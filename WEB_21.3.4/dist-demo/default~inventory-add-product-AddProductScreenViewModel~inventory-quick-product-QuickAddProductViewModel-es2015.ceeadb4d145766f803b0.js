(window.webpackJsonp=window.webpackJsonp||[]).push([[66,175],{DLiw:function(e,t,i){"use strict";i.r(t),i.d(t,"AddProductScreenViewModel",(function(){return ue})),i.d(t,"MultipleUOM",(function(){return be}));var s=i("Do2H"),a=i("Lp6j"),o=i("eQJW"),r=i("ScVY"),n=i("VxiT"),l=i("EQd/"),h=i("0/4Q"),d=i("n56n"),c=i("NkMH"),u=i("THE7"),b=i("vVAv"),S=i("RJs6"),m=i("OvA8"),g=i("8B8H"),C=i("ockk"),P=i("3Pt+");class D{constructor(e,t){this.Module="INV",this.ClassName="ProductKitViewModel",this.Visible=!0,this.contextVisible=!0,this.IsKit=0,this.ColumnSpan="4",this.Row="0",this.PrdID="",this.form=new P.j({}),Logger.InfoLog("ProductKitViewModel::Entering ProductKitViewModel With oParent="+e+",IsKit"+t),this.IsKit=t,this.Parent=e,this.ModGrid=new g.a,this.ModGrid.Width="320",this.ModGrid.Height=100,this.ModGrid.CanUserAddRows=!0,this.ModGrid.CanUserDeleteRows=!0,this.ModGrid.CellEditEnding.Subscribe(this,"OnCellEditEnding"),this.KitGrid=new g.a,this.KitGrid.Clear(),this.KitGrid.BeginEdit.Subscribe(this,"OnBeginEdit"),this.KitGrid.CellEditEnding.Subscribe(this,"OnCellEditEnding"),this.KitGrid.CanUserAddRows=!0,this.KitGrid.CanUserDeleteRows=!0,2==t?this.BuildSpecs():this.BuildTempDataTable(),Logger.InfoLog("ProductKitViewModel::Leaving ProductKitViewModel")}get angularGrid(){return this.KitGrid.angularGrid}get angularGridModGrid(){return this.ModGrid.angularGrid}OnBeginEdit(e){let t=e.args.item,i=e.args.column.field,s=e.args.column.className,o=e.args.model;if("DataGridPactListBoxColumn"==s&&"LookVal"==i)o.TypeID="1"!=t.FldType||a.e.IsEmpty(t.LookUpID)?5e5:parseInt(t.LookUpID.toString());else if("DataGridPactListBoxColumn"==s&&"Unit"==i){let e="";e=t.PRODUCT_Key.toString();let i=" (BaseID IN ";i+=" (SELECT     BaseID ",i+=" FROM          COM_UOM AS COM_UOM_1 with(nolock) ",i=i+" WHERE      (UOMID =(select UOMID from inv_product with(nolock) where productid="+e+") ))) ",""==e?(o.ProductID=0,i=" (BaseID IN ",i+=" (SELECT     BaseID ",i+=" FROM          COM_UOM AS COM_UOM_1 with(nolock) ",i+=" WHERE      (UOMID =-1 ))) "):o.ProductID=parseInt(e),o.FilterCondition=i}else"PRODUCT"!=i&&"PRODUCTCODE"!=i||a.e.IsEmpty(t.PRODUCT_Key)||(this.PrdID=t.PRODUCT_Key.toString());return!1}OnCellEditEnding(e){if("ModifierName"==e.column.field){let e=[];e=[],e.push(h.d.ComboBoxItems_2("",""));for(let t=0;t<this.ModGrid.Table.length;t++)e.find(e=>e.Name==this.ModGrid.Table[t].ModifierName.toString())||e.push(h.d.ComboBoxItems_2(this.ModGrid.Table[t].ModifierName.toString(),this.ModGrid.Table[t].ModifierName.toString()));var t=this.KitGrid.Columns.find(e=>"ModifierName"==e.ValueBinding);null!=t&&(t.ComboData=e),this.KitGrid.RefreshGrid=!0}}BuildSpecs(){let e,t;this.KitGrid.Clear(),this.KitGrid.TableColumns.push("GroupName"),this.KitGrid.TableColumns.push("FldType"),this.KitGrid.TableColumns.push("LookUpID"),this.KitGrid.TableColumns.push("LookVal_Key"),this.KitGrid.TableColumns.push("LookVal"),this.KitGrid.TableColumns.push("Val"),this.KitGrid.TableColumns.push("ShowinHeader"),this.KitGrid.TableColumns.push("DisplayOrder"),e=[],t=new C.a,t.DisplayMember="GroupName",t.Header="Group",t.DataType="TextBlock",t.Width=100,t.IsVisible=!0,e.push(t),t=new C.a;let i=new Array;i.push(h.d.ComboBoxItems_2("Text","2")),i.push(h.d.ComboBoxItems_2("Lookup","1")),t.ComboData=i,t.DisplayMember="Name",t.ValueMember="Value",t.ValueBinding="FldType",t.DataType="ComboBox",t.Header="Type",t.Width=100,t.IsVisible=!0,e.push(t),t=new C.a,t.Header="Lookup Type",t.ValueBinding="LookUpID",t.DataType="ComboBox",t.DisplayMember="Name",t.ValueMember="Value",t.Width=150,i=new Array,i.push(h.d.ComboBoxItems_2("","0")),s.a.inventory.GetLookups().Tables[0].forEach(e=>{i.push(h.d.ComboBoxItems_2(e.LookupName.toString(),e.NodeID.toString()))}),t.ComboData=i,e.push(t),t=new C.a,t.DataType="LISTBOX",t.DisplayMember="LookVal",t.ValueMember="LookVal_Key",t.CostCenterID=44,t.Header="Val",t.Width=150,e.push(t),t=new C.a,t.DisplayMember="Val",t.Header="Text",t.DataType="TextBlock",t.Width=100,t.IsVisible=!0,e.push(t),t=new C.a,i=new Array,i.push(h.d.ComboBoxItems_2("NO","0")),i.push(h.d.ComboBoxItems_2("YES","1")),t.ComboData=i,t.DisplayMember="Name",t.ValueMember="Value",t.ValueBinding="ShowinHeader",t.DataType="ComboBox",t.Header="Show inHeader",t.Width=100,t.IsVisible=!0,e.push(t),t=new C.a,t.DisplayMember="DisplayOrder",t.Header="Order",t.DataType="FLOAT",t.Width=100,t.IsVisible=!0,e.push(t),this.KitGrid.Columns=e,this.KitGrid.AddExtraEmptyRows(10)}BuildTempDataTable(){let e,t;this.KitGrid.Clear(),this.KitGrid.TableColumns.push("ModifierName"),this.KitGrid.TableColumns.push("PRODUCT"),this.KitGrid.TableColumns.push("PRODUCTCODE"),this.KitGrid.TableColumns.push("PRODUCT_Key"),this.KitGrid.TableColumns.push("Qty"),this.KitGrid.TableColumns.push("Rate"),this.KitGrid.TableColumns.push("Link"),this.KitGrid.TableColumns.push("Unit"),this.KitGrid.TableColumns.push("Unit_Key"),this.KitGrid.TableColumns.push("LinkedProductID"),this.KitGrid.TableColumns.push("Remarks"),e=[];let i=[];t=new C.a,i.push(h.d.ComboBoxItems_2("","")),t.ComboData=i,t.DisplayMember="Name",t.ValueMember="Value",t.ValueBinding="ModifierName",t.DataType="ComboBox",t.Header="Modifier Name",t.Width=150,t.IsVisible=!1,e.push(t),t=new C.a,t.CostCenterID=3;let a=this.Parent.ScreenObject.Data.Tables[10].filter(e=>"KitProductCode"==e.Name);if(t.TypeID=null!=a&&null!=a&&a.Length>0?parseInt(a[0].Value.toString()):10,t.DataType="LISTBOX",t.DisplayMember="PRODUCTCODE",t.ValueMember="PRODUCT_Key",t.Header=s.a.SessionManager.translate.instant("ProductCode"),t.Width=250,e.push(t),t=new C.a,t.CostCenterID=3,a=this.Parent.ScreenObject.Data.Tables[10].filter(e=>"KitProductName"==e.Name),t.TypeID=null!=a&&a.Length>0?parseInt(a[0].Value):10,t.DataType="LISTBOX",t.DisplayMember="PRODUCT",t.ValueMember="PRODUCT_Key",t.Header=s.a.SessionManager.translate.instant("Product_SelectedName"),t.Width=250,e.push(t),1==this.IsKit&&(t=new C.a,t.DisplayMember="Qty",t.Header=s.a.SessionManager.translate.instant("Packages_Qty"),t.DataType="TextBlock",t.Width=100,t.IsVisible=!0,e.push(t),t=new C.a,t.CostCenterID=11,t.TypeID=1,t.DataType="LISTBOX",t.DisplayMember="Unit",t.ValueMember="Unit_Key",t.Header="Unit",t.Width=100,e.push(t),t=new C.a,t.DisplayMember="Rate",t.Header=s.a.SessionManager.translate.instant("Inv_CCRate_Rate"),t.DataType="TextBlock",t.Width=100,t.IsVisible=!0,e.push(t),t=new C.a,t.DisplayMember="Remarks",t.Header=s.a.SessionManager.translate.instant("Remarks"),t.DataType="TextBlock",t.Width=200,t.IsVisible=!0,e.push(t)),0==this.IsKit){t=new C.a;let i=[];i.push({LinkName:"Optional",Link:"1"}),i.push({LinkName:"Mandatory",Link:"2"}),t.ComboData=i,t.DisplayMember="LinkName",t.ValueMember="Link",t.ValueBinding="Link",t.DataType="ComboBox",t.Header=s.a.SessionManager.translate.instant("Link"),t.Width=100,t.IsVisible=!0,e.push(t)}this.KitGrid.Columns=e;for(let s=0;s<10;s++)this.KitGrid.addEmptyRow();{this.ModGrid.Table=[],this.ModGrid.TableColumns.push("ModifierName"),this.ModGrid.TableColumns.push("MinSelect"),this.ModGrid.TableColumns.push("MaxSelect");let e=[];t=new C.a,t.DisplayMember="ModifierName",t.Header="Modifier Name",t.DataType="TextBlock",t.Width=150,t.IsVisible=!0,e.push(t),t=new C.a,t.DisplayMember="MinSelect",t.Header="Min. Select",t.DataType="TextBlock",t.Width=80,t.IsVisible=!0,e.push(t),t=new C.a,t.DisplayMember="MaxSelect",t.Header="Max. Select",t.DataType="TextBlock",t.Width=80,t.IsVisible=!0,e.push(t),this.ModGrid.Columns=e;for(let t=0;t<3;t++)this.ModGrid.addEmptyRow()}}SpecsXML(){Logger.InfoLog("ProductKitViewModel::Entering SpecsXML");let e="";if(null!=this.KitGrid.Table&&this.KitGrid.Table.length>0)for(let t=0;t<this.KitGrid.Table.length;t++)a.e.StringIsNullOrEmpty(this.KitGrid.Table[t].FldType)||(e+="<Row   ",e+=' GroupName="'+a.e.String(this.KitGrid.Table[t].GroupName)+'"',e+=' FldType="'+a.e.String(this.KitGrid.Table[t].FldType)+'"',e+=' LookUpID="'+a.e.String(this.KitGrid.Table[t].LookUpID)+'"',"1"!=a.e.String(this.KitGrid.Table[t].FldType)||a.e.StringIsNullOrEmpty(this.KitGrid.Table[t].LookVal_Key)?e+=' Val="'+a.e.String(this.KitGrid.Table[t].Val)+'"':e+=' LookUpVal="'+this.KitGrid.Table[t].LookVal_Key.toString()+'"',e+=' ShowinHeader="'+a.e.String(this.KitGrid.Table[t].ShowinHeader)+'"',e+=' DisplayOrder="'+a.e.String(this.KitGrid.Table[t].DisplayOrder)+'"',e+="/>");return e.length>0&&(e="<XML>"+e+"</XML>"),Logger.InfoLog("ProductKitViewModel::Leaving SpecsXML Which Returns XML as"+e),e.toString()}GetKitXML(e,t){Logger.InfoLog("ProductKitViewModel::Entering GetKitXML");let i,s="";t>0&&(s+='<Row  LinkedProductID="-1" ',s+=' CostCenterID="'+e+'"',s+=' NodeID="'+t+'"',s+="/>");let o="";if(null!=this.KitGrid.Table&&this.KitGrid.Table.length>0)for(let r=0;r<this.KitGrid.Table.length;r++)if(!a.e.StringIsNullOrEmpty(this.KitGrid.Table[r].PRODUCT_Key)){s+="<Row   ",s+=' RowNo="'+(r+1)+'"',this.ModGrid.Visible?this.KitGrid.TableColumns.Contains("ModifierName")&&null!=this.KitGrid.Table[r].ModifierName&&null!=this.KitGrid.Table[r].ModifierName&&""!=this.KitGrid.Table[r].ModifierName.toString().Trim()&&(o=this.KitGrid.Table[r].ModifierName.toString().Trim(),i=this.ModGrid.Table.filter(e=>e.ModifierName==o),null!=i&&i.length>0&&(s+=' ModifierName="'+a.e.String(this.KitGrid.Table[r].ModifierName)+'"',s+=' MinSelect="'+a.e.String(i[0].MinSelect)+'"',s+=' MaxSelect="'+a.e.String(i[0].MaxSelect)+'"')):(s+=' ModifierName=""',s+=' MinSelect="0"',s+=' MaxSelect="0"'),a.e.StringIsNullOrEmpty(this.KitGrid.Table[r].LinkedProductID)?s+=' LinkedProductID="0"':s+=' LinkedProductID="'+this.KitGrid.Table[r].LinkedProductID.toString()+'"',s+=' Product="'+this.KitGrid.Table[r].PRODUCT_Key.toString()+'"',s+=' Qty="'+a.e.String(this.KitGrid.Table[r].Qty)+'"',s+=' Rate="'+a.e.String(this.KitGrid.Table[r].Rate)+'"',a.e.StringIsNullOrEmpty(this.KitGrid.Table[r].Unit_Key)||(s+=' Unit="'+this.KitGrid.Table[r].Unit_Key.toString()+'"');let e="1";a.e.StringIsNullOrEmpty(this.KitGrid.Table[r].Link)||(e=this.KitGrid.Table[r].Link.toString()),s+=' LINK="'+e+'"',s+=' Remarks="'+a.e.String(this.KitGrid.Table[r].Remarks)+'"',s+="/>"}return Logger.InfoLog("ProductKitViewModel::Leaving GetKitXML Which Returns XML as"+s),s.toString()}LoadSpecs(e){Logger.InfoLog("LoadBundels :: Entering LoadSpecs With DataTable="+e),Logger.InfoLog("ProductKitViewModel::Entering LoadSpecs"),this.KitGrid.Clear();for(let t=0;t<e.length;t++){let i=this.KitGrid.NewRow();i.GroupName=a.e.String(e[t].GroupName),i.FldType=a.e.String(e[t].FldType),i.LookUpID=a.e.String(e[t].LookUpID),a.e.IsEmpty(e[t].LookUpVal)||"1"!=a.e.String(e[t].FldType)?(i.Val=a.e.String(e[t].Val),i.LookVal=null,i.LookVal_Key=null):(i.LookVal=a.e.String(e[t].Name),i.LookVal_Key=e[t].LookUpVal.toString(),i.Val=null),i.ShowinHeader=a.e.String(e[t].ShowinHeader),i.DisplayOrder=a.e.String(e[t].DisplayOrder),this.KitGrid.addRow(i)}for(let t=0;t<10;t++)this.KitGrid.addEmptyRow();Logger.InfoLog("ProductKitViewModel::Exiting LoadSpecs")}LoadBundels(e){Logger.InfoLog("LoadBundels :: Entering LoadBundels With DataTable="+e);let t=0;if(Logger.InfoLog("ProductKitViewModel::Entering LoadBundles"),this.ModGrid.Visible){if(this.ModGrid.Table.Clear(),e.length>0){let t=e.ToTable(!0,"ModifierName","MinSelect","MaxSelect");if(null!=t&&t.length>0){let e,s=[];s.push(h.d.ComboBoxItems_2("",""));for(let i=0;i<t.length;i++)e=this.ModGrid.NewRow(),e.ModifierName=t[i].ModifierName,e.MinSelect=t[i].MinSelect,e.MaxSelect=t[i].MaxSelect,this.ModGrid.addRow(e),s.find(e=>e.Name==t[i].ModifierName.toString())||s.push(h.d.ComboBoxItems_2(t[i].ModifierName.toString(),t[i].ModifierName.toString()));var i=this.KitGrid.Columns.find(e=>"ModifierName"==e.ValueBinding);null!=i&&(i.ComboData=s)}}this.ModGrid.addEmptyRow()}let s=e;for(this.KitGrid.Clear();t<s.length;t++){let i=this.KitGrid.NewRow();this.KitGrid.TableColumns.Contains("ModifierName")&&e.Columns.Contains("ModifierName")&&(i.ModifierName=s[t].ModifierName.toString()),i.PRODUCT=a.e.String(s[t].PRODUCTNAME),i.PRODUCT_Key=a.e.String(s[t].ProductID),i.PRODUCTCODE=a.e.String(s[t].ProductCode),i.Qty=a.e.StringIsNullOrEmpty(s[t].Quantity)?null:s[t].Quantity.toString(),i.Rate=s[t].Rate?s[t].Rate.toString():null,a.e.StringIsNullOrEmpty(s[t].unit)?(i.Unit_Key=null,i.Unit=null):(i.Unit_Key=s[t].unit.toString(),i.Unit=s[t].UnitName.toString()),i.Link=a.e.StringIsNullOrEmpty(s[t].LinkType)?null:s[t].LinkType.toString(),i.LinkedProductID=a.e.StringIsNullOrEmpty(s[t].LinkedProductID)?null:s[t].LinkedProductID.toString(),i.Remarks=a.e.StringIsNullOrEmpty(s[t].Remarks)?null:s[t].Remarks.toString(),this.KitGrid.addRow(i)}for(;t<10;t++)this.KitGrid.addEmptyRow();Logger.InfoLog("ProductKitViewModel::Exiting LoadBundles")}}var p=i("bSOb"),T=i("ybar"),I=i("MC0n");class V extends r.b{constructor(e){if(super(),this.Module="INV",this.ClassName="AddSubstituteViewModel",this.dsetSubstitues=null,this.Dset=null,this.ButtonAdd=new c.a,this.SubstituteDelete=new c.a,this.Products=new h.b(0),this.ManageVisible=!1,this.GroupVisible=!1,this.GroupID=0,this.GroupName="",this.ProductName="",this.SProductID=0,this.NewSubstituteGroups=new d.b(0),this.SubGroupName=new l.d(0),this.IsAdded=!1,this.ProductsList=new h.b(0),this.SelectedIndex=0,this.form=new P.j({}),Logger.InfoLog("AddSubstituteViewModel:: Entering AddSubstituteViewModel With oParent"+e),this.Parent=e,s.a.SessionManager.HideUnathorizedAccess?this.ButtonAdd.Visible=s.a.SessionManager.IsActionAssigned(3,"Substitutes_Create"):this.ButtonAdd.Enable=s.a.SessionManager.IsActionAssigned(3,"Substitutes_Create"),s.a.SessionManager.HideUnathorizedAccess?this.SubstituteDelete.Visible=s.a.SessionManager.IsActionAssigned(3,"Substitutes_Delete"):this.SubstituteDelete.Enable=s.a.SessionManager.IsActionAssigned(3,"Substitutes_Delete"),this.NewSubstituteGroups.SelectionChangedCommand.Subscribe(this,"OnNewGroupSelectionChanged"),this.NewSubstituteGroups.CCID=23,this.NewSubstituteGroups.TypeID=1,this.Dset=s.a.inventory.GetSubstitueGroups(),null!=this.Dset){let e=this.Dset.Tables[1];for(let t=0;t<e.length;t++)0==this.Parent.ViewSubstitutes.lstSelectedGroups.filter(i=>i.Value.toString()==e[t][Object.keys(e[t])[0]].toString()).length?this.ProductsList.Items.push(h.c.CheckedListBoxItem_6(e[t][Object.keys(e[t])[1]].toString(),e[t][Object.keys(e[t])[0]].toString(),!1,3)):this.ProductsList.Items.push(h.c.CheckedListBoxItem_6(e[t][Object.keys(e[t])[1]].toString(),e[t][Object.keys(e[t])[0]].toString(),!0,3));null!=this.Dset&&this.Dset.Tables.length>2&&this.Dset.Tables[2].length>0&&(this.dsetSubstitues=this.Dset.Tables[2])}this.ProductsList.Label="Group",this.NewSubstituteGroups.Label="Select",this.Products.Label=s.a.GetResource("Products"),this.Products.DBColumnName="3",Logger.InfoLog("AddSubstituteViewModel:: Exiting AddSubstituteViewModel")}OnPickerClick(e){if(Logger.InfoLog("OnPickerClick::Entering OnPickerClick With String="+e),"3"==e){let e=new T.a;e.SearchPickerViewModel(this,"PRODUCTS","","",""),s.a.page.ShowDialog(e,I.a,{HideClose:!0,ShowCenter:!0,Title:""})}}ParentCallBack(e){Logger.InfoLog("ParentCallBack :: Entering ParentCallBack With PickerObject="+e),e.SelectedNodes.forEach(e=>{e.IsGroup||0==this.Products.Items.filter(t=>t.Value==e.Id.toString()).length&&this.Products.Items.push(h.c.CheckedListBoxItem_6(e.Text[1],e.Id.toString(),!0,3))}),Logger.InfoLog("ParentCallBack::Exiting ParentCallBack")}CheckExisting(e,t){for(let i=0;i<t.length;i++)if(e.toString()==t[i].PRODUCTID.toString())return!1;return!0}OnSaveSubstitute(e){let t;Logger.InfoLog("AddSubstituteViewModel::Entering OnSaveSubstitute");let i={};if(null!=e&&"Cancel"==e.toString())this.Parent.SubstituteVisibility=!1,s.a.page.HideDialog();else if(null!=e&&"Delete"==e.toString()){i.Address1=this.NewSubstituteGroups.SelectedValue;let e=s.a.inventory.DeleteSubstituteProduct(this.NewSubstituteGroups.SelectedValue);this.MessageVisibility=!0,this.DisplayMessage=e,this.Parent.ViewSubstitutes.OnShowNewSubstitute("Manage")}else if(null!=e&&"Save"==e.toString()){if(null==this.NewSubstituteGroups.SelectedValue)return;i.Address1=this.NewSubstituteGroups.SelectedValue,i.Address2=this.SubGroupName.Text;let e,a="";a+="<Data>",null!=this.dsetSubstitues&&(t=this.dsetSubstitues,t=t.filter(e=>e.SubstituteGroupID==this.NewSubstituteGroups.SelectedValue)),this.Products.Items.forEach(e=>{e.IsChecked?this.CheckExisting(parseInt(e.Value),t)&&(a+="<Row ProductID='"+e.Value+"' MapAction='Link' />"):a+="<Row ProductID='"+e.Value+"' MapAction='Delink' />"}),a+="</Data>",i.Address3=a.toString();let o=0;s.a.inventory.SetSubstituteGroups(i,"SetSubstituteGroups").subscribe(t=>{this.MessageVisibility=!0,this.DisplayMessage=e,o=t.RetValue,o>0&&this.Parent.ViewSubstitutes.OnShowNewSubstitute("Manage")},e=>{console.log("SetSubstituteGroups : "+JSON.stringify(e))})}else if(null!=e&&"Ok"==e.toString()){let e;this.IsAdded=!0,0==this.Parent.ViewSubstitutes.Substitutes.length?(e=0,this.Parent.ViewSubstitutes.Clear()):e=this.Parent.ViewSubstitutes.Substitutes.length,this.Parent.ViewSubstitutes.SubstitutesObj.Clear(),this.Parent.ViewSubstitutes.lstSelectedGroups.Clear(),this.ProductsList.Items.forEach(e=>{if(e.IsChecked){let i=this.Parent.ViewSubstitutes.SubstitutesObj.NewRow();if(i.GroupID=parseInt(e.Value),i.GroupName=e.Name,this.Parent.ViewSubstitutes.Substitutes.push(i),this.Parent.ViewSubstitutes.lstSelectedGroups.push(h.d.ComboBoxItems_2(e.Name,e.Value)),null!=this.dsetSubstitues&&(t=this.dsetSubstitues,t=t.filter(t=>t.SubstituteGroupID==e.Value)),t.length>0)for(let s=0;s<t.length;s++)parseInt(t[s].PRODUCTID.toString())!=this.Parent.ProductID&&(i=this.Parent.ViewSubstitutes.SubstitutesObj.NewRow(),i.GroupID=parseInt(e.Value),i.SProductID=parseInt(t[s].PRODUCTID.toString()),i.ProductName=t[s].PRODUCTNAME.toString(),i.GroupName="-",i.ProductCode=t[s].ProductCode.toString(),this.Parent.ViewSubstitutes.SubstitutesObj.addRow(i))}}),this.Parent.Substitute=new V(this.Parent),Logger.InfoLog("AddSubstituteViewModel::Exiting OnSaveSubstitute")}else null!=e&&"AssignProduct"==e.toString()&&0==this.Products.Items.filter(e=>e.Value==this.Parent.ProductID.toString()).length&&this.Products.Items.push(h.c.CheckedListBoxItem_5(this.Parent.ProductName.Text,this.Parent.ProductID.toString(),!0))}OnNewGroupSelectionChanged(e){if(Logger.InfoLog("OnGroupSelectionChanged:: Entering OnGroupSelectionChanged"),null!=this.NewSubstituteGroups.SelectedValue&&(this.SubGroupName.Enable=!0,this.SubGroupName.Text="",this.Products.Items.Clear(),this.NewSubstituteGroups.SelectedValue>0&&(this.SubGroupName.Enable=!1,null!=this.dsetSubstitues))){let e;if(e=this.dsetSubstitues,e=e.filter(e=>e.SubstituteGroupID==this.NewSubstituteGroups.SelectedValue),e.length>0){this.SubGroupName.Text=e[0].SubstituteGroupName.toString();for(let t=0;t<e.length;t++)this.Products.Items.push(h.c.CheckedListBoxItem_6(e[t].PRODUCTNAME.toString(),e[t].PRODUCTID.toString(),!0,3))}}Logger.InfoLog("OnGroupSelectionChanged:: Exiting OnGroupSelectionChanged")}}var y=i("fXoL"),M=i("ofXK"),O=i("q8k3"),f=i("sYmb");function w(e,t){if(1&e&&(y.Zb(0,"div",4),y.Wc(1,"\n\n        "),y.Zb(2,"div",5),y.Wc(3,"\n            "),y.Vb(4,6),y.Wc(5,"\n        "),y.Yb(),y.Wc(6,"\n    "),y.Yb()),2&e){const e=y.lc();y.Db(4),y.tc("obj",e.obj.ProductsList)("group",e.obj.form)}}function L(e,t){if(1&e){const e=y.ac();y.Zb(0,"div",4),y.Wc(1,"\n\n        "),y.Zb(2,"div",5),y.Wc(3,"\n            "),y.Vb(4,6),y.Wc(5,"\n        "),y.Yb(),y.Wc(6,"\n\n        "),y.Zb(7,"div",5),y.Wc(8,"\n            "),y.Vb(9,6),y.Wc(10,"\n        "),y.Yb(),y.Wc(11,"\n\n        "),y.Zb(12,"div",5),y.Wc(13,"\n            "),y.Zb(14,"div",7),y.Wc(15,"\n                "),y.Zb(16,"span",8),y.hc("click",(function(t){y.Ic(e);const i=y.lc();return t.preventDefault(),i.obj.OnPickerClick("3")})),y.Ub(17,"i",9),y.Yb(),y.Wc(18,"\n            "),y.Yb(),y.Wc(19,"\n            "),y.Vb(20,6),y.Wc(21,"\n        "),y.Yb(),y.Wc(22,"\n\n    "),y.Yb()}if(2&e){const e=y.lc();y.Db(4),y.tc("obj",e.obj.NewSubstituteGroups)("group",e.obj.form),y.Db(5),y.tc("obj",e.obj.SubGroupName)("group",e.obj.form),y.Db(11),y.tc("obj",e.obj.Products)("group",e.obj.form)}}function R(e,t){if(1&e){const e=y.ac();y.Zb(0,"div"),y.Wc(1,"\n\n            "),y.Zb(2,"button",10),y.hc("click",(function(){return y.Ic(e),y.lc().obj.OnSaveSubstitute("Ok")})),y.Wc(3),y.mc(4,"translate"),y.Yb(),y.Wc(5,"\n\n            "),y.Zb(6,"button",11),y.hc("click",(function(){return y.Ic(e),y.lc().obj.OnSaveSubstitute("Cancel")})),y.Ub(7,"i",12),y.Wc(8),y.mc(9,"translate"),y.Yb(),y.Wc(10,"\n        "),y.Yb()}2&e&&(y.Db(3),y.Xc(y.nc(4,2,"ok")),y.Db(5),y.Xc(y.nc(9,4,"Cancel")))}function N(e,t){if(1&e){const e=y.ac();y.Zb(0,"div"),y.Wc(1,"\n\n            "),y.Zb(2,"button",10),y.hc("click",(function(){return y.Ic(e),y.lc().obj.OnSaveSubstitute("Save")})),y.Ub(3,"i",13),y.Wc(4),y.mc(5,"translate"),y.Yb(),y.Wc(6,"\n\n            "),y.Zb(7,"button",10),y.hc("click",(function(){return y.Ic(e),y.lc().obj.OnSaveSubstitute("Delete")})),y.Wc(8),y.mc(9,"translate"),y.Yb(),y.Wc(10,"\n\n            "),y.Zb(11,"button",11),y.hc("click",(function(){return y.Ic(e),y.lc().obj.OnSaveSubstitute("Cancel")})),y.Ub(12,"i",12),y.Wc(13),y.mc(14,"translate"),y.Yb(),y.Wc(15,"\n        "),y.Yb()}2&e&&(y.Db(4),y.Xc(y.nc(5,3,"Save")),y.Db(4),y.Xc(y.nc(9,5,"Delete")),y.Db(5),y.Xc(y.nc(14,7,"Cancel")))}let B=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=y.Nb({type:e,selectors:[["app-add-substitute"]],decls:13,vars:5,consts:[[1,"master-screen",3,"formGroup"],["class","PACTHeaderFields dialogSubBody",4,"ngIf"],[1,"Pactdailogfooter"],[4,"ngIf"],[1,"PACTHeaderFields","dialogSubBody"],[1,"form-group","col-xl-12","col-md-12","col-sm-12","col-xs-12","PACTControl"],["FieldDirective","",3,"obj","group"],[2,"position","absolute","margin-left","65px","margin-top","-6px"],[1,"secondary-btn",3,"click"],[1,"fa-light","fa-file-plus"],[1,"primary-btn-wicon",3,"click"],[1,"secondary-btn-wicon",3,"click"],[1,"fa-light","fa-rectangle-xmark"],[1,"fa-light","fa-floppy-disk"]],template:function(e,t){1&e&&(y.Zb(0,"div",0),y.Wc(1,"\n    "),y.Uc(2,w,7,2,"div",1),y.Wc(3,"\n    "),y.Uc(4,L,23,6,"div",1),y.Wc(5,"\n    "),y.Zb(6,"div",2),y.Wc(7,"\n        "),y.Uc(8,R,11,6,"div",3),y.Wc(9,"\n        "),y.Uc(10,N,16,9,"div",3),y.Wc(11,"\n    "),y.Yb(),y.Wc(12,"\n"),y.Yb()),2&e&&(y.tc("formGroup",t.obj.form),y.Db(2),y.tc("ngIf",t.obj.GroupVisible),y.Db(2),y.tc("ngIf",t.obj.ManageVisible),y.Db(4),y.tc("ngIf",t.obj.GroupVisible),y.Db(2),y.tc("ngIf",t.obj.ManageVisible))},directives:[P.t,P.k,M.t,O.a],pipes:[f.d],encapsulation:2}),e})();class G{constructor(e){this.Module="INV",this.ClassName="ViewSubstituteViewModel",this.Visible=!0,this.contextVisible=!0,this.cmnItem_Click="",this.ShowType=!1,this.ColumnSpan="4",this.ShowNewSubstitute="",this.SubstitutesList=new Array,this.SubstitutesObj=new g.a,this.DeletedSubstitutesColumns=[],this.DeletedSubstitutes=[],this.lstSelectedGroups=new Array,this.SelectedRow=-100,this.ButtonAdd=new c.a,this.ButtonManage=new c.a,this.ButtonDelete=new c.a,this.Flag=!1;let t=e.ScreenObject.Data.Tables[10].filter(e=>"EnableSubstituteType"==e.Name);0!=t.length&&!a.e.StringIsNullOrEmpty(t[0].Value)&&Object(o.j)(t[0].Value)&&(this.ShowType=!0),this.Parent=e,s.a.SessionManager.HideUnathorizedAccess?this.ButtonAdd.Visible=s.a.SessionManager.IsActionAssigned(e.CostCenterID,"Substitutes_Create"):this.ButtonAdd.Enable=s.a.SessionManager.IsActionAssigned(e.CostCenterID,"Substitutes_Create"),this.ButtonManage.Visible=this.ButtonAdd.Visible,this.ButtonManage.Enable=this.ButtonAdd.Enable,this.ShowType?(this.ButtonManage.Visible=!1,this.ButtonAdd.ToolTipTitle="Get Data"):this.ButtonAdd.ToolTipTitle=s.a.GetResource("Inv_Substitutes_AddTitle"),s.a.SessionManager.HideUnathorizedAccess?this.ButtonDelete.Visible=s.a.SessionManager.IsActionAssigned(e.CostCenterID,"Substitutes_Delete"):this.ButtonDelete.Enable=s.a.SessionManager.IsActionAssigned(e.CostCenterID,"Substitutes_Delete"),this.InitGrid()}onBeginEdit(e){let t=this.Substitutes.indexOf(e.args.item);if(t=-1==t||1==this.Substitutes.length||0==this.Substitutes.length||this.Substitutes.length-t<=1?1:0,this.SubstitutesObj.CanUserAddRows)for(let i=0;i<t;i++){let e=this.SubstitutesObj.NewRow();this.SubstitutesObj.addRow(e)}}InitGrid(){if(this.SubstitutesObj.CanUserAddRows=!0,this.ShowType){this.SubstitutesObj.Clear(),this.SubstitutesColumns.push("ProductName"),this.SubstitutesColumns.push("ProductCode"),this.SubstitutesColumns.push("Type"),this.SubstitutesColumns.push("TypeID"),this.SubstitutesColumns.push("SProductID"),this.DeletedSubstitutes=[],this.DeletedSubstitutesColumns.push("ProductName"),this.DeletedSubstitutesColumns.push("ProductCode"),this.DeletedSubstitutesColumns.push("SProductID");for(let e=0;e<10;e++)this.SubstitutesObj.addEmptyRow()}else this.SubstitutesObj.Clear(),this.SubstitutesColumns.push("GroupID"),this.SubstitutesColumns.push("GroupName"),this.SubstitutesColumns.push("ProductName"),this.SubstitutesColumns.push("ProductCode"),this.SubstitutesColumns.push("SProductID"),this.DeletedSubstitutes=[],this.DeletedSubstitutesColumns.push("GroupID"),this.DeletedSubstitutesColumns.push("GroupName"),this.DeletedSubstitutesColumns.push("ProductName"),this.DeletedSubstitutesColumns.push("SProductID");let e=[],t=new C.a;this.ShowType?(t=new C.a,t.CostCenterID=3,t.TypeID=13,t.DataType="LISTBOX",t.DisplayMember="ProductCode",t.ValueMember="SProductID",t.Header=s.a.GetResource("ProductCode"),t.Width=200,e.push(t),t=new C.a,t.CostCenterID=3,t.TypeID=105,t.DataType="LISTBOX",t.DisplayMember="ProductName",t.ValueMember="SProductID",t.Header=s.a.GetResource("Product_SelectedName"),t.Width=250,e.push(t),t=new C.a,t.CostCenterID=44,t.TypeID=66,t.DataType="LISTBOX",t.DisplayMember="Type",t.ValueMember="TypeID",t.Header="Type",t.Width=160,e.push(t)):(t=new C.a,t.DisplayMember="GroupName",t.Header=s.a.GetResource("GroupName"),t.DataType="TextBlock",t.Width=250,t.ReadOnly=!1,t.IsVisible=!0,e.push(t),t=new C.a,t.DisplayMember="ProductCode",t.Header=s.a.GetResource("ProductCode"),t.DataType="TextBlock",t.Width=350,t.ReadOnly=!0,t.IsVisible=!0,e.push(t),t=new C.a,t.DisplayMember="ProductName",t.Header=s.a.GetResource("ProductName"),t.DataType="TextBlock",t.Width=350,t.ReadOnly=!0,t.IsVisible=!0,e.push(t)),this.ColumnSource=e,this.SubstitutesObj.BeginEdit.Subscribe(this,"onBeginEdit")}get angularGrid(){return this.SubstitutesObj.angularGrid}get Substitutes(){return this.SubstitutesObj.Table}get ColumnSource(){return this.SubstitutesObj.Columns}set ColumnSource(e){this.SubstitutesObj.Columns=e}get SubstitutesColumns(){return this.SubstitutesObj.TableColumns}OnCmnItem_Click(e){Logger.InfoLog("ViewSubstituteViewModel::Entering OnCmnItem_Click With strCommand"+e);let t=this.angularGrid.slickGrid.getSelectedRows();if(t.length>0){switch(this.SelectedRow=t[0],e){case"DELETE":if(-100!=this.SelectedRow){if(!this.ShowType&&parseInt(this.Substitutes[this.SelectedRow].GroupID)>0){let e=parseInt(this.Substitutes[this.SelectedRow].GroupID),t=this.Substitutes.length,i=t-1;for(let s=0;s<this.lstSelectedGroups.length;s++)e.toString()==this.lstSelectedGroups[s].Value&&this.lstSelectedGroups.RemoveAt(s);for(let s=t;s>0;s--,i--)e==parseInt(this.Substitutes[i].GroupID)&&this.Substitutes.RemoveAt(i)}else this.Substitutes.RemoveAt(this.SelectedRow);this.SubstitutesObj.refreshDataView()}}Logger.InfoLog("ViewSubstituteViewModel::Exiting OnCmnItem_Click")}}ontextChangedUnit(e){}GetXML(){let e="";if(this.ShowType)this.Substitutes.forEach(t=>{a.e.IsEmpty(t.SProductID)||0==parseInt(t.SProductID)||(e+="<TP ",e+=' SID="'+t.SProductID.toString()+'"',a.e.String(t.TypeID).length>0?e+=' TID="'+a.e.String(t.TypeID)+'"':e+=' TID="1005"',e+="/>")}),e.length>0&&(e="<SubstituteType>"+e+"</SubstituteType>");else{for(let t=0;t<this.lstSelectedGroups.length;t++)e+='<Row Action="NEW"',e+=' GroupID="'+this.lstSelectedGroups[t].Value+'"',e+=' GroupName="'+a.e.EncodeXML(this.lstSelectedGroups[t].Name)+'"',e+="/>";e.length>0&&(e="<SubstitutesXML>"+e+"</SubstitutesXML>")}return e.toString()}OnShowNewSubstitute(e){try{if("Add"==e.toString())if(this.ShowType){this.Parent.DisplayMessage="";let e=s.a.inventory.GetSubstituteTypeData(this.Parent.ProductID);if(0==e.Tables[0].length)return void(this.Parent.DisplayMessage="No Data Found");let t=this.Substitutes.length-1;for(;t>=0&&a.e.IsEmpty(this.Substitutes[t].SProductID);t--);t++,e.Tables[0].forEach(e=>{if(0==this.Substitutes.filter(t=>t.SProductID==e.SProductID.toString()).length){if(this.Substitutes.length-1<t){let e=this.SubstitutesObj.NewRow();this.SubstitutesObj.addRow(e)}this.Substitutes[t].SProductID=e.SProductID,this.Substitutes[t].ProductCode=e.ProductCode,this.Substitutes[t].ProductName=e.ProductName,this.Substitutes[t].TypeID=e.GroupID,this.Substitutes[t].Type=e.Type,this.SubstitutesObj.updateRow(this.Substitutes[t]),t++}});for(let i=t+5-this.Substitutes.length;i>0;i--){let e=this.SubstitutesObj.NewRow();this.SubstitutesObj.addRow(e)}}else this.ButtonAdd.Enable&&this.ButtonAdd.Visible&&(this.Parent.Substitute=new V(this.Parent),this.Parent.SubstituteVisibility=!0),this.Parent.Substitute.ManageVisible=!1,this.Parent.Substitute.GroupVisible=!0;else"Manage"==e.toString()&&(this.ShowType||this.ButtonAdd.Enable&&this.ButtonAdd.Visible&&(this.Parent.Substitute=new V(this.Parent),this.Parent.SubstituteVisibility=!0,this.Parent.Substitute.GroupVisible=!1,this.Parent.Substitute.ManageVisible=!0));s.a.page.ShowDialog(this.Parent.Substitute,B,{Title:s.a.GetResource("Inv_Substitutes_AddTitle")})}catch(t){Logger.ErrorLog("AddProductViewModel:: OnShowNewSubstitute"+t.stack)}}Clear(){if(this.Substitutes.Clear(),this.DeletedSubstitutes.Clear(),this.ShowType)for(let e=0;e<10;e++){let e=this.SubstitutesObj.NewRow();this.SubstitutesObj.addRow(e)}}LoadSubstitutes(e){if(this.Clear(),this.ShowType)for(let t=0;t<e.length;t++)this.SubstitutesObj.addEmptyRow(),this.Substitutes[t].SProductID=e[t].SProductID,this.Substitutes[t].ProductCode=e[t].ProductCode,this.Substitutes[t].ProductName=e[t].ProductName,this.Substitutes[t].TypeID=e[t].GroupID,this.Substitutes[t].Type=e[t].Type;else{this.lstSelectedGroups.Clear();let t=[];t=e,e.forEach(e=>{if(0==this.lstSelectedGroups.filter(t=>t.Value.toString()==e.SubstituteGroupID.toString()).length){let i=this.SubstitutesObj.NewRow();if(t=t.filter(t=>t.SubstituteGroupID==e.SubstituteGroupID.toString()),i.GroupID=a.e.String(e.SubstituteGroupID),i.GroupName=a.e.String(e.SubstituteGroupName),this.SubstitutesObj.addRow(i),t.length>0){this.lstSelectedGroups.push(h.d.ComboBoxItems_2(e.SubstituteGroupName.toString(),e.SubstituteGroupID.toString()));for(let e=0;e<t.length;e++)i=this.Parent.ViewSubstitutes.SubstitutesObj.NewRow(),i.GroupID=a.e.String(t[e].SubstituteGroupID),i.SProductID=parseInt(t[e].ProductID.toString()),i.GroupName="-",i.ProductName=a.e.String(t[e].ProductName),i.ProductCode=a.e.String(t[e].ProductCode),this.SubstitutesObj.addRow(i)}}})}}}class x{constructor(e){this.Module="INV",this.ClassName="ViewBinsViewModel",this.Visible=!0,this.contextVisible=!0,this.RefreshCostCenterGrid=!1,this.ColumnSpan="4",this.Row="1",this.iTempColumns=[],this.BinsObj=new g.a,this.SelectedRow=-100,this.ButtonAdd=new c.a,this.ButtonDelete=new c.a,this.lstSelectedGroups=new Array,this.lstData=new Array,this.BinDimension=0,this.DimCCID=0,this.SNO=1,this.res="",this.DimwiseBinsinUse=!1,this.Flag=!1,Logger.InfoLog("ViewBinsViewModel::Entering ViewBinsViewModel With Parent"+e),s.a.SessionManager.Preferences.ContainsKey("DimensionwiseBins")&&!a.e.StringIsNullOrEmpty(s.a.SessionManager.Preferences.DimensionwiseBins)&&(this.DimCCID=a.e.IntTryParse(s.a.SessionManager.Preferences.DimensionwiseBins),this.DimCCID>0&&(this.DimCCID=parseInt(s.a.SessionManager.Preferences.DimensionwiseBins))),this.Parent=e,this.AddGridColumns(),Logger.InfoLog("ViewBinsViewModel:: Exiting ViewBinsViewModel")}get angularGrid(){return this.BinsObj.angularGrid}get Bins(){return this.BinsObj.Table}get ColumnSource(){return this.BinsObj.Columns}set ColumnSource(e){this.BinsObj.Columns=e}get BinsColumns(){return this.BinsObj.TableColumns}OnCellEndEdit(e){if(Logger.InfoLog("ViewBinsViewModel::Entering OnCellEndEdit With strCommand"+e),"Default"==e.OriginalSource.Column.SortMemberPath){let e=new Array;this.lstData=new Array,e.push("Name_Key"),e.push("Default");for(let t=0;t<this.Bins.length;t++)if(!a.e.StringIsNullOrEmpty(this.Bins[t].Name_Key)&&"1"==this.Bins[t].Default.toString()){let i=new A;for(let s=0;s<e.length;s++)switch(e[s]){case"Location":i.Loc=parseInt(this.Bins[t].Location);break;case"Name_Key":i.Bin=parseInt(this.Bins[t].Name_Key);break;case"Division":i.Div=parseInt(this.Bins[t].Division);break;case"Default":i.Default=parseInt(this.Bins[t].Default)}if(this.lstData.push(new A(i.Loc,i.Div,i.Bin,i.Default)),this.lstData.filter(e=>e.Loc==i.Loc&&e.Div==i.Div&&e.Bin==i.Bin&&e.Default==i.Default).length>=2)return alert("Default is already set for this combination ?"),void(this.Bins[t].Default="0")}}else if("Name"==e.OriginalSource.Column.SortMemberPath){let t=e.OriginalSource.RowDataItem.Row;if(null!=t.Default&&""!=t.Default.toString()||(t.Default="0"),!a.e.StringIsNullOrEmpty(t.Name_Key)&&this.DimCCID>0&&this.DimwiseBinsinUse){let e=s.a.empService.GetQueryData(0,"DimwiseBinsinUse",this.DimCCID,this.BinDimension,t.Name_Key.toString());null!=e&&null!=e&&e.Tables.length>0&&e.Tables[0].length>0&&(t.Dim_Key=e.Tables[0][0][Object.keys(e.Tables[0][0])[0]].toString())}}else if("Location"==e.OriginalSource.Column.SortMemberPath){let t=e.OriginalSource.RowDataItem.Row;t.Default="0",t.Name_Key="0",t.Name=""}this.RefreshCostCenterGrid=!this.RefreshCostCenterGrid,Logger.InfoLog("ViewBinsViewModel::Leaving OnCellEndEdit With strCommand"+e)}OnCmnItem_Click(e){switch(Logger.InfoLog("ViewBinsViewModel::Entering OnCmnItem_Click With strCommand"+e),e){case"DELETE":this.DeleteBinRow()}this.UpdateSequence(),Logger.InfoLog("ViewBinsViewModel::Exiting OnCmnItem_Click")}ontextChangedUnit(e){this.UpdateSequence()}onCanCmnItem_Click(e){return!0}GetXML(){Logger.InfoLog("ViewBinsViewModel::Entering GetXML");let e="";for(let t=0;t<this.Bins.length;t++)a.e.StringIsNullOrEmpty(this.Bins[t].Name_Key)||(e+="<Row ",e+=' BinNodeID="'+this.Bins[t].Name_Key.toString()+'"',e+=' BinDimension="'+this.BinDimension+'"',this.ColumnSource.filter(e=>"Location"==e.Header).length>0?e+=' Location="'+a.e.String(this.Bins[t].Location)+'"':e+=' Location="1"',this.ColumnSource.filter(e=>"Division"==e.Header).length>0?e+=' Division="'+a.e.String(this.Bins[t].Division)+'"':e+=' Division="1"',this.DimCCID>0&&(e+=' DimCCID="'+this.DimCCID+'"',e+=' DimNodeID="'+a.e.String(this.Bins[t].Dim_Key)+'"'),e+=' Default="'+a.e.String(this.Bins[t].Default)+'"',e+=' Serialno="'+a.e.String(this.Bins[t].Sno)+'"',e+=' Capacity="'+a.e.String(this.Bins[t].Capacity)+'"',e+="/>");return e.length>0&&(e="<BinsXML>"+e+"</BinsXML>"),Logger.InfoLog("ViewBins::Exiting GetXML Which Returns XML ="+e),e.toString()}BuildTempDataTable(){this.BinsObj.Clear(),this.iTempColumns.push("Sno"),this.iTempColumns.push("Name"),this.iTempColumns.push("Name_Key"),this.iTempColumns.push("Dim"),this.iTempColumns.push("Dim_Key"),this.iTempColumns.push("Location"),this.iTempColumns.push("Division"),this.iTempColumns.push("LocationText"),this.iTempColumns.push("DivisionText"),this.iTempColumns.push("Default"),this.iTempColumns.push("StyleHeightZero"),this.iTempColumns.push("Capacity"),this.iTempColumns.push("isUsed"),this.BinsObj.TableColumns.push("Sno"),this.BinsObj.TableColumns.push("Name"),this.BinsObj.TableColumns.push("Name_Key"),this.BinsObj.TableColumns.push("Dim"),this.BinsObj.TableColumns.push("Dim_Key"),this.BinsObj.TableColumns.push("Location"),this.BinsObj.TableColumns.push("Division"),this.BinsObj.TableColumns.push("LocationText"),this.BinsObj.TableColumns.push("DivisionText"),this.BinsObj.TableColumns.push("Default"),this.BinsObj.TableColumns.push("StyleHeightZero"),this.BinsObj.TableColumns.push("Capacity"),this.BinsObj.TableColumns.push("isUsed");for(let e=0;e<15;e++){let t=this.BinsObj.NewRow();t.Sno=e+1,t.Name=null,t.Name_Key=null,t.Dim=null,t.Dim_Key=null,t.Location=null,t.Division=null,t.LocationText=null,t.DivisionText=null,t.Default=null,t.StyleHeightZero=null,t.Capacity=null,t.isUsed=null,this.BinsObj.addRow(t)}}gridUnits_TableNewRow(e,t){this.UpdateSequence(),t.Row.Sno=this.SNO}UpdateSequence(){this.SNO=1,this.Bins.forEach(e=>{e.Sno=this.SNO++})}ReturnDimension(){return s.a.inventory.GetBins(this.Parent.ProductID)}AddGridColumns(){Logger.InfoLog("ViewBinsViewModel :: Entering AddGridColumns"),this.BuildTempDataTable();let e=[],t=this.ReturnDimension(),i=new C.a,r="Division";null!=t&&null!=t&&t.Tables.length>0&&t.Columns[0].Contains("BinDimension")&&t.Tables[0].length>0&&(a.e.StringIsNullOrEmpty(t.Tables[0][0].BinDimension)||(this.BinDimension=parseInt(t.Tables[0][0].BinDimension.toString())),a.e.StringIsNullOrEmpty(t.Tables[0][0].DimwiseBins)||(this.DimCCID=parseInt(t.Tables[0][0].DimwiseBins.toString())),r=a.e.StringIsNullOrEmpty(t.Tables[0][0].DimwiseBinName)?"":t.Tables[0][0].DimwiseBinName.toString(),a.e.StringIsNullOrEmpty(t.Tables[0][0].DimwiseBinsinUse)||(this.DimwiseBinsinUse=Object(o.j)(t.Tables[0][0].DimwiseBinsinUse.toString()))),i=new C.a,i.DisplayMember="Sno",i.Header=s.a.GetResource("Sno"),i.DataType="TextBlock",i.Width=50,i.ReadOnly=!0,i.IsVisible=!0,e.push(i),this.DimCCID>0&&(i=new C.a,i.DisplayMember="Dim",i.ValueBinding="Dim_Key",i.DataType="LISTBOX",i.Header=r,i.CostCenterID=this.DimCCID,i.TypeID=1,i.Width=200,i.IsVisible=!0,this.DimwiseBinsinUse&&(i.ReadOnly=!0),e.push(i)),i=new C.a,i.DisplayMember="Name",i.ValueMember="Name_Key",i.DataType="LISTBOX",i.CostCenterID=this.BinDimension,i.TypeID=1,i.Header="Bins",i.Width=350,i.IsVisible=!0,e.push(i),i=new C.a;let n=[];n.push(h.d.ComboBoxItems_2("Yes","1")),n.push(h.d.ComboBoxItems_2("No","0")),i.ComboData=n,i.DisplayMember="Name",i.ValueMember="Value",i.ValueBinding="Default",i.DataType="ComboBox",i.Header="Default",i.Width=80,i.IsVisible=!0,e.push(i),i=new C.a,i.DisplayMember="Capacity",i.Header=s.a.GetResource("Mac_Cap"),i.DataType="TextBlock",i.Width=80,i.IsVisible=!0,e.push(i),this.ColumnSource=e,Logger.InfoLog("ViewBinsViewModel::Exiting AddGridColumns")}LoadBins(e){Logger.InfoLog("ViewBinsViewModel::Entering LoadBins With DataTable"+e),this.AddGridColumns();let t=[];t=e;let i=1;this.BinsObj.Clear(),e.forEach(t=>{let r=this.BinsObj.NewRow();r.Sno=t.Serialno.toString(),r.Name_Key=t.BinNodeID.toString(),r.Name=a.e.IsEmpty(t.Name)?"":t.Name.toString(),s.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"True"==s.a.SessionManager.Preferences.EnableLocationWise.toString()&&this.ColumnSource.filter(e=>"Location"==e.Header).length>0?(r.Location=t.Location.toString(),s.a.SessionManager.LocationWhere.split(",").Contains(t.Location.toString())||(r.StyleHeightZero="1",i--)):(r.Location=null,r.StyleHeightZero=null),r.Division=this.ColumnSource.filter(e=>"Division"==e.Header).length>0?t.Division.toString():null,r.LocationText=t.LocationText.toString(),r.DivisionText=t.DivisionText.toString(),null==e.DimText||a.e.IsEmpty(t.DimNodeID)?(r.Dim_Key=null,r.Dim=null):(r.Dim_Key=t.DimNodeID.toString(),r.Dim=t.DimText.toString()),r.Default=Object(o.j)(t.IsDefault.toString())?"1":"0",r.Capacity=t.Capacity.toString(),r.isUsed=t.isUsed.toString(),this.BinsObj.addRow(r),i++});for(let s=i;s<15;s++){let e=this.BinsObj.NewRow();e.Sno=s,e.Name=null,e.Name_Key=null,e.Dim=null,e.Dim_Key=null,e.Location=null,e.Division=null,e.LocationText=null,e.DivisionText=null,e.Default=null,e.StyleHeightZero=null,e.Capacity=null,e.isUsed=null,this.BinsObj.addRow(e)}Logger.InfoLog("ViewBinsViewModel::Exiting LoadBins")}ValidateBins(){let e=new Array;this.lstData=new Array,e.push("Name_Key"),e.push("Default");for(let t=0;t<this.Bins.length;t++)if(!a.e.StringIsNullOrEmpty(this.Bins[t].Name_Key)&&"1"==this.Bins[t].Default.toString()){let i=new A;for(let s=0;s<e.length;s++)switch(e[s]){case"Location":null!=this.Bins[t].Location&&""!=this.Bins[t].Location&&(i.Loc=parseInt(this.Bins[t].Location));break;case"Name_Key":null!=this.Bins[t].Name_Key&&""!=this.Bins[t].Name_Key&&(i.Bin=parseInt(this.Bins[t].Name_Key));break;case"Division":null!=this.Bins[t].Division&&""!=this.Bins[t].Division&&(i.Div=parseInt(this.Bins[t].Division));break;case"Default":null!=this.Bins[t].Default&&""!=this.Bins[t].Default&&(i.Default=parseInt(this.Bins[t].Default))}if(this.lstData.push(new A(i.Loc,i.Div,i.Bin,i.Default)),this.lstData.filter(e=>e.Loc==i.Loc&&e.Div==i.Div&&e.Bin==i.Bin&&e.Default==i.Default).length>=2)return alert("Default is already set for this combination ? "),this.Bins[t].Default="0",!1}return!0}ValidateBinsCapacity(){if(Object(o.j)(this.Parent.ScreenObject.Data.Tables[10].filter(e=>"DonotExceedCapacity"==e.Name)[0].Value.toString()))for(let e=0;e<this.Bins.length;e++)if(!a.e.StringIsNullOrEmpty(this.Bins[e].Name_Key)&&("0"==this.Bins[e].Capacity.toString()||""==this.Bins[e].Capacity.toString()))return"Enter Capacity at Row no:"+(e+1);return""}OnMessageCallBack(){this.res="Yes"}DeleteBinRow(){if(-100!=this.SelectedRow){let e=this.Bins[this.SelectedRow];if(null!=e)if(""!=e.Name_Key.toString()&&""!=e.isUsed.toString()){if(parseInt(e.isUsed.toString())>0)return this.Parent.MessageVisibility=!0,void(this.Parent.DisplayMessage="Bin "+e.Name.toString()+" is Used");this.Bins.RemoveAt(this.SelectedRow)}else this.Bins.RemoveAt(this.SelectedRow)}}}class A{constructor(e=0,t=0,i=0,s=0){this.Loc=0,this.Div=0,this.Bin=0,this.Default=0,this.Loc=e,this.Div=t,this.Bin=i,this.Default=s}}class E{constructor(e){this.Module="INV",this.ClassName="ProductSerializationViewModel",this.Visible=!0,this.contextVisible=!1,this.Items=[],this.ColumnSpan="4",this.Row="0",this.SelectedIndex=0,this.Views=[],this.SelectedValue=0,this.Expires="",this.IsChecked=!1,this.ItemListObj=new g.a,this.form=new P.j({}),Logger.InfoLog("ProductSerializationViewModel::Entering ProductSerializationViewModel With oParent="+e),this.BindControls(),Logger.InfoLog("ProductSerializationViewModel :: Exiting ProductSerializationViewModel")}get angularGrid(){return this.ItemListObj.angularGrid}get ItemList(){return this.ItemListObj.Table}get Columns(){return this.ItemListObj.Columns}set Columns(e){this.ItemListObj.Columns=e}get BinsColumns(){return this.ItemListObj.TableColumns}BindControls(){Logger.InfoLog("ProductSerializationViewModel::Entering BindControls"),this.Items=[],this.Views=[],this.Items.push(h.d.ComboBoxItems_2("Days","1")),this.Items.push(h.d.ComboBoxItems_2("Month","2")),this.Items.push(h.d.ComboBoxItems_2("Years","3")),this.Views.push(h.d.ComboBoxItems_2("ALL","1")),this.Views.push(h.d.ComboBoxItems_2("Available","2")),this.Views.push(h.d.ComboBoxItems_2("Sold","3")),this.Columns=[];let e=new C.a;e.Header="SNO",e.DisplayMember="SNO",e.Width=60,this.Columns.push(e),e=new C.a,e.Header="Serial Number",e.DisplayMember="SerialNumber",e.Width=100,this.Columns.push(e),e=new C.a,e.Header="Status",e.DisplayMember="Status",e.Width=80,this.Columns.push(e),e=new C.a,e.Header="Warranty",e.DisplayMember="Warranty",e.Width=100,this.Columns.push(e);let t=this.ItemListObj.NewRow();t.SNO="1",t.SerialNumber="1234",t.Status="SOLD",t.Warranty="Active",this.ItemListObj.addRow(t),t=this.ItemListObj.NewRow(),t.SNO="2",t.SerialNumber="1234",t.Status="Available",t.Warranty="InActive",this.ItemListObj.addRow(t),t=this.ItemListObj.NewRow(),t.SNO="3",t.SerialNumber="2556",t.Status="SOLD",t.Warranty="NA",this.ItemListObj.addRow(t),Logger.InfoLog("ProductSerializationViewModel::Leaving BindControls")}LoadSerialization(e){if(Logger.InfoLog("ProductSerializationViewModel::Entering LoadSerialization With DataTable="+e),null!=e&&e.length>0&&null!=e[0].Warranty){this.IsChecked=Object(o.j)(e[0].Warranty),this.Expires=e[0].WarrantyExpires.toString(),this.SelectedValue=parseInt(e[0].WarrantyExpiryFormat);for(let t=0;t<this.Items.length;t++)if(e[0].WarrantyExpiryFormat.toString()==this.Items[t].Value.toString()){this.SelectedIndex=t;break}}Logger.InfoLog("ProductSerializationViewModel::Exiting LoadSerialization")}GetXml(){Logger.InfoLog("ProductSerializationViewModel::Entering GetXml");let e="";return e+="<XML>",e+="<Row Warranty='"+this.IsChecked+"' WarrantyExpires='"+this.Expires+"' WarrantyExpiresTo='"+this.SelectedValue+"'  /></XML>",Logger.InfoLog("ProductSerializationViewModel::Exiting GetXml Which Returns XML as"+e),e.toString()}}var j=i("4ADR");class k{constructor(e){this.Module="INV",this.ClassName="AddVendorViewModel",this.UomParent=null,this.VendorID=0,this.ViewVendorRowID=0,this.VendorAccount=new d.b(0),this.ETA=new l.d(0),this.IsVendor=!0,this.MinOrderQty=new l.d(0),this.Volume=new l.d(0),this.Weight=new l.d(0),this.Remarks=new l.d(0),this.Priority=new l.d(0),this.Barcode=new l.d(0),this.MessageVisibility=!1,this.DisplayMessage="",this.BarcodeGrid=new g.a,this.IsModified=!1,this.form=new P.j({}),"ProductWiseUOMViewModel"!=e.ClassName&&(this.BarcodeGrid=new g.a,this.VendorAccount.CCID=2,this.VendorAccount.TypeID=2,Logger.InfoLog("AddVendorViewModel With oParent"+e),this.Parent=e,this.ETA.Label="ETA",this.VendorAccount.Label="Vendor Name",this.Priority.Label="Priority",this.MinOrderQty.Label="Min Order Quantity",this.Barcode.Label="Barcode",this.ETA.Text="0",this.ETA.DataType="INT",this.MinOrderQty.Text="0",this.MinOrderQty.DataType="FLOAT",this.Priority.Text="0",this.Priority.DataType="INT",this.Volume.Label="Volume",this.Volume.Text="0",this.Volume.DataType="FLOAT",this.Remarks.Label="Remarks",this.Remarks.Text="",this.Remarks.DataType="String",this.Weight.Label="Weight",this.Weight.Text="0",this.Weight.DataType="FLOAT",this.MessageVisibility=!1,this.DisplayMessage="",this.onloadGrid(),Logger.InfoLog("AddVendorViewModel:: Exiting AddVendorViewModel"))}AddVendorViewModel_1(e){this.UomParent=e,this.IsVendor=!1,this.onloadGrid();var t=this.UomParent.SelectedRow.Barcodes.toString().split(",");if(t.length>0){this.BarcodeGrid.Clear();for(let e=0;e<t.length;e++)if(!a.e.IsEmpty(t[e])){let i=this.BarcodeGrid.NewRow();i.Barcode=t[e],this.BarcodeGrid.addRow(i)}for(let e=0;e<8;e++)this.BarcodeGrid.addEmptyRow()}}onloadGrid(){this.BarcodeGrid=new g.a,this.BarcodeGrid.CanUserDeleteRows=!0,this.BarcodeGrid.CanUserAddRows=!0,this.BarcodeGrid.Table=[],this.BarcodeGrid.Columns=[];let e=new C.a;e.Header="Barcode",e.DisplayMember="Barcode",e.DataType="TexBox",e.Width=217,this.BarcodeGrid.Columns.push(e);for(let t=0;t<8;t++)this.BarcodeGrid.addEmptyRow()}get Title(){return this.IsVendor?s.a.GetResource("Inv_Vendors_AddTitle"):"Barcodes"}get angularGrid(){return this.BarcodeGrid.angularGrid}OnSaveVendor(e){if(Logger.InfoLog("AddVendorViewModel::Entering OnSaveVendor"),null!=e&&"Cancel"==e.toString())null!=this.UomParent||(this.Parent.VendorVisibility=!1),s.a.page.HideDialog();else if(null!=e&&"Save"==e.toString()){let e="";for(let t=0;t<this.BarcodeGrid.Table.length;t++)a.e.IsEmpty(this.BarcodeGrid.Table[t].Barcode)||(e=e.length>0?e+","+this.BarcodeGrid.Table[t].Barcode.toString():this.BarcodeGrid.Table[t].Barcode.toString());if(!a.e.IsEmptySpace(this.Barcode.Text)&&this.Barcode.Text.toString().length>0&&(e=this.Barcode.Text+","+e),e=e.Trim(","),null!=this.UomParent)this.UomParent.SelectedRow.Barcodes=e,s.a.page.HideDialog();else{if(this.VendorID>0&&(this.IsModified=!0),null==this.VendorAccount.SelectedValue||0==this.VendorAccount.SelectedValue)return this.DisplayMessage="Select "+s.a.GetResource("Inv_Vendors_VendorName"),void(this.MessageVisibility=!0);if(!this.Parent.ViewVendors.VendorsList.Contains(this)&&this.Parent.ViewVendors.VendorsList.filter(e=>e.VendorAccount.SelectedValue==this.VendorAccount.SelectedValue).length>0)return this.DisplayMessage="Selected "+s.a.GetResource("Inv_Vendors_VendorName")+" Already Exists",void(this.MessageVisibility=!0);if(!(this.VendorAccount.SelectedValue>0))return this.DisplayMessage="Select "+s.a.GetResource("Inv_Vendors_VendorName"),void(this.MessageVisibility=!0);if(!a.e.StringIsNullOrEmpty(this.ETA.Text)||!a.e.StringIsNullOrEmpty(this.Priority.Text)){if(!a.e.ValidateDouble(this.ETA.Text))return this.DisplayMessage="Invalid Data in ETA",void(this.MessageVisibility=!0);if(this.ETA.Text=this.ETA.Text,!a.e.ValidateDouble(this.Priority.Text))return this.DisplayMessage="Invalid Data in Priority",void(this.MessageVisibility=!0);if(this.Priority.Text=this.Priority.Text,!a.e.ValidateDouble(this.MinOrderQty.Text))return this.DisplayMessage="Invalid Data in Minimum order quantity",void(this.MessageVisibility=!0);if(this.MinOrderQty.Text=this.MinOrderQty.Text,!a.e.ValidateDouble(this.Volume.Text))return this.DisplayMessage="Invalid Volume",void(this.MessageVisibility=!0);if(!a.e.ValidateDouble(this.Weight.Text))return this.DisplayMessage="Invalid Weight",void(this.MessageVisibility=!0);let e="";for(let t=0;t<this.BarcodeGrid.Table.length;t++)a.e.StringIsNullOrEmpty(this.BarcodeGrid.Table[t].Barcode)||(e=e.length>0?e+","+this.BarcodeGrid.Table[t].Barcode.toString():this.BarcodeGrid.Table[t].Barcode.toString());if(!a.e.IsEmptySpace(this.Barcode.Text)&&this.Barcode.Text.toString().length>0&&(e=this.Barcode.Text+","+e),e=e.Trim(","),this.Barcode.Text=e,this.Parent.ViewVendors.VendorsList.Contains(this)){var t=this.Parent.ViewVendors.VendorsList.indexOf(this);this.Parent.ViewVendors.VendorsList[t]=this;let e=this.Parent.ViewVendors.VendorGridObj.Table.find(e=>e.VendorID==this.VendorID);e.VendorAccount=this.VendorAccount.Text,e.VendorAccountSelectedValue=this.VendorAccount.SelectedValue,e.ETA=this.ETA.Text,e.Priority=this.Priority.Text,e.MinOrderQty=this.MinOrderQty.Text,e.Volume=this.Volume.Text,e.Weight=this.Weight.Text,e.Remarks=this.Remarks.Text,e.Barcode=this.Barcode.Text,e.VendorID=this.VendorID,this.Parent.ViewVendors.angularGrid.gridService.updateItem(e)}else{this.Parent.ViewVendors.VendorsList.push(this);let e={};null==this.Parent.ViewVendors.SelectedVendor?e=this.Parent.ViewVendors.VendorGridObj.NewRow():null!=this.Parent.ViewVendors.SelectedVendor&&(e=this.Parent.ViewVendors.VendorGridObj.Table.find(e=>e.VendorID==this.VendorID)),e.VendorAccount=this.VendorAccount.Text,e.VendorAccountSelectedValue=this.VendorAccount.SelectedValue,e.ETA=this.ETA.Text,e.Priority=this.Priority.Text,e.MinOrderQty=this.MinOrderQty.Text,e.Volume=this.Volume.Text,e.Weight=this.Weight.Text,e.Remarks=this.Remarks.Text,e.Barcode=this.Barcode.Text,e.VendorID=this.VendorID,null!=this.Parent.ViewVendors.SelectedVendor||this.Parent.ViewVendors.VendorsList.Contains(e)?this.Parent.ViewVendors.angularGrid.gridService.updateItem(e):this.Parent.ViewVendors.angularGrid.dataView.addItem(e)}this.Parent.Vendor=new k(this.Parent),this.MessageVisibility=!1,s.a.page.HideDialog()}Logger.InfoLog("AddVendorViewModel::Exiting OnSaveVendor")}}else for(let i=0;i<this.BarcodeGrid.Table.length;i++)if(a.e.StringIsNullOrEmpty(this.BarcodeGrid.Table[i].Barcode)){let e={};e.Barcode=this.Barcode.Text,this.BarcodeGrid.insertRowAt(e,i),this.Barcode.Text="",this.BarcodeGrid.removeRowAt(this.BarcodeGrid.Table.length-1);break}}onCanSaveVendor(e){return!0}}var U=i("sT9C");function v(e,t){if(1&e){const e=y.ac();y.Zb(0,"div"),y.Wc(1,"\n        "),y.Zb(2,"div",8),y.Wc(3,"\n            "),y.Vb(4,9),y.Wc(5,"\n        "),y.Yb(),y.Wc(6,"\n        "),y.Zb(7,"div",8),y.Wc(8,"\n            "),y.Vb(9,9),y.Wc(10,"\n        "),y.Yb(),y.Wc(11,"\n        "),y.Zb(12,"div",8),y.Wc(13,"\n            "),y.Vb(14,9),y.Wc(15,"\n        "),y.Yb(),y.Wc(16,"\n        "),y.Zb(17,"div",8),y.Wc(18,"\n            "),y.Vb(19,9),y.Wc(20,"\n        "),y.Yb(),y.Wc(21,"\n        "),y.Zb(22,"div",8),y.Wc(23,"\n            "),y.Vb(24,9),y.Wc(25,"\n        "),y.Yb(),y.Wc(26,"\n        "),y.Zb(27,"div",8),y.Wc(28,"\n            "),y.Vb(29,9),y.Wc(30,"\n        "),y.Yb(),y.Wc(31,"\n        "),y.Zb(32,"div",8),y.Wc(33,"\n            "),y.Vb(34,9),y.Wc(35,"\n        "),y.Yb(),y.Wc(36,"\n        "),y.Zb(37,"div",8),y.Wc(38,"\n            "),y.Zb(39,"h6",10),y.hc("click",(function(){return y.Ic(e),y.lc().obj.OnSaveVendor(null)})),y.Wc(40,"Add"),y.Yb(),y.Wc(41,"\n            "),y.Vb(42,9),y.Wc(43,"\n        "),y.Yb(),y.Wc(44,"\n   \n      "),y.Zb(45,"div",11),y.Wc(46,"\n        "),y.Ub(47,"app-PactGridView",12),y.Wc(48,"\n        "),y.Wc(49,"\n      "),y.Yb(),y.Wc(50," \n    "),y.Yb()}if(2&e){const e=y.lc();y.Db(4),y.tc("obj",e.obj.VendorAccount)("group",e.obj.form),y.Db(5),y.tc("obj",e.obj.ETA)("group",e.obj.form),y.Db(5),y.tc("obj",e.obj.Priority)("group",e.obj.form),y.Db(5),y.tc("obj",e.obj.MinOrderQty)("group",e.obj.form),y.Db(5),y.tc("obj",e.obj.Volume)("group",e.obj.form),y.Db(5),y.tc("obj",e.obj.Weight)("group",e.obj.form),y.Db(5),y.tc("obj",e.obj.Remarks)("group",e.obj.form),y.Db(8),y.tc("obj",e.obj.Barcode)("group",e.obj.form),y.Db(5),y.tc("obj",e.obj.BarcodeGrid)}}let W=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=y.Nb({type:e,selectors:[["app-add-vendor"]],decls:25,vars:8,consts:[[1,"master-screen",3,"formGroup"],[1,"PACTHeaderFields","dialogSubBodyNoScroll"],[4,"ngIf"],[1,"Pactdailogfooter"],[1,"primary-btn-wicon",3,"click"],[1,"fa-light","fa-floppy-disk"],[1,"secondary-btn-wicon",3,"click"],[1,"fa-light","fa-rectangle-xmark"],[1,"form-group","col-xl-12","col-md-12","col-sm-12","col-xs-12","PACTControl"],["FieldDirective","",3,"obj","group"],[2,"float","right","font-weight","600","color","#8477f3","text-decoration","underline",3,"click"],["id","divBarcode",1,"form-group","col-xl-12","col-xs-12","PACTControl"],[2,"width","100%",3,"obj"]],template:function(e,t){1&e&&(y.Wc(0,"\n"),y.Zb(1,"div",0),y.Wc(2,"\n    "),y.Zb(3,"div",1),y.Wc(4,"\n        "),y.Uc(5,v,51,17,"div",2),y.Wc(6,"\n  \n  "),y.Zb(7,"div",3),y.Wc(8,"\n    "),y.Zb(9,"div"),y.Wc(10,"\n        "),y.Zb(11,"button",4),y.hc("click",(function(){return t.obj.OnSaveVendor("Save")})),y.Ub(12,"i",5),y.Wc(13),y.mc(14,"translate"),y.Yb(),y.Wc(15,"\n        "),y.Zb(16,"button",6),y.hc("click",(function(){return t.obj.OnSaveVendor("Cancel")})),y.Ub(17,"i",7),y.Wc(18),y.mc(19,"translate"),y.Yb(),y.Wc(20,"\n    "),y.Yb(),y.Wc(21,"      \n  "),y.Yb(),y.Wc(22,"\n"),y.Yb(),y.Wc(23,"\n"),y.Yb(),y.Wc(24,"\n")),2&e&&(y.Db(1),y.tc("formGroup",t.obj.form),y.Db(4),y.tc("ngIf",t.obj.IsVendor),y.Db(8),y.Xc(y.nc(14,4,"Save")),y.Db(5),y.Xc(y.nc(19,6,"Cancel")))},directives:[P.t,P.k,M.t,O.a,U.a],pipes:[f.d],encapsulation:2}),e})();class F{constructor(e){this.Module="INV",this.ClassName="ViewVendorViewModel",this.Visible=!0,this.contextVisible=!0,this.Data=[],this.VendorGridObj=new g.a,this.ColumnSpan="4",this.VendorsList=[],this.SelectedVendor=null,this.DeletedVendors=[],this.ButtonAdd=new c.a,this.ButtonUpdate=new c.a,this.ButtonDelete=new c.a,Logger.InfoLog("ViewVendorViewModel:: Entering ViewVendorViewModel With oParent="+e),this.Parent=e,s.a.SessionManager.HideUnathorizedAccess?this.ButtonAdd.Visible=s.a.SessionManager.IsActionAssigned(e.CostCenterID,"Vendor_Create"):this.ButtonAdd.Enable=s.a.SessionManager.IsActionAssigned(e.CostCenterID,"Vendor_Create"),s.a.SessionManager.HideUnathorizedAccess?this.ButtonUpdate.Visible=s.a.SessionManager.IsActionAssigned(e.CostCenterID,"Vendor_Update"):this.ButtonUpdate.Enable=s.a.SessionManager.IsActionAssigned(e.CostCenterID,"Vendor_Update"),s.a.SessionManager.HideUnathorizedAccess?this.ButtonDelete.Visible=s.a.SessionManager.IsActionAssigned(e.CostCenterID,"Vendor_Delete"):this.ButtonDelete.Enable=s.a.SessionManager.IsActionAssigned(e.CostCenterID,"Vendor_Delete"),this.Data=[],this.InitGrid(),Logger.InfoLog("ViewVendorViewModel:: Exiting ViewVendorViewModel")}get angularGrid(){return this.VendorGridObj.angularGrid}get VendorGrid(){return this.VendorGridObj.Table}get ColumnSource(){return this.VendorGridObj.Columns}set ColumnSource(e){this.VendorGridObj.Columns=e}get VendorGridColumns(){return this.VendorGridObj.TableColumns}OnCmnItem_Click(e){this.SelectedVendor=null;let t=null,i=this.angularGrid.slickGrid.getSelectedRows();if(i.length>0){switch(this.SelectedVendor=this.VendorsList[i[0]],t=this.VendorGrid[i[0]],Logger.InfoLog("ViewVendorViewModel::Entering OnCmnItem_Click With strCommand="+e),e){case"EDIT":null!=this.SelectedVendor&&(this.Parent.Vendor=this.SelectedVendor,this.Parent.VendorVisibility=!0,null!=this.Parent.Vendor&&s.a.page.ShowDialog(this.Parent.Vendor,W,{Title:"Edit Vendor"}));break;case"DELETE":null!=this.SelectedVendor&&(this.SelectedVendor.VendorID>0&&this.DeletedVendors.push(this.SelectedVendor),this.VendorGridObj.removeRow(t),this.angularGrid.gridService.deleteItem(t))}Logger.InfoLog("ViewVendorViewModel::Exiting OnCmnItem_Click")}}onCanCmnItem_Click(e){return!0}GetXML(){Logger.InfoLog("ViewVendorViewModel::Entering GetXML");let e="";for(let t=0;t<this.VendorsList.length;t++){if(0==this.VendorsList[t].VendorID)e+='<Row Action="NEW"';else{if(!this.VendorsList[t].IsModified)continue;e+='<Row Action="MODIFY"'}e+=' VendorID="'+this.VendorsList[t].VendorID+'"',e+=' AccountID="'+this.VendorsList[t].VendorAccount.SelectedValue+'"',e+=' Priority="'+this.VendorsList[t].Priority.Text+'"',e+=' MinOrderQty="'+this.VendorsList[t].MinOrderQty.Text+'"',e+=' LeadTime="'+this.VendorsList[t].ETA.Text+'"',e+=' Barcode="'+this.VendorsList[t].Barcode.Text+'"',e+=' Volume="'+this.VendorsList[t].Volume.Text+'"',e+=' Weight="'+this.VendorsList[t].Weight.Text+'"',e+=' Remarks="'+this.VendorsList[t].Remarks.Text+'"',e+="/>"}for(let t=0;t<this.DeletedVendors.length;t++)e+='<Row Action="DELETE"',e+=' VendorID="'+this.DeletedVendors[t].VendorID+'"/>';return e.length>0&&(e="<VendorsXML>"+e+"</VendorsXML>"),Logger.InfoLog("ViewVendorViewModel::Exiting GetXML Which Returns XML as"+e),e.toString()}OnShowNewVendor(e){Logger.InfoLog("AddProductViewModel::Entering OnShowNewVendor");try{this.SelectedVendor=null,this.Parent.Vendor=new k(this.Parent),this.Parent.VendorVisibility=!0,s.a.page.ShowDialog(this.Parent.Vendor,W,{Title:this.Parent.Vendor.Title}),Logger.InfoLog("AddProductViewModel::Exiting OnShowNewVendor")}catch(t){Logger.ErrorLog("AddProductViewModel:: OnShowNewVendor"+t.stack.toString())}}InitGrid(){this.VendorGridObj.Clear();let e=[],t=new C.a;t=new C.a,t.CostCenterID=3,t.TypeID=13,t.DataType="LISTBOX",t.DisplayMember="VendorAccount",t.ValueMember="NodeNo",t.Header=s.a.GetResource("Inv_Vendors_VendorName"),t.ReadOnly=!0,t.Width=150,e.push(t),t=new C.a,t.DisplayMember="ETA",t.Header=s.a.GetResource("Inv_Vendors_ETA"),t.DataType="TextBlock",t.Width=150,t.ReadOnly=!0,t.IsVisible=!0,e.push(t),t=new C.a,t.DisplayMember="Priority",t.Header=s.a.GetResource("Inv_Vendors_Priority"),t.DataType="TextBlock",t.Width=150,t.ReadOnly=!0,t.IsVisible=!0,e.push(t),t=new C.a,t.DisplayMember="MinOrderQty",t.Header=s.a.GetResource("Inv_Vendors_MinOrderQty"),t.DataType="TextBlock",t.Width=150,t.ReadOnly=!0,t.IsVisible=!0,e.push(t),t=new C.a,t.DisplayMember="Remarks",t.Header=s.a.GetResource("Remarks"),t.DataType="TextBlock",t.Width=150,t.ReadOnly=!0,t.IsVisible=!0,e.push(t),t=new C.a,t.DisplayMember="Barcode",t.Header=s.a.GetResource("Barcode"),t.DataType="TextBlock",t.Width=150,t.ReadOnly=!0,t.IsVisible=!0,e.push(t),this.ColumnSource=e}LoadVendors(e){if(Logger.InfoLog("ViewVendorViewModel::Entering LoadVendors With DataTable"+e),null!=this.Data&&null!=this.Data.Tables){let e=this.Data.Tables[this.Data.Tables.length-1];e.sort((e,t)=>e.TabOrder-t.TabOrder);for(let t=0;t<e.length;t++){let i=new j.b;i.Name=e[t].CCTabName.toString(),i.Header=e[t].ResourceData.toString(),Object(o.j)(e[t].IsVisible)&&this.CustomTab.Pages.push(i)}}let t,i=new Array;this.VendorsList.Clear();for(let s=0;s<e.length;s++)if(i.Contains(parseInt(e[s].ProductVendorID)))this.VendorsList.forEach(t=>{t.VendorID==parseInt(e[s].ProductVendorID)&&(t.Barcode.Text=t.Barcode.Text+","+e[s].Barcode.toString())});else{t=new k(this.Parent),i.push(parseInt(e[s].ProductVendorID)),t.VendorID=parseInt(e[s].ProductVendorID),t.Priority.Text=e[s].Priority.toString(),null==e[s].MinOrderQty||a.e.StringIsNullOrEmpty(e[s].MinOrderQty)||(t.MinOrderQty.Text=e[s].MinOrderQty.toString()),null==e[s].Remarks||a.e.StringIsNullOrEmpty(e[s].Remarks)||(t.Remarks.Text=e[s].Remarks.toString()),a.e.StringIsNullOrEmpty(e[s].LeadTime)||(t.ETA.Text=e[s].LeadTime.toString()),a.e.StringIsNullOrEmpty(e[s].Barcode)||(t.Barcode.Text=e[s].Barcode.toString()),a.e.StringIsNullOrEmpty(e[s].AccountID)||(t.VendorAccount.SelectedValue=parseInt(e[s].AccountID)),a.e.StringIsNullOrEmpty(e[s].AccountName)||(t.VendorAccount.Text=e[s].AccountName.toString()),null==e.Volume||a.e.StringIsNullOrEmpty(e[s].Volume)||(t.Volume.Text=e[s].Volume.toString()),null==e.Weight||a.e.StringIsNullOrEmpty(e[s].Weight)||(t.Weight.Text=e[s].Weight.toString()),this.VendorsList.push(t);let o=this.VendorGridObj.NewRow();o.VendorAccount=t.VendorAccount.Text,o.VendorAccountSelectedValue=t.VendorAccount.SelectedValue,o.ETA=t.ETA.Text,o.Priority=t.Priority.Text,o.MinOrderQty=t.MinOrderQty.Text,o.Remarks=t.Remarks.Text,o.Barcode=t.Barcode.Text,o.VendorID=t.VendorID,this.Parent.ViewVendors.VendorGridObj.addRow(o)}Logger.InfoLog("ViewVendorViewModel::Exiting LoadVendors")}LoadVendorsCopy(){Logger.InfoLog("ViewVendorViewModel::Entering LoadVendorsCopy");for(let e=0;e<this.VendorsList.length;e++)this.VendorsList[e].VendorID=0;Logger.InfoLog("ViewVendorViewModel::Exiting LoadVendorsCopy")}}var _=i("JIg3"),K=i("4HhE"),H=i("m+Ff"),X=i("Lb65");class Q{constructor(e){this.Module="INV",this.ClassName="ProductAttributeNewViewModel",this.Visible=!0,this.contextVisible=!0,this.UpdateFooter=!1,this.PickerClick=new K.b,this.AddNew=new K.b,this.ButtonClick=new K.b,this.CellEditEnding=new K.b,this.CostCenterClick=new K.b,this.SelectionChangedCommand=new K.b,this.MatrixSelectionChangedCommand=new K.b,this.MatrixPanel=!1,this._IsMatrixItem=!1,this.IsSubItem=!1,this.AttributePanel=!1,this.LotWise=[],this.AttributesList=!1,this.SelectedValue=0,this.LSelectedValue=0,this.DisplayName="",this.BarcodeData=[],this.Items=[],this.Seperator="",this.ColumnSource=[],this.ColumnSpan="4",this.MessageVisibility=!1,this.IsMaster=!0,this.Title="",this.GridWidth="",this.DisplayMessage="",this.Profiles=new h.e(0),this.Name=new l.d(0),this.Documents=new h.e(0),this.Columns=new h.e(0),this.Price=new l.d(0),this.WEF=new _.a(0),this.GridHeight="300",this._IsExpanded=!1,this.CCList=[],this.TextList=[],this.CostCenters=new h.a(0),this.TaxChartTable=[],this.UseProductCode=!1,this.StockList=[],this.Islotwise=!1,this.Code="",this.j=0,this.ProductIndex=0,this.stkItemName="",this.stkItemCode="",this.stkCode=null,this.stkID=null,this.stkName=null,console.log(e),Logger.InfoLog("AddTaxChartViewModel::Entering AddTaxChartViewModel With Parent="+e),this.Parent=e,this.MessageVisibility=!1,this.DisplayMessage="",this.GridWidth=(window.innerWidth-300).toString(),this.ButtonClick.Subscribe(this,"OnButtonClick"),this.PickerClick.Subscribe(this,"OnPickerClick"),this.AddNew.Subscribe(this,"OnAddNew"),this.SelectionChangedCommand.Subscribe(this,"Click"),this.MatrixSelectionChangedCommand.Subscribe(this,"onMatrixSelectionChangedCommand"),this.CostCenterClick.Subscribe(this,"OnCostCenterClick"),this.InitControls(),this.GetData(),this.Click("Attribute"),Logger.InfoLog("ProductAttributeNewViewModel::Exiting ProductAttributeNewViewModel")}get IsMatrixItem(){return this._IsMatrixItem}set IsMatrixItem(e){e!=this._IsMatrixItem&&(this.IsSubItem=!!this._IsMatrixItem,this._IsMatrixItem=e)}get IsExpanded(){return this._IsExpanded}set IsExpanded(e){e!=this._IsExpanded&&(this.GridHeight=this.IsExpanded?"450":"300",this._IsExpanded=e)}ProductAttributeNewViewModel_1(e){Logger.InfoLog("AddTaxChartViewModel::Entering AddTaxChartViewModel With Parent="+e),this.Parentdoc=e,this.IsMaster=!1,this.AttributePanel=!0,this.MessageVisibility=!1,this.DisplayMessage="",this.GridWidth=(window.innerWidth-300).toString(),this.ButtonClick.Subscribe(this,"OnButtonClick"),this.CellEditEnding.Subscribe(this,"OnCellEditEnding"),this.AddNew.Subscribe(this,"OnAddNew"),this.PickerClick.Subscribe(this,"OnPickerClick"),this.SelectionChangedCommand.Subscribe(this,"Click"),this.MatrixSelectionChangedCommand.Subscribe(this,"onMatrixSelectionChangedCommand"),this.CostCenterClick.Subscribe(this,"OnCostCenterClick"),this.CCList=[],this.TextList=[];let t=e.ScreenObject.GetMatrixInfo(e.SelectedRow.ProductID_Key.toString());if(null!=t&&t.Tables.length>0&&t.Tables[0].length>0&&t.Columns[0].Contains("AttributeID")&&("1"!=t.Tables[0][0].islotwise.toString()&&"True"!=t.Tables[0][0].islotwise.toString()||(this.Islotwise=!0),t.Tables[0].forEach(t=>{if(null==e.ScreenObject.ColumnSource.find(e=>e.DisplayMember.toLowerCase()=="dcccnid"+(parseInt(t.AttributeID.toString())-5e4)))return e.DisplayMessage='Define "'+t.NAME.toString()+'" in document.',e.MessageVisibility=!0,void(this.MessageVisibility=!0);let i=new h.a(0);i.DBColumnName=t.AttributeID.toString(),i.CheckedChangedCommand.Subscribe(this,"Oncheckedchanged"),i.FeatureID=parseInt(t.AttributeID.toString()),i.Label=t.NAME.toString(),this.CCList.push(i)})),e.ScreenObject.Preferences.ContainsKey("AttributesMap")&&""!=e.ScreenObject.Preferences.AttributesMap){var i=e.ScreenObject.Preferences.AttributesMap.split(",");for(let t=0;t<i.length;t++){var s=e.ScreenObject.ColumnSource.find(e=>e.ID==i[t]);if(null!=s){let e=new l.d;e.DBColumnName=s.DisplayMember,e.DataType="FLOAT",e.Label=s.Header,e.Width="100",e.Action=s.Width,this.TextList.push(e)}}}this.UpdateCCListPositions(),this.BuildTempDataTable(),this.GridHeight="450";for(let a=0;a<20;a++){let e=this.StockList.NewRow();e.Sno=this.StockList.length+1,this.StockList.push(e)}Logger.InfoLog("ProductAttributeNewViewModel::Exiting ProductAttributeNewViewModel")}onMatrixSelectionChangedCommand(e){if(-100==this.SelectedValue){let e=[];this.CostCenters.Items.length>0&&this.CostCenters.Items.forEach(t=>{let i=new H.ViewColumn;i.CostCenterColID=parseInt(t.Value),i.UserColumnName=t.Name.toString(),e.lstLeft.push(i)})}else this.CheckMatrix()}Click(e){Logger.InfoLog("Click::Entering Click"),"Matrix"==e.toString()?(this.MatrixPanel=!0,this.AttributePanel=!1,this.AttributesList=!1,this.IsMatrixItem=!0,this.IsSubItem=!1):"Attribute"==e.toString()&&(this.MatrixPanel=!1,this.AttributePanel=!0,this.AttributesList=!0,this.IsMatrixItem=!1,this.IsSubItem=!0,this.CheckMatrix()),Logger.InfoLog("Click::Exiting Click")}CheckMatrix(){if(this.SelectedValue>0&&!this.IsMatrixItem&&this.IsSubItem){let e=s.a.inventory.GetMatrixData(this.SelectedValue);null!=e&&null!=e&&e.Tables.length>0&&e.Tables[0].length>0&&(this.Clear(),e.Tables[0].forEach(e=>{var t=this.CostCenters.Items.find(t=>t.Value==e.AttributeID.toString());null!=t&&(t.IsChecked=!0,this.OnCostCenterClick(t))}))}}GetData(){Logger.InfoLog("ProductAttributesViewModel::Entering GetData");let e=s.a.inventory.GetMatrixData(0),t=e.Tables[0];null!=t&&t.length>0&&(this.Items=t),e.Tables.length>1&&(this.BarcodeData=e.Tables[1]),this.LotWise=[],this.LotWise.push(h.d.ComboBoxItems_2(s.a.GetResource("Com_Yes"),"1")),this.LotWise.push(h.d.ComboBoxItems_2(s.a.GetResource("Com_No"),"0")),Logger.InfoLog("ProductAttributesViewModel::Leaving GetData")}LoadAttributes(e,t){Logger.InfoLog("LoadAttributes:: Entering LoadAttributes With DataTable="+e+",flg="+t),this.SelectedValue=null!=e[0].AttributeGroupID&&""!=e[0].AttributeGroupID.toString()?parseInt(e[0].AttributeGroupID.toString()):0,t&&(this.LSelectedValue=null!=e[0].IsLotwise&&""!=e[0].IsLotwise.toString()?parseInt(e[0].IsLotwise):0,this.Click("Matrix")),Logger.InfoLog("LoadAttributes:: Exiting LoadAttributes")}LoadSubItems(e){this.CCList.Clear(),this.CostCenters.Enable=!1,this.CostCenters.Items.forEach(e=>{e.IsChecked=!1});let t=e[0].AttributeMapXML.toString();if(t.length>0){let e=new a.f;e.LoadXml(t);for(let t=0;t<e.DocumentElement.children.length;t++){let s=e.DocumentElement.children[t];var i=this.CostCenters.Items.find(e=>e.Value==s.attributes.CID.Value);null!=i&&(i.IsChecked=!0,this.OnCostCenterClick(i))}}this.BuildTempDataTable()}InitControls(){this.CCList=[],this.Columns.Label=s.a.GetResource("Import_Column"),this.CostCenters.Label=s.a.GetResource("CostCenter_CostCenterslist");let e=s.a.inventory.GetTaxChart(0,0,"");if(null!=e&&e.Tables.length>0){let t=e.Tables[0];if(t=t.filter(e=>e.ID>=5e4),t.length>0)for(let e=0;e<t.length;e++)this.CostCenters.Items.push(h.c.CheckedListBoxItem_5(t[e].NAME.toString(),t[e].ID.toString(),!1))}}Clear(){this.CCList.Clear(),this.CostCenters.Enable=!0,this.CostCenters.Items.forEach(e=>{e.IsChecked=!1}),this.BuildTempDataTable()}OnFreeze(e){if("DataGridPactListBoxColumn"==e.Column.Name){let i=e.Column;var t=this.CCList.find(e=>e.FeatureID==i.CostCenterID);null!=t&&(t.OnlyGroup=!t.OnlyGroup),e.Owner.MakeColumnNoTab(i,!t.OnlyGroup,t.OnlyGroup?"#68cbe8":""),i.DisableTab=t.OnlyGroup}else if("PactTextBoxColumnEx"==e.Column.GetType()){let t=e.Column.Binding.Path.Path;var i=this.ColumnSource.find(e=>e.DisplayMember==t);null!=i&&(i.IsRepeat=!i.IsRepeat),e.Owner.MakeColumnNoTab(e.Column,!i.IsRepeat,i.IsRepeat?"#68cbe8":""),e.Column.DisableTab=i.IsRepeat}}OnCellEditEnding(e){let t=-1,i=e.OriginalSource.RowDataItem.Row;if(e.OriginalSource.Column.GetType()==typeof X.b){let s=e.OriginalSource.Column.Binding.Path.Path;""!=i[s+"_Key"].toString()&&(""==i.AttributeMap.toString()&&(t=i.Table.Rows.indexOf(i),t>0&&this.ColumnSource.forEach(e=>{if("LISTBOX"==e.DataType){var s=this.CCList.find(t=>t.FeatureID==e.CostCenterID);null!=s&&s.OnlyGroup&&(null!=i[e.DisplayMember]&&null!=i[e.DisplayMember]&&""!=i[e.DisplayMember].toString()||(i[e.DisplayMember]=i.Table.Rows[t-1][e.DisplayMember],i[e.ValueMember]=i.Table.Rows[t-1][e.ValueMember]))}else e.IsRepeat&&(i[e.DisplayMember]=i.Table.Rows[t-1][e.DisplayMember])})),i.AttributeMap=i[s].toString())}else t=i.Table.Rows.indexOf(i),t>0&&this.ColumnSource.forEach(e=>{if("LISTBOX"==e.DataType){var s=this.CCList.find(t=>t.FeatureID==e.CostCenterID);null!=s&&s.OnlyGroup&&(null!=i[e.DisplayMember]&&null!=i[e.DisplayMember]&&""!=i[e.DisplayMember].toString()||(i[e.DisplayMember]=i.Table.Rows[t-1][e.DisplayMember],i[e.ValueMember]=i.Table.Rows[t-1][e.ValueMember]))}else e.IsRepeat&&(null!=i[e.DisplayMember]&&null!=i[e.DisplayMember]&&""!=i[e.DisplayMember].toString()||(i[e.DisplayMember]=i.Table.Rows[t-1][e.DisplayMember]))});i.AcceptChanges();var s=this.ColumnSource.find(t=>t.DisplayMember==e.OriginalSource.Column.Binding.Path.Path&&"FLOAT"==t.DataType);null!=s&&this.Calculatetotals(s)}Calculatetotals(e){let t=0;for(let i=0;i<this.StockList.length;i++)null!=this.StockList.Rows[i][e.DisplayMember]&&null!=this.StockList.Rows[i][e.DisplayMember]&&""!=this.StockList.Rows[i][e.DisplayMember].toString().Trim()&&(t+=parseFloat(this.StockList.Rows[i][e.DisplayMember]));e.footer=t.ToString("N"+e.DecimalPoints),this.UpdateFooter=!0}OnButtonClick(e){if("AddProducts"==e);else if("AddAccounts"==e);else if("Generate"==e)this.GenerateClick();else if("Cancel"==e);else if("OK"==e){let e=0;null!=this.Parentdoc.SelectedRow&&this.Parentdoc.SelectedRow&&(e=this.Parentdoc.ScreenObject.GridData.indexOf(this.Parentdoc.SelectedRow));let t=0;for(let i=0;i<this.StockList.length;i++)if(""!=this.StockList[i].AttributeMap.toString()){let s;if(0==t)s=this.Parentdoc.SelectedRow;else{s=this.Parentdoc.ScreenObject.GridData.NewRow();for(let e=0;e<this.Parentdoc.ScreenObject.GridData.Columns.length;e++)"docseqno"!=this.Parentdoc.ScreenObject.GridData.Columns[e].ColumnName.toLowerCase()&&"LinkedFieldName"!=this.Parentdoc.ScreenObject.GridData.Columns[e].ColumnName.toLowerCase()&&"sno"!=this.Parentdoc.ScreenObject.GridData.Columns[e].ColumnName.toLowerCase()&&"LinkedInvDocDetailsID"!=this.Parentdoc.ScreenObject.GridData.Columns[e].ColumnName.toLowerCase()&&"RefNO"!=this.Parentdoc.ScreenObject.GridData.Columns[e].ColumnName.toLowerCase()&&"docdetailsid"!=this.Parentdoc.ScreenObject.GridData.Columns[e].ColumnName.toLowerCase()&&(s[e]=this.Parentdoc.SelectedRow[e]);this.Parentdoc.ScreenObject.GridData.InsertAt(s,e+t)}t++;for(let e=0;e<this.CCList.length;e++)s["dcCCNID"+(parseInt(this.CCList[e].DBColumnName)-5e4)]=this.StockList[i][this.CCList[e].Label],s["dcCCNID"+(parseInt(this.CCList[e].DBColumnName)-5e4)+"_Key"]=this.StockList[i][this.CCList[e].Label+"_Key"];for(let e=0;e<this.TextList.length;e++)""!=this.StockList[i][this.TextList[e].DBColumnName].toString()&&(s[this.TextList[e].DBColumnName]=this.StockList[i][this.TextList[e].DBColumnName]);if(this.Parentdoc.CalculateTotals(s,!1,"Quantity"),this.Islotwise&&null!=this.StockList[i].Quantity&&null!=this.StockList[i].Quantity&&""!=this.StockList[i].Quantity.toString()&&parseFloat(this.StockList[i].Quantity)>1){let i=parseInt(s.Quantity);s.Quantity=1,this.Parentdoc.CalculateTotals(s,!1,"Quantity");for(let a=0;a<i-1;a++){let i=this.Parentdoc.ScreenObject.GridData.NewRow();i.ItemArray=s.ItemArray.Clone(),this.Parentdoc.ScreenObject.GridData.Rows.InsertAt(i,e+t),this.Parentdoc.CalculateTotals(s,!1,"Quantity"),t++}}}this.Parentdoc.ScreenObject.UpdateSequence(),s.a.page.HideDialog()}else"Save"==e&&this.SaveClick();Logger.InfoLog("OnButtonClick:: Exiting OnButtonClick")}Oncheckedchanged(e){this.CCList.find(t=>t.DBColumnName==e.toString())}OnAddNew(e){Logger.InfoLog("OnAddNew::Entering OnAddNew With String="+e),this.CCList.find(t=>t.DBColumnName==e),Logger.InfoLog("OnAddNew:: Exiting OnAddNew")}OnPickerClick(e){Logger.InfoLog("OnPickerClick::Entering OnPickerClick With String="+e),s.a.page.ShowDialog("3"==e?(new T.a).SearchPickerViewModel_2(this,"PRODUCTS"):"2"==e?(new T.a).SearchPickerViewModel_2(this,"ACCOUNTS"):(new T.a).SearchPickerViewModel_3(this,"COSTCENTER",e),I.a),Logger.InfoLog("OnPickerClick:: Exiting OnPickerClick")}OnCostCenterClick(e){if(Logger.InfoLog("OnCostCenterClick::Entering OnCostCenterClick With oItem="+e),e.IsChecked){let t=new h.a(0);t.DBColumnName=e.Value,t.FeatureID=parseInt(e.Value),t.Label=e.Name,this.CCList.push(t)}else for(let t=0;t<this.CCList.length;t++)if(this.CCList[t].DBColumnName==e.Value){this.CCList.RemoveAt(t);break}this.UpdateCCListPositions(),Logger.InfoLog("OnCostCenterClick:: Exiting OnCostCenterClick")}ParentCallBack(e){if(Logger.InfoLog("ParentCallBack :: Entering ParentCallBack With PickerObject="+e),"COSTCENTER"==e.PickerType||"PRODUCTS"==e.PickerType||"ACCOUNTS"==e.PickerType){let t=this.CCList.filter(t=>t.DBColumnName==e.TreeCCID.toString());if(t.length>0){let i=t[0];e.SelectedNodes.forEach(e=>{e.IsGroup||0==i.Items.filter(t=>t.Value==e.Id.toString()).length&&(i.Items.push(h.c.CheckedListBoxItem_5(e.Text[1],e.Id.toString(),!0)),i.Items[i.Items.length-1].Parent=e.Text[0])})}}Logger.InfoLog("ParentCallBack::Exiting ParentCallBack")}SaveClick(){if(a.e.StringIsNullOrEmpty(this.Name.Text))return void(this.DisplayMessage="Select "+this.Name.Label);let e="";this.TaxChartTable.forEach(t=>{e+="<Row ",e+=' DocID="'+t.Document_Key+'"',e+=' ColID="'+t.Column_Key+'"',e+=' CC="'+t.CC+'"',e+=' ID="'+t.CCID+'"',e+=' Price="'+t.Price+'"',e+=' WEF="'+t.WEF+'"',e+="/>"}),e.length>0&&(e="<XML>"+e+"</XML>")}GenerateClick(){let e=this.CCList.length;this.BuildTempDataTable(),this.DisplayMessage="",this.stkCode=[e],this.stkID=[e],this.stkName=[e],this.CCList.length>0&&this.CallRecursive(0),this.RefreshSno(this.StockList),this.ColumnSource.forEach(e=>{"FLOAT"==e.DataType&&this.Calculatetotals(e)})}BuildTempDataTable(){if(!this.IsMaster&&this.StockList.Columns.length>0)return;let e=[],t=[],i=new C.a;i=new C.a,i.DisplayMember="Sno",i.Header="Sno",i.DataType="TextBlock",i.Width=38,i.ReadOnly=!0,t.push(i),this.IsMaster&&(i=new C.a,i.DisplayMember="ItemCode",i.Header="Item Code",i.DataType="TextBlock",i.Width=100,i.ReadOnly=!0,t.push(i),i=new C.a,i.DisplayMember="ItemName",i.Header="Item Name",i.DataType="TextBlock",i.Width=120,i.ReadOnly=!0,t.push(i)),e.Columns.push("Sno"),e.Columns.push("ItemName"),e.Columns.push("ItemCode"),e.Columns.push("AttributeMap");for(let s=0;s<this.CCList.length;s++)i=new C.a,i.DisplayMember=this.CCList[s].Label,i.Header=this.CCList[s].Label,this.IsMaster?(i.ReadOnly=!0,i.DataType="TextBlock"):(i.DataType="LISTBOX",i.CostCenterID=parseInt(this.CCList[s].DBColumnName),i.TypeID=1),i.Width=100,t.push(i),e.Columns.push(this.CCList[s].Label);if(!this.IsMaster){for(let t=0;t<this.CCList.length;t++)e.Columns.push(this.CCList[t].Label+"_Key");for(let s=0;s<this.TextList.length;s++)i=new C.a,i.DisplayMember=this.TextList[s].DBColumnName,i.Header=this.TextList[s].Label,"FLOAT"==this.TextList[s].DataType?(i.DataType="FLOAT",i.ShowTotal=!0,i.IsCalculated=1,i.footer=(0).ToString("N"+this.TextList[s].DecimalPoints)):i.DataType="TextBlock",i.Width=this.TextList[s].Action,t.push(i),e.Columns.push(this.TextList[s].DBColumnName)}this.ColumnSource=t,this.StockList=e}dtStock_RowDeleted(e,t){{let t=1;for(let i=0;i<e.length;i++)e[i].SNO=t.toString(),t++}}RefreshSno(e,t="sno"){let i=1;for(let s=0;s<e.length;s++)e.Rows[s][t]=i.toString(),i++}CallRecursive(e){for(let i=0;i<this.CCList[e].Items.length;i++)if(this.CCList[e].Items[i].IsChecked)if(this.stkCode[e]=this.CCList[e].Items[i].Parent,"Name"==this.CCList[e].CodeNameCombo.SelectedValue?(this.stkName[e]=this.CCList[e].Items[i].Name,this.stkID[e]=this.CCList[e].Items[i].Value):(this.stkName[e]=this.CCList[e].Items[i].Parent,this.stkID[e]=this.CCList[e].Items[i].Value),e==this.CCList.length-1){let e=null;for(this.IsMaster?(e={},this.StockList.push(e)):e=this.StockList[this.Parentdoc.GetEmptyRowPosition(this.StockList,"AttributeMap")],this.stkItemCode="",this.j=0;this.j<this.stkCode.length;this.j++)this.j>0&&(this.stkItemCode+=this.Seperator),this.stkItemCode+=this.stkCode[this.j];for(e[0]=this.StockList.length,this.stkItemName="",this.j=0;this.j<this.stkName.length;this.j++)this.stkItemName.length>0&&(this.stkItemName+=this.Seperator),this.stkItemName+=this.stkName[this.j],e[4+this.j]=this.stkName[this.j],e[4+this.stkName.length+this.j]=this.stkID[this.j];if(this.stkItemCode=this.stkItemCode.Replace(" ",""),this.stkItemName=this.stkItemName.Replace(" ",""),this.IsMaster){let t="";for(0==this.Parent.ProductID?(this.Parent.ProductCode.PrefixVisibility&&!a.e.StringIsNullOrEmpty(this.Parent.ProductCode.PrefixCode)&&(t=this.Parent.ProductCode.PrefixCode),a.e.StringIsNullOrEmpty(this.Parent.ProductCode.Text)||(t+=this.Parent.ProductCode.Text),this.Parent.ProductCode.SuffixVisibility&&!a.e.StringIsNullOrEmpty(this.Parent.ProductCode.SuffixCode)&&(t+=this.Parent.ProductCode.SuffixCode)):t=this.Parent.ProductCode.Text,e.ItemCode=t+this.Seperator+this.stkItemCode,e.ItemName=this.UseProductCode?t+this.Seperator+this.stkItemName:this.Parent.ProductName.Text+this.Seperator+this.stkItemName,this.stkItemName="",this.j=0;this.j<this.stkName.length;this.j++)this.stkItemName+="CCNID"+(this.CCList[this.j].FeatureID-5e4)+"="+this.stkID[this.j]+",";e.AttributeMap=this.stkItemName}else{for(this.stkItemName="",this.j=0;this.j<this.stkName.length;this.j++)this.stkItemName+="CCNID"+(this.CCList[this.j].FeatureID-5e4)+"="+this.stkID[this.j]+",";e.AttributeMap=this.stkItemName;for(let t=0;t<this.TextList.length;t++)a.e.StringIsNullOrEmpty(this.TextList[t].Text)||(e[this.TextList[t].DBColumnName]=this.TextList[t].Text);if(this.Islotwise){let i=0;var t=this.TextList.find(e=>"quantity"==e.DBColumnName.toLowerCase());if(null==t||null==t||a.e.StringIsNullOrEmpty(t.Text)||(i=a.e.IntTryParse(t.Text)),i>1)for(let t=0;t<i-1;t++){e.quantity="1";let t=this.StockList[this.Parentdoc.GetEmptyRowPosition(this.StockList,"AttributeMap")];for(let i=0;i<this.StockList.Columns.length;i++)"Sno"!=this.StockList.Columns[i].ColumnName&&(t[i]=e[i])}}}}else this.CallRecursive(e+1)}ValidateSelectedNodes(e){0==e.Items.filter(e=>e.IsChecked).length&&(this.DisplayMessage="Select "+e.Label)}UpdateCCListPositions(){for(let e=0;e<this.CCList.length;e++)this.CCList[e].Row=e/3,this.CCList[e].Column=e%3}GetXml(){let e="";e+="<XML>";let t=0;for(t=0;t<this.CCList.length;t++)e+='<Row CID="'+this.CCList[t].FeatureID+'" />';return e+="</XML>",e.toString()}GetStringData(e,t){Logger.InfoLog("GetStringData:: Entering GetStringData With CCID="+e+",CCNodeID="+t);let i=this.CCList.filter(t=>t.DBColumnName==e);if(i.length>0){let e=i[0].Items.filter(e=>e.Value==t);if(e.length>0)return e[0].Name}return Logger.InfoLog("GetStringData::Exiting GetStringData"),""}}class Y{constructor(e){if(this.Module="INV",this.ClassName="AddProductTestcasesViewModel",this.Visible=!0,this.contextVisible=!0,this.ColumnSpan="4",this.TestCaseDim=new d.b(0),this.Iteration=new l.d(0),this.Sample=new l.d(0),this.DocumentsList=new h.e(0),this.Dimension=new d.b(0),this.TestcaseGrid=new g.a,this.TestCaseGridColumnsTemp=[],this.Documents=[],this.form=new P.j({}),this.ProductViewModel=e,this.TestcaseGrid=new g.a,this.TestcaseGrid.Width="",this.TestcaseGrid.CanUserAddRows=!0,this.TestcaseGrid.CanUserDeleteRows=!0,this.TestcaseGrid.CellEditEnding.Subscribe(this,"OnGridCellEditEnding"),this.Documents.push(h.d.ComboBoxItems_2("","1")),null!=e.ScreenObject.Data&&e.ScreenObject.Data.Tables.length>15)for(let t=0;t<e.ScreenObject.Data.Tables[16].length;t++)this.Documents.push(h.d.ComboBoxItems_2(e.ScreenObject.Data.Tables[16][t].DocumentName.toString(),e.ScreenObject.Data.Tables[16][t].CostCenterID.toString()));s.a.SessionManager.Preferences.ContainsKey("TestCaseDimension")&&""!=s.a.SessionManager.Preferences.TestCaseDimension&&parseInt(s.a.SessionManager.Preferences.TestCaseDimension)>0&&(this.TestCaseDim.CCID=parseInt(s.a.SessionManager.Preferences.TestCaseDimension)),s.a.SessionManager.Preferences.ContainsKey("DimensionwiseTestcase")&&""!=s.a.SessionManager.Preferences.DimensionwiseTestcase&&parseInt(s.a.SessionManager.Preferences.DimensionwiseTestcase)>5e4?(this.Dimension.CCID=parseInt(s.a.SessionManager.Preferences.DimensionwiseTestcase),this.Dimension.Visible=!0,this.Dimension.Label=e.ScreenObject.Data.Tables[12].filter(e=>e.FEATUREID==s.a.SessionManager.Preferences.DimensionwiseTestcase).Compute("max","NAME").toString()):this.Dimension.Visible=!1,this.DocumentsList.Items=this.Documents,this.DocumentsList.SelectedValue="1",this.DocumentsList.Label="Document",this.TestCaseDim.Label="Test",this.Sample.Label="Sample",this.Iteration.Label="Observation",this.InitControls()}get angularGrid(){return this.TestcaseGrid.angularGrid}InitControls(){Logger.InfoLog("AddProductTestcasesViewModel:: Inside InitColumns"),this.TestcaseGrid.Columns=[];let e=new C.a;e.Header=s.a.GetResource("DocumentDesigner_Sno"),e.DisplayMember="Sno",e.IsFrozen=!1,e.ReadOnly=!0,e.Width=40,this.TestcaseGrid.Columns.push(e),this.TestCaseGridColumnsTemp.push("Sno"),e=new C.a,e.Header=s.a.GetResource("Doc_Document"),e.DisplayMember="Name",e.ValueMember="Value",e.ValueBinding="DocumentID",e.DataType="ComboBox",e.ComboData=this.Documents,e.Width=120,this.TestcaseGrid.Columns.push(e),this.TestCaseGridColumnsTemp.push("DocumentID"),e=new C.a,e.Header=s.a.GetResource("Inv_TestCase"),e.DisplayMember="TestCaseID",e.ValueMember="TestCaseID_Key",s.a.SessionManager.Preferences.ContainsKey("TestCaseDimension")&&""!=s.a.SessionManager.Preferences.TestCaseDimension&&parseInt(s.a.SessionManager.Preferences.TestCaseDimension)>0&&(e.CostCenterID=parseInt(s.a.SessionManager.Preferences.TestCaseDimension)),e.TypeID=1,e.DataType="LISTBOX",e.Width=150,this.TestcaseGrid.Columns.push(e),this.TestCaseGridColumnsTemp.push("TestCaseID"),this.TestCaseGridColumnsTemp.push("TestCaseID_Key"),e=new C.a,e.Header=s.a.GetResource("Inv_TestType"),e.DisplayMember="Name",e.ValueMember="Value",e.ValueBinding="TestType";let t,i=new Array;i.push(h.d.ComboBoxItems_2("Numeric","0")),i.push(h.d.ComboBoxItems_2("Visual","1")),e.ComboData=i,e.DataType="ComboBox",e.Width=80,this.TestcaseGrid.Columns.push(e),this.TestCaseGridColumnsTemp.push("TestType"),e=new C.a,e.Header=s.a.GetResource("Inv_Min"),e.DisplayMember="Min",e.DataType="TextBlock",e.Width=60,this.TestcaseGrid.Columns.push(e),this.TestCaseGridColumnsTemp.push("Min"),e=new C.a,e.Header=s.a.GetResource("Inv_Max"),e.DisplayMember="Max",e.DataType="TextBlock",e.Width=60,this.TestcaseGrid.Columns.push(e),this.TestCaseGridColumnsTemp.push("Max"),e=new C.a,e.Header=s.a.GetResource("CustomizeCostCenter_ProbableValues"),e.DisplayMember="ProbableValues",e.DataType="TextBlock",e.Width=130,this.TestcaseGrid.Columns.push(e),this.TestCaseGridColumnsTemp.push("ProbableValues"),e=new C.a,e.Header=s.a.GetResource("Inv_Variance"),e.DisplayMember="Variance",e.DataType="TextBlock",e.Width=80,this.TestcaseGrid.Columns.push(e),this.TestCaseGridColumnsTemp.push("Variance"),e=new C.a,e.Header=s.a.GetResource("Inv_Sample"),e.DisplayMember="Sample",e.DataType="TextBlock",e.Width=80,this.TestcaseGrid.Columns.push(e),this.TestCaseGridColumnsTemp.push("Sample"),e=new C.a,e.Header=s.a.GetResource("Inv_SampleType"),e.DisplayMember="Name",e.ValueMember="Value",e.ValueBinding="SampleType",i=new Array,i.push(h.d.ComboBoxItems_2("Value","0")),i.push(h.d.ComboBoxItems_2("Number","1")),i.push(h.d.ComboBoxItems_2("Percentage Value","2")),i.push(h.d.ComboBoxItems_2("Percentage Number","3")),e.ComboData=i,e.DataType="ComboBox",e.Width=100,this.TestcaseGrid.Columns.push(e),this.TestCaseGridColumnsTemp.push("SampleType"),e=new C.a,e.Header=s.a.GetResource("Inv_Observation"),e.DisplayMember="Iteration",e.DataType="TextBlock",e.Width=100,this.TestcaseGrid.Columns.push(e),this.TestCaseGridColumnsTemp.push("Iteration"),e=new C.a,e.Header=s.a.GetResource("Inv_RetestDays"),e.DisplayMember="RetestDays",e.DataType="TextBlock",e.Width=80,this.TestcaseGrid.Columns.push(e),this.TestCaseGridColumnsTemp.push("RetestDays"),s.a.SessionManager.Preferences.ContainsKey("DimensionwiseTestcase")&&""!=s.a.SessionManager.Preferences.DimensionwiseTestcase&&parseInt(s.a.SessionManager.Preferences.DimensionwiseTestcase)>0&&(e=new C.a,e.Header=this.ProductViewModel.ScreenObject.Data.Tables[12].filter(e=>e.FEATUREID==s.a.SessionManager.Preferences.DimensionwiseTestcase).Compute("max","NAME").toString(),e.DisplayMember="Dimension",e.ValueMember="Dimension_Key",e.CostCenterID=parseInt(s.a.SessionManager.Preferences.DimensionwiseTestcase),e.Width=150,e.DataType="LISTBOX",e.TypeID=1,this.TestcaseGrid.Columns.push(e)),this.TestCaseGridColumnsTemp.push("Dimension"),this.TestCaseGridColumnsTemp.push("Dimension_Key"),this.TestcaseGrid.Table=[];for(let s=0;s<5;s++)t=this.TestcaseGrid.NewRow(),t.Sno=s+1,t.DocumentID=null,t.TestCaseID=null,t.TestCaseID_Key=null,t.TestType=null,t.Min=null,t.Max=null,t.ProbableValues=null,t.Variance=null,t.Sample=null,t.SampleType=null,t.Iteration=null,t.RetestDays=null,t.Dimension=null,t.Dimension_Key=null,this.TestcaseGrid.addRow(t);Logger.InfoLog("AddProductTestcasesViewModel:: Exiting InitColumns")}LoadData(e){if(null!=e&&null!=e&&e.length>0){this.TestcaseGrid.Clear();for(let t=0;t<e.length;t++){let i=this.TestcaseGrid.NewRow();i.Sno=(t+1).toString(),i.DocumentID=e[t].DocumentID,i.TestCaseID_Key=e[t].TestCaseID,i.TestType=e[t].TestType,i.Min="0"==e[t].Min.toString()?"":e[t].Min,i.Max="0"==e[t].Max.toString()?"":e[t].Max,i.ProbableValues=e[t].ProbableValues,i.Variance="0"==e[t].Variance.toString()?"":e[t].Variance,i.Sample="0"==e[t].Sample.toString()?"":e[t].Sample,i.SampleType=e[t].SampleType,i.Iteration="0"==e[t].Iteration.toString()?"":e[t].Iteration,i.RetestDays="0"==e[t].RetestDays.toString()?"":e[t].RetestDays,i.Dimension_Key=e[t].CCNodeID,this.TestcaseGrid.addRow(i)}}if(this.TestcaseGrid.Table.length>0)for(let t=this.TestcaseGrid.Table.length;t<3;t++){let e=this.TestcaseGrid.NewRow();e.Sno=t+1,e.DocumentID=null,e.TestCaseID=null,e.TestCaseID_Key=null,e.TestType=null,e.Min=null,e.Max=null,e.ProbableValues=null,e.Variance=null,e.Sample=null,e.SampleType=null,e.Iteration=null,e.RetestDays=null,e.Dimension=null,e.Dimension_Key=null,this.TestcaseGrid.addRow(e)}this.TestcaseGrid.RefreshGrid=!this.TestcaseGrid.RefreshGrid}OnAddNewTestcase(e){if("Add"==e.toString()){if(0==this.TestCaseDim.SelectedValue)return this.ProductViewModel.DisplayMessage="Select Testcase",void(this.ProductViewModel.MessageVisibility=!0);if(null==this.DocumentsList.SelectedValue||"1"==this.DocumentsList.SelectedValue)return this.ProductViewModel.DisplayMessage="Select Document",void(this.ProductViewModel.MessageVisibility=!0);{if(this.TestcaseGrid.Table.length>0)for(let t=this.TestcaseGrid.Table.length-1;t>=0;t--)(a.e.StringIsNullOrEmpty(this.TestcaseGrid.Table[t].DocumentID)||a.e.StringIsNullOrEmpty(this.TestcaseGrid.Table[t].TestCaseID_Key))&&this.TestcaseGrid.Table.RemoveAt(t);let e=this.GetTestCaseDetails(this.TestCaseDim.SelectedValue);if(null!=e&&e.Tables.length>0&&e.Tables[0].length>0){let t=1;for(let i=0;i<e.Tables[0].length;i++){t=this.TestcaseGrid.Table.length;let s=this.TestcaseGrid.NewRow();s.Sno=t+1,s.DocumentID=this.DocumentsList.SelectedValue,s.TestCaseID_Key=e.Tables[0][i].NodeID,s.TestCaseID=e.Tables[0][i].Name,s.TestType=a.e.StringIsNullOrEmpty(e.Tables[0][i].TestType)||"Visual"!=e.Tables[0][i].TestType.toString()?"0":"1",s.Min=e.Tables[0][i].Min,s.Max=e.Tables[0][i].Max,s.ProbableValues=e.Tables[0][i].ProbableValues,s.Variance=e.Tables[0][i].Variance,s.SampleType="0",0==i?(s.Sample=this.Sample.Text,s.Iteration=this.Iteration.Text):(s.Sample="",s.Iteration=""),s.RetestDays="",s.Dimension_Key=this.Dimension.SelectedValue,s.Dimension=this.Dimension.Text,this.TestcaseGrid.addRow(s)}for(let e=0;e<3;e++){t=this.TestcaseGrid.Table.length;let e=this.TestcaseGrid.NewRow();e.Sno=t+1,this.TestcaseGrid.addRow(e)}}this.TestCaseDim.SelectedValue=0,this.Iteration.Text="",this.Sample.Text="",this.Dimension.SelectedValue=0,this.DocumentsList.SelectedValue="1"}}}GetXml(){let e="";e+="<XML>";for(let t=0;t<this.TestcaseGrid.Table.length;t++)a.e.StringIsNullOrEmpty(this.TestcaseGrid.Table[t].DocumentID)||a.e.StringIsNullOrEmpty(this.TestcaseGrid.Table[t].TestCaseID_Key)||(e+="<Row ",e+=' DocumentID="'+this.TestcaseGrid.Table[t].DocumentID.toString()+'"',e+=' TestCaseID="'+this.TestcaseGrid.Table[t].TestCaseID_Key.toString()+'"',e+=' TestType="'+a.e.String(this.TestcaseGrid.Table[t].TestType)+'"',e+=' Min="'+a.e.String(this.TestcaseGrid.Table[t].Min)+'"',e+=' Max="'+a.e.String(this.TestcaseGrid.Table[t].Max)+'"',e+=' ProbableValues="'+a.e.String(this.TestcaseGrid.Table[t].ProbableValues)+'"',e+=' Variance="'+a.e.String(this.TestcaseGrid.Table[t].Variance)+'"',e+=' Sample="'+a.e.String(this.TestcaseGrid.Table[t].Sample)+'"',e+=' SampleType="'+a.e.String(this.TestcaseGrid.Table[t].SampleType)+'"',e+=' Iteration="'+a.e.String(this.TestcaseGrid.Table[t].Iteration)+'"',e+=' RetestDays="'+a.e.String(this.TestcaseGrid.Table[t].RetestDays)+'"',s.a.SessionManager.Preferences.ContainsKey("DimensionwiseTestcase")&&""!=s.a.SessionManager.Preferences.DimensionwiseTestcase&&parseInt(s.a.SessionManager.Preferences.DimensionwiseTestcase)>0?(e+=' CostCenterID="'+s.a.SessionManager.Preferences.DimensionwiseTestcase+'"',e+=' CCNodeID="'+this.TestcaseGrid.Table[t].Dimension_Key.toString()+'"'):(e+=' CostCenterID=""',e+=' CCNodeID="1"'),e+="/>");return e+="</XML>",e.toString()}GetTestCaseDetails(e){return s.a.empService.GetQueryData(0,"GetTestCaseDetails",s.a.SessionManager.Preferences.TestCaseDimension,e,"")}OnGridCellEditEnding(e){let t=e.item;if("TestCaseID"==e.column.field&&!a.e.IsEmpty(t.TestCaseID_Key)){let e=this.GetTestCaseDetails(parseInt(t.TestCaseID_Key.toString()));null!=e&&e.Tables.length>0&&e.Tables[0].length>0&&!e.Columns[0].Contains("ErrorMessage")&&(t.TestType=a.e.IsEmpty(e.Tables[0][0].TestType)||"Visual"!=e.Tables[0][0].TestType.toString()?"0":"1",t.Min=e.Tables[0][0].Min,t.Max=e.Tables[0][0].Max,t.ProbableValues=e.Tables[0][0].ProbableValues,t.Variance=e.Tables[0][0].Variance)}}}var z=i("mrSG"),Z=i("Agar");class q extends r.b{constructor(e,t){super(),this.Visible=!0,this.contextVisible=!0,this.ScreenName="",this.RetValue=0,this._ScreenID="",this.ButtonSave=new c.a,this.ShowBarcodeDimension=!1,this.lstDeletedRecords=new Array,this.lstDeletedint=new Array,this.res="",this.PID=0,this.BarcodeVisibility=!1,this.Units=new h.e(0),this.BaseTextObj=new l.d(0),this.RateTextObj=new l.d(0),this.PACTControlData=[],this._BaseVisibility=!1,this.ButtonVisible=!0,this._DetailsVisibility=!1,this.SelectedNode=0,this.GridUnitsObj=new g.a,this._ScreenData=[],this.RoleName="",this.UserID="",this.Description="",this.MessageVisibility=!1,this.DisplayMessage="",this.SelectedText="",this.form=new P.j({}),this.ClassName="ProductWiseUOMViewModel",Logger.InfoLog("AddUOMViewModel::Entering AddUOMViewModel"),this.PID=e,this.Parent=t,s.a.GetResource("UOM_ScreenName"),s.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=s.a.SessionManager.IsActionAssigned(11,"Create"):this.ButtonSave.Enable=s.a.SessionManager.IsActionAssigned(11,"Create"),this.MessageVisibility=!1,this.Units1.SelectionChangedCommand.Subscribe(this,"onSelectionChanged"),this.RateTextObj.LostFocusCommand.Subscribe(this,"OnSerialNo_LostFoucs"),this.RateTextObj.Label=s.a.GetResource("UOM_ConversionRate"),this.BaseTextObj.Label="Base Name",this.BaseTextObj.LostFocusCommand.Subscribe(this,"OnSerialNo_LostFoucs"),this.Units1.Label="Choose Base",new Z.a(0),this._ScreenID="1002",this.ScreenName="Create UOM",this.DetailsVisibility=!0,this.BindBase(),this.BindGridUnits(),Logger.InfoLog("AddUOMViewModel::Exiting AddUOMViewModel")}get dtTable(){return this.GridUnitsObj.Table}OnCmnItem_Click(e){if(Logger.InfoLog("AddUOMViewModel::Entering OnCmnItem_Click"),this.SelectedNode<0)this.DisplayMessage="Please Select Particular cell to remove",this.MessageVisibility=!0;else if(this.SelectedNode<this.dtTable.length)switch(e){case"DELETE":this.res="",null!=this.SelectedRow&&(null!=this.Parent&&"-399"==this.Parent.UOM.SelectedValue?this.dtTable[0]==this.SelectedRow?alert("Base Unit can not be deleted"):a.e.StringIsNullOrEmpty(this.SelectedRow.PrimayColumn)?this.GridUnitsObj.removeRow(this.SelectedRow):confirm("Are you Sure You Want To Delete this Unit ? ")&&(this.lstDeletedint.push(parseInt(this.SelectedRow.PrimayColumn)),this.GridUnitsObj.removeRow(this.SelectedRow)):("1"==this.SelectedRow.UnitID.toString()?confirm("This Unit will delete Base name: Are you sure ? ")&&this.onDeleteBase(this.SelectedRow.BaseID.toString()):confirm("Are you Sure You Want To Delete this Unit ? ")&&(a.e.StringIsNullOrEmpty(this.SelectedRow.PrimayColumn)||this.lstDeletedint.push(parseInt(this.SelectedRow.PrimayColumn))),this.dtTable.length>0&&"Yes"==this.res&&(a.e.StringIsNullOrEmpty(this.SelectedRow.PrimayColumn)?this.GridUnitsObj.removeRowAt(this.SelectedNode):this.GridUnitsObj.removeRow(this.SelectedRow))))}Logger.InfoLog("AddUOMViewModel::Exiting OnCmnItem_Click")}OnMessageCallBack(){this.res="Yes"}onCanCmnItem_Click(e){return!0}OnSerialNo_LostFoucs(e){if(null!=this.Parent&&"-399"==this.Parent.UOM.SelectedValue){let e,t;e=0==this.GridUnitsObj.Table.length?this.GridUnitsObj.NewRow():this.GridUnitsObj.Table[0],e.PrimayColumn=null,e["Unit Name"]=this.BaseText,t=a.e.DoubleTryParse(this.RateText),t<=0&&(t=1),this.RateText=t.toString(),e["Conversion Rate"]=t,e.UnitID=null,e.BaseID=null,e.Barcode="",e.Barcode_Key=null,e.Barcodes="",0==this.GridUnitsObj.Table.length?this.GridUnitsObj.addRow(e):this.GridUnitsObj.updateRow(e)}}GetGridHeader(){let e;this.GridUnitsObj.TableColumns.push("PrimayColumn"),this.GridUnitsObj.TableColumns.push("Unit Name"),this.GridUnitsObj.TableColumns.push("Conversion Rate"),this.GridUnitsObj.TableColumns.push("UnitID"),this.GridUnitsObj.TableColumns.push("BaseID"),this.GridUnitsObj.TableColumns.push("Barcode"),this.GridUnitsObj.TableColumns.push("Barcode_Key"),this.GridUnitsObj.TableColumns.push("Barcodes");for(let s=this.dtTable.length;s<10;s++)e=this.GridUnitsObj.NewRow(),this.GridUnitsObj.addRow(e);let t=0;this.ShowBarcodeDimension=!1;let i=this.Parent.ScreenObject.Data.Tables[10].filter(e=>"BarcodeDimension"==e.Name);i.length>0&&!a.e.StringIsNullOrEmpty(i[0].Value)&&parseInt(i[0].Value.toString())>0&&(t=parseInt(i[0].Value.toString()),this.ShowBarcodeDimension=!0),this.Columns=[];let o=new C.a;o.Header=s.a.GetResource("UOM_UnitName"),o.DisplayMember="Unit Name",o.Width=70,this.Columns.push(o),o=new C.a,o.Header="Conv. Rate",o.DisplayMember="Conversion Rate",o.DataType="FLOAT",o.Width=80,this.Columns.push(o),o=new C.a,o.Header=s.a.GetResource("Barcode"),o.Width=108,this.ShowBarcodeDimension?(o.DataType="LISTBOX",o.ValueMember="Barcode_Key",o.DisplayMember="Barcode",o.CostCenterID=t,o.FilterCondition="a.NodeID NOT IN (select Barcode_Key from INV_ProductBarcode with(nolock) Group By Barcode_Key)"):o.DisplayMember="Barcode",this.Columns.push(o)}BindGridUnits(){return this.GridUnitsObj.Clear(),this.GetGridHeader(),this.dtTable}onDeleteBase(e){return Object(z.b)(this,void 0,void 0,(function*(){if(null!=e&&"Barcode"==e.toString()){if(null==this.SelectedRow)return this.DisplayMessage="Select row to add barcodes",void(this.MessageVisibility=!0);{let e=new k(this);e.AddVendorViewModel_1(this),s.a.page.ShowDialog(e,W,{ShowCenter:!0,Title:e.Title})}}else if(null!=this.Units1.SelectedValue&&"0"!=this.Units1.SelectedValue.toString()){let e=parseInt(this.Units1.SelectedValue);Logger.InfoLog("AddUOMViewModel::Entering onDeleteBase");let t=s.a.inventory.RemoveUOM(this.Units1.SelectedValue,this.PID).RetValue;if(e<0&&(this.Delete(e),this.SelectedText="",this.GridUnits.Clear(),this.MessageVisibility=!1,this.DisplayMessage="",this.BaseText="",this.RateText=""),t>0?(this.Units1.SelectedValue="0",this.SelectedText="",this.GridUnits.Clear(),this.BaseText="",this.RateText="",this.DisplayMessage=s.a.GetResource("UOM_Del"),this.MessageVisibility=!0,this.BaseVisibility=!1,this.Delete(e)):(this.DisplayMessage=s.a.GetResource("UOM_CntDel"),this.MessageVisibility=!0),e<0&&(this.DisplayMessage="",this.MessageVisibility=!1),Logger.InfoLog("AddUOMViewModel::Exiting onDeleteBase"),1==this.Parent.UOM.Items.length&&"New"==this.Parent.UOM.Items[0].Name){this.Parent.UOM.Items.Clear(),this.Parent.ScreenObject.Data.Tables[13].forEach(e=>{this.Parent.UOM.Items.push(h.d.ComboBoxItems_3(e.UnitName.toString(),e.UOMID.toString(),e.BaseID.toString()))}),this.Parent.UOM.Items.push(h.d.ComboBoxItems_2("New","-100")),this.Parent.UOM.Items.push(h.d.ComboBoxItems_2("Product-Wise","-399"));let e=this.Parent.ScreenObject.Data.Tables[10].filter(e=>"DefaultUOM"==e.Name);e.length>0&&""!=e[0].Value.toString()&&(this.Parent.UOM.SelectedValue=e[0].Value.toString())}}}))}Delete(e){if(this.Parent.LstOfBase.length>0){let t=this.Parent.LstUOM.length,i=t-1;for(let s=0;s<this.Parent.LstOfBase.length;s++)if(e.toString()==this.Parent.LstOfBase[s].BaseID){for(let s=t;s>0;s--,i--)e.toString()==this.Parent.LstUOM[i].BaseID&&this.Parent.LstUOM.RemoveAt(i);for(let e=0;e<this.Units.Items.length;e++)if(this.Units.Items[e].Value==this.Units1.SelectedValue.toString()){this.Units.Items.RemoveAt(e);break}this.Parent.LstOfBase.RemoveAt(s);break}}let t;this.Units1.Items.Clear(),this.GridUnitsObj.Clear(),this.BaseVisibility=!0,"-399"==this.Parent.UOM.SelectedValue&&(this.ButtonVisible=!1);for(let i=this.GridUnits.length;i<10;i++)t=this.GridUnitsObj.NewRow(),this.GridUnitsObj.addRow(t);this.BindBase()}onCanDeleteBase(e){return!0}onSave(){Logger.InfoLog("AddUOMViewModel::Entering onSaveUOM");try{this.MessageVisibility=!1;let e={},t="";if(a.e.IsEmpty(this.BaseText))return this.DisplayMessage=s.a.GetResource("CannotSaveBlankUOM"),void(this.MessageVisibility=!0);{if(t+="<XML>",null!=this.GridUnits&&this.GridUnits.length>0){for(let e=0;e<this.GridUnits.length;e++)a.e.StringIsNullOrEmpty(this.GridUnits[e]["Unit Name"])?a.e.StringIsNullOrEmpty(this.GridUnits[e].PrimayColumn)?t+="<Row RowNo='"+(e+1)+"' PrimaryKey='0' UName=''  ConversionRate='' MapAction='DELETE' />":t+="<Row RowNo='"+(e+1)+"' PrimaryKey='"+this.GridUnits[e].PrimayColumn.toString()+"' UName='"+this.GridUnits[e]["Unit Name"]+"'  ConversionRate='"+this.GridUnits[e]["Conversion Rate"]+"' MapAction='DELETE' />":a.e.StringIsNullOrEmpty(this.GridUnits[e].PrimayColumn)?t+="<Row RowNo='"+(e+1)+"' PrimaryKey='0' UName='"+this.GridUnits[e]["Unit Name"]+"'  ConversionRate='"+this.GridUnits[e]["Conversion Rate"]+"' MapAction='NEW' />":t+="<Row RowNo='"+(e+1)+"' PrimaryKey='"+this.GridUnits[e].PrimayColumn.toString()+"' UName='"+this.GridUnits[e]["Unit Name"]+"'  ConversionRate='"+this.GridUnits[e]["Conversion Rate"]+"' MapAction='UPDATE' />";for(let e=0;e<this.lstDeletedint.length;e++)t+='<Row MapAction="DELETE"',t+=' PrimaryKey="'+this.lstDeletedint[e]+'"/>'}else t+="<Row RowNo='1' PrimaryKey='0' UName=''  ConversionRate='' MapAction='NEW' />";t+="</XML>";let i=0;e.Address1=this.BaseText,e.Address2=a.e.StringIsNullOrEmpty(this.Units1.SelectedValue)?0:this.Units1.SelectedValue,e.Address3=t.toString(),e.IsGroup=!1,s.a.inventory.AddUOM(e,"AddUOM").subscribe(e=>{this.DisplayMessage=e.Message,this.RetValue=e.RetValue,this.MessageVisibility=!0,i=this.RetValue,i>0?(null!=this.dtTable&&this.GridUnitsObj.Clear(),this.BindBase(),this.DisplayMessage=s.a.GetResource("UOM_Saved"),this.MessageVisibility=!0,this.BaseVisibility=!1):(this.DisplayMessage=e.Message,this.MessageVisibility=!0)},e=>{alert(JSON.stringify(e)),console.log("AddUOMViewModel::Exiting OnSaveUOM"+JSON.stringify(e))}),Logger.InfoLog("AddUOMViewModel::Exiting OnSaveUOM")}}catch(e){Logger.ErrorLog("AddUOMViewModel:: OnSaveUOM"+e.stack)}}onSaveUOM(e){Logger.InfoLog("AddUOMViewModel::Entering onSaveUOM");try{"-100"==this.Parent.UOM.SelectedValue&&this.onSave()}catch(t){Logger.ErrorLog("AddUOMViewModel:: OnSaveUOM"+t.stack)}}onCanSaveUOM(e){this.Parent.UOMVisibility=!1,s.a.page.HideDialog()}onSelectionChanged(e){let t=null;this.DisplayMessage="",this.MessageVisibility=!1,Logger.InfoLog("AddUOMViewModel::Entering SelectionChanged event");try{if(null!=e){if("-100"==e.toString()?(this.GridUnitsObj.Clear(),this.BaseText="",this.RateText="",this.BaseVisibility=!0,this.BarcodeVisibility=!1):(this.BarcodeVisibility=!0,this.BaseVisibility=!0),this.ButtonVisible="-100"==e.toString(),"-100"==this.Parent.UOM.SelectedValue&&"-100"!=e.toString()){this.ButtonVisible=!0;let e=[];if(e.push(this.Units1.SelectedValue),e.push(s.a.SessionManager.UserID),e.push(s.a.SessionManager.LanguageID),null!=this.Units1.SelectedValue&&(t=s.a.inventory.getUOM2(this._ScreenID,e)),this.GridUnitsObj.Clear(),null!=t&&t.Tables.length>0&&t.Tables[0].length>0){this.BaseText=t.Tables[0][0].BaseName.toString(),this.RateText=t.Tables[0][0].Conversion.toString();for(let e=0;e<t.Tables[0].length;e++){let i=this.GridUnitsObj.NewRow();i.PrimayColumn=t.Tables[0][e].UOMID.toString(),i["Unit Name"]=t.Tables[0][e].UnitName.toString(),i["Conversion Rate"]=t.Tables[0][e].Conversion.toString(),i.UnitID=t.Tables[0][e].UNITID.toString(),i.BaseID=t.Tables[0][e].BaseID.toString(),i.Barcode="",i.Barcode_Key=null,i.Barcodes="",this.GridUnitsObj.addRow(i)}}for(let t=this.GridUnitsObj.Table.length;t<10;t++){let e=this.GridUnitsObj.NewRow();this.GridUnitsObj.addRow(e)}}if("-100"!=e.toString()&&"-399"==this.Parent.UOM.SelectedValue){if(this.ButtonVisible=!0,this.Parent.LstUOM.length>0){this.GridUnitsObj.Clear();for(let e=0;e<this.Parent.LstUOM.length;e++)if(this.Parent.LstUOM[e].BaseID==this.Units1.SelectedValue.toString()){let t=this.GridUnitsObj.NewRow();t.PrimayColumn=parseInt(this.Parent.LstUOM[e].MapAction),t["Unit Name"]=this.Parent.LstUOM[e].UnitName,t["Conversion Rate"]=parseFloat(this.Parent.LstUOM[e].UnitConverstion),t.UnitID=parseInt(this.Parent.LstUOM[e].UnitID),t.BaseID=parseInt(this.Units1.SelectedValue),this.GridUnitsObj.addRow(t),0==this.BaseText.length&&(this.BaseText=this.Parent.LstUOM[e].BaseName),0==this.RateText.length&&(this.RateText=this.Parent.LstUOM[e].UnitConverstion)}}for(let e=this.GridUnits.length;e<10;e++){let e=this.GridUnitsObj.NewRow();this.GridUnitsObj.addRow(e)}}else for(let e=this.GridUnits.length;e<10;e++){let e=this.GridUnitsObj.NewRow();this.GridUnitsObj.addRow(e)}}}catch(i){Logger.ErrorLog("AddUOMViewModel:: onSelectionChanged"+i.stack)}Logger.InfoLog("AddUOMViewModel::Exiting onSelectionChanged")}onCanSelectionChanged(e){return!0}worker_DoWork(e,t){Logger.InfoLog("AddUOMViewModel::Entering worker_DoWork"),Logger.InfoLog("AddUOMViewModel::Leaving worker_DoWork")}BindBase(){if(null!=this.Parent&&"-399"==this.Parent.UOM.SelectedValue){this.Units1.Items.Clear();for(let e=0;e<this.Parent.LstOfBase.length;e++)this.Units1.Items.push(h.d.ComboBoxItems_2(this.Parent.LstOfBase[e].BaseName,this.Parent.LstOfBase[e].BaseID));this.Units1.Items.push(h.d.ComboBoxItems_2("New","-100")),this.Units1.SelectedValue="-100",this.BaseText="",this.RateText="",this.BaseVisibility=!0}null!=this.Parent&&"-100"==this.Parent.UOM.SelectedValue&&(this.Units1.Items.Clear(),this._ScreenData=this.BuildControls(),this.BaseText="",this.RateText="",null!=this._ScreenData&&this._ScreenData.Tables[0].forEach(e=>{this.Units1.Items.push(h.d.ComboBoxItems_2(e[Object.keys(e)[1]].toString(),e[Object.keys(e)[0]].toString()))}),this.Units1.Items.push(h.d.ComboBoxItems_2("New","-100")))}worker_RunWorkerCompleted(e,t){}get Units1(){return this.Units}set Units1(e){e!=this.Units&&(this.Units=e)}get BaseText(){return this.BaseTextObj.Text}set BaseText(e){e!=this.BaseTextObj.Text&&(this.BaseTextObj.Text=e)}get RateText(){return this.RateTextObj.Text}set RateText(e){e!=this.RateTextObj.Text&&(this.RateTextObj.Text=e)}get BaseVisibility(){return this._BaseVisibility}set BaseVisibility(e){e!=this._BaseVisibility&&(this._BaseVisibility=e,this._BaseVisibility&&(this.DetailsVisibility=!1))}get DetailsVisibility(){return this._DetailsVisibility}set DetailsVisibility(e){e!=this._DetailsVisibility&&(e&&(this._BaseVisibility=!1),this._DetailsVisibility=e)}get angularGrid(){return this.GridUnitsObj.angularGrid}get GridUnits(){return this.GridUnitsObj.Table}get Columns(){return this.GridUnitsObj.Columns}set Columns(e){this.GridUnitsObj.Columns=e}get GridUnitsColumns(){return this.GridUnitsObj.TableColumns}get SelectedRow(){return this.GridUnitsObj.SelectedItem}set SelectedRow(e){this.GridUnitsObj.SelectedItem=e}BuildControls(){Logger.InfoLog("AddUOMViewModel::Entering BuildControls");try{let e=[];e.push(0),e.push(s.a.SessionManager.UserID),e.push(s.a.SessionManager.LanguageID);let t=s.a.inventory.getUOM(this.PID,!0,this._ScreenID,e);return null!=t&&null!=t&&t.Tables[0].length>0&&t.Tables.length>0?t:null}catch(e){return Logger.ErrorLog("AddUOMViewModel:: BuildControls"+e.stack),null}}BindGrid(){let e,t=[];if(t.push(this.Units1.SelectedValue),t.push(s.a.SessionManager.UserID),t.push(s.a.SessionManager.LanguageID),null!=this.Units1.SelectedValue&&(e=s.a.inventory.getUOM2(this._ScreenID,t)),this.GridUnitsObj.Clear(),null!=e&&e.Tables.length>0&&e.Tables[0].length>0){this.BaseText=e.Tables[0][0].BaseName.toString(),this.RateText=e.Tables[0][0].Conversion.toString();for(let t=0;t<e.Tables[0].length;t++){let i=this.GridUnitsObj.NewRow();i.PrimayColumn=e.Tables[0][t].UOMID.toString(),i["Unit Name"]=e.Tables[0][t].UnitName.toString(),i["Conversion Rate"]=e.Tables[0][t].Conversion.toString(),i.UnitID=e.Tables[0][t].UnitID.toString(),i.BaseID=e.Tables[0][t].BaseID.toString(),this.GridUnitsObj.addRow(i)}}for(let i=this.GridUnitsObj.Table.length;i<10;i++){let e=this.GridUnitsObj.NewRow();e.SNO=i+1,this.GridUnitsObj.addRow(e)}}}var J=i("NXvD"),$=i("wJuo"),ee=i("x68t"),te=i("4k0m"),ie=i("++IR");function se(e,t){if(1&e&&(y.Zb(0,"div",2),y.Wc(1,"\n            "),y.Vb(2,3),y.Wc(3,"\n        "),y.Yb()),2&e){const e=y.lc();y.Db(2),y.tc("obj",e.obj.BaseTextObj)("group",e.obj.form)}}function ae(e,t){if(1&e){const e=y.ac();y.Zb(0,"div",10),y.Wc(1,"\n    "),y.Zb(2,"div"),y.Wc(3,"\n        "),y.Zb(4,"button",11),y.hc("click",(function(){return y.Ic(e),y.lc().obj.onSaveUOM("Save")})),y.Wc(5),y.mc(6,"translate"),y.Yb(),y.Wc(7,"\n        "),y.Zb(8,"button",6),y.hc("click",(function(){return y.Ic(e),y.lc().obj.onCanSaveUOM("Cancel")})),y.Ub(9,"i",12),y.Wc(10),y.mc(11,"translate"),y.Yb(),y.Wc(12,"\n    "),y.Yb(),y.Wc(13,"      \n  "),y.Yb()}2&e&&(y.Db(5),y.Xc(y.nc(6,2,"Ok")),y.Db(5),y.Xc(y.nc(11,4,"Cancel")))}let oe=(()=>{class e{constructor(){}ngOnInit(){console.log("product wise uom"),console.log(this.obj.BaseVisibility)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=y.Nb({type:e,selectors:[["app-product-wise-uom"]],decls:35,vars:11,consts:[[1,"master-screen",3,"formGroup"],[1,"PACTHeaderFields","dialogSubBody"],[1,"form-group","col-xl-12","col-md-12","col-sm-12","col-xs-12","PACTControl"],["FieldDirective","",3,"obj","group"],[2,"float","right","font-weight","600","color","#8477f3","text-decoration","underline",3,"click"],["class","form-group col-xl-12  col-md-12 col-sm-12 col-xs-12 PACTControl",4,"ngIf"],[1,"secondary-btn-wicon",3,"click"],["id","divBarcode",1,"form-group","col-xl-12","col-xs-12","PACTControl"],[2,"width","100%",3,"obj"],["class","Pactdailogfooter",4,"ngIf"],[1,"Pactdailogfooter"],[1,"primary-btn-wicon",3,"click"],[1,"fa-light","fa-rectangle-xmark"]],template:function(e,t){1&e&&(y.Wc(0,"\n"),y.Zb(1,"div",0),y.Wc(2,"\n    "),y.Zb(3,"div",1),y.Wc(4,"\n        "),y.Zb(5,"div",2),y.Wc(6,"\n            "),y.Vb(7,3),y.Wc(8,"\n            "),y.Zb(9,"h6",4),y.hc("click",(function(){return t.obj.onDeleteBase(null)})),y.Wc(10,"Del"),y.Yb(),y.Wc(11,"\n        "),y.Yb(),y.Wc(12,"\n        "),y.Uc(13,se,4,2,"div",5),y.Wc(14,"\n        "),y.Zb(15,"div",2),y.Wc(16,"\n            "),y.Vb(17,3),y.Wc(18,"\n        "),y.Yb(),y.Wc(19,"\n        "),y.Zb(20,"div",2),y.Wc(21,"\n            "),y.Zb(22,"button",6),y.hc("click",(function(){return t.obj.onDeleteBase("Barcode")})),y.Wc(23),y.mc(24,"translate"),y.Yb(),y.Wc(25,"\n        "),y.Yb(),y.Wc(26," \n      "),y.Zb(27,"div",7),y.Wc(28,"\n        "),y.Ub(29,"app-PactGridView",8),y.Wc(30,"\n      "),y.Yb(),y.Wc(31," \n  "),y.Yb(),y.Wc(32,"\n  "),y.Uc(33,ae,14,6,"div",9),y.Wc(34,"\n"),y.Yb()),2&e&&(y.Db(1),y.tc("formGroup",t.obj.form),y.Db(6),y.tc("obj",t.obj.Units1)("group",t.obj.form),y.Db(6),y.tc("ngIf",t.obj.BaseVisibility),y.Db(4),y.tc("obj",t.obj.RateTextObj)("group",t.obj.form),y.Db(6),y.Xc(y.nc(24,9,"Multiple Barcodes")),y.Db(6),y.tc("obj",t.obj.GridUnitsObj),y.Db(4),y.tc("ngIf",t.obj.ButtonVisible))},directives:[P.t,P.k,O.a,M.t,U.a],pipes:[f.d],encapsulation:2}),e})();var re=i("LSMh"),ne=i("hIrt"),le=i("ddhY"),he=i("V7Sd"),de=i("pcVU"),ce=i("J5xz");class ue extends r.b{constructor(e,t,i,a){super(),this.FileID=0,this.IsPhotoDelete=!1,this.IsImageSaved=!1,this.ParentFeatureID=0,this.PNodeID=0,this.ScreenObject=new n.a,this.oProduct=new de.a,this.DropFile=new K.b,this.FileExtension="",this.FileDescription="",this.Counter=1,this.ImgRowSpan="",this.ImageWidth="",this.ImageHeight="",this.ImgColumn="",this.ImgColumnSpan="",this.ButtonSave=new c.a,this.ButtonQuery=new c.a,this.ButtonCopy=new c.a,this.ParentId=0,this.NextPrevProductID=0,this.LinkColumnCostcenterID=-1,this.IsPhotoChanged=!1,this.InheritImage=!1,this.InheritGrpImage=!1,this.InheritDimImageID=-1,this.PrevTab="",this.dtProductWise=null,this.TempID=0,this.DimFields=null,this.isCopy=!1,this.ButtonEnable=!1,this.NextPreviousVisibility=!1,this.PhotoTextVisibility=!1,this.UploadVisibility=!1,this.DeleteVisibility=!1,this.Enable="",this.ActualFileName="",this.ThumbnailPhoto="",this.ProductPhoto=null,this.ContactExpanded=!1,this.VendorsExpanded=!1,this.IsBaseUpdated=!1,this.SubstitutesExpanded=!1,this.CCRatesExpanded=!1,this.PartyRateExpanded=!1,this.TaxExpanded=!1,this.DiscountExpanded=!1,this.SchemesExpanded=!1,this.AttachmentExpanded=!1,this.NoteExpanded=!1,this.DetailsVisibility=!1,this._NoteVisibility=!1,this._AttachmentVisibility=!1,this.UOMVisibility=!1,this.LstUOM=new Array,this.LstOfBase=new Array,this.AttachmentVisibility=!1,this.SubstituteVisibility=!1,this.CCMapVisibility=!1,this.ViewCCMapping=null,this.VendorVisibility=!1,this.RetValue=0,this._ProductID=0,this.DialogResult=!1,this.ProductName=new l.d(262),this.ProductCode=new l.a(261),this.NameSameasCode=!1,this.AutoGenerateName=!1,this.AliasName=new l.d(263),this.ProductLength=new l.d(601),this.ProductWidth=new l.d(602),this.ProductHeight=new l.d(603),this.ProductVolume=new l.d(604),this.ProductWeight=new l.d(605),this.ProductWastage=new l.d(584),this.ProductPacking=new h.e(600),this.ProductBillOfEntry=new h.e(587),this.ReorderPolicy=new h.e(588),this.MaxInventoryLevel=new l.d(589),this.ReorderMinOrderQty=new l.d(590),this.ReorderMaxOrderQty=new l.d(591),this.ReorderOrderMultiple=new l.d(592),this.PlanningMethod=new h.e(593),this.ProcurementMethod=new h.e(594),this.LeadTime=new l.d(597),this.SafetyStock=new l.d(598),this.ProductBOM=new d.b(599),this.PurchaseBinRule=new h.e(585),this.SalesBinRule=new h.e(586),this.ProductTypes=new h.e(264),this.ProductGroups=new d.b(281),this.ProductStatuses=new h.e(266),this.ValuationMethods=new h.e(265),this.QtyAdjustment=new h.e(274),this.BinWise=new h.e(275),this.AssetGroupVisible=!1,this.AssetGroup=new d.b(146),this.UOM=new h.h(268),this.PurchaseUOM=new h.e(260),this.ManufacturerBarcode=new h.e(50392),this.BarcodeLayoutID=new h.e(27302),this.SalesAccount=new d.a(270),this.PurchaseAccount=new d.a(271),this.COGSAccount=new d.a(272),this.ClosingStockAccount=new d.a(273),this.PurchaseRate=new l.d(22820),this.PurchaseRateA=new l.d(22786),this.PurchaseRateB=new l.d(22787),this.PurchaseRateC=new l.d(22788),this.PurchaseRateD=new l.d(22789),this.PurchaseRateE=new l.d(22790),this.PurchaseRateF=new l.d(22791),this.PurchaseRateG=new l.d(22792),this.SellingRate=new l.d(22821),this.SellingRateA=new l.d(22793),this.SellingRateB=new l.d(22794),this.SellingRateC=new l.d(22795),this.SellingRateD=new l.d(22796),this.SellingRateE=new l.d(22797),this.SellingRateF=new l.d(22798),this.SellingRateG=new l.d(22799),this.ReorderLevel=new l.d(276),this.ReorderQty=new l.f(277),this.ReorderTrigger=new l.f(11496),this.LotWise=new h.e(267),this.Barcode=new l.d(280),this.Currency=new d.b(269),this.Description=new l.d(282),this.Packing=new l.d(279),this.ShelfLife=new l.d(278),this.PreExpiryDays=new l.d(53585),this.MaxTolerancePer=new l.d(53586),this.MaxToleranceVal=new l.d(53587),this.MinTolerancePer=new l.d(53726),this.MinToleranceVal=new l.d(53727),this.CreditDays=new l.d(53588),this.Category=new d.b(284),this.Department=new d.b(285),this.KitSize=new l.d(583),this.SerialNumber=new l.d(582),this.ProductWeightable=new h.e(581),this.AttributesTab=!1,this.SerialTab=!1,this.KitTab=!1,this.PriceChart=null,this.TaxChart=null,this.Linkedcc=new d.b(0),this.ds=null,this.ImgCol=0,this.ImgHeight=0,this.ImgRow=0,this.IsAttachmentMandatory=!1,this.ImageView=null,this.ClassName="AddProductScreenViewModel",this.ScreenObject.CustomTab.OnTabChange.Subscribe(this,"onTabSelectionChanged"),0==e?s.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=s.a.SessionManager.IsActionAssigned(3,"Create"):this.ButtonSave.Enable=s.a.SessionManager.IsActionAssigned(3,"Create"):(this.ScreenObject.IsEdit=!0,s.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=s.a.SessionManager.IsActionAssigned(3,"Update"):this.ButtonSave.Enable=s.a.SessionManager.IsActionAssigned(3,"Update")),s.a.SessionManager.HideUnathorizedAccess?this.ButtonCopy.Visible=s.a.SessionManager.IsActionAssigned(3,"Copy"):this.ButtonCopy.Enable=s.a.SessionManager.IsActionAssigned(3,"Copy"),s.a.SessionManager.HideUnathorizedAccess?this.ButtonQuery.Visible=s.a.SessionManager.IsActionAssigned(3,"Query"):this.ButtonQuery.Enable=s.a.SessionManager.IsActionAssigned(3,"Query"),Logger.InfoLog("AddProductViewModel::Entering AddProductViewModel With ProductID="+e+",ScreenName="+t+",PID="+i),this.DetailsVisibility=!0,this.ScreenName=t,this.CostCenterID=3,this.oProduct.ProductID=e,this.oProduct.IsGroup=a,this.RefreshTitle(),this.ParentId=i,this.ViewContacts=new u.a(this),this.ViewNotes=new S.a(this,s.a.SessionManager,s.a.admin),this.ViewAttachments=new m.ViewAttachmentViewModel(this,s.a.SessionManager,s.a.admin),this.ProductAttributes=new Q(this),this.ProductSerialization=new E(this),this.ViewBins=new x(this),this.ProductTypes.SelectionChangedCommand.Subscribe(this,"OnProductTypeSelectionChanged"),this.ViewVendors=new F(this),this.ViewCCMapping=new b.a(this),this.ViewCCMapping.ViewCCMappingViewModel_1(this,3,this.ProductID),this.StatusAssignGrid=new J.a,this.ProductStatuses.LblClick=new K.b,this.ProductStatuses.LblClick.Subscribe(this,"OnSaveProduct","ShowStatusAssignGrid"),this.MessageVisibility=!1,this.UserID="1",this.ProductCode.TextChangedCommand.Subscribe(this,"OnTextChanged_string"),this.ProductName.LostFocusCommand.Subscribe(this,"OnNameLostFocus"),this.UOM.SelectionChangedCommand.Subscribe(this,"onUOMSelectedChanged"),this.AttributesTab=!1,this.SerialTab=!1,this.KitTab=!1,this.DropFile.Subscribe(this,"OnDropPhoto"),this.IsPhotoChanged=!1,this.PhotoTextVisibility=!0,this.ProductPhoto="",this.ActualFileName="",this.ThumbnailPhoto="",this.DetailsVisibility=!0,this.worker_DoWork(i),this.ProductCode.Enable?this.ProductCode.SetFocus=!0:this.ProductName.Enable&&(this.ProductName.SetFocus=!0),this.DisplayName=this.Title,this.ProductGroups.SelectionChangedCommand.Subscribe(this,"OnGroupSelectionChanged"),Logger.InfoLog("AddProductViewModel::Exiting AddProductViewModel")}onUOMSelectedChanged(e){if(this.TempID!=parseInt(this.UOM.SelectedValue)){if("0"==this.UOM.SelectedValue||"-399"!=this.UOM.SelectedValue&&"-100"!=this.UOM.SelectedValue)this.UOMVisibility=!1,this.PurchaseUOM.Visible&&this.FillPurchaseUom();else{if(this.onShowUOMControlBar(e),this.AddEditUOM.GridUnitsObj.Clear(),0!=this.ProductID||this.isCopy)if(this.AddEditUOM.BindBase(),null!=this.dtProductWise&&"-399"==this.UOM.SelectedValue)this.LoadUnitsProductWise(this.dtProductWise);else for(let e=this.AddEditUOM.GridUnits.length;e<10;e++){let e=this.AddEditUOM.GridUnitsObj.NewRow();this.AddEditUOM.GridUnitsObj.addRow(e)}else{for(let e=this.AddEditUOM.GridUnits.length;e<10;e++){let e=this.AddEditUOM.GridUnitsObj.NewRow();this.AddEditUOM.GridUnitsObj.addRow(e)}this.AddEditUOM.BindBase()}this.AddEditUOM.ButtonVisible="-399"!=this.UOM.SelectedValue}this.TempID=parseInt(this.UOM.SelectedValue),this.UOMVisibility&&s.a.page.ShowDialog(this.AddEditUOM,oe,{Title:s.a.GetResource("UOM_Productwise")})}}FillPurchaseUom(){var e=this.UOM.GetselectedItem();null!=e&&(this.PurchaseUOM.Items.Clear(),s.a.empService.GetQueryData(0,"GetUOMS",e.Parent,"","").Tables[0].forEach(e=>{this.PurchaseUOM.Items.push(h.d.ComboBoxItems_2(e.UnitName.toString(),e.UOMID.toString()))}))}onShowUOMControlBar(e){this.NoteVisibility=!1,this.ContactVisibility=!1,this.CCMapVisibility=!1,this.VendorVisibility=!1,this.SubstituteVisibility=!1,this.AttachmentVisibility=!1,this.UOMVisibility=!0}onTabSelectionChanged(e){if(null!=this.ScreenObject.CustomTab.SelectedTab){if(this.PrevTab==this.ScreenObject.CustomTab.SelectedTab.Name)return;this.PrevTab=this.ScreenObject.CustomTab.SelectedTab.Name,"Notes"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.AttachmentVisibility=!1,this.ContactVisibility=!1,this.CCMapVisibility=!1,this.VendorVisibility=!1,this.SubstituteVisibility=!1,this.UOMVisibility=!1):"Attachments"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.NoteVisibility=!1,this.ContactVisibility=!1,this.CCMapVisibility=!1,this.VendorVisibility=!1,this.SubstituteVisibility=!1,this.UOMVisibility=!1,this.ViewAttachments=new m.ViewAttachmentViewModel(this,s.a.SessionManager,s.a.admin)):"Contacts"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.CCMapVisibility=!1,this.VendorVisibility=!1,this.SubstituteVisibility=!1,this.UOMVisibility=!1,this.ViewContacts.OnShowNewContact(null)):"Assign"==this.ScreenObject.CustomTab.SelectedTab.Name||"Production Process"==this.ScreenObject.CustomTab.SelectedTab.Name?s.a.SessionManager.IsActionAssigned(3,"Map")?(this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.ContactVisibility=!1,this.VendorVisibility=!1,this.SubstituteVisibility=!1,this.UOMVisibility=!1,this.ViewCCMapping.OnShowCC(null)):(this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.ContactVisibility=!1,this.CCMapVisibility=!1,this.SubstituteVisibility=!1,this.VendorVisibility=!1,this.UOMVisibility=!1):"General"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.ContactVisibility=!1,this.CCMapVisibility=!1,this.SubstituteVisibility=!1,this.VendorVisibility=!1,this.UOMVisibility="-399"==this.UOM.SelectedValue||"-100"==this.UOM.SelectedValue):"Substitutes"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.ContactVisibility=!1,this.VendorVisibility=!1,this.CCMapVisibility=!1,this.ViewSubstitutes.OnShowNewSubstitute("Manage")):"Vendors"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.ContactVisibility=!1,this.SubstituteVisibility=!1,this.CCMapVisibility=!1,this.ViewVendors.OnShowNewVendor(null)):"Price Chart"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.ContactVisibility=!1,this.CCMapVisibility=!1,this.SubstituteVisibility=!1,this.VendorVisibility=!1,this.UOMVisibility=!1,this.LoadPriceChart()):"Tax Chart"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.ContactVisibility=!1,this.CCMapVisibility=!1,this.SubstituteVisibility=!1,this.VendorVisibility=!1,this.UOMVisibility=!1,this.LoadTaxChart()):(this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.ContactVisibility=!1,this.CCMapVisibility=!1,this.SubstituteVisibility=!1,this.VendorVisibility=!1,this.UOMVisibility=!1)}}LoadPriceChart(){null==this.PriceChart?0!=this.ProductID&&(this.PriceChart=new p.AddPriceChartNewViewModel("PRODUCT_SEARCH",-100,0),this.PriceChart.ColumnSpan="4",this.PriceChart.PriceGrid.MaxHeight=200,this.PriceChart.LoadProfileData(-1,0,new Date,""," AND T.ProductID="+this.ProductID,null),this.PriceChart.FilterVisibility=!1,this.PriceChart.RightPanelVisibility=!1,this.ScreenObject.CustomTab.SelectedTab.Fields.push(this.PriceChart)):0==this.ProductID?this.PriceChart.PriceGrid.Table.Clear():this.PriceChart.LoadProfileData(-1,0,new Date,""," AND T.ProductID="+this.ProductID,null)}LoadTaxChart(){null==this.TaxChart?0!=this.ProductID&&(this.TaxChart=new ce.AddTaxChartNewViewModel,this.TaxChart.AddTaxChartNewViewModel("PRODUCT_SEARCH",-100),this.TaxChart.ColumnSpan="4",this.TaxChart.TaxGrid.MaxHeight=200,this.TaxChart.LoadProfileData(-1,0,new Date,""," AND T.ProductID="+this.ProductID),this.TaxChart.FilterVisibility=!1,this.TaxChart.RightPanelVisibility=!1,this.ScreenObject.CustomTab.SelectedTab.Fields.push(this.TaxChart)):0==this.ProductID?this.TaxChart.TaxGrid.Table.Clear():this.TaxChart.LoadProfileData(-1,0,new Date,""," AND T.ProductID="+this.ProductID)}onTextChanged(e){let t=0,i=0,o=0;t=a.e.DoubleTryParse(this.ProductLength.Text),i=a.e.DoubleTryParse(this.ProductWidth.Text),o=a.e.DoubleTryParse(this.ProductHeight.Text),this.ProductVolume.Text=s.a.SessionManager.Round(t*i*o,this.ProductVolume.DecimalPoints)}onLostFocus(e){if(alert("check-onLostFocus- AddProductScreen"),"PactTextBoxData"==e.GetType().Name){let t=0;t=a.e.DoubleTryParse(e.Text),t>0&&(e.Text=s.a.SessionManager.Round(t,e.DecimalPoints))}this.ScreenObject.onTextBoxLostFocus(e)}AddProductScreenViewModel(){}GetRecords(e){this.ButtonSave.Enable||(this.ButtonSave.Enable=!0);let t=0,i=!1;"NEXT"==e.toString().toUpperCase()?i=!0:"PREVIOUS"==e.toString().toUpperCase()&&(i=!1);let a=s.a.common.GetNextPreviousRecords(3,this.NextPrevProductID,i,0,this.oProduct.IsGroup?1:0);null!=a&&a.Tables.length>0&&a.Tables[0].length>0&&(t=parseInt(a.Tables[0][0][Object.keys(a.Tables[0][0])[0]]),0!=t&&(this.ImageHeight=(45*parseInt(this.ImgRowSpan)).toString(),this.NextPrevProductID=t,this.oProduct.ProductID=t,this.oProduct.IsGroup=Object(o.j)(a.Tables[0][0][1]),this.RefreshTitle(),this.LoadEditData(),this.PNodeID=t,this.RefreshControls(),"Price Chart"==this.ScreenObject.CustomTab.SelectedTab.Name?this.LoadPriceChart():"Tax Chart"==this.ScreenObject.CustomTab.SelectedTab.Name&&this.LoadTaxChart()))}RefreshControls(){this.NoteVisibility?this.ViewNotes=new S.a(this,s.a.SessionManager,s.a.admin):this.AttachmentVisibility?this.ViewAttachments=new m.ViewAttachmentViewModel(this,s.a.SessionManager,s.a.admin):this.ContactVisibility?this.ViewContacts.OnShowNewContact(null):this.CCMapVisibility&&this.ViewCCMapping.OnShowCC(null)}get ContactVisibility(){return this._ContactVisibility}set ContactVisibility(e){e!=this._ContactVisibility&&(this._ContactVisibility=e,this._ContactVisibility?(this.DetailsVisibility=!1,this.NoteVisibility=!1,this.AttachmentVisibility=!1):this.NoteVisibility||this.AttachmentVisibility||(this.DetailsVisibility=!0))}get NoteVisibility(){return this._NoteVisibility}set NoteVisibility(e){e&&this.HideControls(),this._NoteVisibility=e}get ProductID(){return this.oProduct.ProductID}set ProductID(e){this._ProductID=e,this.oProduct.ProductID=e}OnShowNote(){Logger.InfoLog("AddProductViewModel::Entering OnShowNote"),Logger.InfoLog("AddProductViewModel::Exiting OnShowNote")}get Title(){return this._ScreenName}set Title(e){e!=this._ScreenName&&(this._ScreenName=e)}get Vendor(){return this._Vendor}set Vendor(e){e!=this._Vendor&&(this._Vendor=e)}OnlinkccChanged(e){if(this.PopulateProductName(e),null!=e&&e instanceof d.b&&e.SelectedValue>1){e.CCID==this.InheritDimImageID&&this.OnLoadImage("Dimension",e.SelectedValue);let t=this.oProduct.GetLinkedProducts(e.CCID,e.SelectedValue);null!=t&&null!=t&&t.Tables.length>0&&(this.ProductLink.ModGrid.Visible=!1,this.ProductLink.LoadBundels(t.Tables[0]))}else this.ProductLink.LoadBundels([])}worker_DoWork(e){this.DisplayName=s.a.GetResource("Loading"),this.ScreenObject.LoadScreen_1(this,3,this.oProduct.IsGroup),this.AssetGroupVisible=this.AssetGroup.Visible,this.ViewSubstitutes=new G(this),this.AddEditUOM=new q(this.ProductID,this),this.ProductTestcases=new Y(this),this.ProductKit=new D(this,1),this.ProductSpecs=new D(this,2),this.ProductLink=new D(this,0);let t=0,i=this.ScreenObject.Data.Tables[10].filter(e=>"LinkedProductDimension"==e.Name);null!=i&&i.length>0&&""!=i[0].Value.toString()&&parseInt(i[0].Value.toString())>0&&(t=parseInt(i[0].Value.toString()));let r=0;i=this.ScreenObject.Data.Tables[10].filter(e=>"BinsDimension"==e.Name),null!=i&&i.length>0&&""!=i[0].Value.toString()&&parseInt(i[0].Value.toString())>0&&(r=parseInt(i[0].Value.toString())),i=this.ScreenObject.Data.Tables[10].filter(e=>"PrDimWiseFields"==e.Name),i.length>0&&!a.e.IsEmpty(i[0].Value)&&(this.DimFields=i[0].Value.toString().split(";")),i=this.ScreenObject.Data.Tables[10].filter(e=>"DefaultProductValuation"==e.Name),null!=i&&i.length>0&&null!=i[0].Value&&("FIFO"==i[0].Value.toString()?this.ValuationMethods.SelectedValue="1":"LIFO"==i[0].Value.toString()?this.ValuationMethods.SelectedValue="2":"Weighted Average"==i[0].Value.toString()&&(this.ValuationMethods.SelectedValue="3")),i=this.ScreenObject.Data.Tables[10].filter(e=>e.Name==(this.oProduct.IsGroup?"GroupNameSameasCode":"NameSameasCode")),null!=i&&i.length>0&&Object(o.j)(i[0].Value)?(this.NameSameasCode=!0,this.ProductName.Enable=!1):(this.NameSameasCode=!1,this.ProductName.Enable=!0),null!=this.ScreenObject.Data&&this.ScreenObject.Data.Tables.length>15&&this.ScreenObject.Data.Columns[15].Contains("IsParentCodeInherited")&&this.ScreenObject.Data.Tables[15].length>0&&this.ScreenObject.InitAutoCode(this.ScreenObject.Data.Tables[15],this.oProduct.IsGroup),i=this.ScreenObject.Data.Tables[10].filter(e=>"DefaultImage"==e.Name),i.length>0&&(this.InheritImage=Object(o.j)(i[0].Value)),i=this.ScreenObject.Data.Tables[10].filter(e=>"InheritGroupImage"==e.Name),null!=i&&i.length>0&&(this.InheritGrpImage=Object(o.j)(i[0].Value)),this.InheritImage?(this.UploadVisibility=!0,this.DeleteVisibility=!0,this.PhotoTextVisibility=!0):(this.UploadVisibility=!1,this.DeleteVisibility=!1,this.PhotoTextVisibility=!1),i=this.ScreenObject.Data.Tables[10].filter(e=>"InheritDimensionImage"==e.Name),null!=i&&i.length>0&&(this.InheritDimImageID=""!=i[0].Value.toString()?parseInt(i[0].Value):-1),null!=this.ScreenObject.Data&&null!=this.ScreenObject.Data&&this.ScreenObject.Data.Tables.length>14&&(this.ImageView=this.ScreenObject.Data.Tables[14]),this.ScreenObject.CustomTab.Pages.forEach(e=>{if("General"==e.Name)e.Fields.forEach(e=>{switch(e.DBColumnName){case"CurrencyID":this.ScreenObject.StaticFields.Contains(this.Currency)&&this.ScreenObject.StaticFields.Remove(this.Currency),this.Currency=e;break;case"ShelfLife":this.ScreenObject.StaticFields.Contains(this.ShelfLife)&&this.ScreenObject.StaticFields.Remove(this.ShelfLife),this.ShelfLife=e;break;case"PreexpiryDays":this.ScreenObject.StaticFields.Contains(this.PreExpiryDays)&&this.ScreenObject.StaticFields.Remove(this.PreExpiryDays),this.PreExpiryDays=e;break;case"MaxTolerancePer":this.ScreenObject.StaticFields.Contains(this.MaxTolerancePer)&&this.ScreenObject.StaticFields.Remove(this.MaxTolerancePer),this.MaxTolerancePer=e;break;case"MaxToleranceVal":this.ScreenObject.StaticFields.Contains(this.MaxToleranceVal)&&this.ScreenObject.StaticFields.Remove(this.MaxToleranceVal),this.MaxToleranceVal=e;break;case"MinTolerancePer":this.ScreenObject.StaticFields.Contains(this.MinTolerancePer)&&this.ScreenObject.StaticFields.Remove(this.MinTolerancePer),this.MinTolerancePer=e;break;case"MinToleranceVal":this.ScreenObject.StaticFields.Contains(this.MinToleranceVal)&&this.ScreenObject.StaticFields.Remove(this.MinToleranceVal),this.MinToleranceVal=e;break;case"CreditDays":this.ScreenObject.StaticFields.Contains(this.CreditDays)&&this.ScreenObject.StaticFields.Remove(this.CreditDays),this.CreditDays=e;break;case"Packing":this.ScreenObject.StaticFields.Contains(this.Packing)&&this.ScreenObject.StaticFields.Remove(this.Packing),this.Packing=e;break;case"BarcodeID":this.ScreenObject.StaticFields.Contains(this.Barcode)&&this.ScreenObject.StaticFields.Remove(this.Barcode),this.Barcode=e;break;case"CategoryID":this.ScreenObject.StaticFields.Contains(this.Category)&&this.ScreenObject.StaticFields.Remove(this.Category),this.Category=e,this.Category.SelectionChangedCommand.Subscribe(this,"PopulateProductName"),this.ScreenObject.StaticFields.Contains(this.Category)||this.ScreenObject.StaticFields.push(this.Category);break;case"DepartmentID":this.ScreenObject.StaticFields.Contains(this.Department)&&this.ScreenObject.StaticFields.Remove(this.Department),this.Department=e,this.Department.SelectionChangedCommand.Subscribe(this,"PopulateProductName"),this.ScreenObject.StaticFields.Contains(this.Department)||this.ScreenObject.StaticFields.push(this.Department);break;case"ManufacturerBarcode":this.ScreenObject.StaticFields.Contains(this.ManufacturerBarcode)&&this.ScreenObject.StaticFields.Remove(this.ManufacturerBarcode),this.ManufacturerBarcode=e;break;case"BarcodeLayoutID":this.ScreenObject.StaticFields.Contains(this.BarcodeLayoutID)&&this.ScreenObject.StaticFields.Remove(this.BarcodeLayoutID),this.BarcodeLayoutID=e;break;case"SerialNumber":this.ScreenObject.StaticFields.Contains(this.SerialNumber)&&this.ScreenObject.StaticFields.Remove(this.SerialNumber),this.SerialNumber=e;break;case"IsWeightable":this.ScreenObject.StaticFields.Contains(this.ProductWeightable)&&this.ScreenObject.StaticFields.Remove(this.ProductWeightable),this.ProductWeightable=e,this.ProductWeightable.Items.push(h.d.ComboBoxItems_2("No","0")),this.ProductWeightable.Items.push(h.d.ComboBoxItems_2("Yes","1")),this.ProductWeightable.SelectedValue="0"}});else if("Accounts"==e.Name)e.Fields.forEach(e=>{if(e instanceof d.a)switch(e.DBColumnName){case"SalesAccountID":this.ScreenObject.StaticFields.Contains(this.SalesAccount)&&this.ScreenObject.StaticFields.Remove(this.SalesAccount),this.SalesAccount=e;break;case"PurchaseAccountID":this.ScreenObject.StaticFields.Contains(this.PurchaseAccount)&&this.ScreenObject.StaticFields.Remove(this.PurchaseAccount),this.PurchaseAccount=e,this.PurchaseAccount.HistoryCCID=this.PurchaseAccount.DBColumnID;break;case"COGSAccountID":this.ScreenObject.StaticFields.Contains(this.COGSAccount)&&this.ScreenObject.StaticFields.Remove(this.COGSAccount),this.COGSAccount=e;break;case"ClosingStockAccountID":this.ScreenObject.StaticFields.Contains(this.ClosingStockAccount)&&this.ScreenObject.StaticFields.Remove(this.ClosingStockAccount),this.ClosingStockAccount=e}});else if("SellingRate"==e.Name)e.Fields.forEach(e=>{switch(e.DBColumnName){case"SellingRateA":this.ScreenObject.StaticFields.Contains(this.SellingRateA)&&this.ScreenObject.StaticFields.Remove(this.SellingRateA),this.SellingRateA=e;break;case"SellingRateB":this.ScreenObject.StaticFields.Contains(this.SellingRateB)&&this.ScreenObject.StaticFields.Remove(this.SellingRateB),this.SellingRateB=e;break;case"SellingRateC":this.ScreenObject.StaticFields.Contains(this.SellingRateC)&&this.ScreenObject.StaticFields.Remove(this.SellingRateC),this.SellingRateC=e;break;case"SellingRateD":this.ScreenObject.StaticFields.Contains(this.SellingRateD)&&this.ScreenObject.StaticFields.Remove(this.SellingRateD),this.SellingRateD=e;break;case"SellingRateE":this.ScreenObject.StaticFields.Contains(this.SellingRateE)&&this.ScreenObject.StaticFields.Remove(this.SellingRateE),this.SellingRateE=e;break;case"SellingRateF":this.ScreenObject.StaticFields.Contains(this.SellingRateF)&&this.ScreenObject.StaticFields.Remove(this.SellingRateF),this.SellingRateF=e;break;case"SellingRateG":this.ScreenObject.StaticFields.Contains(this.SellingRateG)&&this.ScreenObject.StaticFields.Remove(this.SellingRateG),this.SellingRateG=e}});else if("PurchaseRate"==e.Name)e.Fields.forEach(e=>{switch(e.DBColumnName){case"PurchaseRateA":this.ScreenObject.StaticFields.Contains(this.PurchaseRateA)&&this.ScreenObject.StaticFields.Remove(this.PurchaseRateA),this.PurchaseRateA=e;break;case"PurchaseRateB":this.ScreenObject.StaticFields.Contains(this.PurchaseRateB)&&this.ScreenObject.StaticFields.Remove(this.PurchaseRateB),this.PurchaseRateB=e;break;case"PurchaseRateC":this.ScreenObject.StaticFields.Contains(this.PurchaseRateC)&&this.ScreenObject.StaticFields.Remove(this.PurchaseRateC),this.PurchaseRateC=e;break;case"PurchaseRateD":this.ScreenObject.StaticFields.Contains(this.PurchaseRateD)&&this.ScreenObject.StaticFields.Remove(this.PurchaseRateD),this.PurchaseRateD=e;break;case"PurchaseRateE":this.ScreenObject.StaticFields.Contains(this.PurchaseRateE)&&this.ScreenObject.StaticFields.Remove(this.PurchaseRateE),this.PurchaseRateE=e;break;case"PurchaseRateF":this.ScreenObject.StaticFields.Contains(this.PurchaseRateF)&&this.ScreenObject.StaticFields.Remove(this.PurchaseRateF),this.PurchaseRateF=e;break;case"PurchaseRateG":this.ScreenObject.StaticFields.Contains(this.PurchaseRateG)&&this.ScreenObject.StaticFields.Remove(this.PurchaseRateG),this.PurchaseRateG=e}});else if("Packing"==e.Name){if(s.a.SessionManager.LicenseSettings.ContainsKey("Packing")&&"FALSE"==s.a.SessionManager.LicenseSettings.Packing.toUpperCase())return void(e.Visible=!1);e.Fields.forEach(e=>{let t;switch(e.DBColumnName){case"Length":this.ScreenObject.StaticFields.Contains(this.ProductLength)&&this.ScreenObject.StaticFields.Remove(this.ProductLength),this.ProductLength=e,t=a.e.IntTryParse(this.ScreenObject.Data.Tables[10].find(e=>"LengthDecimals"==e.Name).Value.toString()),this.ProductLength.DecimalPoints=t.toString(),this.ProductLength.TextChangedCommand.Subscribe(this,"onTextChanged"),this.ProductLength.LostFocusCommand.Subscribe(this,"onLostFocus");break;case"Width":this.ScreenObject.StaticFields.Contains(this.ProductWidth)&&this.ScreenObject.StaticFields.Remove(this.ProductWidth),this.ProductWidth=e,t=a.e.IntTryParse(this.ScreenObject.Data.Tables[10].find(e=>"WidthDecimals"==e.Name).Value.toString()),this.ProductWidth.DecimalPoints=t.toString(),this.ProductWidth.TextChangedCommand.Subscribe(this,"onTextChanged"),this.ProductWidth.LostFocusCommand.Subscribe(this,"onLostFocus");break;case"Height":this.ScreenObject.StaticFields.Contains(this.ProductHeight)&&this.ScreenObject.StaticFields.Remove(this.ProductHeight),this.ProductHeight=e,t=a.e.IntTryParse(this.ScreenObject.Data.Tables[10].find(e=>"HeightDecimals"==e.Name).Value.toString()),this.ProductHeight.DecimalPoints=t.toString(),this.ProductHeight.TextChangedCommand.Subscribe(this,"onTextChanged"),this.ProductHeight.LostFocusCommand.Subscribe(this,"onLostFocus");break;case"Volume":this.ScreenObject.StaticFields.Contains(this.ProductVolume)&&this.ScreenObject.StaticFields.Remove(this.ProductVolume),this.ProductVolume=e,t=a.e.IntTryParse(this.ScreenObject.Data.Tables[10].find(e=>"VolumeDecimals"==e.Name).Value.toString()),this.ProductVolume.DecimalPoints=t.toString(),this.ProductVolume.LostFocusCommand.Subscribe(this,"onLostFocus");break;case"Weight":this.ScreenObject.StaticFields.Contains(this.ProductWeight)&&this.ScreenObject.StaticFields.Remove(this.ProductWeight),this.ProductWeight=e,t=a.e.IntTryParse(this.ScreenObject.Data.Tables[10].find(e=>"WeightDecimals"==e.Name).Value.toString()),this.ProductWeight.DecimalPoints=t.toString(),this.ProductWeight.LostFocusCommand.Subscribe(this,"onLostFocus");break;case"IsPacking":this.ScreenObject.StaticFields.Contains(this.ProductPacking)&&this.ScreenObject.StaticFields.Remove(this.ProductPacking),this.ProductPacking=e,this.ProductPacking.Items.push(h.d.ComboBoxItems_2("No","0")),this.ProductPacking.Items.push(h.d.ComboBoxItems_2("Yes","1")),s.a.SessionManager.Preferences.ContainsKey("PackDimension")&&""!=s.a.SessionManager.Preferences.PackDimension&&parseInt(s.a.SessionManager.Preferences.PackDimension)>0&&(this.ProductPacking.SelectedValue="1");break;case"IsBillOfEntry":this.ScreenObject.StaticFields.Contains(this.ProductBillOfEntry)&&this.ScreenObject.StaticFields.Remove(this.ProductBillOfEntry),this.ProductBillOfEntry=e,this.ProductBillOfEntry.Items.push(h.d.ComboBoxItems_2("No","0")),this.ProductBillOfEntry.Items.push(h.d.ComboBoxItems_2("Yes","1")),this.ProductBillOfEntry.Items.push(h.d.ComboBoxItems_2("FIFO","2"));break;case"Wastage":this.ScreenObject.StaticFields.Contains(this.ProductWastage)&&this.ScreenObject.StaticFields.Remove(this.ProductWastage),this.ProductWastage=e,t=a.e.IntTryParse(this.ScreenObject.Data.Tables[10].find(e=>"VolumeDecimals"==e.Name).Value.toString()),this.ProductWastage.DecimalPoints=t.toString(),this.ProductWastage.LostFocusCommand.Subscribe(this,"onLostFocus")}})}else if("ReOrder"==e.Name){if(s.a.SessionManager.LicenseSettings.ContainsKey("ReOrderManagement")&&"FALSE"==s.a.SessionManager.LicenseSettings.ReOrderManagement.toUpperCase())return void(e.Visible=!1);e.Fields.forEach(e=>{switch(e.DBColumnName){case"ReorderPolicy":this.ScreenObject.StaticFields.Contains(this.ReorderPolicy)&&this.ScreenObject.StaticFields.Remove(this.ReorderPolicy),this.ReorderPolicy=e,this.ReorderPolicy.Items.push(h.d.ComboBoxItems_2("None","0")),this.ReorderPolicy.Items.push(h.d.ComboBoxItems_2("Order","1")),this.ReorderPolicy.Items.push(h.d.ComboBoxItems_2("Max.Level","2")),this.ReorderPolicy.Items.push(h.d.ComboBoxItems_2("Reorder","3")),this.ReorderPolicy.SelectedValue="0";break;case"ReorderLevel":this.ScreenObject.StaticFields.Contains(this.ReorderLevel)&&this.ScreenObject.StaticFields.Remove(this.ReorderLevel),this.ReorderLevel=e;break;case"ReorderQty":this.ScreenObject.StaticFields.Contains(this.ReorderQty)&&this.ScreenObject.StaticFields.Remove(this.ReorderQty),this.ReorderQty=e,this.ReorderQty.Items.push(h.d.ComboBoxItems_2("Value","0")),this.ReorderQty.Items.push(h.d.ComboBoxItems_2("Percentage","1")),this.ReorderQty.SelectedValue="0";break;case"ReorderTrigger":this.ScreenObject.StaticFields.Contains(this.ReorderTrigger)&&this.ScreenObject.StaticFields.Remove(this.ReorderTrigger),this.ReorderTrigger=e,this.ReorderTrigger.Items.push(h.d.ComboBoxItems_2("Value","0")),this.ReorderTrigger.Items.push(h.d.ComboBoxItems_2("Percentage","1")),this.ReorderTrigger.SelectedValue="0";break;case"MaxInventoryLevel":this.ScreenObject.StaticFields.Contains(this.MaxInventoryLevel)&&this.ScreenObject.StaticFields.Remove(this.MaxInventoryLevel),this.MaxInventoryLevel=e;break;case"ReorderMinOrderQty":this.ScreenObject.StaticFields.Contains(this.ReorderMinOrderQty)&&this.ScreenObject.StaticFields.Remove(this.ReorderMinOrderQty),this.ReorderMinOrderQty=e;break;case"ReorderMaxOrderQty":this.ScreenObject.StaticFields.Contains(this.ReorderMaxOrderQty)&&this.ScreenObject.StaticFields.Remove(this.ReorderMaxOrderQty),this.ReorderMaxOrderQty=e;break;case"ReorderOrderMultiple":this.ScreenObject.StaticFields.Contains(this.ReorderOrderMultiple)&&this.ScreenObject.StaticFields.Remove(this.ReorderOrderMultiple),this.ReorderOrderMultiple=e;break;case"PlanningMethod":this.ScreenObject.StaticFields.Contains(this.PlanningMethod)&&this.ScreenObject.StaticFields.Remove(this.PlanningMethod),this.PlanningMethod=e,this.PlanningMethod.Items.push(h.d.ComboBoxItems_2("None","0")),this.PlanningMethod.Items.push(h.d.ComboBoxItems_2("MRP","1")),this.PlanningMethod.SelectedValue="0";break;case"ProcurementMethod":this.ScreenObject.StaticFields.Contains(this.ProcurementMethod)&&this.ScreenObject.StaticFields.Remove(this.ProcurementMethod),this.ProcurementMethod=e,this.ProcurementMethod.Items.push(h.d.ComboBoxItems_2("Purchased","0")),this.ProcurementMethod.Items.push(h.d.ComboBoxItems_2("Produced","1")),this.ProcurementMethod.SelectedValue="0";break;case"LeadTime":this.ScreenObject.StaticFields.Contains(this.LeadTime)&&this.ScreenObject.StaticFields.Remove(this.LeadTime),this.LeadTime=e;break;case"SafetyStock":this.ScreenObject.StaticFields.Contains(this.SafetyStock)&&this.ScreenObject.StaticFields.Remove(this.SafetyStock),this.SafetyStock=e;break;case"BOM":this.ScreenObject.StaticFields.Contains(this.ProductBOM)&&this.ScreenObject.StaticFields.Remove(this.ProductBOM),this.ProductBOM=e,this.ProductBOM.SearchVisible=!0,i=this.ScreenObject.Data.Tables[10].filter(e=>"ProductWiseBoms"==e.Name),i.length>0&&(this.ProductBOM.SearchVisible=Object(o.j)(i[0].Value)),this.ProductBOM.SearchVisible&&(this.ProductBOM.CustomWhere="1!=1")}})}else if("Bins"==e.Name){if(0==r||s.a.SessionManager.LicenseSettings.ContainsKey("Bins")&&"FALSE"==s.a.SessionManager.LicenseSettings.Bins.toUpperCase())return null!=this.BinWise&&(this.BinWise.Visible=!1,this.BinWise.SelectedValue="0",this.BinWise.DefaultValue="0"),void(e.Visible=!1);e.Fields.forEach(e=>{switch(e.DBColumnName){case"PurchaseBinRule":if(this.ScreenObject.StaticFields.Contains(this.PurchaseBinRule)&&this.ScreenObject.StaticFields.Remove(this.PurchaseBinRule),this.PurchaseBinRule=e,this.PurchaseBinRule.Items.push(h.d.ComboBoxItems_2("","0")),this.ScreenObject.Data.Tables.length>17&&this.ScreenObject.Data.Tables[17].length>0){let e=this.ScreenObject.Data.Tables[17].filter(e=>0==e.RuleType);if(null!=e&&e.length>0)for(let t=0;t<e.length;t++)this.PurchaseBinRule.Items.push(h.d.ComboBoxItems_2(e[t].ProfileName.toString(),e[t].ProfileID.toString()))}this.PurchaseBinRule.SelectedValue="";break;case"SalesBinRule":if(this.ScreenObject.StaticFields.Contains(this.SalesBinRule)&&this.ScreenObject.StaticFields.Remove(this.SalesBinRule),this.SalesBinRule=e,this.SalesBinRule.Items.push(h.d.ComboBoxItems_2("","0")),this.ScreenObject.Data.Tables.length>17&&this.ScreenObject.Data.Tables[17].length>0){let e=this.ScreenObject.Data.Tables[17].filter(e=>1==e.RuleType);if(null!=e&&e.length>0)for(let t=0;t<e.length;t++)this.SalesBinRule.Items.push(h.d.ComboBoxItems_2(e[t].ProfileName.toString(),e[t].ProfileID.toString()))}this.SalesBinRule.SelectedValue=""}})}else"Kit"==e.Name&&e.Fields.forEach(e=>{switch(e.DBColumnName){case"KitSize":this.ScreenObject.StaticFields.Contains(this.KitSize)&&this.ScreenObject.StaticFields.Remove(this.KitSize),this.KitSize=e}});50006==t?(this.Linkedcc=this.Category,null!=this.Linkedcc&&this.Linkedcc.SelectionChangedCommand.Subscribe(this,"OnlinkccChanged")):50004==t?(this.Linkedcc=this.Department,null!=this.Linkedcc&&this.Linkedcc.SelectionChangedCommand.Subscribe(this,"OnlinkccChanged")):e.Fields.forEach(e=>{null!=e&&e instanceof d.b&&(e.CCID==t||e.CCID==this.InheritDimImageID)&&(this.Linkedcc=e,null!=this.Linkedcc&&this.Linkedcc.SelectionChangedCommand.Subscribe(this,"OnlinkccChanged"))})}),null!=this.BinWise&&0==r&&(this.BinWise.Visible=!1,this.BinWise.SelectedValue="0",this.BinWise.DefaultValue="0");for(let a=this.ScreenObject.CustomTab.Pages.length-1;a>=0;a--){let e=this.ScreenObject.CustomTab.Pages[a];switch(e.Name){case"Kit":s.a.SessionManager.LicenseSettings.ContainsKey("Kit")&&"FALSE"==s.a.SessionManager.LicenseSettings.Kit.toUpperCase()?e.Visible=!1:(this.ProductKit.Row="1",e.Fields.push(this.ProductKit),e.Enable=!1);break;case"Attributes":e.Fields.push(this.ProductAttributes),e.Enable=!1;break;case"Serial":s.a.SessionManager.LicenseSettings.ContainsKey("SerialNo")&&"FALSE"==s.a.SessionManager.LicenseSettings.SerialNo.toUpperCase()?e.Visible=!1:(this.ProductSerialization.Row="1",e.Fields.push(this.ProductSerialization),e.Enable=!1);break;case"Notes":e.Fields.push(this.ViewNotes);break;case"Contacts":e.Fields.push(this.ViewContacts);break;case"Attachments":e.Fields.push(this.ViewAttachments);break;case"Vendors":e.Fields.push(this.ViewVendors);break;case"Substitutes":s.a.SessionManager.LicenseSettings.ContainsKey("Substitutes")&&"FALSE"==s.a.SessionManager.LicenseSettings.Substitutes.toUpperCase()?e.Visible=!1:e.Fields.push(this.ViewSubstitutes);break;case"Assign":e.Fields.push(this.ViewCCMapping);break;case"TestCases":s.a.SessionManager.LicenseSettings.ContainsKey("QC")&&"FALSE"==s.a.SessionManager.LicenseSettings.QC.toUpperCase()?e.Visible=!1:(e.Fields.push(this.ProductTestcases),e.Visible=!!(s.a.SessionManager.Preferences.ContainsKey("TestCaseDimension")&&""!=s.a.SessionManager.Preferences.TestCaseDimension&&parseInt(s.a.SessionManager.Preferences.TestCaseDimension)>0));break;case"Production Process":s.a.SessionManager.IsActionAssigned(3,"Map")?e.Fields.push(this.ViewCCMapping):this.ScreenObject.CustomTab.Pages.Remove(e);break;case"Link":e.Fields.push(this.ProductLink);break;case"Specifications":e.Fields.push(this.ProductSpecs);break;case"Bins":r>0?e.Fields.push(this.ViewBins):this.ScreenObject.CustomTab.Pages.Remove(e)}}Logger.InfoLog("AddProductViewModel::BuildControls Success"),this.ScreenObject.Data.Tables[3].forEach(e=>{this.ProductStatuses.Items.push(h.d.ComboBoxItems_2(e[Object.keys(e)[1]].toString(),e[Object.keys(e)[0]].toString()))}),this.ScreenObject.Data.Tables[13].forEach(e=>{this.UOM.Items.push(h.d.ComboBoxItems_3(e.UnitName.toString(),e.UOMID.toString(),e.BaseID.toString()))}),this.ScreenObject.Data.Tables[9].forEach(e=>{this.BarcodeLayoutID.Items.push(h.d.ComboBoxItems_2(e.Name.toString(),e.BarcodeLayoutID.toString()))}),this.UOM.Items.push(h.d.ComboBoxItems_2("New","-100")),this.UOM.Items.push(h.d.ComboBoxItems_2("Product-Wise","-399")),this.UOM.SelectedValue=this.UOM.DefaultValue,this.PurchaseUOM.Visible&&this.FillPurchaseUom(),this.ManufacturerBarcode.Items.push(h.d.ComboBoxItems_2("Yes","1")),this.ManufacturerBarcode.Items.push(h.d.ComboBoxItems_2("No","0")),this.ManufacturerBarcode.SelectedValue=this.ManufacturerBarcode.DefaultValue,this.BinWise.Items.push(h.d.ComboBoxItems_2("Yes","1")),this.BinWise.Items.push(h.d.ComboBoxItems_2("No","0")),this.BinWise.SelectedValue=this.BinWise.DefaultValue,Object(o.j)(s.a.SessionManager.Preferences.EnableSerialProducts.toString()),this.ScreenObject.Data.Tables[4].forEach(e=>{"2"==e[Object.keys(e)[0]].toString()&&!Object(o.j)(s.a.SessionManager.Preferences.EnableSerialProducts.toString())||"5"==e[Object.keys(e)[0]].toString()&&!Object(o.j)(s.a.SessionManager.Preferences.EnableBatchProducts.toString())||!("8"!=e[Object.keys(e)[0]].toString()&&"3"!=e[Object.keys(e)[0]].toString()||Object(o.j)(s.a.SessionManager.Preferences.EnableDynamicProducts.toString()))||this.ProductTypes.Items.push(h.d.ComboBoxItems_2(e[Object.keys(e)[1]].toString(),e[Object.keys(e)[0]].toString()))}),this.ScreenObject.Data.Tables[4].length>0&&(this.ProductTypes.SelectedValue=this.ScreenObject.Data.Tables[4][0][Object.keys(this.ScreenObject.Data.Tables[4][0])[0]].toString()),this.ScreenObject.Data.Tables[6].forEach(e=>{this.ValuationMethods.Items.push(h.d.ComboBoxItems_2(e[Object.keys(e)[1]].toString(),e[Object.keys(e)[0]].toString()))}),this.QtyAdjustment.Items.push(h.d.ComboBoxItems_2("Not Applicable","3")),this.QtyAdjustment.Items.push(h.d.ComboBoxItems_2("Optional","2")),this.QtyAdjustment.Items.push(h.d.ComboBoxItems_2("Mandatory","1")),e>0&&(this.ProductGroups.SelectedValue=e,this.ProductGroups.DefaultValue=this.ProductGroups.SelectedValue.toString()),0!=this.oProduct.ProductID?(i=this.ScreenObject.Data.Tables[10].filter(e=>"ProductCodeAutoGen"==e.Name),this.LoadEditData()):(this.NextPreviousVisibility=!1,this.oProduct.GUID="",null!=this.ScreenObject.Data.Tables[10]&&(i=this.ScreenObject.Data.Tables[10].filter(e=>"DefaultUOM"==e.Name),null!=i&&i.length>0&&!a.e.StringIsNullOrEmpty(i[0].Value)&&(this.UOM.SelectedValue=i[0].Value.toString()),i=this.ScreenObject.Data.Tables[10].filter(e=>"DefaultProductType"==e.Name),null!=i&&i.length>0&&!a.e.StringIsNullOrEmpty(i[0].Value)&&(this.ProductTypes.SelectedValue=i[0].Value.toString()))),this.AutoGenerateCode(),null!=this.DimFields&&this.DimFields.length>0||this.ScreenObject.SetViewByType(this.ProductTypes.SelectedValue,this.oProduct.IsGroup),Logger.InfoLog("AddProductViewModel::Exiting worker_DoWork")}SetViewFilter(e){return e.filter="",this.DimFields.forEach(t=>{if("3"==t){if(!(this.ProductGroups.SelectedValue>0))return!1;e.filter+=" and GroupID="+this.ProductGroups.SelectedValue}else if(!a.e.IsEmpty(t)&&parseInt(t)>5e4){var i=this.ScreenObject.GetCustomCCField_1(parseInt(t));if(!(null!=i&&i instanceof d.b&&i.SelectedValue>0))return!1;e.filter+=" and DcCCNID"+(t-5e4)+"="+i.SelectedValue}}),!0}SetViewByType(){let e=null,t=null,i="",s=this.ScreenObject.Data.Tables[18].filter(e=>1==e.IsTab),o=this.ScreenObject.Data.Tables[18].filter(e=>0==e.IsTab);if(this.DimFields.forEach(e=>{if("3"==e&&this.ProductGroups.SelectedValue>0)i+=" and GroupID="+this.ProductGroups.SelectedValue,o=o.filter(e=>e.GroupID==this.ProductGroups.SelectedValue),s=s.filter(e=>e.GroupID==this.ProductGroups.SelectedValue);else if(!a.e.IsEmpty(e)&&parseInt(e)>5e4){var t=this.ScreenObject.GetCustomCCField_1(parseInt(e));null!=t&&t instanceof d.b&&t.SelectedValue>0&&(i+=" and DcCCNID"+(e-5e4)+"="+t.SelectedValue,o=o.filter(i=>0==i.IsTab&&i["DcCCNID"+(e-5e4)]==t.SelectedValue),s=s.filter(i=>1==i.IsTab&&i["DcCCNID"+(e-5e4)]==t.SelectedValue))}}),""==i)return;let r=0;var n=o;n.forEach(t=>{if(e=null,null!=this.ScreenObject.HeaderFields?e=this.ScreenObject.HeaderFields.find(e=>e instanceof K.c&&e.DBColumnID==parseInt(t.CostCenterColID)):null!=this.ScreenObject.StaticFields&&(e=this.ScreenObject.StaticFields.find(e=>e instanceof K.c&&e.DBColumnID==parseInt(t.CostCenterColID))),null==e)for(let i=0;i<this.ScreenObject.CustomTab.Pages.length&&(e=this.ScreenObject.CustomTab.Pages[i].Fields.find(e=>e instanceof K.c&&e.DBColumnID==parseInt(t.CostCenterColID)),null==e||null==e);i++);null!=e&&(r=parseInt(t.Hide),1!=r&&2!=r||(e.Visible=!1),r=parseInt(t.Mandatory),1!=r&&2!=r||(e.Mandatory=!0))}),(n=s).forEach(e=>{t=this.ScreenObject.CustomTab.Pages.find(t=>t.DBColumnID==parseInt(e.CostCenterColID)),null!=t&&null!=t&&(r=parseInt(e.Hide),1!=r&&2!=r||(t.Visible=!1),r=parseInt(e.Mandatory),1!=r&&2!=r||(t.IsReadOnly=!0))});for(let a=0;a<this.ScreenObject.CustomTab.Pages.length;a++){const e=this.ScreenObject.CustomTab.Pages[a];if(e.Visible){this.ScreenObject.CustomTab.SelectedTab=e;break}}}SetFieldsposition(){if(null!=this.ScreenObject.HeaderFields){var e=this.ScreenObject.HeaderFields.filter(e=>e instanceof K.c&&e.Visible);e.sort((e,t)=>e.SectionSeqNo-t.SectionSeqNo),this.Setposition(e)}this.ScreenObject.CustomTab.Pages.forEach(e=>{var t=e.Fields.filter(e=>e instanceof K.c&&e.Visible);t.sort((e,t)=>e.SectionSeqNo-t.SectionSeqNo),t.length>0&&this.Setposition(t)})}Setposition(e){let t=0,i=0,s=1;for(let o=0;o<e.length;o++){let r=e[o];s=1,s=a.e.Int(r.ColumnSpan),s<1&&(s=1),i+s>4&&(t++,i=0),r.Row=t,r.Column=i,i+=s}}PopulateProductName(e){null!=e&&(this.ScreenObject.LinkColumnCostcenterID=this.LinkColumnCostcenterID,this.ScreenObject.PopulateProductName(e))}LoadEditData(){let e;if(this.NextPrevProductID=this.ProductID,this.ds=this.oProduct.GetProductDetails(),this.ProductPhoto="",this.ActualFileName="",this.ThumbnailPhoto="",this.ProductCode.Text=this.oProduct.ProductCode,this.ProductCode.Code=this.oProduct.ProductCode,(this.ScreenObject.InheritParentCode||this.ScreenObject.IsAutoCode)&&(this.ProductCode.Enable=parseInt(this.ds.Tables[0][0].Depth)<=1&&!this.ScreenObject.IsRootAutoCode),this.ProductName.Text=this.oProduct.ProductName,this.AliasName.Text=this.oProduct.AliasName,this.ProductTypes.SelectedValue=this.oProduct.ProductType.toString(),this.ProductStatuses.SelectedValue=this.oProduct.ProductStatus.toString(),this.ProductGroups.SelectedValue=this.oProduct.ProductGroup,this.ProductGroups.Enable=!1,this.ProductGroups.DefaultValue=this.ProductGroups.SelectedValue.toString(),this.ValuationMethods.SelectedValue=this.oProduct.Valuation.toString(),this.QtyAdjustment.SelectedValue=this.oProduct.QtyAdjustment.toString(),this.BinWise.SelectedValue=this.oProduct.BinWise.toString(),this.AssetGroup.SelectedValue=this.oProduct.AssetGroupID,null!=this.ReorderLevel&&(this.ReorderLevel.Text=this.oProduct.ReorderLevel.toString()),null!=this.ReorderQty&&(this.ReorderQty.Text=this.oProduct.ReorderQty.toString(),this.ReorderQty.SelectedValue=this.oProduct.ReorderQtyType.toString()),null!=this.ReorderTrigger&&(this.ReorderTrigger.Text=this.oProduct.ReorderTrigger.toString(),this.ReorderTrigger.SelectedValue=this.oProduct.ReorderTriggerType.toString()),null!=this.Barcode&&null!=this.oProduct.Barcode&&(this.Barcode.Text=this.oProduct.Barcode.toString()),null!=this.Currency&&(this.Currency.SelectedValue=this.oProduct.Currency),this.Description.Text=this.oProduct.Description,null!=this.Packing&&null!=this.oProduct.Packing&&(this.Packing.Text=this.oProduct.Packing),null!=this.ShelfLife&&(this.ShelfLife.Text=this.oProduct.ShelfLife.toString()),null!=this.PreExpiryDays&&(this.PreExpiryDays.Text=this.oProduct.PreExpiryDays.toString()),null!=this.MaxTolerancePer&&(this.MaxTolerancePer.Text=this.oProduct.MaxTolerancePer.toString()),null!=this.MaxToleranceVal&&(this.MaxToleranceVal.Text=this.oProduct.MaxToleranceVal.toString()),null!=this.MinTolerancePer&&(this.MinTolerancePer.Text=this.oProduct.MinTolerancePer.toString()),null!=this.MinToleranceVal&&(this.MinToleranceVal.Text=this.oProduct.MinToleranceVal.toString()),null!=this.CreditDays&&(this.CreditDays.Text=this.oProduct.CreditDays.toString()),this.PurchaseRate.Text=this.oProduct.PurchaseRates.toString(),this.PurchaseRateA.Text=this.oProduct.PurchaseRateA.toString(),this.PurchaseRateB.Text=this.oProduct.PurchaseRateB.toString(),this.PurchaseRateC.Text=this.oProduct.PurchaseRateC.toString(),this.PurchaseRateD.Text=this.oProduct.PurchaseRateD.toString(),this.PurchaseRateE.Text=this.oProduct.PurchaseRateE.toString(),this.PurchaseRateF.Text=this.oProduct.PurchaseRateF.toString(),this.PurchaseRateG.Text=this.oProduct.PurchaseRateG.toString(),this.SellingRate.Text=this.oProduct.SellingRates.toString(),this.SellingRateA.Text=this.oProduct.SellingRateA.toString(),this.SellingRateB.Text=this.oProduct.SellingRateB.toString(),this.SellingRateC.Text=this.oProduct.SellingRateC.toString(),this.SellingRateD.Text=this.oProduct.SellingRateD.toString(),this.SellingRateE.Text=this.oProduct.SellingRateE.toString(),this.SellingRateF.Text=this.oProduct.SellingRateF.toString(),this.SellingRateG.Text=this.oProduct.SellingRateG.toString(),this.oProduct.BarcodeLayoutID>0&&(this.BarcodeLayoutID.SelectedValue=this.oProduct.BarcodeLayoutID.toString()),null!=this.UOM&&(this.UOM.SelectedValue=this.oProduct.UOM.toString()),this.ManufacturerBarcode.SelectedValue=this.oProduct.ManufacturerBarcode.toString(),(this.SalesAccount.Enable||""!=this.SalesAccount.DefaultValue&&this.oProduct.SalesAccount!=parseInt(this.SalesAccount.DefaultValue))&&(this.SalesAccount.SelectedValue=this.oProduct.SalesAccount),(this.PurchaseAccount.Enable||""!=this.PurchaseAccount.DefaultValue&&this.oProduct.PurchaseAccount!=parseInt(this.PurchaseAccount.DefaultValue))&&(this.PurchaseAccount.SelectedValue=this.oProduct.PurchaseAccount),this.COGSAccount.SelectedValue=this.oProduct.COGSAccount,this.ClosingStockAccount.SelectedValue=this.oProduct.ClosingStockAccount,this.SalesAccount.drrEdit=this.ds.Tables[19].filter(e=>e.CCID==this.SalesAccount.DBColumnID),this.PurchaseAccount.drrEdit=this.ds.Tables[19].filter(e=>e.CCID==this.PurchaseAccount.DBColumnID),this.COGSAccount.drrEdit=this.ds.Tables[19].filter(e=>e.CCID==this.COGSAccount.DBColumnID),this.ClosingStockAccount.drrEdit=this.ds.Tables[19].filter(e=>e.CCID==this.ClosingStockAccount.DBColumnID),null!=this.Category&&(this.Category.SelectedValue=this.oProduct.Category),null!=this.Department&&(this.Department.SelectedValue=this.oProduct.Department),this.ProductLength.Text=this.oProduct.ProductLength.ToString("N"+this.ProductLength.DecimalPoints),this.ProductWidth.Text=this.oProduct.ProductWidth.ToString("N"+this.ProductWidth.DecimalPoints),this.ProductHeight.Text=this.oProduct.ProductHeight.ToString("N"+this.ProductHeight.DecimalPoints),this.ProductVolume.Text=this.oProduct.ProductVolume.ToString("N"+this.ProductVolume.DecimalPoints),this.ProductWeight.Text=this.oProduct.ProductWeight.ToString("N"+this.ProductWeight.DecimalPoints),this.ProductWastage.Text=this.oProduct.ProductWastage.ToString("N"+this.ProductWastage.DecimalPoints),this.KitSize.Text=this.oProduct.KitSize.toString(),this.SerialNumber.Text=this.oProduct.SerialNumber,this.ProductWeightable.SelectedValue=this.oProduct.ProductWeightable.toString(),this.ProductPacking.SelectedValue=this.oProduct.ProductPacking.toString(),this.ProductBillOfEntry.SelectedValue=this.oProduct.ProductBillOfEntry.toString(),this.ReorderPolicy.SelectedValue=this.oProduct.ReorderPolicy.toString(),this.MaxInventoryLevel.Text=this.oProduct.MaxInventoryLevel.toString(),this.ReorderMinOrderQty.Text=this.oProduct.ReorderMinOrderQty.toString(),this.ReorderMaxOrderQty.Text=this.oProduct.ReorderMaxOrderQty.toString(),this.ReorderOrderMultiple.Text=this.oProduct.ReorderOrderMultiple.toString(),this.PlanningMethod.SelectedValue=this.oProduct.PlanningMethod.toString(),this.ProcurementMethod.SelectedValue=this.oProduct.ProcurementMethod.toString(),this.LeadTime.Text=this.oProduct.LeadTime.toString(),this.SafetyStock.Text=this.oProduct.SafetyStock.toString(),this.ProductBOM.SearchVisible&&(this.ProductBOM.CustomWhere="a.ProductID="+this.oProduct.ProductID),this.ProductBOM.SelectedValue=this.oProduct.ProductBOM,this.PurchaseBinRule.SelectedValue=this.oProduct.PurchaseBinRule.toString(),this.SalesBinRule.SelectedValue=this.oProduct.SalesBinRule.toString(),this.ScreenObject.LoadCustomFieldsData(this.ds.Tables[1]),this.ScreenObject.LoadCustomFieldsCCData(this.ds.Tables[7],this.ds.Tables[19]),e=this.ds.Tables[4].filter(e=>1==e.IsProductImage&&1==e.IsDefaultImage),e.length>0?(this.PhotoTextVisibility=!1,this.FileID=parseInt(e[0].FileID),this.ProductPhoto=a.e.GetPath(e[0].GUID.toString()+"."+e[0].FileExtension.toString()),this.ActualFileName=e[0].ActualFileName.toString()):this.InheritImage?(this.PhotoTextVisibility=!0,this.FileID=0,this.ImageHeight=(parseInt(this.ImageHeight)-20).toString()):this.InheritGrpImage?this.OnLoadImage("Group",this.ProductGroups.SelectedValue):this.OnLoadImage("Dimension",this.GetImageCCVal()),this.ViewContacts.LoadContacts(this.ds.Tables[2],this.ds.Columns[2]),this.ViewNotes.LoadNotes(this.ds.Tables[3]),this.ViewAttachments.LoadAttachments(this.ds.Tables[4]),this.ViewSubstitutes.LoadSubstitutes(this.ds.Tables[5]),this.ViewVendors.LoadVendors(this.ds.Tables[6]),this.ProductKit.LoadBundels(this.ds.Tables[8]),this.ProductLink.LoadBundels(this.ds.Tables[8]),this.ProductSpecs.LoadSpecs(this.ds.Tables[10]),this.ProductSerialization.LoadSerialization(this.ds.Tables[9]),this.oProduct.IsMatrixItem)this.ProductAttributes.LoadAttributes(this.ds.Tables[0],!0);else{let e=this.ds.Tables[0][0].AttributeMapXML;this.ProductAttributes.LoadAttributes(this.ds.Tables[0],!1),null!=e&&null!=e&&e.length>0&&this.ProductAttributes.LoadSubItems(this.ds.Tables[0])}for(let t=0;t<this.ScreenObject.CustomTab.Pages.length;t++)if(this.ScreenObject.CustomTab.Pages[t].QuickViewCCID>0)for(let e=0;e<this.ScreenObject.CustomTab.Pages[t].Fields.length;e++)if("PACT.VIEWMODEL.PactGridViewModel"==this.ScreenObject.CustomTab.Pages[t].Fields[e].toString()){let i=this.ScreenObject.CustomTab.Pages[t].Fields[e],o=this.ds.Tables[11].filter(e=>e.CostCenterId==this.ScreenObject.CustomTab.Pages[t].QuickViewCCID),r="";i.Table.Clear(),o.forEach(e=>{let t=i.NewRow();t.Dimension_Key=e.NodeID,t.Dimension=e.Value,i.addRow(t),r=r+e.NodeID+",",this.ds.Tables[11].Remove(e)});for(let e=0;e<15;e++){let e=i.NewRow();i.addRow(e)}let n=null;this.ScreenObject.CustomTab.Pages[t].QuickViewID>0&&(n=s.a.common.GetCostCenterQuickViewSummary(this.ScreenObject.CustomTab.Pages[t].QuickViewCCID,r.TrimEnd(","),this.ScreenObject.CustomTab.Pages[t].QuickViewCCID,new Date,"",0,this.ScreenObject.CustomTab.Pages[t].QuickViewID));let l=1;i.Table.forEach(e=>{if(e.SNO=l++,!a.e.StringIsNullOrEmpty(e.Dimension_Key)&&null!=n&&n.Tables.length>0&&n.Tables[0].length>0&&!n.Columns[0].Contains("ErrorMessage")){let t=n.Tables[0].filter(t=>t.NodeID==e.Dimension_Key.toString());for(let i=2;i<n.Columns[0].length;i++)"FileExtension"!=n.Columns[0][i]&&"FileGUID"!=n.Columns[0][i]&&(e["fld"+i]=t[0][n.Columns[0][i]].toString())}})}this.ViewCCMapping.LoadData(this.ds.Tables[11],this.ds.Columns[11]),this.ViewCCMapping.TempData=[],this.ProductTestcases.LoadData(this.ds.Tables[18]),this.StatusAssignGrid.Load(this.ds.Tables[20]),this.ScreenObject.CanApprove(this.ds.Tables[0][0],this.ds.Tables[16][0],this.ButtonSave),this.ds.Tables.length>17&&this.ViewBins.LoadBins(this.ds.Tables[17]),this.OnlinkccChanged(this.Linkedcc),this.ds.Tables.length>13&&this.ds.Tables[13].length>0?(this.dtProductWise=this.ds.Tables[13],this.LoadUnitsProductWise(this.ds.Tables[13]),a.e.IsEmpty(this.ds.Tables[0][0].PurchaseUOM)||(this.PurchaseUOM.SelectedValue=this.ds.Tables[0][0].PurchaseUOM.toString())):this.ds.Tables.length>0&&this.ds.Tables[0].length>0&&this.PurchaseUOM.Visible&&(this.FillPurchaseUom(),a.e.IsEmpty(this.ds.Tables[0][0].PurchaseUOM)||(this.PurchaseUOM.SelectedValue=this.ds.Tables[0][0].PurchaseUOM.toString())),s.a.SessionManager.IsOffline&&this.ProductID>0&&(this.ButtonSave.Visible=!1),e=this.ScreenObject.Data.Tables[10].filter(e=>"ProductName"==e.Name),e.length>0&&""!=e[0].Value.toString()?(this.LinkColumnCostcenterID=parseInt(e[0].Value),this.ScreenObject.LinkColumnCostcenterID=this.LinkColumnCostcenterID,this.LinkColumnCostcenterID>0&&(this.ProductName.Enable=!1)):this.ProductName.Enable=!this.AutoGenerateName&&!this.NameSameasCode,this.OnTypeChanged()}GetImageCCVal(){return this.ScreenObject.StaticFields.forEach(e=>{if(e instanceof d.b&&!a.e.StringIsNullOrEmpty(e.DBColumnName)&&e.DBColumnName.toUpperCase().startsWith("CCNID")&&e.CCID==this.InheritDimImageID)return e.SelectedValue}),0}LoadUnitsProductWise(e){if(e.length>0){this.AddEditUOM.ButtonVisible=!1;let i=[];if(i=e,i.length>0){this.PurchaseUOM.Items.Clear(),this.AddEditUOM.Units1.Items.Clear(),this.isCopy||(this.AddEditUOM.Units1.Items.push(h.d.ComboBoxItems_2(i[0].BaseName.toString(),i[0].BaseID.toString())),this.AddEditUOM.Units1.SelectedValue=i[0].BaseID.toString()),this.AddEditUOM.BaseText=i[0].BaseName.toString(),this.AddEditUOM.RateText=i[0].Conversion.toString(),this.AddEditUOM.BaseVisibility=!0,this.AddEditUOM.GridUnitsObj.Clear();for(let e=0;e<i.length;e++){var t=this.AddEditUOM.GridUnits.filter(t=>t.PrimayColumn==i[e].UOMID.toString());if(t.length>0)t[0].Barcodes=t[0].Barcodes.toString()+","+i[e].Barcode.toString();else{let t=this.AddEditUOM.GridUnitsObj.NewRow();this.isCopy?(t.PrimayColumn=null,t.UnitID=null,t.Barcode="",t.Barcode_Key=null):(t.PrimayColumn=i[e].UOMID.toString(),t.UnitID=i[e].UOMID.toString(),t.Barcode=i[e].Barcode.toString(),t.Barcode_Key=i[e].Barcode_Key,this.PurchaseUOM.Visible&&this.PurchaseUOM.Items.push(h.d.ComboBoxItems_2(i[e].UnitNAme.toString(),i[e].UOMID.toString()))),this.AddEditUOM.BaseText==i[e].UnitName.toString()&&(this.AddEditUOM.RateText=i[e].Conversion.toString()),t["Unit Name"]=i[e].UnitName.toString(),t["Conversion Rate"]=i[e].Conversion.toString(),t.BaseID=null,t.Barcodes="",this.AddEditUOM.GridUnitsObj.addRow(t)}}for(let e=this.AddEditUOM.GridUnits.length;e<10;e++){let e=this.AddEditUOM.GridUnitsObj.NewRow();this.AddEditUOM.GridUnitsObj.addRow(e)}}this.UOM.SelectedValue="-399",this.UOMVisibility=!0}}AutoGenerateCode(){this.AssetGroup.Visible=!!(this.oProduct.IsGroup&&"10"==this.ProductTypes.SelectedValue||this.AssetGroupVisible&&!this.oProduct.IsGroup&&"1"==this.ProductTypes.SelectedValue);let e=this.ScreenObject.Data.Tables[10].filter(e=>"CapsLock"==e.Name);null!=e&&e.length>0&&Object(o.j)(e[0].Value)&&(this.ProductName.IsAllCaps=!0),e=this.ScreenObject.Data.Tables[10].filter(e=>"CapsToFirstLetter"==e.Name),null!=e&&e.length>0&&Object(o.j)(e[0].Value)&&(this.ProductName.IsFirstLetterCaps=!0),e=this.ScreenObject.Data.Tables[10].filter(e=>"CodeCapsLock"==e.Name),null!=e&&e.length>0&&Object(o.j)(e[0].Value)&&(this.ProductCode.IsAllCaps=!0),e=this.ScreenObject.Data.Tables[10].filter(e=>"CodeCapsToFirstLetter"==e.Name),null!=e&&e.length>0&&Object(o.j)(e[0].Value)&&(this.ProductCode.IsFirstLetterCaps=!0),e=this.ScreenObject.Data.Tables[10].filter(e=>"CodeIgnoreSpaces"==e.Name),null!=e&&e.length>0&&Object(o.j)(e[0].Value)&&(this.ProductCode.IgnoreSpaces=!0),e=this.ScreenObject.Data.Tables[10].filter(e=>"IgnoreSpaces"==e.Name),null!=e&&e.length>0&&Object(o.j)(e[0].Value)&&(this.ProductName.IgnoreSpaces=!0),e=this.ScreenObject.Data.Tables[10].filter(e=>"AttachmentMandatory"==e.Name),null!=e&&e.length>0&&Object(o.j)(e[0].Value)&&(this.IsAttachmentMandatory=!0),e=this.ScreenObject.Data.Tables[10].filter(e=>"AttachementThumbnail"==e.Name),e.length>0&&Object(o.j)(e[0].Value)&&(this.ViewAttachments.GridView=!0);let t=90;if(e=this.ScreenObject.Data.Tables[10].filter(e=>"ProductImageDimensions"==e.Name),null!=e&&e.length>0&&!a.e.StringIsNullOrEmpty(e[0].Value)){let i=new a.f;i.LoadXml(e[0].Value.toString()),this.ImgRowSpan=null!=i.DocumentElement.attributes.RowSpan&&""!=i.DocumentElement.attributes.RowSpan.value?i.DocumentElement.attributes.RowSpan.value:"3",this.ImgColumnSpan=null!=i.DocumentElement.attributes.ColumnSpan&&""!=i.DocumentElement.attributes.ColumnSpan.value?i.DocumentElement.attributes.ColumnSpan.value:"1",this.ImgColumn="1"==this.ImgColumnSpan?"3":"2"==this.ImgColumnSpan?"2":"3"==this.ImgColumnSpan?"1":"4"==this.ImgColumnSpan?"0":"3",t=this.ProductPhoto.length>0?45*parseInt(this.ImgRowSpan):45*parseInt(this.ImgRowSpan)-20,this.ImageHeight=t.toString()}else this.ImgRowSpan="3",this.ImgColumn="3",this.ImgColumnSpan="1",this.ImageHeight=t.toString();if(this.ImgRow=parseInt(this.ImgRowSpan),this.ImgHeight=t,this.ImgCol=parseInt(this.ImgColumnSpan),e=this.ScreenObject.Data.Tables[10].filter(e=>"AutoBarcode"==e.Name),null!=e&&e.length>0&&Object(o.j)(e[0].Value)&&null!=this.Barcode&&(this.Barcode.Enable=!1,0==this.oProduct.ProductID&&(this.Barcode.Text=this.oProduct.GetAutoBarcode())),0==this.oProduct.ProductID?(null!=this.ProductGroups&&this.ProductGroups.SelectedValue>0&&(this.ParentId=parseInt(this.ProductGroups.SelectedValue.toString())),this.ScreenObject.IsName=!1,this.ScreenObject.SetAutoCode(this.ProductCode,this.oProduct.IsGroup,this.ParentId,this.ScreenObject.Data.Tables[15]),this.OnTextChanged_string("")):this.ScreenObject.GetCodeParams(this.ScreenObject.Data.Tables[15]),null!=this.ScreenObject.Data.Tables[10]){if(e=this.ScreenObject.Data.Tables[10].filter(e=>"ProductName"==e.Name),null!=e&&e.length>0&&!a.e.StringIsNullOrEmpty(e[0].Value)&&(this.LinkColumnCostcenterID=parseInt(e[0].Value),this.ScreenObject.LinkColumnCostcenterID=this.LinkColumnCostcenterID,this.LinkColumnCostcenterID>0)){if(null!=this.ScreenObject.Data.Tables[12]&&this.ScreenObject.Data.Tables[12].length>0){let e=this.ScreenObject.Data.Tables[12].filter(e=>e.FeatureID==this.LinkColumnCostcenterID);null!=e&&e.length>0&&!a.e.StringIsNullOrEmpty(e[0].NAME)&&0==this.ProductID&&(this.ProductName.Text=e[0].NAME.toString())}this.ProductName.Enable=!1}-1!=this.LinkColumnCostcenterID&&0!=this.LinkColumnCostcenterID||(e=this.ScreenObject.Data.Tables[10].filter(e=>e.Name==(this.oProduct.IsGroup?"GroupNameSameasCode":"NameSameasCode")),null!=e&&e.length>0&&Object(o.j)(e[0].Value)?this.ProductName.Enable=!1:this.ScreenObject.IsAutoName?(this.ScreenObject.IsNameAutoGenerate=!0,this.AutoGenerateName=!0,this.ProductName.Enable=!1):(this.ScreenObject.IsNameAutoGenerate=!1,this.ProductName.Enable=!0,this.AutoGenerateName=!1))}}OnDropPhoto(e){let t=a.e.CheckImageSize(e[0].name,e[0].size);if(""!=t)return void alert(t);let i=e[0],o=e[0].name.split("."),r=e[0].name;o.length>1&&(o=o[o.length-1]);let n=new FormData;n.append("ImageUpload",i),n.append("FileUpload",i),n.append("UserName",s.a.SessionManager.UserID);const l=new FileReader;l.onload=e=>{const t=new Image;if("pdf"==o||"txt"==o||"doc"==o||"csv"==o||"docx"==o||"doc"==o||"xls"==o||"xlsx"==o)return this.DisplayMessage=s.a.GetResource("File_NoPhoto"),void(this.MessageVisibility=!0);t.src=e.target.result,t.onload=t=>{a.e.IsEmpty(e.target.result)||setTimeout(()=>{s.a.common.UploadAttachments(n).subscribe(e=>{"AddEditAccountViewModel"==this.ClassName&&(this.ProductPhoto=a.e.GetPath(e),this.ActualFileName=r,this.FileExtension=o,this.IsPhotoChanged=!0,this.PhotoTextVisibility=!1,this.DisplayMessage="",this.MessageVisibility=!1)},e=>{console.log("Error : "+JSON.stringify(e))})},100)}},l.readAsDataURL(i)}OnLoadImage(e,t){"Group"!=e&&"Dimension"!=e||this.InheritImage?this.InheritImage&&(this.UploadVisibility=!0,this.DeleteVisibility=!0):(null!=this.ScreenObject.Data&&null!=this.ScreenObject.Data&&this.ScreenObject.Data.Tables.length>14&&(this.ImageView=this.ScreenObject.Data.Tables[14]),this.InheritGrpImage?this.ImageView=this.ImageView.filter(e=>3==e.FeatureID&&e.FeaturePK==t&&1==e.IsProductImage):this.InheritDimImageID>5e4&&(this.ImageView=this.ImageView.filter(e=>e.FeatureID==this.InheritDimImageID&&e.FeaturePK==t&&1==e.IsProductImage)),this.ImageView.length>0?(this.PhotoTextVisibility=!1,this.FileID=0,this.ProductPhoto=a.e.GetPath(this.ImageView[0].GUID.toString()+"."+this.ImageView[0].FileExtension.toString()),""==this.ProductPhoto&&(this.ImageHeight=(parseInt(this.ImageHeight)+20).toString()),this.IsPhotoChanged=!0,this.PhotoTextVisibility=!1,this.DisplayMessage="",this.MessageVisibility=!1):(this.ProductPhoto="",this.ActualFileName="",this.IsPhotoChanged=!1,this.PhotoTextVisibility=!1),this.UploadVisibility=!1,this.DeleteVisibility=!1)}OnSaveProduct(e){if(Logger.InfoLog("OnSaveProduct:: Entering OnSaveProduct With Parameter="+e),"Contact"==e.toString())this.ContactExpanded=!this.ContactExpanded;else if("PopUp"==e.toString()){let e="";null!=this.ds&&this.ds.Tables[4].filter(e=>"jpg"==e.FileExtension||"png"==e.FileExtension).forEach(t=>{e+=a.e.GetPath(t.GUID.toString()+"."+t.FileExtension.toString())+";"})}else if("Query"==e.toString());else if("Copy"==e.toString()){this.isCopy=!0;let e=new re.CopyProductViewModel(this);s.a.page.ShowDialog(e,ne.CopyProductComponent,{ShowCenter:!0,Title:s.a.GetResource("Copy")})}else if("Note"==e.toString())this.NoteExpanded=!this.NoteExpanded;else if("Attachment"==e.toString())this.AttachmentExpanded=!this.AttachmentExpanded;else if("NewContact"==e.toString())this.ContactVisibility=!0;else if("Attachment"==e.toString())this.AttachmentVisibility=!0;else if("NewNote"==e.toString())this.NoteVisibility=!0;else if("PartyRate"==e.toString())this.PartyRateExpanded=!this.PartyRateExpanded;else if("CCRates"==e.toString())this.CCRatesExpanded=!this.CCRatesExpanded;else if("Substitutes"==e.toString())this.SubstitutesExpanded=!this.SubstitutesExpanded;else if("Vendors"==e.toString())this.VendorsExpanded=!this.VendorsExpanded;else if("Schemes"==e.toString())this.SchemesExpanded=!this.SchemesExpanded;else if("Discounts"==e.toString())this.DiscountExpanded=!this.DiscountExpanded;else if("Taxes"==e.toString())this.TaxExpanded=!this.TaxExpanded;else if("NewSubstitutes"==e.toString())this.SubstituteVisibility=!0;else if("NewVendors"==e.toString())this.VendorVisibility=!0;else if("DeletePhoto"==e.toString())0==this.ProductPhoto.length?this.ImageHeight=(45*parseInt(this.ImgRowSpan)).toString():confirm("Are you sure you want to delete Image?")&&(this.IsPhotoDelete=!0,this.DialogResult=!1,this.ProductPhoto="",this.ActualFileName="",this.IsPhotoChanged=!1,this.PhotoTextVisibility=!0,this.DisplayMessage="",this.ImageHeight=(parseInt(this.ImageHeight)-15).toString());else if("UploadPhoto"==e.toString()&&this.InheritImage){let e=new $.a;e.PopupAttachmentsViewModel_1(3,this.ProductID,this),s.a.page.ShowDialog(e,ee.a,{ShowCenter:!0,Title:"Add Images"})}else if("MouseDown"==e.toString()&&this.InheritImage);else if("ShowApprove"==e.toString()){let e=new te.a(3,this.oProduct.ProductID,this.ScreenObject,this);s.a.page.ShowDialog(e,ie.a,{ShowCenter:!0,Title:s.a.GetResource("ApproveReject")})}else if("ShowStatusAssignGrid"==e.toString())this.StatusAssignGrid.IsShown=!0,s.a.page.ShowDialog(this.StatusAssignGrid,le.a,{ShowCenter:!0,Title:s.a.GetResource("Assign")});else if("Save"==e.toString()||"APPROVE_CALL"==e.toString()){Logger.InfoLog("AddProductViewModel::Entering OnSaveProduct");try{if(this.IsAttachmentMandatory&&null!=this.ViewAttachments){let e=0;if(this.ViewAttachments.AttachmentsList.length>0&&this.ViewAttachments.AttachmentsList.forEach(t=>{t.IsProductImage||e++}),0==e)return this.DisplayMessage="Attachment is mandatory",void(this.MessageVisibility=!0)}if(a.e.StringIsNullOrEmpty(this.UOM.SelectedValue))return this.MessageVisibility=!0,void(this.DisplayMessage=s.a.GetResource("Select")+" "+this.UOM.Label);if("1"==this.ProcurementMethod.SelectedValue&&this.ProductBOM.SelectedValue<=1)return this.MessageVisibility=!0,void(this.DisplayMessage=s.a.GetResource("Select")+" "+this.ProductBOM.Label);if(0==this.oProduct.ProductID){this.ScreenObject.IsName=!1;let e=[];e=this.ScreenObject.Data.Tables[15],e=e.filter(e=>0==e.IsName);let t={StrCode:this.oProduct.ProductCode,CodePrefix:this.oProduct.CodePrefix,CodeNumber:this.oProduct.CodeNumber};if(this.DisplayMessage=this.ScreenObject.SetAutoCodeParams_3(this.ProductCode,this.ParentId,e,t),this.oProduct.ProductCode=t.StrCode,this.oProduct.CodePrefix=t.CodePrefix,this.oProduct.CodeNumber=t.CodeNumber,this.OnTextChanged_string(""),this.DisplayMessage.length>0)return}else if(this.oProduct.ProductID>0&&!this.ProductCode.Enable&&!this.ScreenObject.CodeSeqExist){this.ScreenObject.IsName=!1;let e=[];e=this.ScreenObject.Data.Tables[15],e=e.filter(e=>0==e.IsName);let t={StrCode:this.oProduct.ProductCode,CodePrefix:this.oProduct.CodePrefix,CodeNumber:this.oProduct.CodeNumber};if(this.DisplayMessage=this.ScreenObject.SetAutoCodeParams_3(this.ProductCode,this.ParentId,e,t),this.oProduct.ProductCode=t.StrCode,this.oProduct.CodePrefix=t.CodePrefix,this.oProduct.CodeNumber=t.CodeNumber,this.OnTextChanged_string(""),this.DisplayMessage.length>0)return}else this.oProduct.ProductCode=this.ProductCode.Text,this.ProductCode.Code=this.ProductCode.Text;if(!this.ProductName.Enable&&this.AutoGenerateName){let e=[];e=this.ScreenObject.Data.Tables[15],e=e.filter(e=>1==e.IsName),this.ScreenObject.IsName=!0,null!=e&&e.length>0&&(this.ProductName.Text=this.ScreenObject.SetAutoCodeParams_1(this.ProductName,this.ParentId,e),this.oProduct.ProductName=this.ProductName.Text)}let e=this.ScreenObject.ValidateData();if(e.length>0)return this.MessageVisibility=!0,void(this.DisplayMessage=e);if(("11"==this.ProductTypes.SelectedValue||"12"==this.ProductTypes.SelectedValue)&&(e=this.ValidateModifiers(),e.length>0))return this.MessageVisibility=!0,void(this.DisplayMessage=e);if(this.ProductCode.Visible||(this.oProduct.ProductCode=this.ProductName.Text),this.ProductName.Visible&&(this.oProduct.ProductName=this.ProductName.Text.trim()),this.AliasName.Enable&&(this.oProduct.AliasName=a.e.StringIsNullOrEmpty(this.AliasName.Text)?this.ProductName.Text.trim():this.AliasName.Text),this.ProductTypes.Enable&&(this.oProduct.ProductType=parseInt(this.ProductTypes.SelectedValue)),this.ValuationMethods.Enable&&(this.oProduct.Valuation=parseInt(this.ValuationMethods.SelectedValue)),this.QtyAdjustment.Enable&&(this.oProduct.QtyAdjustment=parseInt(a.e.StringIsNullOrEmpty(this.QtyAdjustment.SelectedValue)?"0":this.QtyAdjustment.SelectedValue)),this.BinWise.Enable)if(a.e.StringIsNullOrEmpty(this.ScreenObject.Data.Tables[10].filter(e=>"BinsDimension"==e.Name)[0].Value)){let e=!1;null==this.BinWise.DefaultValue||"1"!==this.BinWise.DefaultValue&&1!==parseInt(this.BinWise.DefaultValue)||(e=!0),this.oProduct.BinWise=e}else{let e=!1;null==this.BinWise.SelectedValue||"1"!==this.BinWise.SelectedValue&&1!==parseInt(this.BinWise.SelectedValue)||(e=!0),this.oProduct.BinWise=e}this.oProduct.ProductStatus=parseInt(this.ProductStatuses.SelectedValue),""!=this.UOM.SelectedValue&&(this.oProduct.UOM=parseInt(this.UOM.SelectedValue));let i,r=!1;if(null==this.ManufacturerBarcode.SelectedValue||"1"!==this.ManufacturerBarcode.SelectedValue&&1!==parseInt(this.ManufacturerBarcode.SelectedValue)||(r=!0),this.oProduct.ManufacturerBarcode=r,""!=this.BarcodeLayoutID.SelectedValue)this.oProduct.BarcodeLayoutID=parseInt(this.BarcodeLayoutID.SelectedValue);else if("4"==this.ProductTypes.SelectedValue&&""==this.BarcodeLayoutID.SelectedValue)return this.DisplayMessage="Select barcode layout",void(this.MessageVisibility=!0);if(this.oProduct.SalesAccount=this.SalesAccount.SelectedValue,this.oProduct.PurchaseAccount=this.PurchaseAccount.SelectedValue,this.oProduct.COGSAccount=this.COGSAccount.SelectedValue,this.oProduct.ClosingStockAccount=this.ClosingStockAccount.SelectedValue,this.oProduct.ProductGroup=parseInt(this.ProductGroups.SelectedValue.toString()),this.Currency.Enable&&(this.oProduct.Currency=this.Currency.SelectedValue),this.PurchaseRate.Enable&&(this.oProduct.PurchaseRates=a.e.DoubleTryParse(this.PurchaseRate.Text)),this.PurchaseRateA.Enable&&(this.oProduct.PurchaseRateA=a.e.DoubleTryParse(this.PurchaseRateA.Text)),this.PurchaseRateB.Enable&&(this.oProduct.PurchaseRateB=a.e.DoubleTryParse(this.PurchaseRateB.Text)),this.PurchaseRateC.Enable&&(this.oProduct.PurchaseRateC=a.e.DoubleTryParse(this.PurchaseRateC.Text)),this.PurchaseRateD.Enable&&(this.oProduct.PurchaseRateD=a.e.DoubleTryParse(this.PurchaseRateD.Text)),this.PurchaseRateE.Enable&&(this.oProduct.PurchaseRateE=a.e.DoubleTryParse(this.PurchaseRateE.Text)),this.PurchaseRateF.Enable&&(this.oProduct.PurchaseRateF=a.e.DoubleTryParse(this.PurchaseRateF.Text)),this.PurchaseRateG.Enable&&(this.oProduct.PurchaseRateG=a.e.DoubleTryParse(this.PurchaseRateG.Text)),this.SellingRate.Enable&&(this.oProduct.SellingRates=a.e.DoubleTryParse(this.SellingRate.Text)),this.SellingRateA.Enable&&(this.oProduct.SellingRateA=a.e.DoubleTryParse(this.SellingRateA.Text)),this.SellingRateB.Enable&&(this.oProduct.SellingRateB=a.e.DoubleTryParse(this.SellingRateB.Text)),this.SellingRateC.Enable&&(this.oProduct.SellingRateC=a.e.DoubleTryParse(this.SellingRateC.Text)),this.SellingRateD.Enable&&(this.oProduct.SellingRateD=a.e.DoubleTryParse(this.SellingRateD.Text)),this.SellingRateE.Enable&&(this.oProduct.SellingRateE=a.e.DoubleTryParse(this.SellingRateE.Text)),this.SellingRateF.Enable&&(this.oProduct.SellingRateF=a.e.DoubleTryParse(this.SellingRateF.Text)),this.SellingRateG.Enable&&(this.oProduct.SellingRateG=a.e.DoubleTryParse(this.SellingRateG.Text)),null!=this.ReorderLevel&&this.ReorderLevel.Enable&&(this.oProduct.ReorderLevel=a.e.DoubleTryParse(this.ReorderLevel.Text)),null!=this.ReorderQty&&this.ReorderQty.Enable&&(this.oProduct.ReorderQty=a.e.DoubleTryParse(this.ReorderQty.Text),this.oProduct.ReorderQtyType=a.e.IntTryParse(this.ReorderQty.SelectedValue)),null!=this.ReorderTrigger&&this.ReorderTrigger.Enable&&(this.oProduct.ReorderTrigger=a.e.DoubleTryParse(this.ReorderTrigger.Text),this.oProduct.ReorderTriggerType=a.e.IntTryParse(this.ReorderTrigger.SelectedValue)),null!=this.ShelfLife&&this.ShelfLife.Enable&&(this.oProduct.ShelfLife=a.e.DoubleTryParse(this.ShelfLife.Text)),null!=this.PreExpiryDays&&this.PreExpiryDays.Enable&&(this.oProduct.PreExpiryDays=a.e.IntTryParse(this.PreExpiryDays.Text)),null!=this.MaxTolerancePer&&this.MaxTolerancePer.Enable&&(this.oProduct.MaxTolerancePer=a.e.DoubleTryParse(this.MaxTolerancePer.Text)),null!=this.MaxToleranceVal&&this.MaxToleranceVal.Enable&&(this.oProduct.MaxToleranceVal=a.e.DoubleTryParse(this.MaxToleranceVal.Text)),null!=this.MinTolerancePer&&this.MinTolerancePer.Enable&&(this.oProduct.MinTolerancePer=a.e.DoubleTryParse(this.MinTolerancePer.Text)),null!=this.MinToleranceVal&&this.MinToleranceVal.Enable&&(this.oProduct.MinToleranceVal=a.e.DoubleTryParse(this.MinToleranceVal.Text)),null!=this.CreditDays&&this.CreditDays.Enable&&(this.oProduct.CreditDays=a.e.IntTryParse(this.CreditDays.Text)),null!=this.Packing&&this.Packing.Enable&&(this.oProduct.Packing=this.Packing.Text),null!=this.Barcode&&(this.oProduct.Barcode=this.Barcode.Text),null!=this.Category&&this.Category.Enable&&(this.oProduct.Category=this.Category.SelectedValue),null!=this.Department&&this.Department.Enable&&(this.oProduct.Department=this.Department.SelectedValue),this.Description.Enable&&(this.oProduct.Description=null!=this.Description.Tag&&""!=this.Description.Tag?this.Description.Tag:this.Description.Text),this.ProductGroups.Enable&&(this.oProduct.ProductGroup=parseInt(this.ProductGroups.SelectedValue.toString())),0==this.ProductID){if(this.ProductCode.Visible||(this.oProduct.ProductCode=this.ProductCode.DefaultValue),this.ProductName.Visible&&this.ProductName.Enable||(this.oProduct.ProductName=this.ProductName.Text.trim()),this.AliasName.Visible&&this.AliasName.Enable||(this.oProduct.AliasName=this.oProduct.AliasName=this.AliasName.DefaultValue),this.ProductTypes.Visible&&this.ProductTypes.Enable||a.e.StringIsNullOrEmpty(this.ProductTypes.DefaultValue)||(this.oProduct.ProductType=parseInt(this.ProductTypes.DefaultValue)),this.ValuationMethods.Visible&&this.ValuationMethods.Enable||a.e.StringIsNullOrEmpty(this.ValuationMethods.DefaultValue)||(this.oProduct.Valuation=parseInt(this.ValuationMethods.DefaultValue)),this.QtyAdjustment.Visible&&this.QtyAdjustment.Enable||a.e.StringIsNullOrEmpty(this.QtyAdjustment.DefaultValue)||(this.oProduct.QtyAdjustment=a.e.IntTryParse(this.QtyAdjustment.DefaultValue)),!(this.BinWise.Visible&&this.BinWise.Enable||a.e.StringIsNullOrEmpty(this.BinWise.DefaultValue))){let e=!1;null!=this.BinWise.DefaultValue&&"1"===this.BinWise.DefaultValue&&(e=!0),this.oProduct.BinWise=e}0==this.oProduct.ProductID&&(this.ProductStatuses.Visible&&this.ProductStatuses.Enable||a.e.StringIsNullOrEmpty(this.ProductStatuses.DefaultValue)||(this.oProduct.ProductStatus=parseInt(this.ProductStatuses.DefaultValue))),this.UOM.Visible&&this.UOM.Enable||a.e.StringIsNullOrEmpty(this.UOM.DefaultValue)||(this.oProduct.UOM=parseInt(this.UOM.DefaultValue)),this.SalesAccount.Visible&&this.SalesAccount.Enable||a.e.StringIsNullOrEmpty(this.SalesAccount.DefaultValue)||(this.oProduct.SalesAccount=parseInt(this.SalesAccount.DefaultValue)),this.PurchaseAccount.Visible&&this.PurchaseAccount.Enable||a.e.StringIsNullOrEmpty(this.PurchaseAccount.DefaultValue)||(this.oProduct.PurchaseAccount=parseInt(this.PurchaseAccount.DefaultValue)),this.COGSAccount.Visible&&this.COGSAccount.Enable||a.e.StringIsNullOrEmpty(this.COGSAccount.DefaultValue)||(this.oProduct.COGSAccount=parseInt(this.COGSAccount.DefaultValue)),this.ClosingStockAccount.Visible&&this.ClosingStockAccount.Enable||a.e.StringIsNullOrEmpty(this.ClosingStockAccount.DefaultValue)||(this.oProduct.ClosingStockAccount=parseInt(this.ClosingStockAccount.DefaultValue)),this.Currency.Visible&&this.Currency.Enable||a.e.StringIsNullOrEmpty(this.Currency.DefaultValue)||(this.oProduct.Currency=parseInt(this.Currency.DefaultValue)),this.PurchaseRate.Visible||(this.oProduct.PurchaseRates=0),this.PurchaseRateA.Visible||(this.oProduct.PurchaseRateA=0),this.PurchaseRateB.Visible||(this.oProduct.PurchaseRateB=0),this.PurchaseRateC.Visible||(this.oProduct.PurchaseRateC=0),this.PurchaseRateD.Visible||(this.oProduct.PurchaseRateD=0),this.PurchaseRateE.Visible||(this.oProduct.PurchaseRateE=0),this.PurchaseRateF.Visible||(this.oProduct.PurchaseRateF=0),this.PurchaseRateG.Visible||(this.oProduct.PurchaseRateG=0),this.SellingRate.Visible||(this.oProduct.SellingRates=0),this.SellingRateA.Visible||(this.oProduct.SellingRateA=0),this.SellingRateB.Visible||(this.oProduct.SellingRateB=0),this.SellingRateC.Visible||(this.oProduct.SellingRateC=0),this.SellingRateD.Visible||(this.oProduct.SellingRateD=0),this.SellingRateE.Visible||(this.oProduct.SellingRateE=0),this.SellingRateF.Visible||(this.oProduct.SellingRateF=0),this.SellingRateG.Visible||(this.oProduct.SellingRateG=0),null==this.ReorderLevel||this.ReorderLevel.Visible||(this.oProduct.ReorderLevel=0),null==this.ReorderQty||this.ReorderQty.Visible||(this.oProduct.ReorderQty=0),this.ShelfLife.Visible||(this.oProduct.ShelfLife=1),this.PreExpiryDays.Visible||(this.oProduct.PreExpiryDays=0),this.MaxToleranceVal.Visible||(this.oProduct.MaxToleranceVal=0),this.MaxTolerancePer.Visible||(this.oProduct.MaxTolerancePer=0),this.CreditDays.Visible||(this.oProduct.CreditDays=0),null==this.Packing||this.Packing.Visible||(this.oProduct.Packing=""),null==this.Category||this.Category.Visible||(this.oProduct.Category=0),this.Description.Visible||(this.oProduct.Description=""),null==this.Department||this.Department.Visible||(this.oProduct.Department=0),this.ProductGroups.Visible||(this.oProduct.ProductGroup=parseInt(this.ProductGroups.DefaultValue))}if(null!=this.ProductLength&&this.ProductLength.Enable&&(this.oProduct.ProductLength=a.e.DoubleTryParse(this.ProductLength.Text)),null!=this.ProductWidth&&this.ProductWidth.Enable&&(this.oProduct.ProductWidth=a.e.DoubleTryParse(this.ProductWidth.Text)),null!=this.ProductHeight&&this.ProductHeight.Enable&&(this.oProduct.ProductHeight=a.e.DoubleTryParse(this.ProductHeight.Text)),null!=this.ProductVolume&&this.ProductVolume.Enable&&(this.oProduct.ProductVolume=a.e.DoubleTryParse(this.ProductVolume.Text)),null!=this.ProductWeight&&this.ProductWeight.Enable&&(this.oProduct.ProductWeight=a.e.DoubleTryParse(this.ProductWeight.Text)),null!=this.ProductWastage&&this.ProductWastage.Enable&&(this.oProduct.ProductWastage=a.e.DoubleTryParse(this.ProductWastage.Text)),null!=this.KitSize&&this.KitSize.Enable&&(this.oProduct.KitSize=a.e.DoubleTryParse(this.KitSize.Text)),null!=this.SerialNumber&&this.SerialNumber.Enable&&(this.oProduct.SerialNumber=this.SerialNumber.Text),null!=this.ProductWeightable&&this.ProductWeightable.Enable&&(this.oProduct.ProductWeightable=a.e.IntTryParse(this.ProductWeightable.SelectedValue)),null!=this.ProductPacking&&this.ProductPacking.Enable&&(this.oProduct.ProductPacking=a.e.IntTryParse(this.ProductPacking.SelectedValue)),this.ProductLength.Visible||(this.oProduct.ProductLength=0),this.ProductWidth.Visible||(this.oProduct.ProductWidth=0),this.ProductHeight.Visible||(this.oProduct.ProductHeight=0),this.ProductVolume.Visible||(this.oProduct.ProductVolume=0),this.ProductWeight.Visible||(this.oProduct.ProductWeight=0),this.ProductWastage.Visible||(this.oProduct.ProductWastage=0),this.KitSize.Visible||(this.oProduct.KitSize=1),this.SerialNumber.Visible||(this.oProduct.SerialNumber=""),this.ProductWeightable.Visible&&this.ProductWeightable.Enable||(this.oProduct.ProductWeightable=a.e.IntTryParse(this.ProductWeightable.DefaultValue)),this.ProductPacking.Visible&&this.ProductPacking.Enable||(this.oProduct.ProductPacking=a.e.IntTryParse(this.ProductPacking.DefaultValue)),null!=this.ProductBillOfEntry&&this.ProductBillOfEntry.Enable&&(this.oProduct.ProductBillOfEntry=a.e.IntTryParse(this.ProductBillOfEntry.SelectedValue)),null!=this.ReorderPolicy&&this.ReorderPolicy.Enable&&(this.oProduct.ReorderPolicy=a.e.IntTryParse(this.ReorderPolicy.SelectedValue)),null!=this.MaxInventoryLevel&&this.MaxInventoryLevel.Enable&&(this.oProduct.MaxInventoryLevel=a.e.DoubleTryParse(this.MaxInventoryLevel.Text)),null!=this.ReorderMinOrderQty&&this.ReorderMinOrderQty.Enable&&(this.oProduct.ReorderMinOrderQty=a.e.DoubleTryParse(this.ReorderMinOrderQty.Text)),null!=this.ReorderMaxOrderQty&&this.ReorderMaxOrderQty.Enable&&(this.oProduct.ReorderMaxOrderQty=a.e.DoubleTryParse(this.ReorderMaxOrderQty.Text)),null!=this.ReorderOrderMultiple&&this.ReorderOrderMultiple.Enable&&(this.oProduct.ReorderOrderMultiple=a.e.DoubleTryParse(this.ReorderOrderMultiple.Text)),null!=this.PlanningMethod&&this.PlanningMethod.Enable&&(this.oProduct.PlanningMethod=a.e.IntTryParse(this.PlanningMethod.SelectedValue)),null!=this.ProcurementMethod&&this.ProcurementMethod.Enable&&(this.oProduct.ProcurementMethod=a.e.IntTryParse(this.ProcurementMethod.SelectedValue)),null!=this.LeadTime&&this.LeadTime.Enable&&(this.oProduct.LeadTime=a.e.DoubleTryParse(this.LeadTime.Text)),null!=this.SafetyStock&&this.SafetyStock.Enable&&(this.oProduct.SafetyStock=a.e.DoubleTryParse(this.SafetyStock.Text)),null!=this.ProductBOM&&this.ProductBOM.Enable&&(this.oProduct.ProductBOM=this.ProductBOM.SelectedValue),null!=this.PurchaseBinRule&&this.PurchaseBinRule.Enable&&(this.oProduct.PurchaseBinRule=a.e.IntTryParse(this.PurchaseBinRule.SelectedValue)),null!=this.SalesBinRule&&this.SalesBinRule.Enable&&(this.oProduct.SalesBinRule=a.e.IntTryParse(this.SalesBinRule.SelectedValue)),this.ProductBillOfEntry.Visible&&this.ProductBillOfEntry.Enable||(this.oProduct.ProductBillOfEntry=a.e.IntTryParse(this.ProductBillOfEntry.DefaultValue)),this.ReorderPolicy.Visible&&this.ReorderPolicy.Enable||(this.oProduct.ReorderPolicy=a.e.IntTryParse(this.ReorderPolicy.DefaultValue)),this.MaxInventoryLevel.Visible||(this.oProduct.MaxInventoryLevel=0),this.ReorderMinOrderQty.Visible||(this.oProduct.ReorderMinOrderQty=0),this.ReorderMaxOrderQty.Visible||(this.oProduct.ReorderMaxOrderQty=0),this.ReorderOrderMultiple.Visible||(this.oProduct.ReorderOrderMultiple=0),this.PlanningMethod.Visible&&this.PlanningMethod.Enable||(this.oProduct.PlanningMethod=a.e.IntTryParse(this.PlanningMethod.DefaultValue)),this.ProcurementMethod.Visible&&this.ProcurementMethod.Enable||(this.oProduct.ProcurementMethod=a.e.IntTryParse(this.ProcurementMethod.DefaultValue)),this.LeadTime.Visible||(this.oProduct.LeadTime=0),this.SafetyStock.Visible||(this.oProduct.SafetyStock=0),this.ProductBOM.Visible&&this.ProductBOM.Enable||(this.oProduct.ProductBOM=parseInt(this.ProductBOM.DefaultValue)),this.oProduct.PurchaseUom=null!=this.PurchaseUOM&&this.PurchaseUOM.Visible&&!a.e.IsEmpty(this.PurchaseUOM.SelectedValue)?this.PurchaseUOM.SelectedValue:"",this.PurchaseBinRule.Visible&&this.PurchaseBinRule.Enable||(this.oProduct.PurchaseBinRule=a.e.IntTryParse(this.PurchaseBinRule.DefaultValue)),this.SalesBinRule.Visible&&this.SalesBinRule.Enable||(this.oProduct.SalesBinRule=a.e.IntTryParse(this.SalesBinRule.DefaultValue)),this.oProduct.IsSubItemProduct=!1,this.oProduct.CustomFieldsQuery=this.ScreenObject.GetCustomFieldsQuery(),this.oProduct.CustomCostCenterFieldsQuery=this.ScreenObject.GetCustomCostCenterFieldsQuery(),this.oProduct.ContactsXML=this.ViewContacts.GetXML(),this.oProduct.NotesXML=this.ViewNotes.GetXML(),this.oProduct.SubstitutesXML=this.ViewSubstitutes.GetXML(),this.oProduct.VendorsXML=this.ViewVendors.GetXML(),this.oProduct.KitXML=this.ProductKit.GetKitXML(0,0),this.oProduct.SpecsXML=this.ProductSpecs.SpecsXML(),this.oProduct.LinkXML=null!=this.Linkedcc&&this.Linkedcc.SelectedValue>0?this.ProductLink.GetKitXML(this.Linkedcc.CCID,this.Linkedcc.SelectedValue):"",this.oProduct.HistoryXML=this.ScreenObject.HistoryCCXML,this.oProduct.StatusXML=this.StatusAssignGrid.GetXML(),this.oProduct.KitXML.length>0&&(this.oProduct.KitXML="<XML>"+this.oProduct.KitXML+"</XML>"),this.oProduct.LinkXML.length>0&&(this.oProduct.LinkXML="<XML>"+this.oProduct.LinkXML+"</XML>"),""!=this.ProductSerialization.Expires&&null!=this.ProductSerialization.Expires)return this.DisplayMessage=s.a.GetResource("Invalid")+" Warranty Expires",void(this.MessageVisibility=!0);if(this.oProduct.SerializationXML=this.ProductSerialization.GetXml(),this.oProduct.IsMatrixItem=this.ProductAttributes.IsMatrixItem,this.oProduct.MatrixID=this.ProductAttributes.SelectedValue,this.oProduct.LotWise=Object(o.j)(1==this.ProductAttributes.LSelectedValue),this.oProduct.TestcasesXML=s.a.SessionManager.Preferences.ContainsKey("TestCaseDimension")&&""!=s.a.SessionManager.Preferences.TestCaseDimension&&parseInt(s.a.SessionManager.Preferences.TestCaseDimension)>0?this.ProductTestcases.GetXml():"",!this.ViewBins.ValidateBins())return;if(""!=this.ViewBins.ValidateBinsCapacity())return this.MessageVisibility=!0,void(this.DisplayMessage=this.ViewBins.ValidateBinsCapacity());if(this.oProduct.BinXml=this.ViewBins.GetXML(),this.AssetGroup.Visible){if(0==this.AssetGroup.SelectedValue&&this.oProduct.IsGroup)return void(this.DisplayMessage="Select Asset Group");this.oProduct.AssetGroupID=this.AssetGroup.SelectedValue}this.ProductAttributes.AttributePanel&&"4"==this.ProductTypes.SelectedValue?(this.oProduct.AttributesXML=this.ProductAttributes.GetXml(),this.oProduct.AttributesData="",this.oProduct.IsSubItemProduct=!0):(this.oProduct.AttributesXML="",this.oProduct.AttributesData="",this.oProduct.IsSubItemProduct=!1);let n={strXML:""};if(this.DisplayMessage=this.ViewCCMapping.GetXML(n),i=n.strXML,!a.e.StringIsNullOrEmpty(this.DisplayMessage))return;let h="";h+="<XML>",h+=i.replace("<XML>","").replace("</XML>","");for(let t=0;t<this.ScreenObject.CustomTab.Pages.length;t++)if(this.ScreenObject.CustomTab.Pages[t].QuickViewCCID>0)for(let e=0;e<this.ScreenObject.CustomTab.Pages[t].Fields.length;e++)if(this.ScreenObject.CustomTab.Pages[t].Fields[e]instanceof g.a){let i=this.groupBy(this.ScreenObject.CustomTab.Pages[t].Fields[e].Table,e=>e.Dimension_Key);i.sort((e,t)=>e.SNO-t.SNO);for(let e=0;e<i.length;e++)a.e.IsEmpty(i[e].Dimension_Key)||(h+="<Row ",h+=' CostCenterId="'+this.ScreenObject.CustomTab.Pages[t].QuickViewCCID.toString()+'"',h+=' NodeID="'+i[e].Dimension_Key.toString()+'"',h+="/>")}if(h+="</XML>",this.oProduct.CCCCMapDATA=h.toString(),this.ProductAttributes.AttributePanel&&"4"==this.ProductTypes.SelectedValue){let e="",t=this.ProductAttributes.StockList;if(null!=t&&null!=t&&t.length>0){let i="";this.ScreenObject.CustomTab.Pages.forEach(e=>{e.Fields.forEach(e=>{if(e instanceof d.b&&(null!=e.DBColumnName&&e.DBColumnName.toLowerCase().Contains("ccnid")||null!=e.DBColumnName&&("accountid"==e.DBColumnName.toLowerCase()||"productid"==e.DBColumnName.toLowerCase()))){let t=e;0!=t.SelectedValue&&0==this.ProductAttributes.CCList.filter(e=>e.FeatureID==t.CCID).length&&(i+=t.DBColumnName+"='"+t.SelectedValue+"',")}})}),e+="<ItemProducts>";for(let s=0;s<t.length;s++)e+="<Row RowNo='"+(s+1)+"'   ProductName='"+l.d.GetValidXml(t[s].ItemName.toString())+"' ",e+="ProductCode='"+l.d.GetValidXml(t[s].ItemCode.toString())+"'  ",e+="AliasName='"+l.d.GetValidXml(t[s].ItemName.toString())+"'  ",e+="ProductType='"+this.oProduct.ProductType+"'  ",e+="Valuation='"+this.oProduct.Valuation+"' ",e+="ProductStatus='"+this.oProduct.ProductStatus+"' ",e+="LotWise='"+this.oProduct.LotWise+"' ",e+="UOM='"+this.oProduct.UOM+"'  ",e+="Currency='"+this.oProduct.Currency+"'  ",e+="SalesAccount='"+this.oProduct.SalesAccount+"'  ",e+="PurchaseAccount='"+this.oProduct.PurchaseAccount+"'  ",e+="COGSAccount='"+this.oProduct.COGSAccount+"'   ",e+="ClosingStockAccount='"+this.oProduct.ClosingStockAccount+"' ",e+="ProductGroup='"+this.oProduct.ProductGroup+"'  ",e+="IsGroup='0'  ",e+='CustomFieldsQuery ="'+this.oProduct.CustomFieldsQuery+'"  ',e+='CustomFieldCCMapXML="'+i+t[s].AttributeMap.toString()+'"  ',e+="ContactsXML='"+this.oProduct.ContactsXML+"'  ",e+="NotesXML='"+this.oProduct.NotesXML+"'  ",e+="AttachmetsXML='"+this.oProduct.AttachmetsXML+"'  ",e+="SubstitutesXML='"+this.oProduct.SubstitutesXML+"' ",e+="VendorsXML='"+this.oProduct.VendorsXML+"'  />";e+="</ItemProducts>",this.oProduct.ItemProductData=e.toString()}}if("4"==this.ProductTypes.SelectedValue&&a.e.StringIsNullOrEmpty(this.oProduct.ItemProductData)&&!this.ProductAttributes.IsMatrixItem)return void(this.DisplayMessage="Please select sub products");if("-399"==this.UOM.SelectedValue){let e="";if(e+="<Data>",0==this.AddEditUOM.BaseText.length)return void(this.DisplayMessage="Cannot Save Empty Unit Name");if(e+="<Row",e+=" BaseID='"+this.AddEditUOM.Units1.SelectedValue+"'  ",e+=" Conversion='"+this.AddEditUOM.RateText+"' ",e+=" BaseName='"+this.AddEditUOM.BaseText+"' /> ",e+="</Data>",this.oProduct.ProductwiseUOM1=e.toString(),null!=this.AddEditUOM.GridUnits&&this.AddEditUOM.GridUnits.length>0){let t;e="",e+="<Data>";let i=new Array;for(let s=0;s<this.AddEditUOM.GridUnits.length;s++)if(!a.e.StringIsNullOrEmpty(this.AddEditUOM.GridUnits[s]["Unit Name"])){if(t=this.AddEditUOM.GridUnits[s]["Unit Name"].toString().Trim(),i.Contains(t))return void(this.DisplayMessage="Duplicate Unit Name - '"+t+"'");if(a.e.IsEmpty(this.AddEditUOM.GridUnits[s]["Conversion Rate"])||""==a.e.String(this.AddEditUOM.GridUnits[s]["Conversion Rate"]).Trim())return void(this.DisplayMessage="UOM - Conversion Rate Should not be empty - '"+t+"'");if(parseFloat(this.AddEditUOM.GridUnits[s]["Conversion Rate"])<=0)return void(this.DisplayMessage="UOM - Conversion Rate Should be Greater than 0 - '"+t+"'");i.push(t),e+='<Row UnitName="'+t+'"',e+=' UnitiD="'+a.e.String(this.AddEditUOM.GridUnits[s].UnitID)+'"',a.e.StringIsNullOrEmpty(this.AddEditUOM.GridUnits[s].PrimayColumn)?e+=' Action="NEW"':e+=' Action="UPDATE"',e+=' BaseID="'+this.AddEditUOM.Units1.SelectedValue+'"',e+=' BaseName="'+this.AddEditUOM.BaseText+'"',e+=' Conversion="'+this.AddEditUOM.RateText+'"',e+=' ConversionUnit="'+a.e.String(this.AddEditUOM.GridUnits[s]["Conversion Rate"])+'"',e+=' Barcode="'+a.e.String(this.AddEditUOM.GridUnits[s].Barcode)+'"',e+=' MultiBarcode="'+a.e.String(this.AddEditUOM.GridUnits[s].Barcodes)+'"',this.AddEditUOM.ShowBarcodeDimension&&!a.e.StringIsNullOrEmpty(this.AddEditUOM.GridUnits[s].Barcode_Key)&&(e+=' BarKey="'+this.AddEditUOM.GridUnits[s].Barcode_Key.toString()+'"'),e+="/>"}for(let s=0;s<this.AddEditUOM.lstDeletedint.length;s++)e+='<Row Action="DELETE"',e+=' UnitiD="'+this.AddEditUOM.lstDeletedint[s]+'"/>';e+="</Data>",this.oProduct.ProductwiseUOM=e.toString()}}try{this.oProduct.AttachmetsXML=this.ViewAttachments.GetXML(),this.oProduct.AttachmetsXML+=this.ScreenObject.GetExtraAttachmentXML();let e="";this.IsPhotoChanged&&!a.e.StringIsNullOrEmpty(this.ProductPhoto)?(e+=0==this.FileID?'<Row Action="NEW"':'<Row Action="MODIFY"',e+=s.a.SessionManager.IsWebApplication?' ActualFileName="'+this.ProductPhoto.substring(this.ProductPhoto.lastIndexOf("\\")+1)+'"':' ActualFileName="'+this.ActualFileName+'"',e+=' AttachmentID="'+this.FileID+'"',e+=' FilePath="'+this.ProductPhoto+'"',e+=' RelativeFileName="'+this.ProductPhoto+'"',e+=' FileExtension="'+this.FileExtension+'"',e+=' FileDescription="'+l.d.GetValidXml(this.FileDescription)+'"',e+=' IsProductImage="1"',e+=' IsDefaultImage="1"',e+=' GUID="'+this.guid+'"',a.e.StringIsNullOrEmpty(this.ThumbnailPhoto)||(e+=' HasThumb="1"'),e+="/>"):this.IsPhotoDelete&&this.FileID>0&&(e+='<Row Action="DELETE"',e+=' AttachmentID="'+this.FileID+'"/>'),e.length>0&&(e="<AttachmentsXML>"+e+"</AttachmentsXML>",this.oProduct.AttachmetsXML=this.oProduct.AttachmetsXML+e.toString())}catch(t){return this.DisplayMessage=s.a.GetResource("Upload_Path_notExists"),void(this.MessageVisibility=!0)}if(!this.ScreenObject.ValidateDataonSave())return;this.oProduct.WID=this.ScreenObject.CheckWorkFlow();let c=this.ScreenObject.Data.Tables[10].filter(e=>"LinkDimensionBasedOn"==e.Name);this.oProduct.IsLink=this.ScreenObject.EvaluateExpression(c[0].Value.toString(),this.oProduct.IsGroup);let u=0;this.oProduct.AddProduct("","AddProduct").subscribe(e=>{if(this.DisplayMessage=e.Message,this.RetValue=e.RetValue,this.MessageVisibility=!0,u=this.RetValue,u>0||u<-1e4){s.a.page.tabs.forEach(e=>{e.instance instanceof he.TreeViewPageComponent&&e.instance.obj&&3==e.instance.CostCenterID&&(e.instance.obj.SetFocusNodeID=e.instance.obj.SelectedNode.Id,e.instance.Refresh())}),this.oProduct.ProductID=0,this.ProductPhoto="",this.ActualFileName="",this.ImageHeight=(parseInt(this.ImageHeight)-20).toString(),this.IsPhotoDelete=!1,this.ScreenObject.Clear(),this.ViewSubstitutes.SubstitutesObj.Clear(),this.ViewContacts.ContactsListObj.Clear(),this.ViewNotes.NotesListObj.Clear(),this.ViewAttachments.AttachmentsListObj.Clear(),this.ViewSubstitutes.SubstitutesList.Clear(),this.ViewVendors.VendorsList.Clear(),this.ViewBins.BinsObj.Clear(),this.ProductKit.KitGrid.Table.Clear(),this.ProductKit.ModGrid.Table.Clear(),this.ProductSpecs.KitGrid.Table.Clear(),this.ProductLink.KitGrid.Table.Clear(),this.ProductTestcases.TestcaseGrid.Table.Clear(),this.StatusAssignGrid.Clear(),null!=this.PriceChart&&null!=this.PriceChart.PriceGrid&&null!=this.PriceChart.PriceGrid.Table&&this.PriceChart.PriceGrid.Table.length>0&&this.PriceChart.PriceGrid.Table.Clear(),this.ViewCCMapping.Clear(),this.ViewCCMapping.OnShowCC(null),this.CCMapVisibility=!1,this.ViewAttachments.OnShowNewAttachment(null),this.HideControls(),this.ProductAttributes.Clear(),this.ProductKit.KitGrid.AddExtraEmptyRows(10),this.ProductKit.ModGrid.AddExtraEmptyRows(3),this.ProductSerialization.Expires="",this.ProductSerialization.SelectedValue=0,this.ProductSerialization.IsChecked=!0,this.ProductSerialization.ItemListObj.Clear(),this.ProductBOM.SearchVisible&&(this.ProductBOM.CustomWhere="1!=1"),this.AutoGenerateCode(),this.RefreshTitle(),this.ParentId>0&&(this.ProductGroups.SelectedValue=this.ParentId,this.ProductTypes.SelectedValue=this.oProduct.ProductType.toString()),"Assign"!=this.ScreenObject.CustomTab.SelectedTab.Name&&(this.CCMapVisibility=!1),this.InheritGrpImage&&this.OnLoadImage("Group",this.ProductGroups.SelectedValue);let e=this.ScreenObject.Data.Tables[10].filter(e=>"ShowCurrentSavedData"==e.Name);e.length>0&&!a.e.IsEmpty(e[0].Value)&&Object(o.j)(e[0].Value)&&(this.oProduct.ProductID=this.RetValue,this.RefreshTitle(),this.LoadEditData())}},e=>{console.log("Employee Master Save : "+JSON.stringify(e))}),Logger.InfoLog("AddProductViewModel::Exiting OnSaveProduct")}catch(i){this.DisplayMessage="OnSaveProduct",Logger.ErrorLog("AddProductViewModel:: OnSaveProduct"+i.stack)}}Logger.InfoLog("OnSaveProduct :: Exiting OnSaveProduct")}groupBy(e,t){const i=new Map;let s=[];return e.forEach(e=>{const o=t(e),r=i.get(o);r?r.push(e):(i.set(o,[e]),a.e.IsEmpty(e.Dimension_Key)||s.push(e))}),s}ValidateModifiers(){if(0==this.ProductKit.ModGrid.Table.length)return"Enter atleast one Modifier";if(0==this.ProductKit.KitGrid.Table.length)return"Select atleast one Product for the Modifier";let e=[],t="",i=0,s=0,a=0;for(let o=0;o<this.ProductKit.ModGrid.Table.length;o++)if(null!=this.ProductKit.ModGrid.Table[o].ModifierName&&null!=this.ProductKit.ModGrid.Table[o].ModifierName&&""!=this.ProductKit.ModGrid.Table[o].ModifierName.toString().Trim()){if(t=this.ProductKit.ModGrid.Table[o].ModifierName.toString().trim(),i=0,s=0,e.Contains(t))return"Can not allow same Modifiers";if(e.push(this.ProductKit.ModGrid.Table[o].ModifierName.toString().Trim()),a++,null==this.ProductKit.ModGrid.Table[o].MinSelect||null==this.ProductKit.ModGrid.Table[o].MinSelect||""==this.ProductKit.ModGrid.Table[o].MinSelect.toString().Trim())return"Enter Min. Select for the Modifier at Row No. - "+(o+1);if(i=parseInt(this.ProductKit.ModGrid.Table[o].MinSelect),null==this.ProductKit.ModGrid.Table[o].MaxSelect||null==this.ProductKit.ModGrid.Table[o].MaxSelect||""==this.ProductKit.ModGrid.Table[o].MaxSelect.toString().Trim())return"Enter Max. Select for the Modifier at Row No. - "+(o+1);if(s=parseInt(this.ProductKit.ModGrid.Table[o].MaxSelect),i>s)return"Min. Select should be less than or equal to Max. Select for the Modifier at Row No. - "+(o+1);if(0==a)return"Enter atleast one Modifier"}a=0;for(let o=0;o<this.ProductKit.KitGrid.Table.length;o++)if(""!=this.ProductKit.KitGrid.Table[o].PRODUCT_Key.toString()&&(a++,null==this.ProductKit.KitGrid.Table[o].ModifierName||null==this.ProductKit.KitGrid.Table[o].ModifierName||""==this.ProductKit.KitGrid.Table[o].ModifierName.toString().Trim()))return"Select Modifier at Row No. - "+(o+1);return 0==a?"select atleast one Product for the Modifier":""}OnBarcodeTextChanged(e){null!=this.Barcode.Text&&(this.ManufacturerBarcode.SelectedValue=this.Barcode.Text.trim().length>0?"1":"0")}OnProductTypeSelectionChanged(e){Logger.InfoLog("OnProductTypeSelectionChanged:: Entering OnProductTypeSelectionChanged"),this.OnTypeChanged(),Logger.InfoLog("OnProductTypeSelectionChanged:: Exiting OnProductTypeSelectionChanged")}OnTypeChanged(){this.AssetGroup.Visible=!!(this.oProduct.IsGroup&&"10"==this.ProductTypes.SelectedValue||this.AssetGroupVisible&&!this.oProduct.IsGroup&&"1"==this.ProductTypes.SelectedValue),this.ProductTypes.Enable&&(this.ScreenObject.CustomTab.Pages.forEach(e=>{switch(e.Name){case"Kit":if("3"==this.ProductTypes.SelectedValue||"7"==this.ProductTypes.SelectedValue||"8"==this.ProductTypes.SelectedValue||"9"==this.ProductTypes.SelectedValue)e.Enable=!0,this.KitSize.Visible=!0,this.KitSize.Enable=!0,this.ProductKit.KitGrid.Enable=!0,this.ProductKit.ModGrid.Visible=!1,null!=(t=this.ProductKit.KitGrid.Columns.find(e=>"ModifierName"==e.ValueBinding))&&(t.IsVisible=!1);else if("11"==this.ProductTypes.SelectedValue||"12"==this.ProductTypes.SelectedValue)e.Enable=!0,this.KitSize.Visible=!1,this.KitSize.Enable=!1,this.ProductKit.KitGrid.Enable=!0,this.ProductKit.ModGrid.Visible=!0,null!=(t=this.ProductKit.KitGrid.Columns.find(e=>"ModifierName"==e.ValueBinding))&&(t.IsVisible=!0);else{var t;e.Enable=!1,this.KitSize.Enable=!1,this.KitSize.Visible=!0,this.ProductKit.KitGrid.Enable=!1,this.ProductKit.ModGrid.Visible=!1,null!=(t=this.ProductKit.KitGrid.Columns.find(e=>"ModifierName"==e.ValueBinding))&&(t.IsVisible=!1)}let i=[];for(let e=0;e<this.ProductKit.KitGrid.Columns.length;e++)i.push(this.ProductKit.KitGrid.Columns[e]);this.ProductKit.KitGrid.Columns=i;break;case"Attributes":e.Enable="4"==this.ProductTypes.SelectedValue;break;case"Serial":e.Enable="2"==this.ProductTypes.SelectedValue||"7"==this.ProductTypes.SelectedValue}}),this.oProduct.IsMatrixItem=!1),this.ScreenObject.SetViewByType(this.ProductTypes.SelectedValue,this.oProduct.IsGroup)}OnTextChanged_string(e){null!=e&&null!=e&&(!this.NameSameasCode||this.ProductCode.PrefixVisibility||this.ProductCode.SuffixVisibility?this.NameSameasCode&&this.ProductCode.PrefixVisibility&&this.ProductCode.SuffixVisibility?this.ProductName.Text=this.ProductCode.PrefixCode+this.ProductCode.SuffixCode:this.NameSameasCode&&this.ProductCode.PrefixVisibility&&!this.ProductCode.SuffixVisibility?this.ProductName.Text=this.ProductCode.PrefixCode+this.ProductCode.Text:this.NameSameasCode&&!this.ProductCode.PrefixVisibility&&this.ProductCode.SuffixVisibility&&(this.ProductName.Text=this.ProductCode.Text+this.ProductCode.SuffixCode):this.ProductName.Text=this.ProductCode.Text)}HideControls(){this.ContactVisibility=!1,this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.SubstituteVisibility=!1,this.CCMapVisibility=!1,this.VendorVisibility=!1,this.DetailsVisibility=!1,this.UOMVisibility=!1}OnNameLostFocus(e){if(!a.e.StringIsNullOrEmpty(this.ProductName.Text)){let e=s.a.accounting.CheckDuplicateName(3,this.ProductID,this.ProductName.Text,0,this.oProduct.IsGroup);e.length>0&&(this.DisplayMessage=e)}this.ScreenObject.onTextBoxLostFocus(e)}OnGroupSelectionChanged(e){null!=e&&null!=e&&"Group"==e.toString()&&(this.ProductGroups.SelectedValue>0&&(this.ProductGroups.DefaultValue=this.ProductGroups.SelectedValue.toString(),this.AutoGenerateCode(),this.LoadParentData()),this.InheritGrpImage&&this.OnLoadImage("Group",this.ProductGroups.SelectedValue))}ParentCallBack(e){null!=e.SelectedNode&&e.PickerType.startsWith("PRODUCTGROUPS")&&(this.ProductGroups.SelectedValue=e.SelectedNode.Id)}LoadParentData(){if(0!=this.ProductID||0==this.ParentId||this.oProduct.IsGroup)return;let e=this.ScreenObject.Data.Tables[10].filter(e=>"Copygroupdatatonode"==e.Name);if(0==e.length||a.e.StringIsNullOrEmpty(e[0].Value)||!Object(o.j)(e[0].Value))return;let t=this.oProduct.GetCopyProductDetails(this.ParentId);if(0==t.Tables[0].length)return;let i=null,s=null,r=null;if(t.Tables.length>0&&t.Tables[0].length>0&&(i=t.Tables[0][0]),t.Tables.length>1&&t.Tables[1].length>0&&(s=t.Tables[1][0]),t.Tables.length>7&&t.Tables[7].length>0&&(r=t.Tables[7][0]),this.ScreenObject.FillParentData(i,s,r,["ProductCode","ProductName","ProductGroup"]),t.Tables.length>13&&(this.dtProductWise=t.Tables[13],this.LoadUnitsProductWise(t.Tables[13])),null!=this.Linkedcc&&(50006==this.Linkedcc.CCID&&this.OnlinkccChanged(this.Category),50004==this.Linkedcc.CCID&&this.OnlinkccChanged(this.Department)),e=this.ScreenObject.Data.Tables[10].filter(e=>"CopyGroupTabs"==e.Name),e.length>0&&""!=e[0].Value.toString()){let i=e[0].Value.toString().split(";");if(null!=i&&i.length>0)for(let s=0;s<i.length;s++)if(e=this.ScreenObject.Data.Tables[this.ScreenObject.Data.Tables.length-1].filter(e=>e.CCTabID==i[s]),e.length>0&&!a.e.StringIsNullOrEmpty(e[0].CCTabName))switch(e[0].CCTabName.toString()){case"Kit":this.ProductKit.LoadBundels(t.Tables[8]);break;case"Attributes":this.oProduct.IsMatrixItem&&this.ProductAttributes.LoadAttributes(t.Tables[0],!0);break;case"Serial":this.ProductSerialization.LoadSerialization(t.Tables[9]);break;case"Notes":t.Tables[3].length>0&&(t.Tables[3].Columns.NoteID.Expression="0",this.ViewNotes.LoadNotes(t.Tables[3]));break;case"Attachments":t.Tables[4].length>0&&(t.Tables[4].Columns.FileID.Expression="0",this.ViewAttachments.LoadAttachments(t.Tables[4]));break;case"Vendors":this.ViewVendors.LoadVendors(t.Tables[6]);break;case"Substitutes":this.ViewSubstitutes.LoadSubstitutes(t.Tables[5]);break;case"Assign":break;case"TestCases":this.ProductTestcases.LoadData(t.Tables[18]);break;case"Production Process":break;case"Link":this.ProductLink.LoadBundels(t.Tables[8]);break;case"Bins":t.Tables.length>17&&this.ViewBins.LoadBins(t.Tables[17]);break;default:parseInt(e[0].QuickViewCCID.toString())>0&&(this.LoadQuickAssign(t.Tables[11],parseInt(e[0].CCTabID.toString())),t.Tables[11].filter(t=>t.CostCenterId==e[0].QuickViewCCID.toString()).forEach(e=>{t.Tables[11].Remove(e)}))}}}LoadQuickAssign(e,t){for(let i=0;i<this.ScreenObject.CustomTab.Pages.length;i++)if(this.ScreenObject.CustomTab.Pages[i].DBColumnID==t)for(let t=0;t<this.ScreenObject.CustomTab.Pages[i].Fields.length;t++)if(this.ScreenObject.CustomTab.Pages[i].Fields[t]instanceof g.a){let o,r=this.ScreenObject.CustomTab.Pages[i].Fields[t],n=e.filter(e=>e.CostCenterId==this.ScreenObject.CustomTab.Pages[i].QuickViewCCID),l="";r.Table.Clear(),n.forEach(e=>{let t=r.NewRow();t.Dimension_Key=e.NodeID,t.Dimension=e.Value,r.addRow(t),l=l+e.NodeID+","});for(let e=0;e<15;e++)o=r.NewRow(),r.addRow(o);let h=null;this.ScreenObject.CustomTab.Pages[i].QuickViewID>0&&(h=s.a.common.GetCostCenterQuickViewSummary(this.ScreenObject.CustomTab.Pages[i].QuickViewCCID,l.TrimEnd(","),this.ScreenObject.CustomTab.Pages[i].QuickViewCCID,new Date,"",0,this.ScreenObject.CustomTab.Pages[i].QuickViewID));let d=1;r.Table.forEach(e=>{if(e.SNO=d++,!a.e.IsEmpty(e.Dimension_Key)&&null!=h&&h.Tables.length>0&&h.Tables[0].length>0&&!h.Columns[0].Contains("ErrorMessage")){let t=h.Tables[0].filter(t=>t.NodeID==e.Dimension_Key.toString());for(let i=2;i<h.Columns[0].length;i++)"FileExtension"!=h.Columns[0][i]&&"FileGUID"!=h.Columns[0][i]&&(e["fld"+h.Columns[0][i]]=t[0][h.Columns[0][i]].toString())}})}}RefreshTitle(){this.oProduct.IsGroup?(this.Title=s.a.GetResource(0==this.oProduct.ProductID?"Product_CreateGroup":"Product_EditGroup"),s.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=s.a.SessionManager.IsActionAssigned(3,"Create Group"):this.ButtonSave.Enable=s.a.SessionManager.IsActionAssigned(3,"Create Group")):0==this.oProduct.ProductID?(this.Title=s.a.GetResource("Product_NewScreenName"),s.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=s.a.SessionManager.IsActionAssigned(3,"Create"):this.ButtonSave.Enable=s.a.SessionManager.IsActionAssigned(3,"Create")):(this.Title=s.a.GetResource("Product_EditScreenName"),s.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=s.a.SessionManager.IsActionAssigned(3,"Update"):this.ButtonSave.Enable=s.a.SessionManager.IsActionAssigned(3,"Update"))}}class be{constructor(e,t,i,s,a,o){this.UOMID=0,this.UnitConverstion=a,this.UnitID=e,this.UnitName=t,this.BaseID=i,this.BaseName=s,this.MapAction=o}}},hIrt:function(e,t,i){"use strict";i.r(t),i.d(t,"CopyProductComponent",(function(){return u}));var s=i("vfbs"),a=i("fXoL"),o=i("3Pt+"),r=i("q8k3"),n=i("ofXK"),l=i("sYmb");function h(e,t){if(1&e&&(a.Zb(0,"div",3),a.Wc(1,"\n                "),a.Vb(2,4),a.Wc(3,"\n            "),a.Yb()),2&e){const e=a.lc();a.Db(2),a.tc("obj",e.obj.Reports)("group",e.obj.form)}}function d(e,t){if(1&e&&(a.Zb(0,"div"),a.Wc(1,"\n              "),a.Vb(2,4),a.Wc(3,"\n            "),a.Yb()),2&e){const e=a.lc().$implicit,t=a.lc();a.Ib("form-group col-xl-3  col-md-",3," col-sm-",4," col-xs-3 PACTControl"),a.Db(2),a.tc("obj",e)("group",t.obj.form)}}function c(e,t){if(1&e&&(a.Xb(0),a.Wc(1,"\n            "),a.Uc(2,d,4,6,"div",10),a.Wc(3,"\n          "),a.Wb()),2&e){const e=t.$implicit;a.Db(2),a.tc("ngIf",e.Visible)}}let u=(()=>{class e extends s.a{constructor(){super()}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=a.Nb({type:e,selectors:[["app-copy-product"]],features:[a.Ab],decls:34,vars:11,consts:[[1,"master-screen",3,"formGroup"],[1,"PACTHeaderFields","dialogSubBody"],[1,"row","form-row"],[1,"form-group","col-xl-6","col-md-6","col-sm-6","col-xs-6","PACTControl"],["FieldDirective","",3,"obj","group"],["class","form-group col-xl-6  col-md-6 col-sm-6 col-xs-6 PACTControl",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"Pactdailogfooter"],[1,"primary-btn-wicon",3,"click"],[1,"secondary-btn-wicon",3,"click"],[3,"class",4,"ngIf"]],template:function(e,t){1&e&&(a.Zb(0,"div",0),a.Wc(1,"\n    "),a.Zb(2,"div",1),a.Wc(3,"\n        "),a.Zb(4,"div",2),a.Wc(5,"\n            "),a.Zb(6,"div",3),a.Wc(7,"\n                "),a.Vb(8,4),a.Wc(9,"\n            "),a.Yb(),a.Wc(10,"\n            "),a.Uc(11,h,4,2,"div",5),a.Wc(12,"\n        "),a.Yb(),a.Wc(13,"\n        "),a.Zb(14,"div",2),a.Wc(15,"\n        "),a.Uc(16,c,4,1,"ng-container",6),a.Wc(17,"\n        "),a.Yb(),a.Wc(18,"\n        \n      \n  "),a.Yb(),a.Wc(19,"\n  "),a.Zb(20,"div",7),a.Wc(21,"\n    "),a.Zb(22,"div"),a.Wc(23,"\n        "),a.Zb(24,"button",8),a.hc("click",(function(){return t.obj.OnSearch("OK")})),a.Wc(25),a.mc(26,"translate"),a.Yb(),a.Wc(27,"\n        "),a.Zb(28,"button",9),a.hc("click",(function(){return t.obj.OnSearch("Cancel")})),a.Wc(29),a.mc(30,"translate"),a.Yb(),a.Wc(31,"\n    "),a.Yb(),a.Wc(32,"      \n  "),a.Yb(),a.Wc(33,"\n"),a.Yb()),2&e&&(a.tc("formGroup",t.obj.form),a.Db(8),a.tc("obj",t.obj.Product)("group",t.obj.form),a.Db(3),a.tc("ngIf",t.obj.Reports.Visible),a.Db(5),a.tc("ngForOf",t.obj.Fields),a.Db(9),a.Xc(a.nc(26,7,"Ok")),a.Db(4),a.Xc(a.nc(30,9,"Close")))},directives:[o.t,o.k,r.a,n.t,n.s],pipes:[l.d],encapsulation:2}),e})()},ybar:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var s=i("Do2H"),a=i("Lp6j"),o=i("ScVY"),r=i("ZDA+"),n=i("6z9j");class l extends o.b{constructor(){super(...arguments),this.WhereString="",this.PickerType="",this.TreeVisibility=!1}Refresh(){null!=this.tree&&this.tree.length>0&&(this.tree[0].RefreshData=!0)}GetSeqNosList(){if(null==this.SelectedNodes)return"";let e="";return this.SelectedNodes.forEach(t=>{e+=t.Id+","}),e.length>0?e=e.Remove(e.length-1,1):e+=0,e.toString()}SearchPickerViewModel_2(e,t){this.SearchPickerViewModel(e,t,"","","")}SearchPickerViewModel_3(e,t,i){this.SearchPickerViewModel(e,t,i,"","")}SearchPickerViewModel_4(e,t,i,s){this.SearchPickerViewModel(e,t,i,s,"")}SearchPickerViewModel(e,t,i,o,l){if(this.PickerType=t,this.ViewModel=e,"PRODUCTS"==t)this.TreeCCID=3,this.TreeID=20;else if("ACCOUNTS"==t)this.TreeCCID=2,this.TreeID=126;else if("CUSTOMERS"==t)this.TreeCCID=51,this.TreeID=141;else if("PACKAGE"==t)this.TreeCCID=62,this.TreeID=160;else if("REPORTS"==t)this.TreeCCID=200,this.TreeID=267;else if("DOCUMENTS"==t)this.TreeCCID=300,this.TreeID=410;else if("units"==t)this.TreeCCID=93,this.TreeID=262;else if("COSTCENTER"==t){this.TreeCCID=parseInt(i),i=o;let e=s.a.common.GetCostCenterGridViewList(this.TreeCCID,!1),t=e.Tables[0];if(t=t.filter(e=>0==e.IsUserDefined),t.length>0)this.TreeID=parseInt(t[0].GridViewID);else{if(!(e.Tables[0].length>0))return void s.a.page.HideDialog();this.TreeID=parseInt(e.Tables[0][0].GridViewID)}}else if(t.startsWith("PRODUCTGROUPS")){this.TreeCCID=3;let e=t.split("~");this.TreeID=parseInt(e[1]),i="A.IsGroup=1"}let h=[];if(""!=l){let e=l.split(",");for(let t=0;t<e.length;t++){let i;if(i=a.e.IntTryParse(e[t]),i){let i=new r.a;i.Id=parseInt(e[t]),h.push(i)}}}this.tree=[];let d=new n.a;d.TreeViewModel_6(this.TreeCCID,this,this.TreeID,i,h,""),d.HeaderVisiblity=!1,d.ViewsVisible=!1,this.tree.push(d),this.ViewModel=this.ViewModel,this.MessageVisibility=!1}CommandController(e){null!=e&&"MouseDoubleClick"==e.toString()&&null!=this.SelectedNode&&(this.SelectedNode.IsGroup||(null==this.SelectedNodes?this.SelectedNodes=[]:this.SelectedNodes.Clear(),this.SelectedNodes.push(this.SelectedNode),s.a.page.HideDialog(),this.ViewModel.ParentCallBack(this)))}OnOkClick(e){s.a.page.HideDialog(),this.ViewModel.ParentCallBack(this)}OnCancelClick(e){s.a.page.HideDialog()}}}}]);