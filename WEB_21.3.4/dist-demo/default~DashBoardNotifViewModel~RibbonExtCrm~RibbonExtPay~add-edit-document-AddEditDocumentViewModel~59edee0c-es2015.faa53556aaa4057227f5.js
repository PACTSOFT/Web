(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{lUlH:function(e,t,s){"use strict";s.d(t,"a",(function(){return f}));var n=s("Do2H"),a=s("Lp6j"),i=s("vTM8"),o=s("jgdN"),r=s("EQd/"),l=s("JIg3"),u=s("0/4Q"),c=s("n56n"),D=s("Huqd"),h=s("Jnyl"),C=s("FruK"),m=s("4ADR"),d=s("ockk"),p=s("4HhE"),S=s("eQJW"),I=s("bgvB"),g=s("MCLT"),y=s("8B8H"),b=s("mRNg");class f{constructor(e,t){this.IsConstructorCall=!0,this.LoadEditCallBack=new p.b,this.ClearCallBack=new p.b,this.ValidateData=new p.b,this.ReferenceCallBack=new p.b,this.ShowQuickViewCallBack=new p.b,this.MinRowCount=9,this.ChequeBookChecking=0,this.IsResave=0,this.BulkSaveon=0,this.CostCenterID=0,this.CurrentCodeNumber=0,this.DivisionID=0,this.RegisterNodeID=0,this.ShiftNodeID=0,this.DivisionName="",this.LocationName="",this.LockWhere="",this.DocID=0,this._locID=0,this.RefNodeID=0,this.RefCCId=0,this.RefAmount=0,this.IsBouncedorPdcPosted=!1,this.IsLoadingeditData=!1,this.IsRefLCTR=!1,this.IsDirty=!1,this.ParentFlagName="",this.BouncedorPdcMessage="",this.ExternalFuncErrorMessage="",this.DraftID=0,this.DocumentType=0,this.IsInventory=!1,this.Preferences=new i.a,this.PriceTaxcc=new i.c,this.TempProductID=0,this.IsPurchase=!1,this.IsForecast=!1,this.ForecastObj=null,this.SectionOrders=new i.a,this.ColumnSource=[],this.FooterColumnSource=[],this.GridData=[],this.GridDataColumns=[],this.GridDataObj=new y.a,this.FooterGridData=[],this.FooterGridDataColumns=[],this.FooterDataBind=[],this.FooterDataBindColumns=[],this.FooterGridDataObj=new y.a,this._numericFields=[],this._TextFields=[],this._CCFields=[],this._StaticFields=[],this.FilterFields=[],this.FilterColumns=new i.a,this.ProdFilterinuse=new i.c,this.CostCentersValues=new i.a,this.dtHistory=null,this.DocPrefix=null,this.DueDate=null,this.BillNo=null,this.Status=null,this.CreditAccount=null,this.DebitAccount=null,this.Link=null,this.PostVoucherDocID=0,this.PostVoucherDocDetailsID=0,this.PostVoucherCreditAccount=0,this.PostVoucherDebitAccount=0,this.PostVoucherAmount=0,this.PostVouceherDocPrefix="",this.PostVoucherDocnumber="",this.guid="",this.CCguid="",this.strnumericFields=null,this.strTextFields=null,this.strCCFields=null,this.strStaticFields=null,this.FooterAccounts=null,this.VoucherNo=null,this.ChildVNos=null,this.strTOCCFields=null,this.linkstat=null,this.DistributeCostXML=null,this.HistoryCCXML=null,this.HeaderFields=[],this._LineItemFields=[],this.AvgrateExists=!1,this.RWFieldsExists=[],this.DefaultBasedOn=new i.a,this.GridColumnType=new i.a,this.footerGridColumnType=new i.a,this.DataTableColumnType=new i.a,this.CustomTab=new m.a,this.TabIndex=new m.b,this.IsAccessDenied=!1,this.RateVisibility=!0,this.dtSerialTemp=[],this.SNOFoot=1,this.SNO=1,this.ID=0,this.LineItemFields=[],this.AmtFc="1",this.ExchRate="1",this.AttachmentFields=[],this.CostCenterID=e,this.DocID=t,this.GridDataObj.Table=this.GridData,this.GridDataObj.CanUserAddRows=!0,this.GridDataObj.CanUserDeleteRows=!0,this.GridDataObj.SearchColStartIndex=1,this.FooterGridDataObj.Height=150,this.FooterGridDataObj.Table=this.FooterGridData,this.FooterGridDataObj.Columns=this.FooterColumnSource,this.FooterGridDataObj.TableColumns=this.FooterGridDataColumns,this.FooterGridDataObj.IsDocument=!0,n.a.IsMobile&&(this.GridDataObj.CanUserAddRows=!1)}get LocationID(){return this._locID}set LocationID(e){n.a.SessionManager.Preferences.ContainsKey("LWAccPeriod")&&"True"==n.a.SessionManager.Preferences.LWAccPeriod.toString()&&(this.dtLocWise=this.getAccoutingDate(e)),this._locID=e}get IsDocEdit(){return this.DocID>0||this.DocID<-1e4}get IsPayrollDocument(){return this.DocumentType>=51&&this.DocumentType<=199&&64!=this.DocumentType}CheckIsPurchase(){this.IsInventory&&(this.IsPurchase=1==this.DocumentType||2==this.DocumentType||6==this.DocumentType||39==this.DocumentType||3==this.DocumentType||4==this.DocumentType||34==this.DocumentType||13==this.DocumentType||25==this.DocumentType||26==this.DocumentType||27==this.DocumentType,64==this.DocumentType&&(this.IsForecast=!0))}FilterTo(e){if(!e.DBColumnName.Contains("TO")){var t=this._CCFields.find(t=>t.DBColumnName=="TO"+e.DBColumnName);t instanceof c.b&&(t.CustomWhere=this.GetCustomWhere(e.CCID,e.SelectedValue))}}FilterToCodeName(e){if(!e.DBColumnName.Contains("TO")){var t=this._CCFields.find(t=>t.DBColumnName=="TO"+e.DBColumnName);t instanceof D.a&&(t.Code.CustomWhere=t.Name.CustomWhere=this.GetCustomWhere(e.CCID,e.SelectedValue))}}GetCustomWhere(e,t){let s="";return s=s+"a.NodeID <>  "+t.toString(),s}OnGetReference(e){if(null!=this.ShowQuickViewCallBack&&!this.IsLoadingeditData&&e instanceof c.b){if(null==e.SelectedValue||null==e.SelectedValue||0==e.SelectedValue)return;let o=e;this.FilterTo(e);let l=null;if(this.SelectedGridRowIndex>=0&&(l=this.GridData[this.SelectedGridRowIndex]),2!=o.Action&&4!=o.Action||a.e.IsEmpty(o.Expression)||this.ShowQuickViewCallBack.Call({CCID:0,NodeID:0,datarow:null,ctrl:o}),(2==o.CCID||o.CCID>=50001&&o.CCID<=50057&&this.Preferences.ContainsKey("QuickViewDimensions")&&""!=this.Preferences.QuickViewDimensions&&this.Preferences.QuickViewDimensions.toString().Contains(o.CCID.toString()))&&this.ShowQuickViewCallBack.Call({CCID:o.CCID,NodeID:o.SelectedValue,datarow:l,ctrl:null}),this.PriceTaxcc.ContainsKey(o.CCID)&&this.ReferenceCallBack.IsSubscribed){let e=null;(2!=o.CCID||1!=this.DocumentType&&2!=this.DocumentType&&10!=this.DocumentType&&26!=this.DocumentType&&27!=this.DocumentType&&3!=this.DocumentType&&4!=this.DocumentType&&25!=this.DocumentType&&13!=this.DocumentType||null==this.CreditAccount||this.CreditAccount.Code!=o&&this.CreditAccount.Name!=o)&&(2!=o.CCID||11!=this.DocumentType&&38!=this.DocumentType&&39!=this.DocumentType&&6!=this.DocumentType&&7!=this.DocumentType&&8!=this.DocumentType&&9!=this.DocumentType&&12!=this.DocumentType&&24!=this.DocumentType||null==this.DebitAccount||this.DebitAccount.Code!=o&&this.DebitAccount.Name!=o)?o.CCID>5e4&&this.ReferenceCallBack.Call({ReferenceTable:null,ReferenceEditTable:null,DBColumnName:"ReEvaluate",ccid:o.CCID,dr:e}):this.ReferenceCallBack.Call({ReferenceTable:null,ReferenceEditTable:null,DBColumnName:"ReEvaluate",ccid:o.CCID,dr:e})}if(this.GetLinkReferenceData(o.DBColumnID,this.CostCenterID,o.SelectedValue,this.DocDate.Date,o.DBColumnName,o.CCID,l),this.Preferences.ContainsKey("DimWiseCurrency")&&"true"!=this.Preferences.DimWiseCurrency.toLowerCase()&&n.a.SessionManager.Preferences.DimensionwiseCurrency==o.CCID.toString()){for(let t=0;t<this.HeaderFields.length;t++){let e=this.HeaderFields[t];if(e instanceof h.b){a.e.IsEmpty(e.Currency.SelectedValue)||(e.ExchangeRate.Text=this.GetExchangeRate(parseInt(e.Currency.SelectedValue),this.DocDate.Date).toString());break}}let e,s=this.Data.Tables[0].filter(e=>null!=e.LocalReference&&79==e.LocalReference&&55847==e.LinkData);if(e=a.e.Int(n.a.SessionManager.Preferences.BaseCurrency),s.length>0&&""!=n.a.SessionManager.Preferences.BaseCurrency&&e>0){var t=this._TextFields.find(e=>e.DBColumnID.toString()==s[0].CostCenterColID.toString());t&&t instanceof r.d&&(t.Text=this.GetExchangeRate(parseInt(n.a.SessionManager.Preferences.BaseCurrency),this.DocDate.Date).toString())}}if(!a.e.IsEmpty(o.KeyTip)&&"lostfocus"==o.KeyTip.toLowerCase()&&this.ValidateData.IsHandler&&this.ValidateData.Call({sender:o,IsExternal:!0})&&this.GetExternalFuncData(o.Mode,o.ToolTipFooterTitle,o.ToolTipFooterDescription,o.ToolTipDescription,null),o.SelectedValue>0){if(this.Preferences.ContainsKey("DimWiseAttachments")&&this.Preferences.DimWiseAttachments==o.CCID.toString()){let e=null,t=this.GetFiles(o.CCID,o.SelectedValue);t.Tables.length>0&&t.Tables[0].length>0&&this.ReferenceCallBack.Call({ReferenceTable:t.Tables[0],ReferenceEditTable:null,DBColumnName:"Attachments~",ccid:0,dr:e})}if(o.CCID>5e4&&(o.CrFilter>0||o.DbFilter>0)){if(o.CrFilter>0&&null!=this.CreditAccount){var s=this._CCFields.filter(e=>e.CrFilter>0);let e="";s.forEach(t=>{t instanceof c.b&&t.SelectedValue>0&&(e="("+t.DBColumnName.replace("dc","")+"="+t.SelectedValue.toString(),1==t.CrFilter&&(e+=" OR "+t.DBColumnName.replace("dc","")+"=1 "),e+=")")}),this.CreditAccount.Code.CustomWhere=null==this.CreditAccount.Code.InitCustomWhere||""==this.CreditAccount.Code.InitCustomWhere?e:this.CreditAccount.Code.InitCustomWhere+" and "+e,this.CreditAccount.Name.CustomWhere=null==this.CreditAccount.Name.InitCustomWhere||""==this.CreditAccount.Name.InitCustomWhere?e:this.CreditAccount.Code.InitCustomWhere+" and "+e}if(e.DbFilter>0&&null!=this.DebitAccount){var i=this._CCFields.filter(e=>e.DbFilter>0);let e="";i.forEach(t=>{e="("+t.DBColumnName.replace("dc","")+"="+t.SelectedValue.toString(),1==t.DbFilter&&(e+=" OR "+t.DBColumnName.replace("dc","")+"=1 "),e+=")"}),this.DebitAccount.Code.CustomWhere=null==this.DebitAccount.Code.InitCustomWhere||""==this.DebitAccount.Code.InitCustomWhere?e:this.DebitAccount.Code.InitCustomWhere+" and "+e,this.DebitAccount.Name.CustomWhere=null==this.DebitAccount.Name.InitCustomWhere||""==this.DebitAccount.Name.InitCustomWhere?e:this.DebitAccount.Code.InitCustomWhere+" and "+e}}}if(this.FilterDependencies(o),n.a.SessionManager.Preferences.BudgetAccount.length>0&&n.a.SessionManager.Preferences.BudgetDimension.length>0&&null!=this._CCFields.find(e=>e instanceof c.b&&e.CCID==parseInt(n.a.SessionManager.Preferences.BudgetDimension))){let e=this._CCFields.find(e=>e instanceof c.b&&e.CCID==parseInt(n.a.SessionManager.Preferences.BudgetDimension)),t=this.Data.Tables[5].filter(e=>e.CostCenterID==n.a.SessionManager.Preferences.BudgetDimension&&0==e.QtyBudget&&(0==e.QtyType||null==e.QtyType)),s="";t.length>0&&this.Data.Tables[5].filter(e=>e.BudgetDefID==t[0].BudgetDefID).forEach(e=>{let t=parseInt(e.CostCenterID);if(2==t){let e="";null!=this.CreditAccount&&this.CreditAccount.SelectedValue>0&&(e+=this.CreditAccount.SelectedValue),null!=this.DebitAccount&&this.DebitAccount.SelectedValue>0&&(e.length>0&&(e+=","),e+=this.DebitAccount.SelectedValue),e.length>0&&(s+=" and B.AccountID in("+e+")")}else if(e.CostCenterID.toString()!=n.a.SessionManager.Preferences.BudgetDimension&&t>5e4&&e.CostCenterID.toString()!=n.a.SessionManager.Preferences.BudgetDimension){let t=this._CCFields.find(t=>t instanceof c.b&&t.DBColumnName.toLowerCase()=="dcccnid"+(parseInt(e.CostCenterID)-5e4));null!=t&&t.SelectedValue>0&&(s+=" and B.CCNID"+(t.CCID-5e4)+"="+t.SelectedValue)}}),s.length>0&&(e.CustomWhere="A.NodeID IN (select B.CCNID"+(parseInt(n.a.SessionManager.Preferences.BudgetDimension)-5e4)+" from COM_BudgetAlloc B with(nolock)\n                        where B.BudgetDefID="+t[0].BudgetDefID.toString()+s+"\n                        union\n                        select B.CCNID"+(parseInt(n.a.SessionManager.Preferences.BudgetDimension)-5e4)+"\n                        from COM_CostCenterCostCenterMap M with(nolock) \n                        inner join COM_BudgetAlloc B with(nolock) ON B.CCNID"+(parseInt(n.a.SessionManager.Preferences.BudgetDimension)-5e4)+"=M.NodeID\n                        where B.BudgetDefID="+t[0].BudgetDefID.toString()+" and B.AccountID="+n.a.SessionManager.Preferences.BudgetAccount+" and M.ParentCostCenterID=2 and M.CostCenterID="+n.a.SessionManager.Preferences.BudgetDimension+"\n                        "+s.replace("B.AccountID","M.ParentNodeID")+" group by B.CCNID"+(parseInt(n.a.SessionManager.Preferences.BudgetDimension)-5e4)+")")}!a.e.IsEmpty(o.Lbl)&&this.CheckFormulaExists(o.Lbl)&&this.ReferenceCallBack.IsSubscribed&&this.ReferenceCallBack.Call({ReferenceTable:null,ReferenceEditTable:null,DBColumnName:"ReCalculate",ccid:o.CCID,dr:null})}}FilterDependencies(e){this._CCFields.filter(t=>null!=t.DependantOn&&t.DependantOn.toLowerCase()==e.DBColumnName.toLowerCase()).forEach(t=>{if(t instanceof c.b||t instanceof D.a){let s="",n=0;n=t.CCID,n>5e4?t instanceof c.b&&!a.e.IsEmpty(t.ToolTipTitle)&&2==e.CCID?s=t.ToolTipTitle+"="+e.SelectedValue.toString():t instanceof c.b&&t.Dependantinuse||t instanceof D.a&&t.Dependantinuse?(s="("+e.DBColumnName.replace("dc","")+"="+e.SelectedValue.toString(),(t instanceof c.b&&1==t.Dependancy||t instanceof D.a&&1==t.Dependancy)&&(s+=" OR "+e.DBColumnName.replace("dc","")+"=1 "),s+=")"):s=t instanceof c.b&&5==t.Dependancy||t instanceof D.a&&5==t.Dependancy?"  JOIN "+this.GetTableName(n)+" CMJ with(nolock) ON a.lft between  CMJ.lft and CMJ.rgt JOIN COM_CostCenterCostCenterMap CM on CM.CostCenterID="+n+" and CM.ParentCostCenterID="+e.CCID+" and CM.ParentNodeID="+e.SelectedValue.toString()+" and CMJ.NodeID=CM.NodeID ":"  JOIN COM_CostCenterCostCenterMap CM with(nolock) on CM.ParentCostCenterID="+n+" and a.NodeID=CM.ParentNodeID \n                                JOIN "+this.GetTableName(e.CCID)+" CMJ with(nolock) ON CM.CostCenterID= "+e.CCID+"   and CM.NodeID=CMJ."+this.GetPrimaryKey(e.CCID)+" \n                                JOIN "+this.GetTableName(e.CCID)+" CMJG with(nolock) ON CMJG.lft between  CMJ.lft and CMJ.rgt and CMJG."+this.GetPrimaryKey(e.CCID)+" ="+e.SelectedValue:65==n?s="(FeatureID="+e.CCID+" and  FeaturePK="+e.SelectedValue.toString()+")":7==n&&(s="  JOIN COM_CostCenterCostCenterMap CM with(nolock) on CM.ParentCostCenterID=7 and a.UserID=CM.ParentNodeID  and CM.CostCenterID= "+e.CCID+" and CM.NodeID="+e.SelectedValue),t instanceof c.b?t.CustomWhere=s:t instanceof D.a&&(t.Code.CustomWhere=t.Name.CustomWhere=s)}})}get Prefix(){let e="";return null!=this.DocPrefix&&null!=this.DocPrefix.ComboBox.SelectedValue&&(e=this.DocPrefix.ComboBox.SelectedValue),e}get SelectedGridRowIndex(){return this.GridDataObj.SelectedIndex}GetControls(e,t){try{return null==this.Data&&(this.Data=this.GetScreenInfo(parseInt(e))),this.Data}catch(s){return alert("error-GetControls()"),Logger.ErrorLog("VoucherGenerator:: GetControls"+s.stack),null}}LoadScreen(e,t=0){try{if(null==this.Data){if(this.oParent=e,this.Data=this.GetScreenInfo(this.CostCenterID),this.Data.Tables.length<3)return void(this.IsAccessDenied=!0);if(this.DocumentType=parseInt(this.Data.Tables[3][0].DocumentType),38==this.DocumentType||39==this.DocumentType){let e=n.a.document.GetPosDetails(this.CostCenterID,t);e.Tables.length>0&&(this.Data.Tables[1]=e.Tables[0],this.Data.Columns[1]=e.Columns[0],this.Data.Tables[11]=e.Tables[1],this.Data.Columns[11]=e.Columns[1])}if((38==this.DocumentType||39==this.DocumentType)&&0==this.Data.Tables[1].length)return;if((38==this.DocumentType||39==this.DocumentType)&&(this.RegisterNodeID=parseInt(this.Data.Tables[1][0].NOdeID),this.ShiftNodeID=""==this.Data.Tables[1][0].ShiftID.toString()||"0"==this.Data.Tables[1][0].ShiftID.toString()?this.GetShifts(new Date(this.Data.Tables[1][0].Day)):parseInt(this.Data.Tables[1][0].ShiftID),0==this.Data.Tables[8].filter(e=>e.CCID==n.a.SessionManager.RegisterCCID).length))return;if(this.IsInventory=Object(S.j)(this.Data.Tables[3][0].IsInventory),this.CCguid=this.Data.Tables[3][0].GUID.toString(),this.CheckIsPurchase(),100==this.DocumentType)this.GridTitle="Travel Details";else if(this.IsInventory){if(this.GridTitle="Product Details",this.IsPayrollDocument)switch(this.DocumentType){case 62:this.GridTitle="Leave Details";break;case 90:this.GridTitle="Timesheet Details";break;case 89:this.GridTitle="Attendance Details";break;default:this.GridTitle="Details"}}else this.GridTitle="Account Details";if(this.Data.Tables.length>7&&this.Data.Tables[7].length>0){for(let e=0;e<this.Data.Tables[7].length;e++)this.Preferences.ContainsKey(this.Data.Tables[7][e].PrefName.toString())||this.Preferences.push(this.Data.Tables[7][e].PrefName.toString(),this.Data.Tables[7][e].PrefValue.toString());this.Preferences.ContainsKey("ControlAccountFilterField")&&n.a.SessionManager.Preferences.ContainsKey("IsControlAccounts")&&"FALSE"==n.a.SessionManager.Preferences.IsControlAccounts.toUpperCase()&&(this.Preferences.ControlAccountFilterField=""),this.Preferences.ContainsKey("AutoChequeNo")&&"TRUE"==this.Preferences.AutoChequeNo.toUpperCase()&&n.a.SessionManager.LicenseSettings.ContainsKey("ChequeBookManagement")&&"FALSE"==n.a.SessionManager.LicenseSettings.ChequeBookManagement.toUpperCase()&&(this.Preferences.AutoChequeNo="False"),n.a.SessionManager.LicenseSettings.ContainsKey("CrossDimension")&&"FALSE"==n.a.SessionManager.LicenseSettings.CrossDimension.toUpperCase()&&(this.Preferences.ContainsKey("UseasCrossDimension")&&"TRUE"==this.Preferences.UseasCrossDimension.toUpperCase()&&(this.Preferences.UseasCrossDimension="False"),this.Preferences.ContainsKey("CrossDimDocument")&&""!=this.Preferences.CrossDimDocument.toUpperCase()&&(this.Preferences.CrossDimDocument=""),this.Preferences.ContainsKey("CrossDimField")&&""!=this.Preferences.CrossDimField.toUpperCase()&&(this.Preferences.CrossDimField="")),n.a.SessionManager.LicenseSettings.ContainsKey("LCTR")&&"FALSE"==n.a.SessionManager.LicenseSettings.LCTR.toUpperCase()&&(this.Preferences.ContainsKey("UseAsLC")&&"TRUE"==this.Preferences.UseAsLC.toUpperCase()&&(this.Preferences.UseAsLC="False"),this.Preferences.ContainsKey("EnableLC")&&"TRUE"==this.Preferences.EnableLC.toUpperCase()&&(this.Preferences.EnableLC="False"),this.Preferences.ContainsKey("LcCloseDocument")&&""!=this.Preferences.LcCloseDocument.toUpperCase()&&(this.Preferences.LcCloseDocument="")),this.Preferences.ContainsKey("EnableTestcase")&&"TRUE"==this.Preferences.EnableTestcase.toUpperCase()&&n.a.SessionManager.LicenseSettings.ContainsKey("QC")&&"FALSE"==n.a.SessionManager.LicenseSettings.QC.toUpperCase()&&(this.Preferences.EnableTestcase="False"),n.a.SessionManager.LicenseSettings.ContainsKey("Kit")&&"FALSE"==n.a.SessionManager.LicenseSettings.Kit.toUpperCase()&&(this.Preferences.ContainsKey("dynamicsetProductwiselinking")&&"TRUE"==this.Preferences.dynamicsetProductwiselinking.toUpperCase()&&(this.Preferences.dynamicsetProductwiselinking="False"),this.Preferences.ContainsKey("SplitKit")&&"TRUE"==this.Preferences.SplitKit.toUpperCase()&&(this.Preferences.SplitKit="False"),this.Preferences.ContainsKey("KitAccPosting")&&"TRUE"==this.Preferences.KitAccPosting.toUpperCase()&&(this.Preferences.KitAccPosting="False")),n.a.SessionManager.LicenseSettings.ContainsKey("Bins")&&"FALSE"==n.a.SessionManager.LicenseSettings.Bins.toUpperCase()&&(this.Preferences.ContainsKey("AutoAdjustBinLinking")&&"TRUE"==this.Preferences.AutoAdjustBinLinking.toUpperCase()&&(this.Preferences.AutoAdjustBinLinking="False"),this.Preferences.ContainsKey("AutoAdjustBins")&&"TRUE"==this.Preferences.AutoAdjustBins.toUpperCase()&&(this.Preferences.AutoAdjustBins="False"),this.Preferences.ContainsKey("CopyBins")&&"TRUE"==this.Preferences.CopyBins.toUpperCase()&&(this.Preferences.CopyBins="False"),this.Preferences.ContainsKey("DuplicateProductClubBins")&&"TRUE"==this.Preferences.DuplicateProductClubBins.toUpperCase()&&(this.Preferences.DuplicateProductClubBins="False"),this.Preferences.ContainsKey("OptionalBins")&&"TRUE"==this.Preferences.OptionalBins.toUpperCase()&&(this.Preferences.OptionalBins="False"),this.Preferences.ContainsKey("ShowBins")&&"TRUE"==this.Preferences.ShowBins.toUpperCase()&&(this.Preferences.ShowBins="False")),n.a.SessionManager.LicenseSettings.ContainsKey("Packing")&&"FALSE"==n.a.SessionManager.LicenseSettings.Packing.toUpperCase()&&(this.Preferences.ContainsKey("EnablePacking")&&"TRUE"==this.Preferences.EnablePacking.toUpperCase()&&(this.Preferences.EnablePacking="False"),this.Preferences.ContainsKey("Checkpackedqty")&&"TRUE"==this.Preferences.Checkpackedqty.toUpperCase()&&(this.Preferences.Checkpackedqty="False"),this.Preferences.ContainsKey("LineWisePacking")&&"TRUE"==this.Preferences.LineWisePacking.toUpperCase()&&(this.Preferences.LineWisePacking="False"),this.Preferences.ContainsKey("Linkallprodspacked")&&"TRUE"==this.Preferences.Linkallprodspacked.toUpperCase()&&(this.Preferences.Linkallprodspacked="False"),this.Preferences.ContainsKey("ScanPack")&&"TRUE"==this.Preferences.ScanPack.toUpperCase()&&(this.Preferences.ScanPack="False"),this.Preferences.ContainsKey("ShowPackStat")&&"TRUE"==this.Preferences.ShowPackStat.toUpperCase()&&(this.Preferences.ShowPackStat="False"),this.Preferences.ContainsKey("PackMandScan")&&"TRUE"==this.Preferences.PackMandScan.toUpperCase()&&(this.Preferences.PackMandScan="False"),this.Preferences.ContainsKey("DefaultPack")&&""!=this.Preferences.DefaultPack.toUpperCase()&&(this.Preferences.DefaultPack=""),this.Preferences.ContainsKey("PackLabel")&&""!=this.Preferences.PackLabel.toUpperCase()&&(this.Preferences.PackLabel=""),this.Preferences.ContainsKey("PackWiseProds")&&""!=this.Preferences.PackWiseProds.toUpperCase()&&(this.Preferences.PackWiseProds="")),n.a.SessionManager.LicenseSettings.ContainsKey("Substitutes")&&"FALSE"==n.a.SessionManager.LicenseSettings.Substitutes.toUpperCase()&&(this.Preferences.ContainsKey("EnableSubtitutes")&&"TRUE"==this.Preferences.EnableSubtitutes.toUpperCase()&&(this.Preferences.EnableSubtitutes="False"),this.Preferences.ContainsKey("EnableSubtitutesQty")&&"TRUE"==this.Preferences.EnableSubtitutesQty.toUpperCase()&&(this.Preferences.EnableSubtitutesQty="False"),this.Preferences.ContainsKey("ShowSubQOH")&&"TRUE"==this.Preferences.ShowSubQOH.toUpperCase()&&(this.Preferences.ShowSubQOH="False"),this.Preferences.ContainsKey("SubonProdChange")&&"TRUE"==this.Preferences.SubonProdChange.toUpperCase()&&(this.Preferences.SubonProdChange="False"),this.Preferences.ContainsKey("SubstituteOnQty")&&"TRUE"==this.Preferences.SubstituteOnQty.toUpperCase()&&(this.Preferences.SubstituteOnQty="")),n.a.SessionManager.LicenseSettings.ContainsKey("Barcode")&&"FALSE"==n.a.SessionManager.LicenseSettings.Barcode.toUpperCase()&&(this.Preferences.ContainsKey("UsingBarCodes")&&"TRUE"==this.Preferences.UsingBarCodes.toUpperCase()&&(this.Preferences.UsingBarCodes="False"),this.Preferences.ContainsKey("BarcodeField")&&"TRUE"==this.Preferences.BarcodeField.toUpperCase()&&(this.Preferences.BarcodeField="")),this.Preferences.ContainsKey("PriceChartMapping")&&""!=this.Preferences.PriceChartMapping.toUpperCase()&&n.a.SessionManager.LicenseSettings.ContainsKey("PriceChartFromDocument")&&"FALSE"==n.a.SessionManager.LicenseSettings.PriceChartFromDocument.toUpperCase()&&(this.Preferences.PriceChartMapping=""),n.a.SessionManager.LicenseSettings.ContainsKey("Hold_Release")&&"FALSE"==n.a.SessionManager.LicenseSettings.Hold_Release.toUpperCase()&&(this.Preferences.ContainsKey("Enable Hold")&&"TRUE"==this.Preferences["Enable Hold"].toUpperCase()&&(this.Preferences["Enable Hold"]="False"),this.Preferences.ContainsKey("enebleSaveonhold")&&"TRUE"==this.Preferences.enebleSaveonhold.toUpperCase()&&(this.Preferences.enebleSaveonhold="False")),this.Preferences.ContainsKey("ImpPrf")&&""!=this.Preferences.ImpPrf.toUpperCase()&&n.a.SessionManager.LicenseSettings.ContainsKey("Import")&&"FALSE"==n.a.SessionManager.LicenseSettings.Import.toUpperCase()&&(this.Preferences.ImpPrf=""),n.a.SessionManager.LicenseSettings.ContainsKey("SKU")&&"FALSE"==n.a.SessionManager.LicenseSettings.SKU.toUpperCase()&&(this.Preferences.ContainsKey("DumpStockCodes")&&"TRUE"==this.Preferences.DumpStockCodes.toUpperCase()&&(this.Preferences.DumpStockCodes="False"),this.Preferences.ContainsKey("OnScan")&&""!=this.Preferences.OnScan.toUpperCase()&&(this.Preferences.OnScan="")),n.a.SessionManager.LicenseSettings.ContainsKey("PaymentTerms")&&"FALSE"==n.a.SessionManager.LicenseSettings.PaymentTerms.toUpperCase()&&(this.Preferences.ContainsKey("accountwisePaymentTerms")&&"TRUE"==this.Preferences.accountwisePaymentTerms.toUpperCase()&&(this.Preferences.accountwisePaymentTerms="False"),this.Preferences.ContainsKey("CopyPaymentTerms")&&"TRUE"==this.Preferences.CopyPaymentTerms.toUpperCase()&&(this.Preferences.CopyPaymentTerms="False"),this.Preferences.ContainsKey("Enable Payment Terms")&&"TRUE"==this.Preferences["Enable Payment Terms"].toUpperCase()&&(this.Preferences["Enable Payment Terms"]="False"),this.Preferences.ContainsKey("ShowPercentPayTerms")&&"TRUE"==this.Preferences.ShowPercentPayTerms.toUpperCase()&&(this.Preferences.ShowPercentPayTerms="False"),this.Preferences.ContainsKey("Paytermids")&&""!=this.Preferences.Paytermids.toUpperCase()&&(this.Preferences.Paytermids=""),this.Preferences.ContainsKey("Paymenttermsbasedon")&&""!=this.Preferences.Paymenttermsbasedon.toUpperCase()&&(this.Preferences.Paymenttermsbasedon="")),n.a.SessionManager.LicenseSettings.ContainsKey("Schemes")&&"FALSE"==n.a.SessionManager.LicenseSettings.Schemes.toUpperCase()&&(this.Preferences.ContainsKey("EnableSchemes")&&"TRUE"==this.Preferences.EnableSchemes.toUpperCase()&&(this.Preferences.EnableSchemes="False"),this.Preferences.ContainsKey("SchemesNumericFields")&&""!=this.Preferences.SchemesNumericFields.toUpperCase()&&(this.Preferences.SchemesNumericFields=""),this.Preferences.ContainsKey("SchemesValueField")&&""!=this.Preferences.SchemesValueField.toUpperCase()&&(this.Preferences.SchemesValueField=""),this.Preferences.ContainsKey("DonotUpdateSchemeQty")&&"TRUE"==this.Preferences.DonotUpdateSchemeQty.toUpperCase()&&(this.Preferences.DonotUpdateSchemeQty="False"),this.Preferences.ContainsKey("GetSchemeQty")&&"TRUE"==this.Preferences.GetSchemeQty.toUpperCase()&&(this.Preferences.GetSchemeQty="False"),this.Preferences.ContainsKey("PriceScheme")&&"TRUE"==this.Preferences.PriceScheme.toUpperCase()&&(this.Preferences.PriceScheme="False"),this.Preferences.ContainsKey("ValidateSchemeBeforeSave")&&"TRUE"==this.Preferences.ValidateSchemeBeforeSave.toUpperCase()&&(this.Preferences.ValidateSchemeBeforeSave="False")),n.a.SessionManager.LicenseSettings.ContainsKey("DimensionMapping")&&"FALSE"==n.a.SessionManager.LicenseSettings.DimensionMapping.toUpperCase()&&this.Preferences.ContainsKey("DefaultProfileID")&&""!=this.Preferences.DefaultProfileID.toUpperCase()&&(this.Preferences.DefaultProfileID=""),n.a.SessionManager.LicenseSettings.ContainsKey("TemporaryProduct")&&"FALSE"==n.a.SessionManager.LicenseSettings.TemporaryProduct.toUpperCase()&&(this.Preferences.ContainsKey("onlyTempProduct")&&"TRUE"==this.Preferences.onlyTempProduct.toUpperCase()&&(this.Preferences.onlyTempProduct="False"),this.Preferences.ContainsKey("ExcludeTemproducts")&&"TRUE"==this.Preferences.ExcludeTemproducts.toUpperCase()&&(this.Preferences.ExcludeTemproducts="False"),this.Preferences.ContainsKey("IgnoreTempProduct")&&"TRUE"==this.Preferences.IgnoreTempProduct.toUpperCase()&&(this.Preferences.IgnoreTempProduct="False"),this.Preferences.ContainsKey("MandatorytempPartinfo")&&"TRUE"==this.Preferences.MandatorytempPartinfo.toUpperCase()&&(this.Preferences.MandatorytempPartinfo="False"),this.Preferences.ContainsKey("TempInfo")&&"TRUE"==this.Preferences.TempInfo.toUpperCase()&&(this.Preferences.TempInfo="False")),this.Preferences.ContainsKey("Enabletolerance")&&"TRUE"==this.Preferences.Enabletolerance.toUpperCase()&&n.a.SessionManager.LicenseSettings.ContainsKey("ToleranceManagement")&&"FALSE"==n.a.SessionManager.LicenseSettings.ToleranceManagement.toUpperCase()&&(this.Preferences.Enabletolerance="False")}if(this.Preferences.ContainsKey("IsBudgetDocument")&&"1"==this.Preferences.IsBudgetDocument){let e=new a.f;e.LoadXml(this.Preferences.BudgetMapFields),this.Preferences.ContainsKey("BudgetType")||this.Preferences.push("BudgetType",e.DocumentElement.attributes.BudgetType.value),5!=this.DocumentType&&8!=this.DocumentType&&13!=this.DocumentType||this.Preferences.ContainsKey("CF")||!e.DocumentElement.attributes.CF||this.Preferences.Add("BudgetFeild",e.DocumentElement.attributes.CF.value),this.Preferences.ContainsKey("BudgetDoc")||null==e.DocumentElement.attributes.BudgetDoc||this.Preferences.push("BudgetDoc",e.DocumentElement.attributes.BudgetDoc.value),this.Preferences.ContainsKey("Dims")||null==e.DocumentElement.attributes.Dims||this.Preferences.push("BudgetDims",e.DocumentElement.attributes.Dims.Value),a.f.SelectSingleNode(e.DocumentElement,"Map");let t=a.f.SelectNodes(e.DocumentElement,"Map/R");if(t.filter(e=>"AnnualAmount"==e.attributes.B.value).length>0&&!this.Preferences.ContainsKey("BudgetAnnualAmount")){this.Preferences.push("BudgetAnnualAmount",t[0].attributes.D.value);let e=0;t.forEach(t=>{(t.attributes.B.value.startsWith("Month")||t.attributes.B.value.startsWith("Qtr")||t.attributes.B.value.startsWith("YearH"))&&this.Preferences.push("BudgetField"+ ++e,t.attributes.D.value)})}}if(this.Data.Tables.length>2&&this.Data.Tables[2].length>0&&this.IsInventory)for(let e=0;e<this.Data.Tables[2].length;e++)a.e.IsEmpty(this.Data.Tables[2][e].CostCenterID)||"3"==this.Data.Tables[2][e].DefType.toString()||("1"==this.Data.Tables[2][e].DefType.toString()?this.PriceTaxcc.ContainsKey(parseInt(this.Data.Tables[2][e].CostCenterID))?this.PriceTaxcc[parseInt(this.Data.Tables[2][e].CostCenterID)]=this.PriceTaxcc[parseInt(this.Data.Tables[2][e].CostCenterID)]+",p":this.PriceTaxcc.push(parseInt(this.Data.Tables[2][e].CostCenterID),"p"):"2"==this.Data.Tables[2][e].DefType.toString()&&(this.PriceTaxcc.ContainsKey(parseInt(this.Data.Tables[2][e].CostCenterID))?this.PriceTaxcc[parseInt(this.Data.Tables[2][e].CostCenterID)]=this.PriceTaxcc[parseInt(this.Data.Tables[2][e].CostCenterID)]+",t":this.PriceTaxcc.push(parseInt(this.Data.Tables[2][e].CostCenterID),"t")));if(this.Preferences.ContainsKey("DefaultProfileID")&&""!=this.Preferences.DefaultProfileID&&this.Data.Tables.length>22&&this.Data.Tables[22].length>0&&this.Data.Columns[22].Contains("DefXml")&&!a.e.IsEmpty(this.Data.Tables[22][0].DefXml)){for(let e=0;e<this.Data.Tables[22].length;e++){let t=(new DOMParser).parseFromString(this.Data.Tables[22][e].DefXml,"text/xml").getElementsByTagName("Row");for(let s=0;s<t.length;s++)t[s].attributes.cols&&!this.DefaultBasedOn.ContainsKey(t[s].attributes.cols.value)&&t[s].attributes.IsBase&&"1"==t[s].attributes.IsBase.value&&this.DefaultBasedOn.push(t[s].attributes.cols.value,this.Data.Tables[22][e].profileID.toString())}this.Data.Tables[22].length>1&&(this.Preferences.DefaultProfileID=this.DefaultBasedOn.ContainsKey("3")?this.DefaultBasedOn[3]:this.DefaultBasedOn.values[0])}else this.Preferences.ContainsKey("DefaultProfileID")&&this.Preferences.Remove("DefaultProfileID");let s=this.Data.Tables[0].filter(e=>1==e.SectionID);if(this.GenerateCustomFields(s,this.HeaderFields),this.Data.Tables.length>6&&this.Data.Tables[6].length>0&&(!this.Preferences.ContainsKey("Productwise")||this.Preferences.ContainsKey("Productwise")&&null!=this.Preferences.Productwise&&!Object(S.j)(this.Preferences.Productwise))){this.Link=new C.a(0),this.Link.DBColumnName="Link",this.Link.LinkCombo.DBColumnName="LinkDocs",this.Link.DocumentList.DBColumnName="LinkVnos",this.Link.DocumentList.LblWidth="0px";for(let e=0;e<this.Data.Tables[6].length;e++){let t=!1;t=!(!this.Data.Columns[6].Contains("IsDefault")||a.e.IsEmpty(this.Data.Tables[6][e].IsDefault))&&Object(S.j)(this.Data.Tables[6][e].IsDefault),this.Link.LinkCombo.Items.push(u.d.ComboBoxItems_6(a.e.String(this.Data.Tables[6][e].DocumentName),this.Data.Tables[6][e].DocumentLinkDefID.toString(),t,a.e.String(this.Data.Tables[6][e].AutoSelect),this.Data.Tables[6][e].CostCenterIDLinked.toString())),t&&(this.Link.LinkCombo.SelectedItem=this.Link.LinkCombo.Items[e],this.Link.LinkCombo.SelectedValue=this.Data.Tables[6][e].DocumentLinkDefID.toString())}this.Link.DocumentList.Visible=!1,this.Link.Row=0,this.Link.Column=3,this.Link.RowSpan=3,this.Link.LinkCombo.Label="Document"}this.GenerateBody(),this.IsInventory&&this.GenerateFooter(),this.CheckRWFieldsExists_0(),this.GridDataObj.TableNewRow.Subscribe(this,"onAddRow"),this.Preferences.ContainsKey("Dynamic Footer")&&null!=this.Preferences["Dynamic Footer"]&&Object(S.j)(this.Preferences["Dynamic Footer"])&&this.FooterGridDataObj.TableNewRow.Subscribe(this,"onAddRowFoot");let i,o=null,r=this.Data.Tables[0].filter(e=>2==e.SectionID);r.sort((e,t)=>e.SectionSeqNumber-t.SectionSeqNumber);for(let e=0;e<r.length;e++)if(null==this.CustomTab.Pages.find(t=>null!=r[e].SectionName&&t.Header.toLowerCase()==r[e].SectionName.toString().toLowerCase())){let t=new m.b;o=a.e.String(r[e].SectionName),t.Name=o,t.Header=o,this.CustomTab.Pages.push(t)}this.SectionOrders.Clear(),i=a.e.IsEmpty(this.Preferences.ShowasSections)?[]:this.Preferences.ShowasSections.split(","),i.Contains("PRIMARY SECTION")||i.InsertAt("PRIMARY SECTION",0),i.Contains("EXTRA FIELDS TAB")||i.InsertAt("EXTRA FIELDS TAB",1),i.Contains("BODY")||i.InsertAt("BODY",2),this.Preferences.ContainsKey("HideBody")&&"True"==this.Preferences.HideBody&&i.Remove("BODY");let l=0,D=0;i.forEach(e=>{if(this.SectionOrders.Add(e,++D),"PRIMARY SECTION"==e||"EXTRA FIELDS TAB"==e||"BODY"==e)return;let t=this.CustomTab.Pages.find(t=>t.Name==e);t?(t.TabType=2,this.CustomTab.Pages.Remove(t),this.CustomTab.Pages.InsertAt(t,l++)):(t=new m.b,t.Header=e,t.Name=e,t.TabType=3,this.CustomTab.Pages.InsertAt(t,l++)),t.Row=D}),this.CustomTab.Pages.map(e=>e.IsAccordionOpen=this.Preferences.ContainsKey("OpenAllSection")&&"True"==this.Preferences.OpenAllSection);let h=!1;for(let e=0;e<this.CustomTab.Pages.length;e++)s=this.Data.Tables[0].filter(t=>2==t.SectionID&&(null!=t.SectionName?t.SectionName:"").toLowerCase()==this.CustomTab.Pages[e].Name.toLowerCase()),s.sort((e,t)=>e.SectionSeqNumber-t.SectionSeqNumber),this.GenerateCustomFields(s,this.CustomTab.Pages[e].Fields),this.CustomTab.Pages[e].Fields.find(e=>e instanceof p.c&&e.Visible)?h=!0:this.CustomTab.Pages[e].Visible=!1;if(this.CustomTab.Pages.length>0&&h?(this.CustomTab.Visible=!0,this.CustomTab.Pages[0].Visible?this.CustomTab.SelectedTab=this.CustomTab.Pages[0]:this.CustomTab.Pages.length>1&&(this.CustomTab.SelectedTab=this.CustomTab.Pages[1])):this.CustomTab.Visible=!1,this.Data.Tables.length>16&&this.Data.Tables[16].length>0){let e=this.Data.Tables[16].filter(e=>"BinsDimension"==e.name);e.length>0&&a.e.IsNum(e[0].value)&&this.Preferences.push("BinsDimension",e[0].value.toString()),e=this.Data.Tables[16].filter(e=>"ProductWiseBins"==e.name),e.length>0&&!a.e.IsEmpty(e[0].value)&&this.Preferences.push("ProductWiseBins",e[0].value.toString()),e=this.Data.Tables[16].filter(e=>"NoOfBins"==e.name),e.length>0&&!a.e.IsEmpty(e[0].value)&&this.Preferences.push("NoOfBins",e[0].value.toString()),e=this.Data.Tables[16].filter(e=>"ConsolidatedBins"==e.name),e.length>0&&!a.e.IsEmpty(e[0].value)&&this.Preferences.push("ConsolidatedBins",e[0].value.toString()),e=this.Data.Tables[16].filter(e=>"bincapacityonVolume"==e.name),e.length>0&&!a.e.IsEmpty(e[0].value)&&this.Preferences.push("bincapacityonVolume",e[0].value.toString()),e=this.Data.Tables[16].filter(e=>"AutoSelectBins"==e.name),e.length>0&&!a.e.IsEmpty(e[0].value)&&this.Preferences.push("AutoSelectBins",e[0].value.toString()),e=this.Data.Tables[16].filter(e=>"DefaultDelimiter"==e.name),e.length>0&&!a.e.IsEmpty(e[0].value)&&this.Preferences.push("DefaultDelimiter",e[0].value.toString()),e=this.Data.Tables[16].filter(e=>"IgnoreFirstDelimiter"==e.name),e.length>0&&!a.e.IsEmpty(e[0].value)&&this.Preferences.push("IgnoreFirstDelimiter",e[0].value.toString()),e=this.Data.Tables[16].filter(e=>"ScanMultiple"==e.name),e.length>0&&!a.e.IsEmpty(e[0].value)&&this.Preferences.push("ScanMultiple",e[0].value.toString()),e=this.Data.Tables[16].filter(e=>"DonotExceedCapacity"==e.name),e.length>0&&!a.e.IsEmpty(e[0].value)&&this.Preferences.push("DonotExceedCapacity",e[0].value.toString()),e=this.Data.Tables[16].filter(e=>"JobDimension"==e.name),e.length>0&&!a.e.IsEmpty(e[0].value)&&this.Preferences.push("jobCCID",e[0].value.toString()),e=this.Data.Tables[16].filter(e=>"StageDimension"==e.name),e.length>0&&!a.e.IsEmpty(e[0].value)&&this.Preferences.push("StageCCID",e[0].value.toString()),e=this.Data.Tables[16].filter(e=>"BomDimension"==e.name),e.length>0&&!a.e.IsEmpty(e[0].value)&&this.Preferences.push("BomCCID",e[0].value.toString()),e=this.Data.Tables[16].filter(e=>"BinFilterinPopup"==e.name),e.length>0&&!a.e.IsEmpty(e[0].value)&&this.Preferences.push("BinFilterinPopup",e[0].value.toString()),e=this.Data.Tables[16].filter(e=>"BinFilterDim"==e.name),e.length>0&&!a.e.IsEmpty(e[0].value)&&this.Preferences.push("BinFilterDim",e[0].value.toString()),e=this.Data.Tables[16].filter(e=>"ExcludeHoldBins"==e.name),e.length>0&&!a.e.IsEmpty(e[0].value)&&this.Preferences.push("ExcludeHoldBins",e[0].value.toString()),e=this.Data.Tables[16].filter(e=>"ExcludeHold"==e.name),e.length>0&&!a.e.IsEmpty(e[0].value)&&this.Preferences.push("ExcludeHold",e[0].value.toString()),e=this.Data.Tables[16].filter(e=>"ExcludeReserve"==e.name),e.length>0&&!a.e.IsEmpty(e[0].value)&&this.Preferences.push("ExcludeReserve",e[0].value.toString()),e=this.Data.Tables[16].filter(e=>"JobFilterDim"==e.name),e.length>0&&!a.e.IsEmpty(e[0].value)&&this.Preferences.push("JobUnqCCID",e[0].value.toString()),e=this.Data.Tables[16].filter(e=>"BarcodeDimension"==e.name),e.length>0&&!a.e.IsEmpty(e[0].value)&&this.Preferences.push("BarcodeDimension",e[0].value.toString()),e=this.Data.Tables[16].filter(e=>"JobRemainingQty"==e.name),e.length>0&&!a.e.IsEmpty(e[0].value)&&this.Preferences.push("JobRemainingQty",e[0].value.toString()),e=this.Data.Tables[16].filter(e=>"BatchFilterDim"==e.name),e.length>0&&!a.e.IsEmpty(e[0].value)&&this.Preferences.push("BatchFilterDim",e[0].value.toString()),e=this.Data.Tables[16].filter(e=>"TempPartProduct"==e.name),this.TempProductID=e.length>0&&!a.e.IsEmpty(e[0].value)&&a.e.IsNum(e[0].value)?parseInt(e[0].value.toString()):0,e=this.Data.Tables[16].filter(e=>"Waistage"==e.name),e.length>0&&!a.e.IsEmpty(e[0].value)&&this.Preferences.push("Waistage",e[0].value.toString()),e=this.Data.Tables[16].filter(e=>"AllowNegativebatches"==e.name),e.length>0&&!a.e.IsEmpty(e[0].value)&&this.Preferences.push("AllowNegativebatches",e[0].value.toString()),e=this.Data.Tables[16].filter(e=>"DueDateCheck"==e.name),e.length>0&&!a.e.IsEmpty(e[0].value)&&this.Preferences.push("BUDGET_DueDateCheck",e[0].value.toString()),e=this.Data.Tables[16].filter(e=>"BudgetDateField"==e.name),e.length>0&&!a.e.IsEmpty(e[0].value)&&this.Preferences.push("BUDGET_BudgetDateField",e[0].value.toString()),e=this.Data.Tables[16].filter(e=>"BudgetAccountField"==e.name),e.length>0&&!a.e.IsEmpty(e[0].value)&&this.Preferences.push("BUDGET_BudgetAccountField",e[0].value.toString())}if(this.Preferences.ContainsKey("TwoColumnLayout")&&"True"==this.Preferences.TwoColumnLayout&&(this.HeaderFields.forEach(e=>{e.LblWidth="140",e.ColumnSpan=2*e.ColumnSpan}),this.CustomTab.Pages.forEach(e=>{e.Fields.forEach(e=>{e.LblWidth="140",e.ColumnSpan=2*e.ColumnSpan})})),this.CheckViewForUser(0),n.a.SessionManager.Is_SIMPLE_License&&this.SimpleLicensedDocumentPreferences(),0!=n.a.SessionManager.LoginDimension&&0!=n.a.SessionManager.ESSID){let e=this._CCFields.find(e=>e.CCID==n.a.SessionManager.LoginDimension);e instanceof c.b&&(e.PreviousSelectedValue=n.a.SessionManager.ESSID,e.SelectedValue=n.a.SessionManager.ESSID,e.DefaultValue=n.a.SessionManager.ESSID.toString(),e.Enable=!1,this.Data.Tables[0].filter(t=>null!=t.LocalReference&&t.LocalReference==e.DBColumnID).length>0&&this.GetLinkReferenceData(e.DBColumnID,this.CostCenterID,e.SelectedValue,this.DocDate.Date,e.DBColumnName,e.CCID,null))}}}catch(s){alert("error-loadscreen:: "+s.stack),Logger.ErrorLog("VoucherGenerator:: LoadScreen : "+s.stack)}}SimpleLicensedDocumentPreferences(){this.Preferences.ContainsKey("LineWisePacking")&&"TRUE"==this.Preferences.LineWisePacking.toUpperCase()&&(this.Preferences.LineWisePacking="False"),this.Preferences.ContainsKey("Select Port")&&"TRUE"==this.Preferences["Select Port"].toUpperCase()&&(this.Preferences["Select Port"]="False"),this.Preferences.ContainsKey("DontAllowNegative")&&"TRUE"==this.Preferences.DontAllowNegative.toUpperCase()&&(this.Preferences.DontAllowNegative="False"),this.Preferences.ContainsKey("DumpStockCodes")&&"TRUE"==this.Preferences.DumpStockCodes.toUpperCase()&&(this.Preferences.DumpStockCodes="False"),this.Preferences.ContainsKey("EnableTouch")&&"TRUE"==this.Preferences.EnableTouch.toUpperCase()&&(this.Preferences.EnableTouch="False"),this.Preferences.ContainsKey("PartialRecur")&&"TRUE"==this.Preferences.PartialRecur.toUpperCase()&&(this.Preferences.PartialRecur="False"),this.Preferences.ContainsKey("DistributeCost")&&"TRUE"==this.Preferences.DistributeCost.toUpperCase()&&(this.Preferences.DistributeCost="False"),this.Preferences.ContainsKey("EnablePacking")&&"TRUE"==this.Preferences.EnablePacking.toUpperCase()&&(this.Preferences.EnablePacking="False"),this.Preferences.ContainsKey("PackWiseProds")&&"TRUE"==this.Preferences.PackWiseProds.toUpperCase()&&(this.Preferences.PackWiseProds="False"),this.Preferences.ContainsKey("AssembleCalcOPRate")&&"TRUE"==this.Preferences.AssembleCalcOPRate.toUpperCase()&&(this.Preferences.AssembleCalcOPRate="False"),this.Preferences.ContainsKey("AutoIssueNextStage")&&"TRUE"==this.Preferences.AutoIssueNextStage.toUpperCase()&&(this.Preferences.AutoIssueNextStage="False"),this.Preferences.ContainsKey("Check Budget")&&"TRUE"==this.Preferences["Check Budget"].toUpperCase()&&(this.Preferences["Check Budget"]="False"),this.Preferences.ContainsKey("PackMandScan")&&"TRUE"==this.Preferences.PackMandScan.toUpperCase()&&(this.Preferences.PackMandScan="False"),this.Preferences.ContainsKey("PosPostings")&&"TRUE"==this.Preferences.PosPostings.toUpperCase()&&(this.Preferences.PosPostings="False"),this.Preferences.ContainsKey("Open Cash Drawer")&&"TRUE"==this.Preferences["Open Cash Drawer"].toUpperCase()&&(this.Preferences["Open Cash Drawer"]="False"),this.Preferences.ContainsKey("PackLabel")&&"TRUE"==this.Preferences.PackLabel.toUpperCase()&&(this.Preferences.PackLabel="False"),this.Preferences.ContainsKey("UseAsLC")&&"TRUE"==this.Preferences.UseAsLC.toUpperCase()&&(this.Preferences.UseAsLC="False"),this.Preferences.ContainsKey("AutoRejoinVacation")&&"TRUE"==this.Preferences.AutoRejoinVacation.toUpperCase()&&(this.Preferences.AutoRejoinVacation="False"),this.Preferences.ContainsKey("CalcOpRate")&&"TRUE"==this.Preferences.CalcOpRate.toUpperCase()&&(this.Preferences.CalcOpRate="False"),this.Preferences.ContainsKey("OptionalBins")&&"TRUE"==this.Preferences.OptionalBins.toUpperCase()&&(this.Preferences.OptionalBins="False"),this.Preferences.ContainsKey("UseasCrossDimension")&&"TRUE"==this.Preferences.UseasCrossDimension.toUpperCase()&&(this.Preferences.UseasCrossDimension="False"),this.Preferences.ContainsKey("ConsiderVacationDayswhilePayrollProcessing")&&"TRUE"==this.Preferences.ConsiderVacationDayswhilePayrollProcessing.toUpperCase()&&(this.Preferences.ConsiderVacationDayswhilePayrollProcessing="False"),this.Preferences.ContainsKey("DoNotReceiveMoreThanJobQty")&&"TRUE"==this.Preferences.DoNotReceiveMoreThanJobQty.toUpperCase()&&(this.Preferences.DoNotReceiveMoreThanJobQty="False"),this.Preferences.ContainsKey("DuplicateProductClubBins")&&"TRUE"==this.Preferences.DuplicateProductClubBins.toUpperCase()&&(this.Preferences.DuplicateProductClubBins="False"),this.Preferences.ContainsKey("AllowResignationifEmployeeonLeaveorVacation")&&"TRUE"==this.Preferences.AllowResignationifEmployeeonLeaveorVacation.toUpperCase()&&(this.Preferences.AllowResignationifEmployeeonLeaveorVacation="False"),this.Preferences.ContainsKey("UseAsTR")&&"TRUE"==this.Preferences.UseAsTR.toUpperCase()&&(this.Preferences.UseAsTR="False"),this.Preferences.ContainsKey("AutoAdjustBins")&&"TRUE"==this.Preferences.AutoAdjustBins.toUpperCase()&&(this.Preferences.AutoAdjustBins="False"),this.Preferences.ContainsKey("EnableTestcase")&&"TRUE"==this.Preferences.EnableTestcase.toUpperCase()&&(this.Preferences.EnableTestcase="False"),this.Preferences.ContainsKey("jobswithissues")&&"TRUE"==this.Preferences.jobswithissues.toUpperCase()&&(this.Preferences.jobswithissues="False"),this.Preferences.ContainsKey("NoAutoproduce")&&"TRUE"==this.Preferences.NoAutoproduce.toUpperCase()&&(this.Preferences.NoAutoproduce="False"),this.Preferences.ContainsKey("SetUpdatedStartEndTimeToShiftTime")&&"TRUE"==this.Preferences.SetUpdatedStartEndTimeToShiftTime.toUpperCase()&&(this.Preferences.SetUpdatedStartEndTimeToShiftTime="False"),this.Preferences.ContainsKey("ShowBins")&&"TRUE"==this.Preferences.ShowBins.toUpperCase()&&(this.Preferences.ShowBins="False"),this.Preferences.ContainsKey("EnableLC")&&"TRUE"==this.Preferences.EnableLC.toUpperCase()&&(this.Preferences.EnableLC="False"),this.Preferences.ContainsKey("EnableWieghingPopupOnQty")&&"TRUE"==this.Preferences.EnableWieghingPopupOnQty.toUpperCase()&&(this.Preferences.EnableWieghingPopupOnQty="False"),this.Preferences.ContainsKey("UseasPosReciept")&&"TRUE"==this.Preferences.UseasPosReciept.toUpperCase()&&(this.Preferences.UseasPosReciept="False"),this.Preferences.ContainsKey("ShowPackStat")&&"TRUE"==this.Preferences.ShowPackStat.toUpperCase()&&(this.Preferences.ShowPackStat="False"),this.Preferences.ContainsKey("ShowVacationCreditDaysDetail")&&"TRUE"==this.Preferences.ShowVacationCreditDaysDetail.toUpperCase()&&(this.Preferences.ShowVacationCreditDaysDetail="False"),this.Preferences.ContainsKey("TempInfo")&&"TRUE"==this.Preferences.TempInfo.toUpperCase()&&(this.Preferences.TempInfo="False"),this.Preferences.ContainsKey("UpdateGradeandAppraisalData")&&"TRUE"==this.Preferences.UpdateGradeandAppraisalData.toUpperCase()&&(this.Preferences.UpdateGradeandAppraisalData="False"),this.Preferences.ContainsKey("CopyBins")&&"TRUE"==this.Preferences.CopyBins.toUpperCase()&&(this.Preferences.CopyBins="False"),this.Preferences.ContainsKey("ScanPack")&&"TRUE"==this.Preferences.ScanPack.toUpperCase()&&(this.Preferences.ScanPack="False"),this.Preferences.ContainsKey("AutoAdjustBinLinking")&&"TRUE"==this.Preferences.AutoAdjustBinLinking.toUpperCase()&&(this.Preferences.AutoAdjustBinLinking="False"),this.Preferences.ContainsKey("DonotCopyBOE")&&"TRUE"==this.Preferences.DonotCopyBOE.toUpperCase()&&(this.Preferences.DonotCopyBOE="False"),this.Preferences.ContainsKey("Enabletolerance")&&"TRUE"==this.Preferences.Enabletolerance.toUpperCase()&&(this.Preferences.Enabletolerance="False"),this.Preferences.ContainsKey("Linkallprodspacked")&&"TRUE"==this.Preferences.Linkallprodspacked.toUpperCase()&&(this.Preferences.Linkallprodspacked="False"),this.Preferences.ContainsKey("Checkpackedqty")&&"TRUE"==this.Preferences.Checkpackedqty.toUpperCase()&&(this.Preferences.Checkpackedqty="False"),this.Preferences.ContainsKey("DonotConsiderOpeningInPaymode")&&"TRUE"==this.Preferences.DonotConsiderOpeningInPaymode.toUpperCase()&&(this.Preferences.DonotConsiderOpeningInPaymode="False"),this.Preferences.ContainsKey("DonotpostOpening")&&"TRUE"==this.Preferences.DonotpostOpening.toUpperCase()&&(this.Preferences.DonotpostOpening="False"),this.Preferences.ContainsKey("UseasGiftVoucher")&&"TRUE"==this.Preferences.UseasGiftVoucher.toUpperCase()&&(this.Preferences.UseasGiftVoucher="False"),this.Preferences.ContainsKey("LogInasSystemDate")&&"TRUE"==this.Preferences.LogInasSystemDate.toUpperCase()&&(this.Preferences.LogInasSystemDate="False"),this.Preferences.ContainsKey("MandatorySalesMan")&&"TRUE"==this.Preferences.MandatorySalesMan.toUpperCase()&&(this.Preferences.MandatorySalesMan="False"),this.Preferences.ContainsKey("DisplaySno")&&"TRUE"==this.Preferences.DisplaySno.toUpperCase()&&(this.Preferences.DisplaySno="False"),this.Preferences.ContainsKey("DonotShowPayModesinReturn")&&"TRUE"==this.Preferences.DonotShowPayModesinReturn.toUpperCase()&&(this.Preferences.DonotShowPayModesinReturn="False"),this.Preferences.ContainsKey("DisableNumPad")&&"TRUE"==this.Preferences.DisableNumPad.toUpperCase()&&(this.Preferences.DisableNumPad="False"),this.Preferences.ContainsKey("ShowDenom")&&"TRUE"==this.Preferences.ShowDenom.toUpperCase()&&(this.Preferences.ShowDenom="False"),this.Preferences.ContainsKey("SkipNegStock")&&"TRUE"==this.Preferences.SkipNegStock.toUpperCase()&&(this.Preferences.SkipNegStock="False"),this.Preferences.ContainsKey("Cancelinclose")&&"TRUE"==this.Preferences.Cancelinclose.toUpperCase()&&(this.Preferences.Cancelinclose="False"),this.Preferences.ContainsKey("MandatoryDenom")&&"TRUE"==this.Preferences.MandatoryDenom.toUpperCase()&&(this.Preferences.MandatoryDenom="False"),this.Preferences.ContainsKey("PickStockRate")&&"TRUE"==this.Preferences.PickStockRate.toUpperCase()&&(this.Preferences.PickStockRate="False"),this.Preferences.ContainsKey("ShowDenomInClose")&&"TRUE"==this.Preferences.ShowDenomInClose.toUpperCase()&&(this.Preferences.ShowDenomInClose="False"),this.Preferences.ContainsKey("UseAsOrder")&&"TRUE"==this.Preferences.UseAsOrder.toUpperCase()&&(this.Preferences.UseAsOrder="False"),this.Preferences.ContainsKey("CashForeignCurrency")&&"TRUE"==this.Preferences.CashForeignCurrency.toUpperCase()&&(this.Preferences.CashForeignCurrency="False"),this.Preferences.ContainsKey("GetOpCash")&&"TRUE"==this.Preferences.GetOpCash.toUpperCase()&&(this.Preferences.GetOpCash="False"),this.Preferences.ContainsKey("ShowSearchOnProductNotFound")&&"TRUE"==this.Preferences.ShowSearchOnProductNotFound.toUpperCase()&&(this.Preferences.ShowSearchOnProductNotFound="False"),this.Preferences.ContainsKey("CreateNewBatchNo")&&"TRUE"==this.Preferences.CreateNewBatchNo.toUpperCase()&&(this.Preferences.CreateNewBatchNo="False"),this.Preferences.ContainsKey("BinvInv")&&"TRUE"==this.Preferences.BinvInv.toUpperCase()&&(this.Preferences.BinvInv="False"),this.Preferences.ContainsKey("BOEAutoAdjustOnCellEnter")&&"TRUE"==this.Preferences.BOEAutoAdjustOnCellEnter.toUpperCase()&&(this.Preferences.BOEAutoAdjustOnCellEnter="False"),this.Preferences.ContainsKey("DefaultPack")&&"TRUE"==this.Preferences.DefaultPack.toUpperCase()&&(this.Preferences.DefaultPack="False"),this.Preferences.ContainsKey("ClubBoe")&&"TRUE"==this.Preferences.ClubBoe.toUpperCase()&&(this.Preferences.ClubBoe="False"),this.Preferences.ContainsKey("CopyBinsFromBoe")&&"TRUE"==this.Preferences.CopyBinsFromBoe.toUpperCase()&&(this.Preferences.CopyBinsFromBoe="False"),this.Preferences.ContainsKey("BilllandingMap")&&"TRUE"==this.Preferences.BilllandingMap.toUpperCase()&&(this.Preferences.BilllandingMap="False"),this.Preferences.ContainsKey("AssetShiftDate")&&"TRUE"==this.Preferences.AssetShiftDate.toUpperCase()&&(this.Preferences.AssetShiftDate="False"),this.Preferences.ContainsKey("AutoBOE")&&"TRUE"==this.Preferences.AutoBOE.toUpperCase()&&(this.Preferences.AutoBOE="False"),this.Preferences.ContainsKey("PostAsset")&&"TRUE"==this.Preferences.PostAsset.toUpperCase()&&(this.Preferences.PostAsset="False"),this.Preferences.ContainsKey("ShowBOE")&&"TRUE"==this.Preferences.ShowBOE.toUpperCase()&&(this.Preferences.ShowBOE="False"),this.Preferences.ContainsKey("Billlanding")&&"TRUE"==this.Preferences.Billlanding.toUpperCase()&&(this.Preferences.Billlanding="False"),this.Preferences.ContainsKey("BOEValidateActualAndAdjustedQtys")&&"TRUE"==this.Preferences.BOEValidateActualAndAdjustedQtys.toUpperCase()&&(this.Preferences.BOEValidateActualAndAdjustedQtys="False"),this.Preferences.ContainsKey("EnableAssetSerialNo")&&"TRUE"==this.Preferences.EnableAssetSerialNo.toUpperCase()&&(this.Preferences.EnableAssetSerialNo="False"),this.Preferences.ContainsKey("POSDiffJVFields")&&"TRUE"==this.Preferences.POSDiffJVFields.toUpperCase()&&(this.Preferences.POSDiffJVFields="False"),this.Preferences.ContainsKey("ShowProduct")&&""!=this.Preferences.ShowProduct.toUpperCase()&&(this.Preferences.ShowProduct=""),this.Preferences.ContainsKey("POSDealerPrice")&&""!=this.Preferences.POSDealerPrice.toUpperCase()&&(this.Preferences.POSDealerPrice="0"),this.Preferences.ContainsKey("TRCloseDocument")&&""!=this.Preferences.TRCloseDocument.toUpperCase()&&(this.Preferences.TRCloseDocument=""),this.Preferences.ContainsKey("Distributebasedon")&&""!=this.Preferences.Distributebasedon.toUpperCase()&&(this.Preferences.Distributebasedon=""),this.Preferences.ContainsKey("POSFields")&&""!=this.Preferences.POSFields.toUpperCase()&&(this.Preferences.POSFields=""),this.Preferences.ContainsKey("POSJVFields")&&""!=this.Preferences.POSJVFields.toUpperCase()&&(this.Preferences.POSJVFields=""),this.Preferences.ContainsKey("PackQty")&&""!=this.Preferences.PackQty.toUpperCase()&&(this.Preferences.PackQty=""),this.Preferences.ContainsKey("PosJVOn")&&""!=this.Preferences.PosJVOn.toUpperCase()&&(this.Preferences.PosJVOn=""),this.Preferences.ContainsKey("POSRetailPrice")&&""!=this.Preferences.POSRetailPrice.toUpperCase()&&(this.Preferences.POSRetailPrice="0"),this.Preferences.ContainsKey("LcCloseDocument")&&""!=this.Preferences.LcCloseDocument.toUpperCase()&&(this.Preferences.LcCloseDocument="0"),this.Preferences.ContainsKey("PosJV")&&""!=this.Preferences.PosJV.toUpperCase()&&(this.Preferences.PosJV="0"),this.Preferences.ContainsKey("CrossDimDocument")&&""!=this.Preferences.CrossDimDocument.toUpperCase()&&(this.Preferences.CrossDimDocument="0"),this.Preferences.ContainsKey("ExpFPQTY")&&""!=this.Preferences.ExpFPQTY.toUpperCase()&&(this.Preferences.ExpFPQTY="0"),this.Preferences.ContainsKey("FPQty")&&""!=this.Preferences.FPQty.toUpperCase()&&(this.Preferences.FPQty="0"),this.Preferences.ContainsKey("PosPaymentTypeFld")&&""!=this.Preferences.PosPaymentTypeFld.toUpperCase()&&(this.Preferences.PosPaymentTypeFld="0"),this.Preferences.ContainsKey("Distributebasedon")&&""!=this.Preferences.Distributebasedon.toUpperCase()&&(this.Preferences.Distributebasedon=""),this.Preferences.ContainsKey("CrossDimField")&&""!=this.Preferences.CrossDimField.toUpperCase()&&(this.Preferences.CrossDimField="0"),this.Preferences.ContainsKey("RowHeight")&&""!=this.Preferences.RowHeight.toUpperCase()&&(this.Preferences.RowHeight="0"),this.Preferences.ContainsKey("right panel width")&&""!=this.Preferences["right panel width"].toUpperCase()&&(this.Preferences["right panel width"]="0"),this.Preferences.ContainsKey("OnScan")&&""!=this.Preferences.OnScan.toUpperCase()&&(this.Preferences.OnScan=""),this.Preferences.ContainsKey("BilllandingReport")&&""!=this.Preferences.BilllandingReport.toUpperCase()&&(this.Preferences.BilllandingReport="0"),this.Preferences.ContainsKey("AssetBasedOn")&&""!=this.Preferences.AssetBasedOn.toUpperCase()&&(this.Preferences.AssetBasedOn="0"),this.Preferences.ContainsKey("DefaultLabel")&&""!=this.Preferences.DefaultLabel.toUpperCase()&&(this.Preferences.DefaultLabel=""),this.Preferences.ContainsKey("BilllandingScanField")&&""!=this.Preferences.BilllandingScanField.toUpperCase()&&(this.Preferences.BilllandingScanField=""),this.Preferences.ContainsKey("DistributeCostDims")&&""!=this.Preferences.DistributeCostDims.toUpperCase()&&(this.Preferences.DistributeCostDims="")}GetShifts(e){let t=0;if(n.a.SessionManager.Preferences.ContainsKey("PosShifts")&&a.e.Int(n.a.SessionManager.Preferences.PosShifts)>5e4){let s=n.a.common.GetDataSet3("DOC040",n.a.SessionManager.Preferences.PosShifts,e.ToString("dd/MMM/yyyy"));t=null!=s&&s.Tables.length>0&&s.Tables[0].length>0&&s.Columns[0].Contains("NodeID")?parseInt(s.Tables[0][0].NodeID):1}else t=1;return t}GetEditDataCopy(e,t,s){let a=[];return a.push(s),a.push(e),a.push(t),a.push(0),a.push(0),a.push(""),a.push(n.a.SessionManager.UserID),a.push(n.a.SessionManager.RoleID),a.push(n.a.SessionManager.UserName),a.push(n.a.SessionManager.LanguageID),n.a.document.GetEditDataCopy(this.IsInventory?"1":"0",a)}GetEditData(e,t,s){return n.a.document.GetEditData(this.CostCenterID,e,t,s,"0",this.LockWhere,this.IsInventory)}GetEditDataByCCDOCID(e,t){return n.a.document.GetEditData(e,"","","0",t,this.LockWhere,this.IsInventory)}static UpdateScheduleEvents(e,t,s){let a=[];return a.push(e),a.push(t),a.push(s),a.push(n.a.SessionManager.UserID),a.push(n.a.SessionManager.LanguageID),n.a.report.UpdateScheduleEvents(a)}GetDocumentHistory(){let e=[];return e.push(this.CostCenterID),e.push(this.DocID),e.push(n.a.SessionManager.UserID),e.push(n.a.SessionManager.RoleID),e.push(n.a.SessionManager.UserName),e.push(n.a.SessionManager.LanguageID),n.a.document.GetDocumentHistory(e)}GetReviseHistory(){let e=[];return e.push(this.DocID),e.push(this.IsInventory),e.push(n.a.SessionManager.UserID),e.push(n.a.SessionManager.LanguageID),n.a.document.GetReviseHistory(e)}GetEditDataByDOCID(){let e=[];return e.push(this.CostCenterID),e.push(""),e.push(""),e.push("0"),e.push(this.DocID),e.push(this.LockWhere),e.push(n.a.SessionManager.UserID),e.push(n.a.SessionManager.RoleID),e.push(n.a.SessionManager.UserName),e.push(n.a.SessionManager.LanguageID),n.a.document.GetEditDataCopy(this.IsInventory?"1":"0",e)}GetEditDataByVersion(e,t){let s=[];return s.push(this.CostCenterID),s.push(this.DocID),s.push(e),s.push(t),s.push(n.a.SessionManager.UserID),s.push(n.a.SessionManager.RoleID),s.push(n.a.SessionManager.UserName),s.push(n.a.SessionManager.LanguageID),n.a.document.GetEditDataByVersion(this.IsInventory?"1":"0",s)}SuspentDocument(e,t){let s=[];return s.push(this.CostCenterID),s.push(this.DocID),s.push(this.Prefix),s.push(null!=this.DocPrefix.TextBox.Text?this.DocPrefix.TextBox.Text:""),s.push(t),s.push(this.LockWhere),s.push(e),s.push(n.a.SessionManager.UserID),s.push(n.a.SessionManager.UserName),s.push(n.a.SessionManager.RoleID),s.push(n.a.SessionManager.LanguageID),n.a.document.SuspentDocument(this.IsInventory?"1":"0",s)}DeleteDocument(){let e=[];return e.push(this.CostCenterID),e.push(this.Prefix),e.push(null!=this.DocPrefix.TextBox.Text?this.DocPrefix.TextBox.Text:""),e.push(0),e.push(this.LockWhere),e.push(n.a.SessionManager.UserID),e.push(n.a.SessionManager.UserName),e.push(n.a.SessionManager.LanguageID),e.push(n.a.SessionManager.RoleID),n.a.document.DeleteDocument(this.IsInventory?"1":"0",e)}DeleteDocumentByDocID(e,t,s){let a=[];return a.push(e),a.push(""),a.push(""),a.push(t),a.push(this.LockWhere),a.push(n.a.SessionManager.UserID),a.push(n.a.SessionManager.UserName),a.push(n.a.SessionManager.LanguageID),a.push(n.a.SessionManager.RoleID),n.a.document.DeleteDocument(this.IsInventory?"1":"0",a)}OnDocPrefixChanged(e,t,s,i,o,r=0){let l=0;if(null!=e&&"lostFocus"==e.toString()){if(this.IsRefLCTR=!1,this.DocPrefix.ComboBox.SelectedValue!=this.DocPrefix.TextBox.Text){Logger.InfoLog("VoucherGenerator:: Inside GetDocument");let e=null;var D;if(a.e.IsValidID(s)?(this.DocID=s,e=n.a.document.GetEditData(this.CostCenterID,"","","0",this.DocID,this.LockWhere,this.IsInventory),null!=e&&e.Tables.length>0&&e.Columns[0].Contains("DocPrefix")&&e.Tables[0].length>0&&(this.DocPrefix.ComboBox.Items.find(t=>t instanceof u.d&&t.Value==e.Tables[0][0].DocPrefix.toString())||this.DocPrefix.ComboBox.Items.push(u.d.ComboBoxItems_2(e.Tables[0][0].DocPrefix.toString(),e.Tables[0][0].DocPrefix.toString())),this.DocPrefix.ComboBox.SelectedValue=e.Tables[0][0].DocPrefix.toString(),this.DocPrefix.TextBox.Text=e.Tables[0][0].DocNumber.toString())):(e=n.a.document.GetEditData(this.CostCenterID,this.Prefix,null!=this.DocPrefix.TextBox.Text?this.DocPrefix.TextBox.Text:"",t,"0",this.LockWhere,this.IsInventory),null!=e&&e.Tables.length>0&&e.Columns[0].Contains("DocPrefix")&&e.Tables[0].length>0&&(this.DocPrefix.ComboBox.Items.find(t=>t instanceof u.d&&t.Value==e.Tables[0][0].DocPrefix.toString())||(this.DocPrefix.ComboBox.Items.push(u.d.ComboBoxItems_2(e.Tables[0][0].DocPrefix.toString(),e.Tables[0][0].DocPrefix.toString())),this.DocPrefix.ComboBox.SelectedValue=e.Tables[0][0].DocPrefix.toString()))),e.Tables.length>1&&e.Tables[0].length>0&&!e.Columns[0].Contains("ErrorMessage")){if(this.DocID=parseInt(e.Tables[0][0].DocID),this.RefNodeID=a.e.IsEmpty(e.Tables[0][0].RefNodeid)?0:parseInt(e.Tables[0][0].RefNodeid),this.RefCCId=a.e.IsEmpty(e.Tables[0][0].RefCCId)?0:parseInt(e.Tables[0][0].RefCCId),this.VoucherNo=e.Tables[0][0].VoucherNO,this.guid=e.Tables[0][0].GUID,!this.IsInventory&&e.Tables.length>9&&e.Tables[9].length>0&&e.Columns[9].Contains("ErrorMessage")?(this.IsBouncedorPdcPosted=!0,this.BouncedorPdcMessage=e.Tables[9][0].ErrorMessage):this.IsBouncedorPdcPosted=!1,l=parseInt(e.Tables[0][0].StatusID),this.LoadEditData(e,!1),a.e.IsEmpty(e.Tables[0][0].DocDate)||(i.value=new Date(e.Tables[0][0].DocDate),this.ovDate.Text=i.value.ToString(n.a.SessionManager.Preferences["Date Format"])),e.Tables.length>1&&e.Tables[1].length>0&&(n.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"True"==n.a.SessionManager.Preferences.EnableLocationWise.toString()&&!a.e.IsEmpty(e.Tables[1][0].dcCCNID2)&&(this.LocationID=this.Preferences.ContainsKey("Donotuselocation")&&""!=this.Preferences.Donotuselocation&&Object(S.j)(this.Preferences.Donotuselocation)?0:parseInt(e.Tables[1][0].dcCCNID2),null!=(D=this._CCFields.find(e=>e instanceof c.b&&50002==e.CCID))&&a.e.IsEmpty(D.DefaultValue)&&(D.DefaultValue=this.LocationID.toString())),n.a.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&"True"==n.a.SessionManager.Preferences.EnableDivisionWise.toString()&&!a.e.IsEmpty(e.Tables[1][0].dcCCNID1)&&(this.DivisionID=this.Preferences.ContainsKey("Donotusedivision")&&""!=this.Preferences.Donotusedivision&&Object(S.j)(this.Preferences.Donotusedivision)?0:parseInt(e.Tables[1][0].dcCCNID1),(D=this._CCFields.find(e=>e instanceof c.b&&50001==e.CCID))&&a.e.IsEmpty(D.DefaultValue)&&(D.DefaultValue=this.DivisionID.toString()))),e.Tables.length>13&&e.Columns[13].Contains("DocID")&&e.Tables[13].length>0?(e.Columns[13].Contains("DocID")&&!a.e.IsEmpty(e.Tables[13][0].DocID)&&(this.PostVoucherDocID=parseInt(e.Tables[13][0].DocID)),e.Columns[13].Contains("AccDocDetailsID")&&!a.e.IsEmpty(e.Tables[13][0].AccDocDetailsID)&&(this.PostVoucherDocDetailsID=parseInt(e.Tables[13][0].AccDocDetailsID)),e.Columns[13].Contains("DocPrefix")&&(this.PostVouceherDocPrefix=e.Tables[13][0].DocPrefix.toString()),e.Columns[13].Contains("DocNumber")&&(this.PostVoucherDocnumber=e.Tables[13][0].DocNumber.toString()),e.Columns[13].Contains("CreditAccount")&&!a.e.IsEmpty(e.Tables[13][0].CreditAccount)&&(this.PostVoucherDebitAccount=parseInt(e.Tables[13][0].CreditAccount)),e.Columns[13].Contains("DebitAccount")&&!a.e.IsEmpty(e.Tables[13][0].DebitAccount)&&(this.PostVoucherDebitAccount=parseInt(e.Tables[13][0].DebitAccount)),e.Columns[13].Contains("Amount")&&!a.e.IsEmpty(e.Tables[13][0].Amount)&&(this.PostVoucherAmount=parseFloat(e.Tables[13][0].Amount))):(this.PostVoucherDocID=0,this.PostVoucherCreditAccount=0,this.PostVoucherDebitAccount=0,this.PostVoucherDocDetailsID=0,this.PostVouceherDocPrefix="",this.PostVoucherDocnumber="",this.PostVoucherAmount=0),null!=this.DocPrefix&&this.DocPrefix.RevisionCombo.Visible){this.DocPrefix.RevisionCombo.Items.Clear();let t=!1;if(this.IsInventory&&e.Tables.length>14&&e.Columns[14].Contains("Versionno")&&e.Tables[14].length>0)for(let s=0;s<e.Tables[14].length;s++)"0"==e.Tables[14][s].Versionno.toString()?this.DocPrefix.RevisionCombo.Items.push(u.d.ComboBoxItems_2("","0")):this.DocPrefix.RevisionCombo.Items.push(u.d.ComboBoxItems_2(a.e.StringValue(e.Tables[14][s].Versionno),a.e.StringValue(e.Tables[14][s].Versionno))),a.e.StringValue(e.Tables[0][0].VersionNo)==a.e.StringValue(e.Tables[14][s].Versionno)&&(t=!0);else if(!this.IsInventory&&e.Tables.length>10&&e.Columns[10].Contains("Versionno")&&e.Tables[10].length>0)for(let s=0;s<e.Tables[10].length;s++)"0"==e.Tables[10][s].Versionno.toString()?this.DocPrefix.RevisionCombo.Items.push(u.d.ComboBoxItems_2("","0")):this.DocPrefix.RevisionCombo.Items.push(u.d.ComboBoxItems_2(a.e.StringValue(e.Tables[10][s].Versionno),a.e.StringValue(e.Tables[10][s].Versionno))),a.e.StringValue(e.Tables[0][0].VersionNo)==a.e.StringValue(e.Tables[10][s].Versionno)&&(t=!0);t||("0"==a.e.StringValue(e.Tables[0][0].VersionNo)?this.DocPrefix.RevisionCombo.Items.push(u.d.ComboBoxItems_2("","0")):this.DocPrefix.RevisionCombo.Items.push(u.d.ComboBoxItems_2(a.e.StringValue(e.Tables[0][0].VersionNo),a.e.StringValue(e.Tables[0][0].VersionNo)))),this.DocPrefix.RevisionCombo.SelectedValue=a.e.StringValue(e.Tables[0][0].VersionNo)}}else this.DocID=0,this.RefNodeID=0,this.RefCCId=0,this.IsBouncedorPdcPosted=!1,this.Clear(i,2),this.VoucherNo="",this.CheckViewForUser(l);Logger.InfoLog("VoucherGenerator:: Exiting GetDocument")}}else if(null!=e){0==r&&(this.RefNodeID=0,this.RefCCId=0),this.IsBouncedorPdcPosted=!1,this.DocID=0;let e=1==this.IsResave?null:n.a.document.getcurrentcode(this.CostCenterID,this.Prefix);null!=e&&e.Tables.length>0&&e.Tables[0].length>0&&!e.Columns[0].Contains("ErrorMessage")&&e.Columns[0].Contains("CurrentCodeNumber")&&!a.e.IsNullOrWhiteSpace(e.Tables[0][0].CurrentCodeNumber)?(this.DocPrefix.TextBox.Text=e.Tables[0][0].CurrentCodeNumber.toString(),null!=this.DocPrefix.ComboBox.SelectedItem&&(a.e.IsEmpty(this.DocPrefix.ComboBox.SelectedItem.Aliasname)||"1"==this.DocPrefix.ComboBox.SelectedItem.Aliasname)&&e.Columns[0].Contains("Codelength")&&!a.e.IsEmpty(e.Tables[0][0].Codelength)&&parseInt(e.Tables[0][0].Codelength)>1&&(this.DocPrefix.ComboBox.SelectedItem.Aliasname=e.Tables[0][0].Codelength.toString())):this.DocPrefix.TextBox.Text=this.Preferences.ContainsKey("StartNoForNewPrefix")&&!a.e.IsEmpty(this.Preferences.StartNoForNewPrefix)&&"0"!=this.Preferences.StartNoForNewPrefix?this.Preferences.StartNoForNewPrefix:"1",o&&this.Clear(i,1),this.CheckViewForUser(l)}}DivisionChanged(){n.a.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&"True"==n.a.SessionManager.Preferences.EnableDivisionWise.toString()&&this._CCFields.forEach(e=>{e instanceof c.b&&50001==e.CCID?(e.DefaultValue=this.DivisionID.toString(),e.DBColumnName.Contains("TO")||(e.DefaultValue=this.DivisionID.toString(),e.SelectedValue=this.DivisionID,this.FilterTo(e))):e instanceof D.a&&50001==e.CCID&&(e.DefaultValue=this.DivisionID.toString(),e.DBColumnName.Contains("TO")||(e.SelectedValue=this.DivisionID),this.FilterToCodeName(e))})}LocationChanged(){n.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"True"==n.a.SessionManager.Preferences.EnableLocationWise.toString()&&this._CCFields.forEach(e=>{e instanceof c.b&&50002==e.CCID?(e.DefaultValue=this.LocationID.toString(),e.DBColumnName.Contains("TO")||(e.SelectedValue=this.LocationID),this.FilterTo(e)):e instanceof D.a&&50002==e.CCID&&(e.DefaultValue=this.LocationID.toString(),e.DBColumnName.Contains("TO")||(e.SelectedValue=this.LocationID),this.FilterToCodeName(e))})}SaveBulkInvDoc(e,t,s,i,o,r,l,u){Logger.InfoLog("VoucherGenerator:: Inside SaveDocument");let c=[];if(c.push(this.CostCenterID),c.push(this.DocID),c.push(null!=this.Prefix?this.Prefix:""),c.push(null!=this.DocPrefix&&null!=this.DocPrefix.TextBox.Text?this.DocPrefix.TextBox.Text:""),c.push(i.ToString("dd/MMM/yyyy")),c.push(null!=this.DueDate?this.DueDate.Date?this.DueDate.Date.ToString("dd/MMM/yyyy"):null:this.DueDate),null!=this.BillNo)c.push(this.BillNo.Text);else{let e="";if(this.GridDataColumns.Contains("BillNo"))for(let t=0;t<this.GridData.length;t++)a.e.IsEmpty(this.GridData[t].ProductID_Key)||a.e.IsEmpty(this.GridData[t].BillNo)||(""!=e&&(e+=","),e+=this.GridData[t].BillNo.toString());c.push(e)}c.AddRange(e),c.push(t),c.push(s),c.push(l),c.push("false"),n.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"True"==n.a.SessionManager.Preferences.EnableLocationWise.toString()?c.push(this.LocationID>0?this.LocationID:n.a.SessionManager.LocationID>0?n.a.SessionManager.LocationID:1):c.push(0),n.a.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&"True"==n.a.SessionManager.Preferences.EnableDivisionWise.toString()?c.push(this.DivisionID>0?this.DivisionID:n.a.SessionManager.DivisionID>0?n.a.SessionManager.DivisionID:1):c.push(0),c.push(o),c.push(n.a.SessionManager.RoleID),c.push(r),86==this.RefCCId||73==this.RefCCId||89==this.RefCCId||n.a.SessionManager.IsActionAssigned(43,"Edit Reference Documents")?(c.push(this.RefCCId),c.push(this.RefNodeID)):(c.push(0),c.push(0)),c.push(n.a.SessionManager.CompanyGUID),c.push(n.a.SessionManager.UserName),c.push(n.a.SessionManager.UserID),c.push(n.a.SessionManager.LanguageID),c.push(n.a.SessionManager.IsOffline);let D="",h=n.a.document.SetTempBulkInvDoc(c);u.RetVal=h.obj;let C=h;return null!=C&&C.Tables.length>0&&C.Tables[C.Tables.length-1].length>0&&C.Columns[C.Tables.length-1].Contains("ErrorMessage")?(D=C.Tables[C.Tables.length-1][0].ErrorMessage.toString(),u.RetVal>0?(this.DocID=u.RetVal,null!=C&&C.Tables.length>0&&C.Tables[C.Tables.length-1].length>0&&C.Columns[C.Tables.length-1].Contains("VoucherNo")&&(this.VoucherNo=C.Tables[C.Tables.length-1][0].VoucherNo.toString()),null!=C&&C.Tables.length>0&&C.Tables[C.Tables.length-1].length>0&&C.Columns[C.Tables.length-1].Contains("StatusID")&&(u.stat=parseInt(C.Tables[C.Tables.length-1][0].StatusID)),this.DraftID>0&&(h=n.a.document.DeleteDocumentDraft(this.DraftID),u.RetVal=h.obj,this.DraftID=0)):null!=C&&C.Tables.length>0&&C.Tables[C.Tables.length-1].length>0&&C.Columns[C.Tables.length-1].Contains("ServerMessage")&&"-407"==C.Tables[C.Tables.length-1][0].ServerMessage.toString()&&(u.RetVal=-407),Logger.InfoLog("VoucherGenerator:: Exiting SaveDocument"),D):"Problem in processing your request,Please contact administrator."}SaveInventoryDocument(e,t,s,i,o,r,l,u,c){this.oParent.Status=0,this.oParent.RetVal=0,this.oParent.message="",Logger.InfoLog("VoucherGenerator:: Inside SaveDocument");let D=[];if(D.push(this.CostCenterID),D.push(this.DocID),D.push(null!=this.Prefix?this.Prefix:""),D.push(null!=this.DocPrefix&&null!=this.DocPrefix.TextBox.Text?this.DocPrefix.TextBox.Text:""),D.push(o.ToString("dd/MMM/yyyy")),D.push(this.DueDate?this.DueDate.Date?this.DueDate.Date.ToString("dd/MMM/yyyy"):null:this.DueDate),this.BillNo)D.push(this.BillNo.Text);else{let e="";if(this.GridDataColumns.Contains("BillNo"))for(let t=0;t<this.GridData.length;t++)a.e.IsEmpty(this.GridData[t].ProductID_Key)||a.e.IsEmpty(this.GridData[t].BillNo)||(""!=e&&(e+=","),e+=this.GridData[t].BillNo.toString());D.push(e)}D.push(e),D.push(t),D.push(s),D.push(i),D.push(u),D.push("false"),n.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"True"==n.a.SessionManager.Preferences.EnableLocationWise.toString()?D.push(this.LocationID>0?this.LocationID:n.a.SessionManager.LocationID>0?n.a.SessionManager.LocationID:1):D.push(0),n.a.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&"True"==n.a.SessionManager.Preferences.EnableDivisionWise.toString()?D.push(this.DivisionID>0?this.DivisionID:n.a.SessionManager.DivisionID>0?n.a.SessionManager.DivisionID:1):D.push(0),D.push(r),D.push(n.a.SessionManager.RoleID),D.push(l),86==this.RefCCId||73==this.RefCCId||89==this.RefCCId||n.a.SessionManager.IsActionAssigned(43,"Edit Reference Documents")?(D.push(this.RefCCId),D.push(this.RefNodeID)):(D.push(0),D.push(0)),D.push(n.a.SessionManager.CompanyGUID),D.push(n.a.SessionManager.UserName),D.push(n.a.SessionManager.UserID),D.push(n.a.SessionManager.LanguageID),D.push(n.a.SessionManager.IsOffline),n.a.document.SetTempInvDocument(D).subscribe(e=>{e.RetVal=e.obj,this.oParent.RetValue=e.RetVal;let t=e;if(!(null!=t&&t.Tables.length>0&&t.Tables[t.Tables.length-1].length>0&&t.Columns[t.Tables.length-1].Contains("ErrorMessage")))return this.oParent.DisplayMessage="Problem in processing your request,Please contact administrator.",void this.oParent.SaveInventoryDocument_CallBack(c);this.oParent.DisplayMessage=t.Tables[t.Tables.length-1][0].ErrorMessage.toString(),this.oParent.RetValue>0||this.oParent.RetValue<-1e4?(this.DocID=this.oParent.RetValue,null!=t&&t.Tables.length>0&&t.Tables[t.Tables.length-1].length>0&&t.Columns[t.Tables.length-1].Contains("VoucherNo")&&(this.VoucherNo=t.Tables[t.Tables.length-1][0].VoucherNo.toString()),null!=t&&t.Tables.length>0&&t.Tables[t.Tables.length-1].length>0&&t.Columns[t.Tables.length-1].Contains("StatusID")&&(this.oParent.StatusID=parseInt(t.Tables[t.Tables.length-1][0].StatusID)),this.DraftID>0&&(n.a.document.DeleteDocumentDraft(this.DraftID),this.DraftID=0)):null!=t&&t.Tables.length>0&&t.Tables[t.Tables.length-1].length>0&&t.Columns[t.Tables.length-1].Contains("ServerMessage")&&"-407"==t.Tables[t.Tables.length-1][0].ServerMessage.toString()&&(this.oParent.RetValue=-407),Logger.InfoLog("VoucherGenerator:: Exiting SaveDocument"),this.oParent.SaveInventoryDocument_CallBack(c)},e=>{this.oParent.DisplayMessage="Save API Error",console.log(e)})}UpdateBulkInventoryDocument(e,t,s,a,i,o,r){Logger.InfoLog("VoucherGenerator:: Inside SaveDocument");let l=[];return l.push(o),l.push(r),l.push(e),l.push(t),l.push(s),l.push(a),l.push(i),l.push(n.a.SessionManager.CompanyGUID),l.push(n.a.SessionManager.UserName),l.push(n.a.SessionManager.UserID),l.push(n.a.SessionManager.LanguageID),n.a.document.BulkUpdateInvDocument(l)}PostInventoryDocument(e,t,s,a,i,o,r){Logger.InfoLog("VoucherGenerator:: Inside SaveDocument");let l=[];return l.push(r),l.push(this.DocID),null!=i&&l.push(i.ToString("dd/MMM/yyyy")),l.push(this.DueDate&&this.DueDate.Date?this.DueDate.Date.ToString("dd/MMM/yyyy"):null),l.push(null!=this.BillNo?this.BillNo.Text:""),l.push(e),l.push(t),l.push(s),l.push(a),l.push("false"),n.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"True"==n.a.SessionManager.Preferences.EnableLocationWise.toString()?l.push(this.LocationID>0?this.LocationID:n.a.SessionManager.LocationID>0?n.a.SessionManager.LocationID:0):l.push(0),n.a.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&"True"==n.a.SessionManager.Preferences.EnableDivisionWise.toString()?l.push(this.DivisionID>0?this.DivisionID:n.a.SessionManager.DivisionID>0?n.a.SessionManager.DivisionID:0):l.push(0),l.push(o),l.push(this.CostCenterID),l.push(n.a.SessionManager.RoleID),l.push(n.a.SessionManager.CompanyGUID),l.push(n.a.SessionManager.UserName),l.push(n.a.SessionManager.UserID),l.push(n.a.SessionManager.LanguageID),n.a.document.PostInventoryDocument(l)}CheckInvPosting(e){let t=[];return t.push(e),t.push(n.a.SessionManager.RoleID),t.push(n.a.SessionManager.UserID),t.push(n.a.SessionManager.LanguageID),n.a.document.CheckInvPosting(t)}GetPSPProducts(e,t,s,i){let o=[];o.push(i),o.push(e);let r=0,l=!1,u="";var D;return r=a.e.Int(n.a.SessionManager.Preferences["Maintain Dimensionwise stock"]),r>5e4&&(D=this._CCFields.find(e=>e.DBColumnName.toLowerCase()=="dcccnid"+(r-5e4)))instanceof c.b&&D.SelectedValue>0&&(u+=" and dcccnid"+(r-5e4)+"="+D.SelectedValue.toString()),n.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&Object(S.j)(n.a.SessionManager.Preferences.EnableLocationWise)&&n.a.SessionManager.Preferences.ContainsKey("Location Stock")&&Object(S.j)(n.a.SessionManager.Preferences["Location Stock"])&&((D=this._CCFields.find(e=>"dcccnid2"==e.DBColumnName.toLowerCase()))instanceof c.b&&D.SelectedValue>0?u+=" and dcccnid2="+D.SelectedValue.toString():this.LocationID>0?u+=" and dcccnid1="+this.LocationID.toString():n.a.SessionManager.LocationID>0&&(u+=" and dcccnid1="+n.a.SessionManager.LocationID.toString())),l=!1,n.a.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&Object(S.j)(n.a.SessionManager.Preferences.EnableDivisionWise)&&n.a.SessionManager.Preferences.ContainsKey("Division Stock")&&Object(S.j)(n.a.SessionManager.Preferences["Division Stock"])&&((D=this._CCFields.find(e=>"dcccnid1"==e.DBColumnName.toLowerCase()))instanceof c.b&&D.SelectedValue>0?u+=" and dcccnid1="+D.SelectedValue.toString():this.DivisionID>0?u+=" and dcccnid1="+this.DivisionID.toString():n.a.SessionManager.DivisionID>0&&(u+=" and dcccnid1="+n.a.SessionManager.DivisionID.toString())),o.push(u),o.push(s),o.push(t.ToString("dd/MMM/yyyy")),r=a.e.Int(n.a.SessionManager.Preferences.POSItemCodeDimension),""!=n.a.SessionManager.Preferences.POSItemCodeDimension&&r>5e4?(o.push("dcccnid"+(r-5e4)),o.push(this.GetTableName(parseInt(n.a.SessionManager.Preferences.POSItemCodeDimension)))):(o.push(""),o.push("")),o.push(n.a.SessionManager.UserID),o.push(n.a.SessionManager.LanguageID),n.a.document.GetPSPProducts(o)}PostAccountingDocument(e,t,s,a,i,o){Logger.InfoLog("VoucherGenerator:: Inside PostAccountingDocument");let r=[];if(r.push(o),r.push(this.DocID),null!=a&&r.push(a.ToString("dd/MMM/yyyy")),r.push(null!=this.DueDate?this.DueDate.Date?this.DueDate.Date.ToString("dd/MMM/yyyy"):null:this.DueDate),r.push(null!=this.BillNo?this.BillNo.Text:""),r.push(e),r.push(t),r.push(s),n.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"True"==n.a.SessionManager.Preferences.EnableLocationWise.toString())if(this.LocationID>0)r.push(this.LocationID);else if(n.a.SessionManager.LocationID>0)r.push(n.a.SessionManager.LocationID);else{var l=this._CCFields.find(e=>e instanceof c.b&&50002==e.CCID);r.push(null!=l&&l.SelectedValue>0?l.SelectedValue:0)}else r.push(0);return n.a.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&"True"==n.a.SessionManager.Preferences.EnableDivisionWise.toString()?this.DivisionID>0?r.push(this.DivisionID):n.a.SessionManager.DivisionID>0?r.push(n.a.SessionManager.DivisionID):(l=this._CCFields.find(e=>e instanceof c.b&&50001==e.CCID),r.push(null!=l&&l.SelectedValue>0?l.SelectedValue:0)):r.push(0),r.push(i),r.push(n.a.SessionManager.RoleID),r.push(this.CostCenterID),r.push(this.DocumentType),r.push(n.a.SessionManager.CompanyGUID),r.push(n.a.SessionManager.UserName),r.push(n.a.SessionManager.UserID),r.push(n.a.SessionManager.LanguageID),n.a.document.SetBouncePosting(r)}SaveAccountingDocument(e,t,s,a,i,o,r){Logger.InfoLog("VoucherGenerator:: Inside SaveDocument");let l=[];return l.push(this.CostCenterID),l.push(this.DocID),l.push(this.Prefix),l.push(null!=this.DocPrefix.TextBox.Text?this.DocPrefix.TextBox.Text:""),null!=i&&l.push(i.ToString("dd/MMM/yyyy")),l.push(null!=this.DueDate?this.DueDate.Date?this.DueDate.Date.ToString("dd/MMM/yyyy"):null:this.DueDate),l.push(r>0?r:null!=this.BillNo?this.BillNo.Text:""),l.push(e),l.push(t),l.push(s),l.push(a),l.push("false"),n.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"True"==n.a.SessionManager.Preferences.EnableLocationWise.toString()?l.push(this.LocationID>0?this.LocationID:n.a.SessionManager.LocationID>0?n.a.SessionManager.LocationID:0):l.push(0),n.a.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&"True"==n.a.SessionManager.Preferences.EnableDivisionWise.toString()?l.push(this.DivisionID>0?this.DivisionID:n.a.SessionManager.DivisionID>0?n.a.SessionManager.DivisionID:0):l.push(0),l.push(o),l.push(n.a.SessionManager.RoleID),this.IsRefLCTR||n.a.SessionManager.IsActionAssigned(43,"Edit Reference Documents")?(l.push(this.RefCCId),l.push(this.RefNodeID)):(l.push(0),l.push(0)),l.push(n.a.SessionManager.CompanyGUID),l.push(n.a.SessionManager.UserName),l.push(n.a.SessionManager.UserID),l.push(n.a.SessionManager.LanguageID),l.push(n.a.SessionManager.IsOffline),n.a.document.SetTempAccDocument(l)}SaveAccountingDocument_2(e,t,s,a,i,o,r,l,u,c,D){Logger.InfoLog("VoucherGenerator:: Inside SaveRefDocument");let h=[];return h.push(e),h.push(t),h.push(s),h.push(a),h.push(o.ToString("dd/MMM/yyyy")),h.push(i),h.push(c),h.push(D),n.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"True"==n.a.SessionManager.Preferences.EnableLocationWise.toString()?this.LocationID>0?h.push(this.LocationID):n.a.SessionManager.LocationID>0&&h.push(n.a.SessionManager.LocationID):h.push(0),n.a.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&"True"==n.a.SessionManager.Preferences.EnableDivisionWise.toString()?h.push(this.DivisionID>0?this.DivisionID:n.a.SessionManager.DivisionID>0?n.a.SessionManager.DivisionID:0):h.push(0),h.push(n.a.SessionManager.RoleID),h.push(l),h.push(u),h.push(n.a.SessionManager.CompanyGUID),h.push(n.a.SessionManager.UserName),h.push(n.a.SessionManager.UserID),h.push(n.a.SessionManager.LanguageID),h.push(n.a.SessionManager.IsOffline),n.a.document.PostVoucherSave(h)}SetDocumentDraft(e){return e.push(n.a.SessionManager.CompanyGUID),e.push(""),e.push(n.a.SessionManager.UserName),e.push(n.a.SessionManager.UserID),e.push(n.a.SessionManager.LanguageID),n.a.document.SetDocumentDraft(e)}AttachDetach(e){this.IsLoadingeditData=!e,this.HeaderFields.forEach(t=>{t instanceof D.a?e?t.SelectionCallBack.Subscribe(this,"OnGetReference"):(t.SelectionCallBack.UnSubscribe(),t.t.Enabled=!1):t instanceof c.b&&(e?t.OnPactListBoxValueChanged.Subscribe(this,"OnGetReference"):(t.OnPactListBoxValueChanged.UnSubscribe(),t.t.Enabled=!1))}),this._CCFields.forEach(t=>{t instanceof D.a?e?t.SelectionCallBack.Subscribe(this,"OnGetReference"):(t.t.Enabled=!1,t.SelectionCallBack.UnSubscribe()):t instanceof c.b&&(e?t.OnPactListBoxValueChanged.Subscribe(this,"OnGetReference"):(t.t.Enabled=!1,t.OnPactListBoxValueChanged.UnSubscribe()))}),this._TextFields.forEach(t=>{t instanceof u.e&&(e?t.SelectionChangedCommand.Subscribe(this,"OnGetReference"):t.SelectionChangedCommand.UnSubscribe())})}LoadEditData(e,t,s=0){try{this.AttachDetach(!1),this.LoadEditData_1(e,t,!0,s)}catch(n){this.oParent.DisplayMessage="Error in loading data..",Logger.ErrorLog("VoucherGenerator","LoadEditData",n.stack)}finally{this.AttachDetach(!0),this.GridDataObj.refreshDatawithIDs(),this.FooterGridDataObj.refreshDatawithIDs()}}GetEmptyRowPosition(e,t){for(let n=0;n<e.length;n++)if(""==a.e.String(e[n][t]))return e[n];let s=this.GridDataObj.getEmptyRow();return this.GridDataColumns.Contains("Sno")&&(s.Sno=e.length),this.GridDataColumns.Contains("DocSeqNo")&&(s.DocSeqNo=e.length),e.push(s),s}LoadEditData_1(e,t,s,i){if(this.IsDirty=!1,this.dtHistory=null,this.ChequeBookChecking=1,null!=this.Link&&null!=this.Link.LinkCombo&&(this.Link.LinkCombo.SelectedValue="",this.Link.DocumentList.Items.Clear()),this.FooterGridData.Clear(),this.LoadFieldsData(e.Tables[0],this._StaticFields,t,e.Columns[0]),!this.IsInventory){var o=this._StaticFields.find(e=>"batchid"==e.DBColumnName.toLowerCase());o&&o instanceof c.b&&e.Tables.length>12&&e.Columns[12].Contains("BatchID")&&e.Tables[12].length>0&&!a.e.IsEmpty(e.Tables[12][0].BatchID)&&(o.SelectedValue=parseInt(e.Tables[12][0].BatchID),o.IsAutoLoad&&(o.SelectedValueText=e.Tables[12][0].BatchNUmber.toString()))}if(null!=this.CreditAccount&&e.Tables[0][0].CreditAccount&&(e.Columns[0].Contains("IsNegative")&&!a.e.IsEmpty(e.Tables[0][0].IsNegative)&&Object(S.j)(e.Tables[0][0].IsNegative)?(this.CreditAccount.PrevSelValu=parseInt(e.Tables[0][0].DebitAccount),this.CreditAccount.SelectedValue=parseInt(e.Tables[0][0].DebitAccount)):(this.CreditAccount.PrevSelValu=parseInt(e.Tables[0][0].CreditAccount),this.CreditAccount.SelectedValue=parseInt(e.Tables[0][0].CreditAccount)),14==this.DocumentType&&e.Columns[0].Contains("BankAccountID")&&!a.e.IsEmpty(e.Tables[0][0].BankAccountID)&&parseInt(e.Tables[0][0].BankAccountID)>0&&(this.CreditAccount.PrevSelValu=parseInt(e.Tables[0][0].BankAccountID),this.CreditAccount.SelectedValue=parseInt(e.Tables[0][0].BankAccountID))),null==this.DebitAccount||a.e.IsEmpty(e.Tables[0][0].DebitAccount)||(e.Columns[0].Contains("IsNegative")&&!a.e.IsEmpty(e.Tables[0][0].IsNegative)&&Object(S.j)(e.Tables[0][0].IsNegative)?(this.DebitAccount.PrevSelValu=parseInt(e.Tables[0][0].CreditAccount),this.DebitAccount.SelectedValue=parseInt(e.Tables[0][0].CreditAccount)):(this.DebitAccount.PrevSelValu=parseInt(e.Tables[0][0].DebitAccount),this.DebitAccount.SelectedValue=parseInt(e.Tables[0][0].DebitAccount)),19==this.DocumentType&&e.Columns[0].Contains("BankAccountID")&&!a.e.IsEmpty(e.Tables[0][0].BankAccountID)&&parseInt(e.Tables[0][0].BankAccountID)>0&&(this.DebitAccount.PrevSelValu=parseInt(e.Tables[0][0].BankAccountID),this.DebitAccount.SelectedValue=parseInt(e.Tables[0][0].BankAccountID))),62==this.DocumentType&&this.oParent.onEditLeaveData(e,t),this.LoadFieldsData(e.Tables[3],this._TextFields,t,e.Columns[3]),this.LoadFieldsData(e.Tables[2],this._numericFields,t,e.Columns[2]),this.LoadFieldsData(e.Tables[1],this._CCFields,t,e.Columns[1]),t||this.GridData.Clear(),92==this.DocumentType){if((1==n.a.SessionManager.IsWebApplication||n.a.SessionManager.Preferences.ContainsKey("DisableAutoLoad")&&"true"==n.a.SessionManager.Preferences.DisableAutoLoad.toLowerCase())&&this.FillListViews(!1),this.GridDataObj.CanUserAddRows){let e=this.GridDataObj.NewRow();e.DocSeqNo=this.GridData.length+1,e.DocDetailsID=0,this.GridDataObj.Table.push(e)}return this.UpdateSequence(),void(t||this.LoadEditCallBack.Call(e))}if(this.DueDate&&(this.DueDate.Date=a.e.IsEmpty(e.Tables[0][0].DueDate)?null:new Date(e.Tables[0][0].DueDate)),this.BillNo&&e.Columns[0].Contains("BillNo")&&(this.BillNo.Text=null!=e.Tables[0][0].BillNo?e.Tables[0][0].BillNo.toString():""),this.Status&&(this.Status.SelectedValue=e.Tables[0][0].StatusID.toString()),this.HeaderFields.forEach(t=>{t instanceof h.b&&(t.Currency.SelectedValue=e.Tables[0][0].CurrencyID.toString(),t.ExchangeRate.Text=e.Tables[0][0].ExchangeRate.toString()),t instanceof u.e&&"ChequeBookNo"==t.DBColumnName&&e.Columns[0].Contains("ChequeBookNo")&&(t.Items.find(t=>t.Value==e.Tables[0][0].ChequeBookNo)&&t.Items.push(u.d.ComboBoxItems_2(e.Tables[0][0].ChequeBookNo.toString(),e.Tables[0][0].ChequeBookNo.toString())),t.SelectedValue=e.Tables[0][0].ChequeBookNo)}),this.IsInventory){let t=1;if(this.FooterColumnSource.length>0){this.FooterColumnSource[1].SetComboData(this.FooterColumnSource[1].ComboDataTable);for(let e=0;e<this.FooterColumnSource[1].ComboData.length;e++){let s=this.FooterGridDataObj.NewRow();s.Sno=t++,s.Name=this.FooterColumnSource[1].ComboData[e].Name.toString(),s.ColumnName=this.FooterColumnSource[1].ComboData[e].ColumnName.toString(),s.Decimals=a.e.String(this.FooterColumnSource[1].ComboData[e].Decimals),s.PostingType=a.e.String(this.FooterColumnSource[1].ComboData[e].PostingType),s.IsCalculated=a.e.String(this.FooterColumnSource[1].ComboData[e].IsCalculated),s.CrRefColName=a.e.String(this.FooterColumnSource[1].ComboData[e].CrRefColName),s.CrRefColID=a.e.String(this.FooterColumnSource[1].ComboData[e].CrRefColID),s.CrRefID=a.e.String(this.FooterColumnSource[1].ComboData[e].CrRefID),s.CrRefSection=a.e.String(this.FooterColumnSource[1].ComboData[e].CrRefSection),s.DrRefColName=a.e.String(this.FooterColumnSource[1].ComboData[e].DrRefColName),s.DrRefColID=a.e.String(this.FooterColumnSource[1].ComboData[e].DrRefColID),s.DrRefID=a.e.String(this.FooterColumnSource[1].ComboData[e].DrRefID),s.DrRefSection=a.e.String(this.FooterColumnSource[1].ComboData[e].DrRefSection),s.DebitAccount=a.e.String(this.FooterColumnSource[1].ComboData[e].DebitAccount),s.CreditAccount=a.e.String(this.FooterColumnSource[1].ComboData[e].CreditAccount),s.Formula=a.e.String(this.FooterColumnSource[1].ComboData[e].Formula),s.dcCurrID_Key=a.e.String(this.FooterColumnSource[1].ComboData[e].Currency),s.dcCurrID=a.e.String(this.FooterColumnSource[1].ComboData[e].CurrencyName),s.ReadOnly=a.e.String(this.FooterColumnSource[1].ComboData[e].ReadOnly),s.IsVisible=a.e.String(this.FooterColumnSource[1].ComboData[e].IsVisible),s.BasedOnXML=a.e.String(this.FooterColumnSource[1].ComboData[e].BasedOnXML),this.FooterGridDataColumns.Contains("StyleHeightZero")&&(s.StyleHeightZero=Object(S.j)(s.IsVisible)?0:1),this.FooterGridData.push(s)}this.FooterColumnSource[1].ComboDataTable&&this.FooterColumnSource[1].ComboDataTable.length>0&&this.FooterColumnSource[1].SetComboData(this.FooterColumnSource[1].ComboDataTable.filter(e=>1==e.IsVisible))}let s=new a.f;t=0;for(let n=0;n<e.Tables[0].length;n++)if(!e.Columns[0].Contains("DynamicInvDocDetailsID")||a.e.IsEmpty(e.Tables[0][n].DynamicInvDocDetailsID)){t=n;break}e.Columns[2].Contains("Remarks")&&e.Tables[2].length>t&&!a.e.IsEmpty(e.Tables[2][t].Remarks)&&s.LoadXml(e.Tables[2][t].Remarks);for(let i=0;i<this.FooterGridData.length;i++)if(e.Columns[2].Contains(this.FooterGridData[i].ColumnName.toString())){let t;if(e.Tables[2].length>0)for(let s=0;s<e.Tables[0].length;s++)if((!e.Columns[0].Contains("DynamicInvDocDetailsID")||a.e.IsEmpty(e.Tables[0][s].DynamicInvDocDetailsID))&&!a.e.IsEmpty(e.Tables[2][s][this.FooterGridData[i].ColumnName.toString()])){this.FooterGridData[i].Amount=e.Tables[2][s][this.FooterGridData[i].ColumnName.toString()].toString();break}if(t=n.a.SessionManager.Preferences.ContainsKey("Use Foreign Currency")&&Object(S.j)(n.a.SessionManager.Preferences["Use Foreign Currency"])&&e.Columns[0].Contains("amountfc")||!e.Columns[2].Contains("dcCalcNumFC"+this.FooterGridData[i].ColumnName.toString().Replace("dcNum",""))?e.Tables[2].Compute("sum","dcCalc"+this.FooterGridData[i].ColumnName.toString().replace("dc","")):e.Tables[2].Compute("sum","dcCalcNumFC"+this.FooterGridData[i].ColumnName.toString().replace("dcNum","")),null!=t&&null!=t||(t=0),0!=parseFloat(t))this.FooterGridData[i].CalcAmount=t;else if((""==a.e.StringValue(this.FooterGridData[i].Amount)||!a.e.IsEmpty(this.FooterGridData[i].Amount)&&0==parseFloat(this.FooterGridData[i].Amount))&&this.Preferences.ContainsKey("Dynamic Footer")&&null!=this.Preferences["Dynamic Footer"]&&"True"==this.Preferences["Dynamic Footer"]){this.FooterGridData.Remove(this.FooterGridData[i]),i--;continue}"-2"==this.FooterGridData[i].dcCurrID_Key.toString()?(this.FooterGridData[i].dcCurrID_Key=e.Tables[2][0]["dcCurrID"+this.FooterGridData[i].ColumnName.toString().toLowerCase().replace("dcnum","")].toString(),this.FooterGridData[i].dcExchRT=e.Tables[2][0]["dcExchRT"+this.FooterGridData[i].ColumnName.toString().toLowerCase().replace("dcnum","")].toString()):"-3"==this.FooterGridData[i].dcCurrID_Key.toString()&&(this.FooterGridData[i].dcExchRT=e.Tables[2][0]["dcExchRT"+this.FooterGridData[i].ColumnName.toString().toLowerCase().replace("dcnum","")].toString());let o=s.SelectNodes("XML/Row");for(let e=0;e<o.length;e++){let t=o[e];if(null!=t.attributes.Columnname&&t.attributes.Columnname.value.toLowerCase()==this.FooterGridData[i].ColumnName.toString().toLowerCase()){null!=t.attributes.DebitAccount&&""!=t.attributes.DebitAccount.value&&(this.FooterGridData[i].DebitAccount=t.attributes.DebitAccount.value),null!=t.attributes.CreditAcount&&""!=t.attributes.CreditAcount.value&&(this.FooterGridData[i].CreditAccount=t.attributes.CreditAcount.value),null!=t.attributes.Remarks&&""!=t.attributes.Remarks.value&&(this.FooterGridData[i].Remarks=t.attributes.Remarks.value);break}}}else this.Preferences.ContainsKey("Dynamic Footer")&&null!=this.Preferences["Dynamic Footer"]&&"True"==this.Preferences["Dynamic Footer"]?(this.FooterGridData.Remove(this.FooterGridData[i]),i--):(this.FooterGridData[i].Amount=0,this.FooterGridData[i].CalcAmount=0);this.Preferences.ContainsKey("Dynamic Footer")&&null!=this.Preferences["Dynamic Footer"]&&"True"==this.Preferences["Dynamic Footer"]&&this.FooterGridDataColumns.length>0&&(this.FooterGridDataObj.addEmptyRow(),this.FooterGridDataObj.addEmptyRow()),this.UpdateSequenceFoot()}(this.Preferences.ContainsKey("LineWisePacking")&&"true"==this.Preferences.LineWisePacking.toLowerCase()||this.Preferences.ContainsKey("PackWiseProds")&&"true"==this.Preferences.PackWiseProds.toLowerCase())&&!this.GridDataColumns.Contains("Unq")&&(this.GridDataColumns.push("Unq"),this.GridDataObj.DataTypes.Int.push("Unq"));let l=null,C=0,m=0;n.a.SessionManager.Preferences.ContainsKey("DimensionwiseBins")&&""!=n.a.SessionManager.Preferences.DimensionwiseBins.toString()&&(m=a.e.Int(n.a.SessionManager.Preferences.DimensionwiseBins.toString())),this.ChildVNos="",this.DistributeCostXML="";let d="";if(this.GridDataColumns.Contains("FieldType")&&(this.FillDafaultTypes(),this.Preferences.ContainsKey("PosPaymentTypeFld")&&""!=this.Preferences.PosPaymentTypeFld)){var p=this.Data.Tables[0].filter(e=>e.CostCenterColID==this.Preferences.PosPaymentTypeFld);p.length>0&&this.GridDataColumns.Contains(p[0].SysColumnName)&&(d=p[0].SysColumnName)}i>0&&e.Tables.length>6&&e.Tables[6].length>0&&e.Columns[6].Contains("IsLock")&&!a.e.IsEmpty(e.Tables[6][0].IsLock.toString())&&Object(S.j)(e.Tables[6][0].IsLock.toString())&&(e.Tables[6][0].IsLock=null);for(let h=0;h<e.Tables[0].length;h++){if(d){var I=this.GridData.filter(t=>t.FieldType==e.Tables[3][h][d]);I.length>0?(l=I[0],this.GridDataColumns.Contains("DebitAccount")&&(l.DebitAccount=null)):l=this.GridDataObj.NewRow()}else t?this.IsInventory?l=this.GetEmptyRowPosition(this.GridData,"ProductID_Key"):this.GridDataColumns.Contains("CreditAccount_Key")?l=this.GetEmptyRowPosition(this.GridData,"CreditAccount_Key"):this.GridDataColumns.Contains("DebitAccount_Key")?l=this.GetEmptyRowPosition(this.GridData,"DebitAccount_Key"):this.GridDataColumns.Contains("AccountID_Key")&&(l=this.GetEmptyRowPosition(this.GridData,"AccountID_Key")):l=this.GridDataObj.NewRow();if(!e.Columns[0].Contains("DynamicInvDocDetailsID")||a.e.IsEmpty(e.Tables[0][h].DynamicInvDocDetailsID)){if(!(i>0&&e.Columns[0].Contains("CanRecur")&&"False"==e.Tables[0][h].CanRecur.toString())){this.GridDataColumns.Contains("StatusID")&&e.Columns[0].Contains("StatusID")&&(l.StatusID=e.Tables[0][h].StatusID.toString(),"372"==e.Tables[0][h].StatusID.toString()||"429"==e.Tables[0][h].StatusID.toString()?(l.StatusID_COLOR="RED",this.GridDataColumns.Contains("StatusID_Name")&&(l.StatusID_Name="Rejected")):"369"==e.Tables[0][h].StatusID.toString()?(l.StatusID_COLOR="GREEN",this.GridDataColumns.Contains("StatusID_Name")&&(l.StatusID_Name="Posted")):"441"==e.Tables[0][h].StatusID.toString()?(l.StatusID_COLOR="BLUE",this.GridDataColumns.Contains("StatusID_Name")&&(l.StatusID_Name="Approved")):"371"==e.Tables[0][h].StatusID.toString()&&(l.StatusID_COLOR="ORANGE",this.GridDataColumns.Contains("StatusID_Name")&&(l.StatusID_Name="UnApproved"))),this.GridDataColumns.Contains("CanEdit")&&e.Columns[0].Contains("CanEdit")&&(l.CanEdit="372"==e.Tables[0][h].StatusID.toString()&&!n.a.SessionManager.IsActionAssigned(this.CostCenterID,"Edit Rejected Documents")&&!n.a.SessionManager.IsActionAssigned(this.CostCenterID,"Edit")||"372"!=e.Tables[0][h].StatusID.toString()&&!n.a.SessionManager.IsActionAssigned(this.CostCenterID,"Edit")||"true"!=n.a.SessionManager.Preferences.EditApprovedDocuments.toLowerCase()&&!n.a.SessionManager.IsActionAssigned(this.CostCenterID,"Edit Approved Docs")&&"369"==e.Tables[0][h].StatusID.toString()?"0":e.Tables[0][h].CanEdit.toString()),this.GridDataColumns.Contains("WorkFlowLevel")&&e.Columns[0].Contains("WorkFlowLevel")&&"372"!=a.e.String(e.Tables[0][h].StatusID)&&(l.WorkFlowLevel=a.e.String(e.Tables[0][h].WorkFlowLevel)),this.GridDataColumns.Contains("WorkFlowID")&&e.Columns[0].Contains("WorkFlowID")&&(l.WorkFlowID=a.e.String(e.Tables[0][h].WorkFlowID)),this.GridDataColumns.Contains("oppdc")&&e.Columns[0].Contains("oppdc")&&""!=e.Tables[0][h].oppdc.toString()&&(l.oppdc=e.Tables[0][h].oppdc.toString()),this.GridDataColumns.Contains("CanApprove")&&e.Columns[0].Contains("CanApprove")&&(l.CanApprove=a.e.String(e.Tables[0][h].CanApprove)),38==this.DocumentType&&"1"==a.e.String(e.Tables[0][h].VoucherType)&&(C=a.e.Double(e.Tables[0][h].Quantity),e.Tables[0][h].Quantity=C>0?"-"+a.e.String(e.Tables[0][h].Quantity):a.e.String(e.Tables[0][h].Quantity),C=a.e.Double(e.Tables[0][h].Gross),e.Tables[0][h].Gross=C>0?"-"+a.e.String(e.Tables[0][h].Gross):a.e.String(e.Tables[0][h].Gross),C=a.e.Double(e.Tables[0][h].GroStockValuess),e.Tables[0][h].StockValue=C>0?"-"+a.e.String(e.Tables[0][h].StockValue):a.e.String(e.Tables[0][h].StockValue),C=a.e.Double(e.Tables[0][h].grossfc),e.Tables[0][h].grossfc=C>0?"-"+a.e.String(e.Tables[0][h].grossfc):a.e.String(e.Tables[0][h].grossfc),C=a.e.Double(e.Tables[0][h].UOMConvertedQty),e.Tables[0][h].UOMConvertedQty=C>0?"-"+a.e.String(e.Tables[0][h].UOMConvertedQty):a.e.String(e.Tables[0][h].UOMConvertedQty));for(let s=0;s<this.ColumnSource.length;s++)if((this.IsInventory||4!=this.ColumnSource[s].SectionID&&"LinkedInvDocDetailsID"!=this.ColumnSource[s].DisplayMember&&"RefNo"!=this.ColumnSource[s].DisplayMember&&"StatusID"!=this.ColumnSource[s].DisplayMember&&"LinkedFieldName"!=this.ColumnSource[s].DisplayMember)&&!this.ColumnSource[s].DisplayMember.toLowerCase().Contains("dccurrid")&&!this.ColumnSource[s].DisplayMember.toLowerCase().Contains("dcexchrt")&&"FreeQTY"!=this.ColumnSource[s].DisplayMember&&(!t||"DocDetailsID"!=this.ColumnSource[s].DisplayMember)){if(this.ColumnSource[s].IsColumnUserDefined){if(d==this.ColumnSource[s].DisplayMember)continue;if("SELECTIONBOX"==this.ColumnSource[s].DataType)e.Tables[3].length>0&&(l[this.ColumnSource[s].DisplayMember]=e.Tables[3][h][this.ColumnSource[s].DisplayMember]);else if(null!=this.ColumnSource[s].CostCenterID&&this.ColumnSource[s].CostCenterID>0)if(16==this.ColumnSource[s].CostCenterID){if(e.Tables.length>12&&e.Columns[12].Contains("BatchID")){let t=e.Tables[12].filter(t=>t.AccDocDetailsID==parseInt(e.Tables[0][h].DocDetailsID));t.length>0&&(l[this.ColumnSource[s].DisplayMember]=t[0].BatchNUmber.toString(),l[this.ColumnSource[s].DisplayMember+"_Key"]=t[0].BatchID.toString())}}else 5==this.DocumentType&&this.ColumnSource[s].DisplayMember.Contains("TO")?e.Tables[1].length>0&&e.Columns[1].Contains(this.ColumnSource[s].DisplayMember.replace("TO",""))&&e.Tables[1].length>h+1&&!a.e.IsEmpty(e.Tables[1][h+1][this.ColumnSource[s].DisplayMember.replace("TO","")])&&(l[this.ColumnSource[s].DisplayMember+"_Key"]=e.Tables[1][h+1][this.ColumnSource[s].DisplayMember.replace("TO","")]):this.ColumnSource[s].DisplayMember.toLowerCase().Contains("alpha")?e.Tables[3].length>0&&!a.e.IsEmpty(e.Tables[3][h][this.ColumnSource[s].DisplayMember])&&(l[this.ColumnSource[s].DisplayMember+"_Key"]=e.Tables[3][h][this.ColumnSource[s].DisplayMember]):this.ColumnSource[s].DisplayMember.toString().toLowerCase().endsWith("code")||e.Tables[1].length>0&&!a.e.IsEmpty(e.Tables[1][h][this.ColumnSource[s].DisplayMember])&&(l[this.ColumnSource[s].DisplayMember+"_Key"]=e.Tables[1][h][this.ColumnSource[s].DisplayMember]);else if(this.ColumnSource[s].DisplayMember.toLowerCase().Contains("dcnum"))e.Tables[2].length>0&&(l[this.ColumnSource[s].DisplayMember]=this.ColumnSource[s].NoRoundOff||a.e.IsEmpty(e.Tables[2][h][this.ColumnSource[s].DisplayMember])||!a.e.IsNum(e.Tables[2][h][this.ColumnSource[s].DisplayMember])||a.e.IsEmpty(this.ColumnSource[s].DecimalPoints)?e.Tables[2][h][this.ColumnSource[s].DisplayMember]:parseFloat(e.Tables[2][h][this.ColumnSource[s].DisplayMember]).ToString("N"+this.ColumnSource[s].DecimalPoints),n.a.SessionManager.Preferences.ContainsKey("Use Foreign Currency")&&Object(S.j)(n.a.SessionManager.Preferences["Use Foreign Currency"])?(l["dcCalc"+this.ColumnSource[s].DisplayMember]=e.Tables[2][h]["dcCalcNumFC"+this.ColumnSource[s].DisplayMember.replace("dcNum","")],"-2"==this.ColumnSource[s].DefaultValue?""==e.Tables[2][h]["dcCurrID"+this.ColumnSource[s].DisplayMember.toLowerCase().replace("dcnum","")].toString()?this.GridDataColumns.Contains(e.Tables[2][h]["dcCurrID"+this.ColumnSource[s].DisplayMember.toLowerCase().replace("dcnum","")].toString())&&(l["dcCurrID"+this.ColumnSource[s].DisplayMember.toLowerCase().replace("dcnum","")+"_Key"]="1",l["dcExchRT"+this.ColumnSource[s].DisplayMember.toLowerCase().replace("dcnum","")]="1"):(this.GridDataColumns.Contains("dcCurrID"+this.ColumnSource[s].DisplayMember.toLowerCase().replace("dcnum","")+"_Key")&&(l["dcCurrID"+this.ColumnSource[s].DisplayMember.toLowerCase().replace("dcnum","")+"_Key"]=e.Tables[2][h]["dcCurrID"+this.ColumnSource[s].DisplayMember.toLowerCase().replace("dcnum","")]),this.GridDataColumns.Contains("dcExchRT"+this.ColumnSource[s].DisplayMember.toLowerCase().replace("dcnum",""))&&(l["dcExchRT"+this.ColumnSource[s].DisplayMember.toLowerCase().replace("dcnum","")]=e.Tables[2][h]["dcExchRT"+this.ColumnSource[s].DisplayMember.toLowerCase().replace("dcnum","")])):"-1"!=this.ColumnSource[s].DefaultValue&&a.e.Int(this.ColumnSource[s].DefaultValue)>0&&this.ColumnSource[s].CurrID>0&&(a.e.IsEmpty(e.Tables[2][h]["dcExchRT"+this.ColumnSource[s].DisplayMember.toLowerCase().replace("dcnum","")])?this.ColumnSource[s].ExhcgRt=1:e.Columns[2].Contains("dcCurrID"+this.ColumnSource[s].DisplayMember.toLowerCase().replace("dcnum",""))&&!a.e.IsEmpty(e.Tables[2][h]["dcCurrID"+this.ColumnSource[s].DisplayMember.toLowerCase().replace("dcnum","")])&&parseInt(e.Tables[2][h]["dcCurrID"+this.ColumnSource[s].DisplayMember.toLowerCase().replace("dcnum","")])==this.ColumnSource[s].CurrID&&(this.ColumnSource[s].ExhcgRt=parseFloat(e.Tables[2][h]["dcExchRT"+this.ColumnSource[s].DisplayMember.toLowerCase().replace("dcnum","")])))):l["dcCalc"+this.ColumnSource[s].DisplayMember]=e.Tables[2][h]["dcCalc"+this.ColumnSource[s].DisplayMember.replace("dc","")]);else if("DATE"==this.ColumnSource[s].DataType||"DATETIME"==this.ColumnSource[s].DataType||"TIME"==this.ColumnSource[s].DataType||"Time2"==this.ColumnSource[s].DataType){if(e.Tables[3].length>0&&!a.e.IsEmpty(e.Tables[3][h][this.ColumnSource[s].DisplayMember])&&a.e.isValidDate(e.Tables[3][h][this.ColumnSource[s].DisplayMember])){if("DATETIME"==this.ColumnSource[s].DataType)l[this.ColumnSource[s].DisplayMember]=new Date(e.Tables[3][h][this.ColumnSource[s].DisplayMember]).ToString(n.a.SessionManager.Preferences["Date Format"]+" hh:mm:ss a"),l[this.ColumnSource[s].DisplayMember+"_Key"]=e.Tables[3][h][this.ColumnSource[s].DisplayMember];else if("TIME"==this.ColumnSource[s].DataType)l[this.ColumnSource[s].DisplayMember]=new Date(e.Tables[3][h][this.ColumnSource[s].DisplayMember]).ToString("hh:mm:ss a"),l[this.ColumnSource[s].DisplayMember+"_Key"]=e.Tables[3][h][this.ColumnSource[s].DisplayMember];else if("Time2"==this.ColumnSource[s].DataType)l[this.ColumnSource[s].DisplayMember]=new Date(e.Tables[3][h][this.ColumnSource[s].DisplayMember]).ToString("HH:mm"),l[this.ColumnSource[s].DisplayMember+"_Key"]=new Date(e.Tables[3][h][this.ColumnSource[s].DisplayMember]).ToString("dd/MMM/yyyy HH:mm");else{let t="dd/MMM/yyyy";n.a.SessionManager.Preferences.ContainsKey("Date Format")&&""!=n.a.SessionManager.Preferences["Date Format"]&&(t=n.a.SessionManager.Preferences["Date Format"]),l[this.ColumnSource[s].DisplayMember]=new Date(e.Tables[3][h][this.ColumnSource[s].DisplayMember]).ToString(n.a.SessionManager.Preferences["Date Format"]),l[this.ColumnSource[s].DisplayMember+"_Key"]=new Date(e.Tables[3][h][this.ColumnSource[s].DisplayMember])}null!=this.ColumnSource[s].FixedDateFormat&&""!=this.ColumnSource[s].FixedDateFormat&&(l[this.ColumnSource[s].DisplayMember]=new Date(e.Tables[3][h][this.ColumnSource[s].DisplayMember]).ToString(this.ColumnSource[s].FixedDateFormat))}}else"ComboBox"==this.ColumnSource[s].DataType?e.Tables[3].length>0&&(l[this.ColumnSource[s].ValueBinding]=e.Tables[3][h][this.ColumnSource[s].ValueBinding]):"CheckBox"==this.ColumnSource[s].DataType?l[this.ColumnSource[s].DisplayMember]=e.Tables[3].length>0&&!a.e.IsEmpty(e.Tables[3][h][this.ColumnSource[s].DisplayMember])&&"True"==e.Tables[3][h][this.ColumnSource[s].DisplayMember].toString()?"True":"False":"PactComboBox"==this.ColumnSource[s].DataType?e.Tables[3].length>0&&(l[this.ColumnSource[s].ValueBinding]=e.Tables[3][h][this.ColumnSource[s].ValueBinding],l[this.ColumnSource[s].ValueBinding+"_Key"]=e.Tables[3][h][this.ColumnSource[s].ValueBinding]):"FLOAT"==this.ColumnSource[s].DataType?e.Tables[3].length>0&&!a.e.IsEmpty(e.Tables[3][h][this.ColumnSource[s].DisplayMember])&&a.e.IsNum(e.Tables[3][h][this.ColumnSource[s].DisplayMember])&&(l[this.ColumnSource[s].DisplayMember]=e.Tables[3][h][this.ColumnSource[s].DisplayMember]):"LINK"==this.ColumnSource[s].DataType&&this.ColumnSource[s].DisplayMember.toLowerCase().Contains("dcalpha")?l[this.ColumnSource[s].DisplayMember]="...":e.Tables[3].length>0&&e.Columns[3].Contains(this.ColumnSource[s].DisplayMember)&&(l[this.ColumnSource[s].DisplayMember]=e.Tables[3][h][this.ColumnSource[s].DisplayMember])}else if(16!=this.DocumentType&&17!=this.DocumentType&&28!=this.DocumentType&&29!=this.DocumentType||"AccountID_Key"!=this.ColumnSource[s].ValueMember&&"DebitAmount"!=this.ColumnSource[s].DisplayMember&&"CreditAmount"!=this.ColumnSource[s].DisplayMember)if("SELECTIONBOX"==this.ColumnSource[s].DataType)l[this.ColumnSource[s].DisplayMember]=e.Tables[0][h][this.ColumnSource[s].DisplayMember];else if(!e.Columns[0].Contains("IsNegative")||a.e.IsEmpty(e.Tables[0][h].IsNegative)||!Object(S.j)(e.Tables[0][h].IsNegative)||(null==this.ColumnSource[s].ValueMember||"DebitAccount_Key"!=this.ColumnSource[s].ValueMember&&"CreditAccount_Key"!=this.ColumnSource[s].ValueMember)&&"Amount"!=this.ColumnSource[s].DisplayMember){if(3==this.ColumnSource[s].CostCenterID)l[this.ColumnSource[s].ValueMember]=e.Tables[0][h].ProductID,e.Tables[0].length>0&&e.Columns[0].Contains(this.ColumnSource[s].DisplayMember)&&(l[this.ColumnSource[s].DisplayMember]=e.Tables[0][h][this.ColumnSource[s].DisplayMember]);else if(2==this.ColumnSource[s].CostCenterID)l[this.ColumnSource[s].ValueMember]=e.Tables[0][h][this.ColumnSource[s].ValueMember.substr(0,this.ColumnSource[s].ValueMember.length-4)],null!=this.ColumnSource[s].ValueMember&&"DebitAccount_Key"==this.ColumnSource[s].ValueMember&&(14!=this.DocumentType&&15!=this.DocumentType&&20!=this.DocumentType&&23!=this.DocumentType||(l.Type=e.Tables[0][h].DBIsBillwise.toString()),19==this.DocumentType&&e.Columns[0].Contains("BankAccountID")&&a.e.Int(e.Tables[0][h].BankAccountID)>0&&(l.DebitAccount_Key=parseInt(e.Tables[0][h].BankAccountID))),null!=this.ColumnSource[s].ValueMember&&"CreditAccount_Key"==this.ColumnSource[s].ValueMember&&(18!=this.DocumentType&&19!=this.DocumentType&&21!=this.DocumentType&&22!=this.DocumentType||(l.Type=e.Tables[0][h].CrIsBillwise.toString()),14==this.DocumentType&&e.Columns[0].Contains("BankAccountID")&&a.e.Int(e.Tables[0][h].BankAccountID)>0&&(l.CreditAccount_Key=parseInt(e.Tables[0][h].BankAccountID)));else if(11==this.ColumnSource[s].CostCenterID)a.e.IsEmpty(e.Tables[0][h].Unit)||(l[this.ColumnSource[s].ValueMember]=e.Tables[0][h].Unit),e.Tables[0].length>0&&e.Columns[0].Contains("UnitName")&&(l[this.ColumnSource[s].DisplayMember]=e.Tables[0][h].UnitName);else if(0!=this.ColumnSource[s].CostCenterID)l[this.ColumnSource[s].ValueMember]=e.Tables[0][h][this.ColumnSource[s].ValueMember.substr(0,this.ColumnSource[s].ValueMember.length-4)];else if("DocSeqNo"!=this.ColumnSource[s].DisplayMember&&"IsScheme"!=this.ColumnSource[s].DisplayMember&&"RecievedQty"!=this.ColumnSource[s].DisplayMember)if("DATE"==this.ColumnSource[s].DataType){if(e.Tables[0].length>0&&e.Tables[0][h][this.ColumnSource[s].DisplayMember]){let t="dd/MMM/yyyy";n.a.SessionManager.Preferences.ContainsKey("Date Format")&&""!=n.a.SessionManager.Preferences["Date Format"]&&(t=n.a.SessionManager.Preferences["Date Format"]),l[this.ColumnSource[s].DisplayMember]=new Date(e.Tables[0][h][this.ColumnSource[s].DisplayMember]).ToString(t),this.GridDataColumns.Contains(this.ColumnSource[s].DisplayMember+"_Key")&&(l[this.ColumnSource[s].DisplayMember+"_Key"]=new Date(e.Tables[0][h][this.ColumnSource[s].DisplayMember]))}}else if("gross"==this.ColumnSource[s].DisplayMember.toLowerCase())l[this.ColumnSource[s].DisplayMember]=(n.a.SessionManager.Preferences.ContainsKey("Use Foreign Currency")&&Object(S.j)(n.a.SessionManager.Preferences["Use Foreign Currency"])||!a.e.IsEmpty(e.Tables[0][h].ExchangeRate)&&1!=parseFloat(e.Tables[0][h].ExchangeRate))&&e.Columns[0].Contains("grossfc")?e.Tables[0][h].grossfc:e.Tables[0][h][this.ColumnSource[s].DisplayMember];else if("quantity"==this.ColumnSource[s].DisplayMember.toLowerCase())this.ColumnSource[s].NoRoundOff||!a.e.IsNum(e.Tables[0][h][this.ColumnSource[s].DisplayMember])||a.e.IsEmpty(this.ColumnSource[s].DecimalPoints)?!a.e.IsEmpty(e.Tables[0][h].ParentSchemeID)&&"0"!=e.Tables[0][h].ParentSchemeID.toString()&&this.GridDataColumns.Contains("FreeQTY")&&!a.e.IsEmpty(e.Tables[0][h].IsQtyFreeOffer)&&parseInt(e.Tables[0][h].IsQtyFreeOffer)>0?l.FreeQTY=e.Tables[0][h][this.ColumnSource[s].DisplayMember]:l[this.ColumnSource[s].DisplayMember]=e.Tables[0][h][this.ColumnSource[s].DisplayMember]:!a.e.IsEmpty(e.Tables[0][h].ParentSchemeID)&&"0"!=e.Tables[0][h].ParentSchemeID.toString()&&this.GridDataColumns.Contains("FreeQTY")&&!a.e.IsEmpty(e.Tables[0][h].IsQtyFreeOffer)&&parseInt(e.Tables[0][h].IsQtyFreeOffer)>0?l.FreeQTY=parseFloat(e.Tables[0][h][this.ColumnSource[s].DisplayMember]).ToString("N"+this.ColumnSource[s].DecimalPoints):l[this.ColumnSource[s].DisplayMember]=parseFloat(e.Tables[0][h][this.ColumnSource[s].DisplayMember]).ToString("N"+this.ColumnSource[s].DecimalPoints),5==this.DocumentType&&this.GridDataColumns.Contains("RecievedQty")&&!a.e.IsEmpty(e.Tables[0][h+1][this.ColumnSource[s].DisplayMember])&&(l.RecievedQty=e.Tables[0][h+1][this.ColumnSource[s].DisplayMember].toString());else if("Amount"==this.ColumnSource[s].DisplayMember)l.Amount=n.a.SessionManager.Preferences.ContainsKey("Use Foreign Currency")&&Object(S.j)(n.a.SessionManager.Preferences["Use Foreign Currency"])&&e.Columns[0].Contains("amountfc")?e.Tables[0][h].amountfc:e.Tables[0][h].Amount.toString();else if("ComboBox"==this.ColumnSource[s].DataType&&e.Columns[0].Contains(this.ColumnSource[s].ValueBinding)){if(l[this.ColumnSource[s].ValueBinding]=e.Tables[0][h][this.ColumnSource[s].ValueBinding],"ChequeBookNo"==this.ColumnSource[s].ValueBinding){let t=[];t.push(u.d.ComboBoxItems_2(a.e.String(e.Tables[0][h][this.ColumnSource[s].ValueBinding]),a.e.String(e.Tables[0][h][this.ColumnSource[s].ValueBinding]))),this.ColumnSource[s].ComboData=t}}else e.Columns[0].Contains(this.ColumnSource[s].DisplayMember)&&(l[this.ColumnSource[s].DisplayMember]=e.Tables[0][h][this.ColumnSource[s].DisplayMember])}else null!=this.ColumnSource[s].ValueMember&&"DebitAccount_Key"==this.ColumnSource[s].ValueMember&&(l.DebitAccount_Key=e.Tables[0][h].CreditAccount,14!=this.DocumentType&&15!=this.DocumentType&&20!=this.DocumentType&&23!=this.DocumentType||(l.Type=e.Tables[0][h].CrIsBillwise),19==this.DocumentType&&e.Columns[0].Contains("BankAccountID")&&!Object(g.isNullOrUndefined)(e.Tables[0][h].BankAccountID)&&parseInt(e.Tables[0][h].BankAccountID)>0&&(l.DebitAccount_Key=parseInt(e.Tables[0][h].BankAccountID))),null!=this.ColumnSource[s].ValueMember&&"CreditAccount_Key"==this.ColumnSource[s].ValueMember&&(l.CreditAccount_Key=e.Tables[0][h].DebitAccount,18!=this.DocumentType&&19!=this.DocumentType&&21!=this.DocumentType&&22!=this.DocumentType||(l.Type=e.Tables[0][h].DBIsBillwise.toString()),14==this.DocumentType&&e.Columns[0].Contains("BankAccountID")&&!a.e.IsEmpty(e.Tables[0][h].BankAccountID)&&parseInt(e.Tables[0][h].BankAccountID)>0&&(l.CreditAccount_Key=parseInt(e.Tables[0][h].BankAccountID))),"Amount"==this.ColumnSource[s].DisplayMember&&(l.Amount=(n.a.SessionManager.Preferences.ContainsKey("Use Foreign Currency")&&Object(S.j)(n.a.SessionManager.Preferences["Use Foreign Currency"])||!a.e.IsEmpty(e.Tables[0][h].ExchangeRate)&&1!=parseFloat(e.Tables[0][h].ExchangeRate))&&e.Columns[0].Contains("amountfc")?"-"+e.Tables[0][h].amountfc:"-"+e.Tables[0][h].Amount);else if("AccountID_Key"==this.ColumnSource[s].ValueMember)continue;(this.ColumnSource[s].DisplayMember.toLowerCase().Contains("dcnum")||"quantity"==this.ColumnSource[s].DisplayMember.toLowerCase()||"rate"==this.ColumnSource[s].DisplayMember.toLowerCase()||"gross"==this.ColumnSource[s].DisplayMember.toLowerCase()||this.ColumnSource[s].DisplayMember.toLowerCase().Contains("amount"))&&(l["default"+this.ColumnSource[s].DisplayMember]="gross"==this.ColumnSource[s].DisplayMember.toLowerCase()?n.a.SessionManager.Preferences.ContainsKey("Use Foreign Currency")&&Object(S.j)(n.a.SessionManager.Preferences["Use Foreign Currency"])&&e.Columns[0].Contains("grossfc")?e.Tables[0][h].grossfc:e.Tables[0][h][this.ColumnSource[s].DisplayMember]:"quantity"!=this.ColumnSource[s].DisplayMember.toLowerCase()||!e.Columns[0].Contains("Tolink")||a.e.IsEmpty(e.Tables[0][h].Tolink)||a.e.IsEmpty(l[this.ColumnSource[s].DisplayMember])?l[this.ColumnSource[s].DisplayMember]:parseFloat(e.Tables[0][h].Tolink)+parseFloat(l[this.ColumnSource[s].DisplayMember]))}if(this.IsInventory&&e.Columns[0].Contains("LinkedFieldName")&&null!=e.Tables[0][h].LinkedFieldName&&("job"==e.Tables[0][h].LinkedFieldName.toLowerCase()||"bom"==e.Tables[0][h].LinkedFieldName.toLowerCase()))this.GridDataColumns.Contains("jobID")||this.GridDataColumns.push("jobID"),this.Preferences.ContainsKey("jobCCID")&&""!=this.Preferences.jobCCID.toString()&&parseInt(this.Preferences.jobCCID)>5e4&&e.Columns[1].Contains("dcCCNID"+(parseInt(this.Preferences.jobCCID)-5e4))&&(l.jobID=e.Tables[1][h]["dcCCNID"+(parseInt(this.Preferences.jobCCID)-5e4)].toString(),this.GridDataColumns.Contains("NetJobQty")||this.GridDataColumns.push("NetJobQty"),a.e.IsEmpty(e.Tables[0][h].LinkedFieldValue)||(l.NetJobQty=e.Tables[0][h].LinkedFieldValue.toString())),this.GridDataColumns.Contains("StageID")||this.GridDataColumns.push("StageID"),this.Preferences.ContainsKey("StageCCID")&&""!=this.Preferences.StageCCID.toString()&&parseInt(this.Preferences.StageCCID)>5e4&&e.Columns[1].Contains("dcCCNID"+(parseInt(this.Preferences.StageCCID)-5e4))&&(l.StageID=e.Tables[1][h]["dcCCNID"+(parseInt(this.Preferences.StageCCID)-5e4)].toString()),this.GridDataColumns.Contains("BOMID")||this.GridDataColumns.push("BOMID"),this.Preferences.ContainsKey("BomCCID")&&""!=this.Preferences.BomCCID.toString()&&parseInt(this.Preferences.BomCCID)>5e4&&e.Columns[1].Contains("dcCCNID"+(parseInt(this.Preferences.BomCCID)-5e4))&&(l.BOMID=e.Tables[1][h]["dcCCNID"+(parseInt(this.Preferences.BomCCID)-5e4)].toString()),this.Preferences.ContainsKey("JobUnqCCID")&&""!=this.Preferences.JobUnqCCID.toString()&&parseInt(this.Preferences.JobUnqCCID)>5e4&&e.Columns[1].Contains("dcCCNID"+(parseInt(this.Preferences.JobUnqCCID)-5e4))&&(this.GridDataColumns.Contains("JobUnqID")||this.GridDataColumns.push("JobUnqID"),l.JobUnqID=e.Tables[1][h]["dcCCNID"+(parseInt(this.Preferences.JobUnqCCID)-5e4)].toString()),this.Preferences.ContainsKey("JobRemainingQty")&&!this.IsPurchase&&(this.GridDataColumns.Contains("RemQty")||this.GridDataColumns.push("RemQty"),""!=e.Tables[2][h][this.Preferences.JobRemainingQty].toString()&&parseFloat(e.Tables[2][h][this.Preferences.JobRemainingQty])>0&&(l.RemQty=e.Tables[2][h][this.Preferences.JobRemainingQty].toString()));else if(this.IsInventory&&e.Columns[0].Contains("LinkedInvDocDetailsID")&&null!=e.Tables[0][h].LinkedInvDocDetailsID&&parseInt(e.Tables[0][h].LinkedInvDocDetailsID)>0&&!t&&(this.Preferences.ContainsKey("Debit Account")&&Object(S.j)(this.Preferences["Debit Account"])&&null!=this.DebitAccount&&this.DebitAccount.Enable&&(this.DebitAccount.Enable=!1),this.Preferences.ContainsKey("Credit Account")&&Object(S.j)(this.Preferences["Credit Account"])&&null!=this.CreditAccount&&this.CreditAccount.Enable&&(this.CreditAccount.Enable=!1),this.Preferences.ContainsKey("DimensionWise")&&""!=this.Preferences.DimensionWise)){let e=this.Preferences.DimensionWise.split(",");this._CCFields.forEach(t=>{(t instanceof c.b&&e.Contains(t.CCID.toString())||t instanceof D.a&&e.Contains(t.CCID.toString()))&&(t.Enable=!1)})}if(e.Tables[0].length>0&&e.Columns[0].Contains("ProductTypeID")&&(e.Columns[0].Contains("ToleranceLimitsValue")&&(l.TolVal=e.Tables[0][h].ToleranceLimitsValue.toString()),l.Type=e.Tables[0][h].ProductTypeID.toString(),this.GridDataColumns.Contains("QtyType")&&e.Columns[0].Contains("QtyAdjustType")&&(l.QtyType=null==e.Tables[0][h].QtyAdjustType?"":e.Tables[0][h].QtyAdjustType.toString()),this.GridDataColumns.Contains("PackType")&&e.Columns[0].Contains("IsPacking")&&(l.PackType=null==e.Tables[0][h].IsPacking?"":e.Tables[0][h].IsPacking.toString()),this.GridDataColumns.Contains("landingType")&&e.Columns[0].Contains("IsBillOfEntry")&&(l.landingType=null==e.Tables[0][h].IsBillOfEntry?"":e.Tables[0][h].IsBillOfEntry.toString()),this.GridDataColumns.Contains("BinWise")&&e.Columns[0].Contains("BinWise")&&(l.BinWise=null==e.Tables[0][h].BinWise?"":e.Tables[0][h].BinWise.toString()),l.UOMConversion=a.e.IsEmpty(e.Tables[0][h].UOMConversion)?1:e.Tables[0][h].UOMConversion.toString(),a.e.IsEmpty(e.Tables[0][h].UOMConvertedQty)?a.e.IsEmpty(e.Tables[0][h].Quantity)||(l.UOMConvertedQty=e.Tables[0][h].Quantity.toString()):l.UOMConvertedQty=e.Tables[0][h].UOMConvertedQty.toString(),25==this.DocumentType&&this.GridDataColumns.Contains("LinkStatusID")&&e.Columns[0].Contains("LinkStatusID")&&(l.LinkStatusID=e.Tables[0][h].LinkStatusID),"8"==e.Tables[0][h].ProductTypeID.toString()||"3"==e.Tables[0][h].ProductTypeID.toString()||"11"==e.Tables[0][h].ProductTypeID.toString()||"12"==e.Tables[0][h].ProductTypeID.toString()||this.Preferences.ContainsKey("EnablePromotions")&&"true"==this.Preferences.EnablePromotions.toLowerCase()&&e.Columns[0].Contains("DynamicInvDocDetailsID"))){let s=e.Tables[0].filter(t=>t.DynamicInvDocDetailsID==e.Tables[0][h].DocDetailsID);if(s.length>0){var y=e.Tables[0].filter(t=>t.DynamicInvDocDetailsID==e.Tables[0][h].DocDetailsID).Compute("sum","Gross"),b=e.Tables[0].filter(t=>t.DynamicInvDocDetailsID==e.Tables[0][h].DocDetailsID).Compute("sum","Quantity");let i="";i+="<xml>";for(let o=0;o<s.length;o++){let l=e.Tables[1].filter(e=>e.InvDocDetailsID=s[o].DocDetailsID),u=e.Tables[2].filter(e=>e.InvDocDetailsID=s[o].DocDetailsID),c=e.Tables[3].filter(e=>e.InvDocDetailsID=s[o].DocDetailsID);i+="<Row ><xml ";let D=!1,C="",m="",d="";for(let p=0;p<this.ColumnSource.length;p++)if(!(4==this.ColumnSource[p].SectionID||"FreeQTY"==this.ColumnSource[p].DisplayMember||"LinkedInvDocDetailsID"==this.ColumnSource[p].DisplayMember||"RefNo"==this.ColumnSource[p].DisplayMember||"LinkedFieldName"==this.ColumnSource[p].DisplayMember||"StatusID"==this.ColumnSource[p].DisplayMember||this.ColumnSource[p].DisplayMember.toLowerCase().Contains("dccurrid")||this.ColumnSource[p].DisplayMember.toLowerCase().Contains("dcexchrt")||t&&"DocDetailsID"==this.ColumnSource[p].DisplayMember))if(this.ColumnSource[p].IsColumnUserDefined)if("SELECTIONBOX"==this.ColumnSource[p].DataType)i+=this.ColumnSource[p].DisplayMember+'="'+c[0][this.ColumnSource[p].DisplayMember].toString()+'" ',d+=this.ColumnSource[p].DisplayMember+"='"+r.d.GetValidTextXml(c[0][this.ColumnSource[p].DisplayMember])+"', ";else if(null!=this.ColumnSource[p].CostCenterID&&this.ColumnSource[p].CostCenterID>0)this.ColumnSource[p].DisplayMember.toLowerCase().Contains("alpha")?(i+=this.ColumnSource[p].DisplayMember+'="'+c[0][this.ColumnSource[p].DisplayMember].toString()+'" ',d+=this.ColumnSource[p].DisplayMember+"='"+c[0][this.ColumnSource[p].DisplayMember].toString()+"', "):this.ColumnSource[p].DisplayMember.toLowerCase().endsWith("code")||(i+=this.ColumnSource[p].DisplayMember+'="'+l[0][this.ColumnSource[p].DisplayMember].toString()+'" ',C+=this.ColumnSource[p].DisplayMember+"="+l[0][this.ColumnSource[p].DisplayMember].toString()+", ");else if(this.ColumnSource[p].DisplayMember.toLowerCase().Contains("dcnum"))e.Tables[2].length>0&&(i+=this.ColumnSource[p].DisplayMember+'="'+u[0][this.ColumnSource[p].DisplayMember].toString()+'" ',a.e.IsEmpty(u[0][this.ColumnSource[p].DisplayMember])||(m+=this.ColumnSource[p].DisplayMember+"="+u[0][this.ColumnSource[p].DisplayMember].toString()+", "),n.a.SessionManager.Preferences.ContainsKey("Use Foreign Currency")&&Object(S.j)(n.a.SessionManager.Preferences["Use Foreign Currency"])?(i+="dcCalc"+this.ColumnSource[p].DisplayMember.replace("dc","")+'="'+u[0]["dcCalcNumFC"+this.ColumnSource[p].DisplayMember.replace("dcNum","")].toString()+'" ',a.e.IsEmpty(u[0]["dcCalcNumFC"+this.ColumnSource[p].DisplayMember.replace("dcNum","")])||(m+="dcCalcNumFC"+this.ColumnSource[p].DisplayMember.toLowerCase().replace("dcnum","")+"="+u[0]["dcCalcNumFC"+this.ColumnSource[p].DisplayMember.replace("dcNum","")].toString()+", "),a.e.IsEmpty(u[0]["dcCalc"+this.ColumnSource[p].DisplayMember.replace("dc","")])||(m+="dcCalc"+this.ColumnSource[p].DisplayMember.replace("dc","")+"="+u[0]["dcCalc"+this.ColumnSource[p].DisplayMember.replace("dc","")].toString()+", "),"-2"==this.ColumnSource[p].DefaultValue&&(""==u[0]["dcCurrID"+this.ColumnSource[p].DisplayMember.toLowerCase().replace("dcnum","")].toString()?this.GridDataColumns.Contains(e.Tables[2][h]["dcCurrID"+this.ColumnSource[p].DisplayMember.toLowerCase().replace("dcnum","")].toString())&&(i+="dcCurrID"+this.ColumnSource[p].DisplayMember.toLowerCase().replace("dcnum","")+'_Key="1"',i+="dcExchRT"+this.ColumnSource[p].DisplayMember.toLowerCase().replace("dcnum","")+'"1"',m+="dcCurrID"+this.ColumnSource[p].DisplayMember.toLowerCase().replace("dcnum","")+"=1, ",m+="dcExchRT"+this.ColumnSource[p].DisplayMember.toLowerCase().replace("dcnum","")+"=1, "):(this.GridDataColumns.Contains("dcCurrID"+this.ColumnSource[p].DisplayMember.toLowerCase().replace("dcnum","")+"_Key")&&(i+="dcCurrID"+this.ColumnSource[p].DisplayMember.toLowerCase().replace("dcnum","")+'_Key="'+u[0]["dcCurrID"+this.ColumnSource[p].DisplayMember.toLowerCase().replace("dcnum","")].toString()+'" ',m+="dcCurrID"+this.ColumnSource[p].DisplayMember.toLowerCase().replace("dcnum","")+"="+u[0]["dcCurrID"+this.ColumnSource[p].DisplayMember.toLowerCase().replace("dcnum","")].toString()+", "),this.GridDataColumns.Contains("dcExchRT"+this.ColumnSource[p].DisplayMember.toLowerCase().replace("dcnum",""))&&(i+="dcExchRT"+this.ColumnSource[p].DisplayMember.toLowerCase().replace("dcnum","")+'="'+u[0]["dcExchRT"+this.ColumnSource[p].DisplayMember.toLowerCase().replace("dcnum","")].toString()+'" ',m+="dcExchRT"+this.ColumnSource[p].DisplayMember.toLowerCase().replace("dcnum","")+"="+u[0]["dcExchRT"+this.ColumnSource[p].DisplayMember.toLowerCase().replace("dcnum","")].toString()+", ")))):(i+="dcCalc"+this.ColumnSource[p].DisplayMember.replace("dc","")+'="'+u[0]["dcCalc"+this.ColumnSource[p].DisplayMember.replace("dc","")].toString()+'" ',a.e.IsEmpty(u[0]["dcCalc"+this.ColumnSource[p].DisplayMember.replace("dc","")])||(m+="dcCalc"+this.ColumnSource[p].DisplayMember.replace("dc","")+"="+u[0]["dcCalc"+this.ColumnSource[p].DisplayMember.replace("dc","")].toString()+", ")));else if("DATE"==this.ColumnSource[p].DataType){if(!a.e.IsEmpty(c[0][this.ColumnSource[p].DisplayMember])){let e="dd/MMM/yyyy";n.a.SessionManager.Preferences.ContainsKey("Date Format")&&""!=n.a.SessionManager.Preferences["Date Format"]&&(e=n.a.SessionManager.Preferences["Date Format"]),i+=this.ColumnSource[p].DisplayMember+'="'+new Date(c[0][this.ColumnSource[p].DisplayMember]).ToString(e).toString()+'" ',i+=this.ColumnSource[p].DisplayMember+'_Key="'+new Date(c[0][this.ColumnSource[p].DisplayMember]).toString()+'" ',d+=this.ColumnSource[p].DisplayMember+"='"+new Date(c[0][this.ColumnSource[p].DisplayMember]).ToString("dd/MMM/yyyy")+"', "}}else"ComboBox"==this.ColumnSource[p].DataType?(i+=this.ColumnSource[p].ValueBinding+'="'+c[0][this.ColumnSource[p].ValueBinding].toString()+'" ',d+=this.ColumnSource[p].ValueBinding+"='"+c[0][this.ColumnSource[p].ValueBinding].toString()+"', "):"PactComboBox"==this.ColumnSource[p].DataType?(i+=this.ColumnSource[p].ValueBinding+'="'+c[0][this.ColumnSource[p].ValueBinding].toString()+'" ',i+=this.ColumnSource[p].ValueBinding+'_Key="'+c[0][this.ColumnSource[p].ValueBinding].toString()+'" ',d+=this.ColumnSource[p].ValueBinding+"='"+c[0][this.ColumnSource[p].ValueBinding].toString()+"', "):"FLOAT"==this.ColumnSource[p].DataType?a.e.IsNum(c[0][this.ColumnSource[p].DisplayMember])&&(i+=this.ColumnSource[p].DisplayMember+'="'+c[0][this.ColumnSource[p].DisplayMember].toString()+'" ',d+=this.ColumnSource[p].DisplayMember+"='"+c[0][this.ColumnSource[p].DisplayMember].toString()+"', "):(i+=this.ColumnSource[p].DisplayMember+'="'+r.d.GetValidXml(c[0][this.ColumnSource[p].DisplayMember])+'" ',d+=this.ColumnSource[p].DisplayMember+"='"+r.d.GetValidTextXml(c[0][this.ColumnSource[p].DisplayMember])+"', ");else if(3==this.ColumnSource[p].CostCenterID)D||(i+='ProductID="'+s[o].ProductID.toString()+'" '),D=!0;else if(0!=this.ColumnSource[p].CostCenterID)i+=this.ColumnSource[p].DisplayMember+'="'+s[o][this.ColumnSource[p].ValueMember.substr(0,this.ColumnSource[p].ValueMember.length-4)].toString()+'" ';else if("DocSeqNo"!=this.ColumnSource[p].DisplayMember&&"IsScheme"!=this.ColumnSource[p].DisplayMember)if("DATE"==this.ColumnSource[p].DataType){if(e.Tables[0].length>0&&!a.e.IsEmpty(s[o][this.ColumnSource[p].DisplayMember])){let e="dd/MMM/yyyy";n.a.SessionManager.Preferences.ContainsKey("Date Format")&&""!=n.a.SessionManager.Preferences["Date Format"]&&(e=n.a.SessionManager.Preferences["Date Format"]),i+=this.ColumnSource[p].DisplayMember+'="'+new Date(s[o][this.ColumnSource[p].DisplayMember]).ToString(e).toString()+'" ',this.GridDataColumns.Contains(this.ColumnSource[p].DisplayMember+"_Key")&&(i+=this.ColumnSource[p].DisplayMember+'_Key="'+new Date(s[o][this.ColumnSource[p].DisplayMember]).toString()+'" ')}}else"quantity"==this.ColumnSource[p].DisplayMember.toLowerCase()?i+=this.ColumnSource[p].DisplayMember+'="'+r.d.GetValidXml(s[o][this.ColumnSource[p].DisplayMember])+'" ':"gross"==this.ColumnSource[p].DisplayMember.toLowerCase()?(n.a.SessionManager.Preferences.ContainsKey("Use Foreign Currency")&&Object(S.j)(n.a.SessionManager.Preferences["Use Foreign Currency"])||!a.e.IsEmpty(e.Tables[0][h].ExchangeRate)&&1!=parseFloat(e.Tables[0][h].ExchangeRate))&&e.Columns[0].Contains("grossfc")?i+=this.ColumnSource[p].DisplayMember+'="'+s[o].grossfc.toString()+'" ':i+=this.ColumnSource[p].DisplayMember+'="'+s[o][this.ColumnSource[p].DisplayMember].toString()+'" ':"ComboBox"==this.ColumnSource[p].DataType&&e.Columns[0].Contains(this.ColumnSource[p].ValueBinding)?i+=this.ColumnSource[p].ValueBinding+'="'+a.e.String(s[o][this.ColumnSource[p].ValueBinding])+'" ':e.Columns[0].Contains(this.ColumnSource[p].DisplayMember)&&(i+=this.ColumnSource[p].DisplayMember+'="'+r.d.GetValidXml(s[o][this.ColumnSource[p].DisplayMember])+'" ');if(i+=' CCQuery="'+C.toString()+'" ',i+=' NumQuery="'+m.toString()+'" ',i+=' texQuery="'+d.toString()+'" ',i+=' Type="'+s[o].ProductTypeID.toString()+'" ',i+=' DocSeqNo="'+(o+1).toString()+'" ',"3"!=e.Tables[0][h].ProductTypeID.toString()&&"11"!=e.Tables[0][h].ProductTypeID.toString()&&"12"!=e.Tables[0][h].ProductTypeID.toString()||(a.e.IsEmpty(s[o].Quantity)||a.e.IsEmpty(e.Tables[0][h].Quantity)?i+=' defaultQuantity="'+s[o].Quantity.toString()+'" ':i+=' defaultQuantity="'+parseFloat(s[o].Quantity)/parseFloat(e.Tables[0][h].Quantity)+'" '),a.e.IsEmpty(s[o].AverageRate)||(i+=' AverageRate="'+s[o].AverageRate.toString()+'" '),null!=y&&(i+=' totgross="'+y.toString()+'" '),null!=b&&(i+=' totQty="'+b.toString()+'" '),i+=' UOMConversion="'+s[o].UOMConversion.toString()+'" ',i+=' UOMConvertedQty="'+s[o].UOMConvertedQty.toString()+'" ',i+=' LinkedInvDocDetailsID="'+s[o].LinkedInvDocDetailsID.toString()+'" ',i+=' LinkedFieldName="'+a.e.String(s[o].LinkedFieldName)+'" ',i+=' LinkedFieldValue="'+a.e.String(s[o].LinkedFieldValue)+'" ',e.Tables.length>5){let t=e.Tables[5].filter(e=>e.InvDocDetailsID==s[o].DocDetailsID);t.length>0&&(i+=' ExtraXML="',i+="&lt;xml>&lt;Row ",e.Columns[5].Contains("RefInvDocDetailsID")&&(i+=" RefInvID=&quo;"+a.e.String(t[0].RefInvDocDetailsID)+"&quot; "),i+=" BatchID=&quo;"+t[0].BatchID.toString()+"&quot; ",i+=" ProductID=&quo;"+s[o].ProductID.toString()+"&quot; ",i+=" Quantity=&quo;"+t[0].Quantity.toString()+"&quot; ",i+=" Hold=&quo;"+t[0].HoldQuantity.toString()+"&quot; ",i+=" Release=&quo;"+t[0].ReleaseQuantity.toString()+"&quot; ",i+=' >&lt;/Row>&lt;/xml>" ')}i+=" /></Row>"}i+="</xml>","8"==e.Tables[0][h].ProductTypeID.toString()||"3"==e.Tables[0][h].ProductTypeID.toString()||"11"==e.Tables[0][h].ProductTypeID.toString()||"12"==e.Tables[0][h].ProductTypeID.toString()?l.ExtraXML=i:this.Preferences.ContainsKey("EnablePromotions")&&"true"==this.Preferences.EnablePromotions.toLowerCase()&&(l.PromotionXML=i)}}if(e.Tables[0].length>0&&e.Columns[0].Contains("IsQtyFreeOffer")&&!a.e.IsEmpty(e.Tables[0][h].IsQtyFreeOffer)&&parseInt(e.Tables[0][h].IsQtyFreeOffer)>0&&this.GridDataColumns.Contains("SchemeID")){if(l.SchemeID=e.Tables[0][h].IsQtyFreeOffer.toString(),"2"!=l.SchemeID.toString()){let t=this.GridData.filter(t=>1!=t.SchemeID&&t.SchemeID==e.Tables[0][h].IsQtyFreeOffer);if(t.length>0)l.MaxSchemeID=t[0].MaxSchemeID.toString();else{let e=0,t=this.GridData.Compute("max","MaxSchemeID");null!=t&&(e=a.e.Int(t)),e++,l.MaxSchemeID=e}}if("1"==l.SchemeID.toString())l.IsScheme="Y",l.FreeQTY=l.quantity,l.quantity=0;else if(e.Columns[0].Contains("ParentSchemeID")&&!a.e.IsEmpty(e.Tables[0][h].ParentSchemeID)&&"0"!=e.Tables[0][h].ParentSchemeID.toString()){if(l.IsScheme="Y","2"==l.SchemeID.toString()){let t=e.Tables[0][h].ParentSchemeID.toString().split(","),s=e.Tables[0].filter(e=>t.Contains(e.DocSeqNo));if(s.length>0){let e=this.GridData.filter(e=>e.DocDetailsID==s[0].DocDetailsID);e.length>0&&(l.MaxSchemeID=e[0].MaxSchemeID)}}}else if(l.IsScheme="N","2"==l.SchemeID.toString()){let e=0,t=this.GridData.Compute("max","MaxSchemeID");null!=t&&(e=a.e.Int(t)),e++,l.MaxSchemeID=e}}if(e.Tables[0].length>0&&e.Columns[0].Contains("AverageRate")&&!a.e.IsEmpty(e.Tables[0][h].AverageRate)&&this.GridDataColumns.Contains("AVGRATE")&&(l.AVGRATE=e.Tables[0][h].AverageRate.toString()),!t&&e.Tables.length>19&&e.Tables[19].length>0&&e.Columns[19].Contains("ExecutedQty")){let t=e.Tables[19].filter(t=>t.InvDocDetailsID==e.Tables[0][h].DocDetailsID);if(this.GridDataColumns.Contains("ExecutedQty")&&t.length>0&&(l.ExecutedQty=t[0].ExecutedQty.toString()),this.Data.Tables[0].length>0){let e=this.Data.Tables[0].filter(e=>null!=e.LocalReference&&79==e.LocalReference&&50455==e.LinkData);e.length>0&&this.GridDataColumns.Contains(e[0].SysColumnName.toString())&&t.length>0&&(l[e[0].SysColumnName.toString()]=t[0].ExecutedQty.toString())}}if(!t&&e.Tables[0].length>0&&e.Columns[0].Contains("BatchID")&&(l.BatchID=e.Tables[0][h].BatchID.toString()),(22==this.DocumentType||23==this.DocumentType)&&this.GridDataColumns.Contains("DenominationsXML")&&e.Tables.length>13){let t="",s=e.Tables[13].filter(t=>t.AccDocDetailsID==e.Tables[0][h].DocDetailsID);for(let e=0;e<s.length;e++)t+='<XML IsDenom="1" ',a.e.IsEmpty(s[e].Notes)||a.e.IsEmpty(s[e].NotesTender)||(t+=' CurrencyID="'+s[e].CurrencyID.toString()+'" Notes="'+s[e].Notes.toString()+'"  NotesTender="',t+=s[e].NotesTender.toString()+'"  Change="'),a.e.IsEmpty(s[e].Change)||a.e.IsEmpty(s[e].ChangeTender)?t+='0" ChangeTender="0" />':t+=s[e].Change.toString()+'" ChangeTender="'+s[e].ChangeTender.toString()+'" />';l.DenominationsXML=t.toString(),l.Denomination="Denominations"}if(16!=this.DocumentType&&17!=this.DocumentType&&28!=this.DocumentType&&29!=this.DocumentType||(e.Tables[0].length>0&&!a.e.IsEmpty(e.Tables[0][h].CreditAccount)&&parseInt(e.Tables[0][h].CreditAccount)>0?(l.AccountID_Key=e.Tables[0][h].CreditAccount.toString(),l.Type=e.Tables[0][h].CrIsBillwise.toString(),e.Columns[0].Contains("IsNegative")&&!a.e.IsEmpty(e.Tables[0][h].IsNegative)&&Object(S.j)(e.Tables[0][h].IsNegative)?(l.DebitAmount=n.a.SessionManager.Preferences.ContainsKey("Use Foreign Currency")&&Object(S.j)(n.a.SessionManager.Preferences["Use Foreign Currency"])&&e.Columns[0].Contains("amountfc")?"-"+e.Tables[0][h].amountfc:"-"+e.Tables[0][h].Amount,l.CreditAmount=0):(l.DebitAmount=0,l.CreditAmount=n.a.SessionManager.Preferences.ContainsKey("Use Foreign Currency")&&Object(S.j)(n.a.SessionManager.Preferences["Use Foreign Currency"])&&e.Columns[0].Contains("amountfc")?e.Tables[0][h].amountfc:e.Tables[0][h].Amount)):e.Tables[0].length>0&&!a.e.IsEmpty(e.Tables[0][h].DebitAccount)&&parseInt(e.Tables[0][h].DebitAccount)>0&&(l.AccountID_Key=e.Tables[0][h].DebitAccount.toString(),l.Type=e.Tables[0][h].DBIsBillwise.toString(),16==this.DocumentType&&e.Columns[0].Contains("BankAccountID")&&!a.e.IsEmpty(e.Tables[0][h].BankAccountID)&&parseInt(e.Tables[0][h].BankAccountID.toString())>0&&(l.AccountID_KEY=parseInt(e.Tables[0][h].BankAccountID.toString())),e.Columns[0].Contains("IsNegative")&&!a.e.IsEmpty(e.Tables[0][h].IsNegative)&&Object(S.j)(e.Tables[0][h].IsNegative)?(l.DebitAmount=0,l.CreditAmount=n.a.SessionManager.Preferences.ContainsKey("Use Foreign Currency")&&Object(S.j)(n.a.SessionManager.Preferences["Use Foreign Currency"])&&e.Columns[0].Contains("amountfc")?"-"+e.Tables[0][h].amountfc:"-"+e.Tables[0][h].Amount):(l.DebitAmount=n.a.SessionManager.Preferences.ContainsKey("Use Foreign Currency")&&Object(S.j)(n.a.SessionManager.Preferences["Use Foreign Currency"])&&e.Columns[0].Contains("amountfc")?e.Tables[0][h].amountfc:e.Tables[0][h].Amount,l.CreditAmount=0))),this.Preferences.ContainsKey("LineWisePDC")&&Object(S.j)(this.Preferences.LineWisePDC)&&e.Tables.length>5&&e.Tables[5].length>0){let t=e.Tables[5].filter(t=>t.AccDocDetailsID==e.Tables[0][h].DocDetailsID);t.length>0&&(l.RefStatusID=t[0].StatusID)}if(!t&&e.Tables.length>4&&e.Tables[4].length>0){let t,s="",i="";this.IsInventory?(t=e.Tables[4].filter(e=>e.InvDocDetailsID==l.DocDetailsID),s+="<xml>",t.forEach(t=>{s+="<Row ";for(let n=0;n<e.Columns[4].length;n++)s+=e.Columns[4][n]+'="'+a.e.StringValue(t[e.Columns[4][n]])+'" ';s+=" ></Row>"}),s+="</xml>"):(s+="<BillWise> ",t=e.Columns[4].Contains("RefNodeid")?e.Tables[4].filter(t=>t.RefNodeid==e.Tables[0][h].DocDetailsID):e.Tables[4].filter(t=>t.DocSeqNo==e.Tables[0][h].DocSeqNo),this.dtSerialTemp=t,t.forEach(t=>{s+="<Row ",s+='DocSeqNo="'+t.DocSeqNo.toString()+'" ',s+='AccountID="'+t.AccountID.toString()+'" ',e.Columns[4].Contains("RefNodeid")&&(s+='VNO="'+t.DocNo.toString()+'" ',""!=this.ChildVNos&&(this.ChildVNos+="','"),this.ChildVNos+=t.DocNo.toString(),this.GridDataColumns.Contains("OldSeqNo")&&(l.OldSeqNo=t.DocSeqNo.toString())),s+='AdjAmount="'+t.AdjAmount.toString()+'" ',s+='AdjCurrID="'+t.AdjCurrID.toString()+'" ',s+='AdjExchRT="'+t.AdjExchRT.toString()+'" ',n.a.SessionManager.Preferences.ContainsKey("BillwiseCurrency")&&"true"==n.a.SessionManager.Preferences.BillwiseCurrency.toLowerCase()&&e.Columns[4].Contains("AmountFC")?s+='AmountFC="'+t.AmountFC.toString()+'" ':!a.e.IsEmpty(t.AdjAmount)&&!a.e.IsEmpty(t.AdjExchRT)&&parseFloat(t.AdjExchRT)>0?s+='AmountFC="'+parseFloat(t.AdjAmount)/parseFloat(t.AdjExchRT)+'" ':s+='AmountFC="'+t.AdjAmount.toString()+'" ',s+='IsNewReference="'+(Object(S.j)(t.IsNewReference)?"1":"0")+'" ',!Object(S.j)(t.IsNewReference)&&e.Columns[4].Contains("RefStatusID")&&(s+='RefStatusID="'+t.RefStatusID.toString()+'" '),s+='RefDocNo="'+r.d.GetValidXml(t.RefDocNo)+'" ',s+='RefDocSeqNo="'+a.e.StringValue(t.RefDocSeqNo)+'" ',e.Columns[4].Contains("RefDocDate")&&!a.e.IsEmpty(t.RefDocDate)&&(s+='RefDocDate="'+new Date(t.RefDocDate).ToString("dd/MMM/yyyy")+'" '),e.Columns[4].Contains("RefDocDueDate")&&!a.e.IsEmpty(t.RefDocDueDate)&&(s+='RefDocDueDate="'+new Date(t.RefDocDueDate).ToString("dd/MMM/yyyy")+'" '),s+='Narration="'+a.e.StringValue(t.Narration)+'" ',s+='IsDocPDC="'+(Object(S.j)(t.IsDocPDC)?"1":"0")+'" ',!a.e.IsEmpty(t.DiscAmount)&&parseFloat(t.DiscAmount.toString())>0&&(s+='DiscAccountID="'+t.DiscAccountID.toString()+'" ',s+='DiscCurrID="'+t.DiscCurrID.toString()+'" ',s+='DiscExchRT="'+t.DiscExchRT.toString()+'" ',s+='DiscAmount="'+t.DiscAmount.toString()+'" ',i+=this.GetDiscXML(t)),s+=" ></Row>"}),""!=i&&(l.DiscXML="<DiscXML>"+i+"</DiscXML>"),e.Tables.length>16&&e.Tables[16].length>0&&(t=e.Tables[16].filter(t=>t.DocSeqNo==e.Tables[0][h].DocSeqNo),t.forEach(e=>{s+='<NonAccRows RefDocNo="'+e.RefDocNo.toString()+'" Amount="'+e.Amount.toString()+'" Narration="'+e.Narration.toString()+'" ></NonAccRows>'})),s+=" </BillWise>"),l.ExtraXML=s}if(!t&&!this.IsInventory&&e.Tables.length>11&&e.Tables[11].length>0){let t=e.Tables[11].filter(t=>t.DocSeqNo==e.Tables[0][h].DocSeqNo);if(t.length>0){let s="";s+="<XML> ",t.forEach(t=>{s+="<Row ",s+='DocSeqNo="'+t.DocSeqNo.toString()+'" ',s+='AccountID="'+t.AccountID.toString()+'" ',s+='AdjAmount="'+t.AdjAmount.toString()+'" ',s+='AdjCurrID="'+t.AdjCurrID.toString()+'" ',s+='AdjExchRT="'+t.AdjExchRT.toString()+'" ',!a.e.IsEmpty(t.AdjAmount)&&!a.e.IsEmpty(t.AdjExchRT)&&parseFloat(t.AdjExchRT)>0?s+='AmountFC="'+parseFloat(t.AdjAmount)/parseFloat(t.AdjExchRT)+'" ':s+='AmountFC="'+t.AdjAmount.toString()+'" ',s+='IsNewReference="'+(Object(S.j)(t.IsNewReference)?"1":"0")+'" ',s+='RefDocNo="'+a.e.StringValue(t.RefDocNo)+'" ',s+='RefDocSeqNo="'+a.e.StringValue(t.RefDocSeqNo)+'" ',s+='Narration="'+a.e.StringValue(t.Narration)+'" ',e.Columns[11].Contains("RefDocDate")&&!a.e.IsEmpty(t.RefDocDate)&&(s+='RefDocDate="'+new Date(t.RefDocDate).ToString("dd/MMM/yyyy")+'" '),e.Columns[11].Contains("RefDocDueDate")&&!a.e.IsEmpty(t.RefDocDueDate)&&(s+='RefDocDueDate="'+new Date(t.RefDocDueDate).ToString("dd/MMM/yyyy")+'" '),s+='IsDocPDC="'+(Object(S.j)(t.IsDocPDC)?"1":"0")+'" ',s+=" ></Row>"}),s+=" </XML>",l.ReturnXML=s}}if(!t&&this.IsInventory&&e.Tables.length>5&&e.Columns[5].Contains("InvDocDetailsID")&&e.Tables[5].length>0&&"5"==e.Tables[0][h].ProductTypeID.toString()){let t="",s=e.Tables[5].filter(e=>e.InvDocDetailsID==l.DocDetailsID||e.DynamicInvDocDetailsID==l.DocDetailsID);if(s.length>0){let i=0;t+="<xml>",s.forEach(s=>{if(t+="<Row ",e.Columns[5].Contains("RefInvDocDetailsID")&&(t+=' RefInvID="'+a.e.StringValue(s.RefInvDocDetailsID)+'" '),t+=' BatchID="'+s.BatchID.toString()+'" ',t+=' ProductID="'+l.ProductID_Key.toString()+'" ',31==this.DocumentType||32==this.DocumentType?(t+=' Quantity="'+s.ReleaseQuantity.toString()+'" ',t+=' Hold="0" ',t+=' Release="'+s.ReleaseQuantity.toString()+'" '):(t+=' Quantity="'+s.Quantity.toString()+'" ',t+=' Hold="'+s.HoldQuantity.toString()+'" ',30==this.DocumentType&&this.GridDataColumns.Contains("VoucherType")&&"-1"==l.VoucherType.toString()||(t+=' Release="'+s.ReleaseQuantity.toString()+'" ')),this.Preferences.ContainsKey("ConsBatch")&&"True"==this.Preferences.ConsBatch&&(t+=' DocDetailsID="'+s.InvDocDetailsID.toString()+'" ',a.e.IsEmpty(s.LinkedInvDocDetailsID)||(t+=' LinkedID="'+s.LinkedInvDocDetailsID.toString()+'" '),i+=parseFloat(s.Quantity)),l.MRate=s.MRPRate.toString(),l.RRate=s.RetailRate.toString(),l.SRate=s.StockistRate.toString(),this.Data.Tables[0].length>0){let e=this.Data.Tables[0].filter(e=>null!=e.LocalReference&&-100==e.LinkData);e.length>0&&this.GridDataColumns.Contains(e[0].SysColumnName.toString())&&(l[e[0].SysColumnName.toString()]=s.BatchNumber.toString()),e=this.Data.Tables[0].filter(e=>null!=e.LocalReference&&-101==e.LinkData),e.length>0&&this.GridDataColumns.Contains(e[0].SysColumnName.toString())&&s.MfgDate&&(l[e[0].SysColumnName.toString()]=new Date(s.MfgDate).ToString(n.a.SessionManager.Preferences["Date Format"])),e=this.Data.Tables[0].filter(e=>null!=e.LocalReference&&-102==e.LinkData),e.length>0&&this.GridDataColumns.Contains(e[0].SysColumnName.toString())&&s.ExpiryDate&&(l[e[0].SysColumnName.toString()]=new Date(s.ExpiryDate).ToString(n.a.SessionManager.Preferences["Date Format"]))}t+=" ></Row>"}),i>0&&(l.Quantity=i),t+="</xml>",l.ExtraXML=t}}if(!t&&35==this.DocumentType&&e.Tables.length>16&&e.Columns[16].Contains("ContractLineID")&&e.Tables[16].length>0){let t=e.Tables[16].filter(e=>e.ContractLineID==l.DocDetailsID);if(t.length>0){let e="";e+="<xml>";for(let s=0;s<t.length;s++)a.e.IsEmpty(t[s].StartDate)||(e+="<Row ",e+='StartDate="'+new Date(t[s].StartDate).ToString("dd/MMM/yyyy")+'" ',e+='StartTime="'+t[s].StartTime.toString()+'" ',a.e.IsEmpty(t[s].EndDate)||(e+='EndDate="'+new Date(t[s].EndDate).ToString("dd/MMM/yyyy")+'" ',e+='EndTime="'+t[s].EndTime.toString()+'" '),e+='Remarks="'+t[s].Remarks.toString()+'" ',e+='AssignedTo="'+t[s].AssignedTo.toString()+'" ',e+='AccountName="'+t[s].AccountName.toString()+'" ',e+='CaseID="'+t[s].CaseID.toString()+'" ',e+='Status="'+t[s].Status.toString()+'" ',e+="></Row>");e+="</xml>",l.ExtraXML=e}}if(202==this.DocumentType&&e.Tables.length>16&&e.Columns[16].Contains("CostCenterID")&&e.Tables[16].length>0){let t=e.Tables[16].filter(e=>e.CostCenterID==this.CostCenterID.toString()&&e.RefNodeID==l.DocDetailsID.toString());if(t.length>0){let e="";e+="<xml>";for(let s=0;s<t.length;s++)a.e.IsEmpty(t[s].StartDate)||(e+="<Row ",e+='StartDate="'+new Date(t[s].StartDate.toString()).ToString("dd/MMM/yyyy")+'" ',e+='StartTime="'+t[s].StartTime.toString()+'" ',a.e.IsEmpty(t[s].EndDate)||(e+='EndDate="'+new Date(t[s].EndDate.toString()).ToString("dd/MMM/yyyy")+'" ',e+='EndTime="'+t[s].EndTime.toString()+'" '),e+='Remarks="'+a.e.String(t[s].Remarks)+'" ',e+='AssignedTo="'+a.e.String(t[s].AssignedTo)+'" ',e+='AccountName="'+a.e.String(t[s].AccountName)+'" ',e+='DocID="'+a.e.String(t[s].DocID)+'" ',e+='DocDetailsID="'+a.e.String(t[s].DocDetailsID)+'" ',e+='Status="'+a.e.String(t[s].Status)+'" ',e+="></Row>");e+="</xml>",l.ExtraXML=e.toString()}}if(this.IsInventory&&e.Tables.length>21&&e.Columns[21].Contains("InvDocDetailsID")&&this.GridDataColumns.Contains("QtyType")&&e.Tables[21].length>0){let s="",n=null;n=e.Tables[21].filter(t?t=>t.InvDocDetailsID==a.e.String(e.Tables[0][h].DocDetailsID):e=>e.InvDocDetailsID==l.DocDetailsID),n.length>0&&(s+="<QtyAdjustments>",n.forEach(t=>{s+="<Row ";for(let n=0;n<e.Columns[21].length;n++)e.Columns[21][n].Contains("Fld")&&!a.e.IsEmpty(t[e.Columns[21][n]])&&(s+=e.Columns[21][n]+'="'+t[e.Columns[21][n]].toString()+'" ');"1"==t.Islinked.toString()||"True"==t.Islinked.toString()?s+='Islinked="1"':s+='Islinked="0"',s+=" ></Row>"}),s+="</QtyAdjustments>",l.QtyXML=s)}if(!t&&this.IsInventory&&e.Tables.length>22&&e.Columns[22].Contains("InvDocDetailsID")){let t="",s=e.Tables[22].filter(e=>e.InvDocDetailsID==l.DocDetailsID),n=0;s.length>0&&(t+="<BinsXML>",s.forEach(s=>{t+="<Row ",t+=' NodeID="'+s.BinID.toString()+'" ',t+=' Allocate="'+s.Quantity.toString()+'" ',n+=parseFloat(s.Quantity),m>0&&(t+=' Warehouse="'+e.Tables[1][h]["dcCCNID"+(m-5e4)].toString()+'" '),t+=' Remarks="'+a.e.String(s.Remarks)+'" ',t+=' RefID="'+s.RefInvDocDetailsID.toString()+'" ',t+=' Vol="'+e.Tables[0][h].Volume.toString()+'" ',t+=' Waist="'+e.Tables[0][h].Wastage.toString()+'" ',t+=" ></Row>"}),t+="</BinsXML>",l.BinsXML=t),this.GridDataColumns.Contains("BinStatus")&&(0==n?(l.BinStatus="UnAdjusted",l.BinStatus_COLOR="RED"):a.e.IsEmpty(e.Tables[0][h].UOMConvertedQty)||parseFloat(e.Tables[0][h].UOMConvertedQty)!=n?(l.BinStatus="Partial",l.BinStatus_COLOR="ORANGE"):(l.BinStatus="Adjusted",l.BinStatus_COLOR="GREEN"))}if(!t&&this.IsInventory&&e.Tables.length>26&&e.Columns[26].Contains("InvDocDetailsID")&&e.Tables[26].length>0){let t="",s=e.Tables[26].filter(e=>1==e.Type&&e.InvDocDetailsID==l.DocDetailsID);if(s.length>0&&this.GridDataColumns.Contains("DocExtraXML")&&(t+="<DocExtraXML>",s.forEach(e=>{t+="<Row ",t+=' RefID="'+e.RefID.toString()+'" ',t+=' Qty="'+e.Quantity.toString()+'" ',t+=' Type="'+e.Type.toString()+'" ',t+=" ></Row>",l.BOEID=e.RefID.toString()}),t+="</DocExtraXML>",l.DocExtraXML=t),s=e.Tables[26].filter(e=>11==e.Type&&e.InvDocDetailsID==l.DocDetailsID),s.length>0&&this.GridDataColumns.Contains("DocExtraXML")&&(t+="<DocExtraXML>",s.forEach(e=>{t+="<Row ",t+=' RefID="'+e.RefID.toString()+'" ',t+=' Qty="'+e.Quantity.toString()+'" ',t+=' Type="'+e.Type.toString()+'" ',t+=" ></Row>",l.BOEID=e.RefID.toString()}),t+="</DocExtraXML>",l.DocExtraXML=t),s=e.Tables[26].filter(e=>2==e.Type&&e.InvDocDetailsID==l.DocDetailsID),s.length>0&&this.GridDataColumns.Contains("PackXML")&&(this.GridDataColumns.Contains("Unq")&&!e.Columns[26].Contains("Unq")&&e.Columns[26].push("Unq"),t="",t+="<DocExtraXML>",s.forEach(s=>{t+="<Row ",t+=' RefID="'+s.RefID.toString()+'" ',t+=' Qty="'+s.Quantity.toString()+'" ',t+=' Type="'+s.Type.toString()+'" ',t+=' Label="'+s.label.toString()+'" ',t+=' Volume="'+e.Tables[0][h].Volume.toString()+'" ',t+=' Weight="'+e.Tables[0][h].Weight.toString()+'" ',a.e.IsEmpty(s.Fld1)||(t+=' Fld1="'+s.Fld1.toString()+'" '),a.e.IsEmpty(s.Fld2)||(t+=' Fld2="'+s.Fld2.toString()+'" '),a.e.IsEmpty(s.fld3)||(t+=' Fld3="'+s.fld3.toString()+'" '),a.e.IsEmpty(s.fld4)||(t+=' Fld4="'+s.fld4.toString()+'" '),a.e.IsEmpty(s.fld5)||(t+=' Fld5="'+s.fld5.toString()+'" '),t+=" ></Row>",e.Columns[26].Contains("Unq")&&(s.Unq=h)}),t+="</DocExtraXML>",l.PackXML=t,this.GridDataColumns.Contains("Unq")&&(l.Unq=h)),s=e.Tables[26].filter(e=>3==e.Type&&e.InvDocDetailsID==l.DocDetailsID),s.length>0&&this.GridDataColumns.Contains("TestCaseXML")&&(t="",t+="<DocExtraXML>",s.forEach(e=>{t+="<Row ",t+=' RefID="'+e.RefID.toString()+'" ',t+=' Qty="'+e.Quantity.toString()+'" ',a.e.IsEmpty(e.label)||(t+=' Label="'+e.label.toString()+'" '),t+=' Type="3" ',n.a.SessionManager.Preferences.ContainsKey("QCLabNameDimension")&&""!=n.a.SessionManager.Preferences.QCLabNameDimension.toString()&&0!=parseInt(n.a.SessionManager.Preferences.QCLabNameDimension)&&(a.e.IsEmpty(e.LabID)||(t+=' LabID="'+e.LabID.toString()+'" '),a.e.IsEmpty(e.ReportNo)||(t+=' ReportNo="'+e.ReportNo.toString()+'" '),a.e.IsEmpty(e.ReportDate)||(t+=' ReportDate="'+new Date(e.ReportDate).ToString("dd MMM yyyy")+'" ')),a.e.IsEmpty(e.Unit)||(t+=' Unit="'+e.Unit.toString()+'" '),a.e.IsEmpty(e.Remarks)||(t+=' Remarks="'+r.d.GetValidXml(e.Remarks.toString())+'" '),a.e.IsEmpty(e.Fld1)||(t+=' Fld1="'+r.d.GetValidXml(e.Fld1.toString())+'" '),a.e.IsEmpty(e.Fld2)||(t+=' Fld2="'+r.d.GetValidXml(e.Fld2.toString())+'" '),a.e.IsEmpty(e.fld3)||(t+=' Fld3="'+r.d.GetValidXml(e.fld3.toString())+'" '),a.e.IsEmpty(e.fld4)||(t+=' Fld4="'+r.d.GetValidXml(e.fld4.toString())+'" '),a.e.IsEmpty(e.fld5)||(t+=' Fld5="'+r.d.GetValidXml(e.fld5.toString())+'" '),a.e.IsEmpty(e.fld6)||(t+=' Fld6="'+r.d.GetValidXml(e.fld6.toString())+'" '),a.e.IsEmpty(e.fld7)||(t+=' Fld7="'+r.d.GetValidXml(e.fld7.toString())+'" '),a.e.IsEmpty(e.fld8)||(t+=' Fld8="'+r.d.GetValidXml(e.fld8.toString())+'" '),a.e.IsEmpty(e.fld9)||(t+=' Fld9="'+r.d.GetValidXml(e.fld9.toString())+'" '),a.e.IsEmpty(e.fld10)||(t+=' Fld10="'+r.d.GetValidXml(e.fld10.toString())+'" '),t+=" ></Row>"}),t+="</DocExtraXML>",l.TestCaseXML=t),45==this.DocumentType&&(s=e.Tables[26].filter(e=>9==e.Type&&e.InvDocDetailsID==l.DocDetailsID),s.length>0&&this.GridDataColumns.Contains("Dependencies")&&(t="",s.forEach(e=>{t.length>0&&(t+=","),t+=e.Fld1.toString()}),l.Dependencies=t),t="",t+="<AssignXML  ",s=e.Tables[26].filter(e=>6==e.Type&&e.InvDocDetailsID==l.DocDetailsID),s.length>0&&(t+='Groups="',s.forEach(e=>{t+=e.RefID.toString()+","}),t=t.substr(0,t.length-1),t+='"  '),s=e.Tables[26].filter(e=>7==e.Type&&e.InvDocDetailsID==l.DocDetailsID),s.length>0&&(t+='Roles="',s.forEach(e=>{t+=e.RefID.toString()+","}),t=t.substr(0,t.length-1),t+='"  '),s=e.Tables[26].filter(e=>8==e.Type&&e.InvDocDetailsID==l.DocDetailsID),s.length>0&&(t+='Users="',s.forEach(e=>{t+=e.RefID.toString()+","}),t=t.substr(0,t.length-1),t+='"  '),t+="></AssignXML>",l.AssignXML=t),s=e.Tables[26].filter(e=>50==e.Type&&e.InvDocDetailsID==l.DocDetailsID.toString()),s.length>0){let e=null;t="";for(let n=0;n<s.length;n++){const i=s[n];null!=e&&e.DisplayMember==i.label.toString()||(null!=e&&(a.e.IsEmpty(t)||(t="<XML>"+t+"</XML>",e.distLineWise?this.GridDataColumns.Contains(e.DisplayMember+"DistXML")&&(l[e.DisplayMember+"DistXML"]=t.toString()):e.distxml=t.toString())),e=this.ColumnSource.find(e=>e.DisplayMember==i.label.toString())),h>0&&!e.distLineWise||(t+="<Rows  DCCCNID"+(e.distDim-5e4)+'="'+i.RefID.toString(),t+='" Percent="'+i.Quantity.toString()+'" />')}null!=e&&""!=t.toString()&&(t="<XML>"+t+"</XML>",e.distLineWise?this.GridDataColumns.Contains(e.DisplayMember+"DistXML")&&(l[e.DisplayMember+"DistXML"]=t.toString()):e.distxml=t.toString())}}if(!t&&this.IsInventory&&e.Tables.length>12&&e.Columns[12].Contains("InvDocDetailsID")&&e.Tables[12].length>0&&this.TempProductID==parseInt(e.Tables[0][h].ProductID)){let t="",s=e.Tables[12].filter(e=>e.InvDocDetailsID==l.DocDetailsID);s.length>0&&(t+="<xml>",s.forEach(e=>{t+="<Row ",t+=' ProductCode="'+e.ProductCode.toString()+'" ',t+=' PurchasePrice="'+e.PurchasePrice.toString()+'" ',t+=' Manufacturer="'+e.Manufacturer.toString()+'" ',t+=' Vehicles="'+e.Vehicles.toString()+'" ',t+=' Part="'+e.Part.toString()+'" ',t+=" ></Row>"}),t+="</xml>",l.ExtraXML=t)}if(5==this.DocumentType&&(h++,!t)){if(l.TODocDetailsID=e.Tables[0][h].DocDetailsID,e.Tables.length>4&&e.Columns[4].Contains("InvDocDetailsID")&&this.GridDataColumns.Contains("RecievedQtyXML")){let t=e.Tables[4].filter(e=>e.InvDocDetailsID==l.TODocDetailsID),s="";s+="<xml>",t.forEach(t=>{s+="<Row ";for(let n=0;n<e.Columns[4].length;n++)s+=e.Columns[4][n]+'="'+a.e.StringValue(t[e.Columns[4][n]])+'" ';s+=" ></Row>"}),s+="</xml>",l.RecievedQtyXML=s}if(!t&&this.IsInventory&&e.Tables.length>22&&e.Columns[22].Contains("InvDocDetailsID")&&e.Tables[22].length>0){let t="",s=e.Tables[22].filter(e=>e.InvDocDetailsID==l.TODocDetailsID);s.length>0&&(t+="<BinsXML>",s.forEach(s=>{t+="<Row ",t+=' NodeID="'+s.BinID.toString()+'" ',t+=' Allocate="'+s.Quantity.toString()+'" ',m>0&&e.Tables[1].length>h&&(t+=' Warehouse="'+e.Tables[1][h]["dcCCNID"+(m-5e4)].toString()+'" '),t+=' Remarks="'+a.e.String(s.Remarks)+'" ',t+=' RefID="'+s.RefInvDocDetailsID.toString()+'" ',t+=" ></Row>"}),t+="</BinsXML>",l.TOBinsXML=t)}}""!=d?this.GridDataObj.Table.push(l):t||this.GridDataObj.Table.push(l)}}else if("-1"==e.Tables[0][h].DynamicInvDocDetailsID.toString()){let t=null;this.Preferences.ContainsKey("DistributeCost")&&"True"==this.Preferences.DistributeCost.toString()?t=this.Preferences.DistributeCostDims.split(","):n.a.SessionManager.Preferences.ContainsKey("DistributeCost")&&"True"==n.a.SessionManager.Preferences.DistributeCost.toString()&&(t=n.a.SessionManager.Preferences.DistributeCostDims.split(","));let s="";s+='<ROW Amount="'+a.e.String(e.Tables[0][h].GrossFC)+'" ',null!=t&&t.length>0&&t.forEach(t=>{""!=t&&(s+="cc"+t+'="'+e.Tables[1][h]["dcCCNID"+(parseInt(t)-5e4)].toString()+'" ')}),s+=this.IsPurchase?' AccountID="'+a.e.String(e.Tables[0][h].DebitAccount)+'" />':' AccountID="'+a.e.String(e.Tables[0][h].CreditAccount)+'" />',this.DistributeCostXML+=s.toString()}}if(!t&&n.a.SessionManager.Preferences.ContainsKey("ShowLinkedDocEdit")&&"true"==n.a.SessionManager.Preferences.ShowLinkedDocEdit.toLowerCase())if(e.Tables.length>6&&e.Columns[6].Contains("LinkDefID")&&e.Tables[6].length>0&&!a.e.IsEmpty(e.Tables[6][0].LinkDefID)&&"0"!=e.Tables[6][0].LinkDefID.toString()&&null!=this.Link&&null!=this.Link.LinkCombo)this.Link.LinkCombo.SelectedValue=e.Tables[6][0].LinkDefID.toString();else if(e.Tables[0].length>0&&e.Columns[0].Contains("LinkedFieldName")&&null!=e.Tables[0][0].LinkedFieldName&&"JOB"==e.Tables[0][0].LinkedFieldName.toString()&&null!=this.Link&&null!=this.Link.LinkCombo){var f=this.Link.LinkCombo.Items.find(e=>"158"==e.Parent);f&&(this.Link.LinkCombo.SelectedValue=f.Value)}if((n.a.IsMobile||n.a.SessionManager.Preferences.ContainsKey("DisableAutoLoad")&&"true"==n.a.SessionManager.Preferences.DisableAutoLoad.toLowerCase()||100==this.DocumentType)&&this.FillListViews(!1),this.GridDataObj.CanUserAddRows){let e=this.GridDataObj.NewRow();e.DocSeqNo=this.GridData.length+1,e.DocDetailsID=0,this.GridDataObj.Table.push(e)}94==this.DocumentType&&(this.MinRowCount=0),this.UpdateSequence(),t||(this.LoadEditCallBack.Call(e),this.GetLCTRLimits()),this.ChequeBookChecking=0}GetDiscXML(e){let t,s="",i=!1;parseFloat(a.e.String(e.AdjAmount))<0&&(i=!0),t=this.Preferences.ContainsKey("DecimalsBillWise")&&!a.e.IsEmpty(this.Preferences.DecimalsBillWise)&&parseInt(this.Preferences.DecimalsBillWise)>0?this.Preferences.DecimalsBillWise:n.a.SessionManager.Preferences.ContainsKey("DecimalsinAmount")?n.a.SessionManager.Preferences.DecimalsinAmount:"2";let o=this.dtSerialTemp.indexOf(e),l=1,u=parseFloat(a.e.String(e.DiscAmount)),c=parseFloat(a.e.String(e.DiscAmount));return!a.e.IsEmpty(e.DiscCurrID)&&!a.e.IsEmpty(e.DiscExchRT)&&a.e.Double(e.DiscExchRT)>0?(l=a.e.Double(e.DiscExchRT),c=parseFloat((u*l).ToString("N"+t))):l=1,s+="<Row><Transactions  ",s+=' DocDetailsID="0"  DocSeqNo="'+o+'" Amount="'+c+'" ',s+=' AmtFc="'+u+'" ',s+=' CurrencyID="1" ExchangeRate="'+l+'" ',s+=i?'CreditAccount="'+e.AccountID.toString()+'" DebitAccount="'+e.DiscAccountID.toString()+'" ':'CreditAccount="'+e.DiscAccountID.toString()+'" DebitAccount="'+e.AccountID.toString()+'" ',s+="></Transactions> ",this.strCCFields=this.GenerateQueryfromList(this._CCFields,!0,{message:""},!1,!1),s+=' <Numeric /> <Alpha /> <CostCenters  Query="'+this.strCCFields+'"  /> ',s+='<EXTRAXML><BillWise><Row DocSeqNo="'+o+'" ',s+='AccountID="'+e.AccountID.toString()+'" ',i?(s+='AmountFC="-'+u+'" ',s+='AdjAmount="-'+(u*l).ToString("N"+t)+'" '):(s+='AmountFC="'+u+'" ',s+='AdjAmount="'+(u*l).ToString("N"+t)+'" '),s+='AdjExchRT="'+l+'" ',s+='AdjCurrID="1" ',s+='IsNewReference="0" ',s+='RefDocNo="'+r.d.GetValidXml(e.RefDocNo.toString())+'" ',s+='RefStatusID="'+e.RefStatusID.toString()+'" ',s+='RefDocSeqNo="'+e.RefDocSeqNo.toString()+'" ',""!=e.RefDocDate.toString()&&(s+='RefDocDate="'+new Date(e.RefDocDate.toString()).ToString("dd/MMM/yyyy")+'" '),""!=e.RefDocDueDate.toString()&&(s+='RefDocDueDate="'+new Date(e.RefDocDueDate.toString()).ToString("dd/MMM/yyyy")+'" '),s+='  IsDocPDC="0" Narration=""></Row></BillWise></EXTRAXML></Row>',s.toString()}GetHistoryDetails(){let e=n.a.common.GetDataSet3("DOC024",this.CostCenterID.toString(),this.DocID.toString());return null!=e&&e.Tables.length>0&&e.Columns[0].Contains("HistoryID")?e.Tables[0]:null}LoadFieldsData(e,t,s,n){if(Logger.InfoLog("ControlGenerator:: Inside LoadCustomFieldsData"),null!=e&&e.length>0)try{for(let i=0;i<t.length;i++){let h=t[i];if((n.Contains(h.DBColumnName)||5==this.DocumentType&&h.DBColumnName.Contains("TO"))&&!(s&&h instanceof D.a&&this.Data.Tables[8].filter(e=>e.CCID==h.CCID.toString()).length>0||s&&h instanceof c.b&&this.Data.Tables[8].filter(e=>e.CCID==h.CCID.toString()).length>0))if(h instanceof r.d)h.Text=a.e.String(e[0][h.DBColumnName]);else if(h instanceof r.c)h.Text=a.e.String(e[0][h.DBColumnName]);else if(h instanceof o.a)h.Text=a.e.String(e[0][h.DBColumnName]);else if(h instanceof u.e)h.SelectedValue=a.e.String(e[0][h.DBColumnName]);else if(h instanceof l.c)h.Date=a.e.isValidDate(e[0][h.DBColumnName])?new Date(e[0][h.DBColumnName]):null;else if(h instanceof l.b)h.Date=a.e.isValidDate(e[0][h.DBColumnName])?new Date(e[0][h.DBColumnName]):null;else if(h instanceof l.a)a.e.isValidDate(e[0][h.DBColumnName])&&(h.Date=new Date(e[0][h.DBColumnName]));else if(h instanceof c.b)5==this.DocumentType&&h.DBColumnName.Contains("TO")?n.Contains(h.DBColumnName.replace("TO",""))&&e.length>1&&(h.SelectedValue=parseInt(e[1][h.DBColumnName.replace("TO","")])):a.e.IsNum(e[0][h.DBColumnName])?(h.PreviousSelectedValue=parseInt(e[0][h.DBColumnName]),h.SelectedValue=parseInt(e[0][h.DBColumnName])):(h.PreviousSelectedValue=0,h.SelectedValue=0);else if(h instanceof c.a){let t=h;null!=t.DBColumnName&&n.Contains(t.DBColumnName)&&!a.e.IsEmpty(e[0][t.DBColumnName])&&(t.SetValue(parseInt(e[0][t.DBColumnName])),t.Dialog=null,null==this.dtHistory&&(this.dtHistory=this.GetHistoryDetails()),null!=this.dtHistory&&(t.drrEdit=this.dtHistory.filter(e=>e.CCID==t.CCID)))}else h instanceof D.a&&(Object(g.isNullOrUndefined)(e[0][h.DBColumnName])?(h.Code.PreviousSelectedValue=h.Name.PreviousSelectedValue=0,h.Code.SelectedValue=h.Name.SelectedValue=0):(h.PrevSelValu=parseInt(e[0][h.DBColumnName]),h.Code.SelectedValue=h.Name.SelectedValue=parseInt(e[0][h.DBColumnName])))}}catch(i){Logger.ErrorLog("ControlGenerator:: LoadCustomFieldsData : "+i.stack)}}LoadLinkFieldsData_3(e,t,s){let n,i=0;if(s&&s.length>0)for(let a=0;a<e.Tables[0].length;a++)if(parseInt(s[0].InvDocDetailsID)==parseInt(e.Tables[0][a].DocDetailsID)){i=a;break}this.LoadLinkFieldsData(e,this._StaticFields,t,i),this.LoadLinkFieldsData(e,this._TextFields,t,i),this.LoadLinkFieldsData(e,this._CCFields,t,i),null!=this.DueDate&&(n=this.GetValue(e,"DueDate",0,t),""==n?this.IsPurchase&&null!=this.CreditAccount&&this.CreditAccount.SelectedValue>0?this.GetDueDate(this.CreditAccount.SelectedValue,this.DocDate.Date,this.IsPurchase):!this.IsPurchase&&null!=this.DebitAccount&&this.DebitAccount.SelectedValue>0&&this.GetDueDate(this.DebitAccount.SelectedValue,this.DocDate.Date,this.IsPurchase):this.DueDate.Date=a.e.isValidDate(n)?new Date(n):null),null!=this.BillNo&&(this.BillNo.Text=this.GetValue(e,"BillNo",0,t)),null!=this.Status&&(this.Status.SelectedValue=this.GetValue(e,"StatusID",0,t));for(let o=0;o<this.HeaderFields.length;o++){let s=this.HeaderFields[o];if(s instanceof h.b){n=this.GetValue(e,"CurrencyID",0,t),""!=n&&a.e.IsNum(n)&&(s.Currency.SelectedValue=n,n=this.GetValue(e,"ExchangeRate",0,t),""!=n&&a.e.IsNum(n)&&(s.ExchangeRate.Text=n));break}}}GetValue(e,t,s,n){let i,o=null;i=null!=n?n:e.Tables[4],o=i.filter(e=>e.BASECOL==t),o=null==n&&e.Columns[4].Contains("CostCenterIDLinked")?i.filter(n=>n.BASECOL==t&&n.CostCenterIDLinked==e.Tables[0][s].CostCenterID):i.filter(e=>e.BASECOL==t);let r="";if(o.length>0&&!a.e.IsEmpty(o[0].LINKCOL)){if(r=o[0].LINKCOL.toString(),"-3"==o[0].CostCenterColIDLinked.toString())return e.Tables[0][s].DocPrefix.toString();if("-2"==o[0].CostCenterColIDLinked.toString())return e.Tables[0][s].DocNumber.toString();if(r.toLowerCase().Contains("dcccnid")&&e.Tables.length>1&&e.Columns[1].Contains(r)&&e.Tables[1].length>s)return null==e.Tables[1][s][r]?"":e.Tables[1][s][r].toString();if(e.Tables.length>2&&e.Columns[2].Contains(r)&&e.Tables[2].length>s&&r.toLowerCase().Contains("dcnum")||r.toLowerCase().Contains("dccalcnum")||r.toLowerCase().Contains("dccurrid")||r.toLowerCase().Contains("dcexchrt"))return null==e.Tables[2][s][r]?"":e.Tables[2][s][r].toString();if(r.toLowerCase().Contains("dcalpha")&&e.Tables.length>3&&e.Columns[3].Contains(r)&&e.Tables[3].length>s)return null==e.Tables[3][s][r]?"":e.Tables[3][s][r].toString();if(e.Tables.length>0&&e.Columns[0].Contains(r)&&e.Tables[0].length>s)return null==e.Tables[0][s][r]?"":e.Tables[0][s][r].toString();if("contactid"==r.toLowerCase()&&e.Tables.length>1&&e.Columns[1].Contains("ContactID")&&e.Tables[1].length>s)return e.Tables[1][s].ContactID.toString();if("userid"==r.toLowerCase()&&e.Tables.length>1&&e.Columns[1].Contains("UserID")&&e.Tables[1].length>s)return e.Tables[1][s].UserID.toString()}return""}SetDynamicsetNumLinkValues(e,t,s,n){let i,o=null;i=null!=n?n:e.Tables[4],o=i.filter(3==t.CostCenterID?e=>"ProductID"==e.BASECOL:t.CostCenterID>0&&null!=t.ValueMember?e=>e.BASECOL==t.ValueMember.replace("_Key",""):"ComboBox"==t.DataType||"PactComboBox"==t.DataType?e=>e.BASECOL==t.ValueBinding:e=>e.BASECOL==t.DisplayMember);let l="";if(o.length>0&&""!=o[0].LINKCOL){l=o[0].LINKCOL.toString();let n="";if(l.toLowerCase().Contains("dcccnid")&&e.Tables.length>1&&e.Columns[1].Contains(l)&&e.Tables[1].length>s?n=a.e.String(e.Tables[1][s][l]):e.Tables.length>2&&e.Columns[2].Contains(l)&&e.Tables[2].length>s&&l.toLowerCase().Contains("dcnum")||l.toLowerCase().Contains("dccalcnum")||l.toLowerCase().Contains("dccurrid")||l.toLowerCase().Contains("dcexchrt")?n=a.e.String(e.Tables[2][s][l]):l.toLowerCase().Contains("dcalpha")&&e.Tables.length>3&&e.Columns[3].Contains(l)&&e.Tables[3].length>s?n=a.e.String(e.Tables[3][s][l]):e.Tables.length>0&&e.Columns[0].Contains(l)&&e.Tables[0].length>s?n=a.e.String(e.Tables[0][s][l]):"contactid"==l.toLowerCase()&&e.Tables.length>1&&e.Columns[1].Contains("ContactID")&&e.Tables[1].length>s?n=a.e.String(e.Tables[1][s].ContactID):"userid"==l.toLowerCase()&&e.Tables.length>1&&e.Columns[1].Contains("UserID")&&e.Tables[1].length>s&&(n=a.e.String(e.Tables[1][s].UserID)),""==n)return"";let i="";return 0!=t.CostCenterID?a.e.IsNum(n)&&(i=t.ValueMember.replace("_Key","")+"="+n+", "):a.e.String(e.Tables[0][s][e.Columns[0][1]])!=t.DisplayMember&&(i=t.DisplayMember+"="+r.d.GetValidXml(n)+", "),i}return""}SetDynamicsetLinkValues(e,t,s,n){let i,o=null;i=null!=n?n:e.Tables[4],o=i.filter(3==t.CostCenterID?e=>"ProductID"==e.BASECOL:t.CostCenterID>0&&null!=t.ValueMember?e=>e.BASECOL==t.ValueMember.replace("_Key",""):"ComboBox"==t.DataType||"PactComboBox"==t.DataType?e=>e.BASECOL==t.ValueBinding:e=>e.BASECOL==t.DisplayMember);let l="";if(o.length>0&&""!=o[0].LINKCOL){l=o[0].LINKCOL.toString();let n="";if(l.toLowerCase().Contains("dcccnid")&&e.Tables.length>1&&e.Columns[1].Contains(l)&&e.Tables[1].length>s?n=a.e.String(e.Tables[1][s][l]):e.Tables.length>2&&e.Columns[2].Contains(l)&&e.Tables[2].length>s&&l.toLowerCase().Contains("dcnum")||l.toLowerCase().Contains("dccalcnum")||l.toLowerCase().Contains("dccurrid")||l.toLowerCase().Contains("dcexchrt")?n=a.e.String(e.Tables[2][s][l]):l.toLowerCase().Contains("dcalpha")&&e.Tables.length>3&&e.Columns[3].Contains(l)&&e.Tables[3].length>s?n=a.e.String(e.Tables[3][s][l]):e.Tables.length>0&&e.Columns[0].Contains(l)&&e.Tables[0].length>s?n=a.e.String(e.Tables[0][s][l]):"contactid"==l.toLowerCase()&&e.Tables.length>1&&e.Columns[1].Contains("ContactID")&&e.Tables[1].length>s?n=a.e.String(e.Tables[1][s].ContactID):"userid"==l.toLowerCase()&&e.Tables.length>1&&e.Columns[1].Contains("UserID")&&e.Tables[1].length>s&&(n=a.e.String(e.Tables[1][s].UserID)),""==n)return"";let i="";return 0!=t.CostCenterID?a.e.IsNum(n)&&(i=t.ValueMember.replace("_Key","")+'="'+n+'" '):"ComboBox"==t.DataType||"PactComboBox"==t.DataType?i=t.ValueBinding+'="'+r.d.GetValidXml(n)+'" ':a.e.String(e.Tables[0][s][e.Columns[0][1]])!=t.DisplayMember&&(i=t.DisplayMember+'="'+r.d.GetValidXml(n)+'" '),i}return""}SetLinkValues(e,t,s,i,o,r){let l,u,c=null;l=null!=o?o:e.Tables[4],c=l,u=3!=t.CostCenterID||t.DisplayMember.toLowerCase().Contains("alpha")?t.CostCenterID>0&&null!=t.ValueMember?t.ValueMember.replace("_Key",""):"ComboBox"==t.DataType||"PactComboBox"==t.DataType?t.ValueBinding:t.DisplayMember:"ProductID",c=null==o&&e.Columns[4].Contains("CostCenterIDLinked")?l.filter(t=>t.BASECOL==u&&t.CostCenterIDLinked==e.Tables[0][s].CostCenterID):l.filter(e=>e.BASECOL==u);let D="";if(c.length>0){D=c[0].LINKCOL.toString();let l="";if(t.distDim>0){let n=e.Tables[13].filter(t=>50==t.Type&&t.Label==D&&t.InvDocDetailsID==e.Tables[0][s].DocDetailsID.toString()),a="";n.length>0&&(a+="<XML>",n.forEach(e=>{a+="<Rows  DCCCNID"+(t.distDim-5e4)+'="'+e.RefID.toString(),a+='" Percent="'+e.Quantity.toString()+'" />'}),a+="</XML>"),t.distLineWise?i[t.DisplayMember+"DistXML"]=a.toString():t.distxml=a.toString()}if("-3"==c[0].CostCenterColIDLinked.toString()?l=a.e.String(e.Tables[0][s].DocPrefix):"-2"==c[0].CostCenterColIDLinked.toString()?l=a.e.String(e.Tables[0][s].DocNumber):"-4"==c[0].CostCenterColIDLinked.toString()&&e.Columns[0].Contains("DocSeqNo")&&(l=a.e.String(e.Tables[0][s].DocSeqNo)),(t.DisplayMember.toLowerCase().Contains("todcccnid")||c[0].CostCenterColIDLinked.toString().startsWith("-"))&&e.Tables.length>1&&e.Columns[1].Contains(D)&&e.Tables[1].length>s+1)l=a.e.String(e.Tables[1][s+1][D]);else if(D.toLowerCase().Contains("dcccnid")&&e.Tables.length>1&&e.Columns[1].Contains(D)&&e.Tables[1].length>s)l=a.e.String(e.Tables[1][s][D]);else if(e.Tables.length>2&&e.Columns[2].Contains(D)&&e.Tables[2].length>s&&(D.toLowerCase().Contains("dcnum")||D.toLowerCase().Contains("dccalcnum")||D.toLowerCase().Contains("dccurrid")||D.toLowerCase().Contains("dcexchrt")))null==o&&Object(S.j)(c[0].CalcValue)?e.Columns[2].Contains("dcCalcNum"+D.toLowerCase().replace("dcnum",""))&&(l=a.e.String(e.Tables[2][s]["dcCalcNum"+D.toLowerCase().replace("dcnum","")])):l=a.e.String(e.Tables[2][s][D]);else if(D.toLowerCase().Contains("dcalpha")&&e.Tables.length>3&&e.Columns[3].Contains(D)&&e.Tables[3].length>s)l=a.e.String(e.Tables[3][s][D]);else if(e.Tables.length>0&&e.Columns[0].Contains(D)&&e.Tables[0].length>s)if("CurrencyID"==D&&t.DisplayMember.toLowerCase().Contains("alpha")){var h=this.Data.Tables[14].filter(t=>t.CurrencyID==e.Tables[0][s][D]);h.length>0&&(l=a.e.String(h[0].Name))}else l=a.e.String(e.Tables[0][s][D]);else"contactid"==D.toLowerCase()&&e.Tables.length>1&&e.Columns[1].Contains("ContactID")&&e.Tables[1].length>s?l=a.e.String(e.Tables[1][s].ContactID):"customerid"==D.toLowerCase()&&e.Tables.length>1&&e.Columns[1].Contains("CustomerID")&&e.Tables[1].length>s?l=a.e.String(e.Tables[1][s].CustomerID):"userid"==D.toLowerCase()&&e.Tables.length>1&&e.Columns[1].Contains("UserID")&&e.Tables[1].length>s?l=a.e.String(e.Tables[1][s].UserID):"accountid"==D.toLowerCase()&&e.Tables.length>0?a.e.Int(e.Tables[0][s].DebitAccount)>0?l=e.Tables[0][s].DebitAccount.toString():a.e.Int(e.Tables[0][s].CreditAccount)>0&&(l=e.Tables[0][s].CreditAccount.toString()):"debitamount"==D.toLowerCase()?a.e.Int(e.Tables[0][s].DebitAccount)>0&&e.Columns[0].Contains("Amount")&&!a.e.IsEmpty(e.Tables[0][s].Amount)&&(l=e.Tables[0][s].Amount.toString()):"creditamount"==D.toLowerCase()&&a.e.Int(e.Tables[0][s].CreditAccount)>0&&e.Columns[0].Contains("Amount")&&!a.e.IsEmpty(e.Tables[0][s].Amount)&&(l=e.Tables[0][s].Amount.toString());if(""==l)return;!t.IsPartialLinking||a.e.IsEmpty(e.Tables[0][s][e.Columns[0][0]])&&""==r||("Quantity"==e.Tables[0][s][e.Columns[0][3]].toString()||"Gross"==e.Tables[0][s][e.Columns[0][3]].toString()?l=""!=r?(parseFloat(l)*(parseFloat(r)/parseFloat(e.Tables[0][s][e.Tables[0][s][e.Columns[0][3]].toString()]))).toString():(parseFloat(l)*(parseFloat(e.Tables[0][s][0].toString())/parseFloat(e.Tables[0][s][e.Tables[0][s][e.Columns[0][3]].toString()]))).toString():e.Tables[0][s][e.Columns[0][3]].toString().toLowerCase().Contains("dcnum")&&(l=""!=r?(parseFloat(l)*(parseFloat(r)/parseFloat(e.Tables[2][s][e.Tables[0][s][e.Columns[0][3]].toString()]))).toString():(parseFloat(l)*(parseFloat(e.Tables[0][s][0].toString())/parseFloat(e.Tables[2][s][e.Tables[0][s][e.Columns[0][3]].toString()]))).toString())),0!=t.CostCenterID?"SELECTIONBOX"==t.DataType?i[t.DisplayMember]=l:(a.e.IsNum(l)&&(i[t.ValueMember]=l,a.e.IsEmpty(i[t.DisplayMember])||(i[t.DisplayMember]=null)),61==t.CostCenterID?(e.Columns[1].Contains("StartYear")&&this.GridDataColumns.Contains("StartYear")&&(i.StartYear=e.Tables[1][s].StartYear.toString()),e.Columns[1].Contains("EndYear")&&this.GridDataColumns.Contains("EndYear")&&(i.EndYear=e.Tables[1][s].EndYear.toString())):3!=t.CostCenterID||a.e.IsEmpty(i[t.ValueMember])||a.e.IsEmpty(e.Tables[0][s].ProductID)||parseInt(i[t.ValueMember])!=parseInt(e.Tables[0][s].ProductID)?11==t.CostCenterID&&e.Columns[0].Contains("UnitName")&&(i[t.DisplayMember]=e.Tables[0][s].UnitName):e.Columns[0].Contains(t.DisplayMember)&&(i[t.DisplayMember]=e.Tables[0][s][t.DisplayMember])):"ComboBox"==t.DataType?i[t.ValueBinding]=l:"PactComboBox"==t.DataType?(i[t.ValueBinding]=l,i[t.ValueBinding+"_Key"]=l):"DATE"==t.DataType?a.e.isValidDate(l)&&(i[t.DisplayMember]=new Date(l).ToString(n.a.SessionManager.Preferences["Date Format"]),i[t.DisplayMember+"_Key"]=new Date(l)):"DATETIME"==t.DataType||"TIME"==t.DataType?a.e.isValidDate(l)&&(i[t.DisplayMember+"_Key"]=new Date(l),i[t.DisplayMember]=new Date(l).ToString(n.a.SessionManager.Preferences["Date Format"]+" hh:mm:ss tt")):"TIME2"==t.DataType.toUpperCase()?a.e.isValidDate(l)&&(i[t.DisplayMember+"_Key"]=new Date(l),i[t.DisplayMember]=new Date(l).ToString("HH:mm")):i[t.DisplayMember]=l}}LoadLinkFieldsData(e,t,s,n=0){Logger.InfoLog("ControlGenerator:: Inside LoadCustomFieldsData");let i=[];if(null==s&&this.Preferences.ContainsKey("DimensionWise")&&""!=this.Preferences.DimensionWise&&(i=this.Preferences.DimensionWise.split(",")),null!=e){let l=null;l=null!=s?s:e.Tables[4];try{for(let r=0;r<t.length;r++){let u,D=t[r];if(i.length>0&&D instanceof c.b&&i.Contains(D.CCID.toString()))continue;u=null==s&&e.Columns[4].Contains("CostCenterIDLinked")&&e.Columns[0].Contains("CostCenterID")&&e.Tables[0].length>0?l.filter(t=>t.BASECOL==D.DBColumnName&&t.CostCenterIDLinked==e.Tables[0][0].CostCenterID):l.filter(e=>e.BASECOL==D.DBColumnName);let h="";if(u.length>0)if(h=a.e.StringValue(u[0].LINKCOL),"-3"==a.e.StringValue(u[0].CostCenterColIDLinked)&&(h="DocPrefix"),"-2"==a.e.StringValue(u[0].CostCenterColIDLinked)&&(h="DocNumber"),(D.DBColumnName.toLowerCase().Contains("todcccnid")||a.e.StringValue(u[0].CostCenterColIDLinked).startsWith("-"))&&e.Tables.length>1&&e.Columns[1].Contains(h)&&e.Tables[1].length>1)this.fillcontrolValue(D,e.Tables[1][1][h]);else if((h.toLowerCase().Contains("dcccnid")||h.toLowerCase().Contains("customerid")||h.toLowerCase().Contains("userid")||h.toLowerCase().Contains("contactid"))&&e.Tables.length>1&&e.Columns[1].Contains(h)&&e.Tables[1].length>n)this.fillcontrolValue(D,e.Tables[1][n][h]);else if(e.Tables.length>2&&e.Columns[2].Contains(h)&&e.Tables[2].length>n&&h.toLowerCase().Contains("dcnum")||h.toLowerCase().Contains("dccalcnum")||h.toLowerCase().Contains("dccurrid")||h.toLowerCase().Contains("dcexchrt"))this.fillcontrolValue(D,e.Tables[2][n][h]);else if(h.toLowerCase().Contains("dcalpha")&&e.Tables.length>3&&e.Columns[3].Contains(h)&&e.Tables[3].length>n)this.fillcontrolValue(D,e.Tables[3][n][h],!0);else if(e.Tables.length>0&&e.Columns[0].Contains(h)&&e.Tables[0].length>n)if("CurrencyID"==h&&D.DBColumnName.toLowerCase().Contains("alpha")){var o=this.Data.Tables[14].filter(t=>t.CurrencyID==e.Tables[0][n][h]);o.length>0&&this.fillcontrolValue(D,o[0].Name,!0)}else this.fillcontrolValue(D,e.Tables[0][n][h],!0)}}catch(r){Logger.ErrorLog("ControlGenerator:: LoadCustomFieldsData : "+r.stack)}}}GetcontrolValue(e){if(e instanceof r.d)return e.Text;if(e instanceof r.c)return e.Text;if(e instanceof o.a)return e.Text;if(e instanceof u.e)return e.SelectedValue;if(e instanceof l.c){if(e.Date)return e.Date.ToString("dd/MMM/yyyy")}else if(e instanceof l.b){if(e.Date)return e.Date.ToString("dd/MMM/yyyy hh:mm a")}else{if(e instanceof l.a)return e.Date.ToString("dd/MMM/yyyy");if(e instanceof c.b){if(e.SelectedValue>0)return e.SelectedValue.toString()}else if(e instanceof D.a&&e.SelectedValue>0)return e.SelectedValue.toString()}return""}fillcontrolValue(e,t,s=!1,n=null){if(e instanceof r.d)s&&!a.e.IsEmpty(e.Text)&&this.Preferences.ContainsKey("Appendheader")&&"true"==this.Preferences.Appendheader.toLowerCase()?e.Text.split(",").Contains(t)||(e.Text+=","+t):e.Text.startsWith("<FlowDocument")?(e.Xaml=e.Text,e.Text=a.e.GetXamlText(e.Text.toString())):e.Text=t;else if(e instanceof r.c)s&&!a.e.IsEmpty(e.Text)&&this.Preferences.ContainsKey("Appendheader")&&"true"==this.Preferences.Appendheader.toLowerCase()?e.Text.split(",").Contains(t)||(e.Text+=","+t):e.Text=t;else if(e instanceof o.a)e.Text=t;else if(e instanceof u.e)e.SelectedValue=t;else if(e instanceof h.b)e.Currency.SelectedValue=t;else if(e instanceof l.c)""!=t&&a.e.isValidDate(t)&&(e.Date=new Date(t));else if(e instanceof l.b)""!=t&&a.e.isValidDate(t)&&(e.Date=new Date(t));else if(e instanceof l.a)""!=t&&a.e.isValidDate(t)&&(e.Date=new Date(t));else if(e instanceof c.b)""!=t&&a.e.IsNum(t)&&(e.PreviousSelectedValue=parseInt(t),e.SelectedValue=parseInt(t));else if(e instanceof D.a)""!=t&&a.e.IsNum(t)&&(e.PrevSelValu=parseInt(t),e.SelectedValue=parseInt(t),null!=n&&(n.Columns.Contains("Code")&&(e.Code.SelectedValueText=n[0].Code.toString()),n.Columns.Contains("Name")&&(e.Name.SelectedValueText=n[0].Name.toString())));else if(e instanceof h.a&&null!=t&&""!=t&&"PayrollJV"==this.ParentFlagName&&"VoucherNo"==e.DBColumnName&&t.Contains("|")){let s=t.split("|");e.ComboBox.Items.find(e=>e instanceof u.d&&e.Value==s[0])&&e.ComboBox.Items.push(u.d.ComboBoxItems_2(s[0],s[0])),e.ComboBox.SelectedValue=s[0],e.TextBox.Text=s[1]}}onAddRowFoot(e){this.SNOFoot<=this.FooterColumnSource[1].ComboData.length+1&&(this.UpdateSequenceFoot(),e.Sno=this.SNOFoot)}onAddRow(e){e.DocSeqNo=this.GridData.length+1,e.DocDetailsID=0}UpdateSequenceFoot(){this.SNOFoot=1,this.FooterGridData.forEach(e=>{e.Sno=this.SNOFoot++,this.FooterGridDataObj.updateRow(e)})}UpdateSequence(){let e=0;for(let s=0;s<this.GridData.length;s++)if(this.IsInventory&&this.GridDataColumns.Contains("ProductID_Key")&&a.e.IsEmpty(this.GridData[s].ProductID_Key)||!this.IsInventory&&(this.GridDataColumns.Contains("AccountID_Key")&&a.e.IsEmpty(this.GridData[s].AccountID_Key)||this.GridDataColumns.Contains("DebitAccount_Key")&&a.e.IsEmpty(this.GridData[s].DebitAccount_Key)||this.GridDataColumns.Contains("CreditAccount_Key")&&a.e.IsEmpty(this.GridData[s].CreditAccount_Key))){e=s;break}38==this.DocumentType&&(this.MinRowCount=25),(n.a.IsMobile||100==this.DocumentType)&&(this.MinRowCount=0),40062==this.CostCenterID&&(this.MinRowCount=1);let t=null;for(let s=this.GridData.length;s<e+this.MinRowCount;s++)t=this.GridDataObj.NewRow(),t.DocSeqNo=s+1,t.DocDetailsID=0,this.GridDataObj.Table.push(t);this.SNO=1,this.GridData.forEach(e=>{e.DocSeqNo=this.SNO,this.GridDataColumns.Contains("StyleHeightZero")&&"1"==a.e.String(e.StyleHeightZero)||this.SNO++}),this.GridDataObj.refreshDataView()}SetDefaultValuesforCostCenters(e){for(let t=0;t<this._CCFields.length;t++){let s=this._CCFields[t];if(s instanceof c.b){if(0==e||1==e){if(0==e){if(5==this.DocumentType&&s.DBColumnName.Contains("TO"))continue;50001==s.CCID?this.DivisionID>0?s.DefaultValue=this.DivisionID.toString():n.a.SessionManager.DivisionID>0?s.DefaultValue=n.a.SessionManager.DivisionID.toString():this.CostCentersValues.ContainsKey("50001")&&(s.DefaultValue=this.CostCentersValues[50001],s.Enable&&(s.Enable=!1)):"50002"==s.CCID.toString()?this.LocationID>0?s.DefaultValue=this.LocationID.toString():n.a.SessionManager.LocationID>0?s.DefaultValue=n.a.SessionManager.LocationID.toString():this.CostCentersValues.ContainsKey("50002")&&(s.DefaultValue=this.CostCentersValues[50002],s.Enable&&(s.Enable=!1)):this.CostCentersValues.ContainsKey(s.CCID.toString())&&(s.DefaultValue=this.CostCentersValues[s.CCID.toString()],s.Enable&&(s.Enable=!1))}this.DivisionID>0&&(s.DivisionId=this.DivisionID),this.LocationID>0&&(s.LocationID=this.LocationID),a.e.Int(s.DefaultValue)>0&&(s.PreviousSelectedValue=parseInt(s.DefaultValue),s.SelectedValue=parseInt(s.DefaultValue),(this.Data.Tables[0].filter(e=>null!=e.LocalReference&&e.LocalReference==s.DBColumnID).length>0||this.DefaultBasedOn.ContainsKey(s.CCID.toString())||this.Preferences.ContainsKey("DimWiseCurrency")&&"true"==this.Preferences.DimWiseCurrency.toLowerCase()&&this.Preferences.ContainsKey("CurrencyDim")&&this.Preferences.CurrencyDim==s.CCID.toString())&&this.GetLinkReferenceData(s.DBColumnID,this.CostCenterID,s.SelectedValue,this.DocDate.Date,s.DBColumnName,s.CCID,null))}s.SelectedValue>0?(this.DBCRFilter(s),this._CCFields.filter(e=>e.DependantOn&&e.DependantOn.toLowerCase()==s.DBColumnName.toLowerCase()).forEach(e=>{if(e instanceof c.b&&s instanceof c.b){let t="";e.CCID>5e4?e.Dependantinuse?(t="("+s.DBColumnName.replace("dc","")+"="+s.SelectedValue.toString(),1==e.Dependancy&&(t+=" OR "+s.DBColumnName.replace("dc","")+"=1 "),t+=")"):t=5==e.Dependancy?"  JOIN "+this.GetTableName(e.CCID)+" CMJ ON a.lft between  CMJ.lft and CMJ.rgt JOIN COM_CostCenterCostCenterMap CM on CM.CostCenterID="+e.CCID+" and CM.ParentCostCenterID="+s.CCID+" and CM.ParentNodeID="+s.SelectedValue.toString()+" and CMJ.NodeID=CM.NodeID ":"  JOIN COM_CostCenterCostCenterMap CM on CM.ParentCostCenterID="+e.CCID+" and a.NodeID=CM.ParentNodeID \n                                            JOIN "+this.GetTableName(s.CCID)+" CMJ ON CM.CostCenterID= "+s.CCID+"   and CM.NodeID=CMJ.NodeID \n                                            JOIN "+this.GetTableName(s.CCID)+" CMJG ON CMJG.lft between  CMJ.lft and CMJ.rgt and CMJG.NodeID="+s.SelectedValue:65==e.CCID&&(t="(FeatureID="+s.CCID+" and  FeaturePK="+s.SelectedValue.toString()+")"),e.CustomWhere=t}})):this._CCFields.filter(e=>null!=e.DependantOn&&e.DependantOn.toLowerCase()==s.DBColumnName.toLowerCase()).forEach(e=>{e instanceof c.b&&(e.CustomWhere="")})}else s instanceof D.a&&((0==e||1==e)&&(0==e&&(50001==s.CCID?this.DivisionID>0?s.DefaultValue=this.DivisionID.toString():n.a.SessionManager.DivisionID>0?s.DefaultValue=n.a.SessionManager.DivisionID.toString():this.CostCentersValues.ContainsKey("50001")&&(s.DefaultValue=this.CostCentersValues[50001],s.Enable&&(s.Enable=!1)):"50002"==s.CCID.toString()?this.LocationID>0?s.DefaultValue=this.LocationID.toString():n.a.SessionManager.LocationID>0?s.DefaultValue=n.a.SessionManager.LocationID.toString():this.CostCentersValues.ContainsKey("50002")&&(s.DefaultValue=this.CostCentersValues[50002],s.Enable&&(s.Enable=!1)):this.CostCentersValues.ContainsKey(s.CCID.toString())&&(s.DefaultValue=this.CostCentersValues[s.CCID.toString()],s.Enable&&(s.Enable=!1))),this.DivisionID>0&&(s.Code.DivisionId=s.Name.DivisionId=this.DivisionID),this.LocationID>0&&(s.Code.LocationID=s.Name.LocationID=this.LocationID),a.e.Int(s.DefaultValue)>0)&&(s.SelectedValue=parseInt(s.DefaultValue),(this.Data.Tables[0].filter(e=>null!=e.LocalReference&&e.LocalReference==s.DBColumnID).length>0||this.DefaultBasedOn.ContainsKey(s.CCID.toString())||this.Preferences.ContainsKey("DimWiseCurrency")&&"true"==this.Preferences.DimWiseCurrency.toLowerCase()&&this.Preferences.ContainsKey("CurrencyDim")&&this.Preferences.CurrencyDim==s.CCID.toString())&&this.GetLinkReferenceData(s.DBColumnID,this.CostCenterID,s.SelectedValue,this.DocDate.Date,s.DBColumnName,s.CCID,null)),this.FillCustomwhere(s))}if((0==e||1==e)&&(null!=this.CreditAccount&&(this.DivisionID>0&&(this.CreditAccount.DivisionId=this.DivisionID),this.LocationID>0&&(this.CreditAccount.LocationID=this.LocationID),(1==this.DocumentType||2==this.DocumentType||10==this.DocumentType||26==this.DocumentType||27==this.DocumentType||3==this.DocumentType||4==this.DocumentType||25==this.DocumentType||13==this.DocumentType)&&null!=this.CreditAccount&&this.CreditAccount.SelectedValue>0)&&(this.Data.Tables[0].filter(e=>null!=e.LocalReference&&e.LocalReference==this.CreditAccount.DBColumnID).length>0||this.DefaultBasedOn.ContainsKey("2"))&&this.GetLinkReferenceData(this.CreditAccount.DBColumnID,this.CostCenterID,this.CreditAccount.SelectedValue,this.DocDate.Date,this.CreditAccount.DBColumnName,2,null),null!=this.DebitAccount&&(this.DivisionID>0&&(this.DebitAccount.DivisionId=this.DivisionID),this.LocationID>0&&(this.DebitAccount.LocationID=this.LocationID),(11==this.DocumentType||38==this.DocumentType||39==this.DocumentType||6==this.DocumentType||7==this.DocumentType||8==this.DocumentType||9==this.DocumentType||12==this.DocumentType||24==this.DocumentType)&&null!=this.DebitAccount&&this.DebitAccount.SelectedValue>0)&&(this.Data.Tables[0].filter(e=>null!=e.LocalReference&&e.LocalReference==this.DebitAccount.DBColumnID).length>0||this.DefaultBasedOn.ContainsKey("2"))&&this.GetLinkReferenceData(this.DebitAccount.DBColumnID,this.CostCenterID,this.DebitAccount.SelectedValue,this.DocDate.Date,this.DebitAccount.DBColumnName,2,null),this.IsInventory&&this.GridDataColumns.Contains("ProductID_Key")))for(let t=0;t<this.ColumnSource.length;t++)if(this.ColumnSource[t].CostCenterID>0){let e=this.Data.Tables[0].filter(e=>null!=e.LocalReference&&e.LocalReference==this.ColumnSource[t].ID);if(e.length>0){let s=0;for(let n=0;n<this.GridData.length;n++)a.e.IsEmpty(this.GridData[n].ProductID_Key)||a.e.IsEmpty(this.GridData[n][this.ColumnSource[t].ValueMember])||(s!=parseInt(this.GridData[n][this.ColumnSource[t].ValueMember])?(s=parseInt(this.GridData[n][this.ColumnSource[t].ValueMember]),this.GetLinkReferenceData(parseInt(this.ColumnSource[t].ID),this.CostCenterID,parseInt(this.GridData[n][this.ColumnSource[t].ValueMember]),Date.Today(),"",this.ColumnSource[t].CostCenterID,this.GridData[n])):n>0&&e.forEach(e=>{e.SysColumnName.toString().toUpperCase().Contains("CCNID")&&this.GridDataColumns.Contains(e.SysColumnName.toString()+"_Key")?(this.GridData[n][e.SysColumnName.toString()]=this.GridData[n-1][e.SysColumnName.toString()],this.GridData[n][e.SysColumnName.toString()+"_Key"]=this.GridData[n-1][e.SysColumnName.toString()+"_Key"]):this.GridDataColumns.Contains(e.SysColumnName.toString())&&(this.GridData[n][this.GridDataColumns[e.SysColumnName.toString()]]=this.GridData[n-1][this.GridDataColumns[e.SysColumnName.toString()]],this.GridDataColumns.Contains(this.GridDataColumns[e.SysColumnName.toString()]+"_Key")&&(this.GridData[n][this.GridDataColumns[e.SysColumnName.toString()]+"_Key"]=this.GridData[n-1][this.GridDataColumns[e.SysColumnName.toString()]+"_Key"]))}))}}null!=this.DebitAccount&&this.FillCustomwhere(this.DebitAccount),null!=this.CreditAccount&&this.FillCustomwhere(this.CreditAccount)}DBCRFilter(e){if(e.CCID>5e4&&(e.CrFilter>0||e.DbFilter>0)){if(e.CrFilter>0&&null!=this.CreditAccount){var t=this._CCFields.filter(e=>e.CrFilter>0);let e="";t.forEach(t=>{t instanceof c.b&&t.SelectedValue>0&&(e="("+t.DBColumnName.replace("dc","")+"="+t.SelectedValue.toString(),1==t.CrFilter&&(e+=" OR "+t.DBColumnName.replace("dc","")+"=1 "),e+=")")}),this.CreditAccount.Code.CustomWhere=null==this.CreditAccount.Code.InitCustomWhere||""==this.CreditAccount.Code.InitCustomWhere?e:this.CreditAccount.Code.InitCustomWhere+" and "+e,this.CreditAccount.Name.CustomWhere=null==this.CreditAccount.Name.InitCustomWhere||""==this.CreditAccount.Name.InitCustomWhere?e:this.CreditAccount.Code.InitCustomWhere+" and "+e}if(e.DbFilter>0&&null!=this.DebitAccount){var s=this._CCFields.filter(e=>e.DbFilter>0);let e="";s.forEach(t=>{e="("+t.DBColumnName.replace("dc","")+"="+t.SelectedValue.toString(),1==t.DbFilter&&(e+=" OR "+t.DBColumnName.replace("dc","")+"=1 "),e+=")"}),this.DebitAccount.Code.CustomWhere=null==this.DebitAccount.Code.InitCustomWhere||""==this.DebitAccount.Code.InitCustomWhere?e:this.DebitAccount.Code.InitCustomWhere+" and "+e,this.DebitAccount.Name.CustomWhere=null==this.DebitAccount.Name.InitCustomWhere||""==this.DebitAccount.Name.InitCustomWhere?e:this.DebitAccount.Code.InitCustomWhere+" and "+e}}}FillCustomwhere(e){this._CCFields.filter(t=>null!=t.DependantOn&&t.DependantOn.toLowerCase()==e.DBColumnName.toLowerCase()).forEach(t=>{if(t instanceof D.a){if(0==e.SelectedValue)return void(t.Code.CustomWhere=t.Name.CustomWhere="");let s="";t.CCID>5e4?t.Dependantinuse?(s="("+e.DBColumnName.replace("dc","")+"="+e.SelectedValue.toString(),1==t.Dependancy&&(s+=" OR "+e.DBColumnName.replace("dc","")+"=1 "),s+=")"):s=5==t.Dependancy?"  JOIN "+this.GetTableName(t.CCID)+" CMJ ON a.lft between  CMJ.lft and CMJ.rgt JOIN COM_CostCenterCostCenterMap CM on CM.CostCenterID="+t.CCID+" and CM.ParentCostCenterID="+e.CCID+" and CM.ParentNodeID="+e.SelectedValue.toString()+" and CMJ.NodeID=CM.NodeID ":"  JOIN COM_CostCenterCostCenterMap CM on CM.ParentCostCenterID="+t.CCID+" and a.NodeID=CM.ParentNodeID \n                                            JOIN "+this.GetTableName(e.CCID)+" CMJ ON CM.CostCenterID= "+e.CCID+"   and CM.NodeID=CMJ.NodeID \n                                            JOIN "+this.GetTableName(e.CCID)+" CMJG ON CMJG.lft between  CMJ.lft and CMJ.rgt and CMJG.NodeID="+e.SelectedValue:65==t.CCID&&(s="(FeatureID="+e.CCID+" and  FeaturePK="+e.SelectedValue.toString()+")"),t.Code.CustomWhere=t.Name.CustomWhere=s}else if(t instanceof c.b){if(0==e.SelectedValue)return void(t.CustomWhere="");let s="";t.CCID>5e4?a.e.IsEmpty(t.ToolTipTitle)||2!=e.CCID?t.Dependantinuse?(s="("+e.DBColumnName.replace("dc","")+"="+e.SelectedValue.toString(),1==t.Dependancy&&(s+=" OR "+e.DBColumnName.replace("dc","")+"=1 "),s+=")"):s=5==t.Dependancy?"  JOIN "+this.GetTableName(t.CCID)+" CMJ ON a.lft between  CMJ.lft and CMJ.rgt JOIN COM_CostCenterCostCenterMap CM on CM.CostCenterID="+t.CCID+" and CM.ParentCostCenterID="+e.CCID+" and CM.ParentNodeID="+e.SelectedValue.toString()+" and CMJ.NodeID=CM.NodeID ":"  JOIN COM_CostCenterCostCenterMap CM on CM.ParentCostCenterID="+t.CCID+" and a.NodeID=CM.ParentNodeID \n                                JOIN "+this.GetTableName(e.CCID)+" CMJ ON CM.CostCenterID= "+e.CCID+"  and CM.NodeID=CMJ.NodeID \n                                JOIN "+this.GetTableName(e.CCID)+" CMJG ON CMJG.lft between  CMJ.lft and CMJ.rgt and CMJG.NodeID="+e.SelectedValue:s=t.ToolTipTitle+"="+e.SelectedValue.toString():65==t.CCID&&(s="(FeatureID="+e.CCID+" and  FeaturePK="+e.SelectedValue.toString()+")"),t.CustomWhere=s}})}Clear(e,t){try{this.AttachDetach(!1),Logger.InfoLog("VoucherGenerator:: Inside Clear"),this.guid="",this._StaticFields.forEach(e=>{this.SetProperty_DefaultValue(e,!0)}),this._TextFields.forEach(e=>{this.SetProperty_DefaultValue(e,!0)}),this._numericFields.forEach(e=>{this.SetProperty_DefaultValue(e,!0)});for(let e=0;e<this._CCFields.length;e++){let s=this._CCFields[e];(38==this.DocumentType||39==this.DocumentType)&&n.a.SessionManager.Preferences.ContainsKey("EPOS")&&""!=n.a.SessionManager.Preferences.EPOS.toString()&&parseInt(n.a.SessionManager.Preferences.EPOS)>5e4&&s instanceof c.b&&s.CCID==parseInt(n.a.SessionManager.Preferences.EPOS)||5==t&&s instanceof c.b&&this.Data.Tables.length>0&&this.Data.Tables[8].filter(e=>e.CCID==s.CCID.toString()).length>0||(this.SetProperty_DefaultValue(s,!0),s instanceof c.b?this.FilterTo(s):s instanceof D.a&&this.FilterToCodeName(s),!(s instanceof c.b&&50001==s.CCID&&this.DivisionID!=s.SelectedValue&&n.a.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&"True"==n.a.SessionManager.Preferences.EnableDivisionWise.toString())||s.DBColumnName.Contains("TO")||this.Preferences.ContainsKey("Donotusedivision")&&!a.e.IsEmpty(this.Preferences.Donotusedivision)&&Object(S.j)(this.Preferences.Donotusedivision)?!(s instanceof c.b&&50002==s.CCID&&this.LocationID!=s.SelectedValue&&n.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"True"==n.a.SessionManager.Preferences.EnableLocationWise.toString())||s.DBColumnName.Contains("TO")||this.Preferences.ContainsKey("Donotuselocation")&&!a.e.IsEmpty(this.Preferences.Donotuselocation)&&Object(S.j)(this.Preferences.Donotuselocation)||(this.LocationID=s.SelectedValue):this.DivisionID=s.SelectedValue)}if(38==this.DocumentType||39==this.DocumentType)(s=this.HeaderFields.find(e=>e instanceof l.a&&"docdate"==e.DBColumnName.toLowerCase()))&&""!=s.DefaultValue&&(e.value=new Date(s.DefaultValue),this.ovDate.Date=e.value,this.ovDate.Text=e.value.ToString(n.a.SessionManager.Preferences["Date Format"]));else if(e.value&&(1==t||5==t||2==t&&n.a.SessionManager.Preferences.ContainsKey("ChangeVoucherDate")&&Object(S.j)(n.a.SessionManager.Preferences.ChangeVoucherDate)||3==t&&this.DocPrefix.Prefixes.length<2)){var s;(s=this.HeaderFields.find(e=>e instanceof l.a&&"docdate"==e.DBColumnName.toLowerCase()))&&""!=s.DefaultValue&&a.e.isValidDate(s.DefaultValue)?(e.value=new Date(s.DefaultValue),this.ovDate.Date=e.value):(e.value=Date.Today(),this.ovDate.Date=e.value)}if(null!=this.BillNo&&(this.BillNo.Text=""),this.dtHistory=null,this.VoucherNo="",null!=this.DebitAccount&&this.SetProperty_DefaultValue(this.DebitAccount,!0),null!=this.CreditAccount&&this.SetProperty_DefaultValue(this.CreditAccount,!0),this.GridData.Clear(),this.ColumnSource.forEach(e=>{4==e.SectionID?(e.CreditAcount=e.DefCreditAcount,e.DebitAccount=e.DefDebitAccount,e.Remarks=""):a.e.IsEmpty(e.LocalRefDefaultValue)||(e.LocalRefDefaultValue="",e.LocalRefDefaultValueText=""),e.footer="",e.distDim>0&&!a.e.IsEmpty(e.distxml)&&(e.distxml="")}),null!=this.DocPrefix&&this.DocPrefix.RevisionCombo.Visible&&(this.DocPrefix.RevisionCombo.Items.Clear(),this.DocPrefix.RevisionCombo.Items.push(u.d.ComboBoxItems_2("","0")),this.DocPrefix.RevisionCombo.SelectedValue="0"),null!=this.DueDate&&(this.DueDate.Date=null),this.IsInventory)if(this.Preferences.ContainsKey("Dynamic Footer")&&null!=this.Preferences["Dynamic Footer"]&&"TRUE"==this.Preferences["Dynamic Footer"].toString().toUpperCase()){if(null!=this.FooterGridData&&this.FooterGridDataColumns.length>0){this.FooterGridData.Clear();for(let e=0;e<5;e++){let t=this.FooterGridDataObj.NewRow();t.Sno=e+1,this.FooterGridDataObj.addRow(t)}}}else for(let e=0;e<this.FooterGridData.length;e++){var i;this.FooterGridData[e].Amount=null,this.FooterGridData[e].CalcAmount=null,this.FooterGridData[e].Remarks=null,this.FooterGridDataColumns.Contains("DebitAccount")&&((i=this.ColumnSource.find(t=>!a.e.IsEmpty(t.DisplayMember)&&t.DisplayMember.toLowerCase()==a.e.String(this.FooterGridData[e].Columnname).toLowerCase()))&&i.DebitAccount>0?(this.FooterGridData[e].DebitAccount.toString()!=i.DebitAccount.toString()&&(this.FooterGridData[e].DebitAccount=i.DebitAccount),this.FooterGridData[e].DebitAccountName=null):(this.FooterGridData[e].DebitAccount=null,this.FooterGridData[e].DebitAccountName=null)),this.FooterGridDataColumns.Contains("CreditAccount")&&(null!=(i=this.ColumnSource.find(t=>!a.e.IsEmpty(t.DisplayMember)&&t.DisplayMember.toLowerCase()==a.e.String(this.FooterGridData[e].Columnname).toLowerCase()))&&i.DebitAccount>0?(this.FooterGridData[e].CreditAccount.toString()!=i.CreditAcount.toString()&&(this.FooterGridData[e].CreditAccount=i.CreditAcount),this.FooterGridData[e].CreditAccountName=null):(this.FooterGridData[e].CreditAccount=null,this.FooterGridData[e].CreditAccountName=null)),this.FooterGridDataObj.updateRow(this.FooterGridData[e])}if(this.GridDataColumns.length>0&&(this.GridDataColumns.Contains("FieldType")&&this.FillDafaultTypes(),this.UpdateSequence()),this.PostVoucherDocID=0,this.PostVoucherCreditAccount=0,this.PostVoucherDebitAccount=0,this.PostVoucherAmount=0,this.PostVoucherDocDetailsID=0,this.PostVouceherDocPrefix="",this.PostVoucherDocnumber="",this.DistributeCostXML="",this.IsRefLCTR=!1,this.DocID=0,this.guid="",this.Preferences.ContainsKey("Debit Account")&&Object(S.j)(this.Preferences["Debit Account"])&&null!=this.DebitAccount&&!this.DebitAccount.Enable&&(this.DebitAccount.Enable=!0),this.Preferences.ContainsKey("Credit Account")&&Object(S.j)(this.Preferences["Credit Account"])&&null!=this.CreditAccount&&!this.CreditAccount.Enable&&(this.CreditAccount.Enable=!0),this.Preferences.ContainsKey("DimensionWise")&&""!=this.Preferences.DimensionWise){let e=this.Preferences.DimensionWise.split(",");for(let t=0;t<e.length;t++)!a.e.IsEmpty(e[t])&&this.Data.Tables[8].filter(s=>s.CCID==e[t]).length>0&&(e[t]="0");this._CCFields.forEach(t=>{(t instanceof c.b&&e.Contains(t.CCID.toString())&&0==this.Data.Tables[8].filter(e=>e.CCID==t.CCID.toString()).length||t instanceof D.a&&e.Contains(t.CCID.toString())&&0==this.Data.Tables[8].filter(e=>e.CCID==t.CCID.toString()).length)&&(t.Enable=!0)})}if(this.SetDefaultValuesforCostCenters(1),this.Link){this.Link.LinkCombo.SelectedValue="",this.Link.DocumentList.Items.Clear();var o=this.Link.LinkCombo.Items.find(e=>1==e.Status);o&&(this.Link.LinkCombo.SelectedValue=o.Value)}this.GridDataObj.refreshDatawithIDs(),62==this.oParent.DocumentType&&this.oParent.ClearLeaveData()}catch(r){Logger.ErrorLog("VoucherGenerator","LoadEditData",r.stack)}finally{this.AttachDetach(!0)}}GetCopyLinkDetails(e,t){let s=[];return s.push(e),s.push(t),s.push(n.a.SessionManager.UserID),s.push(n.a.SessionManager.LanguageID),n.a.document.GetCopyLinkDetails(s)}GetDetailsByDocno(e){Logger.InfoLog("VoucherGenerator:: Inside GetDetailsByDocno");try{let t=[];return t.push(e),t.push(n.a.SessionManager.UserID),t.push(n.a.SessionManager.LanguageID),n.a.document.GetDetailsByDocno(t)}catch(t){return Logger.ErrorLog("VoucherGenerator:: GetDetailsByDocno"+t.stack),null}}GetFiles(e,t,s=""){return n.a.common.GetDataSet3("DOC002",e.toString(),t.toString(),s)}GetProjectByINVID(e,t){let s=0,a=n.a.common.GetDataSet3("DOC025",t,e);return null!=a&&a.Tables.length>0&&a.Tables[0].length>0&&(s=parseInt(a.Tables[0][0].id)),s}IsBinWise(e,t){let s="";Logger.InfoLog("VoucherGenerator:: Inside GetFiles");try{let i=n.a.common.GetDataSet3("DOC010",e.toString(),t.toString());null!=i&&i.Tables.length>0&&i.Tables[0].length>0&&(s=a.e.String(i.Tables[0][0][i.Columns[0][0]]).toLowerCase())}catch(i){Logger.ErrorLog("VoucherGenerator:: GetFiles"+i.stack)}return"no"!=s&&"0"!=s&&"false"!=s}GetScreenInfo(e){Logger.InfoLog("VoucherGenerator:: Inside GetScreenInfo");try{let t="",s="";return n.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"True"==n.a.SessionManager.Preferences.EnableLocationWise.toString()&&(this.LocationID>0?t=this.LocationID.toString():n.a.SessionManager.LocationID>0&&(t=n.a.SessionManager.LocationID.toString())),n.a.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&"True"==n.a.SessionManager.Preferences.EnableDivisionWise.toString()&&(this.DivisionID>0?s=this.DivisionID.toString():n.a.SessionManager.DivisionID>0&&(s=n.a.SessionManager.DivisionID.toString())),n.a.document.GetDocumentDefinition(e,t,s)}catch(t){return Logger.ErrorLog("VoucherGenerator:: GetScreenInfo"+t.stack),null}}FillDocumentPrefix(e){if(e){for(let e=0;e<this.DocPrefix.ComboBox.Items.length;e++)this.DocPrefix.ComboBox.Items[e].Value!=this.DocPrefix.ComboBox.SelectedValue&&(this.DocPrefix.ComboBox.Items.Remove(this.DocPrefix.ComboBox.Items[e]),e--);return}Logger.InfoLog("VoucherGenerator:: Inside GetDocumentPrefix");let t=[];t.push(this.CostCenterID),n.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"True"==n.a.SessionManager.Preferences.EnableLocationWise.toString()?t.push(this.LocationID>0?this.LocationID:n.a.SessionManager.LocationID>0?n.a.SessionManager.LocationID:""):t.push(""),n.a.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&"True"==n.a.SessionManager.Preferences.EnableDivisionWise.toString()?t.push(this.DivisionID>0?this.DivisionID:n.a.SessionManager.DivisionID>0?n.a.SessionManager.DivisionID:""):t.push(""),t.push(n.a.SessionManager.UserID),t.push(n.a.SessionManager.RoleID),t.push(n.a.SessionManager.LanguageID);let s=n.a.document.GetDocumentPrefix(t);this.LocationChanged(),this.DivisionChanged(),this.DocPrefix.ComboBox.Items.Clear(),e&&this.DocPrefix.Prefixes.Clear(),null!=s&&s.Tables.length>0&&!s.Tables.Contains("ErrorMessage")&&(s.Tables[0].forEach(e=>{this.DocPrefix.ComboBox.Items.push(u.d.ComboBoxItems_4(e.CodePrefix.toString(),e.CodePrefix.toString(),"",e.CodeNumberLength.toString()))}),!e&&this.DocPrefix.ComboBox.Items.length>0&&(this.DocPrefix.ComboBox.SelectedItem=this.DocPrefix.ComboBox.Items[0],this.DocPrefix.ComboBox.SelectedValue=this.Data.Tables[0][0][Object.keys(this.Data.Tables[0][0])[0]].toString())),Logger.InfoLog("VoucherGenerator::Exiting GetDocumentPrefix")}GenerateFooter(){let e=this.Data.Tables[7].filter(e=>"Dynamic Footer"==e.PrefName),t=this.Data.Tables[0].filter(e=>4==e.SectionID);t.sort((e,t)=>e.SectionSeqNumber-t.SectionSeqNumber);let s,i,o=new d.a;o.Header="#",o.DisplayMember="Sno",o.DataType="TextBlock",o.ReadOnly=!0,o.Width=25,o.DisableTab=!0,this.FooterColumnSource.push(o),this.FooterGridDataColumns.push("Sno"),this.FooterGridDataColumns.push("Name"),this.FooterGridDataColumns.push("ColumnName"),this.FooterGridDataColumns.push("Amount"),this.FooterGridDataObj.DataTypes.Double.push("Amount"),this.FooterGridDataColumns.push("CalcAmount"),this.FooterGridDataObj.DataTypes.Double.push("CalcAmount"),this.FooterGridDataColumns.push("DebitAccount"),this.FooterGridDataObj.DataTypes.Int.push("DebitAccount"),this.FooterGridDataColumns.push("CreditAccount"),this.FooterGridDataObj.DataTypes.Int.push("CreditAccount"),this.FooterGridDataColumns.push("DebitAccountName"),this.FooterGridDataColumns.push("CreditAccountName"),this.FooterGridDataColumns.push("PostingType"),this.FooterGridDataColumns.push("Formula"),this.FooterGridDataColumns.push("dcCurrID"),this.FooterGridDataColumns.push("dcCurrID_Key"),this.FooterGridDataColumns.push("dcExchRT"),this.FooterGridDataColumns.push("IsCalculated"),this.FooterGridDataColumns.push("DrRefSection"),this.FooterGridDataColumns.push("DrRefID"),this.FooterGridDataColumns.push("DrRefColID"),this.FooterGridDataColumns.push("DrRefColName"),this.FooterGridDataColumns.push("CrRefSection"),this.FooterGridDataColumns.push("CrRefID"),this.FooterGridDataColumns.push("CrRefColID"),this.FooterGridDataColumns.push("CrRefColName"),this.FooterGridDataColumns.push("Message"),this.FooterGridDataColumns.push("Action"),this.FooterGridDataColumns.push("Expression"),this.FooterGridDataColumns.push("ReadOnly"),this.FooterGridDataObj.DataTypes.Bool.push("ReadOnly"),this.FooterGridDataColumns.push("IsVisible"),this.FooterGridDataObj.DataTypes.Bool.push("IsVisible"),this.FooterGridDataColumns.push("Remarks"),this.FooterGridDataColumns.push("StyleHeightZero"),this.FooterGridDataColumns.push("BasedOnXML"),this.FooterGridDataColumns.push("Decimals"),this.FooterDataBindColumns.push("Name"),this.FooterDataBindColumns.push("ColumnName"),this.FooterDataBindColumns.push("Currency"),this.FooterDataBindColumns.push("CurrencyName"),this.FooterDataBindColumns.push("Exchange"),this.FooterDataBindColumns.push("PostingType"),this.FooterDataBindColumns.push("IsCalculated"),this.FooterDataBindColumns.push("Formula"),this.FooterDataBindColumns.push("DebitAccount"),this.FooterDataBindColumns.push("CreditAccount"),this.FooterDataBindColumns.push("DebitAccountName"),this.FooterDataBindColumns.push("CreditAccountName"),this.FooterDataBindColumns.push("Decimals"),this.FooterDataBindColumns.push("DrRefSection"),this.FooterDataBindColumns.push("DrRefID"),this.FooterDataBindColumns.push("DrRefColID"),this.FooterDataBindColumns.push("DrRefColName"),this.FooterDataBindColumns.push("CrRefSection"),this.FooterDataBindColumns.push("CrRefID"),this.FooterDataBindColumns.push("CrRefColID"),this.FooterDataBindColumns.push("CrRefColName"),this.FooterDataBindColumns.push("Message"),this.FooterDataBindColumns.push("Action"),this.FooterDataBindColumns.push("Expression"),this.FooterDataBindColumns.push("ReadOnly"),this.FooterDataBindColumns.push("IsVisible"),this.FooterDataBindColumns.push("BasedOnXML"),o=new d.a,o.Header=n.a.GetResource("Document_footer_Name"),o.DisplayMember="Name",o.DataType="ComboBox",e.length>0&&Object(S.j)(e[0].PrefValue)?o.ReadOnly=!1:(o.ReadOnly=!0,o.DisableTab=!0),o.DisplayMember="Name",o.ValueMember="ColumnName",o.ValueBinding="ColumnName",o.ComboData=this.FooterDataBind,o.Width=200,this.FooterColumnSource.push(o),o=new d.a,o.Header="ColumnName",o.DisplayMember="ColumnName",o.DataType="TextBlock",o.ReadOnly=!0,o.Width=0,o.IsVisible=!1,o.DisableTab=!0,this.FooterColumnSource.push(o),o=new d.a,o.Header="Debit Account",o.DisplayMember="DebitAccountName",o.ValueMember="DebitAccount",o.DataType="LISTBOX",o.CostCenterID=2,o.TypeID=2,o.Width=200,o.IsVisible=!1,o.DisableTab=!0,o.ID="-100",this.FooterColumnSource.push(o),o=new d.a,o.Header="Credit Account",o.DisplayMember="CreditAccountName",o.ValueMember="CreditAccount",o.DataType="LISTBOX",o.CostCenterID=2,o.TypeID=2,o.Width=200,o.IsVisible=!1,o.DisableTab=!0,o.ID="-200",this.FooterColumnSource.push(o),o=new d.a,o.Header=n.a.GetResource("Document_footer_amount"),o.DisplayMember="Amount",o.DataType="FLOAT",o.ReadOnly=!1,o.Width=100,n.a.SessionManager.Preferences.ContainsKey("DecimalsinFooter")&&""!=n.a.SessionManager.Preferences.DecimalsinFooter&&(o.DecimalPoints=n.a.SessionManager.Preferences.DecimalsinFooter),this.FooterColumnSource.push(o),o=new d.a,o.Header=n.a.GetResource("Document_footer_CalcAmount"),o.DisplayMember="CalcAmount",o.DataType="FLOAT",o.ReadOnly=!1,o.Width=120,n.a.SessionManager.Preferences.ContainsKey("DecimalsinFooter")&&""!=n.a.SessionManager.Preferences.DecimalsinFooter&&(o.DecimalPoints=n.a.SessionManager.Preferences.DecimalsinFooter),this.FooterColumnSource.push(o),o=new d.a,o.Header=n.a.GetResource("Document_footer_Remarks"),o.DisplayMember="Remarks",o.DataType="TextBlock",o.Width=120,o.ID="-4",38!=this.DocumentType&&39!=this.DocumentType||(o.IsVisible=!1),this.FooterColumnSource.push(o);let r=1,l=0;for(let u=0;u<t.length;u++){if(t[u].SysColumnName.toString().toLowerCase().Contains("dcexchrt")||t[u].SysColumnName.toString().toLowerCase().Contains("dccurrid"))continue;if(38==this.DocumentType&&"26425"==t[u].LinkData.toString())continue;!a.e.IsEmpty(t[u].Decimal)&&parseFloat(t[u].Decimal)>0&&l<parseFloat(t[u].Decimal)&&(l=parseFloat(t[u].Decimal)),i={},s=this.FooterGridDataObj.NewRow(),s.Sno=r++,s.Name=t[u].ResourceData,s.ColumnName=t[u].SysColumnName,i.Name=t[u].ResourceData,i.ColumnName=t[u].SysColumnName,s.BasedOnXml=t[u].BasedOnXml,i.BasedOnXml=t[u].BasedOnXml,!a.e.IsEmpty(t[u].Decimal)&&parseFloat(t[u].Decimal)>=0?(s.Decimals=t[u].Decimal,i.Decimals=t[u].Decimal):n.a.SessionManager.Preferences.ContainsKey("DecimalsinFooter")&&""!=n.a.SessionManager.Preferences.DecimalsinFooter&&(s.Decimals=n.a.SessionManager.Preferences.DecimalsinFooter,i.Decimals=n.a.SessionManager.Preferences.DecimalsinFooter),a.e.IsEmpty(t[u].IsEditable)?(i.ReadOnly=!0,s.ReadOnly=!0):(i.ReadOnly=!Object(S.j)(t[u].IsEditable),s.ReadOnly=!Object(S.j)(t[u].IsEditable)),a.e.IsEmpty(t[u].IsVisible)?(i.IsVisible=!0,s.IsVisible=!0):(i.IsVisible=Object(S.j)(t[u].IsVisible),s.IsVisible=Object(S.j)(t[u].IsVisible),this.FooterGridDataColumns.Contains("StyleHeightZero")&&(s.StyleHeightZero=Object(S.j)(s.IsVisible)?0:1)),a.e.IsEmpty(t[u].PostingType)||(s.PostingType=parseInt(t[u].PostingType),i.PostingType=parseInt(t[u].PostingType)),a.e.IsEmpty(t[u].IsCalculate)||(s.IsCalculated=t[u].IsCalculate.toString(),i.IsCalculated=t[u].IsCalculate.toString()),a.e.IsEmpty(t[u].CRSysColumnName)||(s.CrRefColName=t[u].CRSysColumnName.toString(),i.CrRefColName=t[u].CRSysColumnName.toString()),a.e.IsEmpty(t[u].CrRefColID)||(s.CrRefColID=parseInt(t[u].CrRefColID),i.CrRefColID=parseInt(t[u].CrRefColID)),a.e.IsEmpty(t[u].CrRefID)||(s.CrRefID=parseInt(t[u].CrRefID),i.CrRefID=parseInt(t[u].CrRefID)),a.e.IsEmpty(t[u].CRSection)||(s.CrRefSection=parseInt(t[u].CRSection),i.CrRefSection=parseInt(t[u].CRSection)),a.e.IsEmpty(t[u].DRSysColumnName)||(s.DrRefColName=t[u].DRSysColumnName.toString(),i.DrRefColName=t[u].DRSysColumnName.toString()),a.e.IsEmpty(t[u].DrRefColID)||(s.DrRefColID=parseInt(t[u].DrRefColID),i.DrRefColID=parseInt(t[u].DrRefColID)),a.e.IsEmpty(t[u].DrRefID)||(s.DrRefID=parseInt(t[u].DrRefID),i.DrRefID=parseInt(t[u].DrRefID)),a.e.IsEmpty(t[u].DrSection)||(s.DrRefSection=parseInt(t[u].DrSection),i.DrRefSection=parseInt(t[u].DrSection)),a.e.IsEmpty(t[u].DebitAccount)||(s.DebitAccount=parseInt(t[u].DebitAccount),s.DebitAccountName=a.e.StringValue(t[u].DebitAccountName),i.DebitAccount=parseInt(t[u].DebitAccount),i.DebitAccountName=a.e.StringValue(t[u].DebitAccountName)),a.e.IsEmpty(t[u].CreditAccount)||(s.CreditAccount=parseInt(t[u].CreditAccount),s.CreditAccountName=a.e.StringValue(t[u].CreditAccountName),i.CreditAccount=parseInt(t[u].CreditAccount),i.CreditAccountName=a.e.StringValue(t[u].CreditAccountName)),a.e.IsEmpty(t[u].Formula)||(s.Formula=t[u].Formula.toString(),i.Formula=t[u].Formula.toString()),!a.e.IsNullOrWhiteSpace(t[u].IsCrAccountDisplayed)&&Object(S.j)(t[u].IsCrAccountDisplayed)&&(this.FooterColumnSource[4].IsVisible=!0,this.FooterColumnSource[4].DisableTab=!1),!a.e.IsNullOrWhiteSpace(t[u].IsDrAccountDisplayed)&&Object(S.j)(t[u].IsDrAccountDisplayed)&&(this.FooterColumnSource[3].IsVisible=!0,this.FooterColumnSource[3].DisableTab=!1);let e=this.Data.Tables[0].filter(e=>4==e.SectionID&&e.SysColumnName=="dcCurrID"+t[u].SysColumnName.toString().toLowerCase().replace("dcnum",""));if(e.length>0&&(s.dcCurrID_Key=e[0].UserDefaultValue,i.Currency=e[0].UserDefaultValue,!a.e.IsEmpty(e[0].UserDefaultValue)&&this.Data.Tables.length>17&&this.Data.Tables[17].length>0&&this.Data.Columns[17].Contains("ccid"))){let t=this.Data.Tables[17].filter(t=>t.ccid=t.NodeID==e[0].UserDefaultValue.toString());t.length>0&&(i.CurrencyName=t[0].Name.toString(),s.dcCurrID=t[0].Name.toString(),i.Currency=-3,s.dcCurrID_Key=-3)}this.Preferences.ContainsKey("Dynamic Footer")&&null!=this.Preferences["Dynamic Footer"]&&!Object(S.j)(this.Preferences["Dynamic Footer"])&&this.FooterGridData.push(s),this.FooterDataBind.push(i)}if(l>0&&(this.FooterColumnSource[5].DecimalPoints=l.toString(),this.FooterColumnSource[6].DecimalPoints=l.toString()),this.FooterColumnSource[1].ComboData=this.FooterDataBind,0==this.FooterGridData.length&&!n.a.IsMobile){let e,t=1;for(let s=0;s<this.FooterColumnSource[1].ComboData.length;s++)e=this.FooterGridDataObj.NewRow(),e.Sno=t++,this.FooterGridData.push(e)}n.a.SessionManager.Preferences.ContainsKey("Use Foreign Currency")&&Object(S.j)(n.a.SessionManager.Preferences["Use Foreign Currency"])&&(o=new d.a,o.Header="Currency",o.DisplayMember="dcCurrID",o.ValueMember="dcCurrID_Key",o.DataType="LISTBOX",o.CostCenterID=12,o.TypeID=1,o.Width=100,o.ID="-300",38!=this.DocumentType&&39!=this.DocumentType||(o.IsVisible=!1),this.FooterColumnSource.push(o),o=new d.a,o.Header="Exchange Rate",o.DisplayMember="dcExchRT",o.DataType="FLOAT",o.Width=100,o.ID="-5",o.DisableTab=!1,38!=this.DocumentType&&39!=this.DocumentType||(o.IsVisible=!1),this.FooterColumnSource.push(o))}GenerateBody(){let e=this.Data.Tables[0].filter(e=>3==e.SectionID||4==e.SectionID);e.sort((e,t)=>e.SectionSeqNumber-t.SectionSeqNumber);let t=0,s=new d.a;s.Header="#",s.DisplayMember="DocSeqNo",s.lbl="DocSeqNo",s.DataType="TextBlock",s.ReadOnly=!0,38!=this.DocumentType&&39!=this.DocumentType||!this.Preferences.ContainsKey("DisplaySno")||Object(S.j)(this.Preferences.DisplaySno)||(s.IsVisible=!1),s.Width=45,t+=s.Width,s.ID="0",this.Preferences.ContainsKey("BodyFreezeColumn")&&""!=this.Preferences.BodyFreezeColumn&&a.e.IsNum(this.Preferences.BodyFreezeColumn)&&(s.IsFrozen=!0),s.DisableTab=!0,this.ColumnSource.push(s),this.GridDataColumns.push("DocSeqNo"),s=new d.a,s.Header="DocDetailsID",s.DisplayMember="DocDetailsID",s.lbl="DocDetailsID",s.DataType="TextBlock",s.ReadOnly=!0,s.Width=0,s.DisableTab=!0,s.IsVisible=!1,this.ColumnSource.push(s),s.ID="0",this.GridDataColumns.push("DocDetailsID"),s=new d.a,s.Header="LinkedInvDocDetailsID",s.lbl="LinkedInvDocDetailsID",s.DisplayMember="LinkedInvDocDetailsID",s.DataType="TextBlock",s.ReadOnly=!0,s.Width=0,s.DisableTab=!0,s.IsVisible=!1,this.ColumnSource.push(s),s.ID="0",this.GridDataColumns.push("LinkedInvDocDetailsID"),this.GridDataObj.DataTypes.Int.push("LinkedInvDocDetailsID"),s=new d.a,s.Header="LinkedFieldName",s.DisplayMember="LinkedFieldName",s.lbl="LinkedFieldName",s.DataType="TextBlock",s.ReadOnly=!0,s.Width=0,s.DisableTab=!0,s.IsVisible=!1,this.ColumnSource.push(s),s.ID="0",this.GridDataColumns.push("LinkedFieldName"),100==this.DocumentType&&(s=new d.a,s.Header="Edit",s.DisplayMember="drEdit",s.ReadOnly=!0,s.DataType="LINK",s.TextAlign="Center",s.ValueBinding="fa-light fa-pen-to-square",s.IsFrozen=!0,s.Width=50,this.ColumnSource.push(s),s.ID="drEdit",s=new d.a,s.Header="Delete",s.DisplayMember="drDelete",s.ReadOnly=!0,s.DataType="LINK",s.TextAlign="Center",s.ValueBinding="fa-light fa-trash-can",s.IsFrozen=!0,s.Width=50,this.ColumnSource.push(s),s.ID="drDelete"),this.Preferences.ContainsKey("UseasPosReciept")&&"True"==this.Preferences.UseasPosReciept&&this.GridDataColumns.push("FieldType");let i=e.find(e=>"RefNO"==e.SysColumnName);i&&(i.SysColumnName="RefNo",i.UserColumnName="RefNo");for(let l=0;l<e.length;l++){let i=e[l];if(!("HoldQuantity"!=i.SysColumnName||this.Preferences.ContainsKey("Enable Hold")&&Object(S.j)(this.Preferences["Enable Hold"])))continue;if(!("ReserveQuantity"!=i.SysColumnName||this.Preferences.ContainsKey("Enable Reserve")&&Object(S.j)(this.Preferences["Enable Reserve"])))continue;if(!("RecievedQty"!=i.SysColumnName||this.Preferences.ContainsKey("SeparateColRecieptIssue")&&""!=this.Preferences.SeparateColRecieptIssue&&Object(S.j)(this.Preferences.SeparateColRecieptIssue)))continue;if(38==this.DocumentType&&null!=i.LinkData&&"26425"==i.LinkData.toString())continue;if(s=new d.a,s.ID=i.CostCenterColID.toString(),this.Preferences.ContainsKey("BodyFreezeColumn")&&""!=this.Preferences.BodyFreezeColumn&&a.e.IsNum(this.Preferences.BodyFreezeColumn)&&this.Preferences.BodyFreezeColumn==s.ID&&(s.IsFrozen=!0),(i.SysColumnName.toLowerCase().Contains("dccurrid")||i.SysColumnName.toLowerCase().Contains("dcexchrt"))&&(!a.e.IsEmpty(i.UserDefaultValue)&&"-2"!=i.UserDefaultValue.toString()||!a.e.IsEmpty(i.SectionID)&&4==parseInt(i.SectionID)))continue;s.Header=i.SysColumnName.toLowerCase().Contains("dcexchrt")?i.ResourceData.toString()+"-ExchRT":i.SysColumnName.toLowerCase().Contains("dccurrid")?i.ResourceData.toString()+"-Curr":a.e.StringValue(i.ResourceData).toString(),s.lbl=i.UserColumnName.toString(),s.DisplayMember=i.SysColumnName,a.e.IsEmpty(i.Mode)||(s.Mode=parseInt(i.Mode)),s.SPName=Object(g.isNullOrUndefined)(i.SpName)?"":i.SpName.toString(),s.Shortcut=Object(g.isNullOrUndefined)(i.Shortcut)?"":i.Shortcut.toString(),s.IPParams=Object(g.isNullOrUndefined)(i.IpParams)?"":i.IpParams.toString(),s.OPParams=Object(g.isNullOrUndefined)(i.OpParams)?"":i.OpParams.toString(),Object(g.isNullOrUndefined)(i.Expression)||(s.ExternExpression=i.Expression.toString()),a.e.IsEmpty(i.LinkData)||(s.linkData=parseInt(i.LinkData)),s.DataType=i.ColumnDataType.toString(),s.Width=Object(g.isNullOrUndefined)(i.UIWidth)?0:parseInt(i.UIWidth),t+=s.Width,i.IsMandatory&&(s.Mandatory=Object(S.j)(i.IsMandatory)),a.e.IsEmpty(i.Formula)||(s.Formula=i.Formula.toString(),s.Formula.toLowerCase().Contains("avgrate")&&(this.AvgrateExists=!0)),a.e.IsEmpty(i.IsEditable)||(s.ReadOnly=!Object(S.j)(i.IsEditable)),Object(g.isNullOrUndefined)(i.RoundOffLineWise)||"1"!=i.RoundOffLineWise.toString()||(s.NoRoundOff=!0),a.e.IsEmpty(i.IsRepeat)||(s.IsRepeat=Object(S.j)(i.IsRepeat)),a.e.IsEmpty(i.ShowinCalc)||(s.ShowinCalc=Object(S.j)(i.ShowinCalc)),a.e.IsEmpty(i.IsReEvaluate)||(s.IsReEvaluate=Object(S.j)(i.IsReEvaluate)),a.e.IsEmpty(i.IsnoTab)||(s.DisableTab=Object(S.j)(i.IsnoTab)),a.e.IsEmpty(i.isnotab)||(s.DisableTab=Object(S.j)(i.isnotab)),a.e.IsEmpty(i.IsPartialLinking)||(s.IsPartialLinking=Object(S.j)(i.IsPartialLinking)),a.e.IsEmpty(i.SectionID)||(s.SectionID=parseInt(i.SectionID)),s.IsVisible=3==s.SectionID&&!a.e.IsEmpty(i.IsVisible)&&Object(S.j)(i.IsVisible),a.e.IsEmpty(i.DistCol)||(s.DistributeColName=i.DistCol),a.e.IsEmpty(i.DistributionColID)||(s.DistributionColID=parseInt(i.DistributionColID));let r=this.Data.Tables[0].filter(e=>null!=e.LocalReference&&79==e.LocalReference&&50040==e.LinkData);if(r.length>0&&i.SysColumnName==r[0].SysColumnName&&(s.IsVisible=!1),r=this.Data.Tables[0].filter(e=>null!=e.LocalReference&&79==e.LocalReference&&55498==e.LinkData),r.length>0&&i.SysColumnName==r[0].SysColumnName&&(s.ReadOnly=!0,s.DistributeColName="FillGUID"),s.IsColumnUserDefined=Object(S.j)(i.IsColumnUserDefined),35!=this.DocumentType&&36!=this.DocumentType&&37!=this.DocumentType||!i.SysColumnName.toLowerCase().Contains("dcalpha")&&!i.SysColumnName.toLowerCase().Contains("dcnum")||(s.IsColumnUserDefined=!0),a.e.IsEmpty(i.PostingType)||(s.PostingType=parseInt(i.PostingType)),a.e.IsEmpty(i.DebitAccount)||(s.DebitAccount=parseInt(i.DebitAccount)),a.e.IsEmpty(i.CreditAccount)||(s.CreditAcount=parseInt(i.CreditAccount)),s.DefCreditAcount=s.CreditAcount,s.DefDebitAccount=s.DebitAccount,a.e.IsEmpty(i.IsCalculate)||(s.IsCalculated=parseInt(i.IsCalculate)),a.e.IsEmpty(i.FixedAcc)||(s.GridViewID=parseInt(i.FixedAcc)),a.e.IsEmpty(i.CRSysColumnName)||(s.CrRefColName=!a.e.IsEmpty(i.CrRefID)&&parseInt(i.CrRefID)<0?"TO"+i.CRSysColumnName:i.CRSysColumnName),a.e.IsEmpty(i.CrRefColID)||(s.CrRefColID=parseInt(i.CrRefColID)),a.e.IsEmpty(i.CrRefID)||(s.CrRefID=parseInt(i.CrRefID)),a.e.IsEmpty(i.CRSection)||(s.CrRefSection=parseInt(i.CRSection)),a.e.IsEmpty(i.DRSysColumnName)||(s.DrRefColName=!a.e.IsEmpty(i.DrRefID)&&parseInt(i.DrRefID)<0?"TO"+i.DRSysColumnName:i.DRSysColumnName),a.e.IsEmpty(i.DrRefColID)||(s.DrRefColID=parseInt(i.DrRefColID)),a.e.IsEmpty(i.DrRefID)||(s.DrRefID=parseInt(i.DrRefID)),a.e.IsEmpty(i.DrSection)||(s.DrRefSection=parseInt(i.DrSection)),!a.e.IsEmpty(i.TextFormat)){let e=0;e=a.e.Int(i.TextFormat),2==e?s.IsAllCaps=!0:3==e&&(s.IsFirstLetterCaps=!0)}if(s.DefaultValue=Object(g.isNullOrUndefined)(i.UserDefaultValue)?"":i.UserDefaultValue.toString(),!a.e.IsEmpty(i.dependanton)&&"0"!=i.dependanton.toString()){let e=null;e=83==parseInt(i.dependanton)||parseInt(i.dependanton)>5e4&&parseInt(i.dependanton)<50100?this.Data.Tables[0].filter(e=>e.ColumnCostCenterID==i.dependanton):this.Data.Tables[0].filter(e=>e.CostCenterColID==i.dependanton),null!=e&&e.length>0?(s.DependantOn=e[0].SysColumnName,a.e.IsEmpty(i.dependancy)||(s.Dependancy=parseInt(i.dependancy)),"productid"!=s.DependantOn.toLowerCase()||a.e.IsNullOrWhiteSpace(i.Productfilterinuse)?a.e.IsEmpty(i.filterinuse)||(s.Dependantinuse=Object(S.j)(i.filterinuse)):s.Dependantinuse=Object(S.j)(i.Productfilterinuse)):5!=this.DocumentType&&8!=this.DocumentType&&13!=this.DocumentType||!this.Preferences.ContainsKey("BudgetFeild")||""==this.Preferences.BudgetFeild||"-94"!=a.e.String(i.dependanton)||(s.DependantOn=i.dependanton.toString())}switch((5==this.DocumentType||this.Preferences.ContainsKey("UseasCrossDimension")&&"true"==this.Preferences.UseasCrossDimension.toLowerCase())&&("gross"==i.SysColumnName.toLowerCase()||i.SysColumnName.toLowerCase().Contains("dcnum"))&&(s.Dependancy=a.e.IsEmpty(i.Posting)?4:parseInt(i.Posting)),!a.e.IsEmpty(s.Formula)&&this.Data.Tables[15].filter(e=>e.CostCenterColIDField==s.ID&&1==e.ClubFields).length>0&&(s.UseBarcode=!0),i.ColumnDataType.toString().toUpperCase()){case"BIGINT":case"INT":this.GridDataColumns.push(i.SysColumnName),this.GridDataObj.DataTypes.Int.push(i.SysColumnName);break;case"FLOAT":if(this.GridDataColumns.push(i.SysColumnName),this.GridDataObj.DataTypes.Double.push(i.SysColumnName),i.SysColumnName.toLowerCase().Contains("dcnum")){if(!a.e.IsEmpty(i.Distxml)){var o=i.Distxml.toString().split(",");o.length>2&&""!=o[0]&&(s.distDim=parseInt(o[0]),"1"==o[1]&&(s.distequally=!0),"1"==o[2]&&(s.distLineWise=!0,this.GridDataColumns.push(i.SysColumnName.toString()+"DistXML")),o.length>3&&""!=o[3]&&(s.DefaultValueText=o[3]))}s.DefaultValue=Object(g.isNullOrUndefined)(i.UserDefaultValue)?"":i.UserDefaultValue.toString(),this.GridDataColumns.push("dcCalc"+i.SysColumnName),this.GridDataObj.DataTypes.Double.push("dcCalc"+i.SysColumnName),!a.e.IsEmpty(i.Decimal)&&parseFloat(i.Decimal)>=0?s.DecimalPoints=i.Decimal.toString():n.a.SessionManager.Preferences.ContainsKey("DecimalsinExtraFields")&&""!=n.a.SessionManager.Preferences.DecimalsinExtraFields&&(s.DecimalPoints=n.a.SessionManager.Preferences.DecimalsinExtraFields);let e=this.Data.Tables[0].filter(e=>e.SysColumnName=="dcCurrID"+i.SysColumnName.toLowerCase().replace("dcnum",""));e.length>0&&!a.e.IsEmpty(e[0].UserDefaultValue)&&a.e.IsNum(e[0].UserDefaultValue)&&parseInt(e[0].UserDefaultValue)>0&&(s.CurrID=parseInt(e[0].UserDefaultValue),s.ExhcgRt=this.GetExchangeRate(s.CurrID,new Date)),a.e.IsEmpty(i.EvaluateAfter)||(s.FilterCondition=i.EvaluateAfter.toString()),a.e.IsEmpty(i.Distributeon)||(s.DependantOn=i.Distributeon.toString())}else if(i.SysColumnName.toLowerCase().Contains("dcexchrt"));else if("Quantity"==i.SysColumnName)this.GridDataColumns.push("Linked"+i.SysColumnName),this.GridDataObj.DataTypes.Double.push("Linked"+i.SysColumnName),!a.e.IsEmpty(i.Decimal)&&parseFloat(i.Decimal)>=0?s.DecimalPoints=i.Decimal.toString():n.a.SessionManager.Preferences.ContainsKey("DecimalsinQty")&&""!=n.a.SessionManager.Preferences.DecimalsinQty&&(s.DecimalPoints=n.a.SessionManager.Preferences.DecimalsinQty);else if("RecievedQty"==i.SysColumnName){if(!this.Preferences.ContainsKey("SeparateColRecieptIssue")||""==this.Preferences.SeparateColRecieptIssue||!Object(S.j)(this.Preferences.SeparateColRecieptIssue))continue;!a.e.IsEmpty(i.Decimal)&&parseFloat(i.Decimal)>=0?s.DecimalPoints=i.Decimal.toString():n.a.SessionManager.Preferences.ContainsKey("DecimalsinQty")&&""!=n.a.SessionManager.Preferences.DecimalsinQty&&(s.DecimalPoints=n.a.SessionManager.Preferences.DecimalsinQty),s.ShowbodyTotal=this.Preferences.ContainsKey("ShowQtyTotal")&&""!=this.Preferences.ShowQtyTotal&&Object(S.j)(this.Preferences.ShowQtyTotal)?1:0,this.GridDataColumns.push("RecievedQtyXML")}else"Gross"==i.SysColumnName||"Rate"==i.SysColumnName?(s.NoRoundOff=!0,"Gross"==i.SysColumnName&&(this.GridDataColumns.push("Linked"+i.SysColumnName),this.GridDataObj.DataTypes.Double.push("Linked"+i.SysColumnName)),!a.e.IsEmpty(i.Decimal)&&parseFloat(i.Decimal)>=0?s.DecimalPoints=i.Decimal.toString():n.a.SessionManager.Preferences.ContainsKey("DecimalsinRate")&&""!=n.a.SessionManager.Preferences.DecimalsinRate&&(s.DecimalPoints=n.a.SessionManager.Preferences.DecimalsinRate)):"Amount"!=i.SysColumnName&&"DebitAmount"!=i.SysColumnName&&"CreditAmount"!=i.SysColumnName||(!a.e.IsEmpty(i.Decimal)&&parseFloat(i.Decimal)>=0?s.DecimalPoints=i.Decimal.toString():n.a.SessionManager.Preferences.ContainsKey("DecimalsinAmount")&&""!=n.a.SessionManager.Preferences.DecimalsinAmount&&(s.DecimalPoints=n.a.SessionManager.Preferences.DecimalsinAmount));"Quantity"==i.SysColumnName?s.ShowbodyTotal=this.Preferences.ContainsKey("ShowQtyTotal")&&""!=this.Preferences.ShowQtyTotal&&Object(S.j)(this.Preferences.ShowQtyTotal)?1:0:i.SysColumnName.toLowerCase().Contains("dcexchrt")||"exchangerate"==i.SysColumnName.toLowerCase()||"rate"==i.SysColumnName.toLowerCase()||a.e.IsEmpty(i.ShowbodyTotal)||(s.ShowbodyTotal=parseInt(i.ShowbodyTotal));break;case"LISTBOX":if(s.ValueMember=i.SysColumnName+"_Key",a.e.IsEmpty(i.CrFilter)||(s.CrRefColID=parseInt(i.CrFilter)),a.e.IsEmpty(i.DbFilter)||(s.DrRefColID=parseInt(i.DbFilter)),a.e.IsEmpty(i.Accountfilterinuse)||(s.isUpdate=Object(S.j)(i.Accountfilterinuse)),"unit"==i.SysColumnName.toLowerCase()?(this.GridDataColumns.push(i.SysColumnName),this.GridDataColumns.push(i.SysColumnName+"_Key"),this.GridDataObj.DataTypes.Int.push(i.SysColumnName+"_Key"),this.GridDataColumns.push("UOMConversion"),this.GridDataColumns.push("UOMConvertedQty"),this.GridDataObj.DataTypes.Double.push("UOMConversion"),this.GridDataObj.DataTypes.Double.push("UOMConvertedQty")):"productid"==i.SysColumnName.toLowerCase()?(s.ValueMember="ProductID_Key",s.DisplayMember=i.parentccdefaultcolid&&"261"==i.parentccdefaultcolid.toString().toLowerCase()||this.GridDataColumns.Contains("ProductName")?"ProductCode":"ProductName",this.GridDataColumns.push(s.DisplayMember),"ProductCode"==s.DisplayMember&&this.Data.Tables.length>19&&this.Data.Tables[19].length>0&&this.Data.Columns[19].Contains("DefinitionXML")&&(s.BarcodeDef=this.Data.Tables[19][0].DefinitionXML.toString(),s.BarcodeProp=this.Data.Tables[19][0].BarcodeXml.toString(),""!=s.BarcodeDef&&"<Definition></Definition>"!=s.BarcodeDef&&(s.UseBarcode=!0)),this.GridDataColumns.Contains(s.ValueMember)||(this.GridDataColumns.push(s.ValueMember),this.GridDataObj.DataTypes.Int.push(s.ValueMember))):"accountid"==i.SysColumnName.toLowerCase()||"debitaccount"==i.SysColumnName.toLowerCase()||"creditaccount"==i.SysColumnName.toLowerCase()?("creditaccount"==i.SysColumnName.toLowerCase()&&(18==this.DocumentType||19==this.DocumentType||21==this.DocumentType||22==this.DocumentType)||"debitaccount"==i.SysColumnName.toLowerCase()&&(14==this.DocumentType||15==this.DocumentType||20==this.DocumentType||23==this.DocumentType)||"accountid"==i.SysColumnName.toLowerCase()?(s.DisplayMember=i.parentccdefaultcolid&&"239"==i.parentccdefaultcolid.toString().toLowerCase()?this.GridDataColumns.Contains("AccountName")?"AccountCode":"AccountName":"AccountCode",this.GridDataColumns.push(s.DisplayMember)):(s.DisplayMember=i.SysColumnName,this.GridDataColumns.push(s.DisplayMember)),this.GridDataColumns.Contains(s.ValueMember)||(this.GridDataColumns.push(s.ValueMember),this.GridDataObj.DataTypes.Int.push(s.ValueMember))):(this.GridDataColumns.push(i.SysColumnName),this.GridDataColumns.push(i.SysColumnName+"_Key"),this.GridDataObj.DataTypes.Int.push(i.SysColumnName+"_Key")),s.CostCenterID=parseInt(i.ColumnCostCenterID),s.TypeID=parseInt(i.ColumnCCListViewTypeID),a.e.IsEmpty(i.FetchMaxRows)||(s.GridViewID=parseInt(i.FetchMaxRows)),!a.e.IsEmpty(i.UserDefaultValue)&&this.Data.Tables.length>17&&this.Data.Tables[17].length>0&&this.Data.Columns[17].Contains("ccid")){let e=this.Data.Tables[17].filter(e=>e.ccid==i.ColumnCostCenterID);e.length>0&&(s.DefaultValue=i.UserDefaultValue.toString(),s.DefaultValueText=e[0].Name.toString())}if((s.CostCenterID>5e4||61==s.CostCenterID)&&!a.e.IsEmpty(i.Filter)&&parseInt(i.Filter)>0&&(s.Filter=parseInt(i.Filter),this.FilterColumns.push(i.SysColumnName+"_Key",parseInt(i.Filter)),a.e.IsEmpty(i.Productfilterinuse)?this.ProdFilterinuse.push(s.CostCenterID,!1):this.ProdFilterinuse.push(s.CostCenterID,Object(S.j)(i.Productfilterinuse))),61==s.CostCenterID&&(this.GridDataColumns.push("StartYear"),this.GridDataColumns.push("EndYear")),"ProductID_Key"==s.ValueMember||"AccountID_Key"==s.ValueMember||"CreditAccount_Key"==s.ValueMember||"DebitAccount_Key"==s.ValueMember?(this.DivisionID>0&&(2==s.CostCenterID&&n.a.SessionManager.Preferences.ContainsKey("DW Accounts")&&"True"==n.a.SessionManager.Preferences["DW Accounts"].toString()||3==s.CostCenterID&&n.a.SessionManager.Preferences.ContainsKey("DW Products")&&"True"==n.a.SessionManager.Preferences["DW Products"].toString())&&(s.DivisionID=this.DivisionID),this.LocationID>0&&(2==s.CostCenterID&&n.a.SessionManager.Preferences.ContainsKey("LW Accounts")&&"True"==n.a.SessionManager.Preferences["LW Accounts"].toString()||3==s.CostCenterID&&n.a.SessionManager.Preferences.ContainsKey("LW Products")&&"True"==n.a.SessionManager.Preferences["LW Products"].toString())&&(s.LocationID=this.LocationID),s.FilterCondition=a.e.String(i.UserProbableValues)):a.e.IsEmpty(i.UserProbableValues)||(s.FilterColumn=i.UserProbableValues.toString()),n.a.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&"True"==n.a.SessionManager.Preferences.EnableDivisionWise.toString()&&50001==s.CostCenterID&&(s.ReadOnly=!this.Preferences.ContainsKey("Donotusedivision")||""==this.Preferences.Donotusedivision||!Object(S.j)(this.Preferences.Donotusedivision)),!n.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")||"True"!=n.a.SessionManager.Preferences.EnableLocationWise.toString()||this.Preferences.ContainsKey("Donotuselocation")&&""!=this.Preferences.Donotuselocation&&Object(S.j)(this.Preferences.Donotuselocation)||50002!=s.CostCenterID||(s.ReadOnly=!this.Preferences.ContainsKey("EnableLocation")||""==this.Preferences.EnableLocation||!Object(S.j)(this.Preferences.EnableLocation)),!a.e.IsEmpty(i.Decimal)&&parseFloat(i.Decimal)>0&&i.SysColumnName.toLowerCase().Contains("dcccnid")&&3==parseInt(i.SectionID)&&parseInt(i.ColumnCostCenterID)>0){let e=s.Clone();e.Header=i.UserColumnName.toString()+"Code",e.TypeID=parseInt(i.Decimal),e.DisplayMember=i.SysColumnName+"Code",e.ValueMember=i.SysColumnName+"_Key",this.ColumnSource.push(e),this.GridDataColumns.push(i.SysColumnName+"Code")}break;case"TEXT":case"STRING":case"COMBOBOX":if(this.GridDataColumns.push(i.SysColumnName),s.IsColumnUserDefined||35==this.DocumentType||"chequebankname"==i.SysColumnName.toLowerCase()){if("Date"!=i.UserColumnType.toString()&&"FixedDate"!=i.UserColumnType.toString()||(s.DataType="DATE",this.GridDataColumns.push(i.SysColumnName+"_Key"),this.GridDataObj.DataTypes.Date.push(i.SysColumnName+"_Key"),55==this.DocumentType&&"dcalpha1"==i.SysColumnName.toLowerCase()&&(s.FixedDateFormat="MMM/yyyy")),"DateTime"==i.UserColumnType.toString()||"FixedDateTime"==i.UserColumnType.toString())s.DataType="DATETIME",this.GridDataColumns.push(i.SysColumnName+"_Key"),this.GridDataObj.DataTypes.Date.push(i.SysColumnName+"_Key");else if("Time"==i.UserColumnType.toString())s.DataType="TIME",this.GridDataColumns.push(i.SysColumnName+"_Key"),this.GridDataObj.DataTypes.Date.push(i.SysColumnName+"_Key");else if("CheckBox"==i.UserColumnType.toString())s.DataType="CheckBox";else if("Numeric"==i.UserColumnType.toString())s.DataType="FLOAT",!a.e.IsEmpty(i.Decimal)&&parseFloat(i.Decimal)>=0&&(s.DecimalPoints=i.Decimal.toString()),this.GridDataObj.DataTypes.Double.push(i.SysColumnName),"4"==i.TextFormat&&(s.ShowbodyTotal=1);else if("SELECTIONBOX"==i.UserColumnType.toString()||"editablecombobox"==i.UserColumnType.toString().toLowerCase())s.DataType="SELECTIONBOX",s.CostCenterID=this.CostCenterID;else if("combobox"==i.UserColumnType.toString().toLowerCase())if(s.ValueBinding=i.SysColumnName,!a.e.IsEmpty(i.linkData)&&22803==parseInt(i.linkData)||"@YEAR"==s.DefaultValue){s.DataType="PactComboBox";let e=[];for(let t=1980;t<2100;t++)e.push({Year:t.toString()});s.DisplayMember="Year",s.ValueMember="Year",s.ComboData=e,"@YEAR"==s.DefaultValue&&(s.DefaultValue=""),this.GridDataColumns.push(i.SysColumnName+"_Key")}else{s.DataType="ComboBox",s.DisplayMember="Name",s.ValueMember="Value";let e=[],t=a.e.String(i.UserProbableValues).trim();if(t.length>0){let s=t.split(";");for(let t=0;t<s.length;t++)e.push(u.d.ComboBoxItems_2(s[t],s[t]))}s.ComboData=e}else if("LISTBOX"==i.UserColumnType.toString()){if(s.DataType="LISTBOX",s.CostCenterID=this.CostCenterID,s.ValueMember=i.SysColumnName+"_Key",this.GridDataColumns.push(i.SysColumnName+"_Key"),s.CostCenterID=parseInt(i.ColumnCostCenterID),s.TypeID=parseInt(i.ColumnCCListViewTypeID),a.e.IsEmpty(i.UserDefaultValue)&&this.Data.Tables.length>17&&this.Data.Tables[17].length>0&&this.Data.Columns[17].Contains("ccid")){let e=this.Data.Tables[17].filter(e=>e.ccid==i.ColumnCostCenterID&&e.NodeID==i.UserDefaultValue);e.length>0&&(s.DefaultValue=Object(g.isNullOrUndefined)(i.UserDefaultValue)?"":i.UserDefaultValue.toString(),s.DefaultValueText=e[0].Name.toString())}}else if("Attachment"==i.UserColumnType.toString())s.DataType="LINK",s.ReadOnly=!0,s.FilterCondition=i.BasedOnXml.toString(),s.Dependantinuse=!1;else if("Image"==i.UserColumnType.toString())s.DataType="LINK",s.ReadOnly=!0,s.Dependantinuse=!0;else if("LOOKUP"==i.UserColumnType.toString()){s.ValueBinding=i.SysColumnName,s.DataType="ComboBox",s.DisplayMember="Name",s.ValueMember="Value";let e=f.GetLookupData(parseInt(i.ColumnCCListViewTypeID));if(null!=e){let t=[];for(let s=0;s<e.length;s++)t.push(u.d.ComboBoxItems_2(e[s].Name.toString(),e[s].NodeID.toString()));s.ComboData=t}this.GridDataColumns.push(i.SysColumnName+"_Key")}}else if("VoucherType"==i.SysColumnName){s.DataType="ComboBox",s.DisplayMember="Name",s.ValueMember="Value",s.ValueBinding=i.SysColumnName;let e=[];e.push(u.d.ComboBoxItems_2(n.a.GetResource("StockJVIssue"),"-1")),e.push(u.d.ComboBoxItems_2(n.a.GetResource("StockJVRecieve"),"1")),s.ComboData=e}else"ChequeBookNo"==i.SysColumnName&&(s.DataType="ComboBox",s.DisplayMember="Name",s.ValueMember="Value",s.ValueBinding=i.SysColumnName);break;case"DATE":s.DataType="DATE",this.GridDataColumns.push(i.SysColumnName),this.GridDataColumns.push(i.SysColumnName+"_Key"),this.GridDataObj.DataTypes.Date.push(i.SysColumnName+"_Key")}if(67!=this.DocumentType||"dcalpha2"!=i.SysColumnName.toLowerCase()&&"dcalpha3"!=i.SysColumnName.toLowerCase()&&"dcalpha18"!=i.SysColumnName.toLowerCase()&&"dcalpha19"!=i.SysColumnName.toLowerCase()||"DateTime"==i.UserColumnType.toString()&&(s.DataType="Time2"),99!=this.DocumentType||"dcalpha4"!=i.SysColumnName.toString().toLowerCase()&&"dcalpha5"!=i.SysColumnName.toString().toLowerCase()&&"dcalpha6"!=i.SysColumnName.toString().toLowerCase()&&"dcalpha7"!=i.SysColumnName.toString().toLowerCase()&&"dcalpha8"!=i.SysColumnName.toString().toLowerCase()&&"dcalpha9"!=i.SysColumnName.toString().toLowerCase()||"DateTime"==i.UserColumnType.toString()&&(s.DataType="Time2"),52!=this.DocumentType||"dcalpha1"!=i.SysColumnName.toLowerCase()&&"dcalpha2"!=i.SysColumnName.toLowerCase()||"Time"==i.UserColumnType.toString()&&(s.DataType="Time2"),59!=this.DocumentType||"dcalpha3"!=i.SysColumnName.toLowerCase()&&"dcalpha4"!=i.SysColumnName.toLowerCase()||"Time"==i.UserColumnType.toString()&&(s.DataType="Time2"),89!=this.DocumentType||"dcalpha2"!=i.SysColumnName.toLowerCase()&&"dcalpha4"!=i.SysColumnName.toLowerCase()||"Time"==i.UserColumnType.toString()&&(s.DataType="Time2"),90!=this.DocumentType||"dcalpha2"!=i.SysColumnName.toLowerCase()&&"dcalpha4"!=i.SysColumnName.toLowerCase()||"Time"==i.UserColumnType.toString()&&(s.DataType="Time2"),96==this.DocumentType&&"dcalpha3"==i.SysColumnName.toLowerCase()&&"Time"==i.UserColumnType.toString()&&(s.DataType="Time2"),68==this.DocumentType&&"dcalpha3"==i.SysColumnName.toLowerCase()&&(s.DataType="PactComboBox",s.ValueBinding=i.SysColumnName,this.GridDataColumns.push(i.SysColumnName+"_Key")),70!=this.DocumentType||"dcalpha1"!=i.SysColumnName.toLowerCase()&&"dcalpha3"!=i.SysColumnName.toLowerCase()||(s.DataType="PactComboBox",s.ValueBinding=i.SysColumnName,this.GridDataColumns.push(i.SysColumnName+"_Key")),80==this.DocumentType&&"dcalpha2"==i.SysColumnName.toLowerCase()&&(s.DataType="PactComboBox",s.ValueBinding=i.SysColumnName,this.GridDataColumns.push(i.SysColumnName+"_Key")),(i.SysColumnName.toLowerCase().Contains("dcnum")||"quantity"==i.SysColumnName.toLowerCase()||"rate"==i.SysColumnName.toLowerCase()||"gross"==i.SysColumnName.toLowerCase()||i.SysColumnName.toLowerCase().Contains("amount"))&&(this.GridDataColumns.push("default"+i.SysColumnName),this.GridDataObj.DataTypes.Double.push("default"+i.SysColumnName)),this.ColumnSource.push(s),"quantity"==i.SysColumnName.toLowerCase()){let e=!1;if(this.Preferences.ContainsKey("EnableSchemes")&&Object(S.j)(this.Preferences.EnableSchemes)&&(e=Object(S.j)(this.Preferences.EnableSchemes)),e){let e=s.Clone();e.Formula="",e.DisplayMember="FreeQTY",e.Header="Free Qty",e.DisableTab=!0,"0"==a.e.String(i.ColumnSpan)&&(e.IsVisible=!1),this.GridDataColumns.push("FreeQTY"),this.ColumnSource.push(e)}}if(s.IsColumnUserDefined&&5==this.DocumentType&&s.CostCenterID>0&&s.DisplayMember.toLowerCase().Contains("ccnid")&&a.e.Int(i.IsTransfer)>0){this.GridDataColumns.push("TO"+i.SysColumnName),this.GridDataColumns.push("TO"+i.SysColumnName+"_Key");let e=new d.a;if(e.CostCenterID=s.CostCenterID,e.ID=s.ID,e.TypeID=s.TypeID,e.DisplayMember="TO"+i.SysColumnName,e.FilterCondition=s.FilterCondition,e.DivisionID=s.DivisionID,e.LocationID=s.LocationID,e.Width=s.Width,e.DependantOn=s.DependantOn,e.Dependantinuse=s.Dependantinuse,e.IsColumnUserDefined=s.IsColumnUserDefined,e.DataType=s.DataType,e.ValueMember="TO"+i.SysColumnName+"_Key",2!=parseInt(i.IsTransfer)&&4!=parseInt(i.IsTransfer)||(e.ExcludeFilter=!0),3!=parseInt(i.IsTransfer)&&4!=parseInt(i.IsTransfer)||(s.ExcludeFilter=!0),e.Header=n.a.GetResource("StockTransferTo")+s.Header,s.Header=n.a.GetResource("StockTransferFrom")+s.Header,e.lbl="To"+i.UserColumnName.toString(),s.lbl="From"+i.UserColumnName.toString(),this.ColumnSource.push(e),null!=i.Decimal&&!a.e.IsEmpty(i.Decimal)&&parseFloat(i.Decimal.toString())>0){let t=e;t.Header=e.Header+"Code",t.TypeID=parseInt(i.Decimal),t.DisplayMember="TO"+i.SysColumnName.toString()+"Code",t.ValueMember="TO"+i.SysColumnName.toString()+"_Key",this.ColumnSource.push(t),this.GridDataColumns.push("TO"+i.SysColumnName.toString()+"Code")}}}if(38!=this.DocumentType&&!this.IsForecast){var r=this.ColumnSource.filter(e=>e.IsVisible).Compute("sum","Width");if(r&&parseFloat(r)<window.innerWidth-290){let e=this.ColumnSource.length-1;for(;!this.ColumnSource[e].IsVisible;)e--;e>=0&&(this.ColumnSource[e].Width=window.innerWidth-parseFloat(r)+this.ColumnSource[e].Width-290)}}if(this.GridDataColumns.push("ExtraXML"),this.GridDataColumns.push("Type"),this.GridDataColumns.push("PayrollType"),this.GridDataColumns.push("TODocDetailsID"),this.GridDataColumns.push("LinkType"),this.GridDataColumns.push("LinkID"),this.GridDataObj.DataTypes.Int.push("LinkID"),this.IsInventory){if(this.GridDataColumns.push("AVGRATE"),this.GridDataColumns.push("LASTPURCHASERATE"),this.GridDataColumns.push("LASTLANDINGRATE"),this.GridDataColumns.push("QOH"),this.GridDataColumns.push("BalQOH"),this.GridDataColumns.push("HOLDQTY"),this.GridDataColumns.push("CommittedQty"),this.GridDataColumns.push("RESERVEQTY"),this.GridDataColumns.push("TotalReserve"),this.GridDataColumns.push("MRate"),this.GridDataColumns.push("RRate"),this.GridDataColumns.push("SRate"),this.GridDataColumns.push("Subexists"),this.GridDataColumns.push("SchemeID"),this.GridDataColumns.push("IsWeightable"),n.a.SessionManager.Preferences.LoyaltyBasedOn.toString().split(",").Contains("-1")&&(this.GridDataColumns.push("SchemeProductID"),this.GridDataObj.DataTypes.Int.push("SchemeProductID")),this.Preferences.ContainsKey("LockExecutedRows")&&"true"==this.Preferences.LockExecutedRows.toLowerCase()&&(this.GridDataColumns.push("ExecutedQty"),this.GridDataObj.DataTypes.Double.push("ExecutedQty")),this.Preferences.ContainsKey("AutoIssueNextStage")&&"true"==this.Preferences.AutoIssueNextStage.toLowerCase()&&(this.GridDataColumns.push("NextStageID"),this.GridDataObj.DataTypes.Int.push("NextStageID")),this.Preferences.ContainsKey("EnablePromotions")&&"true"==this.Preferences.EnablePromotions.toLowerCase()&&this.GridDataColumns.push("PromotionXML"),this.GridDataColumns.push("MaxSchemeID"),this.GridDataObj.DataTypes.Int.push("MaxSchemeID"),this.GridDataColumns.push("FileGUID"),this.GridDataColumns.push("FileExtension"),this.GridDataColumns.push("TolPer"),this.GridDataColumns.push("TolVal"),this.GridDataObj.DataTypes.Double.push("TolPer"),this.GridDataObj.DataTypes.Double.push("TolVal"),this.Preferences.ContainsKey("UseQtyAdjustment")&&""!=this.Preferences.UseQtyAdjustment&&Object(S.j)(this.Preferences.UseQtyAdjustment)&&(this.GridDataColumns.push("QtyType"),this.GridDataColumns.push("QtyXML")),this.GridDataColumns.push("BinWise"),this.GridDataColumns.push("BinsXML"),5==this.DocumentType?this.GridDataColumns.push("TOBinsXML"):45==this.DocumentType&&(this.GridDataColumns.push("AssignXML"),this.GridDataColumns.push("Dependencies")),this.Data.Tables.length>3&&this.Data.Tables[3].length>0&&this.Data.Columns[3].Contains("IsLineWise")&&!a.e.IsEmpty(this.Data.Tables[3][0].IsLineWise)&&Object(S.j)(this.Data.Tables[3][0].IsLineWise)){s=new d.a,s.Header="Select",s.ValueBinding="IsSelected",s.DataType="ComboBox",s.DisplayMember="Name",s.ValueMember="Value";let e=[];e.push(u.d.ComboBoxItems_2("","0")),e.push(u.d.ComboBoxItems_2(n.a.GetResource("btnApprove"),"1")),e.push(u.d.ComboBoxItems_2(n.a.GetResource("btnReject"),"2")),s.ComboData=e,s.ReadOnly=!1,s.Width=90,s.DisableTab=!0,s.IsVisible=!1,s.ID="0",this.ColumnSource.InsertAt(s,1),s=new d.a,s.Header="Approval Status",s.DisplayMember="StatusID",s.ReadOnly=!0,s.DataType="text",s.Width=2,s.DisableTab=!0,s.IsVisible=!0,s.ID="0",this.ColumnSource.InsertAt(s,1),s=new d.a,s.Header="Status",s.DisplayMember="StatusID_Name",s.ReadOnly=!0,s.DataType="text",s.Width=parseInt(this.Data.Tables[3][0].FieldWidth),s.DisableTab=!0,s.IsVisible=0!=s.Width,s.ID="0",this.ColumnSource.InsertAt(s,2),s=new d.a,s.Header="Remarks",s.DisplayMember="AppRemarks",s.DataType="text",s.ReadOnly=!1,s.Width=220,s.DisableTab=!0,s.IsVisible=!1,s.ID="0",this.ColumnSource.InsertAt(s,3),this.GridDataColumns.push("AppRemarks"),this.GridDataColumns.push("IsSelected"),this.GridDataColumns.push("StatusID"),this.GridDataColumns.push("CanApprove"),this.GridDataColumns.push("CanEdit"),this.GridDataColumns.push("WorkFlowLevel"),this.GridDataColumns.push("WorkFlowID"),this.GridDataColumns.push("StatusID_COLOR"),this.GridDataColumns.push("StatusID_Name")}}else this.GridDataColumns.push("ReturnXML"),this.GridDataColumns.push("RefStatusID"),this.GridDataColumns.push("OldSeqNo"),this.GridDataColumns.push("DiscXML"),14!=this.DocumentType&&19!=this.DocumentType||(s=new d.a,s.Header="Status",s.DisplayMember="StatusID",s.ReadOnly=!0,s.DataType="text",s.Width=2,s.DisableTab=!0,s.IsVisible=!1,s.ID="0",this.ColumnSource.InsertAt(s,1),this.GridDataColumns.push("StatusID"),this.GridDataColumns.push("StatusID_COLOR"));if(25==this.DocumentType&&this.GridDataColumns.push("LinkStatusID"),this.Preferences.ContainsKey("Billlanding")&&Object(S.j)(this.Preferences.Billlanding)&&(this.GridDataColumns.push("DocExtraXML"),this.GridDataColumns.push("landingType"),this.GridDataColumns.push("BOEID")),this.Preferences.ContainsKey("EnablePacking")&&Object(S.j)(this.Preferences.EnablePacking)&&(this.GridDataColumns.push("PackType"),this.GridDataColumns.push("PackXML")),this.Preferences.ContainsKey("EnableTestcase")&&Object(S.j)(this.Preferences.EnableTestcase)&&(this.GridDataColumns.push("IsTestCase"),this.GridDataColumns.push("TestCaseXML")),this.Preferences.ContainsKey("OptionalBins")&&""!=this.Preferences.OptionalBins.toString()&&Object(S.j)(this.Preferences.OptionalBins)&&(this.GridDataColumns.push("BinStatus"),this.GridDataColumns.push("BinStatus_COLOR"),s=new d.a,s.Header="BinStatus",s.DisplayMember="BinStatus",s.ReadOnly=!0,s.DataType="text",s.Width=2,s.SectionID=3,s.DisableTab=!0,s.IsVisible=!0,s.ID="0",this.ColumnSource.InsertAt(s,1)),this.Preferences.ContainsKey("PartialRecur")&&"True"==this.Preferences.PartialRecur.toString()){this.GridDataColumns.push("CanRecur"),s=new d.a,s.Header="Recur",s.ValueBinding="CanRecur",s.DataType="ComboBox",s.DisplayMember="Name",s.ValueMember="Value";let e=[];e.push(u.d.ComboBoxItems_2(n.a.GetResource("Com_No"),"False")),e.push(u.d.ComboBoxItems_2(n.a.GetResource("Com_Yes"),"True")),s.ComboData=e,s.Width=70,s.SectionID=3,s.IsVisible=!0,s.ID="0",this.ColumnSource.push(s)}this.GridDataColumns.Contains("FieldType")&&this.FillDafaultTypes(),this.UpdateSequence(),40062==this.CostCenterID&&this.GenerateCustomFields(e,this.LineItemFields,!0)}FillDafaultTypes(){let e,t="";this.Data.Columns[1].Contains("PaymentModes")&&this.Data.Tables[1].length>0&&(t=this.Data.Tables[1][0].PaymentModes.toString());let s="";if(this.Preferences.ContainsKey("PosPaymentTypeFld")&&""!=this.Preferences.PosPaymentTypeFld&&(e=this.Data.Tables[0].filter(e=>e.CostCenterColID==this.Preferences.PosPaymentTypeFld),e.length>0&&this.GridDataColumns.Contains(e[0].SysColumnName.toString())&&(s=e[0].SysColumnName.toString())),""!=s){e=this.Data.Tables[0].filter(e=>e.SectionID>4,"SectionID"),e.sort((e,t)=>e.SectionID-t.SectionID);for(let n=0;n<e.length;n++){let i=e[n];if(!i.SysColumnName.toLowerCase().Contains("currid")&&!i.SysColumnName.toLowerCase().Contains("exchrt")&&(""==t||t.split(",").Contains(i.SectionID.toString()))&&0==this.GridData.filter(e=>e.FieldType==i.SysColumnName).length){let e=this.GridDataObj.NewRow();e.FieldType=i.SysColumnName,e[s]=i.ResourceData.toString(),!a.e.IsEmpty(i.DebitAccount)&&this.GridDataColumns.Contains("DebitAccount")&&(e.DebitAccount_Key=i.DebitAccount.toString(),e.DebitAccount=i.DebitAccountName.toString()),this.GridDataObj.addRow(e)}}}}CheckRWFieldsExists_0(){this.IsInventory&&(this.CheckRWFieldsExists(23819,"AVGRATE"),this.CheckRWFieldsExists(23820,"LastPurchaseRate"),this.CheckRWFieldsExists(23821,"PW_LandingCost"),this.CheckRWFieldsExists(24062,"PW_LastRate"),this.CheckRWFieldsExists(25398,"QOH"),this.CheckRWFieldsExists(26421,"HOLDQTY"),this.CheckRWFieldsExists(26422,"RESERVEQTY"),this.CheckRWFieldsExists(499943,"TotalReserve"),this.CheckRWFieldsExists(26585,"PW_LastValue"),this.CheckRWFieldsExists(50051,"Last Landing Rate"),this.CheckRWFieldsExists(50403,"ExchangeGainOrLoss"),this.CheckRWFieldsExists(50454,"CommittedQty"),this.CheckRWFieldsExists(50455,"ExecutedQty"),this.CheckRWFieldsExists(50456,"RefDocNo"),this.CheckRWFieldsExists(50493,"VendorBarcode"),this.CheckRWFieldsExists(50494,"UnitBarCode"),this.CheckRWFieldsExists(52627,"RecurDocNo"),this.CheckRWFieldsExists(52637,"BalQty"),this.CheckRWFieldsExists(52638,"BalHold"),this.CheckRWFieldsExists(53529,"LastValue"),this.CheckRWFieldsExists(53530,"TotalValue"),this.CheckRWFieldsExists(55479,"LPRStockNonStock"),this.CheckRWFieldsExists(49,"Loc_QOH"),this.CheckRWFieldsExists(50,"Div_QOH"))}CheckRWFieldsExists(e,t){var s=this.ColumnSource.find(s=>s.linkData==e||!a.e.IsEmpty(s.Formula)&&s.Formula.toUpperCase().Contains(t));this.IsInventory&&!s&&(s=this.FooterColumnSource.find(s=>s.linkData==e||!a.e.IsEmpty(s.Formula)&&s.Formula.toUpperCase().Contains(t))),s&&this.RWFieldsExists.push(t)}CheckFormulaExists(e){var t=this.ColumnSource.find(t=>!a.e.IsEmpty(t.Formula)&&t.Formula.toUpperCase().Contains(e.toUpperCase()));return this.IsInventory&&t&&(t=this.FooterColumnSource.find(t=>!a.e.IsEmpty(t.Formula)&&t.Formula.toUpperCase().Contains(e.toUpperCase()))),!!t||null!=this._TextFields.find(t=>!a.e.IsEmpty(t.Formula)&&t.Formula.toUpperCase().Contains(e.toUpperCase()))}GetAccountTransaction(e,t,s,n,i,o){let r="",l=a.e.Double(s);return l<0?(r+='DebitAccount="'+t+'" ',r+='CreditAccount="'+e+'" ',r+='Amount="'+(-1*l*i).ToString("N"+o).Replace(",","")+'" ',r+='AmtFc="'+(-1*l).toString()+'" ',r+='CurrencyID="'+n+'" ',r+='ExchangeRate="'+i+'" ',r+='IsNegative="1" '):(r+='DebitAccount="'+e+'" ',r+='CreditAccount="'+t+'" ',r+='Amount="'+(l*i).ToString("N"+o).Replace(",","")+'" ',r+='AmtFc="'+l.toString()+'" ',r+='CurrencyID="'+n+'" ',r+='ExchangeRate="'+i+'" '),r.toString()}FillBillWiseDt(e,t,s,n,i,o,r,l,u,c=1){a.e.IsEmpty(u)&&(u="2");let D,h,C=a.e.Double(n);if(C<0&&(i=!i,C=parseFloat((-1*C).ToString("N"+u))),h=t.Contains("DocSeqNo")?e.filter(e=>e.AccountID==s&&e.DocSeqNo==c):e.filter(e=>e.AccountID==s),h.length>0)if(D=h[0],D.FromTo.toString()!=l.toString()&&(D.FromTo="0"),parseInt(D.CurrencyID)!=o&&(D.Amount=parseFloat((parseFloat(D.Amount)*parseFloat(D.ExchangeRate)).ToString("N"+u)),D.CurrencyID=1,D.ExchangeRate=1,C=parseFloat((C*r).ToString("N"+u))),parseInt(u)>parseInt(D.Decimal)?D.Decimal=u:u=D.Decimal.toString(),Object(S.j)(D.IsCredit)!=i){let t=parseFloat(D.Amount);t>C?D.Amount=parseFloat((parseFloat(D.Amount)-C).ToString("N"+u)):t<C?(D.Amount=parseFloat((C-t).ToString("N"+u)),D.IsCredit=i):t==C&&e.Remove(D)}else D.Amount=parseFloat((parseFloat(D.Amount)+C).ToString("N"+u));else t.length>0&&(D={},D.AccountID=s,D.Amount=C,D.IsCredit=i,D.CurrencyID=o,D.ExchangeRate=r,D.FromTo=l,D.Decimal=u,t.Contains("DocSeqNo")&&(D.DocSeqNo=c),e.push(D))}ValidateDate(e){return this.DocDate.Mandatory&&!a.e.isValidDate(e)?n.a.GetResource("Invalid")+" "+this.DocDate.Label:a.e.IsEmpty(e)||a.e.isValidDate(e)?"":n.a.GetResource("Invalid")+" "+this.DocDate.Label}ValidateInt(e){return a.e.IsEmpty(e)||a.e.IsNum(e)?"":n.a.GetResource("Invalid")+" "+this.DocPrefix.Label}ValidateLong(e){return a.e.IsEmpty(e)||a.e.IsNum(e)?"":n.a.GetResource("Invalid")+" "+this.DocPrefix.Label}getAccoutingDate(e){let t=n.a.common.GetDataSet("DOC039",e.toString());return null!=t&&t.Tables.length>0&&t.Tables[0].length>0&&t.Tables[0][0].ccAlpha42&&a.e.isValidDate(t.Tables[0][0].ccAlpha42)?new Date(t.Tables[0][0].ccAlpha42):n.a.SessionManager.AccountingDate}GenerateQuery(e,t,s,i,o=!1){if(i&&""==this.DocPrefix.TextBox.Text)return e.message=n.a.GetResource("MandatoryDocumentNumber"),"";if(i&&""!=this.ValidateLong(this.DocPrefix.TextBox.Text))return e.message=this.ValidateLong(this.DocPrefix.TextBox.Text),"";if(i&&!a.e.IsNum(this.DocPrefix.TextBox.Text))return e.message=n.a.GetResource("Invalid")+" "+this.DocPrefix.Label,"";if(i&&a.e.IsEmpty(s))return e.message=n.a.GetResource("MandatoryDocumentDate"),"";if(i&&""!=this.ValidateDate(s))return e.message=this.ValidateDate(s),"";if(i)if((n.a.SessionManager.LocationID>0||this.LocationID>0)&&n.a.SessionManager.Preferences.ContainsKey("LWAccPeriod")&&"True"==n.a.SessionManager.Preferences.LWAccPeriod.toString()){if(0==this.LocationID&&n.a.SessionManager.LocationID>0&&(this.dtLocWise=this.getAccoutingDate(n.a.SessionManager.LocationID)),16==this.DocumentType&&s>this.dtLocWise)return e.message=n.a.GetResource("OpeningVoucherDate"),"";if(!this.IsPayrollDocument&&16!=this.DocumentType&&s<this.dtLocWise)return e.message=n.a.GetResource("DocumentDateValidation"),""}else{if(16==this.DocumentType&&s>n.a.SessionManager.AccountingDate)return e.message=n.a.GetResource("OpeningVoucherDate"),"";if(!this.IsPayrollDocument&&16!=this.DocumentType&&s<n.a.SessionManager.AccountingDate)return e.message=n.a.GetResource("DocumentDateValidation"),""}return i&&null!=this.BillNo&&this.BillNo.Mandatory&&""!=this.BillNo.ValidateData()?(e.message=this.BillNo.ValidateData(),""):i&&null!=this.DebitAccount&&this.DebitAccount.SelectedValue<1&&this.DebitAccount.SelectedValue>-10001?(e.message=this.DebitAccount.Visible?n.a.GetResource("Select")+" "+this.DebitAccount.Label:"Default "+this.DebitAccount.Label+" not defined",""):i&&null!=this.CreditAccount&&this.CreditAccount.SelectedValue<1&&this.CreditAccount.SelectedValue>-10001?(e.message=this.CreditAccount.Visible?n.a.GetResource("Select")+" "+this.CreditAccount.Label:"Default "+this.CreditAccount.Label+" not defined",""):(this.HistoryCCXML="",this.strStaticFields=this.GenerateQueryfromList(this._StaticFields,!1,e,!1,i),""!=e.message?"":(this.strTextFields=this.GenerateQueryfromList(this._TextFields,!o,e,!1,i),""!=e.message?"":(this.strnumericFields=this.GenerateQueryfromList(this._numericFields,!o,e,!1,i),""!=e.message?"":(this.strCCFields=this.GenerateQueryfromList(this._CCFields,!o,e,!1,i),""!=e.message||5==this.DocumentType&&(this.strTOCCFields=this.GenerateQueryfromList(this._CCFields,!0,e,!0,i),""!=e.message)?"":(this.FooterAccounts="".toString(),"".toString())))))}BindCurExchange(){this.HeaderFields.forEach(e=>{"ExchangeRate"==e.DBColumnName&&(this.AmtFc=e.Text),"CurrencyID"==e.DBColumnName&&(this.ExchRate=e.SelectedValue.toString())})}GenerateQueryfromList(e,t,s,i,h){let C=!1;e==this._TextFields&&(C=!0);let m="";s.message="";let d="";for(let p=0;p<e.length;p++){let S=e[p];if(d="",S instanceof r.d){if("SKU"==S.DBColumnName)continue;s.message=S.ValidateData(),d=S.Text,a.e.IsEmpty(d)&&(d=""),null!=S.Tag&&""!=S.Tag&&(d=S.Tag)}if(S instanceof o.a)h&&(s.message=S.GetValidationError("Text")),d=S.Text,a.e.IsEmpty(d)&&(d="");else if(S instanceof r.c)h&&(s.message=S.ValidateData()),d=S.Text,d=a.e.IsEmpty(d)?"":d.replace("\r\n","@~");else if(S instanceof u.e)h&&(s.message=S.GetValidationError("SelectedValue")),d=S.SelectedValue,a.e.IsEmpty(d)&&(d="");else if(S instanceof l.c)h&&(s.message=S.ValidateData()),S.Date&&(d=68==this.DocumentType?new Date(parseInt(S.Date.ToString("yyyy")),parseInt(S.Date.ToString("MM")),1).ToString("dd/MMM/yyyy"):56==this.DocumentType&&"dcalpha5"==S.DBColumnName.toLowerCase()?S.Date.ToString("01/MMM/yyyy"):S.Date.ToString("dd/MMM/yyyy")),a.e.IsEmpty(d)&&(d="");else if(S instanceof l.b){let e=S;if(h&&(s.message=e.ValidateData()),e.Date){let t=e.Date;e.ShowTimePicker&&1900!=e.Date.getFullYear()&&(t=new Date(1900,1,1),t=t.AddHours(e.Date.getHours()),t=t.AddMinutes(e.Date.getMinutes()),t=t.AddSeconds(e.Date.getSeconds())),d=t.ToString("dd/MMM/yyyy hh:mm a")}a.e.IsEmpty(d)&&(d="")}else if(S instanceof l.a)h&&(s.message=S.ValidateData()),d=S.Date.ToString("dd/MMM/yyyy"),a.e.IsEmpty(d)&&(d="");else if(S instanceof c.b){if(S.CCID==n.a.SessionManager.RegisterCCID&&(S.Mandatory=!0),h&&(s.message=S.GetValidationError("SelectedValue")),h&&S.Visible&&!a.e.IsEmpty(S.Text)&&0==S.SelectedValue)return s.message=n.a.GetResource("Invalid")+" "+S.Label.toString(),"";S.SelectedValue>0&&(d=S.SelectedValue.toString())}else if(S instanceof c.a){if(h&&S.Visible&&0==S.SelectedValue)return s.message=n.a.GetResource("Invalid")+" "+S.Label.toString(),"";S.SelectedValue>0&&(d=S.SelectedValue.toString()),a.e.IsEmpty(S.XML)||(this.HistoryCCXML+=S.XML)}else if(S instanceof D.a&&S.CCID>2){if(S.CCID==n.a.SessionManager.RegisterCCID&&(S.Mandatory=!0),h&&(s.message=S.GetValidationError("SelectedValue")),h&&S.Visible&&!a.e.IsEmpty(S.Text)&&0==S.SelectedValue)return s.message=n.a.GetResource("Invalid")+" "+S.Label.toString(),"";if(50051==S.CCID&&S.Mandatory&&0==S.SelectedValue)return s.message=n.a.GetResource("Invalid")+" "+S.Label.toString(),"";S.SelectedValue>0&&(d=S.SelectedValue.toString())}if(t){if(!a.e.IsEmpty(s.message))return"";""!=d&&i?S.DBColumnName.Contains("TO")?m+=S.DBColumnName.replace("TO","")+"="+r.d.GetValidXml(d)+", ":S.DBColumnName.Contains("TO")||this._CCFields.find(e=>e.DBColumnName=="TO"+S.DBColumnName)||(m+=S.DBColumnName+"="+r.d.GetValidXml(d)+", "):""==d||i||S.DBColumnName.Contains("TO")?""==d&&(i&&S.DBColumnName.Contains("TO")?m+=S.DBColumnName.replace("TO","")+"=1, ":i||S.DBColumnName.Contains("TO")||(C?m+=S.DBColumnName+"=NULL, ":S instanceof c.b&&(m+=S.DBColumnName+"=1, "))):m+=C?S.DBColumnName+"=N'"+r.d.GetValidTextXml(d)+"', ":S.DBColumnName+"="+r.d.GetValidXml(d)+", "}else{if(!a.e.IsEmpty(s.message))return"";""!=d&&i?S.DBColumnName.Contains("TO")?m+=S.DBColumnName.replace("TO","")+'="'+r.d.GetValidXml(d)+'" ':S.DBColumnName.Contains("TO")||this._CCFields.find(e=>e.DBColumnName=="TO"+S.DBColumnName)||(m+=S.DBColumnName+'="'+r.d.GetValidXml(d)+'" '):""==d||i||S.DBColumnName.Contains("TO")||(m+=S.DBColumnName+'="'+r.d.GetValidXml(d)+'" ')}}return m}GenerateCustomFields(e,t,s=!1){let i;Logger.InfoLog("VoucherGenerator:: Inside GenerateCustomFields"),e.forEach(m=>{if(!m.SysColumnName.toLowerCase().Contains("dccurrid")&&!m.SysColumnName.toLowerCase().Contains("dcexchrt"))switch(i=m.UserColumnType.toString().toUpperCase(),i){case"NUMERIC":case"FLOAT":if("ExchangeRate"==m.SysColumnName)return;this.oText=new r.d(parseInt(m.CostCenterColID)),this.SetProperties_Custom(m,this.oText,s),t.push(this.oText);break;case"TEXT":this.oText=new r.d(parseInt(m.CostCenterColID)),this.SetProperties_Custom(m,this.oText,s)&&t.push(this.oText);break;case"SELECTIONBOX":case"EDITABLECOMBOBOX":this.oPactSelectionBox=new o.a(parseInt(m.CostCenterColID)),this.oPactSelectionBox.CostCenterID=this.CostCenterID,this.SetProperties_Custom(m,this.oPactSelectionBox,s),t.push(this.oPactSelectionBox);break;case"TEXTAREA":this.oTextArea=new r.c(parseInt(m.CostCenterColID)),this.SetProperties_Custom(m,this.oTextArea,s),t.push(this.oTextArea);break;case"TIME":case"DATETIME":case"FIXEDDATETIME":let d=new l.b(parseInt(m.CostCenterColID));this.SetProperties_Custom(m,d,s),"TIME"==i?(d.ShowTimePicker=!0,d.CustomFormat=a.e.IsNullOrWhiteSpace(m.UserProbableValues)?"hh:mm:ss tt":m.UserProbableValues.toString()):d.CustomFormat=n.a.SessionManager.Preferences["Date Format"]+" hh:mm:ss tt",t.push(d);break;case"DATE":case"FIXEDDATE":"DocDate"==m.SysColumnName?(this.ovDate=new l.d(parseInt(m.CostCenterColID)),this.ovDate.objParent=this.oParent,this.SetProperties_Custom(m,this.ovDate,s),t.push(this.ovDate)):"ActDocDate"==m.SysColumnName?(this.oDate=new l.a(parseInt(m.CostCenterColID)),this.SetProperties_Custom(m,this.oDate,s),t.push(this.oDate)):(this.oDate=new l.c(parseInt(m.CostCenterColID)),this.oDate.VoucherDate=this.ovDate,this.SetProperties_Custom(m,this.oDate,s)&&t.push(this.oDate));break;case"COMBOBOX":this.oCombo=new u.e(parseInt(m.CostCenterColID));let p=m.UserProbableValues?m.UserProbableValues.toString().trim():"";if(p.length>0){let e=p.split(";");for(let t=0;t<e.length;t++)this.oCombo.Items.push(u.d.ComboBoxItems_2(e[t],e[t]));this.oCombo.SelectedValue=this.oCombo.Items[0].Value}else if("@YEAR"==a.e.String(m.UserDefaultValue)){for(let e=1980;e<2100;e++)this.oCombo.Items.push(u.d.ComboBoxItems_2(e.toString(),e.toString()));m.UserDefaultValue=null}this.SetProperties_Custom(m,this.oCombo,s),t.push(this.oCombo);break;case"LOOKUP":this.oCombo=new u.e(parseInt(m.CostCenterColID));let y=f.GetLookupData(parseInt(m.ColumnCCListViewTypeID));if(null!=y){for(let e=0;e<y.length;e++)this.oCombo.Items.push(u.d.ComboBoxItems_2(y[e].Name.toString(),y[e].NodeID.toString()));this.oCombo.SelectedValue=this.oCombo.Items[0].Value}this.SetProperties_Custom(m,this.oCombo,s),t.push(this.oCombo);break;case"LISTBOX":if("currencyid"==m.SysColumnName.toLowerCase()){let e=new h.b;e.DBColumnID=parseInt(m.CostCenterColID),this.Data.Tables.length>14&&this.Data.Tables[14].forEach(t=>{e.Currency.Items.push(u.d.ComboBoxItems_2(t.Name.toString(),t.CurrencyID.toString()))}),this.SetProperties_Custom(m,e,s),t.push(e)}else if("CreditAccount"==m.SysColumnName||"DebitAccount"==m.SysColumnName)this.oCodeNameCombo=new D.a(parseInt(m.CostCenterColID)),this.oCodeNameCombo.Code.TypeID=10,this.oCodeNameCombo.Name.TypeID=100,this.oCodeNameCombo.SelectionCallBack.Subscribe(this,"OnGetReference"),this.oCodeNameCombo.Code.Visible=this.oCodeNameCombo.Name.Visible=!1,"CreditAccount"==m.SysColumnName?this.CreditAccount=this.oCodeNameCombo:"DebitAccount"==m.SysColumnName&&(this.DebitAccount=this.oCodeNameCombo),this.Preferences.ContainsKey("ShowAccount")&&"Code"==this.Preferences.ShowAccount?(this.oCodeNameCombo.Code.Column=0,this.oCodeNameCombo.Code.ColumnSpan=2,this.oCodeNameCombo.Code.Visible=!0):this.Preferences.ContainsKey("ShowAccount")&&"Name"==this.Preferences.ShowAccount?(this.oCodeNameCombo.Name.Column=0,this.oCodeNameCombo.Name.ColumnSpan=2,this.oCodeNameCombo.Name.Visible=!0,this.oCodeNameCombo.Name.CCID=parseInt(m.ColumnCostCenterID)):(this.oCodeNameCombo.Code.Column=0,this.oCodeNameCombo.Name.Column=1,this.oCodeNameCombo.Code.Visible=!0,this.oCodeNameCombo.Name.Visible=!0,this.oCodeNameCombo.Code.CCID=this.oCodeNameCombo.Name.CCID=parseInt(m.ColumnCostCenterID)),this.oCodeNameCombo.Code.Visible&&(this.oCodeNameCombo.Code.CCID=parseInt(m.ColumnCostCenterID),this.oCodeNameCombo.Code.TypeID=10,a.e.Int(m.Decimal)>0&&(this.oCodeNameCombo.Code.TypeID=parseInt(m.Decimal))),this.oCodeNameCombo.Name.Visible&&(this.oCodeNameCombo.Name.CCID=parseInt(m.ColumnCostCenterID),this.oCodeNameCombo.Name.TypeID=0==m.ColumnCCListViewTypeID.toString().trim().length?1:parseInt(m.ColumnCCListViewTypeID),10==this.oCodeNameCombo.Name.TypeID&&(this.oCodeNameCombo.Name.TypeID=100)),this.DivisionID>0&&n.a.SessionManager.Preferences.ContainsKey("DW Accounts")&&"True"==n.a.SessionManager.Preferences["DW Accounts"].toString()&&(this.oCodeNameCombo.Code.DivisionId=this.oCodeNameCombo.Name.DivisionId=this.DivisionID),this.LocationID>0&&n.a.SessionManager.Preferences.ContainsKey("LW Accounts")&&"True"==n.a.SessionManager.Preferences["LW Accounts"].toString()&&(this.oCodeNameCombo.Code.LocationID=this.oCodeNameCombo.Name.LocationID=this.LocationID),this.oCodeNameCombo.Code.CustomWhere=this.oCodeNameCombo.Name.CustomWhere=a.e.String(m.UserProbableValues),(3==n.a.SessionManager.RoleType&&"DebitAccount"==m.SysColumnName||2==n.a.SessionManager.RoleType&&"CreditAccount"==m.SysColumnName)&&(this.oCodeNameCombo.Code.CustomWhere.length>0&&(this.oCodeNameCombo.Code.CustomWhere+=" and "),this.oCodeNameCombo.Code.CustomWhere+=" a.AccountID="+n.a.SessionManager.ESSID,this.oCodeNameCombo.Name.CustomWhere=this.oCodeNameCombo.Code.CustomWhere),this.oCodeNameCombo.Code.InitCustomWhere=this.oCodeNameCombo.Name.InitCustomWhere=this.oCodeNameCombo.Code.CustomWhere,this.SetProperties_Custom(m,this.oCodeNameCombo,s),this.oCodeNameCombo.Code.DBColumnName=this.oCodeNameCombo.Name.DBColumnName=this.oCodeNameCombo.DBColumnName,this.oCodeNameCombo.Code.IsReadOnly=this.oCodeNameCombo.Name.IsReadOnly=this.oCodeNameCombo.IsReadOnly,this.oCodeNameCombo.Code.IsTabStop=this.oCodeNameCombo.Name.IsTabStop=this.oCodeNameCombo.IsTabStop,this.oCodeNameCombo.Name.Mandatory=this.oCodeNameCombo.Mandatory,this.oCodeNameCombo.Code.Mode=this.oCodeNameCombo.Name.Mode=this.oCodeNameCombo.Mode,this.oCodeNameCombo.Code.KeyTip=this.oCodeNameCombo.Name.KeyTip=this.oCodeNameCombo.KeyTip,this.oCodeNameCombo.Code.ToolTipFooterTitle=this.oCodeNameCombo.Name.ToolTipFooterTitle=this.oCodeNameCombo.ToolTipFooterTitle,this.oCodeNameCombo.Code.ToolTipFooterDescription=this.oCodeNameCombo.Name.ToolTipFooterDescription=this.oCodeNameCombo.ToolTipFooterDescription,this.oCodeNameCombo.Code.ToolTipDescription=this.oCodeNameCombo.Name.ToolTipDescription=this.oCodeNameCombo.ToolTipDescription,this.oCodeNameCombo.Code.ExternExpression=this.oCodeNameCombo.Name.ExternExpression=this.oCodeNameCombo.ExternExpression,m.FetchMaxRows&&(this.oCodeNameCombo.Code.GridViewID=this.oCodeNameCombo.Name.GridViewID=parseInt(m.FetchMaxRows),this.oCodeNameCombo.Name.GridViewID>0&&this.oCodeNameCombo.Enable&&(38==this.DocumentType||39==this.DocumentType)&&(this.oCodeNameCombo.Name.SearchVisible=!0)),t.push(this.oCodeNameCombo);else if("1"==m.Cformula&&m.SysColumnName.toLowerCase().Contains("dcccnid")&&parseInt(m.ColumnCostCenterID)>0){let e=new c.a(parseInt(m.CostCenterColID));e.CCID=parseInt(m.ColumnCostCenterID),e.TypeID=0==m.ColumnCCListViewTypeID.toString().trim().length?1:parseInt(m.ColumnCCListViewTypeID),e.ParentCostCenterID=this.CostCenterID,this.SetProperties_Custom(m,e,s),t.push(e)}else if(!a.e.IsEmpty(m.Decimal)&&parseFloat(m.Decimal)>0&&m.SysColumnName.toLowerCase().Contains("dcccnid")&&parseInt(m.ColumnCostCenterID)>0)this.oCodeNameCombo=new D.a(parseInt(m.CostCenterColID)),this.oCodeNameCombo.Code.TypeID=parseInt(m.Decimal),this.oCodeNameCombo.Name.TypeID=parseInt(m.ColumnCCListViewTypeID),this.oCodeNameCombo.SelectionCallBack.Subscribe(this,"OnGetReference"),this.oCodeNameCombo.Code.Visible=this.oCodeNameCombo.Name.Visible=!1,this.oCodeNameCombo.Code.Column=0,this.oCodeNameCombo.Name.Column=1,this.oCodeNameCombo.Code.Visible=!0,this.oCodeNameCombo.Name.Visible=!0,this.oCodeNameCombo.Code.CCID=this.oCodeNameCombo.Name.CCID=parseInt(m.ColumnCostCenterID),this.oCodeNameCombo.Code.Visible&&(this.oCodeNameCombo.Code.CCID=parseInt(m.ColumnCostCenterID),this.oCodeNameCombo.Code.TypeID=parseInt(m.Decimal)),this.oCodeNameCombo.Name.Visible&&(this.oCodeNameCombo.Name.CCID=parseInt(m.ColumnCostCenterID),this.oCodeNameCombo.Name.TypeID=0==m.ColumnCCListViewTypeID.toString().trim().length?1:parseInt(m.ColumnCCListViewTypeID)),this.SetProperties_Custom(m,this.oCodeNameCombo,s),this.oCodeNameCombo.Code.DBColumnName=this.oCodeNameCombo.Name.DBColumnName=this.oCodeNameCombo.DBColumnName,this.oCodeNameCombo.Code.IsReadOnly=this.oCodeNameCombo.Name.IsReadOnly=this.oCodeNameCombo.IsReadOnly,this.oCodeNameCombo.Code.IsTabStop=this.oCodeNameCombo.Name.IsTabStop=this.oCodeNameCombo.IsTabStop,this.oCodeNameCombo.Code.Mandatory=this.oCodeNameCombo.Name.Mandatory=this.oCodeNameCombo.Mandatory,this.oCodeNameCombo.Code.Mode=this.oCodeNameCombo.Name.Mode=this.oCodeNameCombo.Mode,this.oCodeNameCombo.Code.KeyTip=this.oCodeNameCombo.Name.KeyTip=this.oCodeNameCombo.KeyTip,this.oCodeNameCombo.Code.ToolTipFooterTitle=this.oCodeNameCombo.Name.ToolTipFooterTitle=this.oCodeNameCombo.ToolTipFooterTitle,this.oCodeNameCombo.Code.ToolTipFooterDescription=this.oCodeNameCombo.Name.ToolTipFooterDescription=this.oCodeNameCombo.ToolTipFooterDescription,this.oCodeNameCombo.Code.ToolTipDescription=this.oCodeNameCombo.Name.ToolTipDescription=this.oCodeNameCombo.ToolTipDescription,this.oCodeNameCombo.Code.ExternExpression=this.oCodeNameCombo.Name.ExternExpression=this.oCodeNameCombo.ExternExpression,m.FetchMaxRows&&(this.oCodeNameCombo.Code.GridViewID=this.oCodeNameCombo.Name.GridViewID=parseInt(m.FetchMaxRows),this.oCodeNameCombo.Code.GridViewID>0&&this.oCodeNameCombo.Enable&&(38==this.DocumentType||39==this.DocumentType)&&(this.oCodeNameCombo.Code.SearchVisible=!0,this.oCodeNameCombo.Name.SearchVisible=!0)),t.push(this.oCodeNameCombo);else{if(n.a.SessionManager.Preferences.ContainsKey("Use Foreign Currency")&&!Object(S.j)(n.a.SessionManager.Preferences["Use Foreign Currency"])&&12==parseInt(m.ColumnCostCenterID))return;if(this.oPactCombo=new c.b(parseInt(m.CostCenterColID)),this.oPactCombo.CCID=parseInt(m.ColumnCostCenterID),this.oPactCombo.OnPactListBoxValueChanged.Subscribe(this,"OnGetReference"),a.e.IsEmpty(m.CrFilter),this.oPactCombo.CrFilter=parseInt(m.CrFilter),a.e.IsEmpty(m.DbFilter)||(this.oPactCombo.DbFilter=parseInt(m.DbFilter)),a.e.IsEmpty(m.Accountfilterinuse)||(this.oPactCombo.AccDimInUse=Object(S.j)(m.Accountfilterinuse)),this.oPactCombo.TypeID=0==m.ColumnCCListViewTypeID.toString().trim().length?1:parseInt(m.ColumnCCListViewTypeID),a.e.IsEmpty(m.FetchMaxRows)||(this.oPactCombo.GridViewID=parseInt(m.FetchMaxRows)),this.SetProperties_Custom(m,this.oPactCombo,s),5!=this.DocumentType&&8!=this.DocumentType&&13!=this.DocumentType||!this.Preferences.ContainsKey("BudgetFeild")||this.oPactCombo.DBColumnName.toLowerCase()!=this.Preferences.BudgetFeild.toLowerCase()||(this.oPactCombo.CustomWhere="a.FinYearStartDate>=convert(float,convert(datetime,'"+n.a.SessionManager.FinancialYearStartDate.ToString("dd/MMM/yyyy")+"'))"),this.oPactCombo.GridViewID>0&&this.oPactCombo.Enable&&(38==this.DocumentType||39==this.DocumentType)&&(this.oPactCombo.SearchVisible=!0),this.oPactCombo.CCID==n.a.SessionManager.RegisterCCID&&this.RegisterNodeID>0&&(this.oPactCombo.DefaultValue=this.RegisterNodeID.toString()),n.a.SessionManager.Preferences.ContainsKey("PosShifts")&&""!=n.a.SessionManager.Preferences.PosShifts.toString()&&parseInt(n.a.SessionManager.Preferences.PosShifts)==this.oPactCombo.CCID&&this.ShiftNodeID>0&&(this.oPactCombo.DefaultValue=this.ShiftNodeID.toString()),t.push(this.oPactCombo),!n.a.SessionManager.Preferences.ContainsKey("EnableDivisionWise")||"True"!=n.a.SessionManager.Preferences.EnableDivisionWise.toString()||this.Preferences.ContainsKey("Donotusedivision")&&""!=this.Preferences.Donotusedivision&&Object(S.j)(this.Preferences.Donotusedivision)||null==this.oPactCombo||50001!=this.oPactCombo.CCID||this.oPactCombo.DBColumnName.toLowerCase().Contains("alpha")||(this.DivisionID>0?this.oPactCombo.DefaultValue=this.DivisionID.toString():n.a.SessionManager.DivisionID>0&&(this.oPactCombo.DefaultValue=n.a.SessionManager.DivisionID.toString()),this.oPactCombo.Enable=!1),!n.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")||"True"!=n.a.SessionManager.Preferences.EnableLocationWise.toString()||this.Preferences.ContainsKey("Donotuselocation")&&""!=this.Preferences.Donotuselocation&&Object(S.j)(this.Preferences.Donotuselocation)||null==this.oPactCombo||50002!=this.oPactCombo.CCID||this.oPactCombo.DBColumnName.toLowerCase().Contains("alpha")||(this.LocationID>0?this.oPactCombo.DefaultValue=this.LocationID.toString():n.a.SessionManager.LocationID>0&&(this.oPactCombo.DefaultValue=n.a.SessionManager.LocationID.toString()),this.oPactCombo.Enable=!1),this.oPactCombo.DBColumnName.toLowerCase().Contains("ccnid")&&this.oPactCombo.IsColumnUserDefined&&5==this.DocumentType&&a.e.Int(m.IsTransfer)>0){let i=new c.b(parseInt(m.CostCenterColID));i.CCID=parseInt(m.ColumnCostCenterID),i.TypeID=0==m.ColumnCCListViewTypeID.toString().trim().length?1:parseInt(m.ColumnCCListViewTypeID),this.SetProperties_Custom(m,i,s),a.e.String(m.UserDefaultValue).Contains(",")?(i.DefaultValue=Object(g.isNullOrUndefined)(m.UserDefaultValue)?"":m.UserDefaultValue.toString().split(",")[1],this.SetProperty_DefaultValue(i,!1)):null!=i.DefaultValue&&""!=i.DefaultValue&&(i.DefaultValue="",i.SelectedValue=0),this.oPactCombo.SelectedValue>0&&(i.CustomWhere=this.GetCustomWhere(this.oPactCombo.CCID,this.oPactCombo.SelectedValue)),2!=parseInt(m.IsTransfer)&&4!=parseInt(m.IsTransfer)||(i.ExcludeFilter=!0),3!=parseInt(m.IsTransfer)&&4!=parseInt(m.IsTransfer)||(this.oPactCombo.ExcludeFilter=!0);let o=0,r=0,l=1,u=-1;a.e.IsEmpty(m.RowNo)||(r=parseInt(m.RowNo)),a.e.IsEmpty(m.ColumnNo)||(o=parseInt(m.ColumnNo)),a.e.IsEmpty(m.ColumnSpan)||(l=parseInt(m.ColumnSpan)),3==o?(o=0,r+=1):o+=1,i.Row=r,i.Column=o,i.ColumnSpan=l;let D=e.filter(e=>"2"==e.SectionID&&e.SectionSeqnumber>(a.e.IsEmpty(m.SectionSeqnumber)?"0":m.SectionSeqnumber.toString()));if(null!=D&&D.length>0)for(let t=0;t<D.length;t++){u=parseInt(D[t].CostCenterColID),3==o?(o=0,r+=1):o+=1;for(let t=0;t<e.length;t++)if(u.toString()==e[t].CostCenterColID.toString()){e[t].RowNo=r.toString(),e[t].ColumnNo=o.toString();break}}i.Label=n.a.GetResource("StockTransferTo")+this.oPactCombo.Label,this.oPactCombo.Label=n.a.GetResource("StockTransferFrom")+this.oPactCombo.Label,i.Lbl="To"+m.UserColumnName.toString(),this.oPactCombo.Lbl="From"+m.UserColumnName.toString(),i.DBColumnName="TO"+this.oPactCombo.DBColumnName,m.FetchMaxRows&&(i.GridViewID=parseInt(m.FetchMaxRows)),t.push(i)}(this.oPactCombo.CCID>5e4||61==this.oPactCombo.CCID)&&!a.e.IsEmpty(m.Filter)&&parseInt(m.Filter)>0&&(this.FilterFields.push({Key:this.oPactCombo,Value:parseInt(m.Filter)}),a.e.IsEmpty(m.Productfilterinuse)?this.ProdFilterinuse.ContainsKey(this.oPactCombo.CCID)||this.ProdFilterinuse.push(this.oPactCombo.CCID,!1):this.ProdFilterinuse.ContainsKey(this.oPactCombo.CCID)||this.ProdFilterinuse.push(this.oPactCombo.CCID,Object(S.j)(m.Productfilterinuse)))}break;case"COMBOTEXT":let b=new h.a(parseInt(m.CostCenterColID));this.SetProperties_Custom(m,b,s),t.push(b);break;case"ATTACHMENT":let T=new I.a(parseInt(m.CostCenterColID));this.SetProperties_Custom(m,T,s),t.push(T),this.AttachmentFields.push(T);break;case"LINK":let P=new C.a(parseInt(m.CostCenterColID));P.LinkCombo.Items.push(u.d.ComboBoxItems_2("A","1")),this.SetProperties_Custom(m,P,s),t.push(P)}})}SetProperties_Custom(e,t,s=!1){if(t.Label=a.e.String(e.ResourceData),t.Lbl=a.e.String(e.UserColumnName),a.e.IsEmpty(e.IsMandatory)||(t.Mandatory=Object(S.j)(e.IsMandatory)),Object(g.isNullOrUndefined)(e.IsVisible)||(t.Visible=Object(S.j)(e.IsVisible)),e.ColumnDataType&&(t.DataType=e.ColumnDataType.toString().toUpperCase()),t.IsColumnUserDefined=!!e.IsColumnUserDefined&&Object(S.j)(e.IsColumnUserDefined),(e.SysColumnName.toLowerCase().Contains("dcalpha")||e.SysColumnName.toLowerCase().Contains("dcnum"))&&(t.IsColumnUserDefined=!0),t.DBColumnName=e.SysColumnName,t.DBColumnName.toLowerCase().Contains("ccnid")&&t.IsColumnUserDefined&&5==this.DocumentType&&!Object(g.isNullOrUndefined)(e.UserDefaultValue)&&e.UserDefaultValue.toString().Contains(",")?""!=e.UserDefaultValue.toString().split(",")[0]&&(t.DefaultValue=e.UserDefaultValue.toString().split(",")[0]):t.DefaultValue=t instanceof c.b&&t.DBColumnName.toLowerCase().Contains("ccnid")&&t.IsColumnUserDefined&&!a.e.IsEmpty(e.UserDefaultValue)?e.UserDefaultValue.toString():Object(g.isNullOrUndefined)(e.UserDefaultValue)?"":e.UserDefaultValue.toString(),t.SectionID=Object(g.isNullOrUndefined)(e.SectionID)?"":e.SectionID.toString(),t.tabname=Object(g.isNullOrUndefined)(e.SectionName)?"":e.SectionName.toString(),Object(g.isNullOrUndefined)(e.IsEditable)||a.e.IsEmpty(e.IsEditable)||(t.IsReadOnly=!Object(S.j)(e.IsEditable)),e.Formula&&(t.Formula=e.Formula.toString()),e.isnotab&&(t.IsTabStop=!Object(S.j)(e.isnotab)),e.RowNo&&(t.Row=parseInt(e.RowNo)),e.ColumnNo&&(t.Column=parseInt(e.ColumnNo)),e.ColumnSpan&&(t.ColumnSpan=parseInt(e.ColumnSpan)),"NUMERIC"==e.UserColumnType.toString().toUpperCase()&&(t.DataType="FLOAT",!a.e.IsEmpty(e.Decimal)&&parseFloat(e.Decimal)>=0&&(t.DecimalPoints=e.Decimal.toString())),e.Calculate&&(t.Calculate=Object(S.j)(e.Calculate)),e.Mode&&(t.Mode=parseInt(e.Mode)),e.Shortcut&&(t.KeyTip=e.Shortcut),e.SpName&&(t.ToolTipFooterTitle=e.SpName.toString()),e.IpParams&&(t.ToolTipFooterDescription=e.IpParams.toString()),e.OpParams&&(t.ToolTipDescription=e.OpParams.toString()),e.Expression&&(t.ExternExpression=e.Expression.toString()),(t instanceof c.b||t instanceof D.a)&&!a.e.IsEmpty(e.dependanton)&&"0"!=e.dependanton.toString()){let s=null;s=83==parseInt(e.dependanton)||parseInt(e.dependanton)>5e4&&parseInt(e.dependanton)<50100?this.Data.Tables[0].filter(t=>t.ColumnCostCenterID==e.dependanton):this.Data.Tables[0].filter(t=>t.CostCenterColID==e.dependanton),null!=s&&s.length>0&&(t.DependantOn=s[0].SysColumnName.toString(),a.e.IsEmpty(e.dependancy)||(t.Dependancy=parseInt(e.dependancy)),a.e.IsEmpty(e.filterinuse)||(t.Dependantinuse=Object(S.j)(e.filterinuse)),a.e.IsEmpty(e.UserProbableValues)||(t.ToolTipTitle=e.UserProbableValues.toString()))}if(!a.e.IsEmpty(e.TextFormat)&&(t instanceof r.c||t instanceof r.d||t instanceof o.a)){let s=0;s=a.e.Int(e.TextFormat),(t instanceof r.d||t instanceof r.c||t instanceof o.a)&&(2==s?t.IsAllCaps=!0:3==s&&(t.IsFirstLetterCaps=!0))}if(t instanceof r.d&&("INT"==t.DataType||"FLOAT"==t.DataType?t.Align="Right":a.e.IsEmpty(e.IgnoreChars)||(t.IgnoreChars=e.IgnoreChars.toString()),a.e.IsEmpty(e.WaterMark)||(t.WaterMark=e.WaterMark.toString())),"VoucherNo"==t.DBColumnName)this.DocPrefix=t,this.Data.Tables[4].forEach(e=>{this.DocPrefix.ComboBox.Items.push(u.d.ComboBoxItems_4(e.CodePrefix.toString(),e.CodePrefix.toString(),"",e.CodeNumberLength.toString()))}),this.DocPrefix.ComboBox.Items.length>0&&!(this.Data.Tables.length>8&&this.Data.Tables[8].length>0)&&(this.DocPrefix.ComboBox.SelectedItem=this.DocPrefix.ComboBox.Items[0],this.DocPrefix.ComboBox.SelectedValue=this.Data.Tables[4][0].CodePrefix.toString()),n.a.SessionManager.RoleType>0&&(t.IsReadOnly=!0);else if("DocDate"==t.DBColumnName)this.DocDate=t;else if("DueDate"==t.DBColumnName)this.DueDate=t,e.Formula&&(this.DueDate.Formula=e.Formula.toString());else if("BillNo"==t.DBColumnName){if(this.Preferences.ContainsKey("Hide_Billno")&&"True"==this.Preferences.Hide_Billno)return!1;this.BillNo=t}else if("BillDate"==t.DBColumnName){if(this.Preferences.ContainsKey("Hide_Billno")&&"True"==this.Preferences.Hide_Billno)return!1;this._StaticFields.push(t)}else if("StatusID"==t.DBColumnName)this.Status=t;else if("CurrencyID"==t.DBColumnName||"ExchangeRate"==t.DBColumnName){n.a.SessionManager.Preferences.ContainsKey("Use Foreign Currency")&&!Object(S.j)(n.a.SessionManager.Preferences["Use Foreign Currency"])&&(t.Visible=!1);let e=this.Data.Tables[0].filter(e=>"ExchangeRate"==e.SysColumnName);e.length>0&&!a.e.IsEmpty(e[0].IsEditable)&&t instanceof h.b&&(t.ExchangeRate.IsReadOnly=!Object(S.j)(e[0].IsEditable),t.ExchangeRate.DBColumnName="ExchangeRate")}else t.IsColumnUserDefined&&"batchid"!=t.DBColumnName.toLowerCase()?s||(e.SysColumnName.toLowerCase().Contains("dcalpha")?this._TextFields.push(t):"LISTBOX"==e.UserColumnType.toString()?this._CCFields.push(t):(a.e.IsEmpty(e.DebitAccount)||(t.DebitAccount=parseInt(e.DebitAccount)),a.e.IsEmpty(e.CreditAccount)||(t.CreditAcount=parseInt(e.CreditAccount)),a.e.IsEmpty(e.PostingType)||(t.PostingType=parseInt(e.PostingType)),this._numericFields.push(t))):s||this._StaticFields.push(t);return t instanceof l.b&&(a.e.IsNullOrWhiteSpace(e.UserProbableValues)||(t.CustomFormat=e.UserProbableValues.toString()),a.e.IsNullOrWhiteSpace(e.UserDefaultValue)||(t.Text=e.UserDefaultValue.toString())),this.SetProperty_DefaultValue(t,!1),!0}GetCostcenterName(e){let t=n.a.common.GetDataSet("DOC004",e.toString());return null!=t&&t.Tables.length>0&&t.Columns[0].Contains("Name")&&t.Tables[0].length>0?t.Tables[0][0].Name.toString():""}GetCCNames(e){return n.a.common.GetDataSet("DOC005",e.toString())}IsValidSelection(e,t){if(null!=e&&e.SelectedValue>0){let s=t.CCID+","+e.CCID+","+e.SelectedValue+","+t.SelectedValue;s+=","+(t.Dependantinuse?"1":"0")+","+t.Dependancy;let i=n.a.common.GetDataSet("DOC011",s);if(null!=i&&i.Tables.length>0&&i.Tables[0].length>0&&"0"==a.e.StringValue(i.Tables[0][0][i.Columns[0][0]]))return!1}return!0}GetDocNumberString(e,t,s){let a=n.a.common.GetDataSet3("DOC003",e,t.toString(),s.toString());return a&&a.Tables.length>0&&a.Columns[0].Contains(e)&&a.Tables[0].length>0?a.Tables[0][0][e].toString():""}GetCodeNameString(e,t,s){let i=n.a.common.GetDataSet3("DOC049",e.toString(),t.toString());return null!=i&&i.Tables.length>0&&s.startsWith("-")&&i.Columns[0].Contains("Code")&&i.Tables[0].length>0?a.e.String(i.Tables[0][0].Code):null!=i&&i.Tables.length>0&&!s.startsWith("-")&&i.Columns[0].Contains("Name")&&i.Tables[0].length>0?a.e.String(i.Tables[0][0].Name):""}GetPrimaryKey(e){return 2==e?"AccountID":3==e?"ProductID":"NodeID"}GetTableName(e){return 2==e?"ACC_Accounts":3==e?"INV_Product":50001==e?"COM_Division":50002==e?"COM_Location":50003==e?"COM_Branch":50004==e?"COM_Department":50005==e?"COM_Salesman":50006==e?"COM_Category":50007==e?"COM_Area":50008==e?"COM_Teritory":"COM_CC"+e}SetProperty_DefaultValue(e,t){if(e instanceof r.d&&(e.Text=e.DefaultValue),e instanceof r.c)e.Text=e.DefaultValue;else if(e instanceof h.b)a.e.IsEmpty(e.DefaultValue)||"0"==e.DefaultValue?(e.Currency.SelectedValue="1",e.ExchangeRate.Text="1"):(e.Currency.SelectedValue=e.DefaultValue,e.ExchangeRate.Text=null!=this.DocDate?this.GetExchangeRate(parseInt(e.Currency.SelectedValue),this.DocDate.Date).toString():this.GetExchangeRate(parseInt(e.Currency.SelectedValue),Date.Today()).toString());else if(e instanceof u.e)e.SelectedValue=a.e.IsEmpty(e.DefaultValue)?"":e.DefaultValue;else if(e instanceof c.b)if(!a.e.IsEmpty(e.DefaultValue)&&a.e.Int(e.DefaultValue)>0){let t;e.PreviousSelectedValue=parseInt(e.DefaultValue),e.SelectedValue=parseInt(e.DefaultValue),t=null!=this.DocDate?this.DocDate.Date:new Date}else e.Visible||e.Mandatory?(e.PreviousSelectedValue=0,e.SelectedValue=0,e.Text=""):(e.PreviousSelectedValue=1,e.SelectedValue=1,e.Text="");else if(e instanceof c.a){let t=e;t.Clear(),50001==t.CCID&&(n.a.SessionManager.DivisionID>0||this.DivisionID>0)?this.DivisionID>0?(e.DefaultValue=this.DivisionID.toString(),t.SetValue(this.DivisionID)):(e.DefaultValue=n.a.SessionManager.DivisionID.toString(),t.SetValue_2(n.a.SessionManager.DivisionID,n.a.SessionManager.DivisionName)):50002==t.CCID&&(n.a.SessionManager.LocationID>0||this.LocationID>0)?this.LocationID>0?(e.DefaultValue=this.LocationID.toString(),t.SetValue(this.LocationID)):(e.DefaultValue=n.a.SessionManager.LocationID.toString(),t.SetValue_2(n.a.SessionManager.LocationID,n.a.SessionManager.LocationName)):a.e.IsEmpty(e.DefaultValue)?t.SetValue(0):""!=e.DefaultValue.trim()&&t.SetValue(parseInt(e.DefaultValue))}else if(e instanceof D.a)if(a.e.IsEmpty(e.DefaultValue))e.Visible||e.Mandatory?(e.PrevSelValu=0,e.SelectedValue=0):(e.PrevSelValu=1,e.SelectedValue=1);else{let t;e.PrevSelValu=parseInt(e.DefaultValue),e.SelectedValue=parseInt(e.DefaultValue),t=null!=this.DocDate?this.DocDate.Date:new Date}else if(e instanceof l.c)e.Date=a.e.IsEmpty(e.DefaultValue)||"today"!=e.DefaultValue.toLowerCase()?a.e.IsEmpty(e.DefaultValue)||"payrollmonth"!=e.DefaultValue.toLowerCase()?a.e.IsEmpty(e.DefaultValue)||"payrollmonthstart"!=e.DefaultValue.toLowerCase()?a.e.IsEmpty(e.DefaultValue)||"payrollmonthend"!=e.DefaultValue.toLowerCase()?a.e.IsEmpty(e.DefaultValue)||"latesmonth"!=e.DefaultValue.toLowerCase()?a.e.IsEmpty(e.DefaultValue)||"latesmonthstart"!=e.DefaultValue.toLowerCase()?a.e.IsEmpty(e.DefaultValue)||"latesmonthend"!=e.DefaultValue.toLowerCase()?e.Visible&&"ChequeDate"==e.DBColumnName&&"docdate"==e.DefaultValue.toLowerCase()&&this.DocDate?this.DocDate.Date:a.e.isValidDate(e.DefaultValue)?new Date(e.DefaultValue):null:n.a.SessionManager.LatesMonthEnd:n.a.SessionManager.LatesMonthStart:n.a.SessionManager.LatesMonth:n.a.SessionManager.PayrollMonthEnd:n.a.SessionManager.PayrollMonthStart:n.a.SessionManager.PayrollMonth:new Date;else if(e instanceof l.b)e.Date=a.e.IsEmpty(e.DefaultValue)||"today"!=e.DefaultValue.toLowerCase()?a.e.IsEmpty(e.DefaultValue)||"payrollmonth"!=e.DefaultValue.toLowerCase()?a.e.IsEmpty(e.DefaultValue)||"payrollmonthstart"!=e.DefaultValue.toLowerCase()?a.e.IsEmpty(e.DefaultValue)||"payrollmonthend"!=e.DefaultValue.toLowerCase()?a.e.IsEmpty(e.DefaultValue)||"latesmonth"!=e.DefaultValue.toLowerCase()?a.e.IsEmpty(e.DefaultValue)||"latesmonthstart"!=e.DefaultValue.toLowerCase()?a.e.IsEmpty(e.DefaultValue)||"latesmonthend"!=e.DefaultValue.toLowerCase()?a.e.isValidDate(e.DefaultValue)?new Date(e.DefaultValue):null:n.a.SessionManager.LatesMonthEnd:n.a.SessionManager.LatesMonthStart:n.a.SessionManager.LatesMonth:n.a.SessionManager.PayrollMonthEnd:n.a.SessionManager.PayrollMonthStart:n.a.SessionManager.PayrollMonth:new Date;else if(e instanceof l.a)e.Date=a.e.isValidDate(e.DefaultValue)?new Date(e.DefaultValue):new Date;else if(e instanceof o.a)e.Text=e.DefaultValue;else if(e instanceof I.a){let t=e;t.IsChanged=!1,t.IsDelete=!1,t.ActualFileName=t.AccountPhoto="",t.guid="",t.FileID=0}}GetExtraAttachmentXML(e=!1){let t="";return this.AttachmentFields.forEach(e=>{e.IsChanged&&!a.e.IsEmpty(e.AccountPhoto)?(t+=0==e.FileID?'<Row Action="NEW"':'<Row Action="MODIFY"',n.a.SessionManager.IsWebApplication&&(t+=' AttachmentID="'+e.FileID+'"',t+=' FilePath="'+e.AccountPhoto+'"',t+=' ActualFileName="'+e.AccountPhoto.substr(e.AccountPhoto.lastIndexOf("\\")+1)+'"',t+=' RelativeFileName="'+e.AccountPhoto+'"',t+=' FileExtension="'+e.FileExtension+'"',t+=' FileDescription=""',t+=' IsProductImage="0"',t+=' AllowInPrint="0"',t+=' IsDefaultImage="100"',t+=' ColName="'+e.DBColumnName+'"',t+=' GUID="'+e.guid+'"',t+="/>")):e.IsDelete&&e.FileID>0&&(t+='<Row Action="DELETE"',t+=' AttachmentID="'+e.FileID+'"/>')}),t.length>0&&!e&&(t="<AttachmentsXML>"+t+"</AttachmentsXML>"),t}IsBillWiseAccount(e){let t=[];return t.push(e),t.push(n.a.SessionManager.UserID),t.push(n.a.SessionManager.LanguageID),n.a.document.IsAccountBillWise(t)}CheckIsBillWise(e){return n.a.common.GetDataSet("DOC026",e)}CheckCreditLimit(e,t,s,a){Logger.InfoLog("VoucherGenerator:: Inside CheckCreditLimit");let i=[];i.push(e),i.push(s.ToString("dd/MMM/yyyy")),i.push(this.DocID),i.push(this.CostCenterID),i.push(t),n.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&Object(S.j)(n.a.SessionManager.Preferences.EnableLocationWise)?i.push(this.LocationID>0?this.LocationID:n.a.SessionManager.LocationID):i.push(0),n.a.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&Object(S.j)(n.a.SessionManager.Preferences.EnableDivisionWise)?i.push(this.DivisionID>0?this.DivisionID:n.a.SessionManager.DivisionID):i.push(0),i.push(a),i.push(n.a.SessionManager.UserID),i.push(n.a.SessionManager.LanguageID);let o=n.a.document.CheckCreditLimit(i);return Logger.InfoLog("VoucherGenerator:: Exiting CheckCreditLimit"),o}GetCaseLinkDetails(e){Logger.InfoLog("VoucherGenerator:: Inside GetCaseLinkDetails");let t=[];return t.push(e),t.push(n.a.SessionManager.UserID),t.push(n.a.SessionManager.LanguageID),Logger.InfoLog("VoucherGenerator:: Exiting GetCaseLinkDetails"),n.a.document.GetCaseLinkDetails(t)}GetAttachments(e,t){let s=[];return s.push(e),s.push(t),s.push(n.a.SessionManager.UserID),s.push(n.a.SessionManager.LanguageID),n.a.document.GetCostCenterNodeFiles(s)}GetLinkParams(e,t,s,i){let o=[];o.push(e),n.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"True"==n.a.SessionManager.Preferences.EnableLocationWise.toString()&&n.a.SessionManager.Preferences.ContainsKey("LocationWiseLinking")&&"True"==n.a.SessionManager.Preferences.LocationWiseLinking.toString()?o.push(this.LocationID>0?this.LocationID:n.a.SessionManager.LocationID>0?n.a.SessionManager.LocationID:0):o.push(0),n.a.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&"True"==n.a.SessionManager.Preferences.EnableDivisionWise.toString()&&n.a.SessionManager.Preferences.ContainsKey("DivisionWiseLinking")&&"True"==n.a.SessionManager.Preferences.DivisionWiseLinking.toString()?o.push(this.DivisionID>0?this.DivisionID:n.a.SessionManager.DivisionID>0?n.a.SessionManager.DivisionID:0):o.push(0),i&&o.push(""==t?null:t),o.push(""==s?null:s),o.push(this.DocID),(this.Preferences.ContainsKey("Debit Account")&&Object(S.j)(this.Preferences["Debit Account"])||this.Preferences.ContainsKey("LinkVendorProducts")&&Object(S.j)(this.Preferences.LinkVendorProducts))&&null!=this.DebitAccount?o.push(null!=this.DebitAccount&&null!=this.DebitAccount.SelectedValue&&this.DebitAccount.SelectedValue>0?this.DebitAccount.SelectedValue:0):o.push(0),(this.Preferences.ContainsKey("Credit Account")&&Object(S.j)(this.Preferences["Credit Account"])||this.Preferences.ContainsKey("LinkVendorProducts")&&Object(S.j)(this.Preferences.LinkVendorProducts))&&null!=this.CreditAccount?o.push(null!=this.CreditAccount&&null!=this.CreditAccount.SelectedValue&&this.CreditAccount.SelectedValue>0?this.CreditAccount.SelectedValue:0):o.push(0);let r="",l=0;return this.Preferences.ContainsKey("DimensionWise")&&""!=this.Preferences.DimensionWise&&this.Preferences.DimensionWise.split(",").forEach(e=>{if(a.e.IsNum(e)&&parseInt(e)>0)if(l=parseInt(e),3==l)(t=this._TextFields.find(e=>e instanceof c.b&&3==e.CCID))&&(r+=null!=t.SelectedValue&&t.SelectedValue>0?" and "+t.DBColumnName+"="+t.SelectedValue.toString():" and "+t.DBColumnName+"=0");else if(l>5e4){var t;(t=this._CCFields.find(e=>e instanceof c.b&&e.CCID==l))&&(r+=null!=t.SelectedValue&&t.SelectedValue>0?" and "+t.DBColumnName+"="+t.SelectedValue.toString():" and "+t.DBColumnName+"=0")}}),o.push(r),o.push(n.a.SessionManager.UserID),i&&(o.push(n.a.SessionManager.LanguageID),o.push(n.a.SessionManager.RoleID)),o}GetLinkDetails(e,t,s){Logger.InfoLog("VoucherGenerator:: Inside GetLinkDetails");let a=this.GetLinkParams(e,t,s,!0),i=n.a.document.GetLinkDetails(a);return Logger.InfoLog("VoucherGenerator:: Exiting GetLinkDetails"),i}GetSubtituteProducts(e,t,s,i){let o=[];o.push(e);let r="<XML>";for(let n=0;n<this._CCFields.length;n++){let e=this._CCFields[n];e instanceof c.b&&e.DBColumnName.Contains("TO")&&5==this.DocumentType||e instanceof c.b&&e.SelectedValue>0&&(r+='<Row CostCenterID="'+e.CCID+'" NODEID="'+e.SelectedValue.toString()+'" />')}return this.ColumnSource.forEach(e=>{null!=e.CostCenterID&&e.CostCenterID>5e4&&this.GridDataColumns.Contains(e.ValueMember)&&(a.e.IsEmpty(i[e.ValueMember])?a.e.IsEmpty(i[e.DisplayMember])||(r+='<Row CostCenterID="'+e.CostCenterID+'" NODEID="'+i[e.DisplayMember].toString()+'" />'):r+='<Row CostCenterID="'+e.CostCenterID+'" NODEID="'+i[e.ValueMember].toString()+'" />')}),(1==this.DocumentType||2==this.DocumentType||10==this.DocumentType||26==this.DocumentType||27==this.DocumentType||3==this.DocumentType||4==this.DocumentType||25==this.DocumentType||13==this.DocumentType)&&null!=this.CreditAccount&&this.CreditAccount.SelectedValue>0?r+='<Row CostCenterID="2" NODEID="'+this.CreditAccount.SelectedValue.toString()+'" />':(11==this.DocumentType||38==this.DocumentType||39==this.DocumentType||6==this.DocumentType||7==this.DocumentType||8==this.DocumentType||9==this.DocumentType||12==this.DocumentType||24==this.DocumentType)&&null!=this.DebitAccount&&this.DebitAccount.SelectedValue>0&&(r+='<Row CostCenterID="2" NODEID="'+this.DebitAccount.SelectedValue.toString()+'" />'),r+="</XML>",o.push(r),o.push(null!=t?t.ToString("dd/MMM/yyyy"):(new Date).ToString("dd/MMM/yyyy")),o.push(""!=s?s:0),o.push(this.CostCenterID),o.push(n.a.SessionManager.UserID),o.push(n.a.SessionManager.LanguageID),n.a.document.GetSubtituteProducts(o)}GetProductLinkDetails(e,t,s,i,o){Logger.InfoLog("VoucherGenerator:: Inside GetProductLinkDetails");let r=[];r.push(e),r.push(t),n.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"True"==n.a.SessionManager.Preferences.EnableLocationWise.toString()?r.push(this.LocationID>0?this.LocationID:n.a.SessionManager.LocationID>0?n.a.SessionManager.LocationID:0):r.push(0),n.a.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&"True"==n.a.SessionManager.Preferences.EnableDivisionWise.toString()?r.push(this.DivisionID>0?this.DivisionID:n.a.SessionManager.DivisionID>0?n.a.SessionManager.DivisionID:0):r.push(0),r.push(""==s?null:s),r.push(""==i?null:i);let l="";return this.Preferences.ContainsKey("DimensionWise")&&""!=this.Preferences.DimensionWise.toString()&&this.Preferences.DimensionWise.split(",").forEach(e=>{let t;if(a.e.Int(e)>0)if(t=parseInt(e),3==t)(s=this._TextFields.find(e=>e instanceof c.b&&3==e.CCID))instanceof c.b&&(l+=s.SelectedValue>0?" and "+s.DBColumnName+"="+s.SelectedValue.toString():" and "+s.DBColumnName+"=0");else if(t>5e4){var s;(s=this._CCFields.find(e=>e instanceof c.b&&e.CCID==t))instanceof c.b&&(l+=s.SelectedValue>0?" and "+s.DBColumnName+"="+s.SelectedValue.toString():" and "+s.DBColumnName+"=0")}}),r.push(l),this.Preferences.ContainsKey("Debit Account")&&Object(S.j)(this.Preferences["Debit Account"])&&null!=this.DebitAccount?r.push(null!=this.DebitAccount&&null!=this.DebitAccount.SelectedValue&&this.DebitAccount.SelectedValue>0?this.DebitAccount.SelectedValue:0):r.push(0),this.Preferences.ContainsKey("Credit Account")&&Object(S.j)(this.Preferences["Credit Account"])&&null!=this.CreditAccount?r.push(null!=this.CreditAccount&&null!=this.CreditAccount.SelectedValue&&this.CreditAccount.SelectedValue>0?this.CreditAccount.SelectedValue:0):r.push(0),r.push(n.a.SessionManager.UserID),r.push(n.a.SessionManager.LanguageID),n.a.document.GetProductLinkDetails(r)}GetKitProductDetails(e,t,s){let a=[];return a.push(e),a.push(s),a.push(t),a.push(n.a.SessionManager.UserID),a.push(n.a.SessionManager.LanguageID),n.a.document.GetKitProductDetails(a)}GetDenominations(e){Logger.InfoLog("ControlGenerator:: Inside GetScreenInfo");try{return n.a.common.GetDenominationDetails(e)}catch(t){return Logger.ErrorLog("ControlGenerator:: GetScreenInfo"+t.stack),null}}GetdimensionNames(e,t){let s=[];return s.push(e),s.push(1),s.push(t),s.push(n.a.SessionManager.UserID),s.push(n.a.SessionManager.LanguageID),n.a.common.GetCostCenterListViewDataByIDs(n.a.SessionManager.CompanyIndex,s)}getVatInclExcl(e){return n.a.common.GetDataSet("DOC013",e)}GetVatAdvanceAccounts(e){return n.a.common.GetDataSet("DOC012",e)}GetDescXml(){let e=n.a.common.GetDataSet("DOC052",this.VoucherNo);return null!=e&&e.Tables.length>0&&e.Tables[0].length>0?e.Tables[0][0].Description.toString():(Logger.InfoLog("VoucherGenerator:: Exiting GetDescXml"),"")}GetPendingAmount(e,t){return n.a.common.GetDataSet3("DOC053",e,t)}GetCCListViewDataID(e,t,s){let a=[];return a.push(e),a.push(t),a.push(s),a.push(n.a.SessionManager.UserID),a.push(n.a.SessionManager.LanguageID),n.a.document.GetCCListViewDataID(JSON.stringify(a))}GetNames(e,t){return n.a.common.GetDataSet3("DOC027",e,t)}GetDueDate(e,t,s){if(this.IsInventory&&e>0){let i=[];i.push(e),n.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&Object(S.j)(n.a.SessionManager.Preferences.EnableLocationWise)?i.push(this.LocationID>0?this.LocationID:n.a.SessionManager.LocationID):i.push(0),n.a.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&Object(S.j)(n.a.SessionManager.Preferences.EnableDivisionWise)?i.push(this.DivisionID>0?this.DivisionID:n.a.SessionManager.DivisionID):i.push(0);let o=0;if(n.a.SessionManager.Preferences.ContainsKey("DimWiseCreditDebit")&&""!=n.a.SessionManager.Preferences.DimWiseCreditDebit&&parseInt(n.a.SessionManager.Preferences.DimWiseCreditDebit)>0){var a=this._CCFields.find(e=>e.DBColumnName.toLowerCase()=="dcccnid"+(parseInt(n.a.SessionManager.Preferences.DimWiseCreditDebit)-5e4));a&&a instanceof c.b&&a.SelectedValue>0&&(o=a.SelectedValue)}i.push(o);let r=n.a.document.GetDocDueDate(i);null!=r&&r.Tables.length>0&&this.GetDueDate_Table(r.Tables[0],t,s)}}GetDueDate_Table(e,t,s){if(!this.IsInventory)return;if(this.Preferences.ContainsKey("DueDateonBillDate")&&""!=this.Preferences.DueDateonBillDate){let e=this.Preferences.DueDateonBillDate,s=this.HeaderFields.find(t=>t instanceof l.c&&t.DBColumnName.toLowerCase()==e.toLowerCase());s&&s.Date&&(t=s.Date),s=this._TextFields.find(t=>t instanceof l.c&&t.DBColumnName.toLowerCase()==e.toLowerCase()),s&&s.Date&&(t=s.Date)}let n=0,i=0;!s&&e.length>0&&!Object(g.isUndefined)(e[0].DebitDays)?(a.e.IsEmpty(e[0].DebitDays)||(n=parseInt(e[0].DebitDays)),a.e.IsEmpty(e[0].DrOptionID)||(i=parseInt(e[0].DrOptionID))):s&&e.length>0&&!Object(g.isUndefined)(e[0].CreditDays)&&(a.e.IsEmpty(e[0].CreditDays)||(n=parseInt(e[0].CreditDays)),a.e.IsEmpty(e[0].CrOptionID)||(i=parseInt(e[0].CrOptionID)));let o=this.HeaderFields.find(e=>e instanceof l.c&&"DueDate"==e.DBColumnName);null!=o&&(0==i?o.Date=t.AddDays(n):1==i?o.Date=t.AddDays(t.DaysInMonth()-t.getDate()+1):2==i?o.Date=t.AddDays(t.DaysInMonth()-t.getDate()):3==i?(n=(t.getDate()/(n+1)+1)*(n+1),o.Date=n>t.DaysInMonth()?12==t.iMonth()?new Date("1/"+this.GetMonthName(t.getMonth()+1,!1)+"/"+(t.getFullYear()+1)):new Date("1/"+this.GetMonthName(t.getMonth()+1,!1)+"/"+t.getFullYear()):t.AddDays(n-t.getDate())):4==i?(t=t.AddDays(n),o.Date=t.AddDays(1-t.getDate())):5==i?(t=t.AddDays(n),o.Date=t.AddDays(t.DaysInMonth()-t.getDate())):6==i?(t=t.AddDays(1-t.getDate()),o.Date=t.AddDays(n)):7==i&&(t=t.AddDays(t.DaysInMonth()-t.getDate()),o.Date=t=t.AddDays(n)))}GetMonthNo(e){let t=12;switch(e.toLowerCase()){case"january":case"jan":t=1;break;case"february":case"feb":t=2;break;case"march":case"mar":t=3;break;case"april":case"apr":t=4;break;case"may":t=5;break;case"june":case"jun":t=6;break;case"July":case"Jul":t=7;break;case"August":case"Aug":t=8;break;case"september":case"sep":t=9;break;case"october":case"oct":t=10;break;case"november":case"nov":t=11;break;case"december":case"dec":t=12}return t}GetMonthName(e,t){e>12&&(e-=12);let s="";switch(e){case 1:s=t?"January":"Jan";break;case 2:s=t?"February":"Feb";break;case 3:s=t?"March":"Mar";break;case 4:s=t?"April":"Apr";break;case 5:s="May";break;case 6:s=t?"June":"Jun";break;case 7:s=t?"July":"Jul";break;case 8:s=t?"August":"Aug";break;case 9:s=t?"September":"Sep";break;case 10:s=t?"October":"Oct";break;case 11:s=t?"November":"Nov";break;case 12:s=t?"December":"Dec"}return s}GetCurrency(e,t){let s=1,i=n.a.common.GetDataSet3("DOC006",t.toString(),e.toString());return null!=i&&i.Tables.length>0&&i.Tables[0].length>0&&!a.e.IsEmpty(i.Tables[0][0].CurrencyID)&&(s=parseInt(i.Tables[0][0].CurrencyID)),s}GetExchangeRate(e,t){let s=1;if(e>0){let r=[];r.push(e),r.push(t.ToString("dd-MMM-yyyy"));let l=a.e.Int(n.a.SessionManager.Preferences.DimensionwiseCurrency),u=1;if(l>5e4){let e=0;if(this.Preferences.ContainsKey("UseasCrossDimension")&&"true"==this.Preferences.UseasCrossDimension.toLowerCase()&&n.a.SessionManager.Preferences.ContainsKey("CrossDimension")&&""!=n.a.SessionManager.Preferences.CrossDimension.toString()&&a.e.IsNum(n.a.SessionManager.Preferences.CrossDimension)&&(e=parseInt(n.a.SessionManager.Preferences.CrossDimension)),e==l){if(this.Preferences.ContainsKey("CrossDimField")&&a.e.IsNum(this.Preferences.CrossDimField)){var i=this._TextFields.find(e=>e.DBColumnID==parseInt(this.Preferences.CrossDimField));i&&i instanceof c.b&&i.SelectedValue>0&&(u=i.SelectedValue)}}else{var o=this._CCFields.find(e=>e instanceof c.b&&e.CCID==l);o&&o instanceof c.b&&(u=o.SelectedValue)}}r.push(u),r.push(n.a.SessionManager.LanguageID);let D=n.a.document.GetCurrencyExchange(r);null!=D&&D.Tables.length>0&&D.Tables[0].length>0&&!a.e.IsEmpty(D.Tables[0][0].Rate)&&(s=parseFloat(D.Tables[0][0].Rate))}return s}GetDocDetailsByVoucherNO(e,t){return n.a.document.GetDocDetailsByVoucherNO(e,t)}GetDocDetailsByInvID(e){return n.a.document.GetDocDetailsByInvID(e)}GetDocDetailsByAccID(e){return n.a.document.GetDocDetailsByAccID(e)}FillListViews(e){let t="";n.a.SessionManager.Preferences.ContainsKey("Dimension List")&&n.a.SessionManager.Preferences["Dimension List"].split(","),this.HeaderFields.forEach(s=>{s instanceof c.b?(e&&(s.IsAutoLoad=!0),n.a.SessionManager.IsValidNode(s.SelectedValue)?(t+='<Row CCID="'+s.CCID+'" ',t+=' TypeID="'+s.TypeID+'" ',t+=' DBColumnID="'+s.DBColumnID+'" ',t+=' NodeID="'+s.SelectedValue+'" />'):s.Text=s.SelectedValueText=""):s instanceof D.a&&(e&&(s.Code.IsAutoLoad=s.Name.IsAutoLoad=!0),n.a.SessionManager.IsValidNode(s.SelectedValue)?(t+='<Row CCID="'+s.CCID+'" ',t+=' TypeID="'+s.Code.TypeID+'" ',t+=' DBColumnID="'+s.DBColumnID+'" ',t+=' NodeID="'+s.SelectedValue+'" />',t+='<Row CCID="'+s.CCID+'" ',t+=' TypeID="'+s.Name.TypeID+'" ',t+=' DBColumnID="'+s.DBColumnID+'" ',t+=' NodeID="'+s.SelectedValue+'" />'):s.Name.SelectedValueText=s.Name.Text=s.Code.Text=s.Code.SelectedValueText="")}),this._CCFields.forEach(s=>{s instanceof c.b?(e&&(s.IsAutoLoad=!0),n.a.SessionManager.IsValidNode(s.SelectedValue)?(t+='<Row CCID="'+s.CCID+'" ',t+=' TypeID="'+s.TypeID+'" ',t+=' DBColumnID="'+s.DBColumnID+'" ',t+=' NodeID="'+s.SelectedValue+'" />'):s.Text=s.SelectedValueText=""):s instanceof D.a&&(e&&(s.Code.IsAutoLoad=s.Name.IsAutoLoad=!0),n.a.SessionManager.IsValidNode(s.SelectedValue)?(t+='<Row CCID="'+s.CCID+'" ',t+=' TypeID="'+s.Code.TypeID+'" ',t+=' DBColumnID="'+s.DBColumnID+'" ',t+=' NodeID="'+s.SelectedValue+'" />',t+='<Row CCID="'+s.CCID+'" ',t+=' TypeID="'+s.Name.TypeID+'" ',t+=' DBColumnID="'+s.DBColumnID+'" ',t+=' NodeID="'+s.SelectedValue+'" />'):s.Name.SelectedValueText=s.Name.Text=s.Code.Text=s.Code.SelectedValueText="")}),this._TextFields.forEach(s=>{s instanceof c.b&&(e&&(s.IsAutoLoad=!0),n.a.SessionManager.IsValidNode(s.SelectedValue)?(t+='<Row CCID="'+s.CCID+'" ',t+=' TypeID="'+s.TypeID+'" ',t+=' DBColumnID="'+s.DBColumnID+'" ',t+=' NodeID="'+s.SelectedValue+'" />'):s.Text=s.SelectedValueText="")});for(let s=0;s<this.ColumnSource.length;s++)if("LISTBOX"==this.ColumnSource[s].DataType&&this.ColumnSource[s].CostCenterID>0){let e="";this.GridData.forEach(t=>{this.ColumnSource[s].ValueMember&&this.GridDataColumns.Contains(this.ColumnSource[s].ValueMember)&&!Object(g.isNullOrUndefined)(t[this.ColumnSource[s].ValueMember])&&!a.e.IsEmpty(t[this.ColumnSource[s].ValueMember])&&a.e.IsEmpty(t[this.ColumnSource[s].DisplayMember])&&(e+=t[this.ColumnSource[s].ValueMember].toString()+",")}),""!=e&&(t+='<Row CCID="'+this.ColumnSource[s].CostCenterID+'" ',t+=' TypeID="'+this.ColumnSource[s].TypeID+'" ',t+=' DBColumnID="'+this.ColumnSource[s].ID+'" ',t+=' NodeID="'+e.substr(0,e.length-1)+'" />')}for(let s=0;s<this.FooterColumnSource.length;s++)if("LISTBOX"==this.FooterColumnSource[s].DataType&&this.FooterColumnSource[s].CostCenterID>0){let e="";this.FooterGridData.forEach(t=>{this.FooterColumnSource[s].ValueMember&&this.GridDataColumns.Contains(this.FooterColumnSource[s].ValueMember)&&!Object(g.isNullOrUndefined)(t[this.FooterColumnSource[s].ValueMember])&&!a.e.IsEmpty(t[this.FooterColumnSource[s].ValueMember])&&parseInt(t[this.FooterColumnSource[s].ValueMember])>0&&(e+=t[this.FooterColumnSource[s].ValueMember].toString()+",")}),""!=e&&(t+='<Row CCID="'+this.FooterColumnSource[s].CostCenterID+'" ',t+=' TypeID="'+this.FooterColumnSource[s].TypeID+'" ',t+=' DBColumnID="'+this.FooterColumnSource[s].ID+'" ',t+=' NodeID="'+e.substr(0,e.length-1)+'" />')}""!=t&&(t="<XML>"+t+"</XML>",n.a.document.GetListViewDataByIDs(t).subscribe(e=>{if(e.Tables.length>0&&!e.Columns[0].Contains("ErrorMessage")){let t;this.HeaderFields.forEach(s=>{s instanceof c.b?n.a.SessionManager.IsValidNode(s.SelectedValue)&&(t=e.Tables[0].filter(e=>e.NodeID==s.SelectedValue&&e.DBColumnID==s.DBColumnID&&e.TypeID==s.TypeID),t.length>0&&(s.Text=t[0].Value,s.SelectedValueText=t[0].Value)):s instanceof D.a&&n.a.SessionManager.IsValidNode(s.SelectedValue)&&(t=e.Tables[0].filter(e=>e.NodeID==s.SelectedValue&&e.DBColumnID==s.DBColumnID&&e.TypeID==s.Code.TypeID),t.length>0&&(s.Code.Text=t[0].Value,s.Code.SelectedValueText=t[0].Value),t=e.Tables[0].filter(e=>e.NodeID==s.SelectedValue&&e.DBColumnID==s.DBColumnID&&e.TypeID==s.Name.TypeID),t.length>0&&(s.Name.Text=t[0].Value,s.Name.SelectedValueText=t[0].Value))}),this._CCFields.forEach(s=>{s instanceof c.b?n.a.SessionManager.IsValidNode(s.SelectedValue)&&(t=e.Tables[0].filter(e=>e.NodeID==s.SelectedValue&&e.DBColumnID==s.DBColumnID&&e.TypeID==s.TypeID),t.length>0&&(s.Text=t[0].Value,s.SelectedValueText=t[0].Value)):s instanceof D.a&&n.a.SessionManager.IsValidNode(s.SelectedValue)&&(t=e.Tables[0].filter(e=>e.NodeID==s.SelectedValue&&e.DBColumnID==s.DBColumnID&&e.TypeID==s.Code.TypeID),t.length>0&&(s.Code.Text=t[0].Value,s.Code.SelectedValueText=t[0].Value),t=e.Tables[0].filter(e=>e.NodeID==s.SelectedValue&&e.DBColumnID==s.DBColumnID&&e.TypeID==s.Name.TypeID),t.length>0&&(s.Name.Text=t[0].Value,s.Name.SelectedValueText=t[0].Value))}),this._TextFields.forEach(s=>{s instanceof c.b&&n.a.SessionManager.IsValidNode(s.SelectedValue)&&(t=e.Tables[0].filter(e=>e.NodeID==s.SelectedValue&&e.DBColumnID==s.DBColumnID&&e.TypeID==s.TypeID),t.length>0&&(s.Text=t[0].Value,s.SelectedValueText=t[0].Value))});for(let s=0;s<this.ColumnSource.length;s++)"LISTBOX"==this.ColumnSource[s].DataType&&this.ColumnSource[s].CostCenterID>0&&this.GridData.forEach(n=>{null==this.ColumnSource[s].ValueMember||a.e.IsEmpty(n[this.ColumnSource[s].ValueMember])||(t=e.Tables[0].filter(e=>e.NodeID==n[this.ColumnSource[s].ValueMember]&&e.DBColumnID==this.ColumnSource[s].ID&&e.TypeID==this.ColumnSource[s].TypeID),t.length>0&&(n[this.ColumnSource[s].DisplayMember]=t[0].Value)),this.GridDataObj.updateRow(n)});for(let s=0;s<this.FooterColumnSource.length;s++)"LISTBOX"==this.FooterColumnSource[s].DataType&&this.FooterColumnSource[s].CostCenterID>0&&this.FooterGridData.forEach(n=>{this.FooterGridDataColumns.length>0&&this.FooterGridData.length>0&&null!=this.FooterColumnSource[s].ValueMember&&!a.e.IsEmpty(n[this.FooterColumnSource[s].ValueMember])&&parseInt(n[this.FooterColumnSource[s].ValueMember])>0&&(t=e.Tables[0].filter(e=>e.NodeID==n[this.FooterColumnSource[s].ValueMember]&&e.DBColumnID==this.FooterColumnSource[s].ID&&e.TypeID==this.FooterColumnSource[s].TypeID),t.length>0&&(n[this.FooterColumnSource[s].DisplayMember]=t[0].Value))})}},e=>{}))}GetPrimaryCol(){return this.IsInventory?"ProductID_Key":this.GridDataColumns.Contains("CreditAccount_Key")?"CreditAccount_Key":this.GridDataColumns.Contains("DebitAccount_Key")?"DebitAccount_Key":this.GridDataColumns.Contains("AccountID_Key")?"AccountID_Key":""}GetExtData(e,t,s){let i=[];var o=e.split(",");for(let n=0;n<o.length;n++)a.e.String(o[n])||i.push(this.GetValueBYCOLID(o[n],t));return i.push(n.a.SessionManager.UserID),i.push(n.a.SessionManager.LanguageID),n.a.document.GetData(JSON.stringify(i),s)}GetExternalFuncData(e,t,s,i,o,r=!1){if(this.IsForecast||1==e&&this.DocID>0||2==e&&0==this.DocID||6==e&&!r)return;let l=[];var u=s.split(",");for(let n=0;n<u.length;n++)""!=u[n]&&l.push(this.GetValueBYCOLID(u[n],o));l.push(n.a.SessionManager.UserID),l.push(n.a.SessionManager.LanguageID);let c=n.a.document.GetData(JSON.stringify(l),t);if(6!=e&&null!=c&&c.Tables.length>0&&!c.Columns[0].Contains("ErrorMessage")&&c.Tables[0].length>0)if((u=i.split(",")).length>0&&("-500"==u[0]||"-501"==u[0])){let e=this.GetPrimaryCol(),t=-1;if("-501"==u[0])this.GridData.Clear();else for(let s=0;s<this.GridData.length;s++)if(""==a.e.StringValue(this.GridData[s][e])){t=s;break}if(-1==t){t=0;for(let e=0;e<5;e++)this.GridData.push({})}for(let s=0;s<c.Tables[0].length;s++){let e=this.GridDataObj.NewRow();for(let t=0;t<c.Columns[0].length;t++)this.GridDataColumns.Contains(c.Columns[0][t])&&!a.e.IsEmpty(c.Tables[0][s][t])?e[c.Columns[0][t]]=c.Tables[0][s][t]:0==s&&((D=this.HeaderFields.find(e=>e instanceof p.c&&e.DBColumnName==c.Columns[0][t]))||(D=this._TextFields.filter(e=>e instanceof p.c&&e.DBColumnName==c.Columns[0][t])),D||(D=this._CCFields.filter(e=>e instanceof p.c&&e.DBColumnName==c.Columns[0][t])),D&&this.fillcontrolValue(D,c.Tables[0][s][t].toString()));this.GridDataObj.insertRowAt(e,t+s)}this.UpdateSequence(),this.ReferenceCallBack.IsSubscribed&&this.ReferenceCallBack.Call({ReferenceTable:null,ReferenceEditTable:null,DBColumnName:"ReCalculate",ccid:0,dr:null})}else if(u.length>0&&"-502"==u[0]){for(let e=0;e<c.Tables[0].length;e++){let t=this.GridData.filter(t=>t.DocSeqNo==c.Tables[0][e].DocSeqNo);if(t.length>0)for(let s=0;s<c.Columns[0].length;s++)if(this.GridDataColumns.Contains(c.Columns[0][s])&&!a.e.IsEmpty(c.Tables[0][e][c.Columns[0][s]]))t[0][c.Columns[0][s]]=c.Tables[0][e][c.Columns[0][s]];else if(0==e){var D;(D=this.HeaderFields.find(e=>e instanceof p.c&&e.DBColumnName==c.Columns[0][s]))||(D=this._TextFields.find(e=>e instanceof p.c&&e.DBColumnName==c.Columns[0][s])),D||(D=this._CCFields.find(e=>e instanceof p.c&&e.DBColumnName==c.Columns[0][s])),D&&this.fillcontrolValue(D,a.e.StringValue(c.Tables[0][e][s]))}}this.ReferenceCallBack.IsSubscribed&&this.ReferenceCallBack.Call({ReferenceTable:null,ReferenceEditTable:null,DBColumnName:"ReCalculate",ccid:0,dr:null})}else for(let n=0;n<u.length;n++)""!=u[n]&&c.Columns[0].length>n&&(c.Columns[0].length>n+1?null!=this.SetValueBYCOLID(u[n],a.e.StringValue(c.Tables[0][0][c.Columns[0][n]]),a.e.StringValue(c.Tables[0][0][c.Columns[0][n+1]]),o)&&n++:this.SetValueBYCOLID(u[n],a.e.StringValue(c.Tables[0][0][c.Columns[0][n]]),"",o));6==e&&null!=c&&c.Tables.length>0&&c.Columns[0].Contains("ExternalFuncErrorMessage")&&c.Tables[0].length>0&&(this.ExternalFuncErrorMessage=c.Tables[0][0].ExternalFuncErrorMessage.toString())}SetValueBYCOLID(e,t,s,i){if("-999"==e)return null;if(null!=i)if("-1"==e)i.UOMConversion=t,a.e.IsEmpty(i.Quantity)||(i.UOMConvertedQty=a.e.IsNum(t)?a.e.Double(t)*parseFloat(i.Quantity):i.Quantity);else{var o=this.ColumnSource.find(t=>t.ID==e);if(o){if("DATE"==o.DataType)a.e.isValidDate(t)&&(i[o.DisplayMember+"_Key"]=new Date(t),i[o.DisplayMember]=new Date(t).ToString(n.a.SessionManager.Preferences["Date Format"]));else if("DATETIME"==o.DataType||"TIME"==o.DataType)a.e.isValidDate(t)&&(i[o.DisplayMember+"_Key"]=new Date(t),i[o.DisplayMember]=new Date(t).ToString(n.a.SessionManager.Preferences["Date Format"]+" hh:mm:ss tt"));else if("Time2"==o.DataType)a.e.isValidDate(t)&&(i[o.DisplayMember+"_Key"]=new Date(t),i[o.DisplayMember]=new Date(t).ToString("HH:mm"));else if("ComboBox"==o.DataType)i[o.ValueBinding]=t;else if("PactComboBox"==o.DataType)i[o.ValueBinding+"_Key"]=t;else if("LISTBOX"==o.DataType&&0!=o.CostCenterID){if(a.e.IsNum(s))return i[o.ValueMember]=s,i[o.DisplayMember]=t,this.IsInventory&&3==o.CostCenterID||this.Data.Tables[0].filter(e=>null!=e.LocalReference&&e.LocalReference==o.ID).length>0&&!a.e.IsEmpty(i[o.ValueMember])&&this.GetLinkReferenceData(parseInt(o.ID),this.CostCenterID,parseInt(i[o.ValueMember]),this.DocDate.Date,"",o.CostCenterID,i),o}else this.GridDataObj.DataTypes.Double.Contains(o.DisplayMember)?a.e.IsNum(t)&&(i[o.DisplayMember]=t):i[o.DisplayMember]=t;return null}}var r=this.HeaderFields.find(t=>t instanceof p.c&&t.DBColumnID.toString()==e);if(r){if(r instanceof D.a){if(a.e.IsEmpty(s)&&!a.e.IsEmpty(t)){let e;if(a.e.IsNum(t))return e=a.e.Int(t),r.PrevSelValu=e,r.SelectedValue=e,r.Name.IsAutoLoad&&r.Name.Visible&&(r.Name.SelectedValueText=t),r}else this.fillcontrolValue(r,s),r.Name.IsAutoLoad&&r.Name.Visible&&(r.Name.SelectedValueText=t);return this.Data.Tables[0].filter(t=>null!=t.LocalReference&&t.LocalReference==e).length>0&&r.SelectedValue>0&&this.GetLinkReferenceData(r.DBColumnID,this.CostCenterID,r.SelectedValue,this.DocDate.Date,"",r.CCID,null),this.FillCustomwhere(r),r}if(r instanceof c.b){if(a.e.IsEmpty(s)&&!a.e.IsEmpty(t)){let e;if(a.e.IsNum(t))return e=a.e.Int(t),r.PreviousSelectedValue=e,r.SelectedValue=e,r}else this.fillcontrolValue(r,s),r.IsAutoLoad&&(r.SelectedValueText=t);return this.Data.Tables[0].filter(t=>null!=t.LocalReference&&t.LocalReference==e).length>0&&r.SelectedValue>0&&this.GetLinkReferenceData(r.DBColumnID,this.CostCenterID,r.SelectedValue,this.DocDate.Date,"",r.CCID,null),this.FilterDependencies(r),r}return this.fillcontrolValue(r,t),null}if(r=this._TextFields.find(t=>t instanceof p.c&&t.DBColumnID.toString()==e)){if(r instanceof c.b){if(a.e.IsEmpty(s)&&!a.e.IsEmpty(t)){let e;if(a.e.IsNum(t))return e=a.e.Int(t),r.PreviousSelectedValue=e,r.SelectedValue=e,r}else this.fillcontrolValue(r,s),r.IsAutoLoad&&(r.SelectedValueText=t);return r}return this.fillcontrolValue(r,t),null}if(r=this._CCFields.find(t=>t instanceof p.c&&t.DBColumnID.toString()==e))if(r instanceof c.b){if(!a.e.IsEmpty(s)||a.e.IsEmpty(t))return this.fillcontrolValue(r,s),r.IsAutoLoad&&(r.SelectedValueText=t),this.FilterDependencies(r),r;{let e;if(a.e.IsNum(t))return e=a.e.Int(t),r.PreviousSelectedValue=e,r.SelectedValue=e,this.FilterDependencies(r),r}}else this.fillcontrolValue(r,t);return null}GetValueBYCOLID(e,t){if("-100"==e)return this.DocID.toString();if("-102"==e)return null==t||Object(g.isNullOrUndefined)(t.BOEID)?"":t.BOEID.toString();if("-104"==e)return null==t||Object(g.isNullOrUndefined)(t.DocSeqNo)?"":t.DocSeqNo.toString();if("-103"==e)return null==t||Object(g.isNullOrUndefined)(t.LinkedInvDocDetailsID)?"":t.LinkedInvDocDetailsID.toString();if("-101"==e){let e,t={message:""};this.GenerateQuery(t,!0,Date.Today(),!1),e=t.message,this.strCCFields=this.GenerateQueryfromList(this._CCFields,!1,t,!1,!1),e=t.message,this.strTextFields=this.GenerateQueryfromList(this._TextFields,!1,t,!1,!1),e=t.message;let s="",n="";this.IsInventory?s="ProductID_Key":this.GridDataColumns.Contains("CreditAccount_Key")?s="CreditAccount_Key":this.GridDataColumns.Contains("DebitAccount_Key")?s="DebitAccount_Key":this.GridDataColumns.Contains("AccountID_Key")&&(s="AccountID_Key"),n+="<DocXML>";for(let i=0;i<this.GridData.length;i++)if(!a.e.IsEmpty(this.GridData[i][s])){n+="<Row ";for(let e=0;e<this.ColumnSource.length;e++)"DATE"==this.ColumnSource[e].DataType?!a.e.IsEmpty(this.GridData[i][this.ColumnSource[e].DisplayMember+"_Key"])&&a.e.isValidDate(this.GridData[i][this.ColumnSource[e].DisplayMember+"_Key"])&&(n+=this.ColumnSource[e].DisplayMember+'="'+new Date(this.GridData[i][this.ColumnSource[e].DisplayMember+"_Key"]).ToString("dd/MMM/yyyy")+'" '):"DATETIME"!=this.ColumnSource[e].DataType&&"TIME"!=this.ColumnSource[e].DataType||!a.e.isValidDate(this.GridData[i][this.ColumnSource[e].DisplayMember+"_Key"])?"ComboBox"==this.ColumnSource[e].DataType?n+=this.ColumnSource[e].ValueBinding+'="'+r.d.GetValidXml(this.GridData[i][this.ColumnSource[e].ValueBinding])+'" ':"PactComboBox"==this.ColumnSource[e].DataType?n+=this.ColumnSource[e].ValueBinding+'="'+r.d.GetValidXml(this.GridData[i][this.ColumnSource[e].ValueBinding+"_Key"])+'" ':"LISTBOX"==this.ColumnSource[e].DataType?"ProductCode"==this.ColumnSource[e].DisplayMember||"AccountCode"==this.ColumnSource[e].DisplayMember||0==this.ColumnSource[e].CostCenterID||a.e.IsEmpty(this.GridData[i][this.ColumnSource[e].ValueMember])||(n+=this.ColumnSource[e].ValueMember.replace("_Key","")+'="'+this.GridData[i][this.ColumnSource[e].ValueMember].toString()+'" '):n+=this.ColumnSource[e].DisplayMember+'="'+r.d.GetValidXml(this.GridData[i][this.ColumnSource[e].DisplayMember])+'" ':a.e.IsEmpty(this.GridData[i][this.ColumnSource[e].DisplayMember+"_Key"])||(n+=this.ColumnSource[e].DisplayMember+'="'+new Date(this.GridData[i][this.ColumnSource[e].DisplayMember+"_Key"]).ToString("dd/MMM/yyyy hh:mm:ss tt")+'" ');n+=this.strCCFields+this.strTextFields+this.strStaticFields,n+=" /> "}return n+="</DocXML>",n}if(null!=t){var s=this.ColumnSource.find(t=>t.ID==e);if(s)if("DATE"==s.DataType){if(!a.e.IsEmpty(t[s.DisplayMember+"_Key"])&&a.e.isValidDate(t[s.DisplayMember+"_Key"]))return new Date(t[s.DisplayMember+"_Key"]).ToString("dd/MMM/yyyy")}else if("DATETIME"!=s.DataType&&"TIME"!=s.DataType||!a.e.isValidDate(t[s.DisplayMember+"_Key"])){if("Time2"!=s.DataType||!a.e.isValidDate(t[s.DisplayMember+"_Key"]))return a.e.String("ComboBox"==s.DataType?t[s.ValueBinding]:"PactComboBox"==s.DataType?t[s.ValueBinding+"_Key"]:"LISTBOX"==s.DataType&&0!=s.CostCenterID?t[s.ValueMember]:t[s.DisplayMember]);if(!a.e.IsEmpty(t[s.DisplayMember+"_Key"]))return new Date(t[s.DisplayMember+"_Key"]).ToString("HH:mm")}else if(!a.e.IsEmpty(t[s.DisplayMember+"_Key"]))return new Date(t[s.DisplayMember+"_Key"]).ToString("dd/MMM/yyyy hh:mm:ss tt")}var n=this.HeaderFields.find(t=>t instanceof p.c&&t.DBColumnID.toString()==e);return n||(n=this._TextFields.find(t=>t instanceof p.c&&t.DBColumnID.toString()==e))||(n=this._CCFields.find(t=>t instanceof p.c&&t.DBColumnID.toString()==e))?this.GetcontrolValue(n):""}GetLinkRefDataSet(e,t,s,i,o,r,l,u=0){Logger.InfoLog("VoucherGenerator:: Inside GetLinkReferenceData");let h=null;if(s>0){let i=[];i.push(e),i.push(t),i.push(s),i.push(null!=this.ovDate&&null!=this.ovDate.Date?this.ovDate.Date.ToString("dd/MMM/yyyy"):(new Date).ToString("dd/MMM/yyyy"));let m="";if(u>0)i.push(u);else{for(let e=0;e<this.DefaultBasedOn.length;e++)this.DefaultBasedOn[this.DefaultBasedOn.keys[e]]="0";1==this.DocumentType||39==this.DocumentType||2==this.DocumentType||6==this.DocumentType||26==this.DocumentType||27==this.DocumentType||3==this.DocumentType||4==this.DocumentType||25==this.DocumentType||13==this.DocumentType?null!=l&&!a.e.IsEmpty(l.CreditAccount_Key)&&parseInt(l.CreditAccount_Key)>0?i.push(l.CreditAccount_Key.toString()):null!=this.CreditAccount&&this.CreditAccount.SelectedValue>0?(i.push(this.CreditAccount.SelectedValue),this.DefaultBasedOn.ContainsKey("2")&&this.CreditAccount.SelectedValue>0&&(2!=r||e==this.CreditAccount.DBColumnID)&&(this.DefaultBasedOn[2]="1",m=" and AccountID="+this.CreditAccount.SelectedValue)):i.push(0):11==this.DocumentType||38==this.DocumentType||10==this.DocumentType||7==this.DocumentType||8==this.DocumentType||9==this.DocumentType||12==this.DocumentType||24==this.DocumentType?null!=l&&!a.e.IsEmpty(l.DebitAccount_Key)&&parseInt(l.DebitAccount_Key)>0?i.push(l.DebitAccount_Key.toString()):null!=this.DebitAccount&&this.DebitAccount.SelectedValue>0?(i.push(this.DebitAccount.SelectedValue),this.DefaultBasedOn.ContainsKey("2")&&this.DebitAccount.SelectedValue>0&&(2!=r||e==this.DebitAccount.DBColumnID)&&(this.DefaultBasedOn[2]="1",m+=" and AccountID="+this.DebitAccount.SelectedValue)):i.push(0):i.push(0)}this.IsInventory||((18==this.DocumentType||19==this.DocumentType||21==this.DocumentType||22==this.DocumentType)&&null!=l&&!a.e.IsEmpty(l.CreditAccount_Key)&&parseInt(l.CreditAccount_Key)>0?this.DefaultBasedOn.ContainsKey("2")&&(this.DefaultBasedOn[2]="1",m+=" and AccountID="+l.CreditAccount_Key.toString()):(14==this.DocumentType||15==this.DocumentType||20==this.DocumentType||23==this.DocumentType)&&null!=l&&!a.e.IsEmpty(l.DebitAccount_Key)&&parseInt(l.DebitAccount_Key)>0?this.DefaultBasedOn.ContainsKey("2")&&(this.DefaultBasedOn[2]="1",m+=" and AccountID="+l.DebitAccount_Key.toString()):null!=l&&!a.e.IsEmpty(l.AccountID_Key)&&parseInt(l.AccountID_Key)>0&&this.DefaultBasedOn.ContainsKey("2")&&(this.DefaultBasedOn[2]="1",m+=" and AccountID="+l.AccountID_Key.toString()));let d=0;this.Preferences.ContainsKey("UseasCrossDimension")&&"true"==this.Preferences.UseasCrossDimension.toLowerCase()&&n.a.SessionManager.Preferences.ContainsKey("CrossDimension")&&""!=n.a.SessionManager.Preferences.CrossDimension.toString()&&a.e.IsNum(n.a.SessionManager.Preferences.CrossDimension)&&(d=parseInt(n.a.SessionManager.Preferences.CrossDimension));let p="<XML>";this._CCFields.forEach(e=>{if(!(e instanceof c.b&&e.DBColumnName.Contains("TO")&&5==this.DocumentType)&&e instanceof c.b&&e.SelectedValue>0){if(d==e.CCID&&this.Preferences.ContainsKey("CrossDimField")&&a.e.IsNum(this.Preferences.CrossDimField)){var t=this._TextFields.find(e=>e.DBColumnID==parseInt(this.Preferences.CrossDimField));return void(t&&t instanceof c.b&&t.SelectedValue>0&&(p+='<Row CostCenterID="'+e.CCID+'" NODEID="'+t.SelectedValue.toString()+'" />'))}p+='<Row CostCenterID="'+e.CCID+'" NODEID="'+e.SelectedValue.toString()+'" />',this.DefaultBasedOn.ContainsKey(e.CCID.toString())&&(this.DefaultBasedOn[e.CCID.toString()]="1",m+=" and CCNID"+(e.CCID-5e4)+"="+e.SelectedValue)}}),null!=l&&this.ColumnSource.forEach(e=>{e.CostCenterID>5e4&&this.GridDataColumns.Contains(e.ValueMember)&&!a.e.IsEmpty(l[e.ValueMember])?(p+='<Row CostCenterID="'+e.CostCenterID+'" NODEID="'+l[e.ValueMember].toString()+'" />',this.DefaultBasedOn.ContainsKey(e.CostCenterID.toString())&&(this.DefaultBasedOn[e.CostCenterID.toString()]="1",m+=" and CCNID"+(e.CostCenterID-5e4)+"="+l[e.ValueMember].toString())):3==e.CostCenterID&&this.GridDataColumns.Contains(e.ValueMember)&&!a.e.IsEmpty(l[e.ValueMember])&&this.DefaultBasedOn.ContainsKey(e.CostCenterID.toString())&&(p+='<Row CostCenterID="3" NODEID="'+l[e.ValueMember].toString()+'" />',this.DefaultBasedOn[e.CostCenterID.toString()]="1",m+=" and ProductID="+l[e.ValueMember].toString())}),p+="</XML>",i.push(p),this.Preferences.ContainsKey("DefaultProfileID")&&!a.e.IsEmpty(this.Preferences.DefaultProfileID)&&this.DefaultBasedOn.ContainsKey(r.toString())?i.push(!0):i.push(!1);let I=[];if(this.Preferences.ContainsKey("DimensionWise")&&!a.e.IsEmpty(this.Preferences.DimensionWise)&&(I=this.Preferences.DimensionWise.split(",")),null!=this.Link&&null!=this.Link.LinkCombo&&null!=this.Link.LinkCombo.SelectedValue&&""!=this.Link.LinkCombo.SelectedValue&&(I.Contains(r.toString())||2==r&&("creditaccount"==o.toLowerCase()&&this.Preferences.ContainsKey("Credit Account")&&Object(S.j)(this.Preferences["Credit Account"])||this.Preferences.ContainsKey("LinkVendorProducts")&&Object(S.j)(this.Preferences.LinkVendorProducts)||"debitaccount"==o.toLowerCase()&&this.Preferences.ContainsKey("Debit Account")&&Object(S.j)(this.Preferences["Debit Account"])))?i.AddRange(this.GetLinkParams(parseInt(this.Link.LinkCombo.SelectedValue),this.DocDate.Date.ToString("dd/MMM/yyyy"),this.DueDate&&this.DueDate.Date?this.DueDate.Date.ToString("dd/MMM/yyyy"):"",!1)):(i.push("0"),i.push("0"),i.push("0"),i.push(null),i.push("0"),i.push("0"),i.push("0"),i.push(""),i.push(n.a.SessionManager.UserID)),i.push(n.a.SessionManager.LanguageID),i.push(n.a.SessionManager.RoleID),h=n.a.document.GetReferenceData(JSON.stringify(i)),Logger.InfoLog("VoucherGenerator:: Exiting GetLinkReferenceData"),"0"!=i[7].toString())for(let e=1;e<h.Tables.length;e++)if(h.Columns[h.Tables.length-e].Contains("voucherno")){this.Link.VouchersList=h.Tables[h.Tables.length-e],this.FillPendingList(!0);break}if(this.Preferences.ContainsKey("DefaultProfileID")&&""!=this.Preferences.DefaultProfileID&&null!=h&&h.Tables.length>0&&h.Columns[h.Tables.length-1].Contains("ProfileID")){for(let e=1;e<h.Tables.length&&h.Columns[h.Tables.length-e].Contains("ProfileID");e++)if(0!=h.Tables[h.Tables.length-e].length)for(let t=1;t<h.Columns[h.Tables.length-1].length;t++){let s=h.Columns[h.Tables.length-e][t];if("AccountID"==s);else if("ProductID"==s);else if(s.Contains("CCNID")&&!a.e.IsEmpty(h.Tables[h.Tables.length-e][0][s])&&parseInt(h.Tables[h.Tables.length-e][0][s])>0)if((C=this._CCFields.find(e=>e.DBColumnName.toUpperCase()=="DC"+s))&&C instanceof c.b)C.SelectedValue=parseInt(h.Tables[h.Tables.length-e][0][s]),C.IsAutoLoad&&h.Columns[h.Tables.length-e].length>t+1&&(C.SelectedValueText=h.Tables[h.Tables.length-e][0][h.Columns[h.Tables.length-e][t+1]].toString());else if(null!=C&&C instanceof D.a){C.Code.SelectedValue=C.Name.SelectedValue=parseInt(h.Tables[h.Tables.length-e][0][s]);let a=n.a.document.GetCCValues("'"+h.Tables[h.Tables.length-e][0][h.Columns[h.Tables.length-e][t+1]].toString()+"'",C.CCID,0);a.length>0&&!a.Columns[0].Contains("ErrorMessage")&&(C.Code.SelectedValueText=a.Tables[0][0].Code.toString(),C.Name.SelectedValueText=a.Tables[0][0].name.toString())}else null==l||Object(g.isUndefined)(l["DC"+s])||(Object(g.isUndefined)(l["DC"+s+"_Key"])||(l["DC"+s+"_Key"]=parseInt(h.Tables[h.Tables.length-e][0][s])),h.Columns[h.Tables.length-e].length>t+1&&(l["DC"+s]=h.Tables[h.Tables.length-e][0][h.Columns[h.Tables.length-e][t+1]].toString()));t++}}else if(this.Preferences.ContainsKey("DefaultProfileID")&&""!=this.Preferences.DefaultProfileID&&null!=h&&h.Tables.length>0&&0==h.Tables[h.Tables.length-1].length&&h.Columns[h.Tables.length-1].Contains("ProfileID"))for(let e=1;e<h.Columns[h.Tables.length-1].length;e++){let t=h.Columns[h.Tables.length-1][e];var C;t.Contains("CCNID")&&((C=this._CCFields.find(e=>e.DBColumnName.toUpperCase()=="DC"+t))&&C instanceof c.b?C.SelectedValue=1:null==l||Object(g.isUndefined)(l["DC"+t])||Object(g.isUndefined)(l["DC"+t+"_Key"])||(l["DC"+t+"_Key"]=1)),e++}}return h}GetLinkReferenceData(e,t,s,i,o,C,m,d=null,p=!0){if(1==this.IsResave)return;let I=this.GetLinkRefDataSet(e,t,s,i,o,C,m),g=this.GetPrimaryCol();if(null!=I){let N=!0;if(this.ColumnSource.find(t=>t.ID==e.toString())&&(N=!1),(15==this.DocumentType||14==this.DocumentType)&&2==C&&this.Preferences.ContainsKey("AutoChequeNo")&&"TRUE"==this.Preferences.AutoChequeNo.toUpperCase())if(null!=this.CreditAccount&&e==this.CreditAccount.DBColumnID&&this.CreditAccount.SelectedValue>0)this.HeaderFields.forEach(e=>{if(e instanceof u.e&&"ChequeBookNo"==e.DBColumnName&&null!=I&&I.Tables.length>4){e.Items.Clear();var t=this.HeaderFields.find(e=>e instanceof r.d&&"ChequeNumber"==e.DBColumnName);t&&(t.Text=""),e.Items.push(u.d.ComboBoxItems_2("",""));for(let t=0;t<I.Tables[4].length;t++)e.Items.push(u.d.ComboBoxItems_2(I.Tables[4][t].BookNo.toString(),I.Tables[4][t].BookNo.toString()));e.Items.length>1&&(e.SelectedValue=e.Items[1].Value)}});else if("CreditAccount"==o&&null!=m&&null!=I&&I.Tables.length>4){var y=this.ColumnSource.find(e=>null!=e.ValueBinding&&"ChequeBookNo"==e.ValueBinding);if(y){let e=[];e.push(u.d.ComboBoxItems_2("",""));for(let t=0;t<I.Tables[4].length;t++)e.push(u.d.ComboBoxItems_2(I.Tables[4][t].BookNo.toString(),I.Tables[4][t].BookNo.toString()));y.ComboData=e,e.length>1&&(m[y.ValueBinding]=e[1].Value,(y=this.ColumnSource.find(e=>null!=e.DisplayMember&&"ChequeNumber"==e.DisplayMember))&&(m[y.DisplayMember]=n.a.document.GetChequeNumbers(s,e[1].Value)))}}if(null!=I&&I.Tables.length>0&&I.Tables[0].length>0)for(let o=0;o<I.Columns[0].length;o++){if(I.Tables[0].length>0&&I.Columns[0][o].toLowerCase().Contains("dcalpha")&&this._TextFields.forEach(e=>{e.DBColumnName==I.Columns[0][o]&&(I.Columns[0].Contains(e.DBColumnName+"Name")&&e instanceof r.d?this.fillcontrolValue(e,a.e.StringValue(I.Tables[0][0][I.Columns[0][o]+"Name"])):this.fillcontrolValue(e,a.e.StringValue(I.Tables[0][0][I.Columns[0][o]])),e instanceof c.b&&I.Columns[0].Contains(I.Columns[0][o]+"Name")&&(e.SelectedValueText=e.Text=a.e.StringValue(I.Tables[0][0][I.Columns[0][o]+"Name"])))}),I.Columns[0][o].toUpperCase().Contains("CCNID")){if("DCCCNID2"==I.Columns[0][o].toUpperCase()&&n.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"True"==n.a.SessionManager.Preferences.EnableLocationWise.toString()&&(!this.Preferences.ContainsKey("Donotuselocation")||""==this.Preferences.Donotuselocation||!Object(S.j)(this.Preferences.Donotuselocation)))continue;if("DCCCNID1"==I.Columns[0][o].toUpperCase()&&n.a.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&"True"==n.a.SessionManager.Preferences.EnableDivisionWise.toString()&&(!this.Preferences.ContainsKey("Donotusedivision")||""==this.Preferences.Donotusedivision||!Object(S.j)(this.Preferences.Donotusedivision)))continue;for(let i=0;i<this._CCFields.length;i++){let r=this._CCFields[i];if(I.Tables[0].length>0&&r.DBColumnName==I.Columns[0][o]){if(!a.e.IsEmpty(I.Tables[0][0][I.Columns[0][o]])&&parseInt(I.Tables[0][0][I.Columns[0][o]])>0)if(r instanceof c.b){if(r.OnPactListBoxValueChanged.IsSubscribed||(r.PreviousSelectedValue=parseInt(I.Tables[0][0][I.Columns[0][o]])),r.SelectedValue=parseInt(I.Tables[0][0][I.Columns[0][o]]),I.Columns[0].Contains(I.Columns[0][o]+"Name")&&(r.Text=I.Tables[0][0][I.Columns[0][o]+"Name"].toString()),n.a.SessionManager.Preferences.ContainsKey("DisableAutoLoad")&&"true"==n.a.SessionManager.Preferences.DisableAutoLoad.toLowerCase()&&(this.IsCodeFirstCol(r.CCID,r.TypeID)&&I.Columns[0].Contains(I.Columns[0][o]+"Code")?r.SelectedValueText=I.Tables[0][0][I.Columns[0][o]+"Code"].toString():I.Columns[0].Contains(I.Columns[0][o]+"Name")&&(r.SelectedValueText=I.Tables[0][0][I.Columns[0][o]+"Name"].toString())),r.CustomWhere=I.Columns[0].Contains(I.Columns[0][o]+"Group")&&!a.e.IsEmpty(I.Tables[0][0][I.Columns[0][o]+"Group"])&&Object(S.j)(I.Tables[0][0][I.Columns[0][o]+"Group"])?" lft between "+I.Tables[0][0][I.Columns[0][o]+"lft"].toString()+" and "+I.Tables[0][0][I.Columns[0][o]+"rgt"].toString():"",C>5e4&&(this.IsConstructorCall||n.a.SessionManager.Preferences.ContainsKey("Dimension List")&&n.a.SessionManager.Preferences["Dimension List"].split(",").Contains(C.toString()))){var b=this._CCFields.find(t=>t.DBColumnID==e);b&&(this.IsConstructorCall||b.DefaultValue==s.toString())&&this.Data.Tables[0].filter(e=>null!=e.LocalReference&&e.LocalReference==r.DBColumnID).length>0&&this.GetLinkReferenceData(r.DBColumnID,t,r.SelectedValue,this.DocDate.Date,r.DBColumnName,r.CCID,null)}}else r instanceof D.a&&(r.Code.OnPactListBoxValueChanged.IsSubscribed||(r.Code.PreviousSelectedValue=r.Name.PreviousSelectedValue=parseInt(I.Tables[0][0][I.Columns[0][o]])),r.SelectedValue=parseInt(I.Tables[0][0][I.Columns[0][o]]),I.Columns[0].Contains(I.Columns[0][o]+"Code")&&(r.Code.Text=I.Tables[0][0][I.Columns[0][o]+"Code"].toString()),I.Columns[0].Contains(I.Columns[0][o]+"Name")&&(r.Name.Text=I.Tables[0][0][I.Columns[0][o]+"Name"].toString()),n.a.SessionManager.Preferences.ContainsKey("DisableAutoLoad")&&"true"==n.a.SessionManager.Preferences.DisableAutoLoad.toLowerCase()&&(this.IsCodeFirstCol(r.Code.CCID,r.Code.TypeID)&&I.Columns[0].Contains(I.Columns[0][o]+"Code")?r.Code.SelectedValueText=I.Tables[0][0][I.Columns[0][o]+"Code"].toString():I.Columns[0].Contains(I.Columns[0][o]+"Name")&&(r.Name.SelectedValueText=I.Tables[0][0][I.Columns[0][o]+"Name"].toString())),r.Code.CustomWhere=r.Name.CustomWhere=I.Columns[0].Contains(I.Columns[0][o]+"Group")&&!a.e.IsEmpty(I.Tables[0][0][I.Columns[0][o]+"Group"])&&Object(S.j)(I.Tables[0][0][I.Columns[0][o]+"Group"])?" lft between "+I.Tables[0][0][I.Columns[0][o]+"lft"].toString()+" and "+I.Tables[0][0][I.Columns[0][o]+"rgt"].toString():"");I.Columns[0].Contains(I.Columns[0][o]+"Group")&&(o+=4);break}}}if("DEBITACCOUNT"==I.Columns[0][o].toUpperCase()&&!a.e.IsEmpty(I.Tables[0][0][I.Columns[0][o]])&&a.e.IsNum(I.Tables[0][0][I.Columns[0][o]])&&(null!=this.DebitAccount?(this.DebitAccount.SelectedValue=parseInt(I.Tables[0][0][I.Columns[0][o]]),n.a.SessionManager.Preferences.ContainsKey("DisableAutoLoad")&&"true"==n.a.SessionManager.Preferences.DisableAutoLoad.toLowerCase()&&(null!=this.DebitAccount.Code&&this.DebitAccount.Code.Visible&&I.Columns[0].Contains("DebitAccountCode")&&(this.DebitAccount.Code.SelectedValueText=I.Tables[0][0].DebitAccountCode.toString()),null!=this.DebitAccount.Name&&this.DebitAccount.Name.Visible&&(I.Columns[0].Contains("DebitAccountName")||I.Columns[0].Contains("DebitAccountname"))&&(a.e.hasprop(I.Tables[0][0],"DebitAccountName")?this.DebitAccount.Name.SelectedValueText=I.Tables[0][0].DebitAccountName.toString():a.e.hasprop(I.Tables[0][0],"DebitAccountname")&&(this.DebitAccount.Name.SelectedValueText=I.Tables[0][0].DebitAccountname.toString())))):null!=m&&this.GridDataColumns.Contains("DebitAccount_Key")&&(m.DebitAccount_Key=parseInt(I.Tables[0][0][I.Columns[0][o]]),(f=this.ColumnSource.filter(e=>!a.e.IsEmpty(e.ValueMember)&&"debitaccount_key"==e.ValueMember.toLowerCase())).length>0&&(f.length>0&&"AccountName"==f[0].DisplayMember&&I.Columns[0].Contains("DebitAccountName")?m[f[0].DisplayMember]=I.Tables[0][0].DebitAccountName.toString():f.length>0&&"AccountCode"==f[0].DisplayMember&&I.Columns[0].Contains("DebitAccountCode")&&(m[f[0].DisplayMember]=I.Tables[0][0].DebitAccountCode.toString()),f.length>1&&"AccountName"==f[f.length-1].DisplayMember&&I.Columns[0].Contains("DebitAccountName")?m[f[f.length-1].DisplayMember]=I.Tables[0][0].DebitAccountName.toString():f.length>1&&"AccountCode"==f[f.length-1].DisplayMember&&I.Columns[0].Contains("DebitAccountCode")&&(m[f[f.length-1].DisplayMember]=I.Tables[0][0].DebitAccountCode.toString())))),"accountid"==I.Columns[0][o].toLowerCase()&&!a.e.IsEmpty(I.Tables[0][0][I.Columns[0][o]])&&a.e.IsNum(I.Tables[0][0][I.Columns[0][o]])&&null!=m&&this.GridDataColumns.Contains("AccountID_Key")&&(m.AccountID_Key=parseInt(I.Tables[0][0][I.Columns[0][o]]),this.GridDataColumns.Contains("AccountCode")&&(m.AccountCode=I.Tables[0][0].AccountIDCode.toString()),this.GridDataColumns.Contains("AccountName")&&(m.AccountName=I.Tables[0][0].AccountIDName.toString())),"CREDITACCOUNT"==I.Columns[0][o].toUpperCase()&&!a.e.IsEmpty(I.Tables[0][0][I.Columns[0][o]])&&a.e.IsNum(I.Tables[0][0][I.Columns[0][o]]))if(null!=this.CreditAccount)this.CreditAccount.SelectedValue=parseInt(I.Tables[0][0][I.Columns[0][o]]),n.a.SessionManager.Preferences.ContainsKey("DisableAutoLoad")&&"true"==n.a.SessionManager.Preferences.DisableAutoLoad.toLowerCase()&&(null!=this.CreditAccount.Code&&this.CreditAccount.Code.Visible&&I.Columns[0].Contains("CreditAccountCode")&&(this.CreditAccount.Code.SelectedValueText=I.Tables[0][0].CreditAccountCode.toString()),null!=this.CreditAccount.Name&&this.CreditAccount.Name.Visible&&I.Columns[0].Contains("CreditAccountname")&&(this.CreditAccount.Name.SelectedValueText=I.Tables[0][0].CreditAccountname.toString()));else if(null!=m&&this.GridDataColumns.Contains("CreditAccount_Key")){var f;m.CreditAccount_Key=parseInt(I.Tables[0][0][I.Columns[0][o]]),(f=this.ColumnSource.filter(e=>!a.e.IsEmpty(e.ValueMember)&&"creditaccount_key"==e.ValueMember.toLowerCase())).length>0&&(f.length>0&&"AccountName"==f[0].DisplayMember&&I.Columns[0].Contains("CreditAccountname")?m[f[0].DisplayMember]=I.Tables[0][0].CreditAccountname.toString():f.length>0&&"AccountCode"==f[0].DisplayMember&&I.Columns[0].Contains("CreditAccountCode")&&(m[f[0].DisplayMember]=I.Tables[0][0].CreditAccountCode.toString()),f.length>1&&"AccountName"==f[f.length-1].DisplayMember&&I.Columns[0].Contains("CreditAccountname")?m[f[f.length-1].DisplayMember]=I.Tables[0][0].CreditAccountname.toString():f.length>1&&"AccountCode"==f[f.length-1].DisplayMember&&I.Columns[0].Contains("CreditAccountCode")&&(m[f[f.length-1].DisplayMember]=I.Tables[0][0].CreditAccountCode.toString()))}if(N&&I.Columns[0][o].toUpperCase().Contains("CCNID")&&this.GridDataColumns.Contains(I.Columns[0][o]+"_Key")){(P=this.ColumnSource.find(e=>null!=e.ValueMember&&e.ValueMember.toLowerCase()==I.Columns[0][o].toLowerCase()+"_key")).LocalRefDefaultValue=I.Tables[0][0][I.Columns[0][o]].toString(),I.Columns[0].Contains(I.Columns[0][o]+"Name")&&(P.LocalRefDefaultValueText=I.Tables[0][0][I.Columns[0][o]+"Name"].toString());for(let e=0;e<this.GridData.length;e++)a.e.IsEmpty(this.GridData[e][g])||(this.GridData[e][P.ValueMember]=I.Tables[0][0][I.Columns[0][o]].toString(),I.Columns[0].Contains(I.Columns[0][o]+"Name")&&(this.GridData[e][P.DisplayMember]=I.Tables[0][0][I.Columns[0][o]+"Name"].toString()))}if(null!=m){if(null!=d&&!d.Contains(I.Columns[0][o]))continue;61==C&&this.GridDataColumns.Contains("StartYear")&&this.GridDataColumns.Contains("EndYear")&&I.Columns[0].Contains("StartYear")&&I.Columns[0].Contains("ENDYear")&&(m.StartYear=I.Tables[0][0].StartYear.toString(),m.EndYear=I.Tables[0][0].ENDYear.toString());for(let e=0;e<this.GridDataColumns.length;e++)if(this.GridDataColumns[e]==I.Columns[0][o]){if(I.Columns[0][o].toUpperCase().Contains("CCNID")&&this.GridDataColumns.Contains(I.Columns[0][o]+"_Key")){if(!a.e.IsEmpty(I.Tables[0][0][I.Columns[0][o]])&&parseInt(I.Tables[0][0][I.Columns[0][o]])>0){if(m[this.GridDataColumns[e]+"_Key"]=I.Tables[0][0][I.Columns[0][o]].toString(),null!=(P=this.ColumnSource.find(t=>null!=t.ValueMember&&t.ValueMember.toLowerCase()==this.GridDataColumns[e].toLowerCase()+"_key"))&&this.IsCodeFirstCol(P.CostCenterID,P.TypeID)&&I.Columns[0].Contains(I.Columns[0][o]+"Code")?this.GridDataColumns.Contains(this.GridDataColumns[e]+"Code")?(m[this.GridDataColumns[e]]=I.Tables[0][0][I.Columns[0][o]+"Name"].toString(),m[this.GridDataColumns[e]+"Code"]=I.Tables[0][0][I.Columns[0][o]+"Code"].toString()):m[this.GridDataColumns[e]]=I.Tables[0][0][I.Columns[0][o]+"Code"].toString():m[this.GridDataColumns[e]]=I.Columns[0].Contains(I.Columns[0][o]+"Name")&&!a.e.IsEmpty(I.Tables[0][0][I.Columns[0][o]+"Name"])?I.Tables[0][0][I.Columns[0][o]+"Name"].toString():"",this.Preferences.ContainsKey("DimWiseAttachments")&&""!=this.Preferences.DimWiseAttachments&&"0"!=this.Preferences.DimWiseAttachments&&null!=P&&P.CostCenterID.toString()==this.Preferences.DimWiseAttachments&&(this.GridDataObj.updateRow(m),1==m.Table.filter(I.Columns[0][o]+"_Key="+I.Tables[0][0][I.Columns[0][o]].toString()).length&&this.ReferenceCallBack.IsSubscribed)){let e=null;if(null!=(T=this.ColumnSource.find(e=>e.DisplayMember.toLowerCase()==I.Columns[0][o].toLowerCase()))){let t=this.GetFiles(T.CostCenterID,parseInt(I.Tables[0][0][I.Columns[0][o]]));t.Tables.length>0&&t.Tables[0].length>0&&this.ReferenceCallBack.Call({ReferenceTable:t.Tables[0],ReferenceEditTable:null,DBColumnName:"Attachments~"+I.Tables[0][0][I.Columns[0][o]+"Name"].toString(),ccid:0,dr:e})}}parseInt(m[this.GridDataColumns[e]+"_Key"])>0&&null!=P&&((this.Data.Tables[0].filter(e=>null!=e.LocalReference&&e.LocalReference==P.ID).length>0||this.DefaultBasedOn.ContainsKey(P.CostCenterID.toString()))&&this.GetLinkReferenceData(parseInt(P.ID),t,parseInt(m[this.GridDataColumns[e]+"_Key"]),i,"",P.CostCenterID,m),p&&this.PriceTaxcc.ContainsKey(P.CostCenterID)&&this.ReferenceCallBack.IsSubscribed&&this.ReferenceCallBack.Call({ReferenceTable:null,ReferenceEditTable:null,DBColumnName:"ReEvaluate",ccid:P.CostCenterID,dr:m}))}I.Columns[0].Contains(I.Columns[0][o]+"Group")&&!a.e.IsEmpty(I.Tables[0][0][I.Columns[0][o]+"Group"])&&Object(S.j)(I.Tables[0][0][I.Columns[0][o]+"Group"])}else if(!a.e.IsEmpty(I.Tables[0][0][I.Columns[0][o]])){var T,P;this.GridDataObj.DataTypes.Double.Contains(this.GridDataColumns[e])&&a.e.IsNum(I.Tables[0][0][I.Columns[0][o]])?m[this.GridDataColumns[e]]=I.Tables[0][0][I.Columns[0][o]].toString():this.GridDataObj.DataTypes.Double.Contains(this.GridDataColumns[e])||this.GridDataColumns.Contains(this.GridDataColumns[e]+"_Key")||(m[this.GridDataColumns[e]]=I.Columns[0].Contains(I.Columns[0][o]+"Name")?I.Tables[0][0][I.Columns[0][o]+"Name"].toString():I.Tables[0][0][I.Columns[0][o]].toString()),this.GridDataColumns.Contains(this.GridDataColumns[e]+"_Key")&&(this.GridDataObj.DataTypes.Date.Contains(this.GridDataColumns[e]+"_Key")?a.e.isValidDate(I.Tables[0][0][I.Columns[0][o]])&&("DATETIME"==(T=this.ColumnSource.find(e=>e.DisplayMember.toLowerCase()==I.Columns[0][o].toLowerCase())).DataType?(m[T.DisplayMember]=new Date(I.Tables[0][0][I.Columns[0][o]]).ToString(n.a.SessionManager.Preferences["Date Format"]+" hh:mm:ss tt"),m[T.DisplayMember+"_Key"]=new Date(I.Tables[0][0][I.Columns[0][o]])):"TIME"==T.DataType?(m[T.DisplayMember]=new Date(I.Tables[0][0][I.Columns[0][o]]).ToString("hh:mm:ss tt"),m[T.DisplayMember+"_Key"]=new Date(I.Tables[0][0][I.Columns[0][o]])):"Time2"==T.DataType?(m[T.DisplayMember]=new Date(I.Tables[0][0][I.Columns[0][o]]).ToString("HH:mm"),m[T.DisplayMember+"_Key"]=new Date(I.Tables[0][0][I.Columns[0][o]]).ToString("dd/MMM/yyyy HH:mm")):(m[this.GridDataColumns[e]+"_Key"]=new Date(I.Tables[0][0][I.Columns[0][o]]),m[this.GridDataColumns[e]]=new Date(I.Tables[0][0][I.Columns[0][o]]).ToString(n.a.SessionManager.Preferences["Date Format"]))):(m[this.GridDataColumns[e]+"_Key"]=I.Tables[0][0][I.Columns[0][o]].toString(),(P=this.ColumnSource.find(t=>null!=t.ValueMember&&t.ValueMember.toLowerCase()==this.GridDataColumns[e].toLowerCase()+"_key"))&&this.IsCodeFirstCol(P.CostCenterID,P.TypeID)&&I.Columns[0].Contains(I.Columns[0][o]+"Code")?m[this.GridDataColumns[e]]=I.Tables[0][0][I.Columns[0][o]+"Code"].toString():I.Columns[0].Contains(I.Columns[0][o]+"Name")&&!a.e.IsEmpty(I.Tables[0][0][I.Columns[0][o]+"Name"])&&(m[this.GridDataColumns[e]]=I.Tables[0][0][I.Columns[0][o]+"Name"].toString())))}this.GridDataObj.updateRow(m)}}}if(2==C&&(I.Columns[0].Contains("DebitDays")&&(this.IsPurchase&&null!=this.CreditAccount&&this.CreditAccount.DBColumnID==e||!this.IsPurchase&&null!=this.DebitAccount&&this.DebitAccount.DBColumnID==e)&&(this.IsInventory&&("true"==n.a.SessionManager.Preferences.EnableLocationWise.toLowerCase()&&"true"==n.a.SessionManager.Preferences["LW CreditDebit"].toLowerCase()||"true"==n.a.SessionManager.Preferences.EnableDivisionWise.toLowerCase()&&"true"==n.a.SessionManager.Preferences["DW CreditDebit"].toLowerCase()||""!=n.a.SessionManager.Preferences.DimWiseCreditDebit&&parseInt(n.a.SessionManager.Preferences.DimWiseCreditDebit)>5e4)?this.GetDueDate(this.IsPurchase&&null!=this.CreditAccount?this.CreditAccount.SelectedValue:this.DebitAccount.SelectedValue,i,this.IsPurchase):this.GetDueDate_Table(I.Tables[0],i,this.IsPurchase)),this.GetLCTRLimits()),(this.Preferences.ContainsKey("PrimaryAddress")&&Object(S.j)(this.Preferences.PrimaryAddress)&&Object(S.j)(this.Preferences.PrimaryAddress)||this.Preferences.ContainsKey("BillingAddress")&&Object(S.j)(this.Preferences.BillingAddress)&&Object(S.j)(this.Preferences.BillingAddress)||this.Preferences.ContainsKey("ShippingAddress")&&Object(S.j)(this.Preferences.ShippingAddress)&&Object(S.j)(this.Preferences.ShippingAddress))&&2==C&&this.IsInventory&&s>0&&null!=I&&I.Tables.length>1&&I.Tables[1].length>0&&this.ReferenceCallBack.IsSubscribed){let e=null;("DebitAccount"==o||"CreditAccount"==o&&this.IsPurchase)&&this.ReferenceCallBack.Call({ReferenceTable:I.Tables[1],ReferenceEditTable:null,DBColumnName:o,ccid:0,dr:e})}if(2==C&&s>0&&null!=I&&I.Tables.length>5&&I.Tables[5].length>0&&this.Preferences.ContainsKey("Account-wiseAttachments")&&""!=this.Preferences["Account-wiseAttachments"]&&Object(S.j)(this.Preferences["Account-wiseAttachments"])&&(this.IsInventory&&(this.IsPurchase&&null!=this.CreditAccount&&this.CreditAccount.DBColumnID==e||!this.IsPurchase&&null!=this.DebitAccount&&this.DebitAccount.DBColumnID==e)||!this.IsInventory)&&this.ReferenceCallBack.IsSubscribed){let t="";if(null!=this.CreditAccount&&this.CreditAccount.DBColumnID==e)t=null!=this.CreditAccount.Name?this.CreditAccount.Name.Text:null!=this.CreditAccount.Code?this.CreditAccount.Code.Text:"";else if(null!=this.DebitAccount&&this.DebitAccount.DBColumnID==e)t=null!=this.DebitAccount.Name?this.DebitAccount.Name.Text:null!=this.DebitAccount.Code?this.DebitAccount.Code.Text:"";else if(null!=m&&!this.IsInventory){var M=this.ColumnSource.find(t=>t.ID==e.toString());M&&this.GridDataColumns.Contains(M.DisplayMember)&&(t=m[M.DisplayMember].toString())}this.ReferenceCallBack.Call({ReferenceTable:I.Tables[5],ReferenceEditTable:null,DBColumnName:"Attachments~"+t,ccid:0,dr:null})}if(2==C&&this.Preferences.ContainsKey("Use Account-wise Currency")&&""!=this.Preferences["Use Account-wise Currency"]&&Object(S.j)(this.Preferences["Use Account-wise Currency"])&&(this.IsInventory&&(this.IsPurchase&&null!=this.CreditAccount&&this.CreditAccount.DBColumnID==e||!this.IsPurchase&&null!=this.DebitAccount&&this.DebitAccount.DBColumnID==e)||!this.IsInventory&&(null!=this.CreditAccount&&this.CreditAccount.DBColumnID==e||null!=this.DebitAccount&&this.DebitAccount.DBColumnID==e||17==this.DocumentType))&&null!=I&&I.Tables.length>2&&I.Columns[2].Contains("CurrencyID")&&I.Tables[2].length>0&&parseInt(I.Tables[2][0].CurrencyID)>0){let e=parseInt(I.Tables[2][0].CurrencyID);17==this.DocumentType?(this.GridDataColumns.Contains("CurrencyID")&&(m.CurrencyID_Key=e),I.Tables.length>3&&I.Tables[3].length>0&&I.Columns[3].Contains("Name")&&!a.e.IsEmpty(I.Tables[3][0].Name)&&(m.CurrencyID=I.Tables[3][0].Name.toString()),this.GridDataColumns.Contains("ExchangeRate")&&I.Tables.length>3&&I.Tables[3].length>0&&I.Columns[3].Contains("Rate")&&!a.e.IsEmpty(I.Tables[3][0].Rate)&&(m.ExchangeRate=I.Tables[3][0].Rate.toString())):this.HeaderFields.forEach(t=>{t instanceof h.b&&(t.Currency.SelectedValue=e.toString(),I.Tables.length>3&&I.Tables[3].length>0&&I.Columns[3].Contains("Rate")&&!a.e.IsEmpty(I.Tables[3][0].Rate)&&(t.ExchangeRate.Text=I.Tables[3][0].Rate.toString()))})}if(3==C&&null!=I&&I.Tables.length>2||2==C&&null!=I&&I.Tables.length>6){let e=2;for(2==C&&(e=6);e<I.Tables.length;e++)if(!I.Columns[e].Contains("ErrorMessage")&&I.Tables[e].length>0&&I.Columns[e].length>0){let t=I.Columns[e][0];if(null!=m&&this.GridDataColumns.Contains(t))if(t.toLowerCase().Contains("dcnum"))a.e.IsNum(I.Tables[e][0][t])&&(m[t]=I.Tables[e][0][t].toString());else{var L=this.ColumnSource.find(e=>null!=e.DisplayMember&&e.DisplayMember.toLowerCase()==t.toLowerCase());L&&"DATE"==L.DataType?!a.e.IsEmpty(I.Tables[e][0][t])&&a.e.isValidDate(I.Tables[e][0][t])&&(m[t]=new Date(I.Tables[e][0][t]).ToString(n.a.SessionManager.Preferences["Date Format"]),m[t+"_Key"]=new Date(I.Tables[e][0][t])):"FLOAT"==L.DataType?a.e.IsNum(I.Tables[e][0][t])&&(m[t]=I.Tables[e][0][t].toString()):m[t]=I.Tables[e][0][t].toString()}t.toLowerCase().Contains("dcalpha")&&this._TextFields.forEach(s=>{s.DBColumnName==t&&(s instanceof r.d?s.Text=I.Tables[e][0][t].toString():s instanceof l.c&&!a.e.IsEmpty(I.Tables[e][0][t])&&a.e.isValidDate(I.Tables[e][0][t])&&(s.Date=new Date(I.Tables[e][0][t])))})}}else if(C>5e4&&null!=I){if(this.Preferences.ContainsKey("DimWiseCurrency")&&"true"==this.Preferences.DimWiseCurrency.toLowerCase()&&this.Preferences.ContainsKey("CurrencyDim")&&this.Preferences.CurrencyDim==C.toString()&&I.Tables.length>1&&I.Columns[1].Contains("CurrencyID")&&I.Tables[1].length>0&&parseInt(I.Tables[1][0].CurrencyID)>0)for(let e=0;e<this.HeaderFields.length;e++){let t=this.HeaderFields[e];if(t instanceof h.b){t.Currency.SelectedValue=I.Tables[1][0].CurrencyID.toString(),this.SetCurrDefault(C,s,t),I.Tables.length>2&&I.Tables[2].length>0&&I.Columns[2].Contains("Rate")&&!a.e.IsEmpty(I.Tables[2][0].Rate)&&(t.ExchangeRate.Text=I.Tables[2][0].Rate.toString());break}}null!=m&&I.Tables.length>3&&!I.Columns[3].Contains("voucherno")&&I.Columns[3].Contains("ProductID")&&I.Tables[3].length>0&&this.GridDataColumns.Contains("ProductID_Key")&&m.ProductID_Key.toString()!=I.Tables[3][0].ProductID.toString()&&(m.ProductID_Key=I.Tables[3][0].ProductID.toString(),this.GridDataColumns.Contains("Productcode")&&I.Tables[3].Columns.Contains("ProductCode")&&(m.Productcode=I.Tables[3][0].ProductCode.toString()),this.GridDataColumns.Contains("ProductName")&&I.Tables[3].Columns.Contains("ProductName")&&(m.ProductName=I.Tables[3][0].ProductName.toString()),this.ReferenceCallBack.Call({ReferenceTable:null,ReferenceEditTable:null,DBColumnName:"",ccid:0,dr:m}))}C>5e4&&null!=this.DueDate&&null!=this.DueDate.Formula&&""!=this.DueDate.Formula&&this.ReferenceCallBack.Call({ReferenceTable:null,ReferenceEditTable:null,DBColumnName:"Formula",ccid:0,dr:null}),56!=this.DocumentType&&58!=this.DocumentType&&61!=this.DocumentType&&65!=this.DocumentType&&71!=this.DocumentType&&72!=this.DocumentType&&73!=this.DocumentType&&94!=this.DocumentType&&78!=this.DocumentType&&68!=this.DocumentType&&69!=this.DocumentType&&80!=this.DocumentType||this.ReferenceCallBack.Call({ReferenceTable:null,ReferenceEditTable:null,DBColumnName:"Dimension",ccid:0,dr:null}),38==this.DocumentType||39==this.DocumentType?this.GridDataObj.refreshDatawithIDs():this.GridDataObj.refreshDataView()}}SetCurrDefault(e,t,s){50001==e?(this.DivisionID>0&&this.DivisionID==t||n.a.SessionManager.DivisionID>0&&n.a.SessionManager.DivisionID==t||this.CostCentersValues.ContainsKey("50001"))&&(s.DefaultValue=s.Currency.SelectedValue):"50002"==e.toString()?(this.LocationID>0&&this.LocationID==t||n.a.SessionManager.LocationID>0&&n.a.SessionManager.LocationID==t||this.CostCentersValues.ContainsKey("50002"))&&(s.DefaultValue=s.Currency.SelectedValue):this.CostCentersValues.ContainsKey(e.toString())&&(s.DefaultValue=s.Currency.SelectedValue)}IsCodeFirstCol(e,t){let s,a;return s=null!=t&&t>0?t:1,a=n.a.SessionManager.ListViewDef.Columns[0].Contains("ColumnType")?n.a.SessionManager.ListViewDef.Tables[0].filter(t=>t.CostCenterID==e&&t.ListViewTypeID==s&&1==t.ColumnType):n.a.SessionManager.ListViewDef.Tables[0].filter(t=>t.CostCenterID==e&&t.ListViewTypeID==s),!!(a.length>0&&a[0].SysColumnName.toString().toLowerCase().Contains("code"))}FillBudgetDims(e,t,s,i){if(this.Preferences.ContainsKey("BudgetDims")&&""!=this.Preferences.BudgetDims){let s="",r="",l=0;var o=this.Preferences.BudgetDims.split(",");for(let t=0;t<o.length;t++)l=a.e.Int(o[t].Replace("dcCCNID","")),l>0&&(l+=5e4,s+=e?"  ,budg.CCNID"+(l-5e4).toString()+" as dcccnid"+(l-5e4).toString()+"_Key,CC"+t.toString()+".Code as dcccnid"+(l-5e4).toString()+"Code,CC"+t.toString()+".Name as dcccnid"+(l-5e4).toString():"  ,budg.CCNID"+(l-5e4).toString()+" as TOdcccnid"+(l-5e4).toString()+"_Key,CC"+t.toString()+".Code as TOdcccnid"+(l-5e4).toString()+"Code,CC"+t.toString()+".Name as TOdcccnid"+(l-5e4).toString(),r+=" LEFT JOIN "+this.GetTableName(l)+" CC"+t.toString()+"  WITH(NOLOCK)  on  CC"+t.toString()+".NodeID=budg.CCNID"+(l-5e4).toString()+" ");let u=n.a.common.GetDataSet("DOC051",JSON.stringify(s+" from COM_BudgetAlloc  budg WITH(NOLOCK) "+r+" where budg.BudgetDefID="+t+" and budg.AccountID="+i));if(null!=u&&u.Tables.length>0&&u.Columns[0].Contains("BudgetDefID")&&u.Tables[0].length>0)return u}return null}GetLinkDocDetails(e,t,s="",o=!1){Logger.InfoLog("VoucherGenerator:: Inside GetLinkDetails");let r=[];r.push(e),r.push(t),r.push(this.DocID),r.push(1==this.DocumentType||2==this.DocumentType||6==this.DocumentType||39==this.DocumentType||26==this.DocumentType||27==this.DocumentType||3==this.DocumentType||4==this.DocumentType||25==this.DocumentType||13==this.DocumentType?null!=this.CreditAccount&&this.CreditAccount.SelectedValue>0?this.CreditAccount.SelectedValue:0:null!=this.DebitAccount&&this.DebitAccount.SelectedValue>0?this.DebitAccount.SelectedValue:0);let l="",u=0;if(this.Preferences.ContainsKey("DimensionWise")&&""!=this.Preferences.DimensionWise&&this.Preferences.DimensionWise.split(",").forEach(e=>{if(a.e.IsNum(e)&&parseInt(e)>0)if(u=parseInt(e),3==u){var t=this._TextFields.find(e=>e instanceof c.b&&3==e.CCID);t&&(l+=null!=t.SelectedValue&&t.SelectedValue>0?" and "+t.DBColumnName+"="+t.SelectedValue.toString():" and "+t.DBColumnName+"=0")}else if(u>5e4){let e=this._CCFields.find(e=>e instanceof c.b&&e.CCID==u);e&&(l+=null!=e.SelectedValue&&e.SelectedValue>0?" and "+e.DBColumnName+"="+e.SelectedValue.toString():" and "+e.DBColumnName+"=0")}}),r.push(l),this.Preferences.ContainsKey("SearchProduct")&&Object(S.j)(this.Preferences.SearchProduct)){alert("Voucher Generator: SearchProduct list");var D=this.ColumnSource.find(e=>null!=e.ValueMember&&"productid_key"==e.ValueMember.toString().toLowerCase()&&"ProductCode"==e.DisplayMember);let e=new b.a;e.CostCenterID=3,e.strPrimaryKey="ProductID",D&&(e.TypeID=D.TypeID),e.FillSearchDetails(new i.a,!1),r.push(e.IgnoreSpecial),r.push(e.strJoin),r.push(e.SearchWhere)}else r.push(0),r.push(""),r.push("");return this.Preferences.ContainsKey("FilteronList")&&Object(S.j)(this.Preferences.FilteronList)?(D=this.ColumnSource.find(e=>null!=e.ValueMember&&"productid_key"==e.ValueMember.toString().toLowerCase()&&"ProductCode"==e.DisplayMember),r.push(D?D.TypeID:0)):r.push(0),r.push(s),r.push(n.a.SessionManager.UserID),r.push(n.a.SessionManager.LanguageID),n.a.document.GetLinkDocDetails(JSON.stringify(r),o)}GetjobDetails(e,t,s,a){let i,o=[];return o.push(e),o.push(this.DocID),o.push(t),o.push(s),o.push(this.CostCenterID),o.push(n.a.SessionManager.UserID),o.push(n.a.SessionManager.LanguageID),i=a?n.a.document.GetBomDetails(o):n.a.document.GetjobDetails(o),i}GetBatchDetails(e){let t=[];return t.push(e),t.push(n.a.SessionManager.RoleID),t.push(n.a.SessionManager.LanguageID),n.a.document.GetBatchDetails(t)}GetQtyAdjustmentDetails(e){let t=[];return t.push(a.e.IsEmpty(e)?"0":e),t.push(n.a.SessionManager.UserID),t.push(n.a.SessionManager.LanguageID),n.a.document.GetQtyAdjustmentDetails(t)}GetConversion(e){let t=0,s=n.a.common.GetDataSet("DOC033",e);return null!=s&&s.Tables.length>0&&s.Columns[0].Contains("Conversion")&&s.Tables[0].length>0&&!a.e.IsEmpty(s.Tables[0][0].Conversion)&&(t=parseFloat(s.Tables[0][0].Conversion)),Logger.InfoLog("VoucherGenerator:: Exiting GetLinkDetails"),t}getProfileBasedon(e,t,s,a){Logger.InfoLog("VoucherGenerator:: Inside getProfileBasedon");let i=[];i.push(e),i.push(t),i.push(s),i.push(a),i.push(n.a.SessionManager.UserID),i.push(n.a.SessionManager.LanguageID);let o=n.a.document.getProfileBasedon(i);return Logger.InfoLog("VoucherGenerator:: Exiting getProfileBasedon"),o}GetBatch(e,t,s){s.BatchID=0;let i=[];i.push(e),i.push(t);let o=n.a.document.IsBatchExists(i);return null!=o&&o.Tables.length>1&&o.Tables[1].length>0&&o.Columns[1].Contains("BatchId")&&!a.e.IsEmpty(o.Tables[1][0].BatchId)&&(s.BatchID=parseInt(o.Tables[1][0].BatchId)),o}GetPosVoucherDetails(e,t,s){Logger.InfoLog("VoucherGenerator:: Inside GetPosVoucherDetails");let a=[];a.push(e),a.push(t),a.push(n.a.SessionManager.UserID),a.push(n.a.SessionManager.LanguageID);let i=n.a.document.GetPosVoucherDetails(a);return Logger.InfoLog("VoucherGenerator:: Exiting GetPosVoucherDetails"),i}GetPDCInstallmentDetails(){return n.a.common.GetDataSet3("DOC032",this.DocID.toString(),this.PostVoucherDocID.toString())}getmachinePref(){return n.a.common.GetDataSet("DOC059","")}GetProdTestCaseDetails(e){let t=[];return t.push(e),t.push(this.CostCenterID),t.push(this.GetTableName(parseInt(n.a.SessionManager.Preferences.TestCaseDimension))),t.push(n.a.SessionManager.UserID),t.push(n.a.SessionManager.LanguageID),n.a.document.GetTestCases(t)}GetProdVWDetails(e){return n.a.common.GetDataSet3("DOC028",e,n.a.SessionManager.Preferences.PackDimension)}GetPackDetails(e){Logger.InfoLog("VoucherGenerator:: Inside GetPackDetails");let t=n.a.common.GetDataSet3("DOC006",n.a.SessionManager.Preferences.PackDimension,e);return Logger.InfoLog("VoucherGenerator:: Exiting GetPackDetails"),t}GetPackInfo(e,t){return n.a.common.GetDataSet3("DOC029",e,t)}GetinvBinDetails(e,t,s){let i="";for(let n=0;n<this.GridData.length;n++)a.e.IsEmpty(this.GridData[n].DocDetailsID)||"0"==this.GridData[n].DocDetailsID.toString()||(i+=this.GridData[n].DocDetailsID.toString()+",");let o="";for(let n=0;n<this.GridData.length;n++)a.e.IsEmpty(this.GridData[n].ProductID_Key)||this.GridData[n].ProductID_Key.toString()!=t||a.e.IsEmpty(this.GridData[n].LinkedInvDocDetailsID)||"0"==this.GridData[n].LinkedInvDocDetailsID.toString()||(a.e.IsEmpty(o)||(o+=","),o+=this.GridData[n].LinkedInvDocDetailsID.toString());let r=[];return r.push(o),r.push(s),r.push(e),r.push(t),r.push(i),r.push(a.e.String(n.a.SessionManager.Preferences.HoldResCancelledDocs)),r.push(a.e.String(this.Preferences.CopyBinsFromBoe)),r.push(a.e.String(this.Preferences.BinsDimension)),r.push(a.e.String(this.Preferences.ConsolidatedBins)),r.push(a.e.String(this.Preferences.ExcludeHoldBins)),n.a.common.GetDataSet("DOC041",JSON.stringify(r))}GetBOEs(e,t,s){let i=[];return i.push(t),i.push(e.ToString("dd/MMM/yyyy")),i.push(a.e.IsEmpty(s)?"0":s),i.push(n.a.SessionManager.UserID),i.push(n.a.SessionManager.LanguageID),n.a.document.GetBOEs(i)}GetQtyWhere(e,t){let s=0,i=!1,o="";var r;return n.a.SessionManager.Preferences.ContainsKey("Maintain Dimensionwise stock")&&a.e.Int(n.a.SessionManager.Preferences["Maintain Dimensionwise stock"])>0&&(s=a.e.Int(n.a.SessionManager.Preferences["Maintain Dimensionwise stock"]),this.GridDataColumns.Contains("dcCCNID"+(s-5e4)+"_Key")?null==e||a.e.IsEmpty(e["dcCCNID"+(s-5e4)+"_Key"])||(o+=" "+t+"dcCCNID"+(s-5e4).toString()+"="+e["dcCCNID"+(s-5e4)+"_Key"].toString()+" and "):((r=this._CCFields.find(e=>e.DBColumnName.toLowerCase()=="dcccnid"+(s-5e4)))&&r instanceof c.b&&r.SelectedValue>0||r&&r instanceof D.a&&r.SelectedValue>0)&&(o+=" "+t+"dcCCNID"+(s-5e4).toString()+"="+r.SelectedValue+" and ")),n.a.SessionManager.Preferences.ContainsKey("Location Stock")&&Object(S.j)(n.a.SessionManager.Preferences["Location Stock"])&&(this.GridDataColumns.Contains("dcCCNID2_Key")?null==e||a.e.IsEmpty(e.dcCCNID2_Key)||(o+=" "+t+"dcCCNID2="+e.dcCCNID2_Key.toString()+" and "):(r=this._CCFields.find(e=>"dcccnid2"==e.DBColumnName.toLowerCase()))&&r instanceof c.b||r&&r instanceof D.a?r.SelectedValue>0&&(o+=" "+t+"dcCCNID2="+r.SelectedValue+" and "):this.LocationID>0?o+=" "+t+"dcCCNID2="+this.LocationID+" and ":n.a.SessionManager.LocationID>0&&(o+=" "+t+"dcCCNID2="+n.a.SessionManager.LocationID+" and ")),i=!1,n.a.SessionManager.Preferences.ContainsKey("Division Stock")&&Object(S.j)(n.a.SessionManager.Preferences["Division Stock"])&&(this.GridDataColumns.Contains("dcCCNID1_Key")?null==e||a.e.IsEmpty(e.dcCCNID1_Key)||(o+=" "+t+"dcCCNID1="+e.dcCCNID1_Key.toString()+" and "):(r=this._CCFields.find(e=>"dcccnid1"==e.DBColumnName.toLowerCase()))&&r instanceof c.b||r&&r instanceof D.a?r.SelectedValue>0&&(o+=" "+t+"dcCCNID1="+r.SelectedValue+" and "):this.DivisionID>0?o+=" "+t+"dcCCNID1="+this.DivisionID+" and ":n.a.SessionManager.DivisionID>0&&(o+=" "+t+"dcCCNID1="+n.a.SessionManager.DivisionID+" and ")),o}GetinvDetails(e,t,s,i,o,r,l=!1,u=""){let c="2";if(n.a.SessionManager.Preferences.ContainsKey("DecimalsinQty")&&!a.e.IsEmpty(n.a.SessionManager.Preferences.DecimalsinQty)&&(c=n.a.SessionManager.Preferences.DecimalsinQty),a.e.IsEmpty(t)&&!l)return null;let D=[],h="",C="",m="";if(""==e){C=this.GetQtyWhere(null,"acc."),a.e.IsEmpty(C)||(C="and "+C.Remove(C.length-5,4));for(let e=0;e<this.GridData.length;e++)a.e.IsEmpty(this.GridData[e].DocDetailsID)||"0"==this.GridData[e].DocDetailsID.toString()||(m+=this.GridData[e].DocDetailsID.toString()+",");if(this.Preferences.ContainsKey("ClubBoe")&&"True"==this.Preferences.ClubBoe&&!r){m="",o="";for(let e=0;e<this.GridData.length;e++)a.e.IsEmpty(this.GridData[e].ProductID_Key)||this.GridData[e].ProductID_Key.toString()!=s||a.e.IsEmpty(this.GridData[e].LinkedInvDocDetailsID)||"0"==this.GridData[e].LinkedInvDocDetailsID.toString()||(o+=this.GridData[e].LinkedInvDocDetailsID.toString()+",");""!=o&&(o=o.substr(0,o.length-1))}}else h=" and a.IsQtyIgnored=0 and a.VoucherType=1 and a.InvDocDetailsID IN("+t+") ";return D.push(e),D.push(h),D.push(t),D.push(s),D.push(i),D.push(o),D.push(r),D.push(l),D.push(u),D.push(C),D.push(m),D.push(this.DocDate.Date.ToString("dd/MMM/yyyy")),D.push(a.e.String(n.a.SessionManager.Preferences.HoldResCancelledDocs)),D.push(a.e.String(n.a.SessionManager.Preferences.BOEStartDate)),D.push(a.e.String(this.Preferences.ExcludeHoldBins)),D.push(a.e.String(this.Preferences.CopyBinsFromBoe)),D.push(a.e.String(this.Preferences.BinsDimension)),D.push(a.e.String(this.Preferences.ConsolidatedBins)),D.push(c),n.a.common.GetDataSet("DOC042",JSON.stringify(D))}static GetPOSDetails(e,t,s,a,i,o){return n.a.document.GetPOSDetails(e,t,s,a,i,o)}GetProductByStockCode(e){let t=[];return t.push(e),""!=n.a.SessionManager.Preferences.POSItemCodeDimension?(t.push(this.GetTableName(parseInt(n.a.SessionManager.Preferences.POSItemCodeDimension))),t.push(parseInt(n.a.SessionManager.Preferences.POSItemCodeDimension))):(t.push(""),t.push(0)),t.push(n.a.SessionManager.UserID),t.push(n.a.SessionManager.LanguageID),n.a.document.GetProductByStockCode(t)}GetProductByExternFunc(e,t,s,i){let o=[];o.push(e),o.push(this.GetTableName(parseInt(""==n.a.SessionManager.Preferences.POSItemCodeDimension?"0":n.a.SessionManager.Preferences.POSItemCodeDimension))),o.push(parseInt(""==n.a.SessionManager.Preferences.POSItemCodeDimension?"0":n.a.SessionManager.Preferences.POSItemCodeDimension)),o.push(t);var r=this.Data.Tables[0].filter(e=>14==e.Mode);if(r.length>0&&!a.e.IsEmpty(r[0].IpParams)){var l=r[0].IpParams.toString().split(",");for(let e=0;e<l.length;e++)""!=l[e]&&o.push(this.GetValueBYCOLID(l[e],i))}return o.push(n.a.SessionManager.UserID),o.push(n.a.SessionManager.LanguageID),n.a.document.GetData(JSON.stringify(o),s)}SaveBatch(e,t,s,a,i,o,r,l,u,c){let D=[];return D.push(0),D.push(0),D.push(e),D.push(t.ToString("dd/MMM/yyyy")),D.push(s.ToString("dd/MMM/yyyy")),D.push(i),D.push(o),D.push(r),D.push(parseInt(l)),D.push(a),D.push(0),D.push(0),D.push(u),D.push(""),D.push(c),D.push(""),D.push(""),D.push(0),D.push(n.a.SessionManager.CompanyGUID),D.push(""),D.push(n.a.SessionManager.UserName),D.push(n.a.SessionManager.UserID),D.push(n.a.SessionManager.LanguageID),n.a.inventory.SetQuickBatch(D).RetValue}GetProductwiseBins(e,t,s,i,o,r,l,u,c,D,h,C){let m=[];if(m.push(e),m.push(t),m.push(i.ToString("dd/MMM/yyyy")),m.push(s),n.a.SessionManager.Preferences.ContainsKey("DimensionwiseBins")&&""!=n.a.SessionManager.Preferences.DimensionwiseBins.toString()?(m.push(o),m.push(r)):(m.push(0),m.push(0)),this.Preferences.ContainsKey("BinFilterDim")&&""!=this.Preferences.BinFilterDim.toString()?(m.push(l),m.push(u)):(m.push(0),m.push(0)),m.push(C),m.push(D),m.push(h),c>0){let t="";for(let s=0;s<this.GridData.length;s++)a.e.IsEmpty(this.GridData[s].ProductID_Key)||this.GridData[s].ProductID_Key.toString()!=e.toString()||a.e.IsEmpty(this.GridData[s].LinkedInvDocDetailsID)||"0"==this.GridData[s].LinkedInvDocDetailsID.toString()||(a.e.IsEmpty(t)||(t+=","),t+=this.GridData[s].LinkedInvDocDetailsID.toString());m.push(t)}else m.push("");return m.push(this.CostCenterID),m.push(n.a.SessionManager.UserID),m.push(n.a.SessionManager.RoleID),m.push(n.a.SessionManager.LanguageID),n.a.document.GetProductwiseBins(m)}GetProductsinBin(e){return n.a.common.GetDataSet("DOC030",e)}GetProductwiseBatches(e,t,s,i,o,r){let l=[];if(l.push(e),l.push(t),l.push(this.DocID),l.push(s),l.push(this.DocDate.Date.ToString("dd/MMM/yyyy")),n.a.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&Object(S.j)(n.a.SessionManager.Preferences.EnableDivisionWise)&&n.a.SessionManager.Preferences.ContainsKey("DW Batches")&&Object(S.j)(n.a.SessionManager.Preferences["DW Batches"])?l.push(this.DivisionID>0?this.DivisionID:n.a.SessionManager.DivisionID):l.push(0),n.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&Object(S.j)(n.a.SessionManager.Preferences.EnableLocationWise)&&n.a.SessionManager.Preferences.ContainsKey("LW Batches")&&Object(S.j)(n.a.SessionManager.Preferences["LW Batches"])?l.push(this.LocationID>0?this.LocationID:n.a.SessionManager.LocationID):l.push(0),l.push(this.CostCenterID),n.a.SessionManager.Preferences.ContainsKey("Maintain Dimensionwise Batches")&&""!=n.a.SessionManager.Preferences["Maintain Dimensionwise Batches"].toString()){let e=0,t=!1;if(e=a.e.Int(n.a.SessionManager.Preferences["Maintain Dimensionwise Batches"]),e>0){for(let s=0;s<this._CCFields.length;s++){let n=this._CCFields[s];if(n instanceof c.b&&n.CCID==e){l.push(n.SelectedValue),t=!0;break}}t||null!=i&&e>5e4&&this.GridDataColumns.Contains("dcCCNID"+(e-5e4).toString()+"_Key")&&!a.e.IsEmpty(i["dcCCNID"+(e-5e4).toString()+"_Key"])&&(t=!0,l.push(i["dcCCNID"+(e-5e4).toString()+"_Key"].toString())),r&&l.push(o)}t||l.push(-1)}else l.push(-1);if(this.Preferences.ContainsKey("BatchFilterDim")&&""!=this.Preferences.BatchFilterDim.toString()){let e=a.e.Int(this.Preferences.BatchFilterDim),t=!1;if(e>0){for(let s=0;s<this._CCFields.length;s++){let n=this._CCFields[s];if(n instanceof c.b&&n.CCID==e){l.push(n.SelectedValue>0?n.SelectedValue:1),t=!0;break}}t||null!=i&&e>5e4&&this.GridDataColumns.Contains("dcCCNID"+(e-5e4).toString()+"_Key")&&(t=!0,a.e.IsEmpty(i["dcCCNID"+(e-5e4).toString()+"_Key"])?l.push(1):l.push(i["dcCCNID"+(e-5e4).toString()+"_Key"].toString()))}t||l.push(-1)}else l.push(-1);return l.push(n.a.SessionManager.UserID),l.push(n.a.SessionManager.RoleID),l.push(n.a.SessionManager.LanguageID),n.a.document.GetTempBatches(l)}GetBillwiseNonAccDetails(e,t){return n.a.document.GetBillwiseNonAccDetails(e,t)}GetBillwiseCCDetails(e,t,s){return n.a.document.GetBillwiseCCDetails(e,t,s)}GetChequeReturnCCDetails(e,t,s){return n.a.document.GetChequeReturnCCDetails(e,t,s)}PostBillWiseDetails(e,t,s,i,o,r,l,u){Logger.InfoLog("VoucherGenerator:: Inside PostBillWiseDetails"),u.RetVal=0;let c=[];c.push(e),c.push(t),c.push(this.VoucherNo),c.push(i),c.push(o.ToString("dd/MMM/yyyy")),c.push(this.CostCenterID),c.push(s),c.push(r),c.push(a.e.IsEmpty(l)?"":l),c.push(n.a.SessionManager.CompanyGUID),c.push(n.a.SessionManager.UserName),c.push(n.a.SessionManager.UserID),c.push(n.a.SessionManager.LanguageID);let D=n.a.document.PostBillWiseDetails(c);return u.RetVal=D.RetValue,Logger.InfoLog("VoucherGenerator:: Exiting PostBillWiseDetails"),D.Message}GetBillWiseDetails(e,t,s,i,o,r,l,u=!1){this.IsInventory&&null==r&&this.GridData.length>0&&(r=this.GridData[0]);let D=0;this.Preferences.ContainsKey("UseasCrossDimension")&&"true"==this.Preferences.UseasCrossDimension.toLowerCase()&&n.a.SessionManager.Preferences.ContainsKey("CrossDimension")&&""!=n.a.SessionManager.Preferences.CrossDimension.toString()&&a.e.IsNum(n.a.SessionManager.Preferences.CrossDimension)&&(D=parseInt(n.a.SessionManager.Preferences.CrossDimension));let h=[];if(h.push(e),h.push(t),h.push(s),h.push(i),h.push(o),n.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"True"==n.a.SessionManager.Preferences.EnableLocationWise.toString()&&n.a.SessionManager.Preferences.ContainsKey("LW Bills")&&"True"==n.a.SessionManager.Preferences["LW Bills"].toString())if(50002==D){let e=0;this.Preferences.ContainsKey("CrossDimField")&&a.e.IsNum(this.Preferences.CrossDimField)&&((C=this._TextFields.find(e=>e.DBColumnID==parseInt(this.Preferences.CrossDimField)))&&C instanceof c.b&&C.SelectedValue>0?e=C.SelectedValue:(m=this.ColumnSource.find(e=>e.ID==this.Preferences.CrossDimField))&&this.GridDataColumns.Contains(m.ValueMember)&&!a.e.IsEmpty(r[m.ValueMember])&&(e=parseInt(r[m.ValueMember]))),h.push(e)}else this.Preferences.ContainsKey("Donotuselocation")&&""!=this.Preferences.Donotuselocation&&Object(S.j)(this.Preferences.Donotuselocation)?(C=this._CCFields.find(e=>"dcccnid2"==e.DBColumnName.toLowerCase()))&&C instanceof c.b&&C.SelectedValue>0?h.push(C.SelectedValue):null!=r&&this.GridDataColumns.Contains("dcCCNID2_Key")&&!a.e.IsEmpty(r.dcCCNID2_Key)?h.push(r.dcCCNID2_Key.toString()):h.push(""):this.LocationID>0?h.push(this.LocationID):n.a.SessionManager.LocationID>0&&h.push(n.a.SessionManager.LocationID);else h.push("");if(n.a.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&"True"==n.a.SessionManager.Preferences.EnableDivisionWise.toString()&&n.a.SessionManager.Preferences.ContainsKey("DW Bills")&&"True"==n.a.SessionManager.Preferences["DW Bills"].toString())if(50001==D){let e=0;this.Preferences.ContainsKey("CrossDimField")&&a.e.IsNum(this.Preferences.CrossDimField)&&((C=this._TextFields.find(e=>e.DBColumnID==parseInt(this.Preferences.CrossDimField)))&&C instanceof c.b&&C.SelectedValue>0?e=C.SelectedValue:(m=this.ColumnSource.find(e=>e.ID==this.Preferences.CrossDimField))&&this.GridDataColumns.Contains(m.ValueMember)&&!a.e.IsEmpty(r[m.ValueMember])&&(e=parseInt(r[m.ValueMember]))),h.push(e)}else this.Preferences.ContainsKey("Donotusedivision")&&""!=this.Preferences.Donotusedivision&&Object(S.j)(this.Preferences.Donotusedivision)?(C=this._CCFields.find(e=>"dcccnid1"==e.DBColumnName.toLowerCase()))&&C instanceof c.b&&C.SelectedValue>0?h.push(C.SelectedValue):null!=r&&this.GridDataColumns.Contains("dcCCNID1_Key")&&!a.e.IsEmpty(r.dcCCNID1_Key)?h.push(r.dcCCNID1_Key.toString()):h.push(""):this.DivisionID>0?h.push(this.DivisionID):n.a.SessionManager.DivisionID>0&&h.push(n.a.SessionManager.DivisionID);else h.push("");if(n.a.SessionManager.Preferences.ContainsKey("Maintain Dimensionwise Bills")&&""!=n.a.SessionManager.Preferences["Maintain Dimensionwise Bills"].toString()){let e=0,t=!1;if(e=a.e.Int(n.a.SessionManager.Preferences["Maintain Dimensionwise Bills"]),e>0)if(D==e){let e=0;var C,m;this.Preferences.ContainsKey("CrossDimField")&&a.e.IsNum(this.Preferences.CrossDimField)&&((C=this._TextFields.find(e=>e.DBColumnID==parseInt(this.Preferences.CrossDimField)))&&C instanceof c.b&&C.SelectedValue>0?e=C.SelectedValue:(m=this.ColumnSource.find(e=>e.ID==this.Preferences.CrossDimField))&&this.GridDataColumns.Contains(m.ValueMember)&&!a.e.IsEmpty(r[m.ValueMember])&&(e=parseInt(r[m.ValueMember]))),t=!0,h.push(e)}else{for(let s=0;s<this._CCFields.length;s++){var d=this._CCFields[s];if(d instanceof c.b&&d.CCID==e){h.push(d.SelectedValue),t=!0;break}}t||(null!=r&&e>5e4&&this.GridDataColumns.Contains("dcCCNID"+(e-5e4).toString()+"_Key")&&!a.e.IsEmpty(r["dcCCNID"+(e-5e4).toString()+"_Key"])?h.push(r["dcCCNID"+(e-5e4).toString()+"_Key"].toString()):h.push(""),t=!0)}t||h.push("")}else h.push("");if(h.push(l.ToString("dd/MMM/yyyy")),h.push(this.CostCenterID),h.push(this.IsInventory),this.IsInventory&&0==this.DocID){let e="",t=this.GridData.filter(e=>e.LinkedInvDocDetailsID>0);t.length>0&&t.forEach(t=>{e.Contains(t.RefNo.toString())||(e.length>0&&(e+=","),e+=t.RefNo)}),h.push(e)}else h.push("");return h.push(u),h.push(n.a.SessionManager.UserID),h.push(n.a.SessionManager.LanguageID),n.a.document.GetBillWiseDetails(h)}GetChequeReturnDetails(e,t,s,i,o,r){let l=[];if(l.push(e),l.push(t),l.push(a.e.IsEmpty(s)?"":s),l.push(i),n.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"True"==n.a.SessionManager.Preferences.EnableLocationWise.toString()&&n.a.SessionManager.Preferences.ContainsKey("LW Bills")&&"True"==n.a.SessionManager.Preferences["LW Bills"].toString()?this.LocationID>0?l.push(this.LocationID):n.a.SessionManager.LocationID>0&&l.push(n.a.SessionManager.LocationID):l.push(""),n.a.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&"True"==n.a.SessionManager.Preferences.EnableDivisionWise.toString()&&n.a.SessionManager.Preferences.ContainsKey("DW Bills")&&"True"==n.a.SessionManager.Preferences["DW Bills"].toString()?this.DivisionID>0?l.push(this.DivisionID):n.a.SessionManager.DivisionID>0&&l.push(n.a.SessionManager.DivisionID):l.push(""),n.a.SessionManager.Preferences.ContainsKey("Maintain Dimensionwise Bills")&&""!=n.a.SessionManager.Preferences["Maintain Dimensionwise Bills"].toString()){let e=0,t=!1;if(e=a.e.Int(n.a.SessionManager.Preferences["Maintain Dimensionwise Bills"]),e>0){for(let s=0;s<this._CCFields.length;s++){let n=this._CCFields[s];if(n instanceof c.b&&n.CCID==e){l.push(n.SelectedValue),t=!0;break}}t||(null!=o&&e>5e4&&this.GridDataColumns.Contains("dcCCNID"+(e-5e4).toString()+"_Key")&&!a.e.IsEmpty(o["dcCCNID"+(e-5e4).toString()+"_Key"])?l.push(o["dcCCNID"+(e-5e4).toString()+"_Key"].toString()):l.push(1),t=!0)}t||l.push("")}else l.push("");return l.push(r.ToString("dd/MMM/yyyy")),l.push(this.CostCenterID),l.push(n.a.SessionManager.UserID),l.push(n.a.SessionManager.LanguageID),n.a.document.GetChequeReturnHistory(JSON.stringify(l))}GetLCBills(e,t,s,a,i){let o=[];return o.push(e),o.push(t),o.push(s),o.push(a),o.push(""),o.push(""),o.push(""),o.push(i.ToString("dd/MMM/yyyy")),o.push(this.CostCenterID),o.push(n.a.SessionManager.UserID),o.push(n.a.SessionManager.LanguageID),n.a.document.GetLCBills(o)}GetBillWiseData(e,t,s,i){let o=[];if(o.push(e),o.push(t),o.push(s),o.push(i),n.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"True"==n.a.SessionManager.Preferences.EnableLocationWise.toString()&&n.a.SessionManager.Preferences.ContainsKey("LW Bills")&&"true"==n.a.SessionManager.Preferences["LW Bills"].toLowerCase()?this.LocationID>0?o.push(this.LocationID):n.a.SessionManager.LocationID>0&&o.push(n.a.SessionManager.LocationID):o.push(""),n.a.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&"True"==n.a.SessionManager.Preferences.EnableDivisionWise.toString()&&n.a.SessionManager.Preferences.ContainsKey("DW Bills")&&"True"==n.a.SessionManager.Preferences["DW Bills"].toString()?this.DivisionID>0?o.push(this.DivisionID):n.a.SessionManager.DivisionID>0&&o.push(n.a.SessionManager.DivisionID):o.push(""),n.a.SessionManager.Preferences.ContainsKey("Maintain Dimensionwise Bills")&&""!=n.a.SessionManager.Preferences["Maintain Dimensionwise Bills"].toString()){let e=a.e.Int(n.a.SessionManager.Preferences["Maintain Dimensionwise Bills"]),t=!1;if(e>0)for(let s=0;s<this._CCFields.length;s++){let n=this._CCFields[s];if(n instanceof c.b&&n.CCID==e){o.push(n.SelectedValue),t=!0;break}}t||o.push("")}else o.push("");o.push(n.a.SessionManager.UserID),o.push(n.a.SessionManager.LanguageID),n.a.document.GetBillWiseData(o)}GetDetailsByInvDetID(e){Logger.InfoLog("VoucherGenerator:: Inside GetDetailsByInvDetID");let t=[];t.push(e),t.push(this.CostCenterID),t.push(n.a.SessionManager.LanguageID);let s=n.a.document.GetDetailsByInvDetID(t);return Logger.InfoLog("VoucherGenerator:: Exiting GetDetailsByInvDetID"),s}GetProductTypeDetails(e,t,s,i,o,r,l=!1,u=null,D=!1,h=0,C=null,m=!1){Logger.InfoLog("Product:: Inside GetProductTypeDetails");let d=[];a.e.IsEmpty(u)||(e="0"),d.push(a.e.IsEmpty(e)?"0":e),d.push(a.e.IsEmpty(u)?"":u),d.push(s);let p="<XML>",I="";if(D){if(n.a.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&Object(S.j)(n.a.SessionManager.Preferences.EnableDivisionWise)&&n.a.SessionManager.Preferences.ContainsKey("DW Batches")&&Object(S.j)(n.a.SessionManager.Preferences["DW Batches"])&&this.DivisionID>0&&(p+='<Row CostCenterID="50001" NODEID="'+this.DivisionID+'" />'),n.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&Object(S.j)(n.a.SessionManager.Preferences.EnableLocationWise)&&n.a.SessionManager.Preferences.ContainsKey("LW Batches")&&Object(S.j)(n.a.SessionManager.Preferences["LW Batches"])&&this.LocationID>0&&(p+='<Row CostCenterID="50002" NODEID="'+this.LocationID+'" />'),n.a.SessionManager.Preferences.ContainsKey("Maintain Dimensionwise Batches")&&""!=n.a.SessionManager.Preferences["Maintain Dimensionwise Batches"].toString()){let e=0;e=a.e.Int(n.a.SessionManager.Preferences["Maintain Dimensionwise Batches"]),e>0&&(p+='<Row CostCenterID="'+e+'" NODEID="'+h+'" />')}}else this._CCFields.forEach(e=>{e instanceof c.b&&e.DBColumnName.Contains("TO")&&5==this.DocumentType||e instanceof c.b&&e.SelectedValue>0&&(p+='<Row CostCenterID="'+e.CCID+'" NODEID="'+e.SelectedValue.toString()+'" />')}),this.ColumnSource.forEach(e=>{if(null!=e.CostCenterID&&e.CostCenterID>5e4&&this.GridDataColumns.Contains(e.ValueMember)&&!e.ValueMember.startsWith("TO")){if(!m){var t=this.Data.Tables[0].filter(t=>t.CostCenterColID==e.ID);if(t.length>0&&"3"==a.e.StringValue(t[0].LocalCCID))return}a.e.IsEmpty(r[e.ValueMember])||(p+='<Row CostCenterID="'+e.CostCenterID+'" NODEID="'+r[e.ValueMember].toString()+'" />')}else null==e.CostCenterID||2!=e.CostCenterID||a.e.IsEmpty(r[e.ValueMember])||((1==this.DocumentType||39==this.DocumentType||2==this.DocumentType||6==this.DocumentType||26==this.DocumentType||27==this.DocumentType||3==this.DocumentType||4==this.DocumentType||25==this.DocumentType||13==this.DocumentType)&&e.ValueMember.toLowerCase().startsWith("credit")||(11==this.DocumentType||38==this.DocumentType||10==this.DocumentType||7==this.DocumentType||8==this.DocumentType||9==this.DocumentType||12==this.DocumentType||24==this.DocumentType)&&e.ValueMember.toLowerCase().startsWith("debit")||e.ValueMember.toLowerCase().startsWith("account"))&&(p+='<Row CostCenterID="2" NODEID="'+r[e.ValueMember].toString()+'" />',I=r[e.ValueMember].toString())}),n.a.SessionManager.Preferences.ContainsKey("Use Foreign Currency")&&Object(S.j)(n.a.SessionManager.Preferences["Use Foreign Currency"])&&C&&null!=C.Currency.SelectedValue&&""!=C.Currency.SelectedValue?p+='<Row CostCenterID="12" NODEID="'+parseInt(C.Currency.SelectedValue)+'" />':p+='<Row CostCenterID="12" NODEID="1" />',(1==this.DocumentType||39==this.DocumentType||2==this.DocumentType||6==this.DocumentType||26==this.DocumentType||27==this.DocumentType||3==this.DocumentType||4==this.DocumentType||25==this.DocumentType||13==this.DocumentType)&&null!=this.CreditAccount&&this.CreditAccount.SelectedValue>0?p+='<Row CostCenterID="2" NODEID="'+this.CreditAccount.SelectedValue.toString()+'" />':(11==this.DocumentType||38==this.DocumentType||10==this.DocumentType||7==this.DocumentType||8==this.DocumentType||9==this.DocumentType||12==this.DocumentType||24==this.DocumentType)&&null!=this.DebitAccount&&this.DebitAccount.SelectedValue>0&&(p+='<Row CostCenterID="2" NODEID="'+this.DebitAccount.SelectedValue.toString()+'" />'),this.DocID>0&&(p+='<Row CostCenterID="400" NODEID="'+this.DocID.toString()+'" />');p+="</XML>",d.push(p),d.push(this.CostCenterID),31!=this.DocumentType&&32!=this.DocumentType||null==this.DueDate||!this.DueDate.Date?31!=this.DocumentType&&32!=this.DocumentType||null==r||!this.GridDataColumns.Contains("DueDate_Key")||a.e.IsEmpty(r.DueDate_Key)?d.push(null!=t?t.ToString("dd/MMM/yyyy"):(new Date).ToString("dd/MMM/yyyy")):d.push(new Date(r.DueDate_Key).ToString("dd/MMM/yyyy")):d.push(this.DueDate.Date.ToString("dd/MMM/yyyy")),d.push((1==this.DocumentType||39==this.DocumentType||2==this.DocumentType||6==this.DocumentType||26==this.DocumentType||27==this.DocumentType||3==this.DocumentType||4==this.DocumentType||25==this.DocumentType||13==this.DocumentType)&&null!=this.CreditAccount&&this.CreditAccount.SelectedValue>0?this.CreditAccount.SelectedValue:(11==this.DocumentType||38==this.DocumentType||10==this.DocumentType||7==this.DocumentType||8==this.DocumentType||9==this.DocumentType||12==this.DocumentType||24==this.DocumentType)&&null!=this.DebitAccount&&this.DebitAccount.SelectedValue>0?this.DebitAccount.SelectedValue:""!=I?I:0),d.push(i),d.push(this.AvgrateExists),d.push(""!=o?o:0),d.push(n.a.SessionManager.UserID),d.push(n.a.SessionManager.RoleID),d.push(n.a.SessionManager.LanguageID),d.push(this.RWFieldsExists.Contains("PW_LandingCost")),d.push(this.RWFieldsExists.Contains("PW_LastRate")),d.push(this.RWFieldsExists.Contains("Last Landing Rate")),d.push(this.RWFieldsExists.Contains("LastPurchaseRate")),d.push(this.RWFieldsExists.Contains("QOH")),d.push(this.RWFieldsExists.Contains("BalQty")),d.push(this.RWFieldsExists.Contains("HOLDQTY")),d.push(this.RWFieldsExists.Contains("CommittedQty")),d.push(this.RWFieldsExists.Contains("RESERVEQTY")),d.push(this.RWFieldsExists.Contains("TotalReserve")),d.push(this.RWFieldsExists.Contains("LPRStockNonStock")),d.push(this.RWFieldsExists.Contains("Loc_QOH")),d.push(this.RWFieldsExists.Contains("Div_QOH")),this.GridDataColumns.Contains("IsTestCase")?d.push(!0):d.push(!1),d.push(l),this.Preferences.ContainsKey("DefaultProfileID")&&""!=this.Preferences.DefaultProfileID?d.push(this.Preferences.DefaultProfileID):d.push(0);let g=n.a.document.GetProductTypeDetails(JSON.stringify(d));return Logger.InfoLog("Product:: Success: DBH.GetProductTypeDetails "+e.toString()),g}GetProductPrices(e,t){Logger.InfoLog("Product:: Inside GetProductPrices");let s=[];s.push(a.e.IsEmpty(e)?"0":e);let i="<XML>";for(let n=0;n<this._CCFields.length;n++){const e=this._CCFields[n];e instanceof c.b&&e.DBColumnName.Contains("TO")&&5==this.DocumentType||e instanceof c.b&&e.SelectedValue>0&&(i+='<Row CostCenterID="'+e.CCID+'" NODEID="'+e.SelectedValue.toString()+'" />')}return(1==this.DocumentType||39==this.DocumentType||2==this.DocumentType||6==this.DocumentType||26==this.DocumentType||27==this.DocumentType||3==this.DocumentType||4==this.DocumentType||25==this.DocumentType||13==this.DocumentType)&&null!=this.CreditAccount&&this.CreditAccount.SelectedValue>0?i+='<Row CostCenterID="2" NODEID="'+this.CreditAccount.SelectedValue.toString()+'" />':(11==this.DocumentType||38==this.DocumentType||10==this.DocumentType||7==this.DocumentType||8==this.DocumentType||9==this.DocumentType||12==this.DocumentType||24==this.DocumentType)&&null!=this.DebitAccount&&this.DebitAccount.SelectedValue>0&&(i+='<Row CostCenterID="2" NODEID="'+this.DebitAccount.SelectedValue.toString()+'" />'),this.DocID>0&&(i+='<Row CostCenterID="400" NODEID="'+this.DocID.toString()+'" />'),i+="</XML>",s.push(i),s.push(null!=t?t.ToString("dd/MMM/yyyy"):(new Date).ToString("dd/MMM/yyyy")),s.push(this.CostCenterID),s.push(this.DocumentType),s.push(n.a.SessionManager.RoleID),s.push(n.a.SessionManager.UserID),s.push(n.a.SessionManager.LanguageID),n.a.common.GetProductPrices(s)}GetPriceTax(e,t,s,i,o,r,l,u=null){var D=l.split(",");let h=[];h.push(a.e.IsEmpty(e)?"0":e);let C="<XML>",m="";return this._CCFields.forEach(e=>{e instanceof c.b&&e.DBColumnName.Contains("TO")&&5==this.DocumentType||e instanceof c.b&&e.SelectedValue>0&&(C+='<Row CostCenterID="'+e.CCID+'" NODEID="'+e.SelectedValue.toString()+'" />')}),this.ColumnSource.forEach(e=>{e.CostCenterID>5e4&&this.GridDataColumns.Contains(e.ValueMember)&&!e.ValueMember.startsWith("TO")?a.e.IsEmpty(r[e.ValueMember])?a.e.IsEmpty(r[e.DisplayMember])||(C+='<Row CostCenterID="'+e.CostCenterID+'" NODEID="'+r[e.DisplayMember].toString()+'" />'):C+='<Row CostCenterID="'+e.CostCenterID+'" NODEID="'+r[e.ValueMember].toString()+'" />':2!=e.CostCenterID||a.e.IsEmpty(r[e.ValueMember])||(1==this.DocumentType||2==this.DocumentType||10==this.DocumentType||26==this.DocumentType||27==this.DocumentType||3==this.DocumentType||4==this.DocumentType||25==this.DocumentType||13==this.DocumentType?C+='<Row CostCenterID="2" NODEID="'+r[e.ValueMember].toString()+'" />':11!=this.DocumentType&&38!=this.DocumentType&&39!=this.DocumentType&&6!=this.DocumentType&&7!=this.DocumentType&&8!=this.DocumentType&&9!=this.DocumentType&&12!=this.DocumentType&&24!=this.DocumentType||(C+='<Row CostCenterID="2" NODEID="'+r[e.ValueMember].toString()+'" />'),m=r[e.ValueMember].toString())}),n.a.SessionManager.Preferences.ContainsKey("Use Foreign Currency")&&Object(S.j)(n.a.SessionManager.Preferences["Use Foreign Currency"])&&null!=u&&null!=u.Currency.SelectedValue&&""!=u.Currency.SelectedValue?C+='<Row CostCenterID="12" NODEID="'+parseInt(u.Currency.SelectedValue)+'" />':C+='<Row CostCenterID="12" NODEID="1" />',(1==this.DocumentType||39==this.DocumentType||2==this.DocumentType||6==this.DocumentType||26==this.DocumentType||27==this.DocumentType||3==this.DocumentType||4==this.DocumentType||25==this.DocumentType||13==this.DocumentType)&&null!=this.CreditAccount&&this.CreditAccount.SelectedValue>0?C+='<Row CostCenterID="2" NODEID="'+this.CreditAccount.SelectedValue.toString()+'" />':(11==this.DocumentType||38==this.DocumentType||10==this.DocumentType||7==this.DocumentType||8==this.DocumentType||9==this.DocumentType||12==this.DocumentType||24==this.DocumentType)&&null!=this.DebitAccount&&this.DebitAccount.SelectedValue>0&&(C+='<Row CostCenterID="2" NODEID="'+this.DebitAccount.SelectedValue.toString()+'" />'),this.DocID>0&&(C+='<Row CostCenterID="400" NODEID="'+this.DocID.toString()+'" />'),C+="</XML>",h.push(C),31!=this.DocumentType&&32!=this.DocumentType||null==this.DueDate||!this.DueDate.Date?31!=this.DocumentType&&32!=this.DocumentType||null==r||!this.GridDataColumns.Contains("DueDate_Key")||a.e.IsEmpty(r.DueDate_Key)?h.push(null!=t?t.ToString("dd/MMM/yyyy"):(new Date).ToString("dd/MMM/yyyy")):h.push(new Date(r.DueDate_Key).ToString("dd/MMM/yyyy")):h.push(this.DueDate.Date.ToString("dd/MMM/yyyy")),h.push(""!=o?o:0),this.Preferences.ContainsKey("DefaultProfileID")&&""!=this.Preferences.DefaultProfileID?h.push(this.Preferences.DefaultProfileID):h.push(0),h.push(s),h.push(this.CostCenterID),h.push(i),h.push(D.Contains("a")&&this.AvgrateExists),h.push(D.Contains("s")&&this.RWFieldsExists.Contains("QOH")),h.push(D.Contains("s")&&this.RWFieldsExists.Contains("BalQty")),h.push(D.Contains("s")&&this.RWFieldsExists.Contains("HOLDQTY")),h.push(D.Contains("s")&&this.RWFieldsExists.Contains("CommittedQty")),h.push(D.Contains("s")&&this.RWFieldsExists.Contains("RESERVEQTY")),h.push(D.Contains("s")&&this.RWFieldsExists.Contains("TotalReserve")),h.push(this.DocumentType),n.a.SessionManager.Preferences.ContainsKey("ConsiderUnAppInHold")&&!a.e.IsEmpty(n.a.SessionManager.Preferences.ConsiderUnAppInHold)&&Object(S.j)(n.a.SessionManager.Preferences.ConsiderUnAppInHold)?h.push(!0):h.push(!1),D.Contains("p")&&D.Contains("t")?h.push(3):D.Contains("p")?h.push(1):D.Contains("t")?h.push(2):h.push(0),h.push(n.a.SessionManager.RoleID),h.push(n.a.SessionManager.UserID),h.push(n.a.SessionManager.LanguageID),n.a.document.GetPriceTax(JSON.stringify(h))}GetPriceofUnit(e,t,s,i){let o=[];o.push(a.e.IsEmpty(e)?"0":e),o.push(s);let r="<XML>",l="";return this._CCFields.forEach(e=>{e instanceof c.b&&e.DBColumnName.Contains("TO")&&5==this.DocumentType||e instanceof c.b&&e.SelectedValue>0&&(r+='<Row CostCenterID="'+e.CCID+'" NODEID="'+e.SelectedValue.toString()+'" />')}),this.ColumnSource.forEach(e=>{e.CostCenterID>5e4&&this.GridDataColumns.Contains(e.ValueMember)?a.e.IsEmpty(i[e.ValueMember])?a.e.IsEmpty(i[e.DisplayMember])||(r+='<Row CostCenterID="'+e.CostCenterID+'" NODEID="'+i[e.DisplayMember].toString()+'" />'):r+='<Row CostCenterID="'+e.CostCenterID+'" NODEID="'+i[e.ValueMember].toString()+'" />':2!=e.CostCenterID||a.e.IsEmpty(i[e.ValueMember])||(1==this.DocumentType||2==this.DocumentType||10==this.DocumentType||26==this.DocumentType||27==this.DocumentType||3==this.DocumentType||4==this.DocumentType||25==this.DocumentType||13==this.DocumentType?r+='<Row CostCenterID="2" NODEID="'+i[e.ValueMember].toString()+'" />':11!=this.DocumentType&&38!=this.DocumentType&&39!=this.DocumentType&&6!=this.DocumentType&&7!=this.DocumentType&&8!=this.DocumentType&&9!=this.DocumentType&&12!=this.DocumentType&&24!=this.DocumentType||(r+='<Row CostCenterID="2" NODEID="'+i[e.ValueMember].toString()+'" />'),l=i[e.ValueMember].toString())}),(1==this.DocumentType||39==this.DocumentType||2==this.DocumentType||6==this.DocumentType||26==this.DocumentType||27==this.DocumentType||3==this.DocumentType||4==this.DocumentType||25==this.DocumentType||13==this.DocumentType)&&null!=this.CreditAccount&&this.CreditAccount.SelectedValue>0?r+='<Row CostCenterID="2" NODEID="'+this.CreditAccount.SelectedValue.toString()+'" />':(11==this.DocumentType||38==this.DocumentType||10==this.DocumentType||7==this.DocumentType||8==this.DocumentType||9==this.DocumentType||12==this.DocumentType||24==this.DocumentType)&&null!=this.DebitAccount&&this.DebitAccount.SelectedValue>0&&(r+='<Row CostCenterID="2" NODEID="'+this.DebitAccount.SelectedValue.toString()+'" />'),r+="</XML>",o.push(r),o.push(this.CostCenterID),31!=this.DocumentType&&32!=this.DocumentType||null==this.DueDate||!this.DueDate.Date?31!=this.DocumentType&&32!=this.DocumentType||null==i||!this.GridDataColumns.Contains("DueDate_Key")||a.e.IsEmpty(i.DueDate_Key)?o.push(null!=t?t.ToString("dd/MMM/yyyy"):(new Date).ToString("dd/MMM/yyyy")):o.push(new Date(i.DueDate_Key).ToString("dd/MMM/yyyy")):o.push(this.DueDate.Date.ToString("dd/MMM/yyyy")),o.push((1==this.DocumentType||39==this.DocumentType||2==this.DocumentType||6==this.DocumentType||26==this.DocumentType||27==this.DocumentType||3==this.DocumentType||4==this.DocumentType||25==this.DocumentType||13==this.DocumentType)&&null!=this.CreditAccount&&this.CreditAccount.SelectedValue>0?this.CreditAccount.SelectedValue:(11==this.DocumentType||38==this.DocumentType||10==this.DocumentType||7==this.DocumentType||8==this.DocumentType||9==this.DocumentType||12==this.DocumentType||24==this.DocumentType)&&null!=this.DebitAccount&&this.DebitAccount.SelectedValue>0?this.DebitAccount.SelectedValue:""!=l?l:0),o.push(n.a.SessionManager.UserID),o.push(n.a.SessionManager.LanguageID),n.a.document.GetPriceofUnit(JSON.stringify(o))}GetCrossDimLinkDetails(e,t,s,a,i){let o=[];return o.push(e),o.push(t),o.push(s),o.push(a),o.push(i),o.push(n.a.SessionManager.UserID),o.push(n.a.SessionManager.LanguageID),n.a.document.GetCrossDimLinkDetails(JSON.stringify(o))}GetProductQtyOnHand(e,t){let s=[];s.push(e);let i=0,o=!1,r="";var l;return i=a.e.Int(n.a.SessionManager.Preferences["Maintain Dimensionwise stock"]),i>5e4&&(l=this._CCFields.find(e=>e.DBColumnName.toLowerCase()=="dcccnid"+(i-5e4)))&&l.SelectedValue>0&&(r+=" and dcccnid"+(i-5e4)+"="+l.SelectedValue.toString()),n.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&Object(S.j)(n.a.SessionManager.Preferences.EnableLocationWise)&&Object(S.j)(n.a.SessionManager.Preferences.EnableLocationWise)&&n.a.SessionManager.Preferences.ContainsKey("Location Stock")&&Object(S.j)(n.a.SessionManager.Preferences["Location Stock"])&&Object(S.j)(n.a.SessionManager.Preferences["Location Stock"])&&((l=this._CCFields.find(e=>"dcccnid2"==e.DBColumnName.toLowerCase()))&&l.SelectedValue>0?r+=" and dcccnid2="+l.SelectedValue.toString():this.LocationID>0?r+=" and dcccnid1="+this.LocationID.toString():n.a.SessionManager.LocationID>0&&(r+=" and dcccnid1="+n.a.SessionManager.LocationID.toString())),o=!1,n.a.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&Object(S.j)(n.a.SessionManager.Preferences.EnableDivisionWise)&&Object(S.j)(n.a.SessionManager.Preferences.EnableDivisionWise)&&n.a.SessionManager.Preferences.ContainsKey("Division Stock")&&Object(S.j)(n.a.SessionManager.Preferences["Division Stock"])&&Object(S.j)(n.a.SessionManager.Preferences["Division Stock"])&&((l=this._CCFields.find(e=>"dcccnid1"==e.DBColumnName.toLowerCase()))&&l.SelectedValue>0?r+=" and dcccnid1="+l.SelectedValue.toString():this.DivisionID>0?r+=" and dcccnid1="+this.DivisionID.toString():n.a.SessionManager.DivisionID>0&&(r+=" and dcccnid1="+n.a.SessionManager.DivisionID.toString())),s.push(null!=t?t.ToString("dd/MMM/yyyy"):(new Date).ToString("dd/MMM/yyyy")),s.push(r),s.push(n.a.SessionManager.UserID),s.push(n.a.SessionManager.LanguageID),n.a.document.GetProductQtyOnHand(s)}GetAssignedUsers(){let e=[];e.push(n.a.SessionManager.UserID),e.push(n.a.SessionManager.LanguageID);let t=n.a.document.GetAssignedUsers(e);return null!=t&&t.Tables.length>0&&t.Tables[0].length>0&&t.Columns[0].Contains("AssignedUsers")?t.Tables[0][0].AssignedUsers.toString():""}GetAssetDetByProduct(e){let t=[];return t.push(e),t.push(this.CostCenterID),t.push(n.a.SessionManager.UserID),t.push(n.a.SessionManager.LanguageID),n.a.document.GetAssetDetByProduct(t)}GetProductDetails(e,t,s,i,o,r){Logger.InfoLog("Product:: Inside GetProductTypeDetails");let l=[];l.push(e),l.push(s);let u="<XML>";this._CCFields.forEach(e=>{e instanceof c.b&&e.DBColumnName.Contains("TO")&&5==this.DocumentType||e instanceof c.b&&e.SelectedValue>0&&(u+='<Row CostCenterID="'+e.CCID+'" NODEID="'+e.SelectedValue.toString()+'" />')}),null!=r&&this.ColumnSource.forEach(e=>{e.CostCenterID>5e4&&null!=e.ValueMember&&this.GridDataColumns.Contains(e.ValueMember)&&!a.e.IsEmpty(r[e.ValueMember])&&(u+='<Row CostCenterID="'+e.CostCenterID+'" NODEID="'+r[e.ValueMember].toString()+'" />')}),(1==this.DocumentType||2==this.DocumentType||10==this.DocumentType||26==this.DocumentType||27==this.DocumentType||3==this.DocumentType||4==this.DocumentType||25==this.DocumentType||13==this.DocumentType)&&null!=this.CreditAccount&&this.CreditAccount.SelectedValue>0?u+='<Row CostCenterID="2" NODEID="'+this.CreditAccount.SelectedValue.toString()+'" />':(11==this.DocumentType||38==this.DocumentType||39==this.DocumentType||6==this.DocumentType||7==this.DocumentType||8==this.DocumentType||9==this.DocumentType||12==this.DocumentType||24==this.DocumentType)&&null!=this.DebitAccount&&this.DebitAccount.SelectedValue>0&&(u+='<Row CostCenterID="2" NODEID="'+this.DebitAccount.SelectedValue.toString()+'" />'),u+="</XML>",l.push(u),l.push(this.CostCenterID),l.push(null!=t?t.ToString("dd/MMM/yyyy"):(new Date).ToString("dd/MMM/yyyy")),l.push((1==this.DocumentType||2==this.DocumentType||10==this.DocumentType||26==this.DocumentType||27==this.DocumentType||3==this.DocumentType||4==this.DocumentType||25==this.DocumentType||13==this.DocumentType)&&null!=this.CreditAccount&&this.CreditAccount.SelectedValue>0?this.CreditAccount.SelectedValue:(11==this.DocumentType||38==this.DocumentType||39==this.DocumentType||6==this.DocumentType||7==this.DocumentType||8==this.DocumentType||9==this.DocumentType||12==this.DocumentType||24==this.DocumentType)&&null!=this.DebitAccount&&this.DebitAccount.SelectedValue>0?this.DebitAccount.SelectedValue:0),l.push(i),l.push(this.AvgrateExists),l.push(""!=o?o:0),l.push(this.LocationID>0?this.LocationID:n.a.SessionManager.LocationID>0?n.a.SessionManager.LocationID:0),l.push(n.a.SessionManager.UserID),l.push(n.a.SessionManager.LanguageID);let D=n.a.document.GetReferenceData(JSON.stringify(l));return Logger.InfoLog("Product:: Success: DBH.GetProductTypeDetails "+e.toString()),D}GetReconcileAvgRate(e,t,s=!1){let a=[];return a.push(e),a.push(null!=t?t.ToString("dd/MMM/yyyy"):(new Date).ToString("dd/MMM/yyyy")),a.push(this.DocID),a.push(s),a.push(n.a.SessionManager.UserID),a.push(n.a.SessionManager.LanguageID),n.a.document.GetReconcileAvgRate(a)}GetChequeDetails(){return 0==this.PostVoucherDocID?null:n.a.common.GetDataSet("DOC031",this.PostVoucherDocID.toString())}CheckViewForUser(e){var t;if(null!=this.Data&&this.Data.Tables.length>10&&this.Data.Tables[10].length>0){let s;for(let t=0;t<this.HeaderFields.length;t++){let s=this.HeaderFields[t];(38==this.DocumentType||39==this.DocumentType)&&s instanceof l.a&&"docdate"==s.DBColumnName.toLowerCase()||(!(s instanceof h.b)||n.a.SessionManager.Preferences.ContainsKey("Use Foreign Currency")&&Object(S.j)(n.a.SessionManager.Preferences["Use Foreign Currency"]))&&(this.SetView(s,e),s instanceof h.b&&this.SetView(s.ExchangeRate,e))}if(this.CustomTab.Pages.forEach(t=>{if(3!=t.TabType)if(t.Fields.forEach(t=>{this.SetView(t,e)}),s=null,s=this.Data.Tables[10].filter(this.DocID>0?null!=this.Link&&"[Open]"!=this.Link.LinkStatus?369==e?e=>e.CostCenterColID>-100&&e.CostCenterColID<-50&&e.description==t.Header&&(2==e.Mode||3==e.Mode||4==e.Mode||5==e.Mode):e=>e.CostCenterColID>-100&&e.CostCenterColID<-50&&e.description==t.Header&&(2==e.Mode||3==e.Mode||5==e.Mode):369==e?e=>e.CostCenterColID>-100&&e.CostCenterColID<-50&&e.description==t.Header&&(2==e.Mode||3==e.Mode||4==e.Mode):e=>e.CostCenterColID>-100&&e.CostCenterColID<-50&&e.description==t.Header&&(2==e.Mode||3==e.Mode):e=>e.CostCenterColID>-100&&e.CostCenterColID<-50&&e.description==t.Header&&(1==e.Mode||3==e.Mode)),null!=s&&s.length>0)t.Visible=Object(S.j)(s[0].IsVisible),t.Enable=Object(S.j)(s[0].IsEditable);else{var n=t.Fields.find(e=>e instanceof p.c&&e.Visible);t.Visible=!!n,t.Enable=!0}}),this.ColumnSource.forEach(t=>{4!=t.SectionID&&"LinkedFieldName"!=t.DisplayMember&&"StatusID"!=t.DisplayMember&&"LinkedInvDocDetailsID"!=t.DisplayMember&&"DocDetailsID"!=t.DisplayMember&&"DocSeqNo"!=t.DisplayMember&&this.SetView(t,e)}),this.FooterColumnSource.forEach(t=>{"Remarks"!=t.DisplayMember&&"dcCurrID"!=t.DisplayMember&&"dcExchRT"!=t.DisplayMember||this.SetView(t,e)}),this.IsInventory){null!=this.Link&&(s=null,s=this.Data.Tables[10].filter(this.DocID>0?"[Open]"!=this.Link.LinkStatus?369==e?e=>-3==e.CostCenterColID&&(2==e.Mode||3==e.Mode||4==e.Mode||5==e.Mode):e=>-3==e.CostCenterColID&&(2==e.Mode||3==e.Mode||5==e.Mode):369==e?e=>-3==e.CostCenterColID&&(2==e.Mode||3==e.Mode||4==e.Mode):e=>-3==e.CostCenterColID&&(2==e.Mode||3==e.Mode):e=>-3==e.CostCenterColID&&(1==e.Mode||3==e.Mode)),null!=s&&s.length>0?(this.Preferences.ContainsKey("LinkPopup")&&"True"==this.Preferences.LinkPopup||(this.Link.Visible=Object(S.j)(s[0].IsVisible)),this.Link.LinkCombo.Enable=Object(S.j)(s[0].IsEditable),this.Link.DocumentList.Enable=Object(S.j)(s[0].IsEditable)):(this.Preferences.ContainsKey("LinkPopup")&&"True"==this.Preferences.LinkPopup||(this.Link.Visible=!0),this.Link.LinkCombo.Enable=!0,this.Link.DocumentList.Enable=!0));for(let t=0;t<this.FooterGridData.length;t++)this.FooterGridDataColumns.Contains("ColumnName")&&!a.e.IsEmpty(this.FooterGridData[t].ColumnName)&&this.SetView(this.FooterGridData[t],e,!0,this.FooterGridDataColumns);if(null!=this.FooterDataBind&&this.FooterDataBind.length>1){for(let t=0;t<this.FooterDataBind.length;t++)this.SetView(this.FooterDataBind[t],e,!0,this.FooterDataBindColumns);this.FooterColumnSource.length>1&&!this.FooterColumnSource[1].ReadOnly&&(null===(t=this.FooterColumnSource[1].ComboDataTable)||void 0===t?void 0:t.length)>0&&this.FooterColumnSource[1].SetComboData(this.FooterColumnSource[1].ComboDataTable.filter(e=>e.IsVisible=!0))}}}}SetView(e,t,s=!1,i=null){let o=[],r=this.Data.Tables[0];if(this.Data.Tables[10].length>0){let n,i,r;this.DocID>0?(n=[2,3],null!=this.Link&&"[Open]"!=this.Link.LinkStatus||null==this.Link&&"[Open]"!=this.linkstat?n=369==t?[2,3,4,5]:[2,3,5]:369==t&&(n=[2,3,4])):n=[1,3],e instanceof p.c?i=e.DBColumnName:e instanceof d.a?"combobox"==e.DataType.toLowerCase()?i=e.ValueBinding:3==e.CostCenterID||2==e.CostCenterID||!a.e.IsEmpty(e.ID)&&parseInt(e.ID)<0?r=e.ID:i=e.DisplayMember:s&&(i=" and SysColumnName='"+e.ColumnName.toString()+"'"),i?o=this.Data.Tables[10].filter(e=>e.SysColumnName==i&&n.Contains(e.Mode)):r&&(o=this.Data.Tables[10].filter(e=>e.CostCenterColID==r&&n.Contains(e.Mode)))}if(o.length>0)e instanceof p.c?e.Visible=Object(S.j)(o[0].IsVisible):e instanceof d.a?e.IsVisible=Object(S.j)(o[0].IsVisible):s&&(e.IsVisible=Object(S.j)(o[0].IsVisible),i.Contains("StyleHeightZero")&&(e.StyleHeightZero=Object(S.j)(o[0].IsVisible)?0:1)),a.e.IsEmpty(o[0].IsMandatory)||(e instanceof p.c?(e.Mandatory=Object(S.j)(o[0].IsMandatory),e instanceof D.a&&(e.Name.Mandatory=e.Mandatory)):e instanceof d.a&&(e.Mandatory=Object(S.j)(o[0].IsMandatory))),e instanceof p.c?(e.IsReadOnly=!Object(S.j)(o[0].IsEditable),e instanceof D.a&&(e.Code.IsReadOnly=e.Name.IsReadOnly=e.IsReadOnly)):(e instanceof d.a||s)&&(e.ReadOnly=!Object(S.j)(o[0].IsEditable)),(e instanceof p.c||e instanceof d.a||s)&&(e.Expression=o[0].Expression.toString()),(e instanceof p.c||e instanceof d.a||s)&&(e.Message=o[0].FailureMessage.toString()),a.e.IsEmpty(o[0].ActionOptionID)?(e instanceof p.c||e instanceof d.a||s)&&(e.Action=0):(e instanceof p.c||e instanceof d.a||s)&&(e.Action=parseInt(o[0].ActionOptionID)),a.e.IsEmpty(o[0].NumFieldEditOptionID)?e instanceof d.a&&(e.EditOption=0):e instanceof d.a&&(e.EditOption=parseInt(o[0].NumFieldEditOptionID));else{let t,o;e instanceof p.c?t=e.DBColumnName:e instanceof d.a?"combobox"==e.DataType.toLowerCase()?t=e.ValueBinding:3==e.CostCenterID||2==e.CostCenterID||!a.e.IsEmpty(e.ID)&&parseInt(e.ID)<0?o=e.ID:t=e.DisplayMember:s&&(t=" and SysColumnName='"+e.ColumnName.toString()+"'"),t?r=this.Data.Tables[0].filter(e=>e.SysColumnName==t):o&&(r=this.Data.Tables[0].filter(e=>e.CostCenterColID==o)),r.length>0&&(e instanceof p.c?(e.IsReadOnly=!Object(S.j)(r[0].IsEditable),e instanceof D.a&&(e.Code.IsReadOnly=e.Name.IsReadOnly=e.IsReadOnly)):e instanceof d.a?e.ReadOnly=n.a.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&"True"==n.a.SessionManager.Preferences.EnableDivisionWise.toString()&&50001==e.CostCenterID?!this.Preferences.ContainsKey("Donotusedivision")||""==this.Preferences.Donotusedivision||!Object(S.j)(this.Preferences.Donotusedivision):!n.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")||"True"!=n.a.SessionManager.Preferences.EnableLocationWise.toString()||this.Preferences.ContainsKey("Donotuselocation")&&""!=this.Preferences.Donotuselocation&&Object(S.j)(this.Preferences.Donotuselocation)||50002!=e.CostCenterID?!Object(S.j)(r[0].IsEditable):!this.Preferences.ContainsKey("EnableLocation")||""==this.Preferences.EnableLocation||!Object(S.j)(this.Preferences.EnableLocation):s&&(e.ReadOnly=!Object(S.j)(r[0].IsEditable)),a.e.IsEmpty(r[0].IsMandatory)||(e instanceof p.c?(e.Mandatory=Object(S.j)(r[0].IsMandatory),e instanceof D.a&&(e.Name.Mandatory=e.Mandatory)):e instanceof d.a&&(e.Mandatory=Object(S.j)(r[0].IsMandatory))),e instanceof p.c&&!a.e.IsEmpty(r[0].IsVisible)?e.Visible=Object(S.j)(r[0].IsVisible):e instanceof d.a?e.IsVisible=Object(S.j)(r[0].IsVisible):s&&(e.IsVisible=Object(S.j)(r[0].IsVisible),i.Contains("StyleHeightZero")&&(e.StyleHeightZero=Object(S.j)(r[0].IsVisible)?0:1))),e instanceof d.a&&(e.EditOption=0),(e instanceof p.c||e instanceof d.a||s)&&(e.Expression=""),(e instanceof p.c||e instanceof d.a||s)&&(e.Message=""),e instanceof p.c||e instanceof d.a?e.Action=0:s&&(e.Action="")}e instanceof c.b&&(38==this.DocumentType||39==this.DocumentType)?e.SearchVisible=!!(e.GridViewID>0&&e.Enable):e instanceof D.a&&(38==this.DocumentType||39==this.DocumentType)&&(e.Name.SearchVisible=!!(e.Name.GridViewID>0&&e.Enable))}CheckNegativeStock(e,t,s,a,i){let o=[];return o.push(e),o.push(i),o.push(this.DocID),o.push(t),o.push(s),o.push(a),o.push(n.a.SessionManager.UserID),o.push(n.a.SessionManager.LanguageID),n.a.document.CheckNegativeStock(o)}CheckReorderLevel(e,t){let s=[];return s.push(e),s.push(this.DocDate.Date),s.push(this.DocID),s.push(t),s.push(n.a.SessionManager.UserID),s.push(n.a.SessionManager.LanguageID),n.a.document.CheckReorderLevel(s)}GetLCTRLimits(){if(this.Preferences.ContainsKey("UseAsLC")&&""!=this.Preferences.UseAsLC&&Object(S.j)(this.Preferences.UseAsLC)||this.Preferences.ContainsKey("UseAsTR")&&""!=this.Preferences.UseAsTR&&Object(S.j)(this.Preferences.UseAsTR)){let e=0;if(this.Preferences.ContainsKey("UseAsLC")&&""!=this.Preferences.UseAsLC&&Object(S.j)(this.Preferences.UseAsLC)&&null!=this.CreditAccount&&this.CreditAccount.SelectedValue>1&&(e=this.CreditAccount.SelectedValue),this.Preferences.ContainsKey("UseAsTR")&&""!=this.Preferences.UseAsTR&&Object(S.j)(this.Preferences.UseAsTR)&&null!=this.DebitAccount&&this.DebitAccount.SelectedValue>1&&(e=this.DebitAccount.SelectedValue),e>0){let t=[];t.push(e),t.push(null!=this.ovDate?this.ovDate.Date.ToString("dd/MMM/yyyy"):(new Date).ToString("dd/MMM/yyyy")),t.push(0),t.push(n.a.SessionManager.UserID),t.push(n.a.SessionManager.LanguageID);let s=n.a.document.GetLCTRAnalysis(t);this.FillLCTRLimits(s)}}}GetLCUsedAmt(e){let t=[];return t.push(""),t.push((new Date).ToString("dd/MMM/yyyy")),t.push(e),t.push(n.a.SessionManager.UserID),t.push(n.a.SessionManager.LanguageID),n.a.document.GetLCTRAnalysis(t)}FillLCTRLimits(e){if(null!=e&&e.Tables.length>0&&e.Tables[0].length>0){let s=0,n=0;var t=this._TextFields.find(e=>"dcalpha1"==e.DBColumnName.toLowerCase());t instanceof r.d&&(this.Preferences.ContainsKey("UseAsLC")&&""!=this.Preferences.UseAsLC&&Object(S.j)(this.Preferences.UseAsLC)&&e.Columns[0].Contains("LetterofCredit")&&(t.Text=e.Tables[0][0].LetterofCredit.toString()),this.Preferences.ContainsKey("UseAsTR")&&""!=this.Preferences.UseAsTR&&Object(S.j)(this.Preferences.UseAsTR)&&e.Columns[0].Contains("TrustReceipt")&&(t.Text=e.Tables[0][0].TrustReceipt.toString()),""!=t.Text&&(s=parseFloat(t.Text)),t instanceof r.d&&(t=this._TextFields.find(e=>"dcalpha2"==e.DBColumnName.toLowerCase()))instanceof r.d&&(this.Preferences.ContainsKey("UseAsLC")&&""!=this.Preferences.UseAsLC&&Object(S.j)(this.Preferences.UseAsLC)&&e.Columns[0].Contains("LCAmount")&&(t.Text=e.Tables[0][0].LCAmount.toString()),this.Preferences.ContainsKey("UseAsTR")&&""!=this.Preferences.UseAsTR&&Object(S.j)(this.Preferences.UseAsTR)&&e.Columns[0].Contains("TRAmount")&&(t.Text=e.Tables[0][0].TRAmount.toString()),""!=t.Text&&(n=parseFloat(t.Text))),(t=this._TextFields.find(e=>"dcalpha3"==e.DBColumnName.toLowerCase()))instanceof r.d&&(t.Text=(s-n).toString()))}}GetAccountByRef(e,t,s,i="",o=!1){e<0&&-98!=e&&-99!=e&&(e=-e);let r=0,l=[];l.push(e),l.push(t),l.push(s),l.push(i),l.push(o),l.push(n.a.SessionManager.UserID),l.push(n.a.SessionManager.LanguageID);let u=n.a.document.GetAccountByRef(l);return null!=u&&u.Tables.length>0&&u.Tables[0].length>0&&a.e.IsNum(u.Tables[0][0][u.Columns[0][0]])&&(r=parseInt(u.Tables[0][0][u.Columns[0][0]])),r}static POSLogin(e,t,s,i,o,r,l,u){let c=[];c.push(e),c.push(t),c.push(s),c.push(i),c.push(o),c.push(r),c.push(l),c.push(n.a.SessionManager.IPAddress),c.push(n.a.SessionManager.CompanyGUID),c.push(n.a.SessionManager.UserName),c.push(n.a.SessionManager.RoleID),c.push(n.a.SessionManager.UserID),c.push(n.a.SessionManager.LanguageID);let D=n.a.document.POSLogin(c);return null!=D&&D.Tables.length>0&&D.Tables[0].length>0&&a.e.IsNum(D.Tables[0][0][D.Columns[0][0]])&&(u.RetVal=parseInt(D.Tables[0][0][D.Columns[0][0]])),D}FillPendingList(e){if(this.Link&&null!=this.Link.LinkCombo&&!a.e.IsEmpty(this.Link.LinkCombo.SelectedValue)&&this.Link.VouchersList){this.Link.DocumentList.Items.Clear();let e=[];for(let t=0;t<this.Link.VouchersList.length;t++)this.Link.VouchersList.length<5e3&&e.Contains(this.Link.VouchersList[t].voucherno.toString())||(e.push(this.Link.VouchersList[t].voucherno.toString()),null!=this.Link.LinkCombo.SelectedItem&&"true"==this.Link.LinkCombo.SelectedItem.Aliasname.toLowerCase()&&this.ReferenceCallBack.IsSubscribed||this.GridData.filter(e=>e.RefNo==this.Link.VouchersList[t].voucherno.toString()).length>0?this.Link.DocumentList.Items.push(u.c.CheckedListBoxItem_5(this.Link.VouchersList[t].voucherno.toString(),this.Link.VouchersList[t].DocID.toString(),!0)):this.Link.DocumentList.Items.push(u.c.CheckedListBoxItem_3(this.Link.VouchersList[t].voucherno.toString(),this.Link.VouchersList[t].DocID.toString())));if(e=null,this.Data.Tables[0].length>0){let e=this.Data.Tables[0].filter(e=>null!=e.LocalReference&&79==e.LocalReference&&55497==e.LinkData);if(e.length>0){var t=this._TextFields.find(t=>t.DBColumnName==e[0].SysColumnName.toString());t&&t instanceof r.d&&(t.Text=this.Link.VouchersList.length.toString())}}0==this.DocID&&null!=this.Link.LinkCombo.SelectedItem&&"true"==this.Link.LinkCombo.SelectedItem.Aliasname.toLowerCase()&&this.ReferenceCallBack.IsSubscribed&&this.ReferenceCallBack.Call({ReferenceTable:null,ReferenceEditTable:null,DBColumnName:"LinkAll",ccid:0,dr:null})}}SetDocStatus(e,t,s,a,i,o,r){let l=[];return l.push(e),l.push(Object(g.isNullOrUndefined)(i)?"":i),l.push(a.ToString("dd/MMM/yyyy")),l.push(this.IsInventory),l.push(this.DocID),l.push(this.CostCenterID),l.push(t),l.push(s),l.push(o),l.push(r),l.push(n.a.SessionManager.CompanyGUID),l.push(n.a.SessionManager.UserName),l.push(n.a.SessionManager.UserID),l.push(n.a.SessionManager.RoleID),l.push(n.a.SessionManager.LanguageID),n.a.document.SetDocStatus(l)}GetProductVendors(e){return n.a.common.GetDataSet("DOC014",e)}GetProductBundle(e){let t=[];return t.push(e),t.push(n.a.SessionManager.UserID),t.push(n.a.SessionManager.LanguageID),n.a.document.GetProductBundle(t)}SetCostCenterNodeFiles(e,t){let s=[];return s.AddRange(e),s.push(n.a.SessionManager.CompanyGUID),s.push(t),s.push(n.a.SessionManager.UserName),s.push(n.a.SessionManager.RoleID),s.push(n.a.SessionManager.LanguageID),n.a.document.SetCostCenterNodeFiles(s)}setPref(e,t){n.a.common.GetDataSet3("SETPEF001",e,this.CostCenterID.toString(),t),this.Preferences[e]=t}SetDocLinkStatus(e,t,s){let a=[];return a.push(e),a.push(null!=s?s:""),a.push(t),a.push(this.DocID),a.push(this.CostCenterID),a.push(n.a.SessionManager.CompanyGUID),a.push(n.a.SessionManager.UserName),a.push(n.a.SessionManager.UserID),a.push(n.a.SessionManager.RoleID),a.push(n.a.SessionManager.LanguageID),n.a.document.SetDocLinkStatus(a)}GetDocStatusHistory(){return f.GetDocStatusHistory(this.CostCenterID,this.DocID,this.IsInventory)}static GetDocStatusHistory(e,t,s){let a=[];return a.push(e),a.push(t),a.push(s),a.push(n.a.SessionManager.UserID),a.push(n.a.SessionManager.LanguageID),n.a.document.GetDocStatusHistory(a)}GetLinkDefDetails(e,t,s="",a=""){let i=[];return i.push(t),i.push(e),i.push(s),i.push(a),i.push(n.a.SessionManager.UserID),i.push(n.a.SessionManager.RoleID),i.push(n.a.SessionManager.LanguageID),n.a.document.GetLinkDefDetails(i)}GetBatchWiseQOH(e,t,s){Logger.InfoLog("VoucherGenerator:: Inside GetBatchWiseQoh");let i="2";n.a.SessionManager.Preferences.ContainsKey("DecimalsinQty")&&""!=n.a.SessionManager.Preferences.DecimalsinQty&&(i=n.a.SessionManager.Preferences.DecimalsinQty);let o=" ProductID= "+e+" and BatchID= "+t+" AND IsQtyIgnored=0 and i.StatusID=369 AND ",r=a.e.Int(n.a.SessionManager.Preferences["Maintain Dimensionwise stock"]);var l;n.a.SessionManager.Preferences.ContainsKey("Maintain Dimensionwise stock")&&r>0&&(this.GridDataColumns.Contains("dcCCNID"+(r-5e4)+"_Key")?a.e.IsEmpty(s["dcCCNID"+(r-5e4)+"_Key"])||(o+=" dcCCNID"+(r-5e4).toString()+"="+s["dcCCNID"+(r-5e4)+"_Key"].toString()+" and "):(l=this._CCFields.find(e=>e.DBColumnName.toLowerCase()=="dcccnid"+(r-5e4)))&&l instanceof c.b&&l.SelectedValue>0&&(o+=" dcCCNID"+(r-5e4).toString()+"="+l.SelectedValue+" and ")),"true"==n.a.SessionManager.Preferences.EnableLocationWise.toLowerCase()&&Object(S.j)(n.a.SessionManager.Preferences["Location Stock"])&&(this.GridDataColumns.Contains("dcCCNID2_Key")?a.e.IsEmpty(s.dcCCNID2_Key)||(o+=" dcCCNID2="+s.dcCCNID2_Key.toString()+" and "):(l=this._CCFields.find(e=>"dcccnid2"==e.DBColumnName.toLowerCase()))&&l instanceof c.b?l.SelectedValue>0&&(o+=" dcCCNID2="+l.SelectedValue+" and "):this.LocationID>0?o+=" dcCCNID2="+this.LocationID+" and ":n.a.SessionManager.LocationID>0&&(o+=" dcCCNID2="+n.a.SessionManager.LocationID+" and ")),"true"==n.a.SessionManager.Preferences.EnableDivisionWise.toLowerCase()&&n.a.SessionManager.Preferences.ContainsKey("Division Stock")&&Object(S.j)(n.a.SessionManager.Preferences["Division Stock"])&&(this.GridDataColumns.Contains("dcCCNID1_Key")?a.e.IsEmpty(s.dcCCNID1_Key)||(o+=" dcCCNID1="+s.dcCCNID1_Key.toString()+" and "):(l=this._CCFields.find(e=>"dcccnid1"==e.DBColumnName.toLowerCase()))&&l instanceof c.b?l.SelectedValue>0&&(o+=" dcCCNID1="+l.SelectedValue+" and "):this.DivisionID>0?o+=" dcCCNID1="+this.DivisionID+" and ":n.a.SessionManager.DivisionID>0&&(o+=" dcCCNID1="+n.a.SessionManager.DivisionID+" and ")),o+=" (VoucherType=1 OR VoucherType=-1) ",o+=" and convert(datetime,DocDate)<='",31!=this.DocumentType&&32!=this.DocumentType||null==s||!this.GridDataColumns.Contains("DueDate_Key")||a.e.IsEmpty(s.DueDate_Key)?o+=null!=this.DueDate&&this.DueDate.Date?this.DueDate.Date.ToString("dd/MMM/yyyy"):null!=this.DocDate?this.DocDate.Date.ToString("dd/MMM/yyyy"):(new Date).ToString("dd/MMM/yyyy"):o+=new Date(s.DueDate_Key).ToString("dd/MMM/yyyy"),o+="' ";let u=[];u.push(o),u.push(n.a.SessionManager.UserID),u.push(n.a.SessionManager.LanguageID);let D=n.a.common.GetDataSet3("DOC043",i,o);return null!=D&&D.Tables.length>0&&D.Tables[0].length>0&&a.e.IsNum(D.Tables[0][0].dbl)?parseFloat(D.Tables[0][0].dbl):(Logger.InfoLog("VoucherGenerator:: Exiting GetBatchWiseQoh"),0)}GetLinkedDocuments(){let e="",t="",s="";return this.GridData.forEach(n=>{!a.e.IsEmpty(n.LinkedInvDocDetailsID)&&parseInt(n.LinkedInvDocDetailsID)>0&&(e.length>0&&(e+=","),e+=n.LinkedInvDocDetailsID.toString(),s.length>0&&(s+=","),s+=n.LinkedInvDocDetailsID.toString()),n.DocDetailsID.toString().length>0&&parseInt(n.DocDetailsID)>0&&(t.length>0&&(t+=","),t+=n.DocDetailsID.toString(),s.length>0&&(s+=","),s+=n.DocDetailsID.toString())}),n.a.common.GetDataSet3("DOC034",s,t,e)}GetPaymentTerms(e,t){let s=[];return s.push(e),s.push(t),s.push(n.a.SessionManager.UserID),s.push(n.a.SessionManager.LanguageID),n.a.document.GetPaymentTermDetails(s)}getDistribution(e="",t="",s=!1,a=0,i=""){Logger.InfoLog("Voucher Generator:: Inside getDistribution");let o=n.a.document.getDistribution(e,t,s,a,i);if(Logger.InfoLog("Voucher Generator: DBH.getDistribution "),null!=o&&o.Tables.length>0){if(o.Columns[0].Contains("amt")&&o.Tables[0].length>0)return o.Tables[0];if(o.Columns[1].Contains("amt")&&o.Tables[1].length>0)return o.Tables[1]}return null}getPrevCash(e){Logger.InfoLog("Voucher Generator:: Inside getPrevCash");let t=[];t.push(this.RegisterNodeID),t.push(this.ShiftNodeID),t.push(e),t.push(n.a.SessionManager.UserID),t.push(n.a.SessionManager.LanguageID);let s=n.a.document.GetPOSCash(t);return null!=s&&s.Tables.length>0&&s.Columns[0].Contains("cash")&&""!=s.Tables[0][0].cash.toString()?s.Tables[0][0].cash.toString():(Logger.InfoLog("Voucher Generator: DBH.getPrevCash "),"0")}GetAccBalance(e,t){Logger.InfoLog("Voucher Generator:: Inside GetAccBalance");let s=[];s.push(e),s.push(this.DocID),s.push(this.IsInventory),s.push((new Date).ToString("dd/MMM/yyyy")),s.push(t.ToString("dd/MMM/yyyy")),s.push(n.a.SessionManager.UserID),s.push(n.a.SessionManager.LanguageID);let a=n.a.document.GetAccBalance(s);return Logger.InfoLog("Voucher Generator: DBH.GetAccBalance "+e.toString()),a}GetArApDetails(e,t,s){let i="";if(38==this.DocumentType||s){for(let e=0;e<this.GridData.length;e++)!a.e.IsEmpty(this.GridData[e].LinkedInvDocDetailsID)&&parseInt(this.GridData[e].LinkedInvDocDetailsID)>0&&(""!=i&&(i+=","),i+=this.GridData[e].LinkedInvDocDetailsID.toString());if(38==this.DocumentType&&""==i)return null}let o=[];return o.push(e),o.push(t.ToString("dd/MMM/yyyy")),o.push(a.e.IsEmpty(this.VoucherNo)?"":this.VoucherNo),o.push(i),o.push(this.DocumentType),o.push(n.a.SessionManager.UserID),o.push(n.a.SessionManager.LanguageID),n.a.document.GetArApDetails(o)}IsRecurDocumet(){let e=n.a.common.GetDataSet3("DOC015",this.CostCenterID.toString(),this.DocID.toString());return!!(null!=e&&e.Tables.length>0&&e.Columns[0].Contains("CNT")&&parseInt(e.Tables[0][0].CNT)>0)}GetMatrixInfo(e){return n.a.common.GetDataSet("DOC015",e)}lockDocument(e=!0){var t,s;let a=n.a.common.GetDataSet3("DOC017",e?"'"+n.a.SessionManager.UserName+"'":"NULL",this.VoucherNo,this.DocID.toString());return e?null!=a&&(null===(t=a.Tables)||void 0===t?void 0:t.length)>0&&a.Columns[0].Contains("CNT")&&parseInt(a.Tables[0][0].CNT)>0?"Locked Successfully":"Lock failed":null!=a&&(null===(s=a.Tables)||void 0===s?void 0:s.length)>0&&a.Columns[0].Contains("CNT")&&parseInt(a.Tables[0][0].CNT)>0?"Unlocked Successfully":"UnLock failed"}GetScannedPacks(e){return n.a.common.GetDataSet("DOC018",e)}IsDistCost(e){let t=n.a.common.GetDataSet("DOC050",e);return!!(null!=t&&t.Tables.length>0&&t.Tables[0].length>0&&t.Columns[0].Contains("DistCost")&&"1"==a.e.String(t.Tables[0][0].DistCost))}IsPostRecurDocumentWithApproval(e){Logger.InfoLog("Voucher Generator:: Inside IsRecurDocumet");let t=n.a.common.GetDataSet("DOC009",e);return!!(null!=t&&t.Tables.length>0&&t.Columns[0].Contains("PostRecurWithApproval")&&"1"==a.e.StringValue(t.Tables[0][0].PostRecurWithApproval))}GetSchemes(e,t){Logger.InfoLog("Voucher Generator:: Inside GetSchemes");let s="<XML>";this._CCFields.forEach(e=>{e instanceof c.b&&e.DBColumnName.Contains("TO")&&5==this.DocumentType||e instanceof c.b&&e.SelectedValue>0&&(s+='<Row CostCenterID="'+e.CCID+'" NODEID="'+e.SelectedValue.toString()+'" />')}),this.ColumnSource.forEach(e=>{e.CostCenterID>5e4&&this.GridDataColumns.Contains(e.ValueMember)?a.e.IsEmpty(t[e.ValueMember])?a.e.IsEmpty(t[e.DisplayMember])||(s+='<Row CostCenterID="'+e.CostCenterID+'" NODEID="'+t[e.DisplayMember].toString()+'" />'):s+='<Row CostCenterID="'+e.CostCenterID+'" NODEID="'+t[e.ValueMember].toString()+'" />':2!=e.CostCenterID||a.e.IsEmpty(t[e.ValueMember])||(1==this.DocumentType||2==this.DocumentType||10==this.DocumentType||26==this.DocumentType||27==this.DocumentType||3==this.DocumentType||4==this.DocumentType||25==this.DocumentType||13==this.DocumentType?s+='<Row CostCenterID="2" NODEID="'+t[e.ValueMember].toString()+'" />':11!=this.DocumentType&&38!=this.DocumentType&&39!=this.DocumentType&&6!=this.DocumentType&&7!=this.DocumentType&&8!=this.DocumentType&&9!=this.DocumentType&&12!=this.DocumentType&&24!=this.DocumentType||(s+='<Row CostCenterID="2" NODEID="'+t[e.ValueMember].toString()+'" />'))}),(1==this.DocumentType||2==this.DocumentType||10==this.DocumentType||26==this.DocumentType||27==this.DocumentType||3==this.DocumentType||4==this.DocumentType||25==this.DocumentType||13==this.DocumentType)&&null!=this.CreditAccount&&this.CreditAccount.SelectedValue>0?s+='<Row CostCenterID="2" NODEID="'+this.CreditAccount.SelectedValue.toString()+'" />':(11==this.DocumentType||38==this.DocumentType||39==this.DocumentType||6==this.DocumentType||7==this.DocumentType||8==this.DocumentType||9==this.DocumentType||12==this.DocumentType||24==this.DocumentType)&&null!=this.DebitAccount&&this.DebitAccount.SelectedValue>0&&(s+='<Row CostCenterID="2" NODEID="'+this.DebitAccount.SelectedValue.toString()+'" />'),s+="</XML>";let i=[];return this.GridDataColumns.Contains("ProductID_Key")&&!a.e.IsEmpty(t.ProductID_Key)?i.push(t.ProductID_Key.toString()):i.push(0),i.push(s),i.push(e.ToString("dd/MMM/yyyy")),n.a.document.GetSchemes(i)}static GetLookupData(e){let t=n.a.common.GetDataSet("DOC019",e.toString());return null!=t&&t.Tables.length>0&&t.Columns[0].Contains("NodeID")?t.Tables[0]:null}GetPosPoints(e){Logger.InfoLog("Voucher Generator:: Inside GetPosPoints");let t=[];if(!a.e.IsEmpty(n.a.SessionManager.Preferences.Loyalty)&&"0"!=n.a.SessionManager.Preferences.Loyalty){let i;if(n.a.SessionManager.Preferences.ContainsKey("LoyaltyOn")&&a.e.Int(n.a.SessionManager.Preferences.LoyaltyOn)>5e4){t.push(i);var s=this._CCFields.find(e=>e instanceof c.b&&e.CCID==i);if(!(null!=s&&s.SelectedValue>0))return null;t.push(s.SelectedValue)}else{if(!(null!=this.DebitAccount&&this.DebitAccount.SelectedValue>0))return null;t.push(2),t.push(this.DebitAccount.SelectedValue)}t.push(this.DocID),t.push(n.a.SessionManager.Preferences.Loyalty),t.push(e.ToString("dd/MMM/yyyy")),t.push(n.a.SessionManager.UserID),t.push(n.a.SessionManager.LanguageID);let o=n.a.inventory.GetPosPoints(t);return Logger.InfoLog("Voucher Generator: DBH.GetPosPoints "),o}return null}getBatchSeq(e){let t=1,s=n.a.common.GetDataSet("DOC020",e);return null!=s&&s.Tables.length>0&&s.Tables[0].length>0&&a.e.IsNum(s.Tables[0][0].bno)&&(t=parseInt(s.Tables[0][0].bno)),t}GetUserWiseDim(){Logger.InfoLog("Voucher Generator:: Inside GetUserWiseDim");let e=n.a.common.GetDataSet("DOC021",n.a.SessionManager.UserID);return Logger.InfoLog("Voucher Generator: DBH.GetUserWiseDim "),e}GetRefDetails(e,t){Logger.InfoLog("Voucher Generator:: Inside GetRefDetails");let s=n.a.common.GetDataSet3("DOC022",e,t);return Logger.InfoLog("Voucher Generator: DBH.GetRefDetails "),null!=s&&s.Tables.length>0?s.Tables[0]:null}GetUniqueDimension(e,t){if(2==e||3==e||e>5e4){let s=n.a.common.GetDataSet3("DOC023",e.toString(),t?"1":"0");if(null!=s&&s.Tables.length>0&&s.Tables[0].length>0&&!a.e.IsEmpty(s.Tables[0][0].isunique))return parseInt(s.Tables[0][0].isunique)}return 0}GetCCData(e,t,s,i){Logger.InfoLog("Voucher Generator:: Inside GetCCData");let o="";e>5e4?(o="Select a.NodeID ID,a.Code,a.name","true"==n.a.SessionManager.Preferences.POSShowDimImage.toLowerCase()&&(o+=",f.GUID+'.'+f.FileExtension FileName"),o+=" from "+this.GetTableName(e)+" a WITH(NOLOCK) JOIN COM_CCCCData CC WITH(NOLOCK) ON CC.COSTCENTERID="+e+" AND CC.NODEID= a.NODEID ","true"==n.a.SessionManager.Preferences.POSShowDimImage.toLowerCase()&&(o+=" left join COM_Files f WITH(NOLOCK) on f.FeaturePK=a.NodeID and f.FeatureID="+e+" and f.IsDefaultImage=1 "),o+=s,a.e.IsEmpty(t)||(o+=" where "+t)):(3==e||e<0)&&("true"==n.a.SessionManager.Preferences.POSShowStockCodes.toLowerCase()&&""!=n.a.SessionManager.Preferences.POSItemCodeDimension?(e<0&&(o="Select p.ProductID ID,p.ProductCode Code,p.ProductName name,p.IsGroup,0 NodeID,'' StkCode","true"!=n.a.SessionManager.Preferences.POSShowProductImage.toLowerCase()&&"true"!=n.a.SessionManager.Preferences.POSShowDimImage.toLowerCase()||(o+=",f.GUID+'.'+f.FileExtension FileName"),""!=n.a.SessionManager.Preferences.POSSellingRate&&(o+=",0 MRP"),o+=" from inv_product p WITH(NOLOCK) JOIN COM_CCCCData CC WITH(NOLOCK) ON CC.COSTCENTERID=3 AND CC.NODEID= p.ProductID ","true"!=n.a.SessionManager.Preferences.POSShowProductImage.toLowerCase()&&"true"!=n.a.SessionManager.Preferences.POSShowDimImage.toLowerCase()||(o+=" left join COM_Files f WITH(NOLOCK) on f.FeaturePK=p.ProductID and f.FeatureID=3 and f.IsDefaultImage=1  "),o+=s,o+=" where p.IsGroup=1 ",a.e.IsEmpty(t)||(o+=" and "+t),o+=" union all "),o+=" Select test.*","true"!=n.a.SessionManager.Preferences.POSShowProductImage.toLowerCase()&&"true"!=n.a.SessionManager.Preferences.POSShowDimImage.toLowerCase()||("true"==n.a.SessionManager.Preferences.POSShowDimImage.toLowerCase()?o+=",f.ImageName FileName":o+=",f.GUID+'.'+f.FileExtension FileName"),""!=n.a.SessionManager.Preferences.POSSellingRate&&"PriceChart"!=n.a.SessionManager.Preferences.POSSellingRate&&(o+=",sp."+n.a.SessionManager.Preferences.POSSellingRate+" MRP"),o+="from (Select ID,Code,name,IsGroup,MAX(NodeID) NodeID,StkCode \n                from (Select p.ProductID this.ID,p.ProductCode Code,p.ProductName name,p.IsGroup,a.NodeID,a.Code StkCode,\n                (select isnull(sum(UOMConvertedQty*VoucherType),0) from INV_DocDetails i WITH(NOLOCK)\n                join COM_DocCCData c WITH(NOLOCK) on i.InvDocDetailsID=c.InvDocDetailsID \n                where c.DCCCNID"+(parseInt(n.a.SessionManager.Preferences.POSItemCodeDimension)-5e4)+"=a.NodeID "+i+") QOH\n                from "+this.GetTableName(parseInt(n.a.SessionManager.Preferences.POSItemCodeDimension))+" a WITH(NOLOCK) \n                join inv_product p WITH(NOLOCK) on a.ProductID=p.ProductID\n                JOIN COM_CCCCData CC WITH(NOLOCK) ON CC.COSTCENTERID=3 AND CC.NODEID= p.ProductID ",o+=s,a.e.IsEmpty(t)||(o+=" where "+t),o+=" ) as t group by ID,Code,name,IsGroup,StkCode  having SUM(QOH)>0 ) as test ",""!=n.a.SessionManager.Preferences.POSSellingRate&&"PriceChart"!=n.a.SessionManager.Preferences.POSSellingRate&&(o+="DealerPrice"!=n.a.SessionManager.Preferences.POSSellingRate&&"MRP"!=n.a.SessionManager.Preferences.POSSellingRate&&"AvgPrice"!=n.a.SessionManager.Preferences.POSSellingRate?" join inv_product sp WITH(NOLOCK) on sp.ProductID=test.ID ":" join "+this.GetTableName(parseInt(n.a.SessionManager.Preferences.POSItemCodeDimension))+" sp WITH(NOLOCK) on sp.NodeID=test.NodeID"),"true"!=n.a.SessionManager.Preferences.POSShowProductImage.toLowerCase()&&"true"!=n.a.SessionManager.Preferences.POSShowDimImage.toLowerCase()||("true"==n.a.SessionManager.Preferences.POSShowDimImage.toLowerCase()?o+=" join "+this.GetTableName(parseInt(n.a.SessionManager.Preferences.POSItemCodeDimension))+" f WITH(NOLOCK) on f.NodeID=test.NodeID":o+=" left join COM_Files f WITH(NOLOCK) on f.FeaturePK=test.ID and f.FeatureID=3 and f.IsDefaultImage=1 "),"true"==n.a.SessionManager.Preferences.POSShowProductCode.toLowerCase()?"true"==n.a.SessionManager.Preferences.POSShowStockCodes.toLowerCase()?o+=" order by StkCode,Code":o+=" order by Code":"true"==n.a.SessionManager.Preferences.POSShowProductName.toLowerCase()&&(o+=" order by name")):(o="Select p.ProductID ID,p.ProductCode Code,p.ProductName name,p.IsGroup","true"==n.a.SessionManager.Preferences.POSShowProductImage.toLowerCase()&&(o+=",f.GUID+'.'+f.FileExtension FileName"),""!=n.a.SessionManager.Preferences.POSSellingRate&&"PriceChart"!=n.a.SessionManager.Preferences.POSSellingRate&&"DealerPrice"!=n.a.SessionManager.Preferences.POSSellingRate&&"MRP"!=n.a.SessionManager.Preferences.POSSellingRate&&"AvgPrice"!=n.a.SessionManager.Preferences.POSSellingRate&&(o+=",p."+n.a.SessionManager.Preferences.POSSellingRate+" MRP"),o+=" from inv_product p WITH(NOLOCK) JOIN COM_CCCCData CC WITH(NOLOCK) ON CC.COSTCENTERID=3 AND CC.NODEID= p.ProductID ","true"==n.a.SessionManager.Preferences.POSShowProductImage.toLowerCase()&&(o+=" left join COM_Files f WITH(NOLOCK) on f.FeaturePK=p.ProductID and f.FeatureID=3 and f.IsDefaultImage=1 "),o+=s,a.e.IsEmpty(t)||(o+=" where "+t),"true"==n.a.SessionManager.Preferences.POSShowProductCode.toLowerCase()?o+=" order by p.ProductCode":"true"==n.a.SessionManager.Preferences.POSShowProductName.toLowerCase()&&(o+=" order by p.ProductName")));let r=n.a.common.GetDataSetQuery(encodeURIComponent(o));if(Logger.InfoLog("Voucher Generator: DBH.GetCCData "),null!=r&&r.Tables.length>0){let e=[];return e=r.Tables[0],e.Columns=r.Columns[0],e}return null}GetPayrollProcessed(e,t){let s=[];return s.push(e),s.push(t),s.push(n.a.SessionManager.UserID),s.push(n.a.SessionManager.LanguageID),n.a.empService.GetPayrollProcessedStatus(s)}GetEmployeePayrollInfo(e,t,s,a){let i=[];return i.push(e),i.push(a),i.push(s),i.push(t),i.push(n.a.SessionManager.AccountingFromMonth),i.push(n.a.SessionManager.UserID),i.push(n.a.SessionManager.LanguageID),n.a.empService.GetEmployeePayrollInfo(i)}CheckLoanRepayAmountDetails(e){let t=[];return t.push(e),t.push(n.a.SessionManager.UserID),t.push(n.a.SessionManager.LanguageID),n.a.empService.GetLoanRepayAmountDetails(t)}GetAllEmployeesList(e,t,s,a,i){let o=[];return o.push(e),o.push(t),o.push(0),o.push(0),o.push(n.a.SessionManager.UserID),o.push(n.a.SessionManager.LanguageID),o.push(s),o.push(a),o.push(i),n.a.empService.GetAllEmployeesList(o)}GetPayrollComponents(e,t,s,a){let i=[];return i.push(e),i.push(t),i.push(s),i.push(a),i.push(n.a.SessionManager.UserID),i.push(n.a.SessionManager.LanguageID),n.a.empService.GetPayrollComponents(i)}GetVacationDetails(e,t,s){let a=[];return a.push(e),a.push(t.ToString("dd MMM yyyy")),a.push(s.ToString("dd MMM yyyy")),a.push(n.a.SessionManager.UserID),a.push(n.a.SessionManager.LanguageID),n.a.empService.GetVacationDetails(a)}GetVacationDays(e,t,s,a,i,o){let r=[];return r.push(e.ToString("dd MMM yyyy")),r.push(t.ToString("dd MMM yyyy")),r.push(s),r.push(a),r.push(i),r.push(o),r.push(n.a.SessionManager.UserID),r.push(n.a.SessionManager.LanguageID),n.a.empService.GetVacationDays(r)}GetVacationAmount(e,t,s,a){let i=[];return i.push(e.ToString("dd MMM yyyy")),i.push(t.ToString("dd MMM yyyy")),i.push(s),i.push(a),i.push(n.a.SessionManager.UserID),i.push(n.a.SessionManager.LanguageID),n.a.empService.GetVacationAmount(i)}GetAdjustmentLeaves(e,t,s,a){let i=[];return i.push(e),i.push(t),i.push(s),i.push(a),i.push(n.a.SessionManager.UserID),i.push(n.a.SessionManager.LanguageID),n.a.empService.GetAdjustmentLeaves(i)}GetTDSMonthlyandQuarterlyDetails(e,t,s){let a=[];return a.push(e),a.push(t),a.push(s),n.a.empService.GetTDSMonthlyandQuarterlyDetails(a)}GetEmpDimensionDetails(e,t,s){let a=[];return a.push(e),a.push(t),a.push(s),a.push(n.a.SessionManager.UserID),a.push(n.a.SessionManager.LanguageID),n.a.empService.GetEmpDimensionDetails(a)}GetVouchersList(e,t,s,a){try{let i=[];return i.push(e),i.push(t),i.push(s),i.push(a),n.a.document.GetSearchData(n.a.SessionManager.CompanyIndex,i)}catch(i){return Logger.ErrorLog("VoucherGenerator:: GetVouchersList"+i.stack),null}}}}}]);