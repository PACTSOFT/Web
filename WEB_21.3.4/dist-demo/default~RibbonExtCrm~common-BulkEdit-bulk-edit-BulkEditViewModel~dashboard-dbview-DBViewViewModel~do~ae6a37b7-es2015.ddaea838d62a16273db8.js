(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{"XR/+":function(t,e,i){"use strict";i.r(e),i.d(e,"AddEditTenantViewModel",(function(){return M}));var s=i("mrSG"),n=i("Do2H"),a=i("Lp6j"),o=i("eQJW"),l=i("NkMH"),h=i("VxiT"),r=i("n56n"),c=i("0/4Q"),d=i("EQd/"),m=i("xnJf"),g=i("OvA8"),u=i("4HhE"),b=i("JIg3"),S=i("jgdN"),D=i("Jnyl"),T=i("CQvG"),C=i("DKUf"),p=i("ScVY"),V=i("4k0m"),E=i("++IR"),I=i("THE7"),f=i("knKa"),y=i("Huqd"),A=i("bwbx"),O=i("c6C+"),w=i("RJs6");class M extends p.b{constructor(t,e,i){super(),this.CostCenterID=0,this.AttachmentVisibility=!1,this.ReportInfoVisibility=!0,this.ReportsList=[],this.ScreenObject=new h.a,this.ADM={},this.TntObj={},this.Status=new c.e(27284),this.UserName=new d.d(27282),this.Password=new d.d(27283),this.txtCode=new d.d(25694),this.Type=new r.b(25695),this.Position=new r.b(25696),this.FstName=new d.d(25697),this.MdlName=new d.d(25698),this.LstName=new d.d(25699),this.LeaseSignatory=new d.d(25700),this.ContactPerson=new d.d(25701),this.Phone1=new d.d(25702),this.Phone2=new d.d(25703),this.Email=new d.d(25704),this.Fax=new d.d(25705),this.IDNumber=new d.d(25706),this.Profession=new d.d(25707),this.Posting=new r.b(25708),this.Group=new r.b(25789),this.RightRegionVisibility=!1,this.Title="",this.TenantID=0,this.FileID=0,this.IsPhotoDelete=!1,this.IsPhotoChanged=!1,this.IsAttachmentMandatory=!1,this.AccountPhoto="",this.PhotoTextVisibility=!1,this.guid="",this.FileExtension="",this.FileDescription="",this.ActualFileName="",this.NoteVisibility=!1,this.ActVisibility=!1,this.NodeID=0,this.PrimaryVisibility=!1,this.ContactVisibility=!1,this.RetValue=0,this.ParentId=0,this.ErrorMessage="Missing Report Parameter ' ",this.Dset=null,this.ClassName="AddEditTenantViewModel",Logger.InfoLog("AddEditTenantViewModel::Entering AddEditTenantViewModel With SelectedNodeID="+t+",Parent="+e+",IsGroup="+i);try{this.ButtonSave=new l.a,this.ButtonCustomize=new l.a,this.ButtonEIDRead=new l.a,0==t?n.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=n.a.SessionManager.IsActionAssigned(94,"Create"):this.ButtonSave.Enable=n.a.SessionManager.IsActionAssigned(94,"Create"):n.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=n.a.SessionManager.IsActionAssigned(94,"Update"):this.ButtonSave.Enable=n.a.SessionManager.IsActionAssigned(94,"Update"),n.a.SessionManager.HideUnathorizedAccess?this.ButtonCustomize.Visible=n.a.SessionManager.IsActionAssigned(94,"Customize"):this.ButtonCustomize.Enable=n.a.SessionManager.IsActionAssigned(94,"Customize"),n.a.SessionManager.HideUnathorizedAccess?this.ButtonEIDRead.Visible=n.a.SessionManager.IsActionAssigned(94,"EIDRead"):this.ButtonEIDRead.Enable=n.a.SessionManager.IsActionAssigned(94,"EIDRead"),n.a.SessionManager.Preferences.ContainsKey("EIDMapping")&&""!=n.a.SessionManager.Preferences.EIDMapping.toString()||(this.ButtonEIDRead.Visible=!1),this.CostCenterID=94,this.Title=n.a.GetResource("TNT_Title"),this.DisplayMessage="",this.MessageVisibility=!1,this.ScreenObject.LoadScreen_2(this,94),this.LoadImageDimensions(),this.ViewAttachments=new g.ViewAttachmentViewModel(this,n.a.SessionManager,n.a.admin),this.ViewNotes=new w.a(this,n.a.SessionManager,n.a.admin),this.ViewActivities=new T.b(this),this.Activities=new C.a(this,!1),this.ViewActivities.Activities=this.Activities,this.ViewContacts=new I.a(this),this.TntObj.TenantID=t,this.TenantID=this.TntObj.TenantID,this.loadtabs(),this.load(),this.Posting.SelectedValue=154,this.Group.SelectedValue=1,this.AutoGenerateCode(),this.PhotoTextVisibility=!0,this.ParentId=e,this.ScreenObject.CustomTab.Pages.forEach(t=>{"Contacts"==t.Name&&(this.PContact=new f.a,this.PContact.QuickAddContactViewModel_2(this),this.PContact.IsPrimaryContact=!0,this.PContact.Visiblebtns=!1,this.PContact.Countryvisible=!0,this.PrimaryVisibility=!0)}),t>0&&(this.LoadEditData(),this.Title=n.a.GetResource("TNT_Edit")),this.Password.Enable=!this.Password.IsReadOnly,this.ContactVisibility=!1,null!=this.PContact&&(this.PrimaryVisibility=!0),this.ReportView()}catch(s){Logger.ErrorLog("AddEditTenantViewModel:: AddEditTenantViewModel"+s.stack)}Logger.InfoLog("AddEditTenantViewModel::Exiting AddEditTenantViewModel With SelectedNodeID="+t+",Parent="+e+",IsGroup="+i)}GetXML(){Logger.InfoLog("AddEditUnitsViewModel::Entering GetXML"),Logger.InfoLog("AddEditUnitsViewModel::Exiting GetXML")}OnShowNote(){}OnAddNote(){this.Note=new O.AddNoteViewModel,this.Note.AddNoteViewModel_2(this)}OnShowAttachment(){Logger.InfoLog("AddEditAccountScreenViewModel::Entering OnShowAttachment"),Logger.InfoLog("AddEditAccountScreenViewModel::Exiting OnShowAttachment")}OnAddAttachment(){Logger.InfoLog("AddEditAccountScreenViewModel::Entering AddAttachment"),Logger.InfoLog("AddEditAccountScreenViewModel::Exiting AddAttachment")}OnShowContact(){Logger.InfoLog("AddEditTenantViewModel::Entering OnShowContact"),Logger.InfoLog("AddEditTenantViewModel::Exiting OnShowContact")}OnAddContact(){Logger.InfoLog("AddEditTenantViewModel::Entering AddContact"),Logger.InfoLog("AddEditTenantViewModel::Entering AddContact")}ReportView(){this.ReportDimension=new r.b(0),this.ReportDimension.CCID=this.CostCenterID,this.ReportDimension.TypeID=1,this.ReportDimension.SelectedValue=this.TenantID,this.ReportsList=[],this.ReportDimension.OnPactListBoxValueChanged.Subscribe(this,"OnReportsLinkClick");let t=[];null!=this.ScreenObject.Data&&this.ScreenObject.Data.Tables.length>6&&this.ScreenObject.Data.Tables[6].forEach(e=>{let i=new l.a;i.DBColumnID=parseInt(e.ReportID),i.Label=e.ReportName.toString(),this.ScreenObject.Data.Columns[6].Contains("Shortcut")&&(i.KeyTip=e.Shortcut.toString()),this.ScreenObject.Data.Columns[6].Contains("DisplayAsPopup")&&""!=e.DisplayAsPopup.toString()&&(i.Dependantinuse="1"==e.DisplayAsPopup.toString()),this.ScreenObject.Data.Columns[6].Contains("Width")&&""!=e.Width.toString()&&(i.Width=e.Width.toString()),this.ScreenObject.Data.Columns[6].Contains("Height")&&""!=e.Height.toString()&&(i.Length=e.Height.toString()),this.ScreenObject.Data.Columns[6].Contains("DocumentField")&&""!=e.DocumentField.toString()&&(i.Formula=e.DocumentField.toString()),this.ScreenObject.Data.Columns[6].Contains("mapxml")&&""!=e.mapxml.toString()&&(i.ToolTipDescription=e.mapxml.toString()),t.Contains(parseInt(e.ReportID))||(t.push(parseInt(e.ReportID)),this.ReportsList.push(i))})}OnReportsLinkClick(t){return Object(s.b)(this,void 0,void 0,(function*(){const{ReportViewModel:e}=yield Promise.all([i.e(2),i.e(1),i.e(3),i.e(5),i.e(4),i.e(6),i.e(7),i.e(10),i.e(9),i.e(8),i.e(12),i.e(11),i.e(13),i.e(19),i.e(15),i.e(21),i.e(20),i.e(16),i.e(14),i.e(18),i.e(17),i.e(22),i.e(23),i.e(24),i.e(25),i.e(28),i.e(30),i.e(29),i.e(32),i.e(31),i.e(27),i.e(26),i.e(35),i.e(37),i.e(38),i.e(36),i.e(33),i.e(34),i.e(39),i.e(40),i.e(41),i.e(212)]).then(i.bind(null,"ThYU")),{ReportViewComponent:s}=yield Promise.all([i.e(32),i.e(37)]).then(i.bind(null,"YU11"));let o,l={strXML:""},h=new e;if(this.ReportDimension.SelectedValue=this.TenantID,this.DisplayMessage=this.GetReportFilterXML(t,l),o=l.strXML,0==this.DisplayMessage.length){var r=this.ReportsList.find(e=>e.DBColumnID==parseInt(t));if(null!=r&&r.Dependantinuse)h.ReportViewModel_Document(this.CostCenterID,o,parseInt(t),!0,null,null),!a.e.IsEmpty(r.Width)&&parseFloat(r.Width)>0&&(h.RptWidth=parseFloat(r.Width)),!a.e.IsEmpty(r.length)&&parseFloat(r.length)>0&&(h.RptHeight=parseFloat(r.length)),h.DocumentObject=this,n.a.page.HideDialog(),n.a.page.ShowDialog(h,s,{Title:"",HideClose:!0,ShowCenter:!0});else{let i=new e;i.ReportViewModel_Document(this.CostCenterID,o,parseInt(t),!1,null,null),i.DocumentObject=this,n.a.page.HideDialog(),n.a.page.addNewTab({component:s,params:{obj:i}})}}}))}GetReportFilterXML(t,e){let i="";e.strXML="";let s=this.ScreenObject.Data.Tables[6];s=s.filter(e=>e.ReportID==t);let n,a=!1;s.forEach(t=>{Object(o.j)(t.GroupLevel)&&(a=!0)}),i+="<XML",a&&(i+=' GroupLevel="1"'),i+=" >";for(let o=0;o<s.length;o++){n=s[o].ReportField.toString(),i+="<Row ",i+='ColID ="'+n+'" ';for(let t=0;t<this.ScreenObject.StaticFields.length;t++)if(this.ScreenObject.StaticFields[t].DBColumnID==parseInt(s[o].DocumentField.toString()))if(this.ScreenObject.StaticFields[t]instanceof d.d){if(""==this.ScreenObject.StaticFields[t].Text)return alert(this.ErrorMessage+this.ScreenObject.StaticFields[t].Label+" '"),"Empty Value";"SNO"==s[o].SysColumnName.toString()?i+='Value ="'+this.ReportDimension.SelectedValue+'" ':i+='Value ="'+this.ScreenObject.StaticFields[t].Text+'" '}else if(this.ScreenObject.StaticFields[t]instanceof D.a){if(""==this.ScreenObject.StaticFields[t].TextBox.Text||""==this.ScreenObject.StaticFields[t].ComboBox.SelectedValue)return alert(this.ErrorMessage+this.ScreenObject.StaticFields[t].Label+" '"),"Empty Value";i+='Value ="'+this.ScreenObject.StaticFields[t].ComboBox.SelectedValue+'" '}else if(this.ScreenObject.StaticFields[t]instanceof d.c){if(""==this.ScreenObject.StaticFields[t].Text)return alert(this.ErrorMessage+this.ScreenObject.StaticFields[t].Label+" '"),"Empty Value";i+='Value ="'+this.ScreenObject.StaticFields[t].Text+'" '}else if(this.ScreenObject.StaticFields[t]instanceof b.a||this.ScreenObject.StaticFields[t]instanceof b.d||this.ScreenObject.StaticFields[t]instanceof b.c){if(this.ScreenObject.StaticFields[t]instanceof b.a||this.ScreenObject.StaticFields[t]instanceof b.d){if(""==this.ScreenObject.StaticFields[t].Text)return alert(this.ErrorMessage+this.ScreenObject.StaticFields[t].Label+" '"),"Empty Value";i+='Value ="'+this.ScreenObject.StaticFields[t].Date.ToString("dd/MMM/yyyy")+'" '}else if(this.ScreenObject.StaticFields[t]instanceof b.c){if(!this.ScreenObject.StaticFields[t].Date)return alert(this.ErrorMessage+this.ScreenObject.StaticFields[t].Label+" '"),"Empty Value";i+='Value ="'+this.ScreenObject.StaticFields[t].Date.ToString("dd/MMM/yyyy")+'" '}}else if(this.ScreenObject.StaticFields[t]instanceof r.b){if(""==this.ScreenObject.StaticFields[t].Text)return alert(this.ErrorMessage+this.ScreenObject.StaticFields[t].Label+" '"),"Empty Value";i+='Value ="'+this.ScreenObject.StaticFields[t].SelectedValue+'" '}else if(this.ScreenObject.StaticFields[t]instanceof y.a){if(""==this.ScreenObject.StaticFields[t].Text)return alert(this.ErrorMessage+this.ScreenObject.StaticFields[t].Label+" '"),"Empty Value";i+='Value ="'+this.ScreenObject.StaticFields[t].SelectedValue+'" '}this.ScreenObject.CustomTab.Pages.forEach(t=>{t.Fields.forEach(t=>{if(null!=t&&(t instanceof d.d||t instanceof D.a||t instanceof d.c||t instanceof b.a||t instanceof b.d||t instanceof b.c||t instanceof r.b||t instanceof y.a)&&t.DBColumnID==parseInt(s[o].DocumentField.toString()))if(t instanceof d.d){if(""==t.Text)return alert(this.ErrorMessage+t.Label+" '"),"Empty Value";i+='Value ="'+t.Text+'" '}else if(t instanceof D.a){if(""==t.TextBox.Text||""==t.ComboBox.SelectedValue)return alert(this.ErrorMessage+t.Label+" '"),"Empty Value";i+='Value ="'+t.TextBox.Text+'" '}else if(t instanceof d.c){if(""==t.Text)return alert(this.ErrorMessage+t.Label+" '"),"Empty Value";i+='Value ="'+t.Text+'" '}else if(t instanceof b.a||t instanceof b.d||t instanceof b.c){if(t||t){if(""==t.Text)return alert(this.ErrorMessage+t.Label+" '"),"Empty Value";i+='Value ="'+t.Date.ToString("dd/MMM/yyyy")+'" '}else if(t instanceof b.c){if(!t.Date)return alert(this.ErrorMessage+t.Label+" '"),"Empty Value";i+='Value ="'+t.Date.ToString("dd/MMM/yyyy")+'" '}}else if(t instanceof r.b){if(""==t.Text&&0==t.SelectedValue)return alert(this.ErrorMessage+t.Label+" '"),"Empty Value";i+='Value ="'+t.SelectedValue+'" '}else if(t instanceof y.a){if(""==t.Text)return alert(this.ErrorMessage+t.Label+" '"),"Empty Value";i+='Value ="'+t.SelectedValue+'" '}})}),i+=" />"}return i+="</XML>",e.strXML=i.toString(),""}LoadImageDimensions(){}AutoGenerateCode(){let t=n.a.common.GetAutoSequence(94,"","94",n.a.SessionManager.CompanyIndex.toString()),e=this.ScreenObject.Data.Tables[4].filter(t=>"CodeAutoGen"==t.Name);e.length>0&&Object(o.j)(e[0].Value)&&(this.txtCode.Enable=!1,this.txtCode.Mandatory=!1,0==this.TenantID&&(this.txtCode.Text=t))}loadtabs(){Logger.InfoLog("AddEditTenantViewModel::Entering loadtabs");try{this.AssignRowColumns();for(let t=this.ScreenObject.CustomTab.Pages.length-1;t>=0;t--){let e=this.ScreenObject.CustomTab.Pages[t];switch(e.Name){case"Attachments":e.Fields.push(this.ViewAttachments);break;case"Activities":e.Fields.push(this.ViewActivities);break;case"Contacts":e.Fields.push(this.ViewContacts);break;case"Notes":e.Fields.push(this.ViewNotes)}}}catch(t){Logger.InfoLog("AddEditTenantViewModel::Error loadtabs"+t.stack)}Logger.InfoLog("AddEditTenantViewModel::Exiting loadtabs")}AssignRowColumns(){Logger.InfoLog("AddEditTenantViewModel::Entering AssignRowColumns");try{let t;t=this.ScreenObject.CustomFields.length;for(let e=0;e<t;e++)this.ScreenObject.CustomFields[e].Row=e/4,this.ScreenObject.CustomFields[e].Column=e%4}catch(t){Logger.InfoLog("AddEditTenantViewModel::Error AssignRowColumns")}Logger.InfoLog("AddEditTenantViewModel::Exiting AssignRowColumns")}load(){Logger.InfoLog("AddEditTenantViewModel::Entering load");try{this.ScreenObject.Data.Tables[3].forEach(t=>{this.Status.Items.push(c.d.ComboBoxItems_2(t[Object.keys(t)[1]].toString(),t[Object.keys(t)[0]].toString()))}),this.Status.DefaultValue="462",this.Status.SelectedValue="462"}catch(t){Logger.InfoLog("AddEditTenantViewModel::Exiting load"+t.stack)}Logger.InfoLog("AddEditTenantViewModel::Exiting load")}LoadEditData(){if(Logger.InfoLog("AddEditTenantViewModel::Entering LoadEditData"),this.Dset=n.a.rental.GetTenantDetails(this.TntObj.TenantID),Object.assign(this.TntObj,this.Dset.obj),this.txtCode.Text=a.e.StringValue(this.TntObj.Code),this.Type.SelectedValue=this.TntObj.TypeID,this.Position.SelectedValue=this.TntObj.PositionID,this.FstName.Text=a.e.StringValue(this.TntObj.FirstName),this.MdlName.Text=a.e.StringValue(this.TntObj.MiddleName),this.LstName.Text=a.e.StringValue(this.TntObj.LastName),this.LeaseSignatory.Text=a.e.StringValue(this.TntObj.LeaseSignatory),this.ContactPerson.Text=a.e.StringValue(this.TntObj.ContactPerson),this.Phone1.Text=a.e.StringValue(this.TntObj.Phone1),this.Phone2.Text=a.e.StringValue(this.TntObj.Phone2),this.Email.Text=a.e.StringValue(this.TntObj.Email),this.Fax.Text=a.e.StringValue(this.TntObj.Fax),this.UserName.Text=a.e.StringValue(this.TntObj.UserName),this.Password.Text=a.e.StringValue(this.Decrypt(this.TntObj.Password)),this.Status.SelectedValue=a.e.StringValue(this.TntObj.StatusID),this.IDNumber.Text=a.e.StringValue(this.TntObj.IDNumber),this.Profession.Text=a.e.StringValue(this.TntObj.Profession),this.Posting.SelectedValue=a.e.IntTryParse(this.TntObj.PostingID),this.LoadCustomFieldsData(this.Dset.Tables[0]),this.ScreenObject.LoadCustomFieldsData(this.Dset.Tables[1]),this.ScreenObject.LoadCustomFieldsCCData(this.Dset.Tables[2]),this.Dset.Tables.length>3&&this.ViewNotes.LoadNotes(this.Dset.Tables[3]),this.Dset.Tables.length>4){this.ViewAttachments.LoadAttachments(this.Dset.Tables[4]);let t=this.Dset.Tables[4].filter(t=>1==t.IsProductImage);t.length>0?(this.PhotoTextVisibility=!1,this.FileID=parseInt(t[0].FileID),this.AccountPhoto=a.e.GetPath(t[0].GUID.toString()+"."+t[0].FileExtension.toString()),this.ActualFileName=t[0].ActualFileName.toString()):(this.FileID=0,this.PhotoTextVisibility=!0)}this.Dset.Tables.length>6&&this.ViewActivities.LoadActivityData(this.Dset.Tables[6]),this.Dset.Tables.length>7&&this.ViewContacts.LoadContacts(this.Dset.Tables[7],this.Dset.Tables[7]),null!=this.PContact&&this.Dset.Tables.length>8&&this.PContact.LoadContacts(this.Dset.Tables[8]),this.ScreenObject.CanApprove(this.Dset.Tables[0][0],this.Dset.Tables[5][0],this.ButtonSave),Logger.InfoLog("AddEditTenantViewModel::Exiting LoadEditData")}getFields(){let t;Logger.InfoLog("AddEditTenantViewModel::Entering getFields");let e="",i=null;return this.ScreenObject.CustomTab.Pages.forEach(s=>{s.Fields.forEach(s=>{s instanceof u.c&&!a.e.IsEmpty(s.DBColumnName)&&!s.DBColumnName.toLowerCase().Contains("alpha")&&!s.DBColumnName.toLowerCase().Contains("ccnid")&&(s instanceof d.d?"Passport"!=s.DBColumnName&&"Nationality"!=s.DBColumnName&&"SponsorName"!=s.DBColumnName&&"SponsorPassport"!=s.DBColumnName&&"License"!=s.DBColumnName&&"LicenseIssuedBy"!=s.DBColumnName||(t=s.Text,a.e.IsEmpty(t)&&(t="",i=null),e+=s.DBColumnName+"=N'"+t.replace("'","''")+"',"):s instanceof c.e?(t=s.SelectedValue,a.e.IsEmpty(t)&&(t=""),e+=s.DBColumnName+"=N'"+t+"',"):s instanceof b.c?s.Date&&(t=s.Date.ToString("dd/MMM/yyyy"),a.e.IsEmpty(t)&&(t=""),e+=s.DBColumnName+"='"+t+"',"):s instanceof b.a?(t=s.Date.ToString("dd/MMM/yyyy"),a.e.IsEmpty(t)&&(t=""),e+=s.DBColumnName+"=Convert(float,Convert(DateTime,'"+t+"')),"):s instanceof S.a&&(t=s.Text,a.e.IsEmpty(t)&&(t=""),e+=s.DBColumnName+"='"+t+"',"))})}),this.ScreenObject.HeaderFields.forEach(s=>{!(s instanceof u.c)||a.e.IsEmpty(s.DBColumnName)||s.DBColumnName.toLowerCase().Contains("alpha")||s.DBColumnName.toLowerCase().Contains("ccnid")||this.ScreenObject.StaticFields.Contains(s)||(s instanceof d.d?"Passport"!=s.DBColumnName&&"Nationality"!=s.DBColumnName&&"SponsorName"!=s.DBColumnName&&"SponsorPassport"!=s.DBColumnName&&"License"!=s.DBColumnName&&"LicenseIssuedBy"!=s.DBColumnName||(t=s.Text,a.e.IsEmpty(t)&&(t="",i=null),e+=s.DBColumnName+"=N'"+t.replace("'","''")+"',"):s instanceof c.e?(t=s.SelectedValue,a.e.IsEmpty(t)&&(t=""),e+=s.DBColumnName+"=N'"+t+"',"):s instanceof b.c?s.Date&&(t=s.Date.ToString("dd/MMM/yyyy"),a.e.IsEmpty(t)&&(t=""),e+=s.DBColumnName+"='"+t+"',"):s instanceof b.a?(t=s.Date.ToString("dd/MMM/yyyy"),a.e.IsEmpty(t)&&(t=""),e+=s.DBColumnName+"=Convert(float,Convert(DateTime,'"+t+"')),"):s instanceof S.a&&(t=s.Text,a.e.IsEmpty(t)&&(t=""),e+=s.DBColumnName+"='"+t+"',"))}),e+=null!=this.UserName.Text&&""!=this.UserName.Text?"Username='"+this.UserName.Text+"',":"Username='',",e+=null!=this.Password.Text&&""!=this.Password.Text?"Password='"+this.Encrypt(this.Password.Text)+"',":"Password='',",null!=this.Status.SelectedValue&&(e+="StatusID='"+this.Status.SelectedValue+"',"),Logger.InfoLog("AddEditTenantViewModel::Exiting getFields"),e.toString()}LoadCustomFieldsData(t){if(Logger.InfoLog("AddEditTenantViewModel:: Entering LoadCustomFieldsData"),this.ScreenObject.CheckViewForUser(!0),null!=t&&t.length>0){try{this.ScreenObject.CustomTab.Pages.forEach(e=>{e.Fields.forEach(e=>{if(e instanceof u.c&&null!=e.DBColumnName&&null!=t[0][e.DBColumnName])if(e instanceof d.d)e.Text=t[0][e.DBColumnName].toString();else if(e instanceof c.e)e.SelectedValue=t[0][e.DBColumnName].toString();else if(e instanceof b.c)!a.e.StringIsNullOrEmpty(t[0][e.DBColumnName])&&a.e.isValidDate(t[0][e.DBColumnName].toString())&&(e.Date=new Date(t[0][e.DBColumnName]));else if(e instanceof b.a)!a.e.StringIsNullOrEmpty(t[0][e.DBColumnName])&&a.e.isValidDate(t[0][e.DBColumnName].toString())&&(e.Date=new Date(t[0][e.DBColumnName]));else if(e instanceof S.a)e.Text=t[0][e.DBColumnName].toString();else if(e instanceof r.b){let i=a.e.IntTryParse(t[0][e.DBColumnName].toString());!a.e.StringIsNullOrEmpty(t[0][e.DBColumnName])&&i>0&&(e.SelectedValue=parseInt(t[0][e.DBColumnName].toString()))}})}),this.ScreenObject.HeaderFields.forEach(e=>{if(e instanceof u.c&&null!=e.DBColumnName&&null!=t[0][e.DBColumnName])if(e instanceof d.d)e.Text=t[0][e.DBColumnName].toString();else if(e instanceof c.e)e.SelectedValue=t[0][e.DBColumnName].toString();else if(e instanceof b.c)!a.e.StringIsNullOrEmpty(t[0][e.DBColumnName])&&a.e.isValidDate(t[0][e.DBColumnName].toString())&&(e.Date=t[0][e.DBColumnName].toString());else if(e instanceof b.a)!a.e.StringIsNullOrEmpty(t[0][e.DBColumnName])&&a.e.isValidDate(t[0][e.DBColumnName].toString())&&(e.Date=t[0][e.DBColumnName].toString());else if(e instanceof S.a)e.Text=t[0][e.DBColumnName].toString();else if(e instanceof r.b){let i=a.e.IntTryParse(t[0][e.DBColumnName]);!a.e.StringIsNullOrEmpty(t[0][e.DBColumnName])&&i>0&&(e.SelectedValue=parseInt(t[0][e.DBColumnName].toString()))}})}catch(e){Logger.ErrorLog("AddEditTenantViewModel:: LoadCustomFieldsData : "+e.stack)}Logger.InfoLog("AddEditTenantViewModel:: Exiting LoadCustomFieldsData")}}OnCustomize(t){"Report"==t.toString()?(this.AttachmentVisibility=!1,this.ActVisibility=!1,this.PrimaryVisibility=!1,this.ReportInfoVisibility=!0,this.ReportInfoVisibility=!0,n.a.page.ShowDialog(this,A.a,{Title:"Reports"})):"Cancel"==t.toString()&&(this.ReportInfoVisibility=!1)}Encrypt(t){return t}Decrypt(t){return t}OnSave(t,e=""){if(Logger.InfoLog("AddEditTenantViewModel:: Inside OnSave"),"Read"==t.toString()||"ReadEID"==t.toString()){let t="",e="",i="";a.e.IsEmpty(t)||(this.AccountPhoto=t,this.IsPhotoChanged=!0,this.PhotoTextVisibility=!1);for(let s=0;s<this.ViewAttachments.AttachmentsList.length;s++)"EIDSignature.jpg"==this.ViewAttachments.AttachmentsList[s].ActualFileName&&(this.ViewAttachments.SelectedAttachment=this.ViewAttachments.AttachmentsList[s],this.ViewAttachments.OnCmnItem_Click("DELETE"));a.e.IsEmpty(e)||(this.Attachment=new m.AddAttachmentViewModel,this.Attachment.AddAttachmentViewModel_2(this),this.Attachment.AliasFileName=e,this.Attachment.RelativeFileName=e,this.Attachment.FileDescription="Signature",this.Attachment.ActualFileName="EIDSignature.jpg",this.Attachment.FilePath=e,this.Attachment.FileExtension="jpg",this.Attachment.AttachmentID=0,this.Attachment._Flg=!0,this.ViewAttachments.AttachmentsList.push(this.Attachment)),a.e.IsEmpty(i)||(this.DisplayMessage=i,this.MessageVisibility=!0)}else if("DeletePhoto"==t.toString())this.IsPhotoDelete=!0,this.AccountPhoto="",this.ActualFileName="",this.IsPhotoChanged=!1,this.PhotoTextVisibility=!0,this.DisplayMessage="";else if("PopUp"==t.toString()){let t="";null!=this.Dset&&this.Dset.Tables[4].filter(t=>"jpg"==t.FileExtension||"png"==t.FileExtension).forEach(e=>{t+=a.e.GetPath(e.GUID.toString()+"."+e.FileExtension.toString())+";"})}else if("MouseDown"==t.toString()||"UploadPhoto"==t.toString()){let i;if(0==e.srcElement.files[0].length)return this.DisplayMessage=n.a.GetResource("File_NoPhoto"),void(this.MessageVisibility=!0);if(!e.srcElement.files[0].type.match("image"))return this.DisplayMessage=n.a.GetResource("File_NoPhoto"),void(this.MessageVisibility=!0);i=e.target.files[0].name.split("."),i.length>1&&(this.FileExtension=i[i.length-1]),this.AccountPhoto=e.target.files[0].name;let s=e.target.files[0];const a=new FileReader;a.onload=e=>{const i=new Image;i.src=e.target.result,i.onload=i=>{this.ImgFile=e.target.result,t.srcElement.value=""}},a.readAsDataURL(s),setTimeout(()=>{this.getGuid(s)},100),this.IsPhotoChanged=!0}else if("ShowApprove"==t.toString()){let t=new V.a(94,this.TntObj.TenantID,this.ScreenObject,this);n.a.page.ShowDialog(t,E.a,{ShowCenter:!0,Title:n.a.GetResource("ApproveReject")})}else if("Print"==t.toString())this.DisplayMessage="Please Wait Printing Data...",n.a.report.ExportPDF_Masters(94,this.TenantID.toString(),0,"PDF").subscribe(t=>{console.log(t),n.a.SessionManager.Download(t.FileName,"Print"),a.e.IsEmpty(t.Message)&&!a.e.IsEmpty(t.FileName)&&(this.DisplayMessage="Exported Successfully")},t=>{console.log(t)});else if("Preview"==t.toString())this.DisplayMessage="Please Wait Printing Data...",n.a.report.ExportPDF_Masters(94,this.TenantID.toString(),0,"PDF").subscribe(t=>{console.log(t),n.a.SessionManager.Download(t.FileName,"Preview"),a.e.IsEmpty(t.Message)&&!a.e.IsEmpty(t.FileName)&&(this.DisplayMessage="Exported Successfully")},t=>{console.log(t)});else if("Save"==t.toString())try{let t=this.ScreenObject.ValidateData();if(!a.e.IsEmpty(t))return this.DisplayMessage=t,void(this.MessageVisibility=!0);if(this.IsAttachmentMandatory&&null!=this.ViewAttachments){let t=0;if(this.ViewAttachments.AttachmentsList.length>0&&this.ViewAttachments.AttachmentsList.forEach(e=>{e.IsProductImage||t++}),0==t)return this.DisplayMessage="Attachment is mandatory",void(this.MessageVisibility=!0)}if(!this.ScreenObject.ValidateDataonSave())return;this.TntObj.Code=this.txtCode.Text,this.Type.Enable&&(this.TntObj.TypeID=this.Type.SelectedValue),this.Position.Enable&&(this.TntObj.PositionID=this.Position.SelectedValue),this.TntObj.FirstName=this.FstName.Text,this.TntObj.MiddleName=this.MdlName.Text,this.TntObj.LastName=this.LstName.Text,this.TntObj.LeaseSignatory=this.LeaseSignatory.Text,this.TntObj.ContactPerson=this.ContactPerson.Text,this.Posting.Enable&&(this.TntObj.PostingID=this.Posting.SelectedValue),this.TntObj.Phone1=this.Phone1.Text,this.TntObj.Phone2=this.Phone2.Text,this.TntObj.Email=this.Email.Text,this.TntObj.Fax=this.Fax.Text,this.TntObj.IDNumber=this.IDNumber.Text,this.TntObj.Profession=this.Profession.Text,this.txtCode.Visible&&this.txtCode.Enable||(this.TntObj.Code=this.txtCode.Text),this.Type.Visible&&this.Type.Enable||(this.TntObj.TypeID=this.Type.SelectedValue),this.Position.Visible&&this.Position.Enable||(this.TntObj.PositionID=this.Position.SelectedValue),this.FstName.Visible&&this.FstName.Enable||(this.TntObj.FirstName=this.txtCode.Text),this.MdlName.Visible&&this.MdlName.Enable||(this.TntObj.MiddleName=this.txtCode.Text),this.LstName.Visible&&this.LstName.Enable||(this.TntObj.LastName=this.txtCode.Text),this.Posting.Visible&&this.Posting.Enable||(this.TntObj.PostingID=0),this.LeaseSignatory.Visible&&this.LeaseSignatory.Enable||(this.TntObj.LeaseSignatory=this.txtCode.Text),this.ContactPerson.Visible&&this.ContactPerson.Enable||(this.TntObj.ContactPerson=this.txtCode.Text),this.Phone1.Visible&&this.Phone1.Enable||(this.TntObj.Phone1=this.txtCode.Text),this.Phone2.Visible&&this.Phone2.Enable||(this.TntObj.Phone2=this.txtCode.Text),this.Email.Visible&&this.Email.Enable||(this.TntObj.Email=this.txtCode.Text),this.Fax.Visible&&this.Fax.Enable||(this.TntObj.Fax=this.txtCode.Text),this.IDNumber.Visible&&this.IDNumber.Enable||(this.TntObj.IDNumber=this.txtCode.Text),this.Profession.Visible&&this.Profession.Enable||(this.TntObj.Profession=this.txtCode.Text),this.TntObj.IsGroup=!1,this.TntObj.SelectedNodeId=this.Group.SelectedValue,this.TntObj.TabsData=this.getFields().Trim(","),this.TntObj.CustomFieldsQuery=this.ScreenObject.GetCustomFieldsQuery(),this.TntObj.CustomCostCenterFieldsQuery=this.ScreenObject.GetCustomCostCenterFieldsQuery(),this.TntObj.ActivityXml=this.ViewActivities.ActivitiesXML(),this.TntObj.NotesXML=this.ViewNotes.GetXML();try{this.TntObj.AttachmetsXML=this.ViewAttachments.GetXML();let t="";this.IsPhotoChanged&&!a.e.IsEmpty(this.AccountPhoto)?(t+=0==this.FileID?'<Row Action="NEW"':'<Row Action="MODIFY"',n.a.SessionManager.IsWebApplication?(t+=' AttachmentID="'+this.FileID+'"',t+=' FilePath="'+this.AccountPhoto+'"',t+=' ActualFileName="'+this.AccountPhoto.substr(this.AccountPhoto.lastIndexOf("\\")+1)+'"',t+=' RelativeFileName="'+this.AccountPhoto+'"',t+=' FileExtension="'+this.FileExtension+'"',t+=' FileDescription="'+d.d.GetValidXml(this.FileDescription)+'"',t+=' IsProductImage="1"',t+=' IsDefaultImage="1"',t+=' GUID="'+this.guid+'"',t+="/>"):(t+=' AttachmentID="'+this.FileID+'"',t+=' FilePath="'+this.AccountPhoto+'"',t+=' RelativeFileName="'+this.AccountPhoto+'"',t+=' FileExtension="'+this.FileExtension+'"',t+=' FileDescription="'+d.d.GetValidXml(this.FileDescription)+'"',t+=' IsProductImage="1"',t+=' IsDefaultImage="1"',t+=' GUID="'+this.guid+'"',t+="/>")):this.IsPhotoDelete&&this.FileID>0&&(t+='<Row Action="DELETE"',t+=' AttachmentID="'+this.FileID+'"/>'),t.length>0&&(t="<AttachmentsXML>"+t+"</AttachmentsXML>",this.TntObj.AttachmetsXML=this.TntObj.AttachmetsXML+t.toString())}catch(i){return this.DisplayMessage=n.a.GetResource("Upload_Path_notExists"),void(this.MessageVisibility=!0)}this.TntObj.PrimaryContactQuery=null!=this.PContact?this.PContact.GetXML():"",this.TntObj.ContactsXML=this.ViewContacts.GetXML(),this.TntObj.WID=this.ScreenObject.CheckWorkFlow(),n.a.rental.SaveTenant(this.TntObj,"SaveTenant").subscribe(t=>{this.DisplayMessage=t.Message,this.MessageVisibility=!0,this.RetValue=t.RetValue,this.RetValue>0&&(this.txtCode.Text="",this.FstName.Text="",this.MdlName.Text="",this.LstName.Text="",this.LeaseSignatory.Text="",this.Phone1.Text="",this.Phone2.Text="",this.Email.Text="",this.Fax.Text="",this.IDNumber.Text="",this.Profession.Text="",this.AutoGenerateCode(),this.ScreenObject.Clear(),this.ViewAttachments.AttachmentsListObj.Clear(),this.ViewContacts.ContactsListObj.Clear(),this.ViewContacts.DeletedContacts.Clear(),this.ViewNotes.NotesList.Clear(),this.ViewNotes.DeletedNotes.Clear(),null!=this.PContact&&this.PContact.ClearFields(),this.AccountPhoto="",this.PhotoTextVisibility=!0,this.ViewActivities.ActivityGridData.Clear(),this.ViewActivities.ActivityGridDataObj.Clear(),this.ActualFileName="",this.ParentId>0&&(this.Group.SelectedValue=this.ParentId))},t=>{console.log(" Unit Save : "+JSON.stringify(t))})}catch(s){Logger.ErrorLog("AddEditTenantViewModel:: OnSave : "+s.stack)}Logger.InfoLog("AddEditTenantViewModel:: Exiting OnSave")}getGuid(t){let e=new FormData;e.append("ImageUpload",t),e.append("FileUpload",t),e.append("UserName",n.a.SessionManager.UserID),n.a.common.UploadAttachments(e).subscribe(t=>{this.guid=t,this.guid=this.guid.split(".")[0],this.AccountPhoto=a.e.GetPath(this.guid+"."+this.FileExtension)},t=>{console.log("Error : "+JSON.stringify(t))})}}}}]);