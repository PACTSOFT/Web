(window.webpackJsonp=window.webpackJsonp||[]).push([[208,75,77,89,113,121,141,148,150,160,210,212],{EggS:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var a=s("Do2H"),i=s("Lp6j"),o=s("eQJW");class n{constructor(){this.CustomerID=0,this.CustomerTypeID=0,this.StatusID=0,this.AccountID=0,this.ParentID=0,this.SelectedNodeID=0,this.CodeNumber=0,this.IsGroup=!1,this.CreditDays=0,this.CreditLimit=0,this.DebitDays=0,this.Debitlimit=0,this.IsCode=!1,this.ActivityXml="",this.CCXML=""}SaveCustomerQuick(){try{let e=[];return e.push(this.CustomerID),e.push(null!=this.CustomerCode?this.CustomerCode:""),e.push(null!=this.CustomerName?this.CustomerName:""),e.push(this.StatusID),e.push(this.CodePrefix),e.push(this.CodeNumber),e.push(this.StaticFieldsQuery),e.push(this.CustomFieldsQuery),e.push(this.CustomCostCenterFieldsQuery),e.push(a.a.SessionManager.CompanyGUID),e.push(this.GUID),e.push(""),e.push(a.a.SessionManager.UserName),e.push(a.a.SessionManager.RoleID),e.push(a.a.SessionManager.LanguageID),a.a.crmService.SetCustomerQuick(e)}catch(e){return Logger.ErrorLog("Account:: SaveAccountQuick"+e.stack),""}}SaveCustomer(){Logger.InfoLog("Customer:: Inside SaveCustomer");try{0==this.CustomerID&&(this.GUID=i.e.NewGuid());let e=[];return e.push(this.CustomerID),e.push(null!=this.CustomerCode?this.CustomerCode:""),e.push(null!=this.CustomerName?this.CustomerName:""),e.push(null!=this.AliasName?this.AliasName:""),e.push(this.CustomerTypeID),e.push(this.StatusID),e.push(this.AccountID),e.push(this.SelectedNodeID),e.push(this.IsGroup),e.push(this.CreditDays),e.push(this.CreditLimit),e.push(null!=this.UserName?this.UserName:""),e.push(null!=this.Password?this.Password:""),e.push(null!=this.OnlineCustType?this.OnlineCustType:""),e.push(a.a.SessionManager.CompanyGUID),e.push(null!=this.GUID?this.GUID:"GUID"),e.push(""),e.push(a.a.SessionManager.UserName),e.push(this.CustomFieldsQuery),e.push(this.CustomCostCenterFieldsQuery),e.push(this.ContactsXML),e.push(this.AttachmetsXML),e.push(this.NotesXML),e.push(this.AddressXML),e.push(this.ActivityXml),e.push(this.CCXML),e.push(!1),e.push(null==this.PrimaryContactQuery?"":this.PrimaryContactQuery),e.push(a.a.SessionManager.RoleID),e.push(a.a.SessionManager.LanguageID),e.push(null!=this.CodePrefix?this.CodePrefix:""),e.push(this.CodeNumber),e.push(this.IsCode),a.a.crmService.SaveCustomer(e)}catch(e){return Logger.ErrorLog("Customer:: SaveCustomer"+e.stack),""}}GetCustomerDetails(){let e=a.a.crmService.GetCustomerInfo("?UserID="+a.a.SessionManager.UserID+"&RoleID="+a.a.SessionManager.RoleID+"&LangID="+a.a.SessionManager.LangID+"&CustomerID="+this.CustomerID);return!e.Columns[0].Contains("ErrorMessage")&&e.Tables.length>0&&e.Tables[0].length>0&&(this.CustomerID=parseInt(e.Tables[0][0].CustomerID),this.CustomerCode=i.e.String(e.Tables[0][0].CustomerCode),this.CustomerName=i.e.String(e.Tables[0][0].CustomerName),this.AliasName=i.e.String(e.Tables[0][0].AliasName),i.e.IsEmpty(e.Tables[0][0].CustomerTypeID)||(this.CustomerTypeID=parseInt(e.Tables[0][0].CustomerTypeID)),this.StatusID=parseInt(e.Tables[0][0].StatusID),i.e.IsEmpty(e.Tables[0][0].AccountID)||(this.AccountID=parseInt(e.Tables[0][0].AccountID)),this.IsGroup=Object(o.j)(e.Tables[0][0].IsGroup),i.e.IsEmpty(e.Tables[0][0].CreditDays)||(this.CreditDays=parseInt(e.Tables[0][0].CreditDays)),i.e.IsEmpty(e.Tables[0][0].CreditLimit)||(this.CreditLimit=parseFloat(e.Tables[0][0].CreditLimit)),this.ParentID=parseInt(e.Tables[0][0].ParentID),this.GUID=i.e.String(e.Tables[0][0].GUID),this.Description=i.e.String(e.Tables[0][0].Description),this.CodePrefix=i.e.String(e.Tables[0][0].CodePrefix),this.UserName=i.e.String(e.Tables[0][0].UserName),this.OnlineCustType=i.e.String(e.Tables[0][0].OnlineCustType),this.Password=i.e.String(e.Tables[0][0].Password),i.e.IsEmpty(e.Tables[0][0].CodeNumber)||(this.CodeNumber=parseInt(e.Tables[0][0].CodeNumber))),e}DeleteCustomer(e,t){try{let s=[];return s.push(e),s.push(t),s.push(a.a.SessionManager.RoleID),s.push(a.a.SessionManager.LanguageID),Logger.InfoLog("Customer:: Success: DBH.DeleteCustomer "+e.toString()),a.a.crmService.RemoveCustomer(s)}catch(s){return Logger.ErrorLog("LEAD::DeleteLead"+s.stack),""}}}},NM0h:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var a=s("Do2H"),i=s("Lp6j");class o{constructor(){this.ChangeValueXML=null,this.DetailsXML=null,this.AMCode=null,this.AMName=null,this.AMPurchaseValue=null,this.HistoryXML=null,this.DocNo=null,this.XML=null,this.DocSave=null,this.CodePrefix=null,this.Sno=null,this.AssetClassID=0,this.DeprBookID=0,this.AcqnCostACCID=0,this.AccumDeprACCID=0,this.AcqnCostDispACCID=0,this.AccumDeprDispACCID=0,this.GainsDispACCID=0,this.LossDispACCID=0,this.MaintExpenseACCID=0,this.DeprExpenseACCID=0,this.PostingGroupID=0,this.AMStatusID=0,this.CodeNumber=0,this.AMAssetID=0,this.AMParentAssetID=0,this.IsGroup=!1,this.Post=!1,this.StatusID=0,this.DeprBookMethod=0,this.DeprBookMethodBasedOn=0,this.AveragingMethodID=0,this.DeprScheduleID=0,this.DeprTypeID=0,this.AssetClassCode=null,this.AssetClassName=null,this.GUID=null,this.DeprBookCode=null,this.DeprBookName=null,this.PostGroupCode=null,this.PostGroupName=null,this.AMGUID=null,this.RecordType=null,this.AMGroup=!1,this.IsIncreaseAssetValue=!1,this.EmpName=null,this.EmpCode=null,this.EmpID=0,this.SelectedNodeID=0,this.PostCCID=0,this.PostAssetID=0,this.ScheduleID=0,this.LocationID=0,this.AddressXML=null,this.NotesXML=null,this.ContactsXML=null,this.CustomCostCenterFieldsQuery=null,this.CustomFieldsQuery=null,this.PrimaryContactQuery=null,this.AttachmetsXML=null,this.DepreciationXML=null,this.JVXML=null,this.Description=null,this.DeprStartValue=0,this.ChangeVal=0,this.AssetNetValueChange=0,this.DeprBookMethodBasedOnValue=0,this.TotalYears=0}static GetAssetClassDetails(e){let t=[];return t.push(e),t.push(a.a.SessionManager.UserID),t.push(a.a.SessionManager.LanguageID),a.a.accounting.GetAssetClassDetails(t)}static GetPostingGroupDetails(e){let t=[];return t.push(e),t.push(a.a.SessionManager.UserID),t.push(a.a.SessionManager.LanguageID),a.a.accounting.GetPostingGroupDetails(t)}SaveAssetClass(){0==this.AssetClassID&&(this.GUID=i.e.NewGuid());let e=[];return e.push(this.AssetClassID),e.push(null!=this.AssetClassCode?this.AssetClassCode:""),e.push(null!=this.AssetClassName?this.AssetClassName:""),e.push(this.PostingGroupID),e.push(this.DeprBookID),e.push(this.DeprTypeID),e.push(this.TotalYears),e.push(this.StatusID),e.push(a.a.SessionManager.CompanyGUID),e.push(this.GUID),e.push(""),e.push(a.a.SessionManager.UserName),e.push(a.a.SessionManager.UserID),e.push(a.a.SessionManager.LanguageID),a.a.accounting.SetAssetClass(e)}static GetDeprBookDetails(e){let t=[];return t.push(e),t.push(a.a.SessionManager.UserID),t.push(a.a.SessionManager.LanguageID),a.a.accounting.GetDeprBookDetails(t)}PostJVvoucher(){this.GUID=i.e.NewGuid();let e=[];return e.push(this.PostAssetID),e.push(this.PostCCID),e.push(this.JVXML),e.push(this.Post),e.push(this.DeprTypeID),e.push(this.DocXML),e.push(this.DocSave),e.push(this.DepreciationXML),e.push(this.RecordType),e.push(a.a.SessionManager.CompanyGUID),e.push(this.GUID),e.push(a.a.SessionManager.UserName),e.push(a.a.SessionManager.UserID),e.push(a.a.SessionManager.LanguageID),a.a.accounting.GetPostJvVoucher(e)}SetAssetDispose(e){this.GUID=i.e.NewGuid();let t=[];return t.push(this.PostAssetID),t.push(e.ToString("dd/MMM/yyyy")),t.push(this.PostCCID),t.push(this.JVXML),t.push(this.Post),t.push(this.DeprTypeID),t.push(this.DocXML),t.push(this.DocSave),t.push(this.DepreciationXML),t.push(this.RecordType),t.push(a.a.SessionManager.CompanyGUID),t.push(this.GUID),t.push(a.a.SessionManager.UserName),t.push(a.a.SessionManager.UserID),t.push(a.a.SessionManager.LanguageID),a.a.accounting.SetAssetDispose(t)}SaveDeprBook(e,t,s){0==this.DeprBookID&&(this.GUID=i.e.NewGuid());let o=[];return o.push(this.DeprBookID),o.push(this.DeprBookCode),o.push(this.DeprBookName),o.push(this.DeprBookMethod),o.push(this.DeprBookMethodBasedOn),o.push(this.DeprBookMethodBasedOnValue),o.push(this.StatusID),o.push(this.AveragingMethodID),o.push(e),o.push(t),o.push(s),o.push(a.a.SessionManager.CompanyGUID),o.push(this.GUID),o.push(""),o.push(a.a.SessionManager.UserName),o.push(a.a.SessionManager.UserID),o.push(a.a.SessionManager.LanguageID),a.a.accounting.SetDeprBook(o)}SaveFAPostingGroup(){0==this.PostingGroupID&&(this.GUID=i.e.NewGuid());let e=[];return e.push(this.PostingGroupID),e.push(this.PostGroupCode),e.push(this.PostGroupName),e.push(this.AcqnCostACCID),e.push(this.AccumDeprACCID),e.push(this.AcqnCostDispACCID),e.push(this.AccumDeprDispACCID),e.push(this.GainsDispACCID),e.push(this.LossDispACCID),e.push(this.MaintExpenseACCID),e.push(this.DeprExpenseACCID),e.push(this.StatusID),e.push(0),e.push(this.IsGroup),e.push(a.a.SessionManager.CompanyGUID),e.push(this.GUID),e.push(a.a.SessionManager.UserName),e.push(a.a.SessionManager.UserID),e.push(a.a.SessionManager.LanguageID),a.a.accounting.SetPostingGroup(e)}static GetAssetManagementDetails(e){let t=[];return t.push(e),t.push(a.a.SessionManager.UserID),t.push(a.a.SessionManager.LanguageID),a.a.accounting.GetAssetManagementDetails(t)}static GetAssetDeprSchDetails(e){let t=[];return t.push(e),t.push(a.a.SessionManager.UserID),t.push(a.a.SessionManager.LanguageID),a.a.accounting.GetAssetDeprSchDetails(t)}SetAssetManagementDetails(){let e=[];return e.push(this.AMAssetID),e.push(this.AMCode),e.push(this.AMName),e.push(this.AMStatusID),e.push(this.AMPurchaseValue),e.push(this.AMParentAssetID),e.push(this.AMGroup),e.push(this.CodePrefix),e.push(this.CodeNumber),e.push(this.Sno),e.push(this.DetailsXML),e.push(this.ChangeValueXML),e.push(this.CustomFieldsQuery),e.push(this.CustomCostCenterFieldsQuery),e.push(this.DepreciationXML),e.push(this.HistoryXML),e.push(this.NotesXML),e.push(this.AttachmetsXML),e.push(a.a.SessionManager.CompanyGUID),e.push(this.AMGUID),e.push(a.a.SessionManager.UserName),e.push(a.a.SessionManager.UserID),e.push(a.a.SessionManager.LanguageID),a.a.accounting.SetAssetManagementDetails(e).toPromise()}static DeleteAsset(e){let t=[];return t.push(e),t.push(a.a.SessionManager.UserID),t.push(a.a.SessionManager.RoleID),a.a.accounting.DeleteAsset(t)}static DeleteAssetDeprSchedule(e){let t=[];return t.push(e),t.push(a.a.SessionManager.RoleID),t.push(a.a.SessionManager.LanguageID),a.a.accounting.DeleteAssetDeprSchedule(t)}static DeleteAssetRefDoc(e,t){let s=[];return s.push(e),s.push(t),s.push(a.a.SessionManager.UserID),a.a.accounting.DeleteAssetRefDoc(s)}PostDeprJV(){this.GUID=i.e.NewGuid();let e=[];return e.push(this.PostCCID),e.push(this.JVXML),e.push(this.Post),e.push(a.a.SessionManager.CompanyGUID),e.push(this.GUID),e.push(a.a.SessionManager.UserName),e.push(a.a.SessionManager.UserID),e.push(a.a.SessionManager.LanguageID),e.push(a.a.SessionManager.RoleID),a.a.accounting.PostDeprJV(e)}PostDeprJVSummary(e,t,s,o,n){this.GUID=i.e.NewGuid();let r=[];return r.push(e),r.push(t),r.push(s),r.push(o),r.push(n),r.push(a.a.SessionManager.CompanyGUID),r.push(a.a.SessionManager.UserName),r.push(a.a.SessionManager.UserID),r.push(a.a.SessionManager.LanguageID),a.a.accounting.SetDeprPostingJVSummary(r).toPromise()}static SetsPostDeprReverseJV(e,t,s){let i=[];return i.push(e),i.push(t),i.push(s),i.push(a.a.SessionManager.CompanyGUID),i.push(a.a.SessionManager.UserName),i.push(a.a.SessionManager.UserID),i.push(a.a.SessionManager.LanguageID),a.a.accounting.SetsPostDeprReverseJV(i)}ChangeValue(e,t){this.GUID=i.e.NewGuid();let s=[];return s.push(this.PostAssetID),s.push(e),s.push(this.ChangeVal),s.push(this.AssetNetValueChange),s.push(t.ToString("dd/MMM/yyyy")),s.push(this.Description),s.push(this.DepreciationXML),s.push(this.ChangeValueXML),s.push(this.HistoryXML),s.push(this.LocationID),s.push(this.IsIncreaseAssetValue),s.push(this.JVXML),s.push(this.ChangeValueTypeID),s.push(a.a.SessionManager.CompanyGUID),s.push(this.GUID),s.push(a.a.SessionManager.UserName),s.push(a.a.SessionManager.UserID),s.push(a.a.SessionManager.LanguageID),a.a.accounting.SetAssetChangeValue(s)}DisposeReverse(e){let t=[];return t.push(e),t.push(a.a.SessionManager.UserName),t.push(a.a.SessionManager.UserID),t.push(a.a.SessionManager.LanguageID),a.a.accounting.DisposeReverse(t)}}},arqc:function(e,t,s){"use strict";s.r(t),s.d(t,"BRSViewModel",(function(){return f})),s.d(t,"BRSMatchViewModel",(function(){return G}));var a=s("Do2H"),i=s("Lp6j"),o=s("ScVY"),n=s("JIg3"),r=s("0/4Q"),l=s("8B8H"),h=s("ThYU"),u=s("Agar"),c=s("4HhE"),D=s("ockk"),d=s("eQJW"),p=s("n56n"),m=s("PDNK"),C=s("AGpa"),S=s("EQd/"),g=s("w8Sz");class I extends o.b{constructor(){super(),this._PstBalances=new l.a,this.ButtonClick=new c.b,this.LocationCheckedChanged=new c.b,this.IsQuit=!0,this.IsOK=!1,this.LockCheckedChanged=!1,this._BankAccounts=new p.b(0),this._FromDate=new n.a(0),this._ToDate=new n.a(0),this._rdoNone=!0,this._rdoChequeNo=!1,this._rdoVoucherNo=!1,this._BankBalance=new S.d,this.ClassName="BRSDialogViewModel"}get PstBalances(){return this._PstBalances}get Location(){return this._Location}set Location(e){this._Location!=e&&(this._Location=e)}get BankAccounts(){return this._BankAccounts}set BankAccounts(e){e!=this._BankAccounts&&(this._BankAccounts=e)}get FromDate(){return this._FromDate}set FromDate(e){e!=this._FromDate&&(this._FromDate=e)}get ToDate(){return this._ToDate}set ToDate(e){e!=this._ToDate&&(this._ToDate=e)}get Filter(){return this._Filter}set Filter(e){e!=this._Filter&&(this._Filter=e)}get rdoNone(){return this._rdoNone}set rdoNone(e){e!=this._rdoNone&&(e&&(this.rdoChequeNo=!1,this.rdoVoucherNo=!1),this._rdoNone=e)}get rdoChequeNo(){return this._rdoChequeNo}set rdoChequeNo(e){e!=this._rdoChequeNo&&(e&&(this.rdoNone=!1,this.rdoVoucherNo=!1),this._rdoChequeNo=e)}get rdoVoucherNo(){return this._rdoVoucherNo}set rdoVoucherNo(e){e!=this._rdoVoucherNo&&(e&&(this.rdoNone=!1,this.rdoChequeNo=!1),this._rdoVoucherNo=e)}get BankBalance(){return this._BankBalance}set BankBalance(e){e!=this._BankBalance&&(this._BankBalance=e)}get SortOn(){return this._SortOn}set SortOn(e){e!=this._SortOn&&(this._SortOn=e)}get BalancesVisiblity(){return this._BalancesVisiblity}set BalancesVisiblity(e){e!=this._BalancesVisiblity&&(this._BalancesVisiblity=e)}BRSDialogViewModel(){let e;if(Logger.InfoLog("BRSDialogViewModel:: Entering BRSDialogViewModel"),this.BankBalance.Label=a.a.GetResource("BRSBankBalance"),this.BankAccounts.Label=a.a.GetResource("Reports_BankName"),this.BankAccounts.OnPactListBoxValueChanged.Subscribe(this,"onListBoxValueChanged"),this.BankAccounts.CustomWhere="a.AccountTypeID in (2,3)",this.BankAccounts.CCID=2,this.BankAccounts.TypeID=2,this.BankAccounts.Refresh(),this.BankAccounts.SetTimeToZero(500),this.ToDate.SelectedDateChanged.Subscribe(this,"OnDateChanged"),this.FromDate.Label=a.a.GetResource("Reports_LblFromDate"),this.ToDate.Label=a.a.GetResource("Reports_LblToDate"),this.FromDate.Date=a.a.SessionManager.ReportsFromDate,this.DateRanges=g.a.getDateRanges(),this.DateRanges.SelectionChangedCommand.Subscribe(this,"OnDateRangesSelectionChanged"),this.InitGrid(),this.ForeignCurrency=new C.a,a.a.common.GetDataSet("PDDVM01","").Tables[0].forEach(e=>{this.ForeignCurrency.ComboBox.Items.push(r.d.ComboBoxItems_2(e.Name.toString(),e.CurrencyID.toString())),this.ForeignCurrency.ComboBox.Items.length>0&&(this.ForeignCurrency.ComboBox.SelectedValue=this.ForeignCurrency.ComboBox.Items[0].Value)}),this.ForeignCurrency.ComboBox.Enable=!1,this.ForeignCurrency.CheckBox.CheckedChangedCommand.Subscribe(this,"OnForeignCurrencySelectionChanged"),this.ForeignCurrency.CheckBox.Label="Foreign Currency",this.LocationCheckedChanged.Subscribe(this,"OnLocationCheckedChanged"),this.Location=new r.b(0),this.Location.Items.push(r.c.CheckedListBoxItem_6("All","All",!1,50002)),this.Location.Visible="True"==a.a.SessionManager.Preferences.EnableLocationWise.toString(),this.Location.Visible){let e=a.a.admin.getLocationRoles(["50002",a.a.SessionManager.LangID]),t=a.a.SessionManager.LocationWhere.split(",");if(null!=e&&e.Tables.length>0&&e.Tables[0].length>0)for(let s=0;s<e.Tables[0].length;s++)Object(d.j)(e.Tables[0][s].IsGroup.toString())||t.length>0&&t.Contains(e.Tables[0][s][e.Columns[0][0]].toString())&&(this.Location.Items.push(r.c.CheckedListBoxItem_6(e.Tables[0][s][e.Columns[0][2]].toString(),e.Tables[0][s][e.Columns[0][0]].toString(),!0,50002)),parseInt(this.Location.Items[this.Location.Items.length-1].Value)==a.a.SessionManager.LocationID&&(this.Location.Items[this.Location.Items.length-1].IsChecked=!0))}this.Filter=new m.b("Filter"),e=new m.a("All",-1,"Filter"),e.Group=this.Filter,e.Label=a.a.GetResource("ComLanguageAll"),this.Filter.Items.push(e),e=new m.a("Cleared",1,"Filter"),e.Group=this.Filter,e.Label=a.a.GetResource("Reports_Cleared"),this.Filter.Items.push(e),e=new m.a("Outstanding",0,"Filter"),e.Group=this.Filter,e.IsChecked=!0,e.Label=a.a.GetResource("Reports_Outstanding"),this.Filter.Items.push(e),this.Filter.IsHorizontalOrientation=!0,this.SortOn=new r.e,this.SortOn.Label=a.a.GetResource("Reports_LblSortOn"),this.SortOn.Items.push(r.d.ComboBoxItems_2("Date","Date")),this.SortOn.Items.push(r.d.ComboBoxItems_2("Account","Account")),this.SortOn.Items.push(r.d.ComboBoxItems_2("ChequeNo","ChequeNo")),this.SortOn.Items.push(r.d.ComboBoxItems_2("ChequeDate","ChequeDate")),this.SortOn.SelectedValue="Date",this.ButtonClick.Subscribe(this,"OnButtonClick");let t=a.a.admin.GetDefaultPDC(3),s=[];if(t.Tables.length>0&&(s=t.Tables[0]),null!=s&&s.length>0&&!i.e.IsEmpty(s[0].LastValueVouchers)){let e=new i.f;e.LoadXml(s[0].LastValueVouchers.toString()),e.SelectNodes("XML/Row").forEach(e=>{if(this.BankAccounts.SelectedValue=parseInt(e.attributes.Bank.value),null!=e.attributes.FromDate&&(this.FromDate.Date=new Date(e.attributes.FromDate.value)),null!=e.attributes.ToDate&&(this.ToDate.Date=new Date(e.attributes.ToDate.value)),this.BankAccounts.SelectedValue>0&&this.onListBoxValueChanged(null),null!=e.attributes.FCChecked&&(this.ForeignCurrency.CheckBox.IsChecked=Object(d.j)(e.attributes.FCChecked.value),this.ForeignCurrency.ComboBox.SelectedValue=e.attributes.FCID.value),"-1"==e.attributes.Filter.value?this.Filter.Items[parseInt(e.attributes.Filter.value)+1].IsChecked=!0:"0"==e.attributes.Filter.value?this.Filter.Items[parseInt(e.attributes.Filter.value)+2].IsChecked=!0:this.Filter.Items[parseInt(e.attributes.Filter.value)].IsChecked=!0,"CHK"==e.attributes.Group.value?(this.rdoNone=!1,this.rdoChequeNo=!0,this.rdoVoucherNo=!1):"VNO"==e.attributes.Group.value?(this.rdoNone=!1,this.rdoChequeNo=!1,this.rdoVoucherNo=!0):(this.rdoNone=!0,this.rdoChequeNo=!1,this.rdoVoucherNo=!1),this.SortOn.SelectedValue=e.attributes.SortOn.value,this.Location.Visible){let t=e.attributes.Locations.value.toString().split(",");for(let e=0;e<this.Location.Items.length;e++)for(let s=0;s<t.length;s++)this.Location.Items[e].Value.toString()==t[s].toString()&&(this.Location.Items[e].IsChecked=!0)}})}Logger.InfoLog("BRSDialogViewModel:: Entering BRSDialogViewModel")}InitGrid(){this.PstBalances.CanUserAddRows=!0,this.PstBalances.CanUserDeleteRows=!0,this.PstBalances.Width="",this.PstBalances.Table=[],this.PstBalances.TableColumns.push("Month"),this.PstBalances.TableColumns.push("Year"),this.PstBalances.TableColumns.push("ID"),this.PstBalances.DataTypes.Int.push("ID"),this.PstBalances.TableColumns.push("Balance"),this.PstBalances.DataTypes.Double.push("Balance"),this.PstBalances.TableColumns.push("Status"),this.PstBalances.Columns=[];let e=new D.a;e.Header=a.a.GetResource("BRSMonth"),e.ValueBinding="Month",e.Width=70,e.DataType="ComboBox",e.DisplayMember="Name",e.ValueMember="Value";let t=[];t.push(r.d.ComboBoxItems_2("JAN","1")),t.push(r.d.ComboBoxItems_2("FEB","2")),t.push(r.d.ComboBoxItems_2("MAR","3")),t.push(r.d.ComboBoxItems_2("APR","4")),t.push(r.d.ComboBoxItems_2("MAY","5")),t.push(r.d.ComboBoxItems_2("JUN","6")),t.push(r.d.ComboBoxItems_2("JUL","7")),t.push(r.d.ComboBoxItems_2("AUG","8")),t.push(r.d.ComboBoxItems_2("SEP","9")),t.push(r.d.ComboBoxItems_2("OCT","10")),t.push(r.d.ComboBoxItems_2("NOV","11")),t.push(r.d.ComboBoxItems_2("DEC","12")),e.ComboData=t,this.PstBalances.Columns.push(e),e=new D.a,e.Header=a.a.GetResource("BRSYear"),e.ValueBinding="Year",e.Width=70,e.DataType="ComboBox",e.DisplayMember="Name",e.ValueMember="Value",t=[];for(let i=a.a.SessionManager.AccountingDate.getFullYear();i<a.a.SessionManager.AccountingDate.getFullYear()+40;i++)t.push(r.d.ComboBoxItems_2(i.toString(),i.toString()));e.ComboData=t,this.PstBalances.Columns.push(e),e=new D.a,e.Header=a.a.GetResource("BRSBalance"),e.DisplayMember="Balance",e.Width=150,e.DataType="FLOAT",e.DecimalPoints=a.a.SessionManager.Preferences.DecimalsinAmount,this.PstBalances.Columns.push(e),e=new D.a,e.Header=a.a.GetResource("BRSStatus"),e.ValueBinding="Status",e.Width=70,e.DataType="ComboBox",e.DisplayMember="Name",e.ValueMember="Value",t=[],t.push(r.d.ComboBoxItems_2("Open","0")),t.push(r.d.ComboBoxItems_2("Close","1")),e.ComboData=t,this.PstBalances.Columns.push(e);let s=this.PstBalances.NewRow();this.PstBalances.addRow(s)}OnDateChanged(e){var t=this.PstBalances.Table.filter(e=>e.Year==this.ToDate.Date.getFullYear()&&e.Month==this.ToDate.Date.getMonth());t.length>0?this.BankBalance.Text=t[0].Balance.toString():this.PstBalances.Table.length>0&&this.PstBalances.Table.find(e=>e.ID>0)&&(this.BankBalance.Text="0")}onListBoxValueChanged(e){this.PstBalances.Table.Clear();let t=a.a.admin.BankStmtBalance(this.BankAccounts.SelectedValue,"",2,void 0);if(null!=t&&t.Tables.length>0)for(let s=0;s<t.Tables[0].length;s++){let e=this.PstBalances.NewRow();e.ID=t.Tables[0][s].ID.toString(),e.Month=t.Tables[0][s].Month.toString(),e.Year=t.Tables[0][s].Year.toString(),e.Balance=t.Tables[0][s].Balance.toString(),e.Status=t.Tables[0][s].Status.toString(),this.PstBalances.addRow(e)}this.OnDateChanged(null);for(let s=this.PstBalances.Table.length;s<25;s++){let e=this.PstBalances.NewRow();this.PstBalances.addRow(e)}}OnLocationCheckedChanged(e){if(!this.LockCheckedChanged&&e.item instanceof r.c){let t,s=e.item;if(t=this.Location,"All"==s.Value){this.LockCheckedChanged=!0;for(let e=1;e<t.Items.length;e++)t.Items[e].IsChecked=s.IsChecked;this.LockCheckedChanged=!1}else{if(this.LockCheckedChanged=!0,s.IsChecked){t.Items[0].IsChecked=!0;for(let e=1;e<t.Items.length;e++)if(!t.Items[e].IsChecked){t.Items[0].IsChecked=!1;break}}else t.Items[0].IsChecked=!1;this.LockCheckedChanged=!1}this.LockCheckedChanged=!1}}GetLocation(e,t){let s="";if(e.Visible){for(let t=1;t<e.Items.length;t++)e.Items[t].IsChecked&&(s.length>0&&(s+=","),s+=e.Items[t].Value);t&&(s.length>0?e.Items[0].IsChecked&&"1"==a.a.SessionManager.RoleID&&(s=""):s="-100")}return s}OnButtonClick(e){if("Cancel"==e.toString())a.a.page.HideDialog();else if("CancelSave"==e.toString())this.BalancesVisiblity=!1;else if("ShowBalances"==e.toString())this.BalancesVisiblity=!0;else if("Save"==e.toString()){if(0==this.BankAccounts.SelectedValue)return this.DisplayMessage=a.a.GetResource("SelectBankAccount"),void(this.MessageVisibility=!0);let e,t="";for(let s=0;s<this.PstBalances.Table.length;s++)i.e.IsEmpty(this.PstBalances.Table[s].Month)||i.e.IsEmpty(this.PstBalances.Table[s].Year)||i.e.IsEmpty(this.PstBalances.Table[s].Balance)||(t+='<ROW ID="',i.e.IsEmpty(this.PstBalances.Table[s].ID)?t+='0" ':t+=this.PstBalances.Table[s].ID.toString()+'" ',t+='Month="'+this.PstBalances.Table[s].Month.toString()+'" ',t+='Year="'+this.PstBalances.Table[s].Year.toString()+'" ',t+='Status="'+this.PstBalances.Table[s].Status.toString()+'" ',t+='Balance="'+this.PstBalances.Table[s].Balance.toString()+'" />');if(t.length>0){t="<XML>"+t,t+="</XML>";let s=a.a.admin.BankStmtBalance(this.BankAccounts.SelectedValue,t.toString(),1,e);s.Tables.length>0&&s.Columns[0].Contains("ErrorMessage")&&s.Tables[0].length>0&&(this.DisplayMessage=s.Tables[0][0].ErrorMessage.toString()),this.MessageVisibility=!0}}else if("SetAsDefault"==e.toString()){let e="";e+="<XML>",e+="<Row ",e+='Bank="'+this.BankAccounts.SelectedValue+'" ',e+='FromDate="'+this.FromDate.Date.ToString("dd/MMM/yyyy")+'" ',e+='ToDate="'+this.ToDate.Date.ToString("dd/MMM/yyyy")+'" ',null!=this.ForeignCurrency&&(e+='FCChecked="'+this.ForeignCurrency.CheckBox.IsChecked+'" ',e+='FCID="'+(i.e.IsEmpty(this.ForeignCurrency.ComboBox.SelectedValue)?"0":this.ForeignCurrency.ComboBox.SelectedValue)+'" '),e+='Filter="'+this.Filter.CheckedItem.FeatureID+'" ',e+=this.rdoNone?'Group="" ':this.rdoChequeNo?'Group="CHK" ':'Group="VNO" ',e+='Locations="'+this.GetLocation(Location,!1)+'" ',e+='SortOn="'+this.SortOn.SelectedValue+'" ',e+="/>",e+="</XML>";let t=0;a.a.admin.SetDefaultPDC(e.toString(),!0,3,t)}else if("Reset"==e.toString())a.a.admin.SetDefaultPDC("",!0,3,0),this.BankAccounts.SelectedValue=0,this.Location.Items.length>0&&this.Location.Items.forEach(e=>{e.IsChecked=!1});else if("OK"==e.toString())try{if(0==this.BankAccounts.SelectedValue)return this.DisplayMessage=a.a.GetResource("SelectBankAccount"),void(this.MessageVisibility=!0);if(this.DisplayMessage=this.BankBalance.ValidateData(),""!=this.DisplayMessage)return void(this.MessageVisibility=!0);this.DisplayMessage="",this.MessageVisibility=!1,this.IsQuit=!1,this.IsOK=!0,this.GroupByColumn=this.rdoNone?"":this.rdoChequeNo?"CHK":"VNO",a.a.page.HideDialog()}catch(t){}}OnDateRangesSelectionChanged(e){null!=this.DateRanges.SelectedValue&&g.a.SetDateRanges(this.DateRanges.SelectedValue,this.FromDate,this.ToDate)}OnForeignCurrencySelectionChanged(e){this.ForeignCurrency.ComboBox.Enable=!this.ForeignCurrency.ComboBox.Enable}}var b=s("QXvR"),y=s("CUWK"),B=s("YU11"),M=s("ZDA+"),R=s("8mzQ"),T=s("Iab2");class f extends o.b{constructor(e){super(),this.ButtonClick=new c.b,this.ClearanceInfo=new c.b,this._DetailsVisibility=!0,this._CanClick=!0,this._ClearanceVisibility=!1,this._ClearanceDate=new n.a(0),this._Status=new r.e,this.oReportViewModel=null,this.GroupChequeNos=!1,this.dvStatus=null,this.Locations="",this.tempcol=[],this.workerloadData=new c.a,this.DontPopulateClearanceDate=!1,this.NetClearedBalance=0,this.outdr=0,this.outcr=0,this.Netcr=0,this.Netdr=0,this.LockWhere="",this.ClassName="BRSViewModel",this.Title=this.ScreenName=e,this.Title=this.ScreenName,this.BRSViewModel(e)}get DetailsVisibility(){return this._DetailsVisibility}set DetailsVisibility(e){e!=this._DetailsVisibility&&(this._DetailsVisibility=e,this.ClearanceVisibility=!e)}get CanClick(){return this._CanClick}set CanClick(e){e!=this._CanClick&&(this._CanClick=e)}get ClearanceVisibility(){return this._ClearanceVisibility}set ClearanceVisibility(e){e!=this._ClearanceVisibility&&(this._ClearanceVisibility=e)}get ClearanceDate(){return this._ClearanceDate}set ClearanceDate(e){e!=this._ClearanceDate&&(this._ClearanceDate=e)}get Status(){return this._Status}set Status(e){e!=this._Status&&(this._Status=e)}get SelectedVoucher(){return this._SelectedVoucher}set SelectedVoucher(e){e!=this._SelectedVoucher&&(this._SelectedVoucher=e)}get Title(){return this._Title}set Title(e){e!=this._Title&&(this._Title=e)}get SubTitle(){return this._SubTitle}set SubTitle(e){e!=this._SubTitle&&(this._SubTitle=e)}get Table(){return this._Table}set Table(e){e!=this._Table&&(this._Table=e)}BRSViewModel(e){Logger.InfoLog("BRSViewModel::Entering BRSViewModel"),a.a.SessionManager.IsWebApplication&&(this.BRDDialog=new I,this.BRDDialog.BRSDialogViewModel(),a.a.page.ShowDialog(this.BRDDialog,b.a,{ShowCenter:!a.a.IsMobile,NoWidth:!0,Title:a.a.GetResource("Reports_BankReconciliation")}).subscribe(()=>{this.BRDDialog.IsOK&&(this.DetailsVisibility=!0,this.Title=this.ScreenName=e,this.MessageVisibility=!1,this.DisplayMessage="",this.ButtonClick.Subscribe(this,"OnButtonClick"),this.ClearanceInfo.Subscribe(this,"onClearanceInfo"),this.Title=this.ScreenName,this.DisplayName=this.ScreenName,this.ClearanceDate.Label="Clearance Date",this.InitControls())})),Logger.InfoLog("BRSViewModel::Exiting BRSViewModel")}onClick(){null==this.BRSGrid.SelectedItem||i.e.IsEmpty(this.BRSGrid.SelectedItem.CostCenterID)||y.RibbonExtViewModel.LoadDocument(this.BRSGrid.SelectedItem)}InitControls(){let e;this.NetBalance=new u.a,this.OutStandingDr=new u.a,this.OutStandingCr=new u.a,this.NetClearBalance=new u.a,this.Difference=new u.a,this.BankBalance=new u.a,this.NetBalance.Label="Ledger Balance",this.OutStandingDr.Label=a.a.GetResource("Reports_OutStandingDr"),this.OutStandingCr.Label=a.a.GetResource("Reports_OutStandingCr"),this.NetClearBalance.Label="Reconciled Bank Balance",this.Difference.Label="Variance",this.BankBalance.Label="Entered Statement Balance",this.BRSGrid=new l.a,this.BRSGrid.Columns=[],this.BRSGrid.BeginEdit.Subscribe(this,"OnBeginEdit"),this.BRSGrid.CanUserSortColumns=!1,this.BRSGrid.CellEditEnding.Subscribe(this,"OnCellEditEnding"),this.BRSGrid.Width="810",this.BRSGrid.CalcTotalsOnDataView=!0,this.BRSGrid.Height=void 0,this.tempcol=[];let t=[];if(a.a.SessionManager.Preferences.ContainsKey("BRS Screen Widths")&&""!=a.a.SessionManager.Preferences["BRS Screen Widths"]){let t=new i.f;t.LoadXml(a.a.SessionManager.Preferences["BRS Screen Widths"]);for(let s=0;s<t.DocumentElement.childNodes.length;s++){let a=t.DocumentElement.children[s];"CHECKBOX"==a.attributes.Header.value?"DontPopulateClearanceDate"==a.attributes.Name.value&&(this.DontPopulateClearanceDate=1==parseInt(a.attributes.WIDTH.value)):(e=new D.a,e.Header=a.attributes.Header.value,e.DisplayMember=a.attributes.Name.value,e.DisplayIndex=parseInt(a.attributes.index.value),e.Width=parseInt(a.attributes.WIDTH.value),this.tempcol.push(e))}}e=new D.a,e.Header=a.a.GetResource("Service_Sno"),e.DisplayMember="sno",e.ReadOnly=!0,e.Width=45;let s=this.tempcol.find(t=>t.DisplayMember==e.DisplayMember);null!=s?(e.DisplayIndex=s.DisplayIndex,e.Width=s.Width):this.tempcol.length>0&&(e.IsVisible=!1),this.BRSGrid.Columns.push(e),e=new D.a,e.Header=a.a.GetResource("Service_Date"),e.DisplayMember="CDate",e.DataType="DATE",e.ReadOnly=!0,e.Width=85,s=this.tempcol.find(t=>t.DisplayMember==e.DisplayMember),null!=s?(e.DisplayIndex=s.DisplayIndex,e.Width=s.Width):this.tempcol.length>0&&(e.IsVisible=!1),this.BRSGrid.Columns.push(e),e=new D.a,e.DisplayMember="VoucherNo",e.Header=a.a.GetResource("VPDesigner_VNo"),e.DataType="LINK",e.Click.Subscribe(this,"onClick"),e.Width=160,e.ReadOnly=!0,e.IsVisible=!0,s=this.tempcol.find(t=>t.DisplayMember==e.DisplayMember),null!=s?(e.DisplayIndex=s.DisplayIndex,e.Width=s.Width):this.tempcol.length>0&&(e.IsVisible=!1),this.BRSGrid.Columns.push(e),e=new D.a,e.Header=a.a.GetResource("Ticket_Account"),e.DisplayMember="Account",e.ReadOnly=!0,e.Width=160,s=this.tempcol.find(t=>t.DisplayMember==e.DisplayMember),null!=s?(e.DisplayIndex=s.DisplayIndex,e.Width=s.Width):this.tempcol.length>0&&(e.IsVisible=!1),this.BRSGrid.Columns.push(e),e=new D.a,e.Header="Narration",e.DisplayMember="CommonNarration",e.ReadOnly=!0,e.Width=160,s=this.tempcol.find(t=>t.DisplayMember==e.DisplayMember),null!=s?(e.DisplayIndex=s.DisplayIndex,e.Width=s.Width):this.tempcol.length>0&&(e.IsVisible=!1),this.BRSGrid.Columns.push(e),e=new D.a,e.Header=a.a.GetResource("Service_ChequeNo"),e.DisplayMember="ChequeNo",e.ReadOnly=!0,e.Width=90,s=this.tempcol.find(t=>t.DisplayMember==e.DisplayMember),null!=s?(e.DisplayIndex=s.DisplayIndex,e.Width=s.Width):this.tempcol.length>0&&(e.IsVisible=!1),this.BRSGrid.Columns.push(e),e=new D.a,e.Header=a.a.GetResource("Service_ChequeDate"),e.DisplayMember="ChqDate",e.DataType="DATE",e.ReadOnly=!0,e.Width=90,s=this.tempcol.find(t=>t.DisplayMember==e.DisplayMember),null!=s?(e.DisplayIndex=s.DisplayIndex,e.Width=s.Width):this.tempcol.length>0&&(e.IsVisible=!1),this.BRSGrid.Columns.push(e),e=new D.a,e.Header=a.a.GetResource("Amount_Dr"),e.DisplayMember="Dr",e.ReadOnly=!0,e.DataType="FLOAT",e.IsCalculated=1,e.ShowTotal=!0,e.Width=100,e.DecimalPoints=a.a.SessionManager.Preferences.DecimalsinAmount,s=this.tempcol.find(t=>t.DisplayMember==e.DisplayMember),null!=s?(e.DisplayIndex=s.DisplayIndex,e.Width=s.Width):this.tempcol.length>0&&(e.IsVisible=!1),this.BRSGrid.Columns.push(e),e=new D.a,e.Header=a.a.GetResource("Amount_Cr"),e.DisplayMember="Cr",e.ReadOnly=!0,e.DataType="FLOAT",e.IsCalculated=1,e.ShowTotal=!0,e.DecimalPoints=a.a.SessionManager.Preferences.DecimalsinAmount,e.Width=100,s=this.tempcol.find(t=>t.DisplayMember==e.DisplayMember),null!=s?(e.DisplayIndex=s.DisplayIndex,e.Width=s.Width):this.tempcol.length>0&&(e.IsVisible=!1),this.BRSGrid.Columns.push(e);let o=[];o.Columns=[],o.Columns.push("Name"),o.Columns.push("Value"),o.Columns.push("Status");let n=[];n.Name=a.a.GetResource("Reports_Outstanding"),n.Value=0,o.push(n),n=[],n.Name=a.a.GetResource("Reports_Cleared"),n.Value=1,o.push(n),n=[],n.Name=a.a.GetResource("Reports_AlreadyCleared"),n.Value=2,o.push(n),this.dvStatus=o,e=new D.a,e.Header=a.a.GetResource("Document_Status"),e.ValueBinding="Status",e.DataType="PactComboBox",e.DisplayMember="Name",e.ValueMember="Value",e.Width=90,e.ComboData=o,s=this.tempcol.find(t=>t.DisplayMember==e.ValueBinding),null!=s?(e.DisplayIndex=s.DisplayIndex,e.Width=s.Width):this.tempcol.length>0&&(e.IsVisible=!1),this.BRSGrid.Columns.push(e),e=new D.a,e.Header=a.a.GetResource("Reports_ClearanceDate"),e.DisplayMember="clrDate",e.ValueMember="clrDate_Key",e.DataType="DATE",e.ReadOnly=!1,e.Width=105,s=this.tempcol.find(t=>t.DisplayMember==e.DisplayMember),null!=s?(e.DisplayIndex=s.DisplayIndex,e.Width=s.Width):this.tempcol.length>0&&(e.IsVisible=!1),this.BRSGrid.Columns.push(e),this.LoadData(!0),t=this.BRSGrid.Columns,t.sort((e,t)=>e.DisplayIndex-t.DisplayIndex),this.BRSGrid.SearchVisible=!0,this.BRSGrid.FilterVisible=!0,this.BRSGrid.AddSearchCols()}OnBeginEdit(e){let t=e.args.item;if(a.a.SessionManager.Preferences.ContainsKey("BRSFromDate")&&""!=a.a.SessionManager.Preferences.BRSFromDate&&a.a.SessionManager.Preferences.ContainsKey("BRSToDate")&&""!=a.a.SessionManager.Preferences.BRSToDate&&""!=t.CDate_Key.toString()&&new Date(t.CDate_Key)>=new Date(a.a.SessionManager.Preferences.BRSFromDate)&&new Date(t.CDate_Key)<=new Date(a.a.SessionManager.Preferences.BRSToDate))e.args.Cancel=!0;else{if(""!=t.ClearanceDate.toString()&&this.BRDDialog.PstBalances.Table.filter(e=>1==e.Status&&e.Month==new Date(t.ClearanceDate).iMonth()&&e.Year==new Date(t.ClearanceDate).getFullYear()).length>0)return void(e.args.Cancel=!0);if("DataGridPactComboBoxColumn"==e.args.column.className){if("Status"==e.args.column.field){if("3"==t.BRS_Status.toString()||"1"==t.IsLock.toString())return void(e.args.Cancel=!0);e.Column.ItemsSource.RowFilter=!i.e.IsEmpty(t.ClearanceDate)&&new Date(t.ClearanceDate)>this.BRDDialog.ToDate.Date&&"1"==t.BRS_Status.toString()?"Value=2":"Value=1 or Value=0"}}else if(!("DataGridDateColumn"!=e.args.column.className&&"DataGridDateTimeColumn"!=e.args.column.className||"3"!=t.BRS_Status.toString()&&"1"!=t.IsLock.toString()))return void(e.args.Cancel=!0)}}Setselectedrow(e){this.BRSGrid.SelectedItem=this.BRSGrid.Table[e]}OnButtonClick(e){if(this.DisplayMessage="",e instanceof KeyboardEvent){if(e.keyCode==d.g.SPACE&&"PACT.VIEW.PactGridView"==e.toString()&&null!=this.BRSGrid.SelectedItem&&"2"!=this.BRSGrid.SelectedItem.Status_Key.toString()&&"1"!=this.BRSGrid.SelectedItem.IsLock.toString()){if(a.a.SessionManager.Preferences.ContainsKey("BRSFromDate")&&""!=a.a.SessionManager.Preferences.BRSFromDate&&a.a.SessionManager.Preferences.ContainsKey("BRSToDate")&&""!=a.a.SessionManager.Preferences.BRSToDate&&""!=this.BRSGrid.SelectedItem.CDate_Key.toString()&&new Date(this.BRSGrid.SelectedItem.CDate_Key)>=new Date(a.a.SessionManager.Preferences.BRSFromDate)&&new Date(this.BRSGrid.SelectedItem.CDate_Key)<=new Date(a.a.SessionManager.Preferences.BRSToDate))return;if(""!=this.BRSGrid.SelectedItem.ClearanceDate.toString()&&this.BRDDialog.PstBalances.Table.filter(e=>1==e.Status&&e.Month==new Date(this.BRSGrid.SelectedItem.ClearanceDate).iMonth()&&e.Year==new Date(this.BRSGrid.SelectedItem.ClearanceDate).getFullYear()).length>0)return;"1"==this.BRSGrid.SelectedItem.Status.toString()?(this.BRSGrid.SelectedItem.Status=0,this.BRSGrid.SelectedItem.Status_Key=a.a.GetResource("Reports_Outstanding")):(this.BRSGrid.SelectedItem.Status=1,this.BRSGrid.SelectedItem.Status_Key=a.a.GetResource("Reports_Cleared")),this.BRSGrid.updateRow(this.BRSGrid.SelectedItem)}}else{let s=e.toString();if("Save"==s.toString())this.Save();else if("Set"==s)this.Status.Items.Clear(),this.Status.Label="Status",this.Status.Items.push(r.d.ComboBoxItems_2(a.a.GetResource("Reports_Outstanding"),"0")),this.Status.Items.push(r.d.ComboBoxItems_2(a.a.GetResource("Reports_Cleared"),"1")),this.Status.Items.push(r.d.ComboBoxItems_2(a.a.GetResource("Reports_AlreadyCleared"),"2")),this.Status.SelectedValue=this.Status.Items[0].Value,this.DetailsVisibility=!1,this.ClearanceVisibility=!0;else if("DELETE"==s);else if("CLEAR"==s)this.BRSGrid.Table.forEach(e=>{e!=this.BRSGrid.Table[0]&&(""!=e.Status.toString()&&"0"!=e.Status.toString()||(e.Status="1",e.Status_Key=a.a.GetResource("Reports_Cleared"),e.clrDate_Key=e.Date,e.clrDate=new Date(e.Date).ToString(a.a.SessionManager.Preferences["Date Format"]),this.BRSGrid.updateRow(e)))});else if("Report"==s||"Preview"==s){null==this.oReportViewModel?(this.oReportViewModel=new h.ReportViewModel,this.oReportViewModel.ReportViewModel_1(72),a.a.page.addNewTab({component:B.ReportViewComponent,params:{obj:this.oReportViewModel}})):a.a.page.addNewTab({component:B.ReportViewComponent,params:{obj:this.oReportViewModel}}),this.oReportViewModel.oReportDialog.FromDate.Date=this.BRDDialog.FromDate.Date,this.oReportViewModel.oReportDialog.ToDate.Date=this.BRDDialog.ToDate.Date,this.oReportViewModel.FromDatePicker=this.BRDDialog.FromDate,this.oReportViewModel.ToDatePicker=this.BRDDialog.ToDate,this.oReportViewModel.DateFilter=this.SubTitle,this.oReportViewModel.oReportDialog.DefaultProperties.forEach(e=>{e instanceof p.b?e.SelectedValue=this.BRDDialog.BankAccounts.SelectedValue:"ForeignCurrency"==e.DBColumnName&&(e.CheckBox.IsChecked=this.BRDDialog.ForeignCurrency.CheckBox.IsChecked,e.ComboBox.SelectedValue=this.BRDDialog.ForeignCurrency.ComboBox.SelectedValue)}),this.BRDDialog.Location.Visible&&this.oReportViewModel.oReportDialog.Locations.Visible&&50002==this.oReportViewModel.oReportDialog.Locations.DBColumnID&&this.oReportViewModel.oReportDialog.Locations.Items.forEach(e=>{e.IsChecked=null!=this.BRDDialog.Location.Items.filter(t=>t.Value==e.Value&&t.IsChecked)});let e=new R.ACC_BRSReport(this.oReportViewModel);e.BankID=this.BRDDialog.BankAccounts.SelectedValue,e.DateWiseDrCr=!1;let o=0;this.BRDDialog.ForeignCurrency.CheckBox.IsChecked&&(o=i.e.IsEmpty(this.BRDDialog.ForeignCurrency.ComboBox.SelectedValue)?0:parseInt(this.BRDDialog.ForeignCurrency.ComboBox.SelectedValue)),this.oReportViewModel.ShowReport=!0;let n=new i.d;n.Enabled=!0,e.ViewModel.Preferences.ContainsKey("GroupBy")?e.ViewModel.Preferences.GroupBy=this.BRDDialog.GroupByColumn:e.ViewModel.Preferences.push("GroupBy",this.BRDDialog.GroupByColumn),e.ViewModel.Preferences.ContainsKey("Preview")&&e.ViewModel.Preferences.Remove("Preview"),"Preview"==s?(this.oReportViewModel.RefreshVisibility=!1,e.ViewModel.Preferences.push("Preview","true"),e.dtpreview=this.BRSGrid.Table.Copy()):e.ViewModel.Preferences.push("Preview","false");var t=e.ViewModel.oReportDialog.CostCenterFilters.find(e=>2==e.CostCenterID);if(t){t.SelectedNodes.Clear();let s=null;e.ViewModel.oReportDialog.tree.length>0&&2==e.ViewModel.oReportDialog.tree[0].CostCenterID&&(s=e.ViewModel.oReportDialog.tree[0].AllNodes.find(t=>t.Id==e.BankID)),s||(s=new M.a,s.Id=e.BankID,s.Text=[],s.Text.push("[FILTER]")),t.SelectedNodes.push(s),t.RefreshSelectedNodesText()}e.LoadReportFromData(e.BankID,o),this.oReportViewModel.StaticReportObject=e,n.Enabled=!1,Logger.InfoLog("OnButtonClick::Report::"+n.Elapsed.toString())}else if("Regenerate"==s)this.BRDDialog.IsOK=!1,this.DetailsVisibility=!0,this.BRDDialog=new I,this.BRDDialog.BRSDialogViewModel(),a.a.page.ShowDialog(this.BRDDialog,b.a,{ShowCenter:!a.a.IsMobile,NoWidth:!0,Title:a.a.GetResource("Reports_BankReconciliation")}).subscribe(()=>{this.BRDDialog.IsOK&&this.LoadData(!1)});else if("Refresh"==s)this.LoadData(!1);else if("Read"==s)this.onReadFile();else if("Export"==s){this.MessageVisibility=!0,this.DisplayMessage="Exporting data please wait...";let e=this.GetExportHTML(!1);const t=new Blob([e],{type:"text/plain;charser=utf-8"});T.saveAs(t,this.ScreenName+"_XlsExport_"+(new Date).getTime()+".xls")}}}onReadFile(){}OnCellEditEnding(e,t,s){if(t=e.column.field,e=e.item,("Status_Key"==t||i.e.hasprop(e,"Status_Key"))&&!i.e.IsEmpty(e.Status))if(0==parseInt(e.Status.toString())||this.DontPopulateClearanceDate){if(null!=e.clrDate_Key&&null!=e.clrDate_Key)return;e.clrDate_Key=null,e.clrDate=""}else 1==parseInt(e.Status.toString())&&i.e.IsEmpty(e.clrDate_Key)&&(e.clrDate_Key=e.Date,e.clrDate=new Date(e.Date).ToString(a.a.SessionManager.Preferences["Date Format"]));this.RefreshBalances()}onClearanceInfo(e){if(null!=e)if("Clearance"==e.toString()){if(null!=this.BRSGrid.SelectedRows&&this.BRSGrid.SelectedRows.length>1)for(let e=0;e<this.BRSGrid.SelectedRows.length;e++){const t=this.BRSGrid.SelectedRows[e];if(null!=t){let e=t.Row;if("2"!=e.Status.toString()){e.Status=this.Status.SelectedValue;let t=parseInt(this.Status.SelectedValue);e.Status_Key=this.Status.Items[t].Name,e.clrDate_Key=this.ClearanceDate.Date,e.clrDate=new Date(this.ClearanceDate.Date).ToString(a.a.SessionManager.Preferences["Date Format"]),this.BRSGrid.updateRow(e),this.RefreshBalances()}}}this.DetailsVisibility=!0}else this.DetailsVisibility=!0}workerloadData_RunWorkerCompleted(e,t){this.DisplayName=this.Title,this.CanClick=!0}LoadData(e){if(!a.a.SessionManager.IsActionAssigned(43,"Override BRS Lock")&&""==this.LockWhere&&"true"==a.a.SessionManager.Preferences.UseDimWiseLock.toLowerCase()&&""!=a.a.SessionManager.Preferences["DimensionWiseLockData Customize Screen"]&&"<XML></XML>"!=a.a.SessionManager.Preferences["DimensionWiseLockData Customize Screen"]){let e=0,t=new i.f;t.LoadXml(a.a.SessionManager.Preferences["DimensionWiseLockData Customize Screen"]);for(let s=0;s<t.SelectNodes("XML/Row").length;s++){let a=t.SelectNodes("XML/Row")[s];if(null!=a.attributes.ID&&!i.e.IsEmpty(a.attributes.ID.Value))if(e=parseInt(a.attributes.ID.Value),e>5e4)this.LockWhere+=" and (CC.dcCCNID"+(e-5e4)+"=c.CCNID"+(e-5e4)+" or c.CCNID"+(e-5e4)+"=1)";else{if(3==e)continue;2==e?this.LockWhere+=" and (D.DebitAccount=c.AccountID or D.CreditAccount=c.AccountID or c.AccountID=1)":400==e&&(this.LockWhere+=" and (D.CostCenterID=c.DocumentID or c.DocumentID=1)")}}}this.NetClearedBalance=0,this.outdr=0,this.outcr=0,this.Netcr=0,this.Netdr=0;let t=[];t.push(this.BRDDialog.BankAccounts.SelectedValue),t.push(i.e.String(this.BRDDialog.Filter.CheckedItem.FeatureID)),t.push(this.BRDDialog.FromDate.Date.ToString("dd/MMM/yyyy")),t.push(this.BRDDialog.ToDate.Date.ToString("dd/MMM/yyyy")),i.e.String(this.BRDDialog.Location.Visible)?t.push(this.BRDDialog.GetLocation(this.BRDDialog.Location,!1)):t.push(""),t.push(this.BRDDialog.ForeignCurrency.CheckBox.IsChecked?i.e.IsEmpty(this.BRDDialog.ForeignCurrency.ComboBox.SelectedValue)?0:parseInt(this.BRDDialog.ForeignCurrency.ComboBox.SelectedValue):0),t.push(0),t.push(this.LockWhere),t.push(this.BRDDialog.SortOn.SelectedValue),a.a.report.GetBRSVouchers(t).then(t=>{this.ds=t,this.SubTitle=this.BRDDialog.FromDate.Date.ToString(a.a.SessionManager.Preferences["Date Format"]),this.SubTitle+="  to  "+this.BRDDialog.ToDate.Date.ToString(a.a.SessionManager.Preferences["Date Format"]),null!=this.ds&&this.ds.Tables.length>3&&this.ds.Tables[3].length>0&&(this.SubTitle+=" ["+this.ds.Tables[3][0].AccountName.toString()+"]");let s=[];if(!(null!=this.ds&&this.ds.Tables.length>0&&this.ds.Tables.length>0&&this.ds.Columns[0].Contains("VoucherNo")))return;if(s=this.ds.Tables[0],e&&null!=this.ds&&this.ds.Tables.length>0&&this.ds.Columns[0].length>16)for(let e=17;e<this.ds.Columns[0].length;e++){let t=new D.a;var o;t.Header=this.ds.Tables[0][0][this.ds.Columns[0][e]],t.DisplayMember=this.ds.Tables[0][0][this.ds.Columns[0][e]],t.ReadOnly=!0,t.Width=160,this.ds.Columns[0][e].Contains("~")?(t.Header=this.ds.Columns[0][e].split("~")[1],null!=(o=this.tempcol.find(t=>t.DisplayMember==this.ds.Columns[0][e].split("~")[0]))?(t.DisplayIndex=o.DisplayIndex,t.Width=o.Width):this.tempcol.length>0&&(t.IsVisible=!1)):(t.Header=this.ds.Columns[0][e],null!=(o=this.tempcol.find(e=>e.DisplayMember==t.DisplayMember))?(t.DisplayIndex=o.DisplayIndex,t.Width=o.Width):this.tempcol.length>0&&(t.IsVisible=!1)),this.BRSGrid.Columns.push(t)}if(null!=this.ds&&this.ds.Tables.length>0&&this.ds.Tables.length>1&&this.ds.Columns[1].Contains("Bal")&&this.ds.Tables[1].length>0&&""!=i.e.StringValue(this.ds.Tables[1][0])){let e=parseFloat(this.ds.Tables[1][0][this.ds.Columns[1][0]]);this.NetBalance.Text=e>=0?e.Commas("N"+a.a.SessionManager.Preferences.DecimalsinAmount)+" "+a.a.GetResource("Dr"):(-e).Commas("N"+a.a.SessionManager.Preferences.DecimalsinAmount)+" "+a.a.GetResource("Cr")}this.NetClearedBalance=null!=this.ds&&this.ds.Tables.length>0&&this.ds.Tables.length>2&&this.ds.Columns[2].Contains("Bal")&&this.ds.Tables[2].length>0&&!i.e.IsEmpty(this.ds.Tables[2][0][this.ds.Columns[2][0]])?i.e.DoubleTryParse(this.ds.Tables[2][0][this.ds.Columns[2][0]]):0,s.Columns=[],s.Columns.push("StyleIsBold"),s.Columns.push("CDate"),s.Columns.push("ChqDate"),s.Columns.push("ChqDate_Key"),s.Columns.push("sno"),s.Columns.push("Status"),s.Columns.push("Status_Key"),s.Columns.push("clrDate"),s.Columns.push("clrDate_Key"),s.Columns.push("DBStatus"),s.Columns.push("GroupIDs");for(let e=0;e<s.length;e++)if(new Date(s[e].ClearanceDate).Date()>this.BRDDialog.ToDate.Date.Date()&&"1"==s[e].BRS_Status.toString()?(s[e].sno=e+1,s[e].CDate=new Date(s[e].Date).ToString(a.a.SessionManager.Preferences["Date Format"]),s[e].CDate_Key=new Date(s[e].Date),null!=s[e].ChequeDate&&(s[e].ChqDate=new Date(s[e].ChequeDate).ToString(a.a.SessionManager.Preferences["Date Format"]),s[e].ChqDate_Key=new Date(s[e].ChequeDate)),s[e].Status=2,s[e].Status_Key=a.a.GetResource("Reports_AlreadyCleared"),s[e].clrDate=new Date(s[e].ClearanceDate).ToString(a.a.SessionManager.Preferences["Date Format"]),s[e].clrDate_Key=new Date(s[e].ClearanceDate),s[e].DBStatus=1):(s[e].DBStatus=0,s[e].sno=e+1,s[e].CDate=new Date(s[e].Date).ToString(a.a.SessionManager.Preferences["Date Format"]),s[e].CDate_Key=new Date(s[e].Date),null!=s[e].ChequeDate&&(s[e].ChqDate=new Date(s[e].ChequeDate).ToString(a.a.SessionManager.Preferences["Date Format"]),s[e].ChqDate_Key=new Date(s[e].ChequeDate)),s[e].Status=s[e].BRS_Status,"1"==s[e].BRS_Status.toString()?s[e].Status_Key=a.a.GetResource("Reports_Cleared"):"0"==s[e].BRS_Status.toString()&&(s[e].Status_Key=a.a.GetResource("Reports_Outstanding"))),1900!=new Date(s[e].ClearanceDate).getFullYear()&&"1"==s[e].Status.toString()){s[e].clrDate_Key=new Date(s[e].ClearanceDate);try{s[e].clrDate=a.a.SessionManager.Preferences.ContainsKey("Date Format")&&""!=a.a.SessionManager.Preferences["Date Format"]?new Date(s[e].ClearanceDate).ToString(a.a.SessionManager.Preferences["Date Format"]):new Date(s[e].ClearanceDate).ToString("dd/MMM/yyyy")}catch(r){}}if(-1!=this.BRDDialog.Filter.CheckedItem.FeatureID){let e=s.length-1;for(;e>=0;e--)if(this.BRDDialog.Filter.CheckedItem.FeatureID!=parseInt(s[e].Status.toString())){let t=i.e.StringValue(s[e].Dr).length>0?parseFloat(s[e].Dr):0,a=i.e.StringValue(s[e].Cr).length>0?parseFloat(s[e].Cr):0;i.e.IsEmpty(s[e].ClearanceDate)&&this.BRDDialog.ToDate.Date.Date()<new Date(s[e].ClearanceDate).Date()||0==parseInt(s[e].Status)?(this.outcr+=a,this.outdr+=t):1==parseInt(s[e].Status)&&(this.Netcr+=a,this.Netdr+=t),0==this.BRDDialog.Filter.CheckedItem.FeatureID&&2==parseInt(s[e].Status)||s.RemoveAt(e)}}if(!this.BRDDialog.rdoNone){let e=[];for(let t=0;t<s.length;t++)if(!e.Contains(s[t])&&!this.BRDDialog.rdoNone){let a,o=0,n=0,r="",l="";if(this.BRDDialog.rdoChequeNo&&(i.e.IsEmpty(s[t].ChequeNo)||(l="ChequeNo='"+s[t].ChequeNo.toString().Replace("'","''")+"' and ")),l+="VoucherNo='"+s[t].VoucherNo.toString().Replace("'","''")+"' and BRS_Status="+s[t].BRS_Status.toString(),a=s.filter(l),a.length>1){for(let t=1;t<a.length;t++)i.e.IsEmpty(a[t].Dr)||(n+=parseFloat(a[t].Dr.toString())),i.e.IsEmpty(a[t].Cr)||(o+=parseFloat(a[t].Cr.toString())),r+=a[t].AccDocDetailsID.toString()+",",e.push(a[t]);a[0].GroupIDs=r,i.e.IsEmpty(a[0].Cr)||(o=parseFloat(a[0].Cr.toString())+o),i.e.IsEmpty(a[0].Dr)||(n=parseFloat(a[0].Dr.toString())+n),o>n?(a[0].Dr=null,a[0].Cr=o-n):(a[0].Cr=null,a[0].Dr=n-o)}}for(let t=0;t<e.length;t++)s.Remove(e[t])}this.BRSGrid.Table=s,1==this.BRDDialog.Filter.CheckedItem.FeatureID&&this.BRSGrid.Table.sort((e,t)=>e.clrDate_Key>t.clrDate_Key?1:-1),this.RefreshBalances();let n=[];n.Status=3,n.BRS_Status=3,this.NetClearedBalance>0?(n.Dr=this.NetClearedBalance.Commas("N"+a.a.SessionManager.Preferences.DecimalsinAmount),n.Cr=0):(n.Dr=0,n.Cr=this.NetClearedBalance.Commas("N"+a.a.SessionManager.Preferences.DecimalsinAmount)),n.VoucherNo="Opening",n.StyleIsBold="1",this.BRSGrid.Table.InsertAt(n,0);for(let e=0;e<this.BRSGrid.Table.length;e++)this.BRSGrid.Table[e].sno=e+1,this.BRSGrid.Table[e].id=e+1;s=[]})}Save(){this.DisplayMessage="";let e,t,s="",o=0;for(let a=0;a<this.BRSGrid.Table.length;a++){const n=this.BRSGrid.Table[a];if(""!=i.e.String(n.ClearanceDate)){if(o++,1==parseInt(i.e.String(n.Status))&&i.e.IsEmpty(n.clrDate_Key))return this.DisplayMessage="Clearance Date Mandatory when the Status is Cleared. Check at RowNo : "+o,void(this.MessageVisibility=!0);if(t=new Date(n.ClearanceDate),""==i.e.String(n.clrDate))e=t;else{if(e=new Date(n.clrDate_Key),!i.e.IsEmpty(n.ChqDate_Key)&&new Date(n.clrDate_Key)<new Date(n.ChqDate_Key))return this.DisplayMessage="Clearance Date is less than Cheque Date at RowNo : "+o,void(this.MessageVisibility=!0);if(new Date(n.clrDate_Key)<new Date(n.CDate_Key))return this.DisplayMessage="Clearance Date is less than Doc Date at RowNo : "+o,void(this.MessageVisibility=!0)}if(parseInt(n.BRS_Status)!=parseInt(n.Status)||t!=e){if("2"==i.e.String(n.Status))continue;if("0"!=i.e.String(n.DBStatus)&&"1"!=i.e.String(n.Status)||(s+='<Row ID="'+n.AccDocDetailsID.toString()+'" Status="'+n.Status.toString()+'" Date="'+e.ToString("dd MMM yyyy")+'"/>'),!i.e.IsEmpty(n.GroupIDs)&&!this.BRDDialog.rdoNone){let t=n.GroupIDs.toString().split(",");for(let a=0;a<t.length-1;a++)s+='<Row ID="'+t[a]+'" Status="'+n.Status.toString()+'" Date="'+e.ToString("dd MMM yyyy")+'"/>'}}}}if(s.length>0){s="<XML>"+s,s+="</XML>";let e=[];e.push(s.toString());let t=a.a.report.SetBRSVouchers(e);this.DisplayMessage=t.Message}}RefreshBalances(){let e,t,s=this.outcr,o=this.outdr,n=this.Netcr,r=this.Netdr;null!=this.BRSGrid.Table&&this.BRSGrid.Table.forEach(a=>{e=i.e.StringValue(a.Dr).length>0?parseFloat(a.Dr):0,t=i.e.StringValue(a.Cr).length>0?parseFloat(a.Cr):0,i.e.IsEmpty(a.clrDate_Key)&&this.BRDDialog.ToDate.Date.Date()<new Date(a.clrDate_Key)||0==parseInt(a.Status)?(o+=e,s+=t):1==parseInt(a.Status)&&(r+=e,n+=t)}),this.OutStandingDr.Text=o.Commas("N"+a.a.SessionManager.Preferences.DecimalsinAmount),this.OutStandingCr.Text=s.Commas("N"+a.a.SessionManager.Preferences.DecimalsinAmount);let l=0;i.e.IsEmpty(this.BRDDialog.BankBalance.Text)||(l=parseFloat(this.BRDDialog.BankBalance.Text)),this.BankBalance.Text=l>0?l.Commas("N"+a.a.SessionManager.Preferences.DecimalsinAmount)+" "+a.a.GetResource("Dr"):(-l).Commas("N"+a.a.SessionManager.Preferences.DecimalsinAmount)+" "+a.a.GetResource("Cr"),r=this.NetClearedBalance+r-n,this.Difference.Text=l-r>0?(l-r).Commas("N"+a.a.SessionManager.Preferences.DecimalsinAmount)+" "+a.a.GetResource("Dr"):(r-l).Commas("N"+a.a.SessionManager.Preferences.DecimalsinAmount)+" "+a.a.GetResource("Cr"),this.NetClearBalance.Text=r>=0?r.Commas("N"+a.a.SessionManager.Preferences.DecimalsinAmount)+" "+a.a.GetResource("Dr"):(-r).Commas("N"+a.a.SessionManager.Preferences.DecimalsinAmount)+" "+a.a.GetResource("Cr"),this.BRSGrid.UpdateTotals()}GetExportHTML(e){let t="",s="";t+="<html><meta charset='utf-8' /><body style='color:blac;background-color:white;'>",s+=".hdr{text-align:cente; padding:5px; background-color:#4F81BD;color:white;font-family:Arial;font-size:11pt} ",s+=".grp{padding:2p; background-color:#87CEEB; color:#FFFCF7;font-family:arial; font-size:10pt;}",s+=".tot{background-color:whit; color:red;font-family:arial; font-weight:bold; font-size:8pt;}",s+=".alt{background-color:whitesmok; color:black; font-family:arial; font-size:9pt; align:right;}",e||(t+="<style>"+s.toString()+"</style>");let o=0,n=this.BRSGrid.Table,r=this.BRSGrid.Columns;for(let a=0;a<r.length;a++)r[a].IsVisible&&r[a].Width>20&&(o+=r[a].Width);t+="<table>",t+="\r\n<tr><td align='center'><h2>",t+=a.a.SessionManager.CompanyName,t+="</h2></td></tr>",t+="\r\n<tr><td align='center'><h3 style='vertical-align:middl;'>",t+="Bank Reconciliation",t+="</h3></td></tr>",t+="\r\n<tr><td align='center'>",t+=" &nbsp;&nbsp;&nbsp;DATE :  "+(new Date).ToString(a.a.SessionManager.Preferences["Date Format"]),t+="</td></tr>",t+="<tr><td style='padding-top:10p;'><table border=1 width='"+o+"' style='border-collapse:collapse;  font-family:arial; font-size:9pt;' >",t+="<COLGROUP>";for(let a=0;a<r.length;a++)r[a].IsVisible&&r[a].Width>20&&(t+="FLOAT"==r[a].DataType?"<COL style='text-align:righ;'>":"<COL style=''>");t+="</COLGROUP>",t+="<tr style=''>";for(let a=0;a<r.length;a++)r[a].IsVisible&&r[a].Width>20&&(t+="<th class='hdr' width='"+r[a].Width,t+=e?"' >":"px' >",t+=r[a].Header,t+="</th>");t+="</tr>";for(let a=0;a<n.length;a++){t+="<tr",a%2==1&&(t+=" class=alt"),t+=">";for(let e=0;e<r.length;e++)r[e].IsVisible&&r[e].Width>20&&(t+="<td",t+="FLOAT"==r[e].DataType?" align='right'":" align='left'",t+=">",null!=r[e].ComboData&&"Status"==r[e].ValueBinding?(this.dvStatus.filter(t=>t.Value==n[a][r[e].ValueBinding].toString()),this.dvStatus.length>0&&(t+=i.e.String(this.dvStatus[0][r[e].DisplayMember]))):t+=i.e.String(n[a][r[e].DisplayMember]),t+="</td>");t+="</tr>"}return t+="</table>",t+="</td></tr></table>",t+="</body><html>",t}}class G extends f{BRSMatchViewModel(e){this.BRSMatchGrid=new l.a,this.initgrid(),this.BRSMatchGrid.SearchVisible=!0,this.BRSMatchGrid.AddSearchCols(),this.LoadGrid(),this.ButtonClick.Subscribe(this,"OnButtonClick")}OnButtonClick(e){"Regenerate"!=e&&"Refresh"!=e||this.LoadGrid()}initgrid(){this.BRSGrid.TableColumns.push("RefNo"),this.BRSGrid.TableColumns.push("UniqueNo"),this.BRSMatchGrid.Table=[],this.BRSMatchGrid.TableColumns.push("sno"),this.BRSMatchGrid.TableColumns.push("VoucherNo"),this.BRSMatchGrid.TableColumns.push("Account"),this.BRSMatchGrid.TableColumns.push("ChequeNo"),this.BRSMatchGrid.TableColumns.push("DocDate"),this.BRSMatchGrid.TableColumns.push("DocDate_Key"),this.BRSMatchGrid.TableColumns.push("ChequeDate"),this.BRSMatchGrid.TableColumns.push("Cr"),this.BRSMatchGrid.TableColumns.push("Dr"),this.BRSMatchGrid.TableColumns.push("CommonNarration"),this.BRSMatchGrid.TableColumns.push("DocID"),this.BRSMatchGrid.TableColumns.push("CostCenterID"),this.BRSMatchGrid.TableColumns.push("AccDocDetailsID"),this.BRSMatchGrid.TableColumns.push("ChequeDate_Key"),this.BRSMatchGrid.TableColumns.push("RefNo"),this.BRSMatchGrid.TableColumns.push("UniqueNo"),this.BRSMatchGrid.Columns=[];let e=new D.a;e.Header=a.a.GetResource("Service_Sno"),e.DisplayMember="sno",e.ReadOnly=!0,e.Width=45,this.BRSMatchGrid.Columns.push(e),e=new D.a,e.Header="VoucherNo",e.DisplayMember="VoucherNo",e.ReadOnly=!0,e.Width=100,this.BRSMatchGrid.Columns.push(e),e=new D.a,e.Header="Date",e.DisplayMember="DocDate",e.ReadOnly=!0,e.Width=100,this.BRSMatchGrid.Columns.push(e),e=new D.a,e.Header="Account",e.DisplayMember="Account",e.ReadOnly=!0,e.Width=150,this.BRSMatchGrid.Columns.push(e),e=new D.a,e.Header="ChequeNo",e.DisplayMember="ChequeNo",e.ReadOnly=!0,e.Width=100,this.BRSMatchGrid.Columns.push(e),e=new D.a,e.Header="ChequeDate",e.DisplayMember="ChequeDate",e.ReadOnly=!0,e.Width=100,this.BRSMatchGrid.Columns.push(e),e=new D.a,e.Header=a.a.GetResource("Amount_Cr"),e.DisplayMember="Cr",e.ReadOnly=!0,e.DataType="FLOAT",e.ShowTotal=!0,e.DecimalPoints=a.a.SessionManager.Preferences.DecimalsinAmount,e.Width=100,e.ShowTotal=!0,e.IsCalculated=1,this.BRSMatchGrid.Columns.push(e),e=new D.a,e.Header=a.a.GetResource("Amount_Dr"),e.DisplayMember="Dr",e.ReadOnly=!0,e.DataType="FLOAT",e.ShowTotal=!0,e.DecimalPoints=a.a.SessionManager.Preferences.DecimalsinAmount,e.Width=100,e.ShowTotal=!0,this.BRSMatchGrid.Columns.push(e),e=new D.a,e.Header="Narration",e.DisplayMember="CommonNarration",e.ReadOnly=!0,e.Width=160,this.BRSMatchGrid.Columns.push(e)}LoadGrid(){let e=this.ds.Tables[this.ds.Tables.length-1];for(let t=0;t<e.length;t++){let s=this.BRSMatchGrid.NewRow();s.sno=t+1,i.e.IsEmpty(e[t].ChequeDate)||(s.ChequeDate=new Date(e[t].ChequeDate).ToString(a.a.SessionManager.Preferences["Date Format"]),s.ChequeDate_Key=new Date(e[t].ChequeDate)),s.Cr=e[t].Cr,s.Dr=e[t].Dr,s.AccDocDetailsID=e[t].AccDocDetailsID,s.VoucherNo=e[t].VoucherNo,s.CommonNarration=e[t].CommonNarration,s.ChequeNo=e[t].ChequeNo,i.e.IsEmpty(e[t].DocDate)||(s.DocDate=new Date(e[t].DocDate),s.DocDate_Key=new Date(e[t].DocDate).ToString(a.a.SessionManager.Preferences["Date Format"])),s.Account=e[t].Account,s.DocID=e[t].DocID,s.CostCenterID=e[t].CostCenterID,this.BRSMatchGrid.addRow(s)}}}},ouML:function(e,t,s){"use strict";s.r(t),s.d(t,"DocumentDraftsViewModel",(function(){return c}));var a=s("mrSG"),i=s("Do2H"),o=s("Lp6j"),n=s("ScVY"),r=s("8B8H"),l=s("ockk"),h=s("rJVx"),u=s("CUWK");class c extends n.b{constructor(e,t,s=0){if(super(),this.Grid=new r.a,this.IsFromDocs=!1,this.PopupWidth=0,this.ReportType=0,this.Parent=null,this.CCID=0,this.WID=0,this.LevelID=0,this.PactGridVisible=!1,this.CCID=s,this.Parent=e,this.ReportType=t,this.Parent instanceof h.GeneralDashboardViewModel||"DashAddOnsViewModel"==this.Parent.ClassName)1==t&&(this.ColSource=h.GeneralDashboardViewModel.InitColumns("Document Drafts_DashBoardCustomize"));else{let e;1==t?this.DisplayName="Drafts":2==t?this.DisplayName="Hold Documents":3==t?this.DisplayName="Approval History":4==t&&(this.DisplayName="Level Info",this.PactGrid=new r.a),this.Title=this.DisplayName,this.IsFromDocs=!0,this.FillGrid(),this.Grid.OnLinkClick.Subscribe(this,"GridLinkClick"),this.ColSource=[],1==t?(this.ColSource=h.GeneralDashboardViewModel.InitColumns("Document Drafts_DashBoardCustomize"),this.PopupWidth=22,this.ColSource.forEach(e=>{this.PopupWidth=this.PopupWidth+e.Width})):2==t?(e=new l.a,e.DataType="TextBlock",e.Header="Hold Date",e.DisplayMember="HoldDate_Key",e.Width=100,this.ColSource.push(e),e=new l.a,e.DataType="LINK",e.Header=i.a.GetResource("DocName"),e.DisplayMember="DocName",e.Width=135,this.ColSource.push(e),e=new l.a,e.DataType="TextBlock",e.Header="NetValue",e.DisplayMember="NetValue",e.Width=100,this.ColSource.push(e),e=new l.a,e.DataType="TextBlock",e.Header="NoOfProducts",e.DisplayMember="NoOfProducts",e.Width=50,this.ColSource.push(e),e=new l.a,e.DataType="LINK",e.Header=i.a.GetResource("Delete"),e.DisplayMember="Delete",e.Width=100,this.ColSource.push(e),this.PopupWidth=450):3==t?(e=new l.a,e.DataType="TextBlock",e.Header="User",e.DisplayMember="CreatedBy",e.Width=90,this.ColSource.push(e),e=new l.a,e.DataType="TextBlock",e.Header="FirstName",e.DisplayMember="FirstName",e.Width=90,this.ColSource.push(e),e=new l.a,e.DataType="TextBlock",e.Header="LastName",e.DisplayMember="LastName",e.Width=90,this.ColSource.push(e),e=new l.a,e.DataType="TextBlock",e.Header="Email",e.DisplayMember="Email1",e.Width=150,this.ColSource.push(e),e=new l.a,e.DataType="TextBlock",e.Header=i.a.GetResource("Date"),e.DisplayMember="AppDate",e.Width=128,this.ColSource.push(e),e=new l.a,e.DataType="LINK",e.Header="Level",e.DisplayMember="LevelName",e.Width=93,this.ColSource.push(e),e=new l.a,e.DataType="TextBlock",e.Header="Status",e.DisplayMember="Status",e.Width=80,this.ColSource.push(e),e=new l.a,e.DataType="Format",e.Header="Remarks",e.DisplayMember="Remarks",e.Width=190,this.ColSource.push(e),this.PopupWidth=950,"AddEditDocumentViewModel"==this.Parent.ClassName&&(e=new l.a,e.Header="WorkFlowName",e.DisplayMember="WorkFlowName",e.Width=200,this.ColSource.push(e)),this.PopupWidth=950):4==t&&(e=new l.a,e.DataType="TextBlock",e.ReadOnly=!0,e.Header="User Name",e.DisplayMember="UserName",e.Width=120,this.ColSource.push(e),e=new l.a,e.DataType="TextBlock",e.ReadOnly=!0,e.Header="First Name",e.DisplayMember="FirstName",e.Width=120,this.ColSource.push(e),e=new l.a,e.DataType="TextBlock",e.ReadOnly=!0,e.Header="Last Name",e.DisplayMember="LastName",e.Width=120,this.ColSource.push(e),this.PactGrid.Columns=this.ColSource,this.PopupWidth=400)}}get Table(){return this.Grid.Table}set Table(e){this.Grid.Table=e}get TableColumns(){return this.Grid.TableColumns}set TableColumns(e){this.Grid.TableColumns=e}get ColSource(){return this.Grid.Columns}set ColSource(e){this.Grid.Columns=e}get SelectedRow(){return this.Grid.SelectedItem}set SelectedRow(e){this.Grid.SelectedItem=e}onClick(e){event.preventDefault(),null!=this.SelectedRow&&this.LoadDraft(this.SelectedRow)}FillGrid(){let e=0,t=null;if(o.e.IsType(this.Parent,"AddEditDocumentViewModel")?(t=this.Parent,e=0==this.CCID?t.CostCenterID:this.CCID):o.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName||(e=this.CCID),1==this.ReportType||2==this.ReportType){let s;s=o.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName?null==t||38!=t.ScreenObject.DocumentType&&39!=t.ScreenObject.DocumentType?i.a.document.GetDocumentDrafts(0,e,this.ReportType,!1):i.a.document.GetDocumentDrafts(t.ScreenObject.RegisterNodeID,e,this.ReportType,!1,!0):i.a.document.GetDocumentDrafts(0,this.Parent.CostCenterID,this.ReportType,!1),s.subscribe(e=>{this.Table=e.Tables[0],this.Grid.TableColumns.Contains("Date_Text")||(this.Grid.TableColumns.push("Date_Text"),this.Grid.TableColumns.push("Delete")),this.Grid.TableColumns.Contains("HoldDate_Key")||this.Grid.TableColumns.push("HoldDate_Key"),this.Table.forEach(e=>{e.Delete="Delete",e.id=i.a.slick.rowid,e.Date_Text=new Date(e.Date).ToString(i.a.SessionManager.Preferences["Date Format"]+" hh:mm a"),null!=e.HoldDate&&(e.HoldDate_Key=new Date(e.HoldDate).ToString(i.a.SessionManager.Preferences["Date Format"]))})})}else if(3==this.ReportType){let t=null;if(o.e.IsType(this.Parent,"AddEditDocumentViewModel")?(t=this.Parent.ScreenObject.GetDocStatusHistory(),t.Tables.length>1&&t.Tables[1].length>0&&t.Columns[1].Contains("WID")&&(this.WID=parseInt(t.Tables[1][0].WID))):o.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName?o.e.IsEmpty(this.Parent.ClassName)||"AddEditCasesViewModel"!=this.Parent.ClassName||(t=this.GetDocStatusHistory(73,this.Parent.CaseID,!1)):t=i.a.rental.GetHistory(e,this.Parent.ContractID),null!=t&&t.Tables.length>0){this.Table=t.Tables[0],this.Grid.TableColumns.push("AppDate");for(let t=0;t<this.Table.length;t++)""!=this.Table[t].Date.toString()&&(this.Table[t].AppDate=new Date(this.Table[t].Date.toString()).ToString(i.a.SessionManager.Preferences["Date Format"]+" hh:mm a"));let e=0,s=0;this.Table.length>0&&(e=o.e.IntTryParse(this.Table[this.Table.length-1].WorkFlowLevel.toString()),s=o.e.IntTryParse(this.Table[this.Table.length-1].StatusID.toString())),369!=s&&(t.Tables[1]=t.Tables[1].filter(t=>t.levelID>e),t.Tables[1].forEach(e=>{let t=this.Grid.NewRow();t.LevelName=e.LevelName,t.Status="Pending",t.WorkFlowLevel=e.LevelID,this.Grid.addRow(t)}));for(let t=this.Table.length;t<7;t++)this.Grid.addEmptyRow()}}else if(4==this.ReportType){let e=null;if("WFLevelDoc"==this.Parent.ClassName?e=i.a.SessionManager.Preferences.ContainsKey("CanApproveFunction")&&"True"==i.a.SessionManager.Preferences.CanApproveFunction?i.a.report.GetExtWFDet(this.Parent.WID,this.Parent.LevelID,this.Parent.ccid,this.Parent.DOcId):i.a.report.GetWorkFlowLevelDetails(this.Parent.WID,this.Parent.LevelID,this.Parent.ccDate):this.Parent instanceof c&&(i.a.SessionManager.Preferences.ContainsKey("CanApproveFunction")&&"True"==i.a.SessionManager.Preferences.CanApproveFunction?"AddEditDocumentViewModel"==this.Parent.Parent.ClassName?e=i.a.report.GetExtWFDet(this.Parent.WID,this.Parent.LevelID,this.Parent.Parent.CostCenterID,this.Parent.Parent.ScreenObject.DocID):"ReportViewModel"==this.Parent.Parent.ClassName&&"INV_ComparisonReport"==this.Parent.Parent.StaticReportObject&&(e=i.a.report.GetExtWFDet(this.Parent.WID,this.Parent.LevelID,this.Parent.Parent.StaticReportObject.QuotationDocument,this.Parent.Parent.StatusDocID)):e=i.a.report.GetWorkFlowLevelDetails(this.Parent.WID,this.Parent.LevelID,"AddEditDocumentViewModel"==this.Parent.Parent.ClassName?this.Parent.Parent.ScreenObject.DocDate.Date:Date.Today())),null!=e){for(let t=e.Tables[0].length;t<8;t++)e.Tables[0].push();this.PactGrid.Table=e.Tables[0]}this.PactGrid.Width="",this.PactGrid.SearchVisible=!0,this.PactGrid.SearchCols.Width="85",this.PactGrid.SearchOptions.Width="90",this.PactGrid.SearchText.Width="110",this.PactGridVisible=!0}}GetDocStatusHistory(e,t,s){Logger.InfoLog("DocumentDraftsViewModel:: Inside GetDocStatusHistory");let a=[];a.push(e),a.push(t),a.push(s),a.push(i.a.SessionManager.UserID),a.push(i.a.SessionManager.LanguageID);let o=i.a.document.GetDocStatusHistory(a);return Logger.InfoLog("DocumentDraftsViewModel:: Exiting GetDocStatusHistory"),o}OnButtonClick(e){"Cancel"==e.toString()&&(o.e.IsType(this.Parent,"AddEditDocumentViewModel")&&this.CCID>0&&(this.Parent.res="No"),i.a.page.HideDialog())}DeleteDraft(e){let t;t=o.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName?i.a.document.DeleteDocumentDraft(parseInt(e.DraftID)):i.a.rental.DeleteQuotation(parseInt(e.CostCenterID),parseInt(e.DraftID)),t.RetValue>0&&this.Grid.removeRow(e)}LoadDraft(e){return Object(a.b)(this,void 0,void 0,(function*(){if(o.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName){const{AddEditDocumentViewModel:t}=yield Promise.all([s.e(2),s.e(1),s.e(3),s.e(5),s.e(4),s.e(6),s.e(7),s.e(10),s.e(9),s.e(12),s.e(11),s.e(13),s.e(19),s.e(15),s.e(21),s.e(20),s.e(16),s.e(14),s.e(18),s.e(17),s.e(22),s.e(89)]).then(s.bind(null,"1Cra")),{AddEditDocumentComponent:a}=yield Promise.all([s.e(4),s.e(6)]).then(s.bind(null,"MCKn"));let o,n;n=i.a.document.GetDocumentDrafts(parseInt(e.DraftID),0,1,!1),n.subscribe(s=>{if(o=s.Tables[0],null!=o&&o.length>0)if("AddEditDocumentViewModel"==this.Parent.ClassName||"POSDocumentViewModel"==this.Parent.ClassName)this.CCID>0||(this.Parent.clear(1),this.Parent.LoadDraftXML(o[0]),i.a.page.HideDialog(),this.Parent.ScreenObject.GridDataObj.RefreshGridView());else{let s=1==this.ReportType,n=new t(parseInt(e.CostCenterID),e.Type.toString(),s);i.a.page.addNewTab({component:a,params:{obj:n}}),n.LoadDraftXML(o[0],s)}})}else u.RibbonExtViewModel.LoadDraftRentalContract(this.Parent,parseInt(e.DraftID)),i.a.page.HideDialog()}))}GridLinkClick(e,t,s){event.preventDefault(),"Delete"==t?this.DeleteDraft(e):"Date_Text"!=t&&"DocName"!=t||this.LoadDraft(e)}}},rJVx:function(e,t,s){"use strict";s.r(t),s.d(t,"GeneralDashboardViewModel",(function(){return u}));var a=s("mrSG"),i=s("Do2H"),o=s("Lp6j"),n=s("ScVY"),r=s("NkMH"),l=s("ockk"),h=s("JIg3");class u extends n.b{constructor(){super(),this.ButtonPDC=new r.a,this.timerdashboard=new o.d,this.Date=new h.a(0),this.tdMaximize=new Array(4).fill(!1),Logger.InfoLog("DashboardViewModel::Entering DashboardViewModel"),this.timerdashboard.Enabled=!0,this.timerdashboard.Interval=6e4,i.a.SessionManager.IsWebApplication||this.timerdashboard.Elapsed(this,"timerdashboard_Elapsed"),this.DisplayName=i.a.GetResource("Dashboard_Maindashboard"),this.loadDrafts(),Logger.InfoLog("DashboardViewModel::Exiting DashboardViewModel")}loadDrafts(){return Object(a.b)(this,void 0,void 0,(function*(){const{DocumentDraftsViewModel:e}=yield s.e(150).then(s.bind(null,"ouML"));this.DocumentDrafts=new e(this,1),setTimeout(()=>{this.DocumentDrafts.FillGrid()},500);const{UnAppDocumentsViewModel:t}=yield s.e(0).then(s.bind(null,"AyOk"));this.UnApprovedDocuments=new t;const{DashBoardNotifViewModel:a}=yield Promise.all([s.e(2),s.e(1),s.e(5),s.e(26),s.e(42),s.e(0),s.e(73)]).then(s.bind(null,"Wh9R"));this.NotifEvents=new a(2),this.PDCDocuments=new a(4)}))}timerdashboard_Elapsed(e,t){i.a.page.isActiveTab(this)&&(this.OnButtonClick("RefreshPDC"),this.OnButtonClick("RefreshEvents"),this.NotifEvents.RefreshData(),this.UnApprovedDocuments.OnLoad())}OnButtonClick(e){"PostPDC"==e||("RefreshPDC"==e?(this.PDCDocuments.EventsType=4,this.PDCDocuments.InitColumns()):"PostEvents"==e||("RefreshEvents"==e?this.NotifEvents.RefreshData():"UnApproved"==e?this.UnApprovedDocuments.OnLoad():"Drafts"==e&&this.DocumentDrafts.FillGrid()))}OnMessageCallBack(){this.res="Yes"}static InitColumns(e){let t,s="",a=[];if(i.a.SessionManager.Preferences.ContainsKey(e)&&(s=i.a.SessionManager.Preferences[e]),s.length>0){let n=new o.f;n.LoadXml(s);for(let s=0;s<n.DocumentElement.children.length;s++){let o=n.DocumentElement.children[s];t=new l.a,t.Header=i.a.GetResource(o.attributes.Header.value),t.DisplayMember=o.attributes.ID.value,t.ReadOnly=!0,t.Width=parseInt(o.attributes.Width.value),a.push(t),"Un Approved Documents_DashBoardCustomize"==e?"VoucherNo"==t.DisplayMember?t.DataType="LINK":"Amount"==t.DisplayMember&&(t.DataType="FLOAT",t.DecimalPoints=i.a.SessionManager.Preferences.DecimalsinAmount.toString()):"Document Drafts_DashBoardCustomize"==e?"Date_Text"!=t.DisplayMember&&"Delete"!=t.DisplayMember||(t.DataType="LINK"):"Post Dated Documents_DashBoardCustomize"==e?"VoucherNo"==t.DisplayMember?t.DataType="LINK":"Amount"==t.DisplayMember&&(t.DataType="FLOAT",t.DecimalPoints=i.a.SessionManager.Preferences.DecimalsinAmount.toString()):"Notification Events_DashBoardCustomize"==e&&"VoucherNo"==t.DisplayMember&&(t.DataType="LINK")}}return a}static IsActionAssigned(e,t){return i.a.SessionManager.IsActionAssigned(e,t)}}}}]);