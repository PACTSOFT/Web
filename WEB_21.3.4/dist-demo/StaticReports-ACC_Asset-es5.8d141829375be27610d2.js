function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var o=0;o<t.length;o++){var s=t[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function _createClass(e,t,o){return t&&_defineProperties(e.prototype,t),o&&_defineProperties(e,o),e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var o,s=_getPrototypeOf(e);if(t){var l=_getPrototypeOf(this).constructor;o=Reflect.construct(s,arguments,l)}else o=s.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[79],{g9Ew:function(e,t,o){"use strict";o.r(t),o.d(t,"ACC_Asset",(function(){return A}));var s=o("Do2H"),l=o("Lp6j"),a=o("vTM8"),r=o("eQJW"),n=o("1xwR"),i=o("mvPR"),D=o("MCLT"),A=function(e){_inherits(o,e);var t=_createSuper(o);function o(e){var s;return _classCallCheck(this,o),(s=t.call(this,e)).i=0,s.k=0,s.jAccount=0,s.dsTrail=null,s.Balance=0,s.OpBalance=0,s.colBalanceIndex=-1,s.colDebitIndex=-1,s.colCreditIndex=-1,s.colSpanBF=-1,s.colSubTotalStartIndex=0,s.GroupTotalIndex=0,s.CntMonths=0,s.dtStart=Date.Today(),s.IncludeBFInTotals=!1,s.AccountsWithOutTransactions=!1,s.AccountsWithZeroBalance=!1,s.PDCSeperate=!1,s.PDCDrCrSeperate=!1,s.STAccountWise=!1,s.STMonthWise=!1,s.STDayWise=!1,s.ShowGeneralLedgerDetailReport=!1,s.TBIsAccountWise=!1,s.TBOpeningDrCrSeperately=!1,s.TBTransactionsDrCrSeperately=!1,s.OpenCompany=!1,s.ShowTagWise=!1,s.TBShowdetailsofControlGroups=!1,s.UnPostedDocsSeparately=!1,s.AllowAddRows=!1,s.GroupTotalsAtEnd=!1,s.GroupTotalsSeperate=!1,s.DontShowSummaryGroupTotals=!1,s.TagID=0,s.TagTableName=null,s.CountMonths=0,s.IsNewAccount=!0,s.Col1=0,s.Col2=0,s.dec="",s.LocationWhere="",s.filter="",s.LevelNo=0,s.dvDepr=null,s.dvDeprTable=null,s.lstTotal=null,s.lstParents=new Array,s}return _createClass(o,[{key:"LoadReport",value:function(){var e=this;if(this.GrdRow=-1,this.GroupTotalIndex=-1,this.colSubTotalStartIndex=-1,this.lstTotal=new Array,this.DataSetCollection.Clear(),this.ViewModel.lstGroupIndex.Clear(),this.ViewModel.lstGroup.length>0)for(this.k=0;this.k<this.oColumns.length;this.k++)if(this.ViewModel.lstGroup[0].TotalCols.ContainsKey(this.oColumns[this.k].ID)){this.colSubTotalStartIndex=this.k;break}var t="",o="";if(this.ViewModel.oReportDialog.Locations.Visible&&null!=this.ViewModel.oReportDialog.LocationWhere&&(o=" AND A.LocationID IN ("+this.ViewModel.oReportDialog.LocationWhere+")"),116==this.ViewModel.StaticReportType||117==this.ViewModel.StaticReportType){var r=this.ViewModel.oReportDialog.GetSeqNosList();this.dec="N2",t=" select A.IsGroup,A.AssetID,Convert(datetime,A.DeprStartDate) as DeprStartDate,A.AssetName,A.PurchaseValue as OriginalPurchase,A.DeprStartValue as PurchaseCurrent,A.EstimateLife as LifeYrs\n,isnull((select sum(DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) <'"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"'),0) as ToDateDepreciation,\n(A.PurchaseValue+A.DeprStartValue)-isnull((select sum(DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) <'"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"'),0) as OpeningValue,\nisnull((select sum(DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) <'"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"'),0) + isnull((select sum(DepAmount) from ACC_AssetDepSchedule ADS where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) >='"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"' and Convert(datetime,ADS.DeprEndDate) <='"+this.ViewModel.ToDatePicker.Date.ToString("dd MMM yyyy")+"'),0) as ReportDepreciation,\n(A.PurchaseValue+A.DeprStartValue)-(isnull((select sum(DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) <'"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"'),0) + isnull((select sum(DepAmount) from ACC_AssetDepSchedule ADS where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) >='"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"' and Convert(datetime,ADS.DeprEndDate) <='"+this.ViewModel.ToDatePicker.Date.ToString("dd MMM yyyy")+"'),0)) as NetValue,\n(select Count(*) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) <'"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"') as Number \n, A.lft,A.Depth,A.ParentID from ACC_Assets A with(nolock) where A.AssetID IN ("+r+") and A.AssetID > 1 "+o+" Order By A.lft\n\n                        select AssetID,Convert(datetime,DeprStartDate) DeprStartDate,DepAmount from ACC_AssetDepSchedule with(nolock)\n                        WHERE AssetID IN ("+r+") and Convert(datetime,DeprStartDate)>='"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"' and Convert(datetime,DeprEndDate )<='"+this.ViewModel.ToDatePicker.Date.ToString("dd MMM yyyy")+"'"}else if(118==this.ViewModel.StaticReportType){var n=this.ViewModel.oReportDialog.GetSeqNosList();t="select G.AssetName AssetGroup,G.AssetName+ ' Upto '+'"+this.ViewModel.FromDatePicker.Date.ToString("MMM yyyy")+"'+' (Last Year)' DATEGROUP,A.IsGroup,A.AssetID,A.AssetName,Convert(datetime,A.DeprStartDate) as DateofCapitalisation,A.PurchaseValue as Cost,\n                        Convert(nvarchar(50),(isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) <'"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"'),0)/A.PurchaseValue)*100)+'%' as Rate,\n                        isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) <'"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"'),0) as AccDepreciation,\n                        A.PurchaseValue-isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) <'"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"'),0) as WDVToDate,\n                        isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprEndDate) <'"+this.ViewModel.ToDatePicker.Date.ToString("dd MMM yyyy")+"'),0) as ChargedUpto,\n                        (A.PurchaseValue-isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) <'"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"'),0))-\n                        (isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprEndDate) <'"+this.ViewModel.ToDatePicker.Date.ToString("dd MMM yyyy")+"'),0)) as WDVTillDate \n                        , A.lft,A.Depth,A.ParentID,0 as History "+this.ViewModel.SelectTag+"\n                        from  Acc_Assets A with(nolock) LEFT JOIN Acc_Assets G with(nolock) ON G.AssetID=A.ParentID"+this.ViewModel.FromTag+"\n                        where  A.IsGroup=0 AND A.AssetID in ("+n+") and A.AssetID > 1 "+o,t+=" UNION ALL\n                        select G.AssetName AssetGroup,G.AssetName+ ' - CURRENT YEAR' DATEGROUP,A.IsGroup,A.AssetID,A.AssetName,Convert(datetime,A.DeprStartDate) as DateofCapitalisation,A.PurchaseValue as Cost,\n                        Convert(nvarchar(50),(isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) <'"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"'),0)/A.PurchaseValue)*100)+'%' as Rate,\n                        isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) >='"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"' and Convert(datetime,ADS.DeprEndDate) <='"+this.ViewModel.ToDatePicker.Date.ToString("dd MMM yyyy")+"' ),0) as AccDepreciation,\n                        A.PurchaseValue-isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) >='"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"' and Convert(datetime,ADS.DeprEndDate) <='"+this.ViewModel.ToDatePicker.Date.ToString("dd MMM yyyy")+"'),0) as WDVToDate,\n                        isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) >='"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"' and Convert(datetime,ADS.DeprEndDate) <='"+this.ViewModel.ToDatePicker.Date.ToString("dd MMM yyyy")+"'),0) as ChargedUpto,\n                        (A.PurchaseValue-isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) >='"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"' and Convert(datetime,ADS.DeprEndDate) <='"+this.ViewModel.ToDatePicker.Date.ToString("dd MMM yyyy")+"'),0))-\n                        (isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) >='"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"' and Convert(datetime,ADS.DeprEndDate) <='"+this.ViewModel.ToDatePicker.Date.ToString("dd MMM yyyy")+"'),0)) as WDVTillDate \n                        , A.lft,A.Depth,A.ParentID,1 as History "+this.ViewModel.SelectTag+"\n                        from  Acc_Assets A with(nolock) LEFT JOIN Acc_Assets G with(nolock) ON G.AssetID=A.ParentID "+this.ViewModel.FromTag+"\n                        where A.IsGroup=0 AND A.AssetID in ("+n+") and A.AssetID > 1 "+o+" Order By AssetGroup,DATEGROUP desc"}if(120==this.ViewModel.StaticReportType){var D="",A="",u="",d="";new a.a,this.ViewModel.ReportGroups.forEach((function(e){e.CDGDO.ColumnCostCenterID>5e4?(e.CDGDO.ParentTableAlias="C"+e.CDGDO.ColumnCostCenterID,A+=e.CDGDO.ParentTableAlias+"."+e.CDGDO.Column+" AS "+e.ID+",",u+=" INNER JOIN "+e.CDGDO.ParentCostCenterSysName+" AS "+e.CDGDO.ParentTableAlias,u+=" with(nolock) ON "+e.CDGDO.ParentTableAlias+".NodeID=CC."+e.CDGDO.ParentColumn,D+=e.ID+","):72==e.CDGDO.ColumnCostCenterID&&"ParentID"==e.CDGDO.ParentColumn&&(A+="AG."+e.CDGDO.Column+" AS "+e.ID+",",D+=e.ID+","),"1"!=e.ShowAsColumn.SelectedValue&&0})),u.length>0&&(u=" INNER JOIN COM_CCCCData CC with(nolock) ON CC.CostCenterID=72 AND CC.NodeID=A.AssetID"+u),D.length>0&&(D=" ORDER BY "+D.TrimEnd(",")),this.ViewModel.Preferences.ContainsKey("Status")&&"Active"==this.ViewModel.Preferences.Status&&(d=" and A.StatusID=1  "),this.ViewModel.Preferences.ContainsKey("Status")&&"Dispose"==this.ViewModel.Preferences.Status&&(d=" and A.StatusID=0");var h=this.ViewModel.oReportDialog.GetSeqNosList(),C=new Date((new Date).getFullYear(),s.a.SessionManager.AccountingFromMonth-1,1);C>Date.Today()&&(C=C.AddYears(-1)),t=" select A.AssetID,"+A+"\nA.AssetCode,A.AssetName,AG.AssetCode GroupCode,AG.AssetName GroupName,AG.PurchaseInvoiceNo,Convert(datetime,A.PurchaseDate) PurchaseDate,A.PurchaseValue,\nisnull((select sum(AC.AssetNewValue-AC.AssetOldValue) from ACC_AssetChanges AC with(nolock) where AC.AssetID=A.AssetID and  AC.ChangeType in (0,2)),0) as Addition,\nisnull((select case when sum(AC.AssetNewValue-AC.AssetOldValue)<0 then sum(AC.AssetNewValue-AC.AssetOldValue)*(-1) else sum(AC.AssetNewValue-AC.AssetOldValue) end  from ACC_AssetChanges AC with(nolock) where AC.AssetID=A.AssetID and  AC.ChangeType in (1,3)),0) as Deletion,\n((A.PurchaseValue+isnull((select sum(AC.AssetNewValue-AC.AssetOldValue) from ACC_AssetChanges AC with(nolock) where AC.AssetID=A.AssetID and  AC.ChangeType in (0,2)),0))-isnull((select case when sum(AC.AssetNewValue-AC.AssetOldValue)<0 then sum(AC.AssetNewValue-AC.AssetOldValue)*(-1) else sum(AC.AssetNewValue-AC.AssetOldValue) end from ACC_AssetChanges AC with(nolock) where AC.AssetID=A.AssetID and  AC.ChangeType in (1,3)),0)) as NetCost,\nA.EstimateLife,\nA.PreviousDepreciation+isnull((select sum(D.DepAmount) from ACC_AssetDepSchedule D with(nolock) where D.AssetID=A.AssetID and Convert(datetime,D.DeprStartDate)<'"+C+"' and D.DocID IS NOT NULL),0) as PreviousDepreciation,\nisnull((select sum(D.DepAmount) from ACC_AssetDepSchedule D with(nolock) where D.AssetID=A.AssetID and Convert(datetime,D.DeprStartDate)>='"+C+"' and D.DocID IS NOT NULL),0) as CurrentYearDepreciation,\n(A.PreviousDepreciation+isnull((select sum(D.DepAmount) from ACC_AssetDepSchedule D with(nolock) where D.AssetID=A.AssetID and Convert(datetime,D.DeprStartDate)<'"+C+"' and D.DocID IS NOT NULL),0))+(isnull((select sum(D.DepAmount) from ACC_AssetDepSchedule D with(nolock) where D.AssetID=A.AssetID and Convert(datetime,D.DeprStartDate)>='"+C+"' and D.DocID IS NOT NULL),0)) as TotalDepreciation,\n(((A.PurchaseValue+isnull((select sum(AC.AssetNewValue-AC.AssetOldValue) from ACC_AssetChanges AC with(nolock) where AC.AssetID=A.AssetID and  AC.ChangeType in (0,2)),0))-isnull((select case when sum(AC.AssetNewValue-AC.AssetOldValue)<0 then sum(AC.AssetNewValue-AC.AssetOldValue)*(-1) else sum(AC.AssetNewValue-AC.AssetOldValue) end from ACC_AssetChanges AC with(nolock) where AC.AssetID=A.AssetID and  AC.ChangeType in (1,3)),0))\n-((A.PreviousDepreciation+isnull((select sum(D.DepAmount) from ACC_AssetDepSchedule D with(nolock) where D.AssetID=A.AssetID and Convert(datetime,D.DeprStartDate)<'"+C+"' and D.DocID IS NOT NULL),0))+(isnull((select sum(D.DepAmount) from ACC_AssetDepSchedule D with(nolock) where D.AssetID=A.AssetID and Convert(datetime,D.DeprStartDate)>='"+C+"' and D.DocID IS NOT NULL),0)))) as NetBalance\nFROM ACC_Assets A with(nolock) INNER JOIN ACC_Assets AG with(nolock) ON AG.AssetID=A.ParentID\n"+u+" WHERE A.AssetID IN ("+h+") and A.IsGroup=0 "+d+D+o,s.a.report.ReportDataSetAsync("RPT022",this.ViewModel.IsReportDB,t).then((function(t){e.ds=t,e.dv=e.dvTable=e.ds.Tables[0],e.dvColumns=e.ds.Columns[0],e.ViewModel.ReportData=e.ds.Tables[0],e.ViewModel.ConstructFormulaFields(!0),e.ViewModel.totals=l.e.NumArray(e.ViewModel.ReportColumns.length,e.ViewModel.lstGroup.length+1),e.ViewModel.hiddenTotals=l.e.NumArray(e.ViewModel.HiddenNumericColumns.length,e.ViewModel.lstGroup.length+1),e.ViewModel.RenderData(e.dv),e.ViewModel.CheckAndAddTotals(e.dv),e.LoadReport_Complete()}))}if(116==this.ViewModel.StaticReportType||117==this.ViewModel.StaticReportType)this.CntMonths=0,s.a.report.ReportDataSetAsync("RPT022",this.ViewModel.IsReportDB,t).then((function(t){e.ds=t,120!=e.ViewModel.StaticReportType&&(e.dvDepr=e.dvDeprTable=e.ds.Tables[1]);for(var o=new Array,s=0;s<e.ViewModel.ColumnSource.length;s++)if(o.push(e.ViewModel.ColumnSource[s]),116==e.ViewModel.StaticReportType&&"MONTHS"==e.ViewModel.ColumnSource[s].ID){for(e.dtStart=e.ViewModel.FromDatePicker.Date;e.dtStart<=e.ViewModel.ToDatePicker.Date;){var l=o[7].Clone();l.HeaderText=e.dtStart.ToString("MMM yyyy"),l.ID=e.dtStart.ToString("MMMyyyy"),o.push(l),e.ds.Tables[0].Columns.push(l.ID),e.CntMonths++,e.dtStart=e.dtStart.AddMonths(1)}o.Remove(e.ViewModel.ColumnSource[s])}e.ViewModel.ReportColumns=o,e.oColumns=e.ViewModel.ReportColumns,e.dv=e.ds.Tables[0],e.addTrialBalance(),e.AddReportTotals(),e.LoadReport_Complete()}));else if(118==this.ViewModel.StaticReportType){var p=-1,c=-1,w=-1,m=-1,S=-1;this.AggTotal=l.e.NumArray(this.oColumns.length+1,2),s.a.report.ReportDataSetAsync("RPT022",this.ViewModel.IsReportDB,t).then((function(t){e.ds=t,e.ViewModel.RenderData(e.ds.Tables[0]),e.ViewModel.CheckAndAddTotals(e.ds.Tables[0]),e.oRow=e.NewReportRow_2(i.f.Header,e.HeaderAppearance),e.oRow.Cells[0].Text="SUMMARY",e.oRow.Cells[0].CellAppearance.IsUnderline=!0,e.oRow.Cells[0].ColSpan=e.oRow.Cells.length,e.ViewModel.addRow(e.oRow);for(var o=0;o<e.oColumns.length;o++)"Cost"==e.oColumns[o].ID.toString()&&(p=o),"AccDepreciation"==e.oColumns[o].ID.toString()&&(c=o),"WDVToDate"==e.oColumns[o].ID.toString()&&(w=o),"ChargedUpto"==e.oColumns[o].ID.toString()&&(m=o),"WDVTillDate"==e.oColumns[o].ID.toString()&&(S=o);for(var s,r,n,D=e.ds.Tables[0].ToTable(!0,["ParentID","AssetGroup"]),A=new a.a,u=l.e.NumArray(e.oColumns.length,2),d=0;d<3;d++){0==d?(s="1",r=" (CURRENT YEAR)"):1==d?(s="0",r=" (LAST YEAR)"):(s="0",r=" (CURRENT + LAST YEAR)");for(var h=function(t){if(e.oRow=e.NewReportRow(),e.oRow.Cells[0].ColSpan=3,n=D[t].AssetGroup.toString(),2!=d){A.ContainsKey(n)||A.push(n,l.e.NumArray(e.oColumns.length,2)),e.oRow.Cells[0].Text="TOTAL - "+D[t].AssetGroup.toString()+r;var o=e.ds.Tables[0].filter((function(e){return e.History==s&&e.ParentID==D[t][D.Columns[0][0]]})),a=o.Compute("sum","Cost");-1!=p&&(e.ViewModel.SetCellValue(a,e.oColumns[p].DataFormat,"FLOAT",e.oRow.Cells[p]),null!=a&&(A[n][p][d]+=parseFloat(a),u[p][d]+=parseFloat(a))),a=o.Compute("sum","AccDepreciation"),-1!=c&&(e.ViewModel.SetCellValue(a,e.oColumns[c].DataFormat,"FLOAT",e.oRow.Cells[c]),null!=a&&(A[n][c][d]+=parseFloat(a),u[c][d]+=parseFloat(a))),a=o.Compute("sum","WDVToDate"),-1!=w&&(e.ViewModel.SetCellValue(a,e.oColumns[w].DataFormat,"FLOAT",e.oRow.Cells[w]),null!=a&&(A[n][w][d]+=parseFloat(a),u[w][d]+=parseFloat(a))),a=o.Compute("sum","ChargedUpto"),-1!=m&&(e.ViewModel.SetCellValue(a,e.oColumns[m].DataFormat,"FLOAT",e.oRow.Cells[m]),null!=a&&(A[n][m][d]+=parseFloat(a),u[m][d]+=parseFloat(a))),a=o.Compute("sum","WDVTillDate"),-1!=S&&(e.ViewModel.SetCellValue(a,e.oColumns[S].DataFormat,"FLOAT",e.oRow.Cells[S]),null!=a&&(A[n][S][d]+=parseFloat(a),u[S][d]+=parseFloat(a)))}else e.oRow.Cells[0].Text="GRAND TOTAL - "+n+r,A.ContainsKey(n)&&(-1!=p&&e.ViewModel.SetCellValue(A[n][p][0]+A[n][p][1],e.oColumns[p].DataFormat,"FLOAT",e.oRow.Cells[p]),-1!=c&&e.ViewModel.SetCellValue(A[n][c][0]+A[n][c][1],e.oColumns[c].DataFormat,"FLOAT",e.oRow.Cells[c]),-1!=w&&e.ViewModel.SetCellValue(A[n][w][0]+A[n][w][1],e.oColumns[w].DataFormat,"FLOAT",e.oRow.Cells[w]),-1!=m&&e.ViewModel.SetCellValue(A[n][m][0]+A[n][m][1],e.oColumns[m].DataFormat,"FLOAT",e.oRow.Cells[m]),-1!=S&&e.ViewModel.SetCellValue(A[n][S][0]+A[n][S][1],e.oColumns[S].DataFormat,"FLOAT",e.oRow.Cells[S]));e.ViewModel.addRow(e.oRow)},C=0;C<D.length;C++)h(C);e.oRow=e.NewReportRow_2(i.f.SubTotal,e.GrossTotalAppearance),e.oRow.Cells[0].ColSpan=3,e.oRow.Cells[0].Text="GRAND TOTAL - "+r,2!=d?(-1!=p&&(e.ViewModel.SetCellValue(u[p][d],e.oColumns[p].DataFormat,"FLOAT",e.oRow.Cells[p]),e.oRow.Cells[p].CellAppearance.Alignment="Right"),-1!=c&&(e.ViewModel.SetCellValue(u[c][d],e.oColumns[c].DataFormat,"FLOAT",e.oRow.Cells[c]),e.oRow.Cells[c].CellAppearance.Alignment="Right"),-1!=w&&(e.ViewModel.SetCellValue(u[w][d],e.oColumns[w].DataFormat,"FLOAT",e.oRow.Cells[w]),e.oRow.Cells[w].CellAppearance.Alignment="Right"),-1!=m&&(e.ViewModel.SetCellValue(u[m][d],e.oColumns[m].DataFormat,"FLOAT",e.oRow.Cells[m]),e.oRow.Cells[m].CellAppearance.Alignment="Right"),-1!=S&&(e.ViewModel.SetCellValue(u[S][d],e.oColumns[S].DataFormat,"FLOAT",e.oRow.Cells[S]),e.oRow.Cells[S].CellAppearance.Alignment="Right")):(-1!=p&&(e.ViewModel.SetCellValue(u[p][0]+u[p][1],e.oColumns[p].DataFormat,"FLOAT",e.oRow.Cells[p]),e.oRow.Cells[p].CellAppearance.Alignment="Right"),-1!=c&&(e.ViewModel.SetCellValue(u[c][0]+u[c][1],e.oColumns[c].DataFormat,"FLOAT",e.oRow.Cells[c]),e.oRow.Cells[c].CellAppearance.Alignment="Right"),-1!=w&&(e.ViewModel.SetCellValue(u[w][0]+u[w][1],e.oColumns[w].DataFormat,"FLOAT",e.oRow.Cells[w]),e.oRow.Cells[w].CellAppearance.Alignment="Right"),-1!=m&&(e.ViewModel.SetCellValue(u[m][0]+u[m][1],e.oColumns[m].DataFormat,"FLOAT",e.oRow.Cells[m]),e.oRow.Cells[m].CellAppearance.Alignment="Right"),-1!=S&&(e.ViewModel.SetCellValue(u[S][0]+u[S][1],e.oColumns[S].DataFormat,"FLOAT",e.oRow.Cells[S]),e.oRow.Cells[S].CellAppearance.Alignment="Right")),e.ViewModel.addRow(e.oRow)}e.LoadReport_Complete()}))}}},{key:"LoadReport_Complete",value:function(){this.ViewModel.FormulasCalculated=!0,this.ViewModel.process_RunWorkerCompleted()}},{key:"AddReportTotals",value:function(){if(116==this.ViewModel.StaticReportType||117==this.ViewModel.StaticReportType||120==this.ViewModel.StaticReportType){this.UpdateTreeTotals(0),this.row=this.NewReportRow_2(i.f.ReportTotal,this.ViewModel.GrpReportTotal.SubTotalAppearance),this.ViewModel.GrpReportTotal.Height>0&&(this.row.Height=this.ViewModel.GrpReportTotal.Height),this.row.LevelNo=0;var e=-1;for(this.k=0;this.k<this.ViewModel.ColumnSource.length;this.k++)0!=this.ViewModel.GrpReportTotal.TotalCols.length&&this.ViewModel.GrpReportTotal.TotalCols.ContainsKey(this.oColumns[this.k].ID)&&(-1==e&&(e=this.k),this.row.Cells[this.k].CellAppearance.Alignment="Right",this.ViewModel.SetCellValue(this.lstTotal[0][this.k].toString(),this.oColumns[this.k].DataFormat,this.oColumns[this.k].ColumnType,this.row.Cells[this.k]));for(this.k=this.ViewModel.ColumnSource.length;this.k<this.oColumns.length;this.k++)-1==e&&(e=this.k),this.row.Cells[this.k].CellAppearance.Alignment="Right",this.ViewModel.SetCellValue(this.lstTotal[0][this.k].toString(),this.oColumns[this.k].DataFormat,this.oColumns[this.k].ColumnType,this.row.Cells[this.k]);this.row.Cells[0].Text=s.a.GetResource("Reports_ReportTotal"),e>0&&(this.GrdRow++,this.row.Cells[0].ColSpan=e,this.ViewModel.addRow(this.row))}else{this.GrdRow++,this.row=this.NewReportRow_2(i.f.ReportTotal,this.ViewModel.GrpReportTotal.SubTotalAppearance),this.ViewModel.GrpReportTotal.Height>0&&(this.row.Height=this.ViewModel.GrpReportTotal.Height),this.row.LevelNo=1;var t=-1;for(this.k=0;this.k<this.oColumns.length;this.k++)this.ViewModel.GrpReportTotal.TotalCols.ContainsKey(this.oColumns[this.k].ID)&&(-1==t&&(t=this.k),this.row.Cells[this.k].CellAppearance.Alignment="Right",this.ViewModel.SetCellValue(this.AggTotal[0].toString(),this.oColumns[this.k].DataFormat,"FLOAT",this.row.Cells[this.k]));this.row.Cells[0].Text=s.a.GetResource("Reports_ReportTotal"),t>0&&(this.row.Cells[0].ColSpan=t,this.ViewModel.addRow(this.row))}}},{key:"LoadReportWithPostFilters",value:function(e){}},{key:"addTrialBalance",value:function(){var e=this,t=function(){e.oRow=e.NewReportRow(),e.oRow.LevelNo=parseInt(e.dv[e.k].Depth)-1,e.oRow.Cells[1].IsNormal=!1,e.oRow.IsGroup=Object(r.j)(e.dv[e.k].IsGroup),e.oRow.DataRow=e.dv[e.k];var t=parseInt(e.dv[e.k].AssetID);if(e.oRow.Cells[1].level=e.oRow.LevelNo,e.UpdateTreeTotals(e.oRow.LevelNo),Object(r.j)(e.dv[e.k].IsGroup)){e.lstParents.push(e.oRow),new Array(e.oColumns.length).fill(0),e.oRow.Type=i.f.BalanceBF;for(var o=0;o<e.oRow.Cells.length;o++)e.oRow.Cells[o].IsNormal=!1,e.oRow.Cells[o].CellAppearance=e.BalanceBFAppearance_Data.Clone(),e.oRow.Cells[o].CellAppearance.Alignment=e.oColumns[o].DataAppearance.Alignment}else 120!=e.ViewModel.StaticReportType&&(e.dvDepr=e.dvDeprTable.filter((function(e){return e.AssetID==t})),e.dvDepr.forEach((function(t){var o=new Date(t.DeprStartDate).ToString("MMMyyyy");e.dvColumns.Contains(o)&&(e.dv[e.k][o]=t.DepAmount)})));for(var s=0;s<e.oColumns.length;s++)e.CellValue=null,Object(D.isUndefined)(e.dv[e.k][e.oColumns[s].ID])||(e.CellValue=e.dv[e.k][e.oColumns[s].ID]),null!=e.CellValue&&(e.ViewModel.SetCellValue(e.CellValue,e.oColumns[s].DataFormat,e.oColumns[s].ColumnType,e.oRow.Cells[s]),l.e.IsNum(e.CellValue)&&(e.dbl=l.e.Double(e.CellValue),e.lstTotal.length>0&&(e.lstTotal[e.lstTotal.length-1][s]+=e.dbl)));if(e.GrdRow++,e.ViewModel.addRow(e.oRow),120!=e.ViewModel.StaticReportType&&!e.oRow.IsGroup){for(var a=0,n=e.ViewModel.FromDatePicker.Date,A=e.ViewModel.FromDatePicker.Date,u=parseInt(e.dv[e.k].Number),d=0;d<e.ViewModel.ReportColumns.length;d++)e.ViewModel.ReportColumns[d].ID==n.ToString("MMMyyyy")&&(a=d);if(n=n.AddMonths(1),e.oRow=e.NewReportRow(),e.oRow.LevelNo=parseInt(e.dv[e.k].Depth)-1,e.oRow.Cells[0].IsNormal=!1,e.oRow.Cells[0].Text=null!=e.dv[e.k].DeprStartDate?u.toString()+" & "+new Date(e.dv[e.k].DeprStartDate).ToString("dd/MMM/yyyy"):u.toString(),116==e.ViewModel.StaticReportType){for(var h=0;h<e.CntMonths;h++)e.dvColumns.Contains(A.ToString("MMMyyyy"))&&null!=e.dv[e.k][A.ToString("MMMyyyy")]&&(e.oRow.Cells[a].Text=(u+1).toString(),u++),h>0&&1==u&&(e.oRow.Cells[0].Text=-h+" & "+new Date(e.dv[e.k].DeprStartDate).ToString("dd/MMM/yyyy")),a++,A=A.AddMonths(1);e.CntMonths>0&&0==u&&(e.oRow.Cells[0].Text=-e.CntMonths+" & "+new Date(e.dv[e.k].DeprStartDate).ToString("dd/MMM/yyyy"))}e.ViewModel.addRow(e.oRow),A=e.ViewModel.FromDatePicker.Date,a=0;for(var C=0;C<e.ViewModel.ReportColumns.length;C++)e.ViewModel.ReportColumns[C].ID==n.ToString("MMMyyyy")&&(a=C);if(e.oRow=e.NewReportRow(),e.oRow.LevelNo=parseInt(e.dv[e.k].Depth)-1,e.oRow.Cells[0].IsNormal=!1,e.oRow.Cells[0].Text="Net Book Value",116==e.ViewModel.StaticReportType)for(var p=0,c=0;c<e.CntMonths;c++)e.dvColumns.Contains(A.ToString("MMMyyyy"))&&(null!=e.dv[e.k][A.ToString("MMMyyyy")]&&(0==p?p=parseFloat(e.dv[e.k].OpeningValue.toString())-parseFloat(e.dv[e.k][A.ToString("MMMyyyy")].toString()):p-=parseFloat(e.dv[e.k][A.ToString("MMMyyyy")].toString()),e.oRow.Cells[a-1].Text=p.toString()),a++,A=A.AddMonths(1));e.GrdRow++,e.ViewModel.addRow(e.oRow)}};for(this.lstParents.Clear(),this.lstTotal.Clear(),this.lstParents.push(this.NewReportRow()),this.lstTotal.push(new Array(this.oColumns.length).fill(0)),this.k=0;this.k<this.dv.length;this.k++)t()}},{key:"UpdateTreeTotals",value:function(e){for(var t=this.lstTotal.length-1;t>e;t--){if(t>0)for(var o=0;o<this.lstTotal[t].length;o++)this.lstTotal[t-1][o]+=this.lstTotal[t][o];if(!this.GroupTotalsAtEnd||this.DontShowSummaryGroupTotals&&!this.lstParents[t].IsExpanded)for(var s=0;s<this.oColumns.length;s++)"FLOAT"==this.oColumns[s].ColumnType&&this.ViewModel.SetCellValue(this.lstTotal[t][s],this.oColumns[s].DataFormat,"FLOAT",this.lstParents[t].Cells[s]);if(e<=this.LevelNo){var l=!1;if(0==this.AccountsWithOutTransactions&&0==this.lstTotal[t][2]&&0==this.lstTotal[t][3]&&0==this.lstTotal[t][4]&&0==this.lstTotal[t][5]&&(this.GrdRow--,l=!0,this.ViewModel.Data.Remove(this.lstParents[t])),this.AccountsWithZeroBalance||l||0==this.lstTotal[t][6]&&0==this.lstTotal[t][7]&&(this.GrdRow--,l=!0,this.ViewModel.Data.Remove(this.lstParents[t])),!l){var a=this.ViewModel.Data.indexOf(this.lstParents[t]);if(a>=0)if(!this.GroupTotalsAtEnd||this.DontShowSummaryGroupTotals&&!this.lstParents[t].IsExpanded)this.GroupTotalsSeperate&&-1!=this.colBalanceIndex&&(this.lstParents[t].Cells[this.GroupTotalIndex].Text=this.lstParents[t].Cells[this.colBalanceIndex].Text,this.lstParents[t].Cells[this.colBalanceIndex].Text=""),this.ViewModel.Data.Remove(this.lstParents[t]),this.ViewModel.Data.Insert(a,this.lstParents[t]);else{this.oSubTotal=this.NewReportRow(),this.oSubTotal.Type=i.f.BalanceBF,this.oSubTotal.Parent=this.lstParents[t].Parent,this.oSubTotal.LevelNo=this.lstParents[t].LevelNo,this.oSubTotal.Cells[1].IsNormal=!1,this.oSubTotal.IsGroup=!0,this.oSubTotal.Visible=this.lstParents[t].Visible,this.oSubTotal.Cells[1].level=this.lstParents[t].LevelNo,this.oSubTotal.Cells[1].Text=this.lstParents[t].Cells[1].Text+" - Total ",this.oSubTotal.Cells[1].CellAppearance=this.GrossTotalAppearance_Data.Clone(),this.oSubTotal.Cells[1].CellAppearance.Alignment=this.oColumns[1].DataAppearance.Alignment;for(var r=0;r<this.oColumns.length;r++)"FLOAT"==this.oColumns[r].ColumnType&&(this.oSubTotal.Cells[r].IsNormal=!1,this.oSubTotal.Cells[r].CellAppearance=this.GrossTotalAppearance_Data.Clone(),this.oSubTotal.Cells[r].CellAppearance.Alignment=this.oColumns[r].DataAppearance.Alignment,this.ViewModel.SetCellValue(this.lstTotal[t][r],this.oColumns[r].DataFormat,"FLOAT",this.oSubTotal.Cells[r]));this.GroupTotalsSeperate&&-1!=this.colBalanceIndex&&(this.oSubTotal.Cells[this.GroupTotalIndex].IsNormal=!1,this.oSubTotal.Cells[this.GroupTotalIndex].CellAppearance=this.GrossTotalAppearance_Data.Clone(),this.oSubTotal.Cells[this.GroupTotalIndex].CellAppearance.Alignment=this.oColumns[this.GroupTotalIndex].DataAppearance.Alignment,this.oSubTotal.Cells[this.GroupTotalIndex].Text=this.oSubTotal.Cells[this.colBalanceIndex].Text,this.oSubTotal.Cells[this.colBalanceIndex].Text=""),this.GrdRow++,this.ViewModel.addRow(this.oSubTotal)}}}this.lstParents.RemoveAt(t),this.lstTotal.RemoveAt(t)}}}]),o}(n.b)}}]);