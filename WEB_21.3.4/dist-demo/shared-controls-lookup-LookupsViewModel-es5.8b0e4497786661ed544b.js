function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,o){return t&&_defineProperties(e.prototype,t),o&&_defineProperties(e,o),e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var o,i=_getPrototypeOf(e);if(t){var s=_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,s)}else o=i.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[218],{LPVC:function(e,t,o){"use strict";o.r(t),o.d(t,"LookupsViewModel",(function(){return c})),o.d(t,"QuickAddLookupsViewModel",(function(){return k}));var i=o("eQJW"),s=o("ScVY"),a=o("4HhE"),n=o("ockk"),u=o("0/4Q"),r=o("EQd/"),l=o("NkMH"),p=o("Do2H"),d=o("Lp6j"),h=o("8B8H"),c=function(e){_inherits(o,e);var t=_createSuper(o);function o(){var e;return _classCallCheck(this,o),(e=t.apply(this,arguments)).NodeID=0,e.ButtonClick=new a.b,e.LookupsTableObj=new h.a,e.LookupTypes=new u.e(0),e.Code=new r.d(0),e.Name=new r.d(0),e.AliasName=new r.d(0),e.ButtonAddLookup=new l.a,e.ButtonSave=new l.a,e.ButtonAdd=new l.a,e.ButtonEdit=new l.a,e.ButtonDelete=new l.a,e.ColLists=[],e.LookupType=0,e.isTravel=!1,e}return _createClass(o,[{key:"LookupsViewModel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.LookupType=t,this.isTravel=o,p.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=p.a.SessionManager.IsActionAssigned(44,"Create"):this.ButtonSave.Enable=p.a.SessionManager.IsActionAssigned(44,"Create"),p.a.SessionManager.HideUnathorizedAccess?this.ButtonEdit.Visible=p.a.SessionManager.IsActionAssigned(44,"Update"):this.ButtonEdit.Enable=p.a.SessionManager.IsActionAssigned(44,"Update"),this.AddEditLookupVisibility=!1,p.a.SessionManager.HideUnathorizedAccess?this.ButtonDelete.Visible=p.a.SessionManager.IsActionAssigned(44,"Delete"):this.ButtonDelete.Enable=p.a.SessionManager.IsActionAssigned(44,"Delete"),p.a.SessionManager.HideUnathorizedAccess?this.ButtonAddLookup.Visible=p.a.SessionManager.IsActionAssigned(44,"Add Lookup"):this.ButtonAddLookup.Enable=p.a.SessionManager.IsActionAssigned(44,"Add Lookup"),this.Title=e,this.ButtonClick.Subscribe(this,"CommandController"),this.DisplayName=this.Title,this.AddGridColumns(),this.LookupTypes.SelectionChangedCommand.Subscribe(this,"OnLookupChanged"),this.LoadLookupTypes(),o&&(this.ButtonAddLookup.Visible=!1)}},{key:"LoadLookupTypes",value:function(){var e=p.a.admin.GetLookupTypes().Tables[0],t="124,125,126,127,128,129,130,131,132,133,134,135,136,137,140,142,143,144,145,146,147".split(",");e=e.filter(this.isTravel?function(e){return t.Contains(e.NodeID.toString())}:function(e){return!t.Contains(e.NodeID.toString())});for(var o=0;o<e.length;o++)this.LookupTypes.Items.push(u.d.ComboBoxItems_2(d.e.StringValue(e[o].ResourceName),e[o].NodeID.toString()));this.LookupTypes.Items.length>0&&(this.LookupType>0?(this.LookupTypes.SetSelectedItem(this.LookupType.toString()),this.LookupTypes.SelectedValue=this.LookupType.toString()):(this.LookupTypes.SelectedItem=this.LookupTypes.Items[0],this.LookupTypes.SelectedValue=this.LookupTypes.Items[0].Value),this.OnLookupChanged(""))}},{key:"AddGridColumns",value:function(){this.LookupsTableColumns.push("NodeID"),this.LookupsTableColumns.push("Code"),this.LookupsTableColumns.push("Name"),this.LookupsTableColumns.push("IsDefault"),this.LookupsTableColumns.push("Status");var e=new n.a;(e=new n.a).DisplayMember="Code",e.Header=p.a.GetResource("CCGroup_Code"),e.DataType="TextBlock",e.Width=180,e.ReadOnly=!0,e.IsVisible=!0,this.LookupsTableObj.Columns.push(e),e=new n.a,(e=new n.a).DisplayMember="Name",e.Header=p.a.GetResource("CCGroup_Name"),e.DataType="TextBlock",e.Width=320,e.ReadOnly=!0,e.IsVisible=!0,this.LookupsTableObj.Columns.push(e),(e=new n.a).DisplayMember="IsDefault",e.Header=p.a.GetResource("CCGroup_IsDefault"),e.DataType="RadioButton",e.Width=150,e.ReadOnly=!1,e.IsVisible=!0,this.LookupsTableObj.Columns.push(e)}},{key:"OnLookupChanged",value:function(e){this.NodeID=0,this.MessageVisibility=!1,this.DisplayMessage="",this.Code.Text="",this.Name.Text="",this.AliasName.Text="";var t=p.a.admin.GetLookupDataByType(parseInt(this.LookupTypes.SelectedValue));this.LookupsTableObj.Table=t.Tables[0],this.LookupsTableObj.refreshids();try{this.LookupsTableObj.Table.forEach((function(e){""!=e.IsDefault.toString()&&0!=Object(i.j)(e.IsDefault)||(e.IsDefault=!1)}))}catch(o){throw" error"}}},{key:"CommandController",value:function(e){switch(this.DisplayMessage="",e.toString()){case"ADD":this.NodeID=0,this.Code.Text="",this.Name.Text="",this.AliasName.Text="",this.AddEditLookupVisibility=!0;break;case"EDIT":null!=this.SelectedLookup&&(this.NodeID=parseInt(this.SelectedLookup.NodeID),this.Code.Text=this.SelectedLookup.Code.toString(),this.Name.Text=this.SelectedLookup.Name.toString(),this.AliasName.Text=this.SelectedLookup.AliasName.toString(),this.AddEditLookupVisibility=!0);break;case"DELETE":break;case"Cancel":this.AddEditLookupVisibility=!1,this.AddEditLookupTypeVisibility=!1;break;case"Save":this.OnSaveLookup();break;case"Update":this.OnUpdate();break;case"ADDLOOKUPTYPE":this.NodeID=0,this.Code.Text="",this.Name.Text="",this.AliasName.Text="",this.AddEditLookupTypeVisibility=!0;break;case"SaveLOOKUPTYPE":this.OnSaveLookupType()}}},{key:"OnUpdate",value:function(){Logger.InfoLog("LookupsViewModel::Entering OnUpdate");try{if(null!=this.LookupsTableObj.Table&&this.LookupsTableObj.Table.length>0){var e="";e+="<XML>";for(var t=0;t<this.LookupsTableObj.Table.length;t++)e+="<Row Default='"+("True"==this.LookupsTableObj.Table[t].IsDefault.toString()?1:0)+"' NodeID='"+this.LookupsTableObj.Table[t].NodeID.toString()+"' />";e+="</XML>",p.a.admin.UpdateLookups(e.toString()).RetValue>0&&(this.MessageVisibility=!0,this.DisplayMessage="Updated Sucessfully")}}catch(o){Logger.ErrorLog("LookupsViewModel::OnUpdate"+o.stack)}}},{key:"OnSaveLookup",value:function(){Logger.InfoLog("LookupsViewModel::Entering OnSaveLookup");try{if(d.e.IsEmpty(this.Name.Text))return void(this.DisplayMessage="Enter Name");var e=p.a.admin.SetLookup(parseInt(this.LookupTypes.SelectedValue),this.NodeID,this.Code.Text,this.Name.Text,d.e.IsEmpty(this.AliasName.Tag)?this.AliasName.Text:this.AliasName.Tag,1);this.DisplayMessage=e.Message,e.RetValue>0&&this.OnLookupChanged(""),Logger.InfoLog("LookupAddViewModel::Exiting OnSaveLookup")}catch(t){Logger.ErrorLog("LookupAddViewModel::OnSaveLookup"+t.stack)}}},{key:"OnDeleteCallBack",value:function(){var e=p.a.admin.DeleteLookup(parseInt(this.SelectedLookup.NodeID));this.DisplayMessage=e.Message,e.RetValue>0&&this.OnLookupChanged(null)}},{key:"OnSaveLookupType",value:function(){Logger.InfoLog("LookupsViewModel::Entering OnSaveLookupType");try{if(d.e.IsEmpty(this.Name.Text))return void(this.DisplayMessage="Enter Name");var e,t=p.a.admin.SetLookupType(0,this.Name.Text);this.DisplayMessage=t.Message,(e=t.RetValue)>0&&(this.LoadLookupTypes(),this.LookupTypes.SelectedValue=e.toString()),Logger.InfoLog("LookupAddViewModel::Exiting OnSaveLookupType")}catch(o){Logger.ErrorLog("LookupAddViewModel::OnSaveLookupType"+o.stack)}}},{key:"Title",get:function(){return this._ScreenName},set:function(e){e!=this._ScreenName&&(this._ScreenName=e)}},{key:"DisplayName",get:function(){return this._DisplayName},set:function(e){e!=this._DisplayName&&(this._DisplayName=e)}},{key:"angularGrid",get:function(){return this.LookupsTableObj.angularGrid}},{key:"LookupsTable",get:function(){return this.LookupsTableObj.Table}},{key:"LookupsTableColumns",get:function(){return this.LookupsTableObj.TableColumns}},{key:"ColumnSource",get:function(){return this.LookupsTableObj.Columns}},{key:"contextVisible",get:function(){return this.LookupsTableObj.contextVisible},set:function(e){this.LookupsTableObj.contextVisible=e}},{key:"AddEditLookupVisibility",get:function(){return this._AddEditLookupVisibility},set:function(e){e&&(this.AddEditLookupTypeVisibility=!1),this._AddEditLookupVisibility!=e&&(this._AddEditLookupVisibility=e)}},{key:"AddEditLookupTypeVisibility",get:function(){return this._AddEditLookupTypeVisibility},set:function(e){e&&(this.AddEditLookupVisibility=!1),this._AddEditLookupTypeVisibility!=e&&(this._AddEditLookupTypeVisibility=e)}}]),o}(s.b),k=function(e){_inherits(o,e);var t=_createSuper(o);function o(){var e;return _classCallCheck(this,o),(e=t.apply(this,arguments)).NodeID=0,e.ClassName="QuickAddLookupsViewModel",e.ButtonClick=new a.b,e.Code=new r.d(0),e.Name=new r.d(0),e.AliasName=new r.d(0),e.ButtonSave=new l.a,e}return _createClass(o,[{key:"QuickAddLookupsViewModel",value:function(e,t){this.NodeID=t,this.LookupTypeID=e,this.Name.Label=p.a.GetResource("CCGroup_Name"),0==t?(this.Title="Quick Add Lookup",p.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=p.a.SessionManager.IsActionAssigned(44,"Create"):this.ButtonSave.Enable=p.a.SessionManager.IsActionAssigned(44,"Create")):(this.Title="Edit Lookup",p.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=p.a.SessionManager.IsActionAssigned(44,"Update"):this.ButtonSave.Enable=p.a.SessionManager.IsActionAssigned(44,"Update")),this.ButtonClick.Subscribe(this,"CommandController")}},{key:"CommandController",value:function(e){switch(this.DisplayMessage="",e.toString()){case"Cancel":p.a.page.HideDialog();break;case"Save":this.OnSaveLookup();break;case"Update":this.OnUpdate()}}},{key:"OnUpdate",value:function(){}},{key:"OnSaveLookup",value:function(){Logger.InfoLog("QuickAddLookupsViewModel::Entering OnSaveLookup");try{if(d.e.IsEmpty(this.Name.Text))return void(this.DisplayMessage="Enter Name");var e,t=p.a.admin.SetLookup(this.LookupTypeID,this.NodeID,this.Code.Text,this.Name.Text,this.AliasName.Text,1);this.DisplayMessage=t.Message,(e=t.RetValue)>0&&(this.NodeID=e,p.a.page.HideDialog())}catch(o){Logger.ErrorLog("QuickAddLookupsViewModel::OnSaveLookup"+o.stack)}}}]),o}(s.b)}}]);