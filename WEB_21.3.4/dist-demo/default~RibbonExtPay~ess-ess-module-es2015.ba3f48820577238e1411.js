(window.webpackJsonp=window.webpackJsonp||[]).push([[56,75,77,89,113,121,141,148,150,160,210,212],{"4k0m":function(t,e,a){"use strict";a.d(e,"a",(function(){return n}));var s=a("Do2H"),i=a("ScVY"),l=a("EQd/"),o=a("0/4Q");class n extends i.b{constructor(t,e,a,i){super(),this.Remarks=new l.c(0),this.CostCenterID=0,this.NodeID=0,this.Parent=null,this.retValWeb=0,this.IsUpdated=!1,this.CostCenterID=t,this.NodeID=e,this.Parent=i,this.ScreenObject=a,this.Remarks.Label=s.a.GetResource("Remarks")}SaveStatus(t,e,a,s=!0){let i=!1,l=null;"MonthlyPayrollViewModel"==this.Parent.ClassName?(l=this.Parent.SetDocStatus(t,e,a,new Date,this.Remarks.Text,!0,""),null!=l&&l.Tables.length>0&&l.Tables[0].length>0&&l.Columns[0].Contains("status")&&(this.Parent.DocStatus="["+l.Tables[0][0].status.toString()+"]",i=!0),null!=l&&l.Tables.length>0&&l.Tables[l.Tables.length-1].length>0&&l.Columns[l.Tables.length-1].Contains("ErrorMessage")&&(this.Parent.this.DisplayMessage=l.Tables[l.Tables.length-1][0].ErrorMessage.toString()),this.Parent.this.MessageVisibility=!0,i&&this.Parent.btnClear_Click()):"FinalSettlementViewModel"==this.Parent.ClassName&&(l=this.Parent.SetDocStatus(t,e,a,new Date,this.Remarks.Text,!0,""),null!=l&&l.Tables.length>0&&l.Tables[0].length>0&&l.Columns[0].Contains("status")&&(this.Parent.DocStatus="["+l.Tables[0][0].status.toString()+"]",i=!0),null!=l&&l.Tables.length>0&&l.Tables[l.Tables.length-1].length>0&&l.Columns[l.Tables.length-1].Contains("ErrorMessage")&&(this.Parent.this.DisplayMessage=l.Tables[l.Tables.length-1][0].ErrorMessage.toString()),this.Parent.this.MessageVisibility=!0,i&&this.Parent.Button_Click("Clear"))}onButtonClick(t){let e=0;if(40054==this.CostCenterID)"Approve"==t?s.a.SessionManager.IsActionAssigned(this.CostCenterID,"Edit")?this.Parent.btnPost_Click():this.SaveStatus(369,parseInt(this.Parent.oCMP.arrLstOthMPFields[0].dvPayProcessed[0].WorkFlowID),""):"Reject"==t&&this.SaveStatus(372,0,""),s.a.page.HideDialog();else if(40095==this.CostCenterID)"Approve"==t?s.a.SessionManager.IsActionAssigned(this.CostCenterID,"Edit")?(this.Parent.sCmdParameter="Approve",this.Parent.Button_Click("Save")):this.SaveStatus(369,this.Parent.WID,""):"Reject"==t&&this.SaveStatus(372,0,""),s.a.page.HideDialog();else{let a=this.ScreenObject.CurrentStatus;if("Approve"==t){if(!this.IsSaveValidated())return;let t=s.a.common.ApproveCostCenter(this.CostCenterID,this.NodeID,a,this.Remarks.Text,!1,0);this.DisplayMessage=t.Message,e=t.RetValue,e>0&&(this.IsUpdated||(this.ScreenObject.ButtonApproveVisible=!1,this.UpdateStatusID(e),null!=this.ScreenObject.drpStatus&&(null==this.ScreenObject.drpStatus.Items.find(t=>t.Value==e.toString())&&("1001"==e.toString()?this.ScreenObject.drpStatus.Items.push(o.d.ComboBoxItems_2("Un Approved","1001")):"1002"==e.toString()?this.ScreenObject.drpStatus.Items.push(o.d.ComboBoxItems_2("Approved","1002")):this.ScreenObject.drpStatus.Items.push(o.d.ComboBoxItems_2("Rejected","1003"))),this.ScreenObject.drpStatus.SelectedValue=e.toString(),this.ScreenObject.drpStatus.SetSelectedItem(e.toString())),s.a.SessionManager.IsWebApplication&&(this.retValWeb=e)),s.a.page.HideDialog())}else if("Reject"==t){if(!this.IsSaveValidated())return;let t=s.a.common.ApproveCostCenter(this.CostCenterID,this.NodeID,a,this.Remarks.Text,!0,0);this.DisplayMessage=t.Message,e=t.RetValue,e>0&&(this.IsUpdated||(this.UpdateStatusID(e),null!=this.ScreenObject.drpStatus&&(null==this.ScreenObject.drpStatus.Items.find(t=>t.Value==e.toString())&&("1001"==e.toString()?this.ScreenObject.drpStatus.Items.push(o.d.ComboBoxItems_2("Un Approved","1001")):"1002"==e.toString()?this.ScreenObject.drpStatus.Items.push(o.d.ComboBoxItems_2("Approved","1002")):this.ScreenObject.drpStatus.Items.push(o.d.ComboBoxItems_2("Rejected","1003"))),this.ScreenObject.drpStatus.SelectedValue=e.toString(),this.ScreenObject.drpStatus.SetSelectedItem(e.toString())),s.a.SessionManager.IsWebApplication&&(this.retValWeb=e)),s.a.page.HideDialog())}else s.a.page.HideDialog()}}UpdateStatusID(t){this.ScreenObject.CurrentStatus=t,"QuickAddAccountScreenViewModel"==this.Parent.ClassName||"AddEditAccountScreenViewModel"==this.Parent.ClassName?this.Parent.obj.StatusID=t:"QuickAddProductViewModel"==this.Parent.ClassName?this.Parent.objProduct.ProductStatus=t:"AddProductScreenViewModel"==this.Parent.ClassName?this.Parent.oProduct.ProductStatus=t:"QuickAddCostCenterViewModel"==this.Parent.ClassName||"AddCostCenterViewModel"==this.Parent.ClassName?this.Parent.objCostCenter.Status=t:"AddEditEmpMasterViewModel"==this.Parent.ClassName&&(this.Parent.objEmp.StatusID=t)}IsSaveValidated(){if(this.IsUpdated=!1,"QuickAddAccountScreenViewModel"==this.Parent.ClassName){let t=this.Parent;if(t.ButtonSave.Visible&&t.ButtonSave.Enable){if(t.SaveMethod("APPROVE_CALL"),0!=t.AccountID)return this.DisplayMessage=t.DisplayMessage,t.DisplayMessage="",!1;this.IsUpdated=!0,t.DisplayMessage=""}}else if("AddEditAccountScreenViewModel"==this.Parent.ClassName){let t=this.Parent;if(t.ButtonSave.Visible&&t.ButtonSave.Enable){if(t.OnSaveAccount("APPROVE_CALL"),0!=t.AccountID)return this.DisplayMessage=t.DisplayMessage,t.DisplayMessage="",!1;this.IsUpdated=!0,t.DisplayMessage=""}}else if("QuickAddProductViewModel"==this.Parent.ClassName){let t=this.Parent;if(t.ButtonSave.Visible&&t.ButtonSave.Enable){if(t.onSaveProduct("APPROVE_CALL"),0!=t.objProduct.ProductID)return this.DisplayMessage=t.DisplayMessage,t.DisplayMessage="",!1;this.IsUpdated=!0,t.DisplayMessage=""}}else if("AddProductScreenViewModel"==this.Parent.ClassName){let t=this.Parent;if(t.ButtonSave.Visible&&t.ButtonSave.Enable){if(t.OnSaveProduct("APPROVE_CALL"),0!=t.ProductID)return this.DisplayMessage=t.DisplayMessage,t.DisplayMessage="",!1;this.IsUpdated=!0,t.DisplayMessage=""}}else if("QuickAddCostCenterViewModel"==this.Parent.ClassName){let t=this.Parent;if(t.ButtonSave.Visible&&t.ButtonSave.Enable){if(t.SaveMethod(),0!=t.NodeID)return this.DisplayMessage=t.DisplayMessage,t.DisplayMessage="",!1;this.IsUpdated=!0,t.DisplayMessage=""}}else if("AddCostCenterViewModel"==this.Parent.ClassName){let t=this.Parent;if(t.ButtonSave.Visible&&t.ButtonSave.Enable){if(t.OnSaveCostCenter("Save"),0!=t.NodeID)return this.DisplayMessage=t.DisplayMessage,t.DisplayMessage="",!1;this.IsUpdated=!0,t.DisplayMessage=""}}else if("AddEditEmpMasterViewModel"==this.Parent.ClassName){let t=this.Parent;if(t.ButtonSave.Visible&&t.ButtonSave.Enable){if(t.OnSaveEmployee("Save"),0!=t.NodeID)return this.DisplayMessage=t.DisplayMessage,t.DisplayMessage="",!1;this.IsUpdated=!0,t.DisplayMessage=""}}return!0}}},EW98:function(t,e,a){"use strict";a.d(e,"a",(function(){return c}));var s=a("3Pt+"),i=a("fXoL"),l=a("ofXK"),o=a("q8k3"),n=a("sT9C"),r=a("sYmb");function h(t,e){if(1&t){const t=i.ac();i.Zb(0,"span",5),i.hc("click",(function(){return i.Ic(t),i.lc().obj.Button_Click("Post")})),i.Ub(1,"i",19),i.Wc(2),i.mc(3,"translate"),i.Yb()}2&t&&(i.Db(2),i.Xc(i.nc(3,1,"Post")))}function d(t,e){if(1&t){const t=i.ac();i.Zb(0,"span",5),i.hc("click",(function(){return i.Ic(t),i.lc().obj.Button_Click("UnPost")})),i.Ub(1,"i",20),i.Wc(2),i.mc(3,"translate"),i.Yb()}2&t&&(i.Db(2),i.Xc(i.nc(3,1,"UnPost")))}let c=(()=>{class t{constructor(){this.form=new s.j({})}ngOnInit(){this.obj=this.params.obj}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Nb({type:t,selectors:[["app-post-payroll"]],decls:93,vars:25,consts:[[1,"maincontainer"],[1,"page-header"],[1,"page-title"],[1,"btnMetroDiv","secondary-btn-group",2,"margin-right","6px"],["class","secondary-btn",3,"click",4,"ngIf"],[1,"secondary-btn",3,"click"],[1,"fa-light","fa-broom"],[1,"fa-light","fa-filter"],[1,"main_div",2,"display","flex","flex-direction","column","padding","10px"],[1,"masterscreen",2,"height","120px"],[1,"row",2,"height","30px"],[1,"col-xl-3","col-md-4","col-sm-6","col-xs-12",2,"display","flex","flex-direction","row","margin-bottom","9px"],[1,"input_cntrl_label",2,"font-size","13px"],[1,"input_cntrl_label",2,"font-weight","bold","font-size","12px !important"],[1,"form-group","col-xl-3","col-md-4","col-sm-6","col-xs-12",2,"display","flex","flex-direction","row"],[1,"form-group","col-xl-3","col-md-4","col-sm-6","col-xs-12"],["FieldDirective","",3,"obj"],[1,"documentgrid",2,"flex","1","overflow","auto"],[2,"width","100%","height","100%",3,"obj"],[1,"fa-light","fa-floppy-disk-circle-arrow-right"],[1,"fa-light","fa-file-times"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Wc(1,"\n      "),i.Zb(2,"div",1),i.Wc(3,"\n        "),i.Zb(4,"span",2),i.Wc(5),i.Yb(),i.Wc(6,"\n        "),i.Zb(7,"div",3),i.Wc(8,"\n          "),i.Uc(9,h,4,3,"span",4),i.Wc(10,"\n          "),i.Zb(11,"span",5),i.hc("click",(function(){return e.obj.Button_Click("Clear")})),i.Ub(12,"i",6),i.Wc(13),i.mc(14,"translate"),i.Yb(),i.Wc(15,"\n          "),i.Uc(16,d,4,3,"span",4),i.Wc(17,"\n          "),i.Zb(18,"span",5),i.hc("click",(function(){return e.obj.Button_Click("Filter")})),i.Ub(19,"i",7),i.Wc(20),i.mc(21,"translate"),i.Yb(),i.Wc(22,"\n        "),i.Yb(),i.Wc(23,"\n      "),i.Yb(),i.Wc(24,"\n      "),i.Zb(25,"div",8),i.Wc(26," \n        "),i.Zb(27,"div",9),i.Wc(28,"\n          "),i.Zb(29,"div",10),i.Wc(30," \n            "),i.Zb(31,"div",11),i.Wc(32,"\n                  "),i.Zb(33,"label",12),i.Wc(34),i.mc(35,"translate"),i.Yb(),i.Wc(36,"\n                  "),i.Zb(37,"label",13),i.Wc(38),i.Yb(),i.Wc(39,"\n              "),i.Yb(),i.Wc(40,"\n            "),i.Yb(),i.Wc(41,"\n          "),i.Zb(42,"div",10),i.Wc(43,"\n                "),i.Zb(44,"div",14),i.Wc(45,"\n                "),i.Zb(46,"label",12),i.Wc(47),i.mc(48,"translate"),i.Yb(),i.Wc(49,"\n                "),i.Zb(50,"label",13),i.Wc(51),i.Yb(),i.Wc(52,"\n              "),i.Yb(),i.Wc(53,"\n              "),i.Zb(54,"div",14),i.Wc(55,"\n                "),i.Zb(56,"label",12),i.Wc(57),i.mc(58,"translate"),i.Yb(),i.Wc(59,"\n                "),i.Zb(60,"label",13),i.Wc(61),i.Yb(),i.Wc(62,"              \n            "),i.Yb(),i.Wc(63,"\n          "),i.Yb(),i.Wc(64,"\n          "),i.Zb(65,"div",10),i.Wc(66,"\n            "),i.Zb(67,"div",15),i.Wc(68,"\n              "),i.Vb(69,16),i.Wc(70,"\n          "),i.Yb(),i.Wc(71,"\n  \n          "),i.Zb(72,"div",15),i.Wc(73,"\n            "),i.Vb(74,16),i.Wc(75,"\n        "),i.Yb(),i.Wc(76,"                  \n           "),i.Yb(),i.Wc(77,"\n           "),i.Zb(78,"div",10),i.Wc(79,"\n        "),i.Zb(80,"div",15),i.Wc(81,"\n          "),i.Vb(82,16),i.Wc(83,"\n      "),i.Yb(),i.Wc(84,"\n          "),i.Yb(),i.Wc(85,"\n        "),i.Yb(),i.Wc(86,"\n        "),i.Zb(87,"div",17),i.Wc(88,"\n          "),i.Ub(89,"app-PactGridView",18),i.Wc(90,"  \n        "),i.Yb(),i.Wc(91,"\n      "),i.Yb(),i.Wc(92,"\n "),i.Yb()),2&t&&(i.Db(5),i.Xc(e.obj.Title),i.Db(4),i.tc("ngIf",e.obj.PostVisiblility),i.Db(4),i.Xc(i.nc(14,15,"Clear")),i.Db(3),i.tc("ngIf",e.obj.UnPostVisiblility),i.Db(4),i.Xc(i.nc(21,17,"Filter")),i.Db(14),i.Yc("",i.nc(35,19,"Payroll_PayMonth"),"        :"),i.Db(4),i.Xc(e.obj.lblPayrollMonth),i.Db(9),i.Yc("",i.nc(48,21,"Payroll_StartDate"),"   :"),i.Db(4),i.Xc(e.obj.lblPayrollMonthStart),i.Db(6),i.Yc("",i.nc(58,23,"Payroll_EndDate"),"   :"),i.Db(4),i.Xc(e.obj.lblPayrollMonthEnd),i.Db(8),i.tc("obj",e.obj.chkPostBasedOnDailyAttendance),i.Db(5),i.tc("obj",e.obj.chkIncludeOTHours),i.Db(8),i.tc("obj",e.obj.chkPostBasedOnAttDimWise),i.Db(7),i.tc("obj",e.obj.EmployeesList))},directives:[l.t,o.a,n.a],pipes:[r.d],encapsulation:2}),t})()},EggS:function(t,e,a){"use strict";a.d(e,"a",(function(){return o}));var s=a("Do2H"),i=a("Lp6j"),l=a("eQJW");class o{constructor(){this.CustomerID=0,this.CustomerTypeID=0,this.StatusID=0,this.AccountID=0,this.ParentID=0,this.SelectedNodeID=0,this.CodeNumber=0,this.IsGroup=!1,this.CreditDays=0,this.CreditLimit=0,this.DebitDays=0,this.Debitlimit=0,this.IsCode=!1,this.ActivityXml="",this.CCXML=""}SaveCustomerQuick(){try{let t=[];return t.push(this.CustomerID),t.push(null!=this.CustomerCode?this.CustomerCode:""),t.push(null!=this.CustomerName?this.CustomerName:""),t.push(this.StatusID),t.push(this.CodePrefix),t.push(this.CodeNumber),t.push(this.StaticFieldsQuery),t.push(this.CustomFieldsQuery),t.push(this.CustomCostCenterFieldsQuery),t.push(s.a.SessionManager.CompanyGUID),t.push(this.GUID),t.push(""),t.push(s.a.SessionManager.UserName),t.push(s.a.SessionManager.RoleID),t.push(s.a.SessionManager.LanguageID),s.a.crmService.SetCustomerQuick(t)}catch(t){return Logger.ErrorLog("Account:: SaveAccountQuick"+t.stack),""}}SaveCustomer(){Logger.InfoLog("Customer:: Inside SaveCustomer");try{0==this.CustomerID&&(this.GUID=i.e.NewGuid());let t=[];return t.push(this.CustomerID),t.push(null!=this.CustomerCode?this.CustomerCode:""),t.push(null!=this.CustomerName?this.CustomerName:""),t.push(null!=this.AliasName?this.AliasName:""),t.push(this.CustomerTypeID),t.push(this.StatusID),t.push(this.AccountID),t.push(this.SelectedNodeID),t.push(this.IsGroup),t.push(this.CreditDays),t.push(this.CreditLimit),t.push(null!=this.UserName?this.UserName:""),t.push(null!=this.Password?this.Password:""),t.push(null!=this.OnlineCustType?this.OnlineCustType:""),t.push(s.a.SessionManager.CompanyGUID),t.push(null!=this.GUID?this.GUID:"GUID"),t.push(""),t.push(s.a.SessionManager.UserName),t.push(this.CustomFieldsQuery),t.push(this.CustomCostCenterFieldsQuery),t.push(this.ContactsXML),t.push(this.AttachmetsXML),t.push(this.NotesXML),t.push(this.AddressXML),t.push(this.ActivityXml),t.push(this.CCXML),t.push(!1),t.push(null==this.PrimaryContactQuery?"":this.PrimaryContactQuery),t.push(s.a.SessionManager.RoleID),t.push(s.a.SessionManager.LanguageID),t.push(null!=this.CodePrefix?this.CodePrefix:""),t.push(this.CodeNumber),t.push(this.IsCode),s.a.crmService.SaveCustomer(t)}catch(t){return Logger.ErrorLog("Customer:: SaveCustomer"+t.stack),""}}GetCustomerDetails(){let t=s.a.crmService.GetCustomerInfo("?UserID="+s.a.SessionManager.UserID+"&RoleID="+s.a.SessionManager.RoleID+"&LangID="+s.a.SessionManager.LangID+"&CustomerID="+this.CustomerID);return!t.Columns[0].Contains("ErrorMessage")&&t.Tables.length>0&&t.Tables[0].length>0&&(this.CustomerID=parseInt(t.Tables[0][0].CustomerID),this.CustomerCode=i.e.String(t.Tables[0][0].CustomerCode),this.CustomerName=i.e.String(t.Tables[0][0].CustomerName),this.AliasName=i.e.String(t.Tables[0][0].AliasName),i.e.IsEmpty(t.Tables[0][0].CustomerTypeID)||(this.CustomerTypeID=parseInt(t.Tables[0][0].CustomerTypeID)),this.StatusID=parseInt(t.Tables[0][0].StatusID),i.e.IsEmpty(t.Tables[0][0].AccountID)||(this.AccountID=parseInt(t.Tables[0][0].AccountID)),this.IsGroup=Object(l.j)(t.Tables[0][0].IsGroup),i.e.IsEmpty(t.Tables[0][0].CreditDays)||(this.CreditDays=parseInt(t.Tables[0][0].CreditDays)),i.e.IsEmpty(t.Tables[0][0].CreditLimit)||(this.CreditLimit=parseFloat(t.Tables[0][0].CreditLimit)),this.ParentID=parseInt(t.Tables[0][0].ParentID),this.GUID=i.e.String(t.Tables[0][0].GUID),this.Description=i.e.String(t.Tables[0][0].Description),this.CodePrefix=i.e.String(t.Tables[0][0].CodePrefix),this.UserName=i.e.String(t.Tables[0][0].UserName),this.OnlineCustType=i.e.String(t.Tables[0][0].OnlineCustType),this.Password=i.e.String(t.Tables[0][0].Password),i.e.IsEmpty(t.Tables[0][0].CodeNumber)||(this.CodeNumber=parseInt(t.Tables[0][0].CodeNumber))),t}DeleteCustomer(t,e){try{let a=[];return a.push(t),a.push(e),a.push(s.a.SessionManager.RoleID),a.push(s.a.SessionManager.LanguageID),Logger.InfoLog("Customer:: Success: DBH.DeleteCustomer "+t.toString()),s.a.crmService.RemoveCustomer(a)}catch(a){return Logger.ErrorLog("LEAD::DeleteLead"+a.stack),""}}}},Gc3p:function(t,e,a){"use strict";a.d(e,"a",(function(){return c}));var s=a("3Pt+"),i=a("fXoL"),l=a("q8k3"),o=a("ofXK"),n=a("sYmb");function r(t,e){if(1&t&&(i.Zb(0,"div",20),i.Wc(1),i.Yb()),2&t){const t=i.lc().$implicit;i.Db(1),i.Xc(t.Label)}}function h(t,e){if(1&t&&(i.Xb(0),i.Wc(1,"\n              "),i.Vb(2,11),i.Wc(3,"\n            "),i.Wb()),2&t){const t=i.lc().$implicit,e=i.lc();i.Db(2),i.tc("obj",t)("group",e.form)}}function d(t,e){if(1&t&&(i.Xb(0),i.Wc(1,"\n          "),i.Zb(2,"div",17),i.Wc(3,"\n            "),i.Uc(4,r,2,1,"div",18),i.Wc(5,"\n            "),i.Uc(6,h,4,2,"ng-container",19),i.Wc(7,"\n          "),i.Yb(),i.Wc(8,"\n        "),i.Wb()),2&t){const t=e.$implicit;i.Db(2),i.tc("ngSwitch",!0),i.Db(2),i.tc("ngSwitchCase","LABEL"==t.tabname),i.Db(2),i.tc("ngSwitchCase","TEXTBOX"==t.tabname||"COMBOTEXTVALUE"==t.tabname)}}let c=(()=>{class t{constructor(){this.form=new s.j({})}ngOnInit(){this.obj=this.params.obj,console.log(this.obj)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Nb({type:t,selectors:[["app-income-tax-declaration"]],decls:61,vars:17,consts:[[2,"height","100%","padding","20px"],[1,"page-header"],[1,"page-title"],[1,"btnMetroDiv","secondary-btn-group"],[1,"secondary-btn-wicon",3,"click"],[1,"fa-light","fa-save"],[1,"fa-light","fa-broom"],[1,"fa-light","fa-paperclip"],[1,"section",2,"height","calc(100% - 60px)","overflow","hidden"],[1,"row"],[1,"form-group","col-xl-3","col-md-4","col-sm-12","col-xs-12","PACTControl"],["FieldDirective","",3,"obj","group"],[2,"height","calc(100% - 200px)","overflow","auto"],[1,"PACTHeaderFields","row","form-row"],[4,"ngFor","ngForOf"],[1,"documentgrid"],[1,"page-subtitle",2,"padding","12px 0","display","block"],[1,"form-group","row","PACTControl",3,"ngSwitch"],["class","input_cntrl_label panel-heading","style","font-weight: bold; color:var(--base-color); padding: 4px;",4,"ngSwitchCase"],[4,"ngSwitchCase"],[1,"input_cntrl_label","panel-heading",2,"font-weight","bold","color","var(--base-color)","padding","4px"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Wc(1,"\n  "),i.Zb(2,"div",1),i.Wc(3,"\n    "),i.Zb(4,"label",2),i.Wc(5),i.Yb(),i.Wc(6,"\n    "),i.Zb(7,"div",3),i.Wc(8,"\n      "),i.Zb(9,"span",4),i.hc("click",(function(){return e.obj.OnSaveITDeclarations()})),i.Wc(10,"\n        "),i.Ub(11,"i",5),i.Wc(12),i.mc(13,"translate"),i.Yb(),i.Wc(14,"\n      "),i.Zb(15,"span",4),i.hc("click",(function(){return e.obj.OnClear("Clear")})),i.Wc(16,"\n        "),i.Ub(17,"i",6),i.Wc(18),i.mc(19,"translate"),i.Yb(),i.Wc(20,"\n      "),i.Zb(21,"span",4),i.hc("click",(function(){return e.obj.OnAddAttachment()})),i.Wc(22,"\n        "),i.Ub(23,"i",7),i.Wc(24),i.mc(25,"translate"),i.Yb(),i.Wc(26,"\n    "),i.Yb(),i.Wc(27,"\n  "),i.Yb(),i.Wc(28,"\n  "),i.Zb(29,"div",8),i.Wc(30,"\n    "),i.Zb(31,"div",9),i.Wc(32,"\n      "),i.Zb(33,"div",10),i.Wc(34,"\n        "),i.Vb(35,11),i.Wc(36,"\n      "),i.Yb(),i.Wc(37,"\n      "),i.Zb(38,"div",10),i.Wc(39,"\n        "),i.Vb(40,11),i.Wc(41,"\n      "),i.Yb(),i.Wc(42,"\n    "),i.Yb(),i.Wc(43,"\n    "),i.Zb(44,"div",12),i.Wc(45,"\n      "),i.Zb(46,"div",13),i.Wc(47,"\n        "),i.Uc(48,d,9,3,"ng-container",14),i.Wc(49,"\n      "),i.Yb(),i.Wc(50,"\n    "),i.Yb(),i.Wc(51,"\n    "),i.Zb(52,"div",15),i.Wc(53,"\n      "),i.Zb(54,"span",16),i.Wc(55,"HRA Information"),i.Yb(),i.Wc(56,"\n      "),i.Vb(57,11),i.Wc(58,"\n    "),i.Yb(),i.Wc(59,"\n  "),i.Yb(),i.Wc(60,"\n"),i.Yb()),2&t&&(i.Db(5),i.Yc("\n      ",e.obj.Title,"\n    "),i.Db(7),i.Xc(i.nc(13,11,"Save")),i.Db(6),i.Xc(i.nc(19,13,"Clear")),i.Db(6),i.Xc(i.nc(25,15,"Attachments")),i.Db(11),i.tc("obj",e.obj.EmpYear)("group",e.form),i.Db(5),i.tc("obj",e.obj.Employee)("group",e.form),i.Db(8),i.tc("ngForOf",e.obj.PayrollTaxFields),i.Db(9),i.tc("obj",e.obj.dtPayrollTaxCmptsObj)("group",e.form))},directives:[l.a,o.s,o.x,o.y],pipes:[n.d],encapsulation:2}),t})()},Kz05:function(t,e,a){"use strict";a.d(e,"a",(function(){return nt}));var s=a("3Pt+"),i=a("Do2H"),l=a("EQd/"),o=a("8B8H"),n=a("sDFv"),r=a("eQJW"),h=a("Lp6j"),d=a("wlFP"),c=a("MRsC"),u=a("+0zN"),g=a("4HhE"),m=a("Jnyl"),b=a("MCKn"),D=a("1Cra"),p=a("ockk"),T=a("0/4Q"),y=a("OvA8"),C=a("xnJf"),I=a("4k0m"),S=a("++IR"),x=a("E7Kr"),v=a("fXoL"),P=a("ofXK"),A=a("S8xs"),f=a("44PX"),M=a("q8k3"),E=a("sT9C"),L=a("sYmb");function G(t,e){if(1&t){const t=v.ac();v.Zb(0,"span",7),v.hc("click",(function(){return v.Ic(t),v.lc().obj.Button_Click("Approve")})),v.Ub(1,"i",43),v.Wc(2),v.mc(3,"translate"),v.Yb()}2&t&&(v.Db(2),v.Xc(v.nc(3,1,"Approve")))}function R(t,e){if(1&t){const t=v.ac();v.Zb(0,"span",7),v.hc("click",(function(){return v.Ic(t),v.lc().obj.Button_Click("Save")})),v.Ub(1,"i",44),v.Wc(2),v.mc(3,"translate"),v.Yb()}2&t&&(v.Db(2),v.Xc(v.nc(3,1,"Post")))}function N(t,e){if(1&t){const t=v.ac();v.Zb(0,"span",7),v.hc("click",(function(){return v.Ic(t),v.lc().obj.Button_Click("SaveAndPrint")})),v.Ub(1,"i",45),v.Wc(2),v.mc(3,"translate"),v.Yb()}2&t&&(v.Db(2),v.Xc(v.nc(3,1,"SaveAndPrint")))}function V(t,e){if(1&t){const t=v.ac();v.Zb(0,"span",7),v.hc("click",(function(){return v.Ic(t),v.lc().obj.Button_Click("Delete")})),v.Ub(1,"i",46),v.Wc(2),v.mc(3,"translate"),v.Yb()}2&t&&(v.Db(2),v.Xc(v.nc(3,1,"Delete")))}function F(t,e){if(1&t){const t=v.ac();v.Zb(0,"div",26),v.Wc(1,"\n                "),v.Zb(2,"div"),v.Wc(3,"\n                  "),v.Zb(4,"div",47),v.Wc(5,"\n                    "),v.Vb(6,48),v.Wc(7,"\n                    "),v.Zb(8,"div",49),v.Wc(9,"\n                      "),v.Zb(10,"label",50),v.Wc(11),v.Yb(),v.Wc(12,"\n                      "),v.Zb(13,"div",51),v.Wc(14,"\n                        "),v.Zb(15,"span",52),v.hc("click",(function(){return v.Ic(t),v.lc().Calculate_Click("Previous")})),v.Ub(16,"i",53),v.Yb(),v.Wc(17,"\n                        "),v.Zb(18,"span",52),v.hc("click",(function(){return v.Ic(t),v.lc().Calculate_Click("Next")})),v.Ub(19,"i",54),v.Yb(),v.Wc(20,"\n                      "),v.Yb(),v.Wc(21,"\n                    "),v.Yb(),v.Wc(22,"\n                  "),v.Yb(),v.Wc(23,"\n                  \n                  \n                "),v.Yb(),v.Wc(24,"\n              "),v.Yb()}if(2&t){const t=v.lc();v.Db(6),v.tc("obj",t.obj.txtDocNo)("group",t.form),v.Db(5),v.Xc(t.obj.lblDocNo)}}function w(t,e){if(1&t&&(v.Zb(0,"div",26),v.Wc(1,"\n                "),v.Vb(2,37),v.Wc(3,"\n              "),v.Yb()),2&t){const t=v.lc();v.Db(2),v.tc("obj",t.obj.dtpDocDate)("group",t.form)}}function O(t,e){if(1&t&&(v.Zb(0,"div",55),v.Wc(1,"\n                "),v.Vb(2,37),v.Wc(3,"\n              "),v.Yb()),2&t){const t=v.lc();v.Db(2),v.tc("obj",t.obj.EmployeeList)("group",t.form)}}function W(t,e){if(1&t&&(v.Zb(0,"div",26),v.Wc(1,"\n                "),v.Vb(2,37),v.Wc(3,"\n              "),v.Yb()),2&t){const t=v.lc();v.Db(2),v.tc("obj",t.obj.cmbSettlementType)("group",t.form)}}function k(t,e){if(1&t&&(v.Zb(0,"div",26),v.Wc(1,"\n                "),v.Vb(2,37),v.Wc(3,"\n              "),v.Yb()),2&t){const t=v.lc();v.Db(2),v.tc("obj",t.obj.dtpDateOfJoining)("group",t.form)}}function B(t,e){if(1&t&&(v.Zb(0,"div",26),v.Wc(1,"\n                "),v.Vb(2,37),v.Wc(3,"\n              "),v.Yb()),2&t){const t=v.lc();v.Db(2),v.tc("obj",t.obj.dtpDateOfRelieving)("group",t.form)}}function U(t,e){if(1&t&&(v.Zb(0,"div",55),v.Wc(1,"\n                "),v.Vb(2,37),v.Wc(3,"\n              "),v.Yb()),2&t){const t=v.lc();v.Db(2),v.tc("obj",t.obj.txtRemarks)("group",t.form)}}function Y(t,e){if(1&t&&(v.Zb(0,"div",26),v.Wc(1,"\n                "),v.Vb(2,37),v.Wc(3,"\n              "),v.Yb()),2&t){const t=v.lc();v.Db(2),v.tc("obj",t.obj.txtNetAmount)("group",t.form)}}function j(t,e){if(1&t&&(v.Zb(0,"div",56),v.Wc(1,"\n              "),v.Wc(2,"\n              "),v.Ub(3,"app-PactGridView",57),v.Wc(4,"\n            "),v.Yb()),2&t){const t=v.lc();v.Db(3),v.tc("obj",t.dgvGratuity)("group",t.form)}}function H(t,e){if(1&t&&(v.Zb(0,"div",36),v.Wc(1,"\n                "),v.Vb(2,37),v.Wc(3,"\n              "),v.Yb()),2&t){const t=v.lc();v.Db(2),v.tc("obj",t.cmbResignType)("group",t.form)}}function _(t,e){if(1&t&&(v.Zb(0,"div",36),v.Wc(1,"\n                "),v.Vb(2,37),v.Wc(3,"\n              "),v.Yb()),2&t){const t=v.lc();v.Db(2),v.tc("obj",t.txtGratuityAmount)("group",t.form)}}function Z(t,e){if(1&t&&(v.Zb(0,"div",36),v.Wc(1,"\n                "),v.Vb(2,37),v.Wc(3,"\n              "),v.Yb()),2&t){const t=v.lc();v.Db(2),v.tc("obj",t.txtAvailedGratuityAmount)("group",t.form)}}function X(t,e){if(1&t&&(v.Zb(0,"div",36),v.Wc(1,"\n                "),v.Vb(2,37),v.Wc(3,"\n              "),v.Yb()),2&t){const t=v.lc();v.Db(2),v.tc("obj",t.txtPartialGratuityAmount)("group",t.form)}}function q(t,e){if(1&t&&(v.Zb(0,"div",56),v.Wc(1,"\n              "),v.Ub(2,"app-PactGridView",57),v.Wc(3,"\n            "),v.Yb()),2&t){const t=v.lc();v.Db(2),v.tc("obj",t.dgvLeaveEncash)("group",t.form)}}function Q(t,e){if(1&t&&(v.Zb(0,"div",36),v.Wc(1,"\n                "),v.Vb(2,37),v.Wc(3,"\n              "),v.Yb()),2&t){const t=v.lc();v.Db(2),v.tc("obj",t.txtCumLeaveSalBalAmt)("group",t.form)}}function J(t,e){if(1&t&&(v.Zb(0,"div",36),v.Wc(1,"\n                "),v.Vb(2,37),v.Wc(3,"\n              "),v.Yb()),2&t){const t=v.lc();v.Db(2),v.tc("obj",t.txtLEAmount)("group",t.form)}}function K(t,e){if(1&t&&(v.Zb(0,"div",56),v.Wc(1,"\n              "),v.Ub(2,"app-PactGridView",57),v.Wc(3,"\n            "),v.Yb()),2&t){const t=v.lc();v.Db(2),v.tc("obj",t.dgvUPS)("group",t.form)}}function z(t,e){if(1&t&&(v.Zb(0,"div",36),v.Wc(1,"\n                "),v.Vb(2,37),v.Wc(3,"\n              "),v.Yb()),2&t){const t=v.lc();v.Db(2),v.tc("obj",t.txtUPSAmount)("group",t.form)}}function $(t,e){if(1&t&&(v.Zb(0,"div",56),v.Wc(1,"\n              "),v.Ub(2,"app-PactGridView",57),v.Wc(3,"\n            "),v.Yb()),2&t){const t=v.lc();v.Db(2),v.tc("obj",t.dgvNoticePay)("group",t.form)}}function tt(t,e){if(1&t&&(v.Zb(0,"div",36),v.Wc(1,"\n                "),v.Vb(2,37),v.Wc(3,"\n              "),v.Yb()),2&t){const t=v.lc();v.Db(2),v.tc("obj",t.txtNPAmount)("group",t.form)}}function et(t,e){if(1&t&&(v.Zb(0,"div",56),v.Wc(1,"\n              "),v.Ub(2,"app-PactGridView",57),v.Wc(3,"\n            "),v.Yb()),2&t){const t=v.lc();v.Db(2),v.tc("obj",t.dgvOthAdd)("group",t.form)}}function at(t,e){if(1&t&&(v.Zb(0,"div",36),v.Wc(1,"\n                "),v.Vb(2,37),v.Wc(3,"\n              "),v.Yb()),2&t){const t=v.lc();v.Db(2),v.tc("obj",t.txtOthAddAmount)("group",t.form)}}function st(t,e){if(1&t&&(v.Zb(0,"div",56),v.Wc(1,"\n              "),v.Ub(2,"app-PactGridView",57),v.Wc(3,"\n            "),v.Yb()),2&t){const t=v.lc();v.Db(2),v.tc("obj",t.dgvOthDed)("group",t.form)}}function it(t,e){if(1&t&&(v.Zb(0,"div",36),v.Wc(1,"\n                "),v.Vb(2,37),v.Wc(3,"\n              "),v.Yb()),2&t){const t=v.lc();v.Db(2),v.tc("obj",t.txtOthDedAmount)("group",t.form)}}function lt(t,e){if(1&t&&(v.Zb(0,"div",56),v.Wc(1,"\n              "),v.Ub(2,"app-PactGridView",57),v.Wc(3,"\n            "),v.Yb()),2&t){const t=v.lc();v.Db(2),v.tc("obj",t.dgvLoanBal)("group",t.form)}}function ot(t,e){if(1&t&&(v.Zb(0,"div",36),v.Wc(1,"\n                "),v.Vb(2,37),v.Wc(3,"\n              "),v.Yb()),2&t){const t=v.lc();v.Db(2),v.tc("obj",t.txtLoanBalAmount)("group",t.form)}}let nt=(()=>{class t{constructor(){this.form=new s.j({}),this.IsAccordionOpen=!0,this.EmpSeqNo=0,this.GratuityGrade=0,this.EmpGrade=0,this.GratuityDocID=0,this.sDocNo="0",this.strFormula="",this.isLoaded=!1,this.dblAmount=0,this.drwRes=null,this.chkCalcBasedOnLastSal=new d.a,this.chkCalcBasedOnActDays=new d.a,this.GratuityRemarks=new l.d(0),this.LeaveRemarks=new l.d(0),this.UPSRemarks=new l.d(0),this.NoticePayRemarks=new l.d(0),this.OAddRemarks=new l.d(0),this.ODedRemarks=new l.d(0),this.LoanRemarks=new l.d(0),this.txtGratuityAmount=new l.d(0),this.txtAvailedGratuityAmount=new l.d(0),this.txtPartialGratuityAmount=new l.d(0),this.txtCumLeaveSalBalAmt=new l.d(0),this.txtLEAmount=new l.d(0),this.txtUPSAmount=new l.d(0),this.txtOthAddAmount=new l.d(0),this.txtOthDedAmount=new l.d(0),this.txtNPAmount=new l.d(0),this.txtLoanBalAmount=new l.d(0),this.lblGratuityTotalDays="",this.lblGratuityServiceDays="",this.lblGratuityLOPDays="",this.lblGratuityBalDays="",this.lblGratuityTotalGrDays="",this.lblGratuityTaken="",this.lblActRelievingDate="",this.dgvGratuity=new o.a,this.dgvLeaveEncash=new o.a,this.dgvUPS=new o.a,this.dgvOthAdd=new o.a,this.dgvOthDed=new o.a,this.dgvNoticePay=new o.a,this.dgvLoanBal=new o.a,this.lblDocNo="",this.tpGratuity="",this.tpLeaveEncashment="",this.tpUnProcessedSalary="",this.tpNoticePay="",this.tpOtherAdditions="",this.tpOtherDeductions="",this.tpLoanBalances="",this.btnCalcGratuity="",this.lbl1GratuityTotalDays="",this.lbl1GratuityServiceDays="",this.lbl1GratuityLOPDays="",this.lbl1GratuityBalDays="",this.lbl1GratuityTotalGrDays="",this.lblGratuityAmount="",this.lblAvailedGratuityAmount="",this.lblPartialGratuityAmount="",this.lbl1GratuityTaken="",this.lblCumLeaveSalBalAmt="",this.btnCalcLE="",this.lblLEAmount="",this.lblUPSAmount="",this.lblNPAmount="",this.lblOthAddAmount="",this.lblOthDedAmount="",this.lblLoanBalAmount="",this.dtEdit=null,this.iCurDocNo=0,this.CostCenterID=40095,this.DefProdID=0,this.dblBasic=0,this.EOS_ROff=0,this.dServiceDaysFormulaAmount=0,this.dblGratuityAmount=0,this.dActServiceDays=0,this.dServiceDaysAfterLOP=0,this.dLOPDays=0,this.isLast=!1,this.sVacTypeSeqNo="-1",this.EOS_GratuityFormula="",this.EOS_AvailedFormula="",this.EOS_MaxDays=0,this.dEarnedGrDays=0,this.lst=new Array,this.dTotGratuityDays=0,this.dGratuityTaken=0,this.isMaxDaysExceded=!1,this.oEvalPayFormulas=null}ngOnInit(){var t;this.obj=null===(t=this.params)||void 0===t?void 0:t.obj,this.FinalSettlement_DataContextChanged(),this.FinalSettlement_Loaded(),console.log(this)}onSelectTab(t){console.log(t),console.log(this.dgvLeaveEncash.Table),console.log(this.dgvLeaveEncash.Columns),t.length>0&&setTimeout(()=>{this[t].refreshUI(),this[t].refreshDataView()},1e3)}get txtDocNo(){return this.ViewModel.txtDocNo}get txtRemarks(){return this.ViewModel.txtRemarks}get txtNetAmount(){return this.ViewModel.txtNetAmount}get EmployeeList(){return this.ViewModel.EmployeeList}get cmbResignType(){return this.ViewModel.cmbResignType}get cmbSettlementType(){return this.ViewModel.cmbSettlementType}get dtpDocDate(){return this.ViewModel.dtpDocDate}get dtpDateOfJoining(){return this.ViewModel.dtpDateOfJoining}get dtpDateOfRelieving(){return this.ViewModel.dtpDateOfRelieving}FinalSettlement_DataContextChanged(){var t;this.ViewModel=null===(t=this.params)||void 0===t?void 0:t.obj,this.ViewModel.CalculateClick.Subscribe(this,"Calculate_Click"),this.ViewModel.EmpSelectionChanged.Subscribe(this,"Employee_SelectionChanged"),this.ViewModel.txtDocNo.LostFocusCommand.Subscribe(this,"txtDocNo_LostFocus"),this.dgvOthAdd.CellEditEnding.Subscribe(this,"dgvOthAdd_CellEndEdit"),this.dgvOthDed.CellEditEnding.Subscribe(this,"dgvOthDed_CellEndEdit")}FinalSettlement_Loaded(){this.isLoaded||(this.LoadGrids(),this.Clear_Click(),this.dsLookups=i.a.common.GetDataSet("CRM015",""),this.dgvOthAdd.Columns.find(t=>"dgColOthAddParticulars"==t.ValueBinding).ComboData=this.dsLookups.Tables[0],this.dgvOthDed.Columns.find(t=>"dgColOthDedParticulars"==t.ValueBinding).ComboData=this.dsLookups.Tables[1],this.dgvOthAdd.CanUserAddRows=!0,this.dgvOthAdd.CanUserDeleteRows=!0,this.dgvOthAdd.addEmptyRow(),this.dgvOthDed.CanUserAddRows=!0,this.dgvOthDed.CanUserDeleteRows=!0,this.dgvOthDed.addEmptyRow(),this.dgvOthAdd.refreshDataView(),this.lblDocNo=this.GetResource("VoucherNo",40095),this.tpGratuity=this.GetResource("Gratuity",40095),this.tpLeaveEncashment=this.GetResource("Leave Encashment",40095),this.tpUnProcessedSalary=this.GetResource("Un-Processed Salary",40095),this.tpNoticePay=this.GetResource("Notice Pay",40095),this.tpOtherAdditions=this.GetResource("Other Additions",40095),this.tpOtherDeductions=this.GetResource("Other Deductions",40095),this.tpLoanBalances=this.GetResource("Loan Balances",40095),this.chkCalcBasedOnLastSal.Label=this.GetResource("Calculate based on Last Salary",40095),this.chkCalcBasedOnActDays.Label=this.GetResource("Calculate Salary based on Actual Days",40095),this.btnCalcGratuity=this.GetResource("Calculate",40095),this.lbl1GratuityTotalDays=this.GetResource("Total Days",40095)+" : ",this.lbl1GratuityServiceDays=this.GetResource("Service Days",40095)+" : ",this.lbl1GratuityLOPDays=", "+this.GetResource("LOP",40095)+" : ",this.lbl1GratuityBalDays=", "+this.GetResource("Balance",40095)+" : ",this.lbl1GratuityTotalGrDays=this.GetResource("Total Gratuity Days",40095)+" : ",this.lbl1GratuityTaken=this.GetResource("Gratuity Taken",40095)+" : ",this.lblGratuityAmount=this.GetResource("Gratuity Amount",40095),this.lblAvailedGratuityAmount=this.GetResource("Availed Gratuity Amount",40095),this.lblPartialGratuityAmount=this.GetResource("Partial Gratuity Amount",40095),this.lblCumLeaveSalBalAmt=this.GetResource("Cumulative Leave Salary Balance Amount",40095),this.btnCalcLE=this.GetResource("Calculate",40095),this.lblLEAmount=this.GetResource("Amount",40095),this.lblUPSAmount=this.GetResource("Amount",40095),this.lblNPAmount=this.GetResource("Amount",40095),this.lblOthAddAmount=this.GetResource("Amount",40095),this.lblOthDedAmount=this.GetResource("Amount",40095),this.lblLoanBalAmount=this.GetResource("Amount",40095),this.isLoaded=!0,""!=this.ViewModel.sVNo&&this.LoadDocument(parseInt(this.ViewModel.sVNo.Replace("FST-",""))))}txtDocNo_LostFocus(t){try{this.txtDocNo.Text.Trim().length>0&&this.LoadDocument(parseInt(this.txtDocNo.Text.Trim()))}catch(e){this.ViewModel.DisplayMessage="Enter Valid DocNo."}}LoadDocument(t){let e;this.ViewModel.DisplayMessage="",this.ViewModel.MessageVisibility=!0,this.sDocNo=t.toString();let a=i.a.common.GetDataTable("CRM016",t.toString());if(null!=a&&a.length>0){if(!h.e.IsEmpty(i.a.SessionManager.sEmpFilteredEmpSeqNos)&&!i.a.SessionManager.sEmpFilteredEmpSeqNos.split(",").Contains(parseInt(a[0].EmpSeqNo).toString()))return this.ViewModel.DisplayMessage="You don't have permission to view this Document.",this.ViewModel.MessageVisibility=!0,this.Clear_Click(),this.txtDocNo.Text=t.toString(),void(this.EmployeeList.IsEnabled=!1);this.EmployeeList.IsEnabled=!0,this.EmployeeList.SelectedValue=parseInt(a[0].EmpSeqNo),this.EmployeeList.SelectedValue=parseInt(a[0].EmpSeqNo),this.ClearControlValues(),this.dtEdit=null,this.EmpSeqNo=parseInt(a[0].EmpSeqNo),this.dtEdit=i.a.common.GetDataTable("CRM018",this.EmpSeqNo.toString()+"~"+t),null!=this.dtEdit&&this.dtEdit.length>0&&(this.dtpDocDate.Date=new Date(this.dtEdit[0].cDocDate));let s=new Date(this.dtpDocDate.Date.getFullYear(),this.dtpDocDate.Date.iMonth(),1);if(this.dsD=i.a.common.GetDataSet3("CRM019",this.EmpSeqNo.toString()+"~"+i.a.SessionManager.UserID+"~"+i.a.SessionManager.RoleID+"~"+this.CostCenterID,this.dtpDocDate.Date.ToString("dd MMM yyyy"),s.ToString("dd/MMM/yyyy")),null!=this.dsD&&this.dsD.Tables.length>0&&this.dsD.Tables[0].length>0){if(this.dtpDateOfJoining.Date=new Date(this.dsD.Tables[0][0].DOJ),this.EmpGrade=parseInt(this.dsD.Tables[13][0].HistoryNodeID),this.cmbSettlementType.SelectedValue="Final",9e3!=new Date(this.dsD.Tables[0][0].DORelieve).getFullYear()?(this.dtpDateOfRelieving.Date=new Date(this.dsD.Tables[0][0].DORelieve),this.lblActRelievingDate=this.GetResource("Actual Relieving Date",40095)+" : "+this.dtpDateOfRelieving.Date.ToString("dd/MMM/yyyy")):this.dtpDateOfRelieving.Date=new Date,this.cmbResignType.SelectedValue=!h.e.IsEmpty(this.dsD.Tables[0][0].ResignType)&&this.dsD.Tables[0][0].ResignType.toString().startsWith("Terminated")?this.dsD.Tables[0][0].ResignType.toString():"Resigned","Posted"==h.e.String(this.dsD.Tables[0][0].ResignStatus)){let t=new Date(this.dsD.Tables[0][0].DOResign),a=new Date(t.Year,t.Month,1),s=new Date,l=a;"Terminated With Cause"==this.dsD.Tables[0][0].ResignType.toString()?""!=i.a.SessionManager.Preferences.NPTerminatedWithCause&&parseInt(i.a.SessionManager.Preferences.NPTerminatedWithCause)>0&&(s=a.AddMonths(parseInt(i.a.SessionManager.Preferences.NPTerminatedWithCause)-1)):"Terminated Without Cause"==this.dsD.Tables[0][0].ResignType.toString()?""!=i.a.SessionManager.Preferences.NPTerminatedWithOutCause&&parseInt(i.a.SessionManager.Preferences.NPTerminatedWithOutCause)>0&&(s=a.AddMonths(parseInt(i.a.SessionManager.Preferences.NPTerminatedWithOutCause)-1)):"Resigned"==this.dsD.Tables[0][0].ResignType.toString()&&""!=i.a.SessionManager.Preferences.NPResignation&&parseInt(i.a.SessionManager.Preferences.NPResignation)>0&&(s=a.AddMonths(parseInt(i.a.SessionManager.Preferences.NPResignation)-1));let o,n=new Date(this.dtpDateOfRelieving.Date.getFullYear(),this.dtpDateOfRelieving.Date.iMonth(),1);if(s<n)for(;s<n;)s=s.AddMonths(1);let r=new Date,d=new Date,c=new Date;for(;l<=s;){if(e=this.dsD.Tables[5].filter(t=>t.PayrollDate==l.ToString("dd/MMM/yyyy")),null==e||0==e.length){if(this.dgvNoticePay.addEmptyRow(),this.dgvNoticePay.Table[this.dgvNoticePay.Table.length-1].dgColNPType="Add",this.dgvNoticePay.Table[this.dgvNoticePay.Table.length-1].dgColNPPayrollMonth=l.ToString("dd/MMM/yyyy"),"Actual Days"==i.a.SessionManager.Preferences.PayDays){let t={PayrollMonth:r,PayrollMonthStart:d,PayrollMonthEnd:c};h.e.SetPayrollDate(l,t),r=t.PayrollMonth,d=t.PayrollMonthStart,c=t.PayrollMonthEnd,o=c.Subtract(d).Days+1}else o=parseInt(i.a.SessionManager.Preferences.PayDays);this.dgvNoticePay.Table[this.dgvNoticePay.Table.length-1].dgColNPMonthDays=o,this.dgvNoticePay.Table[this.dgvNoticePay.Table.length-1].dgColNPDaysAtt=0,this.dgvNoticePay.Table[this.dgvNoticePay.Table.length-1].dgColNPLOP=0,this.dgvNoticePay.Table[this.dgvNoticePay.Table.length-1].dgColNPNetSal=(0).ToString(i.a.SessionManager.sPayrollDecimals)}l=l.AddMonths(1)}}if(this.dsD.Tables[2].length>0&&(this.sVacTypeSeqNo=this.dsD.Tables[2][0].VacationField.toString()),this.ViewModel.WID=this.dsD.Tables[12].length>0?parseInt(this.dsD.Tables[12][0].WorkFlowID):0,this.dsD.Tables[1].length>0&&this.RefreshLeaveEncashDetails(),this.dsD.Tables[8].length>0&&i.a.SessionManager.Preferences.ContainsKey("DonotCalculateCumulativeLeaveSalaryBalanceinFinalSettlement")&&"False"==i.a.SessionManager.Preferences.DonotCalculateCumulativeLeaveSalaryBalanceinFinalSettlement.toString()){let t=0,e=0;for(let a=0;a<this.dsD.Columns[8].length;a++)h.e.IsEmpty(this.dsD.Tables[8][0][a])||(t+=parseFloat(this.dsD.Tables[8][0][a]));for(let a=0;a<this.dsD.Tables[9].length;a++)h.e.IsEmpty(this.dsD.Tables[9][a].Amount)||(e+=parseFloat(this.dsD.Tables[9][a].Amount));this.txtCumLeaveSalBalAmt.Text=(t-e).ToString(i.a.SessionManager.sPayrollDecimals)}else this.txtCumLeaveSalBalAmt.Text=(0).ToString(i.a.SessionManager.sPayrollDecimals);if(this.txtLEAmount.Text=parseFloat(this.txtCumLeaveSalBalAmt.Text).ToString(i.a.SessionManager.sPayrollDecimals),this.AutoCalculateLeaveEncashment(),this.dsD.Tables[3].length>0&&(this.dblBasic=parseFloat(this.dsD.Tables[3][this.dsD.Tables[3].length-1].BasicMonthly.toString())),this.dsD.Tables[4].length>0){let t;this.dgvUPS.addEmptyRows(this.dsD.Tables[4].length);for(let e=0;e<this.dsD.Tables[4].length;e++)t=new Date(this.dsD.Tables[4][e].PayrollMonth),this.dgvUPS.Table[e].dgColUPSPayrollMonth=t.ToString("dd/MMM/yyyy"),this.dgvUPS.Table[e].dgColUPSMonthDays=t.DaysInMonth(),this.dgvUPS.Table[e].dgColUPSDaysAtt=0,this.dgvUPS.Table[e].dgColUPSLOP=0,this.dgvUPS.Table[e].dgColUPSNetSal=(0).ToString(i.a.SessionManager.sPayrollDecimals),this.dgvUPS.Table[e].dgColUPSCalc=this.GetResource("Calculate",40095),this.dgvUPS.updateRow(this.dgvUPS.Table[e])}let t=0;if(this.dsD.Tables[10].length>0){this.dgvLoanBal.addEmptyRows(this.dsD.Tables[10].length);for(let e=0;e<this.dsD.Tables[10].length;e++)this.dgvLoanBal.Table[e].dgColLoanBalSNo=(e+1).toString(),this.dgvLoanBal.Table[e].dgColLoanBalDocNo=this.dsD.Tables[10][e].DocNo.toString(),this.dgvLoanBal.Table[e].dgColLoanBalDocNo_Tag=this.dsD.Tables[10][e].DocID.toString(),this.dgvLoanBal.Table[e].dgColLoanBalLoanType=this.dsD.Tables[10][e].LoanType.toString(),this.dgvLoanBal.Table[e].dgColLoanBalLoanType_Tag=this.dsD.Tables[10][e].LoanCompID.toString(),this.dgvLoanBal.Table[e].dgColLoanBalApprAmount=parseFloat(this.dsD.Tables[10][e].ApprovedAmt).ToString(i.a.SessionManager.sPayrollDecimals),this.dgvLoanBal.Table[e].dgColLoanBalAmountPaid=parseFloat(this.dsD.Tables[10][e].Paid).ToString(i.a.SessionManager.sPayrollDecimals),this.dgvLoanBal.Table[e].dgColLoanBalBalAmount=parseFloat(this.dsD.Tables[10][e].Balance).ToString(i.a.SessionManager.sPayrollDecimals),t+=parseFloat(this.dsD.Tables[10][e].Balance),this.dgvLoanBal.updateRow(this.dgvLoanBal.Table[e])}this.txtLoanBalAmount.Text=t.ToString(i.a.SessionManager.sPayrollDecimals),this.ViewModel.ApproveVisibility=!1;let a=null;if(null!=this.dtEdit&&this.dtEdit.length>0){if(this.ViewModel.DocStatus="["+this.dtEdit[0].DocStatus.toString()+"]",this.ViewModel.DocID=parseInt(this.dtEdit[0].DocID),this.sDocNo=this.dtEdit[0].DocNumber.toString(),this.txtDocNo.Text=this.sDocNo,this.dtpDocDate.Date=new Date(this.dtEdit[0].cDocDate),this.dtpDateOfRelieving.Date=new Date(this.dtEdit[0].dcAlpha3),this.txtRemarks.Text=this.dtEdit[0].CommonNarration.toString(),this.ViewModel.StatusID=parseInt(this.dtEdit[0].StatusID),this.ViewModel.WID=parseInt(this.dtEdit[0].WorkflowID),this.cmbSettlementType.Text=h.e.String(this.dtEdit[0].dcAlpha10),a=i.a.common.GetDataSet("CRM029",this.ViewModel.DocID.toString()),e=this.dtEdit.filter(t=>"1"==t.dcAlpha1),null!=e&&e.length>0&&(this.GratuityRemarks.Text=e[0].dcAlpha8.toString(),this.cmbResignType.Text=e[0].dcAlpha11.toString(),this.chkCalcBasedOnLastSal.IsChecked=Object(r.j)(e[0].dcAlpha12),this.chkCalcBasedOnActDays.IsChecked=Object(r.j)(e[0].dcAlpha13),this.Calculate_Click("Gratuity"),this.txtPartialGratuityAmount.Text=parseFloat(e[0].dcCalcNum4).ToString(i.a.SessionManager.sPayrollDecimals)),e=this.dtEdit.filter(t=>"2"==t.dcAlpha1),null!=e&&e.length>0){this.LeaveRemarks.Text=e[0].dcAlpha8.toString();for(let t=0;t<e.length;t++)for(let a=0;a<this.dgvLeaveEncash.Table.length;a++)if(e[t].dcAlpha11.toString()==this.dgvLeaveEncash.Table[a+"_Tag"].toString()){this.dgvLeaveEncash.Table[a].dgColLEAvailable=e[t].dcAlpha13.toString(),this.dgvLeaveEncash.Table[a].dgColLEMaxEncash=e[t].dcAlpha14.toString(),this.dgvLeaveEncash.Table[a].dgColLEApplied=e[t].dcAlpha15.toString();break}this.Calculate_Click("LeaveEncash")}if(e=this.dtEdit.filter(t=>"3"==t.dcAlpha1),null!=e&&e.length>0){this.UPSRemarks.Text=e[0].dcAlpha8.toString();for(let t=0;t<e.length;t++)for(let a=0;a<this.dgvUPS.Table.length;a++)if(new Date(e[t].dcAlpha11)==new Date(this.dgvUPS.Table[a].dgColUPSPayrollMonth)){this.dgvUPS.Table[a].dgColUPSDaysAtt=e[t].dcAlpha13.toString(),this.dgvUPS.Table[a].dgColUPSLOP=e[t].dcAlpha14.toString(),this.dgvUPS.Table[a].dgColUPSNetSal=e[t].dcAlpha15.toString();break}this.txtUPSAmount.Text=parseFloat(e[0].dcCalcNum1).ToString(i.a.SessionManager.sPayrollDecimals)}if(e=this.dtEdit.filter(t=>"4"==t.dcAlpha1),null!=e&&e.length>0){this.NoticePayRemarks.Text=e[0].dcAlpha8.toString();for(let t=0;t<e.length;t++)for(let a=0;a<this.dgvNoticePay.Table.length;a++)if(new Date(e[t].dcAlpha11)==new Date(this.dgvNoticePay.Table[a].dgColNPPayrollMonth)){this.dgvNoticePay.Table[a].dgColNPDaysAtt=e[t].dcAlpha13.toString(),this.dgvNoticePay.Table[a].dgColNPLOP=e[t].dcAlpha14.toString(),this.dgvNoticePay.Table[a].dgColNPNetSal=e[t].dcAlpha15.toString(),this.dgvNoticePay.Table[a].dgColNPType=e[t].dcAlpha16.toString(),this.dgvNoticePay.Table[a].dgColNPCalc=this.GetResource("Calculate",40095),this.dgvNoticePay.updateRow(this.dgvNoticePay.Table[a]);break}this.txtNPAmount.Text=parseFloat(e[0].dcCalcNum1).ToString(i.a.SessionManager.sPayrollDecimals)}if(e=this.dtEdit.filter(t=>"5"==t.dcAlpha1),null!=e&&e.length>0){this.OAddRemarks.Text=e[0].dcAlpha8.toString(),this.dgvOthAdd.addEmptyRows(e.length);for(let t=0;t<e.length;t++)this.dgvOthAdd.Table[t].dgColOthAddParticulars=parseInt(e[t].dcAlpha11.toString()),this.dgvOthAdd.Table[t].dgColOthAddAmount=e[t].dcAlpha12.toString(),h.e.IsEmpty(e[t].dcAlpha13)||(this.dgvOthAdd.Table[t].dgColOthAddRemarks=e[t].dcAlpha13.toString()),this.dgvOthAdd.updateRow(this.dgvOthAdd.Table[t]),this.dgvOthAdd_CellEndEdit(this.dgvOthAdd,2)}if(e=this.dtEdit.filter(t=>"6"==t.dcAlpha1),null!=e&&e.length>0){this.ODedRemarks.Text=e[0].dcAlpha8.toString(),this.dgvOthDed.addEmptyRows(e.length);for(let t=0;t<e.length;t++)this.dgvOthDed.Table[t].dgColOthDedParticulars=parseInt(e[t].dcAlpha11.toString()),this.dgvOthDed.Table[t].dgColOthDedAmount=e[t].dcAlpha12.toString(),h.e.IsEmpty(e[t].dcAlpha13)||(this.dgvOthDed.Table[t].dgColOthDedRemarks=e[t].dcAlpha13.toString()),this.dgvOthDed.updateRow(this.dgvOthDed.Table[t]),this.dgvOthDed_CellEndEdit(this.dgvOthDed,2)}if(e=this.dtEdit.filter(t=>"7"==t.dcAlpha1),null!=e&&e.length>0){this.LoanRemarks.Text=e[0].dcAlpha8.toString();for(let t=0;t<e.length;t++)for(let a=0;a<this.dgvLoanBal.Table.length;a++)if(e[t].dcAlpha12.toString()==this.dgvLoanBal.Table[a].dgColLoanBalDocNo_Tag.toString()){this.dgvLoanBal.Table[a].dgColLoanBalCalc_Tag="Paid",this.dgvLoanBal.Table[a].dgColLoanBalSNo_Tag=e[t].dcAlpha17.toString(),this.dgvLoanBal.updateRow(this.dgvLoanBal.Table[a]);break}}if(null!=a&&a.Tables.length>0&&a.Tables[0].length>0){let t=a.Tables[0];if(null!=t&&t.length>0)for(let e=0;e<t.length;e++){let a=new C.AddAttachmentViewModel;a.AddAttachmentViewModel_2(this.ViewModel),a.AttachmentID=parseInt(t[e].FileID),a.ActualFileName=t[e].ActualFileName.toString(),a.FileExtension=t[e].FileExtension.toString(),a.FileDescription=t[e].FileDescription.toString(),a.FilePath=h.e.GetPath(t[e].GUID+"."+t[e].FileExtension),a.RelativeFileName=t[e].RelativeFileName.toString(),a.IsProductImage=!1,this.ViewModel.ViewAttachments.AttachmentsList.push(a)}}if(this.ViewModel.WID>0){let t=i.a.common.GetDataTable("CRM020",this.dtEdit[0].InvDocDetailsID.toString()+",95,'"+i.a.SessionManager.UserName+"',40095,"+this.ViewModel.WID+","+this.dtEdit[0].WorkFlowLevel.toString()+","+this.dtEdit[0].StatusID.toString()+","+this.dtEdit[0].CreatedDate.toString()+","+i.a.SessionManager.UserID+","+i.a.SessionManager.RoleID);null!=t&&t.length>0&&(null!=t[0].CanApprove&&null!=t[0].CanApprove&&"TRUE"==t[0].CanApprove.toString().toUpperCase()?(this.ViewModel.ApproveVisibility=!0,this.ViewModel.PostVisiblility=!1):this.ViewModel.PostVisiblility=!(!i.a.SessionManager.IsActionAssigned(this.CostCenterID,"Edit Posted Docs")&&!i.a.SessionManager.IsActionAssigned(this.CostCenterID,"Edit Approved Docs")))}let t=i.a.common.GetDataSet3("CRM021",this.CostCenterID.toString(),this.ViewModel.DocID.toString());this.ViewModel.WFDocLevelList.Clear();let s=null,l=null;if(s=t.Tables[1],l=t.Tables[0],null!=s&&s.length>0&&!i.a.SessionManager.IsActionAssigned(this.CostCenterID,"HideWorkflowLevels")){let t,e=parseInt(this.dtEdit[0].WorkFlowLevel);l.length>0&&(t=parseInt(l[l.length-1].StatusID));let a=l.length>0?parseInt(l[0].WORKFLOWLEVEL)-1:0;for(let i=0;i<s.length;i++){let t=new n.a(parseInt(s[0].WID),parseInt(s[i].LEVELID),s[i].LEVELNAME.toString(),this.CostCenterID,this.ViewModel.DocID,new Date(s[i].DocDate));i==a&&(t.IsPending=!0,t.Label="C"),0==i&&(t.LeftLineBrush="#FFFFFFFF"),i==s.length-1&&(t.RightLineBrush="#FFFFFFFF"),this.ViewModel.WFDocLevelList.push(t)}for(let s=l.length-1;s>=0;s--){let t=parseInt(l[s].WORKFLOWLEVEL);if(t<=e&&t<=this.ViewModel.WFDocLevelList.length&&!this.ViewModel.WFDocLevelList[t-1].IsSet){this.ViewModel.WFDocLevelList[t-1].IsSet=!0,this.ViewModel.WFDocLevelList[t-1].ModifiedBy=l[s].STATUS.toString()+" By "+l[s].CREATEDBY.toString(),l[s].FIRSTNAME.toString().length>0&&(this.ViewModel.WFDocLevelList[t-1].ModifiedBy+="("+l[s].FIRSTNAME.toString()+")");let e=new Date(l[s].DATE);this.ViewModel.WFDocLevelList[t-1].ModifiedBy+=" On "+e.ToString(i.a.SessionManager.Preferences["Date Format"]);let a=parseInt(l[s].STATUSID);372==a?this.ViewModel.WFDocLevelList[t-1].IsRejected=!0:441==a?this.ViewModel.WFDocLevelList[t-1].IsApproved=!0:369==a&&(this.ViewModel.WFDocLevelList[t-1].IsPending=!0,this.ViewModel.WFDocLevelList[t-1].Label=" P")}}}}else this.ViewModel.DocStatus="[UnPosted]",this.ViewModel.DocID=0,this.sDocNo="0",this.ViewModel.StatusID=0,this.ViewModel.PostVisiblility=i.a.SessionManager.IsActionAssigned(this.CostCenterID,"Create"),this.ViewModel.UnPostVisiblility=i.a.SessionManager.IsActionAssigned(this.CostCenterID,"Delete");this.CalculateTotalAmount()}this.ViewModel.EmployeeList.Code.SelectedValue=parseInt(a[0].EmpSeqNo),this.ViewModel.EmployeeList.Name.SelectedValue=parseInt(a[0].EmpSeqNo),this.ViewModel.DocID=parseInt(a[0].DocID),this.ViewModel.sVoucherNo=a[0].VoucherNo.toString()}else this.Clear_Click(),this.txtDocNo.Text=t.toString(),this.dtpDocDate.SetFocus=!0}Clear_Click(){this.GetNextDocNo(),this.EmployeeList.IsEnabled=!0,this.EmployeeList.SelectedValue=0,this.EmpSeqNo=0,this.ViewModel.DocID=0,this.ClearControlValues(),this.ViewModel.sCmdParameter="",this.ViewModel.SelectedEmpID=0,this.dTotGratuityDays=0,null!=this.ViewModel&&null!=this.ViewModel.WFDocLevelList&&this.ViewModel.WFDocLevelList.Clear(),this.ViewModel.ApproveVisibility=!1,this.ViewModel.PostVisiblility=i.a.SessionManager.IsActionAssigned(this.CostCenterID,"Create"),this.ViewModel.UnPostVisiblility=i.a.SessionManager.IsActionAssigned(this.CostCenterID,"Delete"),null!=this.ViewModel.ViewAttachments&&this.ViewModel.ViewAttachments.AttachmentsList.Clear(),this.ViewModel.ViewAttachments=new y.ViewAttachmentViewModel(this.ViewModel,i.a.SessionManager,i.a.admin),this.ViewModel.OnAddAttachment()}ClearControlValues(){this.dtEdit=null,this.lblGratuityTotalDays="",this.lblGratuityServiceDays="",this.lblGratuityLOPDays="",this.lblGratuityBalDays="",this.lblGratuityTotalGrDays="",this.lblGratuityTaken="0",this.chkCalcBasedOnLastSal.Label="Calculate based on Last Salary",this.chkCalcBasedOnActDays.Label="Calculate Salary based on Actual Days",this.txtRemarks.Label=i.a.GetResource("Remarks"),this.txtRemarks.Text="",this.GratuityRemarks.Label=i.a.GetResource("Remarks"),this.GratuityRemarks.Text="",this.LeaveRemarks.Label=i.a.GetResource("Remarks"),this.LeaveRemarks.Text="",this.UPSRemarks.Label=i.a.GetResource("Remarks"),this.UPSRemarks.Text="",this.NoticePayRemarks.Label=i.a.GetResource("Remarks"),this.NoticePayRemarks.Text="",this.OAddRemarks.Label=i.a.GetResource("Remarks"),this.OAddRemarks.Text="",this.ODedRemarks.Label=i.a.GetResource("Remarks"),this.ODedRemarks.Text="",this.cmbSettlementType.SelectedIndex=0,this.LoanRemarks.Label=i.a.GetResource("Remarks"),this.LoanRemarks.Text="",this.dtpDocDate.Date=(new Date).Date(),this.cmbResignType.Label=i.a.GetResource("Resign Type"),this.cmbResignType.SelectedValue="Resigned",this.dblBasic=0,this.sDocNo="0",this.ViewModel.DocStatus="[UnPosted]",this.dGratuityTaken=0,this.dgvGratuity.Clear(),this.dgvLeaveEncash.Clear(),this.dgvUPS.Clear(),this.dgvOthAdd.Clear(),this.dgvOthDed.Clear(),this.dgvNoticePay.Clear(),this.dgvLoanBal.Clear(),this.txtGratuityAmount.Label=this.GetResource("Gratuity Amount",40095),this.txtGratuityAmount.Text=(0).ToString(i.a.SessionManager.sPayrollDecimals),this.txtGratuityAmount.Align="right",this.txtAvailedGratuityAmount.Label=this.GetResource("Availed Gratuity Amount",40095),this.txtAvailedGratuityAmount.Text=(0).ToString(i.a.SessionManager.sPayrollDecimals),this.txtAvailedGratuityAmount.Align="right",this.txtPartialGratuityAmount.Label=this.GetResource("Partial Gratuity Amount",40095),this.txtPartialGratuityAmount.Text=(0).ToString(i.a.SessionManager.sPayrollDecimals),this.txtPartialGratuityAmount.Align="right",this.txtCumLeaveSalBalAmt.Label=this.GetResource("Cumulative Leave Salary Balance Amount",40095),this.txtCumLeaveSalBalAmt.Text=(0).ToString(i.a.SessionManager.sPayrollDecimals),this.txtCumLeaveSalBalAmt.Align="right",this.txtLEAmount.Label=this.GetResource("Amount",40095),this.txtLEAmount.Text=(0).ToString(i.a.SessionManager.sPayrollDecimals),this.txtLEAmount.Align="right",this.txtUPSAmount.Label=this.GetResource("Amount",40095),this.txtUPSAmount.Text=(0).ToString(i.a.SessionManager.sPayrollDecimals),this.txtUPSAmount.Align="right",this.txtOthAddAmount.Label=this.GetResource("Amount",40095),this.txtOthAddAmount.Text=(0).ToString(i.a.SessionManager.sPayrollDecimals),this.txtOthAddAmount.Align="right",this.txtOthDedAmount.Label=this.GetResource("Amount",40095),this.txtOthDedAmount.Text=(0).ToString(i.a.SessionManager.sPayrollDecimals),this.txtOthDedAmount.Align="right",this.txtNPAmount.Label=this.GetResource("Amount",40095),this.txtNPAmount.Text=(0).ToString(i.a.SessionManager.sPayrollDecimals),this.txtNPAmount.Align="right",this.txtLoanBalAmount.Label=this.GetResource("Amount",40095),this.txtLoanBalAmount.Text=(0).ToString(i.a.SessionManager.sPayrollDecimals),this.txtLoanBalAmount.Align="right",this.txtNetAmount.Text=(0).ToString(i.a.SessionManager.sPayrollDecimals),this.txtNetAmount.Align="right",this.lblActRelievingDate="",null!=this.ViewModel.ViewAttachments&&this.ViewModel.ViewAttachments.AttachmentsList.Clear(),this.ViewModel.ViewAttachments=new y.ViewAttachmentViewModel(this.ViewModel,i.a.SessionManager,i.a.admin),this.ViewModel.OnAddAttachment()}GetNextDocNo(){let t=i.a.common.GetDataTable("CRM017","");null!=t&&(this.txtDocNo.Text=t.length>0?h.e.IsEmpty(t[0].CurrentCodeNumber)?"1":parseInt(t[0].CurrentCodeNumber).toString():"1")}Employee_SelectionChanged(t){if(this.EmpSeqNo==t)return;let e;this.EmpSeqNo=t,this.ClearControlValues();let a=new Date(this.dtpDocDate.Date.getFullYear(),this.dtpDocDate.Date.getMonth(),1);if(this.dsD=i.a.common.GetDataSet3("CRM032",this.EmpSeqNo.toString()+"~"+i.a.SessionManager.UserID+"~"+i.a.SessionManager.RoleID+"~"+this.CostCenterID,this.dtpDocDate.Date.ToString("dd MMM yyyy"),a.ToString("dd/MMM/yyyy")),null!=this.dsD&&this.dsD.Tables.length>0&&this.dsD.Tables[0].length>0){if(this.dtpDateOfJoining.Date=new Date(this.dsD.Tables[0][0].DOJ),this.EmpGrade=parseInt(this.dsD.Tables[13][0].HistoryNodeID),this.cmbSettlementType.SelectedValue="Final",9e3!=new Date(this.dsD.Tables[0][0].DORelieve).getFullYear()?(this.dtpDateOfRelieving.Date=new Date(this.dsD.Tables[0][0].DORelieve),this.lblActRelievingDate=this.GetResource("Actual Relieving Date",40095)+this.dtpDateOfRelieving.Date.ToString("dd/MMM/yyyy")):this.dtpDateOfRelieving.Date=Date.Today(),this.cmbResignType.SelectedValue=!h.e.IsEmpty(this.dsD.Tables[0][0].ResignType)&&this.dsD.Tables[0][0].ResignType.toString().startsWith("Terminated")?this.dsD.Tables[0][0].ResignType.toString():"Resigned","Posted"==this.dsD.Tables[0][0].ResignStatus.toString()){let t=new Date(this.dsD.Tables[0][0].DOResign),a=new Date,s=new Date,l=new Date,o={PayrollMonth:a,PayrollMonthStart:s,PayrollMonthEnd:l};h.e.SetPayrollDate(t,o),a=o.PayrollMonth,s=o.PayrollMonthStart,l=o.PayrollMonthEnd;let n=new Date(a.getFullYear(),a.iMonth(),1),r=new Date,d=n;"Terminated With Cause"==this.dsD.Tables[0][0].ResignType.toString()?""!=i.a.SessionManager.Preferences.NPTerminatedWithCause&&parseInt(i.a.SessionManager.Preferences.NPTerminatedWithCause)>0&&(r=n.AddMonths(parseInt(i.a.SessionManager.Preferences.NPTerminatedWithCause)-1)):"Terminated Without Cause"==this.dsD.Tables[0][0].ResignType.toString()?""!=i.a.SessionManager.Preferences.NPTerminatedWithOutCause&&parseInt(i.a.SessionManager.Preferences.NPTerminatedWithOutCause)>0&&(r=n.AddMonths(parseInt(i.a.SessionManager.Preferences.NPTerminatedWithOutCause)-1)):"Resigned"==this.dsD.Tables[0][0].ResignType.toString()&&""!=i.a.SessionManager.Preferences.NPResignation&&parseInt(i.a.SessionManager.Preferences.NPResignation)>0&&(r=n.AddMonths(parseInt(i.a.SessionManager.Preferences.NPResignation)-1)),a=new Date,s=new Date,l=new Date,o={PayrollMonth:a,PayrollMonthStart:s,PayrollMonthEnd:l},h.e.SetPayrollDate(this.dtpDateOfRelieving.Date,o),a=o.PayrollMonth,s=o.PayrollMonthStart,l=o.PayrollMonthEnd;let c=new Date(a.getFullYear(),a.iMonth(),1);if(r<c)for(;r<c;)r=r.AddMonths(1);let u=0;for(a=new Date,s=new Date,l=new Date;d<=r;){if(e=this.dsD.Tables[5].filter(t=>t.PayrollDate==d.ToString("dd/MMM/yyyy")),null==e||0==e.length){if(this.dgvNoticePay.addEmptyRow(),this.dgvNoticePay.Table[this.dgvNoticePay.Table.length-1].dgColNPType="Add",this.dgvNoticePay.Table[this.dgvNoticePay.Table.length-1].dgColNPPayrollMonth=d.ToString("dd/MMM/yyyy"),"Actual Days"==i.a.SessionManager.Preferences.PayDays){let t={PayrollMonth:a,PayrollMonthStart:s,PayrollMonthEnd:l};h.e.SetPayrollDate(d,t),a=t.PayrollMonth,s=t.PayrollMonthStart,l=t.PayrollMonthEnd,u=l.Subtract(s).Days+1}else u=parseInt(i.a.SessionManager.Preferences.PayDays);this.dgvNoticePay.Table[this.dgvNoticePay.Table.length-1].dgColNPMonthDays=u,this.dgvNoticePay.Table[this.dgvNoticePay.Table.length-1].dgColNPDaysAtt=0,this.dgvNoticePay.Table[this.dgvNoticePay.Table.length-1].dgColNPLOP=0,this.dgvNoticePay.Table[this.dgvNoticePay.Table.length-1].dgColNPNetSal=(0).ToString(i.a.SessionManager.sPayrollDecimals),this.dgvNoticePay.Table[this.dgvNoticePay.Table.length-1].dgColNPCalc=this.GetResource("Calculate",40095),this.dgvNoticePay.updateRow(this.dgvNoticePay.Table[this.dgvNoticePay.Table.length-1])}d=d.AddMonths(1)}}if(this.dsD.Tables[2].length>0&&(this.sVacTypeSeqNo=this.dsD.Tables[2][0].VacationField.toString()),this.ViewModel.WID=this.dsD.Tables[12].length>0?parseInt(this.dsD.Tables[12][0].WorkFlowID):0,this.dsD.Tables[1].length>0&&this.RefreshLeaveEncashDetails(),this.dsD.Tables[8].length>0&&i.a.SessionManager.Preferences.ContainsKey("DonotCalculateCumulativeLeaveSalaryBalanceinFinalSettlement")&&"False"==i.a.SessionManager.Preferences.DonotCalculateCumulativeLeaveSalaryBalanceinFinalSettlement.toString()){let t=0,e=0;for(let a=0;a<this.dsD.Columns[8].length;a++)h.e.IsEmpty(this.dsD.Tables[8][0][a])||(t+=parseFloat(this.dsD.Tables[8][0][a]));for(let a=0;a<this.dsD.Tables[9].length;a++)h.e.IsEmpty(this.dsD.Tables[9][a].Amount)||(e+=parseFloat(this.dsD.Tables[9][a].Amount));this.txtCumLeaveSalBalAmt.Text=(t-e).ToString(i.a.SessionManager.sPayrollDecimals)}else this.txtCumLeaveSalBalAmt.Text=(0).ToString(i.a.SessionManager.sPayrollDecimals);if(this.txtLEAmount.Text=parseFloat(this.txtCumLeaveSalBalAmt.Text).ToString(i.a.SessionManager.sPayrollDecimals),this.AutoCalculateLeaveEncashment(),this.dsD.Tables[3].length>0&&(this.dblBasic=parseFloat(this.dsD.Tables[3][this.dsD.Tables[3].length-1].BasicMonthly.toString())),this.dsD.Tables[4].length>0){let t;this.dgvUPS.addEmptyRows(this.dsD.Tables[4].length);for(let e=0;e<this.dsD.Tables[4].length;e++)t=new Date(this.dsD.Tables[4][e].PayrollMonth),this.dgvUPS.Table[e].dgColUPSPayrollMonth=t.ToString("dd/MMM/yyyy"),this.dgvUPS.Table[e].dgColUPSMonthDays=t.DaysInMonth(),this.dgvUPS.Table[e].dgColUPSDaysAtt=0,this.dgvUPS.Table[e].dgColUPSLOP=0,this.dgvUPS.Table[e].dgColUPSNetSal=(0).ToString(i.a.SessionManager.sPayrollDecimals),this.dgvUPS.Table[e].dgColNPCalc=this.GetResource("Calculate",40095),this.dgvUPS.updateRow(this.dgvUPS.Table[e])}let t=0;if(this.dsD.Tables[10].length>0){this.dgvLoanBal.addEmptyRows(this.dsD.Tables[10].length);for(let e=0;e<this.dsD.Tables[10].length;e++)this.dgvLoanBal.Table[e].dgColLoanBalSNo=(e+1).toString(),this.dgvLoanBal.Table[e].dgColLoanBalDocNo=this.dsD.Tables[10][e].DocNo.toString(),this.dgvLoanBal.Table[e].dgColLoanBalDocNo_Tag=this.dsD.Tables[10][e].DocID.toString(),this.dgvLoanBal.Table[e].dgColLoanBalLoanType=this.dsD.Tables[10][e].LoanType.toString(),this.dgvLoanBal.Table[e].dgColLoanBalLoanType_Tag=this.dsD.Tables[10][e].LoanCompID.toString(),this.dgvLoanBal.Table[e].dgColLoanBalApprAmount=parseFloat(this.dsD.Tables[10][e].ApprovedAmt).ToString(i.a.SessionManager.sPayrollDecimals),this.dgvLoanBal.Table[e].dgColLoanBalAmountPaid=parseFloat(this.dsD.Tables[10][e].Paid).ToString(i.a.SessionManager.sPayrollDecimals),this.dgvLoanBal.Table[e].dgColLoanBalBalAmount=parseFloat(this.dsD.Tables[10][e].Balance).ToString(i.a.SessionManager.sPayrollDecimals),t+=parseFloat(this.dsD.Tables[10][e].Balance),this.dgvLoanBal.updateRow(this.dgvLoanBal.Table[e])}this.txtLoanBalAmount.Text=t.ToString(i.a.SessionManager.sPayrollDecimals),this.CalculateTotalAmount()}}AutoCalculateLeaveEncashment(){i.a.SessionManager.Preferences.ContainsKey("AutoCalcLeaveEncashmentInFinalSettlement")&&"True"==i.a.SessionManager.Preferences.AutoCalcLeaveEncashmentInFinalSettlement.toString()&&this.btnCalcLeaveEncash_Click()}RefreshLeaveEncashDetails(){if(this.EmpSeqNo>0&&(this.dgvLeaveEncash.Clear(),this.dsD.Tables[1].length>0)){this.dgvLeaveEncash.addEmptyRows(this.dsD.Tables[1].length);for(let t=0;t<this.dsD.Tables[1].length;t++){this.dgvLeaveEncash.Table[t+"_Tag"]=this.dsD.Tables[1][t].SNo.toString(),this.dgvLeaveEncash.Table[t].dgColLELeaveType=this.dsD.Tables[1][t].ComponentName.toString();let e=0,a=0;if(this.dsD.Tables[1][t].ComponentID.toString()==this.sVacTypeSeqNo)this.dgvLeaveEncash.Table[t].dgColLEAvailable=this.GetVacationAvailability(this.dtpDateOfRelieving.Date,parseInt(this.sVacTypeSeqNo));else{let s={dTaken:0,dAvail:0};this.GetLeavesTaken(this.dtpDateOfJoining.Date,this.dtpDateOfRelieving.Date,this.dsD.Tables[1][t].ComponentID.toString(),s),e=s.dTaken,a=s.dAvail,this.dgvLeaveEncash.Table[t].dgColLEAvailable=a}this.dgvLeaveEncash.Table[t].dgColLEMaxEncash=parseFloat(this.dgvLeaveEncash.Table[t].dgColLEAvailable)>parseFloat(this.dsD.Tables[1][t].MaxEncashDays)?this.dsD.Tables[1][t].MaxEncashDays.toString():this.dgvLeaveEncash.Table[t].dgColLEAvailable.toString(),this.dgvLeaveEncash.Table[t].dgColLEApplied=0,this.dgvLeaveEncash.Table[t].dgColLEAmount=(0).ToString(i.a.SessionManager.sPayrollDecimals),this.dgvLeaveEncash.Table[t].dgColLEAmount_Tag=this.dsD.Tables[1][t].EncashFormula.toString(),i.a.SessionManager.Preferences.ContainsKey("AutoCalcLeaveEncashmentInFinalSettlement")&&"True"==i.a.SessionManager.Preferences.AutoCalcLeaveEncashmentInFinalSettlement.toString()&&(this.dgvLeaveEncash.Table[t].dgColLEApplied=this.dgvLeaveEncash.Table[t].dgColLEMaxEncash)}this.dgvLeaveEncash.refreshDataView()}}GetAvailableLeavesToEncash(t){t.SNo.toString();let e=t.ComponentID.toString();if(this.sVacTypeSeqNo!=e){let t=i.a.common.GetDataSet3("CRM022",this.dtpDocDate.Date.ToString("dd MMM yyyy"),new Date(this.dtpDocDate.Date.getFullYear(),parseInt(i.a.SessionManager.Preferences.LeaveYear.toString()),1).ToString("dd MMM yyyy"),this.EmpSeqNo+"~"+e);if(null!=t&&t.Tables.length>0&&t.Tables[0].length>0){let e=0,a=0,s=0;return t.Tables[1].length>0&&(a=parseFloat(t.Tables[1][0].NoOfDays.toString())),t.Tables[2].length>0&&(s=parseFloat(t.Tables[2][0].NoOfDays.toString())),e-a-s}return 0}try{return 0}catch(a){return this.ViewModel.DisplayMessage="Exception when Calculating Available leaves of Vacation Type",console.log(a),0}}GetVacationAvailability(t,e){Logger.InfoLog("CommonMonthlyPayroll::Entering GetVacationAvailability()");let a=0,s=[];s.push(t.ToString("dd/MMM/yyyy")),s.push(this.EmpSeqNo),s.push(2),s.push(i.a.SessionManager.UserID),s.push(i.a.SessionManager.LanguageID);let l=i.a.common.GetDataSet_SP(s,"spPAY_GetRemainingVacationDays");if(null!=l&&l.Tables.length>0&&l.Tables[0].length>0){let t=l.Tables[0].filter(t=>t.LeaveType==e);null!=t&&t.length>0&&(a=parseFloat(t[0].AvlblDays))}return Logger.InfoLog("CommonMonthlyPayroll::Exiting GetVacationAvailability()"),a.toString()}GetLeavesTaken(t,e,a,s){s.dTaken=s.dAvail=0;let l=[];l.push(t.ToString("dd/MMM/yyyy")),l.push(e.ToString("dd/MMM/yyyy")),l.push(this.EmpSeqNo),l.push(a),l.push("Both"),l.push(i.a.SessionManager.UserID),l.push(i.a.SessionManager.LanguageID);let o=i.a.common.GetDataSet_SP(l,"spPAY_ExtGetAvlblNoofDays");null!=o&&o.Tables.length>0&&o.Tables[0].length>0&&(h.e.IsEmpty(o.Tables[0][0].LeavesTaken)||(s.dTaken=parseFloat(o.Tables[0][0].LeavesTaken)),h.e.IsEmpty(o.Tables[0][0].AvailableLeaves)||(s.dAvail=parseFloat(o.Tables[0][0].AvailableLeaves)))}CalculateTotalAmount(){let t=0;t+="Partial"==this.cmbSettlementType.SelectedValue?parseFloat(this.txtPartialGratuityAmount.Text):parseFloat(this.txtAvailedGratuityAmount.Text)-this.dGratuityTaken,t+=parseFloat(this.txtLEAmount.Text),t+=parseFloat(this.txtUPSAmount.Text),t+=parseFloat(this.txtOthAddAmount.Text),t-=parseFloat(this.txtOthDedAmount.Text),t+=parseFloat(this.txtNPAmount.Text),t-=parseFloat(this.txtLoanBalAmount.Text),this.txtNetAmount.Text=t.ToString(i.a.SessionManager.sPayrollDecimals)}GenerateSerialNos(t){for(let e=0;e<t.Table.length;e++)t.Table[e].Text=e+1;t.refreshDataView()}LoadGrids(){let t;this.SetGridProperties(this.dgvLeaveEncash),t=new p.a,t.DisplayMember="dgColLELeaveType",t.Header=this.GetResource("Leave Type",40095),t.ReadOnly=!0,this.dgvLeaveEncash.Columns.push(t),this.dgvLeaveEncash.TableColumns.push("dgColLELeaveType"),t=new p.a,t.DisplayMember="dgColLEAvailable",t.Header=this.GetResource("Available Days",40095),t.ReadOnly=!0,t.TextAlign="Center",this.dgvLeaveEncash.Columns.push(t),this.dgvLeaveEncash.TableColumns.push("dgColLEAvailable"),t=new p.a,t.DisplayMember="dgColLEMaxEncash",t.Header=this.GetResource("Max Encash Days",40095),t.ReadOnly=!0,t.TextAlign="Center",this.dgvLeaveEncash.Columns.push(t),this.dgvLeaveEncash.TableColumns.push("dgColLEMaxEncash"),t=new p.a,t.DisplayMember="dgColLEApplied",t.Header=this.GetResource("Applied Days",40095),t.TextAlign="Center",this.dgvLeaveEncash.Columns.push(t),this.dgvLeaveEncash.TableColumns.push("dgColLEApplied"),t=new p.a,t.DisplayMember="dgColLEAmount",t.Header=this.GetResource("Encash Amount",40095),t.ReadOnly=!0,t.TextAlign="Right",this.dgvLeaveEncash.Columns.push(t),this.dgvLeaveEncash.TableColumns.push("dgColLEAmount"),this.SetGridProperties(this.dgvUPS),t=new p.a,t.DisplayMember="dgColUPSPayrollMonth",t.Header=this.GetResource("Payroll Month",40095),t.ReadOnly=!0,t.TextAlign="Center",this.dgvUPS.Columns.push(t),this.dgvUPS.TableColumns.push("dgColUPSPayrollMonth"),t=new p.a,t.DisplayMember="dgColUPSMonthDays",t.Header=this.GetResource("Month Days",40095),t.ReadOnly=!0,t.TextAlign="Center",this.dgvUPS.Columns.push(t),this.dgvUPS.TableColumns.push("dgColUPSMonthDays"),t=new p.a,t.DisplayMember="dgColUPSDaysAtt",t.Header=this.GetResource("Days Attended",40095),t.ReadOnly=!0,t.TextAlign="Center",this.dgvUPS.Columns.push(t),this.dgvUPS.TableColumns.push("dgColUPSDaysAtt"),t=new p.a,t.DisplayMember="dgColUPSLOP",t.Header=this.GetResource("LOP Days",40095),t.ReadOnly=!0,t.TextAlign="Center",this.dgvUPS.Columns.push(t),this.dgvUPS.TableColumns.push("dgColUPSLOP"),t=new p.a,t.DisplayMember="dgColUPSNetSal",t.Header=this.GetResource("Net Salary",40095),t.ReadOnly=!0,t.TextAlign="Right",this.dgvUPS.Columns.push(t),this.dgvUPS.TableColumns.push("dgColUPSNetSal"),t=new p.a,t.DataType="LINK",t.DisplayMember="dgColUPSCalc",t.Header=this.GetResource("Calculate",40095),t.TextAlign="Center",t.Click.Subscribe(this,"dgvUPS_CellClick"),this.dgvUPS.Columns.push(t),this.dgvUPS.TableColumns.push("dgColUPSCalc"),this.SetGridProperties(this.dgvNoticePay),t=new p.a,t.DataType="ComboBox",t.ValueBinding="dgColNPType",t.DisplayMember="Name",t.ValueMember="Value",t.Header=this.GetResource("Type",40095);let e=new Array;e.push(T.d.ComboBoxItems_2("Add","Add")),e.push(T.d.ComboBoxItems_2("Subtract","Subtract")),e.push(T.d.ComboBoxItems_2("None","None")),t.ComboData=e,this.dgvNoticePay.Columns.push(t),this.dgvNoticePay.TableColumns.push("dgColNPType"),t=new p.a,t.DisplayMember="dgColNPPayrollMonth",t.Header=this.GetResource("Payroll Month",40095),t.ReadOnly=!0,t.TextAlign="Center",this.dgvNoticePay.Columns.push(t),this.dgvNoticePay.TableColumns.push("dgColNPPayrollMonth"),t=new p.a,t.DisplayMember="dgColNPMonthDays",t.Header=this.GetResource("Month Days",40095),t.ReadOnly=!0,t.TextAlign="Center",this.dgvNoticePay.Columns.push(t),this.dgvNoticePay.TableColumns.push("dgColNPMonthDays"),t=new p.a,t.DisplayMember="dgColNPDaysAtt",t.Header=this.GetResource("Days Attended",40095),t.ReadOnly=!0,t.TextAlign="Center",this.dgvNoticePay.Columns.push(t),this.dgvNoticePay.TableColumns.push("dgColNPDaysAtt"),t=new p.a,t.DisplayMember="dgColNPLOP",t.Header=this.GetResource("LOP Days",40095),t.ReadOnly=!0,t.TextAlign="Center",this.dgvNoticePay.Columns.push(t),this.dgvNoticePay.TableColumns.push("dgColNPLOP"),t=new p.a,t.DisplayMember="dgColNPNetSal",t.Header=this.GetResource("Net Salary",40095),t.ReadOnly=!0,t.TextAlign="Right",this.dgvNoticePay.Columns.push(t),this.dgvNoticePay.TableColumns.push("dgColNPNetSal"),t=new p.a,t.DataType="LINK",t.DisplayMember="dgColNPCalc",t.Header=this.GetResource("Calculate",40095),t.TextAlign="Center",t.Click.Subscribe(this,"dgvNoticePay_CellClick"),this.dgvNoticePay.Columns.push(t),this.dgvNoticePay.TableColumns.push("dgColNPCalc"),this.SetGridProperties(this.dgvOthAdd),t=new p.a,t.DisplayMember="dgColOthAddSNo",t.Header="#",t.ReadOnly=!0,t.TextAlign="Center",this.dgvOthAdd.Columns.push(t),this.dgvOthAdd.TableColumns.push("dgColOthAddSNo"),t=new p.a,t.DataType="ComboBox",t.ValueBinding="dgColOthAddParticulars",t.DisplayMember="Name",t.ValueMember="NodeID",t.Header=this.GetResource("Particulars",40095),this.dgvOthAdd.Columns.push(t),this.dgvOthAdd.TableColumns.push("dgColOthAddParticulars"),t=new p.a,t.DisplayMember="dgColOthAddAmount",t.Header=this.GetResource("Amount",40095),t.TextAlign="Right",this.dgvOthAdd.Columns.push(t),this.dgvOthAdd.TableColumns.push("dgColOthAddAmount"),t=new p.a,t.DisplayMember="dgColOthAddRemarks",t.Header=this.GetResource("LineNarration",40095),this.dgvOthAdd.Columns.push(t),this.dgvOthAdd.TableColumns.push("dgColOthAddRemarks"),this.SetGridProperties(this.dgvOthDed),t=new p.a,t.DisplayMember="dgColOthDedSNo",t.Header="#",t.ReadOnly=!0,t.TextAlign="Center",this.dgvOthDed.Columns.push(t),this.dgvOthDed.TableColumns.push("dgColOthDedSNo"),t=new p.a,t.DataType="ComboBox",t.ValueBinding="dgColOthDedParticulars",t.DisplayMember="Name",t.ValueMember="NodeID",t.Header=this.GetResource("Particulars",40095),this.dgvOthDed.Columns.push(t),this.dgvOthDed.TableColumns.push("dgColOthDedParticulars"),t=new p.a,t.DisplayMember="dgColOthDedAmount",t.Header=this.GetResource("Amount",40095),t.TextAlign="Right",this.dgvOthDed.Columns.push(t),this.dgvOthDed.TableColumns.push("dgColOthDedAmount"),t=new p.a,t.DisplayMember="dgColOthDedRemarks",t.Header=this.GetResource("LineNarration",40095),this.dgvOthDed.Columns.push(t),this.dgvOthDed.TableColumns.push("dgColOthDedRemarks"),this.SetGridProperties(this.dgvLoanBal),t=new p.a,t.DisplayMember="dgColLoanBalSNo",t.Header="#",t.ReadOnly=!0,t.TextAlign="Center",this.dgvLoanBal.Columns.push(t),this.dgvLoanBal.TableColumns.push("dgColLoanBalSNo"),t=new p.a,t.DisplayMember="dgColLoanBalDocNo",t.Header=this.GetResource("Loan Doc. No.",40095),t.ReadOnly=!0,this.dgvLoanBal.Columns.push(t),this.dgvLoanBal.TableColumns.push("dgColLoanBalDocNo"),t=new p.a,t.DisplayMember="dgColLoanBalLoanType",t.Header=this.GetResource("Loan Type",40095),t.ReadOnly=!0,this.dgvLoanBal.Columns.push(t),this.dgvLoanBal.TableColumns.push("dgColLoanBalLoanType"),t=new p.a,t.DisplayMember="dgColLoanBalApprAmount",t.Header=this.GetResource("Approved Amount",40095),t.ReadOnly=!0,t.TextAlign="Right",this.dgvLoanBal.Columns.push(t),this.dgvLoanBal.TableColumns.push("dgColLoanBalApprAmount"),t=new p.a,t.DisplayMember="dgColLoanBalAmountPaid",t.Header=this.GetResource("Amount Paid",40095),t.ReadOnly=!0,t.TextAlign="Right",this.dgvLoanBal.Columns.push(t),this.dgvLoanBal.TableColumns.push("dgColLoanBalAmountPaid"),t=new p.a,t.DisplayMember="dgColLoanBalBalAmount",t.Header=this.GetResource("Balance Amount",40095),t.ReadOnly=!0,t.TextAlign="Right",this.dgvLoanBal.Columns.push(t),this.dgvLoanBal.TableColumns.push("dgColLoanBalBalAmount"),t=new p.a,t.DisplayMember="dgColLoanBalRemarks",t.Header=this.GetResource("LineNarration",40095),this.dgvLoanBal.Columns.push(t),this.dgvLoanBal.TableColumns.push("dgColLoanBalRemarks"),t=new p.a,t.DataType="LINK",t.DisplayMember="dgColLoanBalCalc",t.Header=this.GetResource("Pay",40095),t.TextAlign="Center",this.dgvLoanBal.Columns.push(t),this.dgvLoanBal.TableColumns.push("dgColLoanBalCalc")}SetGridProperties(t){t.Table=[],t.Columns=[]}Calculate_Click(t){switch(t){case"Gratuity":this.btnCalcGratuity_Click();break;case"LeaveEncash":this.btnCalcLeaveEncash_Click();break;case"Clear":this.Clear_Click();break;case"Save":this.Save_Click();break;case"Delete":this.Delete_Click();break;case"Previous":this.Previous_Click();break;case"Next":this.Next_Click();break;case"Approve":this.Approve_Click()}return""}Approve_Click(){let t=new I.a(this.CostCenterID,this.ViewModel.DocID,null,this.ViewModel);i.a.page.ShowDialog(t,S.a,{ShowCenter:!0,Title:i.a.GetResource("ApproveReject")})}Next_Click(){this.iCurDocNo=parseInt(this.txtDocNo.Text.Trim()),this.LoadDocument(this.iCurDocNo+1)}Previous_Click(){this.iCurDocNo=parseInt(this.txtDocNo.Text.Trim()),this.iCurDocNo>1&&this.LoadDocument(this.iCurDocNo-1)}Delete_Click(){if(""!=this.sDocNo&&parseInt(this.sDocNo)>0){if(confirm("Are you sure want to Delete.?")){let t=0,e=[];e.push(40095),e.push(this.ViewModel.DocID),e.push(1);let a=i.a.document.DeleteSelectedRows(e,t);this.ViewModel.DisplayMessage=a.Message,t=a.RetValue,this.ViewModel.MessageVisibility=!0,this.Clear_Click()}}else this.ViewModel.DisplayMessage="Select any saved Document to Delete",this.ViewModel.MessageVisibility=!0}Save_Click(){if(this.ValidateSave()){let t=[];t.push(this.CostCenterID),t.push(this.ViewModel.DocID),t.push(""),t.push(this.txtDocNo.Text),t.push(this.dtpDocDate.Date.ToString("dd/MMM/yyyy")),t.push(this.dtpDocDate.Date.ToString("dd/MMM/yyyy")),t.push(""),t.push(this.GetDocumentXML()),t.push(""),t.push(""),t.push(this.ViewModel.ViewAttachments.GetXML()),t.push(this.GetActivityXML()),t.push("false"),i.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"True"==i.a.SessionManager.Preferences.EnableLocationWise.toString()?t.push(i.a.SessionManager.LocationID>0?i.a.SessionManager.LocationID:1):t.push(0),i.a.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&"True"==i.a.SessionManager.Preferences.EnableDivisionWise.toString()?t.push(i.a.SessionManager.DivisionID>0?i.a.SessionManager.DivisionID:1):t.push(0),t.push(this.ViewModel.WID),t.push(i.a.SessionManager.RoleID),t.push(""),t.push(0),t.push(0),t.push(i.a.SessionManager.CompanyGUID),t.push(i.a.SessionManager.UserName),t.push(i.a.SessionManager.UserID),t.push(i.a.SessionManager.LanguageID),t.push(i.a.SessionManager.IsOffline);let e=0,a="";i.a.document.SetTempInvDocument(t).subscribe(t=>{e=t.obj;let s=t;if(a=null!=s&&s.Tables.length>0&&s.Tables[s.Tables.length-1].length>0&&s.Columns[s.Tables.length-1].Contains("ErrorMessage")?s.Tables[s.Tables.length-1][0].ErrorMessage.toString():"Problem in processing your request,Please contact administrator.",e>0){let t=[];t.push(e),t.push(i.a.SessionManager.UserID),t.push(i.a.SessionManager.LanguageID);let s=this.ViewModel.PostApplyLeaves(parseInt(i.a.SessionManager.CompanyIndex),t,"spPAY_PostApplyLeaves");null!=s&&s.Tables.length>0&&(a="Problem in processing your request,Please contact administrator."),this.ViewModel.SelectedEmpID=this.EmpSeqNo,this.Clear_Click()}else null!=s&&s.Tables.length>0&&s.Tables[s.Tables.length-1].length>0&&s.Columns[s.Tables.length-1].Contains("ServerMessage")&&(e="-407"==s.Tables[s.Tables.length-1][0].ServerMessage.toString()?-407:-12345);this.ViewModel.DisplayMessage=a,this.ViewModel.MessageVisibility=!0})}}GetActivityXML(){let t="<XML   ";return"Approve"==this.ViewModel.sCmdParameter&&(t+=' AppRejDate="'+Date.Today().ToString("dd/MMM/yyyy")+'"'),t+=" >",t+=" </XML> ",t}GetDocumentXML(){let t,e="",a="",s="",l="",o="",n="";if(new Array,null!=i.a.SessionManager.dtDocDefAccs&&(t=i.a.SessionManager.dtDocDefAccs.filter(t=>40095==t.CostCenterID&&"CreditAccount"==t.SysColumnName),null!=t&&t.length>0&&null!=t[0].UserDefaultValue&&""!=t[0].UserDefaultValue.toString().Trim()&&(o=t[0].UserDefaultValue.toString()),t=i.a.SessionManager.dtDocDefAccs.filter(t=>40095==t.CostCenterID&&"DebitAccount"==t.SysColumnName),null!=t&&t.length>0&&null!=t[0].UserDefaultValue&&""!=t[0].UserDefaultValue.toString().Trim()&&(n=t[0].UserDefaultValue.toString())),a+='" ProductID="'+this.DefProdID+'" Quantity="0" Unit="1" UOMConversion="1" UOMConvertedQty="0" Rate="0" Gross="0" IsQtyIgnored="1" AverageRate="0" StockValue="0" StockValueFC="0" RefNO="" BillDate="'+i.a.SessionManager.PayrollMonth.ToString("dd/MMM/yyyy")+'" CurrencyID="1" ExchangeRate="1" DebitAccount="'+n+'" CreditAccount="'+o+'" CommonNarration="'+h.e.EncodeXML(this.txtRemarks.Text),null!=this.dgvGratuity&&this.dgvGratuity.Table.length>0){let t=1;for(let i=0;i<this.dgvGratuity.Table.length;i++)e+="\x11",e+="<Row>",e+="<AccountsXML></AccountsXML>",e+='<Transactions DocSeqNo="1" VoucherType="0" LinkedInvDocDetailsID="0" LinkedFieldName="" LineNarration="Gratuity',l="",e+=l.length>0?'" DocDetailsID="'+l:'" DocDetailsID="',e+=a.toString()+'" ></Transactions>',s='<Numeric Query="',s+=" dcNum1="+parseFloat(this.txtGratuityAmount.Text).toString().Replace(",","")+",",s+=" dcCalcNum1="+parseFloat(this.txtGratuityAmount.Text).toString().Replace(",","")+",",s+=" dcNum2="+parseFloat(this.txtAvailedGratuityAmount.Text).toString().Replace(",","")+",",s+=" dcCalcNum2="+parseFloat(this.txtAvailedGratuityAmount.Text).toString().Replace(",","")+",",s+=" dcNum3="+parseFloat(this.txtNetAmount.Text).toString().Replace(",","")+",",s+=" dcCalcNum3="+parseFloat(this.txtNetAmount.Text).toString().Replace(",","")+",",s+=" dcNum4="+parseFloat(this.txtPartialGratuityAmount.Text).toString().Replace(",","")+",",s+=" dcCalcNum4="+parseFloat(this.txtPartialGratuityAmount.Text).toString().Replace(",","")+",",s+='" ></Numeric>',e+=s,s='<Alpha Query="',s+=" dcAlpha1='1',",s+=" dcAlpha2='"+t+"',",s+=" dcAlpha3='"+this.dtpDateOfRelieving.Date.ToString("dd/MMM/yyyy")+"',",s+=" dcAlpha4='"+this.lblGratuityServiceDays+"',",s+=" dcAlpha5='"+this.lblGratuityLOPDays+"',",s+=" dcAlpha6='"+this.lblGratuityBalDays+"',",s+=" dcAlpha7='"+this.lblGratuityTotalGrDays+"',",s+=" dcAlpha8='"+this.GratuityRemarks.Text+"',",s+=" dcAlpha9='"+this.GratuityGrade+"',",s+=" dcAlpha10='"+this.cmbSettlementType.Text+"',",s+=" dcAlpha11='"+this.cmbResignType.SelectedValue+"',",s+=" dcAlpha12='"+this.chkCalcBasedOnLastSal.IsChecked+"',",s+=" dcAlpha13='"+this.chkCalcBasedOnActDays.IsChecked+"',",s+=" dcAlpha14='"+this.lblGratuityTotalDays+"',",s+=" dcAlpha15='"+this.dgvGratuity.Table[i][this.dgvGratuity.TableColumns[1]]+"',",s+=" dcAlpha16='"+this.dgvGratuity.Table[i+1][this.dgvGratuity.TableColumns[2]]+"',",s+=" dcAlpha17='"+this.dgvGratuity.Table[i+1][this.dgvGratuity.TableColumns[4]]+"',",s+=" dcAlpha18='"+this.dgvGratuity.Table[i+2][this.dgvGratuity.TableColumns[1]]+"',",s+=" dcAlpha19='"+this.dgvGratuity.Table[i+3][this.dgvGratuity.TableColumns[1]]+"',",s+=" dcAlpha20='"+this.dgvGratuity.Table[i+3][this.dgvGratuity.TableColumns[4]]+"',",s+=" dcAlpha21='"+this.dgvGratuity.Table[i+5][this.dgvGratuity.TableColumns[1]]+"',",s+=" dcAlpha22='"+this.dgvGratuity.Table[i+5][this.dgvGratuity.TableColumns[2]]+"',",s+=" dcAlpha23='"+this.dgvGratuity.Table[i+5][this.dgvGratuity.TableColumns[3]]+"',",s+=" dcAlpha24='"+this.dgvGratuity.Table[i+6][this.dgvGratuity.TableColumns[1]]+"',",s+=" dcAlpha25='"+this.dgvGratuity.Table[i+6][this.dgvGratuity.TableColumns[2]]+"',",s+=" dcAlpha26='"+this.dgvGratuity.Table[i+6][this.dgvGratuity.TableColumns[3]]+"',",s+=" dcAlpha27='"+this.dgvGratuity.Table[i+6][this.dgvGratuity.TableColumns[5]]+"',",s+=" dcAlpha28='"+this.dgvGratuity.Table[i+6][this.dgvGratuity.TableColumns[7]]+"',",s+=" dcAlpha29='"+this.dgvGratuity.Table[i+7][this.dgvGratuity.TableColumns[5]]+"',",s+=" dcAlpha30='"+this.dgvGratuity.Table[i+3][this.dgvGratuity.TableColumns[6]]+"',",s+=" dcAlpha31='"+this.GratuityDocID+"',",s+=" dcAlpha32='"+this.lblGratuityTaken+"',",s+='" ></Alpha>',e+=s,s='<CostCenters Query="',s+=" dcCCNID51="+this.EmpSeqNo+",",s+=" dcCCNID53="+this.EmpGrade+",",s+='" ></CostCenters>',e+=s,e+="<EXTRAXML></EXTRAXML>",e+="</Row>",i+=8,t++}if(null!=this.dgvLeaveEncash&&this.dgvLeaveEncash.Table.length>0){let t=1;for(let i=0;i<this.dgvLeaveEncash.Table.length;i++)0!=h.e.Double(this.dgvLeaveEncash.Table[i].dgColLEAmount)&&(e+="\x11",e+="<Row>",e+="<AccountsXML></AccountsXML>",e+='<Transactions DocSeqNo="1" VoucherType="0" LinkedInvDocDetailsID="0" LinkedFieldName="" LineNarration="Leave Encashment',l="",e+=l.length>0?'" DocDetailsID="'+l:'" DocDetailsID="',e+=a.toString()+'" ></Transactions>',s='<Numeric Query="',s+=" dcNum1="+parseFloat(this.txtLEAmount.Text).toString().Replace(",","")+",",s+=" dcCalcNum1="+parseFloat(this.txtLEAmount.Text).toString().Replace(",","")+",",s+=" dcNum2="+parseFloat(this.txtCumLeaveSalBalAmt.Text).toString().Replace(",","")+",",s+=" dcCalcNum2="+parseFloat(this.txtCumLeaveSalBalAmt.Text).toString().Replace(",","")+",",s+=" dcNum3="+parseFloat(this.txtNetAmount.Text).toString().Replace(",","")+",",s+=" dcCalcNum3="+parseFloat(this.txtNetAmount.Text).toString().Replace(",","")+",",s+='" ></Numeric>',e+=s,s='<Alpha Query="',s+=" dcAlpha1='2',",s+=" dcAlpha2='"+t+"',",s+=" dcAlpha3='"+this.dtpDateOfRelieving.Date.ToString("dd/MMM/yyyy")+"',",s+=" dcAlpha8='"+this.LeaveRemarks.Text+"',",s+=" dcAlpha10='"+this.cmbSettlementType.Text+"',",s+=" dcAlpha11='"+this.dgvLeaveEncash.Table[i+"_Tag"].toString()+"',",s+=" dcAlpha12='"+this.dgvLeaveEncash.Table[i].dgColLELeaveType+"',",s+=" dcAlpha13='"+this.dgvLeaveEncash.Table[i].dgColLEAvailable+"',",s+=" dcAlpha14='"+this.dgvLeaveEncash.Table[i].dgColLEMaxEncash+"',",s+=" dcAlpha15='"+this.dgvLeaveEncash.Table[i].dgColLEApplied+"',",s+=" dcAlpha16='"+this.dgvLeaveEncash.Table[i].dgColLEAmount.toString().Replace(",","")+"',",s+='" ></Alpha>',e+=s,s='<CostCenters Query="',s+=" dcCCNID51="+this.EmpSeqNo+",",s+=" dcCCNID53="+this.EmpGrade+",",s+='" ></CostCenters>',e+=s,e+="<EXTRAXML></EXTRAXML>",e+="</Row>",t++)}if(null!=this.dgvUPS&&this.dgvUPS.Table.length>0){let t=1;for(let i=0;i<this.dgvUPS.Table.length;i++)h.e.Double(this.dgvUPS.Table[i].dgColUPSNetSal)>0&&(e+="\x11",e+="<Row>",e+="<AccountsXML></AccountsXML>",e+='<Transactions DocSeqNo="1" VoucherType="0" LinkedInvDocDetailsID="0" LinkedFieldName="" LineNarration="Un-Processed Salary',l="",e+=l.length>0?'" DocDetailsID="'+l:'" DocDetailsID="',e+=a.toString()+'" ></Transactions>',s='<Numeric Query="',s+=" dcNum1="+parseFloat(this.txtUPSAmount.Text).toString().Replace(",","")+",",s+=" dcCalcNum1="+parseFloat(this.txtUPSAmount.Text).toString().Replace(",","")+",",s+=" dcNum3="+parseFloat(this.txtNetAmount.Text).toString().Replace(",","")+",",s+=" dcCalcNum3="+parseFloat(this.txtNetAmount.Text).toString().Replace(",","")+",",s+='" ></Numeric>',e+=s,s='<Alpha Query="',s+=" dcAlpha1='3',",s+=" dcAlpha2='"+t+"',",s+=" dcAlpha3='"+this.dtpDateOfRelieving.Date.ToString("dd/MMM/yyyy")+"',",s+=" dcAlpha8='"+this.UPSRemarks.Text+"',",s+=" dcAlpha10='"+this.cmbSettlementType.Text+"',",s+=" dcAlpha11='"+this.dgvUPS.Table[i].dgColUPSPayrollMonth+"',",s+=" dcAlpha12='"+this.dgvUPS.Table[i].dgColUPSMonthDays+"',",s+=" dcAlpha13='"+this.dgvUPS.Table[i].dgColUPSDaysAtt+"',",s+=" dcAlpha14='"+this.dgvUPS.Table[i].dgColUPSLOP+"',",s+=" dcAlpha15='"+this.dgvUPS.Table[i].dgColUPSNetSal.toString().Replace(",","")+"',",s+='" ></Alpha>',e+=s,s='<CostCenters Query="',s+=" dcCCNID51="+this.EmpSeqNo+",",s+=" dcCCNID53="+this.EmpGrade+",",s+='" ></CostCenters>',e+=s,e+="<EXTRAXML></EXTRAXML>",e+="</Row>",t++)}if(null!=this.dgvNoticePay&&this.dgvNoticePay.Table.length>0){let t=1;for(let i=0;i<this.dgvNoticePay.Table.length;i++)h.e.Double(this.dgvNoticePay.Table[i].dgColNPNetSal)>0&&(e+="\x11",e+="<Row>",e+="<AccountsXML></AccountsXML>",e+='<Transactions DocSeqNo="1" VoucherType="0" LinkedInvDocDetailsID="0" LinkedFieldName="" LineNarration="Notice Pay',l="",e+=l.length>0?'" DocDetailsID="'+l:'" DocDetailsID="',e+=a.toString()+'" ></Transactions>',s='<Numeric Query="',s+=" dcNum1="+parseFloat(this.txtNPAmount.Text).toString().Replace(",","")+",",s+=" dcCalcNum1="+parseFloat(this.txtNPAmount.Text).toString().Replace(",","")+",",s+=" dcNum3="+parseFloat(this.txtNetAmount.Text).toString().Replace(",","")+",",s+=" dcCalcNum3="+parseFloat(this.txtNetAmount.Text).toString().Replace(",","")+",",s+='" ></Numeric>',e+=s,s='<Alpha Query="',s+=" dcAlpha1='4',",s+=" dcAlpha2='"+t+"',",s+=" dcAlpha3='"+this.dtpDateOfRelieving.Date.ToString("dd/MMM/yyyy")+"',",s+=" dcAlpha8='"+this.NoticePayRemarks.Text+"',",s+=" dcAlpha10='"+this.cmbSettlementType.Text+"',",s+=" dcAlpha11='"+this.dgvNoticePay.Table[i].dgColNPPayrollMonth+"',",s+=" dcAlpha12='"+this.dgvNoticePay.Table[i].dgColNPMonthDays+"',",s+=" dcAlpha13='"+this.dgvNoticePay.Table[i].dgColNPDaysAtt+"',",s+=" dcAlpha14='"+this.dgvNoticePay.Table[i].dgColNPLOP+"',",s+=" dcAlpha15='"+this.dgvNoticePay.Table[i].dgColNPNetSal.toString().Replace(",","")+"',",s+=" dcAlpha16='"+this.dgvNoticePay.Table[i].dgColNPType+"',",s+='" ></Alpha>',e+=s,s='<CostCenters Query="',s+=" dcCCNID51="+this.EmpSeqNo+",",s+=" dcCCNID53="+this.EmpGrade+",",s+='" ></CostCenters>',e+=s,e+="<EXTRAXML></EXTRAXML>",e+="</Row>",t++)}if(null!=this.dgvOthAdd&&this.dgvOthAdd.Table.length>0){let t=1;for(let i=0;i<this.dgvOthAdd.Table.length;i++)!h.e.IsEmpty(this.dgvOthAdd.Table[i].dgColOthAddParticulars)&&h.e.Double(this.dgvOthAdd.Table[i].dgColOthAddAmount)>0&&(e+="\x11",e+="<Row>",e+="<AccountsXML></AccountsXML>",e+='<Transactions DocSeqNo="1" VoucherType="0" LinkedInvDocDetailsID="0" LinkedFieldName="" LineNarration="Other Additions',l="",e+=l.length>0?'" DocDetailsID="'+l:'" DocDetailsID="',e+=a.toString()+'" ></Transactions>',s='<Numeric Query="',s+=" dcNum1="+parseFloat(this.txtOthAddAmount.Text).toString().Replace(",","")+",",s+=" dcCalcNum1="+parseFloat(this.txtOthAddAmount.Text).toString().Replace(",","")+",",s+=" dcNum3="+parseFloat(this.txtNetAmount.Text).toString().Replace(",","")+",",s+=" dcCalcNum3="+parseFloat(this.txtNetAmount.Text).toString().Replace(",","")+",",s+='" ></Numeric>',e+=s,s='<Alpha Query="',s+=" dcAlpha1='5',",s+=" dcAlpha2='"+t+"',",s+=" dcAlpha3='"+this.dtpDateOfRelieving.Date.ToString("dd/MMM/yyyy")+"',",s+=" dcAlpha8='"+this.OAddRemarks.Text+"',",s+=" dcAlpha10='"+this.cmbSettlementType.Text+"',",s+=" dcAlpha11='"+this.dgvOthAdd.Table[i].dgColOthAddParticulars+"',",s+=" dcAlpha12='"+this.dgvOthAdd.Table[i].dgColOthAddAmount.toString().Replace(",","")+"',",h.e.IsEmpty(this.dgvOthAdd.Table[i].dgColOthAddRemarks)||(s+=" dcAlpha13='"+this.dgvOthAdd.Table[i].dgColOthAddRemarks+"',"),s+='" ></Alpha>',e+=s,s='<CostCenters Query="',s+=" dcCCNID51="+this.EmpSeqNo+",",s+=" dcCCNID53="+this.EmpGrade+",",s+='" ></CostCenters>',e+=s,e+="<EXTRAXML></EXTRAXML>",e+="</Row>",t++)}if(null!=this.dgvOthDed&&this.dgvOthDed.Table.length>0){let t=1;for(let i=0;i<this.dgvOthDed.Table.length;i++)!h.e.IsEmpty(this.dgvOthDed.Table[i].dgColOthDedParticulars)&&h.e.Double(this.dgvOthDed.Table[i].dgColOthDedAmount)>0&&(e+="\x11",e+="<Row>",e+="<AccountsXML></AccountsXML>",e+='<Transactions DocSeqNo="1" VoucherType="0" LinkedInvDocDetailsID="0" LinkedFieldName="" LineNarration="Other Deductions',l="",e+=l.length>0?'" DocDetailsID="'+l:'" DocDetailsID="',e+=a.toString()+'" ></Transactions>',s='<Numeric Query="',s+=" dcNum1="+parseFloat(this.txtOthDedAmount.Text).toString().Replace(",","")+",",s+=" dcCalcNum1="+parseFloat(this.txtOthDedAmount.Text).toString().Replace(",","")+",",s+=" dcNum3="+parseFloat(this.txtNetAmount.Text).toString().Replace(",","")+",",s+=" dcCalcNum3="+parseFloat(this.txtNetAmount.Text).toString().Replace(",","")+",",s+='" ></Numeric>',e+=s,s='<Alpha Query="',s+=" dcAlpha1='6',",s+=" dcAlpha2='"+t+"',",s+=" dcAlpha3='"+this.dtpDateOfRelieving.Date.ToString("dd/MMM/yyyy")+"',",s+=" dcAlpha8='"+this.ODedRemarks.Text+"',",s+=" dcAlpha10='"+this.cmbSettlementType.Text+"',",s+=" dcAlpha11='"+this.dgvOthDed.Table[i].dgColOthDedParticulars+"',",s+=" dcAlpha12='"+this.dgvOthDed.Table[i].dgColOthDedAmount.toString().Replace(",","")+"',",null!=this.dgvOthDed.Table[i].dgColOthDedRemarks&&""!=this.dgvOthDed.Table[i].dgColOthDedRemarks.toString().Trim()&&(s+=" dcAlpha13='"+this.dgvOthDed.Table[i].dgColOthDedRemarks+"',"),s+='" ></Alpha>',e+=s,s='<CostCenters Query="',s+=" dcCCNID51="+this.EmpSeqNo+",",s+=" dcCCNID53="+this.EmpGrade+",",s+='" ></CostCenters>',e+=s,e+="<EXTRAXML></EXTRAXML>",e+="</Row>",t++)}if(null!=this.dgvLoanBal&&this.dgvLoanBal.Table.length>0){let t=1;for(let i=0;i<this.dgvLoanBal.Table.length;i++)h.e.IsEmpty(this.dgvLoanBal.Table[i].dgColLoanBalDocNo_Tag)||(e+="\x11",e+="<Row>",e+="<AccountsXML></AccountsXML>",e+='<Transactions DocSeqNo="1" VoucherType="0" LinkedInvDocDetailsID="0" LinkedFieldName="" LineNarration="Loan Balances',l="",e+=l.length>0?'" DocDetailsID="'+l:'" DocDetailsID="',e+=a.toString()+'" ></Transactions>',s='<Numeric Query="',s+=" dcNum1="+parseFloat(this.txtLoanBalAmount.Text).toString().Replace(",","")+",",s+=" dcCalcNum1="+parseFloat(this.txtLoanBalAmount.Text).toString().Replace(",","")+",",s+=" dcNum3="+parseFloat(this.txtNetAmount.Text).toString().Replace(",","")+",",s+=" dcCalcNum3="+parseFloat(this.txtNetAmount.Text).toString().Replace(",","")+",",s+='" ></Numeric>',e+=s,s='<Alpha Query="',s+=" dcAlpha1='7',",s+=" dcAlpha2='"+t+"',",s+=" dcAlpha3='"+this.dtpDateOfRelieving.Date.ToString("dd/MMM/yyyy")+"',",s+=" dcAlpha8='"+this.LoanRemarks.Text+"',",s+=" dcAlpha10='"+this.cmbSettlementType.Text+"',",s+=" dcAlpha11='"+this.dgvLoanBal.Table[i].dgColLoanBalDocNo+"',",s+=" dcAlpha12='"+this.dgvLoanBal.Table[i].dgColLoanBalDocNo_Tag+"',",s+=" dcAlpha13='"+this.dgvLoanBal.Table[i].dgColLoanBalLoanType_Tag+"',",s+=" dcAlpha14='"+this.dgvLoanBal.Table[i].dgColLoanBalApprAmount.toString().Replace(",","")+"',",s+=" dcAlpha15='"+this.dgvLoanBal.Table[i].dgColLoanBalAmountPaid.toString().Replace(",","")+"',",s+=" dcAlpha16='"+this.dgvLoanBal.Table[i].dgColLoanBalBalAmount.toString().Replace(",","")+"',",s+=" dcAlpha17='"+this.dgvLoanBal.Table[i].dgColLoanBalSNo_Tag+"',",s+='" ></Alpha>',e+=s,s='<CostCenters Query="',s+=" dcCCNID51="+this.EmpSeqNo+",",s+=" dcCCNID53="+this.EmpGrade+",",s+='" ></CostCenters>',e+=s,e+="<EXTRAXML></EXTRAXML>",e+="</Row>",t++)}return e.toString()}GetCalcXML(){let t="";if(t+="<Rows>",this.dgvGratuity.Table.length>0){let e=1;for(let a=0;a<this.dgvGratuity.Table.length;a++)t+='<Row DType="1" SubDType="'+e+'" Field1="'+this.cmbResignType.SelectedValue+'" Field2="'+this.chkCalcBasedOnLastSal.IsChecked+'" Field3="'+this.chkCalcBasedOnActDays.IsChecked+'" Field4="'+this.lblGratuityTotalDays+'" Field5="'+this.dgvGratuity.Table[a][this.dgvGratuity.TableColumns[1]]+'" Field6="'+this.dgvGratuity.Table[a+1][this.dgvGratuity.TableColumns[2]]+'" Field7="'+this.dgvGratuity.Table[a+1][this.dgvGratuity.TableColumns[4]]+'" Field8="'+this.dgvGratuity.Table[a+2][this.dgvGratuity.TableColumns[1]]+'" Field9="'+this.dgvGratuity.Table[a+3][this.dgvGratuity.TableColumns[1]]+'" Field10="'+this.dgvGratuity.Table[a+3][this.dgvGratuity.TableColumns[4]]+'" Field11="'+this.dgvGratuity.Table[a+5][this.dgvGratuity.TableColumns[1]]+'" Field12="'+this.dgvGratuity.Table[a+5][this.dgvGratuity.TableColumns[2]]+'" Field13="'+this.dgvGratuity.Table[a+5][this.dgvGratuity.TableColumns[3]]+'" Field14="'+this.dgvGratuity.Table[a+6][this.dgvGratuity.TableColumns[1]]+'" Field15="'+this.dgvGratuity.Table[a+6][this.dgvGratuity.TableColumns[2]]+'" Field16="'+this.dgvGratuity.Table[a+6][this.dgvGratuity.TableColumns[3]]+'" Field17="'+this.dgvGratuity.Table[a+6][this.dgvGratuity.TableColumns[5]]+'" Field18="'+this.dgvGratuity.Table[a+6][this.dgvGratuity.TableColumns[7]]+'" Field19="'+this.dgvGratuity.Table[a+7][this.dgvGratuity.TableColumns[5]]+'" Field20="'+this.dgvGratuity.Table[a+3][this.dgvGratuity.TableColumns[6]],t+='" />',a+=8,e++}if(this.dgvLeaveEncash.Table.length>0)for(let e=0;e<this.dgvLeaveEncash.Table.length;e++)0!=h.e.Double(this.dgvLeaveEncash.Table[e].dgColLEAmount)&&(t+='<Row DType="2" SubDType="'+e+'1" Field1="'+this.dgvLeaveEncash.Table[e+"_Tag"].toString()+'" Field2="'+this.dgvLeaveEncash.Table[e].dgColLELeaveType+'" Field3="'+this.dgvLeaveEncash.Table[e].dgColLEAvailable+'" Field4="'+this.dgvLeaveEncash.Table[e].dgColLEMaxEncash+'" Field5="'+this.dgvLeaveEncash.Table[e].dgColLEApplied+'" Field6="'+this.dgvLeaveEncash.Table[e].dgColLEAmount,t+='" />');if(this.dgvUPS.Table.length>0)for(let e=0;e<this.dgvUPS.Table.length;e++)h.e.Double(this.dgvUPS.Table[e].dgColUPSNetSal)>0&&(t+='<Row DType="3" SubDType="'+e+'1" Field1="'+this.dgvUPS.Table[e].dgColUPSPayrollMonth+'" Field2="'+this.dgvUPS.Table[e].dgColUPSMonthDays+'" Field3="'+this.dgvUPS.Table[e].dgColUPSDaysAtt+'" Field4="'+this.dgvUPS.Table[e].dgColUPSLOP+'" Field5="'+this.dgvUPS.Table[e].dgColUPSNetSal,t+='" />');if(this.dgvNoticePay.Table.length>0)for(let e=0;e<this.dgvNoticePay.Table.length;e++)h.e.Double(this.dgvNoticePay.Table[e].dgColNPNetSal)>0&&(t+='<Row DType="4" SubDType="'+e+'1" Field1="'+this.dgvNoticePay.Table[e].dgColNPPayrollMonth+'" Field2="'+this.dgvNoticePay.Table[e].dgColNPMonthDays+'" Field3="'+this.dgvNoticePay.Table[e].dgColNPDaysAtt+'" Field4="'+this.dgvNoticePay.Table[e].dgColNPLOP+'" Field5="'+this.dgvNoticePay.Table[e].dgColNPNetSal+'" Field6="'+this.dgvNoticePay.Table[e].dgColNPType,t+='" />');if(this.dgvOthAdd.Table.length>0)for(let e=0;e<this.dgvOthAdd.Table.length;e++)!h.e.IsEmpty(this.dgvOthAdd.Table[e].dgColOthAddParticulars)&&h.e.Double(this.dgvOthAdd.Table[e].dgColOthAddAmount)>0&&(t+='<Row DType="5" SubDType="'+e+'1" Field1="'+this.dgvOthAdd.Table[e].dgColOthAddParticulars+'" Field2="'+this.dgvOthAdd.Table[e].dgColOthAddAmount,h.e.IsEmpty(this.dgvOthAdd.Table[e].dgColOthAddRemarks)||(t+='" Field3="'+this.dgvOthAdd.Table[e].dgColOthAddRemarks),t+='" />');if(this.dgvOthDed.Table.length>0)for(let e=0;e<this.dgvOthDed.Table.length;e++)!h.e.IsEmpty(this.dgvOthDed.Table[e].dgColOthDedParticulars)&&h.e.Double(this.dgvOthDed.Table[e].dgColOthDedAmount)>0&&(t+='<Row DType="6" SubDType="'+e+'1" Field1="'+this.dgvOthDed.Table[e].dgColOthDedParticulars+'" Field2="'+this.dgvOthDed.Table[e].dgColOthDedAmount,h.e.IsEmpty(this.dgvOthDed.Table[e].dgColOthDedRemarks)||(t+='" Field3="'+this.dgvOthDed.Table[e].dgColOthDedRemarks),t+='" />');if(this.dgvLoanBal.Table.length>0)for(let e=0;e<this.dgvLoanBal.Table.length;e++)h.e.IsEmpty(this.dgvLoanBal.Table[e].dgColLoanBalDocNo_Tag)||(t+='<Row DType="7" SubDType="'+e+'1" Field1="'+this.dgvLoanBal.Table[e].dgColLoanBalDocNo+'" Field2="'+this.dgvLoanBal.Table[e].dgColLoanBalDocNo_Tag+'" Field3="'+this.dgvLoanBal.Table[e].dgColLoanBalLoanType_Tag+'" Field4="'+this.dgvLoanBal.Table[e].dgColLoanBalApprAmount+'" Field5="'+this.dgvLoanBal.Table[e].dgColLoanBalAmountPaid+'" Field6="'+this.dgvLoanBal.Table[e].dgColLoanBalBalAmount+'" Field7="'+this.dgvLoanBal.Table[e].dgColLoanBalSNo_Tag,t+='" />');return t+="</Rows>",t.toString()}ValidateSave(){if(0==this.EmpSeqNo)return this.ViewModel.DisplayMessage="Please Select Employee.",this.EmployeeList.SetFocus=!0,!1;if(null!=this.dsD&&this.dsD.Tables[0].length>0&&"Final"==this.cmbSettlementType.SelectedValue&&(9e3==new Date(this.dsD.Tables[0][0].DORelieve).getFullYear()||null==this.dsD.Tables[0][0].DORelieve.toString()||""==this.dsD.Tables[0][0].DORelieve.toString()||null==this.dsD.Tables[0][0].DORelieve||""==h.e.String(this.dsD.Tables[0][0].ResignStatus)||"Posted"!=h.e.String(this.dsD.Tables[0][0].ResignStatus)))return this.ViewModel.DisplayMessage="Selected Employee not yet Resigned, Please check",!1;if(this.dgvLoanBal.Table.length>0)for(let t=0;t<this.dgvLoanBal.Table.length;t++)if(h.e.IsEmpty(this.dgvLoanBal.Table[t].dgColLoanBalCalc_Tag))return this.ViewModel.DisplayMessage="Please pay pending Loan Balance amounts.",!1;return null!=i.a.SessionManager.Preferences.PayrollProduct&&""!=i.a.SessionManager.Preferences.PayrollProduct&&(this.DefProdID=parseInt(i.a.SessionManager.Preferences.PayrollProduct)),0!=this.DefProdID||(this.ViewModel.DisplayMessage="Select any Default Payroll Product at Global Preferences",!1)}btnCalcGratuity_Click(){this.dgvGratuity.Columns.Clear(),this.dgvGratuity.TableColumns.Clear(),this.dgvGratuity.Clear();let t={dTotGratuitySal:0};if(this.dEarnedGrDays=0,this.isMaxDaysExceded=!1,this.dTotGratuityDays=0,!(this.EmpSeqNo>0))return this.ViewModel.DisplayMessage="Select any Employee",void(this.EmployeeList.SetFocus=!0);{let e=i.a.common.GetDataSet3("CRM023",this.EmpSeqNo.toString(),this.dtpDateOfRelieving.Date.Date().ToString("dd MMM yyyy"));if(null!=e&&e.Tables.length>0){if(this.dLOPDays=0,this.dLOPDays=parseFloat(this.dsD.Tables[0][0].OPLOPDays),e.Tables[2].length>0)if(null!=this.dtEdit&&this.dtEdit.length>0){let t=this.dtEdit.filter(t=>"1"==t.dcAlpha1&&"1"==t.dcAlpha2);null!=t&&t.length>0&&(this.dGratuityTaken=parseFloat(""==h.e.String(t[0].dcAlpha32)?"0":t[0].dcAlpha32))}else this.dGratuityTaken=parseFloat(e.Tables[2][0].GratuityTaken);if(!(e.Tables[0].length>0))return void(this.ViewModel.DisplayMessage="Gratuity settings not found for this Grade.");{let a,s=this.dtpDateOfJoining.Date.Date(),l=this.dtpDateOfRelieving.Date.Date();if(this.LoadExperinceDaysData(this.lst,e.Tables[0],"Resigned"==this.cmbResignType.SelectedValue?0:1),this.GratuityDocID=parseInt(e.Tables[0][0].DocID),this.GratuityGrade=parseInt(e.Tables[0][0].GradeID),this.EOS_MaxDays=h.e.Double(e.Tables[0][0].MaxDays),this.EOS_ExcludeLOP=e.Tables[0][0].ExcludeLOP.toString(),this.ActEOS_ExcludeLOP=e.Tables[0][0].ExcludeLOP.toString(),this.EOS_ROff=h.e.Double(e.Tables[0][0].ROff),this.EOS_CalcBasedOn=e.Tables[0][0].CalcBasedOn.toString(),this.EOS_GratuityFormula=e.Tables[0][0].Formula.toString(),this.EOS_AvailedFormula=null!=e.Tables[0][0].AvailedFormula&&null!=e.Tables[0][0].AvailedFormula&&""!=e.Tables[0][0].AvailedFormula.toString().Trim()?e.Tables[0][0].AvailedFormula.toString():"GratuityAmount","Exclude at Last"==this.EOS_ExcludeLOP){this.EOS_ExcludeLOP="No";let t=new Date(this.dtpDateOfJoining.Date.getFullYear(),this.dtpDateOfJoining.Date.getMonth(),1),e=new Date(this.dtpDateOfRelieving.Date.getFullYear(),this.dtpDateOfRelieving.Date.getMonth(),1),a=0;a=this.GetPreviousLOPDays(t,e),this.dLOPDays+=a;let s=i.a.common.GetDataSet3("CRM024",this.EmpSeqNo.toString(),t.ToString("dd/MMM/yyyy"),e.ToString("dd/MMM/yyyy"));null!=s&&s.Tables.length>0&&(s.Tables[0].length>0&&(this.dLOPDays+=parseFloat(s.Tables[0][0].LOP.toString())),s.Tables[1].length>0&&(this.dLOPDays-=parseFloat(s.Tables[1][0].LOP.toString()))),l=l.AddDays(-this.dLOPDays)}for(let t=0;t<8;t++)a=new p.a,a.DisplayMember="Column"+t,a.ReadOnly=!0,a.Header="",a.Width=0==t?150:80,this.dgvGratuity.Columns.push(a),this.dgvGratuity.TableColumns.push(a.DisplayMember);if(this.dgvGratuity.RefreshColumns(),this.dActServiceDays=l.Subtract(s).Days+1,"Service Days"==this.EOS_CalcBasedOn){if(this.dServiceDaysAfterLOP=0,"No"!=this.EOS_ExcludeLOP){let t=new Date(this.dtpDateOfJoining.Date.getFullYear(),this.dtpDateOfJoining.Date.getMonth(),1),e=new Date(this.dtpDateOfRelieving.Date.getFullYear(),this.dtpDateOfRelieving.Date.getMonth(),1),a=0;a=this.GetPreviousLOPDays(t,e),this.dLOPDays+=a;let s=i.a.common.GetDataSet3("CRM025",this.EmpSeqNo.toString(),t.ToString("dd/MMM/yyyy"),e.ToString("dd/MMM/yyyy"));null!=s&&s.Tables.length>0&&s.Tables[0].length>0&&(this.dLOPDays+=parseFloat(s.Tables[0][0].LOP.toString()))}this.dServiceDaysAfterLOP=this.dActServiceDays-this.dLOPDays,this.EOS_GratuityFormula=this.EOS_GratuityFormula.Replace("ServiceDays",this.dActServiceDays.toString()),this.EOS_GratuityFormula=this.EOS_GratuityFormula.Replace("LOPDays",this.dLOPDays.toString()),this.EOS_AvailedFormula=this.EOS_AvailedFormula.Replace("ServiceDays",this.dActServiceDays.toString())}this.dblGratuityAmount=parseFloat(this.dsD.Tables[3][this.dsD.Tables[3].length-1].BasicMonthly);let o=this.dtpDateOfJoining.Date.Date(),n=this.dtpDateOfRelieving.Date.Date(),r=0,d=0,u=0,g={iY:r,iM:d,iD:u};if(h.e.GetYearsMonthsDays(o,n,g),r=g.iY,d=g.iM,u=g.iD,"Service Days"==this.EOS_CalcBasedOn){this.CalcGratuityBasedOnServiceDays(this.dblGratuityAmount,s,l,t);let a=0,o=0,n=0,d={iY:a,iM:o,iD:n};h.e.GetYearsMonthsDays(s,l,d),a=d.iY,o=d.iM,n=d.iD,this.lblGratuityTotalDays=a+" : "+this.GetResource("Years",40095)+", "+o+" : "+this.GetResource("Months",40095)+", "+n+" : "+this.GetResource("Days",40095),this.txtGratuityAmount.Text=t.dTotGratuitySal.ToString(i.a.SessionManager.sPayrollDecimals),this.CalculateTotalAmount(),this.oEvalPayFormulas=new c.b,this.oEvalPayFormulas.sEmpSeqNo=this.EmpSeqNo.toString();let u={PayrollMonth:this.oEvalPayFormulas.PayrollMonth,PayrollMonthStart:this.oEvalPayFormulas.PayrollMonthStart,PayrollMonthEnd:this.oEvalPayFormulas.PayrollMonthEnd};if(h.e.SetPayrollDate(this.dtpDocDate.Date.Date(),u),this.oEvalPayFormulas.PayrollMonth=u.PayrollMonth,this.oEvalPayFormulas.PayrollMonthStart=u.PayrollMonthStart,this.oEvalPayFormulas.PayrollMonthEnd=u.PayrollMonthEnd,this.oEvalPayFormulas.arrLstCPFields[6].Clear(),this.oCPF=new c.a,this.oCPF.ComponentName="GratuityAvailedFormula",this.oCPF.SNo=0,this.oCPF.Formula=this.EOS_AvailedFormula,this.oCPF.dEarned=this.oCPF.dActual="0",this.oEvalPayFormulas.arrLstCPFields[6].push(this.oCPF),e.Tables[1].length>0){this.dgvOthAdd.addEmptyRows(e.Tables[1].length);for(let t=0;t<e.Tables[1].length;t++)this.oCPF=new c.a,this.oCPF.ComponentName="Lookup"+e.Tables[1][t].NodeID.toString(),this.oCPF.SNo=t+1,null!=e.Tables[0][0][e.Tables[1][t].SysColumnName.toString()]&&null!=e.Tables[0][0][e.Tables[1][t].SysColumnName.toString()]&&(this.oCPF.Formula=e.Tables[0][0][e.Tables[1][t].SysColumnName.toString()].toString()),this.oCPF.dEarned=this.oCPF.dActual="0",this.oEvalPayFormulas.arrLstCPFields[6].push(this.oCPF),this.dgvOthAdd.Table[t].dgColOthAddParticulars=parseInt(e.Tables[1][t].NodeID.toString()),this.dgvOthAdd.updateRow(this.dgvOthAdd.Table[t])}this.oEvalPayFormulas.othMPField.sResignType=this.cmbResignType.SelectedValue.toString(),this.oEvalPayFormulas.othMPField.GratuityAmount=parseFloat(this.txtGratuityAmount.Text),this.oEvalPayFormulas.othMPField.dServiceDays=this.dActServiceDays,this.oEvalPayFormulas.othMPField.dServiceYears=r,this.oEvalPayFormulas.Intialize(),this.oEvalPayFormulas.ExecuteAllFormulas();for(let t=0;t<this.oEvalPayFormulas.arrLstCPFields[6].length;t++)if("GratuityAvailedFormula"==this.oEvalPayFormulas.arrLstCPFields[6][t].ComponentName)this.txtPartialGratuityAmount.Text="Partial"==this.cmbSettlementType.SelectedValue?(parseFloat(this.txtAvailedGratuityAmount.Text)-this.dGratuityTaken).ToString(i.a.SessionManager.sPayrollDecimals):(0).ToString(i.a.SessionManager.sPayrollDecimals),this.txtAvailedGratuityAmount.Text=parseFloat(this.oEvalPayFormulas.arrLstCPFields[6][t].dEarned).ToString(i.a.SessionManager.sPayrollDecimals);else for(let e=0;e<this.dgvOthAdd.Table.length;e++)if(this.oEvalPayFormulas.arrLstCPFields[6][t].ComponentName=="Lookup"+h.e.String(this.dgvOthAdd.Table[e].dgColOthAddParticulars)){this.dgvOthAdd.Table[e].dgColOthAddAmount=parseFloat(this.oEvalPayFormulas.arrLstCPFields[6][t].dEarned).ToString(i.a.SessionManager.sPayrollDecimals),this.dgvOthAdd.updateRow(this.dgvOthAdd.Table[e]),this.dgvOthAdd_CellEndEdit(this.dgvOthAdd,2);break}return}let m,b=s,D=0,T=0,y=0,C={iY:D,iM:T,iD:y};h.e.GetYearsMonthsDays(s,l,C),D=C.iY,T=C.iM,y=C.iD;let I=!!this.chkCalcBasedOnLastSal.IsChecked&&this.chkCalcBasedOnLastSal.IsChecked,S=this.dblGratuityAmount,x=new Array,v=new Array,P=new Array;x.push(b);for(let t=0;t<this.lst.length;t++){if(D<parseInt(this.lst[t].Year.Replace("=",""))){v.push(l),P.push(P.length>0?P[P.length-1]:0);break}if(this.lst[t].Days>0){if(this.lst[t].IsApplyToPrevYrs)for(let e=0;e<P.length;e++)P[e]=this.lst[t].Days;if(m=b.AddYears(parseInt(this.lst[t].Year.Replace("=",""))).AddDays(-1),m>=l){m=l,v.push(m),P.push(this.lst[t].Days);break}P.Contains(this.lst[t].Days)?(v[v.length-1]=m,x[x.length-1]=m.AddDays(1)):(P.push(this.lst[t].Days),v.push(m),x.push(m.AddDays(1)))}}if(this.isLast=!1,x.length>0)for(let e=0;e<x.length;e++)if(e==x.length-1&&(this.isLast=!0),I){if(x.length>e+1)if(P[e]!=P[e+1]){if(this.CalcGratuityDays(P[e],S,x[e],v[e],t),this.isMaxDaysExceded)break}else v[e]=v[e+1],x.RemoveAt(e+1),v.RemoveAt(e+1),P.RemoveAt(e+1),e--;else if(this.CalcGratuityDays(P[e],S,x[e],v[e],t),this.isMaxDaysExceded)break}else if(x.length>e+1)if(P[e]!=P[e+1]){let a=this.dsD.Tables[3].filter(t=>new Date(t.dtEffectFrom)>=x[e].AddDays(1)&&new Date(t.dtEffectFrom)<=v[e]),s=this.dsD.Tables[3].filter(t=>new Date(t.dtEffectFrom)<=x[e]);if(s.SortBy([{name:"dtEffectFrom",desc:!0}]),null!=a&&a.length>0){let i,l=0;for(l=0;l<a.length;l++)if(0==l){if(this.CalcGratuityDays(P[e],parseFloat(s[0].BasicMonthly),x[e],new Date(a[l].dtEffectFrom).AddDays(-1),t),this.isMaxDaysExceded){i=!0;break}}else if(this.CalcGratuityDays(P[e],parseFloat(a[l-1].BasicMonthly),new Date(a[l-1].dtEffectFrom),new Date(a[l].dtEffectFrom).AddDays(-1),t),this.isMaxDaysExceded){i=!0;break}if(i)break;if(this.CalcGratuityDays(P[e],parseFloat(a[l-1].BasicMonthly),new Date(a[l-1].dtEffectFrom),v[e],t),this.isMaxDaysExceded)break}else if(this.CalcGratuityDays(P[e],parseFloat(s[0].BasicMonthly),x[e],v[e],t),this.isMaxDaysExceded)break}else v[e]=v[e+1],x.RemoveAt(e+1),v.RemoveAt(e+1),P.RemoveAt(e+1),e--;else{let a=this.dsD.Tables[3].filter(t=>new Date(t.dtEffectFrom)>=x[e].AddDays(1)&&new Date(t.dtEffectFrom)<=v[e]),s=this.dsD.Tables[3].filter(t=>new Date(t.dtEffectFrom)<=x[e]);if(s.SortBy([{name:"dtEffectFrom",desc:!0}]),null!=a&&a.length>0){let i,l=0;for(l=0;l<a.length;l++)if(0==l){if(this.CalcGratuityDays(P[e],parseFloat(s[0].BasicMonthly),x[e],new Date(a[l].dtEffectFrom).AddDays(-1),t),this.isMaxDaysExceded){i=!0;break}}else if(this.CalcGratuityDays(P[e],parseFloat(a[l-1].BasicMonthly),new Date(a[l-1].dtEffectFrom),new Date(a[l].dtEffectFrom).AddDays(-1),t),this.isMaxDaysExceded){i=!0;break}if(i)break;if(this.CalcGratuityDays(P[e],parseFloat(a[l-1].BasicMonthly),new Date(a[l-1].dtEffectFrom),v[e],t),this.isMaxDaysExceded)break}else if(this.CalcGratuityDays(P[e],parseFloat(s[0].BasicMonthly),x[e],v[e],t),this.isMaxDaysExceded)break}let A=0,f=0,M=0,E={iY:A,iM:f,iD:M};h.e.GetYearsMonthsDays(s,l,E),A=E.iY,f=E.iM,M=E.iD,this.lblGratuityTotalDays=A+" : "+this.GetResource("Years",40095)+", "+f+" : "+this.GetResource("Months",40095)+", "+M+" : "+this.GetResource("Days",40095),this.txtGratuityAmount.Text=t.dTotGratuitySal.ToString(i.a.SessionManager.sPayrollDecimals);let L=this.dtpDateOfRelieving.Date.Date().Subtract(s.Date()).Days+1;if(this.lblGratuityServiceDays=L.toString(),this.lblGratuityLOPDays=this.dLOPDays.toString(),this.lblGratuityBalDays=(L-this.dLOPDays).toString(),this.lblGratuityTotalGrDays=this.dTotGratuityDays.toString(),this.lblGratuityTaken=this.dGratuityTaken.toString(),this.oEvalPayFormulas=new c.b,this.oEvalPayFormulas.sEmpSeqNo=this.EmpSeqNo.toString(),g={PayrollMonth:this.oEvalPayFormulas.PayrollMonth,PayrollMonthStart:this.oEvalPayFormulas.PayrollMonthStart,PayrollMonthEnd:this.oEvalPayFormulas.PayrollMonthEnd},h.e.SetPayrollDate(this.dtpDocDate.Date.Date(),g),this.oEvalPayFormulas.PayrollMonth=g.PayrollMonth,this.oEvalPayFormulas.PayrollMonthStart=g.PayrollMonthStart,this.oEvalPayFormulas.PayrollMonthEnd=g.PayrollMonthEnd,this.oEvalPayFormulas.arrLstCPFields[6].Clear(),this.oCPF=new c.a,this.oCPF.ComponentName="GratuityAvailedFormula",this.oCPF.SNo=0,this.oCPF.Formula=this.EOS_AvailedFormula,this.oCPF.dEarned=this.oCPF.dActual="0",this.oEvalPayFormulas.arrLstCPFields[6].push(this.oCPF),e.Tables[1].length>0){this.dgvOthAdd.addEmptyRows(e.Tables[1].length);for(let t=0;t<e.Tables[1].length;t++)this.oCPF=new c.a,this.oCPF.ComponentName="Lookup"+e.Tables[1][t].NodeID.toString(),this.oCPF.SNo=t+1,h.e.IsEmpty(e.Tables[0][0][e.Tables[1][t].SysColumnName.toString()])||(this.oCPF.Formula=e.Tables[0][0][e.Tables[1][t].SysColumnName.toString()].toString()),this.oCPF.dEarned=this.oCPF.dActual="0",this.oEvalPayFormulas.arrLstCPFields[6].push(this.oCPF),this.dgvOthAdd.Table[t].dgColOthAddParticulars.Value=parseInt(e.Tables[1][t].NodeID.toString()),this.dgvOthAdd.updateRow(this.dgvOthAdd.Table[t])}this.oEvalPayFormulas.othMPField.IsFinalSettlement=!0,this.oEvalPayFormulas.othMPField.sResignType=this.cmbResignType.SelectedValue.toString(),this.oEvalPayFormulas.othMPField.GratuityAmount=parseFloat(this.txtGratuityAmount.Text),this.oEvalPayFormulas.othMPField.dServiceDays=this.dActServiceDays,this.oEvalPayFormulas.othMPField.dServiceYears=r,this.oEvalPayFormulas.Intialize(),this.oEvalPayFormulas.ExecuteAllFormulas();for(let t=0;t<this.oEvalPayFormulas.arrLstCPFields[6].length;t++)if("GratuityAvailedFormula"==this.oEvalPayFormulas.arrLstCPFields[6][t].ComponentName)this.txtPartialGratuityAmount.Text="Partial"==this.cmbSettlementType.SelectedValue?(parseFloat(this.txtAvailedGratuityAmount.Text)-this.dGratuityTaken).ToString(i.a.SessionManager.sPayrollDecimals):(0).ToString(i.a.SessionManager.sPayrollDecimals),this.txtAvailedGratuityAmount.Text=parseFloat(this.oEvalPayFormulas.arrLstCPFields[6][t].dEarned).ToString(i.a.SessionManager.sPayrollDecimals);else for(let e=0;e<this.dgvOthAdd.Table.length;e++)if(this.oEvalPayFormulas.arrLstCPFields[6][t].ComponentName=="Lookup"+h.e.String(this.dgvOthAdd.Table[e].dgColOthAddParticulars)){this.dgvOthAdd.Table[e].dgColOthAddAmount=parseFloat(this.oEvalPayFormulas.arrLstCPFields[6][t].dEarned).ToString(i.a.SessionManager.sPayrollDecimals),this.dgvOthAdd.updateRow(this.dgvOthAdd.Table[e]),this.dgvOthAdd_CellEndEdit(this.dgvOthAdd,2);break}}}}this.CalculateTotalAmount()}LoadExperinceDaysData(t,e,a){t.Clear();let s="Res";1==a&&(s="Term");for(let i=0;i<e.length;i++)t.push(new rt),t[i].Year=e[i][s+"Exp"].toString().Contains("+")?e[i][s+"Exp"].toString().Replace("[+]",""):"="+e[i][s+"Exp"].toString(),t[i].Days=parseFloat(e[i][s+"GrDays"]),t[i].IsApplyToPrevYrs="Yes"==e[i][s+"ApplyPrevYrs"].toString()}CalcGratuityDays(e,a,s,l,o){o.dTotGratuitySal=0,this.dgvGratuity.addEmptyRow(),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[0]]=this.GetResource("Gratuity/Year",40095),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[1]]=e;let n=e,r="";this.dgvGratuity.addEmptyRow(),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[0]]=this.GetResource("Period",40095),r=this.GetResource("Start Date",40095)+s.ToString("dd/MMM/yyyy")+"          ",r+=this.GetResource("End Date",40095)+l.ToString("dd/MMM/yyyy");let d=0,u=0,g=0,m=this.dtpDateOfJoining.Date.Date(),b=(this.dtpDateOfRelieving.Date.Date(),0),D=0,p=0,T={iY:b,iM:D,iD:p};h.e.GetYearsMonthsDays(m,l,T),b=T.iY,D=T.iM,p=T.iD;let y=0,C=0,I=0,S={iY:y,iM:C,iD:I};h.e.GetYearsMonthsDays(s,l,S),y=S.iY,C=S.iM,I=S.iD;let x=0;if("No"!=this.EOS_ExcludeLOP){x=this.GetPreviousLOPDays(s,l);let t=i.a.common.GetDataSet3("CRM026",this.EmpSeqNo.toString(),s.ToString("dd/MMM/yyyy"),l.ToString("dd/MMM/yyyy"));null!=t&&t.Tables.length>0&&t.Tables[0].length>0&&(x+=parseFloat(t.Tables[0][0].LOP.toString()));let e=l;e=s==this.dtpDateOfJoining.Date.Date()?e.AddDays(-(this.dLOPDays+x)):e.AddDays(-x);let a={iY:y,iM:C,iD:I};h.e.GetYearsMonthsDays(s,e,a),y=a.iY,C=a.iM,I=a.iD,this.dLOPDays+=x}d=y*n,u=C/12*n,g=I/365*n,this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[1]]=this.GetResource("Start Date",40095),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[2]]=s.ToString("dd/MMM/yyyy"),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[3]]=this.GetResource("End Date",40095),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[4]]=l.ToString("dd/MMM/yyyy");let v=!!this.chkCalcBasedOnActDays.IsChecked&&this.chkCalcBasedOnActDays.IsChecked,P=0,A=0,f=0;if(v){let t,e=s,i=l,o=0,n=0;for(;e<=i;){if(t=new Date(e.getFullYear(),e.getMonth(),e.DaysInMonth()),!(t<=i)){o=i.Subtract(e).Days+1,A+=o,n=a*o/t.getDate(),f+=n;break}o=t.Subtract(e).Days+1,A+=o,n=a*o/t.getDate(),f+=n,e=t.AddDays(1)}P=f/A}let M=l.Subtract(s).Days+1;this.dgvGratuity.addEmptyRow(),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[0]]=this.GetResource("Basic Salary",40095);let E=0;this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[1]]=a,E=a,this.dgvGratuity.addEmptyRow(),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[0]]=this.GetResource("Total Days Worked",40095),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[1]]=y+" : "+this.GetResource("Years",40095)+", "+C+" : "+this.GetResource("Months",40095)+", "+I+" : "+this.GetResource("Days",40095),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[3]]=this.GetResource("Total Days",40095),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[4]]=M,"Exclude at Last"==this.ActEOS_ExcludeLOP?this.isLast&&(this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[5]]=this.GetResource("Total LOP Days",40095),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[6]]=this.dLOPDays):(this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[5]]=this.GetResource("LOP Days",40095),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[6]]=x),this.dgvGratuity.addEmptyRow(),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[1]]=this.GetResource("Years",40095),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[2]]=this.GetResource("Months",40095),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[3]]=this.GetResource("Days",40095),this.dgvGratuity.addEmptyRow(),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[1]]=y,this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[2]]=C,this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[3]]=I,this.dgvGratuity.addEmptyRow(),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[0]]=this.GetResource("Available Gratuity",40095),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[1]]=d,this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[2]]=u,this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[3]]=g;let L=d+u+g;if(this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[4]]="=",this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[5]]=L,this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[6]]="=",L=t.RoundOffValue(L,this.EOS_ROff),this.EOS_MaxDays>0&&this.dEarnedGrDays+L>=this.EOS_MaxDays?(L=this.EOS_MaxDays-this.dEarnedGrDays,this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[7]]=L,this.isMaxDaysExceded=!0):(this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[7]]=L,this.dEarnedGrDays+=L),this.dTotGratuityDays+=L,this.dgvGratuity.addEmptyRow(),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[0]]=this.GetResource("Gratuity",40095),v)this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[1]]=f+" / "+A,E=P*L;else{let t=this.dtpDateOfJoining.Date.Date(),e=this.dtpDateOfRelieving.Date.Date(),i=0,l=0,o=0,n={iY:i,iM:l,iD:o};h.e.GetYearsMonthsDays(t,e,n),i=n.iY,l=n.iM,o=n.iD;let r=!!this.chkCalcBasedOnLastSal.IsChecked&&this.chkCalcBasedOnLastSal.IsChecked;this.oEvalPayFormulas=new c.b,this.oEvalPayFormulas.sEmpSeqNo=this.EmpSeqNo.toString(),n={PayrollMonth:this.oEvalPayFormulas.PayrollMonth,PayrollMonthStart:this.oEvalPayFormulas.PayrollMonthStart,PayrollMonthEnd:this.oEvalPayFormulas.PayrollMonthEnd},h.e.SetPayrollDate(r?this.dtpDocDate.Date.Date():s.Date(),n),this.oEvalPayFormulas.PayrollMonth=n.PayrollMonth,this.oEvalPayFormulas.PayrollMonthStart=n.PayrollMonthStart,this.oEvalPayFormulas.PayrollMonthEnd=n.PayrollMonthEnd,this.oEvalPayFormulas.arrLstCPFields[6].Clear(),this.oCPF=new c.a,this.oCPF.ComponentName="GratuityFormula",this.oCPF.SNo=0,this.oCPF.Formula=this.EOS_GratuityFormula.Replace("GratuityDays",L.toString()),this.oCPF.dEarned=this.oCPF.dActual="0",this.oEvalPayFormulas.arrLstCPFields[6].push(this.oCPF),this.oEvalPayFormulas.othMPField.IsFinalSettlement=!0,this.oEvalPayFormulas.othMPField.sResignType=this.cmbResignType.SelectedValue.toString(),this.oEvalPayFormulas.othMPField.BasicMonthly=a,this.oEvalPayFormulas.othMPField.TotalLeaves=0,this.oEvalPayFormulas.othMPField.DaysAttended=this.oEvalPayFormulas.othMPField.TotalDays,this.oEvalPayFormulas.othMPField.dServiceDays=this.dActServiceDays,this.oEvalPayFormulas.othMPField.dServiceYears=i,this.oEvalPayFormulas.Intialize(),this.oEvalPayFormulas.ExecuteAllFormulas();for(let a=0;a<this.oEvalPayFormulas.arrLstCPFields[6].length;a++)if("GratuityFormula"==this.oEvalPayFormulas.arrLstCPFields[6][a].ComponentName){E=parseFloat(this.oEvalPayFormulas.arrLstCPFields[6][a].dEarned);break}}this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[5]]=E,o.dTotGratuitySal+=E,this.dgvGratuity.addEmptyRow(),this.dgvGratuity.refreshDataView(),console.log(this.dgvGratuity)}GetPreviousLOPDays(t,e){let a=0,s=i.a.common.GetDataSet3("CRM027",this.EmpSeqNo.toString(),t.ToString("dd/MMM/yyyy"),e.ToString("dd/MMM/yyyy")).Tables[0];return null!=s&&s.length>0&&(a=parseFloat(s[0].LOPDays)),a}static RoundOffValue(t,e){if(e>0&&t>0){let a=0,s=!1;a=t%e,a>0&&(e/a<=2&&(s=!0),t-=a,s&&(t+=e))}return t}CalcGratuityBasedOnServiceDays(t,e,a,s){s.dTotGratuitySal=0,this.dgvGratuity.addEmptyRow();let i="";this.dgvGratuity.addEmptyRow(),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[0]]=this.GetResource("Period",40095),i=this.GetResource("Start Date",40095)+e.ToString("dd/MMM/yyyy")+"          ",i+=this.GetResource("End Date",40095)+a.ToString("dd/MMM/yyyy");let l=0,o=0,n=0,r={iY:l,iM:o,iD:n};h.e.GetYearsMonthsDays(e,a,r),l=r.iY,o=r.iM,n=r.iD,this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[1]]=this.GetResource("Start Date",40095),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[2]]=e.ToString("dd/MMM/yyyy"),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[3]]=this.GetResource("End Date",40095),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[4]]=a.ToString("dd/MMM/yyyy");let d=a.Subtract(e).Days+1;this.dgvGratuity.addEmptyRow(),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[0]]=this.GetResource("Basic Salary",40095);let u=0;this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[1]]=t,u=t,this.dgvGratuity.addEmptyRow(),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[0]]=this.GetResource("Total Days Worked",40095),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[1]]=l+" : "+this.GetResource("Years",40095)+", "+o+" : "+this.GetResource("Months",40095)+", "+n+" : "+this.GetResource("Days",40095),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[3]]=this.GetResource("Total Days",40095),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[4]]=d,this.dgvGratuity.addEmptyRow(),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[1]]=this.GetResource("Total Duration Days",40095),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[2]]=this.GetResource("LOP Days",40095),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[3]]=this.GetResource("Total Service Days",40095),this.dgvGratuity.addEmptyRow(),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[1]]=this.dActServiceDays,this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[2]]=this.dLOPDays,this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[3]]=this.dServiceDaysAfterLOP,this.dgvGratuity.addEmptyRow(),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[0]]=this.GetResource("Total Years",40095),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[1]]=this.dServiceDaysAfterLOP,this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[2]]="/",this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[3]]="365";let g=this.dServiceDaysAfterLOP/365;this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[4]]="=",this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[5]]=g,this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[6]]="=",this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[7]]=g,this.dgvGratuity.addEmptyRow(),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[0]]=this.GetResource("Gratuity Amount",40095);{this.oEvalPayFormulas=new c.b,this.oEvalPayFormulas.sEmpSeqNo=this.EmpSeqNo.toString();let e={PayrollMonth:this.oEvalPayFormulas.PayrollMonth,PayrollMonthStart:this.oEvalPayFormulas.PayrollMonthStart,PayrollMonthEnd:this.oEvalPayFormulas.PayrollMonthEnd};h.e.SetPayrollDate(this.dtpDocDate.Date.Date(),e),this.oEvalPayFormulas.PayrollMonth=e.PayrollMonth,this.oEvalPayFormulas.PayrollMonthStart=e.PayrollMonthStart,this.oEvalPayFormulas.PayrollMonthEnd=e.PayrollMonthEnd,this.oEvalPayFormulas.arrLstCPFields[6].Clear(),this.oCPF=new c.a,this.oCPF.ComponentName="GratuityFormula",this.oCPF.SNo=0,this.oCPF.Formula=this.EOS_GratuityFormula,this.oCPF.dEarned=this.oCPF.dActual="0",this.oEvalPayFormulas.arrLstCPFields[6].push(this.oCPF),this.oEvalPayFormulas.othMPField.sResignType=this.cmbResignType.SelectedValue.toString(),this.oEvalPayFormulas.othMPField.BasicMonthly=t,this.oEvalPayFormulas.othMPField.TotalLeaves=0,this.oEvalPayFormulas.othMPField.DaysAttended=this.oEvalPayFormulas.othMPField.TotalDays,this.oEvalPayFormulas.othMPField.dServiceDays=this.dActServiceDays,this.oEvalPayFormulas.othMPField.dServiceYears=l,this.oEvalPayFormulas.Intialize(),this.oEvalPayFormulas.ExecuteAllFormulas();for(let t=0;t<this.oEvalPayFormulas.arrLstCPFields[6].length;t++)if("GratuityFormula"==this.oEvalPayFormulas.arrLstCPFields[6][t].ComponentName){this.dServiceDaysFormulaAmount=parseFloat(this.oEvalPayFormulas.arrLstCPFields[6][t].dEarned);break}}this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[5]]=this.dServiceDaysFormulaAmount,s.dTotGratuitySal+=this.dServiceDaysFormulaAmount,this.dgvGratuity.addEmptyRow(),this.dgvGratuity.Table[this.dgvGratuity.Table.length-1][this.dgvGratuity.TableColumns[0]]="* * * * *"}dgvLeaveEncash_CellValidating(t,e){}btnCalcLeaveEncash_Click(){this.oEvalPayFormulas=new c.b,this.oEvalPayFormulas.othMPField.IsFinalSettlement=!1,this.oEvalPayFormulas.sEmpSeqNo=this.EmpSeqNo.toString();let t={PayrollMonth:this.oEvalPayFormulas.PayrollMonth,PayrollMonthStart:this.oEvalPayFormulas.PayrollMonthStart,PayrollMonthEnd:this.oEvalPayFormulas.PayrollMonthEnd};h.e.SetPayrollDate(this.dtpDocDate.Date.Date(),t),this.oEvalPayFormulas.PayrollMonth=t.PayrollMonth,this.oEvalPayFormulas.PayrollMonthStart=t.PayrollMonthStart,this.oEvalPayFormulas.PayrollMonthEnd=t.PayrollMonthEnd,this.oEvalPayFormulas.arrLstCPFields[6].Clear();let e=0;if(this.dgvLeaveEncash.Table.length>0){for(let t=0;t<this.dgvLeaveEncash.Table.length;t++)h.e.IsEmpty(this.dgvLeaveEncash.Table[t].dgColLEApplied)||(h.e.IsEmpty(this.dgvLeaveEncash.Table[t].dgColLEAmount_Tag)||(this.strFormula=this.dgvLeaveEncash.Table[t].dgColLEAmount_Tag.toString()),this.strFormula=this.strFormula.Replace("EncashDays","("+this.dgvLeaveEncash.Table[t].dgColLEApplied.toString().Replace("-","!")+")"),this.oCPF=new c.a,this.oCPF.ComponentName="LEFormula"+this.dgvLeaveEncash.Table[t+"_Tag"].toString(),this.oCPF.SNo=parseInt(this.dgvLeaveEncash.Table[t+"_Tag"]),this.oCPF.Formula=this.strFormula,this.oCPF.dEarned=this.oCPF.dActual="0",this.oEvalPayFormulas.arrLstCPFields[6].push(this.oCPF));this.oEvalPayFormulas.Intialize(),this.oEvalPayFormulas.othMPField.BasicMonthly=parseFloat(this.dsD.Tables[3][this.dsD.Tables[3].length-1].BasicMonthly),this.oEvalPayFormulas.othMPField.TotalLeaves=0,this.oEvalPayFormulas.othMPField.DaysAttended=this.oEvalPayFormulas.othMPField.TotalDays,this.oEvalPayFormulas.ExecuteAllFormulas();for(let t=0;t<this.dgvLeaveEncash.Table.length;t++)if(0!=h.e.Double(this.dgvLeaveEncash.Table[t].dgColLEApplied))for(let a=0;a<this.oEvalPayFormulas.arrLstCPFields[6].length;a++)if(this.oEvalPayFormulas.arrLstCPFields[6][a].ComponentName=="LEFormula"+this.dgvLeaveEncash.Table[t+"_Tag"].toString()){this.dgvLeaveEncash.Table[t].dgColLEAmount=this.oEvalPayFormulas.arrLstCPFields[6][a].dEarned,e+=parseFloat(this.oEvalPayFormulas.arrLstCPFields[6][a].dEarned);break}this.txtLEAmount.Text=(parseFloat(this.txtCumLeaveSalBalAmt.Text)+e).ToString(i.a.SessionManager.sPayrollDecimals)}this.CalculateTotalAmount()}dgvUPS_CellClick(t,e){if("dgColUPSCalc"==this.dgvUPS.Columns[t.cell].DisplayMember){h.e.SetPayrollMonth(new Date(this.dgvUPS.Table[t.row].dgColUPSPayrollMonth));let e=new u.MonthlyPayrollViewModel("Monthly Payroll","UnProcessed");e.sProcessType="UnProcessed",e.SelectedEmpID=this.EmpSeqNo,e.EmployeeList.Code.SelectedValue=e.EmployeeList.Name.SelectedValue=this.EmpSeqNo,e.EmployeeList.Code.Text=e.EmployeeList.Name.Text=this.EmployeeList.Text,e.InitSelectedEmployee(),i.a.page.ShowDialog(e,x.MonthlyPayrollComponent,{ShowCenter:!0,HideHeader:!0}).subscribe(()=>{e.DialogResult&&(this.dgvUPS.Table[t.row].dgColUPSDaysAtt=e.dFS_DaysAttended,this.dgvUPS.Table[t.row].dgColUPSLOP=e.dFS_LOPDays,this.dgvUPS.Table[t.row].dgColUPSNetSal=e.dFS_NetSal,this.dgvUPS.updateRow(this.dgvUPS[t.row]));let a=0;if(this.dgvUPS.Table.length>0)for(let t=0;t<this.dgvUPS.Table.length;t++)a+=parseFloat(this.dgvUPS.Table[t].dgColUPSNetSal);this.txtUPSAmount.Text=a.ToString(i.a.SessionManager.sPayrollDecimals),this.CalculateTotalAmount()})}}dgvNoticePay_CellClick(t,e){if("dgColNPCalc"==this.dgvNoticePay.Columns[t.cell].DisplayMember){h.e.SetPayrollMonth(new Date(this.dgvNoticePay.Table[t.row].dgColNPPayrollMonth));let e=new u.MonthlyPayrollViewModel("Monthly Payroll","NoticePay");e.sProcessType="NoticePay",e.SelectedEmpID=this.EmpSeqNo,e.EmployeeList.Code.SelectedValue=e.EmployeeList.Name.SelectedValue=this.EmpSeqNo,e.EmployeeList.Code.Text=e.EmployeeList.Name.Text=this.EmployeeList.Text,e.InitSelectedEmployee(),i.a.page.ShowDialog(e,x.MonthlyPayrollComponent,{ShowCenter:!0,HideHeader:!0}).subscribe(()=>{e.DialogResult&&(this.dgvNoticePay.Table[t.row].dgColNPDaysAtt=e.dFS_DaysAttended,this.dgvNoticePay.Table[t.row].dgColNPLOP=e.dFS_LOPDays,this.dgvNoticePay.Table[t.row].dgColNPNetSal=e.dFS_NetSal,this.dgvNoticePay.updateRow(this.dgvNoticePay[t.row])),this.CalculateNoticePayAmount()})}}CalculateNoticePayAmount(){let t=0;if(this.dgvNoticePay.Table.length>0)for(let e=0;e<this.dgvNoticePay.Table.length;e++)"Add"==h.e.String(this.dgvNoticePay.Table[e].dgColNPType)?t+=parseFloat(this.dgvNoticePay.Table[e].dgColNPNetSal):"Subtract"==h.e.String(this.dgvNoticePay.Table[e].dgColNPType)&&(t-=parseFloat(this.dgvNoticePay.Table[e].dgColNPNetSal));this.txtNPAmount.Text=t.ToString(i.a.SessionManager.sPayrollDecimals),this.CalculateTotalAmount()}dgvOthAdd_CellEndEdit(t,e){null==e&&(e=t.cell),"dgColOthAddAmount"==this.dgvOthAdd.Columns[e].DisplayMember&&this.CalculateOthAddAmount()}dgvOthAdd_RowsAdded(t,e){this.GenerateSerialNos(this.dgvOthAdd)}CalculateOthAddAmount(){let t=0;for(let e=0;e<this.dgvOthAdd.Table.length;e++)t+=parseFloat(this.dgvOthAdd.Table[e].dgColOthAddAmount);this.txtOthAddAmount.Text=t.ToString(i.a.SessionManager.sPayrollDecimals),this.CalculateTotalAmount()}dgvOthDed_CellEndEdit(t,e){null==e&&(e=t.cell),"dgColOthDedAmount"==this.dgvOthDed.Columns[e].DisplayMember&&this.CalculateOthDedAmount()}dgvOthDed_RowsAdded(t,e){this.GenerateSerialNos(this.dgvOthDed)}CalculateOthDedAmount(){let t=0;for(let e=0;e<this.dgvOthDed.Table.length;e++)t+=parseFloat(this.dgvOthDed.Table[e].dgColOthDedAmount);this.txtOthDedAmount.Text=t.ToString(i.a.SessionManager.sPayrollDecimals),this.CalculateTotalAmount()}dtpDateOfRelieving_SelectedDateChanged(t,e){this.RefreshLeaveEncashDetails()}btnSaveAndPrint_Click(t){this.ViewModel.SelectedEmpID>0?(this.Save_Click(),this.ViewModel.IsSaved&&this.ViewModel.DocID>0&&(this.ViewModel.IsSaved=!1,this.ViewModel.SelectedEmpID=0)):(this.ViewModel.DisplayMessage="Select any Employee.",this.ViewModel.MessageVisibility=!0)}btnPrint_Click(t){this.ViewModel.DocID>0||(this.ViewModel.DisplayMessage="Select any Employee.",this.ViewModel.MessageVisibility=!0)}btnPrintPreview_Click(t){this.ViewModel.DocID>0||(this.ViewModel.DisplayMessage="Select any Employee.",this.ViewModel.MessageVisibility=!0)}btnExport_Click(t){if(!(this.ViewModel.DocID>0))return this.ViewModel.DisplayMessage="Load document in Edit Mode",void(this.ViewModel.MessageVisibility=!0)}dgvLoanBal_CellClick(t,e){if("dgColLoanBalCalc"==this.dgvLoanBal.Columns[t.cell].DisplayMember){let e=i.a.common.GetDataTable("CRM028","");if(null!=e&&e.length>0){let o,n=Date.Today(),r=this.dsD.Tables[11].filter(e=>e.RefNo==this.dgvLoanBal.Table[t.row].dgColLoanBalDocNo);if(r.length>0){o=new D.AddEditDocumentViewModel(40057,"Loan Repayment",!0,"IsFrmFS_LoanBal"),o.ScreenObject.Link.LinkCombo.Enable=!1,o.ScreenObject.Link.DocumentList.Enable=!1,o.ScreenObject.Preferences.Selective="false";let t={value:n};o.ScreenObject.OnDocPrefixChanged("lostFocus",0,parseInt(r[0].DocID),t,!1),n=t.value}else o=new D.AddEditDocumentViewModel(40057,"Loan Repayment",!1,"IsFrmFS_LoanBal"),o.ScreenObject.Link.LinkCombo.SelectedValue=e[0].DocumentLinkDefID.toString(),o.ScreenObject.Link.LinkCombo.Enable=!1,o.ScreenObject.Link.DocumentList.Enable=!1,o.ScreenObject.Preferences.Selective="false",o.OLinkSelectionChanged(null);o.IsFrmFS_LoanBal=!0;var a=o.ScreenObject.HeaderFields.find(t=>t instanceof g.c&&"DocDate"==t.DBColumnName.toString());a&&(a.Enable=!1),(a=o.ScreenObject.HeaderFields.find(t=>t instanceof g.c&&"VoucherNo"==t.DBColumnName.toString()))instanceof m.a&&(a.Enable=!1,a.LoadVisibility=!1,a.PreviousVisibility=!1,a.NextVisibility=!1);var s=o.ScreenObject.Link.DocumentList.Items.find(e=>e.Value==this.dgvLoanBal.Table[t.row].dgColLoanBalDocNo_Tag.toString());s&&(s.IsChecked=!0,o.OnLinkDocumentCheckedChanged(s)),(a=o.ScreenObject._CCFields.find(t=>"dcCCNID51"==t.DBColumnName))&&(a.Enable=!1),(a=o.ScreenObject._TextFields.find(t=>"dcAlpha6"==t.DBColumnName))instanceof l.d&&(a.Text="FFS_LoanBalances");for(let t=0;t<o.ScreenObject.GridData.length;t++)h.e.IsEmpty(o.ScreenObject.GridData[t].ProductID_Key)||(o.ScreenObject.GridData[t].dcAlpha5=this.dtpDocDate.Date.ToString(i.a.SessionManager.Preferences["Date Format"]),o.ScreenObject.GridData[t].dcAlpha5_Key=this.dtpDocDate.Date.toString());i.a.page.ShowDialog(o,b.AddEditDocumentComponent),o.DialogResult&&(this.dgvLoanBal.Table[t.row].dgColLoanBalCalc_Tag="Paid",this.dgvLoanBal.Table[t.row].dgColLoanBalSNo_Tag=o.RetValue,this.dgvLoanBal.updateRow(this.dgvLoanBal.Table[t.row]))}}}NumberValidationTextBox(t,e){}GetResource(t,e){let a=t;return this.drwRes=this.ViewModel.dtRes1.filter(a=>a.CCID==e&&a.Code=="'"+t+"'"),null!=this.drwRes&&this.drwRes.length>0?this.drwRes[0].AliasName.toString():a}cmbSettlementType_SelectionChanged(t,e){this.txtPartialGratuityAmount.IsReadOnly="Partial"!=this.cmbSettlementType.SelectedValue}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=v.Nb({type:t,selectors:[["app-final-settlement"]],decls:322,vars:104,consts:[["id","maincontainer",1,"maincontainer","master_container"],[1,"page-header"],[1,"page-title_div"],[1,"page-title"],[1,"btnpill"],[1,"btnMetroDiv","secondary-btn-group"],["class","secondary-btn",3,"click",4,"ngIf"],[1,"secondary-btn",3,"click"],[1,"fa-light","fa-print"],[1,"fa-light","fa-eye"],[1,"fa-light","fa-file-export"],[1,"fa-light","fa-paperclip"],[1,"fa-light","fa-envelope"],[1,"fa-light","fa-broom"],[1,"document-screen","main_div"],[1,"section"],["acoordionHeader",""],["panelClass","row form-row",3,"isOpen"],["accordion-heading","",1,"collapse_tabfields"],[1,"btn","btn-link"],[1,"fa","pull-right",2,"line-height","26px","color","white","position","relative","left","-10px","float","right","background","none","border","none"],["btnCollapseheader",""],[1,"PACTHeaderFields"],[2,"display","flex","width","100%"],["class","form-group col-xl-3  col-md-3 col-sm-12 col-xs-12 PACTControl",4,"ngIf"],["class","form-group col-xl-6  col-md-6 col-sm-12 col-xs-12 PACTControl",4,"ngIf"],[1,"form-group","col-xl-3","col-md-3","col-sm-12","col-xs-12","PACTControl"],[2,"margin-top","auto"],[1,"PACTTabFields","section","tab_content","tab-exrafields","custom_accordion",2,"display","flex"],["TabHeaderField",""],[1,"master-tab-container",2,"width","100%"],[3,"heading","removable","selectTab"],[1,"documentgrid","row","form-row",2,"width","100%"],["class","form-group col-9 section documentgrid",4,"ngIf"],[1,"form-group","col-3",2,"height","250px","border","1px solid #ccc","overflow","scroll"],["class","form-group col-xl-12  col-md-12 col-sm-12 col-xs-12 PACTControl",4,"ngIf"],[1,"form-group","col-xl-12","col-md-12","col-sm-12","col-xs-12","PACTControl"],["FieldDirective","",3,"obj","group"],[1,"primary-btn-wicon",3,"click"],[1,"form-group","col-xl-12","col-md-12","col-sm-12","col-xs-12",2,"display","flex","flex-direction","row","padding","0px 30px 8px 0px !important","width","100%"],[2,"font-weight","bold"],[1,"form-row","row"],[1,"form-group","col-3"],[1,"fa-light","fa-user"],[1,"fa-light","fa-floppy-disk-circle-arrow-right"],[1,"fas","fa-print"],[1,"fa-light","fa-trash-alt"],[1,"form-group","col-xl-12","col-md-12","col-sm-12","col-xs-12",2,"display","flex","/* flex-direction","row","*/padding","0px 0px 0px 0px !important","width","100%"],["FieldDirective","",2,"width","100%",3,"obj","group"],[2,"display","flex"],[1,"input_cntrl_label",2,"flex-direction","column"],[1,"btnMetroDiv","secondary-btn-group",2,"margin-left","auto","margin-bottom","2px"],[1,"secondary-btn","prevnextbtn",3,"click"],[1,"far","fa-angle-left"],[1,"far","fa-angle-right"],[1,"form-group","col-xl-6","col-md-6","col-sm-12","col-xs-12","PACTControl"],[1,"form-group","col-9","section","documentgrid"],[2,"width","100%",3,"obj","group"]],template:function(t,e){1&t&&(v.Zb(0,"div",0),v.Wc(1,"\n  "),v.Zb(2,"div",1),v.Wc(3,"\n    "),v.Zb(4,"div",2),v.Wc(5,"\n      "),v.Zb(6,"span",3),v.Wc(7),v.Zb(8,"span",4),v.Wc(9),v.Yb(),v.Wc(10,"\n      "),v.Yb(),v.Wc(11,"\n    "),v.Yb(),v.Wc(12,"\n    "),v.Zb(13,"div",5),v.Wc(14,"\n      "),v.Wc(15,"\n      "),v.Uc(16,G,4,3,"span",6),v.Wc(17,"\n      "),v.Uc(18,R,4,3,"span",6),v.Wc(19,"\n      "),v.Uc(20,N,4,3,"span",6),v.Wc(21,"\n      "),v.Zb(22,"span",7),v.hc("click",(function(){return e.btnPrint_Click("Print")})),v.Ub(23,"i",8),v.Wc(24),v.mc(25,"translate"),v.Yb(),v.Wc(26,"\n      "),v.Zb(27,"span",7),v.hc("click",(function(){return e.btnPrintPreview_Click("Preview")})),v.Ub(28,"i",9),v.Wc(29),v.mc(30,"translate"),v.Yb(),v.Wc(31,"\n      "),v.Zb(32,"span",7),v.hc("click",(function(){return e.btnExport_Click("Export")})),v.Ub(33,"i",10),v.Wc(34),v.mc(35,"translate"),v.Yb(),v.Wc(36,"\n      "),v.Zb(37,"span",7),v.hc("click",(function(){return e.obj.Button_Click("Attachments")})),v.Ub(38,"i",11),v.Wc(39),v.mc(40,"translate"),v.Yb(),v.Wc(41,"\n      "),v.Zb(42,"span",7),v.hc("click",(function(){return e.obj.Button_Click("EMail")})),v.Ub(43,"i",12),v.Wc(44),v.mc(45,"translate"),v.Yb(),v.Wc(46,"\n      "),v.Zb(47,"span",7),v.hc("click",(function(){return e.obj.Button_Click("Clear")})),v.Ub(48,"i",13),v.Wc(49),v.mc(50,"translate"),v.Yb(),v.Wc(51,"\n      "),v.Uc(52,V,4,3,"span",6),v.Wc(53,"\n    "),v.Yb(),v.Wc(54,"\n  "),v.Yb(),v.Wc(55,"\n  "),v.Zb(56,"div",14),v.Wc(57,"\n    "),v.Zb(58,"accordion",15,16),v.Wc(60,"\n      "),v.Zb(61,"accordion-group",17),v.Wc(62,"\n        "),v.Zb(63,"div",18),v.Wc(64,"\n          "),v.Zb(65,"span",19),v.Wc(66," Primary Information"),v.Yb(),v.Wc(67,"\n          "),v.Ub(68,"span",20,21),v.Wc(70,"\n        "),v.Yb(),v.Wc(71,"\n        "),v.Zb(72,"div"),v.Wc(73,"\n          "),v.Zb(74,"div",22),v.Wc(75,"\n            "),v.Zb(76,"div",23),v.Wc(77,"\n              "),v.Uc(78,F,25,3,"div",24),v.Wc(79,"\n              "),v.Uc(80,w,4,2,"div",24),v.Wc(81,"\n            "),v.Yb(),v.Wc(82,"\n            "),v.Zb(83,"div",23),v.Wc(84,"\n              "),v.Uc(85,O,4,2,"div",25),v.Wc(86,"\n              "),v.Uc(87,W,4,2,"div",24),v.Wc(88,"\n            "),v.Yb(),v.Wc(89,"\n            "),v.Zb(90,"div",23),v.Wc(91,"\n              "),v.Uc(92,k,4,2,"div",24),v.Wc(93,"\n              "),v.Uc(94,B,4,2,"div",24),v.Wc(95,"\n              "),v.Zb(96,"div",26),v.Wc(97,"\n                "),v.Zb(98,"label",27),v.Wc(99),v.Yb(),v.Wc(100,"\n              "),v.Yb(),v.Wc(101,"\n            "),v.Yb(),v.Wc(102,"\n            "),v.Zb(103,"div",23),v.Wc(104,"\n              "),v.Uc(105,U,4,2,"div",25),v.Wc(106,"\n              "),v.Uc(107,Y,4,2,"div",24),v.Wc(108,"\n            "),v.Yb(),v.Wc(109,"\n          "),v.Yb(),v.Wc(110,"\n        "),v.Yb(),v.Wc(111,"\n      "),v.Yb(),v.Wc(112,"\n    "),v.Yb(),v.Wc(113,"\n\n    "),v.Zb(114,"div",28,29),v.Wc(116,"\n      "),v.Zb(117,"tabset",30),v.Wc(118,"\n        "),v.Zb(119,"tab",31),v.hc("selectTab",(function(){return e.onSelectTab("dgvGratuity")})),v.Wc(120,"\n          "),v.Wc(121,"\n            "),v.Zb(122,"div",32),v.Wc(123,"\n            "),v.Uc(124,j,5,2,"div",33),v.Wc(125,"\n            \n            "),v.Zb(126,"div",34),v.Wc(127,"\n              "),v.Wc(128," \n              "),v.Uc(129,H,4,2,"div",35),v.Wc(130,"\n              "),v.Zb(131,"div",36),v.Wc(132,"\n                "),v.Vb(133,37),v.Wc(134,"\n              "),v.Yb(),v.Wc(135,"\n              "),v.Zb(136,"div",36),v.Wc(137,"\n                "),v.Vb(138,37),v.Wc(139,"\n              "),v.Yb(),v.Wc(140,"\n              "),v.Zb(141,"div",36),v.Wc(142,"\n                "),v.Vb(143,37),v.Wc(144,"\n              "),v.Yb(),v.Wc(145,"\n              "),v.Zb(146,"div",36),v.Wc(147,"\n                "),v.Zb(148,"button",38),v.hc("click",(function(){return e.obj.ButtonClick("Gratuity")})),v.Wc(149),v.Yb(),v.Wc(150,"\n              "),v.Yb(),v.Wc(151,"\n              "),v.Zb(152,"div",39),v.Wc(153,"\n                "),v.Zb(154,"label"),v.Wc(155),v.Yb(),v.Zb(156,"label",40),v.Wc(157),v.Yb(),v.Wc(158,"\n              "),v.Yb(),v.Wc(159,"\n              "),v.Zb(160,"div",39),v.Wc(161,"\n                "),v.Zb(162,"label"),v.Wc(163),v.Yb(),v.Zb(164,"label",40),v.Wc(165),v.Yb(),v.Wc(166," "),v.Zb(167,"label"),v.Wc(168),v.Yb(),v.Zb(169,"label",40),v.Wc(170),v.Yb(),v.Wc(171," "),v.Zb(172,"label"),v.Wc(173),v.Yb(),v.Zb(174,"label",40),v.Wc(175),v.Yb(),v.Wc(176,"\n              "),v.Yb(),v.Wc(177,"\n              "),v.Zb(178,"div",39),v.Wc(179,"\n                "),v.Zb(180,"label"),v.Wc(181),v.Yb(),v.Zb(182,"label",40),v.Wc(183),v.Yb(),v.Wc(184,"\n              "),v.Yb(),v.Wc(185,"\n              "),v.Zb(186,"div",39),v.Wc(187,"\n                "),v.Zb(188,"label"),v.Wc(189),v.Yb(),v.Zb(190,"label",40),v.Wc(191),v.Yb(),v.Wc(192,"\n              "),v.Yb(),v.Wc(193,"\n              "),v.Uc(194,_,4,2,"div",35),v.Wc(195,"\n              "),v.Uc(196,Z,4,2,"div",35),v.Wc(197,"\n              "),v.Uc(198,X,4,2,"div",35),v.Wc(199,"\n            "),v.Yb(),v.Wc(200,"\n          "),v.Yb(),v.Wc(201,"\n        "),v.Yb(),v.Wc(202,"\n        "),v.Zb(203,"tab",31),v.hc("selectTab",(function(){return e.onSelectTab("dgvLeaveEncash")})),v.Wc(204,"\n          "),v.Zb(205,"div",41),v.Wc(206,"\n            "),v.Uc(207,q,4,2,"div",33),v.Wc(208,"\n            "),v.Zb(209,"div",42),v.Wc(210,"\n              "),v.Uc(211,Q,4,2,"div",35),v.Wc(212,"\n              "),v.Zb(213,"div",36),v.Wc(214,"\n                "),v.Vb(215,37),v.Wc(216,"\n              "),v.Yb(),v.Wc(217,"\n              "),v.Zb(218,"div",36),v.Wc(219,"\n                "),v.Zb(220,"button",38),v.hc("click",(function(){return e.obj.ButtonClick("LeaveEncash")})),v.Wc(221),v.Yb(),v.Wc(222,"\n              "),v.Yb(),v.Wc(223,"\n              "),v.Uc(224,J,4,2,"div",35),v.Wc(225,"\n            "),v.Yb(),v.Wc(226,"\n          "),v.Yb(),v.Wc(227,"\n        "),v.Yb(),v.Wc(228,"\n        "),v.Zb(229,"tab",31),v.hc("selectTab",(function(){return e.onSelectTab("dgvUPS")})),v.Wc(230,"\n          "),v.Zb(231,"div",41),v.Wc(232,"\n            "),v.Uc(233,K,4,2,"div",33),v.Wc(234,"\n            "),v.Zb(235,"div",42),v.Wc(236,"\n              "),v.Zb(237,"div",36),v.Wc(238,"\n                "),v.Vb(239,37),v.Wc(240,"\n              "),v.Yb(),v.Wc(241,"\n              "),v.Uc(242,z,4,2,"div",35),v.Wc(243,"\n            "),v.Yb(),v.Wc(244,"\n          "),v.Yb(),v.Wc(245,"\n        "),v.Yb(),v.Wc(246,"\n        "),v.Zb(247,"tab",31),v.hc("selectTab",(function(){return e.onSelectTab("dgvNoticePay")})),v.Wc(248,"\n          "),v.Zb(249,"div",41),v.Wc(250,"\n            "),v.Uc(251,$,4,2,"div",33),v.Wc(252,"\n            "),v.Zb(253,"div",42),v.Wc(254,"\n              "),v.Zb(255,"div",36),v.Wc(256,"\n                "),v.Vb(257,37),v.Wc(258,"\n              "),v.Yb(),v.Wc(259,"\n              "),v.Uc(260,tt,4,2,"div",35),v.Wc(261,"\n            "),v.Yb(),v.Wc(262,"\n          "),v.Yb(),v.Wc(263,"\n        "),v.Yb(),v.Wc(264,"\n        "),v.Zb(265,"tab",31),v.hc("selectTab",(function(){return e.onSelectTab("dgvOthAdd")})),v.Wc(266,"\n          "),v.Zb(267,"div",41),v.Wc(268,"\n            "),v.Uc(269,et,4,2,"div",33),v.Wc(270,"\n            "),v.Zb(271,"div",42),v.Wc(272,"\n              "),v.Zb(273,"div",36),v.Wc(274,"\n                "),v.Vb(275,37),v.Wc(276,"\n              "),v.Yb(),v.Wc(277,"\n              "),v.Uc(278,at,4,2,"div",35),v.Wc(279,"\n            "),v.Yb(),v.Wc(280,"\n          "),v.Yb(),v.Wc(281,"\n        "),v.Yb(),v.Wc(282,"\n        "),v.Zb(283,"tab",31),v.hc("selectTab",(function(){return e.onSelectTab("dgvOthDed")})),v.Wc(284,"\n          "),v.Zb(285,"div",41),v.Wc(286,"\n            "),v.Uc(287,st,4,2,"div",33),v.Wc(288,"\n            "),v.Zb(289,"div",42),v.Wc(290,"\n              "),v.Zb(291,"div",36),v.Wc(292,"\n                "),v.Vb(293,37),v.Wc(294,"\n              "),v.Yb(),v.Wc(295,"\n              "),v.Uc(296,it,4,2,"div",35),v.Wc(297,"\n            "),v.Yb(),v.Wc(298,"\n          "),v.Yb(),v.Wc(299,"\n        "),v.Yb(),v.Wc(300,"\n        "),v.Zb(301,"tab",31),v.hc("selectTab",(function(){return e.onSelectTab("dgvLoanBal")})),v.Wc(302,"\n          "),v.Zb(303,"div",41),v.Wc(304,"\n            "),v.Uc(305,lt,4,2,"div",33),v.Wc(306,"\n            "),v.Zb(307,"div",42),v.Wc(308,"\n              "),v.Zb(309,"div",36),v.Wc(310,"\n                "),v.Vb(311,37),v.Wc(312,"\n              "),v.Yb(),v.Wc(313,"\n              "),v.Uc(314,ot,4,2,"div",35),v.Wc(315,"\n            "),v.Yb(),v.Wc(316,"\n          "),v.Yb(),v.Wc(317,"\n        "),v.Yb(),v.Wc(318,"\n      "),v.Yb(),v.Wc(319,"\n\n    "),v.Yb(),v.Wc(320,"\n\n  "),v.Yb(),v.Wc(321,"\n"),v.Yb()),2&t&&(v.Db(7),v.Yc("\n        ",e.obj.Title," "),v.Db(1),v.Sc("background-color",e.obj.StatusColor),v.Db(1),v.Xc(e.obj.DocStatus),v.Db(7),v.tc("ngIf",e.ViewModel.ApproveVisibility),v.Db(2),v.tc("ngIf",e.ViewModel.PostVisiblility),v.Db(2),v.tc("ngIf",e.ViewModel.PostVisiblility),v.Db(4),v.Xc(v.nc(25,92,"Print")),v.Db(5),v.Xc(v.nc(30,94,"Preview")),v.Db(5),v.Xc(v.nc(35,96,"Export")),v.Db(5),v.Xc(v.nc(40,98,"Attachments")),v.Db(5),v.Xc(v.nc(45,100,"SMTP_Email")),v.Db(5),v.Xc(v.nc(50,102,"Clear")),v.Db(3),v.tc("ngIf",e.obj.UnPostVisiblility),v.Db(9),v.tc("isOpen",e.IsAccordionOpen),v.Db(7),v.Kb("fa-chevron-down",e.IsAccordionOpen)("fa-chevron-up",!e.IsAccordionOpen),v.Db(10),v.tc("ngIf",e.obj.txtDocNo.Visible),v.Db(2),v.tc("ngIf",e.obj.dtpDocDate.Visible),v.Db(5),v.tc("ngIf",e.obj.EmployeeList.Visible),v.Db(2),v.tc("ngIf",e.obj.cmbSettlementType.Visible),v.Db(5),v.tc("ngIf",e.obj.dtpDateOfJoining.Visible),v.Db(2),v.tc("ngIf",e.obj.dtpDateOfRelieving.Visible),v.Db(5),v.Xc(e.lblActRelievingDate),v.Db(6),v.tc("ngIf",e.obj.txtRemarks.Visible),v.Db(2),v.tc("ngIf",e.obj.txtNetAmount.Visible),v.Db(12),v.uc("heading",e.tpGratuity),v.tc("removable",!1),v.Db(5),v.tc("ngIf",e.dgvGratuity.Visible),v.Db(5),v.tc("ngIf",e.cmbResignType.Visible),v.Db(4),v.tc("obj",e.chkCalcBasedOnLastSal)("group",e.form),v.Db(5),v.tc("obj",e.chkCalcBasedOnActDays)("group",e.form),v.Db(5),v.tc("obj",e.GratuityRemarks)("group",e.form),v.Db(6),v.Xc(e.btnCalcGratuity),v.Db(6),v.Xc(e.lbl1GratuityTotalDays),v.Db(2),v.Xc(e.lblGratuityTotalDays),v.Db(6),v.Xc(e.lbl1GratuityServiceDays),v.Db(2),v.Xc(e.lblGratuityServiceDays),v.Db(3),v.Xc(e.lbl1GratuityLOPDays),v.Db(2),v.Xc(e.lblGratuityLOPDays),v.Db(3),v.Xc(e.lbl1GratuityBalDays),v.Db(2),v.Xc(e.lblGratuityBalDays),v.Db(6),v.Xc(e.lbl1GratuityTotalGrDays),v.Db(2),v.Xc(e.lblGratuityTotalGrDays),v.Db(6),v.Xc(e.lbl1GratuityTaken),v.Db(2),v.Xc(e.lblGratuityTaken),v.Db(3),v.tc("ngIf",e.txtGratuityAmount.Visible),v.Db(2),v.tc("ngIf",e.txtAvailedGratuityAmount.Visible),v.Db(2),v.tc("ngIf",e.txtPartialGratuityAmount.Visible),v.Db(5),v.uc("heading",e.tpLeaveEncashment),v.tc("removable",!1),v.Db(4),v.tc("ngIf",e.dgvLeaveEncash.Visible),v.Db(4),v.tc("ngIf",e.txtCumLeaveSalBalAmt.Visible),v.Db(4),v.tc("obj",e.LeaveRemarks)("group",e.form),v.Db(6),v.Xc(e.btnCalcLE),v.Db(3),v.tc("ngIf",e.txtLEAmount.Visible),v.Db(5),v.uc("heading",e.tpUnProcessedSalary),v.tc("removable",!1),v.Db(4),v.tc("ngIf",e.dgvUPS.Visible),v.Db(6),v.tc("obj",e.UPSRemarks)("group",e.form),v.Db(3),v.tc("ngIf",e.txtUPSAmount.Visible),v.Db(5),v.uc("heading",e.tpNoticePay),v.tc("removable",!1),v.Db(4),v.tc("ngIf",e.dgvNoticePay.Visible),v.Db(6),v.tc("obj",e.NoticePayRemarks)("group",e.form),v.Db(3),v.tc("ngIf",e.txtNPAmount.Visible),v.Db(5),v.uc("heading",e.tpOtherAdditions),v.tc("removable",!1),v.Db(4),v.tc("ngIf",e.dgvOthAdd.Visible),v.Db(6),v.tc("obj",e.OAddRemarks)("group",e.form),v.Db(3),v.tc("ngIf",e.txtOthAddAmount.Visible),v.Db(5),v.uc("heading",e.tpOtherDeductions),v.tc("removable",!1),v.Db(4),v.tc("ngIf",e.dgvOthDed.Visible),v.Db(6),v.tc("obj",e.ODedRemarks)("group",e.form),v.Db(3),v.tc("ngIf",e.txtOthDedAmount.Visible),v.Db(5),v.uc("heading",e.tpLoanBalances),v.tc("removable",!1),v.Db(4),v.tc("ngIf",e.dgvLoanBal.Visible),v.Db(6),v.tc("obj",e.LoanRemarks)("group",e.form),v.Db(3),v.tc("ngIf",e.txtLoanBalAmount.Visible))},directives:[P.t,A.a,A.c,f.e,f.b,M.a,E.a],pipes:[L.d],encapsulation:2}),t})();class rt{constructor(){this.Days=0}}},NM0h:function(t,e,a){"use strict";a.d(e,"a",(function(){return l}));var s=a("Do2H"),i=a("Lp6j");class l{constructor(){this.ChangeValueXML=null,this.DetailsXML=null,this.AMCode=null,this.AMName=null,this.AMPurchaseValue=null,this.HistoryXML=null,this.DocNo=null,this.XML=null,this.DocSave=null,this.CodePrefix=null,this.Sno=null,this.AssetClassID=0,this.DeprBookID=0,this.AcqnCostACCID=0,this.AccumDeprACCID=0,this.AcqnCostDispACCID=0,this.AccumDeprDispACCID=0,this.GainsDispACCID=0,this.LossDispACCID=0,this.MaintExpenseACCID=0,this.DeprExpenseACCID=0,this.PostingGroupID=0,this.AMStatusID=0,this.CodeNumber=0,this.AMAssetID=0,this.AMParentAssetID=0,this.IsGroup=!1,this.Post=!1,this.StatusID=0,this.DeprBookMethod=0,this.DeprBookMethodBasedOn=0,this.AveragingMethodID=0,this.DeprScheduleID=0,this.DeprTypeID=0,this.AssetClassCode=null,this.AssetClassName=null,this.GUID=null,this.DeprBookCode=null,this.DeprBookName=null,this.PostGroupCode=null,this.PostGroupName=null,this.AMGUID=null,this.RecordType=null,this.AMGroup=!1,this.IsIncreaseAssetValue=!1,this.EmpName=null,this.EmpCode=null,this.EmpID=0,this.SelectedNodeID=0,this.PostCCID=0,this.PostAssetID=0,this.ScheduleID=0,this.LocationID=0,this.AddressXML=null,this.NotesXML=null,this.ContactsXML=null,this.CustomCostCenterFieldsQuery=null,this.CustomFieldsQuery=null,this.PrimaryContactQuery=null,this.AttachmetsXML=null,this.DepreciationXML=null,this.JVXML=null,this.Description=null,this.DeprStartValue=0,this.ChangeVal=0,this.AssetNetValueChange=0,this.DeprBookMethodBasedOnValue=0,this.TotalYears=0}static GetAssetClassDetails(t){let e=[];return e.push(t),e.push(s.a.SessionManager.UserID),e.push(s.a.SessionManager.LanguageID),s.a.accounting.GetAssetClassDetails(e)}static GetPostingGroupDetails(t){let e=[];return e.push(t),e.push(s.a.SessionManager.UserID),e.push(s.a.SessionManager.LanguageID),s.a.accounting.GetPostingGroupDetails(e)}SaveAssetClass(){0==this.AssetClassID&&(this.GUID=i.e.NewGuid());let t=[];return t.push(this.AssetClassID),t.push(null!=this.AssetClassCode?this.AssetClassCode:""),t.push(null!=this.AssetClassName?this.AssetClassName:""),t.push(this.PostingGroupID),t.push(this.DeprBookID),t.push(this.DeprTypeID),t.push(this.TotalYears),t.push(this.StatusID),t.push(s.a.SessionManager.CompanyGUID),t.push(this.GUID),t.push(""),t.push(s.a.SessionManager.UserName),t.push(s.a.SessionManager.UserID),t.push(s.a.SessionManager.LanguageID),s.a.accounting.SetAssetClass(t)}static GetDeprBookDetails(t){let e=[];return e.push(t),e.push(s.a.SessionManager.UserID),e.push(s.a.SessionManager.LanguageID),s.a.accounting.GetDeprBookDetails(e)}PostJVvoucher(){this.GUID=i.e.NewGuid();let t=[];return t.push(this.PostAssetID),t.push(this.PostCCID),t.push(this.JVXML),t.push(this.Post),t.push(this.DeprTypeID),t.push(this.DocXML),t.push(this.DocSave),t.push(this.DepreciationXML),t.push(this.RecordType),t.push(s.a.SessionManager.CompanyGUID),t.push(this.GUID),t.push(s.a.SessionManager.UserName),t.push(s.a.SessionManager.UserID),t.push(s.a.SessionManager.LanguageID),s.a.accounting.GetPostJvVoucher(t)}SetAssetDispose(t){this.GUID=i.e.NewGuid();let e=[];return e.push(this.PostAssetID),e.push(t.ToString("dd/MMM/yyyy")),e.push(this.PostCCID),e.push(this.JVXML),e.push(this.Post),e.push(this.DeprTypeID),e.push(this.DocXML),e.push(this.DocSave),e.push(this.DepreciationXML),e.push(this.RecordType),e.push(s.a.SessionManager.CompanyGUID),e.push(this.GUID),e.push(s.a.SessionManager.UserName),e.push(s.a.SessionManager.UserID),e.push(s.a.SessionManager.LanguageID),s.a.accounting.SetAssetDispose(e)}SaveDeprBook(t,e,a){0==this.DeprBookID&&(this.GUID=i.e.NewGuid());let l=[];return l.push(this.DeprBookID),l.push(this.DeprBookCode),l.push(this.DeprBookName),l.push(this.DeprBookMethod),l.push(this.DeprBookMethodBasedOn),l.push(this.DeprBookMethodBasedOnValue),l.push(this.StatusID),l.push(this.AveragingMethodID),l.push(t),l.push(e),l.push(a),l.push(s.a.SessionManager.CompanyGUID),l.push(this.GUID),l.push(""),l.push(s.a.SessionManager.UserName),l.push(s.a.SessionManager.UserID),l.push(s.a.SessionManager.LanguageID),s.a.accounting.SetDeprBook(l)}SaveFAPostingGroup(){0==this.PostingGroupID&&(this.GUID=i.e.NewGuid());let t=[];return t.push(this.PostingGroupID),t.push(this.PostGroupCode),t.push(this.PostGroupName),t.push(this.AcqnCostACCID),t.push(this.AccumDeprACCID),t.push(this.AcqnCostDispACCID),t.push(this.AccumDeprDispACCID),t.push(this.GainsDispACCID),t.push(this.LossDispACCID),t.push(this.MaintExpenseACCID),t.push(this.DeprExpenseACCID),t.push(this.StatusID),t.push(0),t.push(this.IsGroup),t.push(s.a.SessionManager.CompanyGUID),t.push(this.GUID),t.push(s.a.SessionManager.UserName),t.push(s.a.SessionManager.UserID),t.push(s.a.SessionManager.LanguageID),s.a.accounting.SetPostingGroup(t)}static GetAssetManagementDetails(t){let e=[];return e.push(t),e.push(s.a.SessionManager.UserID),e.push(s.a.SessionManager.LanguageID),s.a.accounting.GetAssetManagementDetails(e)}static GetAssetDeprSchDetails(t){let e=[];return e.push(t),e.push(s.a.SessionManager.UserID),e.push(s.a.SessionManager.LanguageID),s.a.accounting.GetAssetDeprSchDetails(e)}SetAssetManagementDetails(){let t=[];return t.push(this.AMAssetID),t.push(this.AMCode),t.push(this.AMName),t.push(this.AMStatusID),t.push(this.AMPurchaseValue),t.push(this.AMParentAssetID),t.push(this.AMGroup),t.push(this.CodePrefix),t.push(this.CodeNumber),t.push(this.Sno),t.push(this.DetailsXML),t.push(this.ChangeValueXML),t.push(this.CustomFieldsQuery),t.push(this.CustomCostCenterFieldsQuery),t.push(this.DepreciationXML),t.push(this.HistoryXML),t.push(this.NotesXML),t.push(this.AttachmetsXML),t.push(s.a.SessionManager.CompanyGUID),t.push(this.AMGUID),t.push(s.a.SessionManager.UserName),t.push(s.a.SessionManager.UserID),t.push(s.a.SessionManager.LanguageID),s.a.accounting.SetAssetManagementDetails(t).toPromise()}static DeleteAsset(t){let e=[];return e.push(t),e.push(s.a.SessionManager.UserID),e.push(s.a.SessionManager.RoleID),s.a.accounting.DeleteAsset(e)}static DeleteAssetDeprSchedule(t){let e=[];return e.push(t),e.push(s.a.SessionManager.RoleID),e.push(s.a.SessionManager.LanguageID),s.a.accounting.DeleteAssetDeprSchedule(e)}static DeleteAssetRefDoc(t,e){let a=[];return a.push(t),a.push(e),a.push(s.a.SessionManager.UserID),s.a.accounting.DeleteAssetRefDoc(a)}PostDeprJV(){this.GUID=i.e.NewGuid();let t=[];return t.push(this.PostCCID),t.push(this.JVXML),t.push(this.Post),t.push(s.a.SessionManager.CompanyGUID),t.push(this.GUID),t.push(s.a.SessionManager.UserName),t.push(s.a.SessionManager.UserID),t.push(s.a.SessionManager.LanguageID),t.push(s.a.SessionManager.RoleID),s.a.accounting.PostDeprJV(t)}PostDeprJVSummary(t,e,a,l,o){this.GUID=i.e.NewGuid();let n=[];return n.push(t),n.push(e),n.push(a),n.push(l),n.push(o),n.push(s.a.SessionManager.CompanyGUID),n.push(s.a.SessionManager.UserName),n.push(s.a.SessionManager.UserID),n.push(s.a.SessionManager.LanguageID),s.a.accounting.SetDeprPostingJVSummary(n).toPromise()}static SetsPostDeprReverseJV(t,e,a){let i=[];return i.push(t),i.push(e),i.push(a),i.push(s.a.SessionManager.CompanyGUID),i.push(s.a.SessionManager.UserName),i.push(s.a.SessionManager.UserID),i.push(s.a.SessionManager.LanguageID),s.a.accounting.SetsPostDeprReverseJV(i)}ChangeValue(t,e){this.GUID=i.e.NewGuid();let a=[];return a.push(this.PostAssetID),a.push(t),a.push(this.ChangeVal),a.push(this.AssetNetValueChange),a.push(e.ToString("dd/MMM/yyyy")),a.push(this.Description),a.push(this.DepreciationXML),a.push(this.ChangeValueXML),a.push(this.HistoryXML),a.push(this.LocationID),a.push(this.IsIncreaseAssetValue),a.push(this.JVXML),a.push(this.ChangeValueTypeID),a.push(s.a.SessionManager.CompanyGUID),a.push(this.GUID),a.push(s.a.SessionManager.UserName),a.push(s.a.SessionManager.UserID),a.push(s.a.SessionManager.LanguageID),s.a.accounting.SetAssetChangeValue(a)}DisposeReverse(t){let e=[];return e.push(t),e.push(s.a.SessionManager.UserName),e.push(s.a.SessionManager.UserID),e.push(s.a.SessionManager.LanguageID),s.a.accounting.DisposeReverse(e)}}},R89Y:function(t,e,a){"use strict";a.d(e,"a",(function(){return g}));var s=a("3Pt+"),i=a("fXoL"),l=a("ofXK"),o=a("sT9C"),n=a("sYmb");function r(t,e){if(1&t){const t=i.ac();i.Zb(0,"span",7),i.hc("click",(function(){return i.Ic(t),i.lc().obj.Button_Click("Process")})),i.Ub(1,"i",18),i.Wc(2),i.mc(3,"translate"),i.Yb()}2&t&&(i.Db(2),i.Xc(i.nc(3,1,"Process")))}function h(t,e){if(1&t){const t=i.ac();i.Zb(0,"span",7),i.hc("click",(function(){return i.Ic(t),i.lc().obj.Button_Click("Post")})),i.Ub(1,"i",19),i.Wc(2),i.mc(3,"translate"),i.Yb()}2&t&&(i.Db(2),i.Xc(i.nc(3,1,"Post")))}function d(t,e){if(1&t){const t=i.ac();i.Zb(0,"span",7),i.hc("click",(function(){return i.Ic(t),i.lc().obj.Button_Click("UnPost")})),i.Ub(1,"i",20),i.Wc(2),i.mc(3,"translate"),i.Yb()}2&t&&(i.Db(2),i.Xc(i.nc(3,1,"UnPost")))}function c(t,e){if(1&t){const t=i.ac();i.Zb(0,"span",7),i.hc("click",(function(){return i.Ic(t),i.lc().obj.Button_Click("Export")})),i.Ub(1,"i",21),i.Wc(2),i.mc(3,"translate"),i.Yb()}2&t&&(i.Db(2),i.Xc(i.nc(3,1,"Export")))}const u=function(){return{standalone:!0}};let g=(()=>{class t{constructor(){this.form=new s.j({})}ngOnInit(){this.obj=this.params.obj}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Nb({type:t,selectors:[["app-consolidated-monthly-payroll"]],decls:60,vars:22,consts:[[1,"maincontainer"],[1,"page-header"],[1,"page-title_div"],[1,"page-title"],[1,"page-Subtitle",3,"dblclick"],[1,"btnMetroDiv","secondary-btn-group",2,"margin-right","6px"],["class","secondary-btn",3,"click",4,"ngIf"],[1,"secondary-btn",3,"click"],[1,"fa-light","fa-broom"],[1,"fa-light","fa-filter"],[1,"fa-light","fa-search"],[1,"main_div",2,"display","flex","flex-direction","column","padding","10px"],[1,"row",2,"height","30px"],[1,"form-group","col-xl-3","col-md-4","col-sm-6","col-xs-12","divChk"],["type","checkbox",3,"ngModel","ngModelOptions","ngModelChange"],[3,"click"],[1,"documentgrid",2,"flex","1","overflow","auto"],[2,"width","100%","height","100%",3,"obj"],[1,"fa-light","fa-gears"],[1,"fa-light","fa-floppy-disk-circle-arrow-right"],[1,"fa-light","fa-file-times"],[1,"fa-light","fa-file-export"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Wc(1,"\n      "),i.Zb(2,"div",1),i.Wc(3,"\n        "),i.Zb(4,"div",2),i.Wc(5,"\n          "),i.Zb(6,"span",3),i.Wc(7),i.Zb(8,"span",4),i.hc("dblclick",(function(t){return e.obj.sPayrollMonth_MouseDoubleClick(t)})),i.Wc(9),i.Yb(),i.Wc(10,"\n          "),i.Yb(),i.Wc(11,"\n        "),i.Yb(),i.Wc(12,"\n\n        "),i.Zb(13,"div",5),i.Wc(14,"\n          "),i.Uc(15,r,4,3,"span",6),i.Wc(16,"\n          "),i.Uc(17,h,4,3,"span",6),i.Wc(18,"\n          "),i.Zb(19,"span",7),i.hc("click",(function(){return e.obj.Button_Click("Clear")})),i.Ub(20,"i",8),i.Wc(21),i.mc(22,"translate"),i.Yb(),i.Wc(23,"\n          "),i.Uc(24,d,4,3,"span",6),i.Wc(25,"\n          "),i.Zb(26,"span",7),i.hc("click",(function(){return e.obj.Button_Click("Filter")})),i.Ub(27,"i",9),i.Wc(28),i.mc(29,"translate"),i.Yb(),i.Wc(30,"\n          "),i.Zb(31,"span",7),i.hc("click",(function(){return e.obj.Button_Click("Load")})),i.Ub(32,"i",10),i.Wc(33),i.mc(34,"translate"),i.Yb(),i.Wc(35,"\n          "),i.Uc(36,c,4,3,"span",6),i.Wc(37,"\n        "),i.Yb(),i.Wc(38,"\n      "),i.Yb(),i.Wc(39,"\n    "),i.Zb(40,"div",11),i.Wc(41,"\n        "),i.Zb(42,"div",12),i.Wc(43,"\n          "),i.Zb(44,"div",13),i.Wc(45,"\n            "),i.Zb(46,"input",14),i.hc("ngModelChange",(function(t){return e.obj.IsProcessWithArrears=t})),i.Yb(),i.Wc(47,"\n            "),i.Zb(48,"label",15),i.hc("click",(function(){return e.obj.IsProcessWithArrears=!e.obj.IsProcessWithArrears})),i.Wc(49),i.mc(50,"translate"),i.Yb(),i.Wc(51,"\n        "),i.Yb(),i.Wc(52,"\n        "),i.Yb(),i.Wc(53,"\n        "),i.Zb(54,"div",16),i.Wc(55,"\n          "),i.Ub(56,"app-PactGridView",17),i.Wc(57,"  \n        "),i.Yb(),i.Wc(58,"\n    "),i.Yb(),i.Wc(59,"\n"),i.Yb()),2&t&&(i.Db(7),i.Yc("\n            ",e.obj.Title,"\n            "),i.Db(2),i.Yc("\n              ",e.obj.sPayrollMonth,"\n            "),i.Db(6),i.tc("ngIf",e.obj.PostVisiblility),i.Db(2),i.tc("ngIf",e.obj.PostVisiblility),i.Db(4),i.Xc(i.nc(22,13,"Clear")),i.Db(3),i.tc("ngIf",e.obj.UnPostVisiblility),i.Db(4),i.Xc(i.nc(29,15,"Filter")),i.Db(5),i.Xc(i.nc(34,17,"Load")),i.Db(3),i.tc("ngIf",e.obj.ExportVisiblility),i.Db(10),i.tc("ngModel",e.obj.IsProcessWithArrears)("ngModelOptions",i.xc(21,u)),i.Db(3),i.Xc(i.nc(50,19,"ProcesswithArrears")),i.Db(7),i.tc("obj",e.obj.dgvEmployees))},directives:[l.t,s.a,s.s,s.v,o.a],pipes:[n.d],encapsulation:2}),t})()},c42x:function(t,e,a){"use strict";a.d(e,"a",(function(){return h}));var s=a("3Pt+"),i=a("fXoL"),l=a("ofXK"),o=a("sT9C"),n=a("sYmb");function r(t,e){if(1&t){const t=i.ac();i.Zb(0,"span",6),i.hc("click",(function(){return i.Ic(t),i.lc().obj.Button_Click("Post")})),i.Ub(1,"i",12),i.Wc(2,"Post"),i.Yb()}}let h=(()=>{class t{constructor(){this.form=new s.j({})}ngOnInit(){this.obj=this.params.obj}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Nb({type:t,selectors:[["app-post-att-time-sheet-to-daily-att"]],decls:36,vars:12,consts:[[2,"display","flex","position","relative","height","100%"],[2,"width","100%"],[1,"page-header"],[1,"page-title"],[1,"btnMetroDiv","secondary-btn-group",2,"margin-right","6px"],["class","secondary-btn-wicon",3,"click",4,"ngIf"],[1,"secondary-btn-wicon",3,"click"],[1,"fa-light","fa-broom"],[1,"fa-light","fa-filter"],[1,"fa-light","fa-file-export"],[1,"documentgrid","row","form-row",2,"padding","4px 12px","height","calc(100% - 50px)","width","100%"],[2,"width","100%","height","100%",3,"obj"],[1,"fa-light","fa-floppy-disk-circle-arrow-right"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Wc(1,"\n    "),i.Zb(2,"div",1),i.Wc(3,"\n        "),i.Zb(4,"div",2),i.Wc(5,"\n            "),i.Zb(6,"label",3),i.Wc(7),i.Yb(),i.Wc(8,"\n            "),i.Zb(9,"div",4),i.Wc(10,"\n            "),i.Uc(11,r,3,0,"span",5),i.Wc(12,"\n            "),i.Zb(13,"span",6),i.hc("click",(function(){return e.obj.Button_Click("Clear")})),i.Ub(14,"i",7),i.Wc(15),i.mc(16,"translate"),i.Yb(),i.Wc(17,"\n            "),i.Zb(18,"span",6),i.hc("click",(function(){return e.obj.Button_Click("Filter")})),i.Ub(19,"i",8),i.Wc(20),i.mc(21,"translate"),i.Yb(),i.Wc(22,"\n            "),i.Zb(23,"span",6),i.hc("click",(function(){return e.obj.Button_Click("Export")})),i.Ub(24,"i",9),i.Wc(25),i.mc(26,"translate"),i.Yb(),i.Wc(27,"\n            "),i.Yb(),i.Wc(28,"\n        "),i.Yb(),i.Wc(29,"\n        "),i.Zb(30,"div",10),i.Wc(31,"\n            "),i.Ub(32,"app-PactGridView",11),i.Wc(33,"  \n        "),i.Yb(),i.Wc(34,"\n   "),i.Yb(),i.Wc(35,"\n "),i.Yb()),2&t&&(i.Db(7),i.Xc(e.obj.Title),i.Db(4),i.tc("ngIf",e.obj.PostVisiblility),i.Db(4),i.Xc(i.nc(16,6,"Clear")),i.Db(5),i.Xc(i.nc(21,8,"Filter")),i.Db(5),i.Xc(i.nc(26,10,"lbl_Export")),i.Db(7),i.tc("obj",e.obj.dgv))},directives:[l.t,o.a],pipes:[n.d],encapsulation:2}),t})()},eBJM:function(t,e,a){"use strict";a.d(e,"a",(function(){return D}));var s=a("3Pt+"),i=a("Do2H"),l=a("Lp6j"),o=a("uMy8"),n=a("EQd/"),r=a("n56n"),h=a("vTM8"),d=a("dH+5"),c=a("0/4Q");class u{constructor(){this.FromSlab=0,this.ToSlab=0,this.Percentage=0}}class g{constructor(t){this.prevSelectedEmp=0,this.iSelectedEmpSeqNo=0,this.prevSelectReperson=0,this.BasicIndex=-1,this.TotalSalaryIndex=0,this.Form12Section1Index=0,this.Form12Section2Index=0,this.Exemptionsunder10Index=0,this.HRA10BasicIndex=0,this.HRAAcutalIndex=0,this.HRAMetroNonMetroIndex=0,this.HRAExemptionIndex=0,this.TDSPaidIndex=0,this.NetTaxPayableIndex=0,this.InhandAmountIndex=0,this.MonthlyDeducIndex=0,this.intTotalIncometaxPayableindex=0,this.TotAmtOthExemptUs10Index=0,this.ConveyanceIndex=0,this.ChildrenEduIndex=0,this.StandardDedIndex=0,this.MedicalIndex=0,this.LTAIndex=0,this.LeaveEncashIndex=0,this.FoodIndex=0,this.GratuityIndex=0,this.BalanceSalInc12BAIndex=0,this.ProfessionalTaxIndex=0,this.NetTaxableSalIndex=0,this.GrossTotalIncomeIndex=0,this.IncomefromHousePropertyIndex=0,this.intDeducunder8oCto80CCCIndex=0,this.intTotalDeducunder8oCto80CCCIndex=0,this.intOtherDeducunder8oCto80CCCIndex=0,this.dblTotalIncomeIndex=0,this.dblTotalIncomeRoundoffIndex=0,this.intOtherDeducunder8oCto80CCCIndex1=0,this.dblTaxOnTotalIncomeIndex=0,this.dblRebateIndex=0,this.dblTaxPayableAfterRebateIndex=0,this.dblSurchargeIndex=0,this.dblTaxPayableIndex=0,this.dblEducationCessIndex=0,this.dblSecHighEduCessIndex=0,this.dblbalanceSalaryInc12BA=0,this.dblTotalCellSalary=0,this.dPerq1=0,this.dPerq2=0,this.HraMinValue=0,this.dblMedicalAmount=0,this.dblLTAAmount=0,this.dblLeaveEncashAmount=0,this.dblFoodAmount=0,this.dblGratuityAmount=0,this.dblTotaldeduction80ccc80c=0,this.dblNetTaxableSal=0,this.dblGrossTotalIncome=0,this.dblTDS=0,this.dblNetTaxPayable=0,this.dblInhandAmount=0,this.dblSelfletoutamount=0,this.dblTotalIncome=0,this.dblTotalIncomeRoundoff=0,this.dblServiceDays=0,this.dblStandardDeduction=0,this.lstTaxSalbs=new Array,this.MessageDisplay="",this.txtDesignation=new n.d,this.lstResponsiblePerson=new r.b,this.cmbYear=new c.e;try{this.ITComputationViewModel=t,this.BindGridColumns(),this.MessageDisplay=""}catch(e){Logger.ErrorLog("Error : "+e),this.MessageDisplay=e.Message}}BindGridColumns(){try{let t;t=new d.b,t.HeaderText="SNo",t.width=10,this.grdIncomeTax.ReportColumns.push(t),t=new d.b,t.HeaderText="Header",t.width=20,this.grdIncomeTax.ReportColumns.push(t),t=new d.b,t.HeaderText="ComponentID",t.width=25,this.grdIncomeTax.ReportColumns.push(t),t=new d.b,t.HeaderText="Salary Breakup",t.width=220,this.grdIncomeTax.ReportColumns.push(t),t=new d.b,t.HeaderText="Investment & Bill Details",t.width=100,this.grdIncomeTax.ReportColumns.push(t)}catch(t){Logger.ErrorLog("Error : "+t),this.MessageDisplay=t.message}}get lstEmployee(){return this.ITComputationViewModel.Employee.Code}get lstEmployeeName(){return this.ITComputationViewModel.Employee.Name}clear(t){this.MessageDisplay="",this.prevSelectedEmp=0,this.prevSelectReperson=0,this.dblbalanceSalaryInc12BA=this.dblTotalCellSalary=this.dPerq1=this.dPerq2=this.HraMinValue=this.dblMedicalAmount=this.dblLTAAmount=this.dblLeaveEncashAmount=this.dblFoodAmount=this.dblGratuityAmount=0,this.dblTotaldeduction80ccc80c=this.dblNetTaxableSal=this.dblGrossTotalIncome=this.dblTotalIncome=this.dblTotalIncomeRoundoff=this.dblServiceDays=this.dblTDS=this.dblNetTaxPayable=this.dblInhandAmount=0,this.dblStandardDeduction=0,this.grdIncomeTax.Clear(),this.txtDesignation.Text="",1==t&&(this.lstEmployee.SelectedValue=this.lstEmployeeName.SelectedValue=this.lstResponsiblePerson.SelectedValue=null,this.lstEmployee.SelectedValue=this.lstEmployeeName.SelectedValue=this.lstResponsiblePerson.SelectedValue=null)}btnSave_Click(t){if(null!=t)try{if("Clear"==t)this.clear(1);else if("Save"==t)try{let e=this.ValidateData();this.ITComputationViewModel.sbValidation=null,this.ITComputationViewModel.sbComputationData=null;let a=0,s=0,i="";if(0==e.length){i+="<Rows>";for(let t=0;t<this.grdIncomeTax.Data.length;t++)null!=this.grdIncomeTax.Data[t].Cells[1].Value&&(i+='<row HeaderID="'+this.grdIncomeTax.Data[t].Cells[1].Value,parseFloat(this.grdIncomeTax.Data[t].Cells[2].Value)<0?i+='" HeaderName="'+this.grdIncomeTax.Data[t].Cells[3].Value:i+='" HeaderName="',i+='" ComponentID="'+this.grdIncomeTax.Data[t].Cells[2].Value,a=l.e.Double(this.grdIncomeTax.Data[t].Cells[4].Value),i+=a>=0?'" ComponentAmount="'+a:'" ComponentAmount="-1',s=l.e.Double(this.grdIncomeTax.Data[t].Cells[17].Value),i+='" TotalAmount="'+s,i+='"/>');i+="</Rows>",this.ITComputationViewModel.sbComputationData=i,this.clear(1)}else i+=e,this.ITComputationViewModel.sbValidation=i;this.ITComputationViewModel.OnSaveITComputation(t)}catch(e){Logger.ErrorLog("Error : "+e)}else if("Delete"==t)try{let e=this.ValidateData();this.ITComputationViewModel.sbValidation=null,this.ITComputationViewModel.sbComputationData=null;let a="";0==e.length?(this.ITComputationViewModel.sbComputationData=a,this.clear(1)):(a+=e,this.ITComputationViewModel.sbValidation=a),this.ITComputationViewModel.OnDeleteITComputation(t)}catch(e){Logger.ErrorLog("Error : "+e)}else if("Export"==t){let t=this.ValidateData();this.ITComputationViewModel.sbValidation=null,this.ITComputationViewModel.sbComputationData=null;let e="";0==t.length?(this.ITComputationViewModel.sbComputationData=e,this.ExportToExcel()):(e+=t,this.ITComputationViewModel.sbValidation=e)}}catch(a){Logger.ErrorLog("Error : "+a),this.MessageDisplay=a.message}}ExportToExcel(){}ValidateData(){let t="";return null==this.lstEmployee.SelectedValue&&(t="Please select the Employee."),t}GetMonthName(t,e){t>12&&(t-=12);let a="";switch(t){case 1:a=e?"January":"Jan";break;case 2:a=e?"February":"Feb";break;case 3:a=e?"March":"Mar";break;case 4:a=e?"April":"Apr";break;case 5:a="May";break;case 6:a=e?"June":"Jun";break;case 7:a=e?"July":"Jul";break;case 8:a=e?"August":"Aug";break;case 9:a=e?"September":"Sep";break;case 10:a=e?"October":"Oct";break;case 11:a=e?"November":"Nov";break;case 12:a=e?"December":"Dec"}return a}lstEmployee_SelectionChanged(t){this.lstEmployee.SelectedValue!=this.prevSelectedEmp&&(this.lstEmployeeName.SelectedValue=this.lstEmployee.SelectedValue,this.clear(0),this.prevSelectedEmp=this.lstEmployee.SelectedValue,this.iSelectedEmpSeqNo=this.lstEmployee.SelectedValue,this.ITComputationViewModel.Employee_SelectedValueChanged(t),this.FillDetails())}lstResponsiblePerson_SelectionChanged(t){null!=this.lstResponsiblePerson.SelectedValue&&this.lstResponsiblePerson.SelectedValue!=this.prevSelectReperson&&(this.prevSelectReperson=this.lstResponsiblePerson.SelectedValue,this.txtDesignation.Text="",this.dsRespPerson=this.ITComputationViewModel.lstResponsiblePerson_SelectedValueChanged(t),null!=this.dsRespPerson&&this.dsRespPerson.Tables[0].length>0&&(this.txtDesignation.Text=this.dsRespPerson.Tables[0][0].Designation.toString()))}grdIncomeTax_CellEndEdit(t){if(4==t.ColumnIndex){let a=0;try{a=parseFloat(this.grdIncomeTax.Data[t.RowIndex][t.ColumnIndex]),a<0&&(a=0)}catch(e){}if(t.RowIndex==this.IncomefromHousePropertyIndex||t.RowIndex==this.IncomefromHousePropertyIndex+1||t.RowIndex==this.IncomefromHousePropertyIndex+2||t.RowIndex==this.IncomefromHousePropertyIndex+3||t.RowIndex==this.IncomefromHousePropertyIndex+4)return;t.RowIndex>=this.intDeducunder8oCto80CCCIndex&&t.RowIndex<this.intTotalDeducunder8oCto80CCCIndex||(this.grdIncomeTax.Data[t.RowIndex][17]=l.e.GetAmount(a)),this.dblbalanceSalaryInc12BA=this.dblTotalCellSalary+this.dPerq1+this.dPerq2-(this.HraMinValue+parseFloat(this.grdIncomeTax.Data[this.ConveyanceIndex][this.grdIncomeTax.ReportColumns.length-1].Value)+parseFloat(this.grdIncomeTax.Data[this.ChildrenEduIndex][this.grdIncomeTax.ReportColumns.length-1].Value)+parseFloat(this.grdIncomeTax.Data[this.MedicalIndex][4].Value)+parseFloat(this.grdIncomeTax.Data[this.LTAIndex][4].Value)+parseFloat(this.grdIncomeTax.Data[this.LeaveEncashIndex][4].Value)+parseFloat(this.grdIncomeTax.Data[this.FoodIndex][4].Value)+parseFloat(this.grdIncomeTax.Data[this.GratuityIndex][4].Value)+this.dblStandardDeduction),this.grdIncomeTax.Data[this.BalanceSalInc12BAIndex][17].Value=l.e.GetAmount(this.dblbalanceSalaryInc12BA),a=parseFloat(this.grdIncomeTax.Data[this.BalanceSalInc12BAIndex][17].Value)-parseFloat(this.grdIncomeTax.Data[this.ProfessionalTaxIndex][17].Value),this.grdIncomeTax.Data[this.NetTaxableSalIndex][17].Value=l.e.GetAmount(a),this.dblGrossTotalIncome=0,this.dblGrossTotalIncome=a+this.dblSelfletoutamount-parseFloat(this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+4][17].Value),this.grdIncomeTax.Data[this.GrossTotalIncomeIndex][17].Value=l.e.GetAmount(this.dblGrossTotalIncome);let s=0,i=0;if(this.dvLimit.RowFilter="ComponentID=995",null!=this.dvLimit[0].AmountLimit&&null!=this.dvLimit[0].AmountLimit&&""!=this.dvLimit[0].AmountLimit.toString()&&(i=parseFloat(this.dvLimit[0].AmountLimit)),t.RowIndex>=this.intDeducunder8oCto80CCCIndex&&t.RowIndex<=this.intTotalDeducunder8oCto80CCCIndex){let e=0;for(let a=this.intDeducunder8oCto80CCCIndex+1;a<this.intTotalDeducunder8oCto80CCCIndex;a++)this.dvLimit.RowFilter="ComponentID="+parseInt(this.grdIncomeTax.Data[a].Cells[2].Value),this.dvLimit.length>0&&(s=l.e.Double(this.dvLimit[0].AmountLimit),s>0&&parseInt(this.grdIncomeTax.Data[a].Cells[2].Value)==parseInt(this.dvLimit[0].ComponentID)&&parseFloat(this.grdIncomeTax.Data[a].Cells[t.ColumnIndex].Value)>s&&(this.grdIncomeTax.Data[a].Cells[t.ColumnIndex].Value=l.e.GetAmount(s),this.grdIncomeTax.Data[a].Cells[17].Value=l.e.GetAmount(s))),e+=parseFloat(this.grdIncomeTax.Data[a].Cells[t.ColumnIndex].Value),this.dvLimit.RowFilter="";this.grdIncomeTax.Data[this.intTotalDeducunder8oCto80CCCIndex][4].Value=l.e.GetAmount(e),e>i&&(e=i),this.dblTotaldeduction80ccc80c=e,this.grdIncomeTax.Data[this.intTotalDeducunder8oCto80CCCIndex][17].Value=l.e.GetAmount(this.dblTotaldeduction80ccc80c)}let o=0;for(let e=this.intOtherDeducunder8oCto80CCCIndex;e<=this.intOtherDeducunder8oCto80CCCIndex1;e++)this.dvLimit.RowFilter="",this.dvLimit.RowFilter="ComponentID="+parseInt(this.grdIncomeTax.Data[e].Cells[2].Value),this.dvLimit.length>0&&(s=l.e.Double(this.dvLimit[0].AmountLimit),s>0&&parseInt(this.grdIncomeTax.Data[e].Cells[2].Value)==parseInt(this.dvLimit[0].ComponentID)&&parseFloat(this.grdIncomeTax.Data[e].Cells[t.ColumnIndex].Value)>s&&(this.grdIncomeTax.Data[e].Cells[t.ColumnIndex].Value=l.e.GetAmount(s),this.grdIncomeTax.Data[e].Cells[17].Value=l.e.GetAmount(s))),o+=parseFloat(this.grdIncomeTax.Data[e].Cells[t.ColumnIndex].Value);this.grdIncomeTax.Data[this.dblTotalIncomeIndex][17].Value=l.e.GetAmount(this.dblGrossTotalIncome-this.dblTotaldeduction80ccc80c-o),this.grdIncomeTax.Data[this.dblTotalIncomeRoundoffIndex][17].Value=l.e.GetAmount(Math.round(this.dblGrossTotalIncome-this.dblTotaldeduction80ccc80c-o)),this.UpdateTotals(parseFloat(this.grdIncomeTax.Data[this.dblTotalIncomeRoundoffIndex][17].Value))}}UpdateTotals(t){let e=0;for(let i=0;i<this.lstTaxSalbs.length&&t>0;i++)if(0==i){if(t<this.lstTaxSalbs[i].ToSlab){e+=t*this.lstTaxSalbs[i].Percentage;break}e+=this.lstTaxSalbs[i].ToSlab*this.lstTaxSalbs[i].Percentage}else{if(t<this.lstTaxSalbs[i].ToSlab){e+=(t-this.lstTaxSalbs[i-1].ToSlab)*this.lstTaxSalbs[i].Percentage;break}e+=(this.lstTaxSalbs[i].ToSlab-this.lstTaxSalbs[i-1].ToSlab)*this.lstTaxSalbs[i].Percentage}this.grdIncomeTax.Data[this.dblTaxOnTotalIncomeIndex][17].Value=l.e.GetAmount(Math.round(e));let a=0,s=0;s=parseFloat(this.grdIncomeTax.Data[this.dblTaxOnTotalIncomeIndex][17].Value),s>0&&(parseInt(this.cmbYear.SelectedValue)<2016?t<=5e5&&(a=2e3):2016==parseInt(this.cmbYear.SelectedValue)?t<=5e5&&(a=5e3):2017==parseInt(this.cmbYear.SelectedValue)||2018==parseInt(this.cmbYear.SelectedValue)?t<=35e4&&(a=2500):parseInt(this.cmbYear.SelectedValue)>=2019&&t<=5e5&&(a=12500)),s<a?this.grdIncomeTax.Data[this.dblRebateIndex][17].Value=l.e.GetAmount(Math.round(s)):this.grdIncomeTax.Data[this.dblRebateIndex][17]=l.e.GetAmount(Math.round(a)),s-a<0?(this.grdIncomeTax.Data[this.dblTaxPayableAfterRebateIndex][17]=0,e=0):(this.grdIncomeTax.Data[this.dblTaxPayableAfterRebateIndex][17]=l.e.GetAmount(s-a),e=s-a);let n,r=0,d=null,c=new h.a;if(this.dsTaxData.Tables[7].length>0){let t;n=new o.c("Basic",""),c.push("Basic",n),c.Basic.setFieldValue(parseFloat(this.dsTaxData.Tables[3][0].BasicMonthly).toString()),n=new o.c("TotalIncome",""),c.push("TotalIncome",n),c.TotalIncome.setFieldValue(this.dblTotalIncomeRoundoff),d=this.dsTaxData.Tables[8];let e=this.dsTaxData.Tables[3];if(d=this.dsTaxData.Tables[8].filter(t=>1==t.Type&&"OverTime"!=t.FieldType),d.length>0)for(let a=0;a<d.length;a++)t=this.dsTaxData.Tables[8].Select("ComponentID="+d[a].ComponentID),null!=t&&t.length>0&&(n=new o.c(d[a].ComponentName.toString(),""),c.push(d[a].ComponentName.toString(),n),c[d[a].ComponentName.toString()].setFieldValue(e[0]["Earning"+t[0].SNo.toString()].toString()));if(d=this.dsTaxData.Tables[8].filter(t=>2==t.Type&&"OverTime"!=t.FieldType),d.length>0)for(let a=0;a<d.length;a++)t=this.dsTaxData.Tables[8].Select("ComponentID="+d[a].ComponentID),null!=t&&t.length>0&&(n=new o.c(d[a].ComponentName.toString(),""),c.push(d[a].ComponentName.toString(),n),c[d[a].ComponentName.toString()].setFieldValue(e[0]["Deduction"+t[0].SNo.toString()].toString()))}let u=c;this.dvTaxSlabs.length>0&&null!=this.dvTaxSlabs[0].Surcharge&&null!=this.dvTaxSlabs[0].Surcharge&&""!=this.dvTaxSlabs[0].Surcharge.toString().Trim()&&(r=parseFloat(i.a.eval.EvaluateExpression(this.dvTaxSlabs[0].Surcharge.toString(),u))),this.grdIncomeTax.Data[this.dblSurchargeIndex].Cells[3].Value="Surcharge @ "+r+"%",this.grdIncomeTax.Data[this.dblSurchargeIndex][17]=(t=e*r/100)>0?l.e.GetAmount(Math.round(t)):0,e+=Math.round(t),this.grdIncomeTax.Data[this.dblTaxPayableIndex][17]=e>0?l.e.GetAmount(e):0,r=0,this.dvTaxSlabs.length>0&&null!=this.dvTaxSlabs[0].EducationCess&&null!=this.dvTaxSlabs[0].EducationCess&&""!=this.dvTaxSlabs[0].EducationCess.toString().Trim()&&(r=parseFloat(i.a.eval.EvaluateExpression(this.dvTaxSlabs[0].EducationCess.toString(),u))),this.grdIncomeTax.Data[this.dblEducationCessIndex].Cells[3].Value="Education Cess @ "+r+"%",t=e*r/100,e+=Math.round(t),this.grdIncomeTax.Data[this.dblEducationCessIndex][17]=t>0?l.e.GetAmount(Math.round(t)):0,r=0,this.dvTaxSlabs.length>0&&null!=this.dvTaxSlabs[0].SecondaryandHighEduc&&null!=this.dvTaxSlabs[0].SecondaryandHighEduc&&""!=this.dvTaxSlabs[0].SecondaryandHighEduc.toString().Trim()&&(r=parseFloat(i.a.eval.EvaluateExpression(this.dvTaxSlabs[0].SecondaryandHighEduc.toString(),u))),this.grdIncomeTax.Data[this.dblSecHighEduCessIndex].Cells[3].Value="Secondary and Higher Education Cess @ "+r+"%",t=e*r/100,e+=Math.round(t),this.grdIncomeTax.Data[this.dblSecHighEduCessIndex][17]=t>0?l.e.GetAmount(Math.round(t)):0,this.grdIncomeTax.Data[this.intTotalIncometaxPayableindex][17]=e>0?l.e.GetAmount(Math.round(e)):0,this.grdIncomeTax.Data[this.TDSPaidIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=l.e.GetAmount(this.dblTDS),this.grdIncomeTax.Data[this.NetTaxPayableIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=l.e.GetAmount(parseFloat(this.grdIncomeTax.Data[this.intTotalIncometaxPayableindex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value)-parseFloat(this.grdIncomeTax.Data[this.TDSPaidIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value))}FillDetails(){try{let t=0,e=0,a=0,s=(new Date).OnlyDate(),n="";this.dsTaxData=this.ITComputationViewModel.dsITComputation;let r=this.dsTaxData.Tables[0].DefaultView,d=this.dsTaxData.Tables[1].DefaultView,c=this.dsTaxData.Tables[2].DefaultView;c.RowFilter=" ComponentType='1'";let g=this.dsTaxData.Tables[3].DefaultView,m=this.dsTaxData.Tables[18].DefaultView;if(this.dvTaxSlabs=this.dsTaxData.Tables[7].DefaultView,this.dvLimit=this.dsTaxData.Tables[15].DefaultView,this.dvEmpTaxComputation=this.dsTaxData.Tables[21].DefaultView,r.length>0&&(r.RowFilter="MapFieldName='IT_BASIC'",0==r.length&&(n+="Basic component is not available,Please map component in the payroll strucuture\r\n")),0==g.length&&(n+="Employee Payroll information not available\r\n"),0==this.dvLimit.length&&(n+="Income tax amount limit data not avalilable for the selected year"),""!=n.toString())return void(this.MessageDisplay=n);this.dblServiceDays=0,this.dtDateofJoining=new Date(m[0].CDOJ),this.dtFromMonth=new Date(parseInt(this.cmbYear.SelectedValue),i.a.SessionManager.AccountingFromMonth-1,1),this.dtToMonth=this.dtFromMonth.AddYears(1).AddDays(-1),this.dblServiceDays=s.Subtract(this.dtDateofJoining).Days+1;let b=0,D=0,p=0,T={iY:b,iM:D,iD:p};l.e.GetYearsMonthsDays(new Date(m[0].CDOB),this.dtToMonth.OnlyDate(),T),b=T.iY,D=T.iM,p=T.iD,this.dvTaxSlabs.RowFilter=b>=80?"Gender='SuperSeniorCitizen'":b>=60?"Gender='SeniorCitizen'":"Gender='"+m[0].GenderName.toString()+"'",this.lstTaxSalbs.Clear();for(let i=0;i<this.dvTaxSlabs.length;i++)this.lstTaxSalbs.push(new u),this.lstTaxSalbs[i].FromSlab=parseFloat(this.dvTaxSlabs[i].FromSlab),this.lstTaxSalbs[i].ToSlab=parseFloat(this.dvTaxSlabs[i].ToSlab),this.lstTaxSalbs[i].Percentage=parseFloat(this.dvTaxSlabs[i].Percentage)/100;a=17,e=5;for(let i=5;i<this.grdIncomeTax.ReportColumns.length;i++);let y=0,C=0;this.dsTaxData.Tables[0].length>0&&this.grdIncomeTax.addEmptyRows(this.dsTaxData.Tables[0].length);let I,S=0,x=0;for(let i=0;i<this.dsTaxData.Tables[0].length;i++){if(I=new Array,y=5,S=0,x=0,this.grdIncomeTax.Data[i].Cells[0].Value=this.dsTaxData.Tables[0][i].SNo,this.grdIncomeTax.Data[i].Cells[2].Value=this.dsTaxData.Tables[0][i].componentid,this.grdIncomeTax.Data[i].Cells[3].Value=this.dsTaxData.Tables[0][i].SalaryBreakup,null!=this.dsTaxData.Tables[0][i].MapFieldName&&null!=this.dsTaxData.Tables[0][i].MapFieldName&&"IT_BASIC"==this.dsTaxData.Tables[0][i].MapFieldName.toString().Trim()&&(this.BasicIndex=i),parseInt(this.dsTaxData.Tables[0][i].SNo)>0){for(let e=0;e<d.length;e++)for(let a=5;a<this.grdIncomeTax.ReportColumns.length;a++)if(!I.Contains(this.grdIncomeTax.ReportColumns[a].HeaderText)&&d[e].month.toString()==this.grdIncomeTax.ReportColumns[a].HeaderText.toString()){I.push(this.grdIncomeTax.ReportColumns[a].HeaderText),t=0,l.e.IsEmpty(d[e]["dcCalcNum"+this.dsTaxData.Tables[0][i].SNo.toString()])||(t=parseFloat(d[e]["dcCalcNum"+this.dsTaxData.Tables[0][i].SNo.toString()])),this.grdIncomeTax.Data[i].Cells[a].Value=t>0?l.e.GetAmount(t):0,x=parseFloat(this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[a].Value)+t,this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[a].Value=l.e.GetAmount(x),S+=t;break}for(let e=0;e<c.length;e++)for(let a=5;a<this.grdIncomeTax.ReportColumns.length;a++)if(parseInt(this.dsTaxData.Tables[0][i].componentID)==parseInt(c[e].componentid)&&c[e].FieldName.toString()==this.grdIncomeTax.ReportColumns[a].HeaderText.toString()&&!l.e.IsEmpty(c[e].Amount)&&parseFloat(c[e].Amount)>0&&!I.Contains(this.grdIncomeTax.ReportColumns[a].HeaderText)){I.push(this.grdIncomeTax.ReportColumns[a].HeaderText),t=0,l.e.IsEmpty(c[e].Amount)||(t=parseFloat(c[e].Amount)),this.grdIncomeTax.Data[i].Cells[a].Value=t>0?l.e.GetAmount(t):0,x=parseFloat(this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[a].Value)+t,this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[a].Value=l.e.GetAmount(x),S+=t;break}if(0==g.length)return;for(let s=0;s<g.length;s++)for(y=e;y<a;y++)!I.Contains(this.grdIncomeTax.ReportColumns[y].HeaderText)&&parseFloat(this.grdIncomeTax.Data[i].Cells[y].Value)<=0&&(I.push(this.grdIncomeTax.ReportColumns[y].HeaderText),t=parseFloat(g[s]["Earning"+this.dsTaxData.Tables[0][i].SNo.toString()]),this.grdIncomeTax.Data[i].Cells[y].Value=t>0?l.e.GetAmount(t):0,S+=t)}y=this.grdIncomeTax.ReportColumns.length-1,this.dblTotalCellSalary=this.dblTotalCellSalary+S,parseInt(this.dsTaxData.Tables[0][i].SNo)>0?this.grdIncomeTax.Data[i].Cells[y].Value=l.e.GetAmount(S):(this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=l.e.GetAmount(this.dblTotalCellSalary),this.TotalSalaryIndex=this.dsTaxData.Tables[0].length-1,this.grdIncomeTax.Data[i].Cells[1].Value=this.TotalSalaryIndex,C=this.TotalSalaryIndex)}if(C++,this.Form12Section1Index=this.TotalSalaryIndex+1,this.Form12Section2Index=this.TotalSalaryIndex+2,this.grdIncomeTax.addEmptyRows(2),this.dsTaxData.Tables[4].length>0){let t=0;for(let e=0;e<this.dsTaxData.Tables[4].length;e++)t=C+e,this.grdIncomeTax.Data[t].Cells[0].Value=0,this.grdIncomeTax.Data[t].Cells[1].Value=t+1,this.grdIncomeTax.Data[t].Cells[2].Value=this.dsTaxData.Tables[4][e].componentid,this.grdIncomeTax.Data[t].Cells[3].Value=this.dsTaxData.Tables[4][e].SalaryBreakup,-1==parseInt(this.dsTaxData.Tables[4][e].FieldType)&&(this.dPerq1=parseFloat(this.dsTaxData.Tables[4][e].Amount)),-2==parseInt(this.dsTaxData.Tables[4][e].FieldType)&&(this.dPerq2=parseFloat(this.dsTaxData.Tables[4][e].Amount)),this.grdIncomeTax.Data[t].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=l.e.GetAmount(parseFloat(this.dsTaxData.Tables[4][e].Amount))}let v=0,P=0,A=0;this.grdIncomeTax.addEmptyRows(1),this.Exemptionsunder10Index=this.Form12Section2Index+1,this.grdIncomeTax.Data[this.Exemptionsunder10Index].Cells[0].Value=0,this.grdIncomeTax.Data[this.Exemptionsunder10Index].Cells[1].Value=this.Exemptionsunder10Index,this.grdIncomeTax.Data[this.Exemptionsunder10Index].Cells[2].Value=-101,this.grdIncomeTax.Data[this.Exemptionsunder10Index].Cells[3].Value="Less : Exemptions Under 10 ",this.dsTaxData.Tables[5].length>0&&this.grdIncomeTax.addEmptyRows(1),C=this.HRA10BasicIndex=this.Exemptionsunder10Index+1,this.grdIncomeTax.Data[this.HRA10BasicIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.HRA10BasicIndex].Cells[1].Value=this.HRA10BasicIndex,this.grdIncomeTax.Data[this.HRA10BasicIndex].Cells[2].Value=0,this.grdIncomeTax.Data[this.HRA10BasicIndex].Cells[3].Value="Actual Rent Paid - 10% of Basic ";let f=0,M=0,E=this.dsTaxData.Tables[13];if(E.length>0){for(let e=0;e<E.length;e++)for(let a=5;a<this.grdIncomeTax.ReportColumns.length;a++)if(E[e].MONTHTEXT.toString()==this.grdIncomeTax.ReportColumns[a].HeaderText.toString()){t=0,l.e.IsEmpty(E[e].Amount)||(t=parseFloat(E[e].Amount)),t>0?(M=parseFloat(this.grdIncomeTax.Data[this.BasicIndex].Cells[a].Value),t-=10*M/100,this.grdIncomeTax.Data[this.HRA10BasicIndex].Cells[a].Value=l.e.GetAmount(t)):this.grdIncomeTax.Data[this.HRA10BasicIndex].Cells[a].Value=0,f+=t;break}}else for(let i=5;i<this.grdIncomeTax.ReportColumns.length;i++)this.grdIncomeTax.Data[this.HRA10BasicIndex].Cells[i].Value=l.e.GetAmount(0);if(v=f,this.grdIncomeTax.Data[this.HRA10BasicIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=l.e.GetAmount(f),this.grdIncomeTax.addEmptyRows(1),this.HRAAcutalIndex=this.HRA10BasicIndex+1,f=0,this.grdIncomeTax.Data[this.HRAAcutalIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.HRAAcutalIndex].Cells[1].Value=this.HRAAcutalIndex,this.grdIncomeTax.Data[this.HRAAcutalIndex].Cells[2].Value=this.dsTaxData.Tables[6][0].ComponentID.toString(),this.grdIncomeTax.Data[this.HRAAcutalIndex].Cells[3].Value="Actual Received ",this.dsTaxData.Tables[6].length>0){for(y=5;y<17;y++)this.grdIncomeTax.Data[this.HRAAcutalIndex].Cells[y].Value=l.e.GetAmount(0);y=5;for(let t=0;t<this.TotalSalaryIndex;t++)if(parseInt(this.grdIncomeTax.Data[t].Cells[2].Value)==parseInt(this.dsTaxData.Tables[6][0].ComponentID))for(y=5;y<a;y++)this.grdIncomeTax.Data[this.HRAAcutalIndex].Cells[y].Value=l.e.GetAmount(parseFloat(this.grdIncomeTax.Data[t].Cells[y].Value)),f+=parseFloat(this.grdIncomeTax.Data[t].Cells[y].Value)}P=f,this.grdIncomeTax.Data[this.HRAAcutalIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=l.e.GetAmount(f);let L=0,G=0;if(this.grdIncomeTax.addEmptyRows(1),this.dsTaxData.Tables[7].length>0){f=0;let t,e,a=null,s=new h.a;t=new o.c("Basic",""),s.push("Basic",t),s.Basic.setFieldValue(parseFloat(this.dsTaxData.Tables[3][0].BasicMonthly).toString()),a=this.dsTaxData.Tables[8].filter(t=>1==t.Type&&"OverTime"!=t.FieldType);let l=this.dsTaxData.Tables[3];if(a.length>0)for(let i=0;i<a.length;i++)e=this.dsTaxData.Tables[8].Select("ComponentID="+a[i].ComponentID),null!=e&&e.length>0&&(t=new o.c(a[i].ComponentName.toString(),""),s.push(a[i].ComponentName.toString(),t),s[a[i].ComponentName.toString()].setFieldValue(l[0]["Earning"+e[0].SNo.toString()].toString()));if(a=this.dsTaxData.Tables[8].filter(t=>2==t.Type&&"OverTime"!=t.FieldType),a.length>0)for(let i=0;i<a.length;i++)e=this.dsTaxData.Tables[8].Select("ComponentID="+a[i].ComponentID),null!=e&&e.length>0&&(t=new o.c(a[i].ComponentName.toString(),""),s.push(a[i].ComponentName.toString(),t),s[a[i].ComponentName.toString()].setFieldValue(l[0]["Deduction"+e[0].SNo.toString()].toString()));if(a=this.dsTaxData.Tables[7],a.length>0){let t=s;L=parseFloat(i.a.eval.EvaluateExpression(a[0].MetroFormula.toString(),t)),G=parseFloat(i.a.eval.EvaluateExpression(a[0].NonMetroFormula.toString(),t))}}this.HRAMetroNonMetroIndex=this.HRAAcutalIndex+1,this.grdIncomeTax.Data[this.HRAMetroNonMetroIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.HRAMetroNonMetroIndex].Cells[1].Value=this.HRAMetroNonMetroIndex,this.grdIncomeTax.Data[this.HRAMetroNonMetroIndex].Cells[2].Value=-102,this.grdIncomeTax.Data[this.HRAMetroNonMetroIndex].Cells[3].Value="Metro/Non-Metro ";let R="";if(E.length>0){for(let e=0;e<E.length;e++)for(let a=5;a<this.grdIncomeTax.ReportColumns.length;a++)if(E[e].MONTHTEXT.toString()==this.grdIncomeTax.ReportColumns[a].HeaderText.toString()){R=E[e].Metro.toString(),"Yes"==R?(t=L,this.grdIncomeTax.Data[this.HRAMetroNonMetroIndex].Cells[a].Value=l.e.GetAmount(t)):"No"==R.TrimEnd(" ")?(t=G,this.grdIncomeTax.Data[this.HRAMetroNonMetroIndex].Cells[a].Value=l.e.GetAmount(t)):this.grdIncomeTax.Data[this.HRAMetroNonMetroIndex].Cells[a].Value=0,f+=t;break}}else for(let i=5;i<this.grdIncomeTax.ReportColumns.length;i++)this.grdIncomeTax.Data[this.HRAMetroNonMetroIndex].Cells[i].Value=l.e.GetAmount(0);A=f,this.grdIncomeTax.Data[this.HRAMetroNonMetroIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=l.e.GetAmount(f),this.grdIncomeTax.addEmptyRows(1),this.HRAExemptionIndex=this.HRAMetroNonMetroIndex+1,this.grdIncomeTax.Data[this.HRAExemptionIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.HRAExemptionIndex].Cells[1].Value=this.HRAExemptionIndex,this.grdIncomeTax.Data[this.HRAExemptionIndex].Cells[2].Value=-103,this.grdIncomeTax.Data[this.HRAExemptionIndex].Cells[3].Value="HRA Exemption ",this.HraMinValue=Math.min(v,P,A),this.grdIncomeTax.Data[this.HRAExemptionIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=l.e.GetAmount(this.HraMinValue),this.grdIncomeTax.addEmptyRows(1),this.TotAmtOthExemptUs10Index=this.HRAExemptionIndex+1,this.grdIncomeTax.Data[this.TotAmtOthExemptUs10Index].Cells[0].Value=0,this.grdIncomeTax.Data[this.TotAmtOthExemptUs10Index].Cells[1].Value=this.TotAmtOthExemptUs10Index,this.grdIncomeTax.Data[this.TotAmtOthExemptUs10Index].Cells[2].Value=10001,this.grdIncomeTax.Data[this.TotAmtOthExemptUs10Index].Cells[3].Value="Total amount of any other exemption under section 10";let N=0,V=this.dsTaxData.Tables[25].Select("Name='U/S 10 : 1) Total amount of any other exemption under section 10'");null!=V&&V.length>0&&null!=V[0].Amount&&null!=V[0].Amount&&""!=V[0].Amount.toString()&&(N=parseFloat(V[0].Amount)),this.grdIncomeTax.Data[this.TotAmtOthExemptUs10Index].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=l.e.GetAmount(N),this.grdIncomeTax.addEmptyRows(2);let F=0,w=0,O=0;if(this.dvLimit.RowFilter="",this.dvLimit.RowFilter="ComponentID=998",null!=this.dvLimit[0].AmountLimit&&null!=this.dvLimit[0].AmountLimit&&""!=this.dvLimit[0].AmountLimit.toString()&&(F=parseFloat(this.dvLimit[0].AmountLimit)),this.ConveyanceIndex=this.TotAmtOthExemptUs10Index+1,this.grdIncomeTax.Data[this.ConveyanceIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.ConveyanceIndex].Cells[1].Value=this.ConveyanceIndex,this.grdIncomeTax.Data[this.ConveyanceIndex].Cells[2].Value=parseInt(this.dsTaxData.Tables[9][0].ComponentID),this.grdIncomeTax.Data[this.ConveyanceIndex].Cells[3].Value="Conveyance",parseInt(this.dsTaxData.Tables[9][0].ComponentID)>0){if(this.dsTaxData.Tables[9].length>0){y=5;for(let t=0;t<this.TotalSalaryIndex;t++)if(parseInt(this.grdIncomeTax.Data[t].Cells[2].Value)==parseInt(this.dsTaxData.Tables[9][0].ComponentID))for(y=5;y<a;y++)l.e.IsEmpty(this.grdIncomeTax.Data[t].Cells[y].Value)||(w+=parseFloat(this.grdIncomeTax.Data[t].Cells[y].Value))}O=w/12,0==O||O>F?F*=12:F=w}parseInt(this.cmbYear.SelectedValue)>=2018&&(F=0,2018==parseInt(this.cmbYear.SelectedValue)?this.dblStandardDeduction=4e4:parseInt(this.cmbYear.SelectedValue)>=2019&&(this.dblStandardDeduction=5e4)),this.grdIncomeTax.Data[this.ConveyanceIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=l.e.GetAmount(F),this.ChildrenEduIndex=this.ConveyanceIndex+1,this.grdIncomeTax.Data[this.ChildrenEduIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.ChildrenEduIndex].Cells[1].Value=this.ChildrenEduIndex,this.grdIncomeTax.Data[this.ChildrenEduIndex].Cells[2].Value=parseInt(this.dsTaxData.Tables[9][1].ComponentID),this.grdIncomeTax.Data[this.ChildrenEduIndex].Cells[3].Value="Children Education Allowances";let W=0;if(parseInt(this.dsTaxData.Tables[9][0].ComponentID)>0){let t=0,e=0,s=0,i=0;if(this.dvLimit.RowFilter="",this.dvLimit.RowFilter="ComponentID=996",null!=this.dvLimit[0].AmountLimit&&null!=this.dvLimit[0].AmountLimit&&""!=this.dvLimit[0].AmountLimit.toString()&&(s=parseFloat(this.dvLimit[0].AmountLimit)),this.dvLimit.RowFilter="",this.dvLimit.RowFilter="ComponentID=997",null!=this.dvLimit[0].AmountLimit&&null!=this.dvLimit[0].AmountLimit&&""!=this.dvLimit[0].AmountLimit.toString()&&(e=parseInt(this.dvLimit[0].AmountLimit)),this.dsTaxData.Tables[10].length>0){t=parseInt(this.dsTaxData.Tables[10][0][0]),t>e&&(t=e),i=12*t*s,y=5;for(let e=0;e<this.TotalSalaryIndex;e++)if(parseInt(this.grdIncomeTax.Data[e].Cells[2].Value)==parseInt(this.dsTaxData.Tables[9][1].ComponentID))for(y=5;y<a;y++)null!=this.grdIncomeTax.Data[e].Cells[y].Value&&""!=this.grdIncomeTax.Data[e].Cells[y].Value.toString()&&0!=parseFloat(this.grdIncomeTax.Data[e].Cells[y].Value)&&(W+=t*s)}}this.grdIncomeTax.Data[this.ChildrenEduIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=l.e.GetAmount(W),this.dsTaxData.Tables[11].length>0&&this.grdIncomeTax.addEmptyRows(this.dsTaxData.Tables[11].length);let k=0,B=0;k=this.ChildrenEduIndex+1,C=k;for(let i=0;i<this.dsTaxData.Tables[11].length;i++)this.grdIncomeTax.Data[C].Cells[0].Value=0,this.grdIncomeTax.Data[C].Cells[1].Value=k+i,this.grdIncomeTax.Data[C].Cells[2].Value=parseInt(this.dsTaxData.Tables[11][i].NodeID),this.grdIncomeTax.Data[C].Cells[3].Value=this.dsTaxData.Tables[11][i].Name.toString(),this.dvEmpTaxComputation.RowFilter="",this.dvEmpTaxComputation.RowFilter="ComponentID="+parseInt(this.dsTaxData.Tables[11][i].NodeID),this.dvEmpTaxComputation.length>0?(this.grdIncomeTax.Data[C].Cells[4].Value=l.e.GetAmount(parseFloat(this.dvEmpTaxComputation[0].ComponentAmount)),this.grdIncomeTax.Data[C].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=l.e.GetAmount(parseFloat(this.dvEmpTaxComputation[0].ComponentAmount))):(this.grdIncomeTax.Data[C].Cells[4].Value=l.e.GetAmount(0),this.grdIncomeTax.Data[C].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=l.e.GetAmount(0)),B+=parseFloat(this.grdIncomeTax.Data[C].Cells[4].Value),C+=1;this.MedicalIndex=this.ChildrenEduIndex+1,this.LTAIndex=this.MedicalIndex+1,this.FoodIndex=this.LTAIndex+1,this.LeaveEncashIndex=this.FoodIndex+1,this.GratuityIndex=this.LeaveEncashIndex+1,this.grdIncomeTax.addEmptyRows(1),this.StandardDedIndex=this.GratuityIndex+1,this.grdIncomeTax.Data[this.StandardDedIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.StandardDedIndex].Cells[1].Value=this.StandardDedIndex,this.grdIncomeTax.Data[this.StandardDedIndex].Cells[2].Value=1e3,this.grdIncomeTax.Data[this.StandardDedIndex].Cells[3].Value="STANDARD DEDUCTION",this.grdIncomeTax.Data[this.StandardDedIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=l.e.GetAmount(this.dblStandardDeduction),C+=1,this.dblbalanceSalaryInc12BA=this.dblTotalCellSalary+this.dPerq1+this.dPerq2-(this.HraMinValue+parseFloat(this.grdIncomeTax.Data[this.TotAmtOthExemptUs10Index].Cells[this.grdIncomeTax.ReportColumns.length-1].Value)+parseFloat(this.grdIncomeTax.Data[this.ConveyanceIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value)+parseFloat(this.grdIncomeTax.Data[this.ChildrenEduIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value)+parseFloat(this.grdIncomeTax.Data[this.MedicalIndex].Cells[4].Value)+parseFloat(this.grdIncomeTax.Data[this.LTAIndex].Cells[4].Value)+parseFloat(this.grdIncomeTax.Data[this.LeaveEncashIndex].Cells[4].Value)+parseFloat(this.grdIncomeTax.Data[this.FoodIndex].Cells[4].Value)+parseFloat(this.grdIncomeTax.Data[this.GratuityIndex].Cells[4].Value)+this.dblStandardDeduction),this.grdIncomeTax.addEmptyRows(3),this.BalanceSalInc12BAIndex=this.StandardDedIndex+1,this.grdIncomeTax.Data[this.BalanceSalInc12BAIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.BalanceSalInc12BAIndex].Cells[1].Value=this.BalanceSalInc12BAIndex,this.grdIncomeTax.Data[this.BalanceSalInc12BAIndex].Cells[2].Value=-104,this.grdIncomeTax.Data[this.BalanceSalInc12BAIndex].Cells[3].Value="Balance Salary including Perquisites",this.grdIncomeTax.Data[this.BalanceSalInc12BAIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=l.e.GetAmount(this.dblbalanceSalaryInc12BA);let U=0,Y=this.dsTaxData.Tables[12];this.ProfessionalTaxIndex=this.BalanceSalInc12BAIndex+1,this.grdIncomeTax.Data[this.ProfessionalTaxIndex].Cells[0].Value=-105,this.grdIncomeTax.Data[this.ProfessionalTaxIndex].Cells[1].Value=this.ProfessionalTaxIndex,this.grdIncomeTax.Data[this.ProfessionalTaxIndex].Cells[2].Value=0,this.grdIncomeTax.Data[this.ProfessionalTaxIndex].Cells[3].Value="Professional Tax",d=this.dsTaxData.Tables[20];let j=!1;if(Y.length>0){j=!1;for(let t=0;t<this.dsTaxData.Tables[19].length;t++)if("PROFESSIONAL TAX"==this.dsTaxData.Tables[19][t].TaxMapName.toString()&&parseInt(this.dsTaxData.Tables[19][t].SNo)>0)for(let e=5;e<this.grdIncomeTax.ReportColumns.length-1;e++){j=!1;for(let a=0;a<d.length;a++)if(d[a].month.toString()==this.grdIncomeTax.ReportColumns[e].HeaderText.toString()){l.e.IsEmpty(d[a]["dcCalcNum"+this.dsTaxData.Tables[19][t].SNo.toString()])||(U+=parseFloat(d[a]["dcCalcNum"+this.dsTaxData.Tables[19][t].SNo.toString()])),j=!0;break}if(!j)for(let a=0;a<c.length;a++)if(parseInt(this.dsTaxData.Tables[19][t].componentID)==parseInt(c[a].componentid)&&c[a].FieldName.toString()==this.grdIncomeTax.ReportColumns[e].HeaderText.toString()&&parseFloat(c[a].Amount)>0){l.e.IsEmpty(c[a].Amount)||(U+=parseFloat(c[a].Amount)),j=!0;break}if(!j)for(let e=0;e<g.length;e++)l.e.IsEmpty(g[e]["Deduction"+this.dsTaxData.Tables[19][t].SNo.toString()])||(U+=parseFloat(g[e]["Deduction"+this.dsTaxData.Tables[19][t].SNo.toString()]))}}this.grdIncomeTax.Data[this.ProfessionalTaxIndex].Cells[4].Value=l.e.GetAmount(U),this.grdIncomeTax.Data[this.ProfessionalTaxIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=l.e.GetAmount(U),this.NetTaxableSalIndex=this.ProfessionalTaxIndex+1,this.grdIncomeTax.Data[this.NetTaxableSalIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.NetTaxableSalIndex].Cells[1].Value=this.NetTaxableSalIndex,this.grdIncomeTax.Data[this.NetTaxableSalIndex].Cells[2].Value=-106,this.grdIncomeTax.Data[this.NetTaxableSalIndex].Cells[3].Value="Net Taxable Salary",this.dblNetTaxableSal=0,this.dblNetTaxableSal=this.dblbalanceSalaryInc12BA-U,this.grdIncomeTax.Data[this.NetTaxableSalIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=l.e.GetAmount(this.dblNetTaxableSal),this.grdIncomeTax.addEmptyRows(this.dsTaxData.Tables[14].length+3);let H=0;this.IncomefromHousePropertyIndex=this.NetTaxableSalIndex+1;for(let i=0;i<this.dsTaxData.Tables[14].length;i++){this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex].Cells[1].Value=this.IncomefromHousePropertyIndex,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex].Cells[2].Value=parseInt(this.dsTaxData.Tables[14][i].NodeID),this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex].Cells[3].Value=this.dsTaxData.Tables[14][i].Name,H=parseFloat(this.dsTaxData.Tables[14][i].Amount),this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex].Cells[4].Value=l.e.GetAmount(parseFloat(this.dsTaxData.Tables[14][i].Amount));break}let _=0;this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+1].Cells[0].Value=0,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+1].Cells[1].Value=this.IncomefromHousePropertyIndex+1,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+1].Cells[2].Value=-107,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+1].Cells[3].Value="Less : Standard deduction 30%",_=30*H/100,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+1].Cells[4].Value=l.e.GetAmount(_);let Z=0;this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+2].Cells[0].Value=0,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+2].Cells[1].Value=this.IncomefromHousePropertyIndex+2,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+2].Cells[2].Value=-108,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+2].Cells[3].Value="",Z=parseFloat(this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex].Cells[4].Value)-parseFloat(this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+1].Cells[4].Value),this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+2].Cells[4].Value=l.e.GetAmount(Z);let X=0;for(let i=1;i<this.dsTaxData.Tables[14].length;i++){this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+3].Cells[0].Value=0,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+3].Cells[1].Value=this.IncomefromHousePropertyIndex+3,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+3].Cells[2].Value=parseInt(this.dsTaxData.Tables[14][i].NodeID),this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+3].Cells[3].Value=this.dsTaxData.Tables[14][i].Name,X=parseFloat(this.dsTaxData.Tables[14][i].Amount),this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+3].Cells[4].Value=l.e.GetAmount(X);break}this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+4].Cells[0].Value=0,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+4].Cells[1].Value=this.IncomefromHousePropertyIndex+4,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+4].Cells[2].Value=-109,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+4].Cells[3].Value="Loss from House Property",this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+4].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=l.e.GetAmount(X-Z);let q=0;this.dblSelfletoutamount=0,C=q=this.IncomefromHousePropertyIndex+5;for(let i=2;i<this.dsTaxData.Tables[14].length;i++)this.grdIncomeTax.Data[C].Cells[0].Value=0,this.grdIncomeTax.Data[C].Cells[1].Value=q,this.grdIncomeTax.Data[C].Cells[2].Value=parseInt(this.dsTaxData.Tables[14][i].NodeID),this.grdIncomeTax.Data[C].Cells[3].Value=this.dsTaxData.Tables[14][i].Name,this.grdIncomeTax.Data[C].Cells[4].Value=l.e.GetAmount(parseFloat(this.dsTaxData.Tables[14][i].Amount)),this.dblSelfletoutamount=this.dblSelfletoutamount+parseFloat(this.dsTaxData.Tables[14][i].Amount),C+=1,q+=1;this.grdIncomeTax.addEmptyRows(1),this.GrossTotalIncomeIndex=q,this.grdIncomeTax.Data[this.GrossTotalIncomeIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.GrossTotalIncomeIndex].Cells[1].Value=this.GrossTotalIncomeIndex,this.grdIncomeTax.Data[this.GrossTotalIncomeIndex].Cells[2].Value=-110,this.grdIncomeTax.Data[this.GrossTotalIncomeIndex].Cells[3].Value="Gross Total Income",this.dblGrossTotalIncome=this.dblNetTaxableSal+this.dblSelfletoutamount-(X-Z),this.grdIncomeTax.Data[this.GrossTotalIncomeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=l.e.GetAmount(this.dblGrossTotalIncome),this.grdIncomeTax.addEmptyRows(1),this.intDeducunder8oCto80CCCIndex=this.GrossTotalIncomeIndex+1,this.grdIncomeTax.Data[this.intDeducunder8oCto80CCCIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.intDeducunder8oCto80CCCIndex].Cells[1].Value=this.intDeducunder8oCto80CCCIndex,this.grdIncomeTax.Data[this.intDeducunder8oCto80CCCIndex].Cells[2].Value=-111,this.grdIncomeTax.Data[this.intDeducunder8oCto80CCCIndex].Cells[3].Value="Deductions under 80C to 80CCC",this.grdIncomeTax.addEmptyRows(this.dsTaxData.Tables[16].length);let Q=0,J=0,K=0;C=K=this.intDeducunder8oCto80CCCIndex+1;for(let i=0;i<this.dsTaxData.Tables[16].length;i++){if(this.grdIncomeTax.Data[C].Cells[0].Value=0,this.grdIncomeTax.Data[C].Cells[1].Value=K,this.grdIncomeTax.Data[C].Cells[2].Value=parseInt(this.dsTaxData.Tables[16][i].NodeID),this.grdIncomeTax.Data[C].Cells[3].Value=this.dsTaxData.Tables[16][i].Name,this.dvEmpTaxComputation.RowFilter="",this.dvEmpTaxComputation.filter(t=>t.ComponentID==parseInt(this.dsTaxData.Tables[16][i].NodeID)),this.dvEmpTaxComputation.length>0)this.grdIncomeTax.Data[C].Cells[4].Value=l.e.GetAmount(parseFloat(this.dvEmpTaxComputation[0].ComponentAmount));else if("PF(Deduction from Salary)"==l.e.String(this.dsTaxData.Tables[16][i].Name)){let t=0;j=!1;for(let e=0;e<this.dsTaxData.Tables[19].length;e++)if("PF(Deduction from Salary)"==l.e.String(this.dsTaxData.Tables[19][e].TaxMapName)&&parseInt(this.dsTaxData.Tables[19][e].SNo)>0)for(let a=5;a<this.grdIncomeTax.ReportColumns.length-1;a++){j=!1;for(let s=0;s<d.length;s++)if(l.e.String(d[s].month)==this.grdIncomeTax.ReportColumns[a].HeaderText.toString()){l.e.IsEmpty(d[s]["dcCalcNum"+l.e.String(this.dsTaxData.Tables[19][e].SNo)])||(t+=parseFloat(d[s]["dcCalcNum"+l.e.String(this.dsTaxData.Tables[19][e].SNo)])),j=!0;break}if(!j)for(let s=0;s<c.length;s++)if(parseInt(this.dsTaxData.Tables[19][e].componentID)==parseInt(c[s].componentid)&&c[s].FieldName.toString()==this.grdIncomeTax.ReportColumns[a].HeaderText.toString()&&parseFloat(c[s].Amount)>0){l.e.IsEmpty(c[s].Amount)||(t+=parseFloat(c[s].Amount)),j=!0;break}if(!j)for(let a=0;a<g.length;a++)l.e.IsEmpty(g[a]["Deduction"+l.e.String(this.dsTaxData.Tables[19][e].SNo)])||(t+=parseFloat(g[a]["Deduction"+l.e.String(this.dsTaxData.Tables[19][e].SNo)]))}this.grdIncomeTax.Data[C].Cells[4].Value=l.e.GetAmount(t)}else this.grdIncomeTax.Data[C].Cells[4].Value=l.e.GetAmount(parseFloat(this.dsTaxData.Tables[16][i].Amount));0==i&&(Q=parseFloat(this.grdIncomeTax.Data[C].Cells[4].Value)),i>0&&(J+=parseFloat(this.grdIncomeTax.Data[C].Cells[4].Value)),C+=1,K+=1}this.grdIncomeTax.addEmptyRows(1),this.intTotalDeducunder8oCto80CCCIndex=K,this.grdIncomeTax.Data[this.intTotalDeducunder8oCto80CCCIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.intTotalDeducunder8oCto80CCCIndex].Cells[1].Value=this.intTotalDeducunder8oCto80CCCIndex,this.grdIncomeTax.Data[this.intTotalDeducunder8oCto80CCCIndex].Cells[2].Value=-112,this.grdIncomeTax.Data[this.intTotalDeducunder8oCto80CCCIndex].Cells[3].Value="Total Deductions under 80C to 80CCC",this.dblTotaldeduction80ccc80c=J+Q,this.grdIncomeTax.Data[this.intTotalDeducunder8oCto80CCCIndex].Cells[4].Value=l.e.GetAmount(this.dblTotaldeduction80ccc80c);let z=0;this.dvLimit.RowFilter="ComponentID=995",null!=this.dvLimit[0].AmountLimit&&null!=this.dvLimit[0].AmountLimit&&""!=this.dvLimit[0].AmountLimit.toString()&&(z=parseFloat(this.dvLimit[0].AmountLimit)),this.dblTotaldeduction80ccc80c>z&&(this.dblTotaldeduction80ccc80c=z),this.grdIncomeTax.Data[this.intTotalDeducunder8oCto80CCCIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=l.e.GetAmount(this.dblTotaldeduction80ccc80c);let $=0;this.grdIncomeTax.addEmptyRows(this.dsTaxData.Tables[17].length),this.intOtherDeducunder8oCto80CCCIndex=this.intTotalDeducunder8oCto80CCCIndex+1,C=K=this.intTotalDeducunder8oCto80CCCIndex+1;for(let i=0;i<this.dsTaxData.Tables[17].length;i++)this.grdIncomeTax.Data[C].Cells[0].Value=0,this.grdIncomeTax.Data[C].Cells[1].Value=K,this.grdIncomeTax.Data[C].Cells[2].Value=parseInt(this.dsTaxData.Tables[17][i].NodeID),this.grdIncomeTax.Data[C].Cells[3].Value=this.dsTaxData.Tables[17][i].Name,this.dvEmpTaxComputation.RowFilter="",this.dvEmpTaxComputation.RowFilter="ComponentID="+parseInt(this.dsTaxData.Tables[17][i].NodeID),this.dvEmpTaxComputation.length>0?($+=parseFloat(this.dvEmpTaxComputation[0].ComponentAmount),this.grdIncomeTax.Data[C].Cells[4].Value=l.e.GetAmount(parseFloat(this.dvEmpTaxComputation[0].ComponentAmount))):($+=parseFloat(this.dsTaxData.Tables[17][i].Amount),this.grdIncomeTax.Data[C].Cells[4].Value=l.e.GetAmount(parseFloat(this.dsTaxData.Tables[17][i].Amount))),this.grdIncomeTax.Data[C].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=l.e.GetAmount(this.dvEmpTaxComputation.length>0?parseFloat(this.dvEmpTaxComputation[0].ComponentAmount):parseFloat(this.dsTaxData.Tables[17][i].Amount)),C+=1,K+=1;this.intOtherDeducunder8oCto80CCCIndex1=K-1,this.grdIncomeTax.addEmptyRows(1),this.dblTotalIncomeIndex=this.intOtherDeducunder8oCto80CCCIndex1+1,this.grdIncomeTax.Data[this.dblTotalIncomeIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.dblTotalIncomeIndex].Cells[1].Value=this.dblTotalIncomeIndex,this.grdIncomeTax.Data[this.dblTotalIncomeIndex].Cells[2].Value=-113,this.grdIncomeTax.Data[this.dblTotalIncomeIndex].Cells[3].Value="Total Income",this.grdIncomeTax.addEmptyRows(1),this.dblTotalIncomeRoundoffIndex=this.dblTotalIncomeIndex+1,this.grdIncomeTax.Data[this.dblTotalIncomeRoundoffIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.dblTotalIncomeRoundoffIndex].Cells[1].Value=this.dblTotalIncomeRoundoffIndex,this.grdIncomeTax.Data[this.dblTotalIncomeRoundoffIndex].Cells[2].Value=-114,this.grdIncomeTax.Data[this.dblTotalIncomeRoundoffIndex].Cells[3].Value="Total Income rounded off",this.grdIncomeTax.addEmptyRows(1),this.dblTaxOnTotalIncomeIndex=this.dblTotalIncomeRoundoffIndex+1,this.grdIncomeTax.Data[this.dblTaxOnTotalIncomeIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.dblTaxOnTotalIncomeIndex].Cells[1].Value=this.dblTotalIncomeRoundoffIndex+1,this.grdIncomeTax.Data[this.dblTaxOnTotalIncomeIndex].Cells[2].Value=-115,this.grdIncomeTax.Data[this.dblTaxOnTotalIncomeIndex].Cells[3].Value="Tax on Total Income",this.grdIncomeTax.addEmptyRows(1),this.dblRebateIndex=this.dblTaxOnTotalIncomeIndex+1,this.grdIncomeTax.Data[this.dblRebateIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.dblRebateIndex].Cells[1].Value=this.dblTotalIncomeRoundoffIndex+2,this.grdIncomeTax.Data[this.dblRebateIndex].Cells[2].Value=-116,parseInt(this.cmbYear.SelectedValue)<2016?this.grdIncomeTax.Data[this.dblRebateIndex].Cells[3].Value="Rebate U/S 87A (Rs.2,000 for Taxable Income below Rs.5,00,000/-)":2016==parseInt(this.cmbYear.SelectedValue)?this.grdIncomeTax.Data[this.dblRebateIndex].Cells[3].Value="Rebate U/S 87A (Rs.5,000 for Taxable Income below Rs.5,00,000/-)":2017==parseInt(this.cmbYear.SelectedValue)||2018==parseInt(this.cmbYear.SelectedValue)?this.grdIncomeTax.Data[this.dblRebateIndex].Cells[3].Value="Rebate U/S 87A (Rs.2,500 for Taxable Income below Rs.3,50,000/-)":parseInt(this.cmbYear.SelectedValue)>=2019&&(this.grdIncomeTax.Data[this.dblRebateIndex].Cells[3].Value="Rebate U/S 87A (Rs.12,500 for Taxable Income below Rs.5,00,000/-)"),this.grdIncomeTax.addEmptyRows(1),this.dblTaxPayableAfterRebateIndex=this.dblRebateIndex+1,this.grdIncomeTax.Data[this.dblTaxPayableAfterRebateIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.dblTaxPayableAfterRebateIndex].Cells[1].Value=this.dblTotalIncomeRoundoffIndex+3,this.grdIncomeTax.Data[this.dblTaxPayableAfterRebateIndex].Cells[2].Value=-117,this.grdIncomeTax.Data[this.dblTaxPayableAfterRebateIndex].Cells[3].Value="Tax Payable after rebate U/S 87A",this.grdIncomeTax.addEmptyRows(1),this.dblSurchargeIndex=this.dblTaxPayableAfterRebateIndex+1,this.grdIncomeTax.Data[this.dblSurchargeIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.dblSurchargeIndex].Cells[1].Value=this.dblTotalIncomeRoundoffIndex+4,this.grdIncomeTax.Data[this.dblSurchargeIndex].Cells[2].Value=-118,this.grdIncomeTax.addEmptyRows(1),this.dblTaxPayableIndex=this.dblSurchargeIndex+1,this.grdIncomeTax.Data[this.dblTaxPayableIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.dblTaxPayableIndex].Cells[1].Value=this.dblTotalIncomeRoundoffIndex+5,this.grdIncomeTax.Data[this.dblTaxPayableIndex].Cells[2].Value=-119,this.grdIncomeTax.Data[this.dblTaxPayableIndex].Cells[3].Value="Tax Payable",this.grdIncomeTax.addEmptyRows(1),this.dblEducationCessIndex=this.dblTaxPayableIndex+1,this.grdIncomeTax.Data[this.dblEducationCessIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.dblEducationCessIndex].Cells[1].Value=this.dblTotalIncomeRoundoffIndex+6,this.grdIncomeTax.Data[this.dblEducationCessIndex].Cells[2].Value=-120,this.grdIncomeTax.addEmptyRows(1),this.dblSecHighEduCessIndex=this.dblEducationCessIndex+1,this.grdIncomeTax.Data[this.dblSecHighEduCessIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.dblSecHighEduCessIndex].Cells[1].Value=this.dblTotalIncomeRoundoffIndex+7,this.grdIncomeTax.Data[this.dblSecHighEduCessIndex].Cells[2].Value=-121,this.grdIncomeTax.addEmptyRows(1),this.intTotalIncometaxPayableindex=this.dblSecHighEduCessIndex+1,this.grdIncomeTax.Data[this.intTotalIncometaxPayableindex].Cells[0].Value=0,this.grdIncomeTax.Data[this.intTotalIncometaxPayableindex].Cells[1].Value=this.intTotalIncometaxPayableindex,this.grdIncomeTax.Data[this.intTotalIncometaxPayableindex].Cells[2].Value=-122,this.grdIncomeTax.Data[this.intTotalIncometaxPayableindex].Cells[3].Value="Total Income Tax Payable",this.grdIncomeTax.addEmptyRows(1),this.TDSPaidIndex=this.intTotalIncometaxPayableindex+1,this.grdIncomeTax.Data[this.TDSPaidIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.TDSPaidIndex].Cells[1].Value=this.TDSPaidIndex,this.grdIncomeTax.Data[this.TDSPaidIndex].Cells[2].Value=-123,this.grdIncomeTax.Data[this.TDSPaidIndex].Cells[3].Value="TDS Paid",this.grdIncomeTax.addEmptyRows(1),this.NetTaxPayableIndex=this.TDSPaidIndex+1,this.grdIncomeTax.Data[this.NetTaxPayableIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.NetTaxPayableIndex].Cells[1].Value=this.NetTaxPayableIndex,this.grdIncomeTax.Data[this.NetTaxPayableIndex].Cells[2].Value=-124,this.grdIncomeTax.Data[this.NetTaxPayableIndex].Cells[3].Value="Net Tax Payable";let tt,et=0,at=0,st=0,it=0,lt=0,ot=0;lt=i.a.SessionManager.FinancialYearStartDate.getFullYear(),tt=lt.toString(),lt=parseInt(tt.substr(2,2)),ot=lt+1,et=i.a.SessionManager.AccountingFromMonth,it=et;let nt=1;at=et,this.grdIncomeTax.addEmptyRows(1),this.MonthlyDeducIndex=this.NetTaxPayableIndex+1,this.grdIncomeTax.Data[this.MonthlyDeducIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.MonthlyDeducIndex].Cells[1].Value=this.MonthlyDeducIndex,this.grdIncomeTax.Data[this.MonthlyDeducIndex].Cells[2].Value=-125,this.grdIncomeTax.Data[this.MonthlyDeducIndex].Cells[3].Value="Monthly Deductions from salary";for(let i=5;i<this.grdIncomeTax.ReportColumns.length;i++)if(13==at){st=at-nt;for(let t=1;t<=st;t++)this.grdIncomeTax.Data[this.MonthlyDeducIndex].Cells[i].Value=this.GetMonthName(t,!1),nt+=1,i++}else this.grdIncomeTax.Data[this.MonthlyDeducIndex].Cells[i].Value=this.GetMonthName(at,!1),at+=1,nt+=1;this.dsTaxData.Tables[19].length>0&&this.grdIncomeTax.addEmptyRows(this.dsTaxData.Tables[19].length);let rt=0,ht=0,dt=0;C=rt=this.MonthlyDeducIndex+1,d=this.dsTaxData.Tables[20].DefaultView;for(let i=0;i<this.dsTaxData.Tables[19].length;i++)if(I=new Array,y=5,dt=ht=0,this.grdIncomeTax.Data[C+i].Cells[0].Value=this.dsTaxData.Tables[19][i].SNo,this.grdIncomeTax.Data[C+i].Cells[1].Value=rt+i,this.grdIncomeTax.Data[C+i].Cells[2].Value=this.dsTaxData.Tables[19][i].componentid,this.grdIncomeTax.Data[C+i].Cells[3].Value=this.dsTaxData.Tables[19][i].SalaryBreakup,parseInt(this.dsTaxData.Tables[19][i].SNo)>0){for(let e=0;e<d.length;e++)for(let a=5;a<this.grdIncomeTax.ReportColumns.length;a++)if(d[e].month.toString()==this.grdIncomeTax.ReportColumns[a].HeaderText.toString()&&!I.Contains(this.grdIncomeTax.ReportColumns[a].HeaderText)){I.push(this.grdIncomeTax.ReportColumns[a].HeaderText),t=0,l.e.IsEmpty(d[e]["dcCalcNum"+this.dsTaxData.Tables[19][i].SNo.toString()])||(t=parseFloat(d[e]["dcCalcNum"+this.dsTaxData.Tables[19][i].SNo.toString()])),this.grdIncomeTax.Data[C+i].Cells[a].Value=t>=0?l.e.GetAmount(t):0,dt+=t;break}c.RowFilter="",c.RowFilter=" ComponentType='2'";for(let e=0;e<c.length;e++)for(let a=5;a<this.grdIncomeTax.ReportColumns.length;a++)if(parseInt(this.dsTaxData.Tables[19][i].componentID)==parseInt(c[e].componentid)&&c[e].FieldName.toString()==this.grdIncomeTax.ReportColumns[a].HeaderText.toString()&&parseFloat(c[e].Amount)>0&&!I.Contains(this.grdIncomeTax.ReportColumns[a].HeaderText)){I.push(this.grdIncomeTax.ReportColumns[a].HeaderText),t=0,l.e.IsEmpty(c[e].Amount)||(t=parseFloat(c[e].Amount)),this.grdIncomeTax.Data[C+i].Cells[a].Value=t>=0?l.e.GetAmount(t):0,dt+=t;break}if(0==g.length)return;for(let s=0;s<g.length;s++)for(y=e;y<a;y++)!I.Contains(this.grdIncomeTax.ReportColumns[y].HeaderText)&&parseFloat(this.grdIncomeTax.Data[C+i].Cells[y].Value)<=0&&(I.push(this.grdIncomeTax.ReportColumns[y].HeaderText),t=parseFloat(g[s]["Deduction"+this.dsTaxData.Tables[19][i].SNo.toString()]),this.grdIncomeTax.Data[C+i].Cells[y].Value=t>=0?l.e.GetAmount(t):0,dt+=t)}this.InhandAmountIndex=rt+this.dsTaxData.Tables[19].length;let ct=0;this.grdIncomeTax.Data[this.InhandAmountIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.InhandAmountIndex].Cells[1].Value=this.InhandAmountIndex,this.grdIncomeTax.Data[this.InhandAmountIndex].Cells[2].Value=-126,this.grdIncomeTax.Data[this.InhandAmountIndex].Cells[3].Value="In Hand",y=5;let ut=0;for(y=5;y<17;y++)this.grdIncomeTax.Data[this.InhandAmountIndex].Cells[y].Value=l.e.GetAmount(0);for(y=5;y<a;y++){ht=0;for(let t=rt;t<this.InhandAmountIndex;t++)ht+=parseFloat(this.grdIncomeTax.Data[t].Cells[y].Value);ut=parseFloat(this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[y].Value)-ht,this.grdIncomeTax.Data[this.InhandAmountIndex].Cells[y].Value=l.e.GetAmount(ut),ct+=ut}this.grdIncomeTax.Data[this.InhandAmountIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=l.e.GetAmount(ct),j=!1;for(let i=0;i<this.dsTaxData.Tables[19].length;i++)if("TDS"==this.dsTaxData.Tables[19][i].TaxMapName.toString()&&parseInt(this.dsTaxData.Tables[19][i].SNo)>0)for(let t=5;t<this.grdIncomeTax.ReportColumns.length-1;t++){j=!1;for(let e=0;e<d.length;e++)if(d[e].month.toString()==this.grdIncomeTax.ReportColumns[t].HeaderText.toString()){l.e.IsEmpty(d[e]["dcCalcNum"+this.dsTaxData.Tables[19][i].SNo.toString()])||(this.dblTDS+=parseFloat(d[e]["dcCalcNum"+this.dsTaxData.Tables[19][i].SNo.toString()])),j=!0;break}if(!j)for(let e=0;e<c.length;e++)if(parseInt(this.dsTaxData.Tables[19][i].componentID)==parseInt(c[e].componentid)&&c[e].FieldName.toString()==this.grdIncomeTax.ReportColumns[t].HeaderText.toString()&&parseFloat(c[e].Amount)>0){l.e.IsEmpty(c[e].Amount)||(this.dblTDS+=parseFloat(c[e].Amount)),j=!0;break}if(!j)for(let t=0;t<g.length;t++)l.e.IsEmpty(g[t]["Deduction"+this.dsTaxData.Tables[19][i].SNo.toString()])||(this.dblTDS+=parseFloat(g[t]["Deduction"+this.dsTaxData.Tables[19][i].SNo.toString()]))}this.UpdateTotals(this.dblTotalIncomeRoundoff)}catch(t){Logger.ErrorLog("Error : "+t)}}cmbYear_SelectionChanged(t){this.clear(0),this.ITComputationViewModel.FilterEmployees(),null!=this.lstEmployee.SelectedValue&&(this.ITComputationViewModel.OnYearSelected("Year"),this.FillDetails())}}var m=a("fXoL"),b=a("sYmb");let D=(()=>{class t{constructor(){this.form=new s.j({})}ngOnInit(){this.obj=this.params.obj,this.obj2=new g(this.obj)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=m.Nb({type:t,selectors:[["app-income-tax-computation"]],decls:32,vars:13,consts:[[1,"page-header"],[1,"page-title"],[1,"btnMetroDiv","secondary-btn-group"],[1,"secondary-btn-wicon",3,"click"],[1,"fa-light","fa-save"],[1,"fa-light","fa-trash-alt"],[1,"fa-light","fa-broom"],[1,"fa-light","fa-file-export"]],template:function(t,e){1&t&&(m.Zb(0,"div"),m.Wc(1,"\n    "),m.Zb(2,"div",0),m.Wc(3,"\n      "),m.Zb(4,"label",1),m.Wc(5),m.Yb(),m.Wc(6,"\n      "),m.Zb(7,"div",2),m.Wc(8,"\n        "),m.Zb(9,"span",3),m.hc("click",(function(){return e.obj2.btnSave_Click("Save")})),m.Ub(10,"i",4),m.Wc(11),m.mc(12,"translate"),m.Yb(),m.Wc(13,"\n        "),m.Wc(14,"\n        "),m.Zb(15,"span",3),m.hc("click",(function(){return e.obj2.btnSave_Click("Delete")})),m.Ub(16,"i",5),m.Wc(17),m.mc(18,"translate"),m.Yb(),m.Wc(19,"\n        "),m.Zb(20,"span",3),m.hc("click",(function(){return e.obj2.btnSave_Click("Clear")})),m.Ub(21,"i",6),m.Wc(22),m.mc(23,"translate"),m.Yb(),m.Wc(24,"\n        "),m.Zb(25,"span",3),m.hc("click",(function(){return e.obj2.btnSave_Click("Export")})),m.Ub(26,"i",7),m.Wc(27),m.mc(28,"translate"),m.Yb(),m.Wc(29,"\n      "),m.Yb(),m.Wc(30,"\n    "),m.Yb(),m.Wc(31,"\n  \n  "),m.Yb()),2&t&&(m.Db(5),m.Yc("\n        ",e.obj.Title,"\n      "),m.Db(6),m.Xc(m.nc(12,5,"Save")),m.Db(6),m.Xc(m.nc(18,7,"Delete")),m.Db(5),m.Xc(m.nc(23,9,"Clear")),m.Db(5),m.Xc(m.nc(28,11,"Export")))},pipes:[b.d],encapsulation:2}),t})()},fKF8:function(t,e,a){"use strict";a.d(e,"a",(function(){return n}));var s=a("3Pt+"),i=a("fXoL"),l=a("q8k3"),o=a("sYmb");let n=(()=>{class t{constructor(){this.form=new s.j({})}ngOnInit(){this.obj=this.params.obj}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Nb({type:t,selectors:[["app-payslip"]],decls:63,vars:22,consts:[[1,"maincontainer"],[1,"page-header"],[1,"page-title"],[1,"btnMetroDiv","secondary-btn-group",2,"margin-right","6px"],[1,"secondary-btn",3,"click"],[1,"fa-light","fa-eye"],[1,"fa-light","fa-print"],[1,"fa-light","fa-file-export"],[1,"fa-light","fa-envelope"],[1,"fa-light","fa-filter"],[1,"main_div"],[2,"padding","11px"],[1,"row","form-row"],[1,"form-group","col-md-4","col-sm-6","col-xs-12","PACTControl"],["FieldDirective","",3,"obj","group"],[1,"documentgrid","row","form-row",2,"padding","4px 12px","height","calc(100% - 50px)","width","100%"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Wc(1,"\n        "),i.Zb(2,"div",1),i.Wc(3,"\n            "),i.Zb(4,"span",2),i.Wc(5),i.Yb(),i.Wc(6,"\n            "),i.Zb(7,"div",3),i.Wc(8,"\n                "),i.Zb(9,"span",4),i.hc("click",(function(){return e.obj.Button_Click("Preview")})),i.Ub(10,"i",5),i.Wc(11),i.mc(12,"translate"),i.Yb(),i.Wc(13," \n                "),i.Zb(14,"span",4),i.hc("click",(function(){return e.obj.Button_Click("Print")})),i.Ub(15,"i",6),i.Wc(16),i.mc(17,"translate"),i.Yb(),i.Wc(18," \n                "),i.Zb(19,"span",4),i.hc("click",(function(){return e.obj.Button_Click("Export")})),i.Ub(20,"i",7),i.Wc(21),i.mc(22,"translate"),i.Yb(),i.Wc(23,"\n                "),i.Zb(24,"span",4),i.hc("click",(function(){return e.obj.Button_Click("EMail")})),i.Ub(25,"i",8),i.Wc(26),i.mc(27,"translate"),i.Yb(),i.Wc(28,"\n                "),i.Zb(29,"span",4),i.hc("click",(function(){return e.obj.Button_Click("Filter")})),i.Ub(30,"i",9),i.Wc(31),i.mc(32,"translate"),i.Yb(),i.Wc(33,"\n            "),i.Yb(),i.Wc(34,"\n        "),i.Yb(),i.Wc(35,"\n"),i.Zb(36,"div",10),i.Wc(37,"\n    "),i.Zb(38,"div",11),i.Wc(39,"          \n        "),i.Zb(40,"div",12),i.Wc(41,"\n            "),i.Zb(42,"div",13),i.Wc(43,"\n                "),i.Vb(44,14),i.Wc(45,"\n            "),i.Yb(),i.Wc(46,"\n            "),i.Zb(47,"div",13),i.Wc(48,"\n                "),i.Vb(49,14),i.Wc(50,"\n            "),i.Yb(),i.Wc(51,"\n            "),i.Zb(52,"div",13),i.Wc(53,"\n                "),i.Vb(54,14),i.Wc(55,"\n            "),i.Yb(),i.Wc(56,"               \n             "),i.Yb(),i.Wc(57,"\n    "),i.Yb(),i.Wc(58,"\n\n    "),i.Zb(59,"div",15),i.Wc(60,"\n        \n    "),i.Yb(),i.Wc(61,"\n"),i.Yb(),i.Wc(62,"\n "),i.Yb()),2&t&&(i.Db(5),i.Xc(e.obj.Title),i.Db(6),i.Xc(i.nc(12,12,"Preview")),i.Db(5),i.Xc(i.nc(17,14,"Print")),i.Db(5),i.Xc(i.nc(22,16,"Export")),i.Db(5),i.Xc(i.nc(27,18,"EMail")),i.Db(5),i.Xc(i.nc(32,20,"Filter")),i.Db(13),i.tc("obj",e.obj.dtpPayrollMonth)("group",e.form),i.Db(5),i.tc("obj",e.obj.cmbPayslipLayout)("group",e.form),i.Db(5),i.tc("obj",e.obj.cmbSortOn)("group",e.form))},directives:[l.a],pipes:[o.d],encapsulation:2}),t})()},ouML:function(t,e,a){"use strict";a.r(e),a.d(e,"DocumentDraftsViewModel",(function(){return c}));var s=a("mrSG"),i=a("Do2H"),l=a("Lp6j"),o=a("ScVY"),n=a("8B8H"),r=a("ockk"),h=a("rJVx"),d=a("CUWK");class c extends o.b{constructor(t,e,a=0){if(super(),this.Grid=new n.a,this.IsFromDocs=!1,this.PopupWidth=0,this.ReportType=0,this.Parent=null,this.CCID=0,this.WID=0,this.LevelID=0,this.PactGridVisible=!1,this.CCID=a,this.Parent=t,this.ReportType=e,this.Parent instanceof h.GeneralDashboardViewModel||"DashAddOnsViewModel"==this.Parent.ClassName)1==e&&(this.ColSource=h.GeneralDashboardViewModel.InitColumns("Document Drafts_DashBoardCustomize"));else{let t;1==e?this.DisplayName="Drafts":2==e?this.DisplayName="Hold Documents":3==e?this.DisplayName="Approval History":4==e&&(this.DisplayName="Level Info",this.PactGrid=new n.a),this.Title=this.DisplayName,this.IsFromDocs=!0,this.FillGrid(),this.Grid.OnLinkClick.Subscribe(this,"GridLinkClick"),this.ColSource=[],1==e?(this.ColSource=h.GeneralDashboardViewModel.InitColumns("Document Drafts_DashBoardCustomize"),this.PopupWidth=22,this.ColSource.forEach(t=>{this.PopupWidth=this.PopupWidth+t.Width})):2==e?(t=new r.a,t.DataType="TextBlock",t.Header="Hold Date",t.DisplayMember="HoldDate_Key",t.Width=100,this.ColSource.push(t),t=new r.a,t.DataType="LINK",t.Header=i.a.GetResource("DocName"),t.DisplayMember="DocName",t.Width=135,this.ColSource.push(t),t=new r.a,t.DataType="TextBlock",t.Header="NetValue",t.DisplayMember="NetValue",t.Width=100,this.ColSource.push(t),t=new r.a,t.DataType="TextBlock",t.Header="NoOfProducts",t.DisplayMember="NoOfProducts",t.Width=50,this.ColSource.push(t),t=new r.a,t.DataType="LINK",t.Header=i.a.GetResource("Delete"),t.DisplayMember="Delete",t.Width=100,this.ColSource.push(t),this.PopupWidth=450):3==e?(t=new r.a,t.DataType="TextBlock",t.Header="User",t.DisplayMember="CreatedBy",t.Width=90,this.ColSource.push(t),t=new r.a,t.DataType="TextBlock",t.Header="FirstName",t.DisplayMember="FirstName",t.Width=90,this.ColSource.push(t),t=new r.a,t.DataType="TextBlock",t.Header="LastName",t.DisplayMember="LastName",t.Width=90,this.ColSource.push(t),t=new r.a,t.DataType="TextBlock",t.Header="Email",t.DisplayMember="Email1",t.Width=150,this.ColSource.push(t),t=new r.a,t.DataType="TextBlock",t.Header=i.a.GetResource("Date"),t.DisplayMember="AppDate",t.Width=128,this.ColSource.push(t),t=new r.a,t.DataType="LINK",t.Header="Level",t.DisplayMember="LevelName",t.Width=93,this.ColSource.push(t),t=new r.a,t.DataType="TextBlock",t.Header="Status",t.DisplayMember="Status",t.Width=80,this.ColSource.push(t),t=new r.a,t.DataType="Format",t.Header="Remarks",t.DisplayMember="Remarks",t.Width=190,this.ColSource.push(t),this.PopupWidth=950,"AddEditDocumentViewModel"==this.Parent.ClassName&&(t=new r.a,t.Header="WorkFlowName",t.DisplayMember="WorkFlowName",t.Width=200,this.ColSource.push(t)),this.PopupWidth=950):4==e&&(t=new r.a,t.DataType="TextBlock",t.ReadOnly=!0,t.Header="User Name",t.DisplayMember="UserName",t.Width=120,this.ColSource.push(t),t=new r.a,t.DataType="TextBlock",t.ReadOnly=!0,t.Header="First Name",t.DisplayMember="FirstName",t.Width=120,this.ColSource.push(t),t=new r.a,t.DataType="TextBlock",t.ReadOnly=!0,t.Header="Last Name",t.DisplayMember="LastName",t.Width=120,this.ColSource.push(t),this.PactGrid.Columns=this.ColSource,this.PopupWidth=400)}}get Table(){return this.Grid.Table}set Table(t){this.Grid.Table=t}get TableColumns(){return this.Grid.TableColumns}set TableColumns(t){this.Grid.TableColumns=t}get ColSource(){return this.Grid.Columns}set ColSource(t){this.Grid.Columns=t}get SelectedRow(){return this.Grid.SelectedItem}set SelectedRow(t){this.Grid.SelectedItem=t}onClick(t){event.preventDefault(),null!=this.SelectedRow&&this.LoadDraft(this.SelectedRow)}FillGrid(){let t=0,e=null;if(l.e.IsType(this.Parent,"AddEditDocumentViewModel")?(e=this.Parent,t=0==this.CCID?e.CostCenterID:this.CCID):l.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName||(t=this.CCID),1==this.ReportType||2==this.ReportType){let a;a=l.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName?null==e||38!=e.ScreenObject.DocumentType&&39!=e.ScreenObject.DocumentType?i.a.document.GetDocumentDrafts(0,t,this.ReportType,!1):i.a.document.GetDocumentDrafts(e.ScreenObject.RegisterNodeID,t,this.ReportType,!1,!0):i.a.document.GetDocumentDrafts(0,this.Parent.CostCenterID,this.ReportType,!1),a.subscribe(t=>{this.Table=t.Tables[0],this.Grid.TableColumns.Contains("Date_Text")||(this.Grid.TableColumns.push("Date_Text"),this.Grid.TableColumns.push("Delete")),this.Grid.TableColumns.Contains("HoldDate_Key")||this.Grid.TableColumns.push("HoldDate_Key"),this.Table.forEach(t=>{t.Delete="Delete",t.id=i.a.slick.rowid,t.Date_Text=new Date(t.Date).ToString(i.a.SessionManager.Preferences["Date Format"]+" hh:mm a"),null!=t.HoldDate&&(t.HoldDate_Key=new Date(t.HoldDate).ToString(i.a.SessionManager.Preferences["Date Format"]))})})}else if(3==this.ReportType){let e=null;if(l.e.IsType(this.Parent,"AddEditDocumentViewModel")?(e=this.Parent.ScreenObject.GetDocStatusHistory(),e.Tables.length>1&&e.Tables[1].length>0&&e.Columns[1].Contains("WID")&&(this.WID=parseInt(e.Tables[1][0].WID))):l.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName?l.e.IsEmpty(this.Parent.ClassName)||"AddEditCasesViewModel"!=this.Parent.ClassName||(e=this.GetDocStatusHistory(73,this.Parent.CaseID,!1)):e=i.a.rental.GetHistory(t,this.Parent.ContractID),null!=e&&e.Tables.length>0){this.Table=e.Tables[0],this.Grid.TableColumns.push("AppDate");for(let e=0;e<this.Table.length;e++)""!=this.Table[e].Date.toString()&&(this.Table[e].AppDate=new Date(this.Table[e].Date.toString()).ToString(i.a.SessionManager.Preferences["Date Format"]+" hh:mm a"));let t=0,a=0;this.Table.length>0&&(t=l.e.IntTryParse(this.Table[this.Table.length-1].WorkFlowLevel.toString()),a=l.e.IntTryParse(this.Table[this.Table.length-1].StatusID.toString())),369!=a&&(e.Tables[1]=e.Tables[1].filter(e=>e.levelID>t),e.Tables[1].forEach(t=>{let e=this.Grid.NewRow();e.LevelName=t.LevelName,e.Status="Pending",e.WorkFlowLevel=t.LevelID,this.Grid.addRow(e)}));for(let e=this.Table.length;e<7;e++)this.Grid.addEmptyRow()}}else if(4==this.ReportType){let t=null;if("WFLevelDoc"==this.Parent.ClassName?t=i.a.SessionManager.Preferences.ContainsKey("CanApproveFunction")&&"True"==i.a.SessionManager.Preferences.CanApproveFunction?i.a.report.GetExtWFDet(this.Parent.WID,this.Parent.LevelID,this.Parent.ccid,this.Parent.DOcId):i.a.report.GetWorkFlowLevelDetails(this.Parent.WID,this.Parent.LevelID,this.Parent.ccDate):this.Parent instanceof c&&(i.a.SessionManager.Preferences.ContainsKey("CanApproveFunction")&&"True"==i.a.SessionManager.Preferences.CanApproveFunction?"AddEditDocumentViewModel"==this.Parent.Parent.ClassName?t=i.a.report.GetExtWFDet(this.Parent.WID,this.Parent.LevelID,this.Parent.Parent.CostCenterID,this.Parent.Parent.ScreenObject.DocID):"ReportViewModel"==this.Parent.Parent.ClassName&&"INV_ComparisonReport"==this.Parent.Parent.StaticReportObject&&(t=i.a.report.GetExtWFDet(this.Parent.WID,this.Parent.LevelID,this.Parent.Parent.StaticReportObject.QuotationDocument,this.Parent.Parent.StatusDocID)):t=i.a.report.GetWorkFlowLevelDetails(this.Parent.WID,this.Parent.LevelID,"AddEditDocumentViewModel"==this.Parent.Parent.ClassName?this.Parent.Parent.ScreenObject.DocDate.Date:Date.Today())),null!=t){for(let e=t.Tables[0].length;e<8;e++)t.Tables[0].push();this.PactGrid.Table=t.Tables[0]}this.PactGrid.Width="",this.PactGrid.SearchVisible=!0,this.PactGrid.SearchCols.Width="85",this.PactGrid.SearchOptions.Width="90",this.PactGrid.SearchText.Width="110",this.PactGridVisible=!0}}GetDocStatusHistory(t,e,a){Logger.InfoLog("DocumentDraftsViewModel:: Inside GetDocStatusHistory");let s=[];s.push(t),s.push(e),s.push(a),s.push(i.a.SessionManager.UserID),s.push(i.a.SessionManager.LanguageID);let l=i.a.document.GetDocStatusHistory(s);return Logger.InfoLog("DocumentDraftsViewModel:: Exiting GetDocStatusHistory"),l}OnButtonClick(t){"Cancel"==t.toString()&&(l.e.IsType(this.Parent,"AddEditDocumentViewModel")&&this.CCID>0&&(this.Parent.res="No"),i.a.page.HideDialog())}DeleteDraft(t){let e;e=l.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName?i.a.document.DeleteDocumentDraft(parseInt(t.DraftID)):i.a.rental.DeleteQuotation(parseInt(t.CostCenterID),parseInt(t.DraftID)),e.RetValue>0&&this.Grid.removeRow(t)}LoadDraft(t){return Object(s.b)(this,void 0,void 0,(function*(){if(l.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName){const{AddEditDocumentViewModel:e}=yield Promise.all([a.e(2),a.e(1),a.e(3),a.e(5),a.e(4),a.e(6),a.e(7),a.e(10),a.e(9),a.e(12),a.e(11),a.e(13),a.e(19),a.e(15),a.e(21),a.e(20),a.e(16),a.e(14),a.e(18),a.e(17),a.e(22),a.e(89)]).then(a.bind(null,"1Cra")),{AddEditDocumentComponent:s}=yield Promise.all([a.e(4),a.e(6)]).then(a.bind(null,"MCKn"));let l,o;o=i.a.document.GetDocumentDrafts(parseInt(t.DraftID),0,1,!1),o.subscribe(a=>{if(l=a.Tables[0],null!=l&&l.length>0)if("AddEditDocumentViewModel"==this.Parent.ClassName||"POSDocumentViewModel"==this.Parent.ClassName)this.CCID>0||(this.Parent.clear(1),this.Parent.LoadDraftXML(l[0]),i.a.page.HideDialog(),this.Parent.ScreenObject.GridDataObj.RefreshGridView());else{let a=1==this.ReportType,o=new e(parseInt(t.CostCenterID),t.Type.toString(),a);i.a.page.addNewTab({component:s,params:{obj:o}}),o.LoadDraftXML(l[0],a)}})}else d.RibbonExtViewModel.LoadDraftRentalContract(this.Parent,parseInt(t.DraftID)),i.a.page.HideDialog()}))}GridLinkClick(t,e,a){event.preventDefault(),"Delete"==e?this.DeleteDraft(t):"Date_Text"!=e&&"DocName"!=e||this.LoadDraft(t)}}},qeHP:function(t,e,a){"use strict";a.d(e,"a",(function(){return n}));var s=a("3Pt+"),i=a("fXoL"),l=a("q8k3"),o=a("sYmb");let n=(()=>{class t{constructor(){this.form=new s.j({})}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Nb({type:t,selectors:[["app-cons-mpload"]],decls:52,vars:18,consts:[[1,"master-screen",2,"padding-bottom","4px","width","400px"],[1,"PACTHeaderFields","dialogSubBody"],[1,"row","form-row"],[1,"col-xl-10","col-md-10","col-sm-12","col-xs-12"],["type","text","readonly","",3,"ngModel","ngModelChange"],[1,"col-xl-2","col-md-2","col-sm-12","col-xs-12",2,"margin-top","15px","display","flex !important"],["type","file","accept",".xlsx,.xls,.csv","name","upload",2,"display","none",3,"change"],["fileUpload",""],[1,"secondary-btn-wicon",3,"click"],[1,"fa-light","fa-search"],[1,"form-group","row","form-row","PACTControl"],["FieldDirective","",3,"obj","group"],[1,"Pactdailogfooter"],[1,"primary-btn-wicon",3,"click"],[1,"fa-light","fa-rectangle-xmark"]],template:function(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",0),i.Wc(1,"\n    "),i.Zb(2,"div",1),i.Wc(3,"\n        "),i.Zb(4,"div",2),i.Wc(5,"\n            "),i.Zb(6,"div",3),i.Wc(7,"\n                "),i.Zb(8,"label"),i.Wc(9),i.mc(10,"translate"),i.Yb(),i.Wc(11,"\n                "),i.Zb(12,"input",4),i.hc("ngModelChange",(function(t){return e.obj.ActualFileName=t})),i.Yb(),i.Wc(13,"\n            "),i.Yb(),i.Wc(14,"\n            "),i.Zb(15,"div",5),i.Wc(16,"\n                "),i.Zb(17,"input",6,7),i.hc("change",(function(t){return e.obj.OpenFile(t)})),i.Yb(),i.Wc(19,"               \n                "),i.Zb(20,"span",8),i.hc("click",(function(){return i.Ic(t),i.Ec(18).click()})),i.Ub(21,"i",9),i.Wc(22),i.mc(23,"translate"),i.Yb(),i.Wc(24,"\n             \n            "),i.Yb(),i.Wc(25,"\n        "),i.Yb(),i.Wc(26,"  \n            \n        "),i.Zb(27,"div",10),i.Wc(28,"\n            "),i.Vb(29,11),i.Wc(30,"\n        "),i.Yb(),i.Wc(31,"\n    "),i.Yb(),i.Wc(32,"\n    "),i.Zb(33,"div",12),i.Wc(34,"\n        "),i.Zb(35,"div"),i.Wc(36,"\n            "),i.Zb(37,"button",13),i.hc("click",(function(){return e.obj.Button_Click("Load")})),i.Wc(38),i.mc(39,"translate"),i.Yb(),i.Wc(40,"\n            "),i.Zb(41,"button",8),i.hc("click",(function(){return e.obj.Button_Click("View")})),i.Wc(42),i.mc(43,"translate"),i.Yb(),i.Wc(44,"\n            "),i.Zb(45,"button",8),i.hc("click",(function(){return e.obj.Button_Click("Cancel")})),i.Ub(46,"i",14),i.Wc(47),i.mc(48,"translate"),i.Yb(),i.Wc(49,"\n           \n        "),i.Yb(),i.Wc(50,"\n    "),i.Yb(),i.Wc(51,"\n"),i.Yb()}2&t&&(i.Db(9),i.Xc(i.nc(10,8,"Com_Attachments_FileName")),i.Db(3),i.tc("ngModel",e.obj.ActualFileName),i.Db(10),i.Xc(i.nc(23,10,"Browse")),i.Db(7),i.tc("obj",e.obj.dgv)("group",e.form),i.Db(9),i.Xc(i.nc(39,12,"Load")),i.Db(4),i.Xc(i.nc(43,14,"View")),i.Db(5),i.Xc(i.nc(48,16,"Cancel")))},directives:[s.c,s.s,s.v,l.a],pipes:[o.d],encapsulation:2}),t})()},rJVx:function(t,e,a){"use strict";a.r(e),a.d(e,"GeneralDashboardViewModel",(function(){return d}));var s=a("mrSG"),i=a("Do2H"),l=a("Lp6j"),o=a("ScVY"),n=a("NkMH"),r=a("ockk"),h=a("JIg3");class d extends o.b{constructor(){super(),this.ButtonPDC=new n.a,this.timerdashboard=new l.d,this.Date=new h.a(0),this.tdMaximize=new Array(4).fill(!1),Logger.InfoLog("DashboardViewModel::Entering DashboardViewModel"),this.timerdashboard.Enabled=!0,this.timerdashboard.Interval=6e4,i.a.SessionManager.IsWebApplication||this.timerdashboard.Elapsed(this,"timerdashboard_Elapsed"),this.DisplayName=i.a.GetResource("Dashboard_Maindashboard"),this.loadDrafts(),Logger.InfoLog("DashboardViewModel::Exiting DashboardViewModel")}loadDrafts(){return Object(s.b)(this,void 0,void 0,(function*(){const{DocumentDraftsViewModel:t}=yield a.e(150).then(a.bind(null,"ouML"));this.DocumentDrafts=new t(this,1),setTimeout(()=>{this.DocumentDrafts.FillGrid()},500);const{UnAppDocumentsViewModel:e}=yield a.e(0).then(a.bind(null,"AyOk"));this.UnApprovedDocuments=new e;const{DashBoardNotifViewModel:s}=yield Promise.all([a.e(2),a.e(1),a.e(5),a.e(26),a.e(42),a.e(0),a.e(73)]).then(a.bind(null,"Wh9R"));this.NotifEvents=new s(2),this.PDCDocuments=new s(4)}))}timerdashboard_Elapsed(t,e){i.a.page.isActiveTab(this)&&(this.OnButtonClick("RefreshPDC"),this.OnButtonClick("RefreshEvents"),this.NotifEvents.RefreshData(),this.UnApprovedDocuments.OnLoad())}OnButtonClick(t){"PostPDC"==t||("RefreshPDC"==t?(this.PDCDocuments.EventsType=4,this.PDCDocuments.InitColumns()):"PostEvents"==t||("RefreshEvents"==t?this.NotifEvents.RefreshData():"UnApproved"==t?this.UnApprovedDocuments.OnLoad():"Drafts"==t&&this.DocumentDrafts.FillGrid()))}OnMessageCallBack(){this.res="Yes"}static InitColumns(t){let e,a="",s=[];if(i.a.SessionManager.Preferences.ContainsKey(t)&&(a=i.a.SessionManager.Preferences[t]),a.length>0){let o=new l.f;o.LoadXml(a);for(let a=0;a<o.DocumentElement.children.length;a++){let l=o.DocumentElement.children[a];e=new r.a,e.Header=i.a.GetResource(l.attributes.Header.value),e.DisplayMember=l.attributes.ID.value,e.ReadOnly=!0,e.Width=parseInt(l.attributes.Width.value),s.push(e),"Un Approved Documents_DashBoardCustomize"==t?"VoucherNo"==e.DisplayMember?e.DataType="LINK":"Amount"==e.DisplayMember&&(e.DataType="FLOAT",e.DecimalPoints=i.a.SessionManager.Preferences.DecimalsinAmount.toString()):"Document Drafts_DashBoardCustomize"==t?"Date_Text"!=e.DisplayMember&&"Delete"!=e.DisplayMember||(e.DataType="LINK"):"Post Dated Documents_DashBoardCustomize"==t?"VoucherNo"==e.DisplayMember?e.DataType="LINK":"Amount"==e.DisplayMember&&(e.DataType="FLOAT",e.DecimalPoints=i.a.SessionManager.Preferences.DecimalsinAmount.toString()):"Notification Events_DashBoardCustomize"==t&&"VoucherNo"==e.DisplayMember&&(e.DataType="LINK")}}return s}static IsActionAssigned(t,e){return i.a.SessionManager.IsActionAssigned(t,e)}}}}]);