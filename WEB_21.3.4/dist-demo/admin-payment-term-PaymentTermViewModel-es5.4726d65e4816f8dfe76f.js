function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,s){return t&&_defineProperties(e.prototype,t),s&&_defineProperties(e,s),e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var s,i=_getPrototypeOf(e);if(t){var n=_getPrototypeOf(this).constructor;s=Reflect.construct(i,arguments,n)}else s=i.apply(this,arguments);return _possibleConstructorReturn(this,s)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[93],{"wL+q":function(e,t,s){"use strict";s.r(t),s.d(t,"PaymentTermViewModel",(function(){return u}));var i=s("Do2H"),n=s("Lp6j"),a=s("eQJW"),o=s("ScVY"),r=s("EQd/"),l=s("0/4Q"),m=s("8B8H"),d=s("ockk"),h=s("jDOZ"),u=function(e){_inherits(s,e);var t=_createSuper(s);function s(){var e;return _classCallCheck(this,s),(e=t.call(this)).ds=null,e.obj=new h.a,e.Name=new r.d(0),e.Profile=new l.e(0),e.Dimensions=new l.e(0),e.Name.Enable=!1,e.DisplayName=i.a.GetResource("Payment_Terms"),e.ProfileFill(),e.AddGridColumns(),e.FillingRows(),e.PaymentGrid.SearchVisible=!1,e.Name.Label="Name",e.Profile.Label="Profile",e.Dimensions.Label="Dimension",e.Profile.SelectionChangedCommand.Subscribe(_assertThisInitialized(e),"OnProfileSelection"),e}return _createClass(s,[{key:"OnBeginEdit",value:function(e){"DataGridPactListBoxColumn"!=e.args.column.className||n.e.IsEmpty(this.Dimensions.SelectedValue)||"0"==this.Dimensions.SelectedValue||(e.args.Column.CostCenterID=parseInt(this.Dimensions.SelectedValue))}},{key:"OnCellEditEnding",value:function(e){var t=e.item;"PactTextBoxEditor"==e.column.className&&"Percent"==e.column.field&&(""!=n.e.String(t.Percent).Trim()?(""==n.e.String(t.Period)&&(t.Period="1"),""==n.e.String(t.TypeID)&&(t.TypeID="0"),""==n.e.String(t.BasedOn)&&(t.BasedOn="1"),""==n.e.String(t.PostonDate)&&(t.PostonDate="0")):(""!=n.e.String(t.Period)&&(t.Period=null),""!=n.e.String(t.TypeID)&&(t.TypeID=null),""!=n.e.String(t.BasedOn)&&(t.BasedOn=null),""!=n.e.String(t.PostonDate)&&(t.PostonDate=null)),this.PaymentGrid.updateRow(t))}},{key:"ProfileFill",value:function(){var e=this;this.Profile.Items.Clear(),this.ds=this.obj.GetAndDeleteTerms(0,1),null!=this.ds&&this.ds.Tables.length>0&&this.ds.Tables[0].length>0?(this.Profile.Items.push(l.d.ComboBoxItems_2("New","-1")),this.ds.Tables[0].forEach((function(t){0==e.Profile.Items.filter((function(e){return e.Value==t.ProfileID.toString()})).length&&e.Profile.Items.push(l.d.ComboBoxItems_2(t.ProfileName.toString(),t.ProfileID.toString()))}))):(this.Profile.Items.push(l.d.ComboBoxItems_2("New","-1")),this.Dimensions.Visible=!1),null!=this.ds&&this.ds.Tables.length>1&&!n.e.IsEmpty(i.a.SessionManager.Preferences.EnableDimPayterm)&&Object(a.j)(i.a.SessionManager.Preferences.EnableDimPayterm)?(this.Dimensions.Label="Dimensions",this.Dimensions.Items.push(l.d.ComboBoxItems_2("","0")),this.ds.Tables[1].forEach((function(t){e.Dimensions.Items.push(l.d.ComboBoxItems_2(t.Name.toString(),t.FeatureID.toString()))})),this.Dimensions.Visible=!0):this.Dimensions.Visible=!1}},{key:"FillingRows",value:function(){if(0==this.PaymentGrid.Table.length)for(var e=this.PaymentGrid.Table.length;e<10;e++){var t=this.PaymentGrid.NewRow();t.Sno=e+1,this.PaymentGrid.addRow(t)}}},{key:"AddGridColumns",value:function(){this.PaymentGrid=new m.a,this.PaymentGrid.Columns=[],this.PaymentGrid.CellEditEnding.Subscribe(this,"OnCellEditEnding"),this.PaymentGrid.BeginEdit.Subscribe(this,"OnBeginEdit"),this.PaymentGrid.Table=[],this.PaymentGrid.CanUserAddRows=!0,this.PaymentGrid.CanUserDeleteRows=!0,this.PaymentGrid.Height=230,this.PaymentGrid.Width="1040",this.PaymentGrid.TableColumns.push("Sno"),this.PaymentGrid.TableColumns.push("Percent"),this.PaymentGrid.TableColumns.push("Days"),this.PaymentGrid.TableColumns.push("Period"),this.PaymentGrid.TableColumns.push("TypeID"),this.PaymentGrid.TableColumns.push("BasedOn"),this.PaymentGrid.TableColumns.push("Occurences"),this.PaymentGrid.TableColumns.push("PostonDate"),this.PaymentGrid.TableColumns.push("Remarks");var e=new d.a;e.Header=i.a.GetResource("Sno"),e.DisplayMember="Sno",e.ReadOnly=!0,e.Width=50,e.DataType="FLOAT",this.PaymentGrid.Columns.push(e),(e=new d.a).Header=i.a.GetResource("Percentage"),e.DisplayMember="Percent",e.ReadOnly=!1,e.Width=135,e.DataType="FLOAT",this.PaymentGrid.Columns.push(e),(e=new d.a).Header="Number",e.DisplayMember="Days",e.ReadOnly=!1,e.Width=100,e.DataType="INT",this.PaymentGrid.Columns.push(e),(e=new d.a).Header="Period",e.ValueBinding="Period",e.DataType="ComboBox",e.DisplayMember="Name",e.ValueMember="Value",e.Width=100;var t=new Array;t.push(l.d.ComboBoxItems_2("Month(s)","2")),t.push(l.d.ComboBoxItems_2("Day(s)","1")),e.ComboData=t,this.PaymentGrid.Columns.push(e),(e=new d.a).Header="Type",e.ValueBinding="TypeID",e.DataType="ComboBox",e.DisplayMember="Name",e.ValueMember="Value",e.Width=100,(t=new Array).push(l.d.ComboBoxItems_2("None","0")),t.push(l.d.ComboBoxItems_2("Repeat","1")),t.push(l.d.ComboBoxItems_2("Divide","2")),e.ComboData=t,this.PaymentGrid.Columns.push(e),(e=new d.a).Header="Based On",e.ValueBinding="BasedOn",e.DataType="ComboBox",e.DisplayMember="Name",e.ValueMember="Value",e.Width=100,(t=new Array).push(l.d.ComboBoxItems_2("Voucher Date","1")),t.push(l.d.ComboBoxItems_2("Preference Date","2")),e.ComboData=t,this.PaymentGrid.Columns.push(e),(e=new d.a).Header="Occurences",e.DisplayMember="Occurences",e.Width=100,e.DataType="INT",this.PaymentGrid.Columns.push(e),(e=new d.a).Header="Remarks",e.DisplayMember="Remarks",e.Width=100,this.PaymentGrid.Columns.push(e),(e=new d.a).Header="Post on Date",e.ValueBinding="PostonDate",e.DataType="ComboBox",e.DisplayMember="Name",e.ValueMember="Value",e.Width=100,(t=new Array).push(l.d.ComboBoxItems_2("Same","0")),t.push(l.d.ComboBoxItems_2("1","1")),t.push(l.d.ComboBoxItems_2("2","2")),t.push(l.d.ComboBoxItems_2("3","3")),t.push(l.d.ComboBoxItems_2("4","4")),t.push(l.d.ComboBoxItems_2("5","5")),t.push(l.d.ComboBoxItems_2("6","6")),t.push(l.d.ComboBoxItems_2("7","7")),t.push(l.d.ComboBoxItems_2("8","8")),t.push(l.d.ComboBoxItems_2("9","9")),t.push(l.d.ComboBoxItems_2("10","10")),t.push(l.d.ComboBoxItems_2("11","11")),t.push(l.d.ComboBoxItems_2("12","12")),t.push(l.d.ComboBoxItems_2("13","13")),t.push(l.d.ComboBoxItems_2("14","14")),t.push(l.d.ComboBoxItems_2("15","15")),t.push(l.d.ComboBoxItems_2("16","16")),t.push(l.d.ComboBoxItems_2("17","17")),t.push(l.d.ComboBoxItems_2("18","18")),t.push(l.d.ComboBoxItems_2("19","19")),t.push(l.d.ComboBoxItems_2("20","20")),t.push(l.d.ComboBoxItems_2("21","21")),t.push(l.d.ComboBoxItems_2("22","22")),t.push(l.d.ComboBoxItems_2("23","23")),t.push(l.d.ComboBoxItems_2("24","24")),t.push(l.d.ComboBoxItems_2("25","25")),t.push(l.d.ComboBoxItems_2("26","26")),t.push(l.d.ComboBoxItems_2("27","27")),t.push(l.d.ComboBoxItems_2("28","28")),t.push(l.d.ComboBoxItems_2("29","29")),t.push(l.d.ComboBoxItems_2("30","30")),t.push(l.d.ComboBoxItems_2("LastDayofMonth","31")),e.ComboData=t,this.PaymentGrid.Columns.push(e),this.Dimensions.Visible&&((e=new d.a).Header="Dimension",e.DisplayMember="Dim",e.DataType="LISTBOX",e.Width=150,e.TypeID=1,this.PaymentGrid.Columns.push(e),this.PaymentGrid.TableColumns.push("Dim_Key"),this.PaymentGrid.TableColumns.push("Dim"))}},{key:"OnButtonClick",value:function(e){var t,s,i=this;if("Save"==e){if(null==this.Name.Text||""==this.Name.Text)return this.DisplayMessage="Enter Profile Name",void(this.MessageVisibility=!0);(null===(t=this.PaymentGrid.angularGrid)||void 0===t?void 0:t.slickGrid)&&(null===(s=this.PaymentGrid.angularGrid)||void 0===s?void 0:s.slickGrid.getActiveCellNode())&&this.PaymentGrid.angularGrid.slickGrid.getEditorLock().commitCurrentEdit();for(var a="",o=0,r=0;r<this.PaymentGrid.Table.length;r++)n.e.IsEmpty(this.PaymentGrid.Table[r].Percent)||n.e.IsEmpty(this.PaymentGrid.Table[r].Days)||(a+="<Row ",n.e.IsEmpty(this.PaymentGrid.Table[r].TypeID)||"1"!=this.PaymentGrid.Table[r].TypeID.toString()||n.e.IsEmpty(this.PaymentGrid.Table[r].Occurences)?o+=parseFloat(this.PaymentGrid.Table[r].Percent.toString()):o+=parseFloat(this.PaymentGrid.Table[r].Percent.toString())*parseFloat(this.PaymentGrid.Table[r].Occurences.toString()),a+='percentage="'+this.PaymentGrid.Table[r].Percent.toString()+'" ',n.e.IsEmpty(this.PaymentGrid.Table[r].Days)||(a+='Days="'+this.PaymentGrid.Table[r].Days.toString()+'" '),n.e.IsEmpty(this.PaymentGrid.Table[r].Period)||(a+='Period="'+this.PaymentGrid.Table[r].Period.toString()+'" '),n.e.IsEmpty(this.PaymentGrid.Table[r].TypeID)||(a+='TypeID="'+this.PaymentGrid.Table[r].TypeID.toString()+'" '),n.e.IsEmpty(this.PaymentGrid.Table[r].BasedOn)||(a+='BasedOn="'+this.PaymentGrid.Table[r].BasedOn.toString()+'" '),n.e.IsEmpty(this.PaymentGrid.Table[r].Occurences)||(a+='Occurences="'+this.PaymentGrid.Table[r].Occurences.toString()+'" '),n.e.IsEmpty(this.PaymentGrid.Table[r].PostonDate)||(a+='DateNo="'+this.PaymentGrid.Table[r].PostonDate.toString()+'" '),n.e.IsEmpty(this.PaymentGrid.Table[r].Remarks)||(a+='Remarks="'+this.PaymentGrid.Table[r].Remarks.toString()+'" '),this.Dimensions.Visible&&!n.e.IsEmpty(this.PaymentGrid.Table[r].Dim_Key)&&(a+='Dim="'+this.PaymentGrid.Table[r].Dim_Key.toString()+'" '),a+='Discount="" ',a+="/>");if(o>100)return this.DisplayMessage="Percentage can not be greater than 100.",void(this.MessageVisibility=!0);h.a.SetPaymentDiscountTerm(this.Name.Text,this.Profile.SelectedValue,this.Dimensions.SelectedValue,a.toString()).subscribe((function(e){i.DisplayMessage=e.Message,e.RetValue>0?(i.Name.Text="",i.PaymentGrid.Clear(),i.FillingRows(),i.ProfileFill()):i.MessageVisibility=!0}),(function(e){console.log(e),i.DisplayMessage="Error in save"}))}else"-1"==this.Profile.SelectedValue?this.DisplayMessage="Cannot Delete New":(this.ds=this.obj.GetAndDeleteTerms(parseInt(this.Profile.SelectedValue),3),null!=this.ds&&this.ds.Tables.length>0&&this.ds.Tables[0].length>0&&(this.DisplayMessage=this.ds.Tables[0][0].ErrorMessage.toString(),"Deleted Successfully"==this.DisplayMessage&&(this.Name.Text="",this.PaymentGrid.Clear(),this.FillingRows(),this.ProfileFill()))),this.MessageVisibility=!0}},{key:"OnProfileSelection",value:function(e){if("-1"==this.Profile.SelectedValue)this.Name.Enable=!0,this.Name.Text="",this.PaymentGrid.Clear(),this.FillingRows();else if(null!=this.Profile.SelectedValue){this.Name.Enable=!1,this.ds=this.obj.GetAndDeleteTerms(parseInt(this.Profile.SelectedValue),0),this.Name.Text=this.Profile.GetText(),this.PaymentGrid.Clear();var t="";if(null!=this.ds&&this.ds.Tables.length>0){for(var s=0;s<this.ds.Tables[0].length;s++){var i=this.PaymentGrid.NewRow();i.Sno=s+1,i.Percent=this.ds.Tables[0][s].percentage,i.Days=this.ds.Tables[0][s].Days,n.e.IsEmpty(this.ds.Tables[0][s].Period)||(i.Period=this.ds.Tables[0][s].Period),n.e.IsEmpty(this.ds.Tables[0][s].TypeID)||(i.TypeID=this.ds.Tables[0][s].TypeID),n.e.IsEmpty(this.ds.Tables[0][s].BasedOn)||(i.BasedOn=this.ds.Tables[0][s].BasedOn),n.e.IsEmpty(this.ds.Tables[0][s].Occurences)||(i.Occurences=this.ds.Tables[0][s].Occurences),n.e.IsEmpty(this.ds.Tables[0][s].DateNo)||(i.PostonDate=this.ds.Tables[0][s].DateNo),this.ds.Columns[0].Contains("Remarks")&&!n.e.IsEmpty(this.ds.Tables[0][s].Remarks)&&(i.Remarks=this.ds.Tables[0][s].Remarks),this.PaymentGrid.TableColumns.Contains("Dim_Key")&&!n.e.IsEmpty(this.ds.Tables[0][s].DimNodeID)&&(i.Dim_Key=this.ds.Tables[0][s].DimNodeID,""!=t&&(t+=","),t+=this.ds.Tables[0][s].DimNodeID.toString()),this.PaymentGrid.addRow(i)}if(this.ds.Tables[0].length>0&&this.Dimensions.Visible)if(n.e.IsEmpty(this.ds.Tables[0][0].DimCCID))this.Dimensions.SelectedValue="0";else{this.Dimensions.SelectedValue=this.ds.Tables[0][0].DimCCID.toString();var a=this.obj.GetdimensionNames(this.Dimensions.SelectedValue,t);a.Tables.length>0&&!a.Columns[0].Contains("ErrorMessage")&&this.PaymentGrid.Table.forEach((function(e){if(!n.e.IsEmpty(e.Dim_Key.toString())){var t=a.Tables[0].filter((function(t){return t.NodeID==e.Dim_Key.toString()}));t.length>0&&(e.Dim=t[0][Object.keys(t[0])[1]].toString())}}))}for(var o=this.ds.Tables[0].length;o<this.ds.Tables[0].length+10;o++){var r=this.PaymentGrid.NewRow();r.Sno=o+1,this.PaymentGrid.addRow(r)}}}}}]),s}(o.b)}}]);