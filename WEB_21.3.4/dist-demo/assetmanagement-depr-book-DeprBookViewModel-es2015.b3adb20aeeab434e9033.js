(window.webpackJsonp=window.webpackJsonp||[]).push([[103],{wpq0:function(e,t,s){"use strict";s.r(t),s.d(t,"DeprBookViewModel",(function(){return u}));var o=s("Do2H"),a=s("Lp6j"),i=s("eQJW"),h=s("ScVY"),r=s("EQd/"),l=s("0/4Q"),d=s("Jnyl"),n=s("VxiT"),p=s("NM0h"),D=s("wlFP");class u extends h.b{constructor(e){super(),this._DeprBookID=0,this.DeprBookCode=new r.d(23798),this.DeprBookName=new r.d(23799),this.DeprBookMethod=new l.e(23800),this.DeprMethodBasedOn=new l.e(49968),this.DeprMethodBasedOnValue=new r.d(49969),this.DeprBookStatus=new l.e(23801),this.Salvage=new d.b,this.SalvageEnable=new D.a,this.AveragingMethod=new l.e(26584),this.ScreenObject=new n.a,this.obj=new p.a,this.RetValue=0,this.Fields=[],this.DeprBookID=e,this.Title=o.a.GetResource("AddDeprBook"),this.DisplayName=this.Title,this.DisplayMessage="",this.AveragingMethod.Items.push(l.d.ComboBoxItems_2(o.a.GetResource("DeprBook_CalendarDays"),"1")),this.AveragingMethod.Items.push(l.d.ComboBoxItems_2(o.a.GetResource("DeprBook_FullMonth"),"2")),this.AveragingMethod.Items.push(l.d.ComboBoxItems_2(o.a.GetResource("DeprBook_MidMonth"),"3")),this.AveragingMethod.SelectedValue="1",this.DeprBookMethod.SelectionChangedCommand.Subscribe(this,"OnDeprMethodChange"),this.DeprMethodBasedOn.SelectionChangedCommand.Subscribe(this,"OnDeprMethodBasedOn"),this.Salvage.Currency.Items.push(l.d.ComboBoxItems_2("Value","1")),this.Salvage.Currency.Items.push(l.d.ComboBoxItems_2("Percentage","2")),this.Salvage.Currency.SelectedValue="1",this.Salvage.ExchangeRate.Text="0",this.SalvageEnable.IsChecked=!1,this.LoadData(),0==this.DeprBookID?this.Title=o.a.GetResource("AddDeprBook"):(this.Title=o.a.GetResource("EditDeprBook"),this.OnLoadData()),this.OnDeprMethodChange(null)}get DeprBookID(){return this._DeprBookID}set DeprBookID(e){e!=this._DeprBookID&&(this._DeprBookID=e,this.obj.DeprBookID=this._DeprBookID)}LoadData(){this.ScreenObject.LoadScreen_2(this,75),this.DeprBookCode.Enable=!0,this.DeprBookName.Enable=!0,this.DeprBookMethod.Enable=!0,this.DeprBookStatus.Enable=!0,this.DeprMethodBasedOn.Enable=!0,this.DeprMethodBasedOnValue.Enable=!0,this.Salvage.Enable=!0,this.SalvageEnable.Enable=!0,this.Salvage.Visible=!0,this.SalvageEnable.Visible=!0,this.SalvageEnable.Label="Include salvage value in depriciation calcualtion",this.AveragingMethod.Enable=!0,this.Fields.push(this.DeprBookCode),this.Fields.push(this.DeprBookName),this.Fields.push(this.DeprBookStatus),this.Fields.push(this.DeprMethodBasedOn),this.Fields.push(this.DeprMethodBasedOnValue),this.Fields.push(this.Salvage),this.Fields.push(this.SalvageEnable),this.Fields.push(this.AveragingMethod),this.ScreenObject.Data.Tables.length>0&&(this.ScreenObject.Data.Tables[3].forEach(e=>{this.DeprBookStatus.Items.push(l.d.ComboBoxItems_2(e.Status.toString(),e.StatusID.toString()))}),this.DeprBookStatus.SelectedValue="381",this.ScreenObject.Data.Tables[4].forEach(e=>{this.DeprBookMethod.Items.push(l.d.ComboBoxItems_2(e.Name.toString(),e.DepreciationMethodID.toString()))}),this.DeprBookMethod.SelectedValue="1",this.DeprMethodBasedOn.Items.push(l.d.ComboBoxItems_2("Acquisition Value/Total","1")),this.DeprMethodBasedOn.Items.push(l.d.ComboBoxItems_2("Percentage On Acquisition Value","2")),this.DeprMethodBasedOn.SelectedValue="1",this.DeprMethodBasedOnValue.Text="1")}OnLoadData(){let e=p.a.GetDeprBookDetails(this.obj.DeprBookID);null!=e&&e.Tables.length>0&&e.Tables[0].length>0&&(this.DeprBookCode.Text=e.Tables[0][0].DeprBookCode.toString(),this.DeprBookName.Text=e.Tables[0][0].DeprBookName.toString(),this.DeprBookMethod.SelectedValue=e.Tables[0][0].DeprBookMethod.toString(),this.DeprBookStatus.SelectedValue=e.Tables[0][0].StatusID.toString(),this.AveragingMethod.SelectedValue=e.Tables[0][0].AveragingMethod.toString(),this.DeprMethodBasedOn.SelectedValue=e.Tables[0][0].DeprMethodBasedOn.toString(),this.DeprMethodBasedOnValue.Text=e.Tables[0][0].BasedOnValue.toString(),this.Salvage.Currency.SelectedValue=e.Tables[0][0].SalvageValueType.toString(),this.Salvage.ExchangeRate.Text=e.Tables[0][0].SalvageValue.toString(),this.SalvageEnable.IsChecked=Object(i.j)(e.Tables[0][0].IncludeSalvageInDepr),this.obj.GUID=e.Tables[0][0].GUID.toString())}OnDeprMethodChange(e){this.DeprMethodBasedOn.Visible="1"==this.DeprBookMethod.SelectedValue,this.OnDeprMethodBasedOn(null)}OnDeprMethodBasedOn(e){this.DeprMethodBasedOnValue.Label=this.DeprMethodBasedOn.Visible?"2"==this.DeprMethodBasedOn.SelectedValue?"Percentage":"Total Years":"Percentage"}OnSaveDeprBook(e){try{if("Save"==e.toString()){if(null==this.DeprBookCode.Text||""==this.DeprBookCode.Text.Trim())return void(this.DisplayMessage=o.a.GetResource("Enter")+" Code");if(this.obj.DeprBookCode=this.DeprBookCode.Text,null==this.DeprBookName.Text||""==this.DeprBookName.Text.Trim())return void(this.DisplayMessage=o.a.GetResource("Enter")+" Name");if(this.obj.DeprBookName=this.DeprBookName.Text,a.e.IsEmpty(this.DeprBookMethod.SelectedValue))return void(this.DisplayMessage=o.a.GetResource("Select")+o.a.GetResource("DeprMethod"));if(this.obj.DeprBookMethod=parseInt(this.DeprBookMethod.SelectedValue),a.e.IsEmpty(this.DeprBookStatus.SelectedValue))return void(this.DisplayMessage=o.a.GetResource("Select")+o.a.GetResource("Status"));if(this.obj.StatusID=parseInt(this.DeprBookStatus.SelectedValue),null==this.AveragingMethod.SelectedValue||""==this.AveragingMethod.SelectedValue)return void(this.DisplayMessage=o.a.GetResource("Select")+o.a.GetResource("DeprBook_AveragingMethod"));if(this.obj.AveragingMethodID=parseInt(this.AveragingMethod.SelectedValue),this.obj.DeprBookMethodBasedOnValue=a.e.Double(this.DeprMethodBasedOnValue.Text),this.obj.DeprBookMethodBasedOnValue<=0)return void(this.DisplayMessage="Please enter valid based on value");this.obj.DeprBookMethodBasedOn=parseInt(this.DeprMethodBasedOn.SelectedValue);let e=0,t=parseInt(this.Salvage.Currency.SelectedValue);e=a.e.Double(this.Salvage.ExchangeRate.Text),this.obj.SaveDeprBook(t,e,this.SalvageEnable.IsChecked).subscribe(e=>{this.DisplayMessage=e.Message,this.RetValue=e.RetValue,this.RetValue>0&&(this.DeprBookID=0,this.ClearFields(),null!=this.Parent&&this.Parent.Refresh())})}else o.a.page.HideDialog()}catch(t){Logger.ErrorLog("DeprBookViewModel:: OnSaveDeprBook",t)}}ClearFields(){this.DeprBookCode.Text="",this.DeprBookName.Text="",this.DeprBookStatus.SelectedValue="381",this.DeprBookMethod.SelectedValue="1",this.AveragingMethod.SelectedValue="1",this.OnDeprMethodChange(null)}}}}]);