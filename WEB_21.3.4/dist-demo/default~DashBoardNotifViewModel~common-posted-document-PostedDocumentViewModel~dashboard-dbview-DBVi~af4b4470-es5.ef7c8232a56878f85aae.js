function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var n,i=_getPrototypeOf(e);if(t){var s=_getPrototypeOf(this).constructor;n=Reflect.construct(i,arguments,s)}else n=i.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{H45g:function(e,t,n){"use strict";n.d(t,"a",(function(){return M}));var i=n("3Pt+"),s=n("fXoL"),o=n("ofXK"),a=n("q8k3"),r=n("qSjU"),l=n("towX"),c=n("sYmb");function u(e,t){if(1&e&&(s.Zb(0,"div",23),s.Wc(1,"\n                        "),s.Vb(2,8),s.Wc(3,"\n                        "),s.Wc(4,"\n                    "),s.Yb()),2&e){var n=s.lc(2);s.Db(2),s.tc("obj",n.obj.CostCenters)("group",n.form)}}function D(e,t){if(1&e&&(s.Zb(0,"div",23),s.Wc(1,"\n                                "),s.Vb(2,8),s.Wc(3,"\n                                "),s.Wc(4,"\n                            "),s.Yb()),2&e){var n=s.lc(4);s.Db(2),s.tc("obj",n.obj.CostCenters)("group",n.form)}}function d(e,t){if(1&e&&(s.Zb(0,"app-pact-tree",26),s.Wc(1,"\n                            "),s.Uc(2,D,5,2,"div",21),s.Wc(3,"\n                        "),s.Yb()),2&e){var n=t.$implicit,i=s.lc(3);s.tc("obj",n),s.Db(2),s.tc("ngIf",i.obj.CostCenters.Visible)}}function h(e,t){if(1&e&&(s.Zb(0,"div",24),s.Wc(1,"\n                        "),s.Uc(2,d,4,2,"app-pact-tree",25),s.Wc(3,"\n                    "),s.Yb()),2&e){var n=s.lc(2);s.Db(2),s.tc("ngForOf",n.obj.tree)}}function g(e,t){if(1&e&&(s.Zb(0,"div",20),s.Wc(1,"\n                "),s.Zb(2,"div"),s.Wc(3,"\n                    "),s.Uc(4,u,5,2,"div",21),s.Wc(5,"\n                    "),s.Uc(6,h,4,1,"div",22),s.Wc(7,"\n                "),s.Yb(),s.Wc(8,"\n            "),s.Yb()),2&e){var n=s.lc();s.Db(4),s.tc("ngIf",n.obj.CostCenters.Visible&&0==n.obj.tree.length),s.Db(2),s.tc("ngIf",n.obj.tree.length>0)}}function m(e,t){if(1&e&&(s.Zb(0,"div",12),s.Wc(1,"\n                "),s.Vb(2,10),s.Wc(3,"\n            "),s.Yb()),2&e){var n=s.lc();s.Db(2),s.tc("obj",n.obj.rdo)}}function b(e,t){if(1&e&&(s.Zb(0,"div",12),s.Wc(1,"\n                    "),s.Vb(2,10),s.Wc(3,"\n                "),s.Yb()),2&e){var n=s.lc();s.Db(2),s.tc("obj",n.obj.BankAccounts)}}function C(e,t){if(1&e&&(s.Zb(0,"div",12),s.Wc(1,"\n                    "),s.Vb(2,10),s.Wc(3,"\n                "),s.Yb()),2&e){var n=s.lc();s.Db(2),s.tc("obj",n.obj.Documents)}}function I(e,t){if(1&e&&(s.Zb(0,"div",5),s.Wc(1,"\n                "),s.Zb(2,"div",12),s.Wc(3,"\n                    "),s.Vb(4,10),s.Wc(5,"\n                "),s.Yb(),s.Wc(6,"\n                "),s.Zb(7,"div",12),s.Wc(8,"\n                    "),s.Vb(9,10),s.Wc(10,"\n                "),s.Yb(),s.Wc(11,"\n            "),s.Yb()),2&e){var n=s.lc();s.Db(4),s.tc("obj",n.obj.FilterON),s.Db(5),s.tc("obj",n.obj.SortON)}}function p(e,t){if(1&e&&(s.Zb(0,"div",12),s.Wc(1,"\n                    "),s.Zb(2,"fieldset"),s.Wc(3,"\n                        "),s.Zb(4,"legend"),s.Wc(5),s.mc(6,"translate"),s.Yb(),s.Wc(7,"\n                        "),s.Vb(8,10),s.Wc(9,"\n                    "),s.Yb(),s.Wc(10,"\n                "),s.Yb()),2&e){var n=s.lc();s.Db(5),s.Xc(s.nc(6,2,n.obj.Stat.Label)),s.Db(3),s.tc("obj",n.obj.Stat)}}function S(e,t){if(1&e&&(s.Zb(0,"div",12),s.Wc(1,"\n                    "),s.Vb(2,10),s.Wc(3,"\n                "),s.Yb()),2&e){var n=s.lc();s.Db(2),s.tc("obj",n.obj.Location)}}function y(e,t){if(1&e&&(s.Zb(0,"div",12),s.Wc(1,"\n                    "),s.Vb(2,10),s.Wc(3,"\n                "),s.Yb()),2&e){var n=s.lc();s.Db(2),s.tc("obj",n.obj.Division)}}function f(e,t){if(1&e&&s.Vb(0,30),2&e){var n=s.lc().$implicit;s.tc("obj",n)}}function P(e,t){if(1&e&&(s.Xb(0),s.Wc(1,"\n                    "),s.Uc(2,f,1,1,"ng-container",29),s.Wc(3,"\n                "),s.Wb()),2&e){var n=t.$implicit;s.Db(2),s.tc("ngIf",n.IsVisible)}}function T(e,t){if(1&e&&(s.Zb(0,"div",27),s.Wc(1,"\n                "),s.Uc(2,P,4,1,"ng-container",28),s.Wc(3,"\n            "),s.Yb()),2&e){var n=s.lc();s.Db(2),s.tc("ngForOf",n.obj.CostCenterFilters)}}function v(e,t){if(1&e){var n=s.ac();s.Zb(0,"button",16),s.hc("click",(function(){return s.Ic(n),s.lc().obj.OnButtonClick("SetAsDefault")})),s.Wc(1),s.mc(2,"translate"),s.Yb()}2&e&&(s.Db(1),s.Xc(s.nc(2,1,"Set As Default")))}var M=function(){var e=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){this.form=new i.j({})}},{key:"ngAfterViewInit",value:function(){if(0==this.obj.TreeVisibility){for(var e=document.createDocumentFragment(),t=document.querySelector(".cPostedDoc");t.firstChild;){var n=t.removeChild(t.firstChild);e.appendChild(n)}t.parentNode.replaceChild(e,t)}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Nb({type:e,selectors:[["app-posted-document-dialog"]],inputs:{obj:"obj"},decls:106,vars:32,consts:[[1,"master-screen",2,"padding-bottom","4px","height","100%"],[1,"cPostedDoc",2,"display","flex","height","100%"],["class","rpttree_div","style","width: 50%;display: flex;flex-direction: column;height: calc(100% - 50px);",4,"ngIf"],[1,"PACTHeaderFields","PDCDialog",2,"display","block","overflow","auto","max-height","calc(100% - 44px)","padding","15px","padding-right","12px","width","50%"],["class","form-group row form-row col-xl-6 col-md-6 col-sm-12 col-xs-12 PACTControl",4,"ngIf"],[1,"row"],["class","row",4,"ngIf"],["Style","width: 120px;",1,"form-group","row","form-row","PACTControl"],["FieldDirective","",3,"obj","group"],[1,"form-group","row","form-row","select-no-border"],["FieldDirective","",3,"obj"],[1,"form-group","row","form-row","col-xl-12","col-md-12","col-sm-12","col-xs-12","PACTControl"],[1,"form-group","row","form-row","col-xl-6","col-md-6","col-sm-12","col-xs-12","PACTControl"],["style","display: flex;flex-wrap: wrap;",4,"ngIf"],[1,"Pactdailogfooter",2,"margin-top","-50px"],[2,"margin","auto"],[1,"primary-btn-wicon",3,"click"],[1,"secondary-btn-wicon",3,"click"],[1,"fa-light","fa-rectangle-xmark"],["class","primary-btn-wicon",3,"click",4,"ngIf"],[1,"rpttree_div",2,"width","50%","display","flex","flex-direction","column","height","calc(100% - 50px)"],["class","CostCenters_select","style","margin: 5px;display: flex;align-items: center;",4,"ngIf"],["style","padding-right: 0px !important;height:  calc(100% - 50px);",4,"ngIf"],[1,"CostCenters_select",2,"margin","5px","display","flex","align-items","center"],[2,"padding-right","0px !important","height","calc(100% - 50px)"],[3,"obj",4,"ngFor","ngForOf"],[3,"obj"],[2,"display","flex","flex-wrap","wrap"],[4,"ngFor","ngForOf"],["ScreenDirective","",3,"obj",4,"ngIf"],["ScreenDirective","",3,"obj"]],template:function(e,t){1&e&&(s.Zb(0,"div",0),s.Wc(1,"\n    "),s.Zb(2,"div",1),s.Wc(3,"\n        "),s.Wc(4,"\n            "),s.Uc(5,g,9,2,"div",2),s.Wc(6,"\n        "),s.Wc(7,"\n\n        "),s.Zb(8,"div",3),s.Wc(9,"\n            "),s.Uc(10,m,4,1,"div",4),s.Wc(11,"\n            "),s.Zb(12,"div",5),s.Wc(13,"\n                "),s.Uc(14,b,4,1,"div",4),s.Wc(15,"\n                "),s.Uc(16,C,4,1,"div",4),s.Wc(17,"\n            "),s.Yb(),s.Wc(18,"\n            "),s.Uc(19,I,12,2,"div",6),s.Wc(20,"\n            "),s.Zb(21,"div",5),s.Wc(22,"\n                "),s.Zb(23,"div",7),s.Wc(24,"\n                    "),s.Vb(25,8),s.Wc(26,"\n                "),s.Yb(),s.Wc(27,"\n                "),s.Zb(28,"div",7),s.Wc(29,"\n                    "),s.Vb(30,8),s.Wc(31,"\n                "),s.Yb(),s.Wc(32,"\n                "),s.Zb(33,"div",9),s.Wc(34,"\n                    "),s.Vb(35,10),s.Wc(36,"\n                "),s.Yb(),s.Wc(37,"\n            "),s.Yb(),s.Wc(38,"\n            "),s.Zb(39,"div",5),s.Wc(40,"\n                "),s.Zb(41,"div",11),s.Wc(42,"\n                    "),s.Vb(43,10),s.Wc(44,"\n                "),s.Yb(),s.Wc(45,"\n                "),s.Wc(46,"\n            "),s.Yb(),s.Wc(47,"\n            "),s.Zb(48,"div",5),s.Wc(49,"\n                "),s.Zb(50,"div",12),s.Wc(51,"\n                    "),s.Vb(52,10),s.Wc(53,"\n                "),s.Yb(),s.Wc(54,"\n                "),s.Uc(55,p,11,4,"div",4),s.Wc(56,"\n            "),s.Yb(),s.Wc(57,"\n            "),s.Zb(58,"div",5),s.Wc(59,"\n                "),s.Uc(60,S,4,1,"div",4),s.Wc(61,"\n                "),s.Uc(62,y,4,1,"div",4),s.Wc(63,"\n            "),s.Yb(),s.Wc(64,"\n            "),s.Zb(65,"div",5),s.Wc(66,"\n                "),s.Zb(67,"div",12),s.Wc(68,"\n                    "),s.Vb(69,10),s.Wc(70,"\n                "),s.Yb(),s.Wc(71,"\n            "),s.Yb(),s.Wc(72,"\n            "),s.Zb(73,"div",5),s.Wc(74,"\n                "),s.Zb(75,"div",12),s.Wc(76,"\n                    "),s.Vb(77,10),s.Wc(78,"\n                "),s.Yb(),s.Wc(79,"\n            "),s.Yb(),s.Wc(80,"\n            "),s.Uc(81,T,4,1,"div",13),s.Wc(82,"\n\n        "),s.Yb(),s.Wc(83,"\n    "),s.Yb(),s.Wc(84,"\n    "),s.Zb(85,"div",14),s.Wc(86,"\n        "),s.Zb(87,"div",15),s.Wc(88,"\n            "),s.Zb(89,"button",16),s.hc("click",(function(){return t.obj.OnButtonClick("OK")})),s.Wc(90),s.mc(91,"translate"),s.Yb(),s.Wc(92,"\n            "),s.Zb(93,"button",17),s.hc("click",(function(){return t.obj.OnButtonClick("Cancel")})),s.Ub(94,"i",18),s.Wc(95),s.mc(96,"translate"),s.Yb(),s.Wc(97,"\n            "),s.Uc(98,v,3,3,"button",19),s.Wc(99,"\n            "),s.Zb(100,"button",16),s.hc("click",(function(){return t.obj.OnButtonClick("Reset")})),s.Wc(101),s.mc(102,"translate"),s.Yb(),s.Wc(103,"\n        "),s.Yb(),s.Wc(104,"\n    "),s.Yb(),s.Wc(105,"\n"),s.Yb()),2&e&&(s.Sc("width",t.obj.IsMobile?"100%":t.obj.TreeVisibility?"1050px":"550px"),s.Db(5),s.tc("ngIf",t.obj.TreeVisibility),s.Db(3),s.Sc("width",t.obj.TreeVisibility?"50%":"100%"),s.Db(2),s.tc("ngIf",t.obj.rdo),s.Db(4),s.tc("ngIf",t.obj.BankAccounts&&t.obj.BankAccounts.Visible),s.Db(2),s.tc("ngIf",t.obj.Documents.Visible),s.Db(3),s.tc("ngIf",t.obj.IsPDC),s.Db(6),s.tc("obj",t.obj.FromDate)("group",t.form),s.Db(5),s.tc("obj",t.obj.ToDate)("group",t.form),s.Db(5),s.tc("obj",t.obj.DateRanges),s.Db(8),s.tc("obj",t.obj.ForeignCurrency),s.Db(9),s.tc("obj",t.obj.Filter),s.Db(3),s.tc("ngIf",t.obj.IsPDC),s.Db(5),s.tc("ngIf",t.obj.Location.Visible),s.Db(2),s.tc("ngIf",t.obj.IsPDC&&t.obj.Division.Visible),s.Db(7),s.tc("obj",t.obj.DimensionWise),s.Db(8),s.tc("obj",t.obj.PostConversionDate),s.Db(4),s.tc("ngIf",t.obj.TreeVisibility),s.Db(9),s.Xc(s.nc(91,26,"Com_OK")),s.Db(5),s.Xc(s.nc(96,28,"Cancel")),s.Db(3),s.tc("ngIf",t.obj.IsPDC),s.Db(3),s.Xc(s.nc(102,30,"Reset")))},directives:[o.t,a.a,o.s,r.a,l.a],pipes:[c.d],encapsulation:2}),e}()},KHrY:function(e,t,n){"use strict";n.r(t),n.d(t,"PostedDocumentViewModel",(function(){return V}));var i,s=n("mrSG"),o=n("Do2H"),a=n("Lp6j"),r=n("eQJW"),l=n("ScVY"),c=n("4HhE"),u=n("JIg3"),D=n("0/4Q"),d=n("wlFP"),h=n("PDNK"),g=n("n56n"),m=n("AGpa"),b=n("w8Sz"),C=n("6z9j"),I=n("ZDA+"),p=n("8iaB"),S=n("7JXL"),y=n("/G+I"),f=function(e){_inherits(n,e);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.call(this)).LocationCheckedChanged=new c.b,e.ButtonClick=new c.b,e.IsQuit=!0,e.IsOK=!1,e.FromDate=new u.a(0),e._ClearSelectedNodes=!1,e.Documents=new D.e(0),e.ToDate=new u.a(0),e.DateRanges=new D.e(0),e.Location=new D.b,e.Division=new D.b,e.DimensionWise=new D.b,e.Dimension=0,e._PostConversionDate=new d.a(0),e.IsPDC=!0,e.BankAccounts=new g.b(0),e.LockCheckedChanged=!1,e}return _createClass(n,[{key:"PostedDocumentDialogViewModel",value:function(e){this.IsPDC=!1,this.Title="Trust Reciept",this.Trparent=e,this.Load(),this.TreeVisibility&&(this.CostCenters.Label=o.a.GetResource("Reports_SelectCostCenter"))}},{key:"PostedDocumentDialogViewModel_1",value:function(e){this.parent=e,this.Title=o.a.GetResource("DocumentDesigner_PostedDocument"),this.Load(),this.TreeVisibility&&(this.CostCenters.Label=o.a.GetResource("Reports_SelectCostCenter"))}},{key:"Load",value:function(){var e=this;if(this.BankAccounts.Label=o.a.GetResource("Reports_BankName"),this.FromDate.Label=o.a.GetResource("DocumentDesigner_FromDate"),this.ToDate.Label=o.a.GetResource("DocumentDesigner_ToDate"),this.FromDate.Date=o.a.SessionManager.ReportsFromDate,this.DateRanges=b.a.getDateRanges(),this.DateRanges.SelectionChangedCommand.Subscribe(this,"OnDateRangesSelectionChanged"),this.PostConversionDate.Label=o.a.GetResource("PostonConversionDate"),this.ButtonClick.Subscribe(this,"OnButtonClick"),this.LocationCheckedChanged.Subscribe(this,"OnLocationCheckedChanged"),this.Location=new D.b,this.Location.CheckedChangedCommand.Subscribe(this,"OnLocationCheckedChanged"),this.Location.Items.push(D.c.CheckedListBoxItem_6("All","All",!1,50002)),this.Location.Visible="True"==o.a.SessionManager.Preferences.EnableLocationWise.toString(),this.tree=[],this.CostCenterFilters=[],this.CostCenters=new D.e(0),this.CostCenters.SelectionChangedCommand.Subscribe(this,"OnCostCenterChange"),this.Division=new D.b,this.Division.CheckedChangedCommand.Subscribe(this,"OnLocationCheckedChanged"),this.Division.Items.push(D.c.CheckedListBoxItem_6("All","All",!1,50001)),this.Division.Visible="True"==o.a.SessionManager.Preferences.EnableDivisionWise.toString(),o.a.SessionManager.Preferences.ContainsKey("PDCFilterDimension")&&null!=o.a.SessionManager.Preferences.PDCFilterDimension&&""!=o.a.SessionManager.Preferences.PDCFilterDimension.toString()&&"0"!=o.a.SessionManager.Preferences.PDCFilterDimension.toString()&&(this.Dimension=parseInt(o.a.SessionManager.Preferences.PDCFilterDimension.toString())),this.DimensionWise=new D.b,this.DimensionWise.CheckedChangedCommand.Subscribe(this,"OnLocationCheckedChanged"),this.DimensionWise.Items.push(D.c.CheckedListBoxItem_6("All","All",!1,this.Dimension)),this.DimensionWise.Visible=this.Dimension>5e4,this.IsPDC){var t,n,i;this.PostConversionDate.Visible=o.a.SessionManager.IsActionAssigned(4e4,"Post on Conversion Date"),this.Documents.Label=o.a.GetResource("lblPDCDocument"),o.a.SessionManager.Preferences.ContainsKey("IntermediatePDCAccListview")&&null!=o.a.SessionManager.Preferences.IntermediatePDCAccListview&&""!=o.a.SessionManager.Preferences.IntermediatePDCAccListview.toString()&&"0"!=o.a.SessionManager.Preferences.IntermediatePDCAccListview.toString()?(this.BankAccounts.CCID=2,this.BankAccounts.TypeID=parseInt(o.a.SessionManager.Preferences.IntermediatePDCAccListview.toString()),this.BankAccounts.Refresh()):(this.BankAccounts.CCID=2,this.BankAccounts.TypeID=2,this.BankAccounts.Refresh()),null!=this.parent&&null!=this.parent.ForeignCurrency?this.ForeignCurrency=this.parent.ForeignCurrency:(this.ForeignCurrency=new m.a,o.a.common.GetDataSet("PDDVM01","").Tables[0].forEach((function(t){e.ForeignCurrency.ComboBox.Items.push(D.d.ComboBoxItems_2(t.Name.toString(),t.CurrencyID.toString()))})),this.ForeignCurrency.ComboBox.Items.length>0&&(this.ForeignCurrency.ComboBox.SelectedValue=this.ForeignCurrency.ComboBox.Items[0].Value)),this.Filter=new h.b("Documents"),(t=new h.a("All",0,"Filter")).Group=this.Filter,null!=parent&&0==this.parent.Filter&&(t.IsChecked=!0),t.Label=o.a.GetResource("ComLanguageAll"),this.Filter.Items.push(t),(t=new h.a("PDR",1,"Filter")).Group=this.Filter,null!=parent&&1==this.parent.Filter&&(t.IsChecked=!0),t.Label=o.a.GetResource("PDR"),this.Filter.Items.push(t),(t=new h.a("PDP",2,"Filter")).Group=this.Filter,null!=parent&&2==this.parent.Filter&&(t.IsChecked=!0),t.Label=o.a.GetResource("PDP"),this.Filter.Items.push(t),this.Stat=new D.e(0),this.Stat.Label=o.a.GetResource("lblPDCStatus"),this.Stat.Items.push(D.d.ComboBoxItems_2(o.a.GetResource("ComLanguageAll"),"0")),this.Stat.Items.push(D.d.ComboBoxItems_2(o.a.GetResource("PDC"),"370")),this.Stat.Items.push(D.d.ComboBoxItems_2(o.a.GetResource("PDC_Posted"),"369")),this.Stat.Items.push(D.d.ComboBoxItems_2(o.a.GetResource("DocumentDesigner_Bounced"),"429")),this.Stat.Items.push(D.d.ComboBoxItems_2("Discounted","439")),this.Stat.Items.push(D.d.ComboBoxItems_2("Cancelled","376")),o.a.SessionManager.IsActionAssigned(4e4,"Replace")&&(this.Stat.Items.push(D.d.ComboBoxItems_2(o.a.GetResource("Replace"),"1")),this.Stat.Items.push(D.d.ComboBoxItems_2(o.a.GetResource("ReplacePartial"),"2"))),o.a.SessionManager.Preferences.ContainsKey("PDCHoldDimension")&&!a.e.IsEmpty(o.a.SessionManager.Preferences.PDCHoldDimension)&&o.a.SessionManager.Preferences.PDCHoldDimension.length>1&&o.a.common.GetDataSet("PDDVM02",o.a.SessionManager.Preferences.PDCHoldDimension).Tables[0].forEach((function(t){return e.Stat.Items.push(D.d.ComboBoxItems_2(t.Name.toString(),"HOLD_"+t.NodeID.toString()))})),this.Stat.SelectedValue=this.parent.Status,this.FilterON=new h.b(o.a.GetResource("Reports_LblFilterOn")),(n=new h.a("Doc Date",0,"FilterON")).Group=this.FilterON,null!=parent&&0==this.parent.Filter&&(n.IsChecked=!0),n.Label=o.a.GetResource("Doc_Date"),this.FilterON.Items.push(n),(n=new h.a("Maturity Date",1,"FilterON")).Group=this.FilterON,null!=this.parent&&1==this.parent.Filter&&(n.IsChecked=!0),n.Label=o.a.GetResource("Maturity_Date"),this.FilterON.Items.push(n),this.SortON=new h.b(o.a.GetResource("Reports_LblSortOn")),(i=new h.a("Doc Date",0,"SortON")).Group=this.SortON,null!=parent&&0==this.parent.Filter&&(i.IsChecked=!0),i.Label=o.a.GetResource("Doc_Date"),this.SortON.Items.push(i),(i=new h.a("Maturity Date",1,"SortON")).Group=this.SortON,null!=parent&&1==this.parent.Filter&&(i.IsChecked=!0),i.Label=o.a.GetResource("Maturity_Date"),this.SortON.Items.push(i),this.Documents.Items.push(D.d.ComboBoxItems_2("",""));var s=o.a.admin.GetPDCDocs();if(null!=s&&s.Tables.length>0){for(var l=0;l<s.Tables[0].length;l++)this.Documents.Items.push(D.d.ComboBoxItems_2(s.Tables[0][l][s.Columns[0][0]].toString(),s.Tables[0][l][s.Columns[0][1]].toString()));if(this.TreeVisibility&&s.Tables.length>1)for(var c=0;c<s.Tables[1].length;c++)this.CostCenters.Items.push(D.d.ComboBoxItems_2(s.Tables[1][c][s.Columns[1][0]].toString(),s.Tables[1][c][s.Columns[1][1]].toString()))}if(this.Documents.SelectedValue=this.parent.DocumentPicked,null!=this.parent){if(this.Location.Visible){var u=o.a.admin.getLocationRoles(["50002",o.a.SessionManager.LangID]),d=o.a.SessionManager.LocationWhere.split(","),g=a.e.IsEmpty(this.parent.Locations)?[{LocationID:o.a.SessionManager.LocationID.toString()}]:this.parent.Locations.split(",");if(null!=u&&u.Tables.length>0&&u.Tables[0].length>0)for(var C=0;C<u.Tables[0].length;C++)Object(r.j)(u.Tables[0][C].IsGroup.toString())||d.Contains(u.Tables[0][C][u.Columns[0][0]].toString())&&(g.Contains(u.Tables[0][C][u.Columns[0][0]].toString())?this.Location.Items.push(D.c.CheckedListBoxItem_6(u.Tables[0][C][u.Columns[0][2]].toString(),u.Tables[0][C][u.Columns[0][0]].toString(),!0,50002)):this.Location.Items.push(D.c.CheckedListBoxItem_6(u.Tables[0][C][u.Columns[0][2]].toString(),u.Tables[0][C][u.Columns[0][0]].toString(),!1,50002)))}if(this.Division.Visible){var p=o.a.admin.getLocationRoles([50001,o.a.SessionManager.LangID]),y=this.Location.Visible?o.a.SessionManager.DivisionWhere.split(","):o.a.SessionManager.LocationWhere.split(","),f=a.e.IsEmpty(this.parent.Divisions)?this.Location.Visible?o.a.SessionManager.DivisionID.toString():o.a.SessionManager.LocationID.toString():this.parent.Divisions.split(",");if(null!=p&&p.Tables.length>0&&p.Tables[0].length>0)for(var P=0;P<p.Tables[0].length;P++)Object(r.j)(p.Tables[0][P].IsGroup.toString())||y.Contains(p.Tables[0][P][p.Columns[0][0]].toString())&&(f.Contains(p.Tables[0][P][p.Columns[0][0]].toString())?this.Division.Items.push(D.c.CheckedListBoxItem_6(p.Tables[0][P][p.Columns[0][2]].toString(),p.Tables[0][P][p.Columns[0][0]].toString(),!0,50001)):this.Division.Items.push(D.c.CheckedListBoxItem_6(p.Tables[0][P][p.Columns[0][2]].toString(),p.Tables[0][P][p.Columns[0][0]].toString(),!1,50001)))}if(this.DimensionWise.Visible){var T;T="1"!=o.a.SessionManager.UserID&&o.a.SessionManager.Preferences.ContainsKey("Dimension List")&&!a.e.IsEmpty(o.a.SessionManager.Preferences["Dimension List"])&&o.a.SessionManager.Preferences["Dimension List"].toString().Contains(this.Dimension.toString());var v=o.a.common.GetDataSet3("PDDVM03",this.Dimension.toString(),""+T,o.a.SessionManager.UserID+","+o.a.SessionManager.LanguageID),M=this.parent.Dimensions.split(",");if(null!=v&&v.Tables.length>0&&v.Tables[0].length>0){for(var L=0;L<v.Tables[0].length;L++)Object(r.j)(v.Tables[0][L].IsGroup.toString())||(M.Contains(v.Tables[0][L][v.Columns[0][0]].toString())?this.DimensionWise.Items.push(D.c.CheckedListBoxItem_6(v.Tables[0][L].Name.toString(),v.Tables[0][L].NodeID.toString(),!0,this.Dimension)):this.DimensionWise.Items.push(D.c.CheckedListBoxItem_6(v.Tables[0][L].Name.toString(),v.Tables[0][L].NodeID.toString(),!1,this.Dimension)));this.DimensionWise.Label=v.Tables.length>1&&v.Tables[1].length>0?v.Tables[1][0][v.Columns[1][0]].toString():"Dimension"}}this.ToDate.Date=this.parent.ToDate,this.BankAccounts.SelectedValue=this.parent.BankID,this.PostConversionDate.IsChecked=this.parent.PostonconversionDate}if(o.a.SessionManager.Preferences.ContainsKey("DefaultPostConversionDate")&&""!=o.a.SessionManager.Preferences.DefaultPostConversionDate&&(this.PostConversionDate.IsChecked=Object(r.j)(o.a.SessionManager.Preferences.DefaultPostConversionDate)),null!=this.parent){var A=o.a.admin.GetDefaultPDC(1),k=A.Tables.length>0?A.Tables[0]:null;if(null!=k&&k.length>0&&!a.e.IsEmpty(k[0].UserProbableValues)){var V=new a.f;V.LoadXml(k[0].UserProbableValues.toString()),V.SelectNodes("XML/Row").forEach((function(t){if(e.BankAccounts.SelectedValue=parseInt(t.attributes.Bank.value),e.FilterON.Items[parseInt(t.attributes.FilterOn.value)].IsChecked=!0,e.SortON.Items[parseInt(t.attributes.SortOn.value)].IsChecked=!0,e.Filter.Items[parseInt(t.attributes.Document.value)].IsChecked=!0,e.Stat.SelectedValue=t.attributes.Status.value.toString(),e.PostConversionDate.IsChecked=Object(r.j)(t.attributes.PostonconversionDate.value),null!=t.attributes.Documents&&""!=t.attributes.Documents.value&&(e.Documents.SelectedValue=t.attributes.Documents.value),null!=parent&&null!=e.parent.ForeignCurrency||null!=t.attributes.FCChecked&&(e.ForeignCurrency.CheckBox.IsChecked=Object(r.j)(t.attributes.FCChecked.value),e.ForeignCurrency.ComboBox.SelectedValue=t.attributes.FCID.value),e.Location.Visible)for(var n=t.attributes.Locations.value.toString().split(","),i=0;i<e.Location.Items.length;i++)for(var s=0;s<n.length;s++)e.Location.Items[i].Value.toString()==n[s].toString()&&(e.Location.Items[i].IsChecked=!0);if(e.Division.Visible&&null!=t.attributes.Divisions)for(var o=t.attributes.Divisions.value.toString().split(","),a=0;a<e.Division.Items.length;a++)for(var l=0;l<o.length;l++)e.Division.Items[a].Value.toString()==o[l].toString()&&(e.Division.Items[a].IsChecked=!0);if(e.DimensionWise.Visible&&null!=t.attributes.Dimensions&&e.Dimension.toString()==t.attributes.Dimension.value.toString())for(var c=t.attributes.Dimensions.value.toString().split(","),u=0;u<e.DimensionWise.Items.length;u++)for(var D=0;D<c.length;D++)e.DimensionWise.Items[u].Value.toString()==c[D].toString()&&(e.DimensionWise.Items[u].IsChecked=!0);var d;e.TreeVisibility&&null!=e.CostCenterFilters&&function(){for(var n,i="",s="",o=[],a=0,r=0;r<t.attributes.length;r++)if(t.attributes[r].name.startsWith("TreeFilterDimension_")){o=[],i=t.attributes[r].name.Replace("TreeFilterDimension_","");var l=t.attributes[r].value.split(",");if(null!=l&&l.length>0)for(var c=0;c<l.length;c++)if(null!=l[c]&&""!=l[c].toString()){var u=new I.a;u.Id=parseInt(l[c]),o.push(u)}null!=(d=e.CostCenters.Items.find((function(e){return e.Value==i})))&&(s=d.Name),(n=new S.a(parseInt(i),"",s,e)).SelectedNodes=o,n.SelectedNodesTag="[FILTER]",e.CostCenterFilters.push(n),0==a&&(e.CostCenters.SelectedItem=d,e.CostCenters.SelectedValue=i,e.OnCostCenterChange(null)),a++}}()}))}}}else{this.BankAccounts.CCID=2,this.BankAccounts.TypeID=2,this.BankAccounts.Refresh(),this.Filter=new h.b("Documents");var G=new h.a("All",0,"Filter");G.Group=this.Filter,null!=this.Trparent&&0==this.Trparent.Filter&&(G.IsChecked=!0),G.Label=o.a.GetResource("ComLanguageAll"),this.Filter.Items.push(G),(G=new h.a("pending",1,"Filter")).Group=this.Filter,null!=this.Trparent&&1==this.Trparent.Filter&&(G.IsChecked=!0),G.Label=o.a.GetResource("PDR"),this.Filter.Items.push(G),this.FromDate.Date=this.Trparent.FromDate,this.ToDate.Date=this.Trparent.toDate,this.BankAccounts.SelectedValue=this.Trparent.BankAccounts.SelectedValue,this.Documents.Visible=!1}}},{key:"OnCostCenterChange",value:function(e){if(!a.e.IsEmpty(this.CostCenters.SelectedValue)&&(0==this.tree.length||this.tree[0].CostCenterID!=parseInt(this.CostCenters.SelectedValue))){var t=0;null==this.CostCenters.SelectedItem||a.e.IsEmpty(this.CostCenters.SelectedItem.Parent)||(t=a.e.Int(this.CostCenters.SelectedItem.Parent)),this.LoadCostCenterTree(parseInt(this.CostCenters.SelectedValue),t,0,null)}}},{key:"LoadCostCenterTree",value:function(e,t,n,i){this.tree.Clear();var s="";50002==e&&"True"==o.a.SessionManager.Preferences.EnableLocationWise.toString()&&"True"==o.a.SessionManager.Preferences["LW Reports"]&&(s=a.e.IsEmpty(o.a.SessionManager.LocationWhere)?"a.NodeID IN (-1234)":"a.NodeID IN ("+o.a.SessionManager.LocationWhere+")");var r=new C.a;if(null==i)for(var l=0;l<this.CostCenterFilters.length;l++){var u=this.CostCenterFilters[l];if(u.CostCenterID==e&&u.LookupTypeID==t){i=u.SelectedNodes;break}}null==i?r.TreeViewModel_5(e,this,n,s,""):r.TreeViewModel_6(e,this,n,s,i,""),r.LookupTypeID=t,r.HeaderVisiblity=!1,r.OnNodeSelected||(r.OnNodeSelected=new c.b,r.OnNodeSelected.Subscribe(this,"OnNodeSelected")),this.tree.push(r)}},{key:"GetLocation",value:function(e,t){var n="";if(e.Visible){for(var i=1;i<e.Items.length;i++)e.Items[i].IsChecked&&(n.length>0&&(n+=","),n+=e.Items[i].Value);t&&(0==n.length&&(n="-100"),e.Items[0].IsChecked&&"1"==o.a.SessionManager.RoleID&&(n=""))}return n}},{key:"OnLocationCheckedChanged",value:function(e){if(!this.LockCheckedChanged&&e.item instanceof D.c){var t=e.item,n=50001==t.Type||50002==t.Type?50001==t.Type?this.Division:this.Location:this.DimensionWise;if("All"==t.Value){this.LockCheckedChanged=!0;for(var i=1;i<n.Items.length;i++)n.Items[i].IsChecked=t.IsChecked;this.LockCheckedChanged=!1}else{if(this.LockCheckedChanged=!0,t.IsChecked){n.Items[0].IsChecked=!0;for(var s=1;s<n.Items.length;s++)if(!n.Items[s].IsChecked){n.Items[0].IsChecked=!1;break}}else n.Items[0].IsChecked=!1;this.LockCheckedChanged=!1}this.LockCheckedChanged=!1}}},{key:"OnButtonClick",value:function(e){if("Cancel"==e.toString())o.a.page.HideDialog();else if("SetAsDefault"==e.toString()){var t="";if(t+="<XML>",t+="<Row ",t+='Bank="'+this.BankAccounts.SelectedValue+'" ',t+='FilterOn="'+this.FilterON.CheckedItem.FeatureID+'" ',t+='SortOn="'+this.SortON.CheckedItem.FeatureID+'" ',t+='Document="'+this.Filter.CheckedItem.FeatureID+'" ',t+='Status="'+this.Stat.SelectedValue+'" ',t+='Locations="'+this.GetLocation(this.Location,!1)+'" ',t+='Divisions="'+this.GetLocation(this.Division,!1)+'" ',t+='PostonconversionDate="'+this.PostConversionDate.IsChecked+'" ',t+='Documents="'+this.Documents.SelectedValue+'" ',this.DimensionWise.Visible&&(t+='Dimension="'+this.Dimension+'" ',t+='Dimensions="'+this.GetLocation(this.DimensionWise,!1)+'" '),null!=this.ForeignCurrency&&(t+='FCChecked="'+this.ForeignCurrency.CheckBox.IsChecked+'" ',t+='FCID="'+(""==this.ForeignCurrency.ComboBox.SelectedValue?"0":this.ForeignCurrency.ComboBox.SelectedValue)+'" '),this.TreeVisibility&&null!=this.CostCenterFilters&&this.CostCenterFilters.length>0)for(var n="",i=0;i<this.CostCenterFilters.length;i++){n="";for(var s=0;s<this.CostCenterFilters[i].SelectedNodes.length;s++)s>0&&(n+=","),n+=this.CostCenterFilters[i].SelectedNodes[s].Id;n.length>0&&(t+="TreeFilterDimension_"+this.CostCenterFilters[i].CostCenterID+'="'+n+'" ')}t+="/>",t+="</XML>";o.a.admin.SetDefaultPDC(t.toString(),!0,1,0)}else if("Reset"==e.toString())o.a.admin.SetDefaultPDC("",!1,1,0),this.BankAccounts.SelectedValue=0,this.Stat.SelectedValue="0",this.Documents.SelectedValue="",this.Location.Items.length>0&&this.Location.Items.forEach((function(e){e.IsChecked=!1}));else if("LocationSearch"==e);else if("DivisionSearch"==e);else if("DimensionWiseSearch"==e);else try{this.IsPDC&&null!=parent?(this.parent.DialogResult=!0,this.parent.FromDate=this.FromDate.Date,this.parent.ForeignCurrency=this.ForeignCurrency,this.parent.ToDate=this.ToDate.Date,this.parent.BankID=this.BankAccounts.SelectedValue,this.parent.Filter=this.Filter.CheckedItem.FeatureID,null!=this.Stat.SelectedValue&&this.Stat.SelectedValue.startsWith("HOLD_")?(this.parent.Status="0",this.parent.HoldDimFilter=parseInt(this.Stat.SelectedValue.replace("HOLD_",""))):(this.parent.Status=this.Stat.SelectedValue,this.parent.HoldDimFilter=0),this.parent.DocumentPicked=this.Documents.SelectedValue,this.parent.Locations=this.GetLocation(this.Location,!0),this.parent.Divisions=this.GetLocation(this.Division,!0),this.parent.Dimensions=this.GetLocation(this.DimensionWise,!0),this.parent.PostonconversionDate=this.PostConversionDate.IsChecked,this.parent.FilterOn=this.FilterON.Items[0].IsChecked?"DocDate":"ChequeMaturityDate",this.parent.SortOn=this.SortON.Items[0].IsChecked?"DocDate":"ChequeMaturityDate",this.parent.TreeWhere="",this.TreeVisibility&&null!=this.CostCenterFilters&&this.CostCenterFilters.length>0&&(this.parent.TreeWhere=this.GetDimensionFilter("L.dcCCNID")),this.parent.LoadData(),this.parent.PDCDialog=this,o.a.page.HideDialog()):null!=this.Trparent&&(this.Trparent.DialogResult=!0,this.Trparent.FromDate=this.FromDate.Date,this.Trparent.toDate=this.ToDate.Date,this.Trparent.BankAccounts.SelectedValue=this.BankAccounts.SelectedValue,this.Trparent.Filter=this.Filter.CheckedItem.FeatureID,this.Trparent.LoadData(),o.a.page.HideDialog())}catch(a){Logger.ErrorLog("PostedDocumentDialogViewModel","OnButtonClick",a.Message)}}},{key:"GetDimensionFilter",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i="";return this.CostCenterFilters.forEach((function(s){if(s.CostCenterID>5e4&&(null==n||!n.Contains(s.CostCenterID)))if(s.SelectedNodes.length>0)if(1==s.SelectedNodes.length)i+=" AND ",i+=e+(s.CostCenterID-5e4)+"="+s.SelectedNodes[0].Id;else{var a="1"==o.a.SessionManager.UserID||"1"==o.a.SessionManager.RoleID;if(null==(s.DeleteButtonVisibility||a?s.SelectedNodes.find((function(e){return 2==e.Id&&e.IsGroup})):null))if(i+=" AND ",y.IPrefetchFilter.IsGroupTree(s)&&(s.DeleteButtonVisibility||a)){for(var r="",l=0;l<s.SelectedNodes.length;l++)null!=s.SelectedNodes[l].Parent&&s.SelectedNodes[l].Parent.IsSelected||(r.length>0&&(r+=","),r+=s.SelectedNodes[l].Id);0==r.length&&(r+=-12912),i+=e+(s.CostCenterID-5e4)+" IN ",i+=" (select T.NodeID GTID from "+t.GetTagTableName(s.CostCenterID)+" T with(nolock),"+t.GetTagTableName(s.CostCenterID)+" GTP with(nolock) where T.lft BETWEEN GTP.lft AND GTP.rgt AND GTP.NodeID IN "+r.toString()+")  group by T.NodeID)"}else{i+=e+(s.CostCenterID-5e4)+" IN (";for(var c=0;c<s.SelectedNodes.length;c++)c>0&&(i+=","),i+=s.SelectedNodes[c].Id;i+=")"}}else s.DeleteButtonVisibility||(i+=" AND ",i+=e+(s.CostCenterID-5e4)+"=-12912")})),i.toString()}},{key:"GetTagTableName",value:function(e){return 2==e?"ACC_Accounts":3==e?"INV_Product":7==e?"ADM_Users":50001==e?"COM_Division":50002==e?"COM_Location":50003==e?"COM_Branch":50004==e?"COM_Department":50005==e?"COM_Salesman":50006==e?"COM_Category":50007==e?"COM_Area":50008==e?"COM_Teritory":"COM_CC"+e}},{key:"OnDateRangesSelectionChanged",value:function(e){}},{key:"TreeVisibility",get:function(){return!(!o.a.SessionManager.Preferences.ContainsKey("PDCTreeFilter")||"True"!=o.a.SessionManager.Preferences.PDCTreeFilter)}},{key:"ClearSelectedNodes",get:function(){return this._ClearSelectedNodes},set:function(e){this._ClearSelectedNodes=e,this.tree.length>0&&(this.tree[0].ClearAllSelectedNodes=!this.tree[0].ClearAllSelectedNodes)}},{key:"PostConversionDate",get:function(){return this._PostConversionDate}}]),n}(p.a),P=n("lUlH"),T=n("8B8H"),v=n("vTM8"),M=n("uMy8"),L=n("ockk"),A=n("H45g"),k=n("Iab2"),V=((i=function(e){_inherits(i,e);var t=_createSuper(i);function i(){var e;_classCallCheck(this,i),(e=t.call(this)).SavePostedDocument=new c.b,e.ConvertMatDateequaltosysdate=!1,e.ConvertMatDatelessthanequaltosysdate=!1,e.MessageVisibility=!1,e._SelectMaturityDate=!1,e._SelectLessThanMaturityDate=!1,e.DialogResult=!1,e.FromDate=new Date,e.ToDate=new Date,e.Filter=0,e.HoldDimFilter=0,e.Locations="",e.Divisions="",e.Status="0",e.DocumentPicked="",e.Dimensions="",e.TreeWhere="",e.PostonconversionDate=!1,e.IsPDCHoldDimension=!1,e.dtTmp=null,e.dtActions=null,e.ActionSummary="",e._ScreenObject=new P.a(4e4,0),e.onLoad(),e.SetLockDims(),e.DialogResult=!1;var n=new f;return n.PostedDocumentDialogViewModel_1(_assertThisInitialized(e)),o.a.page.ShowDialog(n,A.a),e.PstDocGrid.Height=500,e}return _createClass(i,[{key:"PostedDocumentViewModel_1",value:function(e){this.ActionSummary="",Logger.InfoLog("PostedDocumentViewModel:: Inside PostedDocumentViewModel main "),this._ScreenObject=new P.a(4e4,0),i.SetDimensionQuery(),this.onLoad(),this.LoadDashData(e),Logger.InfoLog("PostedDocumentViewModel:: Exiting PostedDocumentViewModel ")}},{key:"onLoad",value:function(){Logger.InfoLog("PostedDocumentViewModel:: Inside onLoad  "),this.DisplayName=o.a.GetResource("DocumentDesigner_PostedDocument"),this.InitColumns(),this.ConvertMatDatelessthanequaltosysdate=o.a.SessionManager.IsActionAssigned(4e4,"Convert maturity date lessthan or equalto sysdate"),this.ConvertMatDateequaltosysdate=o.a.SessionManager.IsActionAssigned(4e4,"Convert maturity date equal to system date"),this.SavePostedDocument.Subscribe(this,"ButtonSave"),this.PstDocGrid.BeginEdit.Subscribe(this,"OnBeginEdit"),this.PstDocGrid.CellEditEnding.Subscribe(this,"OnEditend"),this.PstDocGrid.OnPreviewKeyDown.Subscribe(this,"OnPreviewKeyDown"),Logger.InfoLog("PostedDocumentViewModel:: Exiting onLoad  ")}},{key:"OnPreviewKeyDown",value:function(e,t){var n="";if(e.grid.getCellEditor()&&e.grid.getCellEditor().args.column.name&&(n=e.grid.getCellEditor().args.column.name),117==t.which&&("Action"==n||"clrDate"==n)){if("YES"!=(confirm("Do you want to override all.?")?"Yes":"No").toUpperCase())return!0;for(var i=this.PstDocGrid.Table,s=0;s<i.length;s++)("Action"!=n||this.isActionExists(i[s],e[n].toString()))&&(i[s][n]=e[n].toString(),this.PstDocGrid.TableColumns.Contains(n+"_Key")&&(i[s][n+"_Key"]=e[n+"_Key"].toString()),this.UpdateAction(i[s]));return!0}return!1}},{key:"isActionExists",value:function(e,t){var n=this.dtActions;n.RowFilter=a.e.IsEmpty(e.StatusID)||370!=parseInt(e.StatusID.toString())?a.e.IsEmpty(e.StatusID)||439!=parseInt(e.StatusID.toString())?a.e.IsEmpty(e.StatusID)||369!=parseInt(e.StatusID.toString())?"Value=2 or Value=100":"Value=2 or Value=0  or Value=4 or Value=5 or Value=100":"Value=1 or Value=0 or Value=100":"Value=1 or Value=0 or Value=4 or Value=5 or Value=3 or Value=100";for(var i=0;i<n.length;i++)if(n[i].Value.toString()==t)return!0;return!1}},{key:"SetLockDims",value:function(){return Object(s.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,i,s,r,l,c,u,D,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e(2),n.e(1),n.e(3),n.e(5),n.e(4),n.e(6),n.e(7),n.e(10),n.e(9),n.e(12),n.e(11),n.e(13),n.e(19),n.e(15),n.e(21),n.e(20),n.e(16),n.e(14),n.e(18),n.e(17),n.e(22),n.e(148)]).then(n.bind(null,"1Cra"));case 2:t=e.sent,i=t.AddEditDocumentViewModel,"true"==o.a.SessionManager.Preferences.UseDimWiseLock.toLowerCase()&&""!=o.a.SessionManager.Preferences["DimensionWiseLockData Customize Screen"]&&"<XML></XML>"!=o.a.SessionManager.Preferences["DimensionWiseLockData Customize Screen"]&&(this.ScreenObject.LockWhere="",s="",r="",l=new v.a,c=0,u=0,D=o.a.common.GetDataSet("PDVM01",""),(d=new a.f).LoadXml(o.a.SessionManager.Preferences["DimensionWiseLockData Customize Screen"]),d.SelectNodes("XML/Row").forEach((function(e){if(null!=e.attributes.ID&&!a.e.IsEmpty(e.attributes.ID.value)){u++;var t=!1;c=parseInt(e.attributes.ID.value),null!=D&&D.Tables.length>0&&D.Tables[0].length>0&&D.Tables[0].filter((function(e){return e.CostCenterID==c})).length>0&&(t=!0),l.push(c.toString(),t),t?(r+=" left join "+a.e.GetTagTableName(c)+" CC"+u+" with(nolock) on C."+i.GetPrimarkyKey(c,!0)+"=CC"+u+"."+i.GetPrimarkyKey(c)+"\n\t\t\t\t\t\t\t\tleft join "+a.e.GetTagTableName(c)+" CJ"+u+" with(nolock) on CJ"+u+".lft between CC"+u+".lft and CC"+u+".rgt",c>5e4?s+=" and (b.dcCCNID"+(c-5e4)+"=CJ"+u+".NodeID or c.CCNID"+(c-5e4)+"=0)":3==c?s+=" and (a.ProductID=CJ"+u+".ProductID or c.ProductID=0)":2==c&&(s+=" and (a.DebitAccount=CJ"+u+".AccountID or a.CreditAccount=CJ"+u+".AccountID or c.AccountID=0)")):c>5e4?s+=" and (b.dcCCNID"+(c-5e4)+"=c.CCNID"+(c-5e4)+" or c.CCNID"+(c-5e4)+"=0)":3==c?s+=" and (a.ProductID=c.ProductID or c.ProductID=0)":2==c?s+=" and (a.DebitAccount=c.AccountID or a.CreditAccount=c.AccountID or c.AccountID=0)":400==c&&(s+=" and (a.CostCenterID=c.DocumentID or c.DocumentID=1)")}})),this.ScreenObject.LockWhere=""!=r?'<XML where="'+s+'" join="'+r+'"></XML>':s);case 5:case"end":return e.stop()}}),e,this)})))}},{key:"UpdateActionSummary",value:function(){var e=this;if(Logger.InfoLog("PostedDocumentViewModel:: Inside UpdateActionSummary()  "),this.dtTmp=[],this.dtTmp=this.PstDocGrid.Table,this.ActionSummary="",Logger.InfoLog("PDC Rows Count :: "+this.dtTmp.length+" Actions Count :: "+this.dtActions.length),null!=this.dtActions&&this.dtActions.length>0){for(var t=0,n="",i=1,s=null,r=function(r){t=0,n="Action_Key='"+e.dtActions[r].Name.toString()+"'",t=a.e.DTComputeSUM(e.dtTmp.filter((function(t){return t.Action_Key==e.dtActions[r].Name.toString()})),"Amount",!1),s=e.dtTmp.filter((function(t){return t.Action_Key==e.dtActions[r].Name.toString()})),Logger.InfoLog("Expression :: "+n+" Length : "+s.length),0!=t&&(e.ActionSummary+=e.dtActions[r].Name.toString()+" ( "+s.length+" )  : "+t.ToString("N"+o.a.SessionManager.Preferences.DecimalsinAmount)+"\t",i%2==0&&(e.ActionSummary+="\r\n"),i++)},l=0;l<this.dtActions.length;l++)r(l);Logger.InfoLog("Action Summary :: "+this.ActionSummary)}Logger.InfoLog("PostedDocumentViewModel:: End UpdateActionSummary()  ")}},{key:"OnEditend",value:function(e){this.PstDocGrid.TableColumns.Contains("Penalty")&&!a.e.IsEmpty(o.a.SessionManager.Preferences.PenaltyFormula.Trim())&&"DataGridPactComboBoxColumn"==e.column.className&&"Action"==e.column.DataGridColumn.SelectedValueBinding&&this.UpdateAction(e.item)}},{key:"UpdateAction",value:function(e){if(a.e.IsEmpty(e.Action)||"0"!=e.Action.toString())Object.keys(e).Contains("Penalty")&&(e.Penalty=null);else{var t=new v.a,n=new M.c;n.setFieldDetails("Amount",1,1,"",1,!1,!1),t.push("Amount",n);var i=t;t.Amount.setFieldValue(e.Amount.toString());var s=o.a.eval.EvaluateExpression(o.a.SessionManager.Preferences.PenaltyFormula,i).toString();a.e.DoubleTryParse(s.toString()),null!=s&&"Infinity"!=s.toString()&&"-Infinity"!=s.toString()&&"NaN"!=s.toString()&&a.e.DoubleTryParse(s.toString())&&(e.Penalty=s.toString())}this.UpdateActionSummary()}},{key:"OnBeginEdit",value:function(e){var t=e.args;if(Logger.InfoLog("PostedDocumentViewModel:: Inside OnBeginEdit"),"DataGridPactComboBoxColumn"==t.column.className){if("Action"==t.model.SelectedValueBinding){var n=t.item;if(""!=n.StatusID.toString()&&452==parseInt(n.StatusID.toString()))return void(t.Cancel=!0);t.column.internalColumnEditor.collection.ItemsSource=t.column.DgCol.ComboData,t.column.internalColumnEditor.collection.ItemsSource=a.e.IsEmpty(n.StatusID)||370!=parseInt(n.StatusID.toString())?a.e.IsEmpty(n.StatusID)||439!=parseInt(n.StatusID.toString())?a.e.IsEmpty(n.StatusID)||369!=parseInt(n.StatusID.toString())?!a.e.IsEmpty(n.StatusID)&&429==parseInt(n.StatusID.toString())&&a.e.hasprop(n,"AdjCnt")&&!a.e.IsEmpty(n.AdjCnt)&&parseInt(n.AdjCnt.toString())>0?t.column.DgCol.ComboData.filter((function(e){return"false"==e})):a.e.IsEmpty(n.StatusID)||376!=parseInt(n.StatusID.toString())?t.column.DgCol.ComboData.filter((function(e){return 2==e.Value||100==e.Value})):t.column.DgCol.ComboData.filter((function(e){return"false"==e})):t.column.DgCol.ComboData.filter((function(e){return 2==e.Value||0==e.Value||4==e.Value||5==e.Value||100==e.Value})):t.column.DgCol.ComboData.filter((function(e){return 1==e.Value||0==e.Value||100==e.Value})):t.column.DgCol.ComboData.filter((function(e){return 1==e.Value||0==e.Value||4==e.Value||5==e.Value||3==e.Value||100==e.Value}))}}else if("DataGridDateColumn"==t.column.className){var i=t.column.internalColumnEditor.collection.SelectedValueBinding,s=t.Item;if(""!=s.StatusID.toString()&&452==parseInt(s.StatusID.toString()))return void(t.Cancel=!0);if("clrDate_Key"==i){if(a.e.IsEmpty(s.Action)||1!=parseInt(s.Action.toString())&&0!=parseInt(s.Action.toString())&&4!=parseInt(s.Action.toString())&&5!=parseInt(s.Action.toString()))return void(t.Cancel=!0)}else if("HoldDate_Key"==i&&"370"!=t.item.StatusID.toString())return void(t.Cancel=!0)}else if("DataGridPactListBoxColumn"==t.column.className){var r=t.column.internalColumnEditor.collection,l=r.SelectedValueBinding,c=t.Item;if(!a.e.IsEmpty(c.StatusID)&&452==parseInt(c.StatusID.toString()))return void(t.Cancel=!0);if(!a.e.IsEmpty(c.BankIDs))return void(t.Cancel=!0);if(!a.e.IsEmpty(c.StatusID)&&439==parseInt(c.StatusID.toString()))return void(t.Cancel=!0);if("19"!=c.DocumentType.toString()&&!o.a.SessionManager.IsActionAssigned(43,"PDPBankChange"))return void(t.Cancel=!0);if("HoldDimension_Key"==l&&"370"!=c.StatusID.toString())return void(t.Cancel=!0);2==r.CostCenterID&&(this.PstDocGrid.TableColumns.Contains("dcCCNID1")&&!a.e.IsEmpty(c.dcCCNID1)&&parseInt(c.dcCCNID1.toString())>0&&(r.DivisionID=parseInt(c.dcCCNID1.toString())),this.PstDocGrid.TableColumns.Contains("dcCCNID2")&&!a.e.IsEmpty(c.dcCCNID2)&&parseInt(c.dcCCNID2.toString())>0&&(r.LocationID=parseInt(c.dcCCNID2.toString())))}Logger.InfoLog("PostedDocumentViewModel:: Exiting OnBeginEdit")}},{key:"InitColumns",value:function(){var e=this;Logger.InfoLog("PostedDocumentViewModel:: Inside InitColumns");var t=[];t.Columns=[],t.Columns.push("Name"),t.Columns.push("Value"),t.Columns.push("Status");var n,s=[];s.Name="",s.Value=100,t.push(s),o.a.SessionManager.IsActionAssigned(4e4,"Convert")&&((s=[]).Name=o.a.GetResource("Pdc_Convert"),s.Value=1,t.push(s)),o.a.SessionManager.IsActionAssigned(4e4,"UnConvert")&&((s=[]).Name=o.a.GetResource("Pdc_unConvert"),s.Value=2,t.push(s)),o.a.SessionManager.IsActionAssigned(4e4,"Bounce")&&((s=[]).Name=o.a.GetResource("DocumentDesigner_Bounce"),s.Value=0,t.push(s)),o.a.SessionManager.IsActionAssigned(4e4,"Replace")&&((s=[]).Name=o.a.GetResource("Replace"),s.Value=4,t.push(s),(s=[]).Name=o.a.GetResource("ReplacePartial"),s.Value=5,t.push(s)),o.a.SessionManager.IsActionAssigned(4e4,"Cancel")&&((s=[]).Name="Cancel",s.Value=3,t.push(s)),this.dtActions=[],this.dtActions=t.filter((function(e){return""!=e.Name})),this.IsPDCHoldDimension=!1,o.a.SessionManager.Preferences.ContainsKey("PDCHoldDimension")&&!a.e.IsEmpty(o.a.SessionManager.Preferences.PDCHoldDimension)&&o.a.SessionManager.Preferences.PDCHoldDimension.length>1&&(this.IsPDCHoldDimension=!0),this.PstDocGrid=new T.a,this.PstDocGrid.CanUserSortColumns=!0,this.PstDocGrid.Columns=[],this.PstDocGrid.Width="",this.PstDocGrid.CalcTotalsOnDataView=!0;var r=[],l=[];if(o.a.SessionManager.Preferences.ContainsKey("PDC Screen Widths")&&""!=o.a.SessionManager.Preferences["PDC Screen Widths"]){var c=new a.f;c.LoadXml(o.a.SessionManager.Preferences["PDC Screen Widths"]);for(var u=0;u<c.DocumentElement.childNodes.length;u++){var D=c.DocumentElement.children[u];(n=new L.a).Header=D.attributes.Header.value,n.DisplayMember=D.attributes.Name.value,n.DisplayIndex=parseInt(D.attributes.index.value),n.Width=parseInt(D.attributes.WIDTH.value),r.push(n)}}(n=new L.a).Header=o.a.GetResource("DocumentDesigner_Sno"),n.DisplayMember="Sno",n.ReadOnly=!0,n.IsFrozen=!0,n.Width=45;var d=r.filter((function(e){return e.DisplayMember==n.DisplayMember}));null!=d?(n.DisplayIndex=d.DisplayIndex,n.Width=d.Width):r.length>0&&(n.IsVisible=!1),l.push(n),(n=new L.a).Header=o.a.GetResource("DocumentDesigner_VoucherNo"),n.DisplayMember="VoucherNo",n.DataType="LINK",n.Click.Subscribe(this,"onClick"),n.ReadOnly=!0,n.IsFrozen=!0,n.Width=100,null!=(d=r.filter((function(e){return e.DisplayMember==n.DisplayMember})))?(n.DisplayIndex=d.DisplayIndex,n.Width=d.Width):r.length>0&&(n.IsVisible=!1),l.push(n),(n=new L.a).Header=o.a.GetResource("DocumentDesigner_VoucherDate"),n.DisplayMember="DocDateFormat",n.ReadOnly=!0,n.DataType="DATE",n.Width=80,null!=(d=r.filter((function(e){return e.DisplayMember==n.DisplayMember})))?(n.DisplayIndex=d.DisplayIndex,n.Width=d.Width):r.length>0&&(n.IsVisible=!1),l.push(n),(n=new L.a).Header=o.a.GetResource("DocumentDesigner_Account"),n.DisplayMember="AccountID",n.ValueMember="AccountID_Key",n.ReadOnly=!0,n.Width=150,null!=(d=r.filter((function(e){return e.DisplayMember==n.DisplayMember})))?(n.DisplayIndex=d.DisplayIndex,n.Width=d.Width):r.length>0&&(n.IsVisible=!1),l.push(n),(n=new L.a).Header=o.a.GetResource("DocumentDesigner_ChequeNo"),n.DisplayMember="ChequeNumber",n.ReadOnly=!0,n.Width=100,null!=(d=r.filter((function(e){return e.DisplayMember==n.DisplayMember})))?(n.DisplayIndex=d.DisplayIndex,n.Width=d.Width):r.length>0&&(n.IsVisible=!1),l.push(n),(n=new L.a).Header=o.a.GetResource("Service_ChequeDate"),n.DisplayMember="ChequeDateFormat",n.ReadOnly=!0,n.DataType="DATE",n.Width=80,null!=(d=r.filter((function(e){return e.DisplayMember==n.DisplayMember})))?(n.DisplayIndex=d.DisplayIndex,n.Width=d.Width):r.length>0&&(n.IsVisible=!1),l.push(n),(n=new L.a).Header=o.a.GetResource("DocumentDesigner_Amount"),n.DisplayMember="Amount",n.ReadOnly=!0,n.DataType="FLOAT",n.DecimalPoints=o.a.SessionManager.Preferences.DecimalsinAmount,n.Width=100,n.IsCalculated=1,n.ShowTotal=!0,null!=(d=r.filter((function(e){return e.DisplayMember==n.DisplayMember})))?(n.DisplayIndex=d.DisplayIndex,n.Width=d.Width):r.length>0&&(n.IsVisible=!1),l.push(n),(n=new L.a).Header=o.a.GetResource("DocumentDesigner_MaturityDate"),n.DisplayMember="MaturityDateFormat",n.ReadOnly=!0,n.DataType="DATE",n.Width=80,null!=(d=r.filter((function(e){return e.DisplayMember==n.DisplayMember})))?(n.DisplayIndex=d.DisplayIndex,n.Width=d.Width):r.length>0&&(n.IsVisible=!1),l.push(n),(n=new L.a).Header=o.a.GetResource("DocumentDesigner_Bank"),n.DisplayMember="BankAccountID",n.ValueMember="BankAccountID_Key",n.DataType="LISTBOX",n.CostCenterID=2,a.e.IntTryParse(o.a.SessionManager.Preferences.PDCAccountListView),n.TypeID=o.a.SessionManager.Preferences.ContainsKey("PDCAccountListView")&&a.e.IntTryParse(o.a.SessionManager.Preferences.PDCAccountListView)?parseInt(o.a.SessionManager.Preferences.PDCAccountListView):51,n.Width=150,null!=(d=r.filter((function(e){return e.DisplayMember==n.DisplayMember})))?(n.DisplayIndex=d.DisplayIndex,n.Width=d.Width):r.length>0&&(n.IsVisible=!1),l.push(n),(n=new L.a).Header=o.a.GetResource("Ren_CntrctPayee"),n.DisplayMember="ChequeBankName",n.ReadOnly=!0,n.Width=100,null!=(d=r.filter((function(e){return e.DisplayMember==n.DisplayMember})))?(n.DisplayIndex=d.DisplayIndex,n.Width=d.Width):r.length>0&&(n.IsVisible=!1),l.push(n);var h=new a.f;h.LoadXml(o.a.SessionManager.Preferences["PDC Customize Screen"]);for(var g=0;g<h.DocumentElement.children.length;g++){var m=h.DocumentElement.children[g];"DIM"==m.attributes.Type.value?((n=new L.a).Header=m.attributes.Header.value,n.DisplayMember="DIM"+m.attributes.ID.value,n.ReadOnly=!0,n.Width=100,null!=(d=r.filter((function(e){return e.DisplayMember==n.DisplayMember})))?(n.DisplayIndex=d.DisplayIndex,n.Width=d.Width):r.length>0&&(n.IsVisible=!1),l.push(n)):"FLD"==m.attributes.Type.value&&((n=new L.a).Header=m.attributes.Header.value,n.DisplayMember=m.attributes.ID.value,n.ReadOnly=!0,n.Width=150,null!=(d=r.filter((function(e){return e.DisplayMember==n.DisplayMember})))?(n.DisplayIndex=d.DisplayIndex,n.Width=d.Width):r.length>0&&(n.IsVisible=!1),l.push(n))}if((n=new L.a).Header=o.a.GetResource("DocumentDesigner_Action"),n.ValueBinding="Action",n.DataType="PactComboBox",n.DisplayMember="Name",n.ValueMember="Value",n.Width=70,n.ComboData=t,null!=(d=r.filter((function(e){return e.DisplayMember==n.ValueBinding})))?(n.DisplayIndex=d.DisplayIndex,n.Width=d.Width):r.length>0&&(n.IsVisible=!1),l.push(n),o.a.SessionManager.Preferences.ContainsKey("PostPenalty")&&"true"==o.a.SessionManager.Preferences.PostPenalty.toLowerCase()){var b=n.DisplayIndex;(n=new L.a).Header="Penalty",n.DisplayMember="Penalty",o.a.SessionManager.IsActionAssigned(4e4,"EditPenalty")||(n.ReadOnly=!0),n.DataType="FLOAT",n.DecimalPoints=o.a.SessionManager.Preferences.DecimalsinAmount,n.Width=100,n.IsCalculated=1,n.ShowTotal=!0,null!=(d=r.filter((function(e){return e.DisplayMember==n.DisplayMember})))?(n.DisplayIndex=d.DisplayIndex,n.Width=d.Width):n.DisplayIndex=b+1,l.push(n)}(n=new L.a).Header=o.a.GetResource("DocumentDesigner_ConvertOn"),n.DisplayMember="clrDate",n.ValueMember="clrDate_Key",n.DataType="DATE",n.ReadOnly=!1,n.Width=90,null!=(d=r.filter((function(e){return e.DisplayMember==n.DisplayMember})))?(n.DisplayIndex=d.DisplayIndex,n.Width=d.Width):r.length>0&&(n.IsVisible=!1),l.push(n),(n=new L.a).Header=o.a.GetResource("DocumentDesigner_Status"),n.DisplayMember="Status",n.ReadOnly=!0,n.Width=100,null!=(d=r.filter((function(e){return e.DisplayMember==n.DisplayMember})))?(n.DisplayIndex=d.DisplayIndex,n.Width=d.Width):r.length>0&&(n.IsVisible=!1),l.push(n),(n=new L.a).Header=o.a.GetResource("PDC_DocNo"),n.DisplayMember="ConvertedDocNo",n.ReadOnly=!0,n.Width=120,n.DataType="LINK",n.Click.Subscribe(this,"OnDocLink"),null!=(d=r.filter((function(e){return e.DisplayMember==n.DisplayMember})))?(n.DisplayIndex=d.DisplayIndex,n.Width=d.Width):r.length>0&&(n.IsVisible=!1),l.push(n),(n=new L.a).Header="User",n.DisplayMember="ConvertedDocUser",n.ReadOnly=!0,n.Width=120,n.DataType="LINK",n.Click.Subscribe(this,"OnDocLink"),null!=(d=r.filter((function(e){return e.DisplayMember==n.DisplayMember})))?(n.DisplayIndex=d.DisplayIndex,n.Width=d.Width):r.length>0&&(n.IsVisible=!1),l.push(n),(n=new L.a).Header="Date",n.DisplayMember="ConvertedDocDate_Key",n.ReadOnly=!0,n.Width=120,n.DataType="LINK",n.Click.Subscribe(this,"OnDocLink"),null!=(d=r.filter((function(e){return"ConvertedDocDate"==e.DisplayMember})))?(n.DisplayIndex=d.DisplayIndex,n.Width=d.Width):r.length>0&&(n.IsVisible=!1),l.push(n),(n=new L.a).Header=o.a.GetResource("PDC_InterDocNo"),n.DisplayMember="InterMediateVoucherNO",n.ReadOnly=!0,n.Width=120,n.DataType="LINK",n.Click.Subscribe(this,"OnInterDocLink"),null!=(d=r.filter((function(e){return e.DisplayMember==n.DisplayMember})))?(n.DisplayIndex=d.DisplayIndex,n.Width=d.Width):r.length>0&&(n.IsVisible=!1),l.push(n),(n=new L.a).Header="User",n.DisplayMember="InterMediateDocUser",n.ReadOnly=!0,n.Width=120,n.DataType="LINK",n.Click.Subscribe(this,"OnDocLink"),null!=(d=r.filter((function(e){return e.DisplayMember==n.DisplayMember})))?(n.DisplayIndex=d.DisplayIndex,n.Width=d.Width):r.length>0&&(n.IsVisible=!1),l.push(n),(n=new L.a).Header="Date",n.DisplayMember="InterMediateDocDate_Key",n.ReadOnly=!0,n.Width=120,n.DataType="LINK",n.Click.Subscribe(this,"OnDocLink"),null!=(d=r.filter((function(e){return"InterMediateDocDate"==e.DisplayMember})))?(n.DisplayIndex=d.DisplayIndex,n.Width=d.Width):r.length>0&&(n.IsVisible=!1),l.push(n),(n=new L.a).Header="Bounced Doc No",n.DisplayMember="BouncedVoucher",n.ReadOnly=!0,n.Width=110,n.DataType="LINK",n.Click.Subscribe(this,"OnBouncedDocLink"),null!=(d=r.filter((function(e){return e.DisplayMember==n.DisplayMember})))?(n.DisplayIndex=d.DisplayIndex,n.Width=d.Width):r.length>0&&(n.IsVisible=!1),l.push(n),(n=new L.a).Header="User",n.DisplayMember="BouncedDocUser",n.ReadOnly=!0,n.Width=120,n.DataType="LINK",n.Click.Subscribe(this,"OnDocLink"),null!=(d=r.filter((function(e){return e.DisplayMember==n.DisplayMember})))?(n.DisplayIndex=d.DisplayIndex,n.Width=d.Width):r.length>0&&(n.IsVisible=!1),l.push(n),(n=new L.a).Header="Date",n.DisplayMember="BouncedDocDate_Key",n.ReadOnly=!0,n.Width=120,n.DataType="LINK",n.Click.Subscribe(this,"OnDocLink"),null!=(d=r.filter((function(e){return"BouncedDocDate"==e.DisplayMember})))?(n.DisplayIndex=d.DisplayIndex,n.Width=d.Width):r.length>0&&(n.IsVisible=!1),l.push(n),this.IsPDCHoldDimension&&((n=new L.a).DataType="LISTBOX",n.Header="Hold Dimension",n.ValueMember="HoldDimension_Key",n.DisplayMember="HoldDimension",n.CostCenterID=parseInt(o.a.SessionManager.Preferences.PDCHoldDimension),null!=(d=r.filter((function(e){return"HoldDimension"==e.DisplayMember})))?(n.DisplayIndex=d.DisplayIndex,n.Width=d.Width):(n.DisplayIndex=l.length,n.Width=120),l.push(n),o.a.SessionManager.Preferences.PDCHoldDate.length>0&&((n=new L.a).Header="Hold Date",n.DisplayMember="HoldDate",n.ValueMember="HoldDate_Key",n.DataType="DATE",n.ReadOnly=!1,null!=(d=r.filter((function(e){return"HoldDate"==e.DisplayMember})))?(n.DisplayIndex=d.DisplayIndex,n.Width=d.Width):(n.DisplayIndex=l.length,n.Width=90),l.push(n)),o.a.SessionManager.Preferences.PDCHoldRemarks.length>0&&((n=new L.a).Header="Hold Remarks",n.DisplayMember="HoldRemarks",n.ReadOnly=!1,null!=(d=r.filter((function(e){return"HoldRemarks"==e.DisplayMember})))?(n.DisplayIndex=d.DisplayIndex,n.Width=d.Width):(n.DisplayIndex=l.length,n.Width=140),l.push(n))),l.sort((function(e,t){return e.DisplayIndex-t.DisplayIndex})).forEach((function(t){e.PstDocGrid.Columns.push(t)})),this.PstDocGrid.SearchVisible=!0,this.PstDocGrid.FilterVisible=!0,this.PstDocGrid.SearchColStartIndex=1,this.PstDocGrid.AddSearchCols(),i.SetDimensionQuery(),Logger.InfoLog("PostedDocumentViewModel:: Exiting InitColumns")}},{key:"onClick",value:function(){return Object(s.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,i,s,r,l,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e(2),n.e(1),n.e(3),n.e(5),n.e(4),n.e(6),n.e(7),n.e(10),n.e(9),n.e(12),n.e(11),n.e(13),n.e(19),n.e(15),n.e(21),n.e(20),n.e(16),n.e(14),n.e(18),n.e(17),n.e(22),n.e(148)]).then(n.bind(null,"1Cra"));case 2:return t=e.sent,i=t.AddEditDocumentViewModel,e.next=6,Promise.all([n.e(4),n.e(6)]).then(n.bind(null,"MCKn"));case 6:s=e.sent,r=s.AddEditDocumentComponent,Logger.InfoLog("PostedDocumentViewModel:: Inside onClick"),null==this.PstDocGrid.SelectedItem||a.e.IsEmpty(this.PstDocGrid.SelectedItem.CostCenterID)||(l=new i(parseInt(this.PstDocGrid.SelectedItem.CostCenterID),"",!0),c={},Object.assign(c,{component:r,params:{obj:l}}),c.title=l.ScreenName,o.a.page.addNewTab(c),o.a.page.setActiveTab(o.a.page.indexOf(l)),l.ScreenObject.DocPrefix.ComboBox.SelectedValue=this.PstDocGrid.SelectedItem.DocPrefix.toString(),l.ScreenObject.DocPrefix.TextBox.Text=this.PstDocGrid.SelectedItem.DocNumber.toString(),l.OnDocPrefixChanged("lostFocus"),l.ScreenObject.FillDocumentPrefix(!0)),Logger.InfoLog("PostedDocumentViewModel:: Exiting onClick");case 10:case"end":return e.stop()}}),e,this)})))}},{key:"OnDocLink",value:function(e){return Object(s.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,i,s,r,l,c,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e(2),n.e(1),n.e(3),n.e(5),n.e(4),n.e(6),n.e(7),n.e(10),n.e(9),n.e(12),n.e(11),n.e(13),n.e(19),n.e(15),n.e(21),n.e(20),n.e(16),n.e(14),n.e(18),n.e(17),n.e(22),n.e(148)]).then(n.bind(null,"1Cra"));case 2:return t=e.sent,i=t.AddEditDocumentViewModel,e.next=6,Promise.all([n.e(4),n.e(6)]).then(n.bind(null,"MCKn"));case 6:if(s=e.sent,r=s.AddEditDocumentComponent,Logger.InfoLog("PostedDocumentViewModel:: Inside OnDocLink"),null!=this.PstDocGrid.SelectedItem&&!a.e.IsEmpty(this.PstDocGrid.SelectedItem.ConvertedDocNo))try{null!=(l=this.ScreenObject.GetDocDetailsByAccID(parseInt(this.PstDocGrid.SelectedItem.ConvertedAccDocID.toString())))&&l.Tables.length>0&&l.Tables[0].length>0&&(c=new i(parseInt(l.Tables[0][0].CCID),l.Tables[0][0].ResourceData.toString(),!0),u={},Object.assign(u,{component:r,params:{obj:c}}),u.title=c.ScreenName,o.a.page.addNewTab(u),o.a.page.setActiveTab(o.a.page.indexOf(c)),c.ScreenObject.DocPrefix.ComboBox.SelectedValue=l.Tables[0][0].Prefix.toString(),c.ScreenObject.DocPrefix.TextBox.Text=l.Tables[0][0].DocNumber.toString(),c.OnDocPrefixChanged("lostFocus"),c.ScreenObject.FillDocumentPrefix(!0))}catch(D){Logger.ErrorLog("PostedDocumentViewModel","OnLinkClickEvent",D.Message)}Logger.InfoLog("PostedDocumentViewModel:: Exiting OnDocLink");case 10:case"end":return e.stop()}}),e,this)})))}},{key:"OnInterDocLink",value:function(e){return Object(s.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,i,s,r,l,c,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e(2),n.e(1),n.e(3),n.e(5),n.e(4),n.e(6),n.e(7),n.e(10),n.e(9),n.e(12),n.e(11),n.e(13),n.e(19),n.e(15),n.e(21),n.e(20),n.e(16),n.e(14),n.e(18),n.e(17),n.e(22),n.e(148)]).then(n.bind(null,"1Cra"));case 2:return t=e.sent,i=t.AddEditDocumentViewModel,e.next=6,Promise.all([n.e(4),n.e(6)]).then(n.bind(null,"MCKn"));case 6:if(s=e.sent,r=s.AddEditDocumentComponent,Logger.InfoLog("PostedDocumentViewModel:: Inside OnInterDocLink"),null!=this.PstDocGrid.SelectedItem&&!a.e.IsEmpty(this.PstDocGrid.SelectedItem.InterMediateVoucherNO))try{null!=(l=this.ScreenObject.GetDocDetailsByAccID(parseInt(this.PstDocGrid.SelectedItem.InterMediateDocID.toString())))&&l.Tables.length>0&&l.Tables[0].length>0&&(c=new i(parseInt(l.Tables[0][0].CCID),l.Tables[0][0].ResourceData.toString(),!0),u={},Object.assign(u,{component:r,params:{obj:c}}),u.title=c.ScreenName,o.a.page.addNewTab(u),o.a.page.setActiveTab(o.a.page.indexOf(c)),c.ScreenObject.DocPrefix.ComboBox.SelectedValue=l.Tables[0][0].Prefix.toString(),c.ScreenObject.DocPrefix.TextBox.Text=l.Tables[0][0].DocNumber.toString(),c.OnDocPrefixChanged("lostFocus"),c.ScreenObject.FillDocumentPrefix(!0))}catch(D){Logger.ErrorLog("PostedDocumentViewModel","OnLinkClickEvent",D.Message)}Logger.InfoLog("PostedDocumentViewModel:: Exiting OnInterDocLink");case 10:case"end":return e.stop()}}),e,this)})))}},{key:"OnBouncedDocLink",value:function(e){return Object(s.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,i,s,r,l,c,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e(2),n.e(1),n.e(3),n.e(5),n.e(4),n.e(6),n.e(7),n.e(10),n.e(9),n.e(12),n.e(11),n.e(13),n.e(19),n.e(15),n.e(21),n.e(20),n.e(16),n.e(14),n.e(18),n.e(17),n.e(22),n.e(148)]).then(n.bind(null,"1Cra"));case 2:return t=e.sent,i=t.AddEditDocumentViewModel,e.next=6,Promise.all([n.e(4),n.e(6)]).then(n.bind(null,"MCKn"));case 6:if(s=e.sent,r=s.AddEditDocumentComponent,Logger.InfoLog("PostedDocumentViewModel:: Inside OnBouncedDocLink"),null!=this.PstDocGrid.SelectedItem&&!a.e.IsEmpty(this.PstDocGrid.SelectedItem.BouncedVoucher))try{null!=(l=this.ScreenObject.GetDocDetailsByAccID(parseInt(this.PstDocGrid.SelectedItem.BouncedVoucherDocID.toString())))&&l.Tables.length>0&&l.Tables[0].length>0&&(c=new i(parseInt(l.Tables[0][0].CCID),l.Tables[0][0].ResourceData.toString(),!0),u={},Object.assign(u,{component:r,params:{obj:c}}),u.title=c.ScreenName,o.a.page.addNewTab(u),o.a.page.setActiveTab(o.a.page.indexOf(c)),c.ScreenObject.DocPrefix.ComboBox.SelectedValue=l.Tables[0][0].Prefix.toString(),c.ScreenObject.DocPrefix.TextBox.Text=l.Tables[0][0].DocNumber.toString(),c.OnDocPrefixChanged("lostFocus"),c.ScreenObject.FillDocumentPrefix(!0))}catch(D){Logger.ErrorLog("PostedDocumentViewModel","OnLinkClickEvent",D.Message)}Logger.InfoLog("PostedDocumentViewModel:: Exiing OnBouncedDocLink");case 10:case"end":return e.stop()}}),e,this)})))}},{key:"LoadData",value:function(){this.ActionSummary="",Logger.InfoLog("PostedDocumentViewModel:: Inside LoadData");var e=0;this.ForeignCurrency.CheckBox.IsChecked&&(e=a.e.IntTryParse(this.ForeignCurrency.ComboBox.SelectedValue));var t=[];t.push(this.FilterOn),t.push(this.SortOn),t.push(this.FromDate.ToString("dd/MMM/yyyy")),t.push(this.ToDate.ToString("dd/MMM/yyyy")),t.push(e),t.push(this.Locations),t.push(this.Divisions),t.push(this.Dimensions),t.push(this.BankID),t.push("1"==this.Status||"2"==this.Status?"429":this.Status),t.push(this.Filter),t.push(i.strSelect),t.push(i.strJoin),t.push(this.DocumentPicked);var n="";"1"==this.Status||"2"==this.Status?n=" and D.BillDate is not null and D.BillDate="+this.Status:"429"==this.Status&&(n=" and (D.BillDate is null or D.BillDate not in(1,2)) "),this.HoldDimFilter>0&&(n+=" and L.dcCCNID"+(parseInt(o.a.SessionManager.Preferences.PDCHoldDimension)-5e4)+"="+this.HoldDimFilter),this.TreeWhere.length>0&&(n+=this.TreeWhere),t.push(n);var s=o.a.document.GetPDCDocuments(t);this.LoadDashData(s),this.DateText=this.FromDate.ToString(o.a.SessionManager.Preferences["Date Format"])+"  -  "+this.ToDate.ToString(o.a.SessionManager.Preferences["Date Format"]),this.MessageVisibility=!1,Logger.InfoLog("PostedDocumentViewModel:: Exiting LoadData")}},{key:"LoadDashData",value:function(e){var t=e.Tables[0];if(Logger.InfoLog("PostedDocumentViewModel:: Inside LoadDashData"),null!=t){e.Columns[0].Contains("Sno")||(e.Columns[0].push("Sno"),e.Columns[0].push("DocDateFormat"),e.Columns[0].push("MaturityDateFormat"),e.Columns[0].push("ChequeDateFormat"),e.Columns[0].push("clrDate"),e.Columns[0].push("clrDate_Key"),e.Columns[0].push("Action"),e.Columns[0].push("Action_Key"),e.Columns[0].push("StatusForDisplay"),e.Columns[0].push("ConvertedDocNo"),e.Columns[0].push("ConvertedAccDocID"),e.Columns[0].push("ConvertedDocDate_Key"),e.Columns[0].push("InterMediateDocDate_Key"),e.Columns[0].push("BouncedDocDate_Key"),e.Columns[0].Contains("InterMediateVoucherNO")||e.Columns[0].push("InterMediateVoucherNO"),e.Columns[0].Contains("InterMediateDocID")||e.Columns[0].push("InterMediateDocID"),e.Columns[0].push("AccIDs"),e.Columns[0].push("BankIDs"),e.Columns[0].push("GroupIDs"),e.Columns[0].Contains("ConvertedDocDate")||e.Columns[0].push("ConvertedDocDate"),e.Columns[0].Contains("InterMediateDocDate")||e.Columns[0].push("InterMediateDocDate"),o.a.SessionManager.Preferences.ContainsKey("PostPenalty")&&"true"==o.a.SessionManager.Preferences.PostPenalty.toLowerCase()&&e.Columns[0].push("Penalty"),this.IsPDCHoldDimension&&!e.Columns[0].Contains("HoldDimension")&&(e.Columns[0].push("HoldDimension"),e.Columns[0].push("HoldDimension_Key"),e.Columns[0].push("HoldDate"),e.Columns[0].push("HoldDate_Key"),e.Columns[0].push("HoldRemarks")));for(var n=0;n<=t.length-1;n++){a.e.IsEmpty(t[n].DocDate)||(t[n].DocDateFormat=o.a.SessionManager.Preferences.ContainsKey("Date Format")&&""!=o.a.SessionManager.Preferences["Date Format"]?new Date(t[n].DocDate.toString()).ToString(o.a.SessionManager.Preferences["Date Format"]):new Date(t[n].DocDate.toString()).ToString("dd/MMM/yyyy")),a.e.IsEmpty(t[n].ChequeMaturityDate)||(t[n].MaturityDateFormat=o.a.SessionManager.Preferences.ContainsKey("Date Format")&&""!=o.a.SessionManager.Preferences["Date Format"]?new Date(t[n].ChequeMaturityDate.toString()).ToString(o.a.SessionManager.Preferences["Date Format"]):new Date(t[n].ChequeMaturityDate.toString()).ToString("dd/MMM/yyyy")),e.Columns[0].Contains("ChequeDate")&&!a.e.IsEmpty(t[n].ChequeDate)&&(t[n].ChequeDateFormat=o.a.SessionManager.Preferences.ContainsKey("Date Format")&&""!=o.a.SessionManager.Preferences["Date Format"]?new Date(t[n].ChequeDate.toString()).ToString(o.a.SessionManager.Preferences["Date Format"]):new Date(t[n].ChequeDate.toString()).ToString("dd/MMM/yyyy")),this.IsPDCHoldDimension&&(e.Columns[0].Contains("HoldDate_Key")&&null!=t[n].HoldDate_Key&&(t[n].HoldDate=new Date(t[n].HoldDate_Key).ToString(o.a.SessionManager.Preferences["Date Format"])),e.Columns[0].Contains("HoldDimension_Old")||e.Columns[0].push("HoldDimension_Old"),t[n].HoldDimension_Old=t[n].HoldDimension_Key),t[n].Sno=n+1,a.e.IsEmpty(t[n].BillDate)||(t[n].clrDate_Key=this.PostonconversionDate?new Date:new Date(t[n].BillDate)),"429"==t[n].StatusID.toString()&&(e.Columns[0].Contains("BillNo")&&"1"==t[n].BillNo.toString()?t[n].Status=o.a.GetResource("Replaced"):e.Columns[0].Contains("BillNo")&&"2"==t[n].BillNo.toString()&&(t[n].Status=o.a.GetResource("ReplacedPartial")));try{"PDC"==t[n].Status.toString()&&(this.PostonconversionDate?t[n].clrDate=o.a.SessionManager.Preferences.ContainsKey("Date Format")&&""!=o.a.SessionManager.Preferences["Date Format"]?(new Date).ToString(o.a.SessionManager.Preferences["Date Format"]):(new Date).ToString("dd/MMM/yyyy"):a.e.IsEmpty(t[n].BillDate.toString())||(t[n].clrDate=o.a.SessionManager.Preferences.ContainsKey("Date Format")&&""!=o.a.SessionManager.Preferences["Date Format"]?new Date(t[n].BillDate.toString()).ToString(o.a.SessionManager.Preferences["Date Format"]):new Date(t[n].BillDate.toString()).ToString("dd/MMM/yyyy")))}catch(D){Logger.ErrorLog("PostedDocumentViewModel","LoadDashData",D.Message)}if("True"==t[n].IsNegative.toString()){var i=t[n].BankAccountID_Key.toString(),s=t[n].BankAccountID.toString();t[n].BankAccountID_Key=t[n].AccountID_Key.toString(),t[n].BankAccountID=t[n].AccountID.toString(),t[n].AccountID_Key=i,t[n].AccountID=s}!e.Columns[0].Contains("DocumentType")||a.e.IsEmpty(t[n].DocumentType)||16!=parseInt(t[n].DocumentType.toString())&&19!=parseInt(t[n].DocumentType.toString())&&14!=parseInt(t[n].DocumentType.toString())||e.Columns[0].Contains("BankID")&&!a.e.IsEmpty(t[n].BankID)&&parseInt(t[n].BankID.toString())>0&&(t[n].BankAccountID_Key=parseInt(t[n].BankID.toString()),t[n].BankAccountID=t[n].BankName.toString()),e.Columns[0].Contains("ConvertedVoucherNO")&&!a.e.IsEmpty(t[n].ConvertedVoucherNO)?(t[n].ConvertedDocNo=t[n].ConvertedVoucherNO,a.e.IsEmpty(t[n].ConvertedDocDate)||(t[n].ConvertedDocDate_Key=new Date(t[n].ConvertedDocDate.toString()).ToString(o.a.SessionManager.Preferences["Date Format"]))):t[n].ConvertedDocDate_Key=null,e.Columns[0].Contains("ConvertedDocID")&&!a.e.IsEmpty(t[n].ConvertedDocID)&&(t[n].ConvertedAccDocID=t[n].ConvertedDocID),e.Columns[0].Contains("InterMediateVoucherNO")&&!a.e.IsEmpty(t[n].InterMediateVoucherNO)?(t[n].InterMediateVoucherNO=t[n].InterMediateVoucherNO,a.e.IsEmpty(t[n].InterMediateDocDate)||(t[n].InterMediateDocDate_Key=new Date(t[n].InterMediateDocDate.toString()).ToString(o.a.SessionManager.Preferences["Date Format"]))):t[n].InterMediateDocDate_Key=null,t[n].BouncedDocDate_Key=e.Columns[0].Contains("BouncedDocDate")&&!a.e.IsEmpty(t[n].BouncedDocDate)?new Date(t[n].BouncedDocDate.toString()).ToString(o.a.SessionManager.Preferences["Date Format"]):null,e.Columns[0].Contains("InterMediateDocID")&&!a.e.IsEmpty(t[n].InterMediateDocID)&&(t[n].InterMediateDocID=t[n].InterMediateDocID)}for(var r=[],l=function(n){if(!r.Contains(t[n])){var i,s=0,o="",l="",c="";if(e.Columns[0].Contains("RefNodeID")&&(i=t.filter((function(e){return 400==e.RefCCID&&e.RefNodeID==t[n].AccDocDetailsID}))).length>0){o=l=c="";for(var u=0;u<i.length;u++)o+=i[u].AccDocDetailsID.toString()+",",c+=i[u].AccountID_Key.toString()+",",l+=i[u].BankAccountID_Key.toString()+",",r.push(i[u]);return t[n].GroupIDs=o,t[n].AccIDs=c,t[n].BankIDs=l,(i=t.filter((function(e){return e.AccDocDetailsID==t[n].AccDocDetailsID.toString()}))).length>1&&(t[n]!=i[1]&&"439"==i[1].StatusID.toString()?(t[n].StatusID=i[1].StatusID,t[n].Status=i[1].Status,r.push(i[1])):t[n]==i[1]&&"439"==i[0].StatusID.toString()&&(t[n].StatusID=i[0].StatusID,t[n].Status=i[0].Status,r.push(i[0]))),"continue"}if((i=t.filter((function(e){return e.ChequeNumber==a.e.StringValue(t[n].ChequeNumber).toString().replace("'","''")&&e.VoucherNo==a.e.StringValue(t[n].VoucherNo).toString()&&e.BankAccountID_Key==a.e.StringValue(t[n].BankAccountID_Key).toString()}))).length>1){var D=new Array;D.push(parseInt(a.e.String(i[0].AccountID_Key)));for(var d=1;d<i.length;d++)a.e.IsEmpty(i[d].Amount)||("True"==i[d].IsNegative.toString()?s-=parseFloat(i[d].Amount.toString()):s+=parseFloat(i[d].Amount.toString())),o+=i[d].AccDocDetailsID.toString()+",",c+=i[d].AccountID_Key.toString()+",",D.Contains(parseInt(i[d].AccountID_Key.toString()))||(l+=i[d].AccountID.toString()+","),D.push(parseInt(i[d].AccountID_Key.toString())),r.push(i[d]);i[0].GroupIDs=o,i[0].AccIDs=c,i[0].Amount=a.e.IsEmpty(i[0].Amount)?s:parseFloat(i[0].Amount.toString())+s,i[0].AccountID=i[0].AccountID.toString()+l}}},c=0;c<t.length;c++)l(c);for(var u=0;u<r.length;u++)t.Remove(r[u]);this.PstDocGrid.Table=t,this.PstDocGrid.TableColumns=e.Columns[0],this.PstDocGrid.setRowid(),this.PstDocGrid.UpdateTotals()}Logger.InfoLog("PostedDocumentViewModel:: Exiting LoadDashData")}},{key:"ButtonSave",value:function(e){var t=this;if(Logger.InfoLog("PostedDocumentViewModel:: Inside ButtonSave sender ="+e.toString()),this.DisplayMessage="","Save"==e){for(var n="",i="",s=0;s<=this.PstDocGrid.Table.length-1;s++)if(""!=a.e.StringValue(this.PstDocGrid.Table[s].Action).toString()&&"100"!=this.PstDocGrid.Table[s].Action.toString()){var l,c=void 0;if("1"==this.PstDocGrid.Table[s].Action.toString()&&this.PstDocGrid.TableColumns.Contains("HoldDate_Key")&&!a.e.IsEmpty(this.PstDocGrid.Table[s].HoldDate_Key)&&a.e.isValidDate(this.PstDocGrid.Table[s].HoldDate_Key.toString())&&!a.e.IsEmpty(this.PstDocGrid.Table[s].clrDate_Key)&&a.e.isValidDate(this.PstDocGrid.Table[s].clrDate_Key.toString())&&new Date(this.PstDocGrid.Table[s].clrDate_Key.toString())<new Date(this.PstDocGrid.Table[s].HoldDate_Key.toString()))return c=this.PstDocGrid.Table[s].HoldDate_Key.toString(),c=this.PstDocGrid.Table[s].clrDate_Key.toString(),this.Setselectedrow(s),this.DisplayMessage="Converted date can not be less than hold date at row no:"+this.PstDocGrid.Table[s].Sno.toString(),void(this.MessageVisibility=!0);if(a.e.isValidDate(this.PstDocGrid.Table[s].clrDate_Key.toString())&&new Date(this.PstDocGrid.Table[s].clrDate_Key.toString())<o.a.SessionManager.AccountingDate)return this.Setselectedrow(s),this.DisplayMessage="Converted date can not be less than Accounting Date at row no:"+this.PstDocGrid.Table[s].Sno.toString(),void(this.MessageVisibility=!0);if(l=o.a.SessionManager.Preferences.ContainsKey("Lock Data Between"),"1"!=o.a.SessionManager.RoleID&&o.a.SessionManager.Preferences.ContainsKey("Lock Data Between")&&l&&Object(r.j)(o.a.SessionManager.Preferences["Lock Data Between"])&&a.e.isValidDate(this.PstDocGrid.Table[s].clrDate_Key.toString())&&(c=new Date(this.PstDocGrid.Table[s].clrDate_Key.toString())).Date>=new Date(o.a.SessionManager.Preferences.LockDataFromDate).Date&&c.Date<=new Date(o.a.SessionManager.Preferences.LockDataToDate).Date)return this.DisplayMessage="Document Date Locked",void(this.MessageVisibility=!0);if(""!=a.e.StringValue(this.PstDocGrid.Table[s].BankIDs).toString()){for(var u=this.PstDocGrid.Table[s].GroupIDs.toString().split(","),D=this.PstDocGrid.Table[s].AccIDs.toString().split(","),d=this.PstDocGrid.Table[s].BankIDs.toString().split(","),h=0;h<u.length-1;h++)n+='<Row ID="'+u[h]+'" ',n+=' StatusID="369" ',"4"==this.PstDocGrid.Table[s].Action.toString()?n+='ACTION="0"  IsReplace="1" ':"5"==this.PstDocGrid.Table[s].Action.toString()?n+='ACTION="0"  IsReplace="2" ':n+='ACTION="'+this.PstDocGrid.Table[s].Action.toString()+'" ',""!=a.e.StringValue(this.PstDocGrid.Table[s].clrDate_Key).toString()&&(n+='PostedDate="'+new Date(this.PstDocGrid.Table[s].clrDate_Key.toString()).ToString("dd/MMM/yyyy")+'" '),n+='CostCenterID="'+this.PstDocGrid.Table[s].CostCenterID.toString()+'" ',n+='VoucherNo="'+this.PstDocGrid.Table[s].VoucherNo.toString()+'" ',"19"==a.e.StringValue(this.PstDocGrid.Table[s].DocumentType).toString()||"16"==a.e.StringValue(this.PstDocGrid.Table[s].DocumentType).toString()?"1"==this.PstDocGrid.Table[s].Action.toString()?(n+='CreditAccountID="'+D[h]+'" ',n+='DebitAccountID="'+d[h]+'" '):(n+='CreditAccountID="'+d[h]+'" ',n+='DebitAccountID="'+D[h]+'" '):"1"==this.PstDocGrid.Table[s].Action.toString()?(n+='CreditAccountID="'+d[h]+'" ',n+='DebitAccountID="'+D[h]+'" '):(n+='DebitAccountID="'+d[h]+'" ',n+='CreditAccountID="'+D[h]+'" '),n+='ACTUAL="'+D[h]+'" ',n+="/>";continue}if(n+='<Row ID="'+this.PstDocGrid.Table[s].AccDocDetailsID.toString()+'" ',n+=' StatusID="369" ',"4"==this.PstDocGrid.Table[s].Action.toString()?n+='ACTION="0"  IsReplace="1" ':"5"==this.PstDocGrid.Table[s].Action.toString()?n+='ACTION="0"  IsReplace="2" ':n+='ACTION="'+this.PstDocGrid.Table[s].Action.toString()+'" ',""!=a.e.StringValue(this.PstDocGrid.Table[s].clrDate_Key).toString()&&(n+='PostedDate="'+new Date(this.PstDocGrid.Table[s].clrDate_Key.toString()).ToString("dd/MMM/yyyy")+'" '),n+='CostCenterID="'+this.PstDocGrid.Table[s].CostCenterID.toString()+'" ',n+='VoucherNo="'+this.PstDocGrid.Table[s].VoucherNo.toString()+'" ',"19"==a.e.StringValue(this.PstDocGrid.Table[s].DocumentType).toString()?"1"==this.PstDocGrid.Table[s].Action.toString()?(n+='CreditAccountID="'+this.PstDocGrid.Table[s].AccountID_Key.toString()+'" ',n+='DebitAccountID="'+this.PstDocGrid.Table[s].BankAccountID_Key.toString()+'" '):(n+='CreditAccountID="'+this.PstDocGrid.Table[s].BankAccountID_Key.toString()+'" ',n+='DebitAccountID="'+this.PstDocGrid.Table[s].AccountID_Key.toString()+'" ',this.PstDocGrid.TableColumns.Contains("Penalty")&&!a.e.IsEmpty(this.PstDocGrid.Table[s].Penalty)&&parseFloat(this.PstDocGrid.Table[s].Penalty.toString())>0&&(n+='Penalty="'+this.PstDocGrid.Table[s].Penalty.toString()+'" ')):"1"==this.PstDocGrid.Table[s].Action.toString()?(n+='CreditAccountID="'+this.PstDocGrid.Table[s].BankAccountID_Key.toString()+'" ',n+='DebitAccountID="'+this.PstDocGrid.Table[s].AccountID_Key.toString()+'" '):(n+='DebitAccountID="'+this.PstDocGrid.Table[s].BankAccountID_Key.toString()+'" ',n+='CreditAccountID="'+this.PstDocGrid.Table[s].AccountID_Key.toString()+'" ',this.PstDocGrid.TableColumns.Contains("Penalty")&&!a.e.IsEmpty(this.PstDocGrid.Table[s].Penalty)&&parseFloat(this.PstDocGrid.Table[s].Penalty.toString())>0&&(n+='Penalty="'+this.PstDocGrid.Table[s].Penalty.toString()+'" ')),n+='ACTUAL="'+this.PstDocGrid.Table[s].ActDr.toString()+'" ',this.IsPDCHoldDimension&&this.PstDocGrid.TableColumns.Contains("HoldDimension_Key")&&null!=this.PstDocGrid.Table[s].HoldDimension_Key&&1!=parseInt(this.PstDocGrid.Table[s].HoldDimension_Key)&&(n+='IsHold="1" '),n+="/>",""!=a.e.StringValue(this.PstDocGrid.Table[s].GroupIDs).toString())for(var g=this.PstDocGrid.Table[s].GroupIDs.toString().split(","),m=this.PstDocGrid.Table[s].AccIDs.toString().split(","),b=0;b<g.length-1;b++)n+='<Row ID="'+g[b]+'" ',n+=' StatusID="369" ',"4"==this.PstDocGrid.Table[s].Action.toString()?n+='ACTION="0"  IsReplace="1" ':"5"==this.PstDocGrid.Table[s].Action.toString()?n+='ACTION="0"  IsReplace="2" ':n+='ACTION="'+this.PstDocGrid.Table[s].Action.toString()+'" ',a.e.IsEmpty(this.PstDocGrid.Table[s].clrDate_Key)||(n+='PostedDate="'+new Date(this.PstDocGrid.Table[s].clrDate_Key.toString()).ToString("dd/MMM/yyyy")+'" '),n+='CostCenterID="'+this.PstDocGrid.Table[s].CostCenterID.toString()+'" ',n+='VoucherNo="'+this.PstDocGrid.Table[s].VoucherNo.toString()+'" ',"19"==a.e.StringValue(this.PstDocGrid.Table[s].DocumentType).toString()?"1"==this.PstDocGrid.Table[s].Action.toString()?(n+='CreditAccountID="'+m[b]+'" ',n+='DebitAccountID="'+this.PstDocGrid.Table[s].BankAccountID_Key.toString()+'" '):(n+='CreditAccountID="'+this.PstDocGrid.Table[s].BankAccountID_Key.toString()+'" ',n+='DebitAccountID="'+m[b]+'" '):"1"==this.PstDocGrid.Table[s].Action.toString()?(n+='CreditAccountID="'+this.PstDocGrid.Table[s].BankAccountID_Key.toString()+'" ',n+='DebitAccountID="'+m[b]+'" '):(n+='DebitAccountID="'+this.PstDocGrid.Table[s].BankAccountID_Key.toString()+'" ',n+='CreditAccountID="'+m[b]+'" '),n+='ACTUAL="'+m[b]+'" ',n+=' Dupl="'+this.PstDocGrid.Table[s].AccDocDetailsID.toString()+'" ',this.IsPDCHoldDimension&&this.PstDocGrid.TableColumns.Contains("HoldDimension_Key")&&null!=this.PstDocGrid.Table[s].HoldDimension_Key&&1!=parseInt(this.PstDocGrid.Table[s].HoldDimension_Key)&&(n+='IsHold="1" '),n+="/>"}else this.IsPDCHoldDimension&&this.PstDocGrid.TableColumns.Contains("HoldDimension_Key")&&null!=this.PstDocGrid.Table[s].HoldDimension_Key&&(1==parseInt(this.PstDocGrid.Table[s].HoldDimension_Key)&&parseInt(this.PstDocGrid.Table[s].HoldDimension_Old)==parseInt(this.PstDocGrid.Table[s].HoldDimension_Key)||(i+='<Row ID="'+this.PstDocGrid.Table[s].AccDocDetailsID.toString()+'" ',i+='HoldDimension="'+this.PstDocGrid.Table[s].HoldDimension_Key.toString()+'" ',1!=parseInt(this.PstDocGrid.Table[s].HoldDimension_Key)&&(this.PstDocGrid.TableColumns.Contains("HoldDate_Key")&&null!=this.PstDocGrid.Table[s].HoldDate_Key&&(i+='HoldDate="'+new Date(this.PstDocGrid.Table[s].HoldDate_Key).ToString("dd-MMM-yyyy")+'" '),this.PstDocGrid.TableColumns.Contains("HoldRemarks")&&(i+='HoldRemarks="'+this.PstDocGrid.Table[s].HoldRemarks.toString()+'" ')),i+="/>"));if(n.length>0||i.length>0){n="<XML>"+n,n+="</XML>",i.length>0&&(i="<XML>"+i,i+="</XML>");var C=o.a.document.SetPostDocuments(n.toString(),i.toString(),this.PostonconversionDate,this.ScreenObject.LockWhere);null!=C&&C.Tables.length>0&&C.Tables[C.Tables.length-1].length>0&&C.Columns[C.Tables.length-1].Contains("ErrorMessage")&&(this.DisplayMessage=C.Tables[C.Tables.length-1][0].ErrorMessage.toString(),C.Tables.length>2&&C.Tables[C.Tables.length-2].length>0&&(this.DisplayMessage=this.DisplayMessage+" :: ",C.Tables[C.Tables.length-2].forEach((function(e){t.DisplayMessage=t.DisplayMessage+e.VoucherNo.toString()+","})),this.DisplayMessage=this.DisplayMessage.TrimEnd(",")+" Documents Locked"),C.Tables.length>=3&&C.Tables[C.Tables.length-3].forEach((function(e){if(C.Columns[C.Tables.length-3].Contains("AccDocDetailsID")){var n=t.PstDocGrid.Table.filter((function(t){return t.AccDocDetailsID==e.AccDocDetailsID}));n.length>0&&(n[0].ConvertedDocNo=a.e.String(e.VoucherNo),n[0].ConvertedAccDocID=a.e.String(e.ConvertedAccDocID),n[0].InterMediateVoucherNO=a.e.String(e.InterMediateVoucherNO),n[0].InterMediateDocID=a.e.String(e.InterMediateDocID),n[0].Action="",n[0].clrDate="",n[0].StatusID=e.StatusID,C.Columns[C.Tables.length-3].Contains("IsReplace")&&!a.e.IsEmpty(e.IsReplace)?"1"==a.e.String(e.IsReplace)?n[0].Status=o.a.GetResource("Replaced"):"2"==e.IsReplace.toString()&&(n[0].Status=o.a.GetResource("ReplacedPartial")):n[0].Status=a.e.String(e.ConvertedStatus),t.PstDocGrid.updateRow(n[0]))}}))),this.MessageVisibility=!0}}else if("Refresh"==e)if(null!=this.PDCDialog)o.a.page.ShowDialog(this.PDCDialog,A.a);else{var I=new f;I.PostedDocumentDialogViewModel_1(this),o.a.page.ShowDialog(I,A.a)}else if("Customize"==e);else if("CustomizePrint"==e);else if("Export"==e){this.MessageVisibility=!0,this.DisplayMessage="Exporting data please wait...";var p=this.GetExportHTML(),S=new Blob([p],{type:"text/plain;charser=utf-8"});k.saveAs(S,this.DisplayName+"_XlsExport_"+(new Date).getTime()+".xls")}Logger.InfoLog("PostedDocumentViewModel:: exiting ButtonSave sender ="+e.toString())}},{key:"Setselectedrow",value:function(e){this.PstDocGrid.SelectedItem=this.PstDocGrid.Table[e]}},{key:"selectConvert",value:function(e){if(Logger.InfoLog("PostedDocumentViewModel:: inside selectConvert "),e)for(var t=0;t<=this.PstDocGrid.Table.length-1;t++)a.e.IsEmpty(this.PstDocGrid.Table[t].StatusID)||370!=parseInt(this.PstDocGrid.Table[t].StatusID.toString())||a.e.IsEmpty(this.PstDocGrid.Table[t].ChequeMaturityDate)||new Date(this.PstDocGrid.Table[t].ChequeMaturityDate.toString()).Date!=(new Date).Date||(this.PstDocGrid.Table[t].Action=this.SelectMaturityDate?"1":"");else for(var n=0;n<=this.PstDocGrid.Table.length-1;n++)!a.e.IsEmpty(this.PstDocGrid.Table[n].StatusID)&&370==parseInt(this.PstDocGrid.Table[n].StatusID.toString())&&!a.e.IsEmpty(this.PstDocGrid.Table[n].ChequeMaturityDate)&&new Date(this.PstDocGrid.Table[n].ChequeMaturityDate.toString()).Date<=(new Date).Date&&(this.PstDocGrid.Table[n].Action=this.SelectLessThanMaturityDate?"1":"");Logger.InfoLog("PostedDocumentViewModel:: exiting selectConvert ")}},{key:"GetExportHTML",value:function(){Logger.InfoLog("PostedDocumentViewModel:: inside GetExportHTML ");var e="",t="";e+="<html><meta charset='utf-8' /><body style='color:blac;background-color:white;'>",t+=".hdr{text-align:cente; padding:5px; background-color:#4F81BD;color:white;font-family:Arial;font-size:11pt} ",t+=".grp{padding:2p; background-color:#87CEEB; color:#FFFCF7;font-family:arial; font-size:10pt;}",t+=".tot{background-color:whit; color:red;font-family:arial; font-weight:bold; font-size:8pt;}",e+="<style>"+(t+=".alt{background-color:whitesmok; color:black; font-family:arial; font-size:9pt; align:right;}").toString()+"</style>";for(var n,i=0,s=0;s<this.PstDocGrid.Columns.length;s++)i+=this.PstDocGrid.Columns[s].Width;e+="<table>",e+="\r\n<tr><td align='center'><h2>",e+=o.a.SessionManager.CompanyName,e+="</h2></td></tr>",e+="\r\n<tr><td align='center'><h3 style='vertical-align:middl;'>",e+=this.DisplayName,e+="</h3></td></tr>",e+="\r\n<tr><td align='center'>",e+=" From :  "+this.FromDate.ToString(o.a.SessionManager.Preferences["Date Format"]),e+=" &nbs;&nbsp;&nbsp;To :  "+this.ToDate.ToString(o.a.SessionManager.Preferences["Date Format"]),e+="</td></tr>",e+="<tr><td style='padding-top:10p;'><table border=1 width='"+i+"' style='border-collapse:collapse;  font-family:arial; font-size:9pt;' >",e+="<COLGROUP>";for(var r=0;r<this.PstDocGrid.Columns.length;r++)a.e.IsEmpty(this.PstDocGrid.Columns[r].DataType)||"FLOAT"!=this.PstDocGrid.Columns[r].DataType?e+="<COL style=''>":e+="<COL style='text-align:righ;'>";e+="</COLGROUP>",e+="<tr style=''>";for(var l=0;l<this.PstDocGrid.Columns.length;l++)e+="<th class='hdr' width='"+this.PstDocGrid.Columns[l].Width,e+="' >",e+=this.PstDocGrid.Columns[l].Header,e+="</th>";e+="</tr>";for(var c=0;c<this.PstDocGrid.Table.length;c++){e+="<tr",c%2==1&&(e+=" class=alt"),e+=">";for(var u=0;u<this.PstDocGrid.Columns.length;u++)e+="<td",a.e.IsEmpty(this.PstDocGrid.Columns[u].DataType)||"FLOAT"!=this.PstDocGrid.Columns[u].DataType?e+=" align='left'":e+=" align='right'",e+=">",n=a.e.IsEmpty(this.PstDocGrid.Columns[u].DataType)||"PactComboBox"!==this.PstDocGrid.Columns[u].DataType?this.PstDocGrid.Columns[u].DisplayMember:this.PstDocGrid.Columns[u].ValueBinding+"_Key",this.PstDocGrid.TableColumns.Contains(n)&&("ChequeNumber"==n&&!a.e.IsEmpty(this.PstDocGrid.Table[c][n])&&this.PstDocGrid.Table[c][n].toString().startsWith("0")?e+="'"+this.PstDocGrid.Table[c][n].toString():e+=a.e.String(this.PstDocGrid.Table[c][n])),e+="</td>";e+="</tr>"}return e+="</table>",e+="</td></tr></table>",e+="</body><html>",Logger.InfoLog("PostedDocumentViewModel:: exiting GetExportHTML "),e}},{key:"ScreenObject",get:function(){return this._ScreenObject}},{key:"SelectMaturityDate",get:function(){return this._SelectMaturityDate},set:function(e){e!=this._SelectMaturityDate&&(this._SelectMaturityDate=e,this.selectConvert(!0))}},{key:"SelectLessThanMaturityDate",get:function(){return this._SelectLessThanMaturityDate},set:function(e){e!=this._SelectLessThanMaturityDate&&(this._SelectLessThanMaturityDate=e,this.selectConvert(!1))}}],[{key:"SetDimensionQuery",value:function(){Logger.InfoLog("PostedDocumentViewModel:: Inside SetDimensionQuery  "),this.strSelect=",ChequeBankName",this.strJoin="";try{var e=new a.f;e.LoadXml(o.a.SessionManager.Preferences["PDC Customize Screen"]);for(var t=0;t<e.DocumentElement.children.length;t++){var n=e.DocumentElement.children[t];if("DIM"==n.attributes.Type.value){var i=(parseInt(n.attributes.ID.value)-5e4).toString();this.strSelect+=",L.dcCCNID"+i+",D"+i+".Name AS DIM"+n.attributes.ID.value,this.strJoin+=" LEFT JOIN "+a.e.GetTagTableName(parseInt(n.attributes.ID.value))+" AS D"+i+" ON L.dcCCNID"+i+"=D"+i+".NodeID"}else"FLD"!=n.attributes.Type.value||"CommonNarration"!=n.attributes.ID.value&&"LineNarration"!=n.attributes.ID.value||(this.strSelect+=","+n.attributes.ID.value)}}catch(s){Logger.ErrorLog("PDC Dimension Query Error..",s)}Logger.InfoLog("PostedDocumentViewModel:: Exiting SetDimensionQuery  ")}}]),i}(l.b)).strSelect="",i.strJoin="",i)}}]);