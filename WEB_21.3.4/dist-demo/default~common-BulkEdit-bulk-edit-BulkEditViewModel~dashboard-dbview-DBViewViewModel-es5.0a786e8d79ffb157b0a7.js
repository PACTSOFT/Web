function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var n,i=_getPrototypeOf(e);if(t){var a=_getPrototypeOf(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[61,141,150,160],{EggS:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("Do2H"),a=n("Lp6j"),s=n("eQJW"),r=function(){function e(){_classCallCheck(this,e),this.CustomerID=0,this.CustomerTypeID=0,this.StatusID=0,this.AccountID=0,this.ParentID=0,this.SelectedNodeID=0,this.CodeNumber=0,this.IsGroup=!1,this.CreditDays=0,this.CreditLimit=0,this.DebitDays=0,this.Debitlimit=0,this.IsCode=!1,this.ActivityXml="",this.CCXML=""}return _createClass(e,[{key:"SaveCustomerQuick",value:function(){try{var e=[];return e.push(this.CustomerID),e.push(null!=this.CustomerCode?this.CustomerCode:""),e.push(null!=this.CustomerName?this.CustomerName:""),e.push(this.StatusID),e.push(this.CodePrefix),e.push(this.CodeNumber),e.push(this.StaticFieldsQuery),e.push(this.CustomFieldsQuery),e.push(this.CustomCostCenterFieldsQuery),e.push(i.a.SessionManager.CompanyGUID),e.push(this.GUID),e.push(""),e.push(i.a.SessionManager.UserName),e.push(i.a.SessionManager.RoleID),e.push(i.a.SessionManager.LanguageID),i.a.crmService.SetCustomerQuick(e)}catch(t){return Logger.ErrorLog("Account:: SaveAccountQuick"+t.stack),""}}},{key:"SaveCustomer",value:function(){Logger.InfoLog("Customer:: Inside SaveCustomer");try{0==this.CustomerID&&(this.GUID=a.e.NewGuid());var e=[];return e.push(this.CustomerID),e.push(null!=this.CustomerCode?this.CustomerCode:""),e.push(null!=this.CustomerName?this.CustomerName:""),e.push(null!=this.AliasName?this.AliasName:""),e.push(this.CustomerTypeID),e.push(this.StatusID),e.push(this.AccountID),e.push(this.SelectedNodeID),e.push(this.IsGroup),e.push(this.CreditDays),e.push(this.CreditLimit),e.push(null!=this.UserName?this.UserName:""),e.push(null!=this.Password?this.Password:""),e.push(null!=this.OnlineCustType?this.OnlineCustType:""),e.push(i.a.SessionManager.CompanyGUID),e.push(null!=this.GUID?this.GUID:"GUID"),e.push(""),e.push(i.a.SessionManager.UserName),e.push(this.CustomFieldsQuery),e.push(this.CustomCostCenterFieldsQuery),e.push(this.ContactsXML),e.push(this.AttachmetsXML),e.push(this.NotesXML),e.push(this.AddressXML),e.push(this.ActivityXml),e.push(this.CCXML),e.push(!1),e.push(null==this.PrimaryContactQuery?"":this.PrimaryContactQuery),e.push(i.a.SessionManager.RoleID),e.push(i.a.SessionManager.LanguageID),e.push(null!=this.CodePrefix?this.CodePrefix:""),e.push(this.CodeNumber),e.push(this.IsCode),i.a.crmService.SaveCustomer(e)}catch(t){return Logger.ErrorLog("Customer:: SaveCustomer"+t.stack),""}}},{key:"GetCustomerDetails",value:function(){var e=i.a.crmService.GetCustomerInfo("?UserID="+i.a.SessionManager.UserID+"&RoleID="+i.a.SessionManager.RoleID+"&LangID="+i.a.SessionManager.LangID+"&CustomerID="+this.CustomerID);return!e.Columns[0].Contains("ErrorMessage")&&e.Tables.length>0&&e.Tables[0].length>0&&(this.CustomerID=parseInt(e.Tables[0][0].CustomerID),this.CustomerCode=a.e.String(e.Tables[0][0].CustomerCode),this.CustomerName=a.e.String(e.Tables[0][0].CustomerName),this.AliasName=a.e.String(e.Tables[0][0].AliasName),a.e.IsEmpty(e.Tables[0][0].CustomerTypeID)||(this.CustomerTypeID=parseInt(e.Tables[0][0].CustomerTypeID)),this.StatusID=parseInt(e.Tables[0][0].StatusID),a.e.IsEmpty(e.Tables[0][0].AccountID)||(this.AccountID=parseInt(e.Tables[0][0].AccountID)),this.IsGroup=Object(s.j)(e.Tables[0][0].IsGroup),a.e.IsEmpty(e.Tables[0][0].CreditDays)||(this.CreditDays=parseInt(e.Tables[0][0].CreditDays)),a.e.IsEmpty(e.Tables[0][0].CreditLimit)||(this.CreditLimit=parseFloat(e.Tables[0][0].CreditLimit)),this.ParentID=parseInt(e.Tables[0][0].ParentID),this.GUID=a.e.String(e.Tables[0][0].GUID),this.Description=a.e.String(e.Tables[0][0].Description),this.CodePrefix=a.e.String(e.Tables[0][0].CodePrefix),this.UserName=a.e.String(e.Tables[0][0].UserName),this.OnlineCustType=a.e.String(e.Tables[0][0].OnlineCustType),this.Password=a.e.String(e.Tables[0][0].Password),a.e.IsEmpty(e.Tables[0][0].CodeNumber)||(this.CodeNumber=parseInt(e.Tables[0][0].CodeNumber))),e}},{key:"DeleteCustomer",value:function(e,t){try{var n=[];return n.push(e),n.push(t),n.push(i.a.SessionManager.RoleID),n.push(i.a.SessionManager.LanguageID),Logger.InfoLog("Customer:: Success: DBH.DeleteCustomer "+e.toString()),i.a.crmService.RemoveCustomer(n)}catch(a){return Logger.ErrorLog("LEAD::DeleteLead"+a.stack),""}}}]),e}()},NipM:function(e,t,n){"use strict";n.r(t),n.d(t,"BulkEditViewModel",(function(){return T})),n.d(t,"BulkEditFilter",(function(){return b})),n.d(t,"BulkEditReplace",(function(){return f}));var i=n("mrSG"),a=n("Do2H"),s=n("Lp6j"),r=n("vTM8"),o=n("eQJW"),l=n("NkMH"),u=n("JIg3"),D=n("EQd/"),c=n("ScVY"),d=n("8B8H"),C=n("ockk"),h=n("0/4Q"),p=n("mvPR"),m=n("uMy8"),I=n("ThYU"),g=n("w8Sz"),y=n("XJLh"),S=n("BJEe"),T=function(e){_inherits(c,e);var t=_createSuper(c);function c(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return _classCallCheck(this,c),(n=t.call(this)).ButtonApprove=new l.a,n.AppMessageVisibility=!1,n._AppDisplayMessage="",n.Remarks=new D.d(0),n.AppRejDate=new u.a(0),n.SuspendVisiblity=!1,n.CostCenterName="",n.DisplayName="",n.Title="",n.ReplaceVisibility=!1,n.DeleteVisibility=!1,n.ShowRightPanel=!0,n.SaveButtonVisible=!1,n.IsBarcode=!1,n.HideTitle=!1,n.Replace=null,n.IsLWApproval=!1,n.ID=0,n.CostCenterID=0,n.MainTableName="",n.dvFields=null,n.dvFieldsNew=null,n.IsDetailVoucher=!1,n.IsSelectOnRowLeave=!0,n.IsApproval=!1,n.IsProductExists=!1,n.HideFilterDialog=!1,n.HideProductImage=!1,n.ShowFilter=!1,n.RemarksApprove=!1,n.RemarksReject=!1,n.RemarksSuspend=!1,n.SelectedFields=[],n.DateColIDs=new Array,n.EditColumns=new Array,n.EditColumnsDr=[],n.Entities=new r.a,n.ProductImageVisibility=!1,n.ApproveVisibility=!1,n.PhotoTextVisibility=!1,n.ProductID=0,n.ProductPhoto="",n.ReportID=0,n.DB=null,n.IsDocument=!1,n.PrimaryKey="",n.PrimaryColumns="",n.ReportObj=null,n.Report=[],n.AddressFields=new Array,n.docAllowCols=["billno","billdate","linenarration","commonnarration","chequenumber","chequematuritydate"],n.ReportFilterVisible=!1,n.oDocPayroll=null,n.vnofield="",n.cprimary=null,n.strVoucherNo="VoucherNo",n.dicBarLayouts=new r.a,n.ClassName="BulkEditViewModel",n.FromDate=new u.a,n.FromDate.Label=a.a.GetResource("Calender_FromDate"),n.ToDate=new u.a,n.ToDate.Label=a.a.GetResource("Calender_ToDate"),n.FromDate.CustomFormat=a.a.SessionManager.Preferences["Date Format"],n.ToDate.CustomFormat=a.a.SessionManager.Preferences["Date Format"],n.FromDate.Date=new Date(a.a.SessionManager.AccountingDate),n.ToDate.Date=new Date,n.DateRanges=g.a.getDateRanges(),n.DateRanges.SelectionChangedCommand.Subscribe(_assertThisInitialized(n),"OnDateRangesSelectionChanged"),n.AppRejDate.CustomFormat=a.a.SessionManager.Preferences["Date Format"],n.AppRejDate.Date=new Date,n.ID=e,n.DB=i,n.InitGrids(),n.EditGrid.SelectAll.Visible=!0,n.Margin="2",null!=i&&(n.HideFilterDialog=!0,n.ShowRightPanel=!1,n.HideTitle=!0,n.EditGrid.SearchCols.Width="140",n.EditGrid.SearchOptions.Width="100",n.EditGrid.SearchText.Width="130",n.Margin="2"),n.HideFilterDialog&&(n.ReportFilterVisible=!1,n.EditGrid.Visible=!0,(null!=n.ReportObj&&n.ReportObj.IsDefaultSortColumnExists||a.a.SessionManager.IsWebApplication)&&(n.bgWorker_DoWork(null,null),n.bgWorker_RunWorkerCompleted(null,null))),n}return _createClass(c,[{key:"bgWorker_DoWork",value:function(e,t){null!=this.ReportObj?null!=this.ReportObj.oReportDialog?this.ReportObj.oReportDialog.OnOkClick("OK"):this.ReportObj.Filter.OnButtonClick("OK"):this.RefreshData()}},{key:"bgWorker_RunWorkerCompleted",value:function(e,t){this.DisplayName=this.Title,null==this.DB&&this.HideFilterDialog&&null!=this.EditGrid.Table&&0==this.EditGrid.Table.length&&(this.DisplayMessage="No Data Available.")}},{key:"AddAddressColumns",value:function(e,t){var n,i=["ContactPerson","Address1","Address2","Address3","City","State","Zip","Country","Phone1","Phone2","Fax","Email1","Email2","URL","AddressName"],a="Account",s=e.filter((function(e){return e.CostCenterID==t}));s.length>0&&(a=s[0].CostCenterName.toString());for(var r=0;r<i.length;r++)(n={}).SysTableName="COM_Address",n.UserColumnName=n.SysColumnName=i[r],n.ColumnCostCenterID=n.CostCenterID=t,n.CostCenterName=a,n.CostCenterColID=4e5+r+200*t,n.IsForeignKey=!1,n.IsColumnUserDefined=!1,e.push(n)}},{key:"InitGrids",value:function(){var e=this;this.SaveButtonVisible=!0;var t=a.a.common.BulkEditDetals(6,this.ID,0);this.CostCenterID=parseInt(t.Tables[0][0].CostCenterID),this.DisplayName=s.e.String(t.Tables[0][0].Name),this.Title=this.DisplayName,this.MainTableName=s.e.String(t.Tables[1][0].TableName),this.CostCenterName=s.e.String(t.Tables[1][0].Name);var n=a.a.common.BulkEditDetals(2,0,this.CostCenterID);2==this.CostCenterID&&this.AddAddressColumns(n.Tables[0],this.CostCenterID);var i=new s.f;i.LoadXml(s.e.String(t.Tables[0][0].Options)),this.IsSelectOnRowLeave=null!=i.SelectSingleNode("XML/SelectOnRowLeave"),this.IsDetailVoucher=null!=i.SelectSingleNode("XML/DetailsVoucher"),this.HideFilterDialog=null!=i.SelectSingleNode("XML/HideFilterDialog"),this.HideProductImage=null!=i.SelectSingleNode("XML/HideProductImage"),this.IsApproval=null!=i.SelectSingleNode("XML/ApproveDocuments"),this.ShowFilter=null!=i.SelectSingleNode("XML/ShowFilter"),this.IsApproval&&(this.RemarksApprove=null!=i.SelectSingleNode("XML/RemarksApprove"),this.RemarksReject=null!=i.SelectSingleNode("XML/RemarksReject"),this.RemarksSuspend=null!=i.SelectSingleNode("XML/RemarksSuspend")),this.IsBarcode=null!=i.SelectSingleNode("XML/BarcodePrint"),this.IsBarcode&&(this.SaveButtonVisible=!1,this.IsDetailVoucher=!0),3!=this.CostCenterID||this.HideProductImage||(this.ProductImageVisibility=!0),this.CostCenterID>4e4&&this.CostCenterID<5e4?(this.IsDocument=!0,this.IsLWApproval=!!(this.IsDetailVoucher&&t.Tables[2].length>0&&1==parseInt(t.Tables[2][0].IsLineWise)),this.AppRejDate.Visible=n.Tables[3].filter((function(e){return"AppDate"==e.PrefName&&"True"==e.PrefValue})).length>0):this.AppRejDate.Visible=!1;var r,l=n.Tables[0];this.dvFields=l,this.dvFieldsNew=l,null!=i.SelectSingleNode("XML/Report")?(this.ReportID=parseInt(i.SelectSingleNode("XML/Report").innerHTML),this.InitReport()):this.ReportID=0,(this.IsDocument||2==this.CostCenterID||3==this.CostCenterID||95==this.CostCenterID||this.CostCenterID>5e4)&&this.IsApproval&&a.a.SessionManager.IsActionAssigned(49,"Document Bulk Approval")?(this.ButtonApprove.Visible=!0,this.SaveButtonVisible=!1,this.IsDocument&&this.IsLWApproval&&(this.SuspendVisiblity=a.a.SessionManager.IsActionAssigned(this.CostCenterID,"Suspend"))):this.ButtonApprove.Visible=!1,(2==this.CostCenterID||3==this.CostCenterID||this.CostCenterID>5e4)&&(this.DeleteVisibility=a.a.SessionManager.IsActionAssigned(49,"Bulk Delete"),this.DeleteVisibility&&(this.DeleteVisibility=a.a.SessionManager.IsActionAssigned(this.CostCenterID,"Delete"))),this.EditGrid=new d.a,this.EditGrid.Width="",this.EditGrid.Height=void 0,this.EditGrid.CanUserDeleteRows=!1,this.EditGrid.Columns=[],this.EditGrid.SearchVisible=!0,this.EditGrid.SearchColStartIndex=1,this.EditGrid.CanUserSortColumns=!0,this.EditGrid.Visible=!1,this.EditGrid.CellEditEnding.Subscribe(this,"EditGridOnCellEditEnding"),this.Report.length>0&&this.EditGrid.Clear(),(r=new C.a).Header="Select",r.DisplayMember="Select",r.DataType="CheckBox",r.Width=50,r.IsFrozen=!0,r.DisableTab=!0,this.EditGrid.Columns.push(r);var u=0;i.LoadXml(s.e.String(t.Tables[0][0].FieldsXML));var D=new Array;if(this.IsDocument){var c=new m.a,p=[];n.Tables[1].forEach((function(e){p.Clear(),c.ParseFormula(s.e.String(e.Formula),p);for(var t=null,n=p.length-1;n>=0;n--)(t=p[n]).getTokenClass()!=m.d.OPERAND||t.getTokenType()!=m.e.REFERENCE||D.Contains(t.tokenValue.toString())||D.push(t.tokenValue.toString())}))}for(var I=function(t){var l=i.DocumentElement.children[t];if(e.dvFields=s.e.IsEmpty(l.attributes.ID.value)?[]:e.dvFieldsNew.filter((function(e){return e.CostCenterColID==l.attributes.ID.value})),0!=e.dvFields.length){if(e.SelectedFields.push(e.dvFields[0]),u=parseInt(e.dvFields[0].CostCenterColID),(r=new C.a).DisplayMember="C"+(e.SelectedFields.length-1),r.SectionName=r.DisplayMember,r.Header=s.e.String(e.dvFields[0].UserColumnName),r.Width=parseInt(l.attributes.Width.value),r.ReadOnly="YES"!=l.attributes.Edit.value,s.e.IsEmpty(l.attributes.ShowCode)||"YES"!=l.attributes.ShowCode.value||(e.dvFields[0].ShowCode="YES"),e.ButtonApprove.Visible&&(r.ReadOnly=!0),r.ID=s.e.String(e.dvFields[0].SysColumnName),"COM_ADDRESS"==s.e.String(e.dvFields[0].SysTableName).toUpperCase()&&e.AddressFields.push(r.SectionName),r.CrRefID=u,null!=e.ReportObj&&(r.OPParams=l.attributes.RPTID.value),!r.ReadOnly&&!e.IsBarcode)if(e.IsDocument)r.ID.startsWith("dcAlpha")||r.ID.toLowerCase().startsWith("dcccnid")||e.docAllowCols.Contains(r.ID.toLowerCase())?(0!=n.Tables[1].filter((function(e){return e.CostCenterColID==u.toString()})).length||D.Contains(r.Header))&&(r.ReadOnly=!0):r.ReadOnly=!0;else if(2==e.CostCenterID&&r.ID.startsWith("AccountCode")){var c=n.Tables[2].filter((function(e){return 0==e.IsGroupCode&&0==e.IsName}));r.ReadOnly=null!=c&&c.length>0&&"true"==s.e.String(c[0].IsEnable).toLowerCase()}else if(3==e.CostCenterID&&r.ID.startsWith("ProductCode")){var d=n.Tables[2].filter((function(e){return 0==e.IsGroupCode&&0==e.IsName}));r.ReadOnly=null!=d&&d.length>0&&"true"==s.e.String(d[0].IsEnable).toLowerCase()}else if(16==e.CostCenterID&&r.ID.startsWith("BatchCode")){var p=n.Tables[3].filter((function(e){return"BatchCodeAutoGen"==e.Name}));(p.length>0&&"true"==s.e.String(p[0].Value).toLowerCase()||n.Tables[2].length>0&&!s.e.IsEmpty(n.Tables[2][0].IsParentCodeInherited)&&Object(o.j)(n.Tables[2][0].IsParentCodeInherited))&&(r.ReadOnly=!0)}else if(93==e.CostCenterID&&r.ID.startsWith("Code")){var m=n.Tables[2].filter((function(e){return 0==e.IsGroupCode&&0==e.IsName}));r.ReadOnly=null!=m&&m.length>0&&"true"==m[0].IsEnable.toString().toLowerCase()}else if(e.CostCenterID>=50001&&e.CostCenterID<=50050&&r.ID.startsWith("Code")){var I=n.Tables[2].filter((function(e){return 0==e.IsGroupCode&&0==e.IsName}));r.ReadOnly=null!=I&&I.length>0&&"true"==s.e.String(I[0].IsEnable).toLowerCase()}if(e.SelectedFields.length<3&&(r.IsFrozen=!0),r.IsColumnUserDefined=!!Object(o.j)(e.dvFields[0].IsColumnUserDefined),r.DataType=s.e.String(e.dvFields[0].UserColumnType).toUpperCase(),241==u)r.ValueMember="AccountTypeID",r.DisplayMember="AccountType",r.ValueBinding="C"+(e.SelectedFields.length-1),r.ComboData=n.Tables[4],r.DataType="ComboBox",e.dvFields[0].IsForeignKey=!1;else if(264==u)r.ValueMember="ProductTypeID",r.DisplayMember="ProductType",r.ValueBinding="C"+(e.SelectedFields.length-1),r.ComboData=n.Tables[4],r.DataType="ComboBox",e.dvFields[0].IsForeignKey=!1;else if(252==u)r.ValueMember="Value",r.DisplayMember="Name",r.ValueBinding="C"+(e.SelectedFields.length-1),r.ComboData=b.GetBillWiseTable(),r.DataType="ComboBox";else if("StatusID"==r.ID)r.ValueMember="ID",r.DisplayMember="Name",r.ValueBinding="C"+(e.SelectedFields.length-1),r.ComboData=e.IsDocument?n.Tables[2]:n.Tables[1],r.DataType="ComboBox",e.dvFields[0].IsForeignKey=!1;else if(r.ReadOnly||!s.e.IsEmpty(e.dvFields[0].IsForeignKey)&&Object(o.j)(e.dvFields[0].IsForeignKey)&&parseInt(e.dvFields[0].ColumnCostCenterID)>0&&(r.DataType="LISTBOX",r.CostCenterID=parseInt(e.dvFields[0].ColumnCostCenterID),3!=r.CostCenterID||e.HideProductImage||(e.IsProductExists=!0,e.ProductImageVisibility=!0),r.TypeID=parseInt(e.dvFields[0].ColumnCCListViewTypeID)),"DATE"==r.DataType)r.DataType="DATE",e.DateColIDs.push("C"+(e.SelectedFields.length-1));else if(r.IsColumnUserDefined)if("DATE"==r.DataType||"DATETIME"==r.DataType||"TIME"==r.DataType)r.DataType="DATE",e.DateColIDs.push("C"+(e.SelectedFields.length-1));else if("NUMERIC"==r.DataType)r.DataType="FLOAT";else if("SELECTIONBOX"==r.DataType||"editablecombobox"==r.DataType)r.DataType="SELECTIONBOX",r.CostCenterID=e.CostCenterID;else if("COMBOBOX"==r.DataType){var g=[],S={};e.dvFields[0].UserProbableValues.toString().split(";").forEach((function(e){(S={}).Value=e,S.Name=e,g.push(S)})),r.ValueMember="Value",r.DisplayMember="Name",r.ValueBinding="C"+(e.SelectedFields.length-1),r.ComboData=g,r.DataType="ComboBox"}else if("LISTBOX"==r.DataType)r.DataType="LISTBOX",a.a.SessionManager.IsWebApplication&&(r.ValueMember="C"+(e.SelectedFields.length-1)+"_Key"),r.CostCenterID=parseInt(s.e.String(e.dvFields[0].ColumnCostCenterID)),r.TypeID=parseInt(s.e.String(e.dvFields[0].ColumnCCListViewTypeID));else if("LOOKUP"==r.DataType){r.ValueBinding=r.ID,r.DataType="ComboBox",r.DisplayMember="Name",r.ValueMember="Value";var T=a.a.common.GetDataSet("DOC019",parseInt(e.dvFields[0].ColumnCCListViewTypeID).toString());if(null!=T){for(var f=[],E=0;E<T.length;E++)f.push(h.d.ComboBoxItems_2(T[E].Name.toString(),T[E].NodeID.toString()));r.ComboData=f}}if("FLOAT"==s.e.String(e.dvFields[0].ColumnDataType)){r.DataType="FLOAT";var M=s.e.String(e.dvFields[0].Decimal);r.ID.toLowerCase().Contains("dcnum")?!s.e.IsEmpty(M)&&parseFloat(M)>=0?r.DecimalPoints=M:a.a.SessionManager.Preferences.ContainsKey("DecimalsinExtraFields")&&""!=a.a.SessionManager.Preferences.DecimalsinExtraFields&&(r.DecimalPoints=a.a.SessionManager.Preferences.DecimalsinExtraFields):"Quantity"==r.ID?""!=M&&parseFloat(M)>=0?r.DecimalPoints=M:a.a.SessionManager.Preferences.ContainsKey("DecimalsinQty")&&""!=a.a.SessionManager.Preferences.DecimalsinQty&&(r.DecimalPoints=a.a.SessionManager.Preferences.DecimalsinQty):"Gross"==r.ID||"Rate"==r.ID?""!=M&&parseFloat(M)>=0?r.DecimalPoints=M:a.a.SessionManager.Preferences.ContainsKey("DecimalsinRate")&&""!=a.a.SessionManager.Preferences.DecimalsinRate&&(r.DecimalPoints=a.a.SessionManager.Preferences.DecimalsinRate):"Amount"==r.ID||"DebitAmount"==r.ID||"CreditAmount"==r.ID?""!=M&&parseFloat(M)>=0?r.DecimalPoints=M:a.a.SessionManager.Preferences.ContainsKey("DecimalsinAmount")&&""!=a.a.SessionManager.Preferences.DecimalsinAmount&&(r.DecimalPoints=a.a.SessionManager.Preferences.DecimalsinAmount):""!=M&&parseFloat(M)>=0&&(r.DecimalPoints=M)}else"COMBOTEXT"==s.e.String(e.dvFields[0].ColumnDataType)&&(r.DataType="LINK",r.Click.Subscribe(e,"onDocClick"),e.vnofield=r.DisplayMember);95!=e.CostCenterID||r.ReadOnly||r.ID.toLowerCase().Contains("alpha")||(r.ReadOnly=!0),r.ReadOnly?r.DisableTab=!0:(e.EditColumns.push(r),e.EditColumnsDr.push(e.dvFields[0].Row),r.DisableTab=!1),e.EditGrid.Columns.push(r),null!=e.ReportObj&&("LISTBOX"==r.DataType||"DATE"==r.DataType?(e.EditGrid.TableColumns.push(r.DisplayMember),e.EditGrid.TableColumns.push(r.DisplayMember+"_Key")):e.EditGrid.TableColumns.push("FLOAT"==r.DataType?r.DisplayMember:"ComboBox"==r.DataType?r.ValueBinding:r.DisplayMember))}else if(null!=e.ReportObj){if(null==(y=e.ReportObj.ReportColumns.find((function(e){return e.ID==l.attributes.RPTID.value})))||null==y)return"continue";(r=new C.a).DisplayMember="RC"+e.EditGrid.TableColumns.length,r.OPParams=l.attributes.RPTID.value,r.SectionName=r.DisplayMember,r.Header=y.HeaderText,r.Width=parseInt(l.attributes.Width.value),r.ReadOnly=!0,r.DataType=y.DataAppearance.ColumnType,e.EditGrid.Columns.push(r),"DATE"==r.DataType||"DATETIME"==r.DataType?(r.DataType="DATE",e.DateColIDs.push(r.SectionName),e.EditGrid.TableColumns.push(r.DisplayMember),e.EditGrid.TableColumns.push(r.DisplayMember+"_Key")):e.EditGrid.TableColumns.push(r.DisplayMember)}},g=0;g<i.DocumentElement.children.length;g++){var y;I(g)}(r=new C.a).Header="Message",r.DisplayMember="Message",r.Width=250,r.ReadOnly=!0,r.DisableTab=!0,this.EditGrid.Columns.push(r),this.EditGrid.AddSearchCols(),this.Filter=new b(n,this),this.StaticFilter=new b(n,this),this.ShowFilter?this.Filter.LoadXML(s.e.String(t.Tables[0][0].FilterXML)):this.StaticFilter.LoadXML(s.e.String(t.Tables[0][0].FilterXML)),this.IsDocument?(this.FromDate.Visible=!0,this.ToDate.Visible=!0):(this.FromDate.Visible=!1,this.ToDate.Visible=!1)}},{key:"EditGridOnCellEditEnding",value:function(e){0!=e.cell&&this.IsSelectOnRowLeave&&(e.item.Select=!0)}},{key:"onDocClick",value:function(e){return Object(i.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,i,r,o,l,u,D,c,d,C,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.EditGrid.SelectedItem||!this.EditGrid.TableColumns.Contains(this.vnofield)){e.next=25;break}if(t=a.a.report.GetDocumentDetailsByVoucherNo(this.EditGrid.SelectedItem[this.vnofield].toString()),!(s.e.Int(t.obj)>0)){e.next=25;break}if(i=t.Tables[0].length>0?t.Tables[0][0]:t.Tables[1][0],40054!=parseInt(i.CostCenterID)){e.next=15;break}return e.next=6,n.e(48).then(n.bind(null,"E7Kr"));case 6:return r=e.sent,o=r.MonthlyPayrollComponent,e.next=10,n.e(47).then(n.bind(null,"+0zN"));case 10:l=e.sent,u=l.MonthlyPayrollViewModel,this.oDocPayroll=new u(i.DocumentName.toString(),"",i.VoucherNo.toString()),a.a.page.addNewTab({title:i.DocumentName.toString(),component:o,params:{obj:this.oDocPayroll}}),e.next=25;break;case 15:return e.next=17,Promise.resolve().then(n.bind(null,"MCKn"));case 17:return D=e.sent,c=D.AddEditDocumentComponent,e.next=21,Promise.resolve().then(n.bind(null,"1Cra"));case 21:d=e.sent,C=d.AddEditDocumentViewModel,(h=new C(parseInt(i.CostCenterID),i.DocumentName.toString(),!0)).ScreenObject.DocPrefix.ComboBox.SelectedValue=i.DocPrefix.toString(),h.ScreenObject.DocPrefix.TextBox.Text=i.DocNumber.toString(),h.OnDocPrefixChanged("lostFocus"),h.ScreenObject.FillDocumentPrefix(!0),a.a.page.addNewTab({component:c,params:{obj:h}});case 25:case"end":return e.stop()}}),e,this)})))}},{key:"InitReport",value:function(){var e=new I.ReportViewModel;e.ReportViewModel_1(this.ReportID),this.ReportObj=e,this.ReportObj.ScreenName="BULK",this.ReportObj.BulkEdit=this,this.Report.push(this.ReportObj),this.ReportFilterVisible=!this.HideFilterDialog}},{key:"OnButtonClick",value:function(e){if(this.DisplayMessage="","Save"==e){if(null==this.EditGrid.Table)return;var t=this.EditGrid.Table.filter((function(e){return 1==e.Select||1==e.Select}));if(0==t.length)return void(this.DisplayMessage="No Rows Selected");this.CostCenterID>4e4&&this.CostCenterID<5e4?this.SaveDocument(t):this.SaveDimension(t),this.DisplayMessage=95==this.CostCenterID?"Saved successfully":"Posting Completed"}else if("Delete"==e){if(!this.DeleteVisibility)return;var n=this.EditGrid.Table.filter((function(e){return 1==e.Select||1==e.Select}));if(0==n.length)return void(this.DisplayMessage="No Rows Selected");if(!confirm("Do you want to delete selected rows?"))return;this.CostCenterID>4e4&&this.CostCenterID<5e4||this.DeleteDimension(n)}else if("BACK"==e)this.EditGrid.Visible=!0;else if("OK"==e)this.EditGrid.Visible=!0,this.Filter.FilterGrid.commitEdit(),this.RefreshData();else if("Filter"==e)this.EditGrid.Visible=!1,this.Report.length>0&&(this.Report[0].ShowFilter=!0,this.ReportFilterVisible=!0);else if("Refresh"==e)this.Report.length>0?this.Report[0].Refresh():this.RefreshData();else if("PopUp"==e);else if("Approve"==e)this.ShowRightPanel=!0,this.ProductImageVisibility=!1,this.ReplaceVisibility=!1,this.ApproveVisibility=!0,this.AppDisplayMessage="",this.AppMessageVisibility=!1,this.Remarks.Text="",a.a.page.ShowDialog(this,y.a,{ShowCenter:!0,HideClose:!0,NoWidth:!0,Title:a.a.GetResource("ApproveReject")});else if("CancelAction"==e)this.ApproveVisibility=!1,a.a.page.HideDialog(),null!=this.DB&&(this.ShowRightPanel=!1);else if("Barcode"==e){if(null==this.EditGrid.Table)return;var i=this.EditGrid.Table.filter((function(e){return 1==e.Select||1==e.Select}));if(0==i.length)return void(this.DisplayMessage="No Rows Selected");this.CostCenterID>4e4&&this.CostCenterID<5e4&&this.BarcodeDocument(i)}}},{key:"RefreshData",value:function(){var e=this;if(this.DisplayMessage="",2==this.CostCenterID?(this.PrimaryKey="AccountID",this.PrimaryColumns="D.AccountID,D.AccountCode,D.AccountName,D.AccountTypeID,D.IsGroup,D.StatusID,D.GUID"):3==this.CostCenterID?(this.PrimaryKey="ProductID",this.PrimaryColumns="D.ProductID,D.ProductCode,D.ProductName,D.ProductTypeID,D.GUID"):16==this.CostCenterID?(this.PrimaryKey="BatchID",this.PrimaryColumns="D.BatchID,D.BatchCode,D.BatchNumber, CONVERT(DATETIME,D.MfgDate) MfgDate, D.ProductID,CONVERT(DATETIME, D.ExpiryDate) ExpiryDate, D.MRPRate, D.RetailRate, D.StockistRate,CONVERT(DATETIME, D.RetestDate) RetestDate, D.GUID"):this.CostCenterID>5e4?(this.PrimaryKey="NodeID",this.PrimaryColumns="D.NodeID,D.Code,D.Name,D.StatusID,D.GUID"):92==this.CostCenterID?(this.PrimaryKey="NodeID",this.PrimaryColumns="D.*"):93==this.CostCenterID?(this.PrimaryKey="UnitID",this.PrimaryColumns="D.*"):94==this.CostCenterID?(this.PrimaryKey="TenantID",this.PrimaryColumns="D.*"):95==this.CostCenterID?(this.PrimaryKey="ContractID",this.PrimaryColumns="D.ContractID,D.SNO,D.ContractNumber,D.StatusID,D.GUID"):(this.PrimaryKey=0==s.e.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?"AccDocDetailsID":"InvDocDetailsID",this.PrimaryColumns=this.IsDetailVoucher?0==s.e.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?"D.AccDocDetailsID,D.VoucherNo":"D.InvDocDetailsID,D.VoucherNo":"D.VoucherNo"),this.Report.length>0)return this.ReportFilterVisible=!1,this.EditGrid.Visible=!0,void this.LoadDataFromReport();var t,n,i,r,l="",u="",D=0;this.Entities.Clear(),this.Entities.push(this.MainTableName,"D"),l+=this.PrimaryColumns,u+=this.MainTableName+" D with(nolock)",this.SelectedFields.forEach((function(c){if(i="T"+D,n=s.e.String(c.SysTableName),t=s.e.String(c.SysColumnName),2==e.CostCenterID||3==e.CostCenterID||16==e.CostCenterID||92==e.CostCenterID||93==e.CostCenterID||94==e.CostCenterID||95==e.CostCenterID||e.CostCenterID>=50001)if(n=n.toUpperCase(),0==s.e.stringCompare(n,"ACC_ACCOUNTSEXTENDED")||0==s.e.stringCompare(n,"INV_PRODUCTEXTENDED")||0==s.e.stringCompare(n,"REN_PROPERTYEXTENDED")||0==s.e.stringCompare(n,"REN_UNITSEXTENDED")||0==s.e.stringCompare(n,"REN_TENANTEXTENDED")||0==s.e.stringCompare(n,"REN_CONTRACTEXTENDED"))if(e.Entities.ContainsKey(n)||(e.Entities.push(n,"EXT"),u+=95==e.CostCenterID?" INNER JOIN "+n+" EXT with(nolock) ON EXT.NODEID=D."+e.PrimaryKey:" INNER JOIN "+n+" EXT with(nolock) ON EXT."+e.PrimaryKey+"=D."+e.PrimaryKey),t="EXT."+t,"DATE"==s.e.String(c.ColumnDataType))l+=",'' AS C"+D,l+=","+(t="convert(datetime,"+t+")")+" AS C"+D+"_Key";else if("LISTBOX"==s.e.String(c.UserColumnType)){var d;if("44"==s.e.String(c.ColumnCostCenterID))d=",case when "+t+" is not null and isnumeric("+t+")=1 then (SELECT Name FROM COM_Lookup with(nolock) WHERE NodeID="+t+") else '' end";else{var C=a.a.report.GetTableColumns(parseInt(c.ColumnCostCenterID));d=C.ColumnName,r=C.PrimaryKey,n=C.TableName,d=",case when "+t+" is not null and isnumeric("+t+")=1 then (SELECT "+d+" FROM "+n+" with(nolock) WHERE "+r+"="+t+") else '' end"}l+=d+" AS C"+D,l+=",case when isnumeric("+t+")=1 then "+t+" else convert(bigint,-1) end AS C"+D+"_Key"}else l+=","+t+" AS C"+D;else 0==s.e.stringCompare(n,"COM_CCCCDATA")?(e.Entities.ContainsKey("COM_CCCCDATA")||(e.Entities.push("COM_CCCCDATA","CCDATA"),u+=" INNER JOIN COM_CCCCData CCDATA with(nolock) ON CCDATA.NodeID=D."+e.PrimaryKey+" AND CCDATA.CostCenterID="+e.CostCenterID),e.Entities.ContainsKey(t)||(e.Entities.push(t,i),u+=" INNER JOIN "+s.e.GetTagTableName(parseInt(c.ParentCostCenterID))+" "+i+" with(nolock) ON "+i+".NodeID=CCDATA."+t),l+=","+e.Entities[t]+".Name AS C"+D,l+=",CCDATA."+t+" AS C"+D+"_Key"):0==s.e.stringCompare(n,"COM_ADDRESS")?(e.Entities.ContainsKey("COM_ADDRESS")||(e.Entities.push("COM_ADDRESS","CCADD"),l+=",CCADD.AddressID",u+=" INNER JOIN COM_ADDRESS CCADD with(nolock) ON CCADD.AddressTypeID=1 and CCADD.FeaturePK=D."+e.PrimaryKey+" AND CCADD.FeatureID="+e.CostCenterID),l+=",CCADD."+t+" C"+D):null!=c.IsForeignKey&&Object(o.j)(c.IsForeignKey)?(e.Entities.ContainsKey(t)||(e.Entities.push(t,i),u+=" INNER JOIN "+s.e.String(c.ParentCostCenterSysName)+" "+e.Entities[t]+" with(nolock) ON "+e.Entities[t]+"."+s.e.String(c.ParentCostCenterColSysName)+"=D."+t),l+=","+e.Entities[t]+"."+e.GetColumnName(c)+" AS C"+D,l+=",D."+t+" AS C"+D+"_Key"):(t="D."+t,"DATE"==s.e.String(c.ColumnDataType)?(l+=",'' AS C"+D,l+=","+(t="convert(datetime,"+t+")")+" AS C"+D+"_Key"):("D.IsBillwise"==t&&(t="convert(int,"+t+")"),l+=","+t+" AS C"+D));else if(e.CostCenterID>4e4)if(0==s.e.stringCompare(n,"COM_DocTextData"))if(e.Entities.ContainsKey("COM_DocTextData")||(e.Entities.push("COM_DocTextData","TXT"),u+=" INNER JOIN COM_DocTextData TXT with(nolock) ON TXT."+e.PrimaryKey+"=D."+e.PrimaryKey),t=e.GetMaxColumn("TXT."+t,s.e.String(c.ColumnDataType)),"DATE"==s.e.String(c.ColumnDataType))l+=",'' AS C"+D,l+=","+(t="convert(datetime,"+t+")")+" AS C"+D+"_Key";else if("LISTBOX"==s.e.String(c.UserColumnType)){var h;if("44"==s.e.String(c.ColumnCostCenterID))h=",case when "+t+" is not null and isnumeric("+t+")=1 then (SELECT Name FROM COM_Lookup with(nolock) WHERE NodeID="+t+") else '' end";else{var p=a.a.report.GetTableColumns(parseInt(c.ColumnCostCenterID));h=p.ColumnName,r=p.PrimaryKey,n=p.TableName,h=",case when "+t+" is not null and isnumeric("+t+")=1 then (SELECT "+h+" FROM "+n+" with(nolock) WHERE "+r+"="+t+") else '' end"}l+=h+" AS C"+D,l+=",case when isnumeric("+t+")=1 then "+t+" else convert(bigint,-1) end AS C"+D+"_Key"}else"LOOKUP"==s.e.String(c.UserColumnType)?(l+=","+t+" AS C"+D,l+=","+t+" AS C"+D+"_Key"):"FLOAT"==s.e.String(c.ColumnDataType)?l+=",case when isnumeric("+t+")=1 then convert(float,"+t+") else null end AS C"+D:l+=","+t+" AS C"+D;else 0==s.e.stringCompare(n,"COM_DocNumData")?(e.Entities.ContainsKey("COM_DocNumData")||(e.Entities.push("COM_DocNumData","NUM"),u+=" INNER JOIN COM_DocNumData NUM with(nolock) ON NUM."+e.PrimaryKey+"=D."+e.PrimaryKey),t=e.GetMaxColumn("NUM."+t,s.e.String(c.ColumnDataType)),l+=","+t+" AS C"+D):0==s.e.stringCompare(n,"COM_DocCCData")?(e.Entities.ContainsKey("COM_DocCCData")||(e.Entities.push("COM_DocCCData","DCC"),r=0==s.e.stringCompare(e.MainTableName,"ACC_DocDetails",!0)?"AccDocDetailsID":"InvDocDetailsID",u+=" INNER JOIN COM_DocCCData DCC with(nolock) ON DCC."+r+"=D."+r),e.Entities.ContainsKey(t)||(e.Entities.push(t,i),u+=" INNER JOIN "+s.e.GetTagTableName(parseInt(c.ParentCostCenterID))+" "+i+" with(nolock) ON "+i+".NodeID=DCC."+t),"YES"==s.e.String(c.ShowCode)?l+=","+e.GetMaxColumn(e.Entities[t]+".Code","")+" AS C"+D:l+=","+e.GetMaxColumn(e.Entities[t]+".Name","")+" AS C"+D,l+=","+e.GetMaxColumn("DCC."+t,"")+" AS C"+D+"_Key"):null!=c.IsForeignKey&&Object(o.j)(c.IsForeignKey)&&0==["AccountTypeID","StatusID"].Contains(t)?(e.Entities.ContainsKey(t)||(e.Entities.push(t,i),u+=" INNER JOIN "+s.e.String(c.ParentCostCenterSysName)+" "+e.Entities[t]+" with(nolock) ON "+e.Entities[t]+"."+s.e.String(c.ParentCostCenterColSysName)+"=D."+t,s.e.IsEmpty(c.ParentCostCenterSysName)||"inv_product"!=s.e.String(c.ParentCostCenterSysName).toLowerCase()||(e.IsProductExists=!0)),l+=","+e.GetMaxColumn(e.Entities[t]+"."+e.GetColumnName(c),"")+" AS C"+D,l+=","+e.GetMaxColumn("D."+t,"")+" AS C"+D+"_Key"):(t=e.GetMaxColumn("D."+t,s.e.String(c.ColumnDataType)),"DATE"==s.e.String(c.ColumnDataType)?(l+=",'' AS C"+D,l+=","+(t="convert(datetime,"+t+")")+" AS C"+D+"_Key"):l+=","+t+" AS C"+D);D++})),3!=this.CostCenterID&&!this.IsProductExists||this.HideProductImage||(this.ProductImageVisibility=!0,this.ReplaceVisibility=!1,this.ApproveVisibility=!1,l+=this.IsDetailVoucher||3==this.CostCenterID?",f.GUID FileGUID, f.FileExtension FileExtension":",max(f.GUID) FileGUID, max(f.FileExtension) FileExtension",u+=" left join com_files f with(nolock) on F.featureid=3 and featurepk=d.productid  and f.isProductImage=1 and f.isDEfaultImage=1 "),this.IsDocument&&this.IsLWApproval&&(l+=",D.WorkflowID"),l="SELECT "+l,l+=" FROM "+u.toString(),l+=" WHERE 1=1",this.CostCenterID>4e4&&this.CostCenterID<5e4&&(l+=" AND D.CostCenterID="+this.CostCenterID,this.FromDate.Visible&&(l+=" AND D.DocDate>=convert(float,convert(datetime,'"+this.FromDate.Date.ToString("dd MMM yyyy")+"'))",l+=" AND D.DocDate<=convert(float,convert(datetime,'"+this.ToDate.Date.ToString("dd MMM yyyy")+"'))"));var c=this.StaticFilter.GetWhere(u,100).Trim();c.length>0&&(l+=" AND ("+c+")");var d=this.Filter.GetWhere(u,500).Trim();d.length>0&&(l+=" AND ("+d+")"),2==this.CostCenterID?l+=" ORDER BY D.AccountName":3==this.CostCenterID?l+=" ORDER BY D.ProductName":16==this.CostCenterID?l+=" ORDER BY D.BatchNumber":92==this.CostCenterID||93==this.CostCenterID?l+=" ORDER BY D.Name":94==this.CostCenterID?l+=" ORDER BY D.FirstName":this.CostCenterID>=50001?l+=" ORDER BY D.Name":this.CostCenterID>4e4&&(this.IsDetailVoucher?l+=" ORDER BY D.DocDate,D.VoucherNo,D.DocSeqNo":(l+=" GROUP BY D.DocDate,D.VoucherNo",l+=" ORDER BY D.DocDate,D.VoucherNo"));try{this.EditGrid.Clear(),l=l.Replace("%","~");var C,h,p=a.a.common.GetDataSetQuery(l.toString());p.Columns[0].push("Select"),p.Columns[0].push("Message"),p.Tables[0].forEach((function(t){t.Select=!1,e.DateColIDs.forEach((function(e){C=e+"_Key",!s.e.IsEmpty(t[C])&&t[C].toString().length>0&&(h=new Date(t[C]),t[e]=h.ToString(a.a.SessionManager.Preferences["Date Format"]))}))}));for(var m=0;m<p.Tables[0].length;m++)p.Tables[0][m].id=m+1;this.EditGrid.Table.AddRange(p.Tables[0]),p.Columns&&p.Columns.length>0&&(this.EditGrid.TableColumns=p.Columns[0]),this.EditGrid.refreshDataView()}catch(I){this.DisplayMessage="Error in loading data",Logger.ErrorLog("Bulk Edit-RefreshData:",I.Message)}}},{key:"ShowEditGrid",value:function(){this.ReportFilterVisible=!1,this.EditGrid.Visible=!0}},{key:"LoadDataFromReport",value:function(){var e,t,n=this;if(this.cprimary=null,this.EditGrid.Clear(),this.IsDocument){if(this.EditGrid.TableColumns.Contains("Message")||(this.EditGrid.TableColumns.push("Select"),this.EditGrid.TableColumns.push("Message")),this.IsDetailVoucher?(this.cprimary=this.Report[0].BaseReportColumns.find((function(e){return"2"==e.LinkType.SelectedValue})),this.EditGrid.TableColumns.Contains("ReportPK")||this.EditGrid.TableColumns.push("ReportPK"),this.IsLWApproval&&!this.EditGrid.TableColumns.Contains("WorkFlowID")&&this.EditGrid.TableColumns.push("WorkFlowID")):this.cprimary=this.Report[0].BaseReportColumns.find((function(e){return"1"==e.LinkType.SelectedValue||"2"==e.LinkType.SelectedValue})),null==this.cprimary||null==this.cprimary)return void(this.DisplayMessage="Please set voucher no column link type as "+(this.IsDetailVoucher?"'Document Detail'":"'Document'"));var i=this.EditGrid.Columns.find((function(e){return e.OPParams==n.cprimary.ID}));if(null==i&&null==i)return void(this.DisplayMessage="Please select voucher no column");this.strVoucherNo=i.SectionName}else if(this.EditGrid.TableColumns.Contains("ReportPK")||(this.EditGrid.TableColumns.push("ReportPK"),this.EditGrid.TableColumns.push("Select"),this.EditGrid.TableColumns.push("Message")),this.cprimary=this.Report[0].BaseReportColumns.find((function(e){return(e.CDGDO.CategoryValue==n.CostCenterID||e.CDGDO.ColumnCostCenterID==n.CostCenterID||null!=e.CDGDO.ChildCDGDO&&e.CDGDO.ChildCDGDO.CategoryValue==n.CostCenterID)&&("3"==e.LinkType.SelectedValue||"4"==e.LinkType.SelectedValue)})),null==this.cprimary)return void(this.DisplayMessage="Please set dimension column link type");for(var o=new r.a,l=new r.a,u=function(e){var t=n.EditGrid.Columns[e];if(null==t.OPParams)return"continue";var i=n.Report[0].BaseReportColumns.find((function(e){return e.ID==t.OPParams}));null!=i&&l.push(t.OPParams,i)},D=0;D<this.EditGrid.Columns.length;D++)u(D);for(var c=0;c<this.Report[0].Data.length;c++){var d=this.Report[0].Data[c];if(d.Type==p.f.Detail){(t=this.EditGrid.NewRow()).Select=!1,null!=d.DataRow&&null!=d.DataRow[this.cprimary.ID+"_ID"]&&s.e.String(d.DataRow[this.cprimary.ID+"_ID"]).length>0&&null!=t.ReportPK&&(t.ReportPK=d.DataRow[this.cprimary.ID+"_ID"]),this.IsLWApproval&&(t.WorkFlowID=d.DataRow.WorkFlowID),null!=this.Report[0].LevelColumn&&d.IsGroup&&(t.Row_Foreground=null);for(var C=function(i){var l=n.EditGrid.Columns[i];if(null!=l.OPParams)if("LISTBOX"==l.DataType){if(null!=d.DataRow&&null!=d.DataRow[l.OPParams])if(t[l.DisplayMember]=d.DataRow[l.OPParams],null!=d.DataRow[l.OPParams+"_ID"])t[l.DisplayMember+"_Key"]=d.DataRow[l.OPParams+"_ID"];else if(o.ContainsKey(l.OPParams)||o.push(l.OPParams,new r.a),o[l.OPParams].ContainsKey(s.e.String(d.DataRow[l.OPParams])))t[l.DisplayMember+"_Key"]=o[l.OPParams][s.e.String(d.DataRow[l.OPParams])];else if(n.dvFields=n.dvFieldsNew.filter((function(e){return e.CostCenterColID==l.CrRefID})),n.dvFields.length>0){var u=a.a.common.GetDataSet3("BULK001",s.e.String(n.dvFields[0].ParentCostCenterColSysName),s.e.String(n.dvFields[0].ParentCostCenterSysName),s.e.String(d.DataRow[l.OPParams])).Tables[0];u.length>0&&!s.e.IsEmpty(u.ID)&&(o[l.OPParams].push(s.e.String(d.DataRow[l.OPParams]),parseInt(u[0].ID)),t[l.DisplayMember+"_Key"]=o[l.OPParams][s.e.String(d.DataRow[l.OPParams])])}}else"DATE"==l.DataType?null!=d.DataRow&&null!=d.DataRow[l.OPParams]&&!s.e.IsEmpty(d.DataRow[l.OPParams])&&s.e.String(d.DataRow[l.OPParams]).length>0&&(e=new Date(d.DataRow[l.OPParams]),t[l.DisplayMember]=e.ToString(a.a.SessionManager.Preferences["Date Format"]),t[l.DisplayMember+"_Key"]=e):"ComboBox"==l.DataType?null!=d.DataRow&&null!=d.DataRow[l.OPParams]&&(t[l.ValueBinding]=d.DataRow[l.OPParams]):null!=d.DataRow&&null!=d.DataRow[l.OPParams]&&(t[l.DisplayMember]=d.DataRow[l.OPParams])},h=0;h<this.EditGrid.Columns.length;h++)C(h);this.EditGrid.addRow(t)}}}},{key:"GetColumnName",value:function(e){var t,n;return t="parentid"==s.e.String(e.SysColumnName).toLowerCase()?this.CostCenterID:parseInt(e.ColumnCostCenterID),n=s.e.IntTryParse(s.e.String(e.ParentCCDefaultColID)),2==t?238==n?"AccountCode":"AccountName":3==t?261==n?"ProductCode":"ProductName":93==t?25624==n?"Code":"Name":94==t?25697==n?"FirstName":"LastName":16==t?"BatchNumber":"Name"}},{key:"GetMaxColumn",value:function(e,t){return this.IsDetailVoucher||(e="FLOAT"!=t||e.Contains("dcAlpha")?"max("+e+")":"sum("+e+")"),e}},{key:"SaveDocument",value:function(e){var t,n,i,r=this,o="",l="",u="",D=0;i=0==s.e.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?"AccDocDetailsID":"InvDocDetailsID",n=null!=this.ReportObj?"ReportPK":i;var c=s.e.NewGuid();e.forEach((function(d){if(D++,u="",l="",o="",r.EditColumns.forEach((function(e){"LISTBOX"==e.DataType&&0!=e.CostCenterID&&e.ID.toLowerCase().startsWith("dcccnid")?l+=e.ID+"="+s.e.String(d[e.ValueMember])+",":e.IsColumnUserDefined?"SELECTIONBOX"==e.DataType?o+=e.ID+"=N'"+s.e.String(d[e.DisplayMember]).Replace("'","''")+"',":e.DisplayMember.toLowerCase().Contains("dcnum")||("DATE"==e.DataType?s.e.IsEmpty(d[e.DisplayMember+"_Key"])||(o+=e.ID+"='"+new Date(d[e.DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy")+"',"):"DATETIME"==e.DataType||"TIME"==e.DataType?s.e.IsEmpty(d[e.DisplayMember+"_Key"])||(o+=e.ID+"='"+new Date(d[e.DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy hh:mm:ss tt")+"',"):o+="ComboBox"==e.DataType?e.ID+"=N'"+s.e.String(d[e.ValueBinding]).Replace("'","''")+"',":"PactComboBox"==e.DataType?e.ID+"=N'"+s.e.String(d[e.ValueBinding+"_Key"]).Replace("'","''")+"',":"LISTBOX"==e.DataType&&0!=e.CostCenterID?e.ID+"='"+s.e.String(d[e.ValueMember]).Replace("'","''")+"',":e.ID+"=N'"+s.e.String(d[e.DisplayMember]).Replace("'","''")+"',"):r.docAllowCols.Contains(e.ID.toLowerCase())&&("DATE"==e.DataType?s.e.IsEmpty(d[e.DisplayMember+"_Key"])||(u+=e.ID+"=CONVERT(INT,CONVERT(DATETIME,'"+new Date(d[e.DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy")+"')),"):u+=e.ID+"=N'"+s.e.String(d[e.DisplayMember]).Replace("'","''")+"',")})),o.length>0||l.length>0||u.length>0){o.length>0&&(o=(o=o.substr(0,o.length-1)).Insert(0,"UPDATE COM_DocTextData SET "),o+=" FROM "+r.MainTableName+" D INNER JOIN COM_DocTextData TXT ON D."+i+"=TXT."+i,r.IsDetailVoucher?(o+=" WHERE ",0==s.e.stringCompare(r.MainTableName,"ACC_DocDetails",!0)?o+="D.AccDocDetailsID="+s.e.String(d[n]):o+="D.InvDocDetailsID="+s.e.String(d[n])):o+=" WHERE VoucherNo='"+s.e.String(d[r.strVoucherNo])+"'"),l.length>0&&(l=(l=l.substr(0,l.length-1)).Insert(0,"   UPDATE COM_DocCCData SET "),l+=" FROM "+r.MainTableName+" D INNER JOIN COM_DocCCData TXT ON D."+i+"=TXT."+i,r.IsDetailVoucher?(l+=" WHERE ",0==s.e.stringCompare(r.MainTableName,"ACC_DocDetails",!0)?l+="D.AccDocDetailsID="+s.e.String(d[n]):l+="D.InvDocDetailsID="+s.e.String(d[n])):l+=" WHERE VoucherNo='"+s.e.String(d[r.strVoucherNo])+"'"),o+=l.toString(),u.length>0&&(u=(u=u.substr(0,u.length-1)).Insert(0,"   UPDATE "+r.MainTableName+" SET "),r.IsDetailVoucher?(u+=" WHERE ",0==s.e.stringCompare(r.MainTableName,"ACC_DocDetails",!0)?u+="AccDocDetailsID="+s.e.String(d[n]):u+="InvDocDetailsID="+s.e.String(d[n])):u+=" WHERE VoucherNo='"+s.e.String(d[r.strVoucherNo])+"'"),o+=u.toString();try{var C,h=null;h=C=D==e.length||s.e.String(d[r.strVoucherNo])!=s.e.String(e[D][r.strVoucherNo])?a.a.common.BulkEditDetals_7(7,r.ID,r.CostCenterID,c,o.toString(),s.e.String(d[r.strVoucherNo]),""):a.a.common.BulkEditDetals_7(7,r.ID,r.CostCenterID,c,o.toString(),"",""),t=s.e.Int(C.obj),d.Message=t>0?"Success":h&&h.Tables.length>0&&h.Tables[0].length>0&&h.Columns[0].Contains("ServerMessage")?"Failure : "+s.e.String(h.Tables[0][0].ServerMessage):h&&h.Tables.length>0&&h.Tables[0].length>0&&h.Columns[0].Contains("ErrorMessage")?"Failure : "+s.e.String(h.Tables[0][0].ErrorMessage):"Failure",r.EditGrid.updateRow(d)}catch(p){Logger.ErrorLog("BulkEdit-SAVE: ",p.Message)}}else d.Message="NO DATA",r.EditGrid.updateRow(d)}))}},{key:"SaveDimension",value:function(e){for(var t,n=this,i="",r="",l="",u="",D="",c=function(c){var d=e[c];if(r="",l="",u="",D="",n.EditColumns.forEach((function(e){"SELECTIONBOX"==e.DataType?e.ID.toLowerCase().Contains("alpha")?l+=e.ID+"='"+s.e.String(d[e.DisplayMember]).Replace("'","''")+"',":r+=e.ID+"='"+s.e.String(d[e.DisplayMember]).Replace("'","''")+"',":"DATE"==e.DataType?s.e.IsEmpty(d[e.DisplayMember+"_Key"])||(e.ID.toLowerCase().Contains("alpha")?l+=e.ID+"='"+new Date(d[e.DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy")+"',":16==n.CostCenterID&&(e.ID.Contains("MfgDate")||e.ID.Contains("ExpiryDate")||e.ID.Contains("RetestDate"))||(r+=e.ID+"='"+new Date(d[e.DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy")+"',")):"DATETIME"==e.DataType||"TIME"==e.DataType?s.e.IsEmpty(d[e.DisplayMember+"_Key"])||(e.ID.toLowerCase().Contains("alpha")?l+=e.ID+"='"+new Date(d[e.DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy hh:mm:ss tt")+"',":16==n.CostCenterID&&(e.ID.Contains("MfgDate")||e.ID.Contains("ExpiryDate")||e.ID.Contains("RetestDate"))||(r+=e.ID+"='"+new Date(d[e.DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy")+"',")):"ComboBox"==e.DataType?e.ID.toLowerCase().Contains("alpha")?l+=e.ID+"='"+s.e.String(d[e.ValueBinding]).Replace("'","''")+"',":r+=e.ID+"='"+s.e.String(d[e.ValueBinding]).Replace("'","''")+"',":"PactComboBox"==e.DataType?e.ID.toLowerCase().Contains("alpha")?l+=e.ID+"='"+s.e.String(d[e.ValueBinding+"_Key"]).Replace("'","''")+"',":r+=e.ID+"='"+s.e.String(d[e.ValueBinding+"_Key"]).Replace("'","''")+"',":"LISTBOX"==e.DataType&&0!=e.CostCenterID?e.ID.toLowerCase().Contains("alpha")?l+=e.ID+"='"+s.e.String(d[e.ValueMember]).Replace("'","''")+"',":e.ID.toLowerCase().startsWith("ccnid")?u+=e.ID+"="+s.e.String(d[e.ValueMember])+",":r+=e.ID+"="+s.e.String(d[e.ValueMember])+",":n.AddressFields.Contains(e.SectionName)?D+=e.ID+"='"+s.e.String(d[e.DisplayMember]).Replace("'","''")+"',":e.IsColumnUserDefined?l+=e.ID+"='"+s.e.String(d[e.DisplayMember]).Replace("'","''")+"',":r+=e.ID+"='"+s.e.String(d[e.DisplayMember]).Replace("'","''")+"',"})),r.length>0||l.length>0||u.length>0||D.length>0)try{if(t=0,null!=n.ReportObj){if(null==d.ReportPK)return"continue";var h=a.a.common.GetDataSet3("BULK002",n.PrimaryColumns,n.MainTableName,n.PrimaryKey+","+s.e.String(d.ReportPK)).Tables[0];if(0==h.length)return"continue";h.Columns.forEach((function(e){n.EditGrid.TableColumns.Contains(e.ColumnName)||n.EditGrid.TableColumns.push(e.ColumnName),d[e.ColumnName]=h[0][e.ColumnName]}))}if(2==n.CostCenterID){var p={};p.AccountID=parseInt(d.AccountID),p.GUID=s.e.String(d.GUID),C=n.EditColumns.find((function(e){return"AccountCode"==e.ID})),p.AccountCode=s.e.String(null!=C?d[C.DisplayMember]:d.AccountCode),p.CodePrefix=p.AccountCode,C=n.EditColumns.find((function(e){return"AccountName"==e.ID})),p.AccountName=s.e.String(null!=C?d[C.DisplayMember]:d.AccountName),C=n.EditColumns.find((function(e){return"StatusID"==e.ID})),p.StatusID=null!=C&&s.e.String(d[C.ValueBinding]).length>0?parseInt(d[C.ValueBinding]):parseInt(d.StatusID),C=n.EditColumns.find((function(e){return"AccountTypeID"==e.ID})),p.AccountTypeID=null!=C&&s.e.String(d[C.ValueBinding]).length>0?parseInt(d[C.ValueBinding]):parseInt(d.AccountTypeID),p.IsGroup=Object(o.j)(d.IsGroup),p.StaticFieldsQuery=r.toString(),p.CustomFieldsQuery=l.toString(),p.CustomCostCenterFieldsQuery=u.toString(),D.length>0&&(D=D.substr(0,D.length-1),D=' <Data><Row Action="MODIFY" AddressID="'+s.e.String(d.AddressID)+'" AddressTypeID="1"  StaticFields ="'+D,D+='"/></Data>'),p.AddressXML=D.toString(),p.CCMapXML=null,a.a.accounting.SaveAccount(p,"SaveAccountQuick").subscribe((function(e){if(i=e.Message,(t=e.RetValue)>0){d.Message="Success",n.EditGrid.updateRow(d);var r=a.a.common.BulkEditDetals_7(8,t,n.CostCenterID,"","","","").ds;null!=r&&r.Tables.length>0&&r.Tables[0].length>0&&r.Columns[0].Contains("GUID")&&(d.GUID=s.e.String(r.Tables[0][0].GUID))}else d.Message="Failure : "+i,n.EditGrid.updateRow(d)}),(function(e){alert(JSON.stringify(e)),console.log("Bulk Edit Account Save : "+JSON.stringify(e))}))}else if(3==n.CostCenterID){var m={};m.ProductID=parseInt(d.ProductID),m.GUID=s.e.String(d.GUID);var I=n.EditColumns.find((function(e){return"ProductCode"==e.ID}));m.ProductCode=s.e.String(null!=I?d[I.DisplayMember]:d.ProductCode),m.CodePrefix=m.ProductCode,I=n.EditColumns.find((function(e){return"ProductName"==e.ID})),m.ProductName=s.e.String(null!=I?d[I.DisplayMember]:d.ProductName),I=n.EditColumns.find((function(e){return"ProductTypeID"==e.ID})),m.ProductType=null!=I&&s.e.String(d[I.ValueBinding]).length>0?parseInt(d[I.ValueBinding]):parseInt(d.ProductTypeID),m.CustomFieldsQuery=l.toString(),m.CustomCostCenterFieldsQuery=u.toString(),m.CCCCMapDATA=null,a.a.inventory.AddProduct("","SetProductQuick").subscribe((function(e){if(i=e.Message,(t=e.RetValue)>0){d.Message="Success",n.EditGrid.updateRow(d);var r=a.a.common.BulkEditDetals_7(8,t,n.CostCenterID,"","","","").ds;null!=r&&r.Tables.length>0&&r.Tables[0].length>0&&r.Columns[0].Contains("GUID")&&(d.GUID=s.e.String(r.Tables[0][0].GUID))}else d.Message="Failure : "+i,n.EditGrid.updateRow(d)}),(function(e){alert(JSON.stringify(e)),console.log("Bulk Edit Quick Product Save : "+JSON.stringify(e))}))}else if(16==n.CostCenterID){var g={};g.BatchID=parseInt(d.BatchID),g.GUID=s.e.String(d.GUID),C=n.EditColumns.find((function(e){return"BatchCode"==e.ID})),g.BatchCode=s.e.String(null!=C?d[C.DisplayMember]:d.BatchCode),g.CodePrefix=g.BatchCode,g.StaticFieldsQuery=r.toString(),g.CustomFieldsQuery=l.toString(),g.CustomCostCenterFieldsQuery=u.toString();var y=[];y.push(s.e.String(d.BatchNumber)),C=n.EditColumns.find((function(e){return"MfgDate"==e.ID})),y.push(null!=C?new Date(s.e.String(d[C.DisplayMember+"_Key"])).ToString("dd/MMM/yyyy"):s.e.IsEmpty(d.MfgDate)?"1/JAN/1900":new Date(d.MfgDate.toString()).ToString("dd/MMM/yyyy")),C=n.EditColumns.find((function(e){return"ExpiryDate"==e.ID})),y.push(null!=C?new Date(s.e.String(d[C.DisplayMember+"_Key"])).ToString("dd/MMM/yyyy"):s.e.IsEmpty(d.ExpiryDate)?"1/JAN/1900":new Date(d.ExpiryDate.toString()).ToString("dd/MMM/yyyy")),C=n.EditColumns.find((function(e){return"MRPRate"==e.ID})),y.push(null!=C?parseFloat(s.e.String(d[C.DisplayMember])):parseFloat(s.e.String(d.MRPRate))),C=n.EditColumns.find((function(e){return"RetailRate"==e.ID})),y.push(null!=C?parseFloat(s.e.String(d[C.DisplayMember])):parseFloat(s.e.String(d.RetailRate))),C=n.EditColumns.find((function(e){return"StockistRate"==e.ID})),y.push(null!=C?parseFloat(s.e.String(d[C.DisplayMember])):parseFloat(s.e.String(d.StockistRate))),y.push(s.e.String(d.ProductID)),C=n.EditColumns.find((function(e){return"RetestDate"==e.ID})),y.push(null!=C?new Date(s.e.String(d[C.DisplayMember+"_Key"])).ToString("dd/MMM/yyyy"):s.e.IsEmpty(d.RetestDate)?null:new Date(d.RetestDate.toString()).ToString("dd/MMM/yyyy")),y.push(0),g.StaticFieldsQuery=r.toString(),g.CustomFieldsQuery=l.toString(),g.CustomCostCenterFieldsQuery=u.toString()}else if(92==n.CostCenterID){var S={};S.PropertyID=parseInt(d.NodeID),S.GUID=d.GUID.toString(),S.IsGroup=Object(o.j)(d.IsGroup);var T=n.EditColumns.find((function(e){return"Code"==e.ID}));S.Code=null!=T?d[T.DisplayMember].toString():d.Code.toString(),T=n.EditColumns.find((function(e){return"Name"==e.ID})),S.Name=null!=T?d[T.DisplayMember].toString():d.Name.toString(),T=n.EditColumns.find((function(e){return"Status"==e.ID})),S.StatusID=null!=T&&d[T.ValueBinding].toString().length>0?parseInt(d[T.ValueBinding]):parseInt(d.Status),S.DetailsXML=r.toString(),S.CustomFieldsQuery=l.toString(),S.CustomCostCenterFieldsQuery=u.toString(),a.a.rental.SaveProperty(S,"SaveProperty").subscribe((function(e){n.DisplayMessage=e.Message,n.MessageVisibility=!0}),(function(e){console.log(" Property Save : "+JSON.stringify(e))}))}else if(93==n.CostCenterID){var b={};b.UnitID=parseInt(d.UnitID),b.GUID=d.GUID.toString(),b.IsGroup=Object(o.j)(d.IsGroup),C=n.EditColumns.find((function(e){return"PropertyID"==e.ID})),b.Property=null!=C&&d[C.ValueBinding].toString().length>0?parseInt(d[C.ValueBinding]):!s.e.IsEmpty(d.PropertyID)&&d.PropertyID.toString().length>0?parseInt(d.PropertyID):0,C=n.EditColumns.find((function(e){return"Code"==e.ID})),b.Code=null!=C?d[C.DisplayMember].toString():d.Code.toString(),C=n.EditColumns.find((function(e){return"Name"==e.ID})),b.Name=null!=C?d[C.DisplayMember].toString():d.Name.toString(),C=n.EditColumns.find((function(e){return"Status"==e.ID})),b.StatusID=null!=C&&d[C.ValueBinding].toString().length>0?parseInt(d[C.ValueBinding]):parseInt(d.Status),C=n.EditColumns.find((function(e){return"NodeID"==e.ID})),b.UnitType=null!=C&&d[C.ValueBinding].toString().length>0?parseInt(d[C.ValueBinding]):!s.e.IsEmpty(d.NodeID)&&d.NodeID.toString().length>0?parseInt(d.NodeID):0,C=n.EditColumns.find((function(e){return"UnitType"==e.ID})),b.TypeofUnit=null!=C&&d[C.ValueBinding].toString().length>0?parseInt(d[C.ValueBinding]):!s.e.IsEmpty(d.UnitType)&&d.UnitType.toString().length>0?parseInt(d.UnitType):0,C=n.EditColumns.find((function(e){return"UnitStatus"==e.ID})),b.UnitStatus=null!=C&&d[C.ValueBinding].toString().length>0?parseInt(d[C.ValueBinding]):!s.e.IsEmpty(d.UnitStatus)&&d.UnitStatus.toString().length>0?parseInt(d.UnitStatus):0,C=n.EditColumns.find((function(e){return"RentableArea"==e.ID})),b.RentalArea=null!=C&&d[C.DisplayMember].toString().length>0?parseFloat(d[C.DisplayMember]):!s.e.IsEmpty(d.RentableArea)&&d.RentableArea.toString().length>0?parseFloat(d.RentableArea):0,C=n.EditColumns.find((function(e){return"BuildUpArea"==e.ID})),b.BuildUpArea=null!=C&&d[C.DisplayMember].toString().length>0?parseFloat(d[C.DisplayMember]):!s.e.IsEmpty(d.BuildUpArea)&&d.BuildUpArea.toString().length>0?parseFloat(d.BuildUpArea):0,C=n.EditColumns.find((function(e){return"FloorLookupID"==e.ID})),b.Floor=null!=C&&d[C.ValueBinding].toString().length>0?parseInt(d[C.ValueBinding]):!s.e.IsEmpty(d.FloorLookupID)&&d.FloorLookupID.toString().length>0?parseInt(d.FloorLookupID):0,C=n.EditColumns.find((function(e){return"ViewLookupID"==e.ID})),b.View=null!=C&&d[C.ValueBinding].toString().length>0?parseInt(d[C.ValueBinding]):!s.e.IsEmpty(d.ViewLookupID)&&d.ViewLookupID.toString().length>0?parseInt(d.ViewLookupID):0,C=n.EditColumns.find((function(e){return"NoOfBathrooms"==e.ID})),b.NoOfBathrooms=null!=C&&d[C.DisplayMember].toString().length>0?parseFloat(d[C.DisplayMember]):!s.e.IsEmpty(d.NoOfBathrooms)&&d.NoOfBathrooms.toString().length>0?parseFloat(d.NoOfBathrooms):0,C=n.EditColumns.find((function(e){return"NoOfParkings"==e.ID})),b.NoOfParkings=null!=C&&d[C.DisplayMember].toString().length>0?parseFloat(d[C.DisplayMember]):!s.e.IsEmpty(d.NoOfParkings)&&d.NoOfParkings.toString().length>0?parseFloat(d.NoOfParkings):0,C=n.EditColumns.find((function(e){return"ElectricityCode"==e.ID})),b.ElectricityCode=null!=C?d[C.DisplayMember].toString():s.e.IsEmpty(d.ElectricityCode)?"":d.ElectricityCode.toString(),C=n.EditColumns.find((function(e){return"ElectricityKW"==e.ID})),b.Electricity=null!=C&&d[C.DisplayMember].toString().length>0?parseFloat(d[C.DisplayMember]):!s.e.IsEmpty(d.ElectricityKW)&&d.ElectricityKW.toString().length>0?parseFloat(d.ElectricityKW):0,C=n.EditColumns.find((function(e){return"Rent"==e.ID})),b.Amount=null!=C&&d[C.DisplayMember].toString().length>0?parseFloat(d[C.DisplayMember]):!s.e.IsEmpty(d.Rent)&&d.Rent.toString().length>0?parseFloat(d.Rent):0,C=n.EditColumns.find((function(e){return"RentTypeID"==e.ID})),b.AmountType=null!=C&&d[C.ValueBinding].toString().length>0?parseInt(d[C.ValueBinding]):!s.e.IsEmpty(d.RentTypeID)&&d.RentTypeID.toString().length>0?parseInt(d.RentTypeID):0,C=n.EditColumns.find((function(e){return"DiscountAmount"==e.ID})),b.Discount=null!=C&&d[C.DisplayMember].toString().length>0?parseFloat(d[C.DisplayMember]):!s.e.IsEmpty(d.DiscountAmount)&&d.DiscountAmount.toString().length>0?parseFloat(d.DiscountAmount):0,C=n.EditColumns.find((function(e){return"DiscountPercentage"==e.ID})),b.DiscountPercentage=null!=C&&d[C.DisplayMember].toString().length>0?parseFloat(d[C.DisplayMember]):!s.e.IsEmpty(d.DiscountPercentage)&&d.DiscountPercentage.toString().length>0?parseFloat(d.DiscountPercentage):0,C=n.EditColumns.find((function(e){return"AnnualRent"==e.ID})),b.AnnaulRent=null!=C&&d[C.DisplayMember].toString().length>0?parseFloat(d[C.DisplayMember]):!s.e.IsEmpty(d.AnnualRent)&&d.AnnualRent.toString().length>0?parseFloat(d.AnnualRent):0,C=n.EditColumns.find((function(e){return"MonthlyRent"==e.ID})),b.MonthlyRent=null!=C&&d[C.DisplayMember].toString().length>0?parseFloat(d[C.DisplayMember]):!s.e.IsEmpty(d.MonthlyRent)&&d.MonthlyRent.toString().length>0?parseFloat(d.MonthlyRent):0,C=n.EditColumns.find((function(e){return"RentPerSQFT"==e.ID})),b.RentperSqft=null!=C&&d[C.DisplayMember].toString().length>0?parseFloat(d[C.DisplayMember]):!s.e.IsEmpty(d.RentPerSQFT)&&d.RentPerSQFT.toString().length>0?parseFloat(d.RentPerSQFT):0,C=n.EditColumns.find((function(e){return"TermsConditions"==e.ID})),b.TermsConditions=null!=C?d[C.DisplayMember].toString():s.e.IsEmpty(d.TermsConditions)?"":d.TermsConditions.toString(),C=n.EditColumns.find((function(e){return"AccountantID"==e.ID})),b.Accountant=null!=C&&d[C.ValueBinding].toString().length>0?parseInt(d[C.ValueBinding]):!s.e.IsEmpty(d.AccountantID)&&d.AccountantID.toString().length>0?parseInt(d.AccountantID):0,C=n.EditColumns.find((function(e){return"SalesmanID"==e.ID})),b.Salesman=null!=C&&d[C.ValueBinding].toString().length>0?parseInt(d[C.ValueBinding]):!s.e.IsEmpty(d.SalesmanID)&&d.SalesmanID.toString().length>0?parseInt(d.SalesmanID):0,C=n.EditColumns.find((function(e){return"LandlordID"==e.ID})),b.Landlord=null!=C&&d[C.ValueBinding].toString().length>0?parseInt(d[C.ValueBinding]):!s.e.IsEmpty(d.LandlordID)&&d.LandlordID.toString().length>0?parseInt(d.LandlordID):0,C=n.EditColumns.find((function(e){return"RentalIncomeAccountID"==e.ID})),b.RentalIncomeAcc=null!=C&&d[C.ValueBinding].toString().length>0?parseInt(d[C.ValueBinding]):!s.e.IsEmpty(d.RentalIncomeAccountID)&&d.RentalIncomeAccountID.toString().length>0?parseInt(d.RentalIncomeAccountID):0,C=n.EditColumns.find((function(e){return"PenaltyAccountID"==e.ID})),b.PenaltyAcc=null!=C&&d[C.ValueBinding].toString().length>0?parseInt(d[C.ValueBinding]):!s.e.IsEmpty(d.PenaltyAccountID)&&d.PenaltyAccountID.toString().length>0?parseInt(d.PenaltyAccountID):0,C=n.EditColumns.find((function(e){return"RentalReceivableAccountID"==e.ID})),b.RentalReceivableAcc=null!=C&&d[C.ValueBinding].toString().length>0?parseInt(d[C.ValueBinding]):!s.e.IsEmpty(d.RentalReceivableAccountID)&&d.RentalReceivableAccountID.toString().length>0?parseInt(d.RentalReceivableAccountID):0,C=n.EditColumns.find((function(e){return"AdvanceRentAccountID"==e.ID})),b.AdvanceRentAcc=null!=C&&d[C.ValueBinding].toString().length>0?parseInt(d[C.ValueBinding]):!s.e.IsEmpty(d.AdvanceRentAccountID)&&d.AdvanceRentAccountID.toString().length>0?parseInt(d.AdvanceRentAccountID):0,C=n.EditColumns.find((function(e){return"ProvisionAccountID"==e.ID})),b.ProvisionAccountID=null!=C&&d[C.ValueBinding].toString().length>0?parseInt(d[C.ValueBinding]):!s.e.IsEmpty(d.ProvisionAccountID)&&d.ProvisionAccountID.toString().length>0?parseInt(d.ProvisionAccountID):0,C=n.EditColumns.find((function(e){return"BankAccount"==e.ID})),b.BankAcc=null!=C&&d[C.ValueBinding].toString().length>0?parseInt(d[C.ValueBinding]):!s.e.IsEmpty(d.BankAccount)&&d.BankAccount.toString().length>0?parseInt(d.BankAccount):0,C=n.EditColumns.find((function(e){return"BankLoanAccount"==e.ID})),b.BankLoanAcc=null!=C&&d[C.ValueBinding].toString().length>0?parseInt(d[C.ValueBinding]):!s.e.IsEmpty(d.BankLoanAccount)&&d.BankLoanAccount.toString().length>0?parseInt(d.BankLoanAccount):0,C=n.EditColumns.find((function(e){return"AdvanceReceivableAccountID"==e.ID})),b.AdvanceReceivableAcc=null!=C&&d[C.ValueBinding].toString().length>0?parseInt(d[C.ValueBinding]):!s.e.IsEmpty(d.AdvanceReceivableAccountID)&&d.AdvanceReceivableAccountID.toString().length>0?parseInt(d.AdvanceReceivableAccountID):0,C=n.EditColumns.find((function(e){return"AdvReceivableCloseAccID"==e.ID})),b.AdvReceivableCloseAcc=null!=C&&d[C.ValueBinding].toString().length>0?parseInt(d[C.ValueBinding]):!s.e.IsEmpty(d.AdvReceivableCloseAccID)&&d.AdvReceivableCloseAccID.toString().length>0?parseInt(d.AdvReceivableCloseAccID):0,C=n.EditColumns.find((function(e){return"RentalAccount"==e.ID})),b.RentAcc=null!=C&&d[C.ValueBinding].toString().length>0?parseInt(d[C.ValueBinding]):!s.e.IsEmpty(d.RentalAccount)&&d.RentalAccount.toString().length>0?parseInt(d.RentalAccount):0,C=n.EditColumns.find((function(e){return"RentPayableAccount"==e.ID})),b.RentPayableAcc=null!=C&&d[C.ValueBinding].toString().length>0?parseInt(d[C.ValueBinding]):!s.e.IsEmpty(d.RentPayableAccount)&&d.RentPayableAccount.toString().length>0?parseInt(d.RentPayableAccount):0,C=n.EditColumns.find((function(e){return"AdvanceRentPaid"==e.ID})),b.AdvanceRentPaid=null!=C&&d[C.ValueBinding].toString().length>0?parseInt(d[C.ValueBinding]):!s.e.IsEmpty(d.AdvanceRentPaid)&&d.AdvanceRentPaid.toString().length>0?parseInt(d.AdvanceRentPaid):0,C=n.EditColumns.find((function(e){return"TenantID"==e.ID})),b.TenantID=null!=C&&d[C.ValueBinding].toString().length>0?parseInt(d[C.ValueBinding]):!s.e.IsEmpty(d.TenantID)&&d.TenantID.toString().length>0?parseInt(d.TenantID):0,C=n.EditColumns.find((function(e){return"LocationID"==e.ID})),b.LocationID=null!=C&&d[C.ValueBinding].toString().length>0?parseInt(d[C.ValueBinding]):!s.e.IsEmpty(d.LocationID)&&d.LocationID.toString().length>0?parseInt(d.LocationID):0,C=n.EditColumns.find((function(e){return"BasedOn"==e.ID})),b.BasedOn=null!=C?d[C.DisplayMember].toString():d.BasedOn.toString(),b.PostIncome=s.e.String(d.PostIncome),b.CustomFieldsQuery=l.toString(),b.CustomCCQuery=u.toString(),a.a.rental.SaveUnits(b,"SaveUnits").subscribe((function(e){n.DisplayMessage=e.Message}),(function(e){console.log(" Unit Save : "+JSON.stringify(e))}))}else if(95==n.CostCenterID){l.Remove(l.length-1,1);var f=null;Object.keys(d).Contains("ContractID")&&(f=a.a.common.BulkEditDetals_7(11,parseInt(d.ContractID),n.CostCenterID,"",l.toString(),"","")),d.Message=f.retvalue&&f.retvalue>0?"Success":null!=f&&f.Tables.length>0&&f.Tables[0].length>0&&f.Columns[0].Contains("ServerMessage")?"Failure : "+f.Tables[0][0].ServerMessage.toString():null!=f&&f.Tables.length>0&&f.Tables[0].length>0&&f.Columns[0].Contains("ErrorMessage")?"Failure : "+f.Tables[0][0].ErrorMessage.toString():"Failure"}else if(n.CostCenterID>=50001&&n.CostCenterID<=50050){var E={};E.NodeID=parseInt(d.NodeID),E.GUID=s.e.String(d.GUID),E.CostCenterID=n.CostCenterID;var M=n.EditColumns.find((function(e){return"Code"==e.ID}));E.Code=s.e.String(null!=M?d[M.DisplayMember]:d.Code),M=n.EditColumns.find((function(e){return"Name"==e.ID})),E.Name=s.e.String(null!=M?d[M.DisplayMember]:d.Name),M=n.EditColumns.find((function(e){return"StatusID"==e.ID})),E.Status=null!=M&&s.e.String(d[M.ValueBinding]).length>0?parseInt(s.e.String(d[M.ValueBinding])):parseInt(d.StatusID),E.StaticFieldsQuery=r.toString(),E.CustomFieldsQuery=l.toString(),E.CustomCostCenterFieldsQuery=u.toString(),E.CCXML="",a.a.common.SaveCostCenterQuick(E,"SaveCostCenterQuick").subscribe((function(e){if(i=e.Message,(t=e.RetValue)>0){d.Message="Success",n.EditGrid.updateRow(d);var r=a.a.common.BulkEditDetals_7(8,t,n.CostCenterID,"","","","").ds;null!=r&&r.Tables.length>0&&r.Tables[0].length>0&&r.Columns[0].Contains("GUID")&&(d.GUID=s.e.String(r.Tables[0][0].GUID))}else d.Message="Failure : "+i,n.EditGrid.updateRow(d)}),(function(e){alert(JSON.stringify(e)),console.log("Bulk Quick Add CostCenter Save : "+JSON.stringify(e))}))}}catch(R){Logger.ErrorLog("BulkEdit-SAVE: ",R.Message)}else d.Message="NO DATA",n.EditGrid.updateRow(d)},d=0;d<e.length;d++){var C;c(d)}}},{key:"DeleteDimension",value:function(e){var t,n,i="";n=null!=this.ReportObj?"ReportPK":this.PrimaryKey;for(var r=0,o=0;o<e.length;o++){var l=e[o];try{if(t=0,null!=this.ReportObj&&s.e.IsEmpty(l.ReportPK))continue;if(2==this.CostCenterID){var u={};u.AccountID=parseInt(l[n]);var D=a.a.accounting.DeleteAccount(u.AccountID);i=D.Message,t=D.RetValue}else if(3==this.CostCenterID){var c=a.a.inventory.DeleteProduct(parseInt(l[n]));i=c.Message,t=c.RetValue}else if(this.CostCenterID>=50001&&this.CostCenterID<=50050){var d={};d.NodeID=parseInt(l[n]),d.CostCenterID=this.CostCenterID;var C=a.a.common.DeleteCostCenter(d.CostCenterID,d.NodeID);i=C.Message,t=C.RetValue}else i="Functionality not implemented";t>0?(r++,this.EditGrid.removeRow(l)):(l.Message="Failure : "+i,this.EditGrid.updateRow(l))}catch(h){Logger.ErrorLog("BulkEdit-DELETE: ",h.Message)}}this.DisplayMessage=r+" Records Deleted"}},{key:"OnRowSelection",value:function(e){return!1}},{key:"Cancelclick",value:function(){this.ApproveVisibility=!1,a.a.page.HideDialog(),null!=this.DB&&(this.ShowRightPanel=!1)}},{key:"onClickIkon",value:function(e){this.ApprovalClick(e,null)}},{key:"ApprovalClick",value:function(e,t){var n=this;if(this.DisplayMessage="","Approve"==e||"Reject"==e||"Suspend"==e){if(this.RemarksApprove&&"Approve"==e&&s.e.IsEmptySpace(this.Remarks.Text))return this.DisplayMessage="Approve Remarks Mandatory",-1;if(this.RemarksReject&&"Reject"==e&&s.e.IsEmptySpace(this.Remarks.Text))return this.DisplayMessage="Reject Remarks Mandatory",-1;if(this.RemarksSuspend&&"Suspend"==e&&s.e.IsEmptySpace(this.Remarks.Text))return this.DisplayMessage="Suspend Remarks Mandatory",-1;if(2==this.CostCenterID?this.strVoucherNo="AccountID":3==this.CostCenterID?this.strVoucherNo="ProductID":95==this.CostCenterID?this.strVoucherNo="ContractID":this.CostCenterID>5e4?this.strVoucherNo="NodeID":null!=this.ReportObj&&this.EditGrid.TableColumns.Contains("ReportPK")&&(this.strVoucherNo="ReportPK"),null==t&&(t=this.EditGrid.Table.filter((function(e){return 1==e.Select||1==e.Select}))),0==t.length)return this.DisplayMessage="No Rows Selected",-1;var i,r="",o="",l=0;if(i=0!=s.e.stringCompare(this.MainTableName,"ACC_DocDetails",!0),"Approve"==e?l=1:"Suspend"==e&&(l=2),this.IsDocument)if(this.IsLWApproval&&"Suspend"!=e){var u=this.PrimaryKey;null!=this.ReportObj&&(u="ReportPK");var D,c=null,d="";t.forEach((function(e){(D=s.e.String(e[n.strVoucherNo]))!=c&&(d.length>0&&(r.length>0&&(r+="\x11"),r+='<XML No="'+c+'">'+d+"</XML>"),d="",c=D),d+='<Row ID="'+s.e.String(e[u])+'" Remarks="'+s.e.EncodeXML(n.Remarks.Text)+'" WID="'+s.e.String(e.WorkflowID)+'"/>'})),d.length>0&&(r.length>0&&(r+="\x11"),r+='<XML No="'+c+'">'+d+"</XML>")}else t.forEach((function(e){if(r+=s.e.String(e[n.strVoucherNo])+",",!s.e.IsEmpty(e[n.strVoucherNo])&&"BUA-"==e[n.strVoucherNo].toString().substr(0,4)){var t=0,i=0,l=0,u=0,D=!1,c="",d="",C=new Date,h=new Date,p=new Date,m=a.a.common.GetDataSet3("BULK003",s.e.String(e[n.strVoucherNo]),"","").Tables[0];if(null!=m&&m.length>0){t=parseInt(m[0].EmpSeqNo),C=new Date(m[0].EffectFrom),h=new Date(m[0].ApplyFrom),p=new Date(m[0].NextAppraisalDate),c=m[0].Remarks.toString(),d=m[0].Reason.toString();var I=a.a.common.GetDataSet3("BULK004",s.e.String(t),C.iMonth().toString(),C.getFullYear().toString()).Tables[0];l=null!=I&&I.length>0?parseInt(I[0].SeqNo):0;var g=new S.a(null,t,new Date,l);g.isFromBulkAppraisals=!0,g.EffectFrom.Date=C,g.ActAppraisalFrom.Date=h,g.NextAppraisal.Date=p,g.Remarks.Text=c,g.Reason.Text=d;for(var y=0;y<m.length;y++){i=parseInt(m[y].ComponentID),u=parseFloat(m[y].Amt),D=!1;for(var T=0;T<g.dgvEarnings.Table.length;T++)if(g.dgvEarnings.Table[T].EarComponentID.toString()==i.toString()){g.dgvEarnings.Table[T].EarValue=u,D=!0;break}if(!D)for(var b=0;b<g.dgvDeductions.Table.length;b++)if(g.dgvDeductions.Table[b].DedComponentID.toString()==i.toString()){g.dgvDeductions.Table[b].DedValue=u;break}}g.ExecuteFormulas(),g.OnButtonClick("Save"),null!=g.DisplayMessage&&g.DisplayMessage.length>0||g.strUpdate.length>0&&(o+='<Row EmpNodeID="'+t+'" ',o+=' VoucherNo ="'+e[n.strVoucherNo].toString()+'" ',o+=' Query ="'+g.strUpdate+'" ',o+="/>")}}})),r=r.substr(0,r.length-1),o.length>0&&(o="<Data>"+o+"</Data>");else t.forEach((function(e){r+=s.e.String(e[n.strVoucherNo])+","})),r=r.substr(0,r.length-1);if(r.length>0){var C,h=a.a.common.BulkApprovals(this.CostCenterID,i,this.Remarks.Text,r.toString(),l,this.AppRejDate.Date.ToString("dd/MMM/yyyy"),o);return(C=s.e.Int(h.obj))>0?(this.Remarks.Text="",t.forEach((function(e){n.EditGrid.removeRow(e)})),"Suspend"==e&&(this.Report.length>0?this.Report[0].Refresh():this.RefreshData()),this.DisplayMessage="Approve"==e?e+"d Successfully":e+"ed Successfully"):this.DisplayMessage="Error in Save",C}}return 0}},{key:"BarcodeDocument",value:function(e){var t=this;if(0!=this.EditColumns.length)if(null!=e[0][this.EditColumns[0].DisplayMember]){var n,i,a,o="";if(this.CostCenterID>4e4&&this.CostCenterID<5e4){i=0==s.e.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?"AccDocDetailsID":"InvDocDetailsID",n=null!=this.ReportObj?"ReportPK":i;var l=new r.a;e.forEach((function(e){a=s.e.String(e[t.strVoucherNo]),l.ContainsKey(a)||l.push(a,[]),l[a].push(e)})),l.forEach((function(e){o="",o+="<XML IgnorePositionDialog='1'>",e.Value.forEach((function(e){e.Message=null,s.e.IntTryParse(s.e.String(e[t.EditColumns[0].DisplayMember]))>0?o+='<R DocDetailsID="'+s.e.String(e[n])+'" Qty="'+s.e.String(e[t.EditColumns[0].DisplayMember])+'"/>':e.Message="Invalid Quantity"})),o+="</XML>";var i=t.PrintBarcode(e.Key,o.toString());e.Value.forEach((function(e){null==e.Message&&(e.Message=i)}))}))}else this.DisplayMessage="Not implemented"}else this.DisplayMessage="Selected editable column not found.";else this.DisplayMessage="Please select ateleast one editable column."}},{key:"PrintBarcode",value:function(e,t){var n,i=a.a.report.GetDocumentDetailsByVoucherNo(e);return s.e.Int(i.obj)>0?(n=i.Tables[0].length>0?i.Tables[0][0]:i.Tables[1][0],parseInt(n.CostCenterID),parseInt(n.DocID),"Success"):"Voucher Not Found"}},{key:"OnDateRangesSelectionChanged",value:function(e){null!=this.DateRanges.SelectedValue&&g.a.SetDateRanges(this.DateRanges.SelectedValue,this.FromDate,this.ToDate)}},{key:"AppDisplayMessage",get:function(){return this._AppDisplayMessage},set:function(e){e!=this._AppDisplayMessage&&(this._AppDisplayMessage=e,this.AppMessageVisibility=!s.e.IsEmpty(this._AppDisplayMessage))}}]),c}(c.b),b=function(){function e(t,n){_classCallCheck(this,e),this.dsFields=null,this.CostCenterID=0,this.ClassName="BulkEditViewModel",this.dsFields=t,this.Parent=n,(n.ClassName="BulkEditViewModel")&&(this.CostCenterID=n.CostCenterID),this.FilterGrid=new d.a,this.FilterGrid.Width="",this.FilterGrid.Height=200,this.FilterGrid.CanUserAddRows=!0,this.FilterGrid.CanUserDeleteRows=!0,this.FilterGrid.BeginEdit.Subscribe(this,"OnBeginEditing"),this.FilterGrid.CellEditEnding.Subscribe(this,"OnCellEditCommiting");var i=[],a=new C.a,s=[],r={AND:"AND",Value:"AND"};s.push(r),(r={}).AND="OR",r.Value="OR",s.push(r),(r={}).AND="(",r.Value="(",s.push(r),(r={}).AND=")",r.Value=")",s.push(r),(a=new C.a).ComboData=s,a.DisplayMember="AND",a.ValueMember="Value",a.ValueBinding="And",a.Header="AND/OR",a.DataType="ComboBox",a.Width=80,a.IsVisible=!0,i.push(a),a=new C.a,null!=t&&(a.ComboData=t.Tables[0]),a.DisplayMember="UserColumnName",a.ValueMember="CostCenterColID",a.ValueBinding="Field",a.DataType="ComboBox",a.Header="Column",a.Width=200,a.IsVisible=!0,i.push(a),(a=new C.a).ComboData=this.ReturnCondition(),a.DisplayMember="Condition",a.ValueMember="Value",a.ValueBinding="Condition",a.DataType="ComboBox",a.Header="Condition",a.Width=120,a.IsVisible=!0,i.push(a),(a=new C.a).Header="Value",a.DisplayMember="MULTI",a.DataType="MULTI_TYPE",a.Width=150,i.push(a),this.FilterGrid.Columns=i,this.FilterGrid.Clear(),this.FilterGrid.TableColumns.push("And"),this.FilterGrid.TableColumns.push("Column"),this.FilterGrid.TableColumns.push("Field"),this.FilterGrid.TableColumns.push("Condition"),this.FilterGrid.TableColumns.push("MULTI"),this.FilterGrid.TableColumns.push("MULTI_TYPE"),this.FilterGrid.TableColumns.push("MULTI_FLOAT"),this.FilterGrid.TableColumns.push("MULTI_DATE"),this.FilterGrid.TableColumns.push("MULTI_LISTBOX"),this.FilterGrid.TableColumns.push("MULTI_COMBOBOX");for(var o=0;o<10;o++){var l=this.FilterGrid.NewRow();this.FilterGrid.addRow(l)}}return _createClass(e,[{key:"LoadXML",value:function(e){var t=this,n=new s.f;n.LoadXml(e),this.FilterGrid.Clear(),n.DocumentElement.childNodes.length>0&&n.DocumentElement.childNodes.forEach((function(e){var n=t.FilterGrid.NewRow();if(n.And=e.attributes.And.value,s.e.IsEmpty(e.attributes.Field.value)&&(n.Field=e.attributes.Field.value),n.Condition=e.attributes.Condition.value,n.MULTI_TYPE=e.attributes.ValueType.value,n.MULTI=e.attributes.Value.value,null!=e.attributes.Value_Key&&!s.e.IsEmpty(e.attributes.Value_Key.value))switch(s.e.String(n.MULTI_TYPE)){case"DATE":case"DATETIME":n.MULTI_DATE=e.attributes.Value_Key.value;break;case"LISTBOX":n.MULTI_LISTBOX=e.attributes.Value_Key.value;break;case"COMBOBOX":n.MULTI_COMBOBOX=e.attributes.Value_Key.value}t.FilterGrid.addRow(n)}));for(var i=0;i<10;i++){var a=this.FilterGrid.NewRow();this.FilterGrid.addRow(a)}}},{key:"GetXML",value:function(){var e="";e+="<XML>";for(var t=0,n=0;n<this.FilterGrid.Table.length;n++){var i=this.FilterGrid.Table[n];if(t++,""!=s.e.String(i.And)||""!=s.e.String(i.Field)){switch(e+='<Row And="',1==t&&"("!=s.e.String(i.And)||(e+=s.e.String(i.And)),e+='"',e+=' Field="'+s.e.String(i.Field)+'"',e+=' Condition="'+s.e.EncodeXML(s.e.String(i.Condition))+'"',e+=' ValueType="'+s.e.EncodeXML(s.e.String(i.MULTI_TYPE))+'"',e+=' Value="'+s.e.EncodeXML(s.e.String(i.MULTI))+'"',s.e.String(i.MULTI_TYPE)){case"DATE":e+=' Value_Key="'+s.e.EncodeXML(s.e.String(i.MULTI_DATE))+'"';break;case"LISTBOX":e+=' Value_Key="'+s.e.EncodeXML(s.e.String(i.MULTI_LISTBOX))+'"';break;case"COMBOBOX":e+=' Value_Key="'+s.e.EncodeXML(s.e.String(i.MULTI_COMBOBOX))+'"'}e+="/>"}}return(e+="</XML>").toString()}},{key:"SetFieldsData",value:function(e,t){this.dsFields=e,this.CostCenterID=t;var n=[];this.FilterGrid.Columns[1].ComboData=e.Tables[0],this.FilterGrid.Columns.forEach((function(e){n.push(e)})),this.FilterGrid.Columns=n}},{key:"ReturnCondition",value:function(){var e=[],t={Condition:"Equals",Value:"=",Type:"3"};return e.push(t),(t={}).Condition="Does Not Equals",t.Value="<>",t.Type="3",e.push(t),(t={}).Condition="Is greater than",t.Value=">",t.Type="2",e.push(t),(t={}).Condition="Is greater than or equals to",t.Value=">=",t.Type="2",e.push(t),(t={}).Condition="Is less than",t.Value="<",t.Type="2",e.push(t),(t={}).Condition="Is less than or equals to",t.Value="<=",t.Type="2",e.push(t),(t={}).Condition="Contains",t.Value="LIKE",t.Type="1",e.push(t),(t={}).Condition="Does Not Contains",t.Value="NOT LIKE",t.Type="1",e.push(t),(t={}).Condition="Is Null",t.Value="IS NULL",t.Type="1",e.push(t),(t={}).Condition="Is Not Null",t.Value="IS NOT NULL",t.Type="1",e.push(t),e}},{key:"OnCellEditCommiting",value:function(e){var t=e.item;if("Field"==e.column.field){if(null==this.dsFields)return;var n=""==s.e.String(t.Field)?[]:this.dsFields.Tables[0].filter((function(e){return e.CostCenterColID==s.e.String(t.Field)}));if(0==n.length)return t.MULTI="",t.MULTI_TYPE="",t.MULTI_FLOAT=null,t.MULTI_DATE=null,t.MULTI_LISTBOX=null,void(t.MULTI_COMBOBOX=null);var i=parseInt(t.Field),a=s.e.String(n[0].UserColumnType).toUpperCase();t.MULTI_TYPE="DATE"==a?"DATE":"FLOAT"==a||"NUMERIC"==a?"FLOAT":"LISTBOX"==a?"="==s.e.String(t.Condition)||"<>"==s.e.String(t.Condition)?"LISTBOX":"":241!=i&&264!=i&&252!=i&&"StatusID"!=s.e.String(n[0].SysColumnName)||"="!=s.e.String(t.Condition)&&"<>"!=s.e.String(t.Condition)?"":"COMBOBOX"}}},{key:"OnBeginEditing",value:function(t){var n=t.args.item,i=t.args.column.field;if("Field"==i);else if("Condition"==i);else if("MULTI"==i){var a=""==s.e.String(n.Field)?[]:this.dsFields.Tables[0].filter((function(e){return e.CostCenterColID==s.e.String(n.Field)}));if(0==a.length)return void(t.Cancel=!0);var r=parseInt(n.Field),o=s.e.String(a[0].UserColumnType).toUpperCase();if("DATE"==o)n.MULTI_TYPE="DATE";else if("FLOAT"==o||"NUMERIC"==o)n.MULTI_TYPE="FLOAT";else if("LISTBOX"==o)t.args.column.CostCenterID=parseInt(s.e.String(a[0].ColumnCostCenterID)),t.args.column.TypeID=parseInt(s.e.String(a[0].ColumnCCListViewTypeID)),n.MULTI_TYPE="="==s.e.String(n.Condition)||"<>"==s.e.String(n.Condition)?"LISTBOX":"";else if(241==r||264==r||252==r||"StatusID"==s.e.String(a[0].SysColumnName))if("="==n.Condition.toString()||"<>"==s.e.String(n.Condition)){n.MULTI_TYPE="COMBOBOX";var l=new Array,u=null;241==r||264==r?u=this.dsFields.Tables[4]:252==r?u=e.GetBillWiseTable():"StatusID"==s.e.String(a[0].SysColumnName)&&(u=this.CostCenterID>4e4&&this.CostCenterID<5e4?this.dsFields.Tables[2]:this.dsFields.Tables[1]),u.forEach((function(e){l.push(h.d.ComboBoxItems_2(s.e.String(e[Object.keys(e)[1]]),s.e.String(e[Object.keys(e)[0]])))})),t.args.column.ComboItems=l}else n.MULTI_TYPE="";else n.MULTI_TYPE=""}}},{key:"GetWhere",value:function(e,t){var n,i,r,l,u,D,c=this,d="",C=this.Parent,h="",p="",m=C.Entities,I=t;if(D=C.CostCenterID,C.IsDetailVoucher,C.IsDocument&&(p=0==s.e.stringCompare(C.MainTableName,"ACC_DocDetails",!0)?"AccDocDetailsID":"InvDocDetailsID"),D>4e4&&D<5e4){for(var g=function(e){var D=c.FilterGrid.Table[e];if(I++,s.e.IsEmpty(D.And)&&s.e.IsEmpty(D.Field))return"continue";I==t+1&&"("!=s.e.String(D.And)||(d+=" "+s.e.String(D.And)+" ");var p=s.e.IsEmpty(D.Field)?[]:c.dsFields.Tables[0].filter((function(e){return e.CostCenterColID==s.e.String(D.Field)}));if(0==p.length)return"continue";var g=p[0];if(u="T"+I.toString(),l=s.e.String(g.SysTableName),r=s.e.String(g.SysColumnName),n=i="",0==s.e.stringCompare(l,"COM_DocTextData"))if(m.ContainsKey("COM_DocTextData")||m.push("COM_DocTextData","TXT"),r="TXT."+r,"DATE"==s.e.String(g.ColumnDataType)&&"IS NOT NULL"!=s.e.String(D.Condition)&&"IS NULL"!=s.e.String(D.Condition))n=i=r=" isdate("+r+")=1 and convert(datetime,"+r+")";else if("LISTBOX"==s.e.String(g.UserColumnType)){var y;if("44"==s.e.String(g.ColumnCostCenterID))y="case when "+r+" is not null and isnumeric("+r+")=1 then (SELECT Name FROM COM_Lookup with(nolock) WHERE NodeID="+r+") else '' end";else{var S=a.a.report.GetTableColumns(parseInt(g.ColumnCostCenterID));y=S.ColumnName,h=S.PrimaryKey,l=S.TableName,y="case when "+r+" is not null and isnumeric("+r+")=1 then (SELECT "+y+" FROM "+l+" with(nolock) WHERE "+h+"="+r+") else '' end"}n=y,i=r}else"LOOKUP"==s.e.String(g.UserColumnType)||(n=i=r);else 0==s.e.stringCompare(l,"COM_DocCCData")?(m.ContainsKey("COM_DocCCData")||m.push("COM_DocCCData","DCC"),m.ContainsKey(r)||(m.push(r,u),s.e.GetTagTableName(parseInt(g.ParentCostCenterID))),n=null==g||s.e.IsEmpty(g.ShowCode)||"YES"!=s.e.String(g.ShowCode)?m[r]+".Name":m[r]+".Code",i="DCC."+r):null!=g.IsForeignKey&&Object(o.j)(g.IsForeignKey)&&0==["AccountTypeID","StatusID"].Contains(r)?(m.ContainsKey(r)||(m.push(r,u),s.e.String(g.ParentCostCenterSysName),s.e.String(g.ParentCostCenterColSysName)),n=m[r]+"."+C.GetColumnName(g),i="D."+r):(r="D."+r,"DATE"==s.e.String(g.ColumnDataType)?n=i=r="convert(datetime,"+r+")":n=i=r);var T=s.e.String(D.MULTI_TYPE);switch(s.e.String(D.Condition)){case"=":case"<>":var b;if("LISTBOX"==T)b=s.e.IntTryParse(s.e.String(D.MULTI_LISTBOX)),d+=" "+i+s.e.String(D.Condition)+b.toString();else"COMBOBOX"==T?s.e.String(D.MULTI_COMBOBOX).length>0&&(d+=" "+i+s.e.String(D.Condition)+"'"+s.e.String(D.MULTI_COMBOBOX)+"'"):"DATE"==T?s.e.IsEmpty(D.MULTI_DATE)?d+=" "+i+s.e.String(D.Condition)+"''":d+=" "+i+s.e.String(D.Condition)+"'"+new Date(D.MULTI_DATE).ToString("dd MMM yyyy")+"'":d+=" "+n+s.e.String(D.Condition)+"'"+s.e.String(D.MULTI)+"'";break;case"LIKE":case"NOT LIKE":d+=" "+n+" "+s.e.String(D.Condition)+" '%"+s.e.String(D.MULTI)+"%'";break;case"IS NULL":case"IS NOT NULL":d+=" "+n+" "+s.e.String(D.Condition);break;case">":case">=":case"<":case"<=":d+="DATE"==T?" "+i+s.e.String(D.Condition)+"'"+new Date(D.MULTI_DATE).ToString("dd MMM yyyy")+"'":" "+n+s.e.String(D.Condition)+"'%"+s.e.String(D.MULTI)+"'%"}},y=0;y<this.FilterGrid.Table.length;y++)g(y);C.IsApproval&&500==t&&(d.length>0&&(d+=" and "),a.a.SessionManager.Preferences.ContainsKey("CanApproveFunction")&&"TRUE"==a.a.SessionManager.Preferences.CanApproveFunction.toUpperCase()?d+=" D.WorkFlowID>0 AND dbo.fnExt_CanApprove(D."+p+",D.CostCenterID,D.WorkflowID,D.WorkFlowLevel,D.StatusID,D.CreatedDate,"+a.a.SessionManager.UserID+","+a.a.SessionManager.RoleID+")=1":d+=" D.WorkFlowID>0 AND dbo.[fnRPT_CanApprove](D.CostCenterID,D.WorkflowID,D.WorkFlowLevel,D.StatusID,D.CreatedDate,"+a.a.SessionManager.UserID+","+a.a.SessionManager.RoleID+")=1")}else{for(var S=function(e){var D=c.FilterGrid.Table[e];if(I++,s.e.IsEmpty(D.And)&&s.e.IsEmpty(D.Field))return"continue";I==t+1&&"("!=s.e.String(D.And)||(d+=" "+s.e.String(D.And)+" ");var p=""==s.e.String(D.Field)?[]:c.dsFields.Tables[0].filter((function(e){return e.CostCenterColID==s.e.String(D.Field)}));if(0==p.length)return"continue";var g=p[0];if(u="T"+I.toString(),l=s.e.String(g.SysTableName),r=s.e.String(g.SysColumnName),n=i="",0==s.e.stringCompare(l,"ACC_AccountsExtended")||0==s.e.stringCompare(l,"INV_ProductExtended")||0==s.e.stringCompare(l,"REN_ContractExtended")||0==s.e.stringCompare(l,"REN_UnitsExtended"))if(m.ContainsKey(l)||m.push(l,"EXT"),r="EXT."+r,"DATE"==s.e.String(g.ColumnDataType))n=i=r="convert(datetime,"+r+")";else if("LISTBOX"==s.e.String(g.UserColumnType)){var y;if("44"==s.e.String(g.ColumnCostCenterID))y="case when "+r+" is not null and isnumeric("+r+")=1 then (SELECT Name FROM COM_Lookup with(nolock) WHERE NodeID="+r+") else '' end";else{var S=a.a.report.GetTableColumns(parseInt(g.ColumnCostCenterID));y=S.ColumnName,h=S.PrimaryKey,l=S.TableName,y="case when "+r+" is not null and isnumeric("+r+")=1 then (SELECT "+y+" FROM "+l+" with(nolock) WHERE "+h+"="+r+") else '' end"}n=y,i=r}else n=i=r;else 0==s.e.stringCompare(l,"COM_CCCCData")?(m.ContainsKey("COM_CCCCData")||m.push("COM_CCCCData","CCDATA"),m.ContainsKey(r)||(m.push(r,u),s.e.GetTagTableName(parseInt(g.ParentCostCenterID))),n=m[r]+".Name",i="CCDATA."+r):null!=g.IsForeignKey&&Object(o.j)(g.IsForeignKey)&&0==["AccountTypeID","StatusID"].Contains(r)?(m.ContainsKey(r)||(m.push(r,u),s.e.String(g.ParentCostCenterSysName),s.e.String(g.ParentCostCenterColSysName)),n=m[r]+"."+C.GetColumnName(g),i="D."+r):(r="D."+r,"DATE"==s.e.String(g.ColumnDataType)?n=i=r="convert(datetime,"+r+")":n=i=r);var T=s.e.String(D.MULTI_TYPE);switch(s.e.String(D.Condition)){case"=":case"<>":var b;if("LISTBOX"==T)b=s.e.IntTryParse(s.e.String(D.MULTI_LISTBOX)),d+=" "+i+s.e.String(D.Condition)+b.toString();else"COMBOBOX"==T?s.e.String(D.MULTI_COMBOBOX).length>0&&(d+=" "+i+s.e.String(D.Condition)+"'"+D.MULTI_COMBOBOX.toString()+"'"):d+="DATE"==T?" "+i+s.e.String(D.Condition)+"'"+new Date(D.MULTI_DATE).ToString("dd MMM yyyy")+"'":" "+n+s.e.String(D.Condition)+"'"+s.e.String(D.MULTI)+"'";break;case"LIKE":case"NOT LIKE":d+=" "+n+" "+s.e.String(D.Condition)+" '%"+s.e.String(D.MULTI)+"%'";break;case">":case">=":case"<":case"<=":d+="DATE"==T?" "+i+s.e.String(D.Condition)+"'"+new Date(D.MULTI_DATE).ToString("dd MMM yyyy")+"'":" "+n+s.e.String(D.Condition)+"'%"+s.e.String(D.MULTI)+"'%"}},T=0;T<this.FilterGrid.Table.length;T++)S(T);C.IsApproval&&500==t&&(n=2==D?"D.AccountID":3==D?"D.ProductID":93==D?"D.UnitID":94==D?"D.TenantID":95==D?"D.ContractID":"D.NodeID",d.length>0&&(d+=" and "),d+=95==D?" D.StatusID IN (470,440,465)":" D.StatusID IN (1001,1003)",d+=95==D?" AND dbo.[fnREN_CanContractApprove]("+D+","+n+","+a.a.SessionManager.UserID+","+a.a.SessionManager.RoleID+")=1 ":" AND dbo.[fnRPT_CanCostCentetApprove]("+D+","+n+","+a.a.SessionManager.UserID+","+a.a.SessionManager.RoleID+")=1 ")}return d.toString()}}],[{key:"GetBillWiseTable",value:function(){var e=[],t={Value:1,Name:"YES"};return e.push(t),t.Value=0,t.Name="NO",e.push(t),e}}]),e}(),f=function(){function e(t,n){_classCallCheck(this,e),this.Title="",this.ApplyToAll=!1,this.Parent=t,this.SourceColumn=n,this.Title=n.Header,this.FindGrid=new d.a,this.FindGrid.CanUserDeleteRows=!0,this.FindGrid.Columns=[],this.FindGrid.Columns.push(n),this.FindGrid.Columns[0].Header="Find What",this.FindGrid.Columns[0].Width=233,this.FindGrid.Table=t.EditGrid.Table;var i=this.FindGrid.NewRow();this.FindGrid.addRow(i),this.FindGrid.SelectedItem=this.FindGrid.Table[0],this.FindGrid.SelectedIndex=0,this.ReplaceGrid=new d.a,this.ReplaceGrid.CanUserDeleteRows=!0,this.ReplaceGrid.Columns=[],this.ReplaceGrid.Columns.push(n),this.ReplaceGrid.Columns[0].Header="Replace With",this.ReplaceGrid.Columns[0].Width=233,this.ReplaceGrid.Table=t.EditGrid.Table,i=this.ReplaceGrid.NewRow(),this.ReplaceGrid.addRow(i),this.ReplaceGrid.SelectedItem=this.ReplaceGrid.Table[0],this.ReplaceGrid.SelectedIndex=0}return _createClass(e,[{key:"OnButtonClick",value:function(e){var t=this;if(this.Parent.DisplayMessage="","Replace"==e){var n=!1,i=this.SourceColumn.SectionName+"_Key";this.Parent.EditGrid.TableColumns.Contains(i)?n=!0:i=this.SourceColumn.SectionName;var a=s.e.String(this.FindGrid.Table[0][i]);if(this.ApplyToAll)this.Parent.EditGrid.Table.forEach((function(e){e[t.SourceColumn.SectionName]=t.ReplaceGrid.Table[0][t.SourceColumn.SectionName],n&&(e[i]=t.ReplaceGrid.Table[0][i]),e.Select=!0,t.Parent.EditGrid.updateRow(e)})),this.Parent.DisplayMessage=this.Parent.EditGrid.Table.length+" Rows Replaced";else{var r=0;this.Parent.EditGrid.Table.forEach((function(e){0==s.e.stringCompare(a,s.e.String(e[i]),!0)&&(e[t.SourceColumn.SectionName]=t.ReplaceGrid.Table[0][t.SourceColumn.SectionName],n&&(e[i]=t.ReplaceGrid.Table[0][i]),e.Select=!0,t.Parent.EditGrid.updateRow(e),r++)})),this.Parent.DisplayMessage=0==r?"No Rows Found":r+" Rows Replaced"}}else"Cancel"==e&&(this.Parent.ReplaceVisibility=!1,this.Parent.ApproveVisibility=!1)}}]),e}()},XJLh:function(e,t,n){"use strict";n.d(t,"a",(function(){return D}));var i=n("3Pt+"),a=n("fXoL"),s=n("ofXK"),r=n("q8k3"),o=n("sYmb");function l(e,t){if(1&e&&(a.Zb(0,"div",3),a.Wc(1,"\n            "),a.Vb(2,10),a.Wc(3,"\n        "),a.Yb()),2&e){var n=a.lc();a.Db(2),a.tc("obj",n.obj.AppRejDate)("group",n.form)}}function u(e,t){if(1&e){var n=a.ac();a.Zb(0,"button",6),a.hc("click",(function(){return a.Ic(n),a.lc().obj.onClickIkon("Suspend")})),a.Wc(1),a.mc(2,"translate"),a.Yb()}2&e&&(a.Db(1),a.Xc(a.nc(2,1,"Suspend")))}var D=function(){var e=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){this.form=new i.j({})}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=a.Nb({type:e,selectors:[["app-bulk-edit-approve-component"]],inputs:{obj:"obj"},decls:35,vars:12,consts:[[1,"master-screen",2,"padding-bottom","4px","min-width","400px"],[1,"PACTHeaderFields","dialogSubBody"],["class","form-group row form-row col-xl-12 col-md-12 col-sm-12 col-xs-12 PACTControl",4,"ngIf"],[1,"form-group","row","form-row","col-xl-12","col-md-12","col-sm-12","col-xs-12","PACTControl"],["FieldDirective","",3,"obj"],[1,"Pactdailogfooter"],[1,"primary-btn-wicon",3,"click"],[1,"secondary-btn-wicon",3,"click"],["class","primary-btn-wicon",3,"click",4,"ngIf"],[1,"fa-light","fa-rectangle-xmark"],["FieldDirective","",3,"obj","group"]],template:function(e,t){1&e&&(a.Zb(0,"div",0),a.Wc(1,"\n    "),a.Zb(2,"div",1),a.Wc(3,"\n        "),a.Uc(4,l,4,2,"div",2),a.Wc(5,"\n        "),a.Zb(6,"div",3),a.Wc(7,"\n            "),a.Vb(8,4),a.Wc(9,"\n        "),a.Yb(),a.Wc(10,"\n        \n    "),a.Yb(),a.Wc(11,"\n    "),a.Zb(12,"div",5),a.Wc(13,"\n      "),a.Zb(14,"div"),a.Wc(15,"\n        "),a.Zb(16,"button",6),a.hc("click",(function(){return t.obj.onClickIkon("Approve")})),a.Wc(17),a.mc(18,"translate"),a.Yb(),a.Wc(19,"\n        "),a.Zb(20,"button",7),a.hc("click",(function(){return t.obj.onClickIkon("Reject")})),a.Wc(21),a.mc(22,"translate"),a.Yb(),a.Wc(23,"\n        "),a.Uc(24,u,3,3,"button",8),a.Wc(25,"\n        "),a.Wc(26,"\n        "),a.Zb(27,"button",7),a.hc("click",(function(){return t.obj.Cancelclick()})),a.Ub(28,"i",9),a.Wc(29),a.mc(30,"translate"),a.Yb(),a.Wc(31,"\n      "),a.Yb(),a.Wc(32,"\n      \n  "),a.Yb(),a.Wc(33,"\n"),a.Yb(),a.Wc(34,"\n")),2&e&&(a.Db(4),a.tc("ngIf",t.obj.AppRejDate.Visible),a.Db(4),a.tc("obj",t.obj.Remarks),a.Db(9),a.Xc(a.nc(18,6,"btnApprove")),a.Db(4),a.Xc(a.nc(22,8,"btnReject")),a.Db(3),a.tc("ngIf",t.obj.SuspendVisiblity),a.Db(5),a.Xc(a.nc(30,10,"Cancel")))},directives:[s.t,r.a],pipes:[o.d],encapsulation:2}),e}()},ouML:function(e,t,n){"use strict";n.r(t),n.d(t,"DocumentDraftsViewModel",(function(){return c}));var i=n("mrSG"),a=n("Do2H"),s=n("Lp6j"),r=n("ScVY"),o=n("8B8H"),l=n("ockk"),u=n("rJVx"),D=n("CUWK"),c=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n){var i,s,D=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(_classCallCheck(this,r),(i=t.call(this)).Grid=new o.a,i.IsFromDocs=!1,i.PopupWidth=0,i.ReportType=0,i.Parent=null,i.CCID=0,i.WID=0,i.LevelID=0,i.PactGridVisible=!1,i.CCID=D,i.Parent=e,i.ReportType=n,i.Parent instanceof u.GeneralDashboardViewModel||"DashAddOnsViewModel"==i.Parent.ClassName)?1==n&&(i.ColSource=u.GeneralDashboardViewModel.InitColumns("Document Drafts_DashBoardCustomize")):(1==n?i.DisplayName="Drafts":2==n?i.DisplayName="Hold Documents":3==n?i.DisplayName="Approval History":4==n&&(i.DisplayName="Level Info",i.PactGrid=new o.a),i.Title=i.DisplayName,i.IsFromDocs=!0,i.FillGrid(),i.Grid.OnLinkClick.Subscribe(_assertThisInitialized(i),"GridLinkClick"),i.ColSource=[],1==n?(i.ColSource=u.GeneralDashboardViewModel.InitColumns("Document Drafts_DashBoardCustomize"),i.PopupWidth=22,i.ColSource.forEach((function(e){i.PopupWidth=i.PopupWidth+e.Width}))):2==n?((s=new l.a).DataType="TextBlock",s.Header="Hold Date",s.DisplayMember="HoldDate_Key",s.Width=100,i.ColSource.push(s),(s=new l.a).DataType="LINK",s.Header=a.a.GetResource("DocName"),s.DisplayMember="DocName",s.Width=135,i.ColSource.push(s),(s=new l.a).DataType="TextBlock",s.Header="NetValue",s.DisplayMember="NetValue",s.Width=100,i.ColSource.push(s),(s=new l.a).DataType="TextBlock",s.Header="NoOfProducts",s.DisplayMember="NoOfProducts",s.Width=50,i.ColSource.push(s),(s=new l.a).DataType="LINK",s.Header=a.a.GetResource("Delete"),s.DisplayMember="Delete",s.Width=100,i.ColSource.push(s),i.PopupWidth=450):3==n?((s=new l.a).DataType="TextBlock",s.Header="User",s.DisplayMember="CreatedBy",s.Width=90,i.ColSource.push(s),(s=new l.a).DataType="TextBlock",s.Header="FirstName",s.DisplayMember="FirstName",s.Width=90,i.ColSource.push(s),(s=new l.a).DataType="TextBlock",s.Header="LastName",s.DisplayMember="LastName",s.Width=90,i.ColSource.push(s),(s=new l.a).DataType="TextBlock",s.Header="Email",s.DisplayMember="Email1",s.Width=150,i.ColSource.push(s),(s=new l.a).DataType="TextBlock",s.Header=a.a.GetResource("Date"),s.DisplayMember="AppDate",s.Width=128,i.ColSource.push(s),(s=new l.a).DataType="LINK",s.Header="Level",s.DisplayMember="LevelName",s.Width=93,i.ColSource.push(s),(s=new l.a).DataType="TextBlock",s.Header="Status",s.DisplayMember="Status",s.Width=80,i.ColSource.push(s),(s=new l.a).DataType="Format",s.Header="Remarks",s.DisplayMember="Remarks",s.Width=190,i.ColSource.push(s),i.PopupWidth=950,"AddEditDocumentViewModel"==i.Parent.ClassName&&((s=new l.a).Header="WorkFlowName",s.DisplayMember="WorkFlowName",s.Width=200,i.ColSource.push(s)),i.PopupWidth=950):4==n&&((s=new l.a).DataType="TextBlock",s.ReadOnly=!0,s.Header="User Name",s.DisplayMember="UserName",s.Width=120,i.ColSource.push(s),(s=new l.a).DataType="TextBlock",s.ReadOnly=!0,s.Header="First Name",s.DisplayMember="FirstName",s.Width=120,i.ColSource.push(s),(s=new l.a).DataType="TextBlock",s.ReadOnly=!0,s.Header="Last Name",s.DisplayMember="LastName",s.Width=120,i.ColSource.push(s),i.PactGrid.Columns=i.ColSource,i.PopupWidth=400));return _possibleConstructorReturn(i)}return _createClass(r,[{key:"onClick",value:function(e){event.preventDefault(),null!=this.SelectedRow&&this.LoadDraft(this.SelectedRow)}},{key:"FillGrid",value:function(){var e=this,t=0,n=null;if(s.e.IsType(this.Parent,"AddEditDocumentViewModel")?(n=this.Parent,t=0==this.CCID?n.CostCenterID:this.CCID):s.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName||(t=this.CCID),1==this.ReportType||2==this.ReportType)(s.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName?null==n||38!=n.ScreenObject.DocumentType&&39!=n.ScreenObject.DocumentType?a.a.document.GetDocumentDrafts(0,t,this.ReportType,!1):a.a.document.GetDocumentDrafts(n.ScreenObject.RegisterNodeID,t,this.ReportType,!1,!0):a.a.document.GetDocumentDrafts(0,this.Parent.CostCenterID,this.ReportType,!1)).subscribe((function(t){e.Table=t.Tables[0],e.Grid.TableColumns.Contains("Date_Text")||(e.Grid.TableColumns.push("Date_Text"),e.Grid.TableColumns.push("Delete")),e.Grid.TableColumns.Contains("HoldDate_Key")||e.Grid.TableColumns.push("HoldDate_Key"),e.Table.forEach((function(e){e.Delete="Delete",e.id=a.a.slick.rowid,e.Date_Text=new Date(e.Date).ToString(a.a.SessionManager.Preferences["Date Format"]+" hh:mm a"),null!=e.HoldDate&&(e.HoldDate_Key=new Date(e.HoldDate).ToString(a.a.SessionManager.Preferences["Date Format"]))}))}));else if(3==this.ReportType){var i=null;if(s.e.IsType(this.Parent,"AddEditDocumentViewModel")?(i=this.Parent.ScreenObject.GetDocStatusHistory()).Tables.length>1&&i.Tables[1].length>0&&i.Columns[1].Contains("WID")&&(this.WID=parseInt(i.Tables[1][0].WID)):s.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName?s.e.IsEmpty(this.Parent.ClassName)||"AddEditCasesViewModel"!=this.Parent.ClassName||(i=this.GetDocStatusHistory(73,this.Parent.CaseID,!1)):i=a.a.rental.GetHistory(t,this.Parent.ContractID),null!=i&&i.Tables.length>0){this.Table=i.Tables[0],this.Grid.TableColumns.push("AppDate");for(var o=0;o<this.Table.length;o++)""!=this.Table[o].Date.toString()&&(this.Table[o].AppDate=new Date(this.Table[o].Date.toString()).ToString(a.a.SessionManager.Preferences["Date Format"]+" hh:mm a"));var l=0,u=0;this.Table.length>0&&(l=s.e.IntTryParse(this.Table[this.Table.length-1].WorkFlowLevel.toString()),u=s.e.IntTryParse(this.Table[this.Table.length-1].StatusID.toString())),369!=u&&(i.Tables[1]=i.Tables[1].filter((function(e){return e.levelID>l})),i.Tables[1].forEach((function(t){var n=e.Grid.NewRow();n.LevelName=t.LevelName,n.Status="Pending",n.WorkFlowLevel=t.LevelID,e.Grid.addRow(n)})));for(var D=this.Table.length;D<7;D++)this.Grid.addEmptyRow()}}else if(4==this.ReportType){var c=null;if("WFLevelDoc"==this.Parent.ClassName?c=a.a.SessionManager.Preferences.ContainsKey("CanApproveFunction")&&"True"==a.a.SessionManager.Preferences.CanApproveFunction?a.a.report.GetExtWFDet(this.Parent.WID,this.Parent.LevelID,this.Parent.ccid,this.Parent.DOcId):a.a.report.GetWorkFlowLevelDetails(this.Parent.WID,this.Parent.LevelID,this.Parent.ccDate):this.Parent instanceof r&&(a.a.SessionManager.Preferences.ContainsKey("CanApproveFunction")&&"True"==a.a.SessionManager.Preferences.CanApproveFunction?"AddEditDocumentViewModel"==this.Parent.Parent.ClassName?c=a.a.report.GetExtWFDet(this.Parent.WID,this.Parent.LevelID,this.Parent.Parent.CostCenterID,this.Parent.Parent.ScreenObject.DocID):"ReportViewModel"==this.Parent.Parent.ClassName&&"INV_ComparisonReport"==this.Parent.Parent.StaticReportObject&&(c=a.a.report.GetExtWFDet(this.Parent.WID,this.Parent.LevelID,this.Parent.Parent.StaticReportObject.QuotationDocument,this.Parent.Parent.StatusDocID)):c=a.a.report.GetWorkFlowLevelDetails(this.Parent.WID,this.Parent.LevelID,"AddEditDocumentViewModel"==this.Parent.Parent.ClassName?this.Parent.Parent.ScreenObject.DocDate.Date:Date.Today())),null!=c){for(var d=c.Tables[0].length;d<8;d++)c.Tables[0].push();this.PactGrid.Table=c.Tables[0]}this.PactGrid.Width="",this.PactGrid.SearchVisible=!0,this.PactGrid.SearchCols.Width="85",this.PactGrid.SearchOptions.Width="90",this.PactGrid.SearchText.Width="110",this.PactGridVisible=!0}}},{key:"GetDocStatusHistory",value:function(e,t,n){Logger.InfoLog("DocumentDraftsViewModel:: Inside GetDocStatusHistory");var i=[];i.push(e),i.push(t),i.push(n),i.push(a.a.SessionManager.UserID),i.push(a.a.SessionManager.LanguageID);var s=a.a.document.GetDocStatusHistory(i);return Logger.InfoLog("DocumentDraftsViewModel:: Exiting GetDocStatusHistory"),s}},{key:"OnButtonClick",value:function(e){"Cancel"==e.toString()&&(s.e.IsType(this.Parent,"AddEditDocumentViewModel")&&this.CCID>0&&(this.Parent.res="No"),a.a.page.HideDialog())}},{key:"DeleteDraft",value:function(e){(s.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName?a.a.document.DeleteDocumentDraft(parseInt(e.DraftID)):a.a.rental.DeleteQuotation(parseInt(e.CostCenterID),parseInt(e.DraftID))).RetValue>0&&this.Grid.removeRow(e)}},{key:"LoadDraft",value:function(e){return Object(i.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i,r,o,l,u,c=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!s.e.IsEmpty(this.Parent.ClassName)&&"AddEditRenContractViewModel"==this.Parent.ClassName){t.next=12;break}return t.next=3,Promise.all([n.e(2),n.e(1),n.e(3),n.e(5),n.e(4),n.e(6),n.e(7),n.e(10),n.e(9),n.e(12),n.e(11),n.e(13),n.e(19),n.e(15),n.e(21),n.e(20),n.e(16),n.e(14),n.e(18),n.e(17),n.e(22),n.e(89)]).then(n.bind(null,"1Cra"));case 3:return i=t.sent,r=i.AddEditDocumentViewModel,t.next=7,Promise.all([n.e(4),n.e(6)]).then(n.bind(null,"MCKn"));case 7:o=t.sent,l=o.AddEditDocumentComponent,a.a.document.GetDocumentDrafts(parseInt(e.DraftID),0,1,!1).subscribe((function(t){if(null!=(u=t.Tables[0])&&u.length>0)if("AddEditDocumentViewModel"==c.Parent.ClassName||"POSDocumentViewModel"==c.Parent.ClassName)c.CCID>0||(c.Parent.clear(1),c.Parent.LoadDraftXML(u[0]),a.a.page.HideDialog(),c.Parent.ScreenObject.GridDataObj.RefreshGridView());else{var n=1==c.ReportType,i=new r(parseInt(e.CostCenterID),e.Type.toString(),n);a.a.page.addNewTab({component:l,params:{obj:i}}),i.LoadDraftXML(u[0],n)}})),t.next=13;break;case 12:D.RibbonExtViewModel.LoadDraftRentalContract(this.Parent,parseInt(e.DraftID)),a.a.page.HideDialog();case 13:case"end":return t.stop()}}),t,this)})))}},{key:"GridLinkClick",value:function(e,t,n){event.preventDefault(),"Delete"==t?this.DeleteDraft(e):"Date_Text"!=t&&"DocName"!=t||this.LoadDraft(e)}},{key:"Table",get:function(){return this.Grid.Table},set:function(e){this.Grid.Table=e}},{key:"TableColumns",get:function(){return this.Grid.TableColumns},set:function(e){this.Grid.TableColumns=e}},{key:"ColSource",get:function(){return this.Grid.Columns},set:function(e){this.Grid.Columns=e}},{key:"SelectedRow",get:function(){return this.Grid.SelectedItem},set:function(e){this.Grid.SelectedItem=e}}]),r}(r.b)},rJVx:function(e,t,n){"use strict";n.r(t),n.d(t,"GeneralDashboardViewModel",(function(){return D}));var i=n("mrSG"),a=n("Do2H"),s=n("Lp6j"),r=n("ScVY"),o=n("NkMH"),l=n("ockk"),u=n("JIg3"),D=function(e){_inherits(r,e);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this)).ButtonPDC=new o.a,e.timerdashboard=new s.d,e.Date=new u.a(0),e.tdMaximize=new Array(4).fill(!1),Logger.InfoLog("DashboardViewModel::Entering DashboardViewModel"),e.timerdashboard.Enabled=!0,e.timerdashboard.Interval=6e4,a.a.SessionManager.IsWebApplication||e.timerdashboard.Elapsed(_assertThisInitialized(e),"timerdashboard_Elapsed"),e.DisplayName=a.a.GetResource("Dashboard_Maindashboard"),e.loadDrafts(),Logger.InfoLog("DashboardViewModel::Exiting DashboardViewModel"),e}return _createClass(r,[{key:"loadDrafts",value:function(){return Object(i.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,i,a,s,r,o,l=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(150).then(n.bind(null,"ouML"));case 2:return t=e.sent,i=t.DocumentDraftsViewModel,this.DocumentDrafts=new i(this,1),setTimeout((function(){l.DocumentDrafts.FillGrid()}),500),e.next=7,n.e(0).then(n.bind(null,"AyOk"));case 7:return a=e.sent,s=a.UnAppDocumentsViewModel,this.UnApprovedDocuments=new s,e.next=12,Promise.all([n.e(2),n.e(1),n.e(5),n.e(26),n.e(42),n.e(0),n.e(73)]).then(n.bind(null,"Wh9R"));case 12:r=e.sent,o=r.DashBoardNotifViewModel,this.NotifEvents=new o(2),this.PDCDocuments=new o(4);case 15:case"end":return e.stop()}}),e,this)})))}},{key:"timerdashboard_Elapsed",value:function(e,t){a.a.page.isActiveTab(this)&&(this.OnButtonClick("RefreshPDC"),this.OnButtonClick("RefreshEvents"),this.NotifEvents.RefreshData(),this.UnApprovedDocuments.OnLoad())}},{key:"OnButtonClick",value:function(e){"PostPDC"==e||("RefreshPDC"==e?(this.PDCDocuments.EventsType=4,this.PDCDocuments.InitColumns()):"PostEvents"==e||("RefreshEvents"==e?this.NotifEvents.RefreshData():"UnApproved"==e?this.UnApprovedDocuments.OnLoad():"Drafts"==e&&this.DocumentDrafts.FillGrid()))}},{key:"OnMessageCallBack",value:function(){this.res="Yes"}}],[{key:"InitColumns",value:function(e){var t,n="",i=[];if(a.a.SessionManager.Preferences.ContainsKey(e)&&(n=a.a.SessionManager.Preferences[e]),n.length>0){var r=new s.f;r.LoadXml(n);for(var o=0;o<r.DocumentElement.children.length;o++){var u=r.DocumentElement.children[o];(t=new l.a).Header=a.a.GetResource(u.attributes.Header.value),t.DisplayMember=u.attributes.ID.value,t.ReadOnly=!0,t.Width=parseInt(u.attributes.Width.value),i.push(t),"Un Approved Documents_DashBoardCustomize"==e?"VoucherNo"==t.DisplayMember?t.DataType="LINK":"Amount"==t.DisplayMember&&(t.DataType="FLOAT",t.DecimalPoints=a.a.SessionManager.Preferences.DecimalsinAmount.toString()):"Document Drafts_DashBoardCustomize"==e?"Date_Text"!=t.DisplayMember&&"Delete"!=t.DisplayMember||(t.DataType="LINK"):"Post Dated Documents_DashBoardCustomize"==e?"VoucherNo"==t.DisplayMember?t.DataType="LINK":"Amount"==t.DisplayMember&&(t.DataType="FLOAT",t.DecimalPoints=a.a.SessionManager.Preferences.DecimalsinAmount.toString()):"Notification Events_DashBoardCustomize"==e&&"VoucherNo"==t.DisplayMember&&(t.DataType="LINK")}}return i}},{key:"IsActionAssigned",value:function(e,t){return a.a.SessionManager.IsActionAssigned(e,t)}}]),r}(r.b)}}]);