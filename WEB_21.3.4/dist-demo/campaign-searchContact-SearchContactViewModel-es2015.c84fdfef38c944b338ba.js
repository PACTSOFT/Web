(window.webpackJsonp=window.webpackJsonp||[]).push([[110],{"13BN":function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var n=i("Do2H"),o=i("Lp6j");class s{constructor(){this.PreferredID=0,this.AccountID=0,this.CustomerID=0,this.DetailContactID=0,this.FeatureID=0,this.FeatureNodeID=0,this.SelectedNodeID=0,this.IsEmail=!1,this.IsBulkMail=!1,this.IsMail=!1,this.IsPhone=!1,this.IsFax=!1,this.IsGroup=!1,this.ActivityXml=""}SaveDContact(){0==this.DetailContactID&&(this.GUID=o.e.NewGuid());let t=[];return t.push(this.FeatureID),t.push(this.FeatureNodeID),t.push(this.AccountID),t.push(this.CustomerID),t.push(this.DetailContactID),t.push(this.FName),t.push(this.MName),t.push(this.LName),t.push(this.XML),t.push(this.Status),t.push(this.IsGroup),t.push(!1),t.push(this.CCMapXML),t.push(this.AttachmetsXML),t.push(this.NotesXML),t.push(this.ActivityXml),t.push(this.CustomFieldsQuery),t.push(this.CustomCostCenterFieldsQuery),t.push(this.SelectedNodeID),t.push(n.a.SessionManager.CompanyGUID),t.push(this.GUID),t.push(n.a.SessionManager.UserName),t.push(n.a.SessionManager.RoleID),t.push(n.a.SessionManager.LanguageID),n.a.crmService.SaveDContact(t)}GetContactDetails(){let t=[];t.push(this.DetailContactID),t.push(n.a.SessionManager.UserID),t.push(n.a.SessionManager.RoleID),t.push(n.a.SessionManager.LanguageID);let e="?param="+JSON.stringify(t);return n.a.crmService.GetContactDetails(e)}GetContactSearchDetails(t){Logger.InfoLog("DContact:: Inside GetContactDetails");let e=[];e.push(t),e.push(n.a.SessionManager.UserID),e.push(n.a.SessionManager.LanguageID);let i="?param="+JSON.stringify(e),o=n.a.crmService.GetContactSearchDetails(i);return Logger.InfoLog("DContact:: Success: BaseService.crmService.GetContactDetails "+t.toString()),o}DeleteContact(t){Logger.InfoLog("Contact:: Entering DeleteContact");try{let e=[];return e.push(t),e.push(n.a.SessionManager.RoleID),Logger.InfoLog("Asset:: Exiting DeleteContact"),n.a.crmService.DeleteContact(e)}catch(e){return Logger.ErrorLog("Contact::DeleteContact"+e.stack),""}}}},"86Y6":function(t,e,i){"use strict";i.r(e),i.d(e,"SearchContactViewModel",(function(){return y}));var n=i("4HhE"),o=i("n56n"),s=i("ScVY"),a=i("ockk"),r=i("8B8H"),l=i("0/4Q"),u=i("wlFP"),C=i("eQJW"),h=i("PDNK"),c=i("EQd/"),m=i("Lp6j"),S=i("JIg3"),d=i("Do2H");class D{constructor(){this._DocumentID=0,this.className="PreferenceControlGenerator",this.SessionManager=d.a.SessionManager,this.commonService=d.a.common}get Data(){return this._Data}LoadScreen(t,e){Logger.InfoLog("PreferenceControlGenerator:: Inside LoadScreen"),this._Data=null,this.OnLoad(t,e)}LoadScreen_1(t,e,i){Logger.InfoLog("PreferenceControlGenerator:: Inside LoadScreen"),this._DocumentID=i,this._Data=null,this.OnLoad(t,e)}OnLoad(t,e){try{if(null==this._Data){this.oParent=t,this._Data=this._DocumentID>0?this.GetScreenInfo_2(e,this._DocumentID):this.GetScreenInfo(e);for(const i in t){let s=t[i];if(s instanceof n.c||s instanceof l.e||s instanceof o.b||s instanceof S.a||s instanceof o.a){let t=s;null!=t&&t.FeatureID==e&&(this.StaticFields.push(t),this.SetProperties_Static(t))}}}}catch(i){Logger.ErrorLog("PreferenceControlGenerator:: LoadScreen : "+i.stack)}}SetProperties_Static(t){let e=this._Data.Tables[0].filter(e=>e.CostCenterColID==t.DBColumnID);if(e.length>0)if(t instanceof l.e){t.Label=e[0].Text.toString();let i=t;if(e[0].Contains("ProbableValues")){let t=null!=e[0].UserProbableValues?e[0].UserProbableValues.toString().trim():[];if(t.length>0&&null!=i){let e=t.split(";");for(let t=0;t<e.length;t++)i.Items.push(l.d.ComboBoxItems_2(e[t].replace("''","'"),e[t].replace("''","'")));i.SelectedValue=i.Items[0].Value}}i.DefaultValue=e[0].Value.toString(),this.SetProperty_DefaultValue(i)}else t.Label=e[0].Text.toString(),t.DefaultValue=e[0].Value.toString(),this.SetProperty_DefaultValue(t);else t.Label=""}SetProperty_DefaultValue(t){if(t instanceof u.a)try{t.IsChecked=Object(C.j)(t.DefaultValue)}catch(e){}else if(t instanceof o.b)try{t.SelectedValue=parseInt(t.DefaultValue)}catch(i){}else if(t instanceof h.a)try{t.IsChecked=Object(C.j)(t.DefaultValue)}catch(n){}else if(t instanceof c.d)try{t.Text=t.DefaultValue}catch(s){}else if(t instanceof l.e)try{t.SelectedValue=m.e.IsEmpty(t.DefaultValue)?"":t.DefaultValue}catch(a){}else if(t instanceof S.a)try{t.Date=new Date(t.DefaultValue)}catch(r){}}GetScreenInfo(t){try{return this.commonService.GetScreenInfo(t)}catch(e){return this.SessionManager.Logger.ErrorLog("ControlGenerator:: GetScreenInfo"+e),null}}GetScreenInfo_2(t,e){Logger.InfoLog("PreferenceControlGenerator:: Inside GetScreenInfo");try{let i=null;return i=d.a.document.GetScreenInfo_2(t,e,0),i}catch(i){return Logger.ErrorLog("PreferenceControlGenerator:: GetScreenInfo"+i.stack),null}}GetDocFields(t,e){}GetTableName(t){return 2==t?"ACC_Accounts":3==t?"INV_Product":50001==t?"COM_Division":50002==t?"COM_Location":50003==t?"COM_Branch":50004==t?"COM_Department":50005==t?"COM_Salesman":50006==t?"COM_Category":50007==t?"COM_Area":50008==t?"COM_Teritory":"COM_CC"+t}GetUnitStatuses(t){}SetPayrollDocumentFields(t){}}var p=i("13BN");class y extends s.b{constructor(t){super(),this.Fields=new Array,this.ButtonClick=new n.b,this.TableObj=new r.a,this.SelectedGrid=new r.a,this.Title="",this.className="SearchContactViewModel",this.Title="Search Contacts",this.ButtonClick.Subscribe(this,"OnButtonClick"),"ViewOrganizationViewModel"==t.ClassName?this.Oparent=t:"ViewInvitesViewModel"==t.ClassName?this.OIparent=t:"ViewStaffViewModel"==t.ClassName?this.OStaff=t:"ResponcesViewModel"==t.ClassName?this.OResponses=t:this.OSpeaker=t,this.LoadGrid();let e=0,i=0,s=new o.b(0);s.CCID=83,s.TypeID=1,s.Label="Customer",s.DBColumnID=26644,s.DBColumnName="CustomerID",s.SysColumnName="CustomerID",s.Column=e,s.Row=i,this.Fields.push(s),e+=1;let a=new D;a.LoadScreen(this,88);let l=a.Data.Tables[0],u=null;l.RowFilter="DBText='SearchContactDims'",l=l.filter(t=>"SearchContactDims"==t.DBText),l.length>0&&l[0].Value.toString().length>0&&(u=l[0].Value.toString().split(",")),null!=u&&(a.Data.Tables.length>1&&(l=a.Data.Tables[1].DefaultView),u.forEach(t=>{s=new o.b(0),s.CCID=parseInt(t),s.TypeID=1,l.Table.Columns.Contains("FeatureID")&&(l.RowFilter="FeatureID="+t,l.length>0&&(s.Label=l[0].Name.toString())),s.Column=e,s.Row=i,this.Fields.push(s),3==e?(i+=1,e=0):e+=1}))}get angularGrid(){return this.TableObj.angularGrid}get Table(){return this.TableObj.Table}get Columns(){return this.TableObj.TableColumns}get ColumnSource(){return this.TableObj.Columns}set ColumnSource(t){this.TableObj.Columns=t}get SelectedGridTable(){return this.SelectedGrid.Table}get SelectedItem(){return this.SelectedGrid.SelectedItem}get SelectedGridColumns(){return this.SelectedGrid.Columns}set SelectedGridColumns(t){this.SelectedGrid.Columns=t}LoadGrid(){let t;this.TableObj.Table=[],this.Columns.push("Customer"),this.Columns.push("CustomerID"),this.Columns.push("ContactID"),this.Columns.push("ContactName"),this.Columns.push("JobTitle"),this.Columns.push("Department"),this.Columns.push("Salutation"),this.Columns.push("SalutationID"),(null!=this.Oparent?73!=this.Oparent.CostCenterID:null!=this.OSpeaker&&73!=this.OSpeaker.CostCenterID)||null!=this.OIparent&&73!=this.OIparent.CostCenterID||null!=this.OStaff||null!=this.OResponses?(this.Columns.push("CytomedDivision"),this.Columns.push("CytomedDivision_Key"),this.Columns.push("Territory"),this.Columns.push("Territory_Key"),this.Columns.push("City"),this.Columns.push("City_Key"),this.Columns.push("Country"),this.Columns.push("Country_Key")):(this.Columns.push("MiddleName"),this.Columns.push("LastName")),this.Columns.push("Action"),this.SelectedGrid.Table=[],this.SelectedGrid.TableColumns.push("Customer"),this.SelectedGrid.TableColumns.push("CustomerID"),this.SelectedGrid.TableColumns.push("ContactID"),this.SelectedGrid.TableColumns.push("ContactName"),this.SelectedGrid.TableColumns.push("JobTitle"),this.SelectedGrid.TableColumns.push("Department"),this.SelectedGrid.TableColumns.push("Salutation"),this.SelectedGrid.TableColumns.push("SalutationID"),(null!=this.Oparent?73!=this.Oparent.CostCenterID:null!=this.OSpeaker&&73!=this.OSpeaker.CostCenterID)||null!=this.OIparent||null!=this.OStaff||null!=this.OResponses?(this.SelectedGrid.TableColumns.push("CytomedDivision"),this.SelectedGrid.TableColumns.push("CytomedDivision_Key"),this.SelectedGrid.TableColumns.push("Territory"),this.SelectedGrid.TableColumns.push("Territory_Key"),this.SelectedGrid.TableColumns.push("City"),this.SelectedGrid.TableColumns.push("City_Key"),this.SelectedGrid.TableColumns.push("Country"),this.SelectedGrid.TableColumns.push("Country_Key")):(this.SelectedGrid.TableColumns.push("MiddleName"),this.SelectedGrid.TableColumns.push("LastName")),this.SelectedGrid.TableColumns.push("Action"),this.ColumnSource=[],this.SelectedGridColumns=[],t=new a.a,t.Header=d.a.GetResource("Service_Action"),t.DisplayMember="Action",t.DataType="LINK",t.Width=65,t.ReadOnly=!0,t.Click.Subscribe(this,"onClick"),this.ColumnSource.push(t),t=new a.a,t.Header=d.a.GetResource("Customer"),t.DisplayMember="Customer",t.DataType="TEXTBOX",t.Width=150,t.IsVisible=(null!=this.Oparent?73!=this.Oparent.CostCenterID:null==this.OSpeaker||73!=this.OSpeaker.CostCenterID)&&null==this.OIparent&&null==this.OStaff&&null==this.OResponses,t.ReadOnly=!0,this.ColumnSource.push(t),this.SelectedGridColumns.push(t),t=new a.a,t.Header=d.a.GetResource("ContactName"),t.DisplayMember="ContactName",t.DataType="TEXTBOX",t.Width=150,t.IsVisible=!0,t.ReadOnly=!0,this.ColumnSource.push(t),this.SelectedGridColumns.push(t),t=new a.a,t.Header=d.a.GetResource("JobTitle"),t.DisplayMember="JobTitle",t.DataType="TEXTBOX",t.Width=150,t.IsVisible=!0,t.ReadOnly=!0,this.ColumnSource.push(t),this.SelectedGridColumns.push(t),t=new a.a,t.Header=d.a.GetResource("Department"),t.DisplayMember="Department",t.DataType="TEXTBOX",t.Width=150,t.IsVisible=!0,t.ReadOnly=!0,this.ColumnSource.push(t),this.SelectedGridColumns.push(t),t=new a.a,t.Header=d.a.GetResource("Salutation"),t.DisplayMember="Salutation",t.DataType="TEXTBOX",t.Width=150,t.IsVisible=!0,t.ReadOnly=!0,this.ColumnSource.push(t),this.SelectedGridColumns.push(t),(null!=this.Oparent?73!=this.Oparent.CostCenterID:null!=this.OSpeaker&&73!=this.OSpeaker.CostCenterID)?(t=new a.a,t.Header=d.a.GetResource("CytomedDivision"),t.DisplayMember="CytomedDivision",t.DataType="TEXTBOX",t.Width=150,t.IsVisible=!0,t.ReadOnly=!0,this.ColumnSource.push(t),this.SelectedGridColumns.push(t),t=new a.a,t.Header=d.a.GetResource("Country"),t.DisplayMember="Country",t.DataType="TEXTBOX",t.Width=150,t.IsVisible=!0,t.ReadOnly=!0,this.ColumnSource.push(t),this.SelectedGridColumns.push(t),t=new a.a,t.Header=d.a.GetResource("City"),t.DisplayMember="City",t.DataType="TEXTBOX",t.Width=150,t.IsVisible=!0,t.ReadOnly=!0,this.ColumnSource.push(t),this.SelectedGridColumns.push(t),t=new a.a,t.Header=d.a.GetResource("Territory"),t.DisplayMember="Territory",t.DataType="TEXTBOX",t.Width=150,t.IsVisible=!0,t.ReadOnly=!0,this.ColumnSource.push(t),this.SelectedGridColumns.push(t)):null==this.OIparent&&null==this.OStaff&&null==this.OResponses||(t=new a.a,t.Header=d.a.GetResource("CytomedDivision"),t.DisplayMember="CytomedDivision",t.DataType="TEXTBOX",t.Width=150,t.IsVisible=!0,t.ReadOnly=!0,this.ColumnSource.push(t),this.SelectedGridColumns.push(t),t=new a.a,t.Header=d.a.GetResource("Country"),t.DisplayMember="Country",t.DataType="TEXTBOX",t.Width=150,t.IsVisible=!0,t.ReadOnly=!0,this.ColumnSource.push(t),this.SelectedGridColumns.push(t),t=new a.a,t.Header=d.a.GetResource("City"),t.DisplayMember="City",t.DataType="TEXTBOX",t.Width=150,t.IsVisible=!0,t.ReadOnly=!0,this.ColumnSource.push(t),this.SelectedGridColumns.push(t),t=new a.a,t.Header=d.a.GetResource("Territory"),t.DisplayMember="Territory",t.DataType="TEXTBOX",t.Width=150,t.IsVisible=!0,t.ReadOnly=!0,this.ColumnSource.push(t),this.SelectedGridColumns.push(t)),this.TableObj.Columns=this.ColumnSource,this.SelectedGrid.Columns=this.SelectedGridColumns}OnSelectionChangedCommand(t){null!=t&&t.toString()}onClick(){if(null!=this.SelectedItem){let t=this.SelectedGrid.NewRow();t.Customer=this.SelectedItem.Customer.toString(),t.CustomerID=this.SelectedItem.CustomerID.toString(),t.ContactName=this.SelectedItem.ContactName.toString(),t.ContactID=this.SelectedItem.ContactID.toString(),t.Salutation=this.SelectedItem.Salutation.toString(),t.SalutationID=this.SelectedItem.SalutationID.toString(),t.JobTitle=this.SelectedItem.JobTitle.toString(),t.Department=this.SelectedItem.Department.toString(),this.SelectedGrid.TableColumns.Contains("Country")&&(t.Country=this.SelectedItem.Country.toString()),this.SelectedGrid.TableColumns.Contains("City")&&(t.City=this.SelectedItem.City.toString()),this.SelectedGrid.TableColumns.Contains("CytomedDivision")&&(t.CytomedDivision=this.SelectedItem.CytomedDivision.toString()),this.SelectedGrid.TableColumns.Contains("Territory")&&(t.Territory=this.SelectedItem.Territory.toString()),this.SelectedGrid.TableColumns.Contains("Country")&&(t.Country=this.SelectedItem.Country.toString()),this.SelectedGrid.TableColumns.Contains("City")&&(t.City=this.SelectedItem.City.toString()),this.SelectedGrid.TableColumns.Contains("Country_key")&&(t.Country_key=this.SelectedItem.Country_key.toString()),this.SelectedGrid.TableColumns.Contains("City_key")&&(t.City_key=this.SelectedItem.City_key.toString()),this.SelectedGrid.TableColumns.Contains("CytomedDivision_Key")&&(t.CytomedDivision_Key=this.SelectedItem.CytomedDivision_Key.toString()),this.SelectedGrid.TableColumns.Contains("Territory_Key")&&(t.Territory_Key=this.SelectedItem.Territory_Key.toString()),t.Action="Add",this.SelectedGrid.addRows(t)}}OnButtonClick(t){if(null!=t)if("Cancel"==t.toString())d.a.page.HideDialog();else if("OK"==t.toString()){let t=null;for(let e=0;e<this.SelectedGrid.Table.length;e++){let i=this.SelectedGrid.Table[e];if(null!=this.Oparent&&"ViewOrganizationViewModel"==this.Oparent.ClassName){if(this.Oparent.lstContacts.filter(t=>t.toString()==i.ContactID.toString()).length>0&&confirm("Duplicate contact found '"+i.ContactName.toString()+"' \r\n Do you want to continue "))continue;this.Oparent.lstContacts.push(null!=i.ContactID&&""!=i.ContactID.toString()?parseInt(i.ContactID.toString()):0);let t=this.Oparent.OrganizationDataObj.NewRow();t.Customer=i.Customer.toString(),t.CustomerID=i.CustomerID.toString(),t.ContactName=i.ContactName.toString(),t.ContactID=i.ContactID.toString(),t.Salutation=i.Salutation.toString(),t.SalutationID=i.SalutationID.toString(),t.JobTitle=i.JobTitle.toString(),t.Department=i.Department.toString(),this.Oparent.OrganizationDataObj.TableColumns.Contains("Country")&&(t.Country=i.Country.toString()),this.Oparent.OrganizationDataObj.TableColumns.Contains("City")&&(t.City=i.City.toString()),this.Oparent.OrganizationDataObj.TableColumns.Contains("CytomedDivision")&&(t.CytomedDivision=i.CytomedDivision.toString()),this.Oparent.OrganizationDataObj.TableColumns.Contains("Territory")&&(t.Territory=i.Territory.toString()),this.Oparent.OrganizationDataObj.TableColumns.Contains("Country_key")&&(t.Country_key=i.Country_key.toString()),this.Oparent.OrganizationDataObj.TableColumns.Contains("City_key")&&(t.City_key=i.City_key.toString()),this.Oparent.OrganizationDataObj.TableColumns.Contains("CytomedDivision_Key")&&(t.CytomedDivision_Key=i.CytomedDivision_Key.toString()),this.Oparent.OrganizationDataObj.TableColumns.Contains("Territory_Key")&&(t.Territory_Key=i.Territory_Key.toString()),this.Oparent.OrganizationDataObj.addRows(t)}else if(null!=this.OIparent&&"ViewInvitesViewModel"==this.OIparent.ClassName){if(this.OIparent.lstContacts.filter(t=>t.toString()==i.ContactID.toString()).length>0&&confirm("Duplicate contact found '"+i.ContactName.toString()+"' \r\n Do you want to continue "))continue;this.OIparent.lstContacts.push(null!=i.ContactID&&""!=i.ContactID.toString()?parseInt(i.ContactID.toString()):0);let t=this.OIparent.InvitesData.NewRow();t.Customer=i.Customer.toString(),t.CustomerID=i.CustomerID.toString(),t.ContactName=i.ContactName.toString(),t.ContactID=i.ContactID.toString(),t.Salutation=i.Salutation.toString(),t.SalutationID=i.SalutationID.toString(),t.JobTitle=i.JobTitle.toString(),t.Department=i.Department.toString(),this.OIparent.InvitesData.Columns.Contains("Country")&&(t.Country=i.Country.toString()),this.OIparent.InvitesData.Columns.Contains("City")&&(t.City=i.City.toString()),this.OIparent.InvitesData.Columns.Contains("CytomedDivision")&&(t.CytomedDivision=i.CytomedDivision.toString()),this.OIparent.InvitesData.Columns.Contains("Territory")&&(t.Territory=i.Territory.toString()),this.OIparent.InvitesData.Columns.Contains("Country_key")&&(t.Country_key=i.Country_key.toString()),this.OIparent.InvitesData.Columns.Contains("City_key")&&(t.City_key=i.City_key.toString()),this.OIparent.InvitesData.Columns.Contains("CytomedDivision_Key")&&(t.CytomedDivision_Key=i.CytomedDivision_Key.toString()),this.OIparent.InvitesData.Columns.Contains("Territory_Key")&&(t.Territory_Key=i.Territory_Key.toString()),this.OIparent.InvitesData.addRows(t)}else if(null!=this.OStaff&&"ViewStaffViewModel"==this.OStaff.ClassName){if(this.OStaff.lstContacts.filter(t=>t.toString()==i.ContactID.toString()).length>0&&confirm("Duplicate contact found '"+i.ContactName.toString()+"' \r\n Do you want to continue "))continue;if(null!=i.CustomerID.toString()&&""!=i.CustomerID.toString()&&"0"!=i.CustomerID.toString()){this.OStaff.lstContacts.push(null!=i.ContactID&&""!=i.ContactID.toString()?parseInt(i.ContactID.toString()):0);let t=this.OStaff.OrganizationData.NewRow();t.Type="Involve",t.Customer=i.Customer.toString(),t.CustomerID=i.CustomerID.toString(),t.JobTitle=i.JobTitle.toString(),t.StaffName=i.ContactName.toString(),t.ContactID=i.ContactID.toString(),this.OStaff.OrganizationData.Rows.push(t)}}else if(null!=this.OSpeaker&&"ViewCampaignSpeakersViewModel"==this.OSpeaker.ClassName){if(this.OSpeaker.lstContacts.filter(t=>t.toString()==i.ContactID.toString()).length>0&&confirm("Duplicate contact found '"+i.ContactName.toString()+"' \r\n Do you want to continue "))continue;if(null!=i.CustomerID.toString()&&""!=i.CustomerID.toString()&&"0"!=i.CustomerID.toString()){this.OSpeaker.lstContacts.push(null!=i.ContactID&&""!=i.ContactID.toString()?parseInt(i.ContactID.toString()):0);let t=this.OSpeaker.SpeakersData.NewRow();t.date=(new Date).ToString("dd/MMM/yyyy"),t.Customer=i.Customer.toString(),t.CustomerID=i.CustomerID.toString(),t.ContactName=i.ContactName.toString(),t.ContactID=i.ContactID.toString(),this.OSpeaker.SpeakersData.Rows.push(t)}}else if(null!=this.OResponses&&"ResponcesViewModel"==this.OResponses){if(this.OResponses.lstContacts.filter(t=>t.toString()==i.ContactID.toString()).length>0&&confirm("Duplicate contact found '"+i.ContactName.toString()+"' \r\n Do you want to continue "))continue;if(null!=i.CustomerID.toString()&&""!=i.CustomerID.toString()&&"0"!=i.CustomerID.toString()){this.OResponses.lstContacts.push(null!=i.ContactID&&""!=i.ContactID.toString()?parseInt(i.ContactID.toString()):0);let e=this.OResponses.grdata.NewRow();if(e.ReceivedDate=(new Date).ToString("dd/MMM/yyyy"),null!=t&&t.Tables.length>4&&t.Tables[5].length>0){let i=t.Tables[5];null!=i&&(i.RowFilter="IsDefault=1",i.length>0&&(e.ResponceType=i[0].Name.toString(),e.CampgnRespLookupID=i[0].NodeID.toString()))}e.ContactID=i.ContactID.toString(),e.Customer=i.Customer.toString(),e.CompanyName=i.Customer.toString(),e.CustomerID=i.CustomerID.toString(),e.JobTitle=i.JobTitle.toString(),e.ContactName=i.ContactName.toString(),e.FirstName=i.ContactName.toString(),e.JobTitle=i.JobTitle.toString(),e.Department=i.Department.toString(),e.Campaign=null!=this.OResponses.ObjParent&&null!=this.OResponses.ObjParent.txtName?this.OResponses.ObjParent.txtName.Text:"",this.OResponses.grdata.Rows.push(e)}}}d.a.page.HideDialog(),this.ClearData()}else if("Clear"==t.toString())this.ClearData();else if("Search"==t.toString()){let t="";if(this.Fields.forEach(e=>{e instanceof o.b&&(this.oPactCombo=e,this.oPactCombo.SelectedValue>0&&(t+=0==t.length?" where ":" and ",83==this.oPactCombo.CCID?t+=" ( cus.customerid= "+this.oPactCombo.SelectedValue+" ) ":(t+=" ( (c.FeatureID=65 and CC.CCNID"+(this.oPactCombo.CCID-5e4)+"="+this.oPactCombo.SelectedValue+" )",t+=" or (  c.FeatureID=83 and cccus.CCNID"+(this.oPactCombo.CCID-5e4)+"="+this.oPactCombo.SelectedValue+" )) ")))}),t.toString().length>0){let e=(new p.a).GetContactSearchDetails(t.toString());null!=e&&e.Tables.length>0&&(this.TableObj.Clear(),e.Tables[0].forEach(t=>{let e=this.TableObj.NewRow();e.Customer=t.CustomerName.toString(),e.CustomerID=t.CustomerID.toString(),e.ContactName=t.FirstName.toString(),e.ContactID=t.ContactID.toString(),e.Salutation=t.Salutation.toString(),e.SalutationID=t.SalutationID.toString(),e.JobTitle=t.JobTitle.toString(),e.Department=t.Department.toString(),this.TableObj.TableColumns.Contains("Country")&&(e.Country=t.Country.toString()),this.TableObj.TableColumns.Contains("City")&&(e.City=t.City.toString()),this.TableObj.TableColumns.Contains("City")&&(e.CytomedDivision=t.CytomedDivision.toString()),this.TableObj.TableColumns.Contains("City")&&(e.Territory=t.Territory.toString()),this.TableObj.TableColumns.Contains("City")&&(e.Country=t.Country1.toString()),this.TableObj.TableColumns.Contains("City")&&(e.City=t.City1.toString()),this.TableObj.TableColumns.Contains("City")&&(e.Country_key=t.CountryID.toString()),this.TableObj.TableColumns.Contains("City")&&(e.City_key=t.CityID.toString()),this.TableObj.TableColumns.Contains("City")&&(e.CytomedDivision_Key=t.CytomedDivisionID.toString()),this.TableObj.TableColumns.Contains("City")&&(e.Territory_Key=t.TerritoryID.toString()),e.Action="Add",this.TableObj.addRows(e)}))}}}ClearData(){this.TableObj.Clear(),this.Fields.forEach(t=>{t instanceof o.b&&(null!=t.DBColumnName&&t.DBColumnName.toLowerCase().Contains("ccnid")||null!=t.DBColumnName&&"customerid"==t.DBColumnName.toLowerCase())&&(this.oPactCombo=t,this.oPactCombo.SelectedValue=0)})}}}}]);