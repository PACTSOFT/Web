(window.webpackJsonp=window.webpackJsonp||[]).push([[91],{lUfH:function(e,t,s){"use strict";s.r(t),s.d(t,"ChequeBookViewModel",(function(){return p}));var i=s("Do2H"),o=s("Lp6j"),n=s("ScVY"),a=s("8B8H"),l=s("0/4Q"),c=s("EQd/"),r=s("ockk"),u=s("jDOZ"),h=s("3Pt+"),d=s("fXoL"),b=s("ofXK"),N=s("q8k3"),g=s("sYmb");function C(e,t){if(1&e&&(d.Zb(0,"div",6),d.Wc(1,"\n            "),d.Vb(2,7),d.Wc(3,"\n        "),d.Yb()),2&e){const e=d.lc();d.Db(2),d.tc("obj",e.obj.ChequeNo)("group",e.form)}}let S=(()=>{class e{constructor(){this.form=new h.j({})}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=d.Nb({type:e,selectors:[["app-cancel-cheque-book"]],inputs:{obj:"obj"},decls:21,vars:7,consts:[[1,"master-screen"],[1,"PACTHeaderFields","dialogSubBody"],["class","form-group col-xl-12 col-md-12 col-sm-12 col-xs-12 PACTControl",4,"ngIf"],[1,"Pactdailogfooter"],[1,"primary-btn-wicon",3,"click"],[1,"secondary-btn-wicon",3,"click"],[1,"form-group","col-xl-12","col-md-12","col-sm-12","col-xs-12","PACTControl"],["FieldDirective","",3,"obj","group"]],template:function(e,t){1&e&&(d.Zb(0,"div",0),d.Wc(1,"\n    "),d.Zb(2,"div",1),d.Wc(3,"\n        "),d.Uc(4,C,4,2,"div",2),d.Wc(5,"\n    "),d.Yb(),d.Wc(6,"\n    "),d.Zb(7,"div",3),d.Wc(8,"\n        "),d.Zb(9,"div"),d.Wc(10,"\n            "),d.Zb(11,"button",4),d.hc("click",(function(){return t.obj.OnButtonClick("Submit")})),d.Wc(12),d.mc(13,"translate"),d.Yb(),d.Wc(14,"\n            "),d.Zb(15,"button",5),d.hc("click",(function(){return t.obj.OnButtonClick("ChequeCancel")})),d.Wc(16),d.mc(17,"translate"),d.Yb(),d.Wc(18,"\n        "),d.Yb(),d.Wc(19,"\n    "),d.Yb(),d.Wc(20,"\n"),d.Yb()),2&e&&(d.Db(4),d.tc("ngIf",t.obj.ChequeNo.Visible),d.Db(8),d.Xc(d.nc(13,3,"Submit")),d.Db(4),d.Xc(d.nc(17,5,"Cancel")))},directives:[b.t,N.a],pipes:[g.d],encapsulation:2}),e})();class p extends n.b{constructor(){super(),this.obj=new u.a,this.CancelledDisplayMessage="",this.CancelledMessageVisibility=!1,this.ChequeCancelVisibility=!1,this.DisplayName="",this.AccountList=new l.e(0),this.ChequeNo=new c.d(0),this.SNO=1,this.DisplayName=i.a.GetResource("ChequeBooks");let e=this.obj.GetChequeBookDetail(0);this.AccountList.SelectionChangedCommand.Subscribe(this,"OnSelectionChanged"),null!=e&&e.Tables.length>0&&e.Tables[0].length>0&&e.Tables[0].forEach(e=>{this.AccountList.Items.push(l.d.ComboBoxItems_2(e.AccountName.toString(),e.AccountID.toString()))}),this.loadGrid(),this.AccountsGrid.OnCellEditEnding.Subscribe(this,"OnCellEndEdit"),this.AccountsGrid.SearchVisible=!1,this.AccountList.Label="Accounts",this.ChequeNo.Label="Cheque No"}loadGrid(){let e=[],t={};t.Name=i.a.GetResource("Open"),t.Value=1,e.push(t),t={},t.Name=i.a.GetResource("Close"),t.Value=2,e.push(t),this.AccountsGrid=new a.a,this.AccountsGrid.CanUserAddRows=!0,this.AccountsGrid.CanUserDeleteRows=!0,this.AccountsGrid.Table=[],this.AccountsGrid.TableColumns.push("Sno"),this.AccountsGrid.TableColumns.push("BookNo"),this.AccountsGrid.TableColumns.push("StartNo"),this.AccountsGrid.TableColumns.push("EndNo"),this.AccountsGrid.TableColumns.push("CurrentNo"),this.AccountsGrid.TableColumns.push("CancelledCheques"),this.AccountsGrid.TableColumns.push("Status"),this.AccountsGrid.Columns=[];let s=new r.a;s=new r.a,s.Header=i.a.GetResource("Sno"),s.DisplayMember="Sno",s.DataType="TextBlock",s.Width=50,s.ReadOnly=!0,this.AccountsGrid.Columns.push(s),s=new r.a,s.Header=i.a.GetResource("BookNo"),s.DisplayMember="BookNo",s.DataType="TextBlock",s.Width=280,s.ReadOnly=!1,this.AccountsGrid.Columns.push(s),s=new r.a,s.Header=i.a.GetResource("StartNo"),s.DisplayMember="StartNo",s.DataType="TextBlock",s.Width=150,s.ReadOnly=!1,this.AccountsGrid.Columns.push(s),s=new r.a,s.Header=i.a.GetResource("EndNo"),s.DisplayMember="EndNo",s.DataType="TextBlock",s.Width=150,s.ReadOnly=!1,this.AccountsGrid.Columns.push(s),s=new r.a,s.Header=i.a.GetResource("CurrentNo"),s.DisplayMember="CurrentNo",s.DataType="TextBlock",s.Width=150,s.ReadOnly=!1,this.AccountsGrid.Columns.push(s),s=new r.a,s.Header=i.a.GetResource("CancelledCheques"),s.DisplayMember="CancelledCheques",s.DataType="TextBlock",s.Width=280,s.ReadOnly=!0,this.AccountsGrid.Columns.push(s),s=new r.a,s.Header=i.a.GetResource("Status"),s.ValueBinding="Status",s.DataType="ComboBox",s.DisplayMember="Name",s.ValueMember="Value",s.Width=70,s.ComboData=e,this.AccountsGrid.Columns.push(s),this.AccountsGrid.Clear();for(let i=0;i<20;i++){let e=this.AccountsGrid.NewRow();e.Sno=i+1,this.AccountsGrid.addRow(e)}this.AccountsGrid.TableNewRow.Subscribe(this,"Table_TableNewRow")}OnCellEndEdit(e,t,s){let i=this.AccountsGrid.Table.indexOf(e)+1;return""==o.e.String(e.BookNo)?(this.DisplayMessage="BookNo instanceof Empty at RowNo "+i,void(this.MessageVisibility=!0)):"BookNo"==t&&this.AccountsGrid.Table.filter(t=>t.BookNo==e.BookNo.toString()).length>1?(this.DisplayMessage="BookNo already selected with the Name '"+e.BookNo.toString()+"'",this.MessageVisibility=!0,e.BookNo=null,e.StartNo=null,e.EndNo=null,e.CurrentNo=null,e.CancelledCheques=null,void this.AccountsGrid.updateRow(e)):"CurrentNo"==t&&!o.e.IsEmpty(e.CurrentNo)&&(parseInt(e.CurrentNo.toString())>parseInt(e.EndNo.toString())||parseInt(e.CurrentNo.toString())<parseInt(e.StartNo.toString()))?(this.DisplayMessage="CurrentNo. in BookNo. '"+e.BookNo.toString()+"' instanceof out of Range",void(this.MessageVisibility=!0)):void 0}Table_TableNewRow(e){this.UpdateSequence(),e.Sno=this.SNO}UpdateSequence(){this.SNO=1,this.AccountsGrid.Table.forEach(e=>{e.Sno=this.SNO++})}OnButtonClick(e){var t,s;if((null===(t=this.AccountsGrid.angularGrid)||void 0===t?void 0:t.slickGrid)&&(null===(s=this.AccountsGrid.angularGrid)||void 0===s?void 0:s.slickGrid.getActiveCellNode())&&this.AccountsGrid.angularGrid.slickGrid.getEditorLock().commitCurrentEdit(),"Save"==e){let e="";e+="<XML>";for(let s=0;s<this.AccountsGrid.Table.length;s++)if(!o.e.IsEmpty(this.AccountsGrid.Table[s].BookNo)){if(""==o.e.String(this.AccountsGrid.Table[s].StartNo))return this.DisplayMessage="Enter start No. for BookNo. = '"+this.AccountsGrid.Table[s].BookNo.toString()+"'",void(this.MessageVisibility=!0);if(0==o.e.Int(this.AccountsGrid.Table[s].StartNo))return this.DisplayMessage="Invalid start No. for BookNo. = '"+this.AccountsGrid.Table[s].BookNo.toString()+"'",void(this.MessageVisibility=!0);if(""==o.e.String(this.AccountsGrid.Table[s].EndNo))return this.DisplayMessage="Enter End No. for BookNo. = '"+this.AccountsGrid.Table[s].BookNo.toString()+"'",void(this.MessageVisibility=!0);if(0==o.e.Int(this.AccountsGrid.Table[s].EndNo))return this.DisplayMessage="Invalid End No. for BookNo. = '"+this.AccountsGrid.Table[s].BookNo.toString()+"'",void(this.MessageVisibility=!0);if(!o.e.IsEmpty(this.AccountsGrid.Table[s].CurrentNo)&&0==o.e.Int(this.AccountsGrid.Table[s].CurrentNo))return this.DisplayMessage="Invalid Current No. for BookNo. = '"+this.AccountsGrid.Table[s].BookNo.toString()+"'",void(this.MessageVisibility=!0);if(parseInt(this.AccountsGrid.Table[s].EndNo.toString())<=parseInt(this.AccountsGrid.Table[s].StartNo.toString()))return this.DisplayMessage="EndNo Should be higher than start No. for BookNo. = '"+this.AccountsGrid.Table[s].BookNo.toString()+"'",void(this.MessageVisibility=!0);if(!o.e.IsEmpty(this.AccountsGrid.Table[s].CurrentNo)&&!o.e.IsEmpty(this.AccountsGrid.Table[s].StartNo)&&!o.e.IsEmpty(this.AccountsGrid.Table[s].EndNo)&&(parseInt(this.AccountsGrid.Table[s].CurrentNo.toString())>parseInt(this.AccountsGrid.Table[s].EndNo.toString())||parseInt(this.AccountsGrid.Table[s].CurrentNo.toString())<parseInt(this.AccountsGrid.Table[s].StartNo.toString())))return this.DisplayMessage="CurrentNo. for BookNo. = '"+o.e.String(this.AccountsGrid.Table[s].BookNo)+"' instanceof out of Range",void(this.MessageVisibility=!0);if(""==o.e.String(this.AccountsGrid.Table[s].Status)||"0"==o.e.String(this.AccountsGrid.Table[s].Status))return this.DisplayMessage="Select Status for BookNo. = '"+o.e.String(this.AccountsGrid.Table[s].BookNo)+"'",void(this.MessageVisibility=!0);e+="<Rows ",e+='BookNo="'+o.e.String(this.AccountsGrid.Table[s].BookNo)+'" ',e+='StartNo="'+o.e.String(this.AccountsGrid.Table[s].StartNo)+'" ',e+='EndNo="'+o.e.String(this.AccountsGrid.Table[s].EndNo)+'" ',""!=o.e.String(this.AccountsGrid.Table[s].CurrentNo)?e+='CurrentNo="'+this.AccountsGrid.Table[s].CurrentNo.toString()+'" ':e+='CurrentNo="'+o.e.String(this.AccountsGrid.Table[s].StartNo)+'" ',e+='Status="'+parseInt(o.e.String(this.AccountsGrid.Table[s].Status))+'" ',e+=" />"}e+="</XML>";let t=0;u.a.SetChequeBookDetails(parseInt(this.AccountList.SelectedValue),e,0).subscribe(e=>{if(this.DisplayMessage=e.Message,t=e.RetValue,t>0){this.MessageVisibility=!0,this.AccountsGrid.Clear();for(let e=0;e<20;e++){let t=this.AccountsGrid.NewRow();t.Sno=e+1,this.AccountsGrid.addRow(t)}}},e=>{console.log(e),this.DisplayMessage="Error in Save"})}else if("Cancel"==e)this.ChequeNo.Text="",this.CancelledDisplayMessage="",this.CancelledMessageVisibility=!1,null==this.AccountsGrid.SelectedItem||null==this.AccountsGrid.SelectedItem||o.e.IsEmpty(this.AccountsGrid.SelectedItem[Object.keys(this.AccountsGrid.SelectedItem)[1]])?(this.DisplayMessage="Select Cheque to Cancel",this.MessageVisibility=!0):(this.ChequeCancelVisibility=!0,this.ChequeNo.Text=this.AccountsGrid.SelectedItem.CurrentNo.toString(),i.a.page.ShowDialog(this,S,{Title:"Cancel Cheque"}));else if("ChequeCancel"==e)this.ChequeNo.Text="",this.ChequeCancelVisibility=!1,i.a.page.HideDialog();else if("Submit"==e){if(0==o.e.Int(this.ChequeNo.Text))return this.CancelledDisplayMessage="Invalid Cheque No.",this.DisplayMessage="Invalid Cheque No.",this.MessageVisibility=!0,void(this.CancelledMessageVisibility=!0);if(parseInt(this.AccountsGrid.SelectedItem.EndNo.toString())<parseInt(this.ChequeNo.Text)||parseInt(this.AccountsGrid.SelectedItem.StartNo.toString())>parseInt(this.ChequeNo.Text))return this.CancelledDisplayMessage="Select Cheque Between StartNo and EndNo",this.DisplayMessage="Select Cheque Between StartNo and EndNo",this.MessageVisibility=!0,void(this.CancelledMessageVisibility=!0);if(parseInt(o.e.String(this.AccountsGrid.SelectedItem.CurrentNo))>=parseInt(o.e.String(this.AccountsGrid.SelectedItem.EndNo)))this.CancelledDisplayMessage="Cheque No. out of Range",this.DisplayMessage="Cheque No. out of Range",this.MessageVisibility=!0,this.CancelledMessageVisibility=!0;else{let e="";e+="<XML>",e+="<Rows ",e+='BookNo="'+o.e.String(this.AccountsGrid.SelectedItem.BookNo)+'" ',e+='StartNo="'+o.e.String(this.AccountsGrid.SelectedItem.StartNo)+'" ',e+='EndNo="'+o.e.String(this.AccountsGrid.SelectedItem.EndNo)+'" ',e+='CurrentNo="'+this.ChequeNo.Text+'" ',e+=" />",e+="</XML>";let t=0;u.a.SetChequeBookDetails(parseInt(this.AccountList.SelectedValue),e,1).subscribe(e=>{t=e.RetValue,t>0?(this.CancelledDisplayMessage="Cheque No '"+this.ChequeNo.Text+"' has been Cancelled",this.DisplayMessage="Cheque No '"+this.ChequeNo.Text+"' as been Cancelled",this.MessageVisibility=!0,this.CancelledMessageVisibility=!0,this.AccountsGrid.SelectedItem.CancelledCheques=o.e.String(this.AccountsGrid.SelectedItem.CancelledCheques)+","+this.ChequeNo.Text,this.AccountsGrid.SelectedItem.CurrentNo=o.e.String(this.AccountsGrid.SelectedItem.CurrentNo).Replace(parseInt(this.AccountsGrid.SelectedItem.CurrentNo.toString()).toString(),"")+t,this.AccountsGrid.updateRow(this.AccountsGrid._SelectedItem)):(this.CancelledDisplayMessage=e.Message,this.DisplayMessage=e.Message,this.MessageVisibility=!0)},e=>{console.log(e),this.DisplayMessage="Error in Delete",this.MessageVisibility=!0})}}}OnSelectionChanged(e){this.AccountsGrid.Clear();let t=this.obj.GetChequeBookDetail(parseInt(this.AccountList.SelectedValue));if(null!=t&&t.Tables.length>0&&t.Tables[0].length>0)for(let s=0;s<t.Tables[0].length;s++){let e=this.AccountsGrid.NewRow();o.e.IsEmpty(t.Tables[0][s].BookNo)||(e.BookNo=t.Tables[0][s].BookNo.toString()),o.e.IsEmpty(t.Tables[0][s].StartNo)||(e.StartNo=t.Tables[0][s].StartNo.toString()),o.e.IsEmpty(t.Tables[0][s].EndNo)||(e.EndNo=t.Tables[0][s].EndNo.toString()),o.e.IsEmpty(t.Tables[0][s].CurrentNo)||(e.CurrentNo=t.Tables[0][s].CurrentNo.toString()),o.e.IsEmpty(t.Tables[0][s].CancelledCheques)||(e.CancelledCheques=t.Tables[0][s].CancelledCheques.toString()),"0"!=o.e.String(t.Tables[0][s].Status)&&(e.Status=t.Tables[0][s].Status.toString()),e.Sno=this.AccountsGrid.Table.length+1,this.AccountsGrid.addRow(e)}for(let s=0;s<20;s++){let e=this.AccountsGrid.NewRow();e.Sno=this.AccountsGrid.Table.length+1,this.AccountsGrid.addRow(e)}}}}}]);