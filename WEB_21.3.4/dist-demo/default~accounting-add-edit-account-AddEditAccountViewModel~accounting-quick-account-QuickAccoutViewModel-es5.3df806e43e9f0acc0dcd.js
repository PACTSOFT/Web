function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var s,i=_getPrototypeOf(e);if(t){var a=_getPrototypeOf(this).constructor;s=Reflect.construct(i,arguments,a)}else s=i.apply(this,arguments);return _possibleConstructorReturn(this,s)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,s){return t&&_defineProperties(e.prototype,t),s&&_defineProperties(e,s),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{mQEZ:function(e,t,s){"use strict";s.r(t),s.d(t,"AddEditAccountViewModel",(function(){return v}));var i=s("mrSG"),a=s("ScVY"),o=s("EQd/"),n=s("0/4Q"),c=s("VxiT"),l=s("n56n"),r=s("NkMH"),h=s("bgvB"),u=s("MCLT"),b=s("4ADR"),d=s("INyF"),C=s("BCIC"),p=s("ZKrh"),m=s("Lp6j"),D=s("eQJW"),S=s("Do2H"),A=s("THE7"),g=s("vVAv"),I=s("RJs6"),y=s("OvA8"),T=function(){function e(t,s,i){_classCallCheck(this,e),this.FinalReportsFields=[],this.oCombo=null}return _createClass(e,[{key:"FinalReportsViewModel_1",value:function(){}},{key:"FinalReportsViewModel",value:function(e){this.oCombo=new n.e(0),this.oCombo.Label=S.a.GetResource("FR_TB"),this.oCombo.DBColumnName="-1",this.oCombo.Row=0,this.oCombo.Column=0,this.oCombo.Width="250",this.oCombo.ColumnSpan=2,this.FillCombo(this.oCombo),this.FinalReportsFields.push(this.oCombo),this.oCombo=new n.e(0),this.oCombo.Label=S.a.GetResource("FR_BS"),this.oCombo.DBColumnName="-2",this.oCombo.ColumnSpan=2,this.oCombo.Row=0,this.oCombo.Column=2,this.FillCombo(this.oCombo),this.FinalReportsFields.push(this.oCombo),this.oCombo=new n.e(0),this.oCombo.Label=S.a.GetResource("FR_PL"),this.oCombo.DBColumnName="-3",this.oCombo.ColumnSpan=2,this.oCombo.Row=1,this.oCombo.Column=0,this.FillCombo(this.oCombo),this.FinalReportsFields.push(this.oCombo),this.oCombo=new n.e(0),this.oCombo.Label=S.a.GetResource("FR_PLT"),this.oCombo.DBColumnName="-4",this.oCombo.ColumnSpan=2,this.oCombo.Row=1,this.oCombo.Column=2,this.FillCombo(this.oCombo),this.FinalReportsFields.push(this.oCombo)}},{key:"FillCombo",value:function(e){e.Items.push(n.d.ComboBoxItems_2("Detailed","0")),e.Items.push(n.d.ComboBoxItems_2("Summary","1")),"-1"==e.DBColumnName&&e.Items.push(n.d.ComboBoxItems_2("Summary(Net Balance)","2")),e.SelectedValue=e.Items[0].Value}},{key:"LoadData",value:function(e){null!=e[0].TB_INT.toString()&&""!=e[0].TB_INT.toString()&&(this.oCombo=this.FinalReportsFields[0],this.oCombo.SelectedValue=parseInt(e[0].TB_INT).toString()),null!=e[0].BS.toString()&&""!=e[0].BS.toString()&&(this.oCombo=this.FinalReportsFields[1],this.oCombo.SelectedValue=Object(D.j)(e[0].BS.toString())?"1":"0"),null!=e[0].PL.toString()&&""!=e[0].PL.toString()&&(this.oCombo=this.FinalReportsFields[2],this.oCombo.SelectedValue=Object(D.j)(e[0].PL.toString())?"1":"0"),null!=e[0].PLT.toString()&&""!=e[0].PLT.toString()&&(this.oCombo=this.FinalReportsFields[3],this.oCombo.SelectedValue=Object(D.j)(e[0].PLT.toString())?"1":"0")}}]),e}(),V=s("knKa"),f=s("4HhE"),j=s("wJuo"),P=s("x68t"),M=s("NXvD"),R=s("ddhY"),w=s("iqoD"),x=s("++IR"),L=s("4k0m"),F=s("V7Sd"),O=s("xnJf"),v=function(e){_inherits(a,e);var t=_createSuper(a);function a(e,s,i,r,b,d){var C;if(_classCallCheck(this,a),(C=t.call(this)).CostCenterID=2,C.RetValue=0,C.ParentFeatureID=0,C.PNodeID=0,C.NextPrevID=0,C.DialogResult=!1,C.CCMapVisibility=!1,C.PrintVisible=!1,C.ViewCCMapping=null,C.LocDivWiseCreditDebit=null,C.rptccid=0,C.RptTemplate=null,C.CCMap=null,C.FileID=0,C.IsPhotoDelete=!1,C.IsPhotoChanged=!1,C.IsAttachmentMandatory=!1,C.DetailsVisibility=!1,C.IsImageSaved=!1,C.ActualFileName="",C.AccountPhoto=null,C.PhotoTextVisibility=!1,C.ContactVisibility=!1,C.FinalReportsVisibility=!1,C.PrimaryVisibility=!1,C.PbtnVisible=!1,C.ContactExpanded=!1,C.AttachmentExpanded=!1,C.NoteExpanded=!1,C.ChequeDiscount=!1,C.NoteVisibility=!1,C.NextPreviousVisibility=!0,C.AttachmentVisibility=!1,C.AddressVisibility=!1,C.Parent=null,C.obj={},C.ScreenObject=new c.a,C.ParentId=0,C.AccountImage=new h.b,C.AccountName=o.d.PactTextBoxData_1(239),C.AccountCode=o.a.PactCodeData_1(238),C.AliasName=o.d.PactTextBoxData_1(240),C.AccountType=n.e.PactComboBoxData1(241),C.Status=n.e.PactComboBoxData1(242),C.Group=l.b.PactListBoxData_1(247),C.PurchaseAccount=new l.a(250),C.TrustReceiptAccount=l.b.PactListBoxData_1(53526),C.MarginAccount=l.b.PactListBoxData_1(53527),C.SalesAccount=new l.a(251),C.COGSAccount=new l.a(23845),C.ClosingStockAccount=new l.a(23846),C.PDCPayableAccount=l.b.PactListBoxData_1(26582),C.PDCReceivableAccount=l.b.PactListBoxData_1(26581),C.IsDrCr=n.e.PactComboBoxData4(-2,!1),C.BillWise=n.e.PactComboBoxData1(252),C.Currency=l.b.PactListBoxData_1(7082),C.drpDebitDays=n.e.PactComboBoxData1(555297),C.DistCost=new n.e(243),C.drpCreditDays=n.e.PactComboBoxData1(555296),C.PaymentTerms=n.e.PactComboBoxData1(50393),C.GLClubTranBy=n.e.PactComboBoxData1(890),C.LetterofCredit=o.d.PactTextBoxData_1(53357),C.TrustReceipt=o.d.PactTextBoxData_1(53358),C._AccountID=0,C.CreditLimit=o.d.PactTextBoxData_1(249),C.CreditDays=o.d.PactTextBoxData_1(248),C.DebitLimit=o.d.PactTextBoxData_1(7080),C.DebitDays=o.d.PactTextBoxData_1(7081),C.TabWidth=0,C.AddressTypes=null,C.Address1="",C.Address2="",C.Address3="",C.City="",C.TabSelectedIndex=0,C.State="",C.Country="",C.Pin="",C.Phone1="",C.Phone2="",C.Fax="",C.Email1="",C.Email2="",C.URL="",C.dtTypes=null,C.guid="",C.FileExtension="",C.ControlType=0,C.IsControlAccounts=!1,C.ButtonEnable=!0,C.oFinalTab=null,C.ds=null,C.ChequeFields=[],C.ClassName="AddEditAccountViewModel",C.ScreenObject.ExculdeStaticFieldIds=[555296,555297,-2],C.AccountImage.RowSpan=3,C.AccountImage.Row=0,C.AccountImage.Column=3,C.obj.IsGroup=b,!Object(u.isUndefined)(S.a.SessionManager.Preferences.IsControlAccounts)&&"TRUE"==S.a.SessionManager.Preferences.IsControlAccounts.toUpperCase()&&(C.IsControlAccounts=!0,0==d&&(d=1,0!=e))){var p=S.a.common.GetDataTable("ACC001",e.toString());if(p.length>0){var m=parseInt(p[0].AccountTypeID);7==m?d=2:6==m&&(d=3)}}return C.ControlType=d,C.AccountType.SelectionChangedCommand.Subscribe(_assertThisInitialized(C),"OnGroupSelectionChanged"),C.Group.SelectionChangedCommand.Subscribe(_assertThisInitialized(C),"OnGroupSelectionChanged"),C.Load(e,s,i,r),_possibleConstructorReturn(C)}return _createClass(a,[{key:"onTabSelectionChanged",value:function(e){}},{key:"OnComboChange",value:function(e){console.log(e)}},{key:"OnPListChange",value:function(e){console.log("OnPListChange event from Add edit Account"),console.log(e)}},{key:"LoadParentData",value:function(){var e=this;if(0==this.AccountID&&0!=this.ParentId&&!this.obj.IsGroup){var t=this.ScreenObject.Data.Tables[5].filter((function(e){return"Copygroupdatatonode"==e.Name}));if(0!=t.length&&""!=t[0].Value.toString()&&Object(D.j)(t[0].Value)){var s=S.a.accounting.GetCopyAccountDetails(this.ParentId);0!=s.Tables[0].length&&(this.ScreenObject.FillParentData(s.Tables[0][0],s.Tables[1][0],s.Tables[5][0],["AccountCode","AccountName","AccountGroup","IsGroup"]),(t=this.ScreenObject.Data.Tables[5].filter((function(e){return"CopyGroupTabs"==e.Name}))).length>0&&""!=t[0].Value.toString())&&function(){var i=t[0].Value.toString().split(";");if(null!=i&&i.length>0)for(var a=function(a){if((t=e.ScreenObject.Data.Tables[e.ScreenObject.Data.Tables.length-1].filter((function(e){return e.CCTabID==i[a]}))).length>0&&""!=t[0].CCTabName.toString())switch(t[0].CCTabName.toString()){case"Notes":s.Tables[3].length>0&&e.ViewNotes.LoadNotes(s.Tables[3]);break;case"Attachments":s.Tables[4].length>0&&e.ViewAttachments.LoadAttachments(s.Tables[4]);break;case"Assign":var o=Array.from(new Set(e.ScreenObject.Data.Tables[e.ScreenObject.Data.Tables.length-1].map((function(e){return e.QuickViewCCID}))));m.e.StringIsNullOrEmpty(o)&&(o=["0"]);var n=s.Tables[9].filter((function(e){return!o.includes(e.CostCenterId.toString())}));n.length>0&&e.ViewCCMapping.LoadData(n,s.Columns[9]),e.ViewCCMapping.TempData=[];break;case"Contacts":s.Tables[2].length>0&&(s.Tables[2].forEach((function(e){e.ContactID=0})),e.ViewContacts.LoadContacts(s.Tables[2],s.Columns[2]));break;case"Address":s.Tables[7].length>0&&(s.Tables[7].forEach((function(e){e.AddressID=0})),e.ViewAddress.LoadContacts(s.Tables[7]));break;case"Credit & Debit":null!=s&&s.Tables.length>11&&s.Tables[11].length>0&&(s.Tables[11].Columns.ID.Expression="0",e.LocDivWiseCreditDebit.LoadXML(s.Tables[11]));break;case"Final Reports":e.FinalReportsViewModel.LoadData(s.Tables[0]);break;case"Report Template":null!=s&&s.Tables.length>14&&null!=e.RptTemplate&&(e.RptTemplate.tempTable=s.Tables[14],s.Tables[15].Columns.TemplateNodeID.Expression="0",e.RptTemplate.LoadXML(s.Tables[15]));break;default:parseInt(t[0].QuickViewCCID.toString())}},o=0;o<i.length;o++)a(o)}()}}}},{key:"Load",value:function(e,t,s,i){if(this.ButtonSave=new r.a,this.ButtonCustomize=new r.a,this.ButtonQuery=new r.a,this.ButtonEIDRead=new r.a,this.AccountID=e,0==this.AccountID?S.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=S.a.SessionManager.IsActionAssigned(2,"Create"):this.ButtonSave.Enable=S.a.SessionManager.IsActionAssigned(2,"Create"):(this.ScreenObject.IsEdit=!0,S.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=S.a.SessionManager.IsActionAssigned(2,"Update"):this.ButtonSave.Enable=S.a.SessionManager.IsActionAssigned(2,"Update")),S.a.SessionManager.HideUnathorizedAccess?this.ButtonCustomize.Visible=S.a.SessionManager.IsActionAssigned(2,"Customize"):this.ButtonCustomize.Enable=S.a.SessionManager.IsActionAssigned(2,"Customize"),S.a.SessionManager.HideUnathorizedAccess?this.ButtonQuery.Visible=S.a.SessionManager.IsActionAssigned(2,"Query"):this.ButtonQuery.Enable=S.a.SessionManager.IsActionAssigned(2,"Query"),S.a.SessionManager.HideUnathorizedAccess?this.ButtonEIDRead.Visible=S.a.SessionManager.IsActionAssigned(2,"EIDRead"):this.ButtonEIDRead.Enable=S.a.SessionManager.IsActionAssigned(2,"EIDRead"),S.a.SessionManager.Preferences.ContainsKey("ACCEIDMapping")&&""!=S.a.SessionManager.Preferences.ACCEIDMapping.toString()||(this.ButtonEIDRead.Visible=!1),this.CostCenterID=2,0!=this.AccountID&&(this.PrintVisible=!0),this.obj.AccountID=this.AccountID,this.RefreshTitle(),this.ViewContacts=new A.a(this),this.ViewNotes=new I.a(this,S.a.SessionManager,S.a.admin),this.FinalReportsViewModel=new T(this,S.a.SessionManager,S.a.admin),this.FinalReportsViewModel.FinalReportsViewModel(!0),this.StatusAssignGrid=new M.a,this.Status.LblClick=new f.b,this.Status.LblClick.Subscribe(this,"OnSaveAccount","ShowStatusAssignGrid"),""!=S.a.SessionManager.Preferences["Report Template Dimension"]&&"0"!=S.a.SessionManager.Preferences["Report Template Dimension"].toString()&&(this.rptccid=parseInt(S.a.SessionManager.Preferences["Report Template Dimension"].toString())),this.rptccid>0&&(this.RptTemplate=new C.a(this,this.rptccid)),this.ViewAttachments=new y.ViewAttachmentViewModel(this,S.a.SessionManager,S.a.admin),this.ViewAddress=new d.a(this),this.Address=new w.a,this.Address.AddAddressViewModel_2(this),this.ViewCCMapping=new g.a(this),this.ViewCCMapping.ViewCCMappingViewModel_1(this,2,this.AccountID),this.DropFile=new f.b,this.DropFile.Subscribe(this,"OnDropPhoto"),this.IsPhotoChanged=!1,this.PhotoTextVisibility=!0,this.AccountPhoto="",this.ActualFileName="",this.OnLoad(i),null!=this.Group)if(this.IsControlAccounts)this.SetControlWhere(this.Group,this.ControlType);else if(this.dtTypes.length<14){var a="";this.dtTypes.forEach((function(e){a.length>0&&(a+=","),a+=e.AccountTypeID.toString()})),this.Group.CustomWhere="(A.AccountID=1 or A.AccountTypeID IN ("+a+"))"}m.e.StringIsNullOrEmpty(this.AccountType.SelectedValue)||2!=parseInt(this.AccountType.SelectedValue)&&3!=parseInt(this.AccountType.SelectedValue)?(this.TrustReceiptAccount.Visible=!1,this.MarginAccount.Visible=!1):(this.TrustReceiptAccount.Visible=!0,this.MarginAccount.Visible=!0),this.CreditDays.drp=this.drpCreditDays,this.DebitDays.drp=this.drpDebitDays,0==this.DistCost.Items.length&&(this.DistCost.Items.push(n.d.ComboBoxItems_2("NO","0")),this.DistCost.Items.push(n.d.ComboBoxItems_2("YES","1"))),0==this.drpCreditDays.Items.length&&0==this.drpDebitDays.Items.length&&(this.drpCreditDays.Items.push(n.d.ComboBoxItems_2("Due Date","0")),this.drpCreditDays.Items.push(n.d.ComboBoxItems_2("First Day of Month","1")),this.drpCreditDays.Items.push(n.d.ComboBoxItems_2("Last Day of Month","2")),this.drpCreditDays.Items.push(n.d.ComboBoxItems_2("BillingCycle","3")),this.drpCreditDays.Items.push(n.d.ComboBoxItems_2("Due date as First Day of Month","4")),this.drpCreditDays.Items.push(n.d.ComboBoxItems_2("Due date as Last Day of Month","5")),this.drpCreditDays.Items.push(n.d.ComboBoxItems_2("Doc date as First Day of Month","6")),this.drpCreditDays.Items.push(n.d.ComboBoxItems_2("Doc date as Last Day of Month","7")),this.drpDebitDays.Items.push(n.d.ComboBoxItems_2("Due Date","0")),this.drpDebitDays.Items.push(n.d.ComboBoxItems_2("First Day of Month","1")),this.drpDebitDays.Items.push(n.d.ComboBoxItems_2("Last Day of Month","2")),this.drpDebitDays.Items.push(n.d.ComboBoxItems_2("BillingCycle","3")),this.drpDebitDays.Items.push(n.d.ComboBoxItems_2("Due date as First Day of Month","4")),this.drpDebitDays.Items.push(n.d.ComboBoxItems_2("Due date as Last Day of Month","5")),this.drpDebitDays.Items.push(n.d.ComboBoxItems_2("Doc date as First Day of Month","6")),this.drpDebitDays.Items.push(n.d.ComboBoxItems_2("Doc date as Last Day of Month","7"))),0==this.obj.AccountID&&(this.drpCreditDays.SelectedValue="0",this.drpDebitDays.SelectedValue="0",this.DistCost.SelectedValue="0",s>0&&(this.ParentId=s,this.Group.SelectedValue=s),0!=t&&(this.obj.SelectedNodeID=t,this.Group.SelectedValue=t),this.AutoGenerateCode()),this.AccountName.LostFocusCommand.Subscribe(this,"OnNameLostFocus"),this.Group.SelectionChangedCommand.Subscribe(this,"OnGroupSelectionChanged"),this.onGetData=this.GetRecords,S.a.SessionManager.IsActionAssigned(2,"DefaultInActive")&&(this.Status.DefaultValue="34",0==this.AccountID&&(this.Status.SelectedValue="34")),this.ContactVisibility=!1,this.MessageVisibility=!1,this.DetailsVisibility=!1,this.AddressVisibility=!1,this.DisplayName=this.Title}},{key:"SetControlWhere",value:function(e,t){var s="";1==t?s="#COATEE#":2==t?s="#DEBTORTEE#":3==t&&(s="#CREDITORTEE#"),e.CustomWhere=m.e.StringIsNullOrEmpty(e.CustomWhere)?s:"("+e.CustomWhere+") and "+s}},{key:"GetRecords",value:function(e){this.ButtonSave.Enable||(this.ButtonSave.Enable=!0);var t=0,s=!1;this.ControlType=null==this.ControlType?0:this.ControlType,"NEXT"==e.toUpperCase()?s=!0:"PREVIOUS"==e.toUpperCase()&&(s=!1),null!=this.ViewCCMapping&&this.ViewCCMapping.Clear();var i=S.a.common.GetNextPreviousRecords(2,this.NextPrevID,s,this.ControlType,this.obj.IsGroup?1:0);null!=i&&i.Tables.length>0&&i.Tables[0].length>0&&((t=parseInt(i.Tables[0][0].AccountID))>0&&(this.NextPrevID=t,this.obj.AccountID=t,this.obj.IsGroup=Object(D.j)(i.Tables[0][0].IsGroup),this.RefreshTitle(),this.LoadEditData(),this.PNodeID=t,this.RefreshControls(),this.obj.IsGroup?0==this.ScreenObject.CustomTab.Pages.filter((function(e){return 982==e.DBColumnID})).length&&(0==this.oFinalTab.Fields.length&&this.oFinalTab.Fields.push(T),this.ScreenObject.CustomTab.Pages.push(this.oFinalTab)):this.ScreenObject.CustomTab.Pages.filter((function(e){return 982==e.DBColumnID})).length>0&&this.ScreenObject.CustomTab.Pages.Remove(this.oFinalTab)))}},{key:"RefreshControls",value:function(){this.NoteVisibility?this.ViewNotes.OnShowNewNote(null):this.AttachmentVisibility?this.ViewAttachments.OnShowNewAttachment(null):this.ContactVisibility?(this.Contact=null,this.ViewContacts.OnShowNewContact(null)):this.AddressVisibility?(this.Address=null,this.ViewAddress.OnShowNewAddress(null)):this.CCMapVisibility&&this.ViewCCMapping.OnShowCC(null)}},{key:"AutoGenerateCode",value:function(){0==this.AccountID&&(this.obj.SelectedNodeID=this.Group.SelectedValue>0?this.Group.SelectedValue:this.ParentId,this.ScreenObject.SetAutoCode(this.AccountCode,this.obj.IsGroup,this.obj.SelectedNodeID,this.ScreenObject.Data.Tables[8]))}},{key:"onSave",value:function(){Logger.InfoLog("AddProductViewModel::Entering onSavecc"),Logger.InfoLog("AddProductViewModel::Entering onSavecc")}},{key:"AssignRowColumns",value:function(){var e;e=this.ScreenObject.CustomFields.length;for(var t=0;t<e;t++)this.ScreenObject.CustomFields[t].Row=t/4,this.ScreenObject.CustomFields[t].Column=t%4}},{key:"OnLoad",value:function(e){var t=this;this.BillWise.Items.push(n.d.ComboBoxItems_2(S.a.GetResource("Com_Yes"),"1")),this.BillWise.Items.push(n.d.ComboBoxItems_2(S.a.GetResource("Com_No"),"0")),this.IsDrCr.Items.push(n.d.ComboBoxItems_2(S.a.GetResource("Com_Yes"),"1")),this.IsDrCr.Items.push(n.d.ComboBoxItems_2(S.a.GetResource("Com_No"),"0")),this.ScreenObject.LoadScreen_1(this,2,this.obj.IsGroup),this.ScreenObject.CustomTab.OnTabChange.Subscribe(this,"onTabSelectionChanged"),this.LocDivWiseCreditDebit=new p.a(this),this.ScreenObject.CustomTab.Pages.forEach((function(e){"Contacts"==e.Name&&(t.PrimaryContact=new V.a,t.PrimaryContact.QuickAddContactViewModel_2(t),t.PrimaryContact.IsPrimaryContact=!0,t.PrimaryContact.Visiblebtns=!1,t.PrimaryContact.Countryvisible=!0,t.PrimaryVisibility=!0)}));var s=this.ScreenObject.Data.Tables[5].filter((function(e){return"CapsLock"==e.Name}));if(s.length>0&&Object(D.j)(s[0].Value)&&(this.AccountName.IsAllCaps=!0),(s=this.ScreenObject.Data.Tables[5].filter((function(e){return"CapsToFirstLetter"==e.Name}))).length>0&&Object(D.j)(s[0].Value)&&(this.AccountName.IsFirstLetterCaps=!0),(s=this.ScreenObject.Data.Tables[5].filter((function(e){return"AttachmentMandatory"==e.Name}))).length>0&&Object(D.j)(s[0].Value)&&(this.IsAttachmentMandatory=!0),(s=this.ScreenObject.Data.Tables[5].filter((function(e){return"AttachementThumbnail"==e.Name}))).length>0&&Object(D.j)(s[0].Value)&&(this.ViewAttachments.GridView=!0),(2==this.ControlType||3==this.ControlType)&&"TRUE"==S.a.SessionManager.Preferences.IsControlAccounts.toUpperCase()){this.IsDrCr.Enable=!0,this.IsDrCr.Visible=!0,this.IsDrCr.Label="Show in Both Types";var i=this.ScreenObject.Data.Tables[0].filter((function(e){return null==e.SectionID&&1==e.IsVisible})).Compute("max","RowNo");if(null!=i){var a=this.ScreenObject.Data.Tables[0].filter((function(e){return null==e.SectionID&&1==e.IsVisible&&e.RowNo==i})).Compute("max","ColumnNo");null!=a&&(parseInt(a)>=3?(i=parseInt(i)+1,a="0"):a=parseInt(a)+1),this.IsDrCr.Column=a.toString(),this.IsDrCr.Row=i.toString()}}this.obj.IsBillwise=Object(D.j)(S.a.SessionManager.Preferences.On.toString()),this.BillWise.SelectedValue=this.obj.IsBillwise?"1":"0",this.AssignRowColumns(),null!=this.ScreenObject.Data&&this.ScreenObject.Data.Tables.length>8&&this.ScreenObject.Data.Tables[8].length>0&&this.ScreenObject.Data.Columns[8].Contains("IsParentCodeInherited")&&this.ScreenObject.InitAutoCode(this.ScreenObject.Data.Tables[8],this.obj.IsGroup),S.a.SessionManager.Preferences["Intermediate PDC"]&&Object(D.j)(S.a.SessionManager.Preferences["Intermediate PDC"])?(this.PDCReceivableAccount.Visible=!0,this.PDCPayableAccount.Visible=!0):(this.PDCReceivableAccount.Visible=!1,this.PDCPayableAccount.Visible=!1),0==this.AccountID?(this.ScreenObject.SetView(this.PDCPayableAccount,!1),this.ScreenObject.SetView(this.PDCReceivableAccount,!1)):(this.ScreenObject.SetView(this.PDCPayableAccount,!0),this.ScreenObject.SetView(this.PDCReceivableAccount,!0)),this.ChequeDiscount=!1;var c=null,r=null;(r=l.b.PactListBoxData_1(0)).Label=S.a.GetResource("CD_PDCAC"),r.DBColumnName="-1",r.ColumnSpan=2,r.Row=0,r.Column=0,r.CCID=2,r.TypeID=2,r.ColumnSpan=2,r.DataType="",this.ChequeFields.push(r),(c=new o.d).Label=S.a.GetResource("CD_IR"),c.DBColumnName="-1",c.ColumnSpan=2,c.Row=0,c.Column=2,c.Text="0",c.DataType="FLOAT",this.ChequeFields.push(c),(c=new o.d).Label=S.a.GetResource("CD_CR"),c.DBColumnName="-1",c.Row=1,c.Column=0,c.Text="0",c.ColumnSpan=2,c.DataType="FLOAT",this.ChequeFields.push(c),(c=new o.d).Label=S.a.GetResource("CD_CDL"),c.DBColumnName="-1",c.Row=1,c.Column=2,c.Text="0",c.ColumnSpan=2,c.DataType="FLOAT",this.ChequeFields.push(c),this.ScreenObject.CustomTab.Pages.forEach((function(e){if("General"==e.Name)for(var s=0;s<e.Fields.length;s++){var i=e.Fields[s];switch(i.DBColumnName){case"GLClubTranBy":t.ScreenObject.StaticFields.includes(t.GLClubTranBy)&&t.ScreenObject.StaticFields.Remove(t.GLClubTranBy),t.GLClubTranBy=i}}else"DistributeCost"==e.Name&&e.Fields.forEach((function(e){e instanceof n.e&&"DistCost"==e.DBColumnName&&(t.DistCost=e)}))})),this.GLClubTranBy.Items.push(n.d.ComboBoxItems_2("Normal","0")),this.GLClubTranBy.Items.push(n.d.ComboBoxItems_2("Daily","1")),this.GLClubTranBy.Items.push(n.d.ComboBoxItems_2("Monthly","2"));for(var h=function(e){var s=t.ScreenObject.CustomTab.Pages[e];switch(s.Name){case"Address":s.Fields.push(t.ViewAddress);break;case"Contacts":s.Fields.push(t.ViewContacts);break;case"Notes":s.Fields.push(t.ViewNotes);break;case"Credit & Debit":s.Fields.push(t.LocDivWiseCreditDebit),s.Visible=!!(S.a.SessionManager.Preferences.ContainsKey("LW CreditDebit")&&""!=S.a.SessionManager.Preferences["LW CreditDebit"]&&Object(D.j)(S.a.SessionManager.Preferences["LW CreditDebit"])||S.a.SessionManager.Preferences.ContainsKey("DW CreditDebit")&&""!=S.a.SessionManager.Preferences["DW CreditDebit"]&&Object(D.j)(S.a.SessionManager.Preferences["DW CreditDebit"])||S.a.SessionManager.Preferences.ContainsKey("DimWiseCreditDebit")&&""!=S.a.SessionManager.Preferences.DimWiseCreditDebit&&parseInt(S.a.SessionManager.Preferences.DimWiseCreditDebit)>0);break;case"Attachments":s.Fields.push(t.ViewAttachments);break;case"Cheque Discount":t.ScreenObject.CustomTab.Pages.Remove(s);break;case"Final Reports":t.obj.IsGroup?t.FinalReportsViewModel.FinalReportsFields.forEach((function(e){s.Fields.push(e)})):t.ScreenObject.CustomTab.Pages.Remove(s);break;case"Assign":s.Fields.push(t.ViewCCMapping);break;case"Report Template":t.rptccid>0&&null!=t.RptTemplate?s.Fields.push(t.RptTemplate):t.ScreenObject.CustomTab.Pages.Remove(s)}},u=this.ScreenObject.CustomTab.Pages.length-1;u>=0;u--)h(u);this.dtTypes=this.ScreenObject.Data.Tables[4],this.ControlType>0&&(2==this.ControlType?e="7":3==this.ControlType&&(e="6")),this.ScreenObject.Data.Tables[3].forEach((function(e){t.Status.Items.push(n.d.ComboBoxItems_2(e.Status.toString(),e.StatusID.toString()))})),this.ScreenObject.Data.Tables[7].length>0&&(this.PaymentTerms.Items.push(n.d.ComboBoxItems_2("","")),this.ScreenObject.Data.Tables[7].forEach((function(e){t.PaymentTerms.Items.push(n.d.ComboBoxItems_2(e.ProfileName.toString(),e.ProfileID.toString()))}))),this.AddressTypes=[],this.AddressTypes.push(n.d.ComboBoxItems_2(S.a.GetResource("Address_Permanent"),"1")),this.AddressTypes.push(n.d.ComboBoxItems_2(S.a.GetResource("Address_Temporary"),"2")),this.SelectedAddressType="1",1==this.ParentId||""==e?this.FillAccountTypes(this.AccountType,""==e?13:parseInt(e),1):this.FillAccountTypes(this.AccountType,parseInt(e),-1),this.ControlType>1&&(this.AccountType.Enable=!1),0!=this.obj.AccountID?this.LoadEditData():(this.obj.GUID="",this.NextPreviousVisibility=!1),console.log(this.ScreenObject.CustomTab)}},{key:"LoadChequeDiscountTab",value:function(){for(var e=this.ScreenObject.CustomTab.Pages.length-1;e>=0;e--){var t=this.ScreenObject.CustomTab.Pages[e];if(300==t.DBColumnID){this.ScreenObject.CustomTab.Pages.Remove(t);break}}if("3"==this.AccountType.SelectedValue||"2"==this.AccountType.SelectedValue){var s=new b.b;s.Name="Cheque Discount",s.Header=S.a.GetResource("Tab_ChequeDiscount"),s.DBColumnID=300,this.ScreenObject.CustomTab.Pages.push(s);for(var i=0;i<this.ChequeFields.length;i++)s.Fields.push(this.ChequeFields[i]);this.ChequeDiscount=!0,this.ClearChequeFields()}}},{key:"ClearChequeFields",value:function(){for(var e=0;e<this.ChequeFields.length;e++)this.ChequeFields[e]instanceof o.d&&(this.ChequeFields[e].Text="0"),this.ChequeFields[e]instanceof l.b&&(this.ChequeFields[e].SelectedValue=0)}},{key:"worker_RunWorkerCompleted",value:function(e,t){this.DisplayName=this.Title}},{key:"LoadEditData",value:function(){if(this.ds=S.a.accounting.GetAccountDetails(this.obj.AccountID),Object.assign(this.obj,this.ds.obj),null!=this.LocDivWiseCreditDebit&&this.LocDivWiseCreditDebit.Clear(),this.AccountID=this.obj.AccountID,this.NextPrevID=this.AccountID,this.AccountPhoto="",this.ActualFileName="",this.AccountCode.Text=this.ds.Tables[0][0].AccountCode,(this.ScreenObject.InheritParentCode||this.ScreenObject.IsAutoCode)&&(this.AccountCode.Enable=parseInt(this.ds.Tables[0][0].Depth)<=1&&!this.ScreenObject.IsRootAutoCode),this.AccountName.Text=this.ds.Tables[0][0].AccountName,this.AliasName.Text=this.obj.AliasName,this.Status.SelectedValue=this.obj.StatusID.toString(),this.Group.SelectedValue=this.obj.ParentID,this.Group.DefaultValue=this.Group.SelectedValue.toString(),this.AccountType.SelectedValue=this.obj.AccountTypeID.toString(),this.PurchaseAccount.SelectedValue=this.obj.PurchaseAccount,this.TrustReceiptAccount.SelectedValue=this.obj.TrustReceiptAccount,this.MarginAccount.SelectedValue=this.obj.MarginAccount,this.CreditDays.Text=this.obj.CreditDays.toString(),this.CreditLimit.Text=this.obj.CreditLimit.toString(),this.DebitDays.Text=this.obj.DebitDays.toString(),this.DebitLimit.Text=this.obj.Debitlimit.toString(),this.Currency.SelectedValue=this.obj.Currency,this.SalesAccount.SelectedValue=this.obj.SalesAccount,this.COGSAccount.SelectedValue=this.obj.COGSAccount,this.ClosingStockAccount.SelectedValue=this.obj.ClosingStkAccount,this.PDCPayableAccount.SelectedValue=this.obj.PDCPayableAccount,this.PDCReceivableAccount.SelectedValue=this.obj.PDCReceivableAccount,this.BillWise.SelectedValue=this.obj.IsBillwise?"1":"0",this.IsDrCr.SelectedValue=this.obj.IsDrCr?"1":"0",this.PaymentTerms.SelectedValue=this.obj.PaymentTerms.toString(),this.LetterofCredit.Text=this.obj.LetterofCredit.toString(),this.TrustReceipt.Text=this.obj.TrustReceipt.toString(),this.Group.Enable=!1,this.drpCreditDays.SelectedValue=this.obj.CreditDaysOpt.toString(),this.drpDebitDays.SelectedValue=this.obj.DebitDaysOpt.toString(),this.DistCost.SelectedValue=this.obj.DistCost.toString(),this.GLClubTranBy.SelectedValue=this.obj.GLClubTranBy.toString(),this.FinalReportsViewModel.LoadData(this.ds.Tables[0]),this.LoadChequeDiscountTab(),"3"==this.AccountType.SelectedValue||"2"==this.AccountType.SelectedValue){this.ds.Columns[0].Contains("PDCDiscountAccount")&&null!=this.ds.Tables[0][0].PDCDiscountAccount.toString()&&""!=this.ds.Tables[0][0].PDCDiscountAccount.toString()&&(this.ChequeFields[0].SelectedValue=parseInt(this.ds.Tables[0][0].PDCDiscountAccount)),this.ds.Columns[0].Contains("InterestRate")&&null!=this.ds.Tables[0][0].InterestRate.toString()&&""!=this.ds.Tables[0][0].InterestRate.toString()&&(this.ChequeFields[1].Text=this.ds.Tables[0][0].InterestRate.toString()),this.ds.Columns[0].Contains("CommissionRate")&&null!=this.ds.Tables[0][0].CommissionRate.toString()&&""!=this.ds.Tables[0][0].CommissionRate.toString()&&(this.ChequeFields[2].Text=this.ds.Tables[0][0].CommissionRate.toString()),this.ds.Columns[0].Contains("CheckDiscountLimit")&&null!=this.ds.Tables[0][0].CheckDiscountLimit.toString()&&""!=this.ds.Tables[0][0].CheckDiscountLimit.toString()&&(this.ChequeFields[3].Text=this.ds.Tables[0][0].CheckDiscountLimit.toString())}this.ScreenObject.LoadCustomFieldsData(this.ds.Tables[1]),null!=this.PrimaryContact&&this.PrimaryContact.LoadContacts(this.ds.Tables[8]),this.ScreenObject.LoadCustomFieldsCCData(this.ds.Tables[5],this.ds.Tables[17]),this.ViewContacts.LoadContacts(this.ds.Tables[2],this.ds.Columns[2]),this.ViewNotes.LoadNotes(this.ds.Tables[3]),this.ViewAttachments.LoadAttachments(this.ds.Tables[4]),this.ViewAddress.LoadContacts(this.ds.Tables[7]),this.ViewCCMapping.LoadData(this.ds.Tables[9],this.ds.Columns[9]),this.StatusAssignGrid.Load(this.ds.Tables[18]),null!=this.ds&&this.ds.Tables.length>11&&this.ds.Tables[11].length>0&&this.LocDivWiseCreditDebit.LoadXML(this.ds.Tables[11]),null!=this.ds&&this.ds.Tables.length>14&&this.RptTemplate&&(this.RptTemplate.tempTable=this.ds.Tables[14],this.RptTemplate.LoadXML(this.ds.Tables[15])),this.ScreenObject.CanApprove(this.ds.Tables[0][0],this.ds.Tables[13][0],this.ButtonSave);var e=this.ds.Tables[4].filter((function(e){return 1==e.IsProductImage&&1==e.IsDefaultImage}));S.a.SessionManager.IsOffline&&this.AccountID>0&&(this.ButtonSave.Visible=!1),this.ControlType>1&&((2==this.ControlType&&"7"!=this.AccountType.SelectedValue||3==this.ControlType&&"6"!=this.AccountType.SelectedValue)&&(this.ButtonSave.Visible=!1),null!=this.AccountType&&(this.AccountType.Enable=!1)),this.ScreenObject.SetViewByType(this.AccountType.SelectedValue,this.obj.IsGroup),e.length>0?(this.PhotoTextVisibility=!1,this.FileID=parseInt(e[0].FileID),this.AccountPhoto=m.e.GetPath(e[0].GUID.toString()+"."+e[0].FileExtension.toString()),this.ActualFileName=e[0].ActualFileName.toString()):(this.FileID=0,this.PhotoTextVisibility=!0),Logger.InfoLog("AddEditAccountScreenViewModel::Exiting LoadEditData")}},{key:"OnDropPhoto",value:function(e){var t=this,s=m.e.CheckImageSize(e[0].name,e[0].size);if(""==s){var i=e[0],a=e[0].name.split("."),o=e[0].name;a.length>1&&(a=a[a.length-1]);var n=new FormData;n.append("ImageUpload",i),n.append("FileUpload",i),n.append("UserName",S.a.SessionManager.UserID);var c=new FileReader;c.onload=function(e){var s=new Image;if("pdf"==a||"txt"==a||"doc"==a||"csv"==a||"docx"==a||"doc"==a||"xls"==a||"xlsx"==a)return t.DisplayMessage=S.a.GetResource("File_NoPhoto"),void(t.MessageVisibility=!0);s.src=e.target.result,s.onload=function(s){m.e.IsEmpty(e.target.result)||setTimeout((function(){S.a.common.UploadAttachments(n).subscribe((function(e){"AddEditAccountViewModel"==t.ClassName&&(t.AccountPhoto=m.e.GetPath(e),t.ActualFileName=o,t.FileExtension=a,t.IsPhotoChanged=!0,t.PhotoTextVisibility=!1,t.DisplayMessage="",t.MessageVisibility=!1)}),(function(e){console.log("Error : "+JSON.stringify(e))}))}),100)}},c.readAsDataURL(i)}else alert(s)}},{key:"OnSaveAccount",value:function(e){return Object(i.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i,a,c,r,h,u,b,d,C,p,A,g,I,y,T,V,f,M,w,O,v=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.DisplayMessage="","Read"!=e.toString()&&"ReadEID"!=e.toString()){t.next=12;break}return t.next=3,Promise.resolve().then(s.bind(null,"xnJf"));case 3:for(i=t.sent,a=i.AddAttachmentViewModel,"","","",m.e.IsEmpty("")||(this.AccountPhoto="",this.IsPhotoChanged=!0,this.PhotoTextVisibility=!1),c=0;c<this.ViewAttachments.AttachmentsList.length;c++)"EIDSignature.jpg"==this.ViewAttachments.AttachmentsList[c].ActualFileName&&(this.ViewAttachments.SelectedAttachment=this.ViewAttachments.AttachmentsList[c],this.ViewAttachments.OnCmnItem_Click("DELETE"));m.e.IsEmpty("")||((r=new a).AddAttachmentViewModel_2(this),r.AliasFileName="",r.RelativeFileName="",r.FileDescription="Signature",r.ActualFileName="EIDSignature.jpg",r.FilePath="",r.FileExtension="jpg",r.AttachmentID=0,r._Flg=!0,this.ViewAttachments.AttachmentsList.push(r)),m.e.IsEmpty("")||(this.DisplayMessage="",this.MessageVisibility=!0),t.next=105;break;case 12:if("Print"!=e.toString()){t.next=16;break}this.DisplayMessage="Please Wait Printing Data...",S.a.report.ExportPDF_Masters(2,this.AccountID.toString(),0,"PDF").subscribe((function(e){console.log(e),S.a.SessionManager.Download(e.FileName,"Print"),m.e.IsEmpty(e.Message)&&!m.e.IsEmpty(e.FileName)&&(v.DisplayMessage="Exported Successfully")}),(function(e){console.log(e)})),t.next=105;break;case 16:if("PrintPreview"!=e.toString()){t.next=20;break}this.DisplayMessage="Please Wait  Preview Data...",S.a.report.ExportPDF_Masters(2,this.AccountID.toString(),0,"PDF").subscribe((function(e){console.log(e),S.a.SessionManager.Download(e.FileName,"Preview"),m.e.IsEmpty(e.Message)&&!m.e.IsEmpty(e.FileName)&&(v.DisplayMessage="Exported Successfully")}),(function(e){console.log(e)})),t.next=105;break;case 20:if("Contact"!=e.toString()){t.next=24;break}t.next=105;break;case 24:if("Query"!=e.toString()){t.next=37;break}return t.next=27,Promise.all([s.e(2),s.e(1),s.e(3),s.e(5),s.e(4),s.e(6),s.e(7),s.e(10),s.e(9),s.e(8),s.e(12),s.e(11),s.e(13),s.e(19),s.e(15),s.e(21),s.e(20),s.e(16),s.e(14),s.e(18),s.e(17),s.e(22),s.e(23),s.e(24),s.e(25),s.e(28),s.e(30),s.e(29),s.e(32),s.e(31),s.e(27),s.e(26),s.e(35),s.e(37),s.e(38),s.e(36),s.e(33),s.e(34),s.e(39),s.e(40),s.e(41),s.e(212)]).then(s.bind(null,"ThYU"));case 27:return h=t.sent,u=h.ReportViewModel,t.next=31,Promise.all([s.e(32),s.e(37)]).then(s.bind(null,"YU11"));case 31:b=t.sent,d=b.ReportViewComponent,(C=new u).ReportViewModel_Query(this.CostCenterID,this.AccountID,this.ScreenName,0,null),S.a.page.addNewTab({component:d,params:{obj:C}}),t.next=105;break;case 37:if("ShowApprove"!=e.toString()){t.next=42;break}p=new L.a(2,this.AccountID,this.ScreenObject,this),S.a.page.ShowDialog(p,x.a,{ShowCenter:!0,Title:S.a.GetResource("ApproveReject")}),t.next=105;break;case 42:if("DeletePhoto"!=e.toString()){t.next=46;break}t.next=105;break;case 46:if("PopUp"!=e.toString()){t.next=50;break}t.next=105;break;case 50:if("UploadPhoto"!=e.toString()){t.next=55;break}(A=new j.a).PopupAttachmentsViewModel_1(2,this.AccountID,this),S.a.page.ShowDialog(A,P.a,{ShowCenter:!0,Title:"Add Images"}),t.next=105;break;case 55:if("ShowStatusAssignGrid"!=e.toString()){t.next=59;break}this.StatusAssignGrid.IsShown=!0,S.a.page.ShowDialog(this.StatusAssignGrid,R.a,{ShowCenter:!0,Title:S.a.GetResource("Assign")}),t.next=105;break;case 59:if(t.prev=59,g=this.ScreenObject.ValidateData(),m.e.IsEmpty(g)){t.next=63;break}return t.abrupt("return",void(this.DisplayMessage=g));case 63:if(!this.IsAttachmentMandatory||null==this.ViewAttachments){t.next=67;break}if(I=0,this.ViewAttachments.AttachmentsList.length>0&&this.ViewAttachments.AttachmentsList.forEach((function(e){e.IsProductImage||I++})),0!=I){t.next=67;break}return t.abrupt("return",(this.DisplayMessage="Attachment is mandatory",void(this.MessageVisibility=!0)));case 67:if(null==this.Group||!this.IsControlAccounts||0!=this.Group.SelectedValue&&1!=this.Group.SelectedValue||(2==this.ControlType?(this.ParentId=parseInt(S.a.SessionManager.Preferences.DebtorsControlGroup),this.Group.SelectedValue=this.ParentId):3==this.ControlType&&(this.ParentId=parseInt(S.a.SessionManager.Preferences.CreditorsControlGroup),this.Group.SelectedValue=this.ParentId)),0!=this.Group.SelectedValue&&(this.obj.SelectedNodeID=this.Group.SelectedValue),0!=this.obj.AccountID){t.next=73;break}if(y={StrCode:this.obj.AccountCode,CodePrefix:this.obj.CodePrefix,CodeNumber:this.obj.CodeNumber},this.DisplayMessage=this.ScreenObject.SetAutoCodeParams_3(this.AccountCode,this.obj.SelectedNodeID,this.ScreenObject.Data.Tables[8],y),this.obj.AccountCode=y.StrCode,this.obj.CodePrefix=y.CodePrefix,this.obj.CodeNumber=y.CodeNumber,!(this.DisplayMessage.length>0)){t.next=71;break}return t.abrupt("return");case 71:t.next=74;break;case 73:this.obj.AccountCode=this.AccountCode.Text;case 74:if(this.AccountName.Enable&&(this.obj.AccountName=this.AccountName.Text.trim()),this.AliasName.Enable&&(this.obj.AliasName=this.AliasName.Text?this.AliasName.Text:this.AccountName.Text),this.AccountType.Enable&&this.AccountType.SelectedValue&&(this.obj.AccountTypeID=parseInt(this.AccountType.SelectedValue)),this.Status.Enable&&this.Status.SelectedValue&&(this.obj.StatusID=parseInt(this.Status.SelectedValue)),this.CreditDays.Enable&&null!=this.CreditDays.Text&&""!=this.CreditDays.Text&&(this.obj.CreditDays=parseInt(this.CreditDays.Text)),this.CreditLimit.Enable&&null!=this.CreditLimit.Text&&""!=this.CreditLimit.Text&&(this.obj.CreditLimit=parseInt(this.CreditLimit.Text)),this.BillWise.Enable&&(this.obj.IsBillwise="1"==this.BillWise.SelectedValue),this.IsDrCr.Visible&&(this.obj.IsDrCr="1"==this.IsDrCr.SelectedValue),this.obj.PurchaseAccount=this.PurchaseAccount.SelectedValue,this.obj.TrustReceiptAccount=this.TrustReceiptAccount.SelectedValue,this.obj.MarginAccount=this.MarginAccount.SelectedValue,this.obj.SalesAccount=this.SalesAccount.SelectedValue,this.obj.COGSAccount=this.COGSAccount.SelectedValue,this.obj.PDCPayableAccount=this.PDCPayableAccount.SelectedValue,this.obj.PDCReceivableAccount=this.PDCReceivableAccount.SelectedValue,this.obj.PaymentTerms=null!=this.PaymentTerms.SelectedValue&&""!=this.PaymentTerms.SelectedValue?parseInt(this.PaymentTerms.SelectedValue):0,this.obj.LetterofCredit=this.LetterofCredit.Enable&&null!=this.LetterofCredit.Text&&""!=this.LetterofCredit.Text?parseInt(this.LetterofCredit.Text):0,this.obj.TrustReceipt=this.TrustReceipt.Enable&&null!=this.TrustReceipt.Text&&""!=this.TrustReceipt.Text?parseInt(this.TrustReceipt.Text):0,this.obj.ClosingStkAccount=this.ClosingStockAccount.SelectedValue,""!=this.DistCost.SelectedValue&&(this.obj.DistCost=parseInt(this.DistCost.SelectedValue)),this.DebitDays.Enable&&null!=this.DebitDays.Text&&""!=this.DebitDays.Text&&(this.obj.DebitDays=parseInt(this.DebitDays.Text)),""!=this.drpDebitDays.SelectedValue&&(this.obj.DebitDaysOpt=parseInt(this.drpDebitDays.SelectedValue)),this.DebitLimit.Enable&&null!=this.DebitLimit.Text&&""!=this.DebitLimit.Text&&(this.obj.Debitlimit=parseInt(this.DebitLimit.Text)),""!=this.drpCreditDays.SelectedValue&&(this.obj.CreditDaysOpt=parseInt(this.drpCreditDays.SelectedValue)),this.Currency.Enable&&(this.obj.Currency=this.Currency.SelectedValue),""!=this.GLClubTranBy.SelectedValue&&(this.obj.GLClubTranBy=parseInt(this.GLClubTranBy.SelectedValue)),this.AccountName.Visible&&this.AccountName.Enable?this.AccountName.Enable&&""!=this.AccountName.Text&&null!=this.AccountName.Text&&(this.obj.AccountName=this.AccountName.Text.trim()):this.obj.AccountName=this.AccountCode.Text,this.AliasName.Visible&&this.AliasName.Enable?this.AliasName.Enable&&(this.obj.AliasName=this.AliasName.Text?this.AliasName.Text:this.AccountName.Text.trim()):this.obj.AliasName=this.AliasName.Text?this.AliasName.Text:this.AccountName.Text.trim(),m.e.StringIsNullOrEmpty(this.Group.DefaultValue)||this.Group.Visible||(this.obj.SelectedNodeID=parseInt(this.Group.DefaultValue)),0==this.AccountID&&(m.e.StringIsNullOrEmpty(this.AccountType.DefaultValue)||this.AccountType.Visible&&this.AccountType.Enable||(this.obj.AccountTypeID=parseInt(this.AccountType.DefaultValue))),0==this.AccountID&&(m.e.StringIsNullOrEmpty(this.Status.DefaultValue)||this.Status.Visible&&this.Status.Enable||(this.obj.StatusID=parseInt(this.Status.DefaultValue))),this.CreditDays.Visible&&this.CreditDays.Enable||(this.obj.CreditDays=0),this.CreditLimit.Visible&&this.CreditLimit.Enable||(this.obj.CreditLimit=0),this.BillWise.Visible&&this.BillWise.Enable||(this.obj.IsBillwise="1"==this.BillWise.SelectedValue),m.e.StringIsNullOrEmpty(this.PurchaseAccount.DefaultValue)||this.PurchaseAccount.Visible&&this.PurchaseAccount.Enable||(this.obj.PurchaseAccount=parseInt(this.PurchaseAccount.DefaultValue)),m.e.StringIsNullOrEmpty(this.TrustReceiptAccount.DefaultValue)||this.TrustReceiptAccount.Visible&&this.TrustReceiptAccount.Enable||(this.obj.TrustReceiptAccount=parseInt(this.TrustReceiptAccount.DefaultValue)),m.e.StringIsNullOrEmpty(this.MarginAccount.DefaultValue)||this.MarginAccount.Visible&&this.MarginAccount.Enable||(this.obj.MarginAccount=parseInt(this.MarginAccount.DefaultValue)),m.e.StringIsNullOrEmpty(this.SalesAccount.DefaultValue)||this.SalesAccount.Visible&&this.SalesAccount.Enable||(this.obj.SalesAccount=parseInt(this.SalesAccount.DefaultValue)),m.e.StringIsNullOrEmpty(this.COGSAccount.DefaultValue)||this.COGSAccount.Visible&&this.COGSAccount.Enable||(this.obj.COGSAccount=parseInt(this.COGSAccount.DefaultValue)),m.e.StringIsNullOrEmpty(this.ClosingStockAccount.DefaultValue)||this.ClosingStockAccount.Visible&&this.ClosingStockAccount.Enable||(this.obj.ClosingStkAccount=parseInt(this.ClosingStockAccount.DefaultValue)),m.e.StringIsNullOrEmpty(this.PDCReceivableAccount.DefaultValue)||this.PDCReceivableAccount.Visible&&this.PDCReceivableAccount.Enable||(this.obj.PDCReceivableAccount=parseInt(this.PDCReceivableAccount.DefaultValue)),m.e.StringIsNullOrEmpty(this.PDCPayableAccount.DefaultValue)||this.PDCPayableAccount.Visible&&this.PDCPayableAccount.Enable||(this.obj.PDCPayableAccount=parseInt(this.PDCPayableAccount.DefaultValue)),this.GLClubTranBy.Visible&&this.GLClubTranBy.Enable||(this.obj.GLClubTranBy=parseInt(this.GLClubTranBy.SelectedValue)),this.DebitDays.Visible&&this.DebitDays.Enable||(this.obj.DebitDays=0),this.DebitDays.Visible&&this.DebitDays.Enable||(this.obj.DebitDaysOpt=0),this.DebitLimit.Visible&&this.DebitLimit.Enable||(this.obj.Debitlimit=0),this.CreditDays.Visible&&this.CreditDays.Enable||(this.obj.CreditDaysOpt=0),this.Currency.Visible&&this.Currency.Enable||(this.obj.Currency=this.Currency.SelectedValue),this.obj.CustomFieldsQuery=this.ScreenObject.GetCustomFieldsQuery(),this.obj.CustomCostCenterFieldsQuery=this.ScreenObject.GetCustomCostCenterFieldsQuery(),this.obj.HistoryXML=this.ScreenObject.HistoryCCXML,this.obj.StatusXML=this.StatusAssignGrid.GetXML(),null!=this.PrimaryContact&&(this.obj.PrimaryContactQuery=this.PrimaryContact.GetXML()),this.obj.NotesXML=this.ViewNotes.GetXML(),this.obj.ContactsXML=this.ViewContacts.GetXML(),this.obj.AddressXML=this.ViewAddress.GetXML(),null==this.RptTemplate){t.next=79;break}if(this.obj.AccReportTemplateXML=this.RptTemplate.GridXML(),""!=this.obj.AccReportTemplateXML||""==this.DisplayMessage){t.next=77;break}return t.abrupt("return");case 77:t.next=80;break;case 79:this.obj.AccReportTemplateXML="";case 80:if("3"!=this.AccountType.SelectedValue&&"2"!=this.AccountType.SelectedValue||(T=null,V=null,null!=this.ChequeFields&&this.ChequeFields[0]instanceof l.b&&(V=this.ChequeFields[0],this.obj.PDCDiscountAccount=V.SelectedValue),null!=this.ChequeFields&&this.ChequeFields[1]instanceof o.d&&(T=this.ChequeFields[1],this.obj.InterestRate=parseInt(T.Text)),null!=this.ChequeFields&&this.ChequeFields[2]instanceof o.d&&(T=this.ChequeFields[2],this.obj.CommissionRate=parseInt(T.Text)),null!=this.ChequeFields&&this.ChequeFields[3]instanceof o.d&&(T=this.ChequeFields[3],this.obj.CheckDiscountlimit=parseInt(T.Text))),f={},this.DisplayMessage=this.ViewCCMapping.GetXML(f),this.obj.CCMapXML=f.strXML,m.e.StringIsNullOrEmpty(this.DisplayMessage)){t.next=84;break}return t.abrupt("return");case 84:if(M={Message:""},this.obj.IsGroup||this.ScreenObject.ValidateGSTRules(this.obj.AccountTypeID,M)){t.next=87;break}return t.abrupt("return",(this.DisplayMessage=M.Message,void(this.MessageVisibility=!0)));case 87:if(this.ScreenObject.ValidateDataonSave()){t.next=89;break}return t.abrupt("return");case 89:this.obj.CreditDebit=this.LocDivWiseCreditDebit.GridXML(),this.obj.IsGroup?(w=null,this.FinalReportsViewModel.FinalReportsFields[0]instanceof n.e&&(w=this.FinalReportsViewModel.FinalReportsFields[0],this.obj.TB=parseInt(w.SelectedValue)),this.FinalReportsViewModel.FinalReportsFields[1]instanceof n.e&&(w=this.FinalReportsViewModel.FinalReportsFields[1],this.obj.BS=parseInt(w.SelectedValue)),this.FinalReportsViewModel.FinalReportsFields[2]instanceof n.e&&(w=this.FinalReportsViewModel.FinalReportsFields[2],this.obj.PL=parseInt(w.SelectedValue)),this.FinalReportsViewModel.FinalReportsFields[3]instanceof n.e&&(w=this.FinalReportsViewModel.FinalReportsFields[3],this.obj.PLT=parseInt(w.SelectedValue))):(this.obj.TB=0,this.obj.PL=0,this.obj.BS=0,this.obj.PLT=0),t.prev=90,this.obj.AttachmetsXML=this.ViewAttachments.GetXML(),this.obj.AttachmetsXML+=this.ScreenObject.GetExtraAttachmentXML(),O="",this.IsPhotoChanged&&!m.e.StringIsNullOrEmpty(this.AccountPhoto)?(O+=0==this.FileID?'<Row Action="NEW"':'<Row Action="MODIFY"',S.a.SessionManager.IsWebApplication&&(O+=' AttachmentID="'+this.FileID+'"',O+=' FilePath="'+this.AccountPhoto+'"',O+=' ActualFileName="'+this.ActualFileName+'"',O+=' RelativeFileName="'+this.AccountPhoto+'"',O+=' FileExtension="'+this.AccountPhoto.substring(this.AccountPhoto.lastIndexOf("/")+1).split(".")[1]+'"',O+=' FileDescription=""',O+=' IsProductImage="1"',O+=' IsDefaultImage="1"',O+=' GUID="'+this.AccountPhoto.substring(this.AccountPhoto.lastIndexOf("/")+1).split(".")[0]+'"',O+="/>")):this.IsPhotoDelete&&this.FileID>0&&(O+='<Row Action="DELETE"',O+=' AttachmentID="'+this.FileID+'"/>'),O.length>0&&(O="<AttachmentsXML>"+O,O+="</AttachmentsXML>",this.obj.AttachmetsXML=this.obj.AttachmetsXML+O.toString()),t.next=99;break;case 96:return t.prev=96,t.t0=t.catch(90),t.abrupt("return",void(this.DisplayMessage=S.a.GetResource("Upload_Path_notExists")));case 99:this.obj.IsCode=!1,this.obj.WID=this.ScreenObject.CheckWorkFlow(),S.a.accounting.SaveAccount(this.obj,"SaveAccount").subscribe((function(e){if(v.DisplayMessage=e.Message,v.RetValue=e.RetValue,v.RetValue>0||v.RetValue<-1e4){S.a.page.tabs.forEach((function(e){e.instance instanceof F.TreeViewPageComponent&&e.instance.obj&&2==e.instance.CostCenterID&&(e.instance.obj.SetFocusNodeID=e.instance.obj.SelectedNode.Id,e.instance.Refresh())})),v.AccountPhoto="",v.ActualFileName="",v.PhotoTextVisibility=!0;var t=v.Group.SelectedValue;v.ScreenObject.Clear(),v.Group.SelectedValue=t,v.ParentId>0&&(v.Group.SelectedValue=v.ParentId,v.AccountType.SelectedValue=v.obj.AccountTypeID.toString()),null!=v.LocDivWiseCreditDebit&&v.LocDivWiseCreditDebit.Clear(),v.IsPhotoDelete=!1,v.ViewContacts.ContactsListObj.Clear(),v.ViewAddress.ContactsListObj.Clear(),v.ViewNotes.NotesListObj.Clear(),v.ViewAttachments.AttachmentsListObj.Clear(),v.ViewCCMapping.Clear(),v.ViewContacts.DeletedContacts.Clear(),v.ClearChequeFields(),v.ViewAddress.DeletedAddress.Clear(),v.ViewNotes.DeletedNotes.Clear(),v.ViewAttachments.AttachmentsListObj.Clear(),v.ViewAttachments.DeletedAttachments.Clear(),v.StatusAssignGrid.Clear(),v.AttachmentVisibility=!1,v.CCMapVisibility=!1,v.RptTemplate&&v.RptTemplate.Clear(),v.AccountID=0,v.obj.AccountID=0,v.PrintVisible=!1,v.AutoGenerateCode(),v.RefreshTitle(),v.AccountName.SetFocus=!0,v.BillWise.SelectedValue="1",0!=v.obj.AccountID&&(v.ButtonSave.Enable=!1,v.AccountCode.Text=""),"2"==v.AccountType.SelectedValue||"3"==v.AccountType.SelectedValue?(v.MarginAccount.Visible=!0,v.TrustReceiptAccount.Visible=!0):(v.MarginAccount.Visible=!1,v.TrustReceiptAccount.Visible=!1),null!=v.PrimaryContact&&v.PrimaryContact.ClearFields()}v.Parent&&v.Parent.Refresh();var s=v.ScreenObject.Data.Tables[5].filter((function(e){return"ShowCurrentSavedData"==e.Name}));s.length>0&&""!=m.e.String(s[0].Value)&&Object(D.j)(s[0].Value)&&(v.obj.AccountID=v.RetValue,v.RefreshTitle(),v.LoadEditData()),v.MessageVisibility=!0}),(function(e){console.log("Quick Account Save : "+JSON.stringify(e))})),t.next=105;break;case 102:t.prev=102,t.t1=t.catch(59),S.a.SessionManager.Logger.ErrorLog("AddEditAccountScreenViewModel:: OnSaveAccount"+t.t1.stack);case 105:case"end":return t.stop()}}),t,this,[[59,102],[90,96]])})))}},{key:"OnAddAttachment",value:function(){Logger.InfoLog("AddProductViewModel::Entering AddAttachment"),this.Attachment=new O.AddAttachmentViewModel,this.Attachment.AddAttachmentViewModel_2(this),Logger.InfoLog("AddProductViewModel::Entering AddAttachment")}},{key:"OnGroupSelectionChanged",value:function(e){e==this.Group||"Group"==e?this.Group.SelectedValue>0&&(this.Group.DefaultValue=this.Group.SelectedValue.toString(),this.FillAccountTypes(this.AccountType,S.a.accounting.GetAccountType(this.Group.SelectedValue),this.Group.SelectedValue),this.AutoGenerateCode(),this.LoadParentData()):e==this.AccountType&&(0==this.AccountID&&(this.BillWise.SelectedValue=null==this.AccountType.SelectedValue||""==this.AccountType.SelectedValue||6!=parseInt(this.AccountType.SelectedValue)&&7!=parseInt(this.AccountType.SelectedValue)?"0":"1"),"2"==this.AccountType.SelectedValue||"3"==this.AccountType.SelectedValue?(this.TrustReceiptAccount.Visible=!0,this.MarginAccount.Visible=!0):(this.TrustReceiptAccount.Visible=!1,this.MarginAccount.Visible=!1),this.LoadChequeDiscountTab(),this.ScreenObject.SetViewByType(this.AccountType.SelectedValue,this.obj.IsGroup))}},{key:"FillAccountTypes",value:function(e,t,s){var i=this,a=e.SelectedValue;if(e.Items=[],this.IsControlAccounts){var o=[];1==this.ControlType?o=this.dtTypes.filter((function(e){return 6==e.AccountTypeID||7==e.AccountTypeID})):2==this.ControlType?(t=7,e.DefaultValue="7",o=this.dtTypes.filter((function(e){return 7!=e.AccountTypeID}))):3==this.ControlType&&(t=6,e.DefaultValue="6",o=this.dtTypes.filter((function(e){return 6!=e.AccountTypeID}))),o.forEach((function(e){i.dtTypes.Remove(e)}))}this.dtTypes.forEach((function(i){var a=parseInt(i.AccountTypeID);1!=s&&(4!=t&&8!=t&&11!=t&&5!=t&&9!=t&&12!=t||4!=a&&8!=a&&11!=a&&5!=a&&9!=a&&12!=a)&&(1!=t&&2!=t&&7!=t&&10!=t&&13!=t&&15!=t&&3!=t&&6!=t&&14!=t&&16!=t||1!=a&&2!=a&&7!=a&&10!=a&&13!=a&&15!=t&&3!=a&&6!=a&&14!=a&&16!=t)||e.Items.push(n.d.ComboBoxItems_2(i.ResourceData,i.AccountTypeID))})),e.SelectedValue=0!=t?t.toString():a,this.ScreenObject.SetViewByType(this.AccountType.SelectedValue,this.obj.IsGroup)}},{key:"RefreshTitle",value:function(){this.obj.IsGroup?(this.Title=S.a.GetResource(0==this.obj.AccountID?"Account_AddGroup":"Account_EditGroup"),S.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=S.a.SessionManager.IsActionAssigned(2,"Create Group"):this.ButtonSave.Enable=S.a.SessionManager.IsActionAssigned(2,"Create Group")):0==this.obj.AccountID?(this.Title=S.a.GetResource("Account_AddAccount"),S.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=S.a.SessionManager.IsActionAssigned(2,"Create"):this.ButtonSave.Enable=S.a.SessionManager.IsActionAssigned(2,"Create")):(this.Title=S.a.GetResource("Account_EditAccount"),S.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=S.a.SessionManager.IsActionAssigned(2,"Update"):this.ButtonSave.Enable=S.a.SessionManager.IsActionAssigned(2,"Update"))}},{key:"OnNameLostFocus",value:function(e){var t;m.e.StringIsNullOrEmpty(this.AccountName.Text)||(t=this.AccountType.Visible&&this.AccountType.Enable?parseInt(this.AccountType.SelectedValue):0==this.AccountID?parseInt(this.AccountType.DefaultValue):this.obj.AccountTypeID,this.DisplayMessage=S.a.accounting.CheckDuplicateName(2,this.AccountID,this.AccountName.Text.TrimStart(""),t,this.obj.IsGroup));this.ScreenObject.onTextBoxLostFocus(e)}},{key:"CreateUser",value:function(){var e=0;S.a.SessionManager.LicenseSettings.ContainsKey("EFeature12")&&(e=S.a.SessionManager.LicenseSettings.EFeature12);var t=0;S.a.SessionManager.LicenseSettings.ContainsKey("EFeature13")&&(t=S.a.SessionManager.LicenseSettings.EFeature13);var s=[];s.push(parseInt(this.ViewContacts.ContactsListObj.SelectedItem.ContactID)),s.push(e),s.push(t),s.push(S.a.SessionManager.CompanyGUID),s.push("guid"),s.push(S.a.SessionManager.UserName),s.push(S.a.SessionManager.UserID),s.push(S.a.SessionManager.RoleID),s.push(S.a.SessionManager.LanguageID),s.push(S.a.SessionManager.CompanyIndex);var i=S.a.admin.CreateUserFromContact(s);return i.obj>0?(this.ViewContacts.ContactsListObj.SelectedItem.ContactID=i.obj,this.ViewContacts.OnRowChange(),this.DisplayMessage="User Saved Successfully",!0):(null!=i&&i.Tables.length>0&&i.Columns[i.Columns.length-1].Contains("ErrorMessage")&&(this.DisplayMessage=i.Tables[i.Tables.length-1][0].ErrorMessage.toString()),!1)}},{key:"AccountID",get:function(){return this._AccountID},set:function(e){this._AccountID=e,this.obj.AccountID=e}}]),a}(a.b)}}]);