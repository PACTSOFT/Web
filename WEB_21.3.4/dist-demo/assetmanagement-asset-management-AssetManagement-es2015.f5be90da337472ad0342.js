(window.webpackJsonp=window.webpackJsonp||[]).push([[99],{"7fVR":function(e,t,s){"use strict";s.d(t,"a",(function(){return D}));var i=s("Do2H"),a=s("Lp6j"),n=s("eQJW"),o=s("ScVY"),l=s("8B8H"),r=s("ockk"),h=s("CUWK"),c=s("NM0h"),u=s("MCLT");class D extends o.b{constructor(){super(),this.DeprMessage="",this.oparent=null,this.PostVisible=!1,this.DeleteVisible=!1,this.JVCCID=0,this.AssetID=0,this.CreditAcc=0,this.DebitAcc=0,this.IsDeprSummary=!1,this.iFailure=0,this.IsPostingOnScheduleDate=!1,this.AllowEditPostingDate=!1,this.SystemDate=Date.Today(),this.CV=null,this.oNotif=null,this.iLoop=0,this.iStart=0,this.strTo=null,this.strDrAcc=null,this.strCrAcc=null,this.strDeprIDs="",this.strDtColumn="",this.JVOK=!1,this.JVUNOK=!1,this.objAsset=new c.a,this.Title=i.a.GetResource("ASM_ScheduleDepreciation")}get oTable(){return this.Schedules.Table}DepreciationScheduleViewModel_1(e){"AssetManagement"==(null==e?void 0:e.ClassName)?(this.oparent=e,this.AssetID=this.oparent.AssetID,this.PostVisible=!0,this.DeleteVisible=!!i.a.SessionManager.IsActionAssigned(72,"Delete Depreciatin Schedule"),1!=this.oparent.IsFullDispose&&3!=this.oparent.IsFullDispose||(this.PostVisible=!1,this.DeleteVisible=!1)):"ChangeValue"==(null==e?void 0:e.ClassName)&&(this.CV=e,this.PostVisible=!1,this.DeleteVisible=!1),this.InitGrid()}DepreciationScheduleViewModel_2(e,t){this.oNotif=t;let s=e.Tables[1].filter(e=>"DepreciationJV"==e.Name);s.length>0&&parseInt(s[0].Value)>0&&(this.JVCCID=parseInt(s[0].Value)),s=e.Tables[1].filter(e=>"ClubDeprPosting"==e.Name),s.length>0&&"TRUE"==s[0].Value.toString().toUpperCase()&&(this.IsDeprSummary=!0),this.worker_DoWork()}worker_RunWorkerCompleted(){this.oNotif.Enable=!0,this.oNotif.DisplayMessage=this.DeprMessage,this.oNotif.DeprDataFilling()}worker_DoWork(){this.oNotif.Enable=!1;let e=this.oNotif.DepreciationGrid.Table;this.drrPost=e.length>0?e.filter(e=>e.select&&Object(u.isNullOrUndefined)(e.DocID)):[],0!=this.drrPost.length?(this.oNotif.DisplayMessage="Posting 0 of "+this.drrPost.length,this.iFailure=0,this.IsDeprSummary?(this.iStart=0,this.strDeprIDs="",this.strDtColumn=this.oNotif.AllowEditPostingDate?"PostDate_Key":"ToDate",this.drrPost=e.filter(e=>e.select&&Object(u.isNullOrUndefined)(e.DocID)),this.drrPost.SortBy([this.strDtColumn,"DebitAccount","CreditAccount"]),this.iLoop=0,this.PostDeprJV_CallBack()):(this.iLoop=0,this.PostDeprJVDetail_CallBack())):this.oNotif.DisplayMessage=i.a.GetResource("PleaseSelectDepreciation")}PostDeprJV_CallBack(){if(this.iLoop>=this.drrPost.length)this.strDeprIDs.length>0?(this.oNotif.DisplayMessage="Posting ("+(this.iStart+1)+"-"+this.drrPost.length+") of "+this.drrPost.length,this.PostDeprJV_Summary(this.strDeprIDs,this.strTo,this.strDrAcc,this.strCrAcc,this.iStart,this.drrPost.length).then(e=>{this.worker_RunWorkerCompleted()})):this.worker_RunWorkerCompleted();else{for(;this.iLoop<this.drrPost.length;this.iLoop++){if(this.strTo!=this.drrPost[this.iLoop][this.strDtColumn].toString()||this.strDrAcc!=this.drrPost[this.iLoop].DebitAccount.toString()||this.strCrAcc!=this.drrPost[this.iLoop].CreditAccount.toString()){if(this.strDeprIDs.length>0)return this.oNotif.DisplayMessage="Posting ("+(this.iStart+1)+"-"+this.iLoop+") of "+this.drrPost.length,this.PostDeprJV_Summary(this.strDeprIDs,this.strTo,this.strDrAcc,this.strCrAcc,this.iStart,this.iLoop).then(e=>{this.PostDeprJV_CallBack()}),this.strDeprIDs="",this.strTo=this.drrPost[this.iLoop][this.strDtColumn].toString(),this.strDrAcc=this.drrPost[this.iLoop].DebitAccount.toString(),this.strCrAcc=this.drrPost[this.iLoop].CreditAccount.toString(),void(this.iStart=this.iLoop);this.strDeprIDs="",this.strTo=this.drrPost[this.iLoop][this.strDtColumn].toString(),this.strDrAcc=this.drrPost[this.iLoop].DebitAccount.toString(),this.strCrAcc=this.drrPost[this.iLoop].CreditAccount.toString(),this.iStart=this.iLoop}this.strDeprIDs.length>0&&(this.strDeprIDs+=","),this.strDeprIDs+=this.drrPost[this.iLoop].ScheduleID.toString()}this.strDeprIDs.length>0&&this.PostDeprJV_CallBack()}}PostDeprJVDetail_CallBack(){if(this.iLoop>=this.drrPost.length)return void this.worker_RunWorkerCompleted();let e="";e="",e+="<JVXML>",e+="<ROWS>",e+='<DepreciationID DepID="'+this.drrPost[this.iLoop].ScheduleID.toString()+'" AssetID="'+this.drrPost[this.iLoop].AssetID.toString()+'"',a.e.IsEmpty(this.drrPost[this.iLoop].PostDate_Key)||(e+=' Dt="'+new Date(this.drrPost[this.iLoop].PostDate_Key).ToString("dd MMM yyyy")+'"'),e+="/>",e+="</ROWS>",e+="</JVXML>",this.oNotif.DisplayMessage="Posting "+(this.iLoop+1)+" of "+this.drrPost.length;let t=0;this.objAsset.PostAssetID=this.AssetID,this.objAsset.PostCCID=this.JVCCID,this.objAsset.JVXML=e.toString(),this.objAsset.Post=!0,this.objAsset.PostDeprJV().subscribe(e=>{this.DisplayMessage=e.Message,t=e.RetValue,t<=0&&this.iFailure++,this.DeprMessage=this.DisplayMessage,this.iLoop++,this.PostDeprJVDetail_CallBack()})}PostDeprJV_Summary(e,t,s,i,a,n){let o=new Date(t);return this.oNotif.AllowEditPostingDate||this.oNotif.IsPostingOnScheduleDate||(o=this.oNotif.SystemDate),this.objAsset.PostDeprJVSummary(this.JVCCID,o,s,i,e).then(e=>{this.DisplayMessage=e.Message,e.RetValue<=0&&(this.iFailure+=n-a),this.DeprMessage=this.DisplayMessage})}InitGrid(){this.Schedules=new l.a,this.Schedules.Width="",this.Schedules.Height=400,this.Schedules.TableColumns.push("ID"),this.Schedules.TableColumns.push("period"),this.Schedules.TableColumns.push("From"),this.Schedules.TableColumns.push("FromText"),this.Schedules.TableColumns.push("To"),this.Schedules.TableColumns.push("ToText"),this.Schedules.TableColumns.push("DepAmt"),this.Schedules.TableColumns.push("AccDep"),this.Schedules.TableColumns.push("AccDepWithPrev"),this.Schedules.TableColumns.push("NetValue"),this.Schedules.TableColumns.push("Status"),this.Schedules.TableColumns.push("DocID"),this.Schedules.TableColumns.push("DocNo"),this.Schedules.TableColumns.push("select"),this.Schedules.TableColumns.push("PostingDate"),this.Schedules.TableColumns.push("CostCenterID"),this.Schedules.TableColumns.push("PostingDate_Key"),this.Schedules.TableColumns.push("DocumentName"),this.Schedules.TableColumns.push("DocPrefix"),this.Schedules.TableColumns.push("DocNumber"),this.oColumns=new Array;let e=new r.a;e.Header="#",e.DisplayMember="period",e.ReadOnly=!0,e.Width=45,e.IsFrozen=!0,this.oColumns.push(e),e=new r.a,e.Header=i.a.GetResource("From"),e.DisplayMember="FromText",e.ReadOnly=!0,e.Width=90,e.IsFrozen=!0,this.oColumns.push(e),e=new r.a,e.Header=i.a.GetResource("To"),e.DisplayMember="ToText",e.ReadOnly=!0,e.Width=90,e.IsFrozen=!0,this.oColumns.push(e),e=new r.a,e.Header="Depr. Amount",e.DisplayMember="DepAmt",e.IsCalculated=1,e.Width=95,e.ReadOnly=!0,e.DataType="FLOAT",this.oColumns.push(e),e=new r.a,e.Header="Acc. Depr",e.DisplayMember="AccDepWithPrev",e.IsCalculated=1,e.Width=100,e.ReadOnly=!0,e.DataType="FLOAT",this.oColumns.push(e),e=new r.a,e.Header="Net Value",e.DisplayMember="NetValue",e.IsCalculated=1,e.Width=100,e.ReadOnly=!0,e.DataType="FLOAT",this.oColumns.push(e),e=new r.a,e.Header=i.a.GetResource("Status"),e.DisplayMember="Status",e.ReadOnly=!0,e.Width=80,this.oColumns.push(e),null!=this.CV&&(e=new r.a,e.Header="Actual Depr",e.DisplayMember="ActualDeprAmt",e.IsCalculated=1,e.Width=100,e.ReadOnly=!0,e.DataType="FLOAT",this.oColumns.push(e)),null!=this.oparent&&(e=new r.a,e.Header=i.a.GetResource("DocumentDesigner_VoucherNo"),e.DisplayMember="DocNo",e.DataType="LINK",e.ReadOnly=!0,e.Width=140,this.oColumns.push(e),e=new r.a,e.Header=i.a.GetResource("select"),e.DisplayMember="select",e.DataType="CheckBox",e.Width=60,this.oColumns.push(e)),this.AllowEditPostingDate=i.a.SessionManager.IsActionAssigned(72,"Allow editing of depreciation posting date"),this.AllowEditPostingDate&&null!=this.oparent&&(this.Schedules.TableColumns.push("PostDate_Key"),this.Schedules.TableColumns.push("PostDate"),e=new r.a,e.Header="Post Date",e.DisplayMember="PostDate",e.DataType="DATE",e.Width=110,e.ReadOnly=!1,this.oColumns.push(e)),e=new r.a,e.Header=i.a.GetResource("DocID"),e.DisplayMember="CostCenterID",e.IsVisible=!1,e.Width=80,this.oColumns.push(e),this.Schedules.OnLinkClick.Subscribe(this,"OnLinkClickEvent"),this.Schedules.Table=[],this.Schedules.addEmptyRow(),this.Schedules.addEmptyRow(),this.Schedules.addEmptyRow(),this.Schedules.addEmptyRow(),this.Schedules.addEmptyRow(),this.Schedules.addEmptyRow(),this.Schedules.addEmptyRow(),this.Schedules.Columns=this.oColumns}OnLinkClickEvent(e,t,s){h.RibbonExtViewModel.LoadDocument(e),i.a.page.HideDialog()}LoadData(e,t,s){this.Schedules.Clear();let n=this.oparent.ScreenObject.Data.Tables[4].filter(e=>"DepreciationJV"==e.Name);n.length>0&&parseInt(n[0].Value)>0&&(this.JVCCID=parseInt(n[0].Value)),a.e.IsEmpty(e.Tables[4][0].AccumDeprACCID)||(this.CreditAcc=parseInt(e.Tables[4][0].AccumDeprACCID.toString())),a.e.IsEmpty(e.Tables[4][0].DeprExpenseACCID)||(this.DebitAcc=parseInt(e.Tables[4][0].DeprExpenseACCID.toString()));let o=a.e.Double(e.Tables[4][0].PreviousDepreciation);if(n=this.oparent.ScreenObject.Data.Tables[4].filter(e=>"AssetDeprPostDate"==e.Name),n.length>0&&"ScheduleDate"==n[0].Value.toString()&&(this.IsPostingOnScheduleDate=!0),e.Tables.length>10){let n=1;e.Tables[10].filter(e=>new Date(e.FromDate)>=t&&new Date(e.ToDate)<=s).forEach(e=>{let t=this.Schedules.NewRow();t.period=(n++).toString(),t.From=e.FromDate,t.ID=e.ScheduleID,t.FromText=new Date(e.FromDate).ToString(i.a.SessionManager.Preferences["Date Format"]),t.To=e.ToDate,t.ToText=new Date(e.ToDate).ToString(i.a.SessionManager.Preferences["Date Format"]),t.DocID=e.DocID,t.DocNo=e.VoucherNo,t.Status=e.StatusID,t.CostCenterID=e.CostCenterID,t.DocPrefix=e.DocPrefix,t.DocNumber=e.DocNumber,t.DocumentName=e.DocumentName,t.DepAmt=parseFloat(e.DeprAmt).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount),t.AccDep=parseFloat(e.accmDepr).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount),t.NetValue=parseFloat(e.NetValue).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount),t.AccDepWithPrev=(parseFloat(e.accmDepr)+o).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount),t.select=!1,this.AllowEditPostingDate&&a.e.IsEmpty(t.DocNo)&&(this.IsPostingOnScheduleDate?(t.PostDate_Key=e.ToDate,t.PostDate=new Date(e.ToDate).ToString(i.a.SessionManager.Preferences["Date Format"])):(t.PostDate_Key=this.SystemDate,t.PostDate=this.SystemDate.ToString(i.a.SessionManager.Preferences["Date Format"]))),this.Schedules.addRow(t)})}}GetJVXML(){let e="",t=0;return e+="<JVXML>",this.oTable.forEach(s=>{!a.e.IsEmpty(s.select)&&Object(n.j)(s.select)&&a.e.IsEmpty(s.DocID)&&(t++,e+='<ROWS><DepreciationID DepID="'+s.ID.toString()+'" AssetID="'+this.AssetID+'"',this.Schedules.TableColumns.Contains("PostDate_Key")&&(e+=' Dt="'+new Date(s.PostDate_Key).ToString("dd MMM yyyy")+'"'),e+="/>",e+="</ROWS>")}),t>0&&(this.JVOK=!0),e+="</JVXML>",e.toString()}GetUnPostJVXML(){let e="",t=0;e+="<JVXML>";for(let s=this.oTable.length-1;s>=0;s--)a.e.IsEmpty(this.oTable[s].select)||!Object(n.j)(this.oTable[s].select)||a.e.IsEmpty(this.oTable[s].DocID)||(t++,e+='<DepreciationID DepID="'+this.oTable[s].ID.toString()+'" AssetID="'+this.AssetID+'"></DepreciationID>');return e+="</JVXML>",t>0&&(this.JVUNOK=!0),e.toString()}OnButtonClick(e){if(this.DisplayMessage="","Cancel"==e)i.a.page.HideDialog();else if("Delete"==e){if(!confirm("Do you want to delete depreciation schedule?"))return;let e=c.a.DeleteAssetDeprSchedule(this.AssetID);this.DisplayMessage=e.Message,a.e.Int(e.RetValue)>0&&(this.oparent.ds.Tables[10].Clear(),this.Schedules.Clear())}else if("Post"==e){let e=0;this.objAsset.PostAssetID=this.AssetID,this.objAsset.PostCCID=this.JVCCID,this.objAsset.JVXML=this.GetJVXML(),this.objAsset.Post=!0,this.JVOK?this.objAsset.PostDeprJV().subscribe(t=>{if(e=t.RetValue,this.DisplayMessage=t.Message,e>0){let e=0;for(let t=0;t<this.oTable.length;t++)if(!a.e.IsEmpty(this.oTable[t].select)&&Object(n.j)(this.oTable[t].select)&&a.e.IsEmpty(this.oTable[t].DocID)){this.oparent.ViewTransactionHistory.TransactionHisInfoObj.addEmptyRow();let s=this.oparent.ViewTransactionHistory.TransactionHisInfo.length-1;0==s?e=this.oparent.GetDeprStartValue():s>0&&(e=0==t?this.oparent.GetDeprStartValue():parseFloat(this.oTable[t-1].NetValue.toString())),this.oparent.ViewTransactionHistory.TransactionHisInfo[s].Type="Depreciation Schedule Post",this.oparent.ViewTransactionHistory.TransactionHisInfo[s].Date=Date.Today().ToString("dd/MMM/yyyy"),this.oparent.ViewTransactionHistory.TransactionHisInfo[s].OldValue=e,this.oparent.ViewTransactionHistory.TransactionHisInfo[s].ChangeType="6",this.oparent.ViewTransactionHistory.TransactionHisInfo[s].Percentage=this.oTable[t].DepAmt.toString(),this.oparent.ViewTransactionHistory.TransactionHisInfo[s].NewValue=e-parseFloat(this.oTable[t].DepAmt.toString()),null!=this.oTable[t].DepAmt&&""!=this.oTable[t].DepAmt&&this.oparent.CurrentValueCallBack(e-parseFloat(this.oTable[t].DepAmt.toString())),this.oparent.ViewTransactionHistory.TransactionHisInfoObj.updateRow(this.oparent.ViewTransactionHistory.TransactionHisInfo[s])}return this.LoadData(c.a.GetAssetManagementDetails(this.AssetID),this.oparent.DeprFromDate,this.oparent.DeprToDate),this.MessageVisibility=!0,void(this.JVOK=!1)}}):this.DisplayMessage="Please select record to post"}else if("UnPost"==e){let e=0;this.objAsset.PostAssetID=this.AssetID,this.objAsset.PostCCID=this.JVCCID,this.objAsset.JVXML=this.GetUnPostJVXML(),this.objAsset.Post=!1,this.JVUNOK?this.objAsset.PostDeprJV().subscribe(t=>{if(e=t.RetValue,this.DisplayMessage=t.Message,e>0){let e=0;for(let t=this.oTable.length-1;t>=0;t--)if(!a.e.IsEmpty(this.oTable[t].select)&&Object(n.j)(this.oTable[t].select)&&!a.e.IsEmpty(this.oTable[t].DocID)){this.oparent.ViewTransactionHistory.TransactionHisInfoObj.addEmptyRow();let s=this.oparent.ViewTransactionHistory.TransactionHisInfo.length-1;0==s?e=this.oparent.GetDeprStartValue():s>0&&(e=0==t?this.oparent.GetDeprStartValue():parseFloat(this.oTable[t-1].NetValue.toString())),this.oparent.ViewTransactionHistory.TransactionHisInfo[s].Type="Depreciation Schedule UnPost",this.oparent.ViewTransactionHistory.TransactionHisInfo[s].Date=Date.Today().ToString("dd/MMM/yyyy"),this.oparent.ViewTransactionHistory.TransactionHisInfo[s].OldValue=e-parseFloat(this.oTable[t].DepAmt.toString()),this.oparent.ViewTransactionHistory.TransactionHisInfo[s].ChangeType="6",this.oparent.ViewTransactionHistory.TransactionHisInfo[s].Percentage=this.oTable[t].DepAmt.toString(),this.oparent.ViewTransactionHistory.TransactionHisInfo[s].NewValue=e,null!=this.oTable[t].DepAmt&&""!=this.oTable[t].DepAmt&&this.oparent.CurrentValueCallBack(e),this.oparent.ViewTransactionHistory.TransactionHisInfoObj.updateRow(this.oparent.ViewTransactionHistory.TransactionHisInfo[s])}return this.LoadData(c.a.GetAssetManagementDetails(this.AssetID),this.oparent.DeprFromDate,this.oparent.DeprToDate),this.MessageVisibility=!0,void(this.JVUNOK=!1)}}):this.DisplayMessage="Please select record to Un post"}}}},"a2Y+":function(e,t,s){"use strict";s.r(t),s.d(t,"AssetManagement",(function(){return fe})),s.d(t,"AssetDeprTabViewModel",(function(){return Me}));var i=s("mrSG"),a=s("Do2H"),n=s("Lp6j"),o=s("eQJW"),l=s("ScVY"),r=s("Jnyl"),h=s("0/4Q"),c=s("JIg3"),u=s("EQd/"),D=s("NkMH"),d=s("8B8H"),b=s("ockk"),p=s("n56n"),m=s("VxiT"),S=s("c6C+"),g=s("RJs6"),C=s("xnJf"),T=s("OvA8"),A=s("MCLT"),I=s("4HhE"),V=s("jgdN"),y=s("CUWK"),f=s("hAwP"),M=s("OljK"),P=s("NM0h");class w extends l.b{constructor(e,t){super(),this.Value=0,this.values=0,this.DocID="",this.JVCCID=0,this.objAsset=new P.a,this.Date=new c.a(0),this.Amount=new u.d(0),this.ChangedValue=new u.d(0),this.CurrentValue=new u.d(0),this.Remarks=new u.c(0),this.DebitAccount=new p.b(0),this.CreditAccount=new p.b(0),this.GainAccount=new p.b(0),this.LossAccount=new p.b(0),this.DisposeClearingAccount=new p.b(0),this.PostJV=new h.e(0),this.Type=new h.e(0),this.dtDepr=null,this.oFormula=null,this.PartialDisposeOnNBV=!1,this.CurrentMonthScheduleID=0,this.dblAssetValue=0,this.dblPrevDeprValue=0,this.dblDeprValue=0,this.dblDisposeValue=0,this.dblCurrentMonthDepr=0,this.currentvalue=0,this.NBVDisposeValue=0,this.JVOK=!1,this.SaleProfit="",this.Title=a.a.GetResource("AssetManagement_InActive"),this.Date.Label=a.a.GetResource("AssetManagement_Date"),this.Type.Label=a.a.GetResource("AssetManagement_Type"),this.CurrentValue.Label=a.a.GetResource("AssetManagement_CurrentValue"),this.Amount.Label=a.a.GetResource("AssetManagement_Amount"),this.ChangedValue.Label=a.a.GetResource("AssetManagement_ChangedValue"),this.Remarks.Label=a.a.GetResource("AssetManagement_Remarks"),this.DebitAccount.Label=a.a.GetResource("AssetManagement_DebitAccount"),this.CreditAccount.Label=a.a.GetResource("AssetManagement_CreditAccount"),this.GainAccount.Label=a.a.GetResource("AssetManagement_GainAccount"),this.LossAccount.Label=a.a.GetResource("AssetManagement_LossAccount"),this.DisposeClearingAccount.Label=a.a.GetResource("AssetManagement_DispClrAcc"),this.PostJV.Label=a.a.GetResource("AssetDepr_PostJV"),this.CurrentValue.Enable=!1,this.ChangedValue.Enable=!1,this.Parent=e,this.CurrentValue.Text=t,this.PostJV.Items.push(h.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_Yes"),"1")),this.PostJV.Items.push(h.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_No"),"2")),this.Type.Items.push(h.d.ComboBoxItems_2("Dispose Partial","0")),this.Type.Items.push(h.d.ComboBoxItems_2("Dispose Full","1")),this.Type.Items.push(h.d.ComboBoxItems_2("Sale Full","3")),this.Type.SelectedValue="0",this.Type.SelectionChangedCommand.Subscribe(this,"OnTypeChanged"),this.OnTypeChanged(null);let s=this.Parent.ScreenObject.Data.Tables[4].filter(e=>"DisposeJV"==e.Name);s.length>0&&parseInt(s[0].Value)>0&&(this.JVCCID=parseInt(s[0].Value)),s=this.Parent.ScreenObject.Data.Tables[4].filter(e=>"PartialDisposeBasedOnNBV"==e.Name),s.length>0&&"TRUE"==s[0].Value.toString().toUpperCase()&&(this.PartialDisposeOnNBV=!0),e.RefreshAssetDataSet(),this.dtDepr=this.Parent.ds.Tables[10],this.CreditAccount.CCID=2,this.CreditAccount.TypeID=13,this.DebitAccount.CCID=2,this.DebitAccount.TypeID=14,this.GainAccount.CCID=2,this.GainAccount.TypeID=18,this.LossAccount.CCID=2,this.LossAccount.TypeID=19,this.DisposeClearingAccount.CCID=2,this.DisposeClearingAccount.TypeID=17,this.ClearFields(this.Parent.AssetID),this.Amount.TextChangedCommand.Subscribe(this,"OnLostFocus"),this.Date.SelectedDateChanged.Subscribe(this,"OnDateChanged"),this.CalculateCurrentValue("Value")}OnTypeChanged(e){if(this.CalcCurrentMonthDepr(),"1"==this.Type.SelectedValue||"3"==this.Type.SelectedValue){if("1"==this.Type.SelectedValue?(this.LossAccount.Visible=!0,this.GainAccount.Visible=!1,this.DisposeClearingAccount.Visible=!1,this.Amount.Enable=!1,this.Amount.Text="",this.ChangedValue.Text=""):"3"==this.Type.SelectedValue&&(this.LossAccount.Visible=!0,this.GainAccount.Visible=!0,this.DisposeClearingAccount.Visible=!0,this.Amount.Enable=!0,this.ChangedValue.Text=""),this.CalcCurrentMonthDepr(),this.dblDeprValue=0,this.dblPrevDeprValue=this.Parent.GetPrevDeprValue(),this.dtDepr.length>0){let e=this.dtDepr.filter(e=>!Object(A.isNullOrUndefined)(e.DocID)).Compute("sum","DeprAmt");null!=e&&(this.dblDeprValue=parseFloat(parseFloat(e).ToString("N"+a.a.SessionManager.Preferences.DecimalsinAmount))),this.dblAssetValue=0;let t=0;for(t=0;t<this.dtDepr.length&&null!=this.dtDepr[t].DocID;t++);t--,this.dblAssetValue=t>=0?parseFloat(this.dtDepr[t].NetValue):parseFloat(this.dtDepr[0].NetValue)+parseFloat(this.dtDepr[0].DeprAmt),this.dblAssetValue=parseFloat(this.dblAssetValue.ToString("N"+a.a.SessionManager.Preferences.DecimalsinAmount)),this.dblAssetValue+=this.dblDeprValue,this.dblDisposeValue=this.dblAssetValue-this.dblDeprValue}else this.dblAssetValue=this.Parent.GetDeprStartValue(),this.dblDisposeValue=this.dblAssetValue-this.dblDeprValue;"1"==this.Type.SelectedValue&&(this.Amount.Text=parseFloat((this.dblDisposeValue-this.dblCurrentMonthDepr).ToString("N"+a.a.SessionManager.Preferences.DecimalsinAmount)).toString())}else this.GainAccount.Visible=!1,this.DisposeClearingAccount.Visible=!1,this.Amount.Enable=!0,this.Amount.Text=""}OnLostFocus(e){if(!n.e.IsNum(this.Amount.Text))return this.DisplayMessage="Enter Valid Amount",void(this.ChangedValue.Text=this.CurrentValue.Text);this.DisplayMessage="",this.CalculateCurrentValue("Date")}OnDateChanged(e){this.CalculateCurrentValue("Date")}CalculateCurrentValue(e){if(null==e||"Value"!=e.toString()&&"Date"!=e.toString())return;let t=0;if(this.currentvalue=0,this.NBVDisposeValue=0,this.dblCurrentMonthDepr=0,this.CurrentMonthScheduleID=0,this.dtDepr.length>0){let e=this.dtDepr.filter(e=>Object(A.isNullOrUndefined)(e.DocID));e.SortBy(["FromDate"]),this.currentvalue=e.length>0?parseFloat(e[0].NetValue)+parseFloat(e[0].DeprAmt):0,this.CalcCurrentMonthDepr(),this.currentvalue-=this.dblCurrentMonthDepr}else this.currentvalue=this.Parent.GetDeprStartValue();if(this.CurrentValue.Text=this.currentvalue.toString(),"1"==this.Type.SelectedValue||"2"==this.Type.SelectedValue||"3"==this.Type.SelectedValue)return"1"==this.Type.SelectedValue&&(this.Amount.Text=this.CurrentValue.Text),void(this.ChangedValue.Text="0");if(t=n.e.Double(this.Amount.Text),null!=this.Amount.Text&&""!=this.Amount.Text)if("0"==this.Type.SelectedValue&&this.PartialDisposeOnNBV){let e=0;e=n.e.Double(this.Parent.PurchaseValue.Text),0==e&&(e=n.e.Double(this.Parent.DeprStartValue.Text)),this.NBVDisposeValue=this.currentvalue*t/e,this.ChangedValue.Text=(this.currentvalue-this.NBVDisposeValue).ToString("N"+a.a.SessionManager.Preferences.DecimalsinAmount)}else this.ChangedValue.Text=(this.currentvalue-t).ToString("N"+a.a.SessionManager.Preferences.DecimalsinAmount);else this.ChangedValue.Text=""}CalcCurrentMonthDepr(){if(this.CurrentMonthScheduleID=0,this.dblCurrentMonthDepr=0,null==this.dtDepr)return;let e=null;for(let t=0;t<this.dtDepr.length;t++){let s=this.dtDepr[t];if(null==s.DocID){e=s;break}}if(null!=e){let t=new Date(e.FromDate),s=new Date(e.ToDate);if(t<this.Date.Date&&s>=this.Date.Date){let i=this.Date.Date.getDate()-t.getDate();i>0&&(this.CurrentMonthScheduleID=parseInt(e.ScheduleID),this.dblCurrentMonthDepr=parseFloat((parseFloat(e.DeprAmt)*i/(s.getDate()+1-t.getDate())).ToString("N"+a.a.SessionManager.Preferences.DecimalsinAmount)))}}}OnButtonClick(e){let t=null;if(this.DisplayMessage="","Cancel"==e)this.Parent.AddDisposalVisibility=!1,this.Parent.DetailsVisibility=!0,a.a.page.HideDialog();else if("Ok"==e){let e=0;if(!n.e.Double(this.Amount.Text))return void(this.DisplayMessage="Enter Valid Amount");if(null==this.Amount.Text||""==this.Amount.Text)return void(this.DisplayMessage="Enter Amount");let s=0;if(s=n.e.Double(this.ChangedValue.Text),s<0&&"3"!=this.Type.SelectedValue&&!("0"==this.Type.SelectedValue&&parseFloat(this.CurrentValue.Text)<=0))return void(this.DisplayMessage="Enter Amount Less than or equal current value.");if(null==this.Amount.Text||""==this.Amount.Text)return void(this.DisplayMessage="Enter Amount");if("1"==this.PostJV.SelectedValue){if(this.DebitAccount.Visible&&0==this.DebitAccount.SelectedValue)return void(this.DisplayMessage="Select Debit Account");if(this.CreditAccount.Visible&&0==this.CreditAccount.SelectedValue)return void(this.DisplayMessage="Select Credit Account");if(this.DisposeClearingAccount.Visible&&0==this.DisposeClearingAccount.SelectedValue)return void(this.DisplayMessage="Select Dispose Clearing Account");if(this.LossAccount.Visible&&0==this.LossAccount.SelectedValue&&"0"==this.Type.SelectedValue)return void(this.DisplayMessage="Select Dispose Clearing Account")}if("0"==this.Type.SelectedValue){let e=parseFloat(this.Amount.Text);"0"==this.Type.SelectedValue&&this.PartialDisposeOnNBV&&(this.CalculateCurrentValue("Value"),e=this.NBVDisposeValue);let t=new f.a;if(t.Date=this.Date.Date,t.Value=e,t.IsDispose=!0,this.oFormula=new f.b(this.Parent.AssetID),this.oFormula.GetScheduleData(this.Parent.GetDeprStartValue(),0,0,0,null,0,0,"SLN","Y",0,"FP",this.Parent.CDeprStartDate.Date,this.Parent.CDeprEndDate.Date,t,this.Parent.DeprBook.SelectedValue.toString()),this.oFormula.ErrorMessage.length>0)return void(this.DisplayMessage=this.oFormula.ErrorMessage);this.objAsset.DepreciationXML=this.oFormula.GetXML()}else{let e=this.dtDepr.filter(e=>!Object(A.isNullOrUndefined)(e.DocID)&&(new Date(e.FromDate)>=this.Date.Date||new Date(e.FromDate)<=this.Date.Date.OnlyDate()&&new Date(e.ToDate)>this.Date.Date.OnlyDate()));if(e.length>0)return void(this.DisplayMessage="Depreciation posting exists for selected date.");let t=new Date(this.Date.Date.getFullYear(),this.Date.Date.getMonth(),1);if(e=this.dtDepr.filter(e=>Object(A.isNullOrUndefined)(e.DocID)&&new Date(e.ToDate)<t.OnlyDate()),e.length>0)return void(this.DisplayMessage="Clear Pending Depreciation Postings.")}if(1==this.Parent.DEditClick&&0==this.Parent.DAddClick){this.PostJV.Enable=!1;let s=parseInt(this.Edr.ItemArray[0].toString())-1;this.Parent.DisposeGrid.Table[s].Date=this.Date.Date.ToString("dd/MMM/yyyy"),this.Parent.DisposeGrid.Table[s].Amount=this.Amount.Text,this.Parent.DisposeGrid.Table[s].CurrentValue=this.CurrentValue.Text,this.Parent.DisposeGrid.Table[s].Remarks=this.Remarks.Text,this.Parent.DisposeGrid.Table[s].DebitAccount=this.DebitAccount.SelectedValue,this.Parent.DisposeGrid.Table[s].CreditAccount=this.CreditAccount.SelectedValue,this.Parent.DisposeGrid.Table[s].GainAccount=this.GainAccount.SelectedValue,this.Parent.DisposeGrid.Table[s].LossAccount=this.LossAccount.SelectedValue,this.Parent.DisposeGrid.Table[s].DisposeClearingAccount=this.DisposeClearingAccount.SelectedValue,this.Parent.DisposeGrid.Table[s].DisposeType_Name="1"==this.Type.SelectedValue||"2"==this.Type.SelectedValue||"3"==this.Type.SelectedValue?this.Type.GetselectedItem().Name:"Dispose",this.objAsset.PostAssetID=this.Parent.AssetID,this.objAsset.PostCCID=this.JVCCID,this.objAsset.JVXML=this.GetJVXML(),this.objAsset.RecordType="EDIT",this.objAsset.DeprTypeID=2,"1"==this.PostJV.SelectedValue?(this.objAsset.DocXML=this.DocXML("DocumentEdit"),this.objAsset.DocSave="",this.objAsset.Post=!0):"2"==this.PostJV.SelectedValue&&(this.objAsset.DocXML="",this.objAsset.DocSave=this.DocXML("NewInsertDoc"),this.objAsset.Post=!1),this.objAsset.SetAssetDispose(this.Date.Date).subscribe(s=>{t=s.ds,e=n.e.Int(s.obj),e>0&&(this.Parent.IsFullDispose=parseInt(this.Type.SelectedValue),this.Parent.AddDisposalVisibility=!1,this.Parent.DetailsVisibility=!0,null!=this.ChangedValue.Text&&this.Parent.CurrentValueCallBack(parseFloat(this.ChangedValue.Text)),this.ClearFields(this.Parent.AssetID))})}else{if(this.objAsset.PostAssetID=this.Parent.AssetID,this.objAsset.PostCCID=this.JVCCID,this.objAsset.JVXML=this.GetJVXML(),"3"==this.Type.SelectedValue){if(this.GainAccount.Visible&&0==this.GainAccount.SelectedValue&&"GAIN"==this.SaleProfit)return void(this.DisplayMessage="Select Gain Account");if(this.LossAccount.Visible&&0==this.LossAccount.SelectedValue&&"LOSS"==this.SaleProfit)return void(this.DisplayMessage="Select Loss Account")}this.objAsset.DocXML="",this.objAsset.DocSave=this.DocXML("NewInsertDoc"),this.objAsset.DeprTypeID=2,this.objAsset.RecordType="NEW",this.objAsset.Post="1"==this.PostJV.SelectedValue,this.objAsset.SetAssetDispose(this.Date.Date).subscribe(s=>{if(t=s.ds,e=n.e.Int(s.obj),e>0){this.Parent.IsFullDispose=parseInt(this.Type.SelectedValue);let s,i=-1;for(let e=0;e<this.Parent.DisposeGrid.Table.length;e++)if(n.e.IsEmpty(this.Parent.DisposeGrid.Table[e].Edit)){i=e;break}if(s=i>-1?this.Parent.DisposeGrid.Table[i]:this.Parent.DisposeGrid.NewRow(),s.Date=this.Date.Date.ToString("dd/MMM/yyyy"),s.Amount=this.Amount.Text,s.CurrentValue=this.CurrentValue.Text,s.Remarks=this.Remarks.Text,s.DebitAccount=this.DebitAccount.SelectedValue,s.CreditAccount=this.CreditAccount.SelectedValue,s.GainAccount=this.GainAccount.SelectedValue,s.LossAccount=this.LossAccount.SelectedValue,s.DisposeClearingAccount=this.DisposeClearingAccount.SelectedValue,s.DisposeType_Name="1"==this.Type.SelectedValue||"2"==this.Type.SelectedValue||"3"==this.Type.SelectedValue?this.Type.GetselectedItem().Name:"Dispose",s.HistoryID=e,null!=t){let e=null;for(let s=0;s<t.Tables.length;s++){let i=t.Tables[s];if(i.Columns.Contains("VOUCHERNO")&&i.Columns.Contains("DOcID")){i.length>0&&(e=i);break}}null!=e&&(s.DocID=e[0].DOcID.toString(),s.DocNo=e[0].VoucherNo.toString(),s.CostCenterID=e[0].CostCenterID.toString(),s.DocumentName=e[0].DocumentName.toString(),s.DocPrefix=e[0].DocPrefix.toString(),s.DocNumber=e[0].DocNumber.toString())}s.PostJV=this.PostJV.SelectedValue,s.Edit="Edit",s.Delete="Delete",-1==i?this.Parent.DisposeGrid.addRow(s):this.Parent.DisposeGrid.updateRow(s),this.values=n.e.Double(this.Amount.Text),this.Parent.ViewTransactionHistory.TransactionHisInfoObj.addEmptyRow();let a=this.Parent.ViewTransactionHistory.TransactionHisInfo.length-1;0==a?this.Value=0:a>0&&(this.Value=parseFloat(this.CurrentValue.Text)),this.Parent.ViewTransactionHistory.TransactionHisInfo[a].Type="Dispose",this.Parent.ViewTransactionHistory.TransactionHisInfo[a].Date=this.Date.Date.ToString("dd/MMM/yyyy"),this.Parent.ViewTransactionHistory.TransactionHisInfo[a].OldValue=this.Value,this.Parent.ViewTransactionHistory.TransactionHisInfo[a].ChangeType="5",this.Parent.ViewTransactionHistory.TransactionHisInfo[a].Percentage=this.values,this.Parent.ViewTransactionHistory.TransactionHisInfo[a].NewValue=this.Value-this.values,this.Parent.ViewTransactionHistory.TransactionHisInfoObj.updateRow(this.Parent.ViewTransactionHistory.TransactionHisInfo[a]),this.Parent.AddDisposalVisibility=!1,this.Parent.DetailsVisibility=!0,n.e.IsEmpty(this.ChangedValue.Text)?this.Parent.CurrentValueCallBack(0):this.Parent.CurrentValueCallBack(parseFloat(this.ChangedValue.Text)),this.ClearFields(this.Parent.AssetID)}else this.DisplayMessage="Error in saving"})}}}ClearFields(e){let t=null;this.Date.Date=Date.Today(),this.Amount.Text="",this.CurrentValue.Text="",this.Remarks.Text="",this.ChangedValue.Text="",this.DebitAccount.SelectedValue=this.Parent.AccumDeprACCID.SelectedValue,this.CreditAccount.SelectedValue=this.Parent.AcqnCostACCID.SelectedValue,this.GainAccount.SelectedValue=this.Parent.DisposalGainAcc.SelectedValue,this.LossAccount.SelectedValue=this.Parent.DisposalLossAcc.SelectedValue,this.DisposeClearingAccount.SelectedValue=this.Parent.DisposalClearingAcc.SelectedValue,t=this.Parent.ScreenObject.Data.Tables[4].filter(e=>"DDefaultPostJV"==e.Name),t.length>0&&parseInt(t[0].Value)>0&&(this.PostJV.SelectedValue=t[0].Value.toString()),t=this.Parent.ScreenObject.Data.Tables[4].filter(e=>"DPostJVMand"==e.Name),this.PostJV.Enable=!(t.length>0&&1==parseInt(t[0].Value))}OnLoad(e){this.Edr=e,null!=e&&(this.Type.SelectedValue=e.PolicyType.toString(),this.OnTypeChanged(null),this.Date.Date=new Date(e.Date.toString()),this.CurrentValue.Text=e.CurrentValue.toString(),this.Amount.Text=e.Amount.toString(),this.Remarks.Text=e.Remarks.toString(),this.DebitAccount.SelectedValue=parseInt(e.DebitAccount.toString()),this.CreditAccount.SelectedValue=parseInt(e.CreditAccount.toString()),this.GainAccount.SelectedValue=parseInt(e.GainAccount.toString()),this.LossAccount.SelectedValue=parseInt(e.LossAccount.toString()),this.PostJV.SelectedValue=e.PostJV.toString(),this.DocID=e.DocID.toString(),History=e.HistoryID.toString())}GetJVXML(){let e="",t=n.e.IsEmpty(this.Remarks.Text)?"":n.e.EncodeXML(this.Remarks.Text),s=" <Numeric /> <Alpha />"+this.Parent.GetCCXML()+" <EXTRAXML/>";e+="<JVXML>";let i=this.dblDeprValue+this.dblCurrentMonthDepr,o=this.dblDisposeValue-this.dblCurrentMonthDepr;if(1!=this.Date.Date.getDate()&&("1"==this.Type.SelectedValue||"3"==this.Type.SelectedValue)&&this.dblCurrentMonthDepr>0){let n=0,l=0;""!=this.Parent.ds.Tables[4][0].AccumDeprACCID.toString()&&(n=parseInt(this.Parent.ds.Tables[4][0].AccumDeprACCID.toString())),""!=this.Parent.ds.Tables[4][0].DeprExpenseACCID.toString()&&(l=parseInt(this.Parent.ds.Tables[4][0].DeprExpenseACCID.toString()));let r=this.dblCurrentMonthDepr.ToString("N"+a.a.SessionManager.Preferences.DecimalsinAmount).Replace(",","");e+='<ROWS ScheduleID="'+this.CurrentMonthScheduleID.toString()+'" Amount="'+r+'" AccDepr="'+i+'" Net="'+o+'"><DocumentXML>',e+='<Row><Transactions DocSeqNo="1"  DocDetailsID="0" LinkedInvDocDetailsID="" LinkedFieldName="" DebitAccount="'+l.toString()+'" CreditAccount="-99" Amount="'+r+'" AmtFc="'+r+'" CurrencyID="1" ExchangeRate="1" LineNarration="'+t+'" CommonNarration="Depreciation Posting"  >',e+="</Transactions>",e+=s,e+=' </Row><Row><Transactions DocSeqNo="2"  DocDetailsID="0" LinkedInvDocDetailsID="" LinkedFieldName="" DebitAccount="-99" CreditAccount="'+n.toString()+'" Amount="'+r+'" AmtFc="'+r+'" CurrencyID="1" ExchangeRate="1" LineNarration="'+t+'" CommonNarration="Depreciation Posting"  >',e+="</Transactions>",e+=s,e+=" </Row>",e+="</DocumentXML></ROWS>"}if(e+="<ROWS><DocumentXML>","1"==this.Type.SelectedValue)e+='<Row> <Transactions DocSeqNo="1"  DocDetailsID="0" LinkedInvDocDetailsID="" LinkedFieldName="" CreditAccount="'+this.CreditAccount.SelectedValue.toString()+'" DebitAccount="-99" Amount="'+(this.dblAssetValue+this.dblPrevDeprValue)+'" AmtFc="'+(this.dblAssetValue+this.dblPrevDeprValue)+'" CurrencyID="1" ExchangeRate="1" LineNarration="'+t+'" CommonNarration="Asset Dispose Posting"  >',e+="</Transactions>",e+=s,e+=' </Row><Row> <Transactions DocSeqNo="2"  DocDetailsID="0" LinkedInvDocDetailsID="" LinkedFieldName="" CreditAccount="-99" DebitAccount="'+this.DebitAccount.SelectedValue.toString()+'" Amount="'+(i+this.dblPrevDeprValue)+'" AmtFc="'+(i+this.dblPrevDeprValue)+'" CurrencyID="1" ExchangeRate="1" LineNarration="'+t+'" CommonNarration="Asset Dispose Posting"  >',e+="</Transactions>",e+=s,e+=" </Row>",o>0&&(e+='<Row> <Transactions DocSeqNo="3"  DocDetailsID="0" LinkedInvDocDetailsID="" LinkedFieldName="" CreditAccount="-99" DebitAccount="'+this.LossAccount.SelectedValue.toString()+'" Amount="'+o+'" AmtFc="'+o+'" CurrencyID="1" ExchangeRate="1" LineNarration="'+t+'" CommonNarration="'+t+'"  >',e+="</Transactions>",e+=s,e+=" </Row>");else if("3"==this.Type.SelectedValue){this.SaleProfit="";let a=parseFloat(this.Amount.Text);e+='<Row> <Transactions DocSeqNo="1"  DocDetailsID="0" LinkedInvDocDetailsID="" LinkedFieldName="" CreditAccount="'+this.CreditAccount.SelectedValue.toString()+'" DebitAccount="-99" Amount="'+(this.dblAssetValue+this.dblPrevDeprValue)+'" AmtFc="'+(this.dblAssetValue+this.dblPrevDeprValue)+'" CurrencyID="1" ExchangeRate="1" LineNarration="'+t+'" CommonNarration="Asset Dispose Posting"  >',e+="</Transactions>",e+=s,e+=' </Row><Row> <Transactions DocSeqNo="2"  DocDetailsID="0" LinkedInvDocDetailsID="" LinkedFieldName="" CreditAccount="-99" DebitAccount="'+this.DebitAccount.SelectedValue.toString()+'" Amount="'+(i+this.dblPrevDeprValue)+'" AmtFc="'+(i+this.dblPrevDeprValue)+'" CurrencyID="1" ExchangeRate="1" LineNarration="'+t+'" CommonNarration="Asset Dispose Posting"  >',e+="</Transactions>",e+=s,e+=" </Row>",a>0&&(e+='<Row> <Transactions DocSeqNo="3"  DocDetailsID="0" LinkedInvDocDetailsID="" LinkedFieldName="" CreditAccount="-99" DebitAccount="'+this.DisposeClearingAccount.SelectedValue.toString()+'" Amount="'+a+'" AmtFc="'+a+'" CurrencyID="1" ExchangeRate="1" LineNarration="'+t+'" CommonNarration="Asset Dispose Posting"  >',e+="</Transactions>",e+=s,e+=" </Row>"),a!=o&&(a>o?(this.SaleProfit="GAIN",e+='<Row> <Transactions DocSeqNo="4"  DocDetailsID="0" LinkedInvDocDetailsID="" LinkedFieldName="" CreditAccount="'+this.GainAccount.SelectedValue.toString()+'" DebitAccount="-99" Amount="'+(a-o).toString()+'" AmtFc="'+(a-o).toString()+'" CurrencyID="1" ExchangeRate="1" LineNarration="'+t+'" CommonNarration="Asset Dispose Posting"  >'):(this.SaleProfit="LOSS",e+='<Row> <Transactions DocSeqNo="4"  DocDetailsID="0" LinkedInvDocDetailsID="" LinkedFieldName="" CreditAccount="-99" DebitAccount="'+this.LossAccount.SelectedValue.toString()+'" Amount="'+(o-a).toString()+'" AmtFc="'+(o-a).toString()+'" CurrencyID="1" ExchangeRate="1" LineNarration="'+t+'" CommonNarration="Asset Dispose Posting"  >'),e+="</Transactions>",e+=s,e+=" </Row>")}else{let i=0,a=0;this.PartialDisposeOnNBV?(i=parseFloat(this.Amount.Text)-this.NBVDisposeValue,a=this.NBVDisposeValue):i=parseFloat(this.Amount.Text),e+='<Row><Transactions DocSeqNo="1"  DocDetailsID="0" LinkedInvDocDetailsID="" LinkedFieldName="" CreditAccount="'+this.CreditAccount.SelectedValue.toString()+'" DebitAccount="-99" Amount="'+this.Amount.Text+'" AmtFc="'+this.Amount.Text+'" CurrencyID="1" ExchangeRate="1" LineNarration="'+t+'" CommonNarration="Asset Dispose Posting">',e+="</Transactions>",e+=s,e+="</Row>",i>0&&(e+='<Row><Transactions DocSeqNo="2"  DocDetailsID="0" LinkedInvDocDetailsID="" LinkedFieldName="" CreditAccount="-99" DebitAccount="'+this.DebitAccount.SelectedValue.toString()+'" Amount="'+i.toString()+'" AmtFc="'+i.toString()+'" CurrencyID="1" ExchangeRate="1" LineNarration="'+t+'" CommonNarration="Asset Dispose Posting">',e+="</Transactions>",e+=s,e+="</Row>"),0!=a&&(e+='<Row><Transactions DocSeqNo="2"  DocDetailsID="0" LinkedInvDocDetailsID="" LinkedFieldName="" CreditAccount="-99" DebitAccount="'+this.LossAccount.SelectedValue.toString()+'" Amount="'+a.toString()+'" AmtFc="'+a.toString()+'" CurrencyID="1" ExchangeRate="1" LineNarration="'+t+'" CommonNarration="Asset Dispose Posting">',e+="</Transactions>",e+=s,e+="</Row>")}return e+="</DocumentXML></ROWS>",e+="</JVXML>",this.JVOK=!0,e.toString()}DocXML(e){let t="";return t+="<XML ",t+='History="'+this.Type.GetselectedItem().Name+'" ',t+='HistoryType="3" ',t+='Type="'+this.Type.SelectedValue+'" ',t+='Date="'+this.Date.Date.ToString("dd/MMM/yyyy")+'" ',t+='Amount="'+this.Amount.Text.Replace(",","")+'" ',t+='CurrentValue="'+this.CurrentValue.Text.Replace(",","")+'" ',t+='PurchaseValue="'+this.Parent.GetDeprStartValue()+'" ',t+='Remarks="'+this.Remarks.Text+'" ',t+='DebitAccount="'+this.DebitAccount.SelectedValue+'" ',t+='CreditAccount="'+this.CreditAccount.SelectedValue+'" ',t+='GainAccount="'+this.GainAccount.SelectedValue+'" ',t+='LossAccount="'+this.LossAccount.SelectedValue+'" ',t+='PostJV="'+this.PostJV.SelectedValue+'" ',t+='HistoryID="'+History+'" ',"DocumentEdit"==e?t+='DocID="'+this.DocID+'" ':"NewInsertDoc"==e&&(t+='AssetID="'+this.Parent.AssetID+'" '),t+="/>",t.toString()}}var E=s("7fVR"),G=s("fXoL"),N=s("ofXK"),O=s("sT9C"),L=s("sYmb");function j(e,t){if(1&e){const e=G.ac();G.Zb(0,"span",6),G.hc("click",(function(){return G.Ic(e),G.lc().obj.OnButtonClick("Post")})),G.Ub(1,"i",7),G.Wc(2),G.mc(3,"translate"),G.Yb()}2&e&&(G.Db(2),G.Xc(G.nc(3,1,"Post")))}function v(e,t){if(1&e){const e=G.ac();G.Zb(0,"span",6),G.hc("click",(function(){return G.Ic(e),G.lc().obj.OnButtonClick("UnPost")})),G.Ub(1,"i",8),G.Wc(2),G.mc(3,"translate"),G.Yb()}2&e&&(G.Db(2),G.Xc(G.nc(3,1,"UnPost")))}function x(e,t){if(1&e){const e=G.ac();G.Zb(0,"span",6),G.hc("click",(function(){return G.Ic(e),G.lc().obj.OnButtonClick("Delete")})),G.Ub(1,"i",9),G.Wc(2),G.mc(3,"translate"),G.Yb()}2&e&&(G.Db(2),G.Xc(G.nc(3,1,"Delete")))}let R=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=G.Nb({type:e,selectors:[["app-depreciation-schedule"]],decls:20,vars:4,consts:[[1,"master-screen",2,"padding-bottom","4px","width","955px"],[1,"dialogSubBody"],[1,"btnMetroDiv","secondary-btn-group",2,"padding-top","0px","margin-top","-8px"],["class","secondary-btn-wicon",3,"click",4,"ngIf"],[1,"documentgrid","row","form-row",2,"width","100%"],[2,"width","100%",3,"obj"],[1,"secondary-btn-wicon",3,"click"],[1,"fa-light","fa-floppy-disk-circle-arrow-right"],[1,"fa-light","fa-file-times"],[1,"fa-light","fa-trash-alt"]],template:function(e,t){1&e&&(G.Zb(0,"div",0),G.Wc(1,"\n    "),G.Zb(2,"div",1),G.Wc(3,"\n        "),G.Zb(4,"div",2),G.Wc(5,"\n            "),G.Uc(6,j,4,3,"span",3),G.Wc(7,"\n            "),G.Uc(8,v,4,3,"span",3),G.Wc(9,"\n            "),G.Uc(10,x,4,3,"span",3),G.Wc(11,"\n        "),G.Yb(),G.Wc(12,"\n      "),G.Zb(13,"div",4),G.Wc(14,"\n        "),G.Ub(15,"app-PactGridView",5),G.Wc(16,"  \n      "),G.Yb(),G.Wc(17,"\n    "),G.Yb(),G.Wc(18,"    \n"),G.Yb(),G.Wc(19,"\n")),2&e&&(G.Db(6),G.tc("ngIf",t.obj.PostVisible),G.Db(2),G.tc("ngIf",t.obj.PostVisible),G.Db(2),G.tc("ngIf",t.obj.DeleteVisible),G.Db(5),G.tc("obj",t.obj.Schedules))},directives:[N.t,O.a],pipes:[L.d],encapsulation:2}),e})();class k extends l.b{constructor(e){super(),this.currentvalue=0,this.Parent=null,this.PeriodField="",this.SalValue="",this.PurValue="",this.DepreciationMethod="",this.AveragingMethod="",this.objAsset=new P.a,this.ChangeID=0,this.Type=new h.e(0),this.PostJV=new h.e(0),this.Date=new c.a(0),this.Location=new p.b(0),this.DebitAccount=new p.b(0),this.CreditAccount=new p.b(0),this.Value=new u.d(0),this.NewEsitmateLife=new u.d(0),this.NewEsitmateEndDate=new c.a(0),this.RemiainingLifeObj=new u.d(0),this.Remarks=new u.d(0),this.UpdatedValueObj=new u.d(0),this.OldValueObj=new u.d(0),this.IsModified=!1,this.value=0,this.JVOK=!1,this.NetAssetValue="",this.dtDepr=[],this.ClassName="ChangeValue",this.Parent=e,this.Title=this.DisplayName=a.a.GetResource("AssetManagement_ChangeValue"),this.Date.Label=a.a.GetResource("AssetManagement_Date"),this.Type.Label=a.a.GetResource("AssetManagement_Type"),this.OldValueObj.Label="Old Value",this.Value.Label=a.a.GetResource("AssetManagement_Amount"),this.UpdatedValueObj.Label="New Value",this.RemiainingLifeObj.Label="Remaining Life",this.Remarks.Label=a.a.GetResource("BillWise_Remarks"),this.DebitAccount.Label=a.a.GetResource("AssetManagement_DebitAccount"),this.CreditAccount.Label=a.a.GetResource("AssetManagement_CreditAccount"),this.PostJV.Label=a.a.GetResource("AssetDepr_PostJV"),this.DebitAccount.CCID=2,this.DebitAccount.TypeID=100,this.CreditAccount.CCID=2,this.CreditAccount.TypeID=100,this.UpdatedValue="",this.UpdatedValueObj.Enable=!1,this.OldValue="",this.OldValueObj.Enable=!1,this.RemiainingLife="",this.RemiainingLifeObj.Enable=!1,this.NewEsitmateEndDate.Enable=!1,this.Date.SelectedDateChanged.Subscribe(this,"OnDateChanged"),this.Value.TextChangedCommand.Subscribe(this,"OnTextChange","Value"),this.NewEsitmateLife.TextChangedCommand.Subscribe(this,"OnEsitmateLifeChange"),this.Type.Items.push(h.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_IncreasebyValue"),"0")),this.Type.Items.push(h.d.ComboBoxItems_2("Change Estimate Life","25")),this.Type.SelectedValue="0",this.Type.SelectionChangedCommand.Subscribe(this,"OnTypeChanged"),this.PostJV.Items.push(h.d.ComboBoxItems_2(a.a.GetResource("Com_No"),"2")),this.PostJV.Items.push(h.d.ComboBoxItems_2(a.a.GetResource("Com_Yes"),"1"));let t=this.Parent.ScreenObject.Data.Tables[4].filter(e=>"DIncreaseDefaultPostJV"==e.Name);this.PostJV.SelectedValue=t.length>0&&parseInt(t[0].Value)>0?t[0].Value.toString():"1",t=this.Parent.ScreenObject.Data.Tables[4].filter(e=>"DIncreasePostJVMand"==e.Name),this.PostJV.Enable=!(t.length>0&&1==parseInt(t[0].Value)),this.DebitAccount.TypeID=this.Parent.AcqnCostACCID.TypeID,this.DebitAccount.SelectedValue=this.Parent.AcqnCostACCID.SelectedValue,this.CreditAccount.TypeID=this.Parent.AcquisitionClearingAcc.TypeID,this.CreditAccount.SelectedValue=this.Parent.AcquisitionClearingAcc.SelectedValue,this.Location.SelectedValue=this.Parent.Location.SelectedValue,e.RefreshAssetDataSet(),this.dtDepr=e.ds.Tables[10],this.OnTypeChanged(null)}get RemiainingLife(){return this.RemiainingLifeObj.Text}set RemiainingLife(e){this.RemiainingLifeObj.Text=e}get UpdatedValue(){return this.UpdatedValueObj.Text}set UpdatedValue(e){this.UpdatedValueObj.Text=e}get OldValue(){return this.OldValueObj.Text}set OldValue(e){this.OldValueObj.Text=e}OnSaveValue(e){if(this.DisplayMessage="","Cancel"==e)this.Parent.ChangeValueVisibility=!1,this.Parent.DetailsVisibility=!0,a.a.page.HideDialog();else if("Schedule"==e){let e=this.CalculateAssetSchedule();if(this.DisplayMessage.length>0)return;let t=new E.a;t.DepreciationScheduleViewModel_1(this),t.Schedules.Table.Clear(),t.Schedules.TableColumns.push("ActualDeprAmt"),e.ScheduleTable.forEach(s=>{let i=t.Schedules.NewRow();i.period=s.Period,i.FromText=new Date(s.From).ToString(a.a.SessionManager.Preferences["Date Format"]),i.ToText=new Date(s.To).ToString(a.a.SessionManager.Preferences["Date Format"]),i.DepAmt=s["Depr Amt"],i.AccDepWithPrev=(e.PrevDeprValue+parseFloat(s["Accm Depr"])).ToString(a.a.SessionManager.Preferences.DecimalsinAmount),i.NetValue=s["Net Value"],null!=s.DocID&&(i.Status="Posted"),i.ActualDeprAmt=s.ActualDeprAmt,t.Schedules.addRow(i)}),a.a.page.ShowDialog(t,R,{ShowCenter:!0})}else{let e=this.CalculateAssetSchedule();if(this.DisplayMessage.length>0)return;if("25"==this.Type.SelectedValue){let t=e.ScheduleTable.filter(e=>!Object(A.isNullOrUndefined)(e.DocID));for(let s=t.length-1;s>=0;s--)e.ScheduleTable.Remove(t[s])}this.objAsset.DepreciationXML=e.GetXML(),this.objAsset.ChangeValueXML="<ChangeValueXML><Row ",this.objAsset.ChangeValueXML+=' AssetID="'+this.Parent.AssetID+'"',this.objAsset.ChangeValueXML+=' ChangeType="'+this.Type.SelectedValue+'"',this.objAsset.ChangeValueXML+=' ChangeName="'+this.Type.Text+'"',this.objAsset.ChangeValueXML+=' StatusID="'+this.Parent.Status.SelectedValue+'"',this.objAsset.ChangeValueXML+=' ChangeDate="'+this.Date.Date.ToString("dd/MMM/yyyy")+'"',this.objAsset.ChangeValueXML+=' AssetOldValue="'+this.currentvalue+'"',this.objAsset.ChangeValueXML+=' ChangeValue="'+this.value+'"',this.objAsset.ChangeValueXML+=' AssetNewValue="'+(this.currentvalue+this.value)+'"',"25"==this.Type.SelectedValue&&(this.objAsset.ChangeValueXML+=' NewEsitmateLife="'+this.NewEsitmateLife.Text+'"',this.objAsset.ChangeValueXML+=' NewEsitmateEndDate="'+this.NewEsitmateEndDate.Date.ToString("dd/MMM/yyyy")+'"'),this.objAsset.ChangeValueXML+="/>",this.objAsset.ChangeValueXML+="</ChangeValueXML>",this.objAsset.HistoryXML="",this.objAsset.LocationID=this.Location.SelectedValue,this.objAsset.JVXML="1"==this.PostJV.SelectedValue&&"4"!=this.Type.SelectedValue&&"25"!=this.Type.SelectedValue?this.GetJVXML():"",this.objAsset.ChangeValue(parseInt(this.Type.SelectedValue),this.Date.Date).subscribe(e=>{if(this.DisplayMessage=e.Message,n.e.Int(e.RetValue)>0){"25"==this.Type.SelectedValue&&(this.Parent.EstLife=this.Parent.EstimateLife.Text=this.NewEsitmateLife.Text,null!=this.Parent.CDeprEndDate&&(this.Parent.CDeprEndDate.Date=this.NewEsitmateEndDate.Date)),this.Parent.ViewTransactionHistory.ExchList.push(this),this.Parent.ViewTransactionHistory.TransactionHisInfoObj.addEmptyRow();let e=this.Parent.ViewTransactionHistory.TransactionHisInfo.length-1;return this.Parent.ViewTransactionHistory.TransactionHisInfo[e].Type=this.Type.Text,this.Parent.ViewTransactionHistory.TransactionHisInfo[e].Date=this.Date.Date.ToString("dd/MMM/yyyy"),this.Parent.ViewTransactionHistory.TransactionHisInfo[e].OldValue=this.currentvalue,this.Parent.ViewTransactionHistory.TransactionHisInfo[e].ChangeType=this.Type.SelectedValue,this.Parent.ViewTransactionHistory.TransactionHisInfo[e].Percentage="2"==this.Type.SelectedValue||"3"==this.Type.SelectedValue?this.value.toString()+"%":this.value,this.Parent.ViewTransactionHistory.TransactionHisInfo[e].NewValue="0"==this.Type.SelectedValue?this.currentvalue+this.value:"1"==this.Type.SelectedValue?this.currentvalue-this.value:"2"==this.Type.SelectedValue?this.currentvalue<0?this.currentvalue-this.currentvalue*(this.value/100):this.currentvalue+this.currentvalue*(this.value/100):"3"==this.Type.SelectedValue?this.currentvalue<0?this.currentvalue+this.currentvalue*(this.value/100):this.currentvalue-this.currentvalue*(this.value/100):this.currentvalue,n.e.IsEmpty(this.UpdatedValue)?this.Parent.CurrentValueCallBack(this.currentvalue):this.Parent.CurrentValueCallBack(parseFloat(this.UpdatedValue)),this.Date.Date=Date.Today(),this.Location.SelectedValue=0,this.Type.SelectedValue="0",this.Value.Text="",this.UpdatedValue="",void(this.Remarks.Text="")}})}}CalculateAssetSchedule(){if(this.Value.Visible){if(0==n.e.IsNum(this.Value.Text))return this.DisplayMessage="Only Numeric Characters allowed in Value",null;if(null==this.Value.Text||""==this.Value.Text||""==this.Value.Text.Trim())return this.DisplayMessage="Enter Value",null}if(this.Date.Date<this.Parent.CDeprStartDate.Date)return this.DisplayMessage="Date should not be less than "+this.Parent.CDeprStartDate.Label,null;if("1"==this.PostJV.SelectedValue){if(this.DebitAccount.Visible&&0==this.DebitAccount.SelectedValue)return this.DisplayMessage="Select Debit Account",null;if(this.CreditAccount.Visible&&0==this.CreditAccount.SelectedValue)return this.DisplayMessage="Select Credit Account",null}this.ChangeID>0&&(this.IsModified=!0),this.value=n.e.Double(this.Value.Text);let e=this.Parent.GetDeprStartValue();this.SalValue="2"==this.Parent.DeprSalvage.Currency.SelectedValue?n.e.IsEmptySpace(this.Parent.DeprSalvage.ExchangeRate.Text)||"0"==this.Parent.DeprSalvage.ExchangeRate.Text?"0":(parseFloat(this.Parent.DeprSalvage.ExchangeRate.Text)*e/100).toString():this.Parent.DeprSalvage.ExchangeRate.Text,this.PeriodField=this.Parent.DeprPeriod.SelectedValue,this.DepreciationMethod=this.Parent.DeprMethod.SelectedValue,this.AveragingMethod=this.Parent.DeprAvgMethod.SelectedValue,this.NetAssetValue=this.currentvalue.toString(),this.objAsset.IsIncreaseAssetValue=!1,"1"==this.Type.SelectedValue?this.value=-this.value:"2"==this.Type.SelectedValue?this.value=this.currentvalue*(this.value/100):"3"==this.Type.SelectedValue?this.value=this.value/100*-this.currentvalue:"0"==this.Type.SelectedValue&&(this.objAsset.IsIncreaseAssetValue=!0),this.objAsset.PostAssetID=this.Parent.AssetID,this.objAsset.ChangeValueTypeID=parseInt(this.Type.SelectedValue),this.objAsset.ChangeVal=this.value,this.objAsset.AssetNetValueChange=this.currentvalue,this.objAsset.Description=this.Remarks.Text;let t=new f.a;t.Date=this.Date.Date,t.Value=this.value;let s=new f.b(this.Parent.AssetID);return"25"==this.Type.SelectedValue&&(s.NewEsitmateLife=this.RemiainingLife,s.NewEsitmateEndDate=this.NewEsitmateEndDate.Date),s.GetScheduleData(e,0,0,0,null,0,parseFloat(this.SalValue),this.DepreciationMethod,this.PeriodField,0,this.AveragingMethod,this.Parent.CDeprStartDate.Date,this.Parent.CDeprEndDate.Date,t,this.Parent.DeprBook.SelectedValue.toString()),this.dtDepr=s.dtDepr,s.ErrorMessage.length>0?(this.DisplayMessage=s.ErrorMessage,null):s}GetJVXML(){let e="",t=this.Parent.GetCCXML();return e+="<JVXML>",e+="<ROWS><DocumentXML>",e+='<Row> <Transactions DocSeqNo="1"  DocDetailsID="0" LinkedInvDocDetailsID="" LinkedFieldName="" DebitAccount="'+this.DebitAccount.SelectedValue.toString()+'" CreditAccount="-99" Amount="'+this.value.toString()+'" AmtFc="'+this.value.toString()+'" CurrencyID="1" ExchangeRate="1" LineNarration="Depreciation Change Value Posting" CommonNarration="Depreciation Change Value Posting"  >',e+="</Transactions>",e+=" <Numeric /> <Alpha />"+t+"<EXTRAXML/>",e+=' </Row><Row> <Transactions DocSeqNo="2"  DocDetailsID="0" LinkedInvDocDetailsID="" LinkedFieldName="" DebitAccount="-99" CreditAccount="'+this.CreditAccount.SelectedValue.toString()+'" Amount="'+this.value.toString()+'" AmtFc="'+this.value.toString()+'" CurrencyID="1" ExchangeRate="1" LineNarration="Depreciation Change Value  Posting" CommonNarration="Depreciation Change Value Posting"  >',e+="</Transactions>",e+=" <Numeric /> <Alpha />"+t+"<EXTRAXML/>",e+=" </Row>",e+="</DocumentXML></ROWS>",this.JVOK=!0,e+="</JVXML>",Logger.InfoLog("DepreciattionScheduleViewModel ::Exiting GetReceiptXML"),e.toString()}OnTypeChanged(e){"25"==this.Type.SelectedValue?(this.NewEsitmateLife.Label=this.Parent.EstimateLife.Label,this.NewEsitmateLife.Text=this.Parent.EstimateLife.Text,this.NewEsitmateEndDate.Label=this.Parent.CDeprEndDate.Label,this.NewEsitmateEndDate.Date=this.Parent.CDeprEndDate.Date,this.Value.Visible=!1,this.DebitAccount.Visible=!1,this.CreditAccount.Visible=!1,this.PostJV.Visible=!1,this.NewEsitmateLife.Visible=!0,this.NewEsitmateEndDate.Visible=!0):(this.Value.Visible=!0,this.DebitAccount.Visible=!0,this.CreditAccount.Visible=!0,this.PostJV.Visible=!0,this.NewEsitmateLife.Visible=!1,this.NewEsitmateEndDate.Visible=!1),this.OnDateChanged(null)}OnDateChanged(e){this.CalculateCurrentValue("Date"),"25"==this.Type.SelectedValue&&this.OnEsitmateLifeChange(null)}OnTextChange(e){this.CalculateCurrentValue(e)}CalculateCurrentValue(e){if(null==e||"Value"!=e.toString()&&"Date"!=e.toString())return;let t=0,s=this.dtDepr.filter(e=>new Date(e.ToDate)<this.Date.Date.OnlyDate());s.SortBy(["FromDate"]),this.dtDepr.length>0?s.length>0?this.currentvalue=parseFloat(s[s.length-1].NetValue):(s=this.dtDepr.filter(e=>new Date(e.FromDate)>=this.Date.Date.OnlyDate()),s.SortBy(["FromDate"]),s.length>0&&(this.currentvalue=parseFloat(s[0].PurchaseValue))):this.currentvalue=this.Parent.GetDeprStartValue(),t=n.e.Double(this.Value.Text),this.UpdatedValue="0"==this.Type.SelectedValue?null!=this.Value.Text&&""!=this.Value.Text?(this.currentvalue+t).toString():this.currentvalue.toString():"1"==this.Type.SelectedValue?null!=this.Value.Text&&""!=this.Value.Text?(this.currentvalue-t).toString():this.currentvalue.toString():"2"==this.Type.SelectedValue?null!=this.Value.Text&&""!=this.Value.Text?this.currentvalue<0?(this.currentvalue-this.currentvalue*(t/100)).toString():(this.currentvalue+this.currentvalue*(t/100)).toString():this.currentvalue.toString():"3"==this.Type.SelectedValue&&null!=this.Value.Text&&""!=this.Value.Text?this.currentvalue<0?(this.currentvalue+this.currentvalue*(t/100)).toString():(this.currentvalue-this.currentvalue*(t/100)).toString():this.currentvalue.toString(),this.UpdatedValue=parseFloat(this.UpdatedValue).ToString("N"+a.a.SessionManager.Preferences.DecimalsinAmount),this.OldValue=this.currentvalue.toString()}OnEsitmateLifeChange(e){if(n.e.IsEmpty(this.NewEsitmateLife.Text))return;let t=Date.Today(),s=(Date.Today(),0),i=0,a=0,o=this.NewEsitmateLife.Text.split(".");s=n.e.Int(o[0]),o.length>1&&(i=n.e.Int(o[1])),o.length>2&&(a=n.e.Int(o[2])),this.NewEsitmateEndDate.Date=this.Parent.CDeprStartDate.Date.AddYears(s),this.NewEsitmateEndDate.Text=this.NewEsitmateEndDate.Date.AddYears(s).toString(),i>0&&(this.NewEsitmateEndDate.Date=this.NewEsitmateEndDate.Date.AddMonths(i)),a>0&&(this.NewEsitmateEndDate.Date=this.NewEsitmateEndDate.Date.AddDays(a));let l=0,r=0,h=0;for(t=this.Date.Date;t.AddYears(1)<=this.NewEsitmateEndDate.Date;)t=t.AddYears(1),l++;for(let n=11;n>=1;n--)if(t.AddMonths(n)<=this.NewEsitmateEndDate.Date){r=n,t=t.AddMonths(n);break}h=this.NewEsitmateEndDate.Date.Subtract(t).Days,this.RemiainingLife=l.toString(),(r>0||h>0)&&(this.RemiainingLife+="."+r,h>0&&(this.RemiainingLife+="."+h))}}class F extends l.b{constructor(e){super(),this.currentvalue=0,this.Parent=null,this.EstLife="",this.PeriodField="",this.SalValue="",this.PurValue="",this.DepreciationMethod="",this.AvgMethod="",this.DeprStartDate=Date.Today(),this.objAsset={},this.ChangeID=0,this.DeprMethod=new h.e(0),this.AveragingMethod=new h.e(0),this.DeprType=new h.e(0),this.Date=new c.a(0),this.EndDate=new c.a(0),this.CurrentValue=new u.d(0),this.Salvage=new u.d(0),this.Estimatedlife=new u.d(0),this.IsModified=!1,this.value=0,this.NetAssetValue="",this.dtDepr=[],this.Parent=e,"1"==this.Parent.DeprSchedule.SelectedValue&&(this.MessageVisibility=!0,this.DisplayMessage="Schedule already exists"),this.CurrentValue.Text=this.Parent.NetValue.Text,this.Estimatedlife.Text=e.EstLife,this.Salvage.Text=e.SalValue,this.AveragingMethod.Items.push(h.d.ComboBoxItems_2(a.a.GetResource("DeprBook_CalendarDays"),"1")),this.AveragingMethod.Items.push(h.d.ComboBoxItems_2(a.a.GetResource("DeprBook_FullMonth"),"2")),this.AveragingMethod.SelectedValue=e.DeprAvgMethod.SelectedValue,this.DeprMethod.Items.push(h.d.ComboBoxItems_2("Straight Line","1")),this.DeprMethod.Items.push(h.d.ComboBoxItems_2("Written Down Value","0")),this.DeprMethod.SelectedValue=e.DeprMethod.SelectedValue,this.DeprType.Items.push(h.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_Monthly"),"1")),this.DeprType.Items.push(h.d.ComboBoxItems_2(a.a.GetResource("Budget_Quarterly"),"3")),this.DeprType.Items.push(h.d.ComboBoxItems_2(a.a.GetResource("Budget_Halfyearely"),"4")),this.DeprType.Items.push(h.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_Yearly"),"2")),this.DeprType.SelectedValue=e.DeprPeriod.SelectedValue,this.Date.Date=new Date(e.DepSDate),this.EndDate.Date=new Date(e.DepEDate)}OnSaveValue(e){if("Cancel"==e)this.Parent.AssetScheduleDeprVisibility=!1,this.Parent.DetailsVisibility=!0;else{if("1"==this.Parent.DeprSchedule.SelectedValue)return this.MessageVisibility=!0,void(this.DisplayMessage="Schedule already exists");{let e;if(this.objAsset.AMAssetID=this.Parent.AssetID,this.objAsset.AMCode=this.Parent.Code.Text,this.objAsset.AMName=this.Parent.Name.Text,this.objAsset.AMStatusID=parseInt(this.Parent.Status.SelectedValue),this.objAsset.AMParentAssetID=this.Parent.ParentAsset.SelectedValue,this.objAsset.DetailsXML="",this.objAsset.CustomFieldsQuery="",this.objAsset.CustomCostCenterFieldsQuery="",this.objAsset.ChangeValueXML="",this.objAsset.HistoryXML="",this.objAsset.AMPurchaseValue=this.CurrentValue.Text,this.objAsset.DepreciationXML=this.GetDepreciationXML(this.Estimatedlife.Text,this.Salvage.Text,this.DeprType.SelectedValue,this.Date.Date,this.DeprMethod.SelectedValue,this.AveragingMethod.SelectedValue),this.objAsset.NotesXML="",this.objAsset.AttachmetsXML="",this.objAsset.AMGUID=this.Parent.GUID,e>0)return void(this.MessageVisibility=!0)}}}GetDepreciationXML(e,t,s,i,a,n){let o=0,l=0,r=this.objAsset.GetAssetManagementDetails(this.Parent.AssetID);null!=r&&r.Tables.length>10&&(this.dtDepr=r.Tables[10]);try{""!=this.CurrentValue.Text&&(l=parseFloat(this.CurrentValue.Text))}catch(c){}try{o=parseFloat(e)}catch(u){}if(l<=0)return this.DisplayMessage="Enter PurchaseValue in PurchaseDetail Tab","";if(o<=0)return this.DisplayMessage="Enter EstimatedLife in PurchaseDetail Tab","";let h=i;if(this.Parent.AssetID>0){let e;null!=this.dtDepr&&this.dtDepr.length>0&&(e=this.dtDepr.filter(e=>Object(A.isNullOrUndefined)(e.DocID)),e.length>0&&(h=new Date(e[0].FromDate)))}return""}}var B=s("Q01V");class W extends I.c{constructor(e){super(),this.ColumnSpan=4,this.TransactionHisInfoObj=new d.a,this.TColumnSource=new Array,this.ExchList=new Array,this.Module="ASS",this.ClassName="ViewTransactionHistory",this.Parent=e,this.TransactionHisInfoObj.Height=200,this.TransactionHisInfoObj.Table=[],this.TransactionHisInfoObj.TableColumns.push("Type"),this.TransactionHisInfoObj.TableColumns.push("Date"),this.TransactionHisInfoObj.TableColumns.push("OldValue"),this.TransactionHisInfoObj.TableColumns.push("Percentage"),this.TransactionHisInfoObj.TableColumns.push("NewValue"),this.TransactionHisInfoObj.TableColumns.push("ChangeType"),this.TransactionHisInfoObj.TableColumns.push("CreatedDate"),this.AddHistoryGridColumns()}get TransactionHisInfo(){return this.TransactionHisInfoObj.Table}get angularGrid(){return this.TransactionHisInfoObj.angularGrid}OnChangeValue(e){this.Parent.OnAddValue()}AddHistoryGridColumns(){let e;e=new b.a,e.DisplayMember="Type",e.Header=a.a.GetResource("Type"),e.Width=250,e.ReadOnly=!0,this.TColumnSource.push(e),e=new b.a,e.DisplayMember="Date",e.Header=a.a.GetResource("Date"),e.Width=150,e.ReadOnly=!0,this.TColumnSource.push(e),e=new b.a,e.DisplayMember="OldValue",e.Header=a.a.GetResource("Old Value"),e.Width=150,e.ReadOnly=!0,this.TColumnSource.push(e),e=new b.a,e.DisplayMember="Percentage",e.Header=a.a.GetResource("+/-"),e.Width=100,e.ReadOnly=!0,this.TColumnSource.push(e),e=new b.a,e.DisplayMember="NewValue",e.Header=a.a.GetResource("New Value"),e.Width=150,e.ReadOnly=!0,this.TColumnSource.push(e),e=new b.a,e.DisplayMember="CreatedDate",e.Header=a.a.GetResource("CreatedDate"),e.Width=150,e.ReadOnly=!0,this.TColumnSource.push(e),this.TransactionHisInfoObj.Columns=this.TColumnSource}LoadValueInfo(e,t){if(e.length>0){for(let s=0;s<e.length;s++)this.TransactionHisInfoObj.addEmptyRow(),this.TransactionHisInfo[s].Type=e[s].ChangeName.toString(),this.TransactionHisInfo[s].Date=new Date(e[s].Date.toString()).ToString("dd/MMM/yyyy"),this.TransactionHisInfo[s].OldValue=e[s].AssetOldValue.toString(),this.TransactionHisInfo[s].Percentage=e[s].ChangeValue.toString(),this.TransactionHisInfo[s].NewValue=e[s].AssetNewValue.toString(),this.TransactionHisInfo[s].ChangeType=e[s].ChangeType.toString(),t.Contains("CreatedDt")&&(this.TransactionHisInfo[s].CreatedDate=new Date(e[s].CreatedDt.toString()).ToString("dd/MMM/yyyy"));this.TransactionHisInfoObj.refreshDataView()}}}class H extends l.b{constructor(e){super(),this.ColumnSpan="4",this.InsuranceCovered=new h.e(26411),this.Vendor=new p.b(26412),this.PolicyNo=new u.d(26416),this.Type=new u.d(26415),this.Effectivedate=new c.a(26413),this.ExpiryDate=new c.a(26414),this.InsurancePremium=new u.d(26417),this.PolicyCoverage=new u.d(26418),this.parent=e,this.InsuranceCovered.Items.push(h.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_Yes"),"1")),this.InsuranceCovered.Items.push(h.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_No"),"0")),this.InsuranceCovered.SelectedValue="1"}}class _ extends l.b{constructor(e){super(),this.ColumnSpan="4",this.MaintenanceCovered=new h.e(26406),this.Vendor=new p.b(26409),this.NextServiceDate=new c.a(26410),this.StartDate=new c.a(26407),this.ExpiryDate=new c.a(26408),this.parent=e,this.MaintenanceCovered.Items.push(h.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_Yes"),"1")),this.MaintenanceCovered.Items.push(h.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_No"),"0")),this.MaintenanceCovered.SelectedValue="1"}}var X=s("3Pt+"),J=s("q8k3");let U=(()=>{class e{constructor(){this.form=new X.j({})}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=G.Nb({type:e,selectors:[["app-depreciation-filter"]],decls:30,vars:10,consts:[[1,"dialogSubBody",2,"width","360px"],[1,"row","form-row"],[1,"col","PACTControl",2,"margin-right","30px"],["FieldDirective","",3,"obj","group"],[1,"col","PACTControl"],[1,"Pactdailogfooter",2,"border-top-width","0px"],[1,"primary-btn-wicon",3,"click"],[1,"secondary-btn-wicon",3,"click"],[1,"fa-light","fa-rectangle-xmark"]],template:function(e,t){1&e&&(G.Zb(0,"div",0),G.Wc(1,"\n    "),G.Zb(2,"div",1),G.Wc(3,"\n        "),G.Zb(4,"div",2),G.Wc(5,"\n            "),G.Vb(6,3),G.Wc(7,"\n        "),G.Yb(),G.Wc(8,"\n        "),G.Zb(9,"div",4),G.Wc(10,"\n            "),G.Vb(11,3),G.Wc(12,"\n        "),G.Yb(),G.Wc(13,"\n    "),G.Yb(),G.Wc(14,"\n    "),G.Zb(15,"div",5),G.Wc(16,"\n        "),G.Zb(17,"div"),G.Wc(18,"\n            "),G.Zb(19,"button",6),G.hc("click",(function(){return t.obj.OnClick("OK")})),G.Wc(20),G.mc(21,"translate"),G.Yb(),G.Wc(22,"\n            "),G.Zb(23,"button",7),G.hc("click",(function(){return t.obj.OnClick("Cancel")})),G.Ub(24,"i",8),G.Wc(25),G.mc(26,"translate"),G.Yb(),G.Wc(27,"\n        "),G.Yb(),G.Wc(28,"\n    "),G.Yb(),G.Wc(29," \n"),G.Yb()),2&e&&(G.Db(6),G.tc("obj",t.obj.FromDate)("group",t.form),G.Db(5),G.tc("obj",t.obj.ToDate)("group",t.form),G.Db(9),G.Xc(G.nc(21,6,"Com_OK")),G.Db(5),G.Xc(G.nc(26,8,"Cancel")))},directives:[J.a],pipes:[L.d],encapsulation:2}),e})();class Y extends l.b{constructor(e,t,s=!1){super(),this.oparent=null,this.FromDate=new c.a(0),this.ToDate=new c.a(0),this.IsEstimateLif=!1,this.IsEstimateLif=s,this.FromDate.Label=a.a.GetResource("DocumentDesigner_FromDate"),this.ToDate.Label=a.a.GetResource("DocumentDesigner_ToDate"),this.oparent=e,this.FromDate.Width=this.ToDate.Width="140",s?(this.Title=this.oparent.EstimateLife.Label,this.FromDate.Date=this.oparent.CDeprStartDate.Date?this.oparent.CDeprStartDate.Date:Date.Today(),this.ToDate.Date=this.oparent.CDeprEndDate.Date?this.oparent.CDeprEndDate.Date:Date.Today().AddYears(1)):(this.Title=a.a.GetResource("DepreciationFilter"),this.FromDate.Date=t.OnlyDate())}OnClick(e){"OK"==e?this.IsEstimateLif?(this.oparent.CDeprStartDate.Date=this.FromDate.Date,this.oparent.CDeprEndDate.Date=this.ToDate.Date,this.oparent.EstLife=f.b.CalculateEstimateLife(this.oparent.CDeprStartDate.Date,this.oparent.CDeprEndDate.Date),this.oparent.EstimateLife.Text=this.oparent.EstLife):(this.oparent.DeprFilterCheck=0,this.oparent.DeprFromDate=this.FromDate.Date,this.oparent.DeprToDate=this.ToDate.Date):this.oparent.DeprFilterCheck=1,a.a.page.HideDialog()}}class Z extends d.a{constructor(e){super(),this.Module="ASS",this.ClassName="AssetTabGrid",this.IsColumnUserDefined=!1,this.Height=180,this.Parent=e}}function Q(e,t){if(1&e&&(G.Zb(0,"div",10),G.Wc(1,"\n            "),G.Vb(2,4),G.Wc(3,"\n        "),G.Yb()),2&e){const e=G.lc();G.Db(2),G.tc("obj",e.obj.Type)("group",e.group)}}function K(e,t){if(1&e&&(G.Zb(0,"div",10),G.Wc(1,"\n            "),G.Vb(2,4),G.Wc(3,"\n        "),G.Yb()),2&e){const e=G.lc();G.Db(2),G.tc("obj",e.obj.OldValueObj)("group",e.group)}}function q(e,t){if(1&e&&(G.Zb(0,"div",10),G.Wc(1,"\n            "),G.Vb(2,4),G.Wc(3,"\n        "),G.Yb()),2&e){const e=G.lc();G.Db(2),G.tc("obj",e.obj.Value)("group",e.group)}}function z(e,t){if(1&e&&(G.Zb(0,"div",10),G.Wc(1,"\n            "),G.Vb(2,4),G.Wc(3,"\n        "),G.Yb()),2&e){const e=G.lc();G.Db(2),G.tc("obj",e.obj.UpdatedValueObj)("group",e.group)}}function $(e,t){if(1&e&&(G.Zb(0,"div",10),G.Wc(1,"\n            "),G.Vb(2,4),G.Wc(3,"\n        "),G.Yb()),2&e){const e=G.lc();G.Db(2),G.tc("obj",e.obj.NewEsitmateLife)("group",e.group)}}function ee(e,t){if(1&e&&(G.Zb(0,"div",10),G.Wc(1,"\n            "),G.Vb(2,4),G.Wc(3,"\n        "),G.Yb()),2&e){const e=G.lc();G.Db(2),G.tc("obj",e.obj.NewEsitmateEndDate)("group",e.group)}}function te(e,t){if(1&e&&(G.Zb(0,"div",10),G.Wc(1,"\n            "),G.Vb(2,4),G.Wc(3,"\n        "),G.Yb()),2&e){const e=G.lc();G.Db(2),G.tc("obj",e.obj.RemiainingLifeObj)("group",e.group)}}function se(e,t){if(1&e&&(G.Zb(0,"div",10),G.Wc(1,"\n            "),G.Vb(2,4),G.Wc(3,"\n        "),G.Yb()),2&e){const e=G.lc();G.Db(2),G.tc("obj",e.obj.Remarks)("group",e.group)}}function ie(e,t){if(1&e&&(G.Zb(0,"div",10),G.Wc(1,"\n            "),G.Vb(2,4),G.Wc(3,"\n        "),G.Yb()),2&e){const e=G.lc();G.Db(2),G.tc("obj",e.obj.DebitAccount)("group",e.group)}}function ae(e,t){if(1&e&&(G.Zb(0,"div",10),G.Wc(1,"\n            "),G.Vb(2,4),G.Wc(3,"\n        "),G.Yb()),2&e){const e=G.lc();G.Db(2),G.tc("obj",e.obj.CreditAccount)("group",e.group)}}function ne(e,t){if(1&e&&(G.Zb(0,"div",10),G.Wc(1,"\n            "),G.Vb(2,4),G.Wc(3,"\n        "),G.Yb()),2&e){const e=G.lc();G.Db(2),G.tc("obj",e.obj.PostJV)("group",e.group)}}let oe=(()=>{class e{constructor(){this.group=new X.j({})}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=G.Nb({type:e,selectors:[["app-change-value"]],decls:52,vars:19,consts:[[1,"master-screen"],[1,"PACTHeaderFields","dialogSubBody"],[1,"form-group","col","PACTControl",2,"display","flex"],[2,"display","block","width","180px"],["FieldDirective","",3,"obj","group"],[1,"quicklink",2,"position","absolute","bottom","10px","left","200px",3,"click"],["class","form-group col PACTControl",4,"ngIf"],[1,"Pactdailogfooter"],[1,"primary-btn-wicon",3,"click"],[1,"secondary-btn-wicon",3,"click"],[1,"form-group","col","PACTControl"]],template:function(e,t){1&e&&(G.Zb(0,"div",0),G.Wc(1,"\n    "),G.Zb(2,"div",1),G.Wc(3,"\n        "),G.Zb(4,"div",2),G.Wc(5,"\n            "),G.Zb(6,"div",3),G.Wc(7,"\n                "),G.Vb(8,4),G.Wc(9,"\n            "),G.Yb(),G.Wc(10,"\n            "),G.Zb(11,"span",5),G.hc("click",(function(){return t.obj.OnSaveValue("Schedule")})),G.Wc(12,"Show Schedule"),G.Yb(),G.Wc(13,"\n        "),G.Yb(),G.Wc(14,"\n        "),G.Uc(15,Q,4,2,"div",6),G.Wc(16,"\n        "),G.Uc(17,K,4,2,"div",6),G.Wc(18,"\n        "),G.Uc(19,q,4,2,"div",6),G.Wc(20,"\n        "),G.Uc(21,z,4,2,"div",6),G.Wc(22,"\n        "),G.Uc(23,$,4,2,"div",6),G.Wc(24,"\n        "),G.Uc(25,ee,4,2,"div",6),G.Wc(26,"\n        "),G.Uc(27,te,4,2,"div",6),G.Wc(28,"\n        "),G.Uc(29,se,4,2,"div",6),G.Wc(30,"\n        "),G.Uc(31,ie,4,2,"div",6),G.Wc(32,"\n        "),G.Uc(33,ae,4,2,"div",6),G.Wc(34,"\n        "),G.Uc(35,ne,4,2,"div",6),G.Wc(36,"\n  "),G.Yb(),G.Wc(37,"\n  "),G.Zb(38,"div",7),G.Wc(39,"\n    "),G.Zb(40,"div"),G.Wc(41,"\n        "),G.Zb(42,"button",8),G.hc("click",(function(){return t.obj.OnSaveValue("Ok")})),G.Wc(43),G.mc(44,"translate"),G.Yb(),G.Wc(45,"\n        "),G.Zb(46,"button",9),G.hc("click",(function(){return t.obj.OnSaveValue("Cancel")})),G.Wc(47),G.mc(48,"translate"),G.Yb(),G.Wc(49,"\n    "),G.Yb(),G.Wc(50,"      \n  "),G.Yb(),G.Wc(51,"\n"),G.Yb()),2&e&&(G.Db(8),G.tc("obj",t.obj.Date)("group",t.group),G.Db(7),G.tc("ngIf",t.obj.Type.Visible),G.Db(2),G.tc("ngIf",t.obj.Value.Visible),G.Db(2),G.tc("ngIf",t.obj.Value.Visible),G.Db(2),G.tc("ngIf",t.obj.Value.Visible),G.Db(2),G.tc("ngIf",t.obj.NewEsitmateLife.Visible),G.Db(2),G.tc("ngIf",t.obj.NewEsitmateEndDate.Visible),G.Db(2),G.tc("ngIf",t.obj.NewEsitmateLife.Visible),G.Db(2),G.tc("ngIf",t.obj.Remarks.Visible),G.Db(2),G.tc("ngIf",t.obj.DebitAccount.Visible),G.Db(2),G.tc("ngIf",t.obj.CreditAccount.Visible),G.Db(2),G.tc("ngIf",t.obj.PostJV.Visible),G.Db(8),G.Xc(G.nc(44,15,"Ok")),G.Db(4),G.Xc(G.nc(48,17,"Cancel")))},directives:[J.a,N.t],pipes:[L.d],encapsulation:2}),e})();function le(e,t){if(1&e&&(G.Zb(0,"div",9),G.Wc(1,"\n            "),G.Vb(2,3),G.Wc(3,"\n        "),G.Yb()),2&e){const e=G.lc();G.Db(2),G.tc("obj",e.obj.Type)("group",e.group)}}function re(e,t){if(1&e&&(G.Zb(0,"div",9),G.Wc(1,"\n            "),G.Vb(2,3),G.Wc(3,"\n        "),G.Yb()),2&e){const e=G.lc();G.Db(2),G.tc("obj",e.obj.CurrentValue)("group",e.group)}}function he(e,t){if(1&e&&(G.Zb(0,"div",9),G.Wc(1,"\n            "),G.Vb(2,3),G.Wc(3,"\n        "),G.Yb()),2&e){const e=G.lc();G.Db(2),G.tc("obj",e.obj.Amount)("group",e.group)}}function ce(e,t){if(1&e&&(G.Zb(0,"div",9),G.Wc(1,"\n            "),G.Vb(2,3),G.Wc(3,"\n        "),G.Yb()),2&e){const e=G.lc();G.Db(2),G.tc("obj",e.obj.ChangedValue)("group",e.group)}}function ue(e,t){if(1&e&&(G.Zb(0,"div",9),G.Wc(1,"\n            "),G.Vb(2,3),G.Wc(3,"\n        "),G.Yb()),2&e){const e=G.lc();G.Db(2),G.tc("obj",e.obj.Remarks)("group",e.group)}}function De(e,t){if(1&e&&(G.Zb(0,"div",9),G.Wc(1,"\n            "),G.Vb(2,3),G.Wc(3,"\n        "),G.Yb()),2&e){const e=G.lc();G.Db(2),G.tc("obj",e.obj.DebitAccount)("group",e.group)}}function de(e,t){if(1&e&&(G.Zb(0,"div",9),G.Wc(1,"\n            "),G.Vb(2,3),G.Wc(3,"\n        "),G.Yb()),2&e){const e=G.lc();G.Db(2),G.tc("obj",e.obj.CreditAccount)("group",e.group)}}function be(e,t){if(1&e&&(G.Zb(0,"div",9),G.Wc(1,"\n            "),G.Vb(2,3),G.Wc(3,"\n        "),G.Yb()),2&e){const e=G.lc();G.Db(2),G.tc("obj",e.obj.GainAccount)("group",e.group)}}function pe(e,t){if(1&e&&(G.Zb(0,"div",9),G.Wc(1,"\n            "),G.Vb(2,3),G.Wc(3,"\n        "),G.Yb()),2&e){const e=G.lc();G.Db(2),G.tc("obj",e.obj.LossAccount)("group",e.group)}}function me(e,t){if(1&e&&(G.Zb(0,"div",9),G.Wc(1,"\n            "),G.Vb(2,3),G.Wc(3,"\n        "),G.Yb()),2&e){const e=G.lc();G.Db(2),G.tc("obj",e.obj.DisposeClearingAccount)("group",e.group)}}function Se(e,t){if(1&e&&(G.Zb(0,"div",9),G.Wc(1,"\n            "),G.Vb(2,3),G.Wc(3,"\n        "),G.Yb()),2&e){const e=G.lc();G.Db(2),G.tc("obj",e.obj.PostJV)("group",e.group)}}let ge=(()=>{class e{constructor(){this.group=new X.j({})}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=G.Nb({type:e,selectors:[["app-add-disposal-grid-data"]],decls:47,vars:19,consts:[[1,"master-screen"],[1,"PACTHeaderFields","dialogSubBody"],[1,"form-group","col","PACTControl",2,"width","150px"],["FieldDirective","",3,"obj","group"],["class","form-group col PACTControl",4,"ngIf"],[1,"Pactdailogfooter"],[1,"primary-btn-wicon",3,"click"],[1,"secondary-btn-wicon",3,"click"],[1,"fa-light","fa-rectangle-xmark"],[1,"form-group","col","PACTControl"]],template:function(e,t){1&e&&(G.Zb(0,"div",0),G.Wc(1,"\n    "),G.Zb(2,"div",1),G.Wc(3,"\n        "),G.Zb(4,"div",2),G.Wc(5,"\n          "),G.Vb(6,3),G.Wc(7,"\n        "),G.Yb(),G.Wc(8,"\n        "),G.Uc(9,le,4,2,"div",4),G.Wc(10,"\n        "),G.Uc(11,re,4,2,"div",4),G.Wc(12,"\n        "),G.Uc(13,he,4,2,"div",4),G.Wc(14,"\n        "),G.Uc(15,ce,4,2,"div",4),G.Wc(16,"\n        "),G.Uc(17,ue,4,2,"div",4),G.Wc(18,"\n        "),G.Uc(19,De,4,2,"div",4),G.Wc(20,"\n        "),G.Uc(21,de,4,2,"div",4),G.Wc(22,"\n        "),G.Uc(23,be,4,2,"div",4),G.Wc(24,"\n        "),G.Uc(25,pe,4,2,"div",4),G.Wc(26,"\n        "),G.Uc(27,me,4,2,"div",4),G.Wc(28,"\n        "),G.Uc(29,Se,4,2,"div",4),G.Wc(30,"\n  "),G.Yb(),G.Wc(31,"\n  "),G.Zb(32,"div",5),G.Wc(33,"\n    "),G.Zb(34,"div"),G.Wc(35,"\n        "),G.Zb(36,"button",6),G.hc("click",(function(){return t.obj.OnButtonClick("Ok")})),G.Wc(37),G.mc(38,"translate"),G.Yb(),G.Wc(39,"\n        "),G.Zb(40,"button",7),G.hc("click",(function(){return t.obj.OnButtonClick("Cancel")})),G.Ub(41,"i",8),G.Wc(42),G.mc(43,"translate"),G.Yb(),G.Wc(44,"\n    "),G.Yb(),G.Wc(45,"      \n  "),G.Yb(),G.Wc(46,"\n"),G.Yb()),2&e&&(G.Db(6),G.tc("obj",t.obj.Date)("group",t.group),G.Db(3),G.tc("ngIf",t.obj.Type.Visible),G.Db(2),G.tc("ngIf",t.obj.CurrentValue.Visible),G.Db(2),G.tc("ngIf",t.obj.Amount.Visible),G.Db(2),G.tc("ngIf",t.obj.ChangedValue.Visible),G.Db(2),G.tc("ngIf",t.obj.Remarks.Visible),G.Db(2),G.tc("ngIf",t.obj.DebitAccount.Visible),G.Db(2),G.tc("ngIf",t.obj.CreditAccount.Visible),G.Db(2),G.tc("ngIf",t.obj.GainAccount.Visible),G.Db(2),G.tc("ngIf",t.obj.LossAccount.Visible),G.Db(2),G.tc("ngIf",t.obj.DisposeClearingAccount.Visible),G.Db(2),G.tc("ngIf",t.obj.PostJV.Visible),G.Db(8),G.Xc(G.nc(38,15,"Ok")),G.Db(5),G.Xc(G.nc(43,17,"Cancel")))},directives:[J.a,N.t],pipes:[L.d],encapsulation:2}),e})();var Ce=s("wlFP");function Te(e,t){if(1&e){const e=G.ac();G.Zb(0,"span",16),G.hc("click",(function(){return G.Ic(e),G.lc().obj.OnSave("Add")})),G.Ub(1,"i",17),G.Yb()}}function Ae(e,t){if(1&e){const e=G.ac();G.Zb(0,"span",16),G.hc("click",(function(){return G.Ic(e),G.lc().obj.OnSave("Import")})),G.Ub(1,"i",18),G.Yb()}}function Ie(e,t){if(1&e){const e=G.ac();G.Zb(0,"span",16),G.hc("click",(function(){return G.Ic(e),G.lc().obj.OnRemove("Remove")})),G.Ub(1,"i",19),G.Yb()}}let Ve=(()=>{class e{constructor(){this.form=new X.j({})}ngOnInit(){console.log(this.obj.GridDataObj)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=G.Nb({type:e,selectors:[["app-asset-serial-no"]],decls:59,vars:14,consts:[[1,"master-screen",2,"padding-bottom","4px","width","450px"],[1,"PACTHeaderFields","dialogSubBody","dialogCtrlPadding"],[1,"row","form-row"],[1,"form-group","col","PACTctrl"],["FieldDirective","",3,"obj"],[1,"form-group","col","col-xs-12"],[2,"display","flex"],[1,"btnMetroDiv","secondary-btn-group",2,"float","unset","margin","auto"],["class","secondary-btn-wicon","style","margin: 3px;",3,"click",4,"ngIf"],[1,"row","form-row",2,"width","100%"],[2,"width","100%",3,"obj"],[2,"font-weight","bold"],[1,"Pactdailogfooter"],[1,"primary-btn-wicon",3,"click"],[1,"fa-light","fa-floppy-disk"],[1,"secondary-btn-wicon",3,"click"],[1,"secondary-btn-wicon",2,"margin","3px",3,"click"],[1,"fa-light","fa-plus"],[1,"fa-light","fa-file-import"],[1,"fa-light","fa-trash-alt"]],template:function(e,t){1&e&&(G.Zb(0,"div",0),G.Wc(1,"\n    "),G.Zb(2,"div",1),G.Wc(3,"\n        "),G.Zb(4,"div",2),G.Wc(5,"\n            "),G.Zb(6,"div",3),G.Wc(7,"\n                "),G.Vb(8,4),G.Wc(9,"\n            "),G.Yb(),G.Wc(10,"\n            "),G.Zb(11,"div",3),G.Wc(12,"\n                "),G.Vb(13,4),G.Wc(14,"\n            "),G.Yb(),G.Wc(15,"\n            \n            "),G.Zb(16,"div",5),G.Wc(17,"\n                "),G.Vb(18,4),G.Wc(19,"\n            "),G.Yb(),G.Wc(20,"\n        "),G.Yb(),G.Wc(21,"\n        "),G.Zb(22,"div",6),G.Wc(23,"\n            "),G.Zb(24,"div",7),G.Wc(25,"\n                "),G.Uc(26,Te,2,0,"span",8),G.Wc(27,"\n                "),G.Uc(28,Ae,2,0,"span",8),G.Wc(29,"\n                "),G.Uc(30,Ie,2,0,"span",8),G.Wc(31,"\n            "),G.Yb(),G.Wc(32,"\n        "),G.Yb(),G.Wc(33,"\n      \n      "),G.Zb(34,"div",9),G.Wc(35,"\n        "),G.Ub(36,"app-PactGridView",10),G.Wc(37,"  \n      "),G.Yb(),G.Wc(38,"\n      "),G.Zb(39,"div",11),G.Wc(40),G.Yb(),G.Wc(41,"\n    "),G.Yb(),G.Wc(42,"\n    "),G.Zb(43,"div",12),G.Wc(44,"\n      "),G.Zb(45,"div"),G.Wc(46,"\n        "),G.Zb(47,"button",13),G.hc("click",(function(){return t.obj.OnSave("Save")})),G.Ub(48,"i",14),G.Wc(49),G.mc(50,"translate"),G.Yb(),G.Wc(51,"\n        "),G.Zb(52,"button",15),G.hc("click",(function(){return t.obj.OnSave("Cancel")})),G.Wc(53),G.mc(54,"translate"),G.Yb(),G.Wc(55,"\n      "),G.Yb(),G.Wc(56,"\n  "),G.Yb(),G.Wc(57,"\n"),G.Yb(),G.Wc(58,"\n")),2&e&&(G.Db(8),G.tc("obj",t.obj.SerialNumber),G.Db(5),G.tc("obj",t.obj.Qty),G.Db(5),G.tc("obj",t.obj.Separator),G.Db(8),G.tc("ngIf",t.obj.AddVisiblility),G.Db(2),G.tc("ngIf",t.obj.AddVisiblility),G.Db(2),G.tc("ngIf",t.obj.AddVisiblility),G.Db(6),G.tc("obj",t.obj.GridDataObj),G.Db(4),G.Xc(t.obj.QtyAddMessage),G.Db(9),G.Xc(G.nc(50,10,"Save")),G.Db(4),G.Xc(G.nc(54,12,"Close")))},directives:[J.a,N.t,O.a],pipes:[L.d],encapsulation:2}),e})(),ye=(()=>{class e extends l.b{constructor(t,s){super(),this.AvailableStatusID=0,this.SoldStatusID=0,this.dtSerials=[],this.dtProdSerial=[],this.AssetCode="",this.AssetQty=0,this.DialogResult=!1,this.SerialNumber=new u.d(0),this.Qty=new u.d(0),this.Separator=new u.d(0),this.AddVisiblility=!1,this.ColumnSource=new Array,this.GridDataObj=new d.a,this.GridDataObj.Table=[],this.Qty.DataType="INT",this.Qty.Text="1",this.AssetQty=t,this.AssetCode=s,this.SerialNumber.Label=a.a.GetResource("SerialNo"),this.Qty.Label=a.a.GetResource("SerialNo_Qty"),this.Separator.Label="Separator",this.Qty.Visible=!0,this.AddVisiblility=!0,e.SearchVisibility=!1,this.Title=a.a.GetResource("SerialNo_Title");let i;a.a.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&Object(o.j)(a.a.SessionManager.Preferences.EnableDivisionWise)&&a.a.SessionManager.Preferences.ContainsKey("DW SNOS")&&Object(o.j)(a.a.SessionManager.Preferences["DW SNOS"]),a.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&Object(o.j)(a.a.SessionManager.Preferences.EnableLocationWise)&&a.a.SessionManager.Preferences.ContainsKey("LW SNOS")&&Object(o.j)(a.a.SessionManager.Preferences["LW SNOS"]),i=new b.a,i.Header=a.a.GetResource("UOM_Sno"),i.DisplayMember="Sno",i.DataType="TextBlock",i.ReadOnly=!0,i.Width=50,i.DisableTab=!0,this.ColumnSource.push(i),this.GridDataObj.TableColumns.push("Sno"),i=new b.a,i.Header=a.a.GetResource("Document_SerialNumber"),i.DisplayMember="SerialNumber",i.ReadOnly=!0,i.DataType="TextBlock",i.Width=250,this.ColumnSource.push(i),this.GridDataObj.TableColumns.push("SerialNumber"),i=new b.a,i.Header="SerialGUID",i.DisplayMember="SerialGUID",i.DataType="TextBlock",i.Width=0,i.IsVisible=!1,i.ReadOnly=!0,i.DisableTab=!0,this.ColumnSource.push(i),this.GridDataObj.TableColumns.push("SerialGUID"),this.GridDataObj.Columns=this.ColumnSource}get SelectedRow(){return this.GridDataObj.SelectedItem}get QtyAddMessage(){return n.e.IsEmpty(this._QtyAddMessage)?"asdfasdf":this._QtyAddMessage}set QtyAddMessage(e){e!=this._QtyAddMessage&&(this._QtyAddMessage=e)}get GridData(){return this.GridDataObj.Table}GridData_RowDeleted(e,t){let s=1;this.GridData.forEach(e=>{"DELETED"!=e.RowState.toString().toUpperCase()&&(e.Sno=s++)}),this.QtyAddMessage=n.e.Format(a.a.GetResource("SerialNo_AddMessage"),(s-1).toString(),this.AssetQty.toString(),this.AssetCode)}OnCheckedChanged(e,t){}OnCellEditEnding(e){if("Microsoft.Windows.Controls.DataGridCheckBoxColumn"==e.OriginalSource.Column.GetType().toString()&&"Select"==e.OriginalSource.Column.Binding.Path.Path){let e=0;this.GridData.forEach(t=>{Object(o.j)(t.Select.toString())&&e++}),this.QtyAddMessage=n.e.Format(a.a.GetResource("SerialNo_SelectMessage"),e.toString(),this.AssetQty.toString(),this.AssetCode)}}OnRemove(e){null!=this.SelectedRow&&this.GridDataObj.removeRow(this.SelectedRow)}Setselectedrow(e){this.GridDataObj.SelectedItem=this.GridData[e]}OnSave(e){if("Search"==e.toString()){if(""!=this.SerialNumber.Text){let e=0,t=1;for(null!=this.SelectedRow&&(t=this.GridData.indexOf(this.SelectedRow)+1);e<this.GridData.length;e++,t++)if(t>=this.GridData.length&&(t=1),this.GridData[t].SerialNumber.toString().Contains(this.SerialNumber.Text))return void this.Setselectedrow(t)}}else if("Save"==e.toString()){let e="",t="",s=0;t+="<xml>";for(let i=0;i<this.GridData.length;i++)if(!this.GridDataObj.TableColumns.Contains("Select")||Object(o.j)(this.GridData[i].Select.toString())){t+="<Row ";for(let e=1;e<this.ColumnSource.length;e++)t+="ComboBox"==this.ColumnSource[e].DataType?this.ColumnSource[e].ValueMember+'="'+this.GridData[i][this.GridDataObj.TableColumns[e]].toString()+'" ':this.ColumnSource[e].DisplayMember+'="'+this.GridData[i][this.GridDataObj.TableColumns[e]].toString()+'" ';t+=" ></Row>",s++,s>1&&(e+=","),e+=this.GridData[i].SerialNumber.toString()}if(t+="</xml>",this.AssetQty!=s)return this.DisplayMessage=a.a.GetResource("SerialNo_QtyMisMatch"),void(this.MessageVisibility=!0);this.DialogResult=!0,a.a.page.HideDialog()}else if("Import"==e.toString()){if(this.DisplayMessage="",this.MessageVisibility=!1,null==this.Separator.Text||""==this.Separator.Text)return this.DisplayMessage="Enter Separator",void(this.MessageVisibility=!0)}else if("Add"==e.toString()){if(null==this.SerialNumber.Text||""==this.SerialNumber.Text||""!=this.Qty.ValidateData())return;if(this.AssetQty>0&&this.GridData.length>=this.AssetQty)return this.DisplayMessage="Qty already adjusted",void(this.MessageVisibility=!0);if(null==this.Qty.Text||""==this.Qty.Text.Trim()){if(this.dtSerials.length>0&&this.dtSerials.filter(e=>e.SerialNumber==this.SerialNumber.Text).length>0||this.GridData.filter(e=>e.SerialNumber==this.SerialNumber.Text).length>0)return this.DisplayMessage=a.a.GetResource("SerialNo_Duplicate"),void(this.MessageVisibility=!0);this.MessageVisibility=!1;let e=this.GridDataObj.NewRow();return e.Sno=(this.GridData.length+1).toString(),e.SerialNumber=this.SerialNumber.Text,e.SerialGUID=n.e.NewGuid(),this.SerialNumber.Text="",void this.GridDataObj.addRow(e)}let e,t=this.SerialNumber.Text,s=1,i=!1;if(null!=t&&""!=t.Trim())for(let a=0;a<t.length;a++)if(!n.e.IsDigit(t[t.length-a-1])){if(a<=15&&(i=!0,a>0)){e=t.substr(t.length-a);for(let t=0;t<e.length&&"0"==e[t];t++)a--;s=parseInt(t.substr(t.length-a)),t=t.substr(0,t.length-a)}break}if(!i&&null!=t&&""!=t.Trim()){let i=t.length;i>15?(i=15,e=t.substr(t.length-i)):e=t;for(let t=0;t<e.length&&"0"==e[t];t++)i--;s=parseInt(t.substr(t.length-i)),t=t.substr(0,t.length-i)}null!=t&&""!=t.Trim()||(t="");for(let o=0;o<parseInt(this.Qty.Text);o++,s++){let e=this.GridDataObj.NewRow();if(this.dtSerials.length>0&&this.dtSerials.filter(e=>e.SerialNumber==t+s.toString()).length>0||this.GridData.filter(e=>e.SerialNumber==t+s.toString()).length>0)return this.DisplayMessage=a.a.GetResource("SerialNo_Duplicate"),void(this.MessageVisibility=!0);this.MessageVisibility=!1,e.Sno=(this.GridData.length+1).toString(),e.SerialNumber=t+s.toString(),e.SerialGUID=n.e.NewGuid(),this.GridDataObj.addRow(e)}this.SerialNumber.Text="",this.Qty.Text=""}else"Cancel"==e.toString()&&(this.DialogResult=!1,a.a.page.HideDialog());this.QtyAddMessage=n.e.Format(a.a.GetResource("SerialNo_AddMessage"),this.GridData.length.toString(),this.AssetQty.toString(),this.AssetCode)}}return e.SearchVisibility=!1,e})();class fe extends l.b{constructor(e,t,s,i){if(super(),this.DialogResult=!1,this.DeprFromDate=Date.Today(),this.DeprToDate=Date.Today(),this.DeprFilterCheck=0,this.RetValue=0,this.MAddClick=!1,this.IAddClick=!1,this.DAddClick=!1,this.MEditClick=!1,this.IEditClick=!1,this.DEditClick=!1,this.EstLife="",this.SalValue="",this.DeprStartDate=Date.Today(),this.DepSDate="",this.DepEDate="",this.ds=null,this.dtDepr=[],this.MaintainGrid=null,this.InsuranceGrid=null,this.DisposeGrid=null,this.CostCenterID=0,this.deprBooks="",this.NoteVisibility=!1,this.GeneralTabVisible=!1,this.ScheduleVisibility=!1,this.DepreciationVisibility=!1,this.AttachmentVisibility=!1,this.ChgVisibility=!1,this.AddButtonVisibility=!1,this.ChangeValueVisibility=!1,this.AssetScheduleDeprVisibility=!1,this.AddMaintenanceVisibility=!1,this.AddInsuranceVisibility=!1,this.AddDisposalVisibility=!1,this.TranHistoryGridDataObj=new d.a,this.Code=new u.a(23954),this.Name=new u.d(23955),this.Sno=new u.d(25464),this.DepreciationBooks=new h.b(25465),this.Class=new h.e(25466),this.Location=new p.a(25472),this.Employee=new p.a(25467),this.NetValue=new u.d(151),this.Description=new u.c(25477),this.Status=new h.e(25476),this.ParentAsset=new p.b(25470),this.DeprBook=new h.e(136),this.FAGroup=new p.b(25474),this.TotalQtyPurchase=new u.d(144),this.TotalQtyPurchaseIgnoreSpaces=new Ce.a(144),this.ScreenObject=new m.a,this.DetailsVisibility=!0,this.BooksIn="",this.GridName="",this.DepreciationStartDate="",this.objAsset=new P.a,this.res=null,this.RES=null,this.AllowChangeOfFAAccounts=!1,this.IsDeprScheduleExists=!1,this._IsFullDispose=0,this.ParentID=0,this.isFromEdit=!1,this.GUID="",this.SNO=1,this.IgnoreClassLoad=!1,this.IgnoreDeprBookChange=!1,this.IgnoreFAGroupChange=!1,this.Schedules=null,this.iCntLoop=0,this.strMessageLoop="",this.iTotalQtyPurchaseLoop=0,this.SNo=0,this.oLocationHistory=null,this.oOwnerHistory=null,this.ClassName="AssetManagement",this.DepreciationBooks.Height=80,this.objAsset.AMGroup=i,this.ParentID=s,this.Parent=e,this.ScreenObject.LoadScreen_1(this,72,i),this.NetValue.Enable=!1,this.TotalQtyPurchaseIgnoreSpaces.Label=a.a.GetResource("Createassetsbasedonquantity"),this.LoadTabGrids(),this.CostCenterID=72,this.ParentAsset.CCID=72,this.ParentAsset.TypeID=2,this.ParentAsset.SelectionChangedCommand.Subscribe(this,"OnGroupChanged"),this.Location.HistoryCCID=1,this.Employee.HistoryCCID=2,this.ButtonSave=new D.a,this.ButtonCustomize=new D.a,0==t?i?a.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=a.a.SessionManager.IsActionAssigned(72,"Create Group"):this.ButtonSave.Enable=a.a.SessionManager.IsActionAssigned(72,"Create Group"):a.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=a.a.SessionManager.IsActionAssigned(72,"Create"):this.ButtonSave.Enable=a.a.SessionManager.IsActionAssigned(72,"Create"):i?a.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=a.a.SessionManager.IsActionAssigned(72,"Create Group"):this.ButtonSave.Enable=a.a.SessionManager.IsActionAssigned(72,"Create Group"):a.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=a.a.SessionManager.IsActionAssigned(72,"Update"):this.ButtonSave.Enable=a.a.SessionManager.IsActionAssigned(72,"Update"),a.a.SessionManager.HideUnathorizedAccess?this.ButtonCustomize.Visible=a.a.SessionManager.IsActionAssigned(72,"Customize"):this.ButtonCustomize.Enable=a.a.SessionManager.IsActionAssigned(72,"Customize"),this.objAsset.AMAssetID=t,this.RefreshAssetDataSet(),this.ViewNotes=new g.a(this),this.ViewAttachments=new T.ViewAttachmentViewModel(this),this.ViewMaintenance=new _(this),this.ViewInsurance=new H(this),this.ViewTransactionHistory=new W(this),this.GeneralTabVisible=!0,this.LoadData(),this.Status.Items.push(h.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_Active"),"1")),this.Status.Items.push(h.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_InActive"),"0")),this.Status.SelectedValue="1",this.DepreciationBooks.CheckedChangedCommand.Subscribe(this,"OnLocationCheckedChanged"),this.Class.Items.push(h.d.ComboBoxItems_2("","0")),this.Class.DefaultValue=this.Class.SelectedValue="0",this.ds.Tables.length>0&&this.ds.Tables[0].length>0)for(let a=0;a<this.ds.Tables[0].length;a++)this.Class.Items.push(h.d.ComboBoxItems_2(this.ds.Tables[0][a].AssetClassName.toString(),this.ds.Tables[0][a].AssetClassID.toString()));if(this.ds.Tables.length>2&&this.ds.Tables[2].length>0)for(let a=0;a<this.ds.Tables[2].length;a++)this.DepreciationBooks.Items.push(h.c.CheckedListBoxItem_3(this.ds.Tables[2][a].DeprBookName.toString(),this.ds.Tables[2][a].DeprBookID.toString()));this.DefaultSelection(),this.ScreenObject.InitAutoCode(this.ScreenObject.Data.Tables[6],this.objAsset.AMGroup);let l=this.ScreenObject.Data.Tables[4].filter(e=>"CapsLock"==e.Name);if(l.length>0&&Object(o.j)(l[0].Value)&&(this.Name.IsAllCaps=!0),l=this.ScreenObject.Data.Tables[4].filter(e=>"CapsToFirstLetter"==e.Name),l.length>0&&Object(o.j)(l[0].Value)&&(this.Name.IsFirstLetterCaps=!0),l=this.ScreenObject.Data.Tables[4].filter(this.objAsset.AMGroup?e=>"ChangeOfFAAccountsGroup"==e.Name:e=>"ChangeOfFAAccountsNode"==e.Name),l.length>0&&Object(o.j)(l[0].Value)&&(this.AllowChangeOfFAAccounts=!0),t>0)this.DepreciationVisibility=!0,this.AddButtonVisibility=!0,this.LoadEditData(),this.DisplayName=i?"Edit Asset Group":a.a.GetResource("AssetManagement_EditAsset"),this.objAsset.AMGUID=this.ds.Tables[4][0].GUID.toString(),this.GUID=this.ds.Tables[4][0].GUID.toString(),this.IsDeprScheduleExists=this.ds.Tables[10].length>0,this.ScheduleVisibility=!1,this.IsDeprScheduleExists&&(this.CDeprStartDate.Enable=!1,null!=this.DeprStartValue&&(this.DeprStartValue.Enable=!1),null!=this.PurchaseValue&&(this.PurchaseValue.Enable=!1),null!=this.PreviousDepreciation&&(this.PreviousDepreciation.Enable=!1),null!=this.DeprSchedule&&(this.DeprSchedule.Enable=!1),null!=this.EstimateLife&&(this.EstimateLife.Enable=!1),null!=this.DeprMethod&&(this.DeprMethod.Enable=!1),null!=this.DeprSalvageInCalc&&(this.DeprSalvageInCalc.Enable=!1),null!=this.DeprAvgMethod&&(this.DeprAvgMethod.Enable=!1),null!=this.DeprSalvage&&(this.DeprSalvage.Enable=!1),null!=this.DeprPeriod&&(this.DeprPeriod.Enable=!1)),null!=this.ds&&this.ds.Tables.length>8&&this.ds.Tables[8].length>0&&(n.e.IsEmpty(this.ds.Tables[8][0].DepStartDate)||(this.DepreciationStartDate=new Date(this.ds.Tables[8][0].DepStartDate.toString()).ToString(a.a.SessionManager.Preferences["Date Format"]))),this.SetVisibility(),this.ChgVisibility=!0,this.DetailsVisibility=!0,this.ParentAsset.Enable=!1;else{this.ScheduleVisibility=!1,this.DepreciationVisibility=!1,this.ParentAsset.SelectedValue=s,this.ParentAsset.DefaultValue=s.toString(),this.ParentAsset.Enable=!0,this.AddButtonVisibility=!1,i?this.DisplayName="Add Asset Group":(this.CDeprStartDate.Mandatory=!0,this.DisplayName=a.a.GetResource("AssetManagement_AddAsset")),this.objAsset.AMGUID="GUID",this.ScreenObject.CustomTab.Pages.Remove(this.Trans),this.SetVisibility(),this.OnGroupChanged(null);let e=this.ScreenObject.CustomTab.Pages.find(e=>"Purchase Details"==e.Name);for(let t=0;t<e.Fields.length;t++)if(e.Fields[t]instanceof u.d&&24064==e.Fields[t].DBColumnID){e.Fields[t].Enable=!0;break}}}get AssetID(){return this.objAsset.AMAssetID}get IsFullDispose(){return this._IsFullDispose}set IsFullDispose(e){this._IsFullDispose!=e&&(this._IsFullDispose=e,this.DisposeGrid.IsColumnUserDefined=1==e||3==e)}OnAddNote(){Logger.InfoLog("AddEditAssetManagement::Entering AddNote"),this.Note=new S.AddNoteViewModel,this.Note.AddNoteViewModel_2(this),Logger.InfoLog("AddEditAssetManagement::Entering AddNote")}OnAddAttachment(){Logger.InfoLog("AddEditAssetManagement::Entering AddAttachment"),this.Attachment=new C.AddAttachmentViewModel,this.Attachment.AddAttachmentViewModel_2(this),Logger.InfoLog("AddEditAssetManagement::Entering AddAttachment")}LoadEditData(){if(this.ds.Tables.length>3&&this.ds.Tables[4].length>0){if(n.e.IsEmpty(this.ds.Tables[4][0].AssetCode)||(this.Code.Text=this.ds.Tables[4][0].AssetCode.toString()),(this.ScreenObject.InheritParentCode||this.ScreenObject.IsAutoCode)&&(this.Code.Enable=parseInt(this.ds.Tables[4][0].Depth)<=1&&!this.ScreenObject.IsRootAutoCode),this.ScreenObject.IsAutoName&&(this.Name.Enable=!1),this.objAsset.CodePrefix=n.e.String(this.ds.Tables[4][0].CodePrefix),this.objAsset.CodeNumber=n.e.Int(this.ds.Tables[4][0].CodeNumber),n.e.IsEmpty(this.ds.Tables[4][0].AssetName)||(this.Name.Text=this.ds.Tables[4][0].AssetName.toString()),n.e.IsEmpty(this.ds.Tables[4][0].StatusID)||(this.Status.SelectedValue=this.ds.Tables[4][0].StatusID.toString()),n.e.IsEmpty(this.ds.Tables[4][0].Description)||(this.Description.Text=this.ds.Tables[4][0].Description.toString(),this.Description.Text.startsWith("<FlowDocument")&&(this.Description.Tag=this.Description.Text)),n.e.IsEmpty(this.ds.Tables[4][0].SerialNo)||(this.Sno.Text=this.ds.Tables[4][0].SerialNo.toString()),n.e.IsEmpty(this.ds.Tables[4][0].ParentAssetID)||(this.ParentAsset.SelectedValue=parseInt(this.ds.Tables[4][0].ParentAssetID),this.ParentAsset.DefaultValue=this.ParentAsset.SelectedValue.toString()),this.TotalQtyPurchase.Text=n.e.String(this.ds.Tables[4][0].TotalQtyPurchase),n.e.IsEmpty(this.ds.Tables[4][0].DeprStartDate)||(this.DepSDate=new Date(this.ds.Tables[4][0].DeprStartDate).ToString("dd/MMM/yyyy")),n.e.IsEmpty(this.ds.Tables[4][0].DeprEndDate)||(this.DepEDate=new Date(this.ds.Tables[4][0].DeprEndDate).ToString("dd/MMM/yyyy")),this.SalValue=null==this.ds.Tables[4][0].SalvageValue?"0":"2"==this.ds.Tables[4][0].SalvageValueType.toString()?(parseFloat(this.ds.Tables[4][0].SalvageValue)*parseFloat(this.ds.Tables[4][0].DeprStartValue)/100).toString():parseFloat(this.ds.Tables[4][0].SalvageValue).toString(),this.EstLife=this.ds.Tables[4][0].EstimateLife.toString(),!n.e.IsEmpty(this.ds.Tables[4][0].DeprBookGroupID)){let e=this.ds.Tables[4][0].DeprBookGroupID.toString().split(",");for(let t=0;t<e.length;t++)for(let s=0;s<this.DepreciationBooks.Items.length;s++)if(this.DepreciationBooks.Items[s].Value==e[t]){this.DepreciationBooks.Items[s].IsChecked=!0;break}}n.e.IsEmpty(this.ds.Tables[4][0].LocationID)?this.Location.Text="":this.Location.SetValue_2(parseInt(this.ds.Tables[4][0].LocationID),this.ds.Tables[5].length>0?n.e.String(this.ds.Tables[5][0].AssetLocation):""),n.e.IsEmpty(this.ds.Tables[4][0].EmployeeID)?this.Employee.Text="":this.Employee.SetValue_2(parseInt(this.ds.Tables[4][0].EmployeeID),this.ds.Tables[5].length>0?n.e.String(this.ds.Tables[5][0].AssetOwner):""),this.NetValue.Text=n.e.IsEmpty(this.ds.Tables[4][0].AssetNetValue)?this.ds.Tables[4][0].DeprStartValue.ToString(a.a.SessionManager.Preferences.DecimalsinAmount):this.ds.Tables[4][0].AssetNetValue.ToString(a.a.SessionManager.Preferences.DecimalsinAmount),this.IgnoreClassLoad=!0,n.e.IsEmpty(this.ds.Tables[4][0].ClassID)||(this.Class.SelectedValue=this.ds.Tables[4][0].ClassID.toString()),"0"!=this.Class.SelectedValue&&(this.EnableControls(!1,1),this.EnableControls(!1,2),this.EnableControls(!1,3)),this.IgnoreClassLoad=!1,this.IgnoreFAGroupChange=!0,this.FAGroup.SelectedValue=null!=this.ds.Tables[4][0].PostingGroupID?parseInt(this.ds.Tables[4][0].PostingGroupID):0,this.AcqnCostACCID.SelectedValue=parseInt(this.ds.Tables[4][0].AcqnCostACCID.toString()),this.AccumDeprACCID.SelectedValue=parseInt(this.ds.Tables[4][0].AccumDeprACCID.toString()),this.DeprExpenseACCID.SelectedValue=parseInt(this.ds.Tables[4][0].DeprExpenseACCID.toString()),this.AcquisitionClearingAcc.SelectedValue=parseInt(this.ds.Tables[4][0].AcqnCostDispACCID.toString()),this.DisposalClearingAcc.SelectedValue=parseInt(this.ds.Tables[4][0].AccumDeprDispACCID.toString()),this.DisposalGainAcc.SelectedValue=parseInt(this.ds.Tables[4][0].GainsDispACCID.toString()),this.DisposalLossAcc.SelectedValue=parseInt(this.ds.Tables[4][0].LossDispACCID.toString()),this.MinorAssetExpenseAcc.SelectedValue=parseInt(this.ds.Tables[4][0].MaintExpenseACCID.ToString()),this.EnableControls(!(this.FAGroup.SelectedValue>0),2),this.isFromEdit=!0,this.IgnoreFAGroupChange=!1,this.IgnoreDeprBookChange=!0,this.DeprBook.SelectedValue=n.e.String(this.ds.Tables[4][0].DeprBookID),n.e.IsEmpty(this.DeprBook.SelectedValue)||"0"==this.DeprBook.SelectedValue?this.EnableControls(!0,3):this.EnableControls(!1,3),this.IgnoreDeprBookChange=!1,this.LoadTabFields(this.ds.Tables[4])}this.ViewNotes.LoadNotes(this.ds.Tables[14]),this.ViewAttachments.LoadAttachments(this.ds.Tables[15]),this.ScreenObject.LoadCustomFieldsData(this.ds.Tables[16]),this.ScreenObject.LoadCustomFieldsCCData(this.ds.Tables[17],this.ds.Tables[11]),this.ds.Tables.length>6&&this.ViewTransactionHistory.LoadValueInfo(this.ds.Tables[6],this.ds.Columns[6]);let e=this.ds.Tables[13].filter(e=>3==e.HistoryTypeID&&(1==e.PolicyType||3==e.PolicyType));this.IsFullDispose=e.length>0?parseInt(e[0].PolicyType):0,this.OnTabGridDataLoad(this.ds.Tables[13])}DefaultSelection(){this.Location.ClickCommand.Subscribe(this,"OnLocationClick"),this.Employee.ClickCommand.Subscribe(this,"OnOwnerClick"),this.Class.SelectionChangedCommand.Subscribe(this,"OnClassSelectionChanged"),this.DeprBook.SelectionChangedCommand.Subscribe(this,"OnDeprBookChange"),this.DeprBook.Items.push(h.d.ComboBoxItems_2("","0")),this.DeprBook.DefaultValue=this.DeprBook.SelectedValue="0",this.ds.Tables[2].forEach(e=>{this.DeprBook.Items.push(h.d.ComboBoxItems_2(e.DeprBookName.toString(),e.DeprBookID.toString()))}),this.FAGroup.OnPactListBoxValueChanged.Subscribe(this,"OnFAGroupSelectionChanged"),this.FAGroup.SetTimeToZero();for(let e=0;e<this.ScreenObject.CustomTab.Pages.length;e++)if("1033"==this.ScreenObject.CustomTab.Pages[e].DBColumnID.toString())for(let t=0;t<this.ScreenObject.CustomTab.Pages[e].Fields.length;t++){let s=this.ScreenObject.CustomTab.Pages[e].Fields[t];if(s instanceof h.e){let e=s;if(26401==e.DBColumnID)this.DeprPeriod=e,e.Items.push(h.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_Monthly"),"1")),e.Items.push(h.d.ComboBoxItems_2(a.a.GetResource("Budget_Quarterly"),"3")),e.Items.push(h.d.ComboBoxItems_2(a.a.GetResource("Budget_Halfyearely"),"4")),e.Items.push(h.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_Yearly"),"2")),e.SelectedValue="1";else if(26402==e.DBColumnID)this.DeprAvgMethod=e,e.Items.push(h.d.ComboBoxItems_2(a.a.GetResource("DeprBook_CalendarDays"),"1")),e.Items.push(h.d.ComboBoxItems_2(a.a.GetResource("DeprBook_FullMonth"),"2")),e.Items.push(h.d.ComboBoxItems_2(a.a.GetResource("DeprBook_MidMonth"),"3")),e.SelectedValue="1";else if(26399==e.DBColumnID){if(this.DeprMethod=e,this.ds.Tables.length>12&&this.ds.Tables[12].length>0){for(let t=0;t<this.ds.Tables[12].length;t++)e.Items.push(h.d.ComboBoxItems_2(this.ds.Tables[12][t].Name.toString(),this.ds.Tables[12][t].DepreciationMethodID.toString()));e.SelectedValue=e.Items[0].Value}}else 26432==s.DBColumnID?(this.DeprSchedule=e,e.Items.push(h.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_Yes"),"1")),e.Items.push(h.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_No"),"0")),e.SelectedValue="1"):147==s.DBColumnID&&(this.DeprSalvageInCalc=e,e.Items.push(h.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_Yes"),"1")),e.Items.push(h.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_No"),"0")),e.SelectedValue="0")}else s instanceof u.e?25471==s.DBColumnID&&(this.EstimateLife=s,this.EstimateLife.TextChangedCommand.Subscribe(this,"OnDateChanged"),this.EstimateLife.LblClick=new I.b,this.EstimateLife.LblClick.Subscribe(this,"OnLabelClick")):s instanceof r.b?"SalvageValue"==s.DBColumnName&&(this.DeprSalvage=s):s instanceof I.c&&(24063==s.DBColumnID?(this.CDeprStartDate=s,this.CDeprStartDate.SelectedDateChanged.Subscribe(this,"OnDateChanged")):26400==s.DBColumnID&&(this.CDeprEndDate=s))}else if("623"==this.ScreenObject.CustomTab.Pages[e].DBColumnID.toString())for(let t=0;t<this.ScreenObject.CustomTab.Pages[e].Fields.length;t++){let s=this.ScreenObject.CustomTab.Pages[e].Fields[t];if(s instanceof u.d){let e=s;26398==e.DBColumnID?this.DeprStartValue=e:24064==e.DBColumnID?this.PurchaseValue=e:50394==e.DBColumnID&&(this.PreviousDepreciation=e)}else if(s instanceof h.e){let e=s;25479==e.DBColumnID?(e.Items.push(h.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_Value"),"1")),e.Items.push(h.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_Percentage"),"2")),e.SelectedValue="1"):26403==e.DBColumnID&&(e.Items.push(h.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_Yes"),"1")),e.Items.push(h.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_No"),"2")),e.SelectedValue="1")}else s instanceof p.b?145==s.DBColumnID&&(s.CustomWhere="1=1"):s instanceof c.c&&183==s.DBColumnID&&(this.OriginalDeprStartDate=s)}else if("624"==this.ScreenObject.CustomTab.Pages[e].DBColumnID.toString())for(let t=0;t<this.ScreenObject.CustomTab.Pages[e].Fields.length;t++)this.ScreenObject.CustomTab.Pages[e].Fields[t]instanceof h.e&&26406==this.ScreenObject.CustomTab.Pages[e].Fields[t].DBColumnID&&(this.ScreenObject.CustomTab.Pages[e].Fields[t].Items.push(h.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_Yes"),"1")),this.ScreenObject.CustomTab.Pages[e].Fields[t].Items.push(h.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_No"),"2")),this.ScreenObject.CustomTab.Pages[e].Fields[t].SelectedValue="1");else if("625"==this.ScreenObject.CustomTab.Pages[e].DBColumnID.toString())for(let t=0;t<this.ScreenObject.CustomTab.Pages[e].Fields.length;t++){let s=this.ScreenObject.CustomTab.Pages[e].Fields[t];s instanceof h.e&&(26411==s.DBColumnID?(s.Items.push(h.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_Yes"),"1")),s.Items.push(h.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_No"),"2")),s.SelectedValue="1"):26415==s.DBColumnID&&(s.Items.push(h.d.ComboBoxItems_2("Quarterly","1")),s.Items.push(h.d.ComboBoxItems_2("Half-Yearly","2")),s.Items.push(h.d.ComboBoxItems_2("Anually","3")),s.SelectedValue="1"))}else if(1049==this.ScreenObject.CustomTab.Pages[e].DBColumnID)for(let t=0;t<this.ScreenObject.CustomTab.Pages[e].Fields.length;t++){let s=this.ScreenObject.CustomTab.Pages[e].Fields[t];if(s instanceof p.b){let e=s;27403==e.DBColumnID?this.AcqnCostACCID=e:27404==e.DBColumnID?this.DeprExpenseACCID=e:27405==e.DBColumnID?this.AccumDeprACCID=e:27406==e.DBColumnID?this.DisposalClearingAcc=e:27407==e.DBColumnID?this.AcquisitionClearingAcc=e:27408==e.DBColumnID?this.DisposalGainAcc=e:27409==e.DBColumnID?this.DisposalLossAcc=e:27410==e.DBColumnID&&(this.MinorAssetExpenseAcc=e)}}}OnDateChanged(e){Date.Today(),Date.Today();let t=0,s=0,i=0,a=null!=this.EstimateLife?this.EstimateLife.Text.split("."):this.EstLife.split(".");t=n.e.Int(a[0]),a.length>1&&(s=n.e.Int(a[1])),a.length>2&&(i=n.e.Int(a[2])),null!=this.CDeprStartDate&&null!=this.CDeprEndDate&&this.CDeprStartDate.Date&&(this.CDeprEndDate.Date=this.CDeprStartDate.Date.AddYears(t),this.CDeprEndDate.Text=this.CDeprStartDate.Date.AddYears(t).toString(),s>0&&(this.CDeprEndDate.Date=this.CDeprEndDate.Date.AddMonths(s)),i>0&&(this.CDeprEndDate.Date=this.CDeprEndDate.Date.AddDays(i)))}Table_TableNewRow(e){this.UpdateSequence(this.MaintainGrid.Table),e.Sno=this.SNO}LoadTabGrids(){this.MaintainGrid=new Z(this),this.InsuranceGrid=new Z(this),this.DisposeGrid=new Z(this),this.MaintainGrid.GroupName="Maintenance",this.InsuranceGrid.GroupName="Insurance",this.DisposeGrid.GroupName="Dispose",this.MaintainGrid.Table=[],this.MaintainGrid.TableColumns.push("Sno"),this.MaintainGrid.TableColumns.push("Vendor"),this.MaintainGrid.TableColumns.push("VendorID"),this.MaintainGrid.TableColumns.push("ServiceDate"),this.MaintainGrid.TableColumns.push("DocNo"),this.MaintainGrid.TableColumns.push("DocID"),this.MaintainGrid.TableColumns.push("Edit"),this.MaintainGrid.TableColumns.push("Delete"),this.MaintainGrid.TableColumns.push("Date"),this.MaintainGrid.TableColumns.push("Remarks"),this.MaintainGrid.TableColumns.push("Amount"),this.MaintainGrid.TableColumns.push("DebitAccount"),this.MaintainGrid.TableColumns.push("CreditAccount"),this.MaintainGrid.TableColumns.push("PostJV"),this.MaintainGrid.TableColumns.push("CostCenterID"),this.MaintainGrid.TableColumns.push("DocumentName"),this.MaintainGrid.TableColumns.push("DocPrefix"),this.MaintainGrid.TableColumns.push("DocNumber"),this.MaintainGrid.TableColumns.push("HistoryID"),this.MaintainGrid.Columns=new Array;let e=new b.a;e.Header=a.a.GetResource("Sno"),e.DisplayMember="Sno",e.ReadOnly=!0,e.Width=50,this.MaintainGrid.Columns.push(e),e=new b.a,e.Header=a.a.GetResource("AssetManagement_Vendor"),e.DisplayMember="Vendor",e.DataType="TEXTBOX",e.ReadOnly=!0,e.Width=150,this.MaintainGrid.Columns.push(e),e=new b.a,e.Header=a.a.GetResource("Service")+a.a.GetResource("Date"),e.DisplayMember="ServiceDate",e.DataType="TEXTBOX",e.ReadOnly=!0,e.Width=150,this.MaintainGrid.Columns.push(e),e=new b.a,e.Header=a.a.GetResource("DocumentDesigner_VoucherNo"),e.DisplayMember="DocNo",e.ReadOnly=!0,e.Width=150,e.DataType="LINK",e.Click.Subscribe(this,"OnMaintainDocLink"),this.MaintainGrid.Columns.push(e),e=new b.a,e.Header=a.a.GetResource("Edit"),e.DisplayMember="Edit",e.ReadOnly=!0,e.Width=50,e.DataType="LINK",e.Click.Subscribe(this,"OnMaintenanceEditClick"),this.MaintainGrid.Columns.push(e),e=new b.a,e.Header=a.a.GetResource("Delete"),e.DisplayMember="Delete",e.ReadOnly=!0,e.Width=70,e.DataType="LINK",this.MaintainGrid.Columns.push(e),this.MaintainGrid.TableNewRow.Subscribe(this,"Table_TableNewRow"),this.MaintainGrid.OnLinkClick.Subscribe(this,"OnMaintenanceDeleteClick"),this.MaintainGrid.Column=0,this.MaintainGrid.Row=3,this.MaintainGrid.ColumnSpan=4,this.InsuranceGrid.Table=[],this.InsuranceGrid.TableColumns.push("Sno"),this.InsuranceGrid.TableColumns.push("Vendor"),this.InsuranceGrid.TableColumns.push("VendorID"),this.InsuranceGrid.TableColumns.push("PolicyNumber"),this.InsuranceGrid.TableColumns.push("Coverage"),this.InsuranceGrid.TableColumns.push("Edit"),this.InsuranceGrid.TableColumns.push("Delete"),this.InsuranceGrid.TableColumns.push("StartDate"),this.InsuranceGrid.TableColumns.push("EndDate"),this.InsuranceGrid.TableColumns.push("PolicyType"),this.InsuranceGrid.TableColumns.push("Premium"),this.InsuranceGrid.TableColumns.push("HistoryID"),this.InsuranceGrid.Columns=new Array,e=new b.a,e.Header=a.a.GetResource("Sno"),e.DisplayMember="Sno",e.ReadOnly=!0,e.Width=50,this.InsuranceGrid.Columns.push(e),e=new b.a,e.Header=a.a.GetResource("AssetManagement_Vendor"),e.DisplayMember="Vendor",e.DataType="TEXTBOX",e.ReadOnly=!0,e.Width=150,this.InsuranceGrid.Columns.push(e),e=new b.a,e.Header=a.a.GetResource("AssetManagement_PolicyNo"),e.DisplayMember="PolicyNumber",e.DataType="TEXTBOX",e.ReadOnly=!0,e.Width=150,this.InsuranceGrid.Columns.push(e),e=new b.a,e.Header=a.a.GetResource("AssetManagement_Coverage"),e.DisplayMember="Coverage",e.ReadOnly=!0,e.Width=150,this.InsuranceGrid.Columns.push(e),e=new b.a,e.Header=a.a.GetResource("Edit"),e.DisplayMember="Edit",e.ReadOnly=!0,e.Width=50,e.DataType="LINK",e.Click.Subscribe(this,"OnInsuranceEditClick"),this.InsuranceGrid.Columns.push(e),e=new b.a,e.Header=a.a.GetResource("Delete"),e.DisplayMember="Delete",e.ReadOnly=!0,e.Width=70,e.DataType="LINK",this.InsuranceGrid.Columns.push(e),this.InsuranceGrid.TableNewRow.Subscribe(this,"Table_TableNewRow"),this.InsuranceGrid.OnLinkClick.Subscribe(this,"OnInsuranceDeleteClick"),this.InsuranceGrid.Column=0,this.InsuranceGrid.Row=3,this.InsuranceGrid.ColumnSpan=4,this.DisposeGrid.Table=[],this.DisposeGrid.TableColumns.push("Sno"),this.DisposeGrid.TableColumns.push("Date"),this.DisposeGrid.TableColumns.push("Amount"),this.DisposeGrid.TableColumns.push("DocNo"),this.DisposeGrid.TableColumns.push("DocID"),this.DisposeGrid.TableColumns.push("Edit"),this.DisposeGrid.TableColumns.push("Delete"),this.DisposeGrid.TableColumns.push("Remarks"),this.DisposeGrid.TableColumns.push("CurrentValue"),this.DisposeGrid.TableColumns.push("DebitAccount"),this.DisposeGrid.TableColumns.push("CreditAccount"),this.DisposeGrid.TableColumns.push("GainAccount"),this.DisposeGrid.TableColumns.push("LossAccount"),this.DisposeGrid.TableColumns.push("DisposeClearingAccount"),this.DisposeGrid.TableColumns.push("PostJV"),this.DisposeGrid.TableColumns.push("CostCenterID"),this.DisposeGrid.TableColumns.push("DocumentName"),this.DisposeGrid.TableColumns.push("DocPrefix"),this.DisposeGrid.TableColumns.push("DocNumber"),this.DisposeGrid.TableColumns.push("HistoryID"),this.DisposeGrid.TableColumns.push("PolicyType"),this.DisposeGrid.TableColumns.push("DisposeType_Name"),this.DisposeGrid.Columns=new Array,e=new b.a,e.Header=a.a.GetResource("Sno"),e.DisplayMember="Sno",e.ReadOnly=!0,e.Width=50,this.DisposeGrid.Columns.push(e),e=new b.a,e.Header=a.a.GetResource("Date"),e.DisplayMember="Date",e.DataType="TEXTBOX",e.ReadOnly=!0,e.Width=120,this.DisposeGrid.Columns.push(e),e=new b.a,e.Header="Type",e.DisplayMember="DisposeType_Name",e.ReadOnly=!0,e.Width=140,this.DisposeGrid.Columns.push(e),e=new b.a,e.Header=a.a.GetResource("Amount"),e.DisplayMember="Amount",e.DataType="TEXTBOX",e.ReadOnly=!0,e.Width=140,this.DisposeGrid.Columns.push(e),e=new b.a,e.Header=a.a.GetResource("DocumentDesigner_VoucherNo"),e.DisplayMember="DocNo",e.ReadOnly=!0,e.Width=160,e.DataType="LINK",e.Click.Subscribe(this,"OnDisposeDocLink"),this.DisposeGrid.Columns.push(e),this.AddingRowsToTabGrid(),this.DisposeGrid.Column=0,this.DisposeGrid.Row=1,this.DisposeGrid.ColumnSpan=4;for(let t=0;t<this.ScreenObject.CustomTab.Pages.length;t++)624==this.ScreenObject.CustomTab.Pages[t].DBColumnID&&this.ScreenObject.CustomTab.Pages[t].Fields.push(this.MaintainGrid),625==this.ScreenObject.CustomTab.Pages[t].DBColumnID&&this.ScreenObject.CustomTab.Pages[t].Fields.push(this.InsuranceGrid),986==this.ScreenObject.CustomTab.Pages[t].DBColumnID&&this.ScreenObject.CustomTab.Pages[t].Fields.push(this.DisposeGrid)}OnDisposeDocLink(e){this.OnLinkClickEvent(this.DisposeGrid.SelectedItem)}OnMaintainDocLink(e){this.OnLinkClickEvent(this.MaintainGrid.SelectedItem)}OnLinkClickEvent(e){n.e.IsEmpty(e.DocNo)||y.RibbonExtViewModel.LoadDocument(e)}AddingRowsToTabGrid(){for(let e=0;e<6;e++)this.MaintainGrid.addEmptyRow(),this.MaintainGrid.Table[e].Sno=e+1;for(let e=0;e<6;e++)this.InsuranceGrid.addEmptyRow(),this.InsuranceGrid.Table[e].Sno=e+1;for(let e=0;e<6;e++)this.DisposeGrid.addEmptyRow(),this.DisposeGrid.Table[e].Sno=e+1}OnMaintenanceDeleteClick(e,t,s){if("Delete"==t&&!n.e.IsEmpty(e.Delete)){let t;if(t=null!=e.DocNo.toString()?confirm("Do you want to Delete Maintainance's Document '"+e.DocNo.toString()+"'"):confirm("Do you want to Delete Vender '"+e.Vender.toString()+"'"),!t)return;this.DeletingDocument(e,1),this.MaintainGrid.Table.Remove(e),this.UpdateSequence(this.MaintainGrid.Table)}}OnInsuranceDeleteClick(e,t,s){if("Delete"==t&&!n.e.IsEmpty(e.Delete)){let t=!1;if(null!=e.PolicyNumber.toString()&&(t=confirm("Do you want to Delete Insurance's of  Vender '"+e.Vendor.toString()+"'  PolicyNo '"+e.PolicyNumber.toString()+"'")),!t)return;t&&(this.DeletingDocument(e,2),this.InsuranceGrid.Table.Remove(e)),this.UpdateSequence(this.InsuranceGrid.Table)}}OnDisposeDeleteClick(e,t,s){if("Delete"==t&&!n.e.IsEmpty(e.Delete)){let t;if(t=null!=e.DocNo.toString()?confirm("Do you want to Delete Maintainance's Document '"+e.DocNo.toString()+"'"):confirm("Do you want to Delete Vender '"+e.Vender.toString()+"'"),!t)return;this.DeletingDocument(e,1),this.DisposeGrid.Table.Remove(e),this.UpdateSequence(this.DisposeGrid.Table)}}DeletingDocument(e,t){try{P.a.DeleteAssetRefDoc(parseInt(e.HistoryID.toString()),t)}catch(s){Logger.ErrorLog("DeleteAssetViewModel:: OnDelete",s)}}InsuranceCheck(){let e="";return e+="<Row ",e+=' Vendor"'+this.InsuranceGrid.SelectedItem.VendorID.toString()+'"',e+=' PolicyNo"'+this.InsuranceGrid.SelectedItem.PolicyNumber.toString()+'"',e+=" />",e.toString()}OnMaintenanceEditClick(e){null==this.MaintainGrid.SelectedItem||n.e.IsEmpty(this.MaintainGrid.SelectedItem.Edit)||(this.MAddClick=!1,this.MEditClick=!0,this.SetVisibility(),this.Maintenance.PostJV.Enable=!1,this.AddMaintenanceVisibility=!0,this.Maintenance.OnLoad(this.MaintainGrid.SelectedItem))}OnInsuranceEditClick(e){null==this.InsuranceGrid.SelectedItem||n.e.IsEmpty(this.InsuranceGrid.SelectedItem.Edit)||(this.IAddClick=!1,this.IEditClick=!0,this.SetVisibility(),this.AddInsuranceVisibility=!0,this.Insurance.OnLoad(this.InsuranceGrid.SelectedItem))}OnDisposeEditClick(e){this.Dispose=new w(this,this.NetValue.Text),null==this.DisposeGrid.SelectedItem||n.e.IsEmpty(this.DisposeGrid.SelectedItem.Edit)||(this.DAddClick=!1,this.DEditClick=!0,this.SetVisibility(),this.Dispose.PostJV.Enable=!1,this.AddDisposalVisibility=!0,this.Dispose.OnLoad(this.DisposeGrid.SelectedItem))}OnTabGridDataLoad(e){let t=e.filter(e=>1==e.HistoryTypeID),s=e.filter(e=>2==e.HistoryTypeID),i=e.filter(e=>3==e.HistoryTypeID);for(let a=0;a<t.length;a++)this.MaintainGrid.Table[a].Date=n.e.IsEmpty(t[a].Datee)?null:new Date(t[a].Datee).ToString("dd/MMM/yyyy"),this.MaintainGrid.Table[a].Vendor=t[a].Vender,this.MaintainGrid.Table[a].VendorID=t[a].VendorID,this.MaintainGrid.Table[a].ServiceDate=n.e.IsEmpty(t[a].MaintenanceNextServiceDate)?null:new Date(t[a].MaintenanceNextServiceDate).ToString("dd/MMM/yyyy"),this.MaintainGrid.Table[a].Remarks=t[a].Remarks,this.MaintainGrid.Table[a].Amount=t[a].Amount,this.MaintainGrid.Table[a].DocID=t[a].DOCID,this.MaintainGrid.Table[a].DocNo=t[a].VoucherNo,this.MaintainGrid.Table[a].DebitAccount=t[a].DebitAccount,this.MaintainGrid.Table[a].CreditAccount=t[a].CreditAccount,this.MaintainGrid.Table[a].PostJV=t[a].PostJV,this.MaintainGrid.Table[a].CostCenterID=t[a].CostCenterID,this.MaintainGrid.Table[a].DocumentName=t[a].DocumentName,this.MaintainGrid.Table[a].DocPrefix=t[a].DocPrefix,this.MaintainGrid.Table[a].DocNumber=t[a].DocNumber,this.MaintainGrid.Table[a].HistoryID=t[a].HistoryID,this.MaintainGrid.Table[a].Edit="Edit",this.MaintainGrid.Table[a].Delete="Delete";for(let a=0;a<s.length;a++)this.InsuranceGrid.Table[a].Vendor=s[a].Vender,this.InsuranceGrid.Table[a].VendorID=s[a].VendorID,this.InsuranceGrid.Table[a].PolicyType=s[a].PolicyType,this.InsuranceGrid.Table[a].PolicyNumber=s[a].PolicyNumber,n.e.IsEmpty(s[a].InsuranceStartDate)?this.InsuranceGrid.Table[a].ServiceDate=null:this.InsuranceGrid.Table[a].StartDate=new Date(s[a].InsuranceStartDate).ToString("dd/MMM/yyyy"),this.InsuranceGrid.Table[a].EndDate=n.e.IsEmpty(s[a].InsuranceEndDate)?null:new Date(s[a].InsuranceEndDate).ToString("dd/MMM/yyyy"),this.InsuranceGrid.Table[a].Coverage=s[a].Coverage,this.InsuranceGrid.Table[a].Premium=s[a].Premium,this.InsuranceGrid.Table[a].HistoryID=s[a].HistoryID,this.InsuranceGrid.Table[a].Edit="Edit",this.InsuranceGrid.Table[a].Delete="Delete";for(let a=0;a<i.length;a++)this.DisposeGrid.Table[a].Date=n.e.IsEmpty(i[a].Datee)?null:new Date(i[a].Datee).ToString("dd/MMM/yyyy"),this.DisposeGrid.Table[a].Amount=i[a].Amount,this.DisposeGrid.Table[a].CurrentValue=i[a].CurrentValue,this.DisposeGrid.Table[a].Remarks=i[a].Remarks,this.DisposeGrid.Table[a].DebitAccount=i[a].DebitAccount,this.DisposeGrid.Table[a].CreditAccount=i[a].CreditAccount,this.DisposeGrid.Table[a].GainAccount=i[a].GainAccount,this.DisposeGrid.Table[a].LossAccount=i[a].LossAccount,this.DisposeGrid.Table[a].DisposeClearingAccount=i[a].DisposeClearingAccount,this.DisposeGrid.Table[a].PostJV=i[a].PostJV,this.DisposeGrid.Table[a].DocID=i[a].DOCID,this.DisposeGrid.Table[a].DocNo=i[a].VoucherNo,this.DisposeGrid.Table[a].HistoryID=i[a].HistoryID,this.DisposeGrid.Table[a].Edit="Edit",this.DisposeGrid.Table[a].Delete="Delete",this.DisposeGrid.Table[a].CostCenterID=i[a].CostCenterID,this.DisposeGrid.Table[a].DocumentName=i[a].DocumentName,this.DisposeGrid.Table[a].DocPrefix=i[a].DocPrefix,this.DisposeGrid.Table[a].DocNumber=i[a].DocNumber,this.DisposeGrid.Table[a].PolicyType=i[a].PolicyType,this.DisposeGrid.Table[a].DisposeType_Name="1"==i[a].PolicyType.toString()?"Dispose Full":"2"==i[a].PolicyType.toString()?"Sale Partial":"3"==i[a].PolicyType.toString()?"Sale Full":"Dispose Partial";t.SortBy([{name:"HistoryID",parser:parseInt,desc:!0}]),s.SortBy([{name:"HistoryID",parser:parseInt,desc:!0}]);for(let o=0;o<this.ScreenObject.CustomTab.Pages.length;o++){if("624"==this.ScreenObject.CustomTab.Pages[o].DBColumnID.toString())for(let e=0;e<this.ScreenObject.CustomTab.Pages[o].Fields.length;e++)null!=t&&t.length>0&&(this.ScreenObject.CustomTab.Pages[o].Fields[e]instanceof c.a?26407==this.ScreenObject.CustomTab.Pages[o].Fields[e].DBColumnID?n.e.IsEmpty(t[0].StartDate)||(this.ScreenObject.CustomTab.Pages[o].Fields[e].Text=new Date(t[0].InsuranceStartDate.toString()).ToString(a.a.SessionManager.Preferences["Date Format"]),this.ScreenObject.CustomTab.Pages[o].Fields[e].Date=new Date(t[0].InsuranceStartDate)):26408==this.ScreenObject.CustomTab.Pages[o].Fields[e].DBColumnID?n.e.IsEmpty(t[0].EndDate)||(this.ScreenObject.CustomTab.Pages[o].Fields[e].Text=new Date(t[0].InsuranceEndDate.toString()).ToString(a.a.SessionManager.Preferences["Date Format"]),this.ScreenObject.CustomTab.Pages[o].Fields[e].Date=new Date(t[0].InsuranceEndDate.toString())):26410==this.ScreenObject.CustomTab.Pages[o].Fields[e].DBColumnID&&(n.e.IsEmpty(t[0].NextServiceDate)||(this.ScreenObject.CustomTab.Pages[o].Fields[e].Text=new Date(t[0].MaintenanceNextServiceDate).ToString(a.a.SessionManager.Preferences["Date Format"]),this.ScreenObject.CustomTab.Pages[o].Fields[e].Date=new Date(t[0].MaintenanceNextServiceDate.toString()))):this.ScreenObject.CustomTab.Pages[o].Fields[e]instanceof p.b&&26412==this.ScreenObject.CustomTab.Pages[o].Fields[e].DBColumnID&&(n.e.IsEmpty(t[0].VendorID)||(this.ScreenObject.CustomTab.Pages[o].Fields[e].SelectedValue=parseInt(t[0].VendorID.toString()))));if("625"==this.ScreenObject.CustomTab.Pages[o].DBColumnID.toString()&&null!=s&&s.length>0)for(let e=0;e<this.ScreenObject.CustomTab.Pages[o].Fields.length;e++)this.ScreenObject.CustomTab.Pages[o].Fields[e]instanceof p.b?26409==this.ScreenObject.CustomTab.Pages[o].Fields[e].DBColumnID&&(n.e.IsEmpty(s[0].VendorID)||(this.ScreenObject.CustomTab.Pages[o].Fields[e].SelectedValue=parseInt(s[0].VendorID.toString()))):this.ScreenObject.CustomTab.Pages[o].Fields[e]instanceof c.c?26413==this.ScreenObject.CustomTab.Pages[o].Fields[e].DBColumnID?n.e.IsEmpty(s[0].StartDate)||(this.ScreenObject.CustomTab.Pages[o].Fields[e].Text=new Date(s[0].InsuranceStartDate).ToString(a.a.SessionManager.Preferences["Date Format"]),this.ScreenObject.CustomTab.Pages[o].Fields[e].Date=new Date(s[0].InsuranceStartDate.toString())):26414==this.ScreenObject.CustomTab.Pages[o].Fields[e].DBColumnID&&(n.e.IsEmpty(s[0].EndDate)||(this.ScreenObject.CustomTab.Pages[o].Fields[e].Text=new Date(s[0].InsuranceEndDate).ToString(a.a.SessionManager.Preferences["Date Format"]),this.ScreenObject.CustomTab.Pages[o].Fields[e].Date=new Date(s[0].InsuranceEndDate.toString()))):this.ScreenObject.CustomTab.Pages[o].Fields[e]instanceof h.e?26415==this.ScreenObject.CustomTab.Pages[o].Fields[e].DBColumnID&&(n.e.IsEmpty(s[0].PolicyType)||(this.ScreenObject.CustomTab.Pages[o].Fields[e].SelectedValue=s[0].PolicyType.toString())):this.ScreenObject.CustomTab.Pages[o].Fields[e]instanceof u.d&&(26416==this.ScreenObject.CustomTab.Pages[o].Fields[e].DBColumnID?n.e.IsEmpty(s[0].PolicyNumber)||(this.ScreenObject.CustomTab.Pages[o].Fields[e].Text=s[0].PolicyNumber.toString()):26417==this.ScreenObject.CustomTab.Pages[o].Fields[e].DBColumnID?n.e.IsEmpty(s[0].Premium)||(this.ScreenObject.CustomTab.Pages[o].Fields[e].Text=s[0].Premium.toString()):26418==this.ScreenObject.CustomTab.Pages[o].Fields[e].DBColumnID&&(n.e.IsEmpty(s[0].Coverage)||(this.ScreenObject.CustomTab.Pages[o].Fields[e].Text=s[0].Coverage.toString())))}}GetTabGridDataXML(){return""}OnMessageCallBack(){this.res="Yes",this.RES="Yes"}onTabSelectionChanged(e){null!=this.ScreenObject.CustomTab.SelectedTab&&("Notes"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.SetVisibility(),this.NoteVisibility=!0,this.ViewNotes.OnShowNewNotes(null)):"Attachments"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.SetVisibility(),this.AttachmentVisibility=!0,this.ViewAttachments.OnShowNewAttachment(null)):"Purchase Details"!=this.ScreenObject.CustomTab.SelectedTab.Name&&"Maintenance"!=this.ScreenObject.CustomTab.SelectedTab.Name&&"Transaction History"!=this.ScreenObject.CustomTab.SelectedTab.Name&&"Dispose"!=this.ScreenObject.CustomTab.SelectedTab.Name&&"Insurance"!=this.ScreenObject.CustomTab.SelectedTab.Name||(this.SetVisibility(),this.DetailsVisibility=!0))}SetVisibility(){}OnAddValue(){1!=this.IsFullDispose?3!=this.IsFullDispose?(this.ChangeValue=new k(this),this.SetVisibility(),this.ChangeValueVisibility=!0,a.a.page.ShowDialog(this.ChangeValue,oe)):this.DisplayMessage="Already Sale Full Done":this.DisplayMessage="Already Dispose Full Done"}CallBack(e,t){let s=new n.f;if(s.LoadXml(e),"Maintain"==t){let e=this.ScreenObject.CustomTab.Pages.find(e=>"Maintain"==e.Name);if(e)for(let t=0;t<e.Fields.length;t++)e.Fields[t]instanceof c.a&&26410==e.Fields[t].DBColumnID&&(e.Fields[t].Text=s.SelectSingleNode("XML").attributes.NextStartDate.value,e.Fields[t].Date=new Date(s.SelectSingleNode("XML").attributes.NextStartDate.value))}else if("Insurance"==t){let e=this.ScreenObject.CustomTab.Pages.find(e=>"Insurance"==e.Name);if(null!=e)for(let t=0;t<e.Fields.length;t++)e.Fields[t]instanceof c.a?26413==e.Fields[t].DBColumnID?(e.Fields[t].Text=s.SelectSingleNode("Row").attributes.StartDate.value,e.Fields[t].Date=new Date(s.SelectSingleNode("Row").attributes.StartDate.value)):26414==e.Fields[t].DBColumnID&&(e.Fields[t].Text=s.SelectSingleNode("Row").attributes.EndDate.value,e.Fields[t].Date=new Date(s.SelectSingleNode("Row").attributes.EndDate.value)):e.Fields[t]instanceof p.b?26409==e.Fields[t].DBColumnID&&(e.Fields[t].SelectedValue=parseInt(s.SelectSingleNode("Row").attributes.VendorID.value)):e.Fields[t]instanceof h.e?26415==e.Fields[t].DBColumnID&&(e.Fields[t].SelectedValue=s.SelectSingleNode("Row").attributes.PolicyType.value):e.Fields[t]instanceof u.d&&(26417==e.Fields[t].DBColumnID?e.Fields[t].Text=s.SelectSingleNode("Row").attributes.Premium.value:26418==e.Fields[t].DBColumnID?e.Fields[t].Text=s.SelectSingleNode("Row").attributes.Coverage.value:26416==e.Fields[t].DBColumnID&&(e.Fields[t].Text=s.SelectSingleNode("Row").attributes.PolicyNo.value))}}OnTextChanged(e){}OnGroupChanged(e){if(0==this.objAsset.AMAssetID){if(this.ParentAsset.SelectedValue>0&&this.ParentAsset.SelectedValue!=this.ParentAsset.PreviousSelectedValue){this.ParentAsset.DefaultValue=this.ParentAsset.SelectedValue.toString();let e=a.a.common.GetDataTable("ASS001",this.ParentAsset.SelectedValue.toString());e.length>0&&(this.IgnoreClassLoad=!0,n.e.IsEmpty(e[0].ClassID)||(this.Class.SelectedValue=e[0].ClassID.toString()),"0"!=this.Class.SelectedValue&&(this.EnableControls(!1,1),this.EnableControls(!1,2),this.EnableControls(!1,3)),this.IgnoreClassLoad=!1,this.IgnoreFAGroupChange=!0,this.FAGroup.SelectedValue=null!=e[0].PostingGroupID?parseInt(e[0].PostingGroupID):0,this.EnableControls(!(this.FAGroup.SelectedValue>0),2),this.IgnoreFAGroupChange=!1,this.IgnoreDeprBookChange=!0,this.DeprBook.SelectedValue=n.e.String(e[0].DeprBookID),n.e.IsEmpty(this.DeprBook.SelectedValue)||"0"==this.DeprBook.SelectedValue?this.EnableControls(!0,3):this.EnableControls(!1,3),this.IgnoreDeprBookChange=!1),this.LoadTabFields(e),this.AutoGenerateCode()}this.ParentAsset.PreviousSelectedValue=this.ParentAsset.SelectedValue}}OnClassSelectionChanged(e){if(!this.IgnoreClassLoad){if(this.IgnoreClassLoad=!0,n.e.IsEmpty(this.Class.SelectedValue)||"0"==this.Class.SelectedValue)this.EnableControls(!0,1);else{let e=P.a.GetAssetClassDetails(parseInt(this.Class.SelectedValue));this.FAGroup.SelectedValue=null!=e.Tables[0][0].FAAccountsID?parseInt(e.Tables[0][0].FAAccountsID):0,a.a.SessionManager.IsWebApplication&&this.OnFAGroupSelectionChanged(this.FAGroup),this.DeprBook.SelectedValue=n.e.String(e.Tables[0][0].DeprBookID),a.a.SessionManager.IsWebApplication&&this.OnDeprBookChange(""),this.DeprPeriod.SelectedValue=n.e.String(e.Tables[0][0].DeprPosting),this.EstimateLife.Text=n.e.String(e.Tables[0][0].TotalYears),this.EnableControls(!1,1)}this.IgnoreClassLoad=!1}}OnFAGroupSelectionChanged(e){if(!this.IgnoreFAGroupChange&&!this.isFromEdit){if(this.FAGroup.SelectedValue>0){let e=P.a.GetPostingGroupDetails(this.FAGroup.SelectedValue);null!=e&&e.Tables.length>0&&e.Tables[0].length>0?(this.AcqnCostACCID.SelectedValue=parseInt(e.Tables[0][0].AcqnCostACCID.toString()),this.AccumDeprACCID.SelectedValue=parseInt(e.Tables[0][0].AccumDeprACCID.toString()),this.DeprExpenseACCID.SelectedValue=parseInt(e.Tables[0][0].DeprExpenseACCID.toString()),this.AcquisitionClearingAcc.SelectedValue=parseInt(e.Tables[0][0].AcqnCostDispACCID.toString()),this.DisposalClearingAcc.SelectedValue=parseInt(e.Tables[0][0].AccumDeprDispACCID.toString()),this.DisposalGainAcc.SelectedValue=parseInt(e.Tables[0][0].GainsDispACCID.toString()),this.DisposalLossAcc.SelectedValue=parseInt(e.Tables[0][0].LossDispACCID.toString()),this.MinorAssetExpenseAcc.SelectedValue=parseInt(e.Tables[0][0].MaintExpenseACCID.toString()),this.EnableControls(!1,2)):this.EnableControls(!0,2)}else this.EnableControls(!0,2);this.isFromEdit=!1}}OnDeprBookChange(e){if(!this.IgnoreDeprBookChange)if(n.e.IsEmpty(this.DeprBook.SelectedValue)||"0"==this.DeprBook.SelectedValue)this.EnableControls(!0,3);else{let e=P.a.GetDeprBookDetails(parseInt(this.DeprBook.SelectedValue));null!=e&&e.Tables.length>0&&e.Tables[0].length>0?(this.DeprMethod.SelectedValue=e.Tables[0][0].DeprBookMethod.toString(),this.DeprAvgMethod.SelectedValue=e.Tables[0][0].AveragingMethod.toString(),this.DeprSalvage.Currency.SelectedValue=e.Tables[0][0].SalvageValueType.toString(),this.DeprSalvage.ExchangeRate.Text=e.Tables[0][0].SalvageValue.toString(),this.DeprSalvageInCalc.SelectedValue=Object(o.j)(e.Tables[0][0].IncludeSalvageInDepr)?"1":"0",this.EnableControls(!1,3)):this.EnableControls(!0,3)}}EnableControls(e,t){this.AllowChangeOfFAAccounts||e&&0!=this.objAsset.AMAssetID||(1==t?(this.DeprPeriod.Enable=e,this.FAGroup.Enable=e,this.DeprBook.Enable=e):2==t?(null!=this.AcqnCostACCID&&(this.AcqnCostACCID.Enable=e),null!=this.AccumDeprACCID&&(this.AccumDeprACCID.Enable=e),null!=this.AcquisitionClearingAcc&&(this.AcquisitionClearingAcc.Enable=e),null!=this.DisposalClearingAcc&&(this.DisposalClearingAcc.Enable=e),null!=this.DisposalGainAcc&&(this.DisposalGainAcc.Enable=e),null!=this.DisposalLossAcc&&(this.DisposalLossAcc.Enable=e),null!=this.MinorAssetExpenseAcc&&(this.MinorAssetExpenseAcc.Enable=e),null!=this.DeprExpenseACCID&&(this.DeprExpenseACCID.Enable=e)):3==t&&(this.DeprMethod.Enable=e,this.EstimateLife.Enable=e,this.DeprAvgMethod.Enable=e,this.DeprSalvage.Enable=e))}CurrentValueCallBack(e){this.NetValue.Text=e.ToString(a.a.SessionManager.Preferences.DecimalsinAmount)}OnLocationCheckedChanged(e){this.BooksIn=this.GetBooks(this.DepreciationBooks)}GetBooks(e){let t=1,s=0,i="";for(;t<e.Items.length;t++)e.Items[t].IsChecked&&(0==s&&(i=""),i+=e.Items[t].Value+",",s++);return i.length>0&&(i=i.substr(0,i.length-1)+""),this.deprBooks=i,i}OnGridAddClick(e){if("Maintenance"==e.toString())this.MAddClick=!0,this.MEditClick=!1,this.SetVisibility(),this.Maintenance.ClearFields(this.AssetID),this.Maintenance.PostJV.Enable=!0,this.AddMaintenanceVisibility=!0;else if("Insurance"==e.toString())this.IAddClick=!0,this.IEditClick=!1,this.SetVisibility(),this.Insurance.ClearFields(),this.AddInsuranceVisibility=!0;else if("Dispose"==e.toString()){if(1==this.IsFullDispose)return void(this.DisplayMessage="Already Dispose Full Done");if(3==this.IsFullDispose)return void(this.DisplayMessage="Already Sale Full Done");this.DAddClick=!0,this.DEditClick=!1,this.SetVisibility(),this.Dispose=new w(this,this.NetValue.Text),this.AddDisposalVisibility=!0,a.a.page.ShowDialog(this.Dispose,ge)}else if("Dispose_Reversal"==e.toString()){if(!confirm("Do you really want to reverse dispose/sale."))return;this.objAsset.DisposeReverse(this.objAsset.AMAssetID).obj>0?(alert("Dispose Reversal Done."),this.ClearAfterSave()):this.DisplayMessage="Error in Dispose Reversal."}}OnSave(e){return Object(i.b)(this,void 0,void 0,(function*(){if("ChangeValue"==e)this.ChangeValue=new k(this),this.SetVisibility(),this.ChangeValueVisibility=!0;else if("Copy"==e.toString()){const{CopyProductViewModel:e}=yield s.e(51).then(s.bind(null,"LSMh"));let t=new e(this);const{CopyProductComponent:i}=yield s.e(175).then(s.bind(null,"hIrt"));a.a.page.ShowDialog(t,i,{ShowCenter:!0,Title:a.a.GetResource("Copy")})}else if("AssetSchedule"==e){if(!(this.AssetID>0))return void(this.DisplayMessage="Cannot Schedule Un saved Assets");this.AssetScheduleDepr=new F(this),this.SetVisibility(),this.AssetScheduleDeprVisibility=!0}else if("ScheduleDepreciation"==e){let e=Date.Today();this.CDeprStartDate.Date&&(e=null!=this.DeprAvgMethod&&"3"==this.DeprAvgMethod.SelectedValue?this.CDeprStartDate.Date.AddDays(1-this.CDeprStartDate.Date.getDate()):this.CDeprStartDate.Date),a.a.page.ShowDialog(new Y(this,e),U,{ShowCenter:!a.a.IsMobile,HideClose:!0,NoWidth:!0}).subscribe(e=>{1!=this.DeprFilterCheck&&(null==this.Schedules&&(this.Schedules=new E.a,this.Schedules.DepreciationScheduleViewModel_1(this)),this.RefreshAssetDataSet(),this.Schedules.LoadData(this.ds,this.DeprFromDate,this.DeprToDate),setTimeout(()=>{a.a.page.ShowDialog(this.Schedules,R,{ShowCenter:!0})},50))})}else if("Save"==e){if(a.a.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&"True"==a.a.SessionManager.Preferences.EnableDivisionWise.toString()&&a.a.SessionManager.Preferences.ContainsKey("DW Assets")&&""!=a.a.SessionManager.Preferences["DW Assets"]&&Object(o.j)(a.a.SessionManager.Preferences["DW Assets"])){let e=!1,t=null,s=!1;for(let i=0;i<this.ScreenObject.CustomTab.Pages.length;i++){let a=this.ScreenObject.CustomTab.Pages[i];if(a.Fields.length>0)for(let i=0;i<a.Fields.length;i++){let n=a.Fields[i];if(n instanceof p.b&&null!=n.DBColumnName&&n.DBColumnName.toLowerCase().Contains("ccnid")&&"ccnid1"==n.DBColumnName.toLowerCase()&&(s=!0,t=n,0==t.SelectedValue||null==t.SelectedValue)){e=!0;break}}if(e)break}if(s&&e)return void(this.DisplayMessage="Division wise Assets exist, Select Division");if(!s)return void(this.DisplayMessage="Division wise Assets exist, Add Field")}if(a.a.SessionManager.Preferences.ContainsKey("DimensionwiseAssets")&&""!=a.a.SessionManager.Preferences.DimensionwiseAssets&&parseInt(a.a.SessionManager.Preferences.DimensionwiseAssets)>0){let e=0,t=!1;e=parseInt(a.a.SessionManager.Preferences.DimensionwiseAssets);for(let s=0;s<this.ScreenObject.CustomTab.Pages.length;s++){let i=this.ScreenObject.CustomTab.Pages[s];if(i.Fields.length>0)for(let s=0;s<i.Fields.length;s++){let a=i.Fields[s];if(a instanceof p.b&&null!=a.DBColumnName&&a.DBColumnName.toLowerCase().Contains("ccnid")&&a.CCID==e){t=!0;let e=a;if(0==e.SelectedValue||null==e.SelectedValue)return void(this.DisplayMessage="Dimension wise Assets exist, Select "+e.Label)}}}if(!t)return void(this.DisplayMessage="Dimension wise Assets exists")}if(a.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"True"==a.a.SessionManager.Preferences.EnableLocationWise.toString()&&a.a.SessionManager.Preferences.ContainsKey("LW Assets")&&""!=a.a.SessionManager.Preferences["LW Assets"]&&Object(o.j)(a.a.SessionManager.Preferences["LW Assets"])&&50002==this.Location.CCID&&(0==this.Location.SelectedValue||null==this.Location.SelectedValue))return void(this.DisplayMessage="Location wise Assets exist, Select Location");try{let e=this.ScreenObject.ValidateData();if(!n.e.IsEmpty(e))return void(this.DisplayMessage=e);this.EstLife="",this.SalValue="",this.DeprStartDate=Date.Today(),this.CDeprStartDate.Date&&(this.DeprStartDate=this.CDeprStartDate.Date);let t=0;if(0==this.objAsset.AMAssetID){let e={StrCode:this.objAsset.AMCode,CodePrefix:this.objAsset.CodePrefix,CodeNumber:this.objAsset.CodeNumber};if(this.DisplayMessage=this.ScreenObject.SetAutoCodeParams_3(this.Code,this.objAsset.SelectedNodeID,this.ScreenObject.Data.Tables[6],e),this.objAsset.AMCode=e.StrCode,this.objAsset.CodePrefix=e.CodePrefix,this.objAsset.CodeNumber=e.CodeNumber,this.DisplayMessage.length>0)return}else this.objAsset.AMCode=this.Code.Text;if(0==this.objAsset.AMAssetID&&this.ScreenObject.IsAutoName){this.Name.Enable=!1;let e=this.ScreenObject.Data.Tables[6].filter(e=>1==e.IsName);this.ScreenObject.IsName=!0,e.length>0&&(this.Name.Text=this.ScreenObject.SetAutoCodeParams_1(this.Name,this.objAsset.SelectedNodeID,e))}if(null==this.Name.Text||""==this.Name.Text)return void(this.DisplayMessage="Enter Name");if(this.objAsset.AMName=this.Name.Text,""==this.Status.SelectedValue)return void(this.DisplayMessage="Select Status");this.objAsset.AMStatusID=parseInt(this.Status.SelectedValue);let s=0;if(null!=this.PreviousDepreciation){if(n.e.IsEmptySpace(this.PreviousDepreciation.Text)&&(this.PreviousDepreciation.Text="0"),!n.e.IsNum(this.PreviousDepreciation.Text))return void(this.DisplayMessage="Only Numeric Characters allowed in Previous Depreciation");if(s=parseFloat(this.PreviousDepreciation.Text),s>0&&!this.OriginalDeprStartDate.Date)return void(this.DisplayMessage="Please Select "+this.OriginalDeprStartDate.Label)}if(null!=this.PurchaseValue){if(n.e.IsEmptySpace(this.PurchaseValue.Text)&&(this.PurchaseValue.Text="0"),!n.e.IsNum(this.PurchaseValue.Text))return void(this.DisplayMessage="Only Numeric Characters allowed in PurchaseValue");this.objAsset.AMPurchaseValue=this.PurchaseValue.Text}if(null!=this.DeprStartValue&&(n.e.IsEmptySpace(this.DeprStartValue.Text)&&(this.DeprStartValue.Text="0"),!n.e.IsNum(this.DeprStartValue.Text)))return void(this.DisplayMessage="Only Numeric Characters allowed in CurrentValue");if(this.objAsset.DeprStartValue=this.GetDeprStartValue(),this.objAsset.DeprStartValue<0)return void(this.DisplayMessage="Negative Depreciation Start Value");if(Math.abs(s+this.objAsset.DeprStartValue-parseFloat(this.objAsset.AMPurchaseValue))>=1)return void(this.DisplayMessage="Purchase value should be equal with (Previous Depreciation + Depreciation Start Value)");if(this.EstLife=this.EstimateLife.Text,n.e.IsEmptySpace(this.EstimateLife.Text))return void(this.DisplayMessage="Enter EstimatedLife in Depreciation Tab");let i=this.EstLife.split("."),o=0,l=0,r=0;if(o=n.e.Int(i[0]),o<0&&(o=0),i.length>1&&(l=n.e.Int(i[1]),l<0&&(l=0)),i.length>2&&(r=n.e.Int(i[2])),this.EstLife=r>0?o+"."+l.toString()+"."+r.toString():l>0?o+"."+l.toString():o.toString(),this.EstimateLife.Text=this.EstLife,"2"==this.DeprSalvage.Currency.SelectedValue){if(n.e.IsEmptySpace(this.DeprSalvage.ExchangeRate.Text)||"0"==this.DeprSalvage.ExchangeRate.Text)return void(this.DisplayMessage="Select Salvage percentage in Depreciation Tab");this.SalValue=(parseFloat(this.DeprSalvage.ExchangeRate.Text)*(this.objAsset.DeprStartValue+s)/100).toString()}else this.SalValue=this.DeprSalvage.ExchangeRate.Text;if(0==this.ParentAsset.SelectedValue)return void(this.DisplayMessage="Select Group");this.objAsset.AMParentAssetID=this.ParentAsset.SelectedValue,this.iTotalQtyPurchaseLoop=0;let h=0;if(this.iTotalQtyPurchaseLoop=n.e.Int(this.TotalQtyPurchase.Text),h=this.iTotalQtyPurchaseLoop,0==this.objAsset.AMAssetID&&this.iTotalQtyPurchaseLoop>1&&this.TotalQtyPurchaseIgnoreSpaces.IsChecked&&(this.iTotalQtyPurchaseLoop=1),this.objAsset.DetailsXML=this.GetDetailXML(h),this.objAsset.CustomFieldsQuery=this.ScreenObject.GetCustomFieldsQuery(),this.objAsset.CustomCostCenterFieldsQuery=this.ScreenObject.GetCustomCostCenterFieldsQuery(),this.objAsset.HistoryXML=this.ScreenObject.HistoryCCXML,!this.objAsset.AMGroup){let e;if(e=n.e.Double(this.PurchaseValue.Text),e<=0)return void(this.DisplayMessage="Enter PurchaseValue in PurchaseDetail Tab");let t=this.SalValue;null!=this.DeprSalvageInCalc&&"1"==this.DeprSalvageInCalc.SelectedValue&&(t="0");let i={ErrorMessage:""};if("1"==this.DeprSchedule.SelectedValue?(0==this.objAsset.AMAssetID||0==this.ds.Tables[10].length&&1!=this.IsFullDispose&&3!=this.IsFullDispose)&&(this.objAsset.DepreciationXML=this.GetDepreciationXML(this.objAsset.DeprStartValue,this.EstLife,this.OriginalDeprStartDate.Date,s,t,this.DeprPeriod.SelectedValue,this.DeprStartDate,this.DeprMethod.SelectedValue,this.DeprAvgMethod.SelectedValue,i)):this.objAsset.DepreciationXML="",i.ErrorMessage.length>0)return void(this.DisplayMessage=i.ErrorMessage)}if(this.objAsset.NotesXML=this.ViewNotes.GetXML(),this.objAsset.AttachmetsXML=this.ViewAttachments.GetXML(),this.objAsset.AttachmetsXML+=this.ScreenObject.GetExtraAttachmentXML(),0==this.objAsset.AMAssetID&&this.iTotalQtyPurchaseLoop>1&&this.TotalQtyPurchaseIgnoreSpaces.IsChecked){let e=new ye(this.iTotalQtyPurchaseLoop,this.Code.Text);a.a.page.ShowDialog(e,Ve).subscribe(t=>{e.DialogResult?(this.iCntLoop=0,this.strMessageLoop="",this.SnoSave_CallBack(e)):this.DisplayMessage="Please enter serial nos"})}else this.objAsset.Sno=this.Sno.Text,this.objAsset.SetAssetManagementDetails().then(e=>{this.DisplayMessage=e.Message,t=e.RetValue,this.RetValue=t,t>0&&this.ClearAfterSave()})}catch(t){Logger.ErrorLog("AddEditAssetViewModel:: OnSAVE",t)}}}))}SnoSave_CallBack(e){if(this.iCntLoop>=this.iTotalQtyPurchaseLoop)return void this.SnoSave_CallBackComplete();this.objAsset.Sno=e.GridData[this.iCntLoop].SerialNumber.toString(),this.iCntLoop>0&&(this.Code.Enable=!1);let t={StrCode:this.objAsset.AMCode,CodePrefix:this.objAsset.CodePrefix,CodeNumber:this.objAsset.CodeNumber};this.strMessageLoop=this.ScreenObject.SetAutoCodeParams_3(this.Code,this.objAsset.SelectedNodeID,this.ScreenObject.Data.Tables[6],t),this.objAsset.AMCode=t.StrCode,this.objAsset.CodePrefix=t.CodePrefix,this.objAsset.CodeNumber=t.CodeNumber,this.strMessageLoop.length>0||this.objAsset.SetAssetManagementDetails().then(t=>{this.strMessageLoop=t.Message,this.RetValue=t.RetValue,this.RetValue<0?this.SnoSave_CallBackComplete():(this.iCntLoop++,this.SnoSave_CallBack(e))})}SnoSave_CallBackComplete(){this.iCntLoop>0&&(this.iCntLoop<this.iTotalQtyPurchaseLoop&&(null!=this.strMessageLoop?this.strMessageLoop+="\r\n"+this.iCntLoop+" Assets Saved":this.strMessageLoop="\r\n"+this.iCntLoop+" Assets Saved"),this.ClearAfterSave()),this.DisplayMessage=this.strMessageLoop}ClearAfterSave(){this.IsFullDispose=0,this.IsDeprScheduleExists=!1,this.objAsset.AMAssetID=0,this.ClearingFields(),this.ParentAsset.PreviousSelectedValue=0,this.ParentAsset.Enable=!0,this.ScreenObject.Clear(),this.OnGroupChanged(null),null!=this.Parent&&this.Parent.Refresh(),this.MaintainGrid.Clear(),this.InsuranceGrid.Clear(),this.DisposeGrid.Clear(),this.ViewNotes.NotesListObj.Clear(),this.ViewAttachments.AttachmentsList.Clear(),this.AddingRowsToTabGrid(),this.objAsset.AMAssetID=0,this.DisplayName=this.objAsset.AMGroup?"Add Asset Group":a.a.GetResource("AssetManagement_AddAsset")}GetDepreciationXML(e,t,s,i,a,o,l,r,h,c){c.ErrorMessage="";let u,D=0,d=0,b=0;try{let e=t.split(".");D=n.e.Int(e[0]),e.length>1&&(d=n.e.Int(e[1])),e.length>2&&(b=n.e.Int(e[2]))}catch(S){}if(D<=0&&d<=0&&b<=0)return e>0&&(c.ErrorMessage="Enter EstimatedLife in Depreciation Tab"),"";if(b>0&&"3"==h)return c.ErrorMessage="Mid-Month method can not be applied if estimated life provided with days.","";let p=l;u=p.AddYears(D),u=u.AddMonths(d),u=u.AddDays(b),u=u.AddDays(-1);let m=new f.b(this.AssetID);return m.CallFromAssetSave=!0,m.GetScheduleData(e,D,d,b,s,i,parseFloat(a),r,o,0,h,p,u,null,this.DeprBook.SelectedValue),c.ErrorMessage=m.ErrorMessage,m.GetXML()}GetXML(e){let t,s,i="",a="";a+="<Row ",n.e.IsEmpty(this.Description.Tag)?a+=' Description="'+u.d.GetValidXml(this.Description.Text)+'"':a+=' Description="'+u.d.GetValidXml(this.Description.Tag)+'"',a+=' Sno="'+this.Sno.Text+'"',a+=' deprBooks="'+this.deprBooks+'"',a+=""!=this.Class.SelectedValue?' Class="'+parseInt(this.Class.SelectedValue)+'"':' Class="0"',a+=' PostingGroupID="'+this.FAGroup.SelectedValue+'"',n.e.IsEmpty(this.DeprBook.SelectedValue)?a+=' DeprBookID="0"':a+=' DeprBookID="'+parseInt(this.DeprBook.SelectedValue)+'"',a+=0!=this.Location.SelectedValue?' Location="'+this.Location.SelectedValue+'"':' Location="1"',a+=0!=this.Employee.SelectedValue?' Employee="'+this.Employee.SelectedValue+'"':' Employee="0"',a+=' TotalQtyPurchase="'+e+'" ';for(let o=0;o<this.ScreenObject.CustomTab.Pages.length;o++){let e=this.ScreenObject.CustomTab.Pages[o];for(let o=0;o<e.Fields.length;o++){let l=e.Fields[o];if(["Purchase Details","Depreciation","FA Accounts","Maintenance","Insurance"].Contains(e.Name)&&l instanceof I.c&&null!=l.DBColumnName)if(l instanceof u.d)if(t=l.Text,n.e.IsEmpty(t)&&(t="",s=null),24064==l.DBColumnID&&(i=t),26398!=l.DBColumnID||""!=l.Text&&0!=parseFloat(l.Text))a+=l.DBColumnName+'="'+t.Replace("'","''")+'" ';else{let e=0,t=0;null!=this.PurchaseValue&&(e=n.e.Double(this.PurchaseValue.Text)),null!=this.PreviousDepreciation&&(t=n.e.Double(this.PreviousDepreciation.Text)),a+=l.DBColumnName+'="'+(e-t)+'" '}else l instanceof h.e?(t=l.SelectedValue,n.e.IsEmpty(t)&&(t=""),a+=l.DBColumnName+'="'+t+'" ',25479==l.DBColumnID&&null!=l.SelectedItem&&(a+='SalvageValueName="'+l.SelectedItem.Name+'" ')):l instanceof c.c||l instanceof c.a?(t=n.e.IsEmpty(l.Date)?"":l.Date.ToString("dd/MMM/yyyy"),a+=l.DBColumnName+'="'+t+'" '):l instanceof p.b&&(this.oPactCombo=l,a+=this.oPactCombo.DBColumnName+'="'+this.oPactCombo.SelectedValue+'" ')}}return a+='SalvageValueType="'+this.DeprSalvage.Currency.SelectedValue+'" ',a+='SalvageValueName="'+this.DeprSalvage.Currency.Text+'" ',a+='SalvageValue="'+this.DeprSalvage.ExchangeRate.Text+'" ',a+=" />",a.toString()}GetDetailXML(e){let t,s="",i=null,a="";return n.e.IsEmpty(this.Description.Tag)?a+=" Description=N'"+u.d.GetValidXml(this.Description.Text)+"',":a+=" Description=N'"+u.d.GetValidXml(this.Description.Tag)+"',",a+=" SerialNo=N'"+this.Sno.Text+"',",a+=" DeprBookGroupID=N'"+this.deprBooks+"',",a+=""!=this.Class.SelectedValue?" ClassID="+parseInt(this.Class.SelectedValue)+",":" ClassID=0,",a+=" PostingGroupID="+this.FAGroup.SelectedValue+",",n.e.IsEmpty(this.DeprBook.SelectedValue)?a+=" DeprBookID=0,":a+=" DeprBookID="+parseInt(this.DeprBook.SelectedValue)+",",a+=0!=this.Location.SelectedValue?" LocationID="+this.Location.SelectedValue+",":" LocationID=1,",a+=0!=this.Employee.SelectedValue?" EmployeeID="+this.Employee.SelectedValue+",":" EmployeeID=0,",a+=" TotalQtyPurchase="+e+",",this.ScreenObject.CustomTab.Pages.forEach(e=>{e.Fields.forEach(o=>{if(["Purchase Details","Depreciation","FA Accounts","Maintenance","Insurance"].Contains(e.Name)&&o instanceof I.c&&null!=o.DBColumnName)if(o instanceof u.d)if(t=o.Text,n.e.IsEmpty(t)&&(t="",i=null),24064==o.DBColumnID&&(s=t),26398!=o.DBColumnID||""!=o.Text&&0!=parseFloat(o.Text))a+=o.DBColumnName+"=N'"+t+"',";else{let e=0,t=0;null!=this.PurchaseValue&&(e=n.e.Double(this.PurchaseValue.Text)),null!=this.PreviousDepreciation&&(t=n.e.Double(this.PreviousDepreciation.Text)),a+=o.DBColumnName+"=N'"+(e-t)+"',"}else o instanceof h.e?(t=o.SelectedValue,n.e.IsEmpty(t)&&(t=""),a+=o.DBColumnName+"=N'"+t+"',",25479==o.DBColumnID&&null!=o.SelectedItem&&(a+="SalvageValueName=N'"+o.SelectedItem.Name+"',")):o instanceof c.c?(t=o.Date.toString(),n.e.IsEmpty(t)&&(t=""),""!=t&&(t=new Date(t).ToString("dd/MMM/yyyy"),t=" convert(float,convert(datetime,'"+t+"'))",a+=o.DBColumnName+"="+t+",")):o instanceof c.a?(t=o.Date.ToString("dd/MMM/yyyy"),n.e.IsEmpty(t)&&(t=""),""!=t&&(t=new Date(t).ToString("dd/MMM/yyyy"),t=" convert(float,convert(datetime,'"+t+"'))",a+=o.DBColumnName+"="+t+",")):o instanceof p.b&&(this.oPactCombo=o,this.oPactCombo.CCID<5e4&&(a+=this.oPactCombo.DBColumnName+"="+this.oPactCombo.SelectedValue+","))})}),a+="SalvageValueType=N'"+this.DeprSalvage.Currency.SelectedValue+"',",a+="SalvageValueName=N'"+this.DeprSalvage.Currency.Text+"',",a+="SalvageValue=N'"+this.DeprSalvage.ExchangeRate.Text+"',",a.toString()}ClearingFields(){this.isFromEdit=!1,this.ChgVisibility=!1,this.DepreciationVisibility=!1,this.ScheduleVisibility=!1,null!=this.CDeprStartDate&&(this.CDeprStartDate.Enable=!0),this.Code.Text="",this.Name.Text="",this.Description.Text="",this.Sno.Text="",this.NetValue.Text="0";for(let e=0;e<this.DepreciationBooks.Items.length;e++)this.DepreciationBooks.Items[e].IsChecked=!1;this.Location.Clear(0),this.oLocationHistory=null,this.Employee.Clear(0),this.oOwnerHistory=null,this.ViewTransactionHistory.TransactionHisInfoObj.Clear(),null!=this.DeprStartValue&&(this.DeprStartValue.Enable=!0),null!=this.PurchaseValue&&(this.PurchaseValue.Enable=!0),null!=this.PreviousDepreciation&&(this.PreviousDepreciation.Enable=!0),null!=this.EstimateLife&&(this.EstimateLife.Enable=!0),null!=this.DeprSchedule&&(this.DeprSchedule.Enable=!0),null!=this.EstimateLife&&(this.EstimateLife.Enable=!0),null!=this.DeprMethod&&(this.DeprMethod.Enable=!0),null!=this.DeprSalvageInCalc&&(this.DeprSalvageInCalc.Enable=!0),null!=this.DeprAvgMethod&&(this.DeprAvgMethod.Enable=!0),null!=this.DeprSalvage&&(this.DeprSalvage.Enable=!0),null!=this.DeprPeriod&&(this.DeprPeriod.Enable=!0)}OnCustomizeExtraFields(e){"Customize"==e.toString()&&(Logger.InfoLog("AddEditAssetViewModel::Entering OnCustomize"),Logger.InfoLog("AddEditAssetViewModel::Exiting OnCustomize"))}LoadData(){let e=new Array;e.push(h.d.ComboBoxItems_2("Add by Value","0")),e.push(h.d.ComboBoxItems_2("Add by %","1")),this.TranColumnSource=new Array;let t=new b.a;t=new b.a,t.Header=a.a.GetResource("Sno"),t.DisplayMember="Sno",t.DataType="TextBlock",t.Width=40,t.ReadOnly=!0,t.IsFrozen=!0,this.TranColumnSource.push(t),t=new b.a,t.Header=a.a.GetResource("AssetManagement_Type"),t.ValueBinding="Type",t.DisplayMember="Name",t.ValueMember="Value",t.DataType="Combobox",t.Width=150,t.ComboData=e,this.TranColumnSource.push(t),t=new b.a,t.Header="Date",t.DisplayMember="Date",t.DataType="DATE",t.Width=180,this.TranColumnSource.push(t),t=new b.a,t.Header="OldValue",t.DisplayMember="OldValue",t.DataType="TextBlock",t.Width=180,this.TranColumnSource.push(t),t=new b.a,t.Header="+/-",t.DisplayMember="Difference",t.DataType="TextBlock",t.Width=180,this.TranColumnSource.push(t),t=new b.a,t.Header="NewValue",t.DisplayMember="NewValue",t.DataType="TextBlock",t.Width=180,this.TranColumnSource.push(t),t=new b.a,t.Header="Location",t.DisplayMember="Location",t.ValueMember="Location_Key",t.DataType="LISTBOX",t.Width=180,t.TypeID=1,t.CostCenterID=50002,this.TranColumnSource.push(t),this.TranHistoryGridData=[],this.TranHistoryGridDataObj.TableColumns.push("Sno"),this.TranHistoryGridDataObj.TableColumns.push("Type"),this.TranHistoryGridDataObj.TableColumns.push("Date"),this.TranHistoryGridDataObj.TableColumns.push("OldValue"),this.TranHistoryGridDataObj.TableColumns.push("+/-"),this.TranHistoryGridDataObj.TableColumns.push("NewValue"),this.TranHistoryGridDataObj.TableColumns.push("Location"),this.TranHistoryGridDataObj.TableColumns.push("Location_Key");for(let s=0;s<5;s++)this.TranHistoryGridDataObj.addEmptyRow(),this.UpdateSequence(this.TranHistoryGridData);for(let s=this.ScreenObject.CustomTab.Pages.length-1;s>=0;s--){let e=this.ScreenObject.CustomTab.Pages[s];switch(e.Name){case"Notes":e.Fields.push(this.ViewNotes);break;case"Attachments":e.Fields.push(this.ViewAttachments);break;case"Maintenance":e.Fields.push(this.ViewMaintenance);break;case"Insurance":e.Fields.push(this.ViewInsurance);break;case"Transaction History":e.Fields.push(this.ViewTransactionHistory),this.Trans=e}}}UpdateSequence(e){this.SNo=1,e.forEach(e=>{e.Sno=this.SNo++})}AutoGenerateCode(){if(this.objAsset.SelectedNodeID=this.ParentAsset.SelectedValue>0?this.ParentAsset.SelectedValue:this.ParentID,this.ScreenObject.SetAutoCode(this.Code,this.objAsset.AMGroup,this.objAsset.SelectedNodeID,this.ScreenObject.Data.Tables[6]),this.ScreenObject.IsAutoName){this.ScreenObject.IsNameAutoGenerate=!0,this.Name.Enable=!1;let e=this.ScreenObject.Data.Tables[6].filter(e=>1==e.IsName);this.ScreenObject.IsName=!0,e.length>0&&(this.Name.Text=this.ScreenObject.SetAutoCodeParams_1(this.Name,this.objAsset.SelectedNodeID,e))}}LoadTabFields(e){if(null!=e&&e.length>0)try{for(let t=0;t<this.ScreenObject.CustomTab.Pages.length;t++){let s=this.ScreenObject.CustomTab.Pages[t];for(let t=0;t<s.Fields.length;t++){let i=s.Fields[t];i instanceof I.c&&null!=i.DBColumnName&&!Object(A.isUndefined)(e[0][i.DBColumnName])&&(i instanceof u.d?i.Text=n.e.String(e[0][i.DBColumnName]):i instanceof h.e?i.SelectedValue=147==i.DBColumnID?Object(o.j)(e[0][i.DBColumnName])?"1":"0":n.e.String(e[0][i.DBColumnName]):i instanceof u.c?i.Text=n.e.String(e[0][i.DBColumnName]):i instanceof c.c||i instanceof c.a?n.e.isValidDate(e[0][i.DBColumnName])&&(i.Date=new Date(e[0][i.DBColumnName])):i instanceof V.a?i.Text=n.e.String(e[0][i.DBColumnName]):i instanceof p.b?n.e.IsNum(e[0][i.DBColumnName])&&(i.SelectedValue=parseInt(e[0][i.DBColumnName])):i instanceof r.b&&(i.ExchangeRate.Text=n.e.String(e[0].SalvageValue),i.Currency.SelectedValue=n.e.String(e[0].SalvageValueType)))}}}catch(t){Logger.ErrorLog("AssetManagement:: LoadTabFields : ",t)}}GetDeprStartValue(){let e;if(e=n.e.Double(this.DeprStartValue.Text),0==e&&(e=n.e.Double(this.PurchaseValue.Text),null!=this.PreviousDepreciation)){let t=0;t=n.e.Double(this.PreviousDepreciation.Text),e-=t}return e}GetPrevDeprValue(){let e=0;if(null!=this.PreviousDepreciation)return e=n.e.Double(this.PreviousDepreciation.Text),e;{let t,s;t=n.e.Double(this.DeprStartValue.Text),0!=t&&(s=n.e.Double(this.PurchaseValue.Text),0!=s&&(e=s-t))}return e}OnLocationClick(e){if(this.DisplayMessage="",null==this.oLocationHistory){this.oLocationHistory=new M.a(e);for(let t=0;t<this.ScreenObject.CustomTab.Pages.length&&(this.oLocationHistory.lstExtraField=this.ScreenObject.CustomTab.Pages[t].Fields.find(t=>t instanceof p.b&&t.CCID==e.CCID),!this.oLocationHistory.lstExtraField);t++);this.AssetID>0&&this.oLocationHistory.LoadEditData(this.ds.Tables[7],this.ds.Columns[7])}a.a.page.ShowDialog(this.oLocationHistory,B.a,{ShowCenter:!a.a.IsMobile,Title:a.a.GetResource("History"),NoWidth:!0})}OnOwnerClick(e){this.DisplayMessage="",0!=e.CCID?(null==this.oOwnerHistory&&(this.oOwnerHistory=new M.a(e),this.AssetID>0&&this.oOwnerHistory.LoadEditData(this.ds.Tables[3],this.ds.Columns[3])),a.a.page.ShowDialog(this.oOwnerHistory,B.a,{ShowCenter:!a.a.IsMobile,Title:a.a.GetResource("History"),NoWidth:!0})):this.DisplayMessage="Please Set Asset Owner Dimension At Asset Preferences"}OnLabelClick(e){"EstimateLife"==e.DBColumnName&&this.EstimateLife.Enable&&a.a.page.ShowDialog(new Y(this,this.DeprFromDate,!0),U,{ShowCenter:!a.a.IsMobile,HideClose:!0,NoWidth:!0})}RefreshAssetDataSet(){this.ds=P.a.GetAssetManagementDetails(this.AssetID),null!=this.ds&&this.ds.Tables.length>10&&(this.dtDepr=this.ds.Tables[10])}GetCCXML(){let e=1,t=null!=Location&&this.Location.CCID>5e4?this.Location.CCID-5e4:2;null!=Location&&0!=this.Location.SelectedValue&&(e=this.Location.SelectedValue);let s=0,i=1;n.e.IsEmpty(this.ds.Tables[4][0].AssetDimNodeID)||(s=parseInt(this.ds.Tables[4][0].AssetDimID),i=parseInt(this.ds.Tables[4][0].AssetDimNodeID),0==i&&(i=1),s>5e4&&(s-=5e4));let a="";if(this.ds.Tables[17].length>0){let e=this.ScreenObject.Data.Tables[0].filter(e=>e.SysColumnName.startsWith("CCNID")&&e.ColumnCostCenterID>5e4);for(let i=0;i<e.length;i++){let o,l=e[i].SysColumnName.toString();o=n.e.Int(l.replace("CCNID","")),o!=t&&o!=s&&o>0&&(a+=",dcCCNID"+o+"="+this.ds.Tables[17][0]["CCNID"+o].toString())}}let o='<CostCenters  Query="dcCCNID'+t+"="+e;return s>0&&(o+=",dcCCNID"+s+"="+i),o+=a,o+=',"  />',o}}class Me{constructor(e){this.Parent=e,this.Book=new h.e(0),this.WEF=new c.a(0),this.Book.SelectionChangedCommand.Subscribe(this,"OnBookChange"),this.ColumnSpan="4",this.Row="2",this.Column="0",e.ds.Tables[2].forEach(e=>{this.Book.Items.push(h.d.ComboBoxItems_2(e.DeprBookName.toString(),e.DeprBookID.toString()))}),this.BooksGrid=new d.a,this.BooksGrid.Table=[],this.BooksGrid.Width="",this.BooksGrid.TableColumns.push("Sno"),this.BooksGrid.TableColumns.push("DeprBookID"),this.BooksGrid.TableColumns.push("DeprBook"),this.BooksGrid.TableColumns.push("WEF_Key"),this.BooksGrid.TableColumns.push("WEF"),this.BooksGrid.Columns=new Array;let t=new b.a;t.Header=a.a.GetResource("Sno"),t.DisplayMember="Sno",t.ReadOnly=!0,t.Width=50,this.BooksGrid.Columns.push(t),t=new b.a,t.Header="Depreciation Book",t.DisplayMember="DeprBook",t.DataType="TEXTBOX",t.ReadOnly=!0,t.Width=180,this.BooksGrid.Columns.push(t),t=new b.a,t.Header="WEF",t.DisplayMember="WEF",t.DataType="TEXTBOX",t.ReadOnly=!0,t.Width=110,this.BooksGrid.Columns.push(t);for(let s=0;s<6;s++)this.BooksGrid.addEmptyRow()}OnButtonClick(e){if(!n.e.IsEmpty(this.Book.SelectedValue)){let e=0;for(e=0;e<this.BooksGrid.Table.length&&!Object(A.isNullOrUndefined)(this.BooksGrid.Table[e].DeprBookID);e++);e==this.BooksGrid.Table.length&&this.BooksGrid.addEmptyRow();let t=this.BooksGrid.Table[e];t.Sno=e+1,t.DeprBookID=this.Book.SelectedValue,t.DeprBook=this.Book.SelectedItem.Name,t.WEF_Key=this.WEF.Date,t.WEF=this.WEF.Date.ToString(a.a.SessionManager.Preferences["Date Format"])}}OnBookChange(e){if(!n.e.IsEmpty(this.Book.SelectedValue)&&null!=this.Book.SelectedItem){let e=P.a.GetDeprBookDetails(parseInt(this.Book.SelectedValue));null!=e&&e.Tables.length>0&&e.Tables[0].length>0?(this.Parent.DeprMethod.SelectedValue=e.Tables[0][0].DeprBookMethod.toString(),this.Parent.EstimateLife.Text=e.Tables[0][0].BasedOnValue.toString(),this.Parent.DeprAvgMethod.SelectedValue=e.Tables[0][0].AveragingMethod.toString(),this.EnableControls(!1)):this.EnableControls(!0)}}EnableControls(e){this.Parent.DeprMethod.Enable=e,this.Parent.EstimateLife.Enable=e,this.Parent.DeprAvgMethod.Enable=e}}}}]);