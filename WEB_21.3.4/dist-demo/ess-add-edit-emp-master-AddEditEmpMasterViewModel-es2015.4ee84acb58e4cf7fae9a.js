(window.webpackJsonp=window.webpackJsonp||[]).push([[163,214],{"4k0m":function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var s=i("Do2H"),a=i("ScVY"),l=i("EQd/"),n=i("0/4Q");class o extends a.b{constructor(e,t,i,a){super(),this.Remarks=new l.c(0),this.CostCenterID=0,this.NodeID=0,this.Parent=null,this.retValWeb=0,this.IsUpdated=!1,this.CostCenterID=e,this.NodeID=t,this.Parent=a,this.ScreenObject=i,this.Remarks.Label=s.a.GetResource("Remarks")}SaveStatus(e,t,i,s=!0){let a=!1,l=null;"MonthlyPayrollViewModel"==this.Parent.ClassName?(l=this.Parent.SetDocStatus(e,t,i,new Date,this.Remarks.Text,!0,""),null!=l&&l.Tables.length>0&&l.Tables[0].length>0&&l.Columns[0].Contains("status")&&(this.Parent.DocStatus="["+l.Tables[0][0].status.toString()+"]",a=!0),null!=l&&l.Tables.length>0&&l.Tables[l.Tables.length-1].length>0&&l.Columns[l.Tables.length-1].Contains("ErrorMessage")&&(this.Parent.this.DisplayMessage=l.Tables[l.Tables.length-1][0].ErrorMessage.toString()),this.Parent.this.MessageVisibility=!0,a&&this.Parent.btnClear_Click()):"FinalSettlementViewModel"==this.Parent.ClassName&&(l=this.Parent.SetDocStatus(e,t,i,new Date,this.Remarks.Text,!0,""),null!=l&&l.Tables.length>0&&l.Tables[0].length>0&&l.Columns[0].Contains("status")&&(this.Parent.DocStatus="["+l.Tables[0][0].status.toString()+"]",a=!0),null!=l&&l.Tables.length>0&&l.Tables[l.Tables.length-1].length>0&&l.Columns[l.Tables.length-1].Contains("ErrorMessage")&&(this.Parent.this.DisplayMessage=l.Tables[l.Tables.length-1][0].ErrorMessage.toString()),this.Parent.this.MessageVisibility=!0,a&&this.Parent.Button_Click("Clear"))}onButtonClick(e){let t=0;if(40054==this.CostCenterID)"Approve"==e?s.a.SessionManager.IsActionAssigned(this.CostCenterID,"Edit")?this.Parent.btnPost_Click():this.SaveStatus(369,parseInt(this.Parent.oCMP.arrLstOthMPFields[0].dvPayProcessed[0].WorkFlowID),""):"Reject"==e&&this.SaveStatus(372,0,""),s.a.page.HideDialog();else if(40095==this.CostCenterID)"Approve"==e?s.a.SessionManager.IsActionAssigned(this.CostCenterID,"Edit")?(this.Parent.sCmdParameter="Approve",this.Parent.Button_Click("Save")):this.SaveStatus(369,this.Parent.WID,""):"Reject"==e&&this.SaveStatus(372,0,""),s.a.page.HideDialog();else{let i=this.ScreenObject.CurrentStatus;if("Approve"==e){if(!this.IsSaveValidated())return;let e=s.a.common.ApproveCostCenter(this.CostCenterID,this.NodeID,i,this.Remarks.Text,!1,0);this.DisplayMessage=e.Message,t=e.RetValue,t>0&&(this.IsUpdated||(this.ScreenObject.ButtonApproveVisible=!1,this.UpdateStatusID(t),null!=this.ScreenObject.drpStatus&&(null==this.ScreenObject.drpStatus.Items.find(e=>e.Value==t.toString())&&("1001"==t.toString()?this.ScreenObject.drpStatus.Items.push(n.d.ComboBoxItems_2("Un Approved","1001")):"1002"==t.toString()?this.ScreenObject.drpStatus.Items.push(n.d.ComboBoxItems_2("Approved","1002")):this.ScreenObject.drpStatus.Items.push(n.d.ComboBoxItems_2("Rejected","1003"))),this.ScreenObject.drpStatus.SelectedValue=t.toString(),this.ScreenObject.drpStatus.SetSelectedItem(t.toString())),s.a.SessionManager.IsWebApplication&&(this.retValWeb=t)),s.a.page.HideDialog())}else if("Reject"==e){if(!this.IsSaveValidated())return;let e=s.a.common.ApproveCostCenter(this.CostCenterID,this.NodeID,i,this.Remarks.Text,!0,0);this.DisplayMessage=e.Message,t=e.RetValue,t>0&&(this.IsUpdated||(this.UpdateStatusID(t),null!=this.ScreenObject.drpStatus&&(null==this.ScreenObject.drpStatus.Items.find(e=>e.Value==t.toString())&&("1001"==t.toString()?this.ScreenObject.drpStatus.Items.push(n.d.ComboBoxItems_2("Un Approved","1001")):"1002"==t.toString()?this.ScreenObject.drpStatus.Items.push(n.d.ComboBoxItems_2("Approved","1002")):this.ScreenObject.drpStatus.Items.push(n.d.ComboBoxItems_2("Rejected","1003"))),this.ScreenObject.drpStatus.SelectedValue=t.toString(),this.ScreenObject.drpStatus.SetSelectedItem(t.toString())),s.a.SessionManager.IsWebApplication&&(this.retValWeb=t)),s.a.page.HideDialog())}else s.a.page.HideDialog()}}UpdateStatusID(e){this.ScreenObject.CurrentStatus=e,"QuickAddAccountScreenViewModel"==this.Parent.ClassName||"AddEditAccountScreenViewModel"==this.Parent.ClassName?this.Parent.obj.StatusID=e:"QuickAddProductViewModel"==this.Parent.ClassName?this.Parent.objProduct.ProductStatus=e:"AddProductScreenViewModel"==this.Parent.ClassName?this.Parent.oProduct.ProductStatus=e:"QuickAddCostCenterViewModel"==this.Parent.ClassName||"AddCostCenterViewModel"==this.Parent.ClassName?this.Parent.objCostCenter.Status=e:"AddEditEmpMasterViewModel"==this.Parent.ClassName&&(this.Parent.objEmp.StatusID=e)}IsSaveValidated(){if(this.IsUpdated=!1,"QuickAddAccountScreenViewModel"==this.Parent.ClassName){let e=this.Parent;if(e.ButtonSave.Visible&&e.ButtonSave.Enable){if(e.SaveMethod("APPROVE_CALL"),0!=e.AccountID)return this.DisplayMessage=e.DisplayMessage,e.DisplayMessage="",!1;this.IsUpdated=!0,e.DisplayMessage=""}}else if("AddEditAccountScreenViewModel"==this.Parent.ClassName){let e=this.Parent;if(e.ButtonSave.Visible&&e.ButtonSave.Enable){if(e.OnSaveAccount("APPROVE_CALL"),0!=e.AccountID)return this.DisplayMessage=e.DisplayMessage,e.DisplayMessage="",!1;this.IsUpdated=!0,e.DisplayMessage=""}}else if("QuickAddProductViewModel"==this.Parent.ClassName){let e=this.Parent;if(e.ButtonSave.Visible&&e.ButtonSave.Enable){if(e.onSaveProduct("APPROVE_CALL"),0!=e.objProduct.ProductID)return this.DisplayMessage=e.DisplayMessage,e.DisplayMessage="",!1;this.IsUpdated=!0,e.DisplayMessage=""}}else if("AddProductScreenViewModel"==this.Parent.ClassName){let e=this.Parent;if(e.ButtonSave.Visible&&e.ButtonSave.Enable){if(e.OnSaveProduct("APPROVE_CALL"),0!=e.ProductID)return this.DisplayMessage=e.DisplayMessage,e.DisplayMessage="",!1;this.IsUpdated=!0,e.DisplayMessage=""}}else if("QuickAddCostCenterViewModel"==this.Parent.ClassName){let e=this.Parent;if(e.ButtonSave.Visible&&e.ButtonSave.Enable){if(e.SaveMethod(),0!=e.NodeID)return this.DisplayMessage=e.DisplayMessage,e.DisplayMessage="",!1;this.IsUpdated=!0,e.DisplayMessage=""}}else if("AddCostCenterViewModel"==this.Parent.ClassName){let e=this.Parent;if(e.ButtonSave.Visible&&e.ButtonSave.Enable){if(e.OnSaveCostCenter("Save"),0!=e.NodeID)return this.DisplayMessage=e.DisplayMessage,e.DisplayMessage="",!1;this.IsUpdated=!0,e.DisplayMessage=""}}else if("AddEditEmpMasterViewModel"==this.Parent.ClassName){let e=this.Parent;if(e.ButtonSave.Visible&&e.ButtonSave.Enable){if(e.OnSaveEmployee("Save"),0!=e.NodeID)return this.DisplayMessage=e.DisplayMessage,e.DisplayMessage="",!1;this.IsUpdated=!0,e.DisplayMessage=""}}return!0}}},"5FTv":function(e,t,i){"use strict";i.r(t),i.d(t,"VoucherExportExcel",(function(){return a}));var s=i("Do2H");class a{static GetPrintLayouts(e,t){let i=[];return i.push(e),i.push(t),i.push(0),i.push(parseInt(s.a.SessionManager.RoleID)),i.push(parseInt(s.a.SessionManager.UserID)),i.push(s.a.SessionManager.LanguageID),s.a.report.GetPrintLayout(i)}static GetPrintLayouts_1(e,t,i){let a=[];return a.push(e),a.push(t),a.push(i),a.push(null),a.push(s.a.SessionManager.RoleID),a.push(s.a.SessionManager.UserID),a.push(s.a.SessionManager.LanguageID),s.a.report.GetPrintLayouts(a)}static GetLocationPrintLayouts(e,t,i,a=1){let l=[];return l.push(a),l.push(e),l.push(t),l.push(s.a.SessionManager.LocationID),l.push(s.a.SessionManager.RoleID),l.push(s.a.SessionManager.UserID),l.push(i),l.push(s.a.SessionManager.LanguageID),s.a.report.GetPrintLayouts(l)}static GetLayoutTemplates(e,t,i){let a=[];return a.push(2),a.push(t),a.push(i),a.push(e),a.push(s.a.SessionManager.RoleID),a.push(s.a.SessionManager.UserID),a.push(s.a.SessionManager.LanguageID),s.a.report.GetPrintLayouts(a)}static AllowRePrint(e,t,i){let a=[];return a.push(3),a.push(e),a.push(t),a.push(i),a.push(s.a.SessionManager.RoleID),a.push(s.a.SessionManager.UserID),a.push(s.a.SessionManager.LanguageID),s.a.report.GetPrintLayouts(a)}}},bB3S:function(e,t,i){"use strict";i.r(t),i.d(t,"AddEditEmpMasterViewModel",(function(){return W})),i.d(t,"PayIdentityGridViewModel",(function(){return U}));var s=i("ScVY"),a=i("EQd/"),l=i("0/4Q"),n=i("VxiT"),o=i("n56n"),r=i("NkMH"),h=i("bgvB"),d=i("eQJW"),c=i("4HhE"),u=i("INyF"),m=i("QQWi"),p=i("JIg3"),g=i("8B8H"),D=i("ockk"),y=i("Lp6j"),b=i("Do2H"),S=i("vTM8"),C=i("uMy8"),I=i("MRsC"),T=i("vVAv"),A=i("RJs6"),E=i("OvA8"),P=i("xnJf"),f=i("jgdN");class M{constructor(e,t){this.SaveCallBack=null,this.Fields=[],this.oText=null,this.oDate=null,this.oCombo=null,this.oTextArea=null,this.OComboText=null,this.oTime=null,this.CostCenterID=0,this.AttachmentVisibility=!1,this.NodeID=0,this.Institute="",this.University="",this.Title="",this.Duration="",this.GradeRPercentage="",this.Remarks="",this.DocumentVisibility=!1,this.IsModified=!1,this.ScreenObject=new n.a,this.MessageVisibility=!1,this.DisplayMessage="",this.AddDocumentText="",this.FeatureID=0,this.FeaturePK=0,this.DocumentType=251,this.dvLookUps=[],Logger.InfoLog("AddEditEmpDocumentsViewModel::Entering AddEditEmpDocumentsViewModel with Parent="+e),this.Parent=e,this.DocumentType=t,this.ButtonSecurity(),this.InitLookUps(),this.ViewAttachments=new E.ViewAttachmentViewModel(this,b.a.SessionManager,b.a.admin),this.OnAddAttachment(),Logger.InfoLog("AddEditEmpDocumentsViewModel::Exiting AddEditEmpDocumentsViewModel")}OnShowAttachment(){Logger.InfoLog("AddProductViewModel::Entering OnShowAttachment"),Logger.InfoLog("AddProductViewModel::Exiting OnShowAttachment")}OnAddAttachment(){Logger.InfoLog("AddProductViewModel::Entering AddAttachment");let e="";null!=this.Attachment&&(e=this.Attachment.ColID);let t=null;null!=this.Attachment&&(t=this.Attachment.RowID),this.Attachment=new P.AddAttachmentViewModel,this.Attachment.AddAttachmentViewModel_2(this),""==e?(this.Attachment.ColID="",this.Attachment.RowID=null):(this.Attachment.ColID=e,this.Attachment.RowID=t),this.ViewAttachments.AttachmentsList.forEach(e=>{e.Height=null==e.RowID&&y.e.StringIsNullOrEmpty(e.ColID)?20:0}),this.Attachment.RowID=null,this.Attachment.ColID="",Logger.InfoLog("AddProductViewModel::Entering AddAttachment")}ButtonSecurity(){this.ButtonCustomize=new r.a,b.a.SessionManager.HideUnathorizedAccess?this.ButtonCustomize.Visible=b.a.SessionManager.IsActionAssigned(this.Parent.CostCenterID,"Customize"):this.ButtonCustomize.Enable=b.a.SessionManager.IsActionAssigned(this.Parent.CostCenterID,"Customize")}InitLookUps(){if(251==this.DocumentType?this.AddDocumentText=b.a.GetResource("Add")+" "+b.a.GetResource("EmpMaster_Qualification"):252==this.DocumentType?this.AddDocumentText=b.a.GetResource("Add")+" "+b.a.GetResource("EmpMaster_Certification"):253==this.DocumentType?this.AddDocumentText=b.a.GetResource("Add")+" "+b.a.GetResource("EmpMaster_PrevEmployment"):254==this.DocumentType?this.AddDocumentText=b.a.GetResource("Add")+" "+b.a.GetResource("EmpMaster_MedicalHistory"):255==this.DocumentType&&(this.AddDocumentText=b.a.GetResource("Add")+" "+b.a.GetResource("EmpMaster_DependentInfo")),this.ScreenObject.LoadQuickScreen(this,this.DocumentType),this.dvLookUps=this.ScreenObject.Data.Tables[5],this.ScreenObject.CheckViewForUser(!1),null!=this.ScreenObject&&this.ScreenObject.StaticFields.length>0)if(251==this.DocumentType)for(let e=0;e<this.ScreenObject.StaticFields.length;e++)if(this.dvLookUps=this.ScreenObject.Data.Tables[5],"Field1"==this.ScreenObject.StaticFields[e].DBColumnName){for(let t=1900;t<=2200;t++)this.ScreenObject.StaticFields[e].Items.push(l.d.ComboBoxItems_2(t.toString(),t.toString()));this.ScreenObject.StaticFields[e].SelectedValue="1900"}else"Field2"==this.ScreenObject.StaticFields[e].DBColumnName?(this.dvLookUps=this.dvLookUps.filter(e=>103==e.LookupType),l.e.FillComboWithDefaultOption(this.dvLookUps,this.ScreenObject.StaticFields[e])):"Field3"==this.ScreenObject.StaticFields[e].DBColumnName?(this.dvLookUps=this.dvLookUps.filter(e=>109==e.LookupType),l.e.FillComboWithDefaultOption(this.dvLookUps,this.ScreenObject.StaticFields[e])):"Field4"==this.ScreenObject.StaticFields[e].DBColumnName&&(this.dvLookUps=this.dvLookUps.filter(e=>110==e.LookupType),l.e.FillComboWithDefaultOption(this.dvLookUps,this.ScreenObject.StaticFields[e]));else if(252==this.DocumentType)for(let e=0;e<this.ScreenObject.StaticFields.length;e++)this.dvLookUps=this.ScreenObject.Data.Tables[5],"Field3"==this.ScreenObject.StaticFields[e].DBColumnName?(this.dvLookUps=this.dvLookUps.filter(e=>103==e.LookupType),l.e.FillComboWithDefaultOption(this.dvLookUps,this.ScreenObject.StaticFields[e])):"Field4"==this.ScreenObject.StaticFields[e].DBColumnName&&(this.dvLookUps=this.dvLookUps.filter(e=>101==e.LookupType),l.e.FillComboWithDefaultOption(this.dvLookUps,this.ScreenObject.StaticFields[e]));else if(253==this.DocumentType);else if(254==this.DocumentType)for(let e=0;e<this.ScreenObject.StaticFields.length;e++)this.dvLookUps=this.ScreenObject.Data.Tables[5],"Field1"==this.ScreenObject.StaticFields[e].DBColumnName&&(this.dvLookUps=this.dvLookUps.filter(e=>107==e.LookupType),l.e.FillComboWithDefaultOption(this.dvLookUps,this.ScreenObject.StaticFields[e]));else if(255==this.DocumentType)for(let e=0;e<this.ScreenObject.StaticFields.length;e++)this.dvLookUps=this.ScreenObject.Data.Tables[5],"Field4"==this.ScreenObject.StaticFields[e].DBColumnName?(this.ScreenObject.StaticFields[e].Items.push(l.d.ComboBoxItems_2("Male","Male")),this.ScreenObject.StaticFields[e].Items.push(l.d.ComboBoxItems_2("Female","Female")),this.ScreenObject.StaticFields[e].Items.push(l.d.ComboBoxItems_2("Others","Others")),this.ScreenObject.StaticFields[e].SelectedValue="Male"):"Field5"==this.ScreenObject.StaticFields[e].DBColumnName?(this.dvLookUps=this.dvLookUps.filter(e=>111==e.LookupType),l.e.FillComboWithDefaultOption(this.dvLookUps,this.ScreenObject.StaticFields[e])):"Field15"==this.ScreenObject.StaticFields[e].DBColumnName?(this.dvLookUps=this.dvLookUps.filter(e=>108==e.LookupType),l.e.FillComboWithDefaultOption(this.dvLookUps,this.ScreenObject.StaticFields[e])):"Field16"==this.ScreenObject.StaticFields[e].DBColumnName&&(this.ScreenObject.StaticFields[e].Items.push(l.d.ComboBoxItems_2("Yes","Yes")),this.ScreenObject.StaticFields[e].Items.push(l.d.ComboBoxItems_2("No","No")),this.ScreenObject.StaticFields[e].SelectedValue="Yes")}OnSaveDocument(e){if(null!=e&&"Cancel"==e.toString())return this.Parent.EmpDocumentsVisibility=!1,void b.a.page.HideDialog();if(null!=e&&"Customize"==e.toString());else{if(Logger.InfoLog("AddEmpDocumentiewModel::Entering OnSaveDocument"),this.DisplayMessage=this.ScreenObject.ValidateData(),this.DisplayMessage.length>0)return;if((this.NodeID>0||this.NodeID<-1e4)&&(this.IsModified=!0),null!=this.Parent){Logger.InfoLog("AddEmpDocumentiewModel::Entering OnSaveDocument"),(this.NodeID>0||this.NodeID<-1e4)&&(this.IsModified=!0);let e=null;if(null==this.Parent.ViewEmpDocuments.SelectedRow){e=this.Parent.ViewEmpDocuments.GridListObj.NewRow();for(let t=0;t<this.Parent.ViewEmpDocuments.tempGridListCols.length;t++)e[this.Parent.ViewEmpDocuments.tempGridListCols[t]]=null}else null!=this.Parent.ViewEmpDocuments.SelectedRow&&(e=this.Parent.ViewEmpDocuments.SelectedRow);for(let s=0;s<this.ScreenObject.StaticFields.length;s++){const i=this.ScreenObject.StaticFields[s];if(i instanceof c.c&&null!=i.DBColumnName)if(this.Parent.ViewEmpDocuments.tempGridListCols.Contains(i.DBColumnName)||this.Parent.ViewEmpDocuments.tempGridListCols.push(i.DBColumnName),i.DBColumnName.toUpperCase().startsWith("CCNID")&&(this.Parent.ViewEmpDocuments.tempGridListCols.Contains(i.DBColumnName+"_Key")||this.Parent.ViewEmpDocuments.tempGridListCols.push(i.DBColumnName+"_Key")),i instanceof l.e&&(this.Parent.ViewEmpDocuments.tempGridListCols.Contains(i.DBColumnName+"_Key")||this.Parent.ViewEmpDocuments.tempGridListCols.push(i.DBColumnName+"_Key")),i instanceof a.d)e[i.DBColumnName]=""!=i.Text?i.Text:"";else if(i instanceof a.a)e[i.DBColumnName]=""!=i.Text?i.Text:"";else if(i instanceof a.c)e[i.DBColumnName]=""!=i.Text?i.Text:"";else if(i instanceof l.e)if(e[i.DBColumnName+"_Key"]=null!=i.SelectedItem?i.SelectedItem.Value:null!=i.SelectedValue?i.SelectedValue:"",b.a.SessionManager.IsWebApplication){if(null!=i.SelectedValue&&null!=i.SelectedValue){var t=i.Items.find(e=>e.Value==i.SelectedValue);e[i.DBColumnName]=null!=t?t.Name:""}}else e[i.DBColumnName]=null!=i.SelectedItem?i.SelectedItem.Name:"";else i instanceof p.b?e[i.DBColumnName]=y.e.StringIsNullOrEmpty(i.Date)?"":i.Date.toString():i instanceof p.c?e[i.DBColumnName]=b.a.SessionManager.IsWebApplication?y.e.StringIsNullOrEmpty(i.Date)?"":new Date(i.Date).ToString("dd/MMM/yyyy"):y.e.StringIsNullOrEmpty(i.Text)||y.e.StringIsNullOrEmpty(i.Date)?"":new Date(i.Date).ToString("dd/MMM/yyyy"):i instanceof p.a?e[i.DBColumnName]=y.e.StringIsNullOrEmpty(i.Text)||y.e.StringIsNullOrEmpty(i.Date)?"":i.Date.ToString("dd/MMM/yyyy"):i instanceof f.a?e[i.DBColumnName]=""!=i.Text?i.Text:"":i instanceof o.b&&(e[i.DBColumnName+"_Key"]=0!=i.SelectedValue?i.SelectedValue:0)}e.DType=this.DocumentType.toString();let i=this.ViewAttachments.GetXML();e.AttachmentXML=i,null==this.Parent.ViewEmpDocuments.SelectedRow&&this.Parent.ViewEmpDocuments.GridListObj.addRow(e),this.Parent.ViewEmpDocuments.SelectedRow=null,this.ClearFields(),Logger.InfoLog("AddContactViewModel::Exiting OnSaveContact")}this.DocumentVisibility=!1,Logger.InfoLog("AddContactViewModel::Exiting OnSaveContact")}}ClearFields(){this.ScreenObject.Clear(),this.ViewAttachments=new E.ViewAttachmentViewModel(this,b.a.SessionManager,b.a.admin),this.OnAddAttachment()}OnSaveDocumentByDialog(e){if(this.DisplayMessage="",null!=e&&"Cancel"==e.toString())b.a.page.HideDialog();else{Logger.InfoLog("AddEditEmpDocumentViewModel::Entering OnSaveDocumentByDialog"),(this.NodeID>0||this.NodeID<-1e4)&&(this.IsModified=!0);let e=null,t=null,i=null,s="";e="",t="",i="",s+='<Data><Row Action="NEW"',s+=' NodeID="0"';let n="",r=this.Fields.find(e=>"Institute"==e.DBColumnName.toString());if(null!=r&&null!=r&&r instanceof a.d&&(this.Institute=r.Text),""==this.Institute.Trim())return;for(let m=0;m<this.Fields.length;m++){const s=this.Fields[m];s instanceof c.c&&null!=s.DBColumnName&&(n="",s instanceof a.d||s instanceof a.a||s instanceof a.c?n=""!=s.Text?s.Text:"":s instanceof l.e?n=""!=s.SelectedValue?s.SelectedValue:"":s instanceof p.b?n=y.e.StringIsNullOrEmpty(s.Date)?"":s.Date.toString():s instanceof p.c?n=y.e.StringIsNullOrEmpty(s.Text)||y.e.StringIsNullOrEmpty(s.Date)?"":new Date(s.Date).ToString("dd/MMM/yyyy"):s instanceof p.a?n=y.e.StringIsNullOrEmpty(s.Text)||y.e.StringIsNullOrEmpty(s.Date)?"":s.Date.ToString("dd/MMM/yyyy"):s instanceof f.a?n=y.e.StringIsNullOrEmpty(s.Text)?"":s.Text:s instanceof o.b&&(n=(0!=s.SelectedValue?s.SelectedValue:0).toString()),s.DBColumnName.toLowerCase().Contains("alpha")?t+=s.DBColumnName+"=N'"+this.GetValidXml(n)+"',":s.DBColumnName.toUpperCase().startsWith("CCNID")?i+=s.DBColumnName+"='"+n+"',":e+=s.DBColumnName+"=N'"+n+"',")}s+=' StaticFields ="'+e.toString().Trim(",")+'" ',s+=' ExtraTextFields ="'+t.toString().Trim(",")+'" ',s+=' CCFields ="'+i.toString().Trim(",")+'" ',s+="/></Data>";let h="",d=0,u={};u.AccountID=this.FeatureID,u.WID=this.FeaturePK,u.CCMapXML=s.toString(),b.a.empService.SaveEmpDocument(u,"SaveEmpDocument").subscribe(e=>{h=e.Message,d=e.RetValue,d>0||d<-1e4?(this.NodeID=d,b.a.page.HideDialog(),null!=this.SaveCallBack&&this.SaveCallBack.Call(this)):this.DisplayMessage=h},e=>{console.log("Save Add Edit Emp document : "+JSON.stringify(e))}),Logger.InfoLog("AddEditEmpDocumentViewModel::Exiting OnSaveDocumentByDialog")}}GetValidXml(e){return a.d.GetValidXml(e)}FillCustomFields(){this.Fields.Clear();let e=0,t=0;t=0,e=0,this.ScreenObject.StaticFields.length>0&&this.ScreenObject.StaticFields.forEach(i=>{i.Row=t,i.Column=e,this.Fields.push(i),2==e?(t+=1,e=0):e+=1})}}var V=i("t9b3"),N=i("3Pt+");class v{constructor(e){this.Module="PAY",this.ClassName="ViewEmpDocumentsViewModel",this.Visible=!0,this.contextVisible=!0,this.iDocumentTypeID=251,this.ColumnSpan="4",this.GridListObj=new g.a,this.ButtonAdd=new r.a,this.ButtonUpdate=new r.a,this.ButtonDelete=new r.a,this.DeletedAddress=new Array,Logger.InfoLog("ViewEmpDocumentsViewModel::Entering ViewEmpDocumentsViewModel with Parent="+e),this.form=new N.j({}),this.GridListObj.Columns=[],b.a.SessionManager.HideUnathorizedAccess?this.ButtonAdd.Visible=b.a.SessionManager.IsActionAssigned(e.CostCenterID,"Qualification_Create"):this.ButtonAdd.Enable=b.a.SessionManager.IsActionAssigned(e.CostCenterID,"Qualification_Create"),b.a.SessionManager.HideUnathorizedAccess?this.ButtonUpdate.Visible=b.a.SessionManager.IsActionAssigned(e.CostCenterID,"Qualification_Update"):this.ButtonUpdate.Enable=b.a.SessionManager.IsActionAssigned(e.CostCenterID,"Qualification_Update"),b.a.SessionManager.HideUnathorizedAccess?this.ButtonDelete.Visible=b.a.SessionManager.IsActionAssigned(e.CostCenterID,"Qualification_Delete"):this.ButtonDelete.Enable=b.a.SessionManager.IsActionAssigned(e.CostCenterID,"Qualification_Delete"),this.ButtonUpdate.Visible||this.ButtonDelete.Visible||(this.contextVisible=!1),this.DocumentTypes=new l.e(0),this.DocumentTypes.Label=b.a.GetResource("DocumentType"),this.DocumentTypes.SelectionChangedCommand.Subscribe(this,"DocumentTypes_SelectionChanged"),this.GridListObj.Clear(),this.tempGridListCols=[],this.tempGridListCols.push("NodeID"),this.tempGridListCols.push("EmpSeqNo"),this.tempGridListCols.push("DType");for(let t=1;t<=30;t++)this.tempGridListCols.Contains("Field"+t)||this.tempGridListCols.push("Field"+t),this.tempGridListCols.Contains("Field"+t+"_Key")||this.tempGridListCols.push("Field"+t+"_Key");this.tempGridListCols.Contains("AttachmentXML")||this.tempGridListCols.push("AttachmentXML"),this.Parent=e;this.Parent=e,"AddEditEmpMasterViewModel"==this.Parent.ClassName&&(this.DocumentTypes.Items.push(l.d.ComboBoxItems_2("Qualifications","Qualifications")),this.DocumentTypes.Items.push(l.d.ComboBoxItems_2("Certifications","Certifications")),this.DocumentTypes.Items.push(l.d.ComboBoxItems_2("Previous Employment","PrevEmployment")),this.DocumentTypes.Items.push(l.d.ComboBoxItems_2("Medical History","MedicalHistory")),this.DocumentTypes.Items.push(l.d.ComboBoxItems_2("Dependent Info","DependentInfo"))),this.DocumentTypes.Items.length>0&&(this.DocumentTypes.SelectedValue=this.DocumentTypes.Items[0].Value,this.DocumentTypes_SelectionChanged("")),Logger.InfoLog("ViewEmpDocumentsViewModel::Exiting ViewEmpDocumentsViewModel")}DocumentTypes_SelectionChanged(e){"Qualifications"==this.DocumentTypes.SelectedValue?this.iDocumentTypeID=251:"Certifications"==this.DocumentTypes.SelectedValue?this.iDocumentTypeID=252:"PrevEmployment"==this.DocumentTypes.SelectedValue?this.iDocumentTypeID=253:"MedicalHistory"==this.DocumentTypes.SelectedValue?this.iDocumentTypeID=254:"DependentInfo"==this.DocumentTypes.SelectedValue&&(this.iDocumentTypeID=255),this.LoadGridColumns(this.iDocumentTypeID),""==e?null!=this.OwnedScreen&&null!=this.OwnedScreen.dsEdit&&this.LoadDocuments(this.OwnedScreen.dsEdit.Tables[13]):this.LoadDocuments(null!=this.OwnedScreen&&null!=this.OwnedScreen.dsEdit?this.OwnedScreen.dsEdit.Tables[13]:null)}LoadGridColumns(e){let t=b.a.admin.GetDimensionTabGridData(e,this.iDocumentTypeID);if(null!=t&&t.Tables.length>1&&t.Columns[2].Contains("USERCOLUMNNAME")&&t.Tables[2].length>0){let e=[];if(e=t.Tables[2],this.GridColumnSource.Clear(),e.length>0){let t=new D.a;for(let i=0;i<e.length;i++)this.tempGridListCols.Contains(e[i].SysColumnName.toString())||(this.tempGridListCols.push(e[i].SysColumnName.toString()),e[i].SysColumnName.toString().toUpperCase().startsWith("CCNID")&&this.tempGridListCols.push(e[i].SysColumnName.toString()+"_Key")),t=new D.a,t.Header=e[i].USERCOLUMNNAME.toString(),e[i].SysColumnName.toString().toUpperCase().startsWith("CCNID")?(t.ValueMember=e[i].SysColumnName.toString()+"_Key",t.DisplayMember=e[i].SysColumnName.toString()):(t.ValueMember=e[i].SysColumnName.toString(),t.DisplayMember=e[i].SysColumnName.toString()),t.DataType="TextBlock",t.ReadOnly=!0,t.Width=0==parseInt(e[i].Width)?150:parseInt(e[i].Width),this.GridColumnSource.push(t)}}else this.LoadStaticColumns()}LoadStaticColumns(){let e=[],t=(new n.a).GetScreenInfo(this.iDocumentTypeID),i=null,s=[];if(null!=t&&null!=t&&t.Tables.length>3&&t.Tables[t.Tables.length-2].length>0){let a=t.Tables[t.Tables.length-2];if(a=a.filter(e=>e.Tabid>0),a.sort((e,t)=>e.Tabid-t.Tabid),a.length>0)for(let l=0;l<a.length;l++)s=t.Tables[0].filter(e=>e.CostCenterColID==a[l].Tabid.toString()),null!=s&&null!=s&&s.length>0&&(i=new D.a,i.Header=s[0].ResourceData.toString(),i.DisplayMember=s[0].SysColumnName.toString(),i.DataType="TextBlock",i.ReadOnly=!0,i.IsVisible=null!=a[l].IsVisible&&null!=a[l].IsVisible&&"TRUE"==a[l].IsVisible.toString().toUpperCase(),i.Width=150,e.push(i),"COMBOBOX"==s[0].ResourceData.toString().toUpperCase()&&(i=new D.a,i.Header=s[0].ResourceData.toString()+"_Key",i.DisplayMember=s[0].SysColumnName.toString()+"_Key",i.DataType="TextBlock",i.ReadOnly=!0,i.Width=150,i.IsVisible=!1,e.push(i)));else this.AddEmpDocumentsColumnsToGrid(e,i)}else this.AddEmpDocumentsColumnsToGrid(e,i);this.GridColumnSource=e}AddEmpDocumentsColumnsToGrid(e,t){251==this.iDocumentTypeID?((t=new D.a).Header=b.a.GetResource("Year"),t.DisplayMember="Field1",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Year_Key",t.DisplayMember="Field1_Key",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,t.IsVisible=!1,e.push(t),(t=new D.a).Header=b.a.GetResource("Qualification"),t.DisplayMember="Field3",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header=b.a.GetResource("Qualification"),t.DisplayMember="Field3_Key",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,t.IsVisible=!1,e.push(t),(t=new D.a).Header=b.a.GetResource("QualificationLevel"),t.DisplayMember="Field4",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header=b.a.GetResource("QualificationLevel"),t.DisplayMember="Field4_Key",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,t.IsVisible=!1,e.push(t),(t=new D.a).Header=b.a.GetResource("Grade_Percentage"),t.DisplayMember="Field8",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header=b.a.GetResource("Remarks"),t.DisplayMember="Field9",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t)):252==this.iDocumentTypeID?((t=new D.a).Header="Domain",t.DisplayMember="Field3",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Certification",t.DisplayMember="Field4",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Grade / Percentage",t.DisplayMember="Field6",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Date",t.DisplayMember="Field1",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Valid Till",t.DisplayMember="Field2",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Remarks",t.DisplayMember="Field7",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t)):253==this.iDocumentTypeID?((t=new D.a).Header="From",t.DisplayMember="Field1",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="To",t.DisplayMember="Field2",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Company",t.DisplayMember="Field3",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Company Details",t.DisplayMember="Field4",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Location",t.DisplayMember="Field5",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Department",t.DisplayMember="Field6",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Designation",t.DisplayMember="Field7",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Remarks",t.DisplayMember="Field11",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t)):254==this.iDocumentTypeID?((t=new D.a).Header="Medical Test",t.DisplayMember="Field1",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Result",t.DisplayMember="Field3",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Valid Till",t.DisplayMember="Field2",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Remarks",t.DisplayMember="Field4",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t)):255==this.iDocumentTypeID&&((t=new D.a).Header="Name",t.DisplayMember="Field1",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Date of Birth",t.DisplayMember="Field2",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Age",t.DisplayMember="Field3",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Sex",t.DisplayMember="Field4",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Relation",t.DisplayMember="Field5",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Insurance",t.DisplayMember="Field16",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t))}get angularGrid(){return this.GridListObj.angularGrid}get GridList(){return this.GridListObj.Table}get GridColumnSource(){return this.GridListObj.Columns}set GridColumnSource(e){this.GridListObj.Columns=e}get SelectedRow(){return this.GridListObj.SelectedItem}set SelectedRow(e){this.GridListObj.SelectedItem=e}OnCmnItem_Click(e){switch(Logger.InfoLog("ViewEmpDocumentsViewModel::Entering OnCmnItem_Click with Command="+e),e){case"EDIT":if(null!=this.SelectedRow){null==this.Parent.EmpDocuments&&(this.Parent.EmpDocuments=new M(this.Parent,this.iDocumentTypeID)),this.Parent.EmpDocumentsVisibility=!0;let e=this.SelectedRow;if(null==e||null==e)return;if(null!=e&&""!=e.NodeID.toString()&&(this.Parent.EmpDocuments.NodeID=""!=e.NodeID.toString()?parseInt(e.NodeID.toString()):0),this.Parent.EmpDocuments.ScreenObject.Clear(),this.Parent.EmpDocuments.ScreenObject.FillControls(e,e,e,null),null!=e.AttachmentXML&&""!=e.AttachmentXML.toString()){let i=new y.f;try{this.Parent.EmpDocuments.ViewAttachments=new E.ViewAttachmentViewModel(this.Parent.EmpDocuments),i.LoadXml(e.AttachmentXML.toString());let t=i.SelectNodes("AttachmentsXML/Row");this.Parent.EmpDocuments.ViewAttachments.AttachmentsListObj.Clear(),t.forEach(e=>{let t=new P.AddAttachmentViewModel;t.AddAttachmentViewModel_2(this.Parent.EmpDocuments),t.AttachmentID=parseInt(e.attributes.AttachmentID.Value),t.ActualFileName=e.attributes.ActualFileName.Value,t.FileExtension=e.attributes.FileExtension.Value,t.FileDescription=e.attributes.FileDescription.Value,t.FilePath=y.e.GetPath(e.attributes.GUID.Value+"."+e.attributes.FileExtension.Value),t.RelativeFileName=e.attributes.RelativeFileName.Value,t.IsProductImage=!1,t.guid=e.attributes.GUID.Value,this.Parent.EmpDocuments.ViewAttachments.AttachmentsListObj.addRow(t)})}catch(t){}}}break;case"DELETE":null!=this.SelectedRow&&(""!=this.SelectedRow.NodeID.toString()&&"0"!=this.SelectedRow.NodeID.toString()&&this.DeletedAddress.push(l.d.ComboBoxItems_1(this.SelectedRow.NodeID.toString())),this.GridList.Remove(this.SelectedRow))}Logger.InfoLog("ViewEmpDocumentsViewModel::Exiting OnCmnItem_Click")}onCanCmnItem_Click(e){return!0}GetXML(){Logger.InfoLog("ViewEmpDocumentsViewModel::Entering GetXML");let e=null,t=null,i=null,s="";for(let a=0;a<this.GridList.length;a++){e="",t="",i="",""==this.GridList[a].NodeID.toString()||"0"==this.GridList[a].NodeID.toString()?s+='<Row Action="NEW"':s+='<Row Action="MODIFY"',s+=' NodeID="'+this.GridList[a].NodeID.toString()+'"',s+=' DType="'+this.GridList[a].DType.toString()+'"';for(let s=0;s<this.tempGridListCols.length;s++)this.tempGridListCols[s].toLowerCase().Contains("_key")||this.tempGridListCols[s].Contains("NodeID")||null!=this.Parent.EmpDocuments&&this.Parent.EmpDocuments.ScreenObject.StaticFields.find(e=>e.DBColumnName==this.tempGridListCols[s])&&(this.tempGridListCols[s].toLowerCase().Contains("alpha")?t+=this.tempGridListCols[s]+"=N'"+this.GetValidXml(this.GridList[a][this.tempGridListCols[s]].toString())+"',":this.tempGridListCols[s].toUpperCase().startsWith("CCNID")?i+=this.tempGridListCols[s]+"='"+this.GridList[a][this.tempGridListCols[s]+"_Key"].toString()+"',":this.tempGridListCols.Contains(this.tempGridListCols[s]+"_Key")&&""!=this.GridList[a][this.tempGridListCols[s]+"_Key"].toString()?e+=this.tempGridListCols[s]+"=N'"+this.GetValidXml(this.GridList[a][this.tempGridListCols[s]+"_Key"].toString())+"',":e+=this.tempGridListCols[s]+"=N'"+this.GetValidXml(this.GridList[a][this.tempGridListCols[s]].toString())+"',");s+=' StaticFields ="'+e.toString().Trim(",")+'" ',s+=' ExtraTextFields ="'+t.toString().Trim(",")+'" ',s+=' CCFields ="'+i.toString().Trim(",")+'" ',s+=' AttachmentXML ="'+this.EncodedXMLString(this.GridList[a].AttachmentXML.toString())+'" ',s+="/>"}for(let a=0;a<this.DeletedAddress.length;a++)s+='<Row Action="DELETE"',s+=' NodeID="'+this.DeletedAddress[a].Name+'"/>';return s.length>0&&(s="<Data>"+s+"</Data>"),Logger.InfoLog("ViewEmpDocumentsViewModel::Exiting GetXML which RETURN XML="+s),s.toString()}EncodedXMLString(e){return y.e.StringIsNullOrEmpty(e)?"":e.replace("&","&amp;").replace("<","&lt;").replace(">","&gt;").replace('"',"&quot;")}OnShowNew(e){Logger.InfoLog("ViewEmpDocumentsViewModel::Entering OnShowNewContact");try{if(null!=e&&null!=e||(e="Save"),"Customize"==e.toString()){let e=-1;"AddEditEmpMasterViewModel"==this.Parent.ClassName&&(e=this.Parent.CostCenterID)}else this.ButtonAdd.Enable&&this.ButtonAdd.Visible&&(this.Parent.EmpDocuments=new M(this.Parent,this.iDocumentTypeID),b.a.page.ShowDialog(this.Parent.EmpDocuments,V.a,{Title:this.Parent.EmpDocuments.AddDocumentText}),this.Parent.EmpDocumentsVisibility=!0);Logger.InfoLog("ViewEmpDocumentsViewModel::Exiting OnShowNewContact")}catch(t){Logger.ErrorLog("ViewEmpDocumentsViewModel:: OnShowNewContact"+t.stack)}}LoadDocuments(e){if(null!=e&&e.length>0){let t=e;t=t.filter(e=>251==e.DType||252==e.DType||253==e.DType||254==e.DType||255==e.DType),e=t}let t=b.a.empService.GetQueryData(0,"LoadDocumentsEmp","","","");if(this.GridListObj.Table=this.GridList.filter(e=>e.DType==+this.iDocumentTypeID),null!=e&&null!=e&&(this.GridListObj.Clear(),Logger.InfoLog("ViewEmpDocumentsViewModel::Entering LoadContacts with TableData"+e),251==this.iDocumentTypeID?(this.tempGridListCols.Contains("Field1_Key")||this.tempGridListCols.push("Field1_Key"),this.tempGridListCols.Contains("Field2_Key")||this.tempGridListCols.push("Field2_Key"),this.tempGridListCols.Contains("Field3_Key")||this.tempGridListCols.push("Field3_Key"),this.tempGridListCols.Contains("Field4_Key")||this.tempGridListCols.push("Field4_Key")):252==this.iDocumentTypeID?(this.tempGridListCols.Contains("Field3_Key")||this.tempGridListCols.push("Field3_Key"),this.tempGridListCols.Contains("Field4_Key")||this.tempGridListCols.push("Field4_Key")):253==this.iDocumentTypeID||(254==this.iDocumentTypeID?this.tempGridListCols.Contains("Field1_Key")||this.tempGridListCols.push("Field1_Key"):255==this.iDocumentTypeID&&(this.tempGridListCols.Contains("Field4_Key")||this.tempGridListCols.push("Field4_Key"),this.tempGridListCols.Contains("Field5_Key")||this.tempGridListCols.push("Field5_Key"),this.tempGridListCols.Contains("Field15_Key")||this.tempGridListCols.push("Field15_Key"),this.tempGridListCols.Contains("Field16_Key")||this.tempGridListCols.push("Field16_Key"))),this.tempGridListCols.Contains("EmpSeqNo")||this.tempGridListCols.push("EmpSeqNo"),this.tempGridListCols.Contains("AttachmentXML")||this.tempGridListCols.push("AttachmentXML"),0!=e.length)){if(null!=this.Parent.EmpDocuments)for(let e=0;e<this.Parent.EmpDocuments.ScreenObject.StaticFields.length;e++){const t=this.Parent.EmpDocuments.ScreenObject.StaticFields[e];t instanceof c.c&&null!=t.DBColumnName&&(this.tempGridListCols.Contains(t.DBColumnName)||(this.tempGridListCols.push(t.DBColumnName),t.DBColumnName.toUpperCase().startsWith("CCNID")&&this.tempGridListCols.push(t.DBColumnName+"_Key")))}for(let i=0;i<e.length;i++){let s={};for(let e=0;e<this.tempGridListCols.length;e++)s[this.tempGridListCols[e]]=null;for(let t=0;t<this.tempGridListCols.length;t++)this.tempGridListCols[t].toLowerCase().Contains("_key")||y.e.hasprop(e[i],this.tempGridListCols[t])&&(this.tempGridListCols[t].toString().toUpperCase().startsWith("CCNID")?s[this.tempGridListCols[t]+"_Key"]=e[i][this.tempGridListCols[t]].toString():s[this.tempGridListCols[t]]=this.GetValidXmlReserve(y.e.StringValue(e[i][this.tempGridListCols[t]]).toString()));if(s.NodeID=parseInt(e[i].NodeID),s.EmpSeqNo=parseInt(e[i].EmployeeID),s.DType=e[i].DType.toString(),251==parseInt(s.DType)?(s.Field1_Key=s.Field1,s.Field2_Key=s.Field2,s.Field3_Key=s.Field3,s.Field4_Key=s.Field4):252==parseInt(s.DType)?(s.Field3_Key=s.Field3,s.Field4_Key=s.Field4):253==parseInt(s.DType)||(254==parseInt(s.DType)?s.Field1_Key=s.Field1:255==parseInt(s.DType)&&(s.Field4_Key=s.Field4,s.Field5_Key=s.Field5,s.Field15_Key=s.Field15,s.Field16_Key=s.Field16)),null!=t&&null!=t&&t.Tables.length>0&&t.Tables[0].length>0){let e=t.Tables[0];if(null!=e&&null!=e){let t="";if(e=e.filter(e=>e.FeatureID==s.DType.toString()&&e.FeaturePK==s.NodeID.toString()),e.length>0){for(let i=0;i<e.length;i++)t+='<Row Action="MODIFY"',t+=' AttachmentID="'+e[i].FileID.toString()+'"',t+=' FilePath="'+y.e.GetPath(e[i].GUID.toString()+"."+e[i].FileExtension.toString())+'"',t+=' ActualFileName="'+a.d.GetValidXml(e[i].ActualFileName.toString())+'"',t+=' RelativeFileName="'+a.d.GetValidXml(e[i].RelativeFileName.toString())+'"',t+=' FileExtension="'+e[i].FileExtension+'"',t+=' GUID="'+e[i].GUID+'"',t+=' FileDescription="'+a.d.GetValidXml(e[i].FileDescription.toString())+'" ',t+=' IsProductImage="0"',t+="/>";t.length>0&&(t="<AttachmentsXML>"+t+"</AttachmentsXML>",s.AttachmentXML=t.toString())}}}this.GridListObj.addRow(s)}null!=e&&this.UpdateNodeNosToData(),Logger.InfoLog("ViewEmpDocumentsViewModel::Exiting LoadContacts")}}UpdateNodeNosToData(){if(null!=this.OwnedScreen){let e,t=this.OwnedScreen.ScreenObject.Data.Tables[8];for(let i=0;i<this.GridList.length;i++)251==parseInt(this.GridList[i].DType)?(y.e.StringIsNullOrEmpty(this.GridList[i].Field2_Key)||(e=t.filter(e=>e.NodeID==this.GridList[i].Field2_Key.toString()),null!=e&&e.length>0&&(this.GridList[i].Field2=e[0].Name)),y.e.StringIsNullOrEmpty(this.GridList[i].Field3_Key)||(e=t.filter(e=>e.NodeID==this.GridList[i].Field3_Key.toString()),null!=e&&e.length>0&&(this.GridList[i].Field3=e[0].Name)),y.e.StringIsNullOrEmpty(this.GridList[i].Field4_Key)||(e=t.filter(e=>e.NodeID==this.GridList[i].Field4_Key.toString()),null!=e&&e.length>0&&(this.GridList[i].Field4=e[0].Name))):252==parseInt(this.GridList[i].DType)?(y.e.StringIsNullOrEmpty(this.GridList[i].Field3_Key)||(e=t.filter(e=>e.NodeID==this.GridList[i].Field3_Key.toString()),null!=e&&e.length>0&&(this.GridList[i].Field3=e[0].Name)),y.e.StringIsNullOrEmpty(this.GridList[i].Field4_Key)||(e=t.filter(e=>e.NodeID==this.GridList[i].Field4_Key.toString()),null!=e&&e.length>0&&(this.GridList[i].Field4=e[0].Name))):253==parseInt(this.GridList[i].DType)||(254==parseInt(this.GridList[i].DType)?y.e.StringIsNullOrEmpty(this.GridList[i].Field1_Key)||(e=t.filter(e=>e.NodeID==this.GridList[i].Field1_Key.toString()),null!=e&&e.length>0&&(this.GridList[i].Field1=e[0].Name)):255==parseInt(this.GridList[i].DType)&&(y.e.StringIsNullOrEmpty(this.GridList[i].Field5_Key)||(e=t.filter(e=>e.NodeID==this.GridList[i].Field5_Key.toString()),null!=e&&e.length>0&&(this.GridList[i].Field5=e[0].Name)),y.e.StringIsNullOrEmpty(this.GridList[i].Field15_Key)||(e=t.filter(e=>e.NodeID==this.GridList[i].Field15_Key.toString()),null!=e&&e.length>0&&(this.GridList[i].Field15=e[0].Name))))}}GetValidXml(e){return a.d.GetValidXml(e)}GetValidXmlReserve(e){return(e=(e=(e=e.Replace("&amp;","&")).Replace("''","'")).Replace("&quot;",'"')).Replace("&lt;","<")}}var w=i("4k0m"),F=i("++IR"),L=i("BJEe"),O=i("v5j5"),B=i("wJuo"),G=i("x68t"),x=i("THE7"),R=i("5FTv"),k=i("ia84"),j=i("SW+i"),_=i("wlFP");class W extends s.b{constructor(e,t,i,s,c){let y;if(super(),this.ClassName="AddEditEmpMasterViewModel",this.objEmp=new m.a,this.Opacity=1,this.DialogResult=!1,this.NextPreviousVisibility=!0,this.DisplayMessage="",this.MessageVisibility=!1,this.EmpCurrentStatusVisibility=!1,this.EmpCurrentStatus="",this._ScreenName="",this.ScreenObject=new n.a,this.NodeID=0,this.EmpCode=a.a.PactCodeData_1(3e4),this.EmpName=a.d.PactTextBoxData_1(30001),this.AliasName=a.d.PactTextBoxData_1(30062),this.Status=l.e.PactComboBoxData1(30002),this.EmpType=l.e.PactComboBoxData1(30357),this.EmpGroup=o.b.PactListBoxData_1(30003),this.DateOfJoining=new p.a(30359),this.DateOfBirth=new p.a(30360),this.RptManager=o.b.PactListBoxData_1(30358),this.Gender=l.e.PactComboBoxData1(30361),this.ProbationDays=a.d.PactTextBoxData_1(30362),this.DateOfConfirmation=new p.a(30363),this.ButtonSave=new r.a,this.ButtonApprove=new r.a,this.ButtonAppraisal=new r.a,this.ButtonCustomize=new r.a,this.EmpImage=new h.b,this.plBoxSalaryAccount=o.b.PactListBoxData_1(0),this.plBoxPayableAccount=o.b.PactListBoxData_1(0),this.FileID=0,this.FileExtension="",this.FileDescription="",this.IsPhotoDelete=!1,this.IsPhotoChanged=!1,this.ActualFileName="",this.AccountPhoto="",this.PhotoTextVisibility=!1,this.AttachmentVisibility=!1,this.NoteVisibility=!1,this.DetailsVisibility=!1,this.ContactVisibility=!1,this.AddressVisibility=!1,this.CCMapVisibility=!1,this.EmpDocumentsVisibility=!1,this.CostCenterID=0,this.ParentId=0,this.RetValue=0,this.guid="",this.EmpAttachmentguid="",this.ParentFeatureID=0,this.PNodeID=0,this.pcbPayrollType=null,this.pcbPaymentMode=null,this.pcbALType=null,this.pcbVacationPeriod=null,this.pcbMaritalStatus=null,this.pcbNationality=null,this.pcbReligion=null,this.txtBasicMonthly=null,this.txtVacDaysPerMonth=null,this.ptxtNetSalary=null,this.dtpNextAppraisal=null,this.DateOfRelieve=null,this.iPayrollTabIndex=-1,this.iAppraisalTabIndex=-1,this.iAccLinkTabIndex=-1,this.iBankNodeID=0,this.IsEdit=!1,this.isLoad=!1,this.dsPayStructure=null,this.sFilter="",this.dsGetBankDetails_web=null,this.AddeditAppraisalViewmodel=null,this.iAccruCnt=0,this.iEarCnt=0,this.fldDict=new S.a,this.sDecimalsAmount="N"+b.a.SessionManager.Preferences.DecimalsinAmount,this.webtotEarnings=0,this.webtotDeductions=0,this.oEvalPayFormulas=null,this.NextPrevID=0,this.ProfileID=-1,this.oFinalTab=null,this.IsExportPrint=!1,this.sXpsFileName="",this.drSelPrintLayout=null,this.dsTotLayouts=null,this.MoreThanOneLayout=!1,this.EmpImage.RowSpan=3,this.EmpImage.Row=0,this.EmpImage.Column=3,this.CostCenterID=50051,this.NodeID=e,this.ScreenName=s,this.MessageVisibility=!1,this.DisplayMessage="",this.AccountPhoto="",this.ParentId=i,this.objEmp.NodeID=this.NodeID,this.objEmp.IsGroup=c,this.objEmp.DOJ=new Date,this.objEmp.DOB=new Date,this.objEmp.DOConfirmation=new Date,this.ViewContacts=new x.a(this),this.ViewNotes=new A.a(this,b.a.SessionManager,b.a.admin),this.ViewAttachments=new E.ViewAttachmentViewModel(this,b.a.SessionManager,b.a.admin),this.ViewAddress=new u.a(this),this.ViewCCMapping=new T.a(this),this.ViewCCMapping.ViewCCMappingViewModel_1(this,this.CostCenterID,this.NodeID),null==this.ScreenObject.StaticFields&&(this.ScreenObject.StaticFields=[]),this.ScreenObject.LoadScreen_1(this,50051,c),this.LoadImageDimensions(),this.plBoxSalaryAccount=this.GetScreenControl("SalaryAccID"),this.plBoxPayableAccount=this.GetScreenControl("PayableAccID"),this.pcbPayrollType=this.GetScreenControl("PayType"),null!=this.pcbPayrollType&&this.pcbPayrollType.SelectionChangedCommand.Subscribe(this,"PayrollType_SelectionChanged"),this.DateOfJoining=this.GetScreenControl("DOJ"),this.DateOfJoining.SelectedDateChanged.Subscribe(this,"DateOfJoining_SelectedDateChanged"),this.ProbationDays=this.GetScreenControl("ProbationDays"),this.ProbationDays.LostFocusCommand.Subscribe(this,"ProbationDays_LostFocus"),this.ProbationDays.Text=""!=b.a.SessionManager.Preferences.DefaultProbationDays&&parseInt(b.a.SessionManager.Preferences.DefaultProbationDays)>0?b.a.SessionManager.Preferences.DefaultProbationDays:"0",this.ProbationDays_LostFocus(this.ProbationDays),this.DateOfRelieve=this.GetScreenControl("DORelieve"),this.dtpNextAppraisal=this.GetScreenControl("NextAppraisalDate"),this.ptxtNetSalary=this.GetScreenControl("NetSalary"),null!=this.ptxtNetSalary&&(this.ptxtNetSalary.Enable=!1),this.txtBasicMonthly=this.GetScreenControl("BasicMonthly"),this.txtBasicMonthly.LostFocusCommand.Subscribe(this,"txtBasicMonthly_LostFocus"),this.dsPayStructure=this.objEmp.GetQueryData(this.NodeID,"dsPayStructure","","",""),this.dgvPayrollEar=new g.a,this.dgvPayrollEar.Columns=[],this.dgvPayrollEar.Height=250,this.dgvPayrollEar.Width="",y=new D.a,y.Header=b.a.GetResource("Payroll_EmpSNo"),y.DisplayMember="SlNo",y.ID="SlNo",y.Width=60,y.ReadOnly=!0,this.dgvPayrollEar.Columns.push(y),y=new D.a,y.Header=b.a.GetResource("Earnings"),y.DisplayMember="Earnings",y.ID="Earnings",y.Width=250,y.ReadOnly=!0,this.dgvPayrollEar.Columns.push(y),y=new D.a,y.Header=b.a.GetResource("Value"),y.DisplayMember="EarValue",y.ID="EarValue",y.DefaultValue=(0).ToString(this.sDecimalsAmount),y.Width=130,y.ReadOnly=!1,y.DataType="FLOAT",y.ShowTotal=!0,y.IsCalculated=1,y.DecimalPoints="2",this.dgvPayrollEar.Columns.push(y),this.dgvPayrollAccrual=new g.a,this.dgvPayrollAccrual.Columns=[],this.dgvPayrollAccrual.Height=150,this.dgvPayrollAccrual.Width="",this.dgvPayrollAccrual.Visible=!1,y=new D.a,y.Header=b.a.GetResource("Payroll_EmpSNo"),y.DisplayMember="SlNo",y.ID="SlNo",y.Width=60,y.ReadOnly=!0,this.dgvPayrollAccrual.Columns.push(y),y=new D.a,y.Header="Accrual Type",y.DisplayMember="Earnings",y.ID="Earnings",y.Width=250,y.ReadOnly=!0,this.dgvPayrollAccrual.Columns.push(y),y=new D.a,y.Header=b.a.GetResource("Value"),y.DisplayMember="EarValue",y.ID="EarValue",y.DefaultValue=(0).ToString(this.sDecimalsAmount),y.Width=130,y.ReadOnly=!1,y.DataType="FLOAT",y.ShowTotal=!0,y.IsCalculated=1,y.DecimalPoints="2",this.dgvPayrollAccrual.Columns.push(y),this.dgvPayrollDed=new g.a,this.dgvPayrollDed.Columns=[],this.dgvPayrollDed.Height=250,this.dgvPayrollDed.Width="",y=new D.a,y.Header=b.a.GetResource("Payroll_EmpSNo"),y.DisplayMember="SlNo",y.ID="SlNo",y.Width=60,y.ReadOnly=!0,this.dgvPayrollDed.Columns.push(y),y=new D.a,y.Header=b.a.GetResource("Deductions"),y.DisplayMember="Deductions",y.ID="Deductions",y.Width=250,y.ReadOnly=!0,this.dgvPayrollDed.Columns.push(y),y=new D.a,y.Header=b.a.GetResource("Value"),y.DisplayMember="DedValue",y.ID="DedValue",y.DefaultValue=(0).ToString(this.sDecimalsAmount),y.Width=130,y.ReadOnly=!0,y.DataType="FLOAT",y.ShowTotal=!0,y.IsCalculated=1,y.DecimalPoints="2",this.dgvPayrollDed.Columns.push(y),this.dgvPayrollEar.Table=[],this.dgvPayrollEar.TableColumns.push("SlNo"),this.dgvPayrollEar.TableColumns.push("Earnings"),this.dgvPayrollEar.TableColumns.push("EarValue"),this.dgvPayrollEar.TableColumns.push("EarAddToNet"),this.dgvPayrollEar.TableColumns.push("EarFType"),this.dgvPayrollEar.TableColumns.push("Earnings_GRAY"),this.dgvPayrollEar.TableColumns.push("EarValue_GRAY"),this.dgvPayrollEar.TableColumns.push("EarSNo"),this.dgvPayrollEar.TableColumns.push("EarFormula"),this.dgvPayrollEar.TableColumns.push("EarROff"),this.dgvPayrollEar.TableColumns.push("EarComponentID"),this.dgvPayrollEar.TableColumns.push("IsVisible"),this.dgvPayrollEar.TableColumns.push("IsAccrualType"),this.dgvPayrollAccrual.Table=[],this.dgvPayrollAccrual.TableColumns.push("SlNo"),this.dgvPayrollAccrual.TableColumns.push("Earnings"),this.dgvPayrollAccrual.TableColumns.push("EarValue"),this.dgvPayrollAccrual.TableColumns.push("EarAddToNet"),this.dgvPayrollAccrual.TableColumns.push("EarFType"),this.dgvPayrollAccrual.TableColumns.push("Earnings_GRAY"),this.dgvPayrollAccrual.TableColumns.push("EarValue_GRAY"),this.dgvPayrollAccrual.TableColumns.push("EarSNo"),this.dgvPayrollAccrual.TableColumns.push("EarFormula"),this.dgvPayrollAccrual.TableColumns.push("EarROff"),this.dgvPayrollAccrual.TableColumns.push("EarComponentID"),this.dgvPayrollAccrual.TableColumns.push("IsVisible"),this.dgvPayrollAccrual.TableColumns.push("IsAccrualType"),this.dgvPayrollDed.Table=[],this.dgvPayrollDed.TableColumns.push("SlNo"),this.dgvPayrollDed.TableColumns.push("Deductions"),this.dgvPayrollDed.TableColumns.push("DedValue"),this.dgvPayrollDed.TableColumns.push("DedAddToNet"),this.dgvPayrollDed.TableColumns.push("DedFType"),this.dgvPayrollDed.TableColumns.push("Deductions_GRAY"),this.dgvPayrollDed.TableColumns.push("DedValue_GRAY"),this.dgvPayrollDed.TableColumns.push("DedSNo"),this.dgvPayrollDed.TableColumns.push("DedFormula"),this.dgvPayrollDed.TableColumns.push("DedROff"),this.dgvPayrollDed.TableColumns.push("DedComponentID"),this.dgvPayrollDed.TableColumns.push("IsVisible"),this.dgvPayrollEar.BeginEdit.Subscribe(this,"dgvPayrollEar_BeginEdit"),this.dgvPayrollEar.CellEditEnding.Subscribe(this,"dgvPayrollEar_EndEdit"),this.dgvPayrollAccrual.BeginEdit.Subscribe(this,"dgvPayrollAccrual_BeginEdit"),this.dgvPayrollAccrual.CellEditEnding.Subscribe(this,"dgvPayrollAccrual_EndEdit"),this.dgvPayrollDed.BeginEdit.Subscribe(this,"dgvPayrollDed_BeginEdit"),this.dgvPayrollDed.CellEditEnding.Subscribe(this,"dgvPayrollDed_EndEdit"),this.LoadPayrollGrid(),this.dgvPayrollEar.Column=0,this.dgvPayrollEar.Row=2,this.dgvPayrollEar.ColumnSpan=2,this.dgvPayrollEar.RowSpan=5,this.dgvPayrollAccrual.Column=0,this.dgvPayrollAccrual.Row=2,this.dgvPayrollAccrual.ColumnSpan=2,this.dgvPayrollAccrual.RowSpan=5,this.dgvPayrollDed.Column=2,this.dgvPayrollDed.Row=2,this.dgvPayrollDed.ColumnSpan=2,this.dgvPayrollDed.RowSpan=5,this.ScreenObject.CustomTab.Pages.find(e=>720==e.DBColumnID),this.iPayrollTabIndex=this.ScreenObject.CustomTab.Pages.findIndex(e=>720==e.DBColumnID),this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields.push(this.dgvPayrollEar),this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields.push(this.dgvPayrollDed),this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields.push(this.dgvPayrollAccrual),this.iAccruCnt>0&&(this.dgvPayrollAccrual.Visible=!0),b.a.SessionManager.Preferences.ContainsKey("ConsiderGradeWiseSalarySlabs")&&"True"==b.a.SessionManager.Preferences.ConsiderGradeWiseSalarySlabs){let e=new r.a;e.Label="Pick Min.",e.Column=3,e.Row=0,e.ImgData="btn_min",e.Icon="fa-light fa-windows-maximize",e.ComParam="PickMin",e.Margin="-30,2,40,2",e.Width="50",this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields.push(e);let t=new r.a;t.Label="Pick Max.",t.Column=3,t.Row=0,e.ImgData="btn_min",e.Icon="fa-light fa-windows-maximize",t.ComParam="PickMax",t.Margin="40,2,2,2",t.Width="50",this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields.push(t)}this.dgvAppraisal=new g.a,this.dgvAppraisal.DoubleClick.Subscribe(this,"dgvAppraisal_CellDoubleClick"),this.dgvAppraisal.Columns=[],this.dgvAppraisal.Height=250,this.dgvAppraisal.Width="",this.dgvAppraisal.Table=[],y=new D.a,y.Header=b.a.GetResource("Payroll_EmpSNo"),y.DisplayMember="SlNo",y.ID="SlNo",y.Width=60,y.ReadOnly=!0,this.dgvAppraisal.Columns.push(y),y=new D.a,y.Header=b.a.GetResource("Payroll_AppraisalDate"),y.DisplayMember="AppraisalDate",y.ID="AppraisalDate",y.Width=100,y.ReadOnly=!0,this.dgvAppraisal.Columns.push(y),y=new D.a,y.Header=b.a.GetResource("Payroll_NetSalary"),y.DisplayMember="NetSalary",y.ID="NetSalary",y.Width=100,y.DataType="FLOAT",y.ReadOnly=!0,this.dgvAppraisal.Columns.push(y),y=new D.a,y.Header=b.a.GetResource("Payroll_Basic"),y.DisplayMember="Basic",y.ID="Basic",y.Width=90,y.DataType="FLOAT",y.ReadOnly=!0,this.dgvAppraisal.Columns.push(y),this.LoadAppraisalGrid(),y=new D.a,y.Header=b.a.GetResource("Payroll_Remarks"),y.DisplayMember="Remarks",y.ID="Remarks",y.Width=150,y.ReadOnly=!0,this.dgvAppraisal.Columns.push(y),y=new D.a,y.Header=b.a.GetResource("Payroll_Reason"),y.DisplayMember="Reason",y.ID="Reason",y.Width=150,y.ReadOnly=!0,this.dgvAppraisal.Columns.push(y),y=new D.a,y.Header=b.a.GetResource("Payroll_AppraisalType"),y.DisplayMember="AppraisalType",y.ID="AppraisalType",y.Width=100,y.ReadOnly=!0,y.IsVisible=!(!b.a.SessionManager.Preferences.ContainsKey("ShowApprslTypeLookUpFldsInApprPopup")||"True"!=b.a.SessionManager.Preferences.ShowApprslTypeLookUpFldsInApprPopup),this.dgvAppraisal.Columns.push(y),this.dgvAppraisal.Column=0,this.dgvAppraisal.Row=0,this.dgvAppraisal.ColumnSpan=4,this.dgvAppraisal.RowSpan=5,this.ScreenObject.CustomTab.Pages.find(e=>726==e.DBColumnID),this.iAppraisalTabIndex=this.ScreenObject.CustomTab.Pages.findIndex(e=>726==e.DBColumnID),this.ScreenObject.CustomTab.Pages[this.iAppraisalTabIndex].Fields.push(this.dgvAppraisal),this.pcbALType=new l.e,this.pcbALType.Row=1,this.pcbALType.Column=0,this.pcbALType.DBColumnName="pcbALType",this.pcbALType.Items.push(l.d.ComboBoxItems_1("Earnings")),this.pcbALType.Items.push(l.d.ComboBoxItems_1("Deductions")),this.pcbALType.Items.push(l.d.ComboBoxItems_1("Loans")),this.pcbALType.SelectionChangedCommand.Subscribe(this,"pcbALType_SelectionChanged"),this.dgvAccLinking=new g.a,this.dgvAccLinking.Columns=[],this.dgvAccLinking.Height=250,this.dgvAccLinking.Width="",this.dgvAccLinking.DBColumnName="EMPACCOUNTLINK",y=new D.a,y.Header=b.a.GetResource("Payroll_EmpSNo"),y.DisplayMember="SlNo",y.ID="SlNo",y.Width=60,y.ReadOnly=!0,this.dgvAccLinking.Columns.push(y),y=new D.a,y.Header=b.a.GetResource("Payroll_EmpComponentName"),y.DisplayMember="ComponentName",y.ID="ComponentName",y.Width=300,y.ReadOnly=!0,this.dgvAccLinking.Columns.push(y),y=new D.a,y.Header=b.a.GetResource("Payroll_EmpDebitAccount"),y.DisplayMember="DebitAccountID",y.ID="DebitAccountID",y.DataType="LISTBOX",y.CostCenterID=2,y.TypeID=2,y.Width=250,y.IsVisible=!0,this.dgvAccLinking.Columns.push(y),y=new D.a,y.Header=b.a.GetResource("Payroll_EmpCreditAccount"),y.DisplayMember="CreditAccountID",y.ID="CreditAccountID",y.DataType="LISTBOX",y.CostCenterID=2,y.TypeID=2,y.Width=250,y.IsVisible=!0,this.dgvAccLinking.Columns.push(y),this.dgvAccLinking.Column=0,this.dgvAccLinking.Row=2,this.dgvAccLinking.ColumnSpan=4,this.dgvAccLinking.RowSpan=5,this.dgvAccLinking.Table=[],this.LoadAccountLinkingGrid(),this.ScreenObject.CustomTab.Pages.find(e=>732==e.DBColumnID),this.iAccLinkTabIndex=this.ScreenObject.CustomTab.Pages.findIndex(e=>732==e.DBColumnID),this.ScreenObject.CustomTab.Pages[this.iAccLinkTabIndex].Fields.push(this.pcbALType),this.ScreenObject.CustomTab.Pages[this.iAccLinkTabIndex].Fields.push(this.dgvAccLinking),this.pcbALType.SelectedValue=this.pcbALType.Items[0].Value,this.pcbALType_SelectionChanged(""),this.ViewEmpDocuments=new v(this),this.ViewEmpDocuments.OwnedScreen=this;for(let a=this.ScreenObject.CustomTab.Pages.length-1;a>=0;a--){let e=this.ScreenObject.CustomTab.Pages[a];switch(e.Name){case"Notes":e.Fields.push(this.ViewNotes);break;case"Contacts":e.Fields.push(this.ViewContacts);break;case"Address":e.Fields.push(this.ViewAddress);break;case"Attachments":e.Fields.push(this.ViewAttachments);break;case"Assign":e.Fields.push(this.ViewCCMapping);break;case"Documents":e.Fields.push(this.ViewEmpDocuments)}}this.ContactVisibility=!1,this.DetailsVisibility=!1,this.AttachmentVisibility=!1,this.AddressVisibility=!1,this.CCMapVisibility=!1,this.EmpDocumentsVisibility=!1,this.ScreenObject.CustomTab.OnTabChange.Subscribe(this,"OnTabSelectionChanged"),this.EmpGroup.SelectionChangedCommand.Subscribe(this,"OnGroupSelectionChanged"),this.pc1=this.GetScreenControl("iBank"),this.pc1.SelectionChangedCommand.Subscribe(this,"GetBankDetails");let C=this.GetScreenControl("AttSetType");if(C.Items[0].CheckedChangedCommand.Subscribe(this,"AttSetTypeCheckedChanged"),C.Items[1].CheckedChangedCommand.Subscribe(this,"AttSetTypeCheckedChanged"),this.AttSetTypeCheckedChanged(C.Items[0]),this.ButtonSave=new r.a,this.ButtonCustomize=new r.a,this.ButtonAppraisal=new r.a,0==this.NodeID?(this.DisplayName=-1==s.indexOf("Add")?b.a.GetResource("Add")+" "+s:s,b.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=b.a.SessionManager.IsActionAssigned(this.CostCenterID,"Create"):this.ButtonSave.Enable=b.a.SessionManager.IsActionAssigned(this.CostCenterID,"Create"),this.EmpGroup.SelectedValue=this.ParentId,this.EmpGroup.DefaultValue=this.EmpGroup.SelectedValue.toString(),this.IsEdit=!1):(this.DisplayName=-1==s.indexOf("Edit")?b.a.GetResource("Edit")+" "+s:s,b.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=b.a.SessionManager.IsActionAssigned(this.CostCenterID,"Update"):this.ButtonSave.Enable=b.a.SessionManager.IsActionAssigned(this.CostCenterID,"Update"),this.IsEdit=!0),b.a.SessionManager.HideUnathorizedAccess?this.ButtonAppraisal.Visible=b.a.SessionManager.IsActionAssigned(this.CostCenterID,"Appraisal"):this.ButtonAppraisal.Enable=b.a.SessionManager.IsActionAssigned(this.CostCenterID,"Appraisal"),b.a.SessionManager.HideUnathorizedAccess?this.ButtonCustomize.Visible=b.a.SessionManager.IsActionAssigned(this.CostCenterID,"Customize"):this.ButtonCustomize.Enable=b.a.SessionManager.IsActionAssigned(this.CostCenterID,"Customize"),null!=this.ScreenObject.Data&&this.ScreenObject.Data.Tables.length>0&&this.ScreenObject.Data.Tables[0].length>0){let e,t;this.ScreenObject.Data.Tables.length>2&&this.ScreenObject.Data.Tables[3].forEach(e=>{this.Status.Items.push(l.d.ComboBoxItems_2(e[Object.keys(e)[1]].toString(),e[Object.keys(e)[0]].toString()))}),this.dvLookUps=this.ScreenObject.Data.Tables[8],this.ScreenObject.Data.Tables.length>8&&(e=this.dvLookUps.filter(e=>"104"==e.LookupType),e&&this.FillComboWithDefaultOption(e,this.EmpType,!0),e=this.dvLookUps.filter(e=>"123"==e.LookupType),e&&this.FillComboWithDefaultOption(e,this.Gender,!0)),this.ScreenObject.HeaderFields.length>0&&this.ScreenObject.HeaderFields.forEach(t=>{if(t instanceof l.e)if("MaritalStatus"==t.DBColumnName)this.pcbMaritalStatus=t,e=this.dvLookUps.filter(e=>"122"==e.LookupType),e&&this.FillComboWithDefaultOption(e,t,!0);else if("PayType"==t.DBColumnName)t.Items.push(l.d.ComboBoxItems_2("Monthly","Monthly")),t.Items.push(l.d.ComboBoxItems_2("Weekly","Weekly")),t.Items.push(l.d.ComboBoxItems_2("Daily","Daily")),t.Items.push(l.d.ComboBoxItems_2("Hourly","Hourly")),t.SelectedValue="Monthly";else if("IsAllowOT"==t.DBColumnName)t.Items.push(l.d.ComboBoxItems_2("Yes","Yes")),t.Items.push(l.d.ComboBoxItems_2("No","No")),t.SelectedValue="No";else if("WeeklyOff1"==t.DBColumnName||"WeeklyOff2"==t.DBColumnName)t.Items.push(l.d.ComboBoxItems_2("None","None")),t.Items.push(l.d.ComboBoxItems_2("Sunday","Sunday")),t.Items.push(l.d.ComboBoxItems_2("Monday","Monday")),t.Items.push(l.d.ComboBoxItems_2("Tuesday","Tuesday")),t.Items.push(l.d.ComboBoxItems_2("Wednesday","Wednesday")),t.Items.push(l.d.ComboBoxItems_2("Thursday","Thursday")),t.Items.push(l.d.ComboBoxItems_2("Friday","Friday")),t.Items.push(l.d.ComboBoxItems_2("Saturday","Saturday")),t.SelectedValue="None";else if("PaymentMode"==t.DBColumnName)this.pcbPaymentMode=t,this.pcbPaymentMode.Items.push(l.d.ComboBoxItems_2("Cash","Cash")),this.pcbPaymentMode.Items.push(l.d.ComboBoxItems_2("Cheque","Cheque")),this.pcbPaymentMode.Items.push(l.d.ComboBoxItems_2("Bank Transfer","Bank Transfer")),this.pcbPaymentMode.Items.push(l.d.ComboBoxItems_2("Demand Draft","Demand Draft")),this.pcbPaymentMode.SelectionChangedCommand.Subscribe(this,"PaymentMode_SelectionChanged"),this.pcbPaymentMode.SelectedValue="Cash",this.PaymentMode_SelectionChanged("");else if("VacationPeriod"==t.DBColumnName)t.Items.push(l.d.ComboBoxItems_2("Half Yearly","Half Yearly")),t.Items.push(l.d.ComboBoxItems_2("Yearly","Yearly")),t.Items.push(l.d.ComboBoxItems_2("Two Years","Two Years")),t.SelectedValue="Yearly";else if("TktAirClass"==t.DBColumnName)t.Items.push(l.d.ComboBoxItems_2("First Class","First Class")),t.Items.push(l.d.ComboBoxItems_2("Business Class","Business Class")),t.Items.push(l.d.ComboBoxItems_2("Economy Class","Economy Class"));else if("Nationality"==t.DBColumnName)this.pcbNationality=t,e=this.dvLookUps.filter(e=>"108"==e.LookupType),e&&this.FillComboWithDefaultOption(e,t,!0);else if("Religion"==t.DBColumnName)this.pcbReligion=t,e=this.dvLookUps.filter(e=>"114"==e.LookupType),e&&this.FillComboWithDefaultOption(e,t,!0);else if("CanCreateUser"==t.DBColumnName)t.Items.push(l.d.ComboBoxItems_2("Yes","Yes")),t.Items.push(l.d.ComboBoxItems_2("No","No")),t.SelectedValue="No";else if("RoleID"==t.DBColumnName){let e=this.GetRoles();e.Tables.length>0&&e.Tables[0].length>0&&e.Tables[0].forEach(e=>{t.Items.push(l.d.ComboBoxItems_2(e.Name.toString(),e.RoleID.toString())),b.a.SessionManager.StringIsNullOrEmpty(e.IsUserDefined)||"FALSE"!=e.IsUserDefined.toString().toUpperCase()||b.a.SessionManager.StringIsNullOrEmpty(e.CompanyGUID)||"HRM-Employee-Role"!=e.CompanyGUID.toString()||(t.SelectedValue=e.RoleID.toString())})}else"IsManager"==t.DBColumnName&&(t.Items.push(l.d.ComboBoxItems_2("Yes","Yes")),t.Items.push(l.d.ComboBoxItems_2("No","No")),t.SelectedValue="No");else t instanceof o.b&&("SalaryAccID"==t.DBColumnName?b.a.SessionManager.Preferences.ContainsKey("CreateSalaryAcc")&&"True"==b.a.SessionManager.Preferences.CreateSalaryAcc&&parseInt(b.a.SessionManager.Preferences.CreateSalaryAccGrp)>0&&(t.CustomWhere=" a.IsGroup=0 AND a.ParentID="+parseInt(b.a.SessionManager.Preferences.CreateSalaryAccGrp)):"PayableAccID"==t.DBColumnName&&b.a.SessionManager.Preferences.ContainsKey("CreatePayableAcc")&&"True"==b.a.SessionManager.Preferences.CreatePayableAcc&&parseInt(b.a.SessionManager.Preferences.CreatePayableAccGrp)>0&&(t.CustomWhere=" a.IsGroup=0 AND a.ParentID="+parseInt(b.a.SessionManager.Preferences.CreatePayableAccGrp)))}),this.ScreenObject.CustomTab.Pages.length>0&&this.ScreenObject.CustomTab.Pages.forEach(t=>{t.Fields.forEach(t=>{if(t instanceof l.e)if("MaritalStatus"==t.DBColumnName)this.pcbMaritalStatus=t,e=this.dvLookUps.filter(e=>"122"==e.LookupType),e&&this.FillComboWithDefaultOption(e,t,!0);else if("PayType"==t.DBColumnName)t.Items.push(l.d.ComboBoxItems_2("Monthly","Monthly")),t.Items.push(l.d.ComboBoxItems_2("Weekly","Weekly")),t.Items.push(l.d.ComboBoxItems_2("Daily","Daily")),t.Items.push(l.d.ComboBoxItems_2("Hourly","Hourly")),t.SelectedValue="Monthly";else if("IsAllowOT"==t.DBColumnName)t.Items.push(l.d.ComboBoxItems_2("Yes","Yes")),t.Items.push(l.d.ComboBoxItems_2("No","No")),t.SelectedValue="No";else if("WeeklyOff1"==t.DBColumnName||"WeeklyOff2"==t.DBColumnName)t.Items.push(l.d.ComboBoxItems_2("None","None")),t.Items.push(l.d.ComboBoxItems_2("Sunday","Sunday")),t.Items.push(l.d.ComboBoxItems_2("Monday","Monday")),t.Items.push(l.d.ComboBoxItems_2("Tuesday","Tuesday")),t.Items.push(l.d.ComboBoxItems_2("Wednesday","Wednesday")),t.Items.push(l.d.ComboBoxItems_2("Thursday","Thursday")),t.Items.push(l.d.ComboBoxItems_2("Friday","Friday")),t.Items.push(l.d.ComboBoxItems_2("Saturday","Saturday")),t.SelectedValue="None";else if("PaymentMode"==t.DBColumnName)this.pcbPaymentMode=t,this.pcbPaymentMode.Items.push(l.d.ComboBoxItems_2("Cash","Cash")),this.pcbPaymentMode.Items.push(l.d.ComboBoxItems_2("Cheque","Cheque")),this.pcbPaymentMode.Items.push(l.d.ComboBoxItems_2("Bank Transfer","Bank Transfer")),this.pcbPaymentMode.Items.push(l.d.ComboBoxItems_2("Demand Draft","Demand Draft")),this.pcbPaymentMode.SelectionChangedCommand.Subscribe(this,"PaymentMode_SelectionChanged"),this.pcbPaymentMode.SelectedValue="Cash",this.PaymentMode_SelectionChanged("");else if("VacationPeriod"==t.DBColumnName)t.Items.push(l.d.ComboBoxItems_2("Half Yearly","Half Yearly")),t.Items.push(l.d.ComboBoxItems_2("Yearly","Yearly")),t.Items.push(l.d.ComboBoxItems_2("Two Years","Two Years")),t.SelectedValue="Yearly";else if("TktAirClass"==t.DBColumnName)t.Items.push(l.d.ComboBoxItems_2("First Class","First Class")),t.Items.push(l.d.ComboBoxItems_2("Business Class","Business Class")),t.Items.push(l.d.ComboBoxItems_2("Economy Class","Economy Class"));else if("Nationality"==t.DBColumnName)this.pcbNationality=t,e=this.dvLookUps.filter(e=>"108"==e.LookupType),e&&this.FillComboWithDefaultOption(e,t,!0);else if("Religion"==t.DBColumnName)this.pcbReligion=t,e=this.dvLookUps.filter(e=>"114"==e.LookupType),e&&this.FillComboWithDefaultOption(e,t,!0);else if("CanCreateUser"==t.DBColumnName)t.Items.push(l.d.ComboBoxItems_2("Yes","Yes")),t.Items.push(l.d.ComboBoxItems_2("No","No")),t.SelectedValue="No";else if("RoleID"==t.DBColumnName){let e=this.GetRoles();e.Tables.length>0&&e.Tables[0].length>0&&e.Tables[0].forEach(e=>{t.Items.push(l.d.ComboBoxItems_2(e.Name.toString(),e.RoleID.toString())),b.a.SessionManager.StringIsNullOrEmpty(e.IsUserDefined)||"FALSE"!=e.IsUserDefined.toString().toUpperCase()||b.a.SessionManager.StringIsNullOrEmpty(e.CompanyGUID)||"HRM-Employee-Role"!=e.CompanyGUID.toString()||(t.SelectedValue=e.RoleID.toString())})}else"IsManager"==t.DBColumnName&&(t.Items.push(l.d.ComboBoxItems_2("Yes","Yes")),t.Items.push(l.d.ComboBoxItems_2("No","No")),t.SelectedValue="No");else t instanceof o.b&&("SalaryAccID"==t.DBColumnName?b.a.SessionManager.Preferences.ContainsKey("CreateSalaryAcc")&&"True"==b.a.SessionManager.Preferences.CreateSalaryAcc&&parseInt(b.a.SessionManager.Preferences.CreateSalaryAccGrp)>0&&(t.CustomWhere=" a.IsGroup=0 AND a.ParentID="+parseInt(b.a.SessionManager.Preferences.CreateSalaryAccGrp)):"PayableAccID"==t.DBColumnName&&b.a.SessionManager.Preferences.ContainsKey("CreatePayableAcc")&&"True"==b.a.SessionManager.Preferences.CreatePayableAcc&&parseInt(b.a.SessionManager.Preferences.CreatePayableAccGrp)>0&&(t.CustomWhere=" a.IsGroup=0 AND a.ParentID="+parseInt(b.a.SessionManager.Preferences.CreatePayableAccGrp)));t instanceof l.b&&"CheckInOutDevice"==t.DBColumnName&&(t.Items.push(l.c.CheckedListBoxItem_3("Desktop","1")),t.Items.push(l.c.CheckedListBoxItem_3("Web","2")),t.Items.push(l.c.CheckedListBoxItem_3("Mobile","3")))})}),this.Title=this.DisplayName,t=this.ScreenObject.Data.Tables[5].filter(e=>"CapsLock"==e.Name),null!=t&&t.length>0&&"true"==t[0].Value.toString().toLowerCase()&&(this.EmpName.IsAllCaps=!0),t=this.ScreenObject.Data.Tables[5].filter(e=>"CapsToFirstLetter"==e.Name),null!=t&&t.length>0&&"true"==t[0].Value.toString().toLowerCase()&&(this.EmpName.IsFirstLetterCaps=!0),t=this.ScreenObject.Data.Tables[5].filter(e=>"AttachementThumbnail"==e.Name),t.length>0&&Object(d.j)(t[0].Value)&&(this.ViewAttachments.GridView=!0),null!=this.ScreenObject.Data&&this.ScreenObject.Data.Tables.length>7&&this.ScreenObject.Data.Columns[7].Contains("IsParentCodeInherited")&&this.ScreenObject.Data.Tables[7].length>0&&this.ScreenObject.InitAutoCode(this.ScreenObject.Data.Tables[7],this.objEmp.IsGroup),this.IsPhotoChanged=!1,this.PhotoTextVisibility=!0,this.AccountPhoto="";let i=this.objEmp.GetQueryData(0,"dtApprRes","","","");if(null!=i&&i.length>0){let e=i.filter(e=>"dcAlpha3"==e.SysColumnName);null!=e&&e.length>0&&(this.ButtonAppraisal.Label=e[0].ResourceData.toString())}this.Status.SelectedValue=""!=b.a.SessionManager.Preferences.DefaultEmpStatus?b.a.SessionManager.Preferences.DefaultEmpStatus:"250",this.txtVacDaysPerMonth=this.GetScreenControl("VacDaysPerMonth"),null!=this.txtVacDaysPerMonth&&(this.txtVacDaysPerMonth.Currency.SelectedValue=b.a.SessionManager.Preferences.DefVacationDaysMonthlyOrYearly,this.txtVacDaysPerMonth.ExchangeRate.Text=b.a.SessionManager.Preferences.DefVacationDays);let s=this.objEmp.LoadStructure_1(b.a.SessionManager.PayrollMonthEnd.ToString("dd/MMM/yyyy"),this.sFilter);null!=s&&s.Tables.length>0&&(this.dvCCData=s.Tables[0]);let a=this.objEmp.GetQueryData(0,"dvDimsData","","","");if(null!=a&&null!=a&&(this.dvDimsData=a),this.ScreenObject.NodeID=this.NodeID,b.a.SessionManager.Preferences.ContainsKey("AttendanceDimension")&&""!=b.a.SessionManager.Preferences.AttendanceDimension.toString()&&"4"!=b.a.SessionManager.Preferences.AttendanceDimension.toString()){let e=this.objEmp.GetQueryData(0,"AttendanceDimension",this.ScreenObject.GetTableName(parseInt(b.a.SessionManager.Preferences.AttendanceDimension)),"","");if(null!=e&&e.length>0){var I=this.GetScreenControl("AttSetDimNodes");if(I instanceof l.b){I.Items.push(l.c.CheckedListBoxItem_3("All","-1"));for(let t=0;t<e.length;t++)I.Items.push(l.c.CheckedListBoxItem_3(e[t].Name.toString(),e[t].NodeID.toString()))}}}this.EmpCurrentStatus="",0!=this.NodeID?(this.FillControls(),this.EmpCurrentStatusVisibility=!0):(this.EmpCurrentStatusVisibility=!1,this.objEmp.GUID="",this.NextPreviousVisibility=!1,this.AutoGenerateCode()),this.CheckViewForUser(0)}this.RestrictSaveButton(),this.pcbALType_SelectionChanged("")}OnComboChange(e){console.log(e)}OnPListChange(e){}fn_AttachmentVisibility(){this.AttachmentVisibility?(this.DetailsVisibility=!1,this.ContactVisibility=!1,this.NoteVisibility=!1,this.AddressVisibility=!1,this.CCMapVisibility=!1,this.EmpDocumentsVisibility=!1):this.ContactVisibility||this.NoteVisibility||this.AddressVisibility||this.AttachmentVisibility||this.CCMapVisibility||this.EmpDocumentsVisibility||(this.DetailsVisibility=!0)}fn_NoteVisibility(){this.NoteVisibility?(this.DetailsVisibility=!1,this.ContactVisibility=!1,this.AttachmentVisibility=!1,this.AddressVisibility=!1,this.CCMapVisibility=!1,this.EmpDocumentsVisibility=!1):this.ContactVisibility||this.NoteVisibility||this.AddressVisibility||this.AttachmentVisibility||this.CCMapVisibility||this.EmpDocumentsVisibility||(this.DetailsVisibility=!0)}fn_DetailsVisibility(){this.DetailsVisibility&&(this.ContactVisibility=!1,this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.AddressVisibility=!1,this.CCMapVisibility=!1,this.EmpDocumentsVisibility=!1)}fn_ContactVisibility(){this.ContactVisibility?(this.DetailsVisibility=!1,this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.AddressVisibility=!1,this.CCMapVisibility=!1,this.EmpDocumentsVisibility=!1):this.ContactVisibility||this.NoteVisibility||this.AddressVisibility||this.AttachmentVisibility||this.CCMapVisibility||this.EmpDocumentsVisibility||(this.DetailsVisibility=!0)}fn_AddressVisibility(){this.AddressVisibility?(this.DetailsVisibility=!1,this.ContactVisibility=!1,this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.CCMapVisibility=!1,this.EmpDocumentsVisibility=!1):this.ContactVisibility||this.NoteVisibility||this.AddressVisibility||this.AttachmentVisibility||this.CCMapVisibility||this.EmpDocumentsVisibility||(this.DetailsVisibility=!0)}fn_CCMapVisibility(){this.CCMapVisibility?(this.DetailsVisibility=!1,this.ContactVisibility=!1,this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.EmpDocumentsVisibility=!1):this.ContactVisibility||this.NoteVisibility||this.AddressVisibility||this.AttachmentVisibility||this.CCMapVisibility||this.EmpDocumentsVisibility||(this.DetailsVisibility=!0)}fn_EmpDocumentsVisibility(){this.EmpDocumentsVisibility?(this.DetailsVisibility=!1,this.ContactVisibility=!1,this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.CCMapVisibility=!1,this.AddressVisibility=!1):this.ContactVisibility||this.NoteVisibility||this.AddressVisibility||this.AttachmentVisibility||this.CCMapVisibility||this.EmpDocumentsVisibility||(this.DetailsVisibility=!0)}FillComboWithDefaultOption(e,t,i){b.a.SessionManager.Logger.InfoLog("Administration:: Inside FillComboWithDefaultOption");try{i&&t.Items.push(l.d.ComboBoxItems_2("","0")),null!=e&&e.length>0?e.forEach(e=>{t.Items.push(l.d.ComboBoxItems_2(e.Name.toString(),e.NodeID.toString())),b.a.SessionManager.StringIsNullOrEmpty(e.IsDefault)||Object(d.j)(e.IsDefault)&&(t.SelectedValue=e.NodeID.toString(),t.DefaultValue=e.NodeID.toString())}):i&&(t.SelectedValue="0",t.DefaultValue="0")}catch(s){b.a.SessionManager.Logger.InfoLog("Administration:: Leaving FillComboWithDefaultOption")}b.a.SessionManager.Logger.InfoLog("Administration:: Leaving FillComboWithDefaultOption")}CheckTabViewForUser(){let e=this.ScreenObject.Data.Tables[this.ScreenObject.Data.Tables.length-1];e.sort((e,t)=>e.TabOrder-t.TabOrder);for(let t=0;t<e.length;t++){let i=1;if(null!=e[t].CCTabID&&""!=e[t].CCTabID){i=parseInt(e[t].CCTabID);let s=this.ScreenObject.CustomTab.Pages.find(e=>e.DBColumnID==i);null!=s&&null!=s&&(s.Visible=!b.a.SessionManager.StringIsNullOrEmpty(e[t].IsVisible)&&0!==y.e.Int(e[t].IsVisible))}else i=1;let s=this.ScreenObject.Data.Tables[this.ScreenObject.Data.Tables.length-2];if(null!=s&&null!=s&&s.length>0&&s.some(e=>e.hasOwnProperty("CostCenterColID"))&&(s=s.filter(e=>"0"==e.CostCenterColID&&e.Tabid>0)),null!=s&&null!=s&&s.length>0&&s.some(e=>e.hasOwnProperty("CostCenterColID"))&&(s=s.filter(e=>e.Tabid==i),null!=s&&s.length>0)){let e=this.ScreenObject.CustomTab.Pages.find(e=>e.DBColumnID==i);null!=e&&null!=e&&(!y.e.IsEmpty(s[0].IsReadOnly)&&Object(d.j)(s[0].IsReadOnly)&&(e.IsReadOnly=!0),e.Visible=!(y.e.IsEmpty(s[0].IsVisible)||!Object(d.j)(s[0].IsVisible)))}}}CheckViewForUser(e){if(null!=this.ScreenObject.Data&&this.ScreenObject.Data.Tables.length>3&&this.ScreenObject.Data.Tables[this.ScreenObject.Data.Tables.length-2].length>0){for(let s=0;s<this.dgvPayrollEar.Table.length;s++)y.e.StringIsNullOrEmpty(this.dgvPayrollEar.Table[s].EarSNo)||this.SetView(this.dgvPayrollEar.Table[s],e,"Earnings");for(let s=0;s<this.dgvPayrollDed.Table.length;s++)y.e.StringIsNullOrEmpty(this.dgvPayrollDed.Table[s].DedSNo)||this.SetView(this.dgvPayrollDed.Table[s],e,"Deductions");if(0==this.dgvPayrollEar.Table.filter(e=>"False"!=e.IsVisible).length){let e=this.dgvPayrollEar.NewRow();this.dgvPayrollEar.addRow(e)}if(0==this.dgvPayrollDed.Table.filter(e=>"False"!=e.IsVisible).length){let e=this.dgvPayrollDed.NewRow();this.dgvPayrollDed.addRow(e)}for(let s=0;s<this.dgvAppraisal.Columns.length;s++)y.e.StringIsNullOrEmpty(this.dgvAppraisal.Columns[s].DisplayMember)||!this.dgvAppraisal.Columns[s].DisplayMember.startsWith("Earning")&&!this.dgvAppraisal.Columns[s].DisplayMember.startsWith("Deduction")||this.SetView(this.dgvAppraisal.Columns[s],e,"Appraisal");let t=this.ScreenObject.Data.Tables[this.ScreenObject.Data.Tables.length-2];t=t.filter(e=>(2==e.Mode||3==e.Mode)&&2000005==e.CostCenterColID),t=t.filter(this.IsEdit?e=>(2==e.Mode||3==e.Mode)&&2000005==e.CostCenterColID:e=>(1==e.Mode||3==e.Mode)&&2000005==e.CostCenterColID),null!=t&&null!=t&&t.length>0&&(this.dgvPayrollEar.Visible=Object(d.j)(t[0].IsVisible.toString()),this.dgvPayrollEar.IsReadOnly=!Object(d.j)(t[0].IsEditable.toString()));let i=this.ScreenObject.Data.Tables[this.ScreenObject.Data.Tables.length-2];i=i.filter(this.IsEdit?e=>(2==e.Mode||3==e.Mode)&&2000015==e.CostCenterColID:e=>(1==e.Mode||3==e.Mode)&&2000015==e.CostCenterColID),null!=i&&i.length>0&&(this.dgvPayrollDed.Visible=Object(d.j)(i[0].IsVisible.toString()),this.dgvPayrollDed.IsReadOnly=!Object(d.j)(i[0].IsEditable.toString()))}this.CheckTabViewForUser()}SetView(e,t,i){let s=this.ScreenObject.Data.Tables[this.ScreenObject.Data.Tables.length-2],a=this.ScreenObject.Data.Tables[0];s=s.filter(this.IsEdit?e=>2==e.Mode||3==e.Mode:e=>1==e.Mode||3==e.Mode),e instanceof c.c?s=s.filter(t=>t.SysColumnName==e.DBColumnName):e instanceof D.a&&(s="combobox"==e.DataType.toLowerCase()?s.filter(t=>t.SysColumnName==e.ValueBinding):e.DisplayMember.startsWith("Earning")||e.DisplayMember.startsWith("Deduction")?s.filter(t=>t.CostCenterColID==3e6+parseInt(e.ID)):s.filter(t=>t.SysColumnName==e.DisplayMember)),"Earnings"==i&&(s=s.filter(t=>t.CostCenterColID==1e6+parseInt(e.EarComponentID))),"Deductions"==i&&(s=s.filter(t=>t.CostCenterColID==1e6+parseInt(e.DedComponentID))),s.length>0?e instanceof c.c?e.Visible=Object(d.j)(s[0].IsVisible.toString()):e.IsVisible=Object(d.j)(s[0].IsVisible.toString()):(e instanceof c.c?a=a.filter(t=>t.SysColumnName==e.DBColumnName):e instanceof D.a&&(a="combobox"==e.DataType.toLowerCase()?a.filter(t=>t.SysColumnName==e.ValueBinding):a.filter(3==e.CostCenterID||2==e.CostCenterID?t=>t.CostcenterColID==e.ID:t=>t.SysColumnName==e.DisplayMember)),e instanceof D.a&&(e.EditOption=0),(e instanceof c.c||e instanceof D.a)&&(e.Expression=""),(e instanceof c.c||e instanceof D.a)&&(e.Message=""),(e instanceof c.c||e instanceof D.a)&&(e.Action=0))}LoadAccountLinkingGrid(){let e=this.dsPayStructure.Tables[1];if(e=e.filter(e=>1==e.Type||2==e.Type||3==e.Type),this.dgvAccLinking.Table.Clear(),null!=e&&null!=e&&e.length>0){let t={};for(let i=0;i<e.length;i++)t=this.dgvAccLinking.NewRow(),t.SlNo=e[i].Serial.toString(),t.ComponentName=e[i].ComponentName.toString(),t.ComponentID=e[i].ComponentID.toString(),t.ComponentType=e[i].Type.toString(),t.ComponentSNO=e[i].SNo.toString(),t.DebitAccountID_Key=null,t.DebitAccountID=null,t.CreditAccountID_Key=null,t.CreditAccountID=null,this.dgvAccLinking.addRow(t)}}pcbALType_SelectionChanged(e){switch(this.isLoad||(this.TempdgvAccLinkingTable=this.dgvAccLinking.Table,this.isLoad=!0),this.dgvAccLinking.Table=this.TempdgvAccLinkingTable,this.pcbALType.SelectedValue){case"Earnings":this.dgvAccLinking.Table=this.dgvAccLinking.Table.filter(e=>1==e.ComponentType),this.dgvAccLinking.setRowid();break;case"Deductions":this.dgvAccLinking.Table=this.dgvAccLinking.Table.filter(e=>2==e.ComponentType),this.dgvAccLinking.setRowid();break;case"Loans":this.dgvAccLinking.Table=this.dgvAccLinking.Table.filter(e=>3==e.ComponentType),this.dgvAccLinking.setRowid()}}cmnAppr_Click(e){if(null!=e&&"Delete"==e.toString()&&null!=this.dgvAppraisal.SelectedItem){let e=this.dgvAppraisal.SelectedItem;if(!confirm("Are you sure want to Delete.?"))return;if(this.objEmp.GetQueryData(this.pc1.SelectedValue,"cmnAppr_Click",e.SeqNo.toString(),"",""),this.LoadAppraisalGrid(),this.dgvAppraisal.Table.length>0){let e=0;for(let t=this.dgvAppraisal.Table.length-1;t>=0;t--)if(!y.e.StringIsNullOrEmpty(this.dgvAppraisal.Table[t].SeqNo)){e=t;break}this.txtBasicMonthly.Text=this.dgvAppraisal.Table[e].Basic.toString(),this.txtBasicMonthly_LostFocus(this.txtBasicMonthly)}}}DateOfJoining_SelectedDateChanged(e){if("False"==b.a.SessionManager.Preferences.AcceptFutureDatesForDOJ&&e.Date>new Date)return this.DisplayMessage="You can not enter future dates. It should be Less than or Equal to the System Date",e.Date=(new Date).ToString("dd/MMM/yyyy"),e.SetFocus=!0,void(this.MessageVisibility=!0);""!=this.ProbationDays.Text.trim()&&parseInt(this.ProbationDays.Text)>0&&(this.DateOfConfirmation.Date=this.DateOfJoining.Date.AddDays(parseInt(this.ProbationDays.Text)))}GetRoles(){let e;try{b.a.SessionManager.Logger.InfoLog("AddEditEmpMasterViewModel::Entering GetRoles");let t="";"1"!=b.a.SessionManager.UserID?(t=b.a.SessionManager.Preferences.ContainsKey("LWRole")&&"true"==b.a.SessionManager.Preferences.LWRole.toLowerCase()?b.a.SessionManager.LocationWhereWithParent:null,b.a.SessionManager.Preferences.ContainsKey("DWRole")&&"true"==b.a.SessionManager.Preferences.DWRole.toLowerCase()?t+=b.a.SessionManager.DivisionID>0?"~"+b.a.SessionManager.DivisionID.toString():"~"+b.a.SessionManager.DivisionWhere:t+="~null"):(t=null,t+="~null"),t+="~"+b.a.SessionManager.UserID,t+="~"+b.a.SessionManager.LanguageID,e=this.objEmp.getUserRoles("",t)}catch(t){b.a.SessionManager.Logger.ErrorLog("AddEditEmpMasterViewModel:: GetRoles"+t)}return e}PaymentMode_SelectionChanged(e){let t;switch(this.pcbPaymentMode.SelectedValue){case"Bank Transfer":null!=this.dsEdit&&this.dsEdit.Tables[0].length>0?(this.pc1.Enable=!0,this.pc1=this.GetScreenControl("iBank"),this.pc1.SelectedValue=parseInt(this.dsEdit.Tables[0][0].iBank),this.GetBankDetails(this.pc1),t=this.GetScreenControl("BankAccNo"),t.Text=this.dsEdit.Tables[0][0].BankAccNo.toString(),t.Enable=!0,t=this.GetScreenControl("IBANNo"),t.Text=this.dsEdit.Tables[0][0].IBANNo.toString(),t.Enable=!0):(this.pc1.Enable=!0,t=this.GetScreenControl("BankAccNo"),t.Enable=!0,t=this.GetScreenControl("IBANNo"),t.Enable=!0);break;default:null!=this.pc1&&(this.pc1.Enable=!1),t=this.GetScreenControl("BankAccNo"),t.Enable=!1,t=this.GetScreenControl("IBANNo"),t.Enable=!1,t=this.GetScreenControl("BankBranch"),t=this.GetScreenControl("BankRoutingCode"),t=this.GetScreenControl("BankAgentCode")}}GetBankDetails(e){if(this.pc1.SelectedValue>0&&((0==this.iBankNodeID||this.iBankNodeID!=this.pc1.SelectedValue)&&(this.iBankNodeID=this.pc1.SelectedValue),this.iBankNodeID>0)){let e;e=this.GetScreenControl("BankBranch"),e.Text="",e=this.GetScreenControl("BankRoutingCode"),e.Text="",e=this.GetScreenControl("BankAgentCode"),e.Text="";let t=this.objEmp.GetQueryData(this.pc1.SelectedValue,"GetBankDetails","","","");null!=t&&t.Tables.length>0&&t.Tables[0].length>0&&(b.a.SessionManager.IsWebApplication&&(this.dsGetBankDetails_web=t),e=this.GetScreenControl("BankBranch"),e.Text=y.e.String(t.Tables[0][0].ccAlpha2),e=this.GetScreenControl("BankRoutingCode"),e.Text=y.e.String(t.Tables[0][0].ccAlpha8),e=this.GetScreenControl("BankAgentCode"),e.Text=y.e.String(t.Tables[0][0].ccAlpha7))}}dgvAppraisal_CellDoubleClick(e,t,i){if(this.ButtonAppraisal.Visible&&this.ButtonAppraisal.Enable){let t=e.grid.getData().getItems()[e.row];y.e.IsEmpty(t.SeqNo)||(this.AddeditAppraisalViewmodel=new L.a(this,this.NodeID,this.dtpNextAppraisal.Date,parseInt(t.SeqNo)),b.a.page.ShowDialog(this.AddeditAppraisalViewmodel,O.a,{ShowCenter:!0,Title:this.AddeditAppraisalViewmodel.Title}))}}LoadPayrollGrid(){if(this.dgvPayrollEar.Clear(),this.dgvPayrollAccrual.Clear(),this.dgvPayrollDed.Clear(),this.iAccruCnt=this.iEarCnt=0,null!=this.dsPayStructure&&null!=this.dsPayStructure&&this.dsPayStructure.Tables.length>0){let e,t=this.dsPayStructure.Tables[0].length>0?this.dsPayStructure.Tables[0]:this.dsPayStructure.Tables[1],i=t;t=t.filter(e=>1==e.Type&&"Yes"==e.Applicable&&"OverTime"!=e.FieldType);for(let s=0;s<t.length;s++)y.e.IsEmpty(t[s].Behaviour)||"Accruals"!=t[s].Behaviour.toString()&&"Accruals-AccumulateForPreviousYears"!=t[s].Behaviour.toString()?(this.iEarCnt++,e=this.dgvPayrollEar.NewRow(),e.SlNo=this.iEarCnt.toString(),e.IsAccrualType=!1):(this.iAccruCnt++,e=this.dgvPayrollAccrual.NewRow(),e.SlNo=this.iAccruCnt.toString(),e.IsAccrualType=!0),e.Earnings=1==b.a.SessionManager.LanguageID?t[s].ComponentName.toString():y.e.String(t[s].ResourceData),e.EarComponentID=t[s].ComponentID.toString(),e.EarSNo=t[s].SNo.toString(),e.EarFormula=t[s].Formula.toString(),e.EarRoff=t[s].ROff.toString(),e.EarValue=(0).ToString(this.sDecimalsAmount),e.EarAddToNet=t[s].AddToNet.toString(),e.EarFType=t[s].FieldType.toString(),"EmployeeMaster"!=e.EarFType.toString()?(e.Earnings_GRAY="1",e.EarValue_GRAY="1"):(e.Earnings_GRAY=null,e.EarValue_GRAY=null),e.IsVisible=null,Object(d.j)(e.IsAccrualType)?this.dgvPayrollAccrual.addRow(e):this.dgvPayrollEar.addRow(e);t=i,t=t.filter(e=>2==e.Type&&"Yes"==e.Applicable&&"NetSalary"!=e.FieldType&&"OverTime"!=e.FieldType);for(let s=0;s<t.length;s++)e=this.dgvPayrollDed.NewRow(),e.SlNo=(s+1).toString(),e.Deductions=1==b.a.SessionManager.LanguageID?t[s].ComponentName.toString():y.e.String(t[s].ResourceData),e.DedComponentID=t[s].ComponentID.toString(),e.DedSNo=t[s].SNo.toString(),e.DedFormula=t[s].Formula.toString(),e.DedROff=t[s].ROff.toString(),e.DedValue=(0).ToString(this.sDecimalsAmount),e.DedAddToNet=t[s].AddToNet.toString(),e.DedFType=t[s].FieldType.toString(),"EmployeeMaster"!=e.DedFType.toString()?(e.Deductions_GRAY="1",e.DedValue_GRAY="1"):(e.Deductions_GRAY=null,e.DedValue_GRAY=null),e.IsVisible=null,this.dgvPayrollDed.addRow(e)}this.dgvPayrollEar.AddExtraEmptyRows(20),this.dgvPayrollAccrual.AddExtraEmptyRows(20),this.dgvPayrollDed.AddExtraEmptyRows(20)}LoadAppraisalGrid(){this.dgvAppraisal.Clear();for(let t=this.dgvAppraisal.Columns.length-4;t>=4;t--)if(this.dgvAppraisal.Columns[t].DisplayMember.startsWith("Earning")||this.dgvAppraisal.Columns[t].DisplayMember.startsWith("Deduction")){const e=this.dgvAppraisal.Table.indexOf(this.dgvAppraisal.Columns[t].DisplayMember);this.dgvAppraisal.Table.splice(e,1),this.dgvAppraisal.Columns.Remove(this.dgvAppraisal.Columns[t])}if(null!=this.dsPayStructure&&null!=this.dsPayStructure&&this.dsPayStructure.Tables.length>0){let e,t=this.dsPayStructure.Tables[0].length>0?this.dsPayStructure.Tables[0]:this.dsPayStructure.Tables[1],i=t;t=t.filter(e=>1==e.Type&&"Yes"==e.Applicable&&("Net"==e.AddToNet||"NetAndTax"==e.AddToNet)&&"OverTime"!=e.FieldType);let s=3;for(let a=0;a<t.length;a++)(y.e.IsEmpty(t[a].Behaviour)||"Accruals"!=t[a].Behaviour.toString()&&"Accruals-AccumulateForPreviousYears"!=t[a].Behaviour.toString())&&(s++,e=new D.a,e.Header=1==b.a.SessionManager.LanguageID?t[a].ComponentName.toString():y.e.String(t[a].ResourceData),e.DisplayMember="Earning"+t[a].SNo.toString(),e.ID=t[a].ComponentID.toString(),e.Width=90,e.DataType="FLOAT",e.ReadOnly=!0,e.HeaderBackColor="LightBlue",this.dgvAppraisal.Columns.splice(s,0,e),this.dgvAppraisal.TableColumns.push("Earning"+t[a].SNo.toString()));t=i,t=t.filter(e=>2==e.Type&&"Yes"==e.Applicable&&("Net"==e.AddToNet||"NetAndTax"==e.AddToNet)&&"NetSalary"!=e.FieldType&&"OverTime"!=e.FieldType);for(let a=0;a<t.length;a++)s++,e=new D.a,e.Header=1==b.a.SessionManager.LanguageID?t[a].ComponentName.toString():y.e.String(t[a].ResourceData),e.DisplayMember="Deduction"+t[a].SNo.toString(),e.ID=t[a].ComponentID.toString(),e.Width=90,e.DataType="FLOAT",e.ReadOnly=!0,e.HeaderBackColor="LightCoral",this.dgvAppraisal.Columns.splice(s,0,e),this.dgvAppraisal.TableColumns.push("Deduction"+t[a].SNo.toString())}this.dgvAppraisal.Table.Clear();let e=this.objEmp.GetQueryData(this.NodeID,"dgvAppraisal","","","");if(null!=e&&e.length>0){let t={};for(let i=0;i<e.length;i++){t={},t.SeqNo=e[i].SeqNo.toString(),t.SlNo=(i+1).toString(),t.AppraisalDate=new Date(e[i].AppraisalDate),t.Basic=parseFloat(e[i].BasicMonthly).ToString(this.sDecimalsAmount),t.NetSalary=parseFloat(e[i].NetSalary).ToString(this.sDecimalsAmount),t.Remarks=y.e.StringIsNullOrEmpty(e[i].Remarks)?"":e[i].Remarks.toString(),t.Reason=y.e.StringIsNullOrEmpty(e[i].Reason)?"":e[i].Reason.toString(),t.AppraisalType=y.e.StringIsNullOrEmpty(e[i].sAppraisalType)?"":e[i].sAppraisalType.toString();for(let s=4;s<this.dgvAppraisal.Columns.length;s++)(this.dgvAppraisal.Columns[s].DisplayMember.startsWith("Earning")||this.dgvAppraisal.Columns[s].DisplayMember.startsWith("Deduction"))&&(t[this.dgvAppraisal.Columns[s].DisplayMember]=parseFloat(e[i][this.dgvAppraisal.Columns[s].DisplayMember]).ToString(this.sDecimalsAmount));this.dgvAppraisal.Table.push(t)}}this.dgvAppraisal.AddExtraEmptyRows(20)}RoundOffValue(e,t){if(t>0&&e>0){let i=0,s=!1;i=e%t,i>0&&(t/i<=2&&(s=!0),e-=i,s&&(e+=t))}return e.ToString(this.sDecimalsAmount).Replace(",","")}GetUnpaidDays(){try{let e,t,i,s=new Date,a=new Date,l=0,n=(this.objEmp.DOJ.getDay(),new Date);if(e=b.a.SessionManager.PayrollMonth,t=b.a.SessionManager.PayrollMonthStart,i=b.a.SessionManager.PayrollMonthEnd,n=null==this.DateOfRelieve.Date||""==this.DateOfRelieve.Date.toString()?new Date("01-Jan-9000"):new Date(this.DateOfRelieve.Date),e.DaysInMonth(),this.objEmp.DOJ>t)if("Actual Days"!=b.a.SessionManager.Preferences.PayDays){let e=parseInt(b.a.SessionManager.Preferences.PayDays);for(s=t,a=this.objEmp.DOJ;s<a;)s.getDate()!=s.DaysInMonth()?(s.getDate()>e||l++,s=s.AddDays(1)):(l+=e-s.getDate()+1,s=s.AddDays(1));if(n<i)for(s=n,a=i;s<a;)s.getDate()!=s.DaysInMonth()?(s.getDate()>e||l++,s=s.AddDays(1)):(l+=e-s.getDate()+1,s=s.AddDays(1))}else l+=y.e.GetDateDifference(this.objEmp.DOJ,t),n<i&&(l+=y.e.GetDateDifference(i,n));else if(n<i)if("Actual Days"!=b.a.SessionManager.Preferences.PayDays){let e=parseInt(b.a.SessionManager.Preferences.PayDays);for(s=n,a=i;s<a;)s.getDate()!=s.DaysInMonth()?(s.getDate()>e||l++,s=s.AddDays(1)):(l+=e-s.getDate()+1,s=s.AddDays(1))}else l+=y.e.GetDateDifference(i,n);return l}catch(e){return 0}}ExecuteFormulas(){let e=this.objEmp.GetQueryData(this.NodeID,"GetDtForEmp","","",""),t=30;t="Actual Days"==b.a.SessionManager.Preferences.EmpMasterPayDays?y.e.GetDateDifference(b.a.SessionManager.PayrollMonthEnd,b.a.SessionManager.PayrollMonthStart)+1:parseInt(b.a.SessionManager.Preferences.EmpMasterPayDays);let i,s=0,a=0,l=0,n=(0).ToString(this.sDecimalsAmount);this.fldDict=new S.a,i=new C.c("Basic",""),this.fldDict.push("Basic",i),this.fldDict.Basic.setFieldValue(this.txtBasicMonthly.Text),i=new C.c("ServiceDays",""),this.fldDict.push("ServiceDays",i),this.fldDict.ServiceDays.setFieldValue(y.e.GetDateDifference(new Date,this.objEmp.DOJ)+1),i=new C.c("WeeklyOffs",""),this.fldDict.push("WeeklyOffs",i),this.fldDict.WeeklyOffs.setFieldValue(0),i=new C.c("LeavesTaken",""),this.fldDict.push("LeavesTaken",i),this.fldDict.LeavesTaken.setFieldValue(0),i=new C.c("VacDaysTaken",""),this.fldDict.push("VacDaysTaken",i),this.fldDict.VacDaysTaken.setFieldValue(0),i=new C.c("VacDays",""),this.fldDict.push("VacDays",i),this.fldDict.VacDays.setFieldValue(0),i=new C.c("VacAmount",""),this.fldDict.push("VacAmount",i),this.fldDict.VacAmount.setFieldValue(0),i=new C.c("VacEncashDays",""),this.fldDict.push("VacEncashDays",i),this.fldDict.VacEncashDays.setFieldValue(0),i=new C.c("VacEncashAmount",""),this.fldDict.push("VacEncashAmount",i),this.fldDict.VacEncashAmount.setFieldValue(0),i=new C.c("VacExcessDays",""),this.fldDict.push("VacExcessDays",i),this.fldDict.VacExcessDays.setFieldValue(0),i=new C.c("VacExcessAmount",""),this.fldDict.push("VacExcessAmount",i),this.fldDict.VacExcessAmount.setFieldValue(0),i=new C.c("VacNetAmount",""),this.fldDict.push("VacNetAmount",i),this.fldDict.VacNetAmount.setFieldValue(0),i=new C.c("TotalDays",""),this.fldDict.push("TotalDays",i),this.fldDict.TotalDays.setFieldValue(t),i=new C.c("DaysAttended",""),this.fldDict.push("DaysAttended",i),this.fldDict.DaysAttended.setFieldValue(t),i=new C.c("UnpaidDays",""),this.fldDict.push("UnpaidDays",i),this.fldDict.UnpaidDays.setFieldValue(this.GetUnpaidDays()),i=new C.c("LOPDays",""),this.fldDict.push("LOPDays",i),this.fldDict.LOPDays.setFieldValue(0),i=new C.c("Holidays",""),this.fldDict.push("Holidays",i),this.fldDict.Holidays.setFieldValue(0),i=new C.c("AdjDays",""),this.fldDict.push("AdjDays",i),this.fldDict.AdjDays.setFieldValue(0),i=new C.c("EmpType",""),this.fldDict.push("EmpType",i),null!=this.EmpType.GetselectedItem()?this.fldDict.EmpType.setFieldValue(this.EmpType.GetselectedItem().Name):this.fldDict.EmpType.setFieldValue(""),i=new C.c("Gender",""),this.fldDict.push("Gender",i),null!=this.Gender.GetselectedItem()?this.fldDict.Gender.setFieldValue(this.Gender.GetselectedItem().Name):this.fldDict.Gender.setFieldValue(""),i=new C.c("MaritalStatus",""),this.fldDict.push("MaritalStatus",i),null!=this.pcbMaritalStatus.GetselectedItem()?this.fldDict.MaritalStatus.setFieldValue(this.pcbMaritalStatus.GetselectedItem().Name):this.fldDict.MaritalStatus.setFieldValue(""),i=new C.c("Nationality",""),this.fldDict.push("Nationality",i),null!=this.pcbNationality.GetselectedItem()?this.fldDict.Nationality.setFieldValue(this.pcbNationality.GetselectedItem().Name):this.fldDict.Nationality.setFieldValue(""),i=new C.c("Religion",""),this.fldDict.push("Religion",i),null!=this.pcbReligion.GetselectedItem()?this.fldDict.Religion.setFieldValue(this.pcbReligion.GetselectedItem().Name):this.fldDict.Religion.setFieldValue(""),i=new C.c("ChildrenCount",""),this.fldDict.push("ChildrenCount",i);let r=this.ViewEmpDocuments.GridListObj.Table;r=r.filter(e=>255==e.DType),null!=r&&null!=r?(r=r.filter(e=>e.EmpSeqNo==this.objEmp.NodeID&&"Children"==e.Field5),this.fldDict.ChildrenCount.setFieldValue(r.length)):this.fldDict.ChildrenCount.setFieldValue(0),i=new C.c("ChildrenDays",""),this.fldDict.push("ChildrenDays",i);let h=0;if(r=this.ViewEmpDocuments.GridListObj.Table,null!=r&&null!=r&&(r=r.filter(e=>e.EmpSeqNo==this.objEmp.NodeID&&"Children"==e.Field5)),r.length>0){let e=r;for(let t=0;t<e.length;t++)if(new Date(e[t].Field2)>=b.a.SessionManager.PayrollMonthStart&&new Date(e[t].Field2)<=b.a.SessionManager.PayrollMonthEnd)h+=y.e.GetDateDifference(b.a.SessionManager.PayrollMonthEnd,new Date(e[t].Field2))+1;else{let i=0,s=0,a=0,l={iY:i,iM:s,iD:a};y.e.GetYearsMonthsDays(new Date(e[t].Field2),b.a.SessionManager.PayrollMonthEnd,l),i=l.iY,s=l.iM,a=l.iD,18==i&&0==s?h+=b.a.SessionManager.PayrollMonthEnd.Subtract(b.a.SessionManager.PayrollMonthStart).Days+1-a:i<18&&(h+=b.a.SessionManager.PayrollMonthEnd.Subtract(b.a.SessionManager.PayrollMonthStart).Days+1)}}this.fldDict.ChildrenDays.setFieldValue(h),i=new C.c("PayrollMonthNo",""),this.fldDict.push("PayrollMonthNo",i),this.fldDict.PayrollMonthNo.setFieldValue(b.a.SessionManager.PayrollMonth.iMonth()),i=new C.c("PayrollYearNo",""),this.fldDict.push("PayrollYearNo",i),this.fldDict.PayrollYearNo.setFieldValue(b.a.SessionManager.PayrollMonth.getFullYear()),i=new C.c("DOJMonth",""),this.fldDict.push("DOJMonth",i),this.fldDict.DOJMonth.setFieldValue(this.objEmp.DOJ.iMonth()),i=new C.c("DOJYear",""),this.fldDict.push("DOJYear",i),this.fldDict.DOJYear.setFieldValue(this.objEmp.DOJ.getFullYear()),i=new C.c("DORMonth",""),this.fldDict.push("DORMonth",i),null!=e&&e.length>0&&!y.e.IsEmpty(e[0].CDORelieve)?this.fldDict.DORMonth.setFieldValue(new Date(e[0].CDORelieve).iMonth()):this.fldDict.DORMonth.setFieldValue(1),i=new C.c("DORYear",""),this.fldDict.push("DORYear",i),null!=e&&e.length>0&&!y.e.IsEmpty(e[0].CDORelieve)?this.fldDict.DORYear.setFieldValue(new Date(e[0].CDORelieve).getFullYear()):this.fldDict.DORYear.setFieldValue(2200),i=new C.c("EmpConfirmationDate",""),this.fldDict.push("EmpConfirmationDate",i),this.fldDict.EmpConfirmationDate.setFieldValue(new Date(this.DateOfConfirmation.Date)),i=new C.c("LeaveFromDate",""),this.fldDict.push("LeaveFromDate",i),this.fldDict.LeaveFromDate.setFieldValue(new Date),i=new C.c("LeaveNoOfDays",""),this.fldDict.push("LeaveNoOfDays",i),this.fldDict.LeaveNoOfDays.setFieldValue(0),i=new C.c("EmpVacationDays",""),this.fldDict.Add("EmpVacationDays",i),this.fldDict.EmpVacationDays.setFieldValue(0),i=new C.c("AppraisalMonthNo",""),this.fldDict.push("AppraisalMonthNo",i);let d=null;null!=this.dsEdit&&(d=this.dsEdit.Tables[14]),null!=d&&d.length>1?(d.sort((e,t)=>t.EffectFrom-e.EffectFrom),this.fldDict.AppraisalMonthNo.setFieldValue(new Date(d[0].ApraisalDate).iMonth())):this.fldDict.AppraisalMonthNo.setFieldValue(0),i=new C.c("VacDaysPayYes",""),this.fldDict.push("VacDaysPayYes",i),this.fldDict.VacDaysPayYes.setFieldValue(0),i=new C.c("VacDaysPayNo",""),this.fldDict.push("VacDaysPayNo",i),this.fldDict.VacDaysPayNo.setFieldValue(0),null!=this.dsEdit&&(d=this.dsEdit.Tables[14]);let c=null,u=0;if(null!=this.dsPayStructure&&(c=this.dsPayStructure.Tables[1]),null!=d&&d.length>0&&(d=d.filter(e=>e.ApraisalDate<=b.a.SessionManager.PayrollMonthEnd.ToString("dd MMM yyyy")),null!=d&&d.length>1&&(d.sort((e,t)=>t.ApraisalDate-e.ApraisalDate),null!=c&&c.length>0&&(c=c.filter(e=>1==e.Type&&"Yes"==e.Applicable),null!=c&&c.length>0))))for(let o=0;o<c.length;o++)y.e.IsEmpty(b.a.SessionManager.Preferences.GosiComponent)||b.a.SessionManager.Preferences.GosiComponent!=c[o].ComponentID.toString()||(u=parseFloat(d[1]["Earning"+parseInt(c[o].SNo)]));i=new C.c("PreviousGosiValue",""),this.fldDict.push("PreviousGosiValue",i),this.fldDict.PreviousGosiValue.setFieldValue(u),i=new C.c("TotCheckInLateMins",""),this.fldDict.push("TotCheckInLateMins",i),this.fldDict.TotCheckInLateMins.setFieldValue(0),i=new C.c("TotCheckOutEarlyMins",""),this.fldDict.push("TotCheckOutEarlyMins",i),this.fldDict.TotCheckOutEarlyMins.setFieldValue(0),i=new C.c("TotBreak1MoreMins",""),this.fldDict.push("TotBreak1MoreMins",i),this.fldDict.TotBreak1MoreMins.setFieldValue(0),i=new C.c("TotBreak2MoreMins",""),this.fldDict.push("TotBreak2MoreMins",i),this.fldDict.TotBreak2MoreMins.setFieldValue(0),i=new C.c("TotBreak3MoreMins",""),this.fldDict.push("TotBreak3MoreMins",i),this.fldDict.TotBreak3MoreMins.setFieldValue(0),i=new C.c("TotBreak4MoreMins",""),this.fldDict.push("TotBreak4MoreMins",i),this.fldDict.TotBreak4MoreMins.setFieldValue(0),i=new C.c("TotBreak5MoreMins",""),this.fldDict.push("TotBreak5MoreMins",i),this.fldDict.TotBreak5MoreMins.setFieldValue(0),i=new C.c("TotLateHrsToDeduct",""),this.fldDict.push("TotLateHrsToDeduct",i),this.fldDict.TotLateHrsToDeduct.setFieldValue(0),i=new C.c("TotLateLeavesToDeduct",""),this.fldDict.push("TotLateLeavesToDeduct",i),this.fldDict.TotLateLeavesToDeduct.setFieldValue(0),i=new C.c("TotWorkingMinsLessBy",""),this.fldDict.push("TotWorkingMinsLessBy",i),this.fldDict.TotWorkingMinsLessBy.setFieldValue(0),i=new C.c("TotAbsentMinsLessBy",""),this.fldDict.push("TotAbsentMinsLessBy",i),this.fldDict.TotAbsentMinsLessBy.setFieldValue(0),this.dvCCData=this.dvCCData.filter(e=>e.EmpSeqNo==this.objEmp.NodeID);let m="",p="";if(i=new C.c("RptManagerCode",""),this.fldDict.push("RptManagerCode",i),i=new C.c("RptManagerName",""),this.fldDict.push("RptManagerName",i),this.dvCCData.length>0&&!y.e.IsEmpty(this.dvCCData[0].RptManager)){let e=this.dvDimsData.filter(e=>"RptManager"==e.SysColName&&e.NodeID==this.dvCCData[0].RptManager.toString());e.length>0&&(m=e[0].Code.toString(),p=e[0].Name.toString())}if(this.fldDict.RptManagerCode.setFieldValue(m),this.fldDict.RptManagerName.setFieldValue(p),this.dvCCData.length>0)for(let y=0;y<Object.keys(this.dvCCData[0]).length;y++){const e=Object.keys(this.dvCCData[0])[y];if(!e.Contains("CCNID"))continue;let t=this.dvDimsData.filter(t=>t.SysColName==e);if(t.length>0){let s=t[0].UserColumnName.toString();i=new C.c(t[0].UserColumnName.toString()+"Code",""),this.fldDict.push(t[0].UserColumnName.toString()+"Code",i),i=new C.c(t[0].UserColumnName.toString()+"Name",""),this.fldDict.push(t[0].UserColumnName.toString()+"Name",i),t=this.dvDimsData.filter(t=>t.SysColName==e&&t.NodeID==this.dvCCData[0][e].toString()),t.length>0?(this.fldDict[t[0].UserColumnName.toString()+"Code"].setFieldValue(t[0].Code.toString()),this.fldDict[t[0].UserColumnName.toString()+"Name"].setFieldValue(t[0].Name.toString())):(this.fldDict[s+"Code"].setFieldValue(""),this.fldDict[s+"Name"].setFieldValue(""));let a=this.ScreenObject.GetCustomField(e);if(null!=a){let i="";(a instanceof o.b||a instanceof o.a)&&(i=a.SelectedValue.toString()),"0"==i&&(i="1"),t=this.dvDimsData.filter(t=>t.SysColName==e&&t.NodeID==i),t.length>0?(this.fldDict[t[0].UserColumnName.toString()+"Code"].setFieldValue(t[0].Code.toString()),this.fldDict[t[0].UserColumnName.toString()+"Name"].setFieldValue(t[0].Name.toString())):(this.fldDict[s+"Code"].setFieldValue(""),this.fldDict[s+"Name"].setFieldValue(""))}}}for(let o=0;o<this.dgvPayrollEar.Table.length;o++)y.e.StringIsNullOrEmpty(this.dgvPayrollEar.Table[o].EarSNo)||(i=new C.c(this.dgvPayrollEar.Table[o].Earnings.toString(),""),this.fldDict.push(this.dgvPayrollEar.Table[o].Earnings.toString(),i),this.fldDict[this.dgvPayrollEar.Table[o].Earnings.toString()].setFieldValue(this.dgvPayrollEar.Table[o].EarValue.toString()),i=new C.c("Calc"+this.dgvPayrollEar.Table[o].Earnings.toString(),""),this.fldDict.push("Calc"+this.dgvPayrollEar.Table[o].Earnings.toString(),i),this.fldDict["Calc"+this.dgvPayrollEar.Table[o].Earnings.toString()].setFieldValue(this.dgvPayrollEar.Table[o].EarValue.toString()),i=new C.c("Arr_"+this.dgvPayrollEar.Table[o].Earnings.toString(),""),this.fldDict.push("Arr_"+this.dgvPayrollEar.Table[o].Earnings.toString(),i),this.fldDict["Arr_"+this.dgvPayrollEar.Table[o].Earnings.toString()].setFieldValue(0),i=new C.c("Adj_"+this.dgvPayrollEar.Table[o].Earnings.toString(),""),this.fldDict.push("Adj_"+this.dgvPayrollEar.Table[o].Earnings.toString(),i),this.fldDict["Adj_"+this.dgvPayrollEar.Table[o].Earnings.toString()].setFieldValue(0));for(let o=0;o<this.dgvPayrollAccrual.Table.length;o++)y.e.StringIsNullOrEmpty(this.dgvPayrollAccrual.Table[o].EarSNo)||(i=new C.c(this.dgvPayrollAccrual.Table[o].Earnings.toString(),""),this.fldDict.push(this.dgvPayrollAccrual.Table[o].Earnings.toString(),i),this.fldDict[this.dgvPayrollAccrual.Table[o].Earnings.toString()].setFieldValue(this.dgvPayrollAccrual.Table[o].EarValue.toString()),i=new C.c("Calc"+this.dgvPayrollAccrual.Table[o].Earnings.toString(),""),this.fldDict.push("Calc"+this.dgvPayrollAccrual.Table[o].Earnings.toString(),i),this.fldDict["Calc"+this.dgvPayrollAccrual.Table[o].Earnings.toString()].setFieldValue(this.dgvPayrollAccrual.Table[o].EarValue.toString()),i=new C.c("Arr_"+this.dgvPayrollAccrual.Table[o].Earnings.toString(),""),this.fldDict.push("Arr_"+this.dgvPayrollAccrual.Table[o].Earnings.toString(),i),this.fldDict["Arr_"+this.dgvPayrollAccrual.Table[o].Earnings.toString()].setFieldValue(0),i=new C.c("Adj_"+this.dgvPayrollAccrual.Table[o].Earnings.toString(),""),this.fldDict.push("Adj_"+this.dgvPayrollAccrual.Table[o].Earnings.toString(),i),this.fldDict["Adj_"+this.dgvPayrollAccrual.Table[o].Earnings.toString()].setFieldValue(0));for(let o=0;o<this.dgvPayrollDed.Table.length;o++)y.e.StringIsNullOrEmpty(this.dgvPayrollDed.Table[o].DedSNo)||(i=new C.c(this.dgvPayrollDed.Table[o].Deductions.toString(),""),this.fldDict.Add(this.dgvPayrollDed.Table[o].Deductions.toString(),i),this.fldDict[this.dgvPayrollDed.Table[o].Deductions.toString()].setFieldValue(this.dgvPayrollDed.Table[o].DedValue.toString()),i=new C.c("Calc"+this.dgvPayrollDed.Table[o].Deductions.toString(),""),this.fldDict.push("Calc"+this.dgvPayrollDed.Table[o].Deductions.toString(),i),this.fldDict["Calc"+this.dgvPayrollDed.Table[o].Deductions.toString()].setFieldValue(this.dgvPayrollDed.Table[o].DedValue.toString()),i=new C.c("Arr_"+this.dgvPayrollDed.Table[o].Deductions.toString(),""),this.fldDict.push("Arr_"+this.dgvPayrollDed.Table[o].Deductions.toString(),i),this.fldDict["Arr_"+this.dgvPayrollDed.Table[o].Deductions.toString()].setFieldValue(0),i=new C.c("Adj_"+this.dgvPayrollDed.Table[o].Deductions.toString(),""),this.fldDict.push("Adj_"+this.dgvPayrollDed.Table[o].Deductions.toString(),i),this.fldDict["Adj_"+this.dgvPayrollDed.Table[o].Deductions.toString()].setFieldValue(0));let g=this.fldDict;for(let o=0;o<this.dgvPayrollEar.Table.length;o++)if(!y.e.StringIsNullOrEmpty(this.dgvPayrollEar.Table[o].EarSNo)){if(!y.e.StringIsNullOrEmpty(this.dgvPayrollEar.Table[o].EarFormula))try{n=parseFloat(b.a.eval.EvaluateExpression(this.dgvPayrollEar.Table[o].EarFormula.toString(),g)).ToString(this.sDecimalsAmount),this.dgvPayrollEar.Table[o].EarValue=this.RoundOffValue(parseFloat(n),parseFloat(this.dgvPayrollEar.Table[o].EarRoff)),this.fldDict[this.dgvPayrollEar.Table[o].Earnings.toString()].setFieldValue(this.dgvPayrollEar.Table[o].EarValue.toString()),this.fldDict["Calc"+this.dgvPayrollEar.Table[o].Earnings.toString()].setFieldValue(this.dgvPayrollEar.Table[o].EarValue.toString())}catch(D){}y.e.StringIsNullOrEmpty(this.dgvPayrollEar.Table[o].EarAddToNet)||"Net"!=this.dgvPayrollEar.Table[o].EarAddToNet.toString()&&"NetAndTax"!=this.dgvPayrollEar.Table[o].EarAddToNet.toString()||(s+=parseFloat(this.dgvPayrollEar.Table[o].EarValue))}for(let o=0;o<this.dgvPayrollAccrual.Table.length;o++)if(!y.e.StringIsNullOrEmpty(this.dgvPayrollAccrual.Table[o].EarSNo)){if(!y.e.StringIsNullOrEmpty(this.dgvPayrollAccrual.Table[o].EarFormula))try{n=parseFloat(b.a.eval.EvaluateExpression(this.dgvPayrollAccrual.Table[o].EarFormula.toString(),g)).ToString(this.sDecimalsAmount),this.dgvPayrollAccrual.Table[o].EarValue=this.RoundOffValue(parseFloat(n),parseFloat(this.dgvPayrollAccrual.Table[o].EarROff)),this.fldDict[this.dgvPayrollAccrual.Table[o].Earnings.toString()].setFieldValue(this.dgvPayrollAccrual.Table[o].EarValue.toString()),this.fldDict["Calc"+this.dgvPayrollAccrual.Table[o].Earnings.toString()].setFieldValue(this.dgvPayrollAccrual.Table[o].EarValue.toString())}catch(I){}l+=parseFloat(this.dgvPayrollAccrual.Table[o].EarValue)}for(let o=0;o<this.dgvPayrollDed.Table.length;o++)if(!y.e.StringIsNullOrEmpty(this.dgvPayrollDed.Table[o].DedSNo)){if(!y.e.StringIsNullOrEmpty(this.dgvPayrollDed.Table[o].DedFormula))try{if(n=b.a.eval.EvaluateExpression(this.dgvPayrollDed.Table[o].DedFormula.toString(),g).toString(),n=parseFloat(n).ToString(this.sDecimalsAmount),"ESI"==this.dgvPayrollDed.Table[o].Deductions.toString().toUpperCase())n=b.a.SessionManager.Round(Math.ceil(parseFloat(n)),this.sDecimalsAmount);else if("PT"==this.dgvPayrollDed.Table[o].Deductions.toString().toUpperCase()){let e=n.Replace(",","");n=(0).ToString(this.sDecimalsAmount);let t=this.dsPayStructure.Tables[0].length>0?this.dsPayStructure.Tables[0]:this.dsPayStructure.Tables[1];if(t.length>0){let i=new Date(t[0].PayrollMonth),s=new Date,a=new Date,l=new Date,o={PayrollMonth:s,PayrollMonthStart:a,PayrollMonthEnd:l};y.e.SetPayrollDate(i,o),s=o.PayrollMonth,a=o.PayrollMonthStart,l=o.PayrollMonthEnd;let r=this.objEmp.GetQueryData(this.NodeID,"SetEmpAsOnStatus",s,a,l);if(null!=r&&r.Tables.length>0){let t="1";r.Tables[0].length>0?t=r.Tables[0][0].PTDimension.toString():r.Tables[1].length>0&&(t=r.Tables[1][0].PTDimension.toString());let i=r.Tables[2];if(r.Tables[0].length>0||r.Tables[1].length>0){let s=r.Tables[2];if(s=s.filter(e=>e.NodeID==t&&""!=e.Formula),null!=s&&s.length>0&&!y.e.IsEmpty(s[0].Formula)){let e=this.fldDict;n=parseFloat(b.a.eval.EvaluateExpression(s[0].Formula.toString(),e)).toString()}else i=i.filter(i=>i.NodeID==t&&i.FromSlab<=e&&i.ToSlab>=e),i.length>0&&(n=y.e.String(i[0].Amount))}}}}this.dgvPayrollDed.Table[o].DedValue=this.RoundOffValue(parseFloat(n),parseFloat(this.dgvPayrollDed.Table[o].DedROff)),this.fldDict[this.dgvPayrollDed.Table[o].Deductions.toString()].setFieldValue(this.dgvPayrollDed.Table[o].DedValue.toString()),this.fldDict["Calc"+this.dgvPayrollDed.Table[o].Deductions.toString()].setFieldValue(this.dgvPayrollDed.Table[o].DedValue.toString())}catch(T){}y.e.StringIsNullOrEmpty(this.dgvPayrollDed.Table[o].DedAddToNet)||"Net"!=this.dgvPayrollDed.Table[o].DedAddToNet.toString()&&"NetAndTax"!=this.dgvPayrollDed.Table[o].DedAddToNet.toString()||(a+=parseFloat(this.dgvPayrollDed.Table[o].DedValue))}this.dgvPayrollEar.Columns[2].footer=s.ToString(this.sDecimalsAmount),this.dgvPayrollDed.Columns[2].footer=a.ToString(this.sDecimalsAmount),this.dgvPayrollEar.RefreshGridView(),this.dgvPayrollEar.UpdateFooter(),this.dgvPayrollEar.refreshDataView(),this.dgvPayrollAccrual.RefreshGridView(),this.dgvPayrollAccrual.refreshDataView(),this.dgvPayrollDed.RefreshGridView(),this.dgvPayrollDed.UpdateFooter(),this.dgvPayrollDed.refreshDataView(),this.ptxtNetSalary.Text=(s-a).ToString(this.sDecimalsAmount),this.webtotEarnings=s,this.webtotDeductions=a}txtBasicMonthly_LostFocus(e){try{let e=parseFloat(this.txtBasicMonthly.Text.trim());this.txtBasicMonthly.Text=e.ToString(this.sDecimalsAmount)}catch(t){this.txtBasicMonthly.Text=(0).ToString(this.sDecimalsAmount)}this.ExecuteFormulas()}ProbationDays_LostFocus(e){try{""!=this.ProbationDays.Text.trim()&&parseInt(this.ProbationDays.Text)>0&&(this.DateOfConfirmation.Date=this.DateOfJoining.Date.AddDays(parseInt(this.ProbationDays.Text)))}catch(t){return this.DisplayMessage="Enter Valid data",this.ProbationDays.SetFocus=!0,void(this.MessageVisibility=!0)}}dgvPayrollAccrual_BeginEdit(e,t,i){return"EarValue"!=e.args.column.field||y.e.StringIsNullOrEmpty(e.args.item.EarValue_GRAY)||"1"!=e.args.item.EarValue_GRAY.toString()?(e.args.Cancel=!1,!1):(e.args.Cancel=!0,!0)}dgvPayrollAccrual_EndEdit(e,t,i){"EarValue"==(t=e.column.field)&&(""==y.e.String(e.item[t]).Trim()&&(e.item[t]=(0).ToString(this.sDecimalsAmount),this.dgvPayrollAccrual.updateRow(e.item)),this.ExecuteFormulas())}dgvPayrollEar_BeginEdit(e,t,i){return"EarValue"!=e.args.column.field||y.e.StringIsNullOrEmpty(e.args.item.EarValue_GRAY)||"1"!=e.args.item.EarValue_GRAY.toString()?(e.args.Cancel=!1,!1):(e.args.Cancel=!0,!0)}dgvPayrollDed_BeginEdit(e,t,i){return"DedValue"==t&&"1"==e.DedValue_GRAY.toString()?(e.args.Cancel=!0,!0):(e.args.Cancel=!1,!1)}GetDtGrSalSalbs(){let e="",t=this.ScreenObject.GetCustomField("CCNID53");null!=t&&null!=t&&(e=t.SelectedValue.toString(),"0"==e&&(e="1")),this.dtGrSalSalbs=this.objEmp.GetQueryData(this.NodeID,"GetDtGrSalSalbs",e,"","")}dgvPayrollEar_EndEdit(e,t,i){let s={};if(s=e.item,"EarValue"==(t=e.column.field)){if(""==s[t].toString().trim()&&(s[t]=(0).ToString(this.sDecimalsAmount)),b.a.SessionManager.Preferences.ContainsKey("ConsiderGradeWiseSalarySlabs")&&"True"==b.a.SessionManager.Preferences.ConsiderGradeWiseSalarySlabs&&(null!=this.dtGrSalSalbs&&null!=this.dtGrSalSalbs||this.GetDtGrSalSalbs(),null!=this.dtGrSalSalbs&&null!=this.dtGrSalSalbs&&this.dtGrSalSalbs.length>0)){let e=null;if(e=this.dtGrSalSalbs.filter("EarValue"==t?e=>e.ComponentID==s.EarComponentID.toString():e=>e.ComponentID==s.DedComponentID.toString()),null!=e&&null!=e&&e.length>0&&this.ValidateGradeWiseSalarySlabsApplicableFormula(e[0])){let i=0,a=0,l=0;i=y.e.DoubleTryParse(s[t].toString()),a=y.e.DoubleTryParse(e[0].MinAmount.toString()),l=y.e.DoubleTryParse(e[0].MaxAmount.toString()),i>=a&&i<=l||("Stop"==e[0].AlertType.toString()?(alert('"'+e[0].ComponentName.toString()+'" Amount should be in between '+a+"  and  "+l),s[t]=(0).ToString(this.sDecimalsAmount)):confirm('"'+e[0].ComponentName.toString()+'" Amount should be in between '+a+"  and  "+l+"\r\nDo you want to proceed.?")||(s[t]=(0).ToString(this.sDecimalsAmount)))}}this.ExecuteFormulas()}}dgvPayrollDed_EndEdit(e,t,i){if("DedValue"==t){if(""==e[t].toString().Trim()&&(e[t]=(0).ToString(this.sDecimalsAmount)),b.a.SessionManager.Preferences.ContainsKey("ConsiderGradeWiseSalarySlabs")&&"True"==b.a.SessionManager.Preferences.ConsiderGradeWiseSalarySlabs&&(null!=this.dtGrSalSalbs&&null!=this.dtGrSalSalbs||this.GetDtGrSalSalbs(),null!=this.dtGrSalSalbs&&null!=this.dtGrSalSalbs&&this.dtGrSalSalbs.length>0)){let i=null;if(i=this.dtGrSalSalbs.filter("EarValue"==t?t=>t.ComponentID==e.EarComponentID.toString():t=>t.ComponentID==e.DedComponentID.toString()),null!=i&&null!=i&&i.length>0&&this.ValidateGradeWiseSalarySlabsApplicableFormula(i[0])){let s=0,a=0,l=0;s=y.e.DoubleTryParse(e[t].toString()),a=y.e.DoubleTryParse(i[0].MinAmount.toString()),l=y.e.DoubleTryParse(i[0].MaxAmount.toString()),s>=a&&s<=l||("Stop"==i[0].AlertType.toString()?(alert('"'+i[0].ComponentName.toString()+'" Amount should be in between '+a+"  and  "+l),e[t]=(0).ToString(this.sDecimalsAmount)):confirm('"'+i[0].ComponentName.toString()+'" Amount should be in between '+a+"  and  "+l+"\r\nDo you want to proceed.?")||(e[t]=(0).ToString(this.sDecimalsAmount)))}}this.ExecuteFormulas()}}ValidateGradeWiseSalarySlabsApplicableFormula(e){if(null!=e&&null!=e&&""!=y.e.String(e.ApplicableFormula).Trim()){this.oEvalPayFormulas=new I.b,this.oEvalPayFormulas.isValidGWSlabs=!0,this.oEvalPayFormulas.sEmpSeqNo=this.NodeID.toString();let t={PayrollMonth:this.oEvalPayFormulas.PayrollMonth,PayrollMonthStart:this.oEvalPayFormulas.PayrollMonthStart,PayrollMonthEnd:this.oEvalPayFormulas.PayrollMonthEnd};if(y.e.SetPayrollDate(new Date,t),this.oEvalPayFormulas.PayrollMonth=t.PayrollMonth,this.oEvalPayFormulas.PayrollMonthStart=t.PayrollMonthStart,this.oEvalPayFormulas.PayrollMonthEnd=t.PayrollMonthEnd,this.oEvalPayFormulas.arrLstCPFields[6].Clear(),this.oCPF=new I.a,this.oCPF.ComponentName="GrdWiseSalSlabsFormula",this.oCPF.SNo=1,this.oCPF.Formula=e.ApplicableFormula.toString(),this.oCPF.dEarned=this.oCPF.dActual="0",this.oEvalPayFormulas.arrLstCPFields[6].push(this.oCPF),this.oEvalPayFormulas.Intialize(),this.oEvalPayFormulas.othMPField.BasicMonthly=""==this.txtBasicMonthly.Text?0:parseFloat(this.txtBasicMonthly.Text),this.oEvalPayFormulas.othMPField.TotalLeaves=0,this.oEvalPayFormulas.othMPField.DaysAttended=this.oEvalPayFormulas.othMPField.TotalDays,null!=this.EmpType.GetselectedItem()&&(this.oEvalPayFormulas.sEmpType=this.EmpType.GetselectedItem().Name),null!=this.Gender.GetselectedItem()&&(this.oEvalPayFormulas.sGender=this.Gender.GetselectedItem().Name),null!=this.pcbMaritalStatus.GetselectedItem()&&(this.oEvalPayFormulas.sMaritalStatus=this.pcbMaritalStatus.GetselectedItem().Name),null!=this.pcbNationality.GetselectedItem()&&(this.oEvalPayFormulas.sNationality=this.pcbNationality.GetselectedItem().Name),null!=this.pcbReligion.GetselectedItem()&&(this.oEvalPayFormulas.sReligion=this.pcbReligion.GetselectedItem().Name),this.oEvalPayFormulas.Parent=this,this.oEvalPayFormulas.ExecuteAllFormulas(),"GrdWiseSalSlabsFormula"==this.oEvalPayFormulas.arrLstCPFields[6][0].ComponentName)return 0!=parseFloat(this.oEvalPayFormulas.arrLstCPFields[6][0].dEarned)}return!0}GetScreenControl(e){let t=null;if(null!=this.ScreenObject&&null!=this.ScreenObject.HeaderFields){if(this.ScreenObject.HeaderFields.length>0&&(t=this.ScreenObject.HeaderFields.find(t=>t instanceof c.c&&t.DBColumnName==e),t))return t;for(let i=0;i<this.ScreenObject.CustomTab.Pages.length;i++)if(t=this.ScreenObject.CustomTab.Pages[i].Fields.find(t=>t instanceof c.c&&t.DBColumnName==e),t)return t}return null}PayrollType_SelectionChanged(){switch(this.pcbPayrollType.SelectedValue){case"Monthly":this.ScreenObject.CustomTab.Pages.forEach(e=>{e.Fields.forEach(e=>{e instanceof a.d&&("BasicMonthly"==e.DBColumnName?e.Enable=!0:("BasicWeekly"==e.DBColumnName||"BasicDaily"==e.DBColumnName||"BasicHourly"==e.DBColumnName)&&(e.Enable=!1))})});break;case"Weekly":this.ScreenObject.CustomTab.Pages.forEach(e=>{e.Fields.forEach(e=>{e instanceof a.d&&("BasicMonthly"==e.DBColumnName?e.Enable=!1:"BasicWeekly"==e.DBColumnName?e.Enable=!0:("BasicDaily"==e.DBColumnName||"BasicHourly"==e.DBColumnName)&&(e.Enable=!1))})});break;case"Daily":this.ScreenObject.CustomTab.Pages.forEach(e=>{e.Fields.forEach(e=>{e instanceof a.d&&("BasicMonthly"==e.DBColumnName||"BasicWeekly"==e.DBColumnName?e.Enable=!1:"BasicDaily"==e.DBColumnName?e.Enable=!0:"BasicHourly"==e.DBColumnName&&(e.Enable=!1))})});break;case"Hourly":this.ScreenObject.CustomTab.Pages.forEach(e=>{e.Fields.forEach(e=>{e instanceof a.d&&("BasicMonthly"==e.DBColumnName||"BasicWeekly"==e.DBColumnName||"BasicDaily"==e.DBColumnName?e.Enable=!1:"BasicHourly"==e.DBColumnName&&(e.Enable=!0))})})}}OnTabSelectionChanged(e){null!=this.ScreenObject.CustomTab.SelectedTab&&("Notes"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.AttachmentVisibility=!1,this.ContactVisibility=!1,this.AddressVisibility=!1,this.CCMapVisibility=!1,this.EmpDocumentsVisibility=!1,this.ViewNotes.OnShowNewNotes(null)):"Attachments"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.ViewAttachments=new E.ViewAttachmentViewModel(this,b.a.SessionManager,b.a.admin),this.NoteVisibility=!1,this.ContactVisibility=!1,this.AddressVisibility=!1,this.CCMapVisibility=!1,this.EmpDocumentsVisibility=!1):"Contacts"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.AddressVisibility=!1,this.CCMapVisibility=!1,this.EmpDocumentsVisibility=!1,this.ViewContacts.OnShowNewContact(null)):"Address"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.ContactVisibility=!1,this.CCMapVisibility=!1,this.EmpDocumentsVisibility=!1,this.ViewAddress.OnShowNewAddress(null)):"Assign"==this.ScreenObject.CustomTab.SelectedTab.Name?b.a.SessionManager.IsActionAssigned(2,"Map")?(this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.ContactVisibility=!1,this.AddressVisibility=!1,this.EmpDocumentsVisibility=!1,this.ViewCCMapping.OnShowCC(null)):(this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.ContactVisibility=!1,this.AddressVisibility=!1,this.CCMapVisibility=!1,this.EmpDocumentsVisibility=!1):"Documents"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.ContactVisibility=!1,this.CCMapVisibility=!1,this.AddressVisibility=!1,this.ViewEmpDocuments.OnShowNew(null)):(this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.ContactVisibility=!1,this.AddressVisibility=!1,this.CCMapVisibility=!1,this.EmpDocumentsVisibility=!1))}OnGroupSelectionChanged(e){this.EmpGroup.SelectedValue>0&&(this.EmpGroup.DefaultValue=this.EmpGroup.SelectedValue.toString(),this.AutoGenerateCode())}AutoGenerateCode(){0==this.NodeID&&(this.objEmp.SelectedNodeID=this.EmpGroup.SelectedValue>0?this.EmpGroup.SelectedValue:this.ParentId,this.ScreenObject.SetAutoCode(this.EmpCode,this.objEmp.IsGroup,this.objEmp.SelectedNodeID,this.ScreenObject.Data.Tables[7]))}GetRecords(e){this.ButtonSave.Enable||(this.ButtonSave.Enable=!0);let t=0;this.iBankNodeID=0;let i=!1;"NEXT"==e.toString().toUpperCase()?i=!0:"PREVIOUS"==e.toString().toUpperCase()&&(i=!1);let s=null;if(b.a.SessionManager.sWHEmpFilteredEmpSeqNos.length>0){if(s=this.objEmp.GetQueryData(0,"EmpFilteredEmpSeqNos",b.a.SessionManager.sWHEmpFilteredEmpSeqNos,"",""),null!=s&&s.Tables.length>0&&s.Tables[0].length>0)for(let e=0;e<s.Tables[0].length;e++)if(s.Tables[0][e].NodeID.toString()==this.NextPrevID.toString()){if(i)try{t=parseInt(s.Tables[0][e+1].NodeID.toString())}catch(a){}else try{t=parseInt(s.Tables[0][e-1].NodeID.toString())}catch(l){}break}}else s=b.a.common.GetNextPreviousRecords(this.CostCenterID,this.NextPrevID,i,0,this.objEmp.IsGroup?1:0),null!=s&&s.Tables.length>0&&s.Tables[0].length>0&&(t=parseInt(s.Tables[0][0][Object.keys(s.Tables[0][0])[0]]));0!=t&&(this.NextPrevID=t,this.NodeID=t,1!=this.NodeID&&this.FillControls())}GetNextPreviousRecords(e,t,i,s){null==s&&(s=0),b.a.SessionManager.Logger.InfoLog("Administration:: Entering GetDivisions");let a="";return a=e,a+="~"+t,a+="~"+i,a+="~"+s,a+="~"+b.a.SessionManager.UserName,b.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"True"==b.a.SessionManager.Preferences.EnableLocationWise.toString()&&(2==e&&b.a.SessionManager.Preferences.ContainsKey("LW Accounts")&&"True"==b.a.SessionManager.Preferences["LW Accounts"].toString()||3==e&&b.a.SessionManager.Preferences.ContainsKey("LW Products")&&"True"==b.a.SessionManager.Preferences["LW Products"].toString()||e>5e4&&b.a.SessionManager.Preferences.ContainsKey("LocationWiseDimension")&&b.a.SessionManager.Preferences.LocationWiseDimension.split(",").Contains(e.toString()))?b.a.SessionManager.LocationID>0?a+="~"+b.a.SessionManager.LocationID:""!=b.a.SessionManager.LocationWhere&&(a+="~"+b.a.SessionManager.LocationWhere):a+="~0",b.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"True"==b.a.SessionManager.Preferences.EnableLocationWise.toString()&&b.a.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&"True"==b.a.SessionManager.Preferences.EnableDivisionWise.toString()&&(2==e&&b.a.SessionManager.Preferences.ContainsKey("DW Accounts")&&"True"==b.a.SessionManager.Preferences["DW Accounts"].toString()||3==e&&b.a.SessionManager.Preferences.ContainsKey("DW Products")&&"True"==b.a.SessionManager.Preferences["DW Products"].toString()||e>5e4&&b.a.SessionManager.Preferences.ContainsKey("DivisionWiseDimension")&&b.a.SessionManager.Preferences.DivisionWiseDimension.split(",").Contains(e.toString()))?b.a.SessionManager.DivisionID>0?a+="~"+b.a.SessionManager.DivisionID:""!=b.a.SessionManager.DivisionWhere&&(a+="~"+b.a.SessionManager.DivisionWhere):a+="~0",b.a.SessionManager.Logger.InfoLog("Administration:: Success: DBH.SetCCCCMap "),this.objEmp.GetNextPreviousRecords(a)}FillControls(){b.a.SessionManager.Logger.InfoLog("AddEditEmpMasterViewModel::Entering FillData"),this.ScreenObject.Clear(),this.ClearOtherControls(),this.NextPrevID=this.NodeID,this.objEmp.NodeID=this.NodeID,this.dsEdit=this.objEmp.GetEmpMasterDetails(),this.AccountPhoto="",this.EmpCode.Text=this.objEmp.EmpCode,this.ScreenObject.IsAutoCode&&(this.EmpCode.Enable=!1),this.ScreenObject.IsAutoName&&(this.EmpName.Enable=!1),this.EmpName.Text=this.objEmp.EmpName,this.AliasName.Text=this.objEmp.EmpAliasName,this.Status.SelectedValue=this.objEmp.StatusID.toString(),this.EmpGroup.SelectedValue=this.objEmp.ParentID,this.EmpGroup.Enable=!1,this.EmpType.SelectedValue=this.objEmp.EmpTypeID.toString(),this.DateOfJoining.Date=this.objEmp.DOJ,this.DateOfBirth.Date=this.objEmp.DOB,this.RptManager.SelectedValue=this.objEmp.RptManager,this.Gender.SelectedValue=this.objEmp.Gender,this.ProbationDays.Text=this.objEmp.ProbationDays.toString(),this.DateOfConfirmation.Date=this.objEmp.DOConfirmation,this.guid=this.objEmp.GUID,this.ScreenObject.LoadCustomFieldsData(this.dsEdit.Tables[0]),this.GetBankDetails(this.pc1),this.ScreenObject.LoadCustomFieldsCCData(this.dsEdit.Tables[7],this.dsEdit.Tables[12]),this.ViewCCMapping.LoadData(this.dsEdit.Tables[5],this.dsEdit.Columns[5]),this.ViewContacts.LoadContacts(this.dsEdit.Tables[1],this.dsEdit.Columns[1]),this.ViewAttachments.LoadAttachments(this.dsEdit.Tables[3]),this.ViewNotes.LoadNotes(this.dsEdit.Tables[2]),this.ViewAddress.LoadContacts(this.dsEdit.Tables[6]),this.ViewEmpDocuments.GridListObj.Clear(),this.ViewEmpDocuments.LoadDocuments(this.dsEdit.Tables[13]),this.ScreenObject.LoadIdentityControlsDataXML(this.dsEdit.Tables[13]),this.EmpDocumentsVisibility=!1;let e,t=this.dsEdit.Tables[14];if(t.sort((e,t)=>t.EffectFrom-e.EffectFrom),t.sort((e,t)=>t.SeqNo-e.SeqNo),t.length>0){for(let e=0;e<this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields.length;e++)this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[e]instanceof c.c&&("BasicMonthly"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[e].DBColumnName&&"BasicWeekly"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[e].DBColumnName&&"BasicDaily"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[e].DBColumnName&&"BasicHourly"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[e].DBColumnName&&"NetSalary"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[e].DBColumnName&&"AnnualCTC"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[e].DBColumnName||(this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[e].Text=parseFloat(t[0][this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[e].DBColumnName]).ToString(this.sDecimalsAmount)));if(null!=this.dgvPayrollEar&&null!=this.dgvPayrollEar&&null!=this.dgvPayrollEar.Table&&this.dgvPayrollEar.Table.length>0)for(let e=0;e<this.dgvPayrollEar.Table.length;e++)y.e.StringIsNullOrEmpty(this.dgvPayrollEar.Table[e].EarSNo)||(this.dgvPayrollEar.Table[e].EarValue=parseFloat(t[0]["Earning"+this.dgvPayrollEar.Table[e].EarSNo]).ToString(this.sDecimalsAmount));if(null!=this.dgvPayrollAccrual&&null!=this.dgvPayrollAccrual&&null!=this.dgvPayrollAccrual.Table&&this.dgvPayrollAccrual.Table.length>0)for(let e=0;e<this.dgvPayrollAccrual.Table.length;e++)y.e.StringIsNullOrEmpty(this.dgvPayrollAccrual.Table[e].EarSNo)||(this.dgvPayrollAccrual.Table[e].EarValue=parseFloat(t[0]["Earning"+this.dgvPayrollAccrual.Table[e].EarSNo]).ToString(this.sDecimalsAmount));if(null!=this.dgvPayrollDed&&null!=this.dgvPayrollDed&&null!=this.dgvPayrollDed.Table&&this.dgvPayrollDed.Table.length>0)for(let e=0;e<this.dgvPayrollDed.Table.length;e++)y.e.StringIsNullOrEmpty(this.dgvPayrollDed.Table[e].DedSNo)||(this.dgvPayrollDed.Table[e].DedValue=parseFloat(t[0]["Deduction"+this.dgvPayrollDed.Table[e].DedSNo]).ToString(this.sDecimalsAmount));this.ExecuteFormulas()}if(this.LoadAppraisalGrid(),this.txtBasicMonthly_LostFocus(this.txtBasicMonthly),null!=this.dgvAccLinking&&null!=this.dgvAccLinking&&null!=this.dgvAccLinking.Table&&this.dgvAccLinking.Table.length>0){let e;for(let t=0;t<this.dgvAccLinking.Table.length;t++)y.e.StringIsNullOrEmpty(this.dgvAccLinking.Table[t].ComponentID)||(e=this.dsEdit.Tables[15].filter(e=>e.ComponentID==this.dgvAccLinking.Table[t].ComponentID.toString()),null!=e&&null!=e&&e.length>0&&(this.dgvAccLinking.Table[t].DebitAccountID=e[0].DebitAccountName.toString(),this.dgvAccLinking.Table[t].DebitAccountID_Key=e[0].DebitAccountID.toString(),this.dgvAccLinking.Table[t].CreditAccountID=e[0].CreditAccountName.toString(),this.dgvAccLinking.Table[t].CreditAccountID_Key=e[0].CreditAccountID.toString()),this.TempdgvAccLinkingTable=this.dgvAccLinking.Table)}this.dsEdit.Tables.length>10&&this.dsEdit.Tables[10].length>0&&this.ScreenObject.CanApprove(this.dsEdit.Tables[0][0],this.dsEdit.Tables[10][0],this.ButtonSave),e=this.dsEdit.Tables[3].filter(e=>1==e.IsProductImage&&(1==e.IsDefaultImage||1==e.IsDefaultImage)),e.length>0?(this.PhotoTextVisibility=!1,this.FileID=parseInt(e[0].FileID),this.EmpAttachmentguid=e[0].GUID.toString(),this.FileExtension=e[0].FileExtension.toString(),this.AccountPhoto=y.e.GetPath(e[0].GUID.toString()+"."+e[0].FileExtension.toString())):(this.FileID=0,this.PhotoTextVisibility=!0),b.a.SessionManager.IsOffline&&this.NodeID>0&&(this.ButtonSave.Visible=!1),"Bank Transfer"==this.pcbPaymentMode.SelectedValue&&(this.pc1=this.GetScreenControl("BankAccNo"),null!=this.pc1&&(this.pc1.Enable=!0),this.pc1=this.GetScreenControl("IBANNo"),null!=this.pc1&&(this.pc1.Enable=!0),this.pc1=this.GetScreenControl("iBank"),null!=this.pc1&&(this.pc1.Enable=!0));let i=this.GetScreenControl("AttSetType");if(this.AttSetTypeCheckedChanged(1==i.Items[0].IsChecked?i.Items[0]:i.Items[1]),this.SetEmpAsOnStatus(),this.CheckViewForUser(0),this.RestrictSaveButton(),b.a.SessionManager.Preferences.ContainsKey("DisableEmployeePayrollTabafterPayrollProcessed")&&"True"==b.a.SessionManager.Preferences.DisableEmployeePayrollTabafterPayrollProcessed){let e=b.a.common.GetDataTable("AEEMP002",this.NodeID.toString());if(null!=e&&e.length>0){for(let e=0;e<this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields.length;e++)this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[e]instanceof c.c&&("BasicMonthly"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[e].DBColumnName&&"BasicWeekly"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[e].DBColumnName&&"BasicDaily"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[e].DBColumnName&&"BasicHourly"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[e].DBColumnName&&"NetSalary"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[e].DBColumnName&&"AnnualCTC"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[e].DBColumnName||(this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[e].IsReadOnly=!0));this.dgvPayrollEar.IsReadOnly=!0,this.dgvPayrollDed.IsReadOnly=!0,this.dgvPayrollAccrual.IsReadOnly=!0}}}SetEmpAsOnStatus(){this.EmpCurrentStatus="";let e=this.objEmp.GetQueryData(this.NodeID,"SetEmpAsOnStatus","","","").Tables[0];null!=e&&e.length>0&&(this.EmpCurrentStatus="Active"==y.e.String(e[0].AsOnStatus)?" ["+b.a.GetResource("EmpActive")+"]":"Inactive"==y.e.String(e[0].AsOnStatus)?" ["+b.a.GetResource("EmpInActive")+"]":"Cancelled"==y.e.String(e[0].AsOnStatus)?" ["+b.a.GetResource("EmpCancelled")+"]":"Absconded"==y.e.String(e[0].AsOnStatus)?" ["+b.a.GetResource("EmpAbsconded")+"]":"Resigned"==y.e.String(e[0].AsOnStatus)?" ["+b.a.GetResource("EmpResigned")+"]":"Terminated With Cause"==y.e.String(e[0].AsOnStatus)?" ["+b.a.GetResource("EmpTerminatedwithcause")+"]":" ["+y.e.String(e[0].AsOnStatus)+"]"),b.a.SessionManager.Logger.InfoLog("AddEditEmpMasterViewModel::Exiting FillData")}LoadImageDimensions(){let e=new h.b;e.Row="0";let t=90,i=!0,s=this.ScreenObject.Data.Tables[5].filter(e=>"ImageDimensions"==e.Name);if(s.length>0&&!y.e.IsEmpty(s[0].Value)){let a=new y.f;a.LoadXml(s[0].Value.toString()),i=null==a.DocumentElement.attributes.ShowImage||"0"!=a.DocumentElement.attributes.ShowImage.value,e.RowSpan=null!=a.DocumentElement.attributes.RowSpan&&""!=a.DocumentElement.attributes.RowSpan.value?a.DocumentElement.attributes.RowSpan.value:"3",e.ColumnSpan=null!=a.DocumentElement.attributes.ColumnSpan&&""!=a.DocumentElement.attributes.ColumnSpan.value?a.DocumentElement.attributes.ColumnSpan.value:"1",e.Column="1"==e.ColumnSpan?"3":"2"==e.ColumnSpan?"2":"3"==e.ColumnSpan?"1":"4"==e.ColumnSpan?"0":"3",t=this.AccountPhoto.length>0?45*parseInt(e.RowSpan):45*parseInt(e.RowSpan)-20,e.ImageHeight=t.toString()}else e.RowSpan="3",e.Column="3",e.ColumnSpan="1",e.ImageHeight=t.toString()}OnSaveEmployee(e){if("PickMin"==e.toString()||"PickMax"==e.toString()){if(b.a.SessionManager.Preferences.ContainsKey("ConsiderGradeWiseSalarySlabs")&&"True"==b.a.SessionManager.Preferences.ConsiderGradeWiseSalarySlabs&&(this.dtGrSalSalbs=b.a.empService.GetQueryData(0,"ValidateDtGrSalSalbs","","",""),null!=this.dtGrSalSalbs&&this.dtGrSalSalbs.length>0)){let t=null;for(let i=0;i<this.dgvPayrollEar.Table.length;i++)if(!y.e.IsEmpty(this.dgvPayrollEar.Table[i].EarFType)&&"EmployeeMaster"==this.dgvPayrollEar.Table[i].EarFType.toString()&&(t=this.dtGrSalSalbs.filter(e=>e.ComponentID==y.e.String(this.dgvPayrollEar.Table[i].EarComponentID)),null!=t&&t.length>0&&this.ValidateGradeWiseSalarySlabsApplicableFormula(t[0]))){let s=0,a=0;s=y.e.Double(t[0].MinAmount),a=y.e.Double(t[0].MaxAmount),this.dgvPayrollEar.Table[i].EarValue="PickMin"==e.toString()?s.toString():a.toString()}for(let i=0;i<this.dgvPayrollDed.Table.length;i++)if(!y.e.IsEmpty(this.dgvPayrollDed.Table[i].DedFType)&&"EmployeeMaster"==this.dgvPayrollDed.Table[i].DedFType.toString()&&(t=this.dtGrSalSalbs.filter(e=>e.ComponentID==y.e.String(this.dgvPayrollDed.Table[i].DedComponentID)),null!=t&&t.length>0&&this.ValidateGradeWiseSalarySlabsApplicableFormula(t[0]))){let s=0,a=0;s=y.e.Double(t[0].MinAmount),a=y.e.Double(t[0].MaxAmount),this.dgvPayrollDed.Table[i].DedValue="PickMin"==e.toString()?s.toString():a.toString()}}this.ExecuteFormulas()}else if("Contact"==e.toString());else if("Note"==e.toString());else if("Attachment"==e.toString());else if("NewContact"==e.toString());else if("NewAttachment"==e.toString());else if("NewAddress"==e.toString());else if("NewNote"==e.toString());else if("ShowApprove"==e.toString()){let e=new w.a(50051,this.NodeID,this.ScreenObject,this);b.a.page.ShowDialog(e,F.a,{ShowCenter:!0,Title:b.a.GetResource("ApproveReject")})}else if("Save"==e.toString()){b.a.SessionManager.Logger.InfoLog("AddEditEmpMasterViewModel::Entering OnSaveEmployee");try{let e=this.ScreenObject.ValidateData();if(!b.a.SessionManager.StringIsNullOrEmpty(e))return this.DisplayMessage=e,void(this.MessageVisibility=!0);if(!this.objEmp.IsGroup&&""!=b.a.SessionManager.Preferences.MinAgeForEmployee&&parseInt(b.a.SessionManager.Preferences.MinAgeForEmployee)>0){let e=parseInt(b.a.SessionManager.Preferences.MinAgeForEmployee);if(this.DateOfJoining.Date.Subtract(this.DateOfBirth.Date).TotalDays/365<e)return this.DisplayMessage="Employee should be atleast "+e+" years of age.",this.MessageVisibility=!0,void(this.DateOfBirth.SetFocus=!0)}let i=this.GetScreenControl("LoginUserID");if(null!=i){let e=b.a.empService.GetQueryData(0,"LoginUserID",this.EmpCode.Text,i.Text.toString(),"");if(null!=e&&e.length>0)return this.DisplayMessage="User Already Created with same LoginUserID",void(this.MessageVisibility=!0)}if(null!=this.EmpType&&"0"==this.EmpType.SelectedValue||""==this.EmpType.SelectedValue)return this.DisplayMessage="Please select the employee type",void(this.MessageVisibility=!0);if(!this.ScreenObject.ValidateDataonSave())return;if(this.objEmp.NodeID>0&&(302==parseInt(this.Status.SelectedValue)||303==parseInt(this.Status.SelectedValue)||304==parseInt(this.Status.SelectedValue))){let e=b.a.common.GetDataTable("AEEMP003",this.objEmp.NodeID.toString());if(null!=e&&e.length>0&&1==parseInt(e[0].VALID))return this.DisplayMessage="Status '"+this.Status.GetselectedItem().Name+"' Can be changed only after RelieveDate",void(this.MessageVisibility=!0)}if(b.a.SessionManager.Preferences.ContainsKey("ConsiderGradeWiseSalarySlabs")&&"True"==b.a.SessionManager.Preferences.ConsiderGradeWiseSalarySlabs){let e="",t=this.ScreenObject.GetCustomField("CCNID53");if(null!=t&&null!=t&&(e=t.SelectedValue.toString(),"0"==e&&(e="1")),this.dtGrSalSalbs=this.objEmp.GetQueryData(this.NodeID,"GradewiseSalarySlabs",e,"",""),this.dtGrSalSalbs&&null!=this.dtGrSalSalbs&&this.dtGrSalSalbs.length>0){let e,t="",i=!1;for(let s=0;s<this.dgvPayrollEar.Table.length;s++)if(!y.e.StringIsNullOrEmpty(this.dgvPayrollEar.Table[s].EarFType)&&"EmployeeMaster"==this.dgvPayrollEar.Table[s].EarFType.toString()&&(e=this.dtGrSalSalbs.filter(e=>e.ComponentID==this.dgvPayrollEar.Table[s].EarComponentID.toString()),null!=e&&null!=e&&e.length>0&&this.ValidateGradeWiseSalarySlabsApplicableFormula(e[0]))){let a=0,l=0,n=0;a=b.a.SessionManager.DoubleTryParse(this.dgvPayrollEar.Table[s].EarValue.toString()),l=b.a.SessionManager.DoubleTryParse(e[0].MinAmount.toString()),n=b.a.SessionManager.DoubleTryParse(e[0].MaxAmount.toString()),a>=l&&a<=n||("Stop"==e[0].AlertType.toString()?(i=!0,t+='\r\n"'+e[0].ComponentName.toString()+'" Amount should be in between '+l+"  and  "+n):t+='\r\n"'+e[0].ComponentName.toString()+'" Amount should be in between '+l+"  and  "+n)}for(let s=0;s<this.dgvPayrollDed.Table.length;s++)if(!y.e.StringIsNullOrEmpty(this.dgvPayrollDed.Table[s].DedFType)&&"EmployeeMaster"==this.dgvPayrollDed.Table[s].DedFType.toString()&&(e=this.dtGrSalSalbs.filter(e=>e.ComponentID==this.dgvPayrollDed.Table[s].DedComponentID.toString()),null!=e&&null!=e&&e.length>0&&this.ValidateGradeWiseSalarySlabsApplicableFormula(e[0]))){let a=0,l=0,n=0;a=b.a.SessionManager.DoubleTryParse(this.dgvPayrollDed.Table[s].DedValue.toString()),l=b.a.SessionManager.DoubleTryParse(e[0].MinAmount.toString()),n=b.a.SessionManager.DoubleTryParse(e[0].MaxAmount.toString()),a>=l&&a<=n||("Stop"==e[0].AlertType.toString()?(i=!0,t+='\r\n"'+e[0].ComponentName.toString()+'" Amount should be in between '+l+"  and  "+n):t+='\r\n"'+e[0].ComponentName.toString()+'" Amount should be in between '+l+"  and  "+n)}if(t.length>0){if(i)return void alert(t);if(!confirm(t+"\r\nDo you want to proceed.?"))return}}}if(0==this.objEmp.NodeID){let e,t={StrCode:this.objEmp.EmpCode,CodePrefix:this.objEmp.CodePrefix,CodeNumber:this.objEmp.CodeNumber};if(this.DisplayMessage=this.ScreenObject.SetAutoCodeParams_3(this.EmpCode,this.objEmp.SelectedNodeID,this.ScreenObject.Data.Tables[7],t),this.objEmp.EmpCode=t.StrCode,this.objEmp.CodePrefix=t.CodePrefix,this.objEmp.CodeNumber=t.CodeNumber,this.DisplayMessage.length>0)return;if(e=this.GetScreenControl("CanCreateUser"),null!=e&&"Yes"==e.SelectedValue&&b.a.SessionManager.LicenseSettings.ContainsKey("EFeature11")){let e;if(e=parseInt(b.a.SessionManager.LicenseSettings.EFeature11),e>0){let t=b.a.common.GetDataTable("AEEMP001","");if(e<=parseInt(t[0][Object.keys(t[0])[0]]))return this.DisplayMessage="Maximum "+e.toString()+" ESS Users Allowed.",void(this.MessageVisibility=!0)}}}else this.objEmp.EmpCode=this.EmpCode.Text.trim();this.objEmp.EmpName=this.EmpName.Text.trim(),this.objEmp.EmpAliasName=this.AliasName.Text,this.objEmp.StatusID=parseInt(this.Status.SelectedValue),this.objEmp.EmpTypeID=parseInt(this.EmpType.SelectedValue),this.objEmp.SelectedNodeID=parseInt(this.EmpGroup.SelectedValue.toString()),this.objEmp.DOJ=this.DateOfJoining.Date,this.objEmp.DOB=this.DateOfBirth.Date,this.objEmp.RptManager=parseInt(this.RptManager.SelectedValue.toString()),this.objEmp.Gender=this.Gender.SelectedValue,this.objEmp.ProbationDays=parseInt(this.ProbationDays.Text),this.objEmp.DOConfirmation=this.DateOfConfirmation.Date,this.objEmp.NotesXML=this.ViewNotes.GetXML(),this.objEmp.ContactsXML=this.ViewContacts.GetXML(),this.objEmp.AddressXML=this.ViewAddress.GetXML();try{this.objEmp.AttachmetsXML=this.ViewAttachments.GetXML(),this.objEmp.AttachmetsXML+=this.ScreenObject.GetExtraAttachmentXML();let e="";this.IsPhotoChanged&&!y.e.IsEmpty(this.AccountPhoto)?(e+=0==this.FileID?'<Row Action="NEW"':'<Row Action="MODIFY"',b.a.SessionManager.IsWebApplication&&(e+=' AttachmentID="'+this.FileID+'"',e+=' FilePath="'+this.AccountPhoto+'"',e+=' ActualFileName="'+this.AccountPhoto.substring(this.AccountPhoto.lastIndexOf("\\")+1)+'"',e+=' RelativeFileName="'+this.AccountPhoto+'"',e+=' FileExtension="'+this.FileExtension+'"',e+=' FileDescription=""',e+=' IsProductImage="1"',e+=' IsDefaultImage="1"',e+=' GUID="'+this.EmpAttachmentguid+'"',e+="/>")):this.IsPhotoDelete&&this.FileID>0&&(e+='<Row Action="DELETE"',e+=' AttachmentID="'+this.FileID+'"/>'),e.length>0&&(e="<AttachmentsXML>"+e,e+="</AttachmentsXML>",this.objEmp.AttachmetsXML=this.objEmp.AttachmetsXML+e)}catch(t){return b.a.SessionManager.Logger.ErrorLog("AddEditEmpMasterViewModel:: OnSaveEmployee :: Attachments Exception : "),this.DisplayMessage=b.a.SessionManager.translate.instant("Upload_Path_notExists"),void(this.MessageVisibility=!0)}this.objEmp.CustomFieldsQuery=this.ScreenObject.GetCustomFieldsQuery(),this.objEmp.CustomCostCenterFieldsQuery=this.ScreenObject.GetCustomCostCenterFieldsQuery(),this.objEmp.HistoryXML=this.ScreenObject.HistoryCCXML,this.objEmp.CCMapXML="";let s="";if("TRUE"==b.a.SessionManager.Preferences.EnableLocationWise.toUpperCase()&&b.a.SessionManager.Preferences.LocationWiseDimension.split(",").Contains("50051")){if(null!=this.objEmp.CustomCostCenterFieldsQuery&&this.objEmp.CustomCostCenterFieldsQuery.length>0){let e=this.objEmp.CustomCostCenterFieldsQuery.split(",");if(e.length>0)for(let t=0;t<e.length;t++)null!=e[t]&&e[t].Contains("CCNID2=")&&(s+='<Row  CostCenterId="50002" NodeID="'+e[t].replace("'","").replace("'","").substring(7)+'" />')}if(""==s)return this.DisplayMessage="Select atleast one Location",void(this.MessageVisibility=!0);this.objEmp.CCMapXML+="<XML>"+s+"</XML>"}else this.objEmp.CCMapXML="";if(null!=this.dsEdit&&this.dsEdit.Tables[0].length>0?Date.parse(this.dsEdit.Tables[0][0].cDOJ.toString())>0&&(this.TempDOJ=new Date(this.dsEdit.Tables[0][0].cDOJ.toString())):Date.parse(this.DateOfJoining.Date.ToString("dd/MMM/yyyy"))>0&&(this.TempDOJ=new Date(this.DateOfJoining.Date.ToString("dd/MMM/yyyy"))),!y.e.IsEmpty(this.objEmp.HistoryXML)){let e=new y.f,t=new Date,i="";e.LoadXml(this.objEmp.HistoryXML);let s=e.SelectNodes("History/XML/Row");if(null!=s&&s.length>0){for(let e=0;e<s.length;e++){const a=s[e];if("2"!=a.attributes.Modified.value.toString()&&"50053"==a.attributes.CCID.value.toString()){i="Grade",t=new Date(a.attributes.FromDate.value);break}}if("Grade"==i.toString()&&new Date(t).ToString("MMM/yyyy")!=new Date(this.DateOfJoining.Date).ToString("MMM/yyyy")&&new Date(this.TempDOJ).ToString("MMM/yyyy")==new Date(this.DateOfJoining.Date).ToString("MMM/yyyy"))return this.DisplayMessage="Please check the date of joining of Employee and dependency with Grade",void(this.MessageVisibility=!0);for(let e=0;e<s.length;e++){const a=s[e];if("2"!=a.attributes.Modified.value.toString()&&"50002"==a.attributes.CCID.value.toString()){i="Location",t=new Date(a.attributes.FromDate.value);break}}}if("Location"==i.toString()&&new Date(t).ToString("MMM/yyyy")!=new Date(this.DateOfJoining.Date).ToString("MMM/yyyy")&&new Date(this.TempDOJ).ToString("MMM/yyyy")==new Date(this.DateOfJoining.Date).ToString("MMM/yyyy"))return this.DisplayMessage="Please check the date of joining of Employee and dependency with Location",void(this.MessageVisibility=!0)}if(null!=this.dsEdit&&null!=this.dsEdit&&this.dsEdit.Tables[12].length>0&&this.TempDOJ.ToString("dd/MMM/yyyy")!=this.DateOfJoining.Date.ToString("dd/MMM/yyyy")){if(!confirm("Changing of Date of Join will effect on History, Appraisal Data and Others Documents. So, Are you sure want to Change the Date of Joining.?"))return void(this.DateOfJoining.Date=this.TempDOJ);let e=this.objEmp.GetQueryData(this.NodeID,"DateOfJoining",this.DateOfJoining.Date.ToString("dd/MMM/yyyy"),"",""),t=e.Tables[0];if(null!=t&&t.length>0){if(t=e.Tables[1],t.length>0&&null!=t)return this.DisplayMessage="Date of joining Cannot be changed Monthly Payroll Processed '"+t[0].VoucherNo.toString()+"'",void(this.MessageVisibility=!0);if(t=e.Tables[2],t.length>0&&null!=t)return this.DisplayMessage="Date of joining Cannot be changed daily payroll posted '"+t[0].VoucherNo.toString()+"'",void(this.MessageVisibility=!0);if(t=e.Tables[3],t.length>0&&null!=t)return this.DisplayMessage="Date of joining Cannot be changed Hours Definition Chart data Exists '"+t[0].VoucherNo.toString()+"' W.E.F Date",void(this.MessageVisibility=!0);if(t=e.Tables[4],t.length>0&&null!=t)return this.DisplayMessage="Date of joining Cannot be changed Document Data Exists '"+t[0].VoucherNo.toString()+"' Dependency With DocDate",void(this.MessageVisibility=!0)}}this.objEmp.DocumentsXML=this.ViewEmpDocuments.GetXML(),this.objEmp.AccLinkXML=this.GetAccountsLinkingXML(),this.objEmp.PrimaryContactQuery="",this.objEmp.GUID=this.guid;let a="";for(let t=0;t<this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields.length;t++)this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[t]instanceof c.c&&("BasicMonthly"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[t].DBColumnName&&"BasicWeekly"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[t].DBColumnName&&"BasicDaily"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[t].DBColumnName&&"BasicHourly"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[t].DBColumnName&&"NetSalary"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[t].DBColumnName&&"AnnualCTC"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[t].DBColumnName||y.e.StringIsNullOrEmpty(this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[t].Text)||(a+=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[t].DBColumnName+"="+this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[t].Text.toString().Replace(",","")+","));if(null!=this.dgvPayrollEar&&null!=this.dgvPayrollEar&&null!=this.dgvPayrollEar.Table&&this.dgvPayrollEar.Table.length>0)for(let t=0;t<this.dgvPayrollEar.Table.length;t++)y.e.StringIsNullOrEmpty(this.dgvPayrollEar.Table[t].EarSNo)||y.e.StringIsNullOrEmpty(this.dgvPayrollEar.Table[t].EarValue.toString().trim())||(a+="Earning"+this.dgvPayrollEar.Table[t].EarSNo+"="+this.dgvPayrollEar.Table[t].EarValue.toString().Replace(",","")+",");if(null!=this.dgvPayrollAccrual&&null!=this.dgvPayrollAccrual&&null!=this.dgvPayrollAccrual.Table&&this.dgvPayrollAccrual.Table.length>0)for(let t=0;t<this.dgvPayrollAccrual.Table.length;t++)y.e.StringIsNullOrEmpty(this.dgvPayrollAccrual.Table[t].EarSNo)||(a+="Earning"+this.dgvPayrollAccrual.Table[t].EarSNo+"="+this.dgvPayrollAccrual.Table[t].EarValue.toString().Replace(",","")+",");if(null!=this.dgvPayrollDed&&null!=this.dgvPayrollDed.Table&&this.dgvPayrollDed.Table.length>0)for(let t=0;t<this.dgvPayrollDed.Table.length;t++)y.e.StringIsNullOrEmpty(this.dgvPayrollDed.Table[t].DedSNo)||y.e.StringIsNullOrEmpty(this.dgvPayrollDed.Table[t].DedValue.toString().trim())||(a+="Deduction"+this.dgvPayrollDed.Table[t].DedSNo+"="+this.dgvPayrollDed.Table[t].DedValue.toString().Replace(",","")+",");this.objEmp.WID=this.ScreenObject.CheckWorkFlow(),this.objEmp.PayQuery=a,this.objEmp.dsPayStructure=this.dsPayStructure,this.objEmp.IDHistoryXML=this.ScreenObject.GetIdentityControlsDataXML(),this.objEmp.PaymentModeXML=this.ScreenObject.GetPaymentModeDataXML(),this.objEmp.IsImport=!1;let l=0;this.objEmp.SaveEmpMaster("","SaveEmpMaster").subscribe(e=>{if(this.DisplayMessage=e.Message,this.RetValue=e.RetValue,l=e.RetValue,this.RetValue>0){b.a.SessionManager.GetEmpWhere(),this.DisplayName="Add "+this.ScreenName,this.ClearScreen();let e=this.ScreenObject.Data.Tables[5].filter(e=>"ShowCurrentSavedData"==e.Name);e.length>0&&!y.e.IsEmpty(e[0].Value)&&Object(d.j)(e[0].Value)&&(this.NodeID=this.RetValue,this.FillControls())}},e=>{console.log("Employee Master Save : "+JSON.stringify(e))}),this.MessageVisibility=!0,b.a.SessionManager.Logger.InfoLog("AddEditEmpMasterViewModel::Exiting OnSaveEmployee")}catch(t){b.a.SessionManager.Logger.ErrorLog("AddEditEmpMasterViewModel:: OnSaveEmployee")}}else if("Appraisal"==e.toString())this.Appraisal_Click();else if("MouseDown"==e.toString());else if("DeletePhoto"==e.toString())confirm("Are you sure you want to delete Image?")&&(this.IsPhotoDelete=!0,this.AccountPhoto="",this.DialogResult=!1,this.ActualFileName="",this.IsPhotoChanged=!1,this.PhotoTextVisibility=!0,this.DisplayMessage="");else if("UploadPhoto"==e.toString()){let e=new B.a;e.PopupAttachmentsViewModel_1(this.CostCenterID,this.NodeID,this),b.a.page.ShowDialog(e,G.a,{ShowCenter:!0,Title:"Add Images"})}else if("PopUp"==e.toString()){let e="";this.dsEdit&&null!=this.dsEdit&&this.dsEdit.Tables[3].filter(e=>"jpg"==e.FileExtension||"png"==e.FileExtension).forEach(t=>{e+=y.e.GetPath(t.GUID.toString()+"."+t.FileExtension.toString())+";"})}else"Print"==e.toString()?this.btnPrint_Click():"PrintPreview"==e.toString()&&this.btnPrintPreview_Click()}ClearScreen(){this.AccountPhoto="",this.PhotoTextVisibility=!0;let e=this.EmpGroup.SelectedValue;this.ScreenObject.Clear(),this.ViewAddress.ContactsListObj.Clear(),this.ViewContacts.grData.Clear(),this.ViewContacts.DeletedContacts.Clear(),this.ViewNotes.NotesListObj.Clear(),this.ViewNotes.DeletedNotes.Clear(),this.ViewAttachments.AttachmentsListObj.Clear(),this.ViewCCMapping.Clear(),this.ViewAddress.DeletedAddress.Clear(),this.ViewAttachments.DeletedAttachments.Clear(),this.ViewCCMapping.OnShowCC(null),this.ViewAttachments.OnShowNewAttachment(null),this.EmpGroup.SelectedValue=e,this.IsPhotoDelete=!1,this.dsEdit=null,this.AutoGenerateCode(),this.NodeID=0,this.objEmp.NodeID=0,this.EmpName.SetFocus=!0,this.dtGrSalSalbs=null,this.ClearOtherControls()}RestrictSaveButton(){0==this.NodeID?b.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=b.a.SessionManager.IsActionAssigned(this.CostCenterID,"Create"):this.ButtonSave.Enable=b.a.SessionManager.IsActionAssigned(this.CostCenterID,"Create"):b.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=b.a.SessionManager.IsActionAssigned(this.CostCenterID,"Update"):this.ButtonSave.Enable=b.a.SessionManager.IsActionAssigned(this.CostCenterID,"Update"),b.a.SessionManager.IsRptManagerUser&&b.a.SessionManager.Preferences.ContainsKey("DontAllowRptMgrToEditSubordinateData")&&"TRUE"==b.a.SessionManager.Preferences.DontAllowRptMgrToEditSubordinateData.toUpperCase()&&b.a.SessionManager.UserName.Trim().toUpperCase()!=this.EmpCode.Text.Trim().toUpperCase()&&(b.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=!1:this.ButtonSave.Enable=!1)}GetAccountsLinkingXML(){if(null!=this.dgvAccLinking&&null!=this.dgvAccLinking&&null!=this.dgvAccLinking.Table&&this.dgvAccLinking.Table.length>0){let e="";e+="<Rows>",e+='<Row EmpSeqNo="'+this.NodeID+'" ComponentID="-301" Type="-301" SNo="'+-301,e+=null!=this.plBoxSalaryAccount&&null!=this.plBoxSalaryAccount?'" DebitAccountID="'+this.plBoxSalaryAccount.SelectedValue:'" DebitAccountID="0',e+='" CreditAccountID="0" />',e+='<Row EmpSeqNo="'+this.NodeID+'" ComponentID="-302" Type="-302" SNo="'+-302,e+=null!=this.plBoxPayableAccount&&null!=this.plBoxPayableAccount?'" DebitAccountID="'+this.plBoxPayableAccount.SelectedValue:'" DebitAccountID="0',e+='" CreditAccountID="0" />';for(let t=0;t<this.dgvAccLinking.Table.length;t++)y.e.StringIsNullOrEmpty(this.dgvAccLinking.Table[t].ComponentName)||y.e.StringIsNullOrEmpty(this.dgvAccLinking.Table[t].DebitAccountID_Key)&&y.e.StringIsNullOrEmpty(this.dgvAccLinking.Table[t].CreditAccountID_Key)||(e+='<Row EmpSeqNo="'+this.NodeID+'" ComponentID="'+this.dgvAccLinking.Table[t].ComponentID.toString()+'" Type="'+this.dgvAccLinking.Table[t].ComponentType.toString()+'" SNo="'+this.dgvAccLinking.Table[t].ComponentSNO.toString(),y.e.StringIsNullOrEmpty(this.dgvAccLinking.Table[t].DebitAccountID_Key)?e+='" DebitAccountID="0':e+='" DebitAccountID="'+this.dgvAccLinking.Table[t].DebitAccountID_Key.toString(),y.e.StringIsNullOrEmpty(this.dgvAccLinking.Table[t].CreditAccountID_Key)?e+='" CreditAccountID="0':e+='" CreditAccountID="'+this.dgvAccLinking.Table[t].CreditAccountID_Key.toString(),e+='" />');return e+="</Rows>",e}return""}OnDeleteCallBack(){}Appraisal_Click(){this.NodeID>0?(this.AddeditAppraisalViewmodel=new L.a(this,this.NodeID,this.dtpNextAppraisal.Date,0),b.a.page.ShowDialog(this.AddeditAppraisalViewmodel,O.a,{ShowCenter:!0,Title:this.AddeditAppraisalViewmodel.Title})):(this.DisplayMessage="Select any Employee",this.MessageVisibility=!0)}btnPrint_Click(){this.NodeID>0?this.PrintEmployee():(this.DisplayMessage="",this.MessageVisibility=!0)}btnPrintPreview_Click(){this.NodeID>0?this.PrintEmployee():(this.DisplayMessage="",this.MessageVisibility=!0)}PrintEmployee(){this.MoreThanOneLayout=!1;let e=this.NodeID;this.IsExportPrint=!1;let t=null,i=R.VoucherExportExcel.GetLocationPrintLayouts(this.CostCenterID,0,e);if(this.IsExportPrint)t=null;else{if(null==i||0==i.Tables[0].length)return b.a.GetResource("Err_PrintLayoutNotDefined");if(i.Tables[0].length>1){this.MoreThanOneLayout=!0;let s=new k.VPTDialogViewModel(i.Tables[0]);b.a.page.ShowDialog(s,j.VPTDialogComponent,{ShowCenter:!0},()=>{s.IsOkClicked&&(t=s.SelectedRow),null!=t&&b.a.report.ExportPDF_Masters(this.CostCenterID,e.toString(),parseInt(t.DocPrintLayoutID),"PDF").subscribe(e=>{b.a.SessionManager.printTab(e.FileName),y.e.IsEmpty(e.Message)&&!y.e.IsEmpty(e.FileName)&&(this.DisplayMessage="Printed Sucessfully")},e=>{this.DisplayMessage="Error in Preview",console.log(e)})})}else t=i.Tables[0][0]}this.dsTotLayouts=i,this.drSelPrintLayout=t,null==t||this.MoreThanOneLayout||b.a.report.ExportPDF_Masters(this.CostCenterID,e.toString(),parseInt(t.DocPrintLayoutID),"PDF").subscribe(e=>{console.log(e),b.a.SessionManager.Download(e.FileName,"abcd"),b.a.SessionManager.printTab(e.FileName),y.e.IsEmpty(e.Message)&&!y.e.IsEmpty(e.FileName)&&(this.DisplayMessage="printed Successfully")},e=>{this.DisplayMessage="Error in Preview",console.log(e)})}ClearOtherControls(){if(this.ViewEmpDocuments.GridListObj.Clear(),this.LoadPayrollGrid(),this.LoadAppraisalGrid(),this.LoadAccountLinkingGrid(),this.dgvPayrollEar.Columns[2].footer=(0).ToString(this.sDecimalsAmount),this.dgvPayrollDed.Columns[2].footer=(0).ToString(this.sDecimalsAmount),this.dgvPayrollEar.UpdateFooter(),this.dgvPayrollDed.UpdateFooter(),this.ProbationDays.Text=!y.e.StringIsNullOrEmpty(b.a.SessionManager.Preferences.DefaultProbationDays)&&parseInt(b.a.SessionManager.Preferences.DefaultProbationDays)>0?b.a.SessionManager.Preferences.DefaultProbationDays:"0",this.ProbationDays_LostFocus(this.ProbationDays),this.Status.SelectedValue=""!=b.a.SessionManager.Preferences.DefaultEmpStatus?b.a.SessionManager.Preferences.DefaultEmpStatus:"250",null!=this.txtVacDaysPerMonth&&(this.txtVacDaysPerMonth.Currency.SelectedValue=b.a.SessionManager.Preferences.DefVacationDaysMonthlyOrYearly,this.txtVacDaysPerMonth.ExchangeRate.Text=b.a.SessionManager.Preferences.DefVacationDays),this.ScreenObject.CustomTab.Pages.length>0)for(let e=0;e<this.ScreenObject.CustomTab.Pages.length;e++){const t=this.ScreenObject.CustomTab.Pages[e];for(let e=0;e<t.Fields.length;e++){const i=t.Fields[e];if(i instanceof l.b&&("CheckInOutDevice"==i.DBColumnName||"AttSetDimNodes"==i.DBColumnName))for(let e=0;e<i.Items.length;e++)i.Items[e].IsChecked=!1;i instanceof _.a&&(i.IsChecked=!1)}}if(b.a.SessionManager.Preferences.ContainsKey("DisableEmployeePayrollTabafterPayrollProcessed")&&"True"==b.a.SessionManager.Preferences.DisableEmployeePayrollTabafterPayrollProcessed){for(let e=0;e<this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields.length;e++)this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[e]instanceof c.c&&("BasicMonthly"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[e].DBColumnName&&"BasicWeekly"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[e].DBColumnName&&"BasicDaily"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[e].DBColumnName&&"BasicHourly"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[e].DBColumnName&&"NetSalary"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[e].DBColumnName&&"AnnualCTC"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[e].DBColumnName||(this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[e].IsReadOnly=!1));this.dgvPayrollEar.IsReadOnly=!1,this.dgvPayrollDed.IsReadOnly=!1,this.dgvPayrollAccrual.IsReadOnly=!1}this.RestrictSaveButton()}AttSetTypeCheckedChanged(e){this.GetScreenControl("AttSetDimNodes").Enable="Dimension"==e.DBColumnName}}class U{constructor(){this.ButtonClick=new c.b,this.DisplayMessage="",this.MessageVisibility=!1,this.CostCenterID=0,this.sDBColumnName="",this.sUserColumnName="",this.dsData=null,this.drLastRow=null,this.IsIdentity=!1,this.IsPaymentMode=!1}PayIdentityGridViewModel_3(e,t,i){this.CostCenterID=e,this.sDBColumnName=t,""!=i&&(this.dsData=new y.f,this.dsData.ReadXml(i)),this.ButtonClick.Subscribe(this,"OnButtonClick"),this.dgv=new g.a,this.dgv.OnBeginEdit.Subscribe(this,"dgv_BeginEdit"),this.dgv.OnCellEditEnding.Subscribe(this,"dgv_EndEdit"),this.dgv.CanUserAddRows=!0,this.dgv.Width="",this.dgv.Table=[],50051==e&&("PassportNo"==t||"VisaNo"==t||"IqamaNo"==t||"ContractNo"==t||"IDNo"==t||"LicenseNo"==t||"MedicalNo"==t?(this.IsIdentity=!0,this.Title=t.substring(0,t.length-2)+" Details - History",this.dgv.TableColumns.push("SNo"),this.dgv.TableColumns.push("Number"),this.dgv.TableColumns.push("IssDate"),this.dgv.TableColumns.push("IssDate_Key"),this.dgv.TableColumns.push("ExpDate"),this.dgv.TableColumns.push("ExpDate_Key"),"ContractNo"==t&&(this.dgv.TableColumns.push("ExtendDate"),this.dgv.TableColumns.push("ExtendDate_Key"))):"PaymentMode"==t&&(this.IsPaymentMode=!0,this.Title="Payment Modes",this.dgv.TableColumns.push("SNo"),this.dgv.TableColumns.push("PaymentMode"),this.dgv.TableColumns.push("PaymentMode_Key"),this.dgv.TableColumns.push("iBank"),this.dgv.TableColumns.push("iBank_Key"),this.dgv.TableColumns.push("BankBranch"),this.dgv.TableColumns.push("BankRoutingCode"),this.dgv.TableColumns.push("BankAgentCode"),this.dgv.TableColumns.push("BankAccNo"),this.dgv.TableColumns.push("IBANNo"),this.dgv.TableColumns.push("StatusID")));let s=[],a=new D.a;if(a.Header="#",a.DisplayMember="SNo",a.ID="SNo",a.Width=30,a.ReadOnly=!0,s.push(a),this.IsIdentity)a=new D.a,a.Header="Number",a.DisplayMember="Number",a.ID="Number",a.Width=220,s.push(a),a=new D.a,a.Header="Iss. Date",a.DisplayMember="IssDate",a.DataType="DATE",a.Width=120,s.push(a),a=new D.a,a.Header="Exp. Date",a.DisplayMember="ExpDate",a.DataType="DATE",a.Width=120,s.push(a),"ContractNo"==t&&(a=new D.a,a.Header="Extend Date",a.DisplayMember="ExtendDate",a.DataType="DATE",a.Width=120,s.push(a));else if(this.IsPaymentMode){a=new D.a,a.Header="Mode of Payment",a.ValueBinding="PaymentMode",a.DataType="ComboBox",a.DisplayMember="Name",a.ValueMember="Value",a.Width=150;let e=new Array;e.push(l.d.ComboBoxItems_2("Cash","Cash")),e.push(l.d.ComboBoxItems_2("Cheque","Cheque")),e.push(l.d.ComboBoxItems_2("Bank Transfer","Bank Transfer")),e.push(l.d.ComboBoxItems_2("Demand Draft","Demand Draft")),a.ComboData=e,s.push(a),a=new D.a,a.Header="Bank Name",a.DisplayMember="iBank",a.DataType="LISTBOX",a.CostCenterID=50068,a.TypeID=1,a.Width=150,s.push(a),a=new D.a,a.Header="Bank Branch",a.DisplayMember="BankBranch",a.DataType="TextBlock",a.Width=120,a.ReadOnly=!0,s.push(a),a=new D.a,a.Header="Bank Routing Code",a.DisplayMember="BankRoutingCode",a.DataType="TextBlock",a.Width=120,a.ReadOnly=!0,s.push(a),a=new D.a,a.Header="Bank Agent Code",a.DisplayMember="BankAgentCode",a.DataType="TextBlock",a.Width=120,a.ReadOnly=!0,s.push(a),a=new D.a,a.Header="Bank Account No.",a.DisplayMember="BankAccNo",a.DataType="TextBlock",a.Width=120,s.push(a),a=new D.a,a.Header="IBAN Number",a.DisplayMember="IBANNo",a.DataType="TextBlock",a.Width=120,s.push(a),a=new D.a,a.Header="Status",a.ValueBinding="StatusID",a.DataType="ComboBox",a.DisplayMember="Name",a.ValueMember="Value",a.Width=100,e=new Array,e.push(l.d.ComboBoxItems_2("Active","1")),e.push(l.d.ComboBoxItems_2("Inactive","2")),a.ComboData=e,s.push(a)}this.dgv.Columns=s,this.Clear(),null!=this.dsData&&null!=this.dsData.Tables&&this.dsData.Tables[0].length>0&&this.Load(this.dsData.Tables[0],this.dsData.Columns[0])}dgv_BeginEdit(e,t,i){return!(!this.IsPaymentMode||"iBank"!=t&&"BankAccNo"!=t&&"IBANNo"!=t||!y.e.IsEmpty(e.PaymentMode)&&"Bank Transfer"==e.PaymentMode.toString())}dgv_EndEdit(e,t,i){try{if(this.IsPaymentMode&&"iBank"==t&&!y.e.IsEmpty(e.iBank_Key)){let t=parseInt(e.iBank_Key),i=b.a.common.GetDataSet("AEEMP004",t.toString());null!=i&&i.Tables.length>0&&i.Tables[0].length>0&&(e.BankBranch=i.Tables[0][0].ccAlpha2.toString(),e.BankRoutingCode=i.Tables[0][0].ccAlpha8.toString(),e.BankAgentCode=i.Tables[0][0].ccAlpha7.toString()),this.dgv.updateRow(e)}}catch(s){}}OnButtonClick(e){if("Cancel"==e)this.DialogResult=!1;else if("OK"==e){if(this.IsIdentity)for(let e=0;e<this.dgv.Table.length;e++){if(!y.e.IsEmpty(this.dgv.Table[e].Number)&&""!=this.dgv.Table[e].Number.toString().Trim()&&!y.e.IsEmpty(this.dgv.Table[e].IssDate_Key)&&this.dgv.Table[e].IssDate_Key.toString().length>0&&!y.e.IsEmpty(this.dgv.Table[e].ExpDate_Key)&&this.dgv.Table[e].ExpDate_Key.toString().length>0&&new Date(this.dgv.Table[e].IssDate_Key)>new Date(this.dgv.Table[e].ExpDate_Key))return this.DisplayMessage="ExpDate Should be greater than IssDate",void(this.MessageVisibility=!0);let t=this.GetLastConsideredRow(e);if(e>0&&t>-1&&!y.e.IsEmpty(this.dgv.Table[t].ExpDate_Key)&&!y.e.IsEmpty(this.dgv.Table[e].IssDate_Key)&&new Date(this.dgv.Table[e].IssDate_Key)<new Date(this.dgv.Table[t].ExpDate_Key))return this.DisplayMessage="IssDate Should be greater than "+new Date(this.dgv.Table[t].ExpDate_Key).ToString("dd MMM yyyy"),void(this.MessageVisibility=!0)}else if(this.IsPaymentMode){let e=0,t=0;for(let i=0;i<this.dgv.Table.length;i++)y.e.IsEmpty(this.dgv.Table[i].PaymentMode)||""==this.dgv.Table[i].PaymentMode.toString().Trim()||(t++,y.e.IsEmpty(this.dgv.Table[i].StatusID)||"1"!=this.dgv.Table[i].StatusID.toString()||(e++,1==e&&(this.drLastRow=this.dgv.Table[i])));if(0==t)return this.DisplayMessage="Enter atlest one Payment Mode",void(this.MessageVisibility=!0);if(0==e)return this.DisplayMessage="Set atleast one Payment Mode as Active",void(this.MessageVisibility=!0);if(e>1)return this.DisplayMessage="You can not set morethan one Payment Mode as Active",void(this.MessageVisibility=!0);for(let i=0;i<this.dgv.Table.length;i++)if(!y.e.IsEmpty(this.dgv.Table[i].PaymentMode)&&"Bank Transfer"==this.dgv.Table[i].PaymentMode.toString().Trim()&&y.e.IsEmpty(this.dgv.Table[i].iBank_Key))return this.DisplayMessage="Select Bank Name at Row No. "+(i+1),void(this.MessageVisibility=!0)}this.DialogResult=!0}b.a.page.HideDialog()}Load(e,t=null){this.dgv.Table.Clear();for(let s=0;s<e.length;s++){let i=this.dgv.NewRow();if(i.SNo=s+1,this.IsIdentity)i.Number=e[s].Number,t.Contains("IssDate")&&!y.e.IsEmpty(e[s].IssDate)&&(i.IssDate=new Date(e[s].IssDate).ToString(b.a.SessionManager.Preferences["Date Format"]),i.IssDate_Key=new Date(e[s].IssDate)),t.Contains("ExpDate")&&!y.e.IsEmpty(e[s].ExpDate)&&(i.ExpDate=new Date(e[s].ExpDate).ToString(b.a.SessionManager.Preferences["Date Format"]),i.ExpDate_Key=new Date(e[s].ExpDate)),t.Contains("ExtendDate")&&!y.e.IsEmpty(e[s].ExtendDate)&&(i.ExtendDate=new Date(e[s].ExtendDate).ToString(b.a.SessionManager.Preferences["Date Format"]),i.ExtendDate_Key=new Date(e[s].ExtendDate));else if(this.IsPaymentMode){if(i.PaymentMode=e[s].PaymentMode,i.iBank_Key=e[s].iBank.toString(),!y.e.IsEmpty(i.iBank_Key)&&""!=i.iBank_Key.toString().Trim()&&parseInt(i.iBank_Key)>0){let e=b.a.common.GetDataSet("AEEMP004",i.iBank_Key.toString());null!=e&&e.Tables.length>0&&e.Tables[0].length>0&&(i.BankBranch=e.Tables[0][0].ccAlpha2.toString(),i.BankRoutingCode=e.Tables[0][0].ccAlpha8.toString(),i.BankAgentCode=e.Tables[0][0].ccAlpha7.toString())}i.BankAccNo=e[s].BankAccNo.toString(),i.IBANNo=e[s].IBANNo.toString(),i.StatusID=e[s].StatusID}this.dgv.addRow(i)}let i;this.dgv.RefreshGrid=!0;for(let s=0;s<10;s++)i=this.dgv.NewRow(),i.SNo=e.length+s+1,this.dgv.addRow(i)}Clear(){let e;this.dgv.Table.Clear();for(let t=0;t<10;t++)e=this.dgv.NewRow(),e.SNo=t+1,this.dgv.addRow(e)}GetXML(){let e="",t=0;return this.dgv.Table.forEach(i=>{if(50051==this.CostCenterID)if(t++,this.IsIdentity){if(!y.e.IsEmpty(i.Number)){e+='<Row Number="'+i.Number.toString()+'"',!y.e.IsEmpty(i.IssDate_Key)&&i.IssDate_Key.toString().length>0&&(e+=' IssDate="'+new Date(i.IssDate_Key).ToString("dd MMM yyyy")+'"',!y.e.IsEmpty(i.ExpDate_Key)&&i.ExpDate_Key.toString().length>0&&(e+=' ExpDate="'+new Date(i.ExpDate_Key).ToString("dd MMM yyyy")+'"'),"ContractNo"==this.sDBColumnName&&!y.e.IsEmpty(i.ExtendDate_Key)&&i.ExtendDate_Key.toString().length>0&&(e+=' ExtendDate="'+new Date(i.ExtendDate_Key).ToString("dd MMM yyyy")+'"'));let s="";"PassportNo"==this.sDBColumnName?s="-51001":"VisaNo"==this.sDBColumnName?s="-51002":"IqamaNo"==this.sDBColumnName?s="-51003":"ContractNo"==this.sDBColumnName?s="-51004":"IDNo"==this.sDBColumnName?s="-51005":"LicenseNo"==this.sDBColumnName?s="-51006":"MedicalNo"==this.sDBColumnName&&(s="-51007"),e+=' DType="'+s+'"',e+=' sDType="'+this.sDBColumnName.substring(0,this.sDBColumnName.length-2)+'"',e+=' SNo="'+t+'"',e+="/>",this.drLastRow=i}}else this.IsPaymentMode&&(y.e.IsEmpty(i.PaymentMode)||""==i.PaymentMode.toString().Trim()||(e+='<Row PaymentMode="'+i.PaymentMode.toString()+'"',!y.e.IsEmpty(i.iBank_Key)&&i.iBank_Key.toString().length>0?e+=' iBank="'+i.iBank_Key.toString()+'"':e+=' iBank="0"',!y.e.IsEmpty(i.BankAccNo)&&i.BankAccNo.toString().length>0?e+=' BankAccNo="'+i.BankAccNo.toString()+'"':e+=' BankAccNo=""',!y.e.IsEmpty(i.IBANNo)&&i.IBANNo.toString().length>0?e+=' IBANNo="'+i.IBANNo.toString()+'"':e+=' IBANNo=""',!y.e.IsEmpty(i.StatusID)&&i.StatusID.toString().length>0?e+=' StatusID="'+i.StatusID.toString()+'"':e+=' StatusID="2"',e+=' DType="-51011"',e+=' sDType="PaymentMode"',e+=' SNo="'+t+'"',e+="/>",!y.e.IsEmpty(i.StatusID)&&i.StatusID.toString().length>0&&"1"==i.StatusID.toString()&&(this.drLastRow=i)))}),e.length>0&&(e="<XML>"+e+"</XML>"),e.toString()}GetLastConsideredRow(e){for(let t=e-1;t>=0;t--)if(!y.e.IsEmpty(this.dgv.Table[t].Number))return t;return-1}}},wJuo:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var s=i("Do2H"),a=i("Lp6j"),l=i("eQJW"),n=i("4HhE"),o=i("OvA8"),r=i("xnJf");class h{constructor(){this.parent=null,this.SubmitClick=new n.b,this._AttachmentVisibility=!1,this.ClassName="PopupAttachmentsViewModel"}get ProductPhoto(){return this._ProductPhoto}set ProductPhoto(e){e!=this._ProductPhoto&&(this._ProductPhoto=e)}get AttachmentVisibility(){return this._AttachmentVisibility}set AttachmentVisibility(e){e!=this._AttachmentVisibility&&(this._AttachmentVisibility=e)}get Attachment(){return this._Attachment}set Attachment(e){e!=this._Attachment&&(this._Attachment=e)}get ViewAttachments(){return this._ViewAttachments}set ViewAttachments(e){e!=this._ViewAttachments&&(this._ViewAttachments=e)}OnShowAttachment(){Logger.InfoLog("AddProductViewModel::Entering OnShowAttachment"),Logger.InfoLog("AddProductViewModel::Exiting OnShowAttachment")}OnAddAttachment(){Logger.InfoLog("AddProductViewModel::Entering AddAttachment"),this.Attachment=new r.AddAttachmentViewModel,this.Attachment.AddAttachmentViewModel_2(this),Logger.InfoLog("AddProductViewModel::Entering AddAttachment")}PopupAttachmentsViewModel_1(e,t,i){var s,n,h;this.parent=i,this.AttachmentVisibility=!0,this.OnAddAttachment(),this.CostCenterID=e,this.NID=t,this._ViewAttachments=new o.ViewAttachmentViewModel(this),this.SubmitClick.Subscribe(this,"ListAttachments");let d=0,c="",u="";if("AddProductScreenViewModel"==(null===(s=this.parent)||void 0===s?void 0:s.ClassName)?(d=i.FileID,c=i.ProductPhoto,u=i.FileDescription):"AddEditAccountViewModel"==(null===(n=this.parent)||void 0===n?void 0:n.ClassName)||"AddUsersViewModel"==(null===(h=this.parent)||void 0===h?void 0:h.ClassName)?(d=i.FileID,c=i.AccountPhoto):(d=this.parent.FileID,c=this.parent.AccountPhoto,u=this.parent.FileDescription),null!=i){if(!a.e.IsEmpty(c)){let e=new r.AddAttachmentViewModel;if(e.AddAttachmentViewModel_2(this),e.AttachmentID=d,d>0){let t=null;"AddProductScreenViewModel"==this.parent.ClassName||"AddEditAccountViewModel"==this.parent.ClassName?t=i.ds.Tables[4].filter(e=>e.FileID==d):"AddUsersViewModel"==this.parent.ClassName||"AddCostCenterViewModel"==this.parent.ClassName?t=this.parent.ds.Tables[3].filter(e=>e.FileID==d):"AddEditEmpMasterViewModel"==this.parent.ClassName?t=this.parent.dsEdit.Tables[3].filter(e=>e.FileID==d):"AddEditPropertyViewModel"==i.ClassName?t=i.ds.Tables[18].filter(e=>e.FileID==d):"AddEditUnitsViewModel"==i.ClassName?t=i.ds.Tables[6].filter(e=>e.FileID==d):"AddEditTenantViewModel"==i.ClassName&&(t=i.Dset.Tables[4].filter(e=>e.FileID==d)),t.length>0&&(e.ActualFileName=t[0].ActualFileName.toString(),e.FileExtension=t[0].FileExtension.toString(),e.FileDescription=t[0].FileDescription.toString(),e.FilePath="",e.Guid=t[0].GUID.toString(),e.RelativeFileName=t[0].RelativeFileName.toString(),e.MainFilePath=t[0].FilePath.toString(),e.IsProductImage=!0,e.IsDefaultImage=!0,e.IsDefaultImageVisible=!0,e.CancelVisible=!1,e.Guid=t[0].GUID.toString(),a.e.hasprop(t[0],"HasThumb")&&(e.HasThumb=Object(l.j)(t[0].HasThumb)))}else{e.FilePath=c,e.MainFilePath=c,e.RelativeFileName=c,e.ActualFileName=e.FilePath.substr(e.FilePath.lastIndexOf("\\")+1);let t=e.FilePath.split("."),i="";t.length>1&&(i=t[t.length-1]),e.FileExtension=i,e.FileDescription=u,e.IsProductImage=!0,e.IsDefaultImage=!0,e.IsDefaultImageVisible=!0,e.CancelVisible=!1,e.Guid=this.parent.guid}this.ViewAttachments.AttachmentsList.push(e)}let e=[];(a.e.IsType(i,"IAttachment")||a.e.hasprop(i,"ViewAttachments"))&&(e=this.parent.ViewAttachments.AttachmentsList),e.forEach(e=>{if(e.IsProductImage){let t=new r.AddAttachmentViewModel;t.AddAttachmentViewModel_2(this),t.AttachmentID=e.AttachmentID,t.ActualFileName=e.ActualFileName,t.FileExtension=e.FileExtension,t.FileDescription=e.FileDescription,t.MainFilePath=e.MainFilePath,t.FilePath=e.FilePath,t.Guid=e.guid,t.RelativeFileName=e.RelativeFileName,t.IsProductImage=e.IsProductImage,t.IsDefaultImage=e.IsDefaultImage,t.IsDefaultImageVisible=!0,t.HasThumb=e.HasThumb,this.ViewAttachments.AttachmentsList.push(t)}})}}ListAttachments(e){if("Submit"==e.toString()){if("AddProductScreenViewModel"==this.parent.ClassName){let e=0;this.ViewAttachments.AttachmentsList.forEach(t=>{var i=this.parent.ViewAttachments.AttachmentsList.filter(e=>e.RelativeFileName==t.RelativeFileName);t.IsDefaultImage?(e++,null!=i&&i.length>0&&this.parent.ViewAttachments.AttachmentsList.Remove(i),(a.e.IsEmpty(t.FilePath)||this.parent.ProductPhoto==t.FilePath)&&this.parent.ProductPhoto.Contains(a.e.GetPath(t.guid+"."+t.FileExtension))||(this.parent.FileID=t.AttachmentID,this.parent.ProductPhoto=a.e.IsEmpty(t.guid)?t.FilePath:a.e.GetPath(t.guid+"."+t.FileExtension),this.parent.ActualFileName=t.ActualFileName,this.parent.ThumbnailPhoto=t.ThumbnailPhoto,this.parent.guid=t.guid,this.parent.Guid=t.guid,this.parent.FileExtension=t.FileExtension,this.parent.IsPhotoChanged=!0,this.parent.PhotoTextVisibility=!1,this.parent.DisplayMessage="",this.parent.MessageVisibility=!1,this.parent.FileDescription=t.FileDescription),t.IsModified=!0):null==i||0==i.length?(t.AttachmentID>0?(t.IsModified=!0,null!=(i=this.parent.ViewAttachments.AttachmentsList.filter(e=>e.AttachmentID==t.AttachmentID))&&this.parent.ViewAttachments.AttachmentsList.Remove(i)):(t.IsModified=!1,t._Flg=!0),this.parent.ViewAttachments.AttachmentsList.push(t)):(i.FileDescription=t.FileDescription,i.IsModified=!0)}),0==e&&(this.parent.ProductPhoto="",this.parent.ActualFileName="",this.parent.ThumbnailPhoto="",this.parent.IsPhotoChanged=!1,this.parent.IsPhotoDelete=!1,this.parent.DialogResult=!1,this.parent.PhotoTextVisibility=!0,this.parent.DisplayMessage="",this.parent.FileDescription=""),this.ViewAttachments.DeletedAttachments.forEach(e=>{this.parent.ViewAttachments.DeletedAttachments.push(e);let t=this.parent.ViewAttachments.AttachmentsList.find(t=>t.AttachmentID==e.AttachmentID);null!=t&&this.parent.ViewAttachments.AttachmentsList.Remove(t)})}else if("AddEditAccountViewModel"==this.parent.ClassName){let e=0;this.ViewAttachments.AttachmentsList.forEach(t=>{var i=this.parent.ViewAttachments.AttachmentsList.filter(e=>e.RelativeFileName==t.RelativeFileName);t.IsDefaultImage?(e++,null!=i&&i.length>0&&this.parent.ViewAttachments.AttachmentsList.Remove(i),(a.e.IsEmpty(t.FilePath)||this.parent.AccountPhoto==t.FilePath)&&this.parent.AccountPhoto.Contains(a.e.GetPath(t.guid+"."+t.FileExtension))||(this.parent.FileID=t.AttachmentID,this.parent.AccountPhoto=a.e.IsEmpty(t.guid)?t.FilePath:a.e.GetPath(t.guid+"."+t.FileExtension),this.parent.ActualFileName=t.ActualFileName,this.parent.guid=t.guid,this.parent.Guid=t.guid,this.parent.FileExtension=t.FileExtension,this.parent.IsPhotoChanged=!0,this.parent.PhotoTextVisibility=!1,this.parent.DisplayMessage="",this.parent.MessageVisibility=!1),t.IsModified=!0):null==i||0==i.length?(t.AttachmentID>0?(t.IsModified=!0,null!=(i=this.parent.ViewAttachments.AttachmentsList.filter(e=>e.AttachmentID==t.AttachmentID))&&this.parent.ViewAttachments.AttachmentsList.Remove(i)):(t.IsModified=!1,t._Flg=!0),this.parent.ViewAttachments.AttachmentsList.push(t)):(i.FileDescription=t.FileDescription,i.IsModified=!0)}),0==e&&(this.parent.AccountPhoto="",this.parent.ActualFileName="",this.parent.IsPhotoChanged=!1,this.parent.IsPhotoDelete=!1,this.parent.PhotoTextVisibility=!0,this.parent.DisplayMessage=""),this.ViewAttachments.DeletedAttachments.forEach(e=>{this.parent.ViewAttachments.DeletedAttachments.push(e);let t=this.parent.ViewAttachments.AttachmentsList.filter(t=>t.AttachmentID==e.AttachmentID);null!=t&&this.parent.ViewAttachments.AttachmentsList.Remove(t)})}else if("AddUsersViewModel"==this.parent.ClassName){let e=0;this.ViewAttachments.AttachmentsList.forEach(t=>{var i=this.parent.ViewAttachments.AttachmentsList.filter(e=>e.RelativeFileName==t.RelativeFileName);t.IsDefaultImage?(e++,null!=i&&i.length>0&&this.parent.ViewAttachments.AttachmentsList.Remove(i),(a.e.IsEmpty(t.FilePath)||this.parent.AccountPhoto==t.FilePath)&&this.parent.AccountPhoto.Contains(a.e.GetPath(t.guid+"."+t.FileExtension))||(this.parent.FileID=t.AttachmentID,this.parent.AccountPhoto=a.e.IsEmpty(t.guid)?t.FilePath:a.e.GetPath(t.guid+"."+t.FileExtension),this.parent.ActualFileName=t.ActualFileName,this.parent.IsPhotoChanged=!0,this.parent.PhotoTextVisibility=!1,this.parent.DisplayMessage="",this.parent.MessageVisibility=!1),t.IsModified=!0):null==i||0==i.length?(t.AttachmentID>0?(t.IsModified=!0,null!=(i=this.parent.ViewAttachments.AttachmentsList.filter(e=>e.AttachmentID==t.AttachmentID))&&this.parent.ViewAttachments.AttachmentsList.Remove(i)):(t.IsModified=!1,t._Flg=!0),this.parent.ViewAttachments.AttachmentsList.push(t)):(i.FileDescription=t.FileDescription,i.IsModified=!0)}),0==e&&(this.parent.AccountPhoto="",this.parent.ActualFileName="",this.parent.IsPhotoChanged=!1,this.parent.IsPhotoDelete=!1,this.parent.DialogResult=!1,this.parent.PhotoTextVisibility=!0,this.parent.DisplayMessage=""),this.ViewAttachments.DeletedAttachments.forEach(e=>{this.parent.ViewAttachments.DeletedAttachments.push(e);let t=this.parent.ViewAttachments.AttachmentsList.find(t=>t.AttachmentID==e.AttachmentID);t&&this.parent.ViewAttachments.AttachmentsList.Remove(t)})}else if("AddCostCenterViewModel"==this.parent.ClassName){let e=0;this.ViewAttachments.AttachmentsList.forEach(t=>{var i=this.parent.ViewAttachments.AttachmentsList.filter(e=>e.RelativeFileName==t.RelativeFileName);t.IsDefaultImage?(e++,null!=i&&i.length>0&&this.parent.ViewAttachments.AttachmentsList.Remove(i),(a.e.IsEmpty(t.FilePath)||this.parent.AccountPhoto==t.FilePath)&&this.parent.AccountPhoto.Contains(a.e.GetPath(t.guid))||(this.parent.FileID=t.AttachmentID,this.parent.AccountPhoto=a.e.IsEmpty(t.guid)?t.FilePath:a.e.GetPath(t.guid),this.parent.ThumbnailPhoto=t.ThumbnailPhoto,this.parent.ActualFileName=t.ActualFileName,this.parent.guid=t.guid,this.parent.Guid=t.guid,this.parent.FileExtension=t.FileExtension,this.parent.IsPhotoChanged=!0,this.parent.PhotoTextVisibility=!1,this.parent.DisplayMessage="",this.parent.MessageVisibility=!1),t.IsModified=!0):null==i||0==i.length?(t.AttachmentID>0?(t.IsModified=!0,null!=(i=this.parent.ViewAttachments.AttachmentsList.filter(e=>e.AttachmentID==t.AttachmentID))&&this.parent.ViewAttachments.AttachmentsList.Remove(i)):(t.IsModified=!1,t._Flg=!0),this.parent.ViewAttachments.AttachmentsList.push(t)):(i.FileDescription=t.FileDescription,i.IsModified=!0)}),0==e&&(this.parent.AccountPhoto="",this.parent.ThumbnailPhoto="",this.parent.ActualFileName="",this.parent.IsPhotoChanged=!1,this.parent.IsPhotoDelete=!1,this.parent.PhotoTextVisibility=!0,this.parent.DisplayMessage=""),this.ViewAttachments.DeletedAttachments.forEach(e=>{this.parent.ViewAttachments.DeletedAttachments.push(e);let t=this.parent.ViewAttachments.AttachmentsList.find(t=>t.AttachmentID==e.AttachmentID);t&&this.parent.ViewAttachments.AttachmentsList.Remove(t)})}else if("AddEditEmpMasterViewModel"==this.parent.ClassName||"AddEditPropertyViewModel"==this.parent.ClassName||"AddEditUnitsViewModel"==this.parent.ClassName||"AddEditTenantViewModel"==this.parent.ClassName){let e=0;this.ViewAttachments.AttachmentsList.forEach(t=>{var i=this.parent.ViewAttachments.AttachmentsList.filter(e=>e.RelativeFileName==t.RelativeFileName);t.IsDefaultImage?(e++,null!=i&&this.parent.ViewAttachments.AttachmentsList.Remove(i),(a.e.IsEmpty(t.FilePath)||this.parent.AccountPhoto==t.FilePath)&&this.parent.AccountPhoto.Contains(a.e.GetPath(t.guid+"."+t.FileExtension))||(this.parent.FileID=t.AttachmentID,this.parent.AccountPhoto=a.e.IsEmpty(t.guid)?t.FilePath:a.e.GetPath(t.guid+"."+t.FileExtension),this.parent.ActualFileName=t.ActualFileName,this.parent.IsPhotoChanged=!0,this.parent.PhotoTextVisibility=!1,this.parent.EmpAttachmentguid=t.guid.toString(),this.parent.DisplayMessage="",this.parent.FileExtension=t.FileExtension,this.parent.MessageVisibility=!1,this.parent.FileDescription=t.FileDescription),t.IsModified=!0):null==i||0==i.length?(t.AttachmentID>0?(t.IsModified=!0,null!=(i=this.parent.ViewAttachments.AttachmentsList.filter(e=>e.AttachmentID==t.AttachmentID))&&this.parent.ViewAttachments.AttachmentsList.Remove(i)):(t.IsModified=!1,t._Flg=!0),this.parent.ViewAttachments.AttachmentsList.push(t)):(i.FileDescription=t.FileDescription,i.IsModified=!0)}),0==e&&(this.parent.AccountPhoto="",this.parent.ActualFileName="",this.parent.IsPhotoChanged=!1,this.parent.IsPhotoDelete=!1,this.parent.PhotoTextVisibility=!0,this.parent.DisplayMessage="",this.parent.FileDescription=""),this.ViewAttachments.DeletedAttachments.forEach(e=>{this.parent.ViewAttachments.DeletedAttachments.push(e);let t=this.parent.ViewAttachments.AttachmentsList.filter(t=>t.AttachmentID==e.AttachmentID);null!=t&&this.parent.ViewAttachments.AttachmentsList.Remove(t)})}s.a.page.HideDialog()}else s.a.page.HideDialog()}}}}]);