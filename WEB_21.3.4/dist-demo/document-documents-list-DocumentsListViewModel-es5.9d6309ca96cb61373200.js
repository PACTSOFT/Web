function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var s,a=_getPrototypeOf(e);if(t){var i=_getPrototypeOf(this).constructor;s=Reflect.construct(a,arguments,i)}else s=a.apply(this,arguments);return _possibleConstructorReturn(this,s)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var s=0;s<t.length;s++){var a=t[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,s){return t&&_defineProperties(e.prototype,t),s&&_defineProperties(e,s),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[155,75,77,89,113,121,141,148,150,160,210,212],{EggS:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var a=s("Do2H"),i=s("Lp6j"),n=s("eQJW"),o=function(){function e(){_classCallCheck(this,e),this.CustomerID=0,this.CustomerTypeID=0,this.StatusID=0,this.AccountID=0,this.ParentID=0,this.SelectedNodeID=0,this.CodeNumber=0,this.IsGroup=!1,this.CreditDays=0,this.CreditLimit=0,this.DebitDays=0,this.Debitlimit=0,this.IsCode=!1,this.ActivityXml="",this.CCXML=""}return _createClass(e,[{key:"SaveCustomerQuick",value:function(){try{var e=[];return e.push(this.CustomerID),e.push(null!=this.CustomerCode?this.CustomerCode:""),e.push(null!=this.CustomerName?this.CustomerName:""),e.push(this.StatusID),e.push(this.CodePrefix),e.push(this.CodeNumber),e.push(this.StaticFieldsQuery),e.push(this.CustomFieldsQuery),e.push(this.CustomCostCenterFieldsQuery),e.push(a.a.SessionManager.CompanyGUID),e.push(this.GUID),e.push(""),e.push(a.a.SessionManager.UserName),e.push(a.a.SessionManager.RoleID),e.push(a.a.SessionManager.LanguageID),a.a.crmService.SetCustomerQuick(e)}catch(t){return Logger.ErrorLog("Account:: SaveAccountQuick"+t.stack),""}}},{key:"SaveCustomer",value:function(){Logger.InfoLog("Customer:: Inside SaveCustomer");try{0==this.CustomerID&&(this.GUID=i.e.NewGuid());var e=[];return e.push(this.CustomerID),e.push(null!=this.CustomerCode?this.CustomerCode:""),e.push(null!=this.CustomerName?this.CustomerName:""),e.push(null!=this.AliasName?this.AliasName:""),e.push(this.CustomerTypeID),e.push(this.StatusID),e.push(this.AccountID),e.push(this.SelectedNodeID),e.push(this.IsGroup),e.push(this.CreditDays),e.push(this.CreditLimit),e.push(null!=this.UserName?this.UserName:""),e.push(null!=this.Password?this.Password:""),e.push(null!=this.OnlineCustType?this.OnlineCustType:""),e.push(a.a.SessionManager.CompanyGUID),e.push(null!=this.GUID?this.GUID:"GUID"),e.push(""),e.push(a.a.SessionManager.UserName),e.push(this.CustomFieldsQuery),e.push(this.CustomCostCenterFieldsQuery),e.push(this.ContactsXML),e.push(this.AttachmetsXML),e.push(this.NotesXML),e.push(this.AddressXML),e.push(this.ActivityXml),e.push(this.CCXML),e.push(!1),e.push(null==this.PrimaryContactQuery?"":this.PrimaryContactQuery),e.push(a.a.SessionManager.RoleID),e.push(a.a.SessionManager.LanguageID),e.push(null!=this.CodePrefix?this.CodePrefix:""),e.push(this.CodeNumber),e.push(this.IsCode),a.a.crmService.SaveCustomer(e)}catch(t){return Logger.ErrorLog("Customer:: SaveCustomer"+t.stack),""}}},{key:"GetCustomerDetails",value:function(){var e=a.a.crmService.GetCustomerInfo("?UserID="+a.a.SessionManager.UserID+"&RoleID="+a.a.SessionManager.RoleID+"&LangID="+a.a.SessionManager.LangID+"&CustomerID="+this.CustomerID);return!e.Columns[0].Contains("ErrorMessage")&&e.Tables.length>0&&e.Tables[0].length>0&&(this.CustomerID=parseInt(e.Tables[0][0].CustomerID),this.CustomerCode=i.e.String(e.Tables[0][0].CustomerCode),this.CustomerName=i.e.String(e.Tables[0][0].CustomerName),this.AliasName=i.e.String(e.Tables[0][0].AliasName),i.e.IsEmpty(e.Tables[0][0].CustomerTypeID)||(this.CustomerTypeID=parseInt(e.Tables[0][0].CustomerTypeID)),this.StatusID=parseInt(e.Tables[0][0].StatusID),i.e.IsEmpty(e.Tables[0][0].AccountID)||(this.AccountID=parseInt(e.Tables[0][0].AccountID)),this.IsGroup=Object(n.j)(e.Tables[0][0].IsGroup),i.e.IsEmpty(e.Tables[0][0].CreditDays)||(this.CreditDays=parseInt(e.Tables[0][0].CreditDays)),i.e.IsEmpty(e.Tables[0][0].CreditLimit)||(this.CreditLimit=parseFloat(e.Tables[0][0].CreditLimit)),this.ParentID=parseInt(e.Tables[0][0].ParentID),this.GUID=i.e.String(e.Tables[0][0].GUID),this.Description=i.e.String(e.Tables[0][0].Description),this.CodePrefix=i.e.String(e.Tables[0][0].CodePrefix),this.UserName=i.e.String(e.Tables[0][0].UserName),this.OnlineCustType=i.e.String(e.Tables[0][0].OnlineCustType),this.Password=i.e.String(e.Tables[0][0].Password),i.e.IsEmpty(e.Tables[0][0].CodeNumber)||(this.CodeNumber=parseInt(e.Tables[0][0].CodeNumber))),e}},{key:"DeleteCustomer",value:function(e,t){try{var s=[];return s.push(e),s.push(t),s.push(a.a.SessionManager.RoleID),s.push(a.a.SessionManager.LanguageID),Logger.InfoLog("Customer:: Success: DBH.DeleteCustomer "+e.toString()),a.a.crmService.RemoveCustomer(s)}catch(i){return Logger.ErrorLog("LEAD::DeleteLead"+i.stack),""}}}]),e}()},NM0h:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var a=s("Do2H"),i=s("Lp6j"),n=function(){function e(){_classCallCheck(this,e),this.ChangeValueXML=null,this.DetailsXML=null,this.AMCode=null,this.AMName=null,this.AMPurchaseValue=null,this.HistoryXML=null,this.DocNo=null,this.XML=null,this.DocSave=null,this.CodePrefix=null,this.Sno=null,this.AssetClassID=0,this.DeprBookID=0,this.AcqnCostACCID=0,this.AccumDeprACCID=0,this.AcqnCostDispACCID=0,this.AccumDeprDispACCID=0,this.GainsDispACCID=0,this.LossDispACCID=0,this.MaintExpenseACCID=0,this.DeprExpenseACCID=0,this.PostingGroupID=0,this.AMStatusID=0,this.CodeNumber=0,this.AMAssetID=0,this.AMParentAssetID=0,this.IsGroup=!1,this.Post=!1,this.StatusID=0,this.DeprBookMethod=0,this.DeprBookMethodBasedOn=0,this.AveragingMethodID=0,this.DeprScheduleID=0,this.DeprTypeID=0,this.AssetClassCode=null,this.AssetClassName=null,this.GUID=null,this.DeprBookCode=null,this.DeprBookName=null,this.PostGroupCode=null,this.PostGroupName=null,this.AMGUID=null,this.RecordType=null,this.AMGroup=!1,this.IsIncreaseAssetValue=!1,this.EmpName=null,this.EmpCode=null,this.EmpID=0,this.SelectedNodeID=0,this.PostCCID=0,this.PostAssetID=0,this.ScheduleID=0,this.LocationID=0,this.AddressXML=null,this.NotesXML=null,this.ContactsXML=null,this.CustomCostCenterFieldsQuery=null,this.CustomFieldsQuery=null,this.PrimaryContactQuery=null,this.AttachmetsXML=null,this.DepreciationXML=null,this.JVXML=null,this.Description=null,this.DeprStartValue=0,this.ChangeVal=0,this.AssetNetValueChange=0,this.DeprBookMethodBasedOnValue=0,this.TotalYears=0}return _createClass(e,[{key:"SaveAssetClass",value:function(){0==this.AssetClassID&&(this.GUID=i.e.NewGuid());var e=[];return e.push(this.AssetClassID),e.push(null!=this.AssetClassCode?this.AssetClassCode:""),e.push(null!=this.AssetClassName?this.AssetClassName:""),e.push(this.PostingGroupID),e.push(this.DeprBookID),e.push(this.DeprTypeID),e.push(this.TotalYears),e.push(this.StatusID),e.push(a.a.SessionManager.CompanyGUID),e.push(this.GUID),e.push(""),e.push(a.a.SessionManager.UserName),e.push(a.a.SessionManager.UserID),e.push(a.a.SessionManager.LanguageID),a.a.accounting.SetAssetClass(e)}},{key:"PostJVvoucher",value:function(){this.GUID=i.e.NewGuid();var e=[];return e.push(this.PostAssetID),e.push(this.PostCCID),e.push(this.JVXML),e.push(this.Post),e.push(this.DeprTypeID),e.push(this.DocXML),e.push(this.DocSave),e.push(this.DepreciationXML),e.push(this.RecordType),e.push(a.a.SessionManager.CompanyGUID),e.push(this.GUID),e.push(a.a.SessionManager.UserName),e.push(a.a.SessionManager.UserID),e.push(a.a.SessionManager.LanguageID),a.a.accounting.GetPostJvVoucher(e)}},{key:"SetAssetDispose",value:function(e){this.GUID=i.e.NewGuid();var t=[];return t.push(this.PostAssetID),t.push(e.ToString("dd/MMM/yyyy")),t.push(this.PostCCID),t.push(this.JVXML),t.push(this.Post),t.push(this.DeprTypeID),t.push(this.DocXML),t.push(this.DocSave),t.push(this.DepreciationXML),t.push(this.RecordType),t.push(a.a.SessionManager.CompanyGUID),t.push(this.GUID),t.push(a.a.SessionManager.UserName),t.push(a.a.SessionManager.UserID),t.push(a.a.SessionManager.LanguageID),a.a.accounting.SetAssetDispose(t)}},{key:"SaveDeprBook",value:function(e,t,s){0==this.DeprBookID&&(this.GUID=i.e.NewGuid());var n=[];return n.push(this.DeprBookID),n.push(this.DeprBookCode),n.push(this.DeprBookName),n.push(this.DeprBookMethod),n.push(this.DeprBookMethodBasedOn),n.push(this.DeprBookMethodBasedOnValue),n.push(this.StatusID),n.push(this.AveragingMethodID),n.push(e),n.push(t),n.push(s),n.push(a.a.SessionManager.CompanyGUID),n.push(this.GUID),n.push(""),n.push(a.a.SessionManager.UserName),n.push(a.a.SessionManager.UserID),n.push(a.a.SessionManager.LanguageID),a.a.accounting.SetDeprBook(n)}},{key:"SaveFAPostingGroup",value:function(){0==this.PostingGroupID&&(this.GUID=i.e.NewGuid());var e=[];return e.push(this.PostingGroupID),e.push(this.PostGroupCode),e.push(this.PostGroupName),e.push(this.AcqnCostACCID),e.push(this.AccumDeprACCID),e.push(this.AcqnCostDispACCID),e.push(this.AccumDeprDispACCID),e.push(this.GainsDispACCID),e.push(this.LossDispACCID),e.push(this.MaintExpenseACCID),e.push(this.DeprExpenseACCID),e.push(this.StatusID),e.push(0),e.push(this.IsGroup),e.push(a.a.SessionManager.CompanyGUID),e.push(this.GUID),e.push(a.a.SessionManager.UserName),e.push(a.a.SessionManager.UserID),e.push(a.a.SessionManager.LanguageID),a.a.accounting.SetPostingGroup(e)}},{key:"SetAssetManagementDetails",value:function(){var e=[];return e.push(this.AMAssetID),e.push(this.AMCode),e.push(this.AMName),e.push(this.AMStatusID),e.push(this.AMPurchaseValue),e.push(this.AMParentAssetID),e.push(this.AMGroup),e.push(this.CodePrefix),e.push(this.CodeNumber),e.push(this.Sno),e.push(this.DetailsXML),e.push(this.ChangeValueXML),e.push(this.CustomFieldsQuery),e.push(this.CustomCostCenterFieldsQuery),e.push(this.DepreciationXML),e.push(this.HistoryXML),e.push(this.NotesXML),e.push(this.AttachmetsXML),e.push(a.a.SessionManager.CompanyGUID),e.push(this.AMGUID),e.push(a.a.SessionManager.UserName),e.push(a.a.SessionManager.UserID),e.push(a.a.SessionManager.LanguageID),a.a.accounting.SetAssetManagementDetails(e).toPromise()}},{key:"PostDeprJV",value:function(){this.GUID=i.e.NewGuid();var e=[];return e.push(this.PostCCID),e.push(this.JVXML),e.push(this.Post),e.push(a.a.SessionManager.CompanyGUID),e.push(this.GUID),e.push(a.a.SessionManager.UserName),e.push(a.a.SessionManager.UserID),e.push(a.a.SessionManager.LanguageID),e.push(a.a.SessionManager.RoleID),a.a.accounting.PostDeprJV(e)}},{key:"PostDeprJVSummary",value:function(e,t,s,n,o){this.GUID=i.e.NewGuid();var r=[];return r.push(e),r.push(t),r.push(s),r.push(n),r.push(o),r.push(a.a.SessionManager.CompanyGUID),r.push(a.a.SessionManager.UserName),r.push(a.a.SessionManager.UserID),r.push(a.a.SessionManager.LanguageID),a.a.accounting.SetDeprPostingJVSummary(r).toPromise()}},{key:"ChangeValue",value:function(e,t){this.GUID=i.e.NewGuid();var s=[];return s.push(this.PostAssetID),s.push(e),s.push(this.ChangeVal),s.push(this.AssetNetValueChange),s.push(t.ToString("dd/MMM/yyyy")),s.push(this.Description),s.push(this.DepreciationXML),s.push(this.ChangeValueXML),s.push(this.HistoryXML),s.push(this.LocationID),s.push(this.IsIncreaseAssetValue),s.push(this.JVXML),s.push(this.ChangeValueTypeID),s.push(a.a.SessionManager.CompanyGUID),s.push(this.GUID),s.push(a.a.SessionManager.UserName),s.push(a.a.SessionManager.UserID),s.push(a.a.SessionManager.LanguageID),a.a.accounting.SetAssetChangeValue(s)}},{key:"DisposeReverse",value:function(e){var t=[];return t.push(e),t.push(a.a.SessionManager.UserName),t.push(a.a.SessionManager.UserID),t.push(a.a.SessionManager.LanguageID),a.a.accounting.DisposeReverse(t)}}],[{key:"GetAssetClassDetails",value:function(e){var t=[];return t.push(e),t.push(a.a.SessionManager.UserID),t.push(a.a.SessionManager.LanguageID),a.a.accounting.GetAssetClassDetails(t)}},{key:"GetPostingGroupDetails",value:function(e){var t=[];return t.push(e),t.push(a.a.SessionManager.UserID),t.push(a.a.SessionManager.LanguageID),a.a.accounting.GetPostingGroupDetails(t)}},{key:"GetDeprBookDetails",value:function(e){var t=[];return t.push(e),t.push(a.a.SessionManager.UserID),t.push(a.a.SessionManager.LanguageID),a.a.accounting.GetDeprBookDetails(t)}},{key:"GetAssetManagementDetails",value:function(e){var t=[];return t.push(e),t.push(a.a.SessionManager.UserID),t.push(a.a.SessionManager.LanguageID),a.a.accounting.GetAssetManagementDetails(t)}},{key:"GetAssetDeprSchDetails",value:function(e){var t=[];return t.push(e),t.push(a.a.SessionManager.UserID),t.push(a.a.SessionManager.LanguageID),a.a.accounting.GetAssetDeprSchDetails(t)}},{key:"DeleteAsset",value:function(e){var t=[];return t.push(e),t.push(a.a.SessionManager.UserID),t.push(a.a.SessionManager.RoleID),a.a.accounting.DeleteAsset(t)}},{key:"DeleteAssetDeprSchedule",value:function(e){var t=[];return t.push(e),t.push(a.a.SessionManager.RoleID),t.push(a.a.SessionManager.LanguageID),a.a.accounting.DeleteAssetDeprSchedule(t)}},{key:"DeleteAssetRefDoc",value:function(e,t){var s=[];return s.push(e),s.push(t),s.push(a.a.SessionManager.UserID),a.a.accounting.DeleteAssetRefDoc(s)}},{key:"SetsPostDeprReverseJV",value:function(e,t,s){var i=[];return i.push(e),i.push(t),i.push(s),i.push(a.a.SessionManager.CompanyGUID),i.push(a.a.SessionManager.UserName),i.push(a.a.SessionManager.UserID),i.push(a.a.SessionManager.LanguageID),a.a.accounting.SetsPostDeprReverseJV(i)}}]),e}()},ouML:function(e,t,s){"use strict";s.r(t),s.d(t,"DocumentDraftsViewModel",(function(){return c}));var a=s("mrSG"),i=s("Do2H"),n=s("Lp6j"),o=s("ScVY"),r=s("8B8H"),u=s("ockk"),l=s("rJVx"),h=s("CUWK"),c=function(e){_inherits(o,e);var t=_createSuper(o);function o(e,s){var a,n,h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(_classCallCheck(this,o),(a=t.call(this)).Grid=new r.a,a.IsFromDocs=!1,a.PopupWidth=0,a.ReportType=0,a.Parent=null,a.CCID=0,a.WID=0,a.LevelID=0,a.PactGridVisible=!1,a.CCID=h,a.Parent=e,a.ReportType=s,a.Parent instanceof l.GeneralDashboardViewModel||"DashAddOnsViewModel"==a.Parent.ClassName)?1==s&&(a.ColSource=l.GeneralDashboardViewModel.InitColumns("Document Drafts_DashBoardCustomize")):(1==s?a.DisplayName="Drafts":2==s?a.DisplayName="Hold Documents":3==s?a.DisplayName="Approval History":4==s&&(a.DisplayName="Level Info",a.PactGrid=new r.a),a.Title=a.DisplayName,a.IsFromDocs=!0,a.FillGrid(),a.Grid.OnLinkClick.Subscribe(_assertThisInitialized(a),"GridLinkClick"),a.ColSource=[],1==s?(a.ColSource=l.GeneralDashboardViewModel.InitColumns("Document Drafts_DashBoardCustomize"),a.PopupWidth=22,a.ColSource.forEach((function(e){a.PopupWidth=a.PopupWidth+e.Width}))):2==s?((n=new u.a).DataType="TextBlock",n.Header="Hold Date",n.DisplayMember="HoldDate_Key",n.Width=100,a.ColSource.push(n),(n=new u.a).DataType="LINK",n.Header=i.a.GetResource("DocName"),n.DisplayMember="DocName",n.Width=135,a.ColSource.push(n),(n=new u.a).DataType="TextBlock",n.Header="NetValue",n.DisplayMember="NetValue",n.Width=100,a.ColSource.push(n),(n=new u.a).DataType="TextBlock",n.Header="NoOfProducts",n.DisplayMember="NoOfProducts",n.Width=50,a.ColSource.push(n),(n=new u.a).DataType="LINK",n.Header=i.a.GetResource("Delete"),n.DisplayMember="Delete",n.Width=100,a.ColSource.push(n),a.PopupWidth=450):3==s?((n=new u.a).DataType="TextBlock",n.Header="User",n.DisplayMember="CreatedBy",n.Width=90,a.ColSource.push(n),(n=new u.a).DataType="TextBlock",n.Header="FirstName",n.DisplayMember="FirstName",n.Width=90,a.ColSource.push(n),(n=new u.a).DataType="TextBlock",n.Header="LastName",n.DisplayMember="LastName",n.Width=90,a.ColSource.push(n),(n=new u.a).DataType="TextBlock",n.Header="Email",n.DisplayMember="Email1",n.Width=150,a.ColSource.push(n),(n=new u.a).DataType="TextBlock",n.Header=i.a.GetResource("Date"),n.DisplayMember="AppDate",n.Width=128,a.ColSource.push(n),(n=new u.a).DataType="LINK",n.Header="Level",n.DisplayMember="LevelName",n.Width=93,a.ColSource.push(n),(n=new u.a).DataType="TextBlock",n.Header="Status",n.DisplayMember="Status",n.Width=80,a.ColSource.push(n),(n=new u.a).DataType="Format",n.Header="Remarks",n.DisplayMember="Remarks",n.Width=190,a.ColSource.push(n),a.PopupWidth=950,"AddEditDocumentViewModel"==a.Parent.ClassName&&((n=new u.a).Header="WorkFlowName",n.DisplayMember="WorkFlowName",n.Width=200,a.ColSource.push(n)),a.PopupWidth=950):4==s&&((n=new u.a).DataType="TextBlock",n.ReadOnly=!0,n.Header="User Name",n.DisplayMember="UserName",n.Width=120,a.ColSource.push(n),(n=new u.a).DataType="TextBlock",n.ReadOnly=!0,n.Header="First Name",n.DisplayMember="FirstName",n.Width=120,a.ColSource.push(n),(n=new u.a).DataType="TextBlock",n.ReadOnly=!0,n.Header="Last Name",n.DisplayMember="LastName",n.Width=120,a.ColSource.push(n),a.PactGrid.Columns=a.ColSource,a.PopupWidth=400));return _possibleConstructorReturn(a)}return _createClass(o,[{key:"onClick",value:function(e){event.preventDefault(),null!=this.SelectedRow&&this.LoadDraft(this.SelectedRow)}},{key:"FillGrid",value:function(){var e=this,t=0,s=null;if(n.e.IsType(this.Parent,"AddEditDocumentViewModel")?(s=this.Parent,t=0==this.CCID?s.CostCenterID:this.CCID):n.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName||(t=this.CCID),1==this.ReportType||2==this.ReportType)(n.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName?null==s||38!=s.ScreenObject.DocumentType&&39!=s.ScreenObject.DocumentType?i.a.document.GetDocumentDrafts(0,t,this.ReportType,!1):i.a.document.GetDocumentDrafts(s.ScreenObject.RegisterNodeID,t,this.ReportType,!1,!0):i.a.document.GetDocumentDrafts(0,this.Parent.CostCenterID,this.ReportType,!1)).subscribe((function(t){e.Table=t.Tables[0],e.Grid.TableColumns.Contains("Date_Text")||(e.Grid.TableColumns.push("Date_Text"),e.Grid.TableColumns.push("Delete")),e.Grid.TableColumns.Contains("HoldDate_Key")||e.Grid.TableColumns.push("HoldDate_Key"),e.Table.forEach((function(e){e.Delete="Delete",e.id=i.a.slick.rowid,e.Date_Text=new Date(e.Date).ToString(i.a.SessionManager.Preferences["Date Format"]+" hh:mm a"),null!=e.HoldDate&&(e.HoldDate_Key=new Date(e.HoldDate).ToString(i.a.SessionManager.Preferences["Date Format"]))}))}));else if(3==this.ReportType){var a=null;if(n.e.IsType(this.Parent,"AddEditDocumentViewModel")?(a=this.Parent.ScreenObject.GetDocStatusHistory()).Tables.length>1&&a.Tables[1].length>0&&a.Columns[1].Contains("WID")&&(this.WID=parseInt(a.Tables[1][0].WID)):n.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName?n.e.IsEmpty(this.Parent.ClassName)||"AddEditCasesViewModel"!=this.Parent.ClassName||(a=this.GetDocStatusHistory(73,this.Parent.CaseID,!1)):a=i.a.rental.GetHistory(t,this.Parent.ContractID),null!=a&&a.Tables.length>0){this.Table=a.Tables[0],this.Grid.TableColumns.push("AppDate");for(var r=0;r<this.Table.length;r++)""!=this.Table[r].Date.toString()&&(this.Table[r].AppDate=new Date(this.Table[r].Date.toString()).ToString(i.a.SessionManager.Preferences["Date Format"]+" hh:mm a"));var u=0,l=0;this.Table.length>0&&(u=n.e.IntTryParse(this.Table[this.Table.length-1].WorkFlowLevel.toString()),l=n.e.IntTryParse(this.Table[this.Table.length-1].StatusID.toString())),369!=l&&(a.Tables[1]=a.Tables[1].filter((function(e){return e.levelID>u})),a.Tables[1].forEach((function(t){var s=e.Grid.NewRow();s.LevelName=t.LevelName,s.Status="Pending",s.WorkFlowLevel=t.LevelID,e.Grid.addRow(s)})));for(var h=this.Table.length;h<7;h++)this.Grid.addEmptyRow()}}else if(4==this.ReportType){var c=null;if("WFLevelDoc"==this.Parent.ClassName?c=i.a.SessionManager.Preferences.ContainsKey("CanApproveFunction")&&"True"==i.a.SessionManager.Preferences.CanApproveFunction?i.a.report.GetExtWFDet(this.Parent.WID,this.Parent.LevelID,this.Parent.ccid,this.Parent.DOcId):i.a.report.GetWorkFlowLevelDetails(this.Parent.WID,this.Parent.LevelID,this.Parent.ccDate):this.Parent instanceof o&&(i.a.SessionManager.Preferences.ContainsKey("CanApproveFunction")&&"True"==i.a.SessionManager.Preferences.CanApproveFunction?"AddEditDocumentViewModel"==this.Parent.Parent.ClassName?c=i.a.report.GetExtWFDet(this.Parent.WID,this.Parent.LevelID,this.Parent.Parent.CostCenterID,this.Parent.Parent.ScreenObject.DocID):"ReportViewModel"==this.Parent.Parent.ClassName&&"INV_ComparisonReport"==this.Parent.Parent.StaticReportObject&&(c=i.a.report.GetExtWFDet(this.Parent.WID,this.Parent.LevelID,this.Parent.Parent.StaticReportObject.QuotationDocument,this.Parent.Parent.StatusDocID)):c=i.a.report.GetWorkFlowLevelDetails(this.Parent.WID,this.Parent.LevelID,"AddEditDocumentViewModel"==this.Parent.Parent.ClassName?this.Parent.Parent.ScreenObject.DocDate.Date:Date.Today())),null!=c){for(var D=c.Tables[0].length;D<8;D++)c.Tables[0].push();this.PactGrid.Table=c.Tables[0]}this.PactGrid.Width="",this.PactGrid.SearchVisible=!0,this.PactGrid.SearchCols.Width="85",this.PactGrid.SearchOptions.Width="90",this.PactGrid.SearchText.Width="110",this.PactGridVisible=!0}}},{key:"GetDocStatusHistory",value:function(e,t,s){Logger.InfoLog("DocumentDraftsViewModel:: Inside GetDocStatusHistory");var a=[];a.push(e),a.push(t),a.push(s),a.push(i.a.SessionManager.UserID),a.push(i.a.SessionManager.LanguageID);var n=i.a.document.GetDocStatusHistory(a);return Logger.InfoLog("DocumentDraftsViewModel:: Exiting GetDocStatusHistory"),n}},{key:"OnButtonClick",value:function(e){"Cancel"==e.toString()&&(n.e.IsType(this.Parent,"AddEditDocumentViewModel")&&this.CCID>0&&(this.Parent.res="No"),i.a.page.HideDialog())}},{key:"DeleteDraft",value:function(e){(n.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName?i.a.document.DeleteDocumentDraft(parseInt(e.DraftID)):i.a.rental.DeleteQuotation(parseInt(e.CostCenterID),parseInt(e.DraftID))).RetValue>0&&this.Grid.removeRow(e)}},{key:"LoadDraft",value:function(e){return Object(a.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var a,o,r,u,l,c=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.e.IsEmpty(this.Parent.ClassName)&&"AddEditRenContractViewModel"==this.Parent.ClassName){t.next=12;break}return t.next=3,Promise.all([s.e(2),s.e(1),s.e(3),s.e(5),s.e(4),s.e(6),s.e(7),s.e(10),s.e(9),s.e(12),s.e(11),s.e(13),s.e(19),s.e(15),s.e(21),s.e(20),s.e(16),s.e(14),s.e(18),s.e(17),s.e(22),s.e(89)]).then(s.bind(null,"1Cra"));case 3:return a=t.sent,o=a.AddEditDocumentViewModel,t.next=7,Promise.all([s.e(4),s.e(6)]).then(s.bind(null,"MCKn"));case 7:r=t.sent,u=r.AddEditDocumentComponent,i.a.document.GetDocumentDrafts(parseInt(e.DraftID),0,1,!1).subscribe((function(t){if(null!=(l=t.Tables[0])&&l.length>0)if("AddEditDocumentViewModel"==c.Parent.ClassName||"POSDocumentViewModel"==c.Parent.ClassName)c.CCID>0||(c.Parent.clear(1),c.Parent.LoadDraftXML(l[0]),i.a.page.HideDialog(),c.Parent.ScreenObject.GridDataObj.RefreshGridView());else{var s=1==c.ReportType,a=new o(parseInt(e.CostCenterID),e.Type.toString(),s);i.a.page.addNewTab({component:u,params:{obj:a}}),a.LoadDraftXML(l[0],s)}})),t.next=13;break;case 12:h.RibbonExtViewModel.LoadDraftRentalContract(this.Parent,parseInt(e.DraftID)),i.a.page.HideDialog();case 13:case"end":return t.stop()}}),t,this)})))}},{key:"GridLinkClick",value:function(e,t,s){event.preventDefault(),"Delete"==t?this.DeleteDraft(e):"Date_Text"!=t&&"DocName"!=t||this.LoadDraft(e)}},{key:"Table",get:function(){return this.Grid.Table},set:function(e){this.Grid.Table=e}},{key:"TableColumns",get:function(){return this.Grid.TableColumns},set:function(e){this.Grid.TableColumns=e}},{key:"ColSource",get:function(){return this.Grid.Columns},set:function(e){this.Grid.Columns=e}},{key:"SelectedRow",get:function(){return this.Grid.SelectedItem},set:function(e){this.Grid.SelectedItem=e}}]),o}(o.b)},rJVx:function(e,t,s){"use strict";s.r(t),s.d(t,"GeneralDashboardViewModel",(function(){return h}));var a=s("mrSG"),i=s("Do2H"),n=s("Lp6j"),o=s("ScVY"),r=s("NkMH"),u=s("ockk"),l=s("JIg3"),h=function(e){_inherits(o,e);var t=_createSuper(o);function o(){var e;return _classCallCheck(this,o),(e=t.call(this)).ButtonPDC=new r.a,e.timerdashboard=new n.d,e.Date=new l.a(0),e.tdMaximize=new Array(4).fill(!1),Logger.InfoLog("DashboardViewModel::Entering DashboardViewModel"),e.timerdashboard.Enabled=!0,e.timerdashboard.Interval=6e4,i.a.SessionManager.IsWebApplication||e.timerdashboard.Elapsed(_assertThisInitialized(e),"timerdashboard_Elapsed"),e.DisplayName=i.a.GetResource("Dashboard_Maindashboard"),e.loadDrafts(),Logger.InfoLog("DashboardViewModel::Exiting DashboardViewModel"),e}return _createClass(o,[{key:"loadDrafts",value:function(){return Object(a.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,a,i,n,o,r,u=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.e(150).then(s.bind(null,"ouML"));case 2:return t=e.sent,a=t.DocumentDraftsViewModel,this.DocumentDrafts=new a(this,1),setTimeout((function(){u.DocumentDrafts.FillGrid()}),500),e.next=7,s.e(0).then(s.bind(null,"AyOk"));case 7:return i=e.sent,n=i.UnAppDocumentsViewModel,this.UnApprovedDocuments=new n,e.next=12,Promise.all([s.e(2),s.e(1),s.e(5),s.e(26),s.e(42),s.e(0),s.e(73)]).then(s.bind(null,"Wh9R"));case 12:o=e.sent,r=o.DashBoardNotifViewModel,this.NotifEvents=new r(2),this.PDCDocuments=new r(4);case 15:case"end":return e.stop()}}),e,this)})))}},{key:"timerdashboard_Elapsed",value:function(e,t){i.a.page.isActiveTab(this)&&(this.OnButtonClick("RefreshPDC"),this.OnButtonClick("RefreshEvents"),this.NotifEvents.RefreshData(),this.UnApprovedDocuments.OnLoad())}},{key:"OnButtonClick",value:function(e){"PostPDC"==e||("RefreshPDC"==e?(this.PDCDocuments.EventsType=4,this.PDCDocuments.InitColumns()):"PostEvents"==e||("RefreshEvents"==e?this.NotifEvents.RefreshData():"UnApproved"==e?this.UnApprovedDocuments.OnLoad():"Drafts"==e&&this.DocumentDrafts.FillGrid()))}},{key:"OnMessageCallBack",value:function(){this.res="Yes"}}],[{key:"InitColumns",value:function(e){var t,s="",a=[];if(i.a.SessionManager.Preferences.ContainsKey(e)&&(s=i.a.SessionManager.Preferences[e]),s.length>0){var o=new n.f;o.LoadXml(s);for(var r=0;r<o.DocumentElement.children.length;r++){var l=o.DocumentElement.children[r];(t=new u.a).Header=i.a.GetResource(l.attributes.Header.value),t.DisplayMember=l.attributes.ID.value,t.ReadOnly=!0,t.Width=parseInt(l.attributes.Width.value),a.push(t),"Un Approved Documents_DashBoardCustomize"==e?"VoucherNo"==t.DisplayMember?t.DataType="LINK":"Amount"==t.DisplayMember&&(t.DataType="FLOAT",t.DecimalPoints=i.a.SessionManager.Preferences.DecimalsinAmount.toString()):"Document Drafts_DashBoardCustomize"==e?"Date_Text"!=t.DisplayMember&&"Delete"!=t.DisplayMember||(t.DataType="LINK"):"Post Dated Documents_DashBoardCustomize"==e?"VoucherNo"==t.DisplayMember?t.DataType="LINK":"Amount"==t.DisplayMember&&(t.DataType="FLOAT",t.DecimalPoints=i.a.SessionManager.Preferences.DecimalsinAmount.toString()):"Notification Events_DashBoardCustomize"==e&&"VoucherNo"==t.DisplayMember&&(t.DataType="LINK")}}return a}},{key:"IsActionAssigned",value:function(e,t){return i.a.SessionManager.IsActionAssigned(e,t)}}]),o}(o.b)},xeC8:function(e,t,s){"use strict";s.r(t),s.d(t,"DocumentsListViewModel",(function(){return y}));var a=s("mrSG"),i=s("ScVY"),n=s("Do2H"),o=s("ThYU"),r=s("dH+5"),u=s("8B8H"),l=s("ockk"),h=s("Lp6j"),c=s("CUWK"),D=s("NkMH"),d=s("eQJW"),p=s("0/4Q"),m=s("1Cra"),C=s("IOQr"),I=function(e){_inherits(s,e);var t=_createSuper(s);function s(e,a){var i;return _classCallCheck(this,s),(i=t.call(this)).GridObj=new u.a,i.IsSelective=!1,i.Parent=e,i.item=a,i.InitGrid(),i}return _createClass(s,[{key:"InitGrid",value:function(){if(this.GridObj=new u.a,this.GridObj.MaxHeight=280,this.GridObj.SelectAll.Visible=!1,this.GridObj.SelectAll.DBColumnName="select",this.GridObj.Width="",this.GridObj.Table=[],this.GridObj.Columns=[],this.GridObj.Visible=!1,this.lstDateCols=[],this.Parent.IsInventory){var e;"True"==this.Parent.GetPrefValue("Selective")&&(this.IsSelective=!0,this.GridObj.SelectAll.Visible=!0,(e=new l.a).DisplayMember="select",e.Header="Select",e.Width=50,e.IsFrozen=!0,e.ReadOnly=!0,e.TextAlign="Center",e.DataType="CheckBox",this.GridObj.Columns.push(e),this.GridObj.TableColumns.push(e.DisplayMember)),(e=new l.a).DisplayMember="DocSeqNo",e.Header="#",e.Width=45,e.ReadOnly=!0,e.IsFrozen=!0,this.GridObj.Columns.push(e),this.GridObj.TableColumns.push(e.DisplayMember),(e=new l.a).DisplayMember="ProductCode",e.Header="Product Code",e.Width=110,e.ReadOnly=!0,this.GridObj.Columns.push(e),this.GridObj.TableColumns.push(e.DisplayMember),(e=new l.a).DisplayMember="ProductName",e.Header="Product Name",e.Width=180,e.ReadOnly=!0,this.GridObj.Columns.push(e),this.GridObj.TableColumns.push(e.DisplayMember),(e=new l.a).DisplayMember="Quantity",e.Header="Qty",e.Width=80,e.ReadOnly=!0,e.DecimalPoints=n.a.SessionManager.Preferences.DecimalsinQty,e.DataType="FLOAT",this.GridObj.Columns.push(e),this.GridObj.TableColumns.push(e.DisplayMember),(e=new l.a).DisplayMember="Rate",e.Header="Rate",e.Width=80,e.ReadOnly=!0,e.DecimalPoints=n.a.SessionManager.Preferences.DecimalsinRate,e.DataType="FLOAT",this.GridObj.Columns.push(e),this.GridObj.TableColumns.push(e.DisplayMember),(e=new l.a).DisplayMember="Gross",e.Header="Gross",e.Width=100,e.ReadOnly=!0,e.DecimalPoints=n.a.SessionManager.Preferences.DecimalsinAmount,e.DataType="FLOAT",this.GridObj.Columns.push(e),this.GridObj.TableColumns.push(e.DisplayMember)}else{var t=new l.a;t.DisplayMember="DocSeqNo",t.Header="#",t.Width=45,t.ReadOnly=!0,t.IsFrozen=!0,this.GridObj.Columns.push(t),this.GridObj.TableColumns.push(t.DisplayMember),(t=new l.a).DisplayMember="DrName",t.Header="Debit Account",t.Width=180,t.ReadOnly=!0,this.GridObj.Columns.push(t),this.GridObj.TableColumns.push(t.DisplayMember),(t=new l.a).DisplayMember="CrName",t.Header="Credit Account",t.Width=180,t.ReadOnly=!0,this.GridObj.Columns.push(t),this.GridObj.TableColumns.push(t.DisplayMember),(t=new l.a).DisplayMember="Amount",t.Header="Amount",t.Width=100,t.DecimalPoints=n.a.SessionManager.Preferences.DecimalsinAmount,t.DataType="FLOAT",t.ReadOnly=!0,this.GridObj.Columns.push(t),this.GridObj.TableColumns.push(t.DisplayMember)}this.LoadData()}},{key:"LoadData",value:function(){var e,t=this;e=this.Parent.IsInventory?"select INV.InvDocDetailsID,INV.DocSeqNo,P.ProductCode,P.ProductName,INV.Quantity,INV.Rate,INV.Gross\n    from INV_DocDetails INV with(nolock)\n    join INV_Product P with(nolock) on P.ProductID=INV.ProductID\n    where INV.VoucherNo='"+this.item.DocNo+"' and INV.DynamicInvDocDetailsID is null\n    order by INV.DocSeqNo\n":"select ACC.AccDocDetailsID,ACC.DocSeqNo,A1.AccountName DrName,A2.AccountName CrName,ACC.Amount\n      from ACC_DocDetails ACC with(nolock)\n      join ACC_Accounts A1 with(nolock) on A1.AccountID=ACC.DebitAccount\n      join ACC_Accounts A2 with(nolock) on A2.AccountID=ACC.CreditAccount\n      where ACC.VoucherNo='"+this.item.DocNo+"'\n      order by ACC.DocSeqNo\n",this.GridObj.Visible=!1,n.a.report.DataSetAsyn("RPT022",e).then((function(e){e.Tables[0].length>0&&(e.Tables[0][0].AccDocDetailsID||e.Tables[0][0].InvDocDetailsID)&&t.GridObj.addRows(e.Tables[0])})).finally((function(){t.GridObj.Visible=!0}))}},{key:"RefreshData",value:function(e){var t=this;e.forEach((function(e){t.GridObj.Columns.forEach((function(e){}))}))}},{key:"OnButtonClick",value:function(e){if("Cancel"==e)n.a.page.HideDialog();else{var t=[];this.IsSelective&&(this.GridObj.Table.forEach((function(e){e.select&&t.push({InvDocDetailsID:e.InvDocDetailsID})})),t.length>0?(this.item._LinkedIDs=t,this.item.select=!0,this.Parent.SelectedLinkedDocs.Contains(this.item)||this.Parent.SelectedLinkedDocs.push(this.item)):(this.item._LinkedIDs=[],this.item.select=!1,this.Parent.SelectedLinkedDocs.Contains(this.item)&&this.Parent.SelectedLinkedDocs.Remove(this.item)),this.Parent.GridObj.updateRow(this.item)),n.a.page.HideDialog()}}}]),s}(i.b),S=s("4lLs"),y=function(e){_inherits(i,e);var t=_createSuper(i);function i(e,s){var a,r,l,h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",D=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(_classCallCheck(this,i),(a=t.call(this)).Documents=new p.e,a.lstDateCols=[],a.Buttons=[],a.CreateNew=[],a.colVoucherID="",a.colStatusID="",a.colAccStatusID="",a.PageNo=1,a.PageSize=20,a.CurrentRecords="",a.TotalRows=0,a.OverallTotalRows="",a.TotalPages=0,a.ExtWhere="",a.ExtWhereLinkStatus=!1,a.ExecutedQty="",a.ExecutedQuery="",a.ExecutedQueryJoin="",a.StatusList=[],a.LinkStatusList=[],a.DocJV=[],a.DocJVDr=[],a.DocJVCr=[],a.DocInfo=[],a.VoucherNo="",a.IsInventory=!1,a.DocumentType=0,a.ProfileLID=0,a.HideGrid=!0,a.IsFirstCall=!0,a.SelectedLinkedDocs=[],a.ShowPostFilter=!1,a.SelectedStatus=null,a.CostCenterID=e,a.ExtWhere=h,a.objParams=D,(null===(r=a.objParams)||void 0===r?void 0:r.DocsList)?(a.dsRpt=n.a.common.GetDataSet3("DOC062",a.objParams.DocsList,""),a.CostCenterID=e=a.dsRpt.Tables[0][0].CostCenterID,s=a.dsRpt.Tables[0][0].DocumentName,"-1"!=a.ExtWhere&&"-2"!=a.ExtWhere&&"-3"!=a.ExtWhere||(a.ExtWhereLinkStatus=!0)):a.dsRpt=n.a.common.GetDataSet3("DOC062",a.CostCenterID.toString(),c),a.Title=s,a.ReportID=S.a.GetLandingReport(e),a.IsInventory=a.dsRpt.Tables[0][0].IsInventory,a.DocumentType=a.dsRpt.Tables[0][0].DocumentType,a.Documents.Items.push(p.d.ComboBoxItems_4(s,e.toString(),a.ReportID.toString(),a.dsRpt.Tables[0][0].IsInventory.toString())),0==a.ReportID&&(a.ReportID=Object(d.j)(a.dsRpt.Tables[0][0].IsInventory)?a.DocumentType>=51&&a.DocumentType<=199&&64!=a.DocumentType?219:217:218),a.Documents.LblWidth="0",a.Documents.SelectedValue=e.toString(),a.Documents.SelectionChangedCommand.Subscribe(_assertThisInitialized(a),"OnDocumentChanged"),null===(l=a.objParams)||void 0===l?void 0:l.DocsList)for(var m=1;m<a.dsRpt.Tables[0].length;m++)a.Documents.Items.push(p.d.ComboBoxItems_4(a.dsRpt.Tables[0][m].DocumentName,a.dsRpt.Tables[0][m].CostCenterID.toString(),S.a.GetLandingReport(a.dsRpt.Tables[0][m].CostCenterID),a.dsRpt.Tables[0][m].IsInventory.toString()));return c&&a.IsInventory&&a.dsRpt.Tables[1].forEach((function(e){a.Documents.Items.push(p.d.ComboBoxItems_4(e.DocumentName,e.CostCenterID.toString(),S.a.GetLandingReport(e.CostCenterID),a.dsRpt.Tables[0][0].IsInventory.toString()))})),1==a.Documents.Items.length&&(a.Documents.Visible=!1),a.rpt=new o.ReportViewModel,a.rpt.DocsLanding=_assertThisInitialized(a),a.GridObj=new u.a,a.GridObj.Height=0,a.GridObj.Width="",a.GridObj.Table=[],a.GridObj.Columns=[],a.GridObj.OnLinkClick.Subscribe(_assertThisInitialized(a),"OnLinkClickEvent"),a.InitButtons(),a.GridObj.OnRowSelection.Subscribe(_assertThisInitialized(a),"OnRowChange"),_possibleConstructorReturn(a)}return _createClass(i,[{key:"OnDocumentChanged",value:function(){var e=this,t=this.Documents.GetselectedItem(),s=h.e.Int(t.Parent);if(this.CreateNew.Clear(),this.SelectedLinkedDocs.Clear(),this.DocsList&&(this.DisplayName=t.Name,this.Title=t.Name),this.dsRpt.Tables[2].length>0&&this.dsRpt.Tables[2].filter((function(e){return e.CCID==parseInt(t.Value)})).forEach((function(t){e.CreateNew.push(t)})),"0"==t.Parent&&(s=Object(d.j)(t.Aliasname)?this.DocumentType>=51&&this.DocumentType<=199&&64!=this.DocumentType?219:217:218),s!=this.ReportID||this.IsFirstCall)this.IsFirstCall=!1,this.ReportID=s,this.OnReportChange();else{this.SetExecutedQtyQuery();var a=this.GetQuery(1);this.LoadData(a)}}},{key:"OnReportChange",value:function(){var e,t=this;this.SetExecutedQtyQuery(),this.rpt.ReportViewModel_2(this.ReportID,r.e.LandingPage,null,null,(null===(e=this.objParams)||void 0===e?void 0:e.ReportFilterXML)?this.objParams.ReportFilterXML:""),this.rpt.ShowFilter=!1,this.rpt.PostDataFetchFilterFields.forEach((function(e){var s=t.rpt.BaseReportColumns.find((function(t){return t.ID==e.ColumnName}));(null==s?void 0:s.CDGDO.IsForeignKey)&&(e.FromList.CCID=s.CDGDO.ColumnCostCenterID,e.FromList.TypeID=2==e.FromList.CCID?100:3==e.FromList.CCID?10:1)})),this.InitGrid(),this.HideGrid=!1,this.SelectedLinkedDocs.Clear(),this.rpt.SetQueryXMLTags();var s=this.GetQuery(1);this.LoadData(s)}},{key:"SetExecutedQtyQuery",value:function(){var e=this;this.ExecutedQty="",this.ExecutedQuery="",this.ExecutedQueryJoin="",this.ProfileLID=0,n.a.page.QuickDocumentData.Profiles.values.forEach((function(t){t.DocData.forEach((function(t){t.Docs.forEach((function(s){s.CCID!=e.Documents.SelectedValue||(e.ProfileLID=t.LID)}))}))})),this.IsInventory&&(this.ExtWhereLinkStatus||70!=this.ProfileLID&&80!=this.ProfileLID&&270!=this.ProfileLID&&280!=this.ProfileLID)&&(this.ExecutedQty=n.a.report.GetExecutedQtyQuery(0,this.Documents.SelectedValue,null,null,!1,!1),this.ExecutedQty.length<=120?this.ExecutedQty="":this.ExecutedQty.Contains("NUM")&&(this.ExecutedQueryJoin=" join COM_DocNumData NUM with(nolock) on NUM.InvDocdetailsID=INV.InvDocdetailsID"))}},{key:"InitGrid",value:function(){var e=this;this.GridObj.Table.Clear(),this.GridObj.Columns.Clear(),this.GridObj.TableColumns.Clear(),this.lstDateCols=[];var t=new l.a;t.DisplayMember="select",t.Header="Select",t.Width=50,t.ReadOnly=!0,t.DataType="CheckBox",t.IsFrozen=!0,t.TextAlign="Center",t.CheckedChanged.Subscribe(this,"dgColSelect_CheckedChanged"),this.GridObj.Columns.push(t),this.GridObj.TableColumns.push(t.DisplayMember),(t=new l.a).DisplayMember="_DocView",t.Header="View",t.Width=42,t.ReadOnly=!0,t.DataType="",t.DataType="LINK",t.TextAlign="Center",t.ValueBinding="fa-light fa-list",t.IsFrozen=!0,this.GridObj.Columns.push(t),this.GridObj.TableColumns.push(t.DisplayMember),this.colVoucherID="",this.colStatusID="",this.rpt.ReportColumns.forEach((function(s){var a=e.rpt.BaseReportColumns.find((function(e){return e.ID==s.ID}));(t=new l.a).DisplayMember=s.ID,t.Header=s.HeaderText,t.Width=s.width,t.ReadOnly=!0,t.DataType=s.DataAppearance.ColumnType,t.TextAlign=s.DataAppearance.Alignment,"FLOAT"==t.DataType?t.DecimalPoints="2":"DATE"==t.DataType?e.lstDateCols.push(s):a&&"VoucherNo"==a.CDGDO.Column?(t.DataType="LINK",0==e.colVoucherID.length&&(e.colVoucherID=s.ID)):113==a.CDGDO.ColumnCostCenterID&&(e.colStatusID=s.ID),e.GridObj.Columns.push(t),e.GridObj.TableColumns.push(t.DisplayMember)})),this.LinkStatusCol=this.GridObj.Columns.find((function(e){return"_LinkStatus"==e.DisplayMember})),this.LinkStatusCol&&0==this.ExecutedQty.length&&this.GridObj.Columns.Remove(this.LinkStatusCol),this.colAccStatusID="";var s=this.GridObj.Columns.find((function(e){return"_AccStatus"==e.DisplayMember}));s&&("True"==this.GetPrefValue("DonotupdateAccounts")?this.GridObj.Columns.Remove(s):this.colAccStatusID="_AccStatus"),this.GridObj.RefreshColumns()}},{key:"InitButtons",value:function(){var e=new D.a;e.Expression="fa-light fa-file",e.Label=n.a.GetResource("New"),e.DBColumnName="New",this.Buttons.push(e),(e=new D.a).Expression="fa-light fa-file-edit",e.Label=n.a.GetResource("Edit"),e.DBColumnName="Edit",this.Buttons.push(e),(e=new D.a).Expression="fa-light fa-arrows-rotate",e.Label=n.a.GetResource("Refresh"),e.DBColumnName="Refresh",this.Buttons.push(e),(e=new D.a).Expression="fa-light fa-gears",e.Label=n.a.GetResource("Regenerate"),e.DBColumnName="Regenerate",this.Buttons.push(e)}},{key:"OnRowChange",value:function(e){var t=this;this.colVoucherID&&(this.DocJVDr.Clear(),this.DocJVCr.Clear(),this.DocInfo.Clear(),this.VoucherNo="",e&&e[this.colVoucherID]&&(this.colAccStatusID&&(this.DocInfo.push({Name:"Bill Amount",Value:h.e.Int(e._BillAmt).Commas(n.a.SessionManager.Preferences.DecimalsinAmount)}),this.DocInfo.push({Name:"Ajusted Amount",Value:h.e.Int(e._AdjAmt).Commas(n.a.SessionManager.Preferences.DecimalsinAmount)})),this.LinkStatusCol&&this.ExecutedQty.length>0&&(this.DocInfo.push({Name:"Total Quantity",Value:h.e.Int(e.DQty).Commas(n.a.SessionManager.Preferences.DecimalsinQty)}),this.DocInfo.push({Name:"Executed Qty",Value:h.e.Int(e.DExQty).Commas(n.a.SessionManager.Preferences.DecimalsinQty)})),this.VoucherNo=e[this.colVoucherID],n.a.report.DataSetAsyn("RPT052",this.IsInventory?"1":"0",this.VoucherNo).then((function(e){e.Tables[2].forEach((function(e){0!=h.e.Int(e.Dr)&&(e.DrText=e.Dr.Commas("N2"),t.DocJVDr.push(e)),0!=h.e.Int(e.Cr)&&(e.CrText=e.Cr.Commas("N2"),t.DocJVCr.push(e))})),t.DocJV=e.Tables[2]}))))}},{key:"OnLinkClickEvent",value:function(e,t){"_DocView"==t?(e._DetailsObj||(e._DetailsObj=new I(this,e)),n.a.page.ShowDialog(e._DetailsObj,C.a,{ShowCenter:!0,Title:"Details",VarWidth:!0})):h.e.IsEmpty(e[t])||c.RibbonExtViewModel.LoadDocument_VoucherNo(e[t].toString())}},{key:"dgColSelect_CheckedChanged",value:function(e,t){t?this.SelectedLinkedDocs.Contains(e.item)||(this.SelectedLinkedDocs.push(e.item),e.item._LinkedIDs=null):this.SelectedLinkedDocs.Contains(e.item)&&(this.SelectedLinkedDocs.Remove(e.item),e.item._LinkedIDs=null)}},{key:"OnButtonClick",value:function(e){return Object(a.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var s,a,i,n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.DisplayMessage="","NEXT"!=e){t.next=7;break}if(!(this.PageNo>=this.TotalPages)){t.next=3;break}return t.abrupt("return",void(this.DisplayMessage="No more records."));case 3:s=this.GetQuery(this.PageNo+1),this.LoadData(s),t.next=15;break;case 7:if("PREVIOUS"!=e){t.next=14;break}if(!(this.PageNo<=1)){t.next=10;break}return t.abrupt("return",void(this.DisplayMessage="No more records."));case 10:a=this.GetQuery(this.PageNo-1),this.LoadData(a),t.next=15;break;case 14:"FIRST"==e?1!=this.PageNo&&(i=this.GetQuery(1),this.LoadData(i)):"LAST"==e?this.PageNo!=this.TotalPages&&this.TotalPages>0&&(n=this.GetQuery(this.TotalPages),this.LoadData(n)):"New"==e?this.NewDocument(this.Documents.SelectedValue,this.Documents.GetText()):"Edit"==e?this.GridObj.SelectedItem&&this.colVoucherID&&!h.e.IsEmpty(this.GridObj.SelectedItem[this.colVoucherID])&&c.RibbonExtViewModel.LoadDocument_VoucherNo(this.GridObj.SelectedItem[this.colVoucherID].toString()):"Refresh"==e?(this.SelectedStatus=null,this.SelectedLinkedDocs.Clear(),o=this.GetQuery(1),this.LoadData(o)):"RemoveExtWhere"==e?(this.ExtWhere="",this.ExtWhereLinkStatus=!1,this.OnButtonClick("Refresh")):"Regenerate"==e&&(this.rpt.Filter.Title="Filter",this.rpt.OnButtonClick("Regenerate"));case 15:case"end":return t.stop()}}),t,this)})))}},{key:"OnCreateNew",value:function(e){this.NewDocument(e.CCID,e.Title)}},{key:"OnGenerate",value:function(e){return Object(a.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var a,i,o,r,u,l,h,c,D=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!=this.SelectedLinkedDocs.length){t.next=2;break}return t.abrupt("return",void(this.DisplayMessage="Please Select Documents."));case 2:return a={},t.next=5,Promise.resolve().then(s.bind(null,"MCKn"));case 5:return i=t.sent,o=i.AddEditDocumentComponent,t.next=9,Promise.resolve().then(s.bind(null,"1Cra"));case 9:r=t.sent,u=r.AddEditDocumentViewModel,l="",this.SelectedLinkedDocs.forEach((function(e){e._LinkedIDs&&e._LinkedIDs.forEach((function(e){l.length>0&&(l+=","),l+=e.InvDocDetailsID.toString()}))})),h=null,l.length>0?0==(h=n.a.report.ReportDataTable("RPT022",!1,"select top 1 D.DebitAccount,D.CreditAccount,dcc.* from INV_DocDetails D with(Nolock) join com_docccdata dcc with(nolock) on D.invdocdetailsid=dcc.invdocdetailsid where D.invdocdetailsid in ("+l+")")).length&&(h=null):(this.SelectedLinkedDocs.forEach((function(e){l.length>0&&(l+=","),l+="'"+e[D.colVoucherID].toString()+"'"})),h=n.a.report.ReportDataTable("RPT022",!1,"select top 1 D.DebitAccount,D.CreditAccount,dcc.* from INV_DocDetails D with(Nolock) join com_docccdata dcc with(nolock) on D.invdocdetailsid=dcc.invdocdetailsid where D.VoucherNo in ("+l+")")),c=new u(parseInt(e.CostCenterID),e.DocumentName,null==h,h),Object.assign(a,{component:o,params:{obj:c}}),h.length>0&&("True"==c.ScreenObject.Preferences["Debit Account"]?c.ScreenObject.DebitAccount.SelectedValue=h[0].DebitAccount:"True"==c.ScreenObject.Preferences["Credit Account"]&&(c.ScreenObject.DebitAccount.SelectedValue=h[0].CreditAccount)),this.SelectedLinkedDocs.forEach((function(t){c.FillLink(t[D.colVoucherID],e.DocumentLinkDefID,t._LinkedIDs,new Array)})),n.a.page.addNewTab(a);case 17:case"end":return t.stop()}}),t,this)})))}},{key:"NewDocument",value:function(e,t){return Object(a.b)(this,void 0,void 0,regeneratorRuntime.mark((function a(){var i,o,r,u,l,h;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return i={},a.next=3,Promise.resolve().then(s.bind(null,"MCKn"));case 3:return o=a.sent,r=o.AddEditDocumentComponent,a.next=7,Promise.resolve().then(s.bind(null,"1Cra"));case 7:u=a.sent,l=u.AddEditDocumentViewModel,h=new l(parseInt(e),t,!1),Object.assign(i,{component:r,params:{obj:h}}),n.a.page.addNewTab(i);case 11:case"end":return a.stop()}}),a)})))}},{key:"OnStatusClick",value:function(e){this.ExtWhereLinkStatus&&(this.ExtWhere="",this.ExtWhereLinkStatus=!1),this.SelectedLinkedDocs.Clear(),this.StatusList.map((function(e){return e.IsSelected=!1})),this.LinkStatusList.map((function(e){return e.IsSelected=!1})),e.IsSelected=!0,this.SelectedStatus=e;var t=this.GetQuery(1);this.LoadData(t)}},{key:"LoadData",value:function(e){var t=this;this.DisplayName="Loading...",this.OnRowChange(null),n.a.report.DataSetAsyn("RPT022",e).then((function(e){var s,a,i,n,o,r,u=t.SelectedStatus?t.SelectedStatus.StatusID:0,l=e;(t.GridObj.Clear(),l.Tables[0].forEach((function(e){e.id=t.GridObj.rowid,e.select=!1,t.colStatusID.length>0&&(e[t.colStatusID+"_CLR"]=m.AddEditDocumentViewModel.getStatusColor(e._StatusID)),(s=t.SelectedLinkedDocs.find((function(s){return s[t.colVoucherID]==e[t.colVoucherID]})))&&(-1!=(a=t.SelectedLinkedDocs.indexOf(s))&&(e._LinkedIDs=s._LinkedIDs,e.select=!0,t.SelectedLinkedDocs[a]=e)),t.lstDateCols.forEach((function(t){e[t.ID+"_Key"]=new Date(e[t.ID]),e[t.ID]=e[t.ID+"_Key"].ToString(t.DataFormat.DateType)})),t.colAccStatusID.length>0&&(i=h.e.Int(e._BillAmt),n=h.e.Int(e._AdjAmt),0!=i&&(0==n?(e._AccStatus="Unpaid",e._AccStatus_CLR="#017EFA"):i-n==0?(e._AccStatus="Paid",e._AccStatus_CLR="#21bf74"):(e._AccStatus="Partially-Paid",e._AccStatus_CLR="#FF9700")))})),t.ExecutedQty.length>0)&&l.Tables[0].forEach((function(e){o=h.e.Int(e.DQty),0==(r=h.e.Int(e.DExQty))?(e._LinkStatus="Pending",e._LinkStatus_CLR="#017EFA"):0!=r&&o-r>0?(e._LinkStatus="Partially-Executed",e._LinkStatus_CLR="#FF9700"):(e._LinkStatus="Executed",e._LinkStatus_CLR="#21bf74")}));t.GridObj.addRows(l.Tables[0]),l.Tables.length>1?(u<0?(t.TotalRows=l.Tables[2].filter((function(e){return e.StatusID==u})).Compute("sum","CNT"),t.TotalPages=Math.floor(t.TotalRows/t.PageSize),t.TotalRows%t.PageSize>0&&t.TotalPages++):(t.TotalRows=l.Tables[1].Compute("sum","CNT"),t.TotalPages=Math.floor(t.TotalRows/t.PageSize),t.TotalRows%t.PageSize>0&&t.TotalPages++),0==u&&(t.OverallTotalRows=t.TotalRows.Commas("N0"),t.StatusList.Clear(),l.Tables[1].forEach((function(e){e.Clr=m.AddEditDocumentViewModel.getStatusColor(e.StatusID),e.CNTText=h.e.Int(e.CNT).Commas("N0"),e.Per=t.TotalRows>0?100*h.e.Int(e.CNT)/t.TotalRows:h.e.Int(e.CNT)>0?100:0,e.PerText=e.Per-Math.floor(e.Per)!=0?e.Per.Commas("N1")+"%":e.Per.Commas("N0")+"%",e.SOrder=371==e.StatusID?1:441==e.StatusID?2:372==e.StatusID?3:369==e.StatusID?4:376==e.StatusID?5:443==e.StatusID?6:445==e.StatusID?7:1e3})),l.Tables[1].SortBy(["SOrder"]),t.StatusList=l.Tables[1]),t.LoadDocLinkStatus()):null!=t.SelectedStatus&&t.CalculatePages(t.SelectedStatus.CNT);var c=(t.PageNo-1)*t.PageSize;t.CurrentRecords=(c+1).toString()+" - "+(c+l.Tables[0].length).toString()})).finally((function(){t.DisplayName=t.Title}))}},{key:"LoadDocLinkStatus",value:function(){var e=this;this.LinkStatusList.Clear(),0!=this.ExecutedQuery.length&&n.a.report.DataSetAsyn("RPT022",this.ExecutedQuery).then((function(t){if(0!=t.Tables.length){if(t.Tables[0].forEach((function(t){-2==t.StatusID?(t.Clr="#21bf74",t.Status="Excuted"):-3==t.StatusID?(t.Clr="#FF9700",t.Status="Partially-Excuted"):(t.Clr="#017EFA",t.Status="Open"),t.CNTText=h.e.Int(t.CNT).Commas("N0"),t.Per=e.TotalRows>0?100*h.e.Int(t.CNT)/e.TotalRows:h.e.Int(t.CNT)>0?100:0,t.PerText=t.Per-Math.floor(t.Per)!=0?t.Per.Commas("N1")+"%":t.Per.Commas("N0")+"%"})),e.ExtWhereLinkStatus){var s=t.Tables[0].find((function(t){return t.StatusID==parseInt(e.ExtWhere)}));s&&e.CalculatePages(s.CNT)}e.LinkStatusList=t.Tables[0]}}))}},{key:"CalculatePages",value:function(e){this.TotalRows=e,this.TotalPages=Math.floor(this.TotalRows/this.PageSize),this.TotalRows%this.PageSize>0&&this.TotalPages++}},{key:"GetQuery",value:function(e){var t,s=this,a=this.SelectedStatus?this.SelectedStatus.StatusID:0,i="",o="",r="",u="",l=!1;return t=this.rpt.FromTag.Contains("INV")?"INV":"ACC",this.ExtWhereLinkStatus&&(a=parseInt(this.ExtWhere)),this.rpt.BaseReportColumns.forEach((function(e){e.CDGDO.ActualColumn&&(e.CDGDO.ActualColumn.Contains("(SELECT")||("FLOAT"==e.CDGDO.DataType?o+=",sum("+e.CDGDO.ActualColumn+") "+e.ID:e.CDGDO.ActualColumn.startsWith("stuff(")||e.CDGDO.ActualColumn.startsWith("STUFF(")?(l=!0,o+=","+e.CDGDO.ActualColumn+" "+e.ID):(o+=",max("+e.CDGDO.ActualColumn+") "+e.ID,s.colStatusID==e.ID&&(o+=",max("+e.CDGDO.ActualColumn+"ID) _StatusID"))))})),this.colAccStatusID.length>0&&(o+=",(SELECT ISNULL(SUM(abs(AdjAmount)),0) FROM COM_Billwise CB WITH(NOLOCK) WHERE CB.DocNo=INV.VoucherNo) _BillAmt\n            ,(SELECT ISNULL(SUM(abs(AdjAmount)),0) FROM COM_Billwise CB WITH(NOLOCK) WHERE IsNewReference=0 AND (CB.RefDocNo=INV.VoucherNo OR CB.DocNo=INV.VoucherNo)) _AdjAmt"),this.LinkStatusCol&&this.ExecutedQty.length>0||a<0?(i="with rows as ( SELECT row_number() over (order by DDocID desc) rowno,* from (SELECT ",i+="(select sum(DExQty) from (select  ("+this.ExecutedQty.split("INV.").join("D.")+") DExQty\nfrom INV_DocDetails D with(nolock)"+this.ExecutedQueryJoin.replace("INV.","D.")+" where D.DocID=INV.DocID\n) AS T)\nDExQty\n, sum(INV.Quantity) DQty\n,INV.DocID DDocID\n",i+=o):i="with rows as ( SELECT row_number() over (order by "+t+".DocID desc) rowno"+o,i+="\nFROM "+this.rpt.FromTag,this.ExecutedQueryJoin.length>0&&-1!=i.indexOf("sum(DExQty)")&&(i+=this.ExecutedQueryJoin),r=this.rpt.WhereTag,""==this.rpt.WhereTag?r=t+".CostCenterID="+this.Documents.SelectedValue:r+=" and "+t+".CostCenterID="+this.Documents.SelectedValue,2!=n.a.SessionManager.RoleType&&3!=n.a.SessionManager.RoleType||(r+=" and ("+t+".DebitAccount="+n.a.SessionManager.ESSID+" or "+t+".CreditAccount="+n.a.SessionManager.ESSID+")"),this.ExtWhereLinkStatus||(r+=this.ExtWhere),a>0&&(r+=" and "+t+".StatusID="+a),i+="\nWHERE "+r,u=t+".DocID,"+t+".VoucherNo",l&&(u=t+".CostCenterID,"+u),i+="\nGROUP BY "+u,this.LinkStatusCol&&this.ExecutedQty.length>0||a<0?(i+=") AS T",a<0&&(i+=-2==a?" where DQty-DExQty<=0":-3==a?" where DExQty!=0 and  DQty-DExQty>0":" where DExQty=0"),i+=") select * from rows WHERE rowno>"+(e-1)*this.PageSize+" and rowno<="+e*this.PageSize+" order by rowno"):i+=") select * from rows WHERE rowno>"+(e-1)*this.PageSize+" and rowno<="+e*this.PageSize+" order by rowno",1!=e||0!=a&&!this.ExtWhereLinkStatus||(i+="\nselect S.StatusID,S.Status,count(*) CNT from (\nSELECT "+t+".StatusID,"+t+".DocID\nFROM "+this.rpt.FromTag+"\nWHERE "+r+"\nGROUP BY "+t+".StatusID,"+u+") AS T\njoin COM_Status S with(nolock) on S.StatusID=T.StatusID\ngroup by S.StatusID,S.Status",this.ExecutedQty.length>0&&(this.ExecutedQuery="\n        select StatusID,count(*) CNT from(\n        select DocID,case when sum(DExQty)=0 then -1 when sum(Quantity)>sum(DExQty) then -3 else -2 end StatusID from (\n        SELECT "+t+".DocID,"+t+".Quantity,"+this.ExecutedQty+" DExQty\n        FROM "+this.rpt.FromTag+this.ExecutedQueryJoin+"\n        WHERE "+r+"\n        ) AS T GROUP BY DocID) AS T group by StatusID order by StatusID desc")),this.PageNo=e,i}},{key:"GetPrefValue",value:function(e){var t=this,s=this.dsRpt.Tables[3].find((function(s){return s.PrefName==e&&s.CostCenterID==parseInt(t.Documents.SelectedValue)}));return s?h.e.String(s.PrefValue):""}},{key:"RoleType",get:function(){return n.a.SessionManager.RoleType}}]),i}(i.b)}}]);