function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,s){return t&&_defineProperties(e.prototype,t),s&&_defineProperties(e,s),e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var s,i=_getPrototypeOf(e);if(t){var n=_getPrototypeOf(this).constructor;s=Reflect.construct(i,arguments,n)}else s=i.apply(this,arguments);return _possibleConstructorReturn(this,s)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[72],{m0Sd:function(e,t,s){"use strict";s.r(t),s.d(t,"QuickAddCostCenterViewModel",(function(){return f}));var i=s("Do2H"),n=s("eQJW"),r=s("Lp6j"),a=s("ScVY"),o=s("vTM8"),h=s("VxiT"),l=s("EQd/"),c=s("n56n"),u=s("0/4Q"),C=s("4HhE"),d=s("ru5v"),b=s("sW9y"),S=s("NkMH"),m=s("2pkr"),D=s("Upsa"),g=s("4k0m"),p=s("++IR"),f=function(e){_inherits(s,e);var t=_createSuper(s);function s(){var e;return _classCallCheck(this,s),(e=t.call(this)).PactScreenID="0",e.ht=new o.a,e.ScreenObject=new h.a,e.Code=new l.a(0),e.Name=new l.d(0),e.Alias=new l.d(0),e.CreditDays=new l.d(0),e.CreditLimit=new l.d(0),e.DebitDays=new l.d(0),e.DebitLimit=new l.d(0),e.Status=new u.e(0),e.SalesAccount=new c.b(0),e.PurchaseAccount=new c.b(0),e.CurrencyID=new c.b(0),e.Group=new c.b(0),e.SaveCostCenter=new C.b,e.objCostCenter=new d.a,e.ScreenData=[],e.DefStatusID=1,e.ButtonSave=new S.a,e.DimLength=new l.d(0),e.DimWidth=new l.d(0),e.DimHeight=new l.d(0),e.DimVolume=new l.d(0),e.DimWeight=new l.d(0),e.lstKeyWords=[],e.RetValue=0,e.QuickAssign=new b.a,e}return _createClass(s,[{key:"QuickAddCostCenterViewModel",value:function(e,t,s,n,a){Logger.InfoLog("QuickAddCostCenterViewModel::Entering QuickAddCostCenterViewModel With ID ="+e+"CostCenterID"+t+"Parent"+this.Parent+"ScreenName"+n),this.objCostCenter.CostCenterID=t,this.CostCenterID=t,this.PactScreenID=t.toString(),this.ScreenData=this.BuildControls(),this.NodeID=e,this.ParentId=s,this.SelectedGroup=s,this.IsGroup=a,this.Title=0==this.NodeID?i.a.GetResource("Add")+" "+n:i.a.GetResource("Edit")+" "+n,this.IsGroup&&(this.Title=this.Title+" Group"),this.GetColumnDefDataset(t);var o=0;if(r.e.IsEmpty(i.a.SessionManager.Preferences["Report Template Dimension"])||"0"==i.a.SessionManager.Preferences["Report Template Dimension"].toString()||(o=parseInt(i.a.SessionManager.Preferences["Report Template Dimension"].toString())),this.DetailsVisibility=o!=t&&!this.IsGroup,r.e.String(i.a.SessionManager.Preferences.OnlineLevel1Dim)==t.toString()&&(this.DetailsVisibility=!0),50052==t){this.DisplayName=n;var h=n.lastIndexOf("-");h>=0&&(this.DisplayName=n.substr(0,h),this.ScreenObject.CGParentID=parseInt(n.substr(h+1))),this.DetailsVisibility=!1}else this.DisplayName=n;this.ScreenData=this.BuildControls(),this.DisplayMessage="",this.OnLoad(e,t),this.FillControls(),this.SaveCostCenter.Subscribe(this,"onSaveCostCenter"),Logger.InfoLog("QuickAddCostCenterViewModel::BuildControls Success")}},{key:"FillKeyWords",value:function(){this.lstKeyWords.push("Basic"),this.lstKeyWords.push("Gross"),this.lstKeyWords.push("ServiceDays"),this.lstKeyWords.push("WeeklyOffs"),this.lstKeyWords.push("LeavesTaken"),this.lstKeyWords.push("TotalDays"),this.lstKeyWords.push("DaysAttended"),this.lstKeyWords.push("UnpaidDays"),this.lstKeyWords.push("LOPDays"),this.lstKeyWords.push("Holidays"),this.lstKeyWords.push("AdjDays"),this.lstKeyWords.push("EmpType"),this.lstKeyWords.push("Gender"),this.lstKeyWords.push("MaritalStatus"),this.lstKeyWords.push("Nationality"),this.lstKeyWords.push("Religion"),this.lstKeyWords.push("ChildrenCount"),this.lstKeyWords.push("ChildrenDays"),this.lstKeyWords.push("VacDaysTaken"),this.lstKeyWords.push("VacDays"),this.lstKeyWords.push("VacAmount"),this.lstKeyWords.push("VacEncashDays"),this.lstKeyWords.push("VacEncashAmount"),this.lstKeyWords.push("VacExcessDays"),this.lstKeyWords.push("VacExcessAmount"),this.lstKeyWords.push("VacNetAmount"),this.lstKeyWords.push("PayrollMonthNo"),this.lstKeyWords.push("TotCheckInLateMins"),this.lstKeyWords.push("TotCheckOutEarlyMins"),this.lstKeyWords.push("TotBreak1MoreMins"),this.lstKeyWords.push("TotBreak2MoreMins"),this.lstKeyWords.push("TotBreak3MoreMins"),this.lstKeyWords.push("TotBreak4MoreMins"),this.lstKeyWords.push("TotBreak5MoreMins"),this.lstKeyWords.push("TotLateHrsToDeduct"),this.lstKeyWords.push("TotLateLeavesToDeduct")}},{key:"OnLoad",value:function(e,t){var s=this;this.ButtonSave=new S.a,0==e?i.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=i.a.SessionManager.IsActionAssigned(t,"Create"):this.ButtonSave.Enable=i.a.SessionManager.IsActionAssigned(t,"Create"):(this.ScreenObject.IsEdit=!0,i.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=i.a.SessionManager.IsActionAssigned(t,"Update"):this.ButtonSave.Enable=i.a.SessionManager.IsActionAssigned(t,"Update")),this.ScreenObject.LoadQuickScreen(this,t,this.IsGroup),this.QuickAssign=new b.a,this.QuickAssign.QuickAssignGrid_1(t,this.ScreenObject.Data,this.IsGroup);var a=[];if(this.ht.ContainsKey("Name")&&(this.Name=this.ScreenObject.GetQuickText(parseInt(this.ht.Name)),null!=this.Name&&this.Name.LostFocusCommand.Subscribe(this,"OnNameLostFocus")),null!=this.ScreenObject.Data&&this.ScreenObject.Data.Tables.length>7&&this.ScreenObject.Data.Columns[7].Contains("IsParentCodeInherited")&&this.ScreenObject.Data.Tables[7].length>0){this.ScreenObject.InitAutoCode(this.ScreenObject.Data.Tables[7],this.IsGroup);var o=this.ScreenObject.StaticFields.find((function(e){return"GroupSeqNoLength"==e.DBColumnName}));null==o||this.IsGroup||(o.Visible=!1),null!=this.Name&&((a=this.ScreenObject.Data.Tables[5].filter((function(e){return"CapsLock"==e.Name}))).length>0&&Object(n.j)(a[0].Value)&&(this.Name.IsAllCaps=!0),(a=this.ScreenObject.Data.Tables[5].filter((function(e){return"CapsToFirstLetter"==e.Name}))).length>0&&Object(n.j)(a[0].Value)&&(this.Name.IsFirstLetterCaps=!0))}if(this.ht.ContainsKey("Code")&&(this.Code=this.ScreenObject.GetQuickCode(parseInt(this.ht.Code))),this.ht.ContainsKey("StatusID")&&(this.Status=this.ScreenObject.GetQuickCombo(parseInt(this.ht.StatusID)),null!=this.Status?(this.ScreenObject.Data.Tables[3].forEach((function(e){s.Status.Items.push(u.d.ComboBoxItems_2(r.e.String(e.Status),r.e.String(e.StatusID)))})),r.e.IsEmpty(this.Status.DefaultValue)?this.ScreenObject.Data.Tables[3].length>0&&(this.Status.SelectedValue=this.ScreenObject.Data.Tables[3][0].StatusID.toString()):this.Status.SelectedValue=this.Status.DefaultValue,!r.e.IsEmpty(this.Status.SelectedValue)&&this.ScreenObject.Data.Tables[3].length>0&&(this.DefStatusID=parseInt(this.ScreenObject.Data.Tables[3][0].StatusID))):this.ScreenObject.Data.Tables[3].length>0&&(this.DefStatusID=parseInt(this.ScreenObject.Data.Tables[3][0].StatusID))),this.ht.ContainsKey("IsGroup")&&(this.Group=this.ScreenObject.GetQuickField(parseInt(this.ht.IsGroup)),null!=this.Group&&(0!=this.ParentId&&0==this.NodeID&&(this.Group.SelectedValue=this.ParentId,this.Group.Enable=!1),this.Group.SelectionChangedCommand.Subscribe(this,"OnGroupSelectionChanged"))),this.ht.ContainsKey("AliasName")&&(this.Alias=this.ScreenObject.GetQuickText(parseInt(this.ht.AliasName))),this.ht.ContainsKey("SalesAccount")&&(this.SalesAccount=this.ScreenObject.GetQuickField(parseInt(this.ht.SalesAccount))),this.ht.ContainsKey("CurrencyID")&&(this.CurrencyID=this.ScreenObject.GetQuickField(parseInt(this.ht.CurrencyID))),this.ht.ContainsKey("PurchaseAccount")&&(this.PurchaseAccount=this.ScreenObject.GetQuickField(parseInt(this.ht.PurchaseAccount))),this.ht.ContainsKey("CreditDays")&&(this.CreditDays=this.ScreenObject.GetQuickField(parseInt(this.ht.CreditDays))),this.ht.ContainsKey("CreditLimit")&&(this.CreditLimit=this.ScreenObject.GetQuickField(parseInt(this.ht.CreditLimit))),this.ht.ContainsKey("DebitDays")&&(this.DebitDays=this.ScreenObject.GetQuickField(parseInt(this.ht.DebitDays))),this.ht.ContainsKey("DebitLimit")&&(this.DebitLimit=this.ScreenObject.GetQuickField(parseInt(this.ht.DebitLimit))),i.a.SessionManager.Preferences.ContainsKey("Report Template Dimension")&&""!=i.a.SessionManager.Preferences["Report Template Dimension"]&&t==parseInt(i.a.SessionManager.Preferences["Report Template Dimension"])&&"TRUE"==i.a.SessionManager.Preferences.WEFINReportTemplate.toUpperCase()){if((a=this.ScreenObject.Data.Tables[0].filter((function(e){return"ccAlpha44"==e.SysColumnName}))).length>0){var h=this.ScreenObject.GetQuickField(parseInt(a[0].CostCenterColID));if(null!=h){var l=h.Items.find((function(e){return"Show Closing"==e.Value}));null!=l&&h.Items.Remove(l)}}}else if(i.a.SessionManager.Preferences.ContainsKey("PackDimension")&&""!=i.a.SessionManager.Preferences.PackDimension&&t==parseInt(i.a.SessionManager.Preferences.PackDimension)){if((a=this.ScreenObject.Data.Tables[0].filter((function(e){return"ccalpha46"==e.SysColumnName}))).length>0&&(this.DimLength=this.ScreenObject.GetQuickText(parseInt(a[0].CostCenterColID)),null!=this.DimLength)){this.DimLength.TextChangedCommand.Subscribe(this,"onTextValueChanged");var c=0,C=this.ScreenObject.Data.Tables[5].filter((function(e){return"LengthDecimals"==e.Name}));null!=C&&C.length>0&&(c=r.e.IntTryParse(C[0].Value.toString())),this.DimLength.DecimalPoints=c.toString(),this.DimLength.LostFocusCommand.Subscribe(this,"onLostFocus")}if((a=this.ScreenObject.Data.Tables[0].filter((function(e){return"ccalpha47"==e.SysColumnName}))).length>0&&(this.DimWidth=this.ScreenObject.GetQuickText(parseInt(a[0].CostCenterColID)),null!=this.DimWidth)){this.DimWidth.TextChangedCommand.Subscribe(this,"onTextValueChanged");var d=0,m=this.ScreenObject.Data.Tables[5].filter((function(e){return"WidthDecimals"==e.Name}));null!=m&&m.length>0&&(d=r.e.IntTryParse(m[0].Value.toString())),this.DimWidth.DecimalPoints=d.toString(),this.DimWidth.LostFocusCommand.Subscribe(this,"onLostFocus")}if((a=this.ScreenObject.Data.Tables[0].filter((function(e){return"ccalpha48"==e.SysColumnName}))).length>0&&(this.DimHeight=this.ScreenObject.GetQuickText(parseInt(a[0].CostCenterColID)),null!=this.DimHeight)){this.DimHeight.TextChangedCommand.Subscribe(this,"onTextValueChanged");var D=0,g=this.ScreenObject.Data.Tables[5].filter((function(e){return"HeightDecimals"==e.Name}));null!=g&&g.length>0&&(D=r.e.IntTryParse(g[0].Value.toString())),this.DimHeight.DecimalPoints=D.toString(),this.DimHeight.LostFocusCommand.Subscribe(this,"onLostFocus")}if((a=this.ScreenObject.Data.Tables[0].filter((function(e){return"ccalpha49"==e.SysColumnName}))).length>0&&(this.DimVolume=this.ScreenObject.GetQuickText(parseInt(a[0].CostCenterColID)),null!=this.DimVolume)){var p=0,f=this.ScreenObject.Data.Tables[5].filter((function(e){return"VolumeDecimals"==e.Name}));null!=f&&f.length>0&&(p=r.e.IntTryParse(f[0].Value.toString())),this.DimVolume.DecimalPoints=p.toString(),this.DimVolume.LostFocusCommand.Subscribe(this,"onLostFocus")}if((a=this.ScreenObject.Data.Tables[0].filter((function(e){return"ccalpha50"==e.SysColumnName}))).length>0&&(this.DimWeight=this.ScreenObject.GetQuickText(parseInt(a[0].CostCenterColID)),null!=this.DimWeight)){var j=0,y=this.ScreenObject.Data.Tables[5].filter((function(e){return"WeightDecimals"==e.Name}));null!=y&&y.length>0&&(j=r.e.IntTryParse(y[0].Value.toString())),this.DimWeight.DecimalPoints=j.toString(),this.DimWeight.LostFocusCommand.Subscribe(this,"onLostFocus")}}if((a=this.ScreenObject.Data.Tables[5].filter((function(e){return"BinsDimension"==e.Name}))).length>0&&a[0].Value.toString()==t.toString()){if((a=this.ScreenObject.Data.Tables[0].filter((function(e){return"ccalpha47"==e.SysColumnName}))).length>0&&(this.DimLength=this.ScreenObject.GetQuickText(parseInt(a[0].CostCenterColID)),null!=this.DimLength)){this.DimLength.TextChangedCommand.Subscribe(this,"onTextValueChanged");var I=0,T=this.ScreenObject.Data.Tables[5].filter((function(e){return"LengthDecimals"==e.Name}));null!=T&&T.length>0&&(I=r.e.IntTryParse(T[0].Value.toString())),this.DimLength.DecimalPoints=I.toString(),this.DimLength.LostFocusCommand.Subscribe(this,"onLostFocus")}if((a=this.ScreenObject.Data.Tables[0].filter((function(e){return"ccalpha48"==e.SysColumnName}))).length>0&&(this.DimWidth=this.ScreenObject.GetQuickText(parseInt(a[0].CostCenterColID)),null!=this.DimWidth)){this.DimWidth.TextChangedCommand.Subscribe(this,"onTextValueChanged");var O=0,N=this.ScreenObject.Data.Tables[5].filter((function(e){return"WidthDecimals"==e.Name}));null!=N&&N.length>0&&(O=r.e.IntTryParse(N[0].Value.toString())),this.DimWidth.DecimalPoints=O.toString(),this.DimWidth.LostFocusCommand.Subscribe(this,"onLostFocus")}if((a=this.ScreenObject.Data.Tables[0].filter((function(e){return"ccalpha49"==e.SysColumnName}))).length>0&&(this.DimHeight=this.ScreenObject.GetQuickText(parseInt(a[0].CostCenterColID)),null!=this.DimHeight)){this.DimHeight.TextChangedCommand.Subscribe(this,"onTextValueChanged");var P=0,L=this.ScreenObject.Data.Tables[5].filter((function(e){return"HeightDecimals"==e.Name}));null!=L&&L.length>0&&(P=r.e.IntTryParse(L[0].Value.toString())),this.DimHeight.DecimalPoints=P.toString(),this.DimHeight.LostFocusCommand.Subscribe(this,"onLostFocus")}if((a=this.ScreenObject.Data.Tables[0].filter((function(e){return"ccalpha50"==e.SysColumnName}))).length>0&&(this.DimVolume=this.ScreenObject.GetQuickText(parseInt(a[0].CostCenterColID)),null!=this.DimVolume)){var A=0,G=this.ScreenObject.Data.Tables[5].filter((function(e){return"VolumeDecimals"==e.Name}));null!=G&&G.length>0&&(A=r.e.IntTryParse(G[0].Value.toString())),this.DimVolume.DecimalPoints=A.toString(),this.DimVolume.LostFocusCommand.Subscribe(this,"onLostFocus")}}}},{key:"onTextValueChanged",value:function(e){var t=0,s=0,i=0;null!=this.DimLength&&(t=r.e.DoubleTryParse(this.DimLength.Text)),null!=this.DimWidth&&(s=r.e.DoubleTryParse(this.DimWidth.Text)),null!=this.DimHeight&&(i=r.e.DoubleTryParse(this.DimHeight.Text)),null!=this.DimVolume&&(this.DimVolume.Text=(t*s*i).toString())}},{key:"onLostFocus",value:function(e){r.e.IsNum(e.Text)&&(e.Text=(0).ToString("N"+e.DecimalPoints)),this.ScreenObject.onTextBoxLostFocus(e)}},{key:"OnGroupSelectionChanged",value:function(e){this.Group.SelectedValue>0&&(this.Group.DefaultValue=this.Group.SelectedValue.toString(),this.ParentId=this.Group.SelectedValue,this.AutoGenerateCode(),this.LoadParentData())}},{key:"AutoGenerateCode",value:function(){if(0==this.NodeID&&null!=this.Code&&(this.ScreenObject.SetAutoCode(this.Code,this.IsGroup,this.ParentId,this.ScreenObject.Data.Tables[7]),this.ScreenObject.IsAutoName&&null!=this.Name)){this.ScreenObject.IsNameAutoGenerate=!0,this.Name.Enable=!1;var e=this.ScreenObject.Data.Tables[7];e=e.filter((function(e){return 1==e.IsName})),this.ScreenObject.IsName=!0,e.length>0&&(this.Name.Text=this.ScreenObject.SetAutoCodeParams_1(this.Name,this.ParentId,e))}}},{key:"FillControls",value:function(){if(0!=this.NodeID){this.objCostCenter.NodeID=this.NodeID;var e=i.a.common.GetCostCenterDetails(0,this.CostCenterID,this.objCostCenter.NodeID,0);Object.assign(this.objCostCenter,e.obj),this.NodeID=this.objCostCenter.NodeID,this.QuickAssign.LoadGrid(this.objCostCenter.NodeID,e.Tables[10]),null!=this.Code&&(this.Code.Text=this.objCostCenter.Code,(this.ScreenObject.InheritParentCode||this.ScreenObject.IsAutoCode)&&(this.Code.Enable=parseInt(e.Tables[0][0].Depth)<=1&&!this.ScreenObject.IsRootAutoCode)),null!=this.Name&&this.ScreenObject.IsAutoName&&(this.Name.Enable=!1),this.ScreenObject.FillControls(e.Tables[0][0],e.Tables[0][0],e.Tables[7].length>0?e.Tables[7][0]:null,null,null,e.Tables[3]),this.ScreenObject.CanApprove(e.Tables[0][0],e.Tables[11][0],this.ButtonSave),e.Tables[7].length>0&&this.ScreenObject.LoadCustomFieldsCCData(e.Tables[7],e.Tables[13]),null!=this.ScreenObject.StatusAssignGrid&&this.ScreenObject.StatusAssignGrid.Load(e.Tables[14]),null!=this.Group&&(this.Group.SelectedValue=parseInt(e.Tables[0][0].ParentID.toString()),this.Group.Enable=!1),i.a.SessionManager.IsOffline&&this.NodeID>0&&(this.ButtonSave.Visible=!1)}else this.AutoGenerateCode(),this.LoadParentData(),this.objCostCenter.GUID=""}},{key:"BuildControls",value:function(){Logger.InfoLog("QuickAddCostCenterViewModel::Entering BuildControls");try{return(new h.a).GetControls(this.PactScreenID,i.a.SessionManager.CompanyIndex)}catch(e){return Logger.ErrorLog("QuickAddCostCenterViewModel:: BuildControls"+e.stack),null}}},{key:"GetColumnDefDataset",value:function(e){try{var t=this.objCostCenter.GetColumnDefination(this.PactScreenID,i.a.SessionManager.CompanyIndex);if(null!=t&&t.Tables[0].length>0)for(var s=0;s<t.Tables[0].length;s++)this.ht.ContainsKey(t.Tables[0][s].SYSCOLUMNNAME.toString())||this.ht.push(t.Tables[0][s].SYSCOLUMNNAME.toString(),t.Tables[0][s].COSTCENTERCOLID.toString())}catch(n){Logger.ErrorLog("AddCostCenterViewModel:: GetColumnDefination "+n.stack)}}},{key:"onSaveCostCenter",value:function(e){var t=this;if(Logger.InfoLog("QuickAddCostCenterViewModel::Entering onSaveCostCenter"),"Cancel"==e)null!=this.Parent?(this.Parent.AddEditCosCenterVisibility=!1,this.Parent.SetDetailsVisibility()):i.a.page.HideDialog();else if("Save"==e)this.SaveMethod();else if("Details"==e)i.a.page.ShowLoading=!0,setTimeout((function(){i.a.page.HideDialog();var e=new m.AddCostCenterViewModel(t.CostCenterID);e.AddCostCenterViewModel_1(t.NodeID,t.CostCenterID,t.SelectedGroup,t.Title,t.IsGroup);var s={obj:e};e.Parent=t.Parent,null!=t.Name&&(e.Name.Text=t.Name.Text),null!=t.Code&&(e.Code.Text=t.Code.Text,e.Code.PrefixCode=t.Code.PrefixCode),e.OnGroupSelectionChanged("Group"),e.ScreenObject.CopyQuickToDetail(t.ScreenObject.StaticFields,[null!=t.Code?t.Code.DBColumnID:0,null!=t.Name?t.Name.DBColumnID:0]),i.a.page.addNewTab({title:t.Title,component:D.AddEditCostcenterComponent,params:s})}),50);else if("ShowApprove"==e){var s=new g.a(this.CostCenterID,this.objCostCenter.NodeID,this.ScreenObject,this);i.a.page.ShowDialog(s,p.a,{ShowCenter:!0,Title:i.a.GetResource("ApproveReject")})}}},{key:"SaveMethod",value:function(){var e=this;try{this.objCostCenter.NodeID=this.NodeID,this.objCostCenter.CostCenterID=this.CostCenterID;var t,s=0;if(0==this.NodeID){this.ScreenObject.IsName=!1;var n=[];if(n=(n=this.ScreenObject.Data.Tables[7]).filter((function(e){return 0==e.IsName})),this.DisplayMessage=this.ScreenObject.SetAutoCodeParams_3(this.Code,this.ParentId,n,{StrCode:this.objCostCenter.Code,CodePrefix:this.objCostCenter.CodePrefix,CodeNumber:this.objCostCenter.CodeNumber}),this.DisplayMessage.length>0)return}else if(this.NodeID>0&&!this.Code.Enable&&!this.ScreenObject.CodeSeqExist){this.ScreenObject.IsName=!1;var a=[];if(a=(a=this.ScreenObject.Data.Tables[7]).filter((function(e){return 0==e.IsName})),this.ScreenObject.SetAutoCodeParams_3(this.Code,this.ParentId,a,{StrCode:this.objCostCenter.Code,CodePrefix:this.objCostCenter.CodePrefix,CodeNumber:this.objCostCenter.CodeNumber}),this.DisplayMessage.length>0)return}else this.objCostCenter.Code=this.Code.Text,this.Code.Code=this.Code.Text;if(this.ScreenObject.IsAutoName&&null!=this.Name&&!this.Name.Enable){this.ScreenObject.IsNameAutoGenerate=!0,this.Name.Enable=!1;var o=this.ScreenObject.Data.Tables[7];o=o.filter((function(e){return 1==e.IsName})),this.ScreenObject.IsName=!0,o.length>0&&(this.Name.Text=this.ScreenObject.SetAutoCodeParams_1(this.Name,this.ParentId,o),this.objCostCenter.Name=this.Name.Text.Trim())}if(this.DisplayMessage=this.ScreenObject.ValidateData(),this.DisplayMessage.length>0)return;if(50052==this.CostCenterID){this.FillKeyWords();for(var h=0;h<=this.lstKeyWords.length-1;h++)if(this.Name.Text.toUpperCase().Trim()==this.lstKeyWords[h].toUpperCase().toString())return void(this.DisplayMessage="Cannot save the Reserve Word");2!=this.ParentId&&3!=this.ParentId&&4!=this.ParentId&&5!=this.ParentId||(this.Name.Text=this.Name.Text.Replace(" ",""))}if(0==this.objCostCenter.NodeID){if(50002==this.CostCenterID&&i.a.SessionManager.LicenseSettings.ContainsKey("MaxLocations")){var l;l=r.e.IntTryParse(i.a.SessionManager.LicenseSettings.MaxLocations);var c=i.a.common.GetDataTable("QACCVM001","");if(l>0&&l<=parseInt(c.Rows[0][0]))return void(this.DisplayMessage="Maximum "+l.toString()+" Locations Allowed")}if(null!=this.Code){var u=this.ScreenObject.Data.Tables[7];u=u.filter((function(e){return 0==e.IsName}));var C={StrCode:this.objCostCenter.Code,CodePrefix:this.objCostCenter.CodePrefix,CodeNumber:this.objCostCenter.CodeNumber};if(this.DisplayMessage=this.ScreenObject.SetAutoCodeParams_3(this.Code,this.ParentId,u,C),this.objCostCenter.Code=C.StrCode,this.objCostCenter.CodePrefix=r.e.String(C.CodePrefix),this.objCostCenter.CodeNumber=C.CodeNumber,this.DisplayMessage.length>0)return}this.objCostCenter.Name=null!=this.Name?this.Name.Text.Trim():this.objCostCenter.Code,this.objCostCenter.AliasName=null!=this.Alias?this.Alias.Text:this.objCostCenter.Name,50052==this.CostCenterID&&null!=this.Alias&&(this.Alias.Text=""!=this.Alias.Text.Trim().toString()?this.Alias.Text:this.objCostCenter.Name,this.objCostCenter.AliasName=this.Alias.Text),this.objCostCenter.SelectedGroup=null!=this.Group?this.Group.SelectedValue:this.ParentId,this.objCostCenter.Status=null!=this.Status?r.e.IsEmpty(this.Status.SelectedValue)?this.DefStatusID:parseInt(this.Status.SelectedValue):this.DefStatusID,this.objCostCenter.SalesAccount=null!=this.SalesAccount?this.SalesAccount.SelectedValue:2,this.objCostCenter.PurchaseAccount=null!=this.PurchaseAccount?this.PurchaseAccount.SelectedValue:3,this.objCostCenter.CreditDays=null!=this.CreditDays?parseInt(this.CreditDays.Text):0,this.objCostCenter.CreditLimit=50052==this.CostCenterID?parseFloat(this.ScreenObject.CGParentID.toString().replace("00","")):null!=this.CreditLimit?parseFloat(this.CreditLimit.Text):0,this.objCostCenter.DebitDays=null!=this.DebitDays?parseInt(this.DebitDays.Text):0,this.objCostCenter.DebitLimit=null!=this.DebitLimit?parseFloat(this.DebitLimit.Text):0,this.objCostCenter.IsGroup=this.IsGroup,this.objCostCenter.SelectedNode=this.ParentId,this.objCostCenter.CustomFieldsXML="",this.objCostCenter.ContactsXML="",this.objCostCenter.NotesXML="",this.objCostCenter.AttachmetsXML=this.ScreenObject.GetExtraAttachmentXML(),this.objCostCenter.CustomFieldsQuery="",null!=this.CurrencyID&&this.CurrencyID.SelectedValue>0&&(this.objCostCenter.CustomFieldsQuery="CurrencyID='"+this.CurrencyID.SelectedValue+"',"),this.objCostCenter.CustomFieldsQuery=this.objCostCenter.CustomFieldsQuery+this.ScreenObject.GetQuickExtraFieldsQuery(),this.objCostCenter.CustomCostCenterFieldsQuery="",this.objCostCenter.CustomCostCenterFieldsQuery=this.ScreenObject.GetQuickExtraCCFieldsQuery();var d,b=this.ScreenObject.StaticFields.find((function(e){return"GroupSeqNoLength"==e.DBColumnName}));this.objCostCenter.GroupSeqNoLength=null!=b&&this.objCostCenter.IsGroup?parseInt(b.Text):0,this.objCostCenter.HistoryXML=this.ScreenObject.HistoryCCXML,this.objCostCenter.StatusXML=null!=this.ScreenObject.StatusAssignGrid?this.ScreenObject.StatusAssignGrid.GetXML():"";var S={};if(this.DisplayMessage=this.QuickAssign.GetXML(S),d=S.strXML,!r.e.IsEmpty(this.DisplayMessage))return;if(this.objCostCenter.CCXML=d,!this.ScreenObject.ValidateDataonSave())return;this.objCostCenter.WID=this.ScreenObject.CheckWorkFlow(),i.a.common.SaveCostCenter(this.objCostCenter,"SaveCostCenter").subscribe((function(i){t=i.Message,s=i.RetValue,e.MessageVisibility=!0,e.DisplayMessage=t,e.RetValue=s,s>0||s<-1e4?e.AfterSave():(e.MessageVisibility=!0,e.DisplayMessage=t)}),(function(e){alert(JSON.stringify(e)),console.log("Quick Add CostCenter Save : "+JSON.stringify(e))}))}else{var m,D=this.ScreenObject.GetStaticFieldsQuery();50052==this.CostCenterID&&(this.objCostCenter.AliasName=null!=this.Alias?this.Alias.Text:this.objCostCenter.Name,null!=this.Alias&&(this.Alias.Text=""!=this.Alias.Text.Trim().toString()?this.Alias.Text:this.objCostCenter.Name,this.objCostCenter.AliasName=this.Alias.Text)),null!=this.Code&&(this.objCostCenter.Code=this.Code.Text.Trim()),this.objCostCenter.Name=null!=this.Name?this.Name.Text.Trim():this.objCostCenter.Code,this.objCostCenter.StaticFieldsQuery=D,this.objCostCenter.CustomFieldsQuery=this.ScreenObject.GetQuickExtraFieldsQuery(),this.objCostCenter.CustomCostCenterFieldsQuery=this.ScreenObject.GetQuickExtraCCFieldsQuery(),this.objCostCenter.AttachmetsXML=this.ScreenObject.GetExtraAttachmentXML(),this.objCostCenter.HistoryXML=this.ScreenObject.HistoryCCXML,this.objCostCenter.StatusXML=null!=this.ScreenObject.StatusAssignGrid?this.ScreenObject.StatusAssignGrid.GetXML():"";var g={};if(this.DisplayMessage=this.QuickAssign.GetXML(g),m=g.strXML,!r.e.IsEmpty(this.DisplayMessage))return;if(this.objCostCenter.CCXML=m,!this.ScreenObject.ValidateDataonSave())return;this.objCostCenter.WID=this.ScreenObject.CheckWorkFlow(),i.a.common.SaveCostCenterQuick(this.objCostCenter,"SaveCostCenterQuick").subscribe((function(i){t=i.Message,s=i.RetValue,e.MessageVisibility=!0,e.DisplayMessage=t,e.RetValue=s,s>0||s<-1e4?e.AfterSave():(e.MessageVisibility=!0,e.DisplayMessage=t)}),(function(e){alert(JSON.stringify(e)),console.log("Quick Add CostCenter Save : "+JSON.stringify(e))}))}Logger.InfoLog("QuickAddAccountScreenViewModel::Exiting OnSaveCostCenter")}catch(p){Logger.ErrorLog("QuickAddAccountScreenViewModel:: onSaveCostCenter"+p.stack)}}},{key:"AfterSave",value:function(){this.NodeID=0,this.QuickAssign.Clear(),this.ScreenObject.Clear(),null!=this.Code&&(this.Code.Text=""),null!=this.Group&&(this.Group.SelectedValue=this.ParentId),this.objCostCenter.NodeID=0,this.Title=i.a.GetResource("Add")+" "+this.DisplayName,this.IsGroup&&(this.Title=this.Title+" Group"),this.AutoGenerateCode(),this.LoadParentData(),null!=this.Parent?(null!=this.Parent.SelectedNode&&(this.Parent.obj.SetFocusNodeID=this.Parent.SelectedNode.Id),this.Parent.Refresh(),this.Parent.SetVisibilityFalse(),this.Parent.AddEditCosCenterVisibility=!0):i.a.page.HideDialog()}},{key:"OnNameLostFocus",value:function(e){r.e.IsEmpty(this.Name.Text),this.ScreenObject.onTextBoxLostFocus(e)}},{key:"LoadParentData",value:function(){if(this.ScreenObject.dsParentData=null,0==this.NodeID&&0!=this.ParentId&&!this.objCostCenter.IsGroup){var e=this.ScreenObject.Data.Tables[5].filter((function(e){return"Copygroupdatatonode"==e.Name}));0!=e.length&&""!=e[0].Value.toString()&&Object(n.j)(e[0].Value)&&(this.ScreenObject.dsParentData=i.a.common.GetCopyNodeDetails(this.objCostCenter.CostCenterID,this.ParentId),0!=this.ScreenObject.dsParentData.Tables[0].length?this.ScreenObject.FillControlsWithParent(this.ScreenObject.dsParentData.Tables[0][0],this.ScreenObject.dsParentData.Columns[0],this.ScreenObject.dsParentData.Tables[0][0],this.ScreenObject.dsParentData.Columns[0],this.ScreenObject.dsParentData.Tables[7].length>0?this.ScreenObject.dsParentData.Tables[7][0]:null,this.ScreenObject.dsParentData.Tables[7].length>0?this.ScreenObject.dsParentData.Columns[7]:null,null,null,["Code","Name","IsGroup"]):this.ScreenObject.dsParentData=null)}}},{key:"SelectedGroup",get:function(){return this._SelectedGroup},set:function(e){this._SelectedGroup=e,this.ParentId!=e&&(this.objCostCenter.SelectedNode=e)}}]),s}(a.b)}}]);