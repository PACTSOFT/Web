function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var o,n=_getPrototypeOf(e);if(t){var i=_getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,o){return t&&_defineProperties(e.prototype,t),o&&_defineProperties(e,o),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{"/G+I":function(e,t,o){"use strict";o.r(t),o.d(t,"DocClass",(function(){return I})),o.d(t,"IPrefetchFilter",(function(){return h}));var n,i=o("Do2H"),s=o("Lp6j"),a=o("vTM8"),r=o("eQJW"),l=o("ScVY"),D=o("dH+5"),C=o("MCLT"),u=o("uMy8"),c=o("USNh"),I=function(){function e(){_classCallCheck(this,e),this.ParentDocID=0,this.IsInventory=!1,this.IsDebit=!0,this.ShowAccountingData=!0,this.dvCommon=null,this.dvCommonTable=null,this._DocID=0,this.AbsDocID=0}return _createClass(e,[{key:"Clone",value:function(){var t=new e;return t.DocID=this.DocID,t.AbsDocID=this.AbsDocID,t.ParentDocID=this.ParentDocID,t.IsInventory=this.IsInventory,t.IsDebit=this.IsDebit,t.dvCommon=this.dvCommon,t}},{key:"DocID",get:function(){return this._DocID},set:function(e){this._DocID=e,this.AbsDocID=e<0?-e:e}}]),e}(),h=((n=function(e){_inherits(o,e);var t=_createSuper(o);function o(){var e;return _classCallCheck(this,o),(e=t.apply(this,arguments))._ShowFilter=!1,e._ShowStaticFilter=!1,e._ShowReport=!1,e._ReportVisibility=!0,e.IsSSRS=!1,e.SSRSVisibility=!1,e.SSRSReportName="",e.ShowRightPanel=!0,e._ShowMasters=!1,e._ShowPrintDesigner=!1,e._ShowOptions=!1,e.Filter=null,e.FieldsDialog=null,e.oReportDialog=null,e.Entities=new a.a,e.BaseReportColumns=[],e.ReportGroups=[],e.FormulaObjects=[],e.StaticReportType=0,e.CostCenterID=0,e.IgnoreTreeLoad=!1,e.DontApplyDateFilter=!1,e.RepeatOn="",e.RepeatStartIndex=-1,e.RepeatNextCols=0,e.RepeatSets=0,e.RepeatEmptyColumns=0,e.RepeatPrevData=0,e.RepeatPrevNextCols=1,e.RepeatType=D.d.None,e.RepeatShowPrevMn=!1,e.RepeatPrevDataFull=!1,e.RepeatPrevDiff=!1,e.RepeatPrevPercent=!1,e.RepeatPrevDataSeperately=!1,e.RepeatPrevDataOfCurrYr=!1,e.PrevDateColumsUsed=!1,e.LevelTreeCostCenterID=0,e.ExQCnt=0,e.LevelColumn=null,e.LevelSubGroup="",e.ReportViewType=D.e.General,e.IsPreProcessQuery=!1,e.IsPreProcessQueryClick=!1,e.IsInventory=!0,e.IsHistory=!1,e.IsRevision=!1,e.iHistoryStatusID=0,e.strHistorySepChar="",e.FileProtection="",e.LinkSubCCID=0,e.LinkSubVoucherNo="",e.IsBudgetFound=!1,e.IsBudgetNewFound=!1,e.IsAuthLevelReport=!1,e.IsNoDataGroups=!1,e.IsSummaryReportType=!1,e.IsKANBAN=!1,e.IsOpeningStockExists=!1,e.IsClosingStockExists=!1,e.IsAvgRateExists=!1,e.ShowUnAppDocsToApprove=!1,e.ShowUnAppDocsToApprove_UseFuncCall=!1,e.ShowMyUnAppDocsToBeApproved=!1,e.UnPostedDocsInclude=!1,e.UnPostedDocsReserveQtyInclude=!1,e.UnPostedDocsHoldQtyInclude=!1,e.IncludeUnPostedDocsReserveQty=!1,e.IncludeUnPostedDocsHoldQty=!1,e.PDCInclude=!1,e.ShowOnlyAccountingData=!1,e.ShowDebitCreditAmount=!1,e.IsNewFromClause=!0,e.IncludeNonAccDocs=null,e.UnPostedDocsList="",e.RowFiltersXML="",e.RowFiltersWhere="",e.dtLWApproval=null,e.sbQuery="",e.sbFinalQuery="",e.DocumentFiltersIDs=new a.a,e.DocumentFiltersText=new a.a,e.DocumentFilters=new a.a,e.SelectTag="",e.DbSelectTag="",e.FromTag="",e.FromTagExtra="",e.WhereTag="",e.OrderByTag="",e.SelectTagAliasOnly="",e.FinalQuery="",e.GroupSelectTag="",e.DbGroupSelectTag="",e.GroupFromTag="",e.GroupSelectTagAlias="",e.SummarySELECT="",e.SummaryGROUPBY="",e.DocumentFields=[135,23144,23145,23146,23147,23148,24500,24501,23149,23826,26583,23831,11364,11365,480020,480021,480022,480023,11375,11490,11405,11505,11516,11426,11683,11643],e.InvDocumentFields=[23150,23822,23823,23824,26250,21356,21357,25523,11371,11372,11373,11374,11383,11384,11403,11404,11484,13964,11491,11514,164,165,166,167,11361,11415,27266,182,11676,11677,11686,11494,11956],e.AccDocumentFields=[23825,23827,23828,23829,23830,11366,11367,11416,11417,205,206,11493],e.IgnoreObjectsForFields=[26648,11396,101,189,11509,11510,11511,11512,11513,26419,26420,50453,11515,11691,11692,170,181,182,209,11377,11378,11379,11380,214],e.ReportParams=new a.a,e.Report=null,e.ParentReport=null,e.ReportViewFrom=null,e.ReportViewFromReorder=null,e.MRPFilter=null,e.MRPII=null,e.BulkEdit=null,e.PrefetchReportTreeFilter=null,e.IncludeLFTColumn=[],e.earningfields=null,e.Vacationfields=null,e.EmpAsonDate=null,e.evalCheck=null,e.fldCheck=null,e}return _createClass(o,[{key:"SetQueryXMLTags",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=0,l=0;this.IsHistory=!1,this.IsAuthLevelReport=!1,this.IsBudgetNewFound=!1,this.IsNoDataGroups=!1,this.LevelColumn=null;var u=null,c="",h="";this.SelectTag=this.FromTag=this.WhereTag=this.OrderByTag=this.SelectTagAliasOnly="",this.GroupSelectTag=this.GroupFromTag=this.GroupSelectTagAlias="",this.SummarySELECT=this.SummaryGROUPBY="",this.Entities=new a.a,this.Objects=[];var d=[];if(this.sbFinalQuery="",this.ReportParams.Clear(),this.fldCheck=null,null!=this.ParentReport&&this.ApplyParentReportFilters(),"ReportViewModel"!=this.ClassName||(this.Report=this,this.Report.SetDatePickers(),this.Report.Preferences.ContainsKey("IsKANBAN")&&(this.IsKANBAN=!0),this.ReportViewType!=D.e.ExternalQuery))if(this.FormulaObjects.Clear(),this.BaseReportColumns.forEach((function(t){t.CDGDO.Formula=t.Formula.Text,t.FormulaExpression="",t.ColumnFilterExpression="",t.FormulaErrorMessage="",s.e.IsEmpty(t.Formula.Text)||e.ParseFormula(t,!0),""!=t.FormulaErrorMessage||s.e.IsEmpty(t.Expression.Text)||e.ParseFormula(t,!1),11406==t.CDGDO.FieldValue||11408==t.CDGDO.FieldValue||t.CDGDO.FieldValue>=11485&&t.CDGDO.FieldValue<=11489?e.IsBudgetNewFound=!0:181==t.CDGDO.FieldValue&&(t.CDGDO.Formula=t.FormulaEvaluateAtEnd.SelectedValue)})),this.ReportGroups.forEach((function(t){t.CDGDO.Formula=t.Formula.Text,t.FormulaExpression="",t.ColumnFilterExpression="",t.FormulaErrorMessage="",s.e.IsEmpty(t.Formula.Text)||e.ParseFormula(t,!0)})),0==this.StaticReportType||110==this.StaticReportType||144==this.StaticReportType)if(0!=this.StaticReportType||!this.IsPreProcessQuery||this.IsPreProcessQueryClick){var T,y=[];for(this.BaseReportColumns.forEach((function(e){0==e.CDGDO.FieldValue||!s.e.IsEmpty(e.Formula.Text)&&188!=e.CDGDO.FieldValue&&"$TOTALHOURS$"!=e.Formula.Text||y.push(e.CDGDO)})),this.ReportGroups.forEach((function(e){s.e.IsEmpty(e.Formula.Text)&&y.push(e.CDGDO)})),y.AddRange(this.FormulaObjects),this.Filter.Fields.forEach((function(e){y.push(e.CDGDO)})),this.earningfields=y.filter((function(e){return(50051==e.CategoryValue||e.CategoryValue>=40051&&e.CategoryValue<=40099&&40064!=e.CategoryValue)&&(405==e.ColumnCostCenterID||406==e.ColumnCostCenterID||410==e.ColumnCostCenterID)})),this.earningfields.length>0&&this.earningfields.forEach((function(e){y.Remove(e)})),this.Vacationfields=y.filter((function(e){return 50051==e.CategoryValue&&411==e.ColumnCostCenterID})),this.Vacationfields.length>0&&this.Vacationfields.forEach((function(e){y.Remove(e)})),this.EmpAsonDate=y.filter((function(e){return 50051==e.CategoryValue&&-601==e.FieldValue})),this.EmpAsonDate.length>0&&this.EmpAsonDate.forEach((function(e){y.Remove(e)})),y.find((function(e){return 400==e.CategoryValue&&(205==e.FieldValue||206==e.FieldValue||207==e.FieldValue)}))&&(this.ShowOnlyAccountingData=!0,this.ShowDebitCreditAmount=!0),T=0;T<y.length;T++)Math.abs(y[T].CategoryValue)>4e4&&Math.abs(y[T].CategoryValue)<5e4&&function(){var t=e.FieldsDialog.DocumentTypes.filter((function(e){return e.CostCenterID==Math.abs(y[T].CategoryValue)}));t.length>0&&(e.IsInventory=Object(r.j)(t[0].IsInventory));var o="";if(0==d.filter((function(e){return e.DocID==y[T].CategoryValue})).length)if(y[T].CategoryValue>0){var n=new I;n.DocID=y[T].CategoryValue,n.IsInventory=e.IsInventory,d.push(n)}else o="DocumentType=@DType",s.e.IsEmpty(y[T].ALLOtherDocuments)||(o="("+o+" or CostCenterID IN ("+y[T].ALLOtherDocuments.Replace("~1","")+"))");else s.e.IsEmpty(y[T].ALLOtherDocuments)||(o="",y[T].ALLOtherDocuments.Replace("~1","").split(",").forEach((function(e){null==d.find((function(t){return t.DocID==-parseInt(e)}))&&(o.length>0&&(o+=","),o+=e)})),o.length>0&&(o=" CostCenterID IN ("+o+")"));if(o.length>0){var a=i.a.report.DataSet("RPT032",Math.abs(y[T].CategoryValue).toString(),o);a.Tables[1].forEach((function(e){if(e.cType){var t=parseInt(e.cType);2==t?e.SysColumnName=e.SysColumnName.toString().Replace("dcNum","dcCalcNum"):3==t&&(e.SysColumnName=e.SysColumnName.toString().Replace("dcNum","dcCalcNumFC"))}})),a.Tables[0].forEach((function(t){var o=parseInt(t.CostCenterID);if(!d.find((function(e){return e.DocID==o}))){var n=new I;n.DocID=o,n.IsInventory=e.IsInventory,n.ParentDocID=y[T].CategoryValue,d.push(n),o!=y[T].CategoryValue&&(d[d.length-1].dvCommonTable=a.Tables[1])}}))}}();for(var m=0;m<this.Filter.CostCenterFilters.length;m++){var A=this.Filter.CostCenterFilters[m];if(300==A.CostCenterID){if(d.filter((function(e){return e.DocID<-4e4})).length>0&&A.SelectedNodes.length>0)for(var p=function(e){Math.abs(d[e].DocID)>4e4&&Math.abs(d[e].DocID)<5e4&&0==A.SelectedNodes.filter((function(t){return t.Id==Math.abs(d[e].DocID)})).length&&d.RemoveAt(e)},E=d.length-1;E>=0;E--)p(E);A.SelectedNodes.forEach((function(t){var o=e.FieldsDialog.DocumentTypes.filter((function(e){return e.CostCenterID==t.Id}));if(o.length>0&&(e.IsInventory=Object(r.j)(o[0].IsInventory),0==d.filter((function(e){return Math.abs(e.DocID)==t.Id})).length)){var n=new I;n.DocID=t.Id,n.IsInventory=e.IsInventory,d.push(n)}}))}}if(this.ReportViewType==D.e.TransactionQuery||this.ReportViewType==D.e.LinkingQuery)if("LINKED_SUB_VOUCHERS"==t){this.IsInventory=!0,d.Clear();var N=new I;N.DocID=this.LinkSubCCID,N.IsInventory=this.IsInventory,d.push(N)}else if(null!=this.TQDocumentType&&this.TQDocumentType.SelectedValue>0&&(""==t||"LINKED_VOUCHERS"==t)){var S=this.FieldsDialog.DocumentTypes.filter((function(t){return t.CostCenterID==e.TQDocumentType.SelectedValue}));S.length>0&&(this.IsInventory=Object(r.j)(S[0].IsInventory)),d.Clear();var O=new I;O.DocID=this.TQDocumentType.SelectedValue,O.IsInventory=this.IsInventory,d.push(O)}if(this.ShowOnlyAccountingData&&null!=this.IncludeNonAccDocs)for(var g=d.length-1;g>=0;g--)this.IncludeNonAccDocs.Contains(d[g].DocID.toString())&&d.Remove(d[g]);if(0==d.length)if(this.ShowOnlyAccountingData){var F=new I;F.DocID=-2,F.IsInventory=!1,d.push(F),(F=new I).DocID=-1,F.IsInventory=!0,d.push(F)}else{if(y.filter((function(t){return 400==t.CategoryValue&&e.InvDocumentFields.Contains(t.FieldValue)})).length>0){var f=new I;f.DocID=-1,f.IsInventory=!0,d.push(f)}if(y.filter((function(t){return 400==t.CategoryValue&&e.AccDocumentFields.Contains(t.FieldValue)})).length>0){var R=new I;R.DocID=-2,R.IsInventory=!1,d.push(R)}if(y.filter((function(t){return!e.IgnoreObjectsForFields.Contains(t.FieldValue)&&t.CategoryValue>=400&&t.CategoryValue<=408&&210!=t.FieldValue&&0==d.length})).length>0){var P=new I;P.DocID=-1,P.IsInventory=!0,d.push(P),(P=new I).DocID=-2,P.IsInventory=!1,d.push(P)}if(0==d.length){var b=new I;b.DocID=0,b.IsInventory=!0,d.push(b)}}for(this.ShowOnlyAccountingData&&null!=this.IncludeNonAccDocs&&this.IncludeNonAccDocs.forEach((function(e){var t=new I;t.DocID=parseInt(e),t.IsInventory=!0,t.ShowAccountingData=!1,d.push(t)})),T=0;T<d.length;T++)for(var V=T+1;V<d.length;V++)Math.abs(d[T].DocID)==Math.abs(d[V].DocID)&&(0!=d[V].ParentDocID&&(d[T].DocID=d[V].DocID,d[T].dvCommon=d[V].dvCommon,d[T].dvCommonTable=d[V].dvCommonTable,d[T].ParentDocID=d[V].ParentDocID),d.RemoveAt(V),V--);if(this.ShowDebitCreditAmount)for(T=d.length-1;T>=0;T--)if(d[T].ShowAccountingData){var v=d[T].Clone();v.IsDebit=!1,d.push(v)}this.IsBudgetNewFound&&(l=s.e.Int(this.Filter.Budget.SelectedValue),u=i.a.report.DataSet("RPT033",l.toString()));try{var M="",_="",L=this.Filter.CostCenterFilters.find((function(e){return-100==e.CostCenterID}));if(L&&L.SelectedNodes.length>0){for(var w="",x=0;x<L.SelectedNodes.length;x++)x>0&&(w+=","),w+=L.SelectedNodes[x].Id;var G=i.a.report.ReportDataTable("RPT034",null!=this.Report&&this.Report.IsReportDB,w);if(Object(C.isNullOrUndefined)(G[0].Job))return void(this.FinalQuery="select 1 where 1!=1");var k=parseInt(G[0].Job);M=G[0].LinkDimension.toString(),k>0&&M.length>0?_="CREATE TABLE #TblJobDim(NodeID BIGINT)\nDECLARE @SQL NVARCHAR(MAX)\nset @SQL='insert into #TblJobDim\nselect "+M+"\nfrom inv_docdetails i with(nolock)\ninner join (select InvDocDetailsID from inv_docdetails with(nolock) where DocID IN ("+w.toString()+")) AS B on i.LinkedInvDocDetailsID=B.InvDocDetailsID\ninner join com_docccdata dcc with(nolock) on dcc.InvDocDetailsID=i.InvDocDetailsID \ngroup by "+M+"'\nEXEC(@SQL)\n":L=null}var B="";if(this.ShowUnAppDocsToApprove){var H=i.a.report.GetReportData(9,this.ShowUnAppDocsToApprove_UseFuncCall?0:1,'<XML UID="'+i.a.SessionManager.UserID+'" ShowMyQueue="'+(this.ShowMyUnAppDocsToBeApproved?"1":"0")+'"></XML>');B=s.e.String(H.Tables[0][0].Qry)}else if(this.ShowMyUnAppDocsToBeApproved){var W=i.a.report.GetReportData(10,this.ShowUnAppDocsToApprove_UseFuncCall?0:1,i.a.SessionManager.UserID.toString());B=s.e.String(W.Tables[0][0].Qry)}this.Filter.IsReportViewScreen&&this.Report.Preferences.ContainsKey("FromOldCode")&&(this.IsNewFromClause=!1);for(var U=function(a){var C=d[a],I=null;e.IsInventory=C.IsInventory,e.SelectTag=e.FromTag=e.FromTagExtra=e.WhereTag=e.OrderByTag=e.SelectTagAliasOnly="",c="",h="",e.ExQCnt=0;var m=[];for(T=0;T<y.length;T++)e.IgnoreObject(C,y[T])||(Math.abs(y[T].CategoryValue)>4e4&&Math.abs(y[T].CategoryValue)<5e4?Math.abs(y[T].CategoryValue)!=Math.abs(C.DocID)&&y[T].CategoryValue!=C.ParentDocID||m.push(y[T]):400==y[T].CategoryValue?e.IsInventory&&!e.AccDocumentFields.Contains(y[T].FieldValue)?(m.push(y[T]),e.DocumentFields.Contains(y[T].FieldValue)&&(y[T].IsForeignKey?y[T].ParentTable="INV_DocDetails":y[T].Table="INV_DocDetails")):e.IsInventory||e.InvDocumentFields.Contains(y[T].FieldValue)||(m.push(y[T]),e.DocumentFields.Contains(y[T].FieldValue)&&(y[T].IsForeignKey?y[T].ParentTable="ACC_DocDetails":y[T].Table="ACC_DocDetails")):101==y[T].CategoryValue?""==y[T].Column||m.push(y[T]):144==y[T].CategoryValue&&65==y[T].ParentCostCenterID||m.push(y[T]));e.Entities.Clear(),e.Objects.Clear();for(var A=function(t){var o=m[t];if("Shipping_Address"!=o.Table&&"Billing_Address"!=o.Table)if(e.drrCCTbl=e.FieldsDialog.CostCenterTables.filter((function(e){return e.FeatureID==(o.IsForeignKey?o.ParentCostCenterID:o.CategoryValue)})),o.CategoryValue>=400&&o.CategoryValue<=408&&!o.IsForeignKey&&(e.drrCCTbl[0].TableName=e.IsInventory?"INV_DocDetails":"ACC_DocDetails"),e.ShowDebitCreditAmount&&C.ShowAccountingData&&207==o.FieldValue&&2==o.ParentCostCenterID&&(o.ParentColumn=C.IsDebit?"DebitAccount":"CreditAccount"),!e.Entities.ContainsKey(o.CategoryText)||null!=o.ChildCDGDO&&!e.Entities.ContainsKey(o.ChildCDGDO.CategoryText)){if(e.drrCCTbl.length>0){if(null!=o.ChildCDGDO){if(o.ChildCDGDO.ColumnCostCenterID>0&&o.ChildCDGDO.ParentTableAlias.Contains("_CCMAP")&&!e.Entities.ContainsKey(o.ChildCDGDO.ParentTableAlias)){var i,a;e.drrCCTbl=e.FieldsDialog.CostCenterTables.filter((function(e){return e.FeatureID==o.ChildCDGDO.CategoryValue})),i=e.drrCCTbl[0].PK.toString(),a=e.drrCCTbl[0].TableName.toString(),400!=o.CategoryValue||e.IsInventory||"inv_docdetails"!=a.toLowerCase()||(i="AccDocDetailsID",a="ACC_DocDetails");var r=o.ChildCDGDO.CategoryText.substr(0,o.ChildCDGDO.CategoryText.lastIndexOf("."));if(r.Contains(".")&&!e.Entities.ContainsKey(r)){var l=o.CloneObject();l.ChildCDGDO=null,l.ParentCDGDO=null;var D=e.FieldsDialog.FilterView.filter((function(e){return e.CostCenterColID==o.FieldValue}));l.Table=D[0].SysTableName.toString(),l.Column=D[0].SysColumnName.toString(),l.FieldText=D[0].UserColumnName.toString(),l.DataType=D[0].ColumnDataType.toString(),l.ParentCCDefaultColID=parseInt(D[0].ParentCCDefaultColID),D=e.FieldsDialog.FilterView.filter((function(e){return e.CostCenterColID==l.ParentCCDefaultColID})),l.Table=D[0].SysTableName.toString(),l.Column=D[0].SysColumnName.toString(),e.Objects.push(l),e.Entities.push(l.CategoryText,"")}var u=o.ChildCDGDO.CloneObject();u.ColumnCostCenterID=0,u.ParentTableAlias=u.ParentTableAlias.Replace("_CCMAP",""),u.Table=u.ParentTable,u.ParentCostCenterColSysName="NodeID",u.ParentTable=a,u.ParentColumn=i,e.Objects.push(u),e.Entities.push(o.ChildCDGDO.ParentTableAlias,""),e.Objects.push(o.ChildCDGDO),e.Entities.push(o.ChildCDGDO.CategoryText,"")}else e.Entities.ContainsKey(o.CategoryText)||(e.Objects.push(o),e.Entities.push(o.CategoryText,"")),null==o.ChildCDGDO||144==o.ChildCDGDO.CategoryValue&&65==o.ChildCDGDO.ParentCostCenterID||e.Entities.ContainsKey(o.ChildCDGDO.CategoryText)||(e.Objects.push(o.ChildCDGDO),e.Entities.push(o.ChildCDGDO.CategoryText,""));return"continue"}if(s.e.StringValue(e.drrCCTbl[0].TableName).toString()!=o.Table){var c=o.CloneObject();return c.ParentCDGDO=null,c.Table=s.e.StringValue(e.drrCCTbl[0].TableName).toString(),e.Objects.push(c),e.Entities.push(o.CategoryText,""),o.ParentCDGDO=c,e.Objects.push(o),e.Entities.push(o.CategoryText+o.Table,""),"continue"}}if(o.ColumnCostCenterID>0&&null!=o.ParentTableAlias&&o.ParentTableAlias.Contains("_CCMAP")&&!e.Entities.ContainsKey(o.ParentTableAlias)){var I,h;e.drrCCTbl=e.FieldsDialog.CostCenterTables.filter((function(e){return e.FeatureID==o.CategoryValue})),400!=o.CategoryValue||e.IsInventory?(I=e.drrCCTbl[0].PK.toString(),h=s.e.StringValue(e.drrCCTbl[0].TableName).toString()):(I="AccDocDetailsID",h="ACC_DocDetails");var d=o.CloneObject();if(d.ColumnCostCenterID=0,d.ParentTableAlias=d.ParentTableAlias.Replace("_CCMAP",""),d.Table=d.ParentTable,d.ParentCostCenterColSysName=400==o.CategoryValue||Math.abs(o.CategoryValue)>=40001&&Math.abs(o.CategoryValue)<5e4?I:"NodeID",d.ParentTable=h,d.ParentColumn=I,!e.Entities.ContainsKey(d.ParentTableAlias)){var T=d.CloneObject();T.Table=h,T.ColumnCostCenterID=0,T.CategoryText=d.ParentTableAlias,T.IsForeignKey=!1,e.Objects.push(T),e.Entities.push(d.ParentTableAlias,"")}e.Objects.push(d),e.Entities.push(o.ParentTableAlias,"")}else if(o.IsForeignKey&&!e.Entities.ContainsKey(o.ParentTableAlias)){var y=o.CloneObject();if(400==o.CategoryValue||Math.abs(o.CategoryValue)>=40001&&Math.abs(o.CategoryValue)<5e4)e.Entities.length>0&&210==o.FieldValue||(y.Table=e.IsInventory?"INV_DocDetails":"ACC_DocDetails",y.ColumnCostCenterID=0,y.CategoryText=o.ParentTableAlias,y.IsForeignKey=!1,e.Objects.push(y),e.Entities.push(o.ParentTableAlias,""));else if(n.ForeignMAPTables.Contains(o.Table.toUpperCase())){e.drrCCTbl=e.FieldsDialog.CostCenterTables.filter((function(e){return e.FeatureID==o.CategoryValue})),y.Table=y.ParentTable;var A=o.CategoryText.substr(0,o.CategoryText.lastIndexOf("."));y.CategoryText=A,0!=s.e.stringCompare(y.Table,e.drrCCTbl[0].TableName.toString(),!0)&&(y.ParentCDGDO=e.Objects[e.Entities.keys.indexOf(A)]),y.ColumnCostCenterID=0,y.IsForeignKey=!1,e.Objects.push(y),e.Entities.push(o.ParentTableAlias,"")}else if("CRM_ProductMapping"==o.ParentTable){var p=o.CloneObject();p.ColumnCostCenterID=0,p.Table=p.ParentTable,p.ParentTableAlias=p.ParentTableAlias.Replace("CRM_ProductMapping",""),p.ParentCostCenterColSysName="CCNodeID",89==p.CategoryValue?(p.ParentTable="CRM_Opportunities",p.ParentColumn="OpportunityID"):(p.ParentTable="CRM_Leads",p.ParentColumn="LeadID"),e.Objects.push(p),e.Entities.push(o.ParentTableAlias,"")}else if("REN_QuotationParticulars"==o.ParentTable){var E=o.CloneObject();E.ColumnCostCenterID=0,E.Table=E.ParentTable,E.ParentTableAlias=E.ParentTableAlias.Replace("REN_QuotationParticulars",""),E.ParentCostCenterColSysName="CCNodeID",129==E.CategoryValue&&(E.ParentTable="REN_Quotation",E.ParentColumn="QuotationID"),e.Objects.push(E),e.Entities.push(o.ParentTableAlias,"")}else y.Table=o.ParentTable,y.ColumnCostCenterID=0,y.CategoryText=o.ParentTableAlias,y.IsForeignKey=!1,e.Objects.push(y),e.Entities.push(o.ParentTableAlias,"")}if(e.Objects.push(o),e.Entities.push(o.CategoryText,""),(64==o.ParentCCDefaultColID||65==o.ParentCCDefaultColID)&&!e.Entities.ContainsKey(o.CategoryText+"_MAXMIN")){var N=o.CloneObject();N.DimensionsFilter="MAXMIN",e.Objects.push(N),e.Entities.push(N.CategoryText+"_MAXMIN","")}}else{if(null!=o.ChildCDGDO&&e.Entities.ContainsKey(o.ChildCDGDO.CategoryText))return"continue";if(e.drrCCTbl.length>0)if(s.e.StringValue(e.drrCCTbl[0].TableName).toString()!=o.Table)o.ParentCDGDO=e.Objects[e.Entities.keys.indexOf(o.CategoryText)],e.Entities.ContainsKey(o.CategoryText+o.Table)||(e.Objects.push(o),e.Entities.push(o.CategoryText+o.Table,""));else if(64==o.ParentCCDefaultColID||65==o.ParentCCDefaultColID)e.Entities.ContainsKey(o.CategoryText+"_MAXMIN")||(e.Objects.push(o),o.DimensionsFilter="MAXMIN",e.Entities.push(o.CategoryText+"_MAXMIN",""));else if(599==o.FieldValue){if(o.ParentTableAlias="Product",o.Column="BOMName",o.Table="PRD_BillOfMaterial",0!=s.e.stringCompare(o.Table,e.FieldsDialog.CostCenterTables[0].TableName.toString(),!0)){var S=e.Entities.Keys.IndexOf("Product");-1!=S&&(o.ParentCDGDO=e.Objects[S])}o.ColumnCostCenterID=76,o.IsForeignKey=!1,e.Objects.push(o),e.Entities.ContainsKey("BOM")||e.Entities.push("BOM",""),o.CategoryText="Product"}}},p=0;p<m.length;p++)A(p);for(var E=function(t){var o=e.Entities.keys[t];if(Math.abs(e.Objects[t].CategoryValue)>4e4&&Math.abs(e.Objects[t].CategoryValue)<5e4||e.Objects[t].CategoryValue>=401&&e.Objects[t].CategoryValue<=408){var n=e.FieldsDialog.DocumentTypes.filter((function(o){return o.CostCenterID==e.Objects[t].CategoryValue}));if(n.length>0&&(e.IsInventory=Object(r.j)(n[0].IsInventory)),e.Objects[t].IsForeignKey)o.endsWith("_CCMAP")&&"COM_DOCCCDATA"==e.Objects[t].Table.toUpperCase()?e.Entities.SetValue(o,"TDCC"):e.Entities.SetValue(o,"T"+t);else if(0==s.e.stringCompare(s.e.StringValue(e.Objects[t].Table),"COM_DocNumData",!0)){for(T=0;T<t;T++)if(e.Entities.keys[T].endsWith("COM_DocNumData")){e.Entities.SetValue(o,e.Entities.values[T]);break}T==t&&e.Entities.SetValue(o,"T"+t)}else if(0==s.e.stringCompare(s.e.StringValue(e.Objects[t].Table),"PAY_DocNumData",!0)){for(T=0;T<t;T++)if(e.Entities.keys[T].endsWith("PAY_DocNumData")){e.Entities.SetValue(o,e.Entities.values[T]);break}T==t&&e.Entities.SetValue(o,"T"+t)}else if(0==s.e.stringCompare(s.e.StringValue(e.Objects[t].Table),"COM_DocTextData",!0)){for(T=0;T<t;T++)if(e.Entities.keys[T].endsWith("COM_DocTextData")){e.Entities.SetValue(o,e.Entities.values[T]);break}T==t&&e.Entities.SetValue(o,"T"+t)}else e.IsInventory?0==s.e.stringCompare(s.e.StringValue(e.Objects[t].Table),"INV_DOCDETAILS",!0)?e.Entities.SetValue(o,"INV"):e.Entities.SetValue(o,"T"+t):0==s.e.stringCompare(s.e.StringValue(e.Objects[t].Table),"ACC_DOCDETAILS",!0)?e.Entities.SetValue(o,"ACC"):e.Entities.SetValue(o,"T"+t)}else 400==e.Objects[t].CategoryValue?e.Objects[t].IsForeignKey?o.endsWith("_CCMAP")&&"COM_DOCCCDATA"==e.Objects[t].Table.toUpperCase()?e.Entities.SetValue(o,"TDCC"):e.Entities.SetValue(o,"T"+t):e.IsInventory?(e.Objects[t].Table="INV_DocDetails",e.Entities.SetValue(o,"INV")):(e.Objects[t].Table="ACC_DocDetails",e.Entities.SetValue(o,"ACC")):e.Entities.SetValue(o,"T"+t)},N=0;N<e.Objects.length;N++)E(N);if(Math.abs(C.DocID)>4e4&&Math.abs(C.DocID)<5e4&&(h=e.IsInventory?"INV.CostCenterID="+Math.abs(C.DocID):"ACC.CostCenterID="+Math.abs(C.DocID)),"LINKED_VOUCHERS"==t)e.SelectTag="DISTINCT INV.DocID,INV.CostCenterID,VoucherNo";else{e.sbQuery="",o=0;for(var S=function(t){var n=e.BaseReportColumns[t];if(!s.e.IsEmpty(n.FormulaExpression)&&0!=s.e.stringCompare(n.Formula.Text,"LATEST",!0)&&0!=s.e.stringCompare(n.Formula.Text,"OLDEST",!0)&&0!=s.e.stringCompare(n.Formula.Text,"$TOTALHOURS$",!0)&&"H"!=n.Formula.Text)return"continue";if(0==n.CDGDO.FieldValue)return"continue";if(!s.e.IsEmpty(n.PrevRowValue.SelectedValue))return"continue";if(e.earningfields.length>0&&e.earningfields.find((function(e){return e==n.CDGDO})))return"continue";if(e.Vacationfields.length>0&&null!=e.Vacationfields.find((function(e){return e==n.CDGDO})))return"continue";if(e.EmpAsonDate.length>0&&null!=e.EmpAsonDate.find((function(e){return e==n.CDGDO})))return"continue";if(o>0&&(e.sbQuery+=","),e.SetActualColumn(n.CDGDO,C,n),11515==n.CDGDO.FieldValue)s.e.IsEmpty(n.CDGDO.ActualTable)&&(n.CDGDO.ActualTable=e.IsInventory?"INV":"ACC"),e.sbQuery+="stuff((select ','+[GUID]+'.'+FileExtension from COM_Files WITH(NOLOCK) WHERE FeatureID="+n.CDGDO.ActualTable+".CostCenterID AND FeaturePK="+n.CDGDO.ActualTable+".DocID FOR XML PATH('')),1,1,'') "+n.ID+"_ID,",n.CDGDO.ActualColumn="stuff((select ', '+ActualFileName from COM_Files WITH(NOLOCK) WHERE FeatureID="+n.CDGDO.ActualTable+".CostCenterID AND FeaturePK="+n.CDGDO.ActualTable+".DocID FOR XML PATH('')),1,2,'')";else if(n.CDGDO.FieldValue>=11678&&n.CDGDO.FieldValue<=11682)e.sbQuery+="stuff((select ','+[GUID]+'.'+FileExtension from COM_Files WITH(NOLOCK) WHERE FeatureID="+n.CDGDO.CategoryValue+" AND FeaturePK="+n.CDGDO.ActualTable+".NodeID FOR XML PATH('')),1,1,'') "+n.ID+"_ID,",n.CDGDO.ActualColumn="stuff((select ', '+ActualFileName from COM_Files WITH(NOLOCK) WHERE FeatureID="+n.CDGDO.CategoryValue+" AND FeaturePK="+n.CDGDO.ActualTable+".NodeID FOR XML PATH('')),1,2,'')";else if(27291==n.CDGDO.FieldValue||27291==n.CDGDO.ParentCCDefaultColID)e.sbQuery+="stuff((select ','+[GUID]+'.'+FileExtension from COM_Files WITH(NOLOCK) WHERE FeatureID=3 AND FeaturePK="+n.CDGDO.ActualTable+".ProductID FOR XML PATH('')),1,1,'') "+n.ID+"_ID,",n.CDGDO.ActualColumn="stuff((select ', '+ActualFileName from COM_Files WITH(NOLOCK) WHERE FeatureID=3 AND FeaturePK="+n.CDGDO.ActualTable+".ProductID FOR XML PATH('')),1,2,'')";else if(27290==n.CDGDO.FieldValue||27290==n.CDGDO.ParentCCDefaultColID)e.sbQuery+="stuff((select ','+[GUID]+'.'+FileExtension from COM_Files WITH(NOLOCK) WHERE FeatureID=2 AND FeaturePK="+n.CDGDO.ActualTable+".AccountID FOR XML PATH('')),1,1,'') "+n.ID+"_ID,",n.CDGDO.ActualColumn="stuff((select ', '+ActualFileName from COM_Files WITH(NOLOCK) WHERE FeatureID=2 AND FeaturePK="+n.CDGDO.ActualTable+".AccountID FOR XML PATH('')),1,2,'')";else if(n.CDGDO.FieldValue>=11801&&n.CDGDO.FieldValue<=11850||n.CDGDO.ParentCCDefaultColID>=11801&&n.CDGDO.ParentCCDefaultColID<=11850){var i;i=n.CDGDO.FieldValue>=11801&&n.CDGDO.FieldValue<=11850?n.CDGDO.CategoryValue:n.CDGDO.ParentCostCenterID,e.sbQuery+="stuff((select ','+[GUID]+'.'+FileExtension from COM_Files WITH(NOLOCK) WHERE FeatureID="+i+" AND FeaturePK="+n.CDGDO.ActualTable+".NodeID FOR XML PATH('')),1,1,'') "+n.ID+"_ID,",n.CDGDO.ActualColumn="stuff((select ', '+ActualFileName from COM_Files WITH(NOLOCK) WHERE FeatureID="+i+" AND FeaturePK="+n.CDGDO.ActualTable+".NodeID FOR XML PATH('')),1,2,'')"}else 50051==n.CDGDO.CategoryValue&&"Attachments"==n.CDGDO.Column?(e.sbQuery+="stuff((select ','+[GUID]+'.'+FileExtension from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK="+n.CDGDO.ActualTable+".NodeId FOR XML PATH('')),1,1,'') "+n.ID+"_ID,",n.CDGDO.ActualColumn="stuff((select ', '+ActualFileName from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK="+n.CDGDO.ActualTable+".NodeId FOR XML PATH('')),1,2,'')"):50051==n.CDGDO.CategoryValue&&"ServiceDays"==n.CDGDO.Column?(e.sbQuery+="(Select ISNULL((DATEDIFF(day,CONVERT(DATETIME,DOJ),GETDATE())+1),0) From COM_CC50051 WITH(NOLOCK) WHERE NodeID="+n.CDGDO.ActualTable+".NodeId ) "+n.ID+"_ID,",n.CDGDO.ActualColumn="(Select ISNULL((DATEDIFF(day,CONVERT(DATETIME,DOJ),GETDATE())+1),0) From COM_CC50051 WITH(NOLOCK) WHERE NodeID="+n.CDGDO.ActualTable+".NodeId )"):11691==n.CDGDO.FieldValue?(s.e.IsEmpty(n.CDGDO.ActualTable)&&(n.CDGDO.ActualTable=e.IsInventory?"INV":"ACC"),e.sbQuery+="convert(nvarchar,"+n.CDGDO.ActualTable+".CostCenterID)+'~'+convert(nvarchar,"+n.CDGDO.ActualTable+".DocID)"+n.ID+"_ID,",n.CDGDO.ActualColumn="'Activity'"):113==n.CDGDO.ParentCostCenterID&&"Status"==n.CDGDO.Column&&!e.IsInventory&&e.Report.Preferences.ContainsKey("ReplaceStatus")?n.CDGDO.ActualColumn="case when ACC.StatusID=429 then case when ACC.BillDate=1 then 'Replace' when ACC.BillDate=1 then 'Partial Replace' else 'Bounced' end else "+n.CDGDO.ActualColumn+" end":599==n.CDGDO.FieldValue&&(n.CDGDO.ActualColumn="BOMName");var a,r=n.CDGDO.ActualColumn;if("DATE"==n.CDGDO.DataType&&("MMM-yy"==n.DateType.Text&&e.ReportGroups.find((function(e){return e.ID==n.ID}))?r="dateadd(day,1-datepart(day,"+r+"),"+r+")":"yyyy"==n.DateType.Text&&e.ReportGroups.find((function(e){return e.ID==n.ID}))&&(r="convert(datetime,'01-01-'+convert(nvarchar,year("+r+")))")),e.sbQuery+=r,0==e.sbFinalQuery.length&&(e.IsSummaryReportType&&(e.SummarySELECT.length>0&&(e.SummarySELECT+=","),"FLOAT"==n.CDGDO.DataType?e.SummarySELECT+="sum("+n.ID+") AS "+n.ID:(e.SummarySELECT+=n.ID,e.SummaryGROUPBY.length>0&&(e.SummaryGROUPBY+=","),e.SummaryGROUPBY+=n.ID)),e.sbQuery+=" ["+n.ID+"]"),e.IncludeLFTColumn.Contains(n.ID)){var l=n.CDGDO.ActualColumn.lastIndexOf(".");e.sbQuery+=l>0?","+n.CDGDO.ActualColumn.substr(0,l+1)+"lft":",null",0==e.sbFinalQuery.length&&(e.sbQuery+=" ["+n.ID+"lft_CF]")}if(n.Sort.SelectedValue.startsWith("NUM"))e.sbQuery+=",CASE WHEN isnumeric("+n.CDGDO.ActualColumn+")=1 THEN CONVERT(FLOAT,"+n.CDGDO.ActualColumn+") ELSE 0 END AS ["+n.ID+"SORT]";else if(n.Sort.SelectedValue.startsWith("TREE")){var D=n.CDGDO.ActualColumn.lastIndexOf(".");D>0&&(e.sbQuery+=","+n.CDGDO.ActualColumn.substr(0,D+1)+"lft AS ["+n.ID+"SORT]")}else"VoucherNo"==n.CDGDO.Column&&0==n.CDGDO.IsForeignKey&&(400==n.CDGDO.CategoryValue||Math.abs(n.CDGDO.CategoryValue)>4e4&&Math.abs(n.CDGDO.CategoryValue)<5e4)&&(""!=n.Sort.SelectedValue||"1"==n.ShowAsColumn.SelectedValue?e.sbQuery+=0==e.sbFinalQuery.length?e.IsInventory?",INV.DocAbbr ["+n.ID+"Abr],INV.DocPrefix ["+n.ID+"prf],CONVERT(BIGINT,INV.DocNumber) ["+n.ID+"dno]":",ACC.DocAbbr ["+n.ID+"Abr],ACC.DocPrefix ["+n.ID+"prf],CONVERT(BIGINT,ACC.DocNumber) ["+n.ID+"dno]":e.IsInventory?",INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber)":",ACC.DocAbbr,ACC.DocPrefix,CONVERT(BIGINT,ACC.DocNumber)":(e.sbQuery+=","+(e.IsInventory?"INV":"ACC")+".VersionNo",0==e.sbFinalQuery.length&&(e.sbQuery+=" ["+n.ID+"Ver]")),"2"==n.LinkType.SelectedValue?e.sbQuery+=e.IsInventory?",INV.InvDocDetailsID ["+n.ID+"_ID]":",ACC.AccDocDetailsID ["+n.ID+"_ID]":"8"==n.LinkType.SelectedValue&&(e.sbQuery+=e.IsInventory?",INV.DocID ["+n.ID+"_DID]":",ACC.DocID ["+n.ID+"_DID]"));("-1"==n.LinkDimension.SelectedValue&&"1"==n.LinkType.SelectedValue&&(e.sbQuery+=e.IsInventory?",INV.DocID AS ["+n.ID+"_ID]":",ACC.DocID AS ["+n.ID+"_ID]"),n.IsReportMappingFilter||"3"==n.LinkType.SelectedValue||"4"==n.LinkType.SelectedValue)&&(400!=(a=null!=n.CDGDO.ChildCDGDO&&n.CDGDO.ChildCDGDO.IsForeignKey?n.CDGDO.ChildCDGDO.ParentCostCenterID:n.CDGDO.IsForeignKey?n.CDGDO.ParentCostCenterID:n.CDGDO.CategoryValue)&&(a<4e4||a>5e4)&&("NULL"!=n.CDGDO.ActualColumn?(e.drrCCTbl=e.FieldsDialog.CostCenterTables.filter((function(e){return e.FeatureID==a})),e.sbQuery+=","+n.CDGDO.ActualTable+"."+e.drrCCTbl[0].PK.toString()+" AS ["+n.ID+"_ID]"):e.sbQuery+=",NULL AS ["+n.ID+"_ID]"));if("1"==n.ShowLevel.SelectedValue||"2"==n.ShowLevel.SelectedValue)if(null==I){if(null==I&&"NULL"!=n.CDGDO.ActualColumn&&(n.CDGDO.IsForeignKey&&n.CDGDO.ColumnCostCenterID>0||!n.CDGDO.IsForeignKey)){var u=n.CDGDO.ActualColumn.lastIndexOf(".");if(u>0){n.CDGDO.IsForeignKey?e.LevelTreeCostCenterID=n.CDGDO.ColumnCostCenterID:(e.LevelTreeCostCenterID=n.CDGDO.CategoryValue,n.CDGDO.ParentCostCenterSysName=n.CDGDO.Table,e.drrCCTbl=e.FieldsDialog.CostCenterTables.filter((function(e){return e.FeatureID==n.CDGDO.CategoryValue})),n.CDGDO.ParentCostCenterColSysName=e.drrCCTbl[0].PK.toString());var c=n.CDGDO.ActualColumn.substr(0,u+1);e.sbQuery+=null!=n.CDGDO.ChildCDGDO?","+c+n.CDGDO.ChildCDGDO.ParentCostCenterColSysName+" AS TreeNodeID":","+c+n.CDGDO.ParentCostCenterColSysName+" AS TreeNodeID",null==e.LevelColumn&&(e.LevelColumn=n)}}I=e.LevelColumn}else e.LevelSubGroup=n.ID;o++},O=0;O<e.BaseReportColumns.length;O++)S(O);for(var g=0;g<e.ReportGroups.length;g++){var F=e.ReportGroups[g];if("0"==F.ShowAsColumn.SelectedValue){if(!s.e.IsEmpty(F.FormulaExpression))continue;o>0&&(e.sbQuery+=","),e.SetActualColumn(F.CDGDO,C);var f=F.CDGDO.ActualColumn;if("DATE"==F.CDGDO.DataType&&("MMM-yy"==F.DateType.Text?f="dateadd(day,1-datepart(day,"+f+"),"+f+")":"yyyy"==F.DateType.Text&&(f="convert(datetime,'01-01-'+convert(nvarchar,year("+f+")))")),e.sbQuery+=f,0==e.sbFinalQuery.length&&(e.sbQuery+=" ["+F.ID+"]"),F.Sort.SelectedValue.startsWith("NUM"))e.sbQuery+=",CASE WHEN isnumeric("+F.CDGDO.ActualColumn+")=1 THEN CONVERT(FLOAT,"+F.CDGDO.ActualColumn+") ELSE 0 END AS ["+F.ID+"SORT]";else if(F.Sort.SelectedValue.startsWith("TREE")){var R=F.CDGDO.ActualColumn.lastIndexOf(".");R>0&&(e.sbQuery+=","+F.CDGDO.ActualColumn.substr(0,R+1)+"lft AS ["+F.ID+"SORT]")}else"VoucherNo"==F.CDGDO.Column&&0==F.CDGDO.IsForeignKey&&(e.sbQuery+=0==e.sbFinalQuery.length?e.IsInventory?",INV.DocAbbr ["+F.ID+"Abr],INV.DocPrefix ["+F.ID+"prf],CONVERT(BIGINT,INV.DocNumber) ["+F.ID+"dno]":",ACC.DocAbbr ["+F.ID+"Abr],ACC.DocPrefix ["+F.ID+"prf],CONVERT(BIGINT,ACC.DocNumber) ["+F.ID+"dno]":e.IsInventory?",INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber)":",ACC.DocAbbr,ACC.DocPrefix,CONVERT(BIGINT,ACC.DocNumber)");o++}}for(var P=0,b=0;b<e.FormulaObjects.length;b++){var V=e.FormulaObjects[b];o>0&&(e.sbQuery+=","),e.SetActualColumn(V,C),e.sbQuery+=V.ActualColumn,0==e.sbFinalQuery.length&&(e.sbQuery+=" F"+P),o++,P++}e.IsAvgRateExists&&(e.StaticReportType>0||(0==C.DocID&&e.Entities.ContainsKey("Product")?e.sbQuery+=","+e.Entities.Product+".ProductID AvgRateOpStkPID,convert(float,convert(int,CONVERT(float,getdate()))) AvgRateOpStkDate":e.Entities.values.Contains("INV")?e.sbQuery+=",INV.ProductID AvgRateOpStkPID,INV.DocDate AvgRateOpStkDate":e.sbQuery+=",null AvgRateOpStkPID,null AvgRateOpStkDate")),e.IsAuthLevelReport?(Q=e.BaseReportColumns.find((function(e){return 95==e.CDGDO.CategoryValue||103==e.CDGDO.CategoryValue||104==e.CDGDO.CategoryValue||129==e.CDGDO.CategoryValue})),e.sbQuery+=Q&&95==Q.CDGDO.CategoryValue?","+e.Entities.Contract+".WorkFlowLevel,"+e.Entities.Contract+".WorkFlowID":Q&&103==Q.CDGDO.CategoryValue?","+e.Entities.Quotation+".WorkFlowLevel,"+e.Entities.Quotation+".WorkFlowID":Q&&104==Q.CDGDO.CategoryValue?","+e.Entities["Purchase Contract"]+".WorkFlowLevel,"+e.Entities["Purchase Contract"]+".WorkFlowID":Q&&129==Q.CDGDO.CategoryValue?","+e.Entities["Unit Reservation"]+".WorkFlowLevel,"+e.Entities["Unit Reservation"]+".WorkFlowID":e.IsInventory?",INV.WorkFlowLevel,INV.WorkFlowID":",ACC.WorkFlowLevel,ACC.WorkFlowID"):null!=e.BulkEdit&&e.BulkEdit.IsLWApproval&&(e.sbQuery+=e.IsInventory?",INV.WorkFlowID":",ACC.WorkFlowID"),e.IsRevision&&(e.sbQuery+=e.IsInventory?",INV.VoucherNo RevDocNo,INV.VersionNo RevVersionNo,INV.ModifiedDate RevModDate":",ACC.VoucherNo RevDocNo,ACC.VersionNo RevVersionNo,ACC.ModifiedDate RevModDate"),s.e.IsEmpty(e.FileProtection)||("Account1"==e.FileProtection&&e.IsInventory?e.sbQuery+=",INV.Account1 FilePwdID":e.FileProtection.Contains("Account")?e.sbQuery+="INV":"Employee"==e.FileProtection&&(e.sbQuery+=",TDCC.dcCCNID51 FilePwdID")),112==e.CostCenterID&&(e.sbQuery+=",INV.InvDocDetailsID ReorderDetailsID"),e.SelectTag=e.sbQuery.toString()}e.sbQuery="";var v=[],_=[];if(e.IsNewFromClause){if(e.ShowOnlyAccountingData&&C.ShowAccountingData)if(C.IsInventory){if(e.sbQuery+="ACC_DocDetails ACC with(nolock) join ",Math.abs(C.DocID)<4e4&&null!=e.IncludeNonAccDocs){var w="";e.IncludeNonAccDocs.forEach((function(e){w.length>0&&(w+=","),w+="'"+e+"'"})),c.length>0&&(c+=" AND "),c+="INV.CostCenterID not in ("+w+")"}}else c.length>0&&(c+=" AND "),c+="ACC.InvDocDetailsID is null";if((e.Entities.values.Contains("INV")||e.Entities.values.Contains("ACC"))&&(e.IsInventory&&"INV"!=e.Entities.values[0]||!e.IsInventory&&"ACC"!=e.Entities.values[0])){X=e.Entities.values,j=e.Entities.keys,Y=e.Objects;var x=X.indexOf(e.IsInventory?"INV":"ACC");e.Entities.Clear(),e.Objects.Clear(),e.Entities.push(j[x],X[x]),e.Objects.push(Y[x]);for(var G=0;G<X.length;G++)G!=x&&(e.Entities.push(j[G],X[G]),e.Objects.push(Y[G]))}o=0;for(var k=function(t){var a=e.Objects[t];for(T=0;T<t&&e.Entities.values[T]!=e.Entities.values[t];T++);if(T==t)if(o>0&&(e.sbQuery+=" left join "),null==a.DimensionsFilter||64!=a.ParentCCDefaultColID&&64!=a.ParentCCDefaultColID){if(210!=a.FieldValue){if(e.IsHistory&&n.HistoryTables[e.iHistoryStatusID].Contains(a.Table)?(e.Filter.ShowArchive.Visible&&e.Filter.ShowArchive.IsChecked&&(e.sbQuery+="PACT2C"+i.a.SessionManager.CompanyIndex+"_ARCHIVE.dbo."),e.iHistoryStatusID>=11701&&e.iHistoryStatusID<=11750&&0==s.e.stringCompare(n.HistoryTables[e.iHistoryStatusID][0],a.Table,!0)?(c.length>0&&(c+=" AND "),c+=e.Entities.values[t]+".CostCenterID="+a.CategoryValue,e.sbQuery+="COM_CCMastHistory "+e.Entities.values[t]+" with(nolock)"):e.sbQuery+=a.Table+e.strHistorySepChar+"History "+e.Entities.values[t]+" with(nolock)"):e.sbQuery+=a.Table+" "+e.Entities.values[t]+" with(nolock)","COM_ADDRESS"==a.Table.toUpperCase()){if(e.Entities.ContainsKey(a.CategoryText)){var r="NodeID";2==a.ColumnCostCenterID?r="AccountID":83==a.ColumnCostCenterID&&(r="CustomerID"),e.sbQuery+=" on "+e.Entities[a.CategoryText]+"."+r+"="+e.Entities.values[t]+".FeaturePK",e.sbQuery+=" AND "+e.Entities.values[t]+".AddressTypeID=1 AND "+e.Entities.values[t]+".FeatureID="+a.ColumnCostCenterID}}else if("COM_CONTACTSEXTENDED"==a.Table.toUpperCase());else if("COM_CONTACTS"==a.Table.toUpperCase()&&"COM_DOCCCDATA"!=a.ParentTable.toUpperCase()){if(65!=a.CategoryValue&&e.Entities.ContainsKey(a.CategoryText)||null!=a.ChildCDGDO&&(144!=a.ChildCDGDO.CategoryValue||65!=a.ChildCDGDO.ParentCostCenterID)){var l=a.ColumnCostCenterID>0?a.ColumnCostCenterID.toString():a.CategoryValue.toString();e.drrCCTbl=e.FieldsDialog.CostCenterTables.filter((function(e){return e.FeatureID==l}));var D=a.CategoryText.lastIndexOf(".");e.sbQuery+=-1==D||"51"==l?" on "+e.Entities[a.CategoryText]+"."+e.drrCCTbl[0].PK.toString()+"="+e.Entities.values[t]+".FeaturePK":" on "+e.Entities[a.CategoryText.substr(0,D)]+"."+e.drrCCTbl[0].PK.toString()+"="+e.Entities.values[t]+".FeaturePK",e.sbQuery+=" AND "+e.Entities.values[t]+".FeatureID="+l}}else if("CRM_CONTACTS"==a.Table.toUpperCase()){if(e.Entities.ContainsKey(a.CategoryText)){var u;u="Leads"==a.CategoryText?"LeadID":"Opportunity"==a.CategoryText?"OpportunityID":e.drrCCTbl[0].PK.toString(),e.sbQuery+=" on "+e.Entities[a.CategoryText]+"."+u+"="+e.Entities.values[t]+".FeaturePK",e.sbQuery+=" AND "+e.Entities.values[t]+".FeatureID="+a.CategoryValue}}else if("CRM_ACTIVITIES"==a.Table.toUpperCase()){if(144!=a.CategoryValue&&e.Entities.ContainsKey(a.CategoryText)&&null!=a.ParentTableAlias&&e.Entities.ContainsKey(a.ParentTableAlias))e.sbQuery+=" on "+e.Entities[a.ParentTableAlias]+"."+a.ParentColumn+"="+e.Entities.values[t]+"."+a.ParentCostCenterColSysName,e.sbQuery+=" AND "+e.Entities.values[t]+".CostCenterID="+a.CategoryValue;else if(e.Filter.ActivityTypes.Visible){var I="";e.Filter.ActivityTypes.Items.forEach((function(e){e.IsChecked&&(I+=e.Value+",")})),I.length>0&&((I=I.TrimEnd(",")).Contains(",")?c+=e.Entities.values[t]+".CostCenterID IN ("+I+")":c+=e.Entities.values[t]+".CostCenterID="+I)}if(e.Filter.UsersList.Visible){var h="";e.Filter.UsersList.Items.forEach((function(e){e.IsChecked&&(h+=e.Value+",")})),0==h.length&&"1"!=i.a.SessionManager.RoleID&&(h="-1"),h.length>0&&(h=h.TrimEnd(",")).length>0&&(e.sbQuery.length>0&&(e.sbQuery+=" join "),e.sbQuery+="  (select a.ISFROMACTIVITY,a.ccid,a.CCNODEID  from CRM_Assignment a with(nolock) where ISFROMACTIVITY>0 and UserID>0 and IsTeam=0 and IsRole=0 and IsGroup=0 and TeamNodeID=0 and a.UserID IN ("+h+") union select a.ISFROMACTIVITY,a.ccid,a.ccnodeid  from CRM_Assignment a with(nolock) join ADM_UserRoleMap map  with(nolock) on a.userid=map.roleid where ISFROMACTIVITY>0 and  a.UserID>0 and a.IsTeam=0 and a.IsRole=1 and a.IsGroup=0 and map.UserID IN ("+h+") union select a.ISFROMACTIVITY,a.ccid,a.ccnodeid  from CRM_Assignment a with(nolock) join com_groups g on a.TeamNodeID=g.gid join ADM_UserRoleMap map  with(nolock) on g.userid=map.userid or g.roleid=map.roleid where ISFROMACTIVITY>0 and  a.UserID=0 and a.IsTeam=0 and a.IsRole=0 and a.IsGroup=1 and a.TeamNodeID>0  and map.UserID IN ("+h+") union select a.ISFROMACTIVITY,a.ccid,a.ccnodeid   from CRM_Assignment a with(nolock) join CRM_Teams T   with(nolock) on a.TEAMNodeID=T.TEAMID and a.userid=t.userid where ISFROMACTIVITY>0 and a.UserID>0 and a.IsTeam=0 AND a.TeamNodeID>0 and a.IsRole=0 and a.IsGroup=0  and T.UserID IN ("+h+")) T ",e.sbQuery+=" on T.ISFROMACTIVITY="+e.Entities.values[t]+".ActivityID and T.ccid="+e.Entities.values[t]+".COSTCENTERID AND T.CCNODEID="+e.Entities.values[t]+".NODEID")}}else if("CRM_FEEDBACK"==a.Table.toUpperCase()||"CRM_LEADCVRDETAILS"==a.Table.toUpperCase())e.Entities.ContainsKey(a.CategoryText)&&(e.sbQuery+=" on "+e.Entities[a.ParentTableAlias]+"."+a.ParentColumn+"="+e.Entities.values[t]+"."+a.ParentCostCenterColSysName,e.sbQuery+=" AND "+e.Entities.values[t]+".CCID="+a.CategoryValue);else if("CRM_PRODUCTMAPPING"==a.Table.toUpperCase())e.Entities.ContainsKey(a.CategoryText)&&(e.sbQuery+=" on "+e.Entities[a.ParentTableAlias]+"."+a.ParentColumn+"="+e.Entities.values[t]+"."+a.ParentCostCenterColSysName,e.sbQuery+=" AND "+e.Entities.values[t]+".CostCenterID="+a.CategoryValue);else if("COM_NOTES"==a.Table.toUpperCase())e.Entities.ContainsKey(a.CategoryText)&&(e.sbQuery+=" on "+e.Entities[a.ParentTableAlias]+"."+a.ParentColumn+"="+e.Entities.values[t]+"."+a.ParentCostCenterColSysName,e.sbQuery+=" AND "+e.Entities.values[t]+".FeatureID="+a.CategoryValue);else if("PAY_EMPPAY"==a.Table.toUpperCase())405==a.CategoryValue&&(e.sbQuery+=" on "+e.Entities.values[t]+".SeqNo IN (SELECT TOP 1 SeqNo FROM PAY_EMPPAY with(nolock) WHERE EmployeeID=TDCC.dcCCNID51 AND (DATEDIFF(day,CONVERT(DATETIME,EffectFrom),CONVERT(DATETIME,INV.DueDate))>=0 OR ((month(CONVERT(DATETIME,EffectFrom)))=MONTH(CONVERT(DATETIME,INV.DueDate)) AND (YEAR(CONVERT(DATETIME,EffectFrom)))=YEAR(CONVERT(DATETIME,INV.DueDate))))  ORDER BY EffectFrom DESC)");else if("REN_ContractParticulars"==a.Table||"REN_ContractPayTerms"==a.Table||"REN_QuotationParticulars"==a.Table||"REN_QuotationPayTerms"==a.Table){if(e.Entities.ContainsKey(a.CategoryText)&&!s.e.IsEmpty(a.ParentTableAlias)){var d=a.ColumnCostCenterID>0?a.ColumnCostCenterID.toString():a.CategoryValue.toString();e.drrCCTbl=e.FieldsDialog.CostCenterTables.filter((function(e){return e.FeatureID==d})),e.sbQuery+=" on "+e.Entities[a.ParentTableAlias]+"."+e.drrCCTbl[0].PK.toString()+"="+e.Entities[a.ParentTableAlias.Replace(a.Table,"")]+"."+e.drrCCTbl[0].PK.toString()}}else"PRD_BILLOFMATERIAL"==a.Table.toUpperCase()&&599==a.FieldValue?e.sbQuery+=" on "+e.Entities[a.ParentTableAlias]+"."+a.FieldText.toString()+"="+e.Entities.Values[t]+".BOMID":a.IsForeignKey&&("ACC"==e.Entities[a.ParentTableAlias]&&"AccountID"==a.ParentColumn?(e.sbQuery+=" on ((ACC.DebitAccount>0 and ACC.DebitAccount="+e.Entities.values[t]+".AccountID) or (ACC.CreditAccount>0 and ACC.CreditAccount="+e.Entities.values[t]+".AccountID))",v.push(e.Entities.values[t]),_.push(e.Entities.values[t])):("INV_ProductExtended"==a.Table||"ACC_AccountsExtended"==a.Table||"REN_PropertyExtended"==a.Table||"REN_UnitsExtended"==a.Table||"REN_TenantExtended"==a.Table||(e.sbQuery+=e.ShowOnlyAccountingData&&C.ShowAccountingData&&C.IsInventory&&(2==a.ParentCostCenterID||12==a.ParentCostCenterID)?" on ACC."+a.ParentColumn+"="+e.Entities.values[t]+"."+a.ParentCostCenterColSysName:" on "+e.Entities[a.ParentTableAlias]+"."+a.ParentColumn+"="+e.Entities.values[t]+"."+a.ParentCostCenterColSysName),0==s.e.stringCompare("DebitAccount",a.ParentColumn,!0)?v.push(e.Entities.values[t]):0==s.e.stringCompare("CreditAccount",a.ParentColumn,!0)&&_.push(e.Entities.values[t]),65==a.CategoryValue?26645==a.FieldValue?e.sbQuery+=" AND "+e.Entities[a.ParentTableAlias]+".FeatureID=2":26644==a.FieldValue&&(e.sbQuery+=" AND "+e.Entities[a.ParentTableAlias]+".FeatureID=83"):24==a.CategoryValue&&107==a.FieldValue?e.sbQuery+=" AND "+e.Entities[a.ParentTableAlias]+".ProductID="+e.Entities.values[t]+".ProductID":86==a.CategoryValue?27179==a.FieldValue?e.sbQuery+=" AND "+e.Entities[a.ParentTableAlias]+".Mode=3":27180==a.FieldValue&&(e.sbQuery+=" AND "+e.Entities[a.ParentTableAlias]+".Mode=2"):73==a.CategoryValue&&(27303==a.FieldValue?e.sbQuery+=" AND "+e.Entities[a.ParentTableAlias]+".CustomerMode=2":27304==a.FieldValue&&(e.sbQuery+=" AND "+e.Entities[a.ParentTableAlias]+".CustomerMode=1"))),0==s.e.stringCompare(a.Table,"COM_CCCCData",!0)&&(e.sbQuery+=" AND "+e.Entities.values[t]+".CostCenterID="+a.CategoryValue),e.IsHistory&&n.HistoryTables[e.iHistoryStatusID].Contains(a.Table)&&(e.sbQuery+=e.iHistoryStatusID>=11701&&e.iHistoryStatusID<=11750?" AND "+e.Entities[a.ParentTableAlias]+".NodeHistoryID="+e.Entities.values[t]+".NodeHistoryID":" AND "+e.Entities[a.ParentTableAlias]+".ModifiedDate="+e.Entities.values[t]+".ModifiedDate"));if(null!=a.ParentCDGDO){var y=e.FieldsDialog.Relations.filter((function(e){return e.PK_Table==a.ParentCDGDO.Table.toUpperCase()&&e.FK_Table==a.Table.toUpperCase()}));y.length>0?(e.sbQuery+=" on "+e.Entities[a.ParentCDGDO.CategoryText]+"."+y[0].PK_Column.toString()+"="+e.Entities.values[t]+"."+y[0].FK_Column.toString(),e.IsHistory&&n.HistoryTables[e.iHistoryStatusID].Contains(a.Table)&&(e.sbQuery+=" AND "+e.Entities[a.ParentCDGDO.CategoryText]+".ModifiedDate="+e.Entities.values[t]+".ModifiedDate")):(y=e.FieldsDialog.Relations.filter((function(e){return e.FK_Table==a.ParentCDGDO.Table.toUpperCase()&&e.PK_Table==a.Table.toUpperCase()}))).length>0&&(e.sbQuery+=" on "+e.Entities[a.ParentCDGDO.CategoryText]+"."+y[0].FK_Column.toString()+"="+e.Entities.values[t]+"."+y[0].PK_Column.toString())}0==t&&e.ShowOnlyAccountingData&&C.ShowAccountingData&&C.IsInventory&&(e.sbQuery+=" on ACC.InvDocDetailsID=INV.InvDocDetailsID"),o++}else if(e.IsInventory&&e.Filter.IsReportViewScreen){var A=s.e.IsEmpty(a.DimensionsFilter)?[null,null,null,null]:a.DimensionsFilter.split("~"),p=e;if(p.SetDatePickers(),s.e.IsEmptySpace(A[2])){var E=null!=m.find((function(e){return 3==e.CategoryValue}))?e.Entities.Product:"INV";e.sbQuery+="dbo.fnRPT_AvgRateAllProds('','','"+p.FromDatePicker.Date.ToString("dd MMM yyyy")+"','"+p.ToDatePicker.Date.ToString("dd MMM yyyy")+"',0,0,0,0,'') "+e.Entities.values[t],e.sbQuery+=" on "+e.Entities.values[t]+".ProductID="+E+".ProductID"}else{var N=s.e.IsEmptySpace(A[1])?0:parseInt(A[1]);e.sbQuery+="dbo."+A[2]+"('','','"+p.FromDatePicker.Date.ToString("dd MMM yyyy")+"','"+p.ToDatePicker.Date.ToString("dd MMM yyyy")+"',0,0,0,0,'') "+e.Entities.values[t],N>0?(A.length>3&&"1"==A[3]&&(c+=e.Entities.values[t]+".ProductID=INV.ProductID and"),e.sbQuery+=" on "+e.Entities.values[t]+".TagID=TDCC.dcCCNID"+(N-5e4)):e.sbQuery+=" on "+e.Entities.values[t]+".ProductID=INV.ProductID"}}}else e.sbQuery+="(select BaseID,max(Conversion) MaxConv,min(Conversion) MinConv from COM_UOM with(nolock) group by BaseID)"+e.Entities[a.CategoryText+"_MAXMIN"],e.sbQuery+=" on "+e.Entities[a.CategoryText]+".BaseID="+e.Entities[a.CategoryText+"_MAXMIN"]+".BaseID"},H=0;H<e.Entities.length;H++)k(H)}else{if(e.ShowOnlyAccountingData&&C.ShowAccountingData)if(c.length>0&&(c+=" AND "),C.IsInventory){if(e.sbQuery+="ACC_DocDetails ACC with(nolock),",c+="ACC.InvDocDetailsID=INV.InvDocDetailsID",Math.abs(C.DocID)<4e4&&null!=e.IncludeNonAccDocs){var W="";e.IncludeNonAccDocs.forEach((function(e){W.length>0&&(W+=","),W+="'"+e+"'"})),c+=" AND INV.CostCenterID not in ("+W+")"}}else c+="ACC.InvDocDetailsID is null";o=0;for(var U=function(t){var a=e.Objects[t];for(T=0;T<t&&e.Entities.values[T]!=e.Entities.values[t];T++);if(T==t)if(o>0&&(e.sbQuery+=","),null==a.DimensionsFilter||64!=a.ParentCCDefaultColID&&64!=a.ParentCCDefaultColID){if(210!=a.FieldValue){if(e.IsHistory&&n.HistoryTables[e.iHistoryStatusID].Contains(a.Table)?(e.Filter.ShowArchive.Visible&&e.Filter.ShowArchive.IsChecked&&(e.sbQuery+="PACT2C"+i.a.SessionManager.CompanyIndex+"_ARCHIVE.dbo."),e.iHistoryStatusID>=11701&&e.iHistoryStatusID<=11750&&0==s.e.stringCompare(n.HistoryTables[e.iHistoryStatusID][0],a.Table,!0)?(c.length>0&&(c+=" AND "),c+=e.Entities.values[t]+".CostCenterID="+a.CategoryValue,e.sbQuery+="COM_CCMastHistory "+e.Entities.values[t]+" with(nolock)"):e.sbQuery+=a.Table+e.strHistorySepChar+"History "+e.Entities.values[t]+" with(nolock)"):e.sbQuery+=a.Table+" "+e.Entities.values[t]+" with(nolock)","COM_ADDRESS"==a.Table.toUpperCase()){if(e.Entities.ContainsKey(a.CategoryText)){c.length>0&&(c+=" AND ");var r="NodeID";2==a.ColumnCostCenterID?r="AccountID":83==a.ColumnCostCenterID&&(r="CustomerID"),c+=e.Entities[a.CategoryText]+"."+r+"="+e.Entities.values[t]+".FeaturePK",c+=" AND "+e.Entities.values[t]+".AddressTypeID=1 AND "+e.Entities.values[t]+".FeatureID="+a.ColumnCostCenterID}}else if("COM_CONTACTSEXTENDED"==a.Table.toUpperCase());else if("COM_CONTACTS"==a.Table.toUpperCase()&&"COM_DOCCCDATA"!=a.ParentTable.toUpperCase()){if(65!=a.CategoryValue&&e.Entities.ContainsKey(a.CategoryText)||null!=a.ChildCDGDO&&(144!=a.ChildCDGDO.CategoryValue||65!=a.ChildCDGDO.ParentCostCenterID)){c.length>0&&(c+=" AND ");var l=a.ColumnCostCenterID>0?a.ColumnCostCenterID.toString():a.CategoryValue.toString();e.drrCCTbl=e.FieldsDialog.CostCenterTables.filter((function(e){return e.FeatureID==l}));var D=a.CategoryText.lastIndexOf(".");c+=-1==D||"51"==l?e.Entities[a.CategoryText]+"."+e.drrCCTbl[0].PK.toString()+"="+e.Entities.values[t]+".FeaturePK":e.Entities[a.CategoryText.substr(0,D)]+"."+e.drrCCTbl[0].PK.toString()+"="+e.Entities.values[t]+".FeaturePK",c+=" AND "+e.Entities.values[t]+".FeatureID="+l}}else if("CRM_CONTACTS"==a.Table.toUpperCase()){if(e.Entities.ContainsKey(a.CategoryText)){var u;c.length>0&&(c+=" AND "),u="Leads"==a.CategoryText?"LeadID":"Opportunity"==a.CategoryText?"OpportunityID":e.drrCCTbl[0].PK.toString(),c+=e.Entities[a.CategoryText]+"."+u+"="+e.Entities.values[t]+".FeaturePK",c+=" AND "+e.Entities.values[t]+".FeatureID="+a.CategoryValue}}else if("CRM_ACTIVITIES"==a.Table.toUpperCase()){if(144!=a.CategoryValue&&e.Entities.ContainsKey(a.CategoryText)&&null!=a.ParentTableAlias&&e.Entities.ContainsKey(a.ParentTableAlias))c.length>0&&(c+=" AND "),c+=e.Entities[a.ParentTableAlias]+"."+a.ParentColumn+"="+e.Entities.values[t]+"."+a.ParentCostCenterColSysName,c+=" AND "+e.Entities.values[t]+".CostCenterID="+a.CategoryValue;else if(e.Filter.ActivityTypes.Visible){var I="";e.Filter.ActivityTypes.Items.forEach((function(e){e.IsChecked&&(I+=e.Value+",")})),I.length>0&&((I=I.TrimEnd(",")).Contains(",")?c+=e.Entities.values[t]+".CostCenterID IN ("+I+")":c+=e.Entities.values[t]+".CostCenterID="+I)}if(e.Filter.UsersList.Visible){var h="";e.Filter.UsersList.Items.forEach((function(e){e.IsChecked&&(h+=e.Value+",")})),0==h.length&&"1"!=i.a.SessionManager.RoleID&&(h="-1"),h.length>0&&(h=h.TrimEnd(",")).length>0&&(e.sbQuery.length>0&&(e.sbQuery+=","),e.sbQuery+="  (select a.ISFROMACTIVITY,a.ccid,a.CCNODEID  from CRM_Assignment a with(nolock) where ISFROMACTIVITY>0 and UserID>0 and IsTeam=0 and IsRole=0 and IsGroup=0 and TeamNodeID=0 and a.UserID IN ("+h+") union select a.ISFROMACTIVITY,a.ccid,a.ccnodeid  from CRM_Assignment a with(nolock) join ADM_UserRoleMap map  with(nolock) on a.userid=map.roleid where ISFROMACTIVITY>0 and  a.UserID>0 and a.IsTeam=0 and a.IsRole=1 and a.IsGroup=0 and map.UserID IN ("+h+") union select a.ISFROMACTIVITY,a.ccid,a.ccnodeid  from CRM_Assignment a with(nolock) join com_groups g on a.TeamNodeID=g.gid join ADM_UserRoleMap map  with(nolock) on g.userid=map.userid or g.roleid=map.roleid where ISFROMACTIVITY>0 and  a.UserID=0 and a.IsTeam=0 and a.IsRole=0 and a.IsGroup=1 and a.TeamNodeID>0  and map.UserID IN ("+h+") union select a.ISFROMACTIVITY,a.ccid,a.ccnodeid   from CRM_Assignment a with(nolock) join CRM_Teams T   with(nolock) on a.TEAMNodeID=T.TEAMID and a.userid=t.userid where ISFROMACTIVITY>0 and a.UserID>0 and a.IsTeam=0 AND a.TeamNodeID>0 and a.IsRole=0 and a.IsGroup=0  and T.UserID IN ("+h+")) T ",c.length>0&&(c+=" AND "),c+="T.ISFROMACTIVITY="+e.Entities.values[t]+".ActivityID and T.ccid="+e.Entities.values[t]+".COSTCENTERID AND T.CCNODEID="+e.Entities.values[t]+".NODEID")}}else"CRM_FEEDBACK"==a.Table.toUpperCase()||"CRM_LEADCVRDETAILS"==a.Table.toUpperCase()?e.Entities.ContainsKey(a.CategoryText)&&(c.length>0&&(c+=" AND "),c+=e.Entities[a.ParentTableAlias]+"."+a.ParentColumn+"="+e.Entities.values[t]+"."+a.ParentCostCenterColSysName,c+=" AND "+e.Entities.values[t]+".CCID="+a.CategoryValue):"CRM_PRODUCTMAPPING"==a.Table.toUpperCase()?e.Entities.ContainsKey(a.CategoryText)&&(c.length>0&&(c+=" AND "),c+=e.Entities[a.ParentTableAlias]+"."+a.ParentColumn+"="+e.Entities.values[t]+"."+a.ParentCostCenterColSysName,c+=" AND "+e.Entities.values[t]+".CostCenterID="+a.CategoryValue):"COM_NOTES"==a.Table.toUpperCase()?e.Entities.ContainsKey(a.CategoryText)&&(c.length>0&&(c+=" AND "),c+=e.Entities[a.ParentTableAlias]+"."+a.ParentColumn+"="+e.Entities.values[t]+"."+a.ParentCostCenterColSysName,c+=" AND "+e.Entities.values[t]+".FeatureID="+a.CategoryValue):a.IsForeignKey&&(c.length>0&&(c+=" AND "),"ACC"==e.Entities[a.ParentTableAlias]&&"AccountID"==a.ParentColumn?(c+="((ACC.DebitAccount>0 and ACC.DebitAccount="+e.Entities.values[t]+".AccountID) or (ACC.CreditAccount>0 and ACC.CreditAccount="+e.Entities.values[t]+".AccountID))",v.push(e.Entities.values[t]),_.push(e.Entities.values[t])):(c+=e.ShowOnlyAccountingData&&C.ShowAccountingData&&C.IsInventory&&(2==a.ParentCostCenterID||12==a.ParentCostCenterID)?"ACC."+a.ParentColumn+"="+e.Entities.values[t]+"."+a.ParentCostCenterColSysName:e.Entities[a.ParentTableAlias]+"."+a.ParentColumn+"="+e.Entities.values[t]+"."+a.ParentCostCenterColSysName,0==s.e.stringCompare("DebitAccount",a.ParentColumn,!0)?v.push(e.Entities.values[t]):0==s.e.stringCompare("CreditAccount",a.ParentColumn,!0)&&_.push(e.Entities.values[t]),65==a.CategoryValue?26645==a.FieldValue?c+=" AND "+e.Entities[a.ParentTableAlias]+".FeatureID=2":26644==a.FieldValue&&(c+=" AND "+e.Entities[a.ParentTableAlias]+".FeatureID=83"):24==a.CategoryValue&&107==a.FieldValue?c+=" AND "+e.Entities[a.ParentTableAlias]+".ProductID="+e.Entities.values[t]+".ProductID":86==a.CategoryValue?27179==a.FieldValue?c+=" AND "+e.Entities[a.ParentTableAlias]+".Mode=3":27180==a.FieldValue&&(c+=" AND "+e.Entities[a.ParentTableAlias]+".Mode=2"):73==a.CategoryValue&&(27303==a.FieldValue?c+=" AND "+e.Entities[a.ParentTableAlias]+".CustomerMode=2":27304==a.FieldValue&&(c+=" AND "+e.Entities[a.ParentTableAlias]+".CustomerMode=1"))),0==s.e.stringCompare(a.Table,"COM_CCCCData",!0)&&(c+=" AND "+e.Entities.values[t]+".CostCenterID="+a.CategoryValue),e.IsHistory&&n.HistoryTables[e.iHistoryStatusID].Contains(a.Table)&&(c+=e.iHistoryStatusID>=11701&&e.iHistoryStatusID<=11750?" AND "+e.Entities[a.ParentTableAlias]+".NodeHistoryID="+e.Entities.values[t]+".NodeHistoryID":" AND "+e.Entities[a.ParentTableAlias]+".ModifiedDate="+e.Entities.values[t]+".ModifiedDate"));if(null!=a.ParentCDGDO){var d=e.FieldsDialog.Relations.filter((function(e){return e.PK_Table==a.ParentCDGDO.Table.toUpperCase()&&e.FK_Table==a.Table.toUpperCase()}));d.length>0?(c.length>0&&(c+=" AND "),c+=e.Entities[a.ParentCDGDO.CategoryText]+"."+d[0].PK_Column.toString()+"="+e.Entities.values[t]+"."+d[0].FK_Column.toString(),e.IsHistory&&n.HistoryTables[e.iHistoryStatusID].Contains(a.Table)&&(c+=" AND "+e.Entities[a.ParentCDGDO.CategoryText]+".ModifiedDate="+e.Entities.values[t]+".ModifiedDate")):(d=e.FieldsDialog.Relations.filter((function(e){return e.FK_Table==a.ParentCDGDO.Table.toUpperCase()&&e.PK_Table==a.Table.toUpperCase()}))).length>0&&(c.length>0&&(c+=" AND "),c+=e.Entities[a.ParentCDGDO.CategoryText]+"."+d[0].FK_Column.toString()+"="+e.Entities.values[t]+"."+d[0].PK_Column.toString())}o++}else if(e.IsInventory&&e.Filter.IsReportViewScreen){var y=s.e.IsEmpty(a.DimensionsFilter)?[null,null,null,null]:a.DimensionsFilter.split("~"),A=e;if(A.SetDatePickers(),s.e.IsEmptySpace(y[2])){var p=null!=m.find((function(e){return 3==e.CategoryValue}))?e.Entities.Product:"INV";e.sbQuery+="dbo.fnRPT_AvgRateAllProds('','','"+A.FromDatePicker.Date.ToString("dd MMM yyyy")+"','"+A.ToDatePicker.Date.ToString("dd MMM yyyy")+"',0,0,0,0,'') "+e.Entities.values[t],c.length>0&&(c+=" AND "),c+=e.Entities.values[t]+".ProductID="+p+".ProductID"}else{var E=s.e.IsEmptySpace(y[1])?0:parseInt(y[1]);e.sbQuery+="dbo."+y[2]+"('','','"+A.FromDatePicker.Date.ToString("dd MMM yyyy")+"','"+A.ToDatePicker.Date.ToString("dd MMM yyyy")+"',0,0,0,0,'') "+e.Entities.values[t],c.length>0&&(c+=" AND "),E>0?(e.sbQuery+=" on ",y.length>3&&"1"==y[3]&&(e.sbQuery+=e.Entities.vValues[t]+".ProductID=INV.ProductID and "),e.sbQuery+=e.Entities.values[t]+".TagID=TDCC.dcCCNID"+(E-5e4)):c+=e.Entities.values[t]+".ProductID=INV.ProductID"}}}else e.sbQuery+="(select BaseID,max(Conversion) MaxConv,min(Conversion) MinConv from COM_UOM with(nolock) group by BaseID)"+e.Entities[a.CategoryText+"_MAXMIN"],c.length>0&&(c+=" AND "),c+=e.Entities[a.CategoryText]+".BaseID="+e.Entities[a.CategoryText+"_MAXMIN"]+".BaseID"},K=0;K<e.Entities.length;K++)U(K)}!e.Entities.values.Contains("TDCC")&&e.Filter.CostCenterFilters.find((function(e){return e.CostCenterID>5e4}))&&(e.Entities.values.Contains("INV")||e.Entities.values.Contains("ACC"))&&(e.IsNewFromClause?(e.sbQuery+=" join COM_DocCCDATA TDCC with(nolock) on ",e.Entities.values.Contains("INV")?e.sbQuery+="INV.InvDocDetailsID=TDCC.InvDocDetailsID":e.sbQuery+="ACC.AccDocDetailsID=TDCC.AccDocDetailsID"):(e.sbQuery+=",COM_DocCCDATA TDCC with(nolock)",c.length>0&&(c+=" AND "),e.Entities.values.Contains("INV")?c+="INV.InvDocDetailsID=TDCC.InvDocDetailsID":c+="ACC.AccDocDetailsID=TDCC.AccDocDetailsID")),e.FromTagExtra.length>0&&(e.sbQuery+=e.FromTagExtra),e.ShowUnAppDocsToApprove&&!e.ShowUnAppDocsToApprove_UseFuncCall&&(e.sbQuery+=",#TblUsrWF WF");var z=e.BaseReportColumns.find((function(e){return 27296==e.CDGDO.FieldValue}));if(z&&(e.sbQuery+=" LEFT JOIN CRM_Assignment ASS WITH(nolock) ON "+e.Entities[z.CDGDO.CategoryText]+".ActivityID=ASS.ISFROMACTIVITY LEFT JOIN ADM_Users U WITH(NOLOCK) ON ASS.UserID=U.UserID"),null!=u){var Z;e.sbQuery+=",COM_BudgetAlloc BALL with(nolock)";var $="BALL.BudgetDefID="+l;u.Tables[0].forEach((function(t){(Z=parseInt(t.CostCenterID))>5e4?($+=" AND BALL.CCNID"+(Z-5e4)+"="+e.Entities.Documents_CCMAP+".dcCCNID"+(Z-5e4),e.SelectTag+=",BALL.CCNID"+(Z-5e4)+" AS BUD_"+Z):2==Z?($+=e.IsInventory?" AND (BALL.AccountID=INV.DebitAccount OR BALL.AccountID=INV.CreditAccount)":" AND (BALL.AccountID=ACC.DebitAccount OR BALL.AccountID=ACC.CreditAccount)",e.SelectTag+=",BALL.AccountID AS BUD_2"):3==Z&&(e.IsInventory&&($+=" AND BALL.ProductID=INV.ProductID"),e.SelectTag+=",BALL.ProductID AS BUD_3")})),c.length>0?c+=" AND "+$:c=$}e.FromTag=e.sbQuery.toString(),e.sbQuery="";var ee="";ee+=c;var te=0;if(e.Filter.IsReportViewScreen){var oe=e;oe.Preferences.ContainsKey("DebitCreditAccountFilter")&&("CreditAccount"==oe.Preferences.DebitCreditAccountFilter?te=1:"Both"==oe.Preferences.DebitCreditAccountFilter&&(te=2))}var ne,ie=e.Filter.CostCenterFilters.find((function(e){return 502==e.CostCenterID})),se=e.Filter.CostCenterFilters.find((function(e){return-502==e.CostCenterID}));if(ie||se){var ae="",re="";if(ie&&ie.SelectedNodes.forEach((function(e){ae.length>0&&(ae+=","),ae+=e.Id})),se&&se.SelectedNodes.forEach((function(e){re.length>0&&(re+=","),re+=e.Id})),ae.length>0||re.length>0){var le="ACC",De=null,Ce=null;C.IsInventory&&(le="INV"),v.length>0?De=v[0]+".AccountTypeID":e.ShowDebitCreditAmount&&C.ShowAccountingData&&!C.IsDebit&&0==re.length||(e.FromTag+=",ACC_Accounts XADRX with(nolock)",ee.length>0&&(ee+=" AND "),ee+="XADRX.AccountID="+le+".DebitAccount",De="XADRX.AccountTypeID"),_.length>0?Ce=_[0]+".AccountTypeID":e.ShowDebitCreditAmount&&C.ShowAccountingData&&C.IsDebit&&0==re.length||(e.FromTag+=",ACC_Accounts XACRX with(nolock)",ee.length>0&&(ee+=" AND "),ee+="XACRX.AccountID="+le+".CreditAccount",Ce="XACRX.AccountTypeID"),ee.length>0&&(ee+=" AND "),e.ShowDebitCreditAmount&&C.ShowAccountingData?(ae.length>0&&(ee+=C.IsDebit?De:Ce,ae.Contains(",")?ee+=" in ("+ae+")":ee+="="+ae),re.length>0&&(ae.length>0&&(ee+=" and "),ee+=C.IsDebit?Ce:De,re.Contains(",")?ee+=" in ("+re+")":ee+="="+re)):ae.Contains(",")?ee+="("+De+" in ("+ae+") or "+Ce+" in ("+ae+"))":ee+="("+De+"="+ae+" or "+Ce+"="+ae+")"}}for(var ue=0,ce="1"==i.a.SessionManager.UserID||"1"==i.a.SessionManager.RoleID,Ie=function(t){var o=e.Filter.CostCenterFilters[t];if(300!=o.CostCenterID&&-100!=o.CostCenterID&&502!=o.CostCenterID&&-502!=o.CostCenterID){if(44!=o.CostCenterID)if(113==o.CostCenterID&&Math.abs(C.DocID)>4e4&&Math.abs(C.DocID)<5e4){if(0!=o.SelectedNodes.length){ee.length>0&&(ee+=" AND "),ee+=(C.IsInventory?"INV":"ACC")+".StatusID IN (";for(var i=0;i<o.SelectedNodes.length;i++)i>0&&(ee+=","),ee+=o.SelectedNodes[i].Id;ee+=")"}}else!function(){var t,i,s="",a="GT"+ ++ue,r=!1,l=o.CostCenterID;50==o.CostCenterID&&(l=e.Filter.lstPreFetchReportCC[o.LookupTypeID]);for(var D=function(D){if("RptManager"!=e.Objects[D].ParentColumn&&(e.drrCCTbl=e.FieldsDialog.CostCenterTables.filter((function(t){return t.FeatureID==e.Objects[D].CategoryValue})),t=400!=e.Objects[D].CategoryValue||e.IsInventory?e.drrCCTbl[0].TableName.toString():"ACC_DocDetails",(e.Objects[D].IsForeignKey&&e.Objects[D].ColumnCostCenterID==l&&null==e.Objects[D].ParentCDGDO||!e.Objects[D].IsForeignKey&&e.Objects[D].CategoryValue==l&&e.Objects[D].Table==t)&&(r=!0,e.drrCCTbl=e.FieldsDialog.CostCenterTables.filter((function(e){return e.FeatureID==l})),e.drrCCTbl.length>0))){if(2==l&&-1==te)return"continue";if(i=e.drrCCTbl[0].PK.toString(),2==l&&2==te){if(te=-1,o.SelectedNodes.length>0||!o.DeleteButtonVisibility){if(ee.length>0&&(ee+=" AND "),ee+="(",0==s.length){for(var C=0;C<o.SelectedNodes.length;C++)null!=o.SelectedNodes[C].Parent&&o.SelectedNodes[C].Parent.IsSelected||(s.length>0&&(s+=","),s+=o.SelectedNodes[C].Id);0==s.length&&(s+=-12912)}v.length>0&&(ee+=v[0]+"."+i+"="+a+".GTID"),v.length>0&&_.length>0&&(ee+=" OR "),_.length>0&&(ee+=_[0]+"."+i+"="+a+".GTID"),ee+=")"}}else{if(0==te){if(_.Contains(e.Entities.values[D]))return"continue"}else if(1==te&&v.Contains(e.Entities.values[D]))return"continue";if(e.IsPreProcessQuery&&o.IsPrePocessFilter)return e.SelectTag+=","+e.Entities.values[D]+"."+i+" PPQ"+l,"continue";if(o.SelectedNodes.length>0||!o.DeleteButtonVisibility)if(ee.length>0&&(ee+=" AND "),n.IsGroupTree(o)&&(o.DeleteButtonVisibility||ce)){if(0==s.length){for(var u=0;u<o.SelectedNodes.length;u++)null!=o.SelectedNodes[u].Parent&&o.SelectedNodes[u].Parent.IsSelected||(s.length>0&&(s+=","),s+=o.SelectedNodes[u].Id);0==s.length&&(s+=-12912)}ee+=e.Entities.values[D]+"."+i+"="+a+".GTID"}else{ee+=e.Entities.values[D]+"."+i+" IN (";for(var c=0;c<o.SelectedNodes.length;c++)c>0&&(ee+=","),ee+=o.SelectedNodes[c].Id;0==o.SelectedNodes.length&&(ee+=-12912),ee+=")"}}}},C=0;C<e.Objects.length;C++)D(C);if(!r&&l>5e4&&(e.Entities.values.Contains("INV")||e.Entities.values.Contains("ACC"))&&(o.SelectedNodes.length>0||!o.DeleteButtonVisibility))if(ee.length>0&&(ee+=" AND "),i="TDCC.dcCCNID"+(l-5e4),n.IsGroupTree(o)&&(o.DeleteButtonVisibility||ce)){if(0==s.length){for(var u=0;u<o.SelectedNodes.length;u++)null!=o.SelectedNodes[u].Parent&&o.SelectedNodes[u].Parent.IsSelected||(s.length>0&&(s+=","),s+=o.SelectedNodes[u].Id);0==s.length&&(s+=-12912)}ee+=i+"="+a+".GTID"}else{ee+=i+" IN (";for(var c=0;c<o.SelectedNodes.length;c++)c>0&&(ee+=","),ee+=o.SelectedNodes[c].Id;0==o.SelectedNodes.length&&(ee+=-12912),ee+=")"}if(s.length>0&&(e.drrCCTbl=e.FieldsDialog.CostCenterTables.filter((function(e){return e.FeatureID==l})),e.FromTag+="\r\n ,(select T."+e.drrCCTbl[0].PK.toString()+" GTID from "+e.drrCCTbl[0].TableName.toString()+" T with(nolock),"+e.drrCCTbl[0].TableName.toString()+" "+a+" with(nolock) where T.lft BETWEEN "+a+".lft AND "+a+".rgt AND "+a+"."+e.drrCCTbl[0].PK.toString()+" IN ("+s.toString()+") group by T."+e.drrCCTbl[0].PK.toString()+") AS "+a),7==l&&o.SelectedNodes.length>0){var I=[];I.AddRange(e.BaseReportColumns),I.AddRange(e.ReportGroups),I.forEach((function(e){if("CreatedBy"==e.CDGDO.Column||"ModifiedBy"==e.CDGDO.Column){ee.length>0&&(ee+=" AND "),ee+=e.CDGDO.ActualColumn+" IN (";for(var t=0;t<o.SelectedNodes.length;t++)t>0&&(ee+=","),ee+="'"+o.SelectedNodes[t].Text[0]+"'";0==o.SelectedNodes.length&&(ee+="NO USER"),ee+=")"}}))}}();else if(o.SelectedNodes.length>0){var s=e.BaseReportColumns.find((function(e){return e.CDGDO.ColumnCCListViewTypeID==o.LookupTypeID&&(44==e.CDGDO.ColumnCostCenterID||44==e.CDGDO.LocalReference)}));if(s||(s=e.ReportGroups.find((function(e){return e.CDGDO.ColumnCCListViewTypeID==o.LookupTypeID&&(44==e.CDGDO.ColumnCostCenterID||44==e.CDGDO.LocalReference)}))),s){ee.length>0&&(ee+=" AND "),ee+=s.CDGDO.ActualTable+" IN (";for(var a=0;a<o.SelectedNodes.length;a++)a>0&&(ee+=","),ee+="'"+o.SelectedNodes[a].Id+"'";0==o.SelectedNodes.length&&(ee+="NO USER"),ee+=")"}}}else 300==o.CostCenterID&&e.IsPreProcessQuery&&o.IsPrePocessFilter&&e.Entities.ContainsKey("Documents")&&(e.SelectTag+=","+e.Entities.Documents+".CostCenterID PPQ"+o.CostCenterID)},he=0;he<e.Filter.CostCenterFilters.length;he++)Ie(he);(h.length>0&&(ee.length>0&&(ee+=" AND "),ee+="("+h+")"),e.BaseReportColumns.find((function(e){return 103==e.CDGDO.CategoryValue}))?(ee.length>0&&(ee+=" AND "),ee+=(e.Entities.ContainsKey("Quotation")?e.Entities.Quotation:"T0")+".CostCenterID=103"):e.BaseReportColumns.find((function(e){return 129==e.CDGDO.CategoryValue}))&&(ee.length>0&&(ee+=" AND "),ee+=(e.Entities.ContainsKey("Unit Reservation")?e.Entities["Unit Reservation"]:"T0")+".CostCenterID=129"),e.BaseReportColumns.find((function(e){return 251==e.CDGDO.CategoryValue}))?(ee.length>0&&(ee+=" AND "),ee+="T0.DType=251"):e.BaseReportColumns.find((function(e){return 252==e.CDGDO.CategoryValue}))?(ee.length>0&&(ee+=" AND "),ee+="T0.DType=252"):e.BaseReportColumns.find((function(e){return 253==e.CDGDO.CategoryValue}))?(ee.length>0&&(ee+=" AND "),ee+="T0.DType=253"):e.BaseReportColumns.find((function(e){return 254==e.CDGDO.CategoryValue}))?(ee.length>0&&(ee+=" AND "),ee+="T0.DType=254"):e.BaseReportColumns.find((function(e){return 255==e.CDGDO.CategoryValue}))&&(ee.length>0&&(ee+=" AND "),ee+="T0.DType=255"),e.ShowDebitCreditAmount&&C.ShowAccountingData)&&(C.IsInventory||(ee.length>0&&(ee+=" AND "),ee+=C.IsDebit?"ACC.DebitAccount>0":"ACC.CreditAccount>0"),ne=0==e.UnPostedDocsList.length?"(ACC.StatusID=369 or ACC.StatusID=429)":" ACC.StatusID IN (369,429,"+e.UnPostedDocsList+")",ee.length>0&&(ee+=" AND "),ee+=C.IsInventory?ne:e.PDCInclude?"(ACC.StatusID=370 OR (ACC.DocumentType<>14 AND ACC.DocumentType<>19 and "+ne+"))":"ACC.DocumentType<>14 AND ACC.DocumentType<>19 and "+ne);e.Entities.ContainsKey("Asset Management")&&(ee.length>0&&(ee+=" AND "),ee+=e.Entities["Asset Management"]+".IsGroup=0",(J=e.Filter.Fields.find((function(e){return 169==e.CDGDO.FieldValue})))&&(ee+=" AND "+e.Entities["Asset Management"]+".DeprStartDate<=convert(float,convert(datetime,'"+J.ToDatePicker.Date.ToString("dd MMM yyyy")+"'))"));for(var de="",Te="",ye=function(t){var o=e.Filter.Fields[t];if(e.SetActualColumn(o.CDGDO,C),"NULL"!=o.CDGDO.ActualColumn&&!(e.EmpAsonDate.length>0&&null!=e.EmpAsonDate.filter((function(e){return e==o.CDGDO})))){if(de="","DATE"==o.CDGDO.DataType){if(e.Filter.IsReportViewScreen&&!e.DontApplyDateFilter){var n;if(e.IsPreProcessQuery&&o.IsPrePocessFilter)n=o.CDGDO.ActualColumn.Contains("CreatedDate")||o.CDGDO.ActualColumn.Contains("ModifiedDate")?o.CDGDO.ActualColumn.Replace("CONVERT(DATETIME,","CONVERT(DATETIME,floor(")+")":o.CDGDO.Column.startsWith("dcAlpha")?"CONVERT(DATETIME,"+o.CDGDO.ActualTable+"."+o.CDGDO.Column+")":o.CDGDO.ActualColumn,e.SelectTag+=","+n+" PPQ"+o.ID.Replace("-","");var a="";if(o.CDGDO.Column.startsWith("dcAlpha")&&(67==o.CDGDO.DocumentType&&"DCALPHA1"==o.CDGDO.Column.toUpperCase()&&(a+="ISNULL("+o.CDGDO.ActualTable+"."+o.CDGDO.Column+",'')<>'' AND LEN("+o.CDGDO.ActualTable+"."+o.CDGDO.Column+")=11 AND "),a+="isDate("+o.CDGDO.ActualTable+"."+o.CDGDO.Column+")=1 AND ",a+="isNumeric("+o.CDGDO.ActualTable+"."+o.CDGDO.Column+")=0 AND "),o.CDGDO.ActualColumn.Contains("CreatedDate")||o.CDGDO.ActualColumn.Contains("ModifiedDate")?a+=o.CDGDO.ActualColumn.replace("CONVERT(DATETIME,","CONVERT(DATETIME,floor(")+")":o.CDGDO.Column.startsWith("dcAlpha")?67==o.CDGDO.DocumentType&&"DCALPHA1"==o.CDGDO.Column.toUpperCase()?a+="CONVERT(DATETIME,REPLACE(REPLACE("+o.CDGDO.ActualTable+"."+o.CDGDO.Column+",'/',' '),'-',' '))":a+="CONVERT(DATETIME,"+o.CDGDO.ActualTable+"."+o.CDGDO.Column+")":a+=o.CDGDO.ActualColumn,"Between"==o.Condition.SelectedValue||"NotBetween"==o.Condition.SelectedValue)a+=o.Condition.SelectedItem.Parent,a+="'"+o.FromDatePicker.Date.ToString("dd MMM yyyy")+"' AND ",a+="'"+o.ToDatePicker.Date.ToString("dd MMM yyyy")+"'";else if("FUTURE"==o.Condition.SelectedValue||"PAST"==o.Condition.SelectedValue){var r,l;if(o.ToDatePicker.Mode=1,o.FromDatePicker.Mode=1,0==(r=s.e.Int(o.FromValue.TextBox.Text))&&(r=1),"Days"==(l=""!=o.FromValue.ComboBox.SelectedValue?o.FromValue.ComboBox.SelectedValue:"Days"))"FUTURE"==o.Condition.SelectedValue?(o.FromDatePicker.Date=Date.Today(),o.ToDatePicker.Date=Date.Today().AddDays(r)):(o.FromDatePicker.Date=Date.Today().AddDays(-r),o.ToDatePicker.Date=Date.Today());else if("Weeks"==l);else if("Months"==l)if("FUTURE"==o.Condition.SelectedValue){var u=Date.Today().AddMonths(r);u=u.MonthsFirst(),o.FromDatePicker.Date=u,u=u.AddMonths(r).AddDays(-1),o.ToDatePicker.Date=u}else{var c=Date.Today().AddMonths(-r);c=c.MonthsFirst(),o.FromDatePicker.Date=c,c=c.AddMonths(r).AddDays(-1),o.ToDatePicker.Date=c}else if("Quarter"==l)if("FUTURE"==o.Condition.SelectedValue){var I=Date.Today().AddMonths(3*r);I=new Date(I.getFullYear(),I.getMonth()-(I.getMonth()-1)%3,1),o.FromDatePicker.Date=I,I=I.AddMonths(3*r).AddDays(-1),o.ToDatePicker.Date=I}else{var h=Date.Today().AddMonths(3*-r);h=new Date(h.getFullYear(),h.getMonth()-(h.getMonth()-1)%3,1),o.FromDatePicker.Date=h,h=h.AddMonths(3*r).AddDays(-1),o.ToDatePicker.Date=h}else if("Year"==l)if("FUTURE"==o.Condition.SelectedValue){var d=Date.Today().AddYears(r);d=new Date(d.getFullYear(),0,1),o.FromDatePicker.Date=d,d=d.AddYears(r-1),d=new Date(d.getFullYear(),11,31),o.ToDatePicker.Date=d}else{var T=Date.Today().AddYears(1-r);T=new Date(T.getFullYear(),0,1),o.FromDatePicker.Date=T,o.ToDatePicker.Date=Date.Today()}a+=" BETWEEN ",a+="'"+o.FromDatePicker.Date.ToString("dd MMM yyyy")+"' AND ",a+="'"+o.ToDatePicker.Date.ToString("dd MMM yyyy")+"'"}else"IsNull"==o.Condition.SelectedValue||"IsNotNull"==o.Condition.SelectedValue?a+=o.Condition.SelectedItem.Parent:(a+=o.Condition.SelectedItem.Parent,a+="'"+o.FromDatePicker.Date.ToString("dd MMM yyyy")+"'");var y="";if("Between"==o.Condition.SelectedValue||"FUTURE"==o.Condition.SelectedValue||"PAST"==o.Condition.SelectedValue){var m=new Date(o.ToDatePicker.Date.getFullYear(),i.a.SessionManager.AccountingFromMonth-1,1);m>o.ToDatePicker.Date&&(m=m.AddYears(-1));var A="";if(o.CDGDO.Column.startsWith("dcAlpha")&&(67==o.CDGDO.DocumentType&&"DCALPHA1"==o.CDGDO.Column.toUpperCase()&&(A+="ISNULL("+o.CDGDO.ActualTable+"."+o.CDGDO.Column+",'')<>'' AND LEN("+o.CDGDO.ActualTable+"."+o.CDGDO.Column+")=11 AND "),A="isDate("+o.CDGDO.ActualTable+"."+o.CDGDO.Column+")=1 AND ",A="isNumeric("+o.CDGDO.ActualTable+"."+o.CDGDO.Column+")=0 AND "),o.CDGDO.ActualColumn.Contains("CreatedDate")||o.CDGDO.ActualColumn.Contains("ModifiedDate")?A+=o.CDGDO.ActualColumn.replace("CONVERT(DATETIME,","CONVERT(DATETIME,floor(")+")":o.CDGDO.Column.startsWith("dcAlpha")?A+="CONVERT(DATETIME,"+o.CDGDO.ActualTable+"."+o.CDGDO.Column+")":A+=o.CDGDO.ActualColumn,e.RepeatShowPrevMn){for(var p=m.AddYears(-1),E=1;E<=e.RepeatPrevData;E++){if(y+=" OR ("+A+" BETWEEN ",e.RepeatPrevDataFull)y+="'"+p.ToString("dd MMM yyyy")+"' AND ",y+="'"+p.AddYears(1).AddDays(-1).ToString("dd MMM yyyy")+"'",p=p.AddYears(-1);else if(e.RepeatPrevDataOfCurrYr&&e.RepeatType==D.d.Monthly){var N=new Date(o.FromDatePicker.Date.getFullYear(),o.FromDatePicker.Date.getMonth(),1);y+="'"+(N=N.AddMonths(-E)).ToString("dd MMM yyyy")+"' AND ",y+="'"+N.AddMonths(1).AddDays(-1).ToString("dd MMM yyyy")+"'"}else y+="'"+o.FromDatePicker.Date.AddYears(-E).ToString("dd MMM yyyy")+"' AND ",y+="'"+o.ToDatePicker.Date.AddYears(-E).ToString("dd MMM yyyy")+"'";y+=")"}e.RepeatEmptyColumns=1}e.BaseReportColumns.find((function(e){return!s.e.IsEmpty(e.Formula.Text)&&e.Formula.Text.Contains("PRV_YEARSTART")}))||e.ReportGroups.find((function(e){return!s.e.IsEmpty(e.Formula.Text)&&e.Formula.Text.Contains("PRV_YEARSTART")}))?(e.PrevDateColumsUsed=!0,y+=" OR ("+A+" BETWEEN ",y+="'"+m.AddYears(-1).ToString("dd MMM yyyy")+"' AND ",y+="'"+m.AddDays(-1).ToString("dd MMM yyyy")+"'",y+=")"):(e.BaseReportColumns.find((function(e){return!s.e.IsEmpty(e.Formula.Text)&&e.Formula.Text.Contains("PRV_YEARFROMDATE")}))||e.ReportGroups.find((function(e){return!s.e.IsEmpty(e.Formula.Text)&&e.Formula.Text.Contains("PRV_YEARFROMDATE")}))||e.BaseReportColumns.find((function(e){return!s.e.IsEmpty(e.Formula.Text)&&e.Formula.Text.Contains("PRV_YEARTODATE")}))||e.ReportGroups.find((function(e){return!s.e.IsEmpty(e.Formula.Text)&&e.Formula.Text.Contains("PRV_YEARTODATE")})))&&(e.PrevDateColumsUsed=!0,y+=" OR ("+A+" BETWEEN ",y+="'"+o.FromDatePicker.Date.AddYears(-1).ToString("dd MMM yyyy")+"' AND ",y+="'"+o.ToDatePicker.Date.AddYears(-1).ToString("dd MMM yyyy")+"'",y+=")")}y.length>0?(de+="(("+a+")",de+=y.toString(),de+=")"):de+=a}}else if("Between"==o.Condition.SelectedValue||"NotBetween"==o.Condition.SelectedValue)if(o.FromValue.Visible){if(s.e.IsEmpty(o.FromValue.TextBox.Text)&&s.e.IsEmpty(o.ToValue.Text))return"continue";de+=o.CDGDO.ActualColumn,de+=o.Condition.SelectedItem.Parent,de+="'"+o.FromValue.TextBox.Text+"' AND ",de+="'"+o.ToValue.Text+"'"}else{if(s.e.IsEmpty(o.FromList.Text)&&s.e.IsEmpty(o.ToList.Text))return"continue";de+=o.CDGDO.ActualColumn,de+=o.Condition.SelectedItem.Parent,de+="'"+o.FromList.Text+"' AND ",de+="'"+o.ToList.Text+"'"}else if("Contains"==o.Condition.SelectedValue||"NotContain"==o.Condition.SelectedValue){if(s.e.IsEmpty(o.FromValue.TextBox.Text))return"continue";de+=o.CDGDO.ActualColumn,de+=o.Condition.SelectedItem.Parent,de+="'%"+o.FromValue.TextBox.Text+"%'"}else if("IsNull"==o.Condition.SelectedValue||"IsNotNull"==o.Condition.SelectedValue)de+=o.CDGDO.ActualColumn,de+=o.Condition.SelectedItem.Parent;else if(o.FromValue.Visible){if(s.e.IsEmpty(o.FromValue.TextBox.Text))return"continue";de+=o.CDGDO.ActualColumn,de+=o.Condition.SelectedItem.Parent,de+="'"+o.FromValue.TextBox.Text+"'"}else if(o.FromList.CCID>0){if(0==o.FromList.SelectedValue&&3!=o.FromList.CCID)return"continue";e.drrCCTbl=e.FieldsDialog.CostCenterTables.filter((function(e){return e.FeatureID==o.FromList.CCID})),o.CDGDO.Column.startsWith("CCNID")&&null!=o.CDGDO.ChildCDGDO?de+=e.Entities[o.CDGDO.ChildCDGDO.CategoryText]+"."+e.drrCCTbl[0].PK.toString():de+=e.Entities[o.CDGDO.CategoryText]+"."+e.drrCCTbl[0].PK.toString(),de+=o.Condition.SelectedItem.Parent,de+=o.FromList.SelectedValue}de.length>0&&(o.QuickSearchField.IsChecked?(Te.length>0&&(Te+=" OR "),Te+=de):(ee.length>0&&(ee+=" AND "),ee+=de))}},me=0;me<e.Filter.Fields.length;me++)ye(me);if(Te.length>0&&(ee.length>0&&(ee+=" AND "),ee+="("+Te+")"),!e.IsInventory&&e.Entities.values.Contains("ACC")&&e.Filter.IsReportViewScreen&&!e.Report.Preferences.ContainsKey("extrafieldsaccountposting")&&(ee.length>0&&(ee+=" AND "),ee+="ACC.LinkedAccDocDetailsID is null"),e.IsNewFromClause&&C.IsInventory&&e.Filter.IsReportViewScreen&&e.Report.Preferences.ContainsKey("ExQtyCol")&&(q=e.BaseReportColumns.find((function(t){return t.ID==e.Report.Preferences.ExQtyCol})))&&(ee.length>0&&(ee+=" AND "),!s.e.IsEmpty(q.CDGDO.ActualColumn)&&q.CDGDO.ActualColumn.Contains("ExQ")?ee+="1"==e.Report.Preferences.ExQtyType?"(INV.LinkStatusID=445 or "+q.CDGDO.ActualTable+"=INV.Quantity)":"INV.LinkStatusID!=445 and ("+q.CDGDO.ActualTable+" is null or "+q.CDGDO.ActualTable+"<INV.Quantity)":ee+="1"==e.Report.Preferences.ExQtyType?"(INV.LinkStatusID=445 or ("+q.CDGDO.ActualColumn+")=INV.Quantity)":"INV.LinkStatusID!=445 and ("+q.CDGDO.ActualColumn+")<INV.Quantity"),null!=e.TQDocPrefix&&(e.ReportViewType==D.e.TransactionQuery||e.ReportViewType==D.e.LinkingQuery&&"LINKED_VOUCHERS"==t)){if(null!=e.TQDocPrefix.SelectedValue&&"ALL"!=e.TQDocPrefix.SelectedValue&&(ee.length>0&&(ee+=" AND "),ee+=e.IsInventory?"INV.DocPrefix='"+e.TQDocPrefix.SelectedValue+"'":"ACC.DocPrefix='"+e.TQDocPrefix.SelectedValue+"'"),!s.e.IsEmpty(e.TQDocNo_From.Text)){var Ae=s.e.Int(e.TQDocNo_From.Text);s.e.IsNum(e.TQDocNo_From.Text)&&(ee.length>0&&(ee+=" AND "),ee+=e.IsInventory?"INV.DocNumber>="+Ae:"ACC.DocNumber>="+Ae)}if(!s.e.IsEmpty(e.TQDocNo_To.Text)){var pe=s.e.Int(e.TQDocNo_To.Text);s.e.IsNum(e.TQDocNo_To.Text)&&(ee.length>0&&(ee+=" AND "),ee+=e.IsInventory?"INV.DocNumber<="+pe:"ACC.DocNumber<="+pe)}}if(e.ReportViewType==D.e.LinkingQuery&&"LINKED_SUB_VOUCHERS"==t&&(ee.length>0&&(ee+=" AND "),ee+="INV.VoucherNo='"+e.LinkSubVoucherNo+"'"),e.IsAuthLevelReport&&(ee.length>0&&(ee+=" AND "),Q=e.BaseReportColumns.find((function(e){return 95==e.CDGDO.CategoryValue||103==e.CDGDO.CategoryValue||104==e.CDGDO.CategoryValue||129==e.CDGDO.CategoryValue})),ee+=Q&&95==Q.CDGDO.CategoryValue?e.Entities.Contract+".WorkFlowID>0":Q&&103==Q.CDGDO.CategoryValue?e.Entities.Quotation+".WorkFlowID>0":Q&&104==Q.CDGDO.CategoryValue?e.Entities["Purchase Contract"]+".WorkFlowID>0":Q&&129==Q.CDGDO.CategoryValue?e.Entities["Unit Reservation"]+".WorkFlowID>0":e.IsInventory?"INV.WorkFlowID>0":"ACC.WorkFlowID>0 AND ACC.InvDocDetailsID IS NULL"),e.ShowUnAppDocsToApprove)if(e.ShowUnAppDocsToApprove_UseFuncCall)e.IsAuthLevelReport||(ee.length>0&&(ee+=" AND "),ee+=e.IsInventory?"INV.WorkFlowID>0":"ACC.WorkFlowID>0 AND ACC.InvDocDetailsID IS NULL"),ee.length>0&&(ee+=" AND "),ee+=e.IsInventory?B:B.Replace("INV.","ACC.");else{ee.length>0&&(ee+=" AND ");var Ee=e.BaseReportColumns.find((function(e){return 95==e.CDGDO.CategoryValue||103==e.CDGDO.CategoryValue||104==e.CDGDO.CategoryValue||129==e.CDGDO.CategoryValue}));ee+=Ee&&95==Ee.CDGDO.CategoryValue?" WF.WID="+e.Entities.Contract+".WorkflowID and WF.LevelID>"+e.Entities.Contract+".WorkFlowLevel and("+e.Entities.Contract+".StatusID = 440 or "+e.Entities.Contract+".StatusID = 466 or "+e.Entities.Contract+".StatusID = 470) AND(WF.Type = 1 or("+e.Entities.Contract+".WorkFlowLevel + 1=WF.LevelID and "+e.Entities.Contract+".StatusID != 470)) ":Ee&&103==Ee.CDGDO.CategoryValue?" WF.WID="+e.Entities.Quotation+".WorkflowID and WF.LevelID>"+e.Entities.Quotation+".WorkFlowLevel  and("+e.Entities.Quotation+".StatusID = 440 or "+e.Entities.Quotation+".StatusID = 466 or "+e.Entities.Quotation+".StatusID = 470) AND(WF.Type = 1 or("+e.Entities.Quotation+".WorkFlowLevel + 1=WF.LevelID and "+e.Entities.Quotation+".StatusID != 470)) ":Ee&&104==Ee.CDGDO.CategoryValue?" WF.WID="+e.Entities["Purchase Contract"]+".WorkflowID and WF.LevelID>"+e.Entities["Purchase Contract"]+".WorkFlowLevel and("+e.Entities["Purchase Contract"]+".StatusID = 440 or "+e.Entities["Purchase Contract"]+".StatusID = 466 or "+e.Entities["Purchase Contract"]+".StatusID = 470) AND(WF.Type = 1 or("+e.Entities["Purchase Contract"]+".WorkFlowLevel + 1=WF.LevelID and "+e.Entities["Purchase Contract"]+".StatusID != 470)) ":Ee&&129==Ee.CDGDO.CategoryValue?" WF.WID="+e.Entities["Unit Reservation"]+".WorkflowID and WF.LevelID>"+e.Entities["Unit Reservation"]+".WorkFlowLevel and("+e.Entities["Unit Reservation"]+".StatusID = 440 or "+e.Entities["Unit Reservation"]+".StatusID = 466 or "+e.Entities["Unit Reservation"]+".StatusID = 470) AND(WF.Type = 1 or("+e.Entities["Unit Reservation"]+".WorkFlowLevel + 1=WF.LevelID and "+e.Entities["Unit Reservation"]+".StatusID != 470)) ":e.IsInventory?B:B.Replace("INV.","ACC.")}else e.ShowMyUnAppDocsToBeApproved&&(ee.length>0&&(ee+=" AND "),ee+=e.IsInventory?B:B.Replace("INV.","ACC."));if(e.IsInventory&&null!=L&&L.SelectedNodes.length>0){for(var Ne="",Se=0;Se<e.Objects.length;Se++)if(e.Entities.keys[Se].endsWith("_CCMAP")&&0==s.e.stringCompare(e.Objects[Se].Table,"COM_DOCCCDATA",!0)){Ne=e.Entities.keys[Se];break}s.e.IsEmpty(Ne)||(ee.length>0&&(ee+=" AND "),ee+=e.Entities[Ne]+"."+M+" IN (select NodeID from #TblJobDim)")}e.DocumentFilters.ContainsKey("CRM_Masters_DocumentsTab")&&e.Entities.ContainsKey("Documents_CCMAP")&&(ee.length>0&&(ee+=" AND "),ee+=e.DocumentFilters.CRM_Masters_DocumentsTab.Replace("DCC",e.Entities.Documents_CCMAP)),(z=e.BaseReportColumns.find((function(e){return 27295==e.CDGDO.FieldValue})))&&(ee.length>0&&(ee+=" AND "),ee+="  ("+e.Entities[z.CDGDO.CategoryText]+".InviteRefActID>0  OR "+e.Entities[z.CDGDO.CategoryText]+".ActivityID IN (select InviteRefActID from CRM_Activities with(nolock)  where InviteRefActID>0))"),s.e.IsEmpty(i.a.SessionManager.sWHEmpFilteredEmpSeqNos)||(z=e.BaseReportColumns.find((function(e){return 50051==e.CDGDO.CategoryValue||e.CDGDO.IsForeignKey&&50051==e.CDGDO.ParentCostCenterID})))&&(i.a.SessionManager.LocationID>0&&i.a.SessionManager.Preferences.ContainsKey("LocationWiseDimension")&&i.a.SessionManager.Preferences.LocationWiseDimension.split(",").Contains("50051")&&(ee.length>0&&(ee+=" AND "),ee+=z.CDGDO.ActualTable+".NodeID in (Select NodeID From Com_CCCCData with(nolock) where CostCenterID=50051 and CCNID2="+i.a.SessionManager.LocationID+")"),ee.length>0&&(ee+=" AND "),ee+=e.PayrollWidgetEmpID>0?z.CDGDO.ActualTable+".NodeID in ("+e.PayrollWidgetEmpID+")":z.CDGDO.ActualTable+".NodeID in ("+i.a.SessionManager.sWHEmpFilteredEmpSeqNos+")"),e.WhereTag=ee.toString(),e.sbFinalQuery.length>0&&(e.sbFinalQuery+="\r\n UNION ALL \r\n"),0==C.DocID&&e.IsBudgetFound?e.SelectTag=e.SelectTag+","+e.Entities.Budget+".BudgetDefID,"+e.Entities.Budget+".BudgetAllocID":0==C.DocID&&(e.earningfields.length>0||e.Vacationfields.length>0)?e.SelectTag=e.SelectTag+",T0.NodeID  XEmpIDX":e.earningfields.length>0&&null!=(z=e.BaseReportColumns.find((function(e){return 50051==e.CDGDO.CategoryValue||e.CDGDO.IsForeignKey&&50051==e.CDGDO.ParentCostCenterID&&""!=e.CDGDO.ActualTable.toString()})))&&(e.SelectTag=e.SelectTag+","+z.CDGDO.ActualTable+".NodeID  XEmpIDX"),e.sbFinalQuery+="SELECT "+e.SelectTag+"\r\n FROM "+e.FromTag,null!=e.WhereTag&&""!=e.WhereTag&&(e.sbFinalQuery+="\r\n WHERE "+e.WhereTag)},K=0;K<d.length;K++){var Q,X,j,Y,J,q;U(K)}if(this.IsSummaryReportType&&(this.sbFinalQuery="select "+this.SummarySELECT+" from ("+this.sbFinalQuery+") AS T group by "+this.SummaryGROUPBY),this.IsPreProcessQuery&&null!=this.Report&&(this.sbFinalQuery="Select * into PACT2C"+i.a.SessionManager.CompanyIndex+"_TEMP.dbo.RPT_TBL"+this.Report.ReportID+" from ("+this.sbFinalQuery+") as T "),"LINKED_VOUCHERS"==t)this.OrderByTag="DocAbbr,DocPrefix,DocNumber";else{for(var z=0;z<this.ReportGroups.length;z++){var Z=this.ReportGroups[z];s.e.IsEmpty(Z.Formula.Text)&&(this.OrderByTag.length>0&&(this.OrderByTag+=","),Z.Sort.SelectedValue.startsWith("NUM")||Z.Sort.SelectedValue.startsWith("TREE")?this.OrderByTag+="["+Z.ID+"SORT] "+Z.Sort.SelectedValue.substr(4):this.OrderByTag+="VoucherNo"==Z.CDGDO.Column&&0==Z.CDGDO.IsForeignKey?"["+Z.ID+"Abr] "+Z.Sort.SelectedValue+",["+Z.ID+"prf] "+Z.Sort.SelectedValue+",["+Z.ID+"dno] "+Z.Sort.SelectedValue:"["+Z.ID+"] "+Z.Sort.SelectedValue)}for(var $=0;$<this.BaseReportColumns.length;$++){var ee=this.BaseReportColumns[$];ee.IsGroup||s.e.IsEmpty(ee.Sort.SelectedValue)||!s.e.IsEmpty(ee.Formula.Text)||(this.OrderByTag.length>0&&(this.OrderByTag+=","),ee.Sort.SelectedValue.startsWith("NUM")||ee.Sort.SelectedValue.startsWith("TREE")?this.OrderByTag+="["+ee.ID+"SORT] "+ee.Sort.SelectedValue.substr(4):this.OrderByTag+="VoucherNo"==ee.CDGDO.Column&&0==ee.CDGDO.IsForeignKey&&""!=ee.Sort.SelectedValue?"["+ee.ID+"Abr] "+ee.Sort.SelectedValue+",["+ee.ID+"prf] "+ee.Sort.SelectedValue+",["+ee.ID+"dno] "+ee.Sort.SelectedValue:"["+ee.ID+"] "+ee.Sort.SelectedValue)}null!=this.OrderByTag&&""!=this.OrderByTag&&(this.sbFinalQuery+=" ORDER BY "+this.OrderByTag)}if(this.IsAuthLevelReport)this.sbFinalQuery+="\r\n SELECT WorkFlowID,MAX(LevelID) Levels FROM COM_WorkFlow with(nolock) GROUP BY WorkFlowID";else if(null!=this.LevelColumn){var te,oe,ne="";this.Entities.Clear(),null!=this.LevelColumn.CDGDO.ChildCDGDO?(te=this.LevelColumn.CDGDO.ChildCDGDO.ParentCostCenterColSysName,oe="LT."+this.LevelColumn.CDGDO.ChildCDGDO.Column+" AS "+this.LevelColumn.ID,this.Entities.push(this.LevelColumn.CDGDO.ChildCDGDO.ParentCostCenterSysName,"LT"),oe+=this.GetLink_IDColumn("LT",this.LevelColumn)):(te=this.LevelColumn.CDGDO.ParentCostCenterColSysName,oe="LT."+this.LevelColumn.CDGDO.Column+" AS "+this.LevelColumn.ID,this.Entities.push(this.LevelColumn.CDGDO.ParentCostCenterSysName,"LT"),oe+=this.GetLink_IDColumn("LT",this.LevelColumn));for(var ie=[25900,26428],se=0;se<this.BaseReportColumns.length;se++){var ae=this.BaseReportColumns[se];ae==this.LevelColumn||null==ae.CDGDO.ActualColumn||s.e.IsEmpty(ae.CDGDO.Column)||!(ae.CDGDO.IsForeignKey&&ae.CDGDO.ColumnCostCenterID>0)&&ae.CDGDO.IsForeignKey||ae.CDGDO.ActualColumn.lastIndexOf(".")>0&&!ie.Contains(ae.CDGDO.FieldValue)&&(ae.CDGDO.IsForeignKey?ae.CDGDO.ColumnCostCenterID==this.LevelTreeCostCenterID&&(this.Entities.ContainsKey(ae.CDGDO.ParentCostCenterSysName),this.Entities.ContainsKey(ae.CDGDO.ParentCostCenterSysName)&&("DATE"==ae.CDGDO.DataType?oe+=",CONVERT(DATETIME,"+this.Entities[ae.CDGDO.ParentCostCenterSysName]+"."+ae.CDGDO.Column+") AS "+ae.ID:(oe+=","+this.Entities[ae.CDGDO.ParentCostCenterSysName]+"."+ae.CDGDO.Column+" AS "+ae.ID,oe+=this.GetLink_IDColumn(this.Entities[ae.CDGDO.ParentCostCenterSysName],ae)))):ae.CDGDO.CategoryValue==this.LevelTreeCostCenterID&&this.Entities.ContainsKey(ae.CDGDO.Table)&&("DATE"==ae.CDGDO.DataType?oe+=",CONVERT(DATETIME,"+this.Entities[ae.CDGDO.Table]+"."+ae.CDGDO.Column+") AS "+ae.ID:(oe+=","+this.Entities[ae.CDGDO.Table]+"."+ae.CDGDO.Column+" AS "+ae.ID,oe+=this.GetLink_IDColumn(this.Entities[ae.CDGDO.Table],ae))))}null!=this.Report&&null!=this.Filter&&(this.Report.LevelNo=s.e.Int(this.Filter.ShowLevel.Text)),this.sbFinalQuery+=null!=this.Report&&-2==this.Report.LevelNo?"\r\n SELECT "+oe+",LT."+te+" AS TreeNodeID,0 Depth,0 ParentID,LT.lft,LT.rgt,LT.IsGroup FROM ":"\r\n SELECT "+oe+",LT."+te+" AS TreeNodeID,LT.Depth,LT.ParentID,LT.lft,LT.rgt,LT.IsGroup FROM ",this.sbFinalQuery+=null!=this.LevelColumn.CDGDO.ChildCDGDO?this.LevelColumn.CDGDO.ChildCDGDO.ParentCostCenterSysName:this.LevelColumn.CDGDO.ParentCostCenterSysName,this.sbFinalQuery+=" LT WITH(NOLOCK)"+ne,this.sbFinalQuery+=" WHERE ",this.sbFinalQuery+="AccountID"!=this.LevelColumn.CDGDO.ParentCostCenterColSysName&&"ProductID"!=this.LevelColumn.CDGDO.ParentCostCenterColSysName||null!=this.LevelColumn.CDGDO.ChildCDGDO?"LT."+te+">0":"LT."+te+">1",null!=this.Report&&-2==this.Report.LevelNo&&(this.sbFinalQuery+=" and LT.IsGroup=0");for(var re=0;re<this.Filter.CostCenterFilters.length;re++){var le=this.Filter.CostCenterFilters[re];if(le.CostCenterID==this.LevelTreeCostCenterID){if(le.SelectedNodes.length>0||!le.DeleteButtonVisibility){this.sbFinalQuery+=" AND "+te+" IN (";for(var De=0;De<le.SelectedNodes.length;De++)De>0&&(this.sbFinalQuery+=","),this.sbFinalQuery+=le.SelectedNodes[De].Id;0==le.SelectedNodes.length&&(this.sbFinalQuery+=-12912),this.sbFinalQuery+=")"}break}}this.sbFinalQuery+=" ORDER BY lft"}else this.IsBudgetNewFound&&(this.sbFinalQuery+="\r\n SELECT D.CostCenterID,CONVERT(DATETIME,FinYearStartDate) StartDate FROM COM_BudgetDef B with(nolock),COM_BudgetDefDims D with(nolock) WHERE B.BudgetDefID="+l+" AND B.BudgetDefID=D.BudgetDefID\n                select * from COM_BudgetAlloc with(nolock) WHERE BudgetDefID="+l);if(this.earningfields.length>0){var Ce=this.Filter.Fields.find((function(e){return null!=e.CDGDO.DataType&&"DATE"==e.CDGDO.DataType.toUpperCase()&&50051==e.CDGDO.CategoryValue&&-601==e.CDGDO.FieldValue}));this.sbFinalQuery+=null!=Ce?" SELECT Convert(DateTime,P.EffectFrom) as CEffectFrom,Convert(DateTime,P.ApplyFrom) as CApplyFrom, P.* FROM PAY_EMPPAY P with(nolock), COM_CC50051 C with(nolock) WHERE C.NodeID>2 AND C.NodeID=P.EmployeeID AND P.SeqNo IN (SELECT TOP 1 SeqNo FROM PAY_EMPPAY with(nolock) WHERE EmployeeID=C.NodeID AND Convert(DateTime,EffectFrom) <='"+Ce.FromDatePicker.Date.ToString("dd MMM yyyy")+"' ORDER BY EffectFrom DESC)":" SELECT Convert(DateTime,P.EffectFrom) as CEffectFrom,Convert(DateTime,P.ApplyFrom) as CApplyFrom, P.* FROM PAY_EMPPAY P with(nolock), COM_CC50051 C with(nolock) WHERE C.NodeID>2 AND C.NodeID=P.EmployeeID AND P.SeqNo IN (SELECT TOP 1 SeqNo FROM PAY_EMPPAY with(nolock) WHERE EmployeeID=C.NodeID ORDER BY EffectFrom DESC)"}if(null!=L&&L.SelectedNodes.length>0&&(this.sbFinalQuery=_+this.sbFinalQuery,this.sbFinalQuery+=" \r\n DROP TABLE #TblJobDim"),this.ShowUnAppDocsToApprove&&!this.ShowUnAppDocsToApprove_UseFuncCall&&(i.a.SessionManager.IsEmpUser&&i.a.SessionManager.IsRptManagerUser?(this.sbFinalQuery="create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)\n                EXEC spRPT_GetReportData @Type=8,@Param1="+i.a.SessionManager.UserID+",@strXML=null,@RoleID=-1\n"+this.sbFinalQuery,this.sbFinalQuery+=" \r\n DROP TABLE #TblUsrWF"):(this.sbFinalQuery="create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)\n                EXEC spRPT_GetReportData @Type=8,@Param1="+i.a.SessionManager.UserID+",@strXML=null,@RoleID="+i.a.SessionManager.RoleID+"\n"+this.sbFinalQuery,this.sbFinalQuery+=" \r\n DROP TABLE #TblUsrWF")),this.Filter.IsReportViewScreen&&this.Report.Preferences.ContainsKey("NoDataGroups")&&this.ReportGroups.length>0&&"1"==this.ReportGroups[0].Visibility.SelectedValue){var ue,ce,Ie,he=this.ReportGroups[0];if(this.Entities.Clear(),ue=(Ie=null!=he.CDGDO.ChildCDGDO?he.CDGDO.ChildCDGDO:he.CDGDO).ParentCostCenterColSysName,ce="NG."+Ie.Column+" AS "+he.ID,this.Entities.push(Ie.ParentCostCenterSysName,"NG"),he.CDGDO.IsForeignKey&&he.CDGDO.ColumnCostCenterID>0&&he.CDGDO.ActualColumn.lastIndexOf(".")>0&&(this.Entities.ContainsKey(Ie.ParentCostCenterSysName),this.Entities.ContainsKey(Ie.ParentCostCenterSysName)))if(ce=this.Entities[Ie.ParentCostCenterSysName]+"."+Ie.Column+" AS NoDataGroup",he.IsReportMappingFilter){var de=he.CDGDO.IsForeignKey?he.CDGDO.ParentCostCenterID:he.CDGDO.CategoryValue;400!=de&&(de<4e4||de>5e4)&&("NULL"!=he.CDGDO.ActualColumn?(this.drrCCTbl=this.FieldsDialog.CostCenterTables.filter((function(e){return e.FeatureID==de})),ce+=","+this.Entities[he.CDGDO.ParentCostCenterSysName]+"."+this.drrCCTbl[0].PK.toString()+" AS ["+he.ID+"_ID]"):ce+=",NULL AS ["+he.ID+"_ID]")}else if("3"==he.LinkType.SelectedValue||"4"==he.LinkType.SelectedValue){var Te=he.CDGDO.IsForeignKey?he.CDGDO.ParentCostCenterID:he.CDGDO.CategoryValue;400!=Te&&(Te<4e4||Te>5e4)&&("NULL"!=he.CDGDO.ActualColumn?(this.drrCCTbl=this.FieldsDialog.CostCenterTables.filter((function(e){return e.FeatureID==Te})),ce+=","+this.Entities[he.CDGDO.ParentCostCenterSysName]+"."+this.drrCCTbl[0].PK.toString()+" AS ["+he.ID+"_ID]"):ce+=",NULL AS ["+he.ID+"_ID]")}if(ce.length>0){this.IsNoDataGroups=!0,this.sbFinalQuery+="\r\n SELECT "+ce+", IsGroup FROM ",this.sbFinalQuery+=Ie.ParentCostCenterSysName,this.sbFinalQuery+=" NG WITH(NOLOCK)",this.sbFinalQuery+=" WHERE IsGroup=0";for(var ye=0;ye<this.Filter.CostCenterFilters.length;ye++){var me=this.Filter.CostCenterFilters[ye];if(me.CostCenterID==he.CDGDO.ColumnCostCenterID){if(me.SelectedNodes.length>0||!me.DeleteButtonVisibility){this.sbFinalQuery+=" AND NG."+ue+" IN (";for(var Ae=0;Ae<me.SelectedNodes.length;Ae++)Ae>0&&(this.sbFinalQuery+=","),this.sbFinalQuery+=me.SelectedNodes[Ae].Id;0==me.SelectedNodes.length&&(this.sbFinalQuery+=-12912),this.sbFinalQuery+=")"}break}}this.sbFinalQuery+=" ORDER BY NoDataGroup"}}this.FinalQuery=this.sbFinalQuery.toString()}catch(pe){Logger.ErrorLog("SetQueryXMLTags :: "+pe.stack)}}else this.SetQueryXMLTagsForPreProcessQuery();else try{-1==this.StaticReportType?this.SetQueryXMLTagsForQueryReports():this.SetQueryXMLTagsForStaticReports()}catch(pe){Logger.ErrorLog("SetQueryXMLTagsForStaticReports/SetQueryXMLTagsForQueryReports :: "+pe.stack)}else this.FinalQuery=this.Report.Reportds.Tables[0][0].Query.toString()}},{key:"SetQueryXMLTagsForStaticReports",value:function(){var e,t,o=this,n=0,l="",D=!1,C=!1,u=!1,h="",d="",T="";this.DbGroupSelectTag="";var y=new a.a;if(9==this.StaticReportType||10==this.StaticReportType||198==this.StaticReportType?l="B":(l="DCC",this.Entities.push("Documents",150==this.StaticReportType?"ACC":"D")),1==this.StaticReportType||86==this.StaticReportType||2==this.StaticReportType||3==this.StaticReportType||4==this.StaticReportType||200==this.StaticReportType?(this.Entities.push("Account","A1"),this.IsInventory=!1,1==this.StaticReportType&&(y.push("Documents","D"),this.ReportParams.push("ProductSelect",""),this.ReportParams.push("ProductFrom",""))):this.StaticReportType>=5&&this.StaticReportType<=12||198==this.StaticReportType||185==this.StaticReportType?this.Entities.push("Account","A"):118==this.StaticReportType?this.Entities.push("Asset Management","A"):73==this.StaticReportType||this.StaticReportType>=209&&this.StaticReportType<=215?(this.Entities.push("Contract","C"),this.Entities.push("Contract.Property","P"),this.Entities.push("Contract.Unit","U"),this.Entities.push("Contract.Tenant","T"),this.Entities.push("Contract.PropertyID","P"),this.Entities.push("Contract.UnitID","U"),this.Entities.push("Contract.TenantID","T"),this.Entities.push("ContractREN_ContractParticulars","CP"),this.Entities.push("Units","U")):87==this.StaticReportType?(this.Entities.push("Contract.Unit","U"),this.Entities.push("Contract.UnitID","U"),this.Entities.push("Units","U")):196==this.StaticReportType||(13==this.StaticReportType||14==this.StaticReportType||15==this.StaticReportType||16==this.StaticReportType||81==this.StaticReportType||82==this.StaticReportType||83==this.StaticReportType||84==this.StaticReportType||112==this.StaticReportType||114==this.StaticReportType||115==this.StaticReportType||158==this.StaticReportType||165==this.StaticReportType||195==this.StaticReportType||203==this.StaticReportType||204==this.StaticReportType?(this.Entities.push("Product","P"),82==this.StaticReportType?this.Entities.Add("Batch","B"):203!=this.StaticReportType&&204!=this.StaticReportType||this.Entities.push("Documents.Product Name","P")):this.IsInventory=!0),this.DocumentFilters.ContainsKey("GLParticularSelect")&&(this.DocumentFilters.Remove("GLParticularSelect"),this.DocumentFilters.Remove("GLParticularFrom")),1==this.StaticReportType||2==this.StaticReportType||3==this.StaticReportType||13==this.StaticReportType||81==this.StaticReportType||82==this.StaticReportType||86==this.StaticReportType||94==this.StaticReportType||95==this.StaticReportType||111==this.StaticReportType||150==this.StaticReportType||156==this.StaticReportType||158==this.StaticReportType||185==this.StaticReportType||195==this.StaticReportType||200==this.StaticReportType||203==this.StaticReportType||204==this.StaticReportType||207==this.StaticReportType||-2==this.StaticReportType){var m=new Array;m.AddRange(this.BaseReportColumns),m.AddRange(this.ReportGroups);for(var A=0;A<m.length;A++){var p=m[A];if(e=p.CDGDO,33==p.ID.length)if(400==e.CategoryValue||401==e.CategoryValue||402==e.CategoryValue||Math.abs(e.CategoryValue)>4e4&&Math.abs(e.CategoryValue)<5e4){if(1==this.StaticReportType&&[23150,23822,23823,23824,11491,11676].Contains(e.FieldValue)){if(e.ActualColumn=null,3==e.ColumnCostCenterID)y.ContainsKey(e.CategoryText)||y.push(e.CategoryText,"P"),"INV_Product"==e.Table?e.ActualColumn=y[e.CategoryText]+"."+e.Column:"INV_ProductExtended"==e.Table?(t=e.CategoryText+"INV_ProductExtended",y.ContainsKey(t)||(y.push(t,"PRODEXT"),this.ReportParams.ProductFrom+=" LEFT JOIN INV_ProductExtended AS "+y[t]+" with(nolock) ON P.ProductID=PRODEXT.ProductID"),e.ActualColumn=y[t]+"."+e.Column):null!=e.ChildCDGDO&&e.ChildCDGDO.IsForeignKey&&(y.ContainsKey(e.ChildCDGDO.CategoryText)||(t="T"+ ++n,y.push(e.ChildCDGDO.CategoryText,t),0==s.e.stringCompare(e.ChildCDGDO.ParentTable,"COM_CCCCData",!0)?(y.ContainsKey("CC")||(y.push("CC","CC"),this.ReportParams.ProductFrom+=" LEFT JOIN COM_CCCCData CC with(nolock) ON CC.NodeID=P.ProductID AND CC.CostCenterID="+e.ChildCDGDO.CategoryValue),this.ReportParams.ProductFrom+=" LEFT JOIN "+e.ChildCDGDO.ParentCostCenterSysName+" AS "+t+" with(nolock) ON "+t+"."+e.ChildCDGDO.ParentCostCenterColSysName+"=CC."+e.ChildCDGDO.ParentColumn):this.ReportParams.ProductFrom+=" LEFT JOIN "+e.ParentCostCenterSysName+" AS "+t+" with(nolock) ON "+t+"."+e.ChildCDGDO.ParentCostCenterColSysName+"="+y.Product+"."+e.ChildCDGDO.ParentColumn,e.ActualColumn=t+"."+e.ChildCDGDO.Column));else{if(!y.ContainsKey(e.CategoryText))return;e.ActualColumn=y[e.CategoryText]+"."+e.Column}null!=e.ActualColumn&&(this.ReportParams.ProductSelect+=","+e.ActualColumn+" ["+p.ID+"]");continue}if(207==e.FieldValue){if(this.DocumentFilters.ContainsKey("GLParticularSelect")||(this.DocumentFilters.push("GLParticularSelect","A.AccountID"),this.DocumentFilters.push("GLParticularFrom","ACC_Accounts A with(nolock)")),"ACC_Accounts"==e.Table){this.DocumentFilters.GLParticularSelect+=",A."+e.Column+" AS ["+p.ID+"]";continue}if("ACC_AccountsExtended"==e.Table){t=e.CategoryText+"ACC_AccountsExtended",this.Entities.ContainsKey(t)||(this.Entities.push(t,"ACCEXT"),this.DocumentFilters.GLParticularFrom+=" LEFT JOIN ACC_AccountsExtended AS "+this.Entities[t]+" with(nolock) ON A.AccountID=ACCEXT.AccountID"),this.DocumentFilters.GLParticularSelect+=",ACCEXT."+e.Column+" AS ["+p.ID+"]";continue}if("COM_ADDRESS"==e.Table.toUpperCase()){t=e.CategoryText+"COM_ADDRESS",this.Entities.ContainsKey(t)||(this.Entities.push(t,"ACCADD"),this.DocumentFilters.GLParticularFrom+=" LEFT JOIN COM_ADDRESS AS "+this.Entities[t]+" with(nolock) ON ACCADD.AddressTypeID=1 AND ACCADD.FeatureID=2 AND A.AccountID=ACCADD.FeaturePK"),this.DocumentFilters.GLParticularSelect+=",ACCADD."+e.Column+" AS ["+p.ID+"]";continue}if("Shipping_Address"==e.Table||"Billing_Address"==e.Table){this.DocumentFilters.GLParticularSelect+=",(select "+this.GetAddressColumn(e.Column.substr(5))+" from COM_ADDRESS with(nolock) where AddressID=(select min(AddressID) from COM_ADDRESS with(nolock) where AddressTypeID="+("Shipping_Address"==e.Table?"3":"2")+" and FeatureID=2 AND A.AccountID=FeaturePK)) AS ["+p.ID+"]";continue}continue}if(401==e.CategoryValue||402==e.CategoryValue||Math.abs(e.CategoryValue)>4e4&&Math.abs(e.CategoryValue)<5e4)if("COM_DocTextData"==e.Table){this.Entities.ContainsKey(e.CategoryText)||this.Entities.push(e.CategoryText,this.Entities.Documents),t=e.CategoryText+"COM_DocTextData";var E=this.FieldsDialog.DocumentTypes.filter((function(t){return t.CostCenterID==Math.abs(e.CategoryValue)}));E.length>0&&Object(r.j)(E[0].IsInventory)?(this.Entities.ContainsKey(t)||this.Entities.push(t,"DOCTEXT"),D||(T+=" LEFT JOIN COM_DocTextData AS "+this.Entities[t]+" with(nolock) ON "+this.Entities[t]+".InvDocDetailsID="+this.Entities.Documents+".InvDocDetailsID"),D=!0):(this.Entities.ContainsKey(t)||this.Entities.push(t,"DOCATEXT"),C||(T+=" LEFT JOIN COM_DocTextData AS "+this.Entities[t]+" with(nolock) ON "+this.Entities[t]+".AccDocDetailsID="+this.Entities.Documents+".AccDocDetailsID"),C=!0),e.ParentCDGDO=new c.a}else if("COM_DocNumData"==e.Table){if(this.Entities.ContainsKey(e.CategoryText)||this.Entities.push(e.CategoryText,this.Entities.Documents),1==this.StaticReportType||2==this.StaticReportType||3==this.StaticReportType||86==this.StaticReportType||156==this.StaticReportType){188==e.FieldValue?(e.ActualColumn="CASE WHEN D.InvDocDetailsID is null THEN NULL ELSE\n(SELECT top 1 (select top 1 X.value('@Remarks','nvarchar(max)') from NUM.Remarks.nodes('/XML/Row') as Data(X) where ",s.e.IsEmpty(e.Formula)?e.ActualColumn+="X.value('@CreditAcount','bigint')=A1.AccountID or X.value('@DebitAcount','bigint')=A1.AccountID":e.ActualColumn+="X.value('@Columnname','nvarchar(50)')='dcNum"+e.Formula+"'",e.ActualColumn+=") FROM COM_DocNumData NUM WITH(NOLOCK) WHERE NUM.InvDocDetailsID=D.InvDocDetailsID) end",h+=","+e.ActualColumn+" AS ["+p.ID+"]",this.SelectTagAliasOnly+=","+p.ID):(this.FieldsDialog.DocumentTypes.filter((function(t){return t.CostCenterID==Math.abs(e.CategoryValue)})),e.ActualColumn=this.FieldsDialog.DocumentTypes.length>0&&Object(r.j)(this.FieldsDialog.DocumentTypes[0].IsInventory)?" CASE WHEN D.CostCenterID="+Math.abs(e.CategoryValue)+" THEN (select sum("+e.Column+") from COM_DocNumData with(nolock) where InvDocDetailsID in (select InvDocDetailsID FROM INV_DocDetails with(nolock) WHERE VoucherNo=D.VoucherNo)) ELSE NULL END ":" CASE WHEN D.CostCenterID="+Math.abs(e.CategoryValue)+" THEN (select sum("+e.Column+") from COM_DocNumData with(nolock) where AccDocDetailsID in (select AccDocDetailsID FROM ACC_DocDetails with(nolock) WHERE VoucherNo=D.VoucherNo)) ELSE NULL END ",h+=","+e.ActualColumn+" AS ["+p.ID+"]",this.SelectTagAliasOnly+=","+p.ID);continue}t=e.CategoryText+"COM_DocNumData",this.Entities.ContainsKey(t)||this.Entities.push(t,"DOCNUM"),u||(T+=this.IsInventory?" LEFT JOIN COM_DocNumData AS "+this.Entities[t]+" with(nolock) ON "+this.Entities[t]+".InvDocDetailsID="+this.Entities.Documents+".InvDocDetailsID":" LEFT JOIN COM_DocNumData AS "+this.Entities[t]+" with(nolock) ON "+this.Entities[t]+".AccDocDetailsID="+this.Entities.Documents+".AccDocDetailsID"),u=!0,e.ParentCDGDO=new c.a}else if(2==e.ColumnCostCenterID&&-2!=this.StaticReportType&&0!=s.e.stringCompare(e.Formula,"LATEST")&&0!=s.e.stringCompare(e.Formula,"OLDEST")){var N=e.ParentColumn;this.Entities.ContainsKey(N)||(this.Entities.push(N,"T"+ ++n),T+=" LEFT JOIN "+e.ParentCostCenterSysName+" AS "+this.Entities[N]+" with(nolock) ON "+this.Entities[N]+"."+e.ParentCostCenterColSysName+"="+this.Entities.Documents+"."+e.ParentColumn),e.ActualColumn=" CASE WHEN "+this.Entities.Documents+".CostCenterID="+Math.abs(e.CategoryValue)+" THEN "+this.Entities[N]+"."+e.Column+" ELSE NULL END",d+=","+e.ActualColumn,h+=","+e.ActualColumn+" AS ["+p.ID+"]",this.SelectTagAliasOnly+=","+p.ID;continue}if(e.ColumnCostCenterID>0&&null!=e.ParentTableAlias&&e.ParentTableAlias.Contains("_CCMAP")){if(this.Entities.ContainsKey(e.CategoryText)||(this.Entities.push(e.CategoryText,"T"+ ++n),T+=" LEFT JOIN "+e.ParentCostCenterSysName+" AS "+this.Entities[e.CategoryText]+" with(nolock) ON "+this.Entities[e.CategoryText]+"."+e.ParentCostCenterColSysName+"="+l+"."+e.ParentColumn),"COM_ADDRESS"==e.Table.toUpperCase()){e.ActualColumn="(select CCADD."+e.Column+" from COM_ADDRESS CCADD with(nolock) where CCADD.AddressTypeID=1 AND CCADD.FeatureID="+e.ColumnCostCenterID+" AND "+this.Entities[e.CategoryText]+"."+e.ParentCostCenterColSysName+"=CCADD.FeaturePK)",h+=","+e.ActualColumn,h+=" AS ["+p.ID+"]",this.SelectTagAliasOnly+=","+p.ID;continue}if(null!=e.ChildCDGDO&&!this.Entities.ContainsKey(e.ChildCDGDO.CategoryText))if("COM_CCCCDATA"==e.ChildCDGDO.ParentTable)this.Entities.ContainsKey(e.ChildCDGDO.ParentTableAlias)||(this.Entities.push(e.ChildCDGDO.ParentTableAlias,"T"+ ++n),T+=" LEFT JOIN COM_CCCCDATA AS "+this.Entities[e.ChildCDGDO.ParentTableAlias]+" with(nolock) ON "+this.Entities[e.CategoryText]+"."+e.ParentCostCenterColSysName+"="+this.Entities[e.ChildCDGDO.ParentTableAlias]+".NodeID and "+this.Entities[e.ChildCDGDO.ParentTableAlias]+".CostCenterID="+e.ParentCostCenterID),this.Entities.ContainsKey(e.ChildCDGDO.CategoryText)||(this.Entities.push(e.ChildCDGDO.CategoryText,"T"+ ++n),T+=" LEFT JOIN "+e.ChildCDGDO.ParentCostCenterSysName+" AS "+this.Entities[e.ChildCDGDO.CategoryText]+" with(nolock) ON "+this.Entities[e.ChildCDGDO.CategoryText]+"."+e.ChildCDGDO.ParentCostCenterColSysName+"="+this.Entities[e.ChildCDGDO.ParentTableAlias]+"."+e.ChildCDGDO.ParentColumn);else if(e.ChildCDGDO.ParentColumn.startsWith("ccAlpha")||e.ChildCDGDO.ParentColumn.startsWith("Alpha")||e.ChildCDGDO.ParentColumn.startsWith("alpha")){e.ActualColumn=" case when isnumeric("+this.Entities[e.CategoryText]+"."+e.ChildCDGDO.ParentColumn+")=1 then (select "+e.ChildCDGDO.Column+" from "+e.ChildCDGDO.ParentCostCenterSysName+" with(nolock) where "+e.ChildCDGDO.ParentCostCenterColSysName+"="+this.Entities[e.CategoryText]+"."+e.ChildCDGDO.ParentColumn+") else null end",h+=","+e.ActualColumn+" AS ["+p.ID+"]",this.SelectTagAliasOnly+=","+p.ID;continue}}else{if(2==e.ColumnCostCenterID&&156==this.StaticReportType){e.ActualColumn=" CASE WHEN D.CostCenterID="+Math.abs(e.CategoryValue)+" THEN (select "+e.Column+" from Acc_Accounts with(nolock) where AccountID =D."+e.ParentColumn+") ELSE NULL END ",h+=","+e.ActualColumn+" AS ["+p.ID+"]",this.SelectTagAliasOnly+=","+p.ID;continue}113==e.ColumnCostCenterID?this.Entities.ContainsKey(e.CategoryText)||(this.Entities.push(e.CategoryText,"T"+ ++n),T+=" LEFT JOIN "+e.ParentCostCenterSysName+" AS "+this.Entities[e.CategoryText]+" with(nolock) ON "+this.Entities[e.CategoryText]+"."+e.ParentCostCenterColSysName+"="+this.Entities.Documents+"."+e.ParentColumn):12==e.ParentCostCenterID||16==e.ParentCostCenterID?this.Entities.ContainsKey(e.CategoryText)||(this.Entities.push(e.CategoryText,12==e.ParentCostCenterID?"T"+ ++n+"CUR":"T"+ ++n),T+=" LEFT JOIN "+e.ParentCostCenterSysName+" AS "+this.Entities[e.CategoryText]+" with(nolock) ON "+this.Entities[e.CategoryText]+"."+e.ParentCostCenterColSysName+"="+this.Entities.Documents+"."+e.ParentColumn):7==e.ColumnCostCenterID?this.Entities.ContainsKey(e.CategoryText)||(this.Entities.push(e.CategoryText,"T"+ ++n),T+=" LEFT JOIN "+e.ParentCostCenterSysName+" AS "+this.Entities[e.CategoryText]+" with(nolock) ON "+this.Entities[e.CategoryText]+"."+e.ParentCostCenterColSysName+"="+this.Entities.Documents+"."+e.ParentColumn):3!=e.ColumnCostCenterID||203!=this.StaticReportType&&204!=this.StaticReportType||this.Entities.ContainsKey(e.CategoryText)||(this.Entities.push(e.CategoryText,"T"+ ++n),T+=" LEFT JOIN "+e.ParentCostCenterSysName+" AS "+this.Entities[e.CategoryText]+" with(nolock) ON "+this.Entities[e.CategoryText]+"."+e.ParentCostCenterColSysName+"="+this.Entities.Documents+"."+e.ParentColumn)}-2!=this.StaticReportType&&81!=this.StaticReportType||(2==e.ColumnCostCenterID?this.Entities.ContainsKey(e.CategoryText)||(this.Entities.push(e.CategoryText,"A"+ ++n),T+=" LEFT JOIN "+e.ParentCostCenterSysName+" AS "+this.Entities[e.CategoryText]+" with(nolock) ON "+this.Entities[e.CategoryText]+"."+e.ParentCostCenterColSysName+"="+this.Entities.Documents+"."+e.ParentColumn):3==e.ColumnCostCenterID&&(this.Entities.ContainsKey(e.CategoryText)||(this.Entities.push(e.CategoryText,"PRD"),T+=" LEFT JOIN "+e.ParentCostCenterSysName+" AS "+this.Entities[e.CategoryText]+" with(nolock) ON "+this.Entities[e.CategoryText]+"."+e.ParentCostCenterColSysName+"="+this.Entities.Documents+"."+e.ParentColumn)));try{if(400==e.CategoryValue)if(214==e.FieldValue){var S="",O=s.e.IsEmpty(e.DimensionsFilter)?[]:e.DimensionsFilter.split("~");if(O.length>2&&O[1].length>0&&O[2].length>0){for(var g=O[2].split(","),F=0;F<g.length;F++)F>0&&(S+=","),g[F].startsWith("EFPRD_")?S+="P."+g[F].Replace("EFPRD_",""):g[F].startsWith("EF_")&&(S=this.SetExtFunctionParams(g[F],S));S.length>0&&(e.ActualColumn="dbo."+O[1]+"("+S+")")}else e.ActualColumn="null "}else if(11515==p.CDGDO.FieldValue)h+=",stuff((select ','+[GUID]+'.'+FileExtension from COM_Files WITH(NOLOCK) WHERE FeatureID="+this.Entities.Documents+".CostCenterID AND FeaturePK="+this.Entities.Documents+".DocID FOR XML PATH('')),1,1,'') "+p.ID+"_ID",this.SelectTagAliasOnly+=","+p.ID+"_ID",e.ActualColumn="stuff((select ', '+ActualFileName from COM_Files WITH(NOLOCK) WHERE FeatureID="+this.Entities.Documents+".CostCenterID AND FeaturePK="+this.Entities.Documents+".DocID FOR XML PATH('')),1,2,'')";else if(11484==p.CDGDO.FieldValue)e.ActualColumn="(SELECT VoucherNo FROM INV_DocDetails with(nolock)\tWHERE InvDocDetailsID IN (select LinkedInvDocDetailsID from INV_DocDetails with(nolock) WHERE InvDocDetailsID="+this.Entities.Documents+".InvDocDetailsID and LinkedInvDocDetailsID>0))";else if(11514==p.CDGDO.FieldValue)e.ActualColumn="(SELECT convert(datetime,DocDate) FROM INV_DocDetails with(nolock)\tWHERE InvDocDetailsID IN (select LinkedInvDocDetailsID from INV_DocDetails with(nolock) WHERE InvDocDetailsID="+this.Entities.Documents+".InvDocDetailsID and LinkedInvDocDetailsID>0))";else if(21358==p.CDGDO.FieldValue)this.Entities.ContainsKey(e.CategoryText)||(this.Entities.push(e.CategoryText,"DocumentType"),T+=" LEFT JOIN "+e.ParentCostCenterSysName+" AS "+this.Entities[e.CategoryText]+" with(nolock) ON "+this.Entities[e.CategoryText]+"."+e.ParentCostCenterColSysName+"="+this.Entities.Documents+"."+e.ParentColumn),e.ActualColumn="DocumentType.DocumentName";else if(11413==p.CDGDO.FieldValue)e.ActualColumn="D.BankAccountID";else{var f=new I;f.DocID=-1,f.IsInventory=this.IsInventory,this.SetActualColumn(e,f)}else 0==s.e.stringCompare(e.Formula,"LATEST")||0==s.e.stringCompare(e.Formula,"OLDEST")?e.ActualColumn=this.GetLatestOldestQuery(e,"P",""):(this.Entities.ContainsKey(e.CategoryText)||this.Entities.push(e.CategoryText,this.Entities.Documents),this.SetActualColumn_1(e));d+=","+e.ActualColumn,h+=","+e.ActualColumn,h+=" AS ["+p.ID+"]",this.SelectTagAliasOnly+=","+p.ID,("3"==p.LinkType.SelectedValue||"4"==p.LinkType.SelectedValue)&&e.ColumnCostCenterID>5e4&&(h+=","+e.ActualTable+".NodeID",h+=" ["+p.ID+"_ID]",this.SelectTagAliasOnly+=","+p.ID+"_ID")}catch(pe){}}else if(2==e.CategoryValue){if("ACC_AccountsExtended"==e.Table){t=e.CategoryText+"ACC_AccountsExtended",this.Entities.ContainsKey(t)||(this.Entities.push(t,"ACCEXT"),this.GroupFromTag+=" LEFT JOIN ACC_AccountsExtended AS "+this.Entities[t]+" with(nolock) ON "+this.Entities.Account+".AccountID=ACCEXT.AccountID"),this.GroupSelectTag+=",ACCEXT."+e.Column+" AS ["+p.ID+"]",this.GroupSelectTagAlias+=","+p.ID;continue}if("COM_ADDRESS"==e.Table.toUpperCase()){t=e.CategoryText+"COM_ADDRESS",this.Entities.ContainsKey(t)||(this.Entities.push(t,"ACCADD"),this.GroupFromTag+=" LEFT JOIN COM_ADDRESS AS "+this.Entities[t]+" with(nolock) ON ACCADD.AddressTypeID=1 AND ACCADD.FeatureID=2 AND "+this.Entities.Account+".AccountID=ACCADD.FeaturePK"),this.GroupSelectTag+=",ACCADD."+e.Column+" AS ["+p.ID+"]",this.GroupSelectTagAlias+=","+p.ID;continue}if("Shipping_Address"==e.Table||"Billing_Address"==e.Table){this.GroupSelectTag+=",(select "+this.GetAddressColumn(e.Column.substr(5))+" from COM_ADDRESS with(nolock) where AddressID=(select min(AddressID) from COM_ADDRESS with(nolock) where AddressTypeID="+("Shipping_Address"==e.Table?"3":"2")+" and FeatureID=2 AND "+this.Entities.Account+".AccountID=FeaturePK)) AS ["+p.ID+"]",this.GroupSelectTagAlias+=","+p.ID;continue}if(e.IsForeignKey&&(this.Entities.ContainsKey(e.CategoryText)||(t="T"+ ++n,this.Entities.push(e.CategoryText,t),0==s.e.stringCompare(e.ParentTable,"COM_CCCCData",!0)?(this.Entities.ContainsKey("CC")||(this.Entities.push("CC","CC"),this.GroupFromTag+=" LEFT JOIN COM_CCCCData CC with(nolock) ON CC.NodeID=P.AccountID AND CC.CostCenterID="+e.CategoryValue),this.GroupFromTag+=" LEFT JOIN "+e.ParentCostCenterSysName+" AS "+this.Entities[e.CategoryText]+" with(nolock) ON "+this.Entities[e.CategoryText]+"."+e.ParentCostCenterColSysName+"=CC."+e.ParentColumn):this.GroupFromTag+=" LEFT JOIN "+e.ParentCostCenterSysName+" AS "+this.Entities[e.CategoryText]+" with(nolock) ON "+this.Entities[e.CategoryText]+"."+e.ParentCostCenterColSysName+"="+this.Entities.Account+"."+e.ParentColumn)),!this.Entities.ContainsKey(e.CategoryText))return;var R=new I;R.DocID=-1,R.IsInventory=this.IsInventory,this.SetActualColumn(e,R),this.GroupSelectTag+=","+e.ActualColumn+" AS ["+p.ID+"]",this.GroupSelectTagAlias+=","+p.ID}else if(3==e.CategoryValue){if("INV_ProductExtended"==e.Table){t=e.CategoryText+"INV_ProductExtended",this.Entities.ContainsKey(t)||(this.Entities.push(t,"PRODEXT"),this.GroupFromTag+=" LEFT JOIN INV_ProductExtended AS "+this.Entities[t]+" with(nolock) ON P.ProductID=PRODEXT.ProductID"),this.DbGroupSelectTag+=",PRODEXT."+e.Column,this.GroupSelectTag+=",PRODEXT."+e.Column+" AS ["+p.ID+"]",this.GroupSelectTagAlias+=","+p.ID;continue}if(e.IsForeignKey&&(this.Entities.ContainsKey(e.CategoryText)||(t="T"+ ++n,this.Entities.push(e.CategoryText,t),0==s.e.stringCompare(e.ParentTable,"COM_CCCCData",!0)?(this.Entities.ContainsKey("CC")||(this.Entities.push("CC","CC"),this.GroupFromTag+=" LEFT JOIN COM_CCCCData CC with(nolock) ON CC.NodeID=P.ProductID AND CC.CostCenterID="+e.CategoryValue),this.GroupFromTag+=" LEFT JOIN "+e.ParentCostCenterSysName+" AS "+this.Entities[e.CategoryText]+" with(nolock) ON "+this.Entities[e.CategoryText]+"."+e.ParentCostCenterColSysName+"=CC."+e.ParentColumn):this.GroupFromTag+=" LEFT JOIN "+e.ParentCostCenterSysName+" AS "+this.Entities[e.CategoryText]+" with(nolock) ON "+this.Entities[e.CategoryText]+"."+e.ParentCostCenterColSysName+"="+this.Entities.Product+"."+e.ParentColumn)),!this.Entities.ContainsKey(e.CategoryText))return;var P=new I;P.DocID=-1,P.IsInventory=this.IsInventory,this.SetActualColumn(e,P),this.DbGroupSelectTag+=","+e.ActualColumn,this.GroupSelectTag+=","+e.ActualColumn+" AS ["+p.ID+"]",this.GroupSelectTagAlias+=","+p.ID}else if(16==e.CategoryValue){if(e.IsForeignKey&&(this.Entities.ContainsKey(e.CategoryText)||(t="T"+ ++n,this.Entities.push(e.CategoryText,t),0==s.e.stringCompare(e.ParentTable,"COM_CCCCData",!0)?(this.Entities.ContainsKey("CC")||(this.Entities.push("CC","CC"),this.GroupFromTag+=" LEFT JOIN COM_CCCCData CC with(nolock) ON CC.NodeID=B.BatchID AND CC.CostCenterID="+e.CategoryValue),this.GroupFromTag+=" LEFT JOIN "+e.ParentCostCenterSysName+" AS "+this.Entities[e.CategoryText]+" with(nolock) ON "+this.Entities[e.CategoryText]+"."+e.ParentCostCenterColSysName+"=CC."+e.ParentColumn):this.GroupFromTag+=" LEFT JOIN "+e.ParentCostCenterSysName+" AS "+this.Entities[e.CategoryText]+" with(nolock) ON "+this.Entities[e.CategoryText]+"."+e.ParentCostCenterColSysName+"="+this.Entities.Product+"."+e.ParentColumn)),!this.Entities.ContainsKey(e.CategoryText))return;var b=new I;b.DocID=-1,b.IsInventory=this.IsInventory,this.SetActualColumn(e,b),this.DbGroupSelectTag+=","+e.ActualColumn,this.GroupSelectTag+=","+e.ActualColumn+" AS ["+p.ID+"]",this.GroupSelectTagAlias+=","+p.ID}}112==this.CostCenterID&&(h+=",D.InvDocDetailsID ReorderDetailsID",this.SelectTagAliasOnly+=",ReorderDetailsID"),this.DbSelectTag=d.toString(),this.SelectTag=h.toString(),this.FromTag=T.toString()}else if(9==this.StaticReportType||10==this.StaticReportType||11==this.StaticReportType||198==this.StaticReportType){var V=!1,v=new Array;v.AddRange(this.BaseReportColumns),v.AddRange(this.ReportGroups);var M=!1,_="DocNo";"ReportViewModel"==this.ClassName&&this.Report.Preferences.ContainsKey("FIFO")&&"1"==this.Report.Preferences.FIFO&&(M=!0,_="VoucherNo");for(var L=function(a){var l=v[a];if(e=l.CDGDO,33==l.ID.length)if(400==e.CategoryValue||401==e.CategoryValue||Math.abs(e.CategoryValue)>4e4&&Math.abs(e.CategoryValue)<5e4){if(V=!0,400==e.CategoryValue){if(214==e.FieldValue){var D="",C=s.e.IsEmpty(e.DimensionsFilter)?[]:e.DimensionsFilter.split("~");if(C.length>2&&C[1].length>0&&C[2].length>0){for(var u=C[2].split(","),c=0;c<u.length;c++)c>0&&(D+=","),u[c].startsWith("EFPBW_")?D+="B."+u[c].Replace("EFPBW_",""):u[c].startsWith("EF_")?D=o.SetExtFunctionParams(u[c],D):D+="null";h+=D.length>0?",dbo."+C[1]+"("+D+")"+l.ID:",null "+l.ID}else h+=",null "+l.ID}else if(0==e.ColumnCostCenterID)"AmountFC"==e.Column?h+=",B."+e.Column+" "+l.ID:"ExchangeRate"==e.Column?h+=M?",B.ExchangeRate "+l.ID:",B.AdjExchRT "+l.ID:"CurrencyID"==e.ParentColumn?(o.Entities.ContainsKey(e.CategoryText)||(t="T"+ ++n,o.Entities.push(e.CategoryText,t),T+=" INNER JOIN "+e.ParentCostCenterSysName+" AS "+t+" with(nolock) ON "+t+".CurrencyID=",T+=M?"B.CurrencyID":"B.AdjCurrID"),h+=","+o.Entities[e.CategoryText]+"."+e.Column+" AS "+l.ID):"ChequeNumber"==e.Column||"ChequeDate"==e.Column||"ChequeMaturityDate"==e.Column?M?(e.ActualColumn="DATE"==e.DataType?"convert(datetime,B."+e.Column+")":"B."+e.Column,h+=",MAX("+e.ActualColumn+") "+l.ID,o.SelectTagAliasOnly+=","+l.ID):(e.ActualColumn="DATE"==e.DataType?"convert(datetime,DOC."+e.Column+")":"DOC."+e.Column,h+=",CASE WHEN DType.IsInventory=0 THEN (SELECT MAX("+e.ActualColumn+") FROM Acc_DocDetails DOC WITH(NOLOCK) WHERE DOC.VoucherNo=B.DocNo) ELSE NULL END "+l.ID):11516==e.FieldValue?h+=",CASE WHEN DType.IsInventory=0 THEN\nstuff((SELECT ','+N.Note FROM Acc_DocDetails DOC WITH(NOLOCK) INNER JOIN COM_Notes N WITH(NOLOCK) ON N.FeatureID=DOC.CostCenterID AND N.FeaturePK=DOC.DocID WHERE DOC.VoucherNo=B."+_+" FOR XML PATH('')),1,1,'')\nELSE\nstuff((SELECT ','+N.Note FROM INV_DocDetails DOC WITH(NOLOCK) INNER JOIN COM_Notes N WITH(NOLOCK) ON N.FeatureID=DOC.CostCenterID AND N.FeaturePK=DOC.DocID WHERE DOC.VoucherNo=B."+_+" FOR XML PATH('')),1,1,'')  END AS "+l.ID:11484==l.CDGDO.FieldValue?h+=",CASE WHEN DType.IsInventory=0 THEN NULL ELSE\n(STUFF((SELECT distinct ','+VoucherNo FROM INV_DocDetails with(nolock) WHERE InvDocDetailsID IN \n(select LinkedInvDocDetailsID from INV_DocDetails with(nolock) WHERE VoucherNo=B.DocNo and LinkedInvDocDetailsID>0) FOR XML PATH('')),1,1,'')) END AS "+l.ID:11514==l.CDGDO.FieldValue?h+=",CASE WHEN DType.IsInventory=0 THEN NULL ELSE\n(SELECT top 1 convert(datetime,DocDate) FROM INV_DocDetails with(nolock) WHERE InvDocDetailsID IN \n(select LinkedInvDocDetailsID from INV_DocDetails with(nolock) WHERE VoucherNo=B."+_+" and LinkedInvDocDetailsID>0)) END AS "+l.ID:21358==l.CDGDO.FieldValue?h+=",(select "+e.Column+" from ADM_DocumentTypes with(nolock) where CostCenterID=(select top 1 CostCenterID from ACC_DocDetails with(nolock) WHERE VoucherNo=B."+_+")) AS "+l.ID:(e.ActualColumn="DATE"==e.DataType?"convert(datetime,DOC."+e.Column+")":"DOC."+e.Column,h+=",CASE WHEN DType.IsInventory=0 THEN\n  (SELECT MAX("+e.ActualColumn+") FROM Acc_DocDetails DOC WITH(NOLOCK) WHERE DOC.VoucherNo=B."+_+" and Doc.DocSeqNo=B.DocSeqNo)\n  ELSE\n  (SELECT MAX("+e.ActualColumn+") FROM INV_DocDetails DOC WITH(NOLOCK) WHERE DOC.VoucherNo=B."+_+")  END AS "+l.ID);else if(7==e.ParentCostCenterID)h+=",CASE WHEN DType.IsInventory=0 THEN (select top 1 [USER]."+e.Column+" from ACC_DocDetails DOC with(nolock) JOIN "+e.ParentCostCenterSysName+" [USER] with(nolock) ON [USER]."+e.ParentCostCenterColSysName+"=DOC."+e.ParentColumn+" WHERE DOC.VoucherNo=B."+_+")\nELSE\n(select top 1 [USER]."+e.Column+" from INV_DocDetails DOC with(nolock) JOIN "+e.ParentCostCenterSysName+" [USER] with(nolock) ON [USER]."+e.ParentCostCenterColSysName+"=DOC."+e.ParentColumn+" WHERE DOC.VoucherNo=B."+_+")\nEND AS "+l.ID;else if(12==e.ParentCostCenterID)o.Entities.ContainsKey(e.CategoryText)||(o.Entities.push(e.CategoryText,"T"+ ++n),T+=" LEFT JOIN "+e.ParentCostCenterSysName+" AS "+o.Entities[e.CategoryText]+" with(nolock) ON "+o.Entities[e.CategoryText]+"."+e.ParentCostCenterColSysName+"=B.AdjCurrID"),M?(h+=",max("+o.Entities[e.CategoryText]+"."+e.Column+") "+l.ID,o.SelectTagAliasOnly+=","+l.ID):h+=","+o.Entities[e.CategoryText]+"."+e.Column+" "+l.ID;else if(e.ColumnCostCenterID>5e4&&(0==o.ReportGroups.filter((function(e){return e.ID==l.ID})).length||198==o.StaticReportType)){if("COM_ADDRESS"==e.Table.toUpperCase())return e.ActualColumn="(select CCADD."+e.Column+" from COM_ADDRESS CCADD with(nolock) where CCADD.AddressTypeID=1 AND CCADD.FeatureID="+e.ColumnCostCenterID+" AND B.dcCCNID"+(e.ColumnCostCenterID-5e4)+"=CCADD.FeaturePK)",h+=","+e.ActualColumn,h+=" AS ["+l.ID+"]","continue";o.Entities.ContainsKey(e.CategoryText)||(t="T"+ ++n,o.Entities.push(e.CategoryText,t),T+=" INNER JOIN "+e.ParentCostCenterSysName+" AS "+t+" with(nolock) ON "+t+".NodeID="+(M?"DCC.":"B.")+e.ParentColumn),M?(h+=",max("+o.Entities[e.CategoryText]+"."+e.Column+") "+l.ID,o.SelectTagAliasOnly+=","+l.ID):h+=","+o.Entities[e.CategoryText]+"."+e.Column+" "+l.ID}}else if(401==e.CategoryValue||Math.abs(e.CategoryValue)>4e4&&Math.abs(e.CategoryValue)<5e4){if("COM_DocTextData"==e.Table){if(e.CategoryValue>4e4)if(e.ColumnCostCenterID>0){var d,y,m;if(s.e.IsEmpty(e.ParentCostCenterSysName)){var A=i.a.report.GetTableColumns(e.ColumnCostCenterID);A.TableName=d,A.PrimaryKey=y,A.ColumnName=m}else d=e.ParentCostCenterSysName,y=e.ParentCostCenterColSysName,m=e.ParentColumn;h+=",(select "+m+" from "+d+" with(nolock) where "+y+"=\n                                        (CASE WHEN DType.IsInventory=0 THEN\n  (SELECT MAX(TXT."+e.Column+') FROM Acc_DocDetails DOC WITH(NOLOCK) INNER JOIN COM_DocTextData TXT WITH(NOLOCK)\n    ON TXT.AccDocDetailsID=DOC.AccDocDetailsID WHERE DOC.VoucherNo=B." + strDocNo + " AND DOC.CostCenterID='+e.CategoryValue+" and Doc.DocSeqNo=B.DocSeqNo and isnumeric(TXT."+e.Column+")=1)\n  ELSE\n  (SELECT MAX(TXT."+e.Column+") FROM INV_DocDetails DOC WITH(NOLOCK) INNER JOIN COM_DocTextData TXT WITH(NOLOCK)\n    ON TXT.InvDocDetailsID=DOC.InvDocDetailsID WHERE DOC.VoucherNo=B."+_+" AND DOC.CostCenterID="+e.CategoryValue+" and isnumeric(TXT."+e.Column+")=1)  END)) AS "+l.ID}else h+=",CASE WHEN DType.IsInventory=0 THEN\n  (SELECT MAX(TXT."+e.Column+") FROM Acc_DocDetails DOC WITH(NOLOCK) INNER JOIN COM_DocTextData TXT WITH(NOLOCK)\n    ON TXT.AccDocDetailsID=DOC.AccDocDetailsID WHERE DOC.VoucherNo=B."+_+" AND DOC.CostCenterID="+e.CategoryValue+" and Doc.DocSeqNo=B.DocSeqNo)\n  ELSE\n  (SELECT MAX(TXT."+e.Column+") FROM INV_DocDetails DOC WITH(NOLOCK) INNER JOIN COM_DocTextData TXT WITH(NOLOCK)\n    ON TXT.InvDocDetailsID=DOC.InvDocDetailsID WHERE DOC.VoucherNo=B."+_+" AND DOC.CostCenterID="+e.CategoryValue+")  END AS "+l.ID;else{var p=o.GetTextField_AllDocuments(e.CategoryValue,e.FieldText);if(p.Tables[1].length>0){for(var E=Object(r.j)(p.Tables[0][0].IsInventory),N=" CASE",S=0;S<p.Tables[1].length;S++)N+=" WHEN MAX(DOC.CostCenterID)="+p.Tables[1][S].CostCenterID.toString(),N+=" THEN MAX(TXT."+p.Tables[1][S].SysColumnName.toString()+")";N+="END ",h+=E?",CASE WHEN DType.IsInventory=0 THEN NULL ELSE (SELECT "+N+" FROM INV_DocDetails DOC WITH(NOLOCK) INNER JOIN COM_DocTextData TXT WITH(NOLOCK) ON TXT.InvDocDetailsID=DOC.InvDocDetailsID WHERE DOC.VoucherNo=B."+_+") END AS "+l.ID:",CASE WHEN DType.IsInventory=1 THEN NULL ELSE (SELECT "+N+" FROM ACC_DocDetails DOC WITH(NOLOCK) INNER JOIN COM_DocTextData TXT WITH(NOLOCK) ON TXT.AccDocDetailsID=DOC.AccDocDetailsID WHERE DOC.VoucherNo=B."+_+") END AS "+l.ID}}return"continue"}if("COM_DocNumData"==e.Table){if(401==e.CategoryValue)188==e.FieldValue?(h+=",CASE WHEN DType.IsInventory=0 THEN NULL\nELSE\n(SELECT top 1 (select  top 1 X.value('@Remarks','nvarchar(max)') from NUM.Remarks.nodes('/XML/Row') as Data(X) where ",s.e.IsEmpty(e.Formula)?h+="X.value('@CreditAcount','bigint')=A.AccountID or X.value('@DebitAcount','bigint')=A.AccountID":h+="X.value('@Columnname','nvarchar(50)')='dcNum"+e.Formula+"'",h+=") FROM INV_DocDetails DOC WITH(NOLOCK) INNER JOIN COM_DocNumData NUM WITH(NOLOCK)\nON NUM.InvDocDetailsID=DOC.InvDocDetailsID WHERE DOC.VoucherNo=B."+_+")  END AS "+l.ID):h+=",CASE WHEN DType.IsInventory=0 THEN\n  (SELECT SUM(NUM."+e.Column+") FROM Acc_DocDetails DOC WITH(NOLOCK) INNER JOIN COM_DocNumData NUM WITH(NOLOCK)\n    ON NUM.AccDocDetailsID=DOC.AccDocDetailsID WHERE DOC.VoucherNo=B."+_+" and Doc.DocSeqNo=B.DocSeqNo)\n  ELSE\n  (SELECT SUM(NUM."+e.Column+") FROM INV_DocDetails DOC WITH(NOLOCK) INNER JOIN COM_DocNumData NUM WITH(NOLOCK)\n    ON NUM.InvDocDetailsID=DOC.InvDocDetailsID WHERE DOC.VoucherNo=B."+_+")  END AS "+l.ID;else if(e.CategoryValue>4e4)h+=",CASE WHEN DType.IsInventory=0 THEN\n  (SELECT SUM(NUM."+e.Column+") FROM Acc_DocDetails DOC WITH(NOLOCK) INNER JOIN COM_DocNumData NUM WITH(NOLOCK)\n    ON NUM.AccDocDetailsID=DOC.AccDocDetailsID WHERE DOC.VoucherNo=B."+_+" AND DOC.CostCenterID="+e.CategoryValue+" and Doc.DocSeqNo=B.DocSeqNo)\n  ELSE\n  (SELECT SUM(NUM."+e.Column+") FROM INV_DocDetails DOC WITH(NOLOCK) INNER JOIN COM_DocNumData NUM WITH(NOLOCK)\n    ON NUM.InvDocDetailsID=DOC.InvDocDetailsID WHERE DOC.VoucherNo=B."+_+" AND DOC.CostCenterID="+e.CategoryValue+")  END AS "+l.ID;else{var O=o.GetTextField_AllDocuments(e.CategoryValue,e.FieldText);if(O.Tables[1].length>0){for(var g=Object(r.j)(O.Tables[0][0].IsInventory),F=" CASE",f=0;f<O.Tables[1].length;f++)F+=" WHEN SUM(DOC.CostCenterID)="+O.Tables[1][f].CostCenterID.toString(),F+=" THEN SUM(NUM."+O.Tables[1][f].SysColumnName.toString()+")";F+="END ",h+=g?",CASE WHEN DType.IsInventory=0 THEN NULL ELSE (SELECT "+F+" FROM INV_DocDetails DOC WITH(NOLOCK) INNER JOIN COM_DocNumData NUM WITH(NOLOCK) ON NUM.InvDocDetailsID=DOC.InvDocDetailsID WHERE DOC.VoucherNo=B."+_+") END AS "+l.ID:",CASE WHEN DType.IsInventory=1 THEN NULL ELSE (SELECT "+F+" FROM ACC_DocDetails DOC WITH(NOLOCK) INNER JOIN COM_DocNumData NUM WITH(NOLOCK) ON NUM.AccDocDetailsID=DOC.AccDocDetailsID WHERE DOC.VoucherNo=B."+_+") END AS "+l.ID}}return"continue"}2==e.ColumnCostCenterID&&(M?(h+=",CASE WHEN DType.IsInventory=0 THEN \n(select TOP 1 A."+e.Column+" from acc_accounts A with(nolock) where A.AccountID=max(B."+e.ParentColumn+"))\nELSE \n(select TOP 1 A."+e.Column+" from inv_docdetails D with(nolock) inner join acc_accounts A with(nolock) on A.AccountID=D."+e.ParentColumn+" where D.CostCenterID="+e.CategoryValue+" AND D.VoucherNo=B.VoucherNo) END AS ["+l.ID+"]",o.SelectTagAliasOnly+=","+l.ID):h+=",CASE WHEN DType.IsInventory=0 THEN \n(select TOP 1 A."+e.Column+" from acc_docdetails D with(nolock) inner join acc_accounts A with(nolock) on A.AccountID=D."+e.ParentColumn+" where D.CostCenterID="+e.CategoryValue+" AND D.VoucherNo=B.DocNo)\nELSE \n(select TOP 1 A."+e.Column+" from inv_docdetails D with(nolock) inner join acc_accounts A with(nolock) on A.AccountID=D."+e.ParentColumn+" where D.CostCenterID="+e.CategoryValue+" AND D.VoucherNo=B.DocNo) END AS ["+l.ID+"]")}}else if(2==e.CategoryValue){if(!o.Entities.ContainsKey(e.CategoryText)&&!e.IsForeignKey)return{v:void 0};if("ACC_AccountsExtended"==e.Table)t=e.CategoryText+"ACC_AccountsExtended",o.Entities.ContainsKey(t)||(o.Entities.push(t,"ACCEXT"),T+=" LEFT JOIN ACC_AccountsExtended AS "+o.Entities[t]+" with(nolock) ON A.AccountID=ACCEXT.AccountID"),h+=",ACCEXT."+e.Column+" AS ["+l.ID+"]";else if("COM_ADDRESS"==e.Table.toUpperCase())t=e.CategoryText+"COM_ADDRESS",o.Entities.ContainsKey(t)||(o.Entities.push(t,"ACCADD"),T+=" LEFT JOIN COM_ADDRESS AS "+o.Entities[t]+" with(nolock) ON ACCADD.AddressTypeID=1 AND ACCADD.FeatureID=2 AND A.AccountID=ACCADD.FeaturePK"),h+=",ACCADD."+e.Column+" AS ["+l.ID+"]";else if("Shipping_Address"==e.Table||"Billing_Address"==e.Table)h+=",(select "+o.GetAddressColumn(e.Column.substr(5))+" from COM_ADDRESS with(nolock) where AddressID=(select min(AddressID) from COM_ADDRESS with(nolock) where AddressTypeID="+("Shipping_Address"==e.Table?"3":"2")+" and FeatureID=2 AND A.AccountID=FeaturePK)) AS ["+l.ID+"]";else if(e.IsForeignKey)o.Entities.ContainsKey(e.CategoryText)||(t="T"+ ++n,o.Entities.push(e.CategoryText,t),0==s.e.stringCompare(e.ParentTable,"COM_CCCCData",!0)?(o.Entities.ContainsKey(e.ParentTableAlias)||(o.Entities.push(e.ParentTableAlias,e.ParentTableAlias),T+=" LEFT JOIN COM_CCCCData "+e.ParentTableAlias+" with(nolock) ON "+e.ParentTableAlias+".NodeID="+o.Entities.Account+".AccountID AND "+e.ParentTableAlias+".CostCenterID="+e.CategoryValue),T+=" LEFT JOIN "+e.ParentCostCenterSysName+" AS "+o.Entities[e.CategoryText]+" with(nolock) ON "+o.Entities[e.CategoryText]+"."+e.ParentCostCenterColSysName+"="+e.ParentTableAlias+"."+e.ParentColumn):T+=" LEFT JOIN "+e.ParentCostCenterSysName+" AS "+o.Entities[e.CategoryText]+" with(nolock) ON "+o.Entities[e.CategoryText]+"."+e.ParentCostCenterColSysName+"="+o.Entities.Account+"."+e.ParentColumn),M?(h+=",max("+o.Entities[e.CategoryText]+"."+e.Column+") "+l.ID,o.SelectTagAliasOnly+=","+l.ID):"accounttypeid"!=e.Column.toLowerCase()||9!=o.StaticReportType&&10!=o.StaticReportType&&11!=o.StaticReportType?h+=","+o.Entities[e.CategoryText]+"."+e.Column+" "+l.ID:h+=", AT.AccountType "+l.ID;else{var R=new I;R.DocID=-1,R.IsInventory=o.IsInventory,o.SetActualColumn(e,R),h+=","+e.ActualColumn+" ["+l.ID+"]",!e.ActualColumn.startsWith("A.")||"3"!=l.LinkType.SelectedValue&&"4"!=l.LinkType.SelectedValue||(h+=",A.AccountID AS "+l.ID+"_ID")}}},w=0;w<v.length;w++){var x=L(w);if("continue"!==x&&"object"==typeof x)return x.v}v.find((function(e){return"AgainstAccount"==e.ID&&"1"==e.Visibility.SelectedValue}))&&(h+=",isnull((select top 1 SA.AccountName from ACC_DocDetails with(nolock)\ninner join ACC_Accounts SA with(nolock) on SA.AccountID=CreditAccount where B.RefDocNo is not null and VoucherNo=B.RefDocNo and DebitAccount=B.AccountID and (InvDocDetailsID is not null or DocSeqNo=B.RefDocSeqNo))\n,(select top 1 SA.AccountName from ACC_DocDetails with(nolock)\ninner join ACC_Accounts SA with(nolock) on SA.AccountID=DebitAccount where B.RefDocNo is not null and VoucherNo=B.RefDocNo and CreditAccount=B.AccountID and (InvDocDetailsID is not null or DocSeqNo=B.RefDocSeqNo))) AgainstAccount"),this.SelectTag=h.toString(),this.FromTag=T.toString(),this.SelectTag.length>0&&V&&this.SelectTag.Contains("DType.")&&(this.FromTag=" INNER JOIN (SELECT DocumentType DocType1,IsInventory FROM ADM_DocumentTypes with(nolock) Group By DocumentType,IsInventory) AS DType ON  DType.DocType1=B."+(M?"DocumentType ":"DocType ")+this.FromTag)}else if(171==this.StaticReportType){var G=new Array;G.AddRange(this.BaseReportColumns),G.AddRange(this.ReportGroups),"ReportViewModel"==this.ClassName&&this.Report.Preferences.ContainsKey("FIFO")&&this.Report.Preferences.FIFO;for(var k=0;k<G.length;k++){var B=G[k];if(e=B.CDGDO,33==B.ID.length&&((400==e.CategoryValue||Math.abs(e.CategoryValue)>4e4&&Math.abs(e.CategoryValue)<5e4)&&(400==e.CategoryValue&&0==e.ColumnCostCenterID?"CurrencyID"==e.ParentColumn?(this.Entities.ContainsKey(e.CategoryText)||(t="T"+ ++n,this.Entities.push(e.CategoryText,t),T+=" INNER JOIN "+e.ParentCostCenterSysName+" AS "+t+" with(nolock) ON "+t+".CurrencyID=D.CurrencyID"),h+=","+this.Entities[e.CategoryText]+"."+e.Column+" "+B.ID,this.SelectTagAliasOnly+=","+B.ID):(e.ActualColumn="DATE"==e.DataType?"convert(datetime,D."+e.Column+")":"D."+e.Column,h+=","+e.ActualColumn+" "+B.ID,this.SelectTagAliasOnly+=","+B.ID):e.ColumnCostCenterID>5e4?(this.Entities.ContainsKey(e.CategoryText)||(t="T"+ ++n,this.Entities.push(e.CategoryText,t),T+=" INNER JOIN "+e.ParentCostCenterSysName+" AS "+t+" with(nolock) ON "+t+".NodeID=DCC."+e.ParentColumn),h+=","+this.Entities[e.CategoryText]+"."+e.Column+" "+B.ID,this.SelectTagAliasOnly+=","+B.ID):"COM_DocTextData"==e.Table&&(D||(T+=" LEFT JOIN COM_DocTextData AS DOCTEXT with(nolock) ON DOCTEXT.InvDocDetailsID=D.InvDocDetailsID"),D=!0,h+=",DOCTEXT."+e.Column+" "+B.ID,this.SelectTagAliasOnly+=","+B.ID)),400==e.CategoryValue&&2==e.ColumnCostCenterID||2==e.CategoryValue))if("ACC_AccountsExtended"==e.Table)t=e.CategoryText+"ACC_AccountsExtended",this.Entities.ContainsKey(t)||(this.Entities.push(t,"ACCEXT"),T+=" LEFT JOIN ACC_AccountsExtended AS "+this.Entities[t]+" with(nolock) ON A.AccountID=ACCEXT.AccountID"),h+=",ACCEXT."+e.Column+" AS ["+B.ID+"]";else if("COM_ADDRESS"==e.Table.toUpperCase())t=e.CategoryText+"COM_ADDRESS",this.Entities.ContainsKey(t)||(this.Entities.push(t,"ACCADD"),T+=" LEFT JOIN COM_ADDRESS AS "+this.Entities[t]+" with(nolock) ON ACCADD.AddressTypeID=1 AND ACCADD.FeatureID=2 AND A.AccountID=ACCADD.FeaturePK"),h+=",ACCADD."+e.Column+" AS ["+B.ID+"]";else{var H=new I;H.DocID=-1,H.IsInventory=this.IsInventory,this.SetActualColumn(e,H),h+=","+e.ActualColumn+" AS ["+B.ID+"]"}}this.SelectTag=h.toString(),this.FromTag=T.toString()}else if(4==this.StaticReportType||12==this.StaticReportType||this.StaticReportType>=5&&this.StaticReportType<=8){for(var W=0;W<this.BaseReportColumns.length;W++){var U=this.BaseReportColumns[W];if(e=U.CDGDO,33==U.ID.length)if(2==e.CategoryValue)if("ACC_AccountsExtended"==e.Table)t=e.CategoryText+"ACC_AccountsExtended",this.Entities.ContainsKey(t)||(this.Entities.push(t,"ACCEXT"),T+=" LEFT JOIN ACC_AccountsExtended AS "+this.Entities[t]+" with(nolock) ON "+this.Entities.Account+".AccountID=ACCEXT.AccountID"),h+=",ACCEXT."+e.Column+" AS ["+U.ID+"]";else if(null!=e.Table&&"COM_ADDRESS"==e.Table.toUpperCase())t=e.CategoryText+"COM_ADDRESS",this.Entities.ContainsKey(t)||(this.Entities.push(t,"ACCADD"),T+=" LEFT JOIN COM_ADDRESS AS "+this.Entities[t]+" with(nolock) ON ACCADD.AddressTypeID=1 AND ACCADD.FeatureID=2 AND "+this.Entities.Account+".AccountID=ACCADD.FeaturePK"),h+=",ACCADD."+e.Column+" AS ["+U.ID+"]";else if(e.IsForeignKey)this.Entities.ContainsKey(e.CategoryText)||(t="T"+ ++n,this.Entities.push(e.CategoryText,t),0==s.e.stringCompare(e.ParentTable,"COM_CCCCData",!0)?(this.Entities.ContainsKey("CC")||(this.Entities.push("CC","CC"),T+=" LEFT JOIN COM_CCCCData CC with(nolock) ON CC.NodeID="+this.Entities.Account+".AccountID AND CC.CostCenterID="+e.CategoryValue),T+=" LEFT JOIN "+e.ParentCostCenterSysName+" AS "+this.Entities[e.CategoryText]+" with(nolock) ON "+this.Entities[e.CategoryText]+"."+e.ParentCostCenterColSysName+"=CC."+e.ParentColumn):T+=" LEFT JOIN "+e.ParentCostCenterSysName+" AS "+this.Entities[e.CategoryText]+" with(nolock) ON "+this.Entities[e.CategoryText]+"."+e.ParentCostCenterColSysName+"="+this.Entities.Account+"."+e.ParentColumn),"accounttypeid"==e.Column.toLowerCase()&&12==this.StaticReportType?h+=", AT.AccountType AS ["+U.ID+"]":h+=","+this.Entities[e.CategoryText]+"."+e.Column+" AS ["+U.ID+"]";else if(11396==e.FieldValue){var K=new I;K.DocID=-1,K.IsInventory=!1,this.SetActualColumn(e,K),h+=","+e.ActualColumn+" AS ["+U.ID+"]"}else s.e.IsEmpty(e.Column)||(h+=","+this.Entities.Account+"."+e.Column+" AS ["+U.ID+"]");else if(400==e.CategoryValue&&214==e.FieldValue){var Q="",X=s.e.IsEmpty(e.DimensionsFilter)?[]:e.DimensionsFilter.split("~");if(X.length>2&&X[1].length>0&&X[2].length>0){for(var j=X[2].split(","),Y=0;Y<j.length;Y++)Y>0&&(Q+=","),j[Y].startsWith("EFPBW_")?Q+="A."+j[Y].Replace("EFPBW_",""):j[Y].startsWith("EF_")?Q=this.SetExtFunctionParams(j[Y],Q):Q+="null";h+=Q.length>0?",dbo."+X[1]+"("+Q+")"+U.ID:",null "+U.ID}else h+=",null "+U.ID}}this.SelectTag=h.toString(),this.FromTag=T.toString()}else if(14==this.StaticReportType||15==this.StaticReportType||16==this.StaticReportType||83==this.StaticReportType||84==this.StaticReportType||112==this.StaticReportType||114==this.StaticReportType||115==this.StaticReportType||165==this.StaticReportType){for(var J=0;J<this.BaseReportColumns.length;J++){var q=this.BaseReportColumns[J];if(e=q.CDGDO,33==q.ID.length)if(11509==e.FieldValue||11510==e.FieldValue)h+=",(select top 1 StockValue/UOMConvertedQty from INV_DocDetails with(nolock) where ProductID=P.ProductID and VoucherType=1 and UOMConvertedQty>0",s.e.IsEmptySpace(e.ExecutedDocument)?h+=" and IsQtyIgnored=0":h+=" and CostCenterID IN ("+e.ExecutedDocument+")",h+=" order by docdate desc) AS ["+q.ID+"]";else if(189==e.FieldValue)s.e.IsEmptySpace(e.ExecutedDocument)?h+=",(select top 1 Rate*ExchangeRate from INV_DocDetails with(nolock) where ProductID=P.ProductID and IsQtyIgnored=0 and UOMConvertedQty>0 order by docdate desc) AS ["+q.ID+"]":h+=",(select top 1 Rate*ExchangeRate from INV_DocDetails with(nolock) where ProductID=P.ProductID and UOMConvertedQty>0 and CostCenterID IN ("+e.ExecutedDocument+") order by docdate desc) AS ["+q.ID+"]";else if(11508==e.FieldValue);else if(181==e.FieldValue){var z=new I;z.DocID=-1,z.IsInventory=this.IsInventory,this.SetActualColumn(e,z),this.GroupSelectTag+=","+e.ActualColumn+" AS ["+q.ID+"]",this.GroupSelectTagAlias+=","+q.ID}else if(214==e.FieldValue){var Z="",$=s.e.IsEmpty(e.DimensionsFilter)?[]:e.DimensionsFilter.split("~");if($.length>2&&$[1].length>0&&$[2].length>0){for(var ee=$[2].split(","),te=0;te<ee.length;te++)te>0&&(Z+=","),ee[te].startsWith("EFPRD_")?Z+="P."+ee[te].Replace("EFPRD_",""):ee[te].startsWith("EF_")&&(Z=this.SetExtFunctionParams(ee[te],Z));Z.length>0&&(h+=",dbo."+$[1]+"("+Z+")"+q.ID)}else h+=",null "+q.ID}else if(3==e.CategoryValue)if("INV_ProductExtended"==e.Table)t=e.CategoryText+"INV_ProductExtended",this.Entities.ContainsKey(t)||(this.Entities.push(t,"PRODEXT"),T+=" LEFT JOIN INV_ProductExtended AS "+this.Entities[t]+" with(nolock) ON P.ProductID=PRODEXT.ProductID"),h+=",PRODEXT."+e.Column+" AS ["+q.ID+"]",this.GroupSelectTag+=",MAX(PRODEXT."+e.Column+") AS ["+q.ID+"]";else if(26419==q.CDGDO.FieldValue||26420==q.CDGDO.FieldValue||50453==q.CDGDO.FieldValue){if(26420==q.CDGDO.FieldValue&&null!=this.Report&&16==this.StaticReportType&&2==this.ReportGroups.length)continue;var oe=new I;oe.DocID=e.CategoryValue,oe.IsInventory=!0,this.SetActualColumn(e,oe),h+=","+e.ActualColumn+" AS ["+q.ID+"]",this.GroupSelectTag+=",MAX("+e.ActualColumn+") AS ["+q.ID+"]"}else if(170==q.CDGDO.FieldValue||208==q.CDGDO.FieldValue){var ne=new I;ne.DocID=0,ne.IsInventory=!0,this.SetActualColumn(e,ne),h+=","+e.ActualColumn+" AS ["+q.ID+"]",this.GroupSelectTag+=",MAX("+e.ActualColumn+") AS ["+q.ID+"]"}else if(e.IsForeignKey)this.Entities.ContainsKey(e.CategoryText)||(t="T"+ ++n,this.Entities.push(e.CategoryText,t),0==s.e.stringCompare(e.ParentTable,"COM_CCCCData",!0)?(this.Entities.ContainsKey("CC")||(this.Entities.push("CC","CC"),T+=" LEFT JOIN COM_CCCCData CC with(nolock) ON CC.NodeID=P.ProductID AND CC.CostCenterID="+e.CategoryValue),T+=" LEFT JOIN "+e.ParentCostCenterSysName+" AS "+this.Entities[e.CategoryText]+" with(nolock) ON "+this.Entities[e.CategoryText]+"."+e.ParentCostCenterColSysName+"=CC."+e.ParentColumn):T+=" LEFT JOIN "+e.ParentCostCenterSysName+" AS "+this.Entities[e.CategoryText]+" with(nolock) ON "+this.Entities[e.CategoryText]+"."+e.ParentCostCenterColSysName+"="+this.Entities.Product+"."+e.ParentColumn),h+=","+this.Entities[e.CategoryText]+"."+e.Column+" AS ["+q.ID+"]",this.GroupSelectTag+=",MAX("+this.Entities[e.CategoryText]+"."+e.Column+") AS ["+q.ID+"]";else if("BinDimension"==e.Column){if(this.ReportParams.ContainsKey("BinDimension")||this.ReportParams.push("BinDimension",q.ID),84==this.StaticReportType){var ie;if(ie=s.e.Int(i.a.SessionManager.Preferences.DimensionwiseBins),"TRUE"==i.a.SessionManager.Preferences["LW Bins"].toUpperCase()||"TRUE"==i.a.SessionManager.Preferences["DW Bins"].toUpperCase()||ie>5e4){var se=i.a.report.GetDataTable("RPT024","");if(se.length>0){var ae="";"TRUE"==i.a.SessionManager.Preferences["LW Bins"].toUpperCase()?ae=this.ReportGroups.length>0&&50002==this.ReportGroups[0].CDGDO.ColumnCostCenterID?" AND B.Location=TBL.TagID":s.e.IsEmpty(this.oReportDialog.LocationWhere)||this.oReportDialog.LocationWhere.Contains(",")?" AND B.Location="+i.a.SessionManager.LocationID:" AND B.Location="+this.oReportDialog.LocationWhere:"TRUE"==i.a.SessionManager.Preferences["DW Bins"].toUpperCase()&&(ae=this.ReportGroups.length>0&&50001==this.ReportGroups[0].CDGDO.ColumnCostCenterID?" AND B.Division=TBL.TagID":" AND B.Division="+i.a.SessionManager.DivisionID),h+=",stuff((select ', '+ D.Name from INV_ProductBins B with(nolock)\ninner join "+se[0].TableName.toString()+" D with(nolock) on B.BinNodeID=D.NodeID\nwhere B.NodeID=P.ProductID AND B.CostCenterID=3"+ae+" FOR XML PATH('')),1,2,'') AS ["+q.ID+"]"}}}}else"ProductImage"==e.Column?(h+=",(select top 1 F.GUID+'.'+F.FileExtension from COM_Files F WITH(NOLOCK) where F.FeatureID=3 and F.IsProductImage=1 and F.FeaturePK="+this.Entities.Product+".ProductID and F.IsDefaultImage=1) ["+q.ID+"]",this.GroupSelectTag+=",MAX(select top 1 F.GUID+'.'+F.FileExtension from COM_Files F WITH(NOLOCK) where F.FeatureID=3 and F.IsProductImage=1 and F.FeaturePK="+this.Entities.Product+".ProductID and F.IsDefaultImage=1) ["+q.ID+"]"):(h+=",P."+e.Column+" AS ["+q.ID+"]",this.GroupSelectTag+=",MAX(P."+e.Column+") AS ["+q.ID+"]");else e.CategoryValue>4e4&&e.CategoryValue<5e4&&(0==s.e.stringCompare(q.Formula.Text,"LATEST",!0)?0==e.IsForeignKey&&("DocDate"==e.Column?h+=",(select TOP 1 CONVERT(DATETIME,A.DocDate) from inv_docdetails A with(nolock) @CCWHERE@ where A.productid=P.productID AND A.costcenterid="+e.CategoryValue+" order by A.DocDate desc,A.CreatedDate desc) AS ["+q.ID+"]":e.Column.startsWith("dcCalcNum")||e.Column.startsWith("dcNum")?h+=",(select TOP 1 N."+e.Column+" from inv_docdetails A with(nolock) inner join COM_DocNumData N with(nolock) on N.invdocdetailsid=A.invdocdetailsid @CCWHERE@ where A.productid=P.productID AND A.costcenterid="+e.CategoryValue+" order by A.DocDate desc,A.CreatedDate desc) AS ["+q.ID+"]":h+=",(select TOP 1 "+e.Column+" from inv_docdetails A with(nolock) @CCWHERE@ where A.productid=P.productID AND A.costcenterid="+e.CategoryValue+" order by A.DocDate desc,A.CreatedDate desc) AS ["+q.ID+"]"):0==s.e.stringCompare(q.Formula.Text,"OLDEST",!0)&&0==e.IsForeignKey&&("DocDate"==e.Column?h+=",(select TOP 1 CONVERT(DATETIME,A.DocDate) from inv_docdetails A with(nolock) @CCWHERE@ where A.productid=P.productID AND A.costcenterid="+e.CategoryValue+" order by A.DocDate asc,A.CreatedDate asc) AS ["+q.ID+"]":e.Column.startsWith("dcCalcNum")||e.Column.startsWith("dcNum")?h+=",(select TOP 1 N."+e.Column+" from inv_docdetails A with(nolock) inner join COM_DocNumData N with(nolock) on N.invdocdetailsid=A.invdocdetailsid @CCWHERE@ where A.productid=P.productID AND A.costcenterid="+e.CategoryValue+" order by A.DocDate asc,A.CreatedDate asc) AS ["+q.ID+"]":h+=",(select TOP 1 "+e.Column+" from inv_docdetails A with(nolock) @CCWHERE@ where A.productid=P.productID AND A.costcenterid="+e.CategoryValue+" order by A.DocDate asc,A.CreatedDate asc) AS ["+q.ID+"]"))}this.SelectTag=h.toString(),this.FromTag=T.toString()}else if(118==this.StaticReportType){for(var re=0;re<this.BaseReportColumns.length;re++){var le=this.BaseReportColumns[re];e=le.CDGDO,33==le.ID.length&&e.IsForeignKey&&(this.Entities.ContainsKey(e.CategoryText)||(t="T"+ ++n,this.Entities.push(e.CategoryText,t),0==s.e.stringCompare(e.ParentTable,"COM_CCCCData",!0)?(this.Entities.ContainsKey("CC")||(this.Entities.push("CC","CC"),T+=" LEFT JOIN COM_CCCCData CC with(nolock) ON CC.NodeID=P.ProductID AND CC.CostCenterID="+e.CategoryValue),T+=" LEFT JOIN "+e.ParentCostCenterSysName+" AS "+this.Entities[e.CategoryText]+" with(nolock) ON "+this.Entities[e.CategoryText]+"."+e.ParentCostCenterColSysName+"=CC."+e.ParentColumn):T+=" LEFT JOIN "+e.ParentCostCenterSysName+" AS "+this.Entities[e.CategoryText]+" with(nolock) ON "+this.Entities[e.CategoryText]+"."+e.ParentCostCenterColSysName+"=A."+e.ParentColumn),h+=","+this.Entities[e.CategoryText]+"."+e.Column+" AS ["+le.ID+"]")}this.SelectTag=h.toString(),this.FromTag=T.toString()}else if(196==this.StaticReportType){var De=new Array;De.AddRange(this.BaseReportColumns),De.AddRange(this.ReportGroups);for(var Ce=0;Ce<De.length;Ce++){var ue=De[Ce];if(e=ue.CDGDO,33==ue.ID.length&&i.a.SessionManager.Preferences.Registers.length>0&&e.CategoryValue==parseInt(i.a.SessionManager.Preferences.Registers)){var ce=e.CategoryText.split(".")[0];if(this.Entities.ContainsKey(ce)||this.Entities.push(ce,"R"),e.IsForeignKey&&(this.Entities.ContainsKey(e.CategoryText)||(t="T"+ ++n,this.Entities.push(e.CategoryText,t),0==s.e.stringCompare(e.ParentTable,"COM_CCCCData",!0)?(this.Entities.ContainsKey("REG_CC")||(this.Entities.push("REG_CC","REG_CC"),this.FromTag+=" LEFT JOIN COM_CCCCData CC with(nolock) ON REG_CC.NodeID=R.NodeID AND REG_CC.CostCenterID="+e.CategoryValue),this.FromTag+=" LEFT JOIN "+e.ParentCostCenterSysName+" AS "+this.Entities[e.CategoryText]+" with(nolock) ON "+this.Entities[e.CategoryText]+"."+e.ParentCostCenterColSysName+"=REG_CC."+e.ParentColumn):this.FromTag+=" LEFT JOIN "+e.ParentCostCenterSysName+" AS "+this.Entities[e.CategoryText]+" with(nolock) ON "+this.Entities[e.CategoryText]+"."+e.ParentCostCenterColSysName+"="+this.Entities[ce]+"."+e.ParentColumn)),!this.Entities.ContainsKey(e.CategoryText))continue;var Ie=new I;Ie.DocID=-1,Ie.IsInventory=this.IsInventory,this.SetActualColumn(e,Ie),this.SelectTag+=","+e.ActualColumn+" AS ["+ue.ID+"]"}}}else if(73==this.StaticReportType||87==this.StaticReportType||this.StaticReportType>=209&&this.StaticReportType<=215){var he=new Array;he.AddRange(this.BaseReportColumns),he.AddRange(this.ReportGroups);for(var de=0;de<he.length;de++){var Te=he[de];if(33==Te.ID.length&&(92==Te.CDGDO.CategoryValue||93==Te.CDGDO.CategoryValue||94==Te.CDGDO.CategoryValue||95==Te.CDGDO.CategoryValue))if((e=Te.CDGDO).IsForeignKey){if(this.Entities.ContainsKey(e.CategoryText))if("REN_PropertyExtended"==e.Table)t=e.CategoryText+"REN_PropertyExtended",this.Entities.ContainsKey(t)||(this.Entities.push(t,"PRPEXT"),T+=" JOIN REN_PropertyExtended AS "+this.Entities[t]+" with(nolock) ON C.PropertyID=PRPEXT.NodeID"),h+=",PRPEXT."+e.Column+" AS ["+Te.ID+"]";else if("REN_UnitsExtended"==e.Table)t=e.CategoryText+"REN_UnitsExtended",this.Entities.ContainsKey(t)||(this.Entities.push(t,"UNTEXT"),T+=" JOIN REN_UnitsExtended AS "+this.Entities[t]+" with(nolock) ON C.UnitID=UNTEXT.UnitID"),h+=",UNTEXT."+e.Column+" AS ["+Te.ID+"]";else if("REN_TenantExtended"==e.Table)t=e.CategoryText+"REN_TenantExtended",this.Entities.ContainsKey(t)||(this.Entities.push(t,"TNTEXT"),T+=" JOIN REN_TenantExtended AS "+this.Entities[t]+" with(nolock) ON C.TenantID=TNTEXT.TenantID"),h+=",TNTEXT."+e.Column+" AS ["+Te.ID+"]";else if(null!=e.ChildCDGDO&&e.IsForeignKey)0!=s.e.stringCompare(e.Table,"COM_CCCCData",!0)||this.Entities.ContainsKey(e.ChildCDGDO.ParentTableAlias)||(this.Entities.push(e.ChildCDGDO.ParentTableAlias,"RTCC"+ ++n),T+=" LEFT JOIN COM_CCCCData "+this.Entities[e.ChildCDGDO.ParentTableAlias]+" with(nolock) ON "+this.Entities[e.ChildCDGDO.ParentTableAlias]+".NodeID="+this.Entities[e.CategoryText]+"."+e.ParentCostCenterColSysName+" AND "+this.Entities[e.ChildCDGDO.ParentTableAlias]+".CostCenterID="+e.ColumnCostCenterID),t=e.CategoryText+e.ChildCDGDO.Table,this.Entities.ContainsKey(t)||(this.Entities.push(t,"RT"+ ++n),T+=" JOIN "+e.ChildCDGDO.Table+" AS "+this.Entities[t]+" with(nolock) ON "+this.Entities[t]+"."+e.ChildCDGDO.ParentCostCenterColSysName+"="+this.Entities[e.ChildCDGDO.ParentTableAlias]+"."+e.ChildCDGDO.ParentColumn),h+=","+this.Entities[t]+"."+e.ChildCDGDO.Column+" AS ["+Te.ID+"]";else{var ye=new I;ye.DocID=-1,ye.IsInventory=this.IsInventory,this.SetActualColumn(e,ye),h+=44==e.LocalReference?","+e.ActualColumn+" AS ["+Te.ID+"]":","+this.Entities[e.CategoryText]+"."+e.Column+" AS ["+Te.ID+"]"}else{var me=e.CategoryText.split(".")[0];this.Entities.ContainsKey(me)||this.Entities.push(me,"R"),0!=s.e.stringCompare(e.ParentTable,"COM_CCCCData",!0)||this.Entities.ContainsKey(e.ParentTableAlias)||(this.Entities.push(e.ParentTableAlias,"RTCC"+ ++n),95==e.CategoryValue&&(this.FromTag+=" LEFT JOIN COM_CCCCData "+this.Entities[e.ParentTableAlias]+" with(nolock) ON "+this.Entities[e.ParentTableAlias]+".NodeID="+this.Entities[me]+".ContractID  AND "+this.Entities[e.ParentTableAlias]+".CostCenterID="+e.CategoryValue),me=e.ParentTableAlias),t="X"+ ++n,this.Entities.push(e.CategoryText,t),this.FromTag+=" LEFT JOIN "+e.ParentCostCenterSysName+" AS "+this.Entities[e.CategoryText]+" with(nolock) ON "+this.Entities[e.CategoryText]+"."+e.ParentCostCenterColSysName+"="+this.Entities[me]+"."+e.ParentColumn,h+=","+this.Entities[e.CategoryText]+"."+e.Column+" AS ["+Te.ID+"]"}209==this.StaticReportType&&(this.GroupSelectTag+=",max("+Te.ID+") ["+Te.ID+"]"),214==this.StaticReportType&&(this.SelectTagAliasOnly+=","+Te.ID)}else if(95==e.CategoryValue){if("REN_ContractExtended"==e.Table)t=e.CategoryText+"REN_ContractExtended",this.Entities.ContainsKey(t)||(this.Entities.push(t,"CNTEXT"),T+=" JOIN REN_ContractExtended AS "+this.Entities[t]+" with(nolock) ON C.ContractID=CNTEXT.NodeID"),h+=",CNTEXT."+e.Column+" AS ["+Te.ID+"]";else if("REN_ContractParticulars"==e.Table)h+=","+this.Entities.ContractREN_ContractParticulars+"."+e.Column+" AS ["+Te.ID+"]";else{var Ae=new I;Ae.DocID=-1,Ae.IsInventory=this.IsInventory,this.SetActualColumn(e,Ae),h+=","+e.ActualColumn+" AS ["+Te.ID+"]"}209==this.StaticReportType&&(this.GroupSelectTag+=",max("+Te.ID+") ["+Te.ID+"]"),214==this.StaticReportType&&(this.SelectTagAliasOnly+=","+Te.ID)}else this.Entities.ContainsKey(e.CategoryText)&&(h+=","+this.Entities[e.CategoryText]+"."+e.Column+" AS ["+Te.ID+"]")}this.SelectTag+=h.toString(),this.FromTag+=T.toString()}}},{key:"SetQueryXMLTagsForQueryReports",value:function(){var e=this;if(this.BaseReportColumns.forEach((function(t){"1"==t.ShowLevel.SelectedValue&&null==e.LevelColumn&&(e.LevelColumn=t)})),this.Filter.IsReportViewScreen){var t,o=this;if(this.FinalQuery=o.ReportQuery,o.Preferences.Filters.length>0&&function(){var a,r="",l="",D=new s.f;D.LoadXml("<XML>"+o.Preferences.Filters+"</XML>");for(var C=D.DocumentElement.childNodes,u=0;u<C.length;u++){var c=C[u];l="";for(var I=s.f.SelectNodes(c,"Filter"),h=function(D){var C=I[D];a=C.attributes.MapField.value;var u=e.Filter.Fields.find((function(e){return e.ID==a}));if(u){if(u.CDGDO.ActualColumn=C.attributes.Column.value,"DATE"==u.CDGDO.DataType){if(!e.DontApplyDateFilter)if(l+=" AND ",l+=u.CDGDO.ActualColumn,"Between"==u.Condition.SelectedValue||"NotBetween"==u.Condition.SelectedValue)l+=u.Condition.SelectedItem.Parent,l+="'"+u.FromDatePicker.Date.ToString("dd MMM yyyy")+"' AND ",l+="'"+u.ToDatePicker.Date.ToString("dd MMM yyyy")+"'";else if("FUTURE"==u.Condition.SelectedValue||"PAST"==u.Condition.SelectedValue){var c,h;if(0==(c=s.e.Int(u.FromValue.TextBox.Text))&&(c=1),h=""!=u.FromValue.ComboBox.SelectedValue?u.FromValue.ComboBox.SelectedValue:"Days",l+=" BETWEEN ","Days"==h)"FUTURE"==u.Condition.SelectedValue?(l+="'"+Date.Today().ToString("dd MMM yyyy")+"' AND ",l+="'"+Date.Today().AddDays(c).ToString("dd MMM yyyy")+"'"):(l+="'"+Date.Today().AddDays(-c).ToString("dd MMM yyyy")+"' AND ",l+="'"+Date.Today().ToString("dd MMM yyyy")+"'");else if("Weeks"==h)304!=o.Report.ReportID&&305!=o.Report.ReportID||!i.a.IsMobile||(l+="'"+Date.Today().ToString("dd MMM yyyy")+"' AND ",l+="'"+Date.Today().AddDays(7).ToString("dd MMM yyyy")+"'");else if("Months"==h)if("FUTURE"==u.Condition.SelectedValue){var d=Date.Today().AddMonths(c);d=new Date(d.getFullYear(),d.getMonth(),1),l+="'"+d.ToString("dd MMM yyyy")+"' AND ",d=d.AddMonths(c).AddDays(-1),l+="'"+d.ToString("dd MMM yyyy")+"'"}else{var T=Date.Today().AddMonths(-c);T=new Date(T.getFullYear(),T.getMonth(),1),l+="'"+T.ToString("dd MMM yyyy")+"' AND ",T=T.AddMonths(c).AddDays(-1),l+="'"+T.ToString("dd MMM yyyy")+"'"}else if("Quarter"==h)if("FUTURE"==u.Condition.SelectedValue){var y=Date.Today().AddMonths(3*c);y=new Date(y.getFullYear(),y.getMonth()-(y.getMonth()-1)%3,1),l+="'"+y.ToString("dd MMM yyyy")+"' AND ",y=y.AddMonths(3*c).AddDays(-1),l+="'"+y.ToString("dd MMM yyyy")+"'"}else{var m=Date.Today().AddMonths(3*-c);m=new Date(m.getFullYear(),m.getMonth()-(m.getMonth()-1)%3,1),l+="'"+m.ToString("dd MMM yyyy")+"' AND ",m=m.AddMonths(3*c).AddDays(-1),l+="'"+m.ToString("dd MMM yyyy")+"'"}else if("Year"==h)if("FUTURE"==u.Condition.SelectedValue){var A=Date.Today().AddYears(c);A=new Date(A.getFullYear(),0,1),l+="'"+A.ToString("dd MMM yyyy")+"' AND ",A=A.AddYears(c-1),A=new Date(A.getFullYear(),11,31),l+="'"+A.ToString("dd MMM yyyy")+"'"}else{var p=Date.Today().AddYears(1-c);p=new Date(p.getFullYear(),0,1),u.FromDatePicker.Date=p,u.ToDatePicker.Date=Date.Today(),l+="'"+p.ToString("dd MMM yyyy")+"' AND ",l+="'"+Date.Today().ToString("dd MMM yyyy")+"'"}}else l+=u.Condition.SelectedItem.Parent,l+="'"+u.FromDatePicker.Date.ToString("dd MMM yyyy")+"'"}else if("Between"==u.Condition.SelectedValue||"NotBetween"==u.Condition.SelectedValue)if(u.FromValue.Visible){if(s.e.IsEmpty(u.FromValue.TextBox.Text)&&s.e.IsEmpty(u.ToValue.Text))return"continue";l+=" AND ",l+=u.CDGDO.ActualColumn,l+=u.Condition.SelectedItem.Parent,l+="'"+u.FromValue.TextBox.Text+"' AND ",l+="'"+u.ToValue.Text+"'"}else{if(s.e.IsEmpty(u.FromList.Text)&&s.e.IsEmpty(u.ToList.Text))return"continue";l+=" AND ",l+=u.CDGDO.ActualColumn,l+=u.Condition.SelectedItem.Parent,l+="'"+u.FromList.Text+"' AND ",l+="'"+u.ToList.Text+"'"}else if("Contains"==u.Condition.SelectedValue||"NotContain"==u.Condition.SelectedValue){if(s.e.IsEmpty(u.FromValue.TextBox.Text))return"continue";l+=" AND ",l+=u.CDGDO.ActualColumn,l+=u.Condition.SelectedItem.Parent,l+="'%"+u.FromValue.TextBox.Text+"%'"}else if(u.FromValue.Visible){if(s.e.IsEmpty(u.FromValue.TextBox.Text))return"continue";l+=" AND ",l+=u.CDGDO.ActualColumn,"Equal"==u.Condition.SelectedValue&&u.FromValue.TextBox.Text.startsWith("'")&&u.FromValue.TextBox.Text.endsWith("'")?u.FromValue.TextBox.Text.Contains("','")?l+=" IN ("+u.FromValue.TextBox.Text+")":l+=u.Condition.SelectedItem.Parent+u.FromValue.TextBox.Text:(l+=u.Condition.SelectedItem.Parent,l+="'"+u.FromValue.TextBox.Text+"'")}else if(u.FromList.CCID>0){if(0==u.FromList.SelectedValue&&3!=u.FromList.CCID)return"continue";l+=" AND ",l+=u.CDGDO.ActualColumn,l+=u.Condition.SelectedItem.Parent,l+=u.FromList.SelectedValue}}else if(a.startsWith("CC_")){var E,N=0;a.startsWith("CC_44_")?(E=44,N=s.e.Int(a.substr(6))):E=s.e.Int(a.substr(3));var S=null;if(t=e.Filter.CostCenterFilters.find((function(e){return e.CostCenterID==E&&e.LookupTypeID==N})),null!=C.attributes.PRID&&(S=e.Filter.CostCenterFilters.find((function(e){return 50==e.CostCenterID&&e.LookupTypeID==parseInt(C.attributes.PRID.value)}))),null==S&&null!=t){if(t.SelectedNodes.length>0||!t.DeleteButtonVisibility)if(r="",n.IsGroupTree(t)&&t.DeleteButtonVisibility){for(var O=0;O<t.SelectedNodes.length;O++)null!=t.SelectedNodes[O].Parent&&t.SelectedNodes[O].Parent.IsSelected||(r.length>0&&(r+=","),r+=t.SelectedNodes[O].Id);var g,F;0==r.length&&(r+=-12912),l+=" AND ",l+=C.attributes.Column.value+" IN (",e.drrCCTbl=e.FieldsDialog.CostCenterTables.filter((function(e){return e.FeatureID==t.CostCenterID})),g=e.drrCCTbl[0].PK.toString(),F=e.drrCCTbl[0].TableName.toString(),l+="select T."+g+" from "+F+" T with(nolock),"+F+" GT with(nolock) where T.lft between GT.lft and GT.rgt and GT."+g+" IN ("+r.toString()+") group by T."+g,l+=")"}else{for(var f=0;f<t.SelectedNodes.length;f++)t.SelectedNodes[f].IsGroup||0==t.SelectedNodes[f].Id||(r.length>0&&(r+=","),r+=t.SelectedNodes[f].Id);0==r.length&&(r+=-12912),l+=" AND ",l+=C.attributes.Column.value+" IN (",l+=r.toString(),l+=")"}}else if(null!=S){r="";for(var R=new Array,P=0;P<S.SelectedNodes.length;P++)0==S.SelectedNodes[P].Id||R.Contains(S.SelectedNodes[P].Id)||(r.length>0&&(r+=","),r+=S.SelectedNodes[P].Id,R.push(S.SelectedNodes[P].Id));S.DeleteButtonVisibility||0!=r.length||(r+=-12912),0!=r.length&&(l+=" AND ",l+=C.attributes.Column.value+" IN (",l+=r.toString(),l+=")")}}else"Employee_Filter"==a&&(s.e.IsEmpty(i.a.SessionManager.sWHEmpFilteredEmpSeqNos)||(i.a.SessionManager.LocationID>0&&i.a.SessionManager.Preferences.ContainsKey("LocationWiseDimension")&&i.a.SessionManager.Preferences.LocationWiseDimension.split(",").Contains("50051")&&(l+=" AND ",l+=C.attributes.Column.value+" IN (Select NodeID From Com_CCCCData with(nolock) where CostCenterID=50051 and CCNID2="+i.a.SessionManager.LocationID+")"),l+=" AND ",l+=e.PayrollWidgetEmpID>0?C.attributes.Column.value+" in ("+e.PayrollWidgetEmpID+")":C.attributes.Column.value+" in ("+i.a.SessionManager.sWHEmpFilteredEmpSeqNos+")"))},d=0;d<I.length;d++)h(d);e.FinalQuery=e.FinalQuery.Replace(c.attributes.Name.value,l.toString())}}(),this.DocumentFilters.ContainsKey("CRM_Cases_DocumentsTab")&&(this.FinalQuery=this.FinalQuery.Replace("@CRM_Cases_DocumentsTab@",this.DocumentFilters.CRM_Cases_DocumentsTab)),this.DocumentFilters.ContainsKey("CRM_CasesRef_DocumentsTab")&&(this.FinalQuery=this.FinalQuery.Replace("@CRM_CasesRef_DocumentsTab@",this.DocumentFilters.CRM_CasesRef_DocumentsTab)),(this.FinalQuery.Contains("@TODATE@")||this.FinalQuery.Contains("@FROMDATE@"))&&(o.SetDatePickers(),this.FinalQuery=this.FinalQuery.Replace("@TODATE@","'"+o.ToDatePicker.Date.ToString("dd MMM yyyy")+"'"),this.FinalQuery=this.FinalQuery.Replace("@FROMDATE@","'"+o.FromDatePicker.Date.ToString("dd MMM yyyy")+"'")),this.FinalQuery.Contains("@USERID@")&&(this.FinalQuery=this.FinalQuery.Replace("@USERID@",i.a.SessionManager.UserID.toString())),this.FinalQuery.Contains("@ROLEID@")&&(this.FinalQuery=this.FinalQuery.Replace("@ROLEID@",i.a.SessionManager.RoleID.toString())),this.FinalQuery.Contains("@USERNAME@")&&(this.FinalQuery=this.FinalQuery.Replace("@ROLEID@",i.a.SessionManager.UserName)),this.FinalQuery.Contains("@SEARCHTEXT@")){var a=this.Filter.Fields.find((function(e){return null==e.CDGDO.DataType||"INT"!=e.CDGDO.DataType.toUpperCase()&&"FLOAT"!=e.CDGDO.DataType.toUpperCase()&&"DATE"!=e.CDGDO.DataType.toUpperCase()}));this.FinalQuery=this.FinalQuery.Replace("@SEARCHTEXT@",a&&null!=a.FromValue.TextBox.Text?"'"+a.FromValue.TextBox.Text+"'":"''")}if(308==o.Report.ReportID)if(i.a.SessionManager.IsEmpUser||i.a.SessionManager.IsRptManagerUser){var r=s.e.StringValue(i.a.SessionManager.Preferences.HolidaysBasedOn).split(","),l=" ",D="",C="";if(null!=r&&r.length>0)for(var u=0;u<r.length;u++)null!=r[u]&&""!=r[u]&&(D="dcCCNID"+(parseInt(r[u])-5e4)+"=",C="CC.CCNID"+(parseInt(r[u])-5e4));D.length>0&&(l=" DECLARE @WH NVARCHAR(MAX),@sQ nvarchar(max),@temp1 nvarchar(max)\n                        SET @temp1='@WH NVARCHAR(max) output'\n                        SET @sQ='\n                        SELECT @WH=''"+D+"''+CONVERT(NVARCHAR,"+C+") FROM COM_CC50051 C51 WITH(NOLOCK)\n                        JOIN COM_CCCCData CC WITH(NOLOCK) ON CC.NODEID=C51.NODEID AND CC.COSTCENTERID=50051\n                        WHERE C51.NODEID="+i.a.SessionManager.iEmployee+"'          \n                        EXEC sp_executesql @sQ,@temp1,@WH output\n                                                        \n",this.FinalQuery=l+this.FinalQuery)}else this.FinalQuery="DECLARE @WH NVARCHAR(MAX)  "+this.FinalQuery}}},{key:"SetQuery",value:function(e,t){var o,n=0;this.IsInventory=t;for(var i,a=!1,r=!1,l="",D="",C=0;C<e.length;C++){var u=e[C];if(o=u.CDGDO,33==u.ID.length)if(400==o.CategoryValue||o.CategoryValue>4e4&&o.CategoryValue<5e4){if(o.CategoryValue>4e4&&o.CategoryValue<5e4&&("COM_DocTextData"==o.Table?(this.Entities.ContainsKey(o.CategoryText)||this.Entities.push(o.CategoryText,this.Entities.Documents),i=o.CategoryText+"COM_DocTextData",this.Entities.ContainsKey(i)||this.Entities.push(i,"DOCTEXT"),a||(D+=t?" LEFT JOIN COM_DocTextData AS "+this.Entities[i]+" with(nolock) ON "+this.Entities[i]+".InvDocDetailsID="+this.Entities.Documents+".InvDocDetailsID":" LEFT JOIN COM_DocTextData AS "+this.Entities[i]+" with(nolock) ON "+this.Entities[i]+".AccDocDetailsID="+this.Entities.Documents+".AccDocDetailsID"),a=!0,o.ParentCDGDO=new c.a):"COM_DocNumData"!=o.Table&&"PAY_DocNumData"!=o.Table||(this.Entities.ContainsKey(o.CategoryText)||this.Entities.push(o.CategoryText,this.Entities.Documents),i=o.CategoryText+o.Table,this.Entities.ContainsKey(i)||this.Entities.push(i,"DOCNUM"),r||(D+=t?" LEFT JOIN "+o.Table+" AS "+this.Entities[i]+" with(nolock) ON "+this.Entities[i]+".InvDocDetailsID="+this.Entities.Documents+".InvDocDetailsID":" LEFT JOIN "+o.Table+" AS "+this.Entities[i]+" with(nolock) ON "+this.Entities[i]+".AccDocDetailsID="+this.Entities.Documents+".AccDocDetailsID"),r=!0,o.ParentCDGDO=new c.a)),o.ColumnCostCenterID>0&&o.ParentTableAlias.Contains("_CCMAP"))this.Entities.ContainsKey(o.CategoryText)||(this.Entities.push(o.CategoryText,"T"+n),n++,D+=" LEFT JOIN "+o.ParentCostCenterSysName+" AS "+this.Entities[o.CategoryText]+" with(nolock) ON "+this.Entities[o.CategoryText]+"."+o.ParentCostCenterColSysName+"=DCC."+o.ParentColumn);else if(o.IsForeignKey){this.Entities.ContainsKey(o.CategoryText)||(i="T"+ ++n,this.Entities.push(o.CategoryText,i),0==s.e.stringCompare(o.ParentTable,"COM_CCCCData",!0)||(D+=" LEFT JOIN "+o.ParentCostCenterSysName+" AS "+this.Entities[o.CategoryText]+" with(nolock) ON "+this.Entities[o.CategoryText]+"."+o.ParentCostCenterColSysName+"="+this.Entities.Documents+"."+o.ParentColumn)),l+=","+this.Entities[o.CategoryText]+"."+o.Column+" AS ["+u.ID+"]";continue}try{var h=new I;h.DocID=-1,h.IsInventory=t,400==o.CategoryValue?this.SetActualColumn(o,h):0==s.e.stringCompare(o.Formula,"LATEST")||0==s.e.stringCompare(o.Formula,"OLDEST")?o.ActualColumn=this.GetLatestOldestQuery(o,"D","VENDOR"):(this.Entities.ContainsKey(o.CategoryText)||this.Entities.push(o.CategoryText,this.Entities.Documents),(h=new I).DocID=o.CategoryValue,h.IsInventory=t,this.SetActualColumn(o,h)),l+=","+o.ActualColumn,l+=" AS ["+u.ID+"]",this.SelectTagAliasOnly+=","+u.ID}catch(T){}}else if(2==o.CategoryValue){if(!this.Entities.ContainsKey(o.CategoryText))return;var d=new I;d.DocID=-1,this.SetActualColumn(o,d),this.GroupSelectTag+=","+o.ActualColumn+" AS ["+u.ID+"]",this.GroupSelectTagAlias+=","+u.ID}}this.SelectTag=l.toString(),this.FromTag=D.toString()}},{key:"SetQueryXMLTagsForPreProcessQuery",value:function(){var e=this,t=0,o="";"ReportViewModel"==this.ClassName&&(this.Report=this,this.Report.SetDatePickers(),this.Report.ProcessdOn.Visible=!1);for(var n=function(n){var i=e.Filter.CostCenterFilters[n];if(!i.IsPrePocessFilter)return"continue";var s=void 0,a="GT"+ ++t;if(e.Report.ReportID,e.drrCCTbl=e.FieldsDialog.CostCenterTables.filter((function(e){return e.FeatureID==i.CostCenterID})),e.FieldsDialog.CostCenterTables.length>0&&(s="T.PPQ"+i.CostCenterID,i.SelectedNodes.length>0||!i.DeleteButtonVisibility)){o.length>0&&(o+=" AND "),o+=s+" IN (";for(var r=0;r<i.SelectedNodes.length;r++)r>0&&(o+=","),o+=i.SelectedNodes[r].Id;0==i.SelectedNodes.length&&(o+=-12912),o+=")"}"".length>0&&(e.drrCCTbl=e.FieldsDialog.CostCenterTables.filter((function(e){return e.FeatureID==i.CostCenterID})),e.FromTag+="\r\n ,(select T."+e.drrCCTbl[0].PK.toString()+" GTID from "+e.drrCCTbl[0].TableName.toString()+" T with(nolock),"+e.drrCCTbl[0].TableName.toString()+" "+a+" with(nolock) where T.lft BETWEEN "+a+".lft AND "+a+".rgt AND "+a+"."+e.drrCCTbl[0].PK.toString()+" IN ("+"".toString()+") group by T."+e.drrCCTbl[0].PK.toString()+") AS "+a)},a=0;a<this.Filter.CostCenterFilters.length;a++)n(a);for(var r="",l="",C=0;C<this.Filter.Fields.length;C++){var u=this.Filter.Fields[C];if(r="","DATE"==u.CDGDO.DataType&&this.Filter.IsReportViewScreen&&!this.DontApplyDateFilter){var c="PPQ"+u.ID.Replace("-","");if("Between"==u.Condition.SelectedValue||"NotBetween"==u.Condition.SelectedValue)c+=u.Condition.SelectedItem.Parent,c+="'"+u.FromDatePicker.Date.ToString("dd MMM yyyy")+"' AND ",c+="'"+u.ToDatePicker.Date.ToString("dd MMM yyyy")+"'";else if("FUTURE"==u.Condition.SelectedValue||"PAST"==u.Condition.SelectedValue){u.ToDatePicker.Mode=1,u.FromDatePicker.Mode=1;var I,h=s.e.Int(u.FromValue.TextBox.Text);if(0==h&&(h=1),"Days"==(I=""!=u.FromValue.ComboBox.SelectedValue?u.FromValue.ComboBox.SelectedValue:"Days"))"FUTURE"==u.Condition.SelectedValue?(u.FromDatePicker.Date=Date.Today(),u.ToDatePicker.Date=Date.Today().AddDays(h)):(u.FromDatePicker.Date=Date.Today().AddDays(-h),u.ToDatePicker.Date=Date.Today());else if("Weeks"==I){Date.Today().getDay();var d=void 0,T=new Date;T=Date.Today().AddDays(-0),d="FUTURE"==u.Condition.SelectedValue?(T=T.AddDays(7*h)).AddDays(7*h-1):(T=T.AddDays(-7*h)).AddDays(7*h-1),u.FromDatePicker.Date=T,u.ToDatePicker.Date=d}else if("Months"==I)if("FUTURE"==u.Condition.SelectedValue){var y=Date.Today().AddMonths(h);y=new Date(y.getFullYear(),y.getMonth(),1),u.FromDatePicker.Date=y,y=y.AddMonths(h).AddDays(-1),u.ToDatePicker.Date=y}else{var m=Date.Today().AddMonths(-h);m=new Date(m.getFullYear(),m.getMonth(),1),u.FromDatePicker.Date=m,m=m.AddMonths(h).AddDays(-1),u.ToDatePicker.Date=m}else if("Quarter"==I)if("FUTURE"==u.Condition.SelectedValue){var A=Date.Today().AddMonths(3*h);A=new Date(A.getFullYear(),A.iMonth()-(A.iMonth()-1)%3-1,1),u.FromDatePicker.Date=A,A=A.AddMonths(3*h).AddDays(-1),u.ToDatePicker.Date=A}else{var p=Date.Today().AddMonths(3*-h);p=new Date(p.getFullYear(),p.iMonth()-(p.iMonth()-1)%3-1,1),u.FromDatePicker.Date=p,p=p.AddMonths(3*h).AddDays(-1),u.ToDatePicker.Date=p}else if("Year"==I)if("FUTURE"==u.Condition.SelectedValue){var E=Date.Today().AddYears(h);E=new Date(E.getFullYear(),0,1),u.FromDatePicker.Date=E,E=E.AddYears(h-1),E=new Date(E.getFullYear(),11,31),u.ToDatePicker.Date=E}else{var N=Date.Today().AddYears(1-h);N=new Date(N.getFullYear(),0,1),u.FromDatePicker.Date=N,u.ToDatePicker.Date=Date.Today()}c+=" BETWEEN ",c+="'"+u.FromDatePicker.Date.ToString("dd MMM yyyy")+"' AND ",c+="'"+u.ToDatePicker.Date.ToString("dd MMM yyyy")+"'"}else"IsNull"==u.Condition.SelectedValue||"IsNotNull"==u.Condition.SelectedValue?c+=u.Condition.SelectedItem.Parent:(c+=u.Condition.SelectedItem.Parent,c+="'"+u.FromDatePicker.Date.ToString("dd MMM yyyy")+"'");var S="";if("Between"==u.Condition.SelectedValue||"FUTURE"==u.Condition.SelectedValue||"PAST"==u.Condition.SelectedValue){var O=new Date(u.ToDatePicker.Date.getFullYear(),i.a.SessionManager.AccountingFromMonth-1,1);O>u.ToDatePicker.Date&&(O=O.AddYears(-1));var g="PPQ"+u.ID.Replace("-","");if(this.RepeatShowPrevMn){for(var F=O.AddYears(-1),f=1;f<=this.RepeatPrevData;f++){if(S+=" OR ("+g+" BETWEEN ",this.RepeatPrevDataFull)S+="'"+F.ToString("dd MMM yyyy")+"' AND ",S+="'"+F.AddYears(1).AddDays(-1).ToString("dd MMM yyyy")+"'",F=F.AddYears(-1);else if(this.RepeatPrevDataOfCurrYr&&this.RepeatType==D.d.Monthly){var R=new Date(u.FromDatePicker.Date.getFullYear(),u.FromDatePicker.Date.getMonth(),1);S+="'"+(R=R.AddMonths(-f)).ToString("dd MMM yyyy")+"' AND ",S+="'"+R.AddMonths(1).AddDays(-1).ToString("dd MMM yyyy")+"'"}else S+="'"+u.FromDatePicker.Date.AddYears(-f).ToString("dd MMM yyyy")+"' AND ",S+="'"+u.ToDatePicker.Date.AddYears(-f).ToString("dd MMM yyyy")+"'";S+=")"}this.RepeatEmptyColumns=1}this.BaseReportColumns.find((function(e){return!s.e.IsEmpty(e.Formula.Text)&&e.Formula.Text.Contains("PRV_YEARSTART")}))||this.ReportGroups.find((function(e){return!s.e.IsEmpty(e.Formula.Text)&&e.Formula.Text.Contains("PRV_YEARSTART")}))?(this.PrevDateColumsUsed=!0,S+=" OR ("+g+" BETWEEN ",S+="'"+O.AddYears(-1).ToString("dd MMM yyyy")+"' AND ",S+="'"+O.AddDays(-1).ToString("dd MMM yyyy")+"'",S+=")"):(this.BaseReportColumns.find((function(e){return!s.e.IsEmpty(e.Formula.Text)&&e.Formula.Text.Contains("PRV_YEARFROMDATE")}))||this.ReportGroups.find((function(e){return!s.e.IsEmpty(e.Formula.Text)&&e.Formula.Text.Contains("PRV_YEARFROMDATE")}))||this.BaseReportColumns.find((function(e){return!s.e.IsEmpty(e.Formula.Text)&&e.Formula.Text.Contains("PRV_YEARTODATE")}))||this.ReportGroups.find((function(e){return!s.e.IsEmpty(e.Formula.Text)&&e.Formula.Text.Contains("PRV_YEARTODATE")})))&&(this.PrevDateColumsUsed=!0,S+=" OR ("+g+" BETWEEN ",S+="'"+u.FromDatePicker.Date.AddYears(-1).ToString("dd MMM yyyy")+"' AND ",S+="'"+u.ToDatePicker.Date.AddYears(-1).ToString("dd MMM yyyy")+"'",S+=")")}S.length>0?(r+="(("+c+")",r+=S.toString(),r+=")"):r+=c}r.length>0&&(u.QuickSearchField.IsChecked?(l.length>0&&(l+=" OR "),l+=r):(o.length>0&&(o+=" AND "),o+=r))}this.FinalQuery="select * from PACT2C"+i.a.SessionManager.CompanyIndex+"_TEMP.dbo.RPT_TBL"+this.Report.ReportID+" T with(nolock)",o.length>0&&(this.FinalQuery+=" where "+o.toString()),null!=this.Report&&i.a.report.ReportDataSetAsync("RPT022",this.Report.IsReportDB,"select convert(datetime,ProcessedOn) ProcessedOn from adm_revenureports with(nolock) where ReportID="+this.Report.ReportID).then((function(t){var o=t.Tables[0];o.length>0&&(e.Report.ProcessdOn.Label="[Processed On "+new Date(o[0].ProcessedOn).ToString(i.a.SessionManager.Preferences["Date Format"]+" hh:mm a")+"]",e.Report.ProcessdOn.Visible=!0)}))}},{key:"ApplyParentReportFilters",value:function(){var e=this;if(null!=this.oReportDialog&&null!=this.oReportDialog.ParentReportDateFilter)this.oReportDialog.FromDate=this.oReportDialog.ParentReportDateFilter.FromDatePicker,this.oReportDialog.ToDate=this.oReportDialog.ParentReportDateFilter.ToDatePicker;else if(null!=this.ParentReport&&null!=this.ParentReport.oReportDialog){var t=this.Filter.Fields.find((function(e){return e.Temp&&"STATIC DATE FILTER"==s.e.String(e.Temp)}));if(t){if(this.ParentReport.oReportDialog.FromDate.Visible)t.FromDatePicker=this.ParentReport.oReportDialog.FromDate;else{if("MMM-yyyy"==this.ParentReport.oReportDialog.ToDate.CustomFormat)return t.FromDatePicker.Date=new Date(this.ParentReport.oReportDialog.ToDate.Date.getFullYear(),this.ParentReport.oReportDialog.ToDate.Date.getMonth(),1),void(t.ToDatePicker.Date=t.FromDatePicker.Date.AddMonths(1).AddDays(-1));t.FromDatePicker=this.ParentReport.oReportDialog.ToDate,t.Condition.SelectedValue="LessthanOrEqual",t.Condition.SetSelectedItem("LessthanOrEqual")}this.ParentReport.oReportDialog.ToDate.Visible&&(t.ToDatePicker=this.ParentReport.oReportDialog.ToDate)}}for(var o=function(t){var o=e.Filter.CostCenterFilters[t];o.ParentReportFilterCostCenterID>0&&((i=e.ParentReport.Filter.CostCenterFilters.find((function(e){return e.CostCenterID==o.ParentReportFilterCostCenterID})))||null==e.ParentReport.oReportDialog||(i=e.ParentReport.oReportDialog.CostCenterFilters.find((function(e){return e.CostCenterID==o.ParentReportFilterCostCenterID}))),i&&(o.SelectedNodes=i.SelectedNodes,null!=e.oReportDialog&&e.oReportDialog.TreeCCID==o.CostCenterID&&(e.oReportDialog.DefaultTreeSelectedNodes=o.SelectedNodes)))},n=0;n<this.Filter.CostCenterFilters.length;n++){var i;o(n)}}},{key:"SetActualColumn",value:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=!1,a=e.Column,r=e.CategoryText;if(null!=e.ParentCDGDO&&(r+=e.Table),"Shipping_Address"!=e.Table&&"Billing_Address"!=e.Table){64!=e.ParentCCDefaultColID&&65!=e.ParentCCDefaultColID||(r+="_MAXMIN");var l=!1;if(Math.abs(e.CategoryValue)>4e4&&Math.abs(e.CategoryValue)<5e4)if(e.CategoryValue>0)e.CategoryValue!=Math.abs(t.DocID)&&(l=!0);else if(e.CategoryValue!=t.ParentDocID)l=!0;else if(e.CategoryValue!=t.DocID&&(e.Column.startsWith("dcNum")||e.Column.startsWith("dcCalcNum")||e.Column.startsWith("dcAlpha")))if(t.dvCommon=t.dvCommonTable.filter((function(o){return o.CostCenterID==t.DocID&&o.CostCenterColID==e.FieldValue})),t.dvCommon.length>0){var D;a=t.dvCommon[0].SysColumnName.toString(),D&&(!s.e.IsEmpty(e.ALLOtherDocuments)&&e.ALLOtherDocuments.Contains((-t.DocID).toString())?!e.Column.startsWith("dcAlpha")&&e.ALLOtherDocuments.Contains(-t.DocID+"~1")&&(n=!0):(a="",l=!0))}else l=!0;if(l||400!=e.CategoryValue)if(!l&&s.e.StringValue(e.Column).startsWith("dcAlpha")&&(402==e.CategoryValue||Math.abs(e.CategoryValue)>4e4&&Math.abs(e.CategoryValue)<5e4)){if(0!=e.ColumnCostCenterID&&44!=e.ColumnCostCenterID){var C,u,c;if(e.ActualTable=this.Entities[r],s.e.IsEmpty(e.ParentCostCenterSysName)){var I=i.a.report.GetTableColumns(e.ColumnCostCenterID);C=I.TableName,u=I.PrimaryKey,c=I.ColumnName}else C=e.ParentCostCenterSysName,u=e.ParentCostCenterColSysName,c=e.ParentColumn;return void(e.ActualColumn="(select "+c+" from "+C+" with(nolock) where "+u+"="+this.Entities[r]+"."+e.Column+")")}if(null!=o&&"5"==o.LinkType.SelectedValue)return this.sbQuery+="(select [GUID]+'.'+FileExtension from COM_Files WITH(NOLOCK) WHERE FeatureID="+(this.IsInventory?"INV":"ACC")+".CostCenterID AND FeaturePK="+(this.IsInventory?"INV":"ACC")+".DocID and (IsDefaultImage=100 or (IsDefaultImage=0 and "+(this.IsInventory?"INV":"ACC")+".DocSeqNo =RowSeqNo)) and ColName='"+e.Column+"')"+o.ID+"_ID,",void(e.ActualColumn="(select ActualFileName from COM_Files WITH(NOLOCK) WHERE FeatureID="+(this.IsInventory?"INV":"ACC")+".CostCenterID AND FeaturePK="+(this.IsInventory?"INV":"ACC")+".DocID and (IsDefaultImage=100 or (IsDefaultImage=0 and "+(this.IsInventory?"INV":"ACC")+".DocSeqNo =RowSeqNo)) and ColName='"+e.Column+"')")}else{if(!l&&null!=o&&"5"==o.LinkType.SelectedValue&&e.Column.Contains("Alpha")&&(Math.abs(e.CategoryValue)<4e4||Math.abs(e.CategoryValue)>5e4))return this.drrCCTbl=this.FieldsDialog.CostCenterTables.filter((function(t){return t.FeatureID==e.CategoryValue})),this.sbQuery+="(select [GUID]+'.'+FileExtension from COM_Files WITH(NOLOCK) WHERE FeatureID="+e.CategoryValue+" AND FeaturePK="+this.Entities[e.CategoryText.split(".")[0]]+"."+this.drrCCTbl[0].PK.toString()+" and IsDefaultImage=100 and ColName='"+e.Column+"')"+o.ID+"_ID,",void(e.ActualColumn="(select ActualFileName from COM_Files WITH(NOLOCK) WHERE FeatureID="+e.CategoryValue+" AND FeaturePK="+this.Entities[e.CategoryText.split(".")[0]]+"."+this.drrCCTbl[0].PK.toString()+" and IsDefaultImage=100 and ColName='"+e.Column+"')");if(144==e.CategoryValue&&(e.Column.startsWith("Alpha")||null!=e.ParentColumn&&e.ParentColumn.startsWith("CCNID"))){if(0==e.LocalReference){var h=i.a.report.GetDataTable("RPT036",e.FieldValue.toString());h.length>0&&h[0].LocalReference&&(e.LocalReference=parseInt(h[0].LocalReference))}var d=this.GetKeyWordColumn(e,t);return e.ActualTable=this.Entities[r],e.ActualColumn=null!=e.ParentColumn&&e.ParentColumn.startsWith("CCNID")?0==e.LocalReference?"(CASE WHEN "+this.Entities[e.ParentTableAlias]+"."+e.ParentColumn+"> 0  THEN ":"(CASE WHEN "+this.Entities[e.ParentTableAlias]+".CostCenterID="+e.LocalReference+" THEN ":"(CASE WHEN "+e.ActualTable+".CostCenterID="+e.LocalReference+" THEN ",s.e.IsEmpty(d)?e.ActualColumn+="DATE"==e.DataType?"CONVERT(DATETIME,"+this.Entities[r]+"."+a+")":this.Entities[r]+"."+a:e.ActualColumn+="("+d+")",void(e.ActualColumn+=" ELSE NULL END)")}if(144==e.CategoryValue&&65==e.ParentCostCenterID||144==e.ParentCostCenterID&&null!=e.ChildCDGDO&&65==e.ChildCDGDO.ParentCostCenterID)return void(e.ActualColumn=144==e.ParentCostCenterID&&null!=e.ChildCDGDO&&65==e.ChildCDGDO.ParentCostCenterID?"(CASE WHEN "+this.Entities[e.CategoryText]+".contactid is null then null else (select "+e.ChildCDGDO.Column+" from com_contacts with(nolock) where contactid="+this.Entities[e.CategoryText]+".contactid) END)":"(CASE WHEN "+this.Entities[e.ParentTableAlias]+".contactid is null then null else (select "+e.Column+" from com_contacts with(nolock) where contactid="+this.Entities[e.ParentTableAlias]+".contactid) END)");if(144==e.CategoryValue&&(27295==e.FieldValue||27296==e.FieldValue))return void(27295==e.FieldValue?e.ActualColumn="(CASE WHEN ("+this.Entities[r]+".InviteRefActID=0 OR "+this.Entities[r]+".InviteRefActID IS NULL) then "+this.Entities[r]+".CreatedBy    END)":27296==e.FieldValue&&(e.ActualColumn="U.UserName"));if(s.e.StringValue(e.Column).startsWith("dcPOSRemarks"))return void(e.ActualColumn="STUFF((SELECT ', '+C.Symbol+' '+convert(nvarchar,P.AmountFC)+' @ '+convert(nvarchar,P.ExchangeRate) \nFROM COM_PosPayModes P with(nolock) \nleft join COM_Currency C with(nolock) on C.CurrencyID=P.Currency\nwhere P.DocID=INV.DocID and P.DBColumnName='"+e.Column.Replace("POSRemarks","")+"' FOR XML PATH('')),1,1,'')")}else this.IsInventory&&this.AccDocumentFields.Contains(e.FieldValue)?this.ShowOnlyAccountingData&&t.ShowAccountingData||(l=!0):!this.IsInventory&&this.InvDocumentFields.Contains(e.FieldValue)?l=!0:207!=e.FieldValue||t.ShowAccountingData||(l=!0);e.ActualTable="",l?e.ActualColumn="NULL":null!=e.ChildCDGDO?(a=e.ChildCDGDO.Column,r=e.ChildCDGDO.CategoryText,e.ChildCDGDO.ActualColumn=this.GetKeyWordColumn(e.ChildCDGDO,t),0==e.ChildCDGDO.ActualColumn.length&&this.Entities.ContainsKey(r)&&(e.ActualTable=this.Entities[r],e.ChildCDGDO.ActualColumn="DATE"==e.ChildCDGDO.DataType?"CONVERT(DATETIME,"+this.Entities[r]+"."+a+")":this.Entities[r]+"."+a),e.ActualColumn=e.ChildCDGDO.ActualColumn):(e.ActualColumn=this.GetKeyWordColumn(e,t),0==e.ActualColumn.length&&this.Entities.ContainsKey(r)&&(e.ActualTable=this.IsInventory&&this.ShowOnlyAccountingData&&t.ShowAccountingData&&this.AccDocumentFields.Contains(e.FieldValue)?"ACC":this.Entities[r],"DATE"==e.DataType?e.ActualColumn=a.startsWith("dcAlpha")?"case when isdate("+e.ActualTable+"."+a+")=1 and isNumeric("+e.ActualTable+"."+a+")=0 then CONVERT(DATETIME,"+e.ActualTable+"."+a+") else null end":"CONVERT(DATETIME,"+e.ActualTable+"."+a+")":this.ShowDebitCreditAmount&&t.ShowAccountingData&&206==e.FieldValue&&t.IsDebit||this.ShowDebitCreditAmount&&t.ShowAccountingData&&205==e.FieldValue&&!t.IsDebit?e.ActualColumn="NULL":this.ShowDebitCreditAmount&&t.ShowAccountingData&&23825==e.FieldValue?e.ActualColumn=t.IsDebit?e.ActualTable+"."+a:"-"+e.ActualTable+"."+a:e.CategoryValue>=405&&e.CategoryValue<=408?t.IsInventory?405==e.CategoryValue?e.ActualColumn=a.startsWith("xEarningType")?"(select Name from "+e.ActualTable+".Remarks.nodes('/XML/Component[@ComponentID=''"+a.Replace("xEarningType","")+"'']') as Data(X) join com_lookup L with(nolock) on X.value('EarDedType[1]','nvarchar(max)')=L.NodeID)":"case when INV.VoucherType=11 then "+e.ActualTable+"."+a+" else null end":406==e.CategoryValue?e.ActualColumn=a.startsWith("xDeductionType")?"(select Name from "+e.ActualTable+".Remarks.nodes('/XML/Component[@ComponentID=''"+a.Replace("xDeductionType","")+"'']') as Data(X) join com_lookup L with(nolock) on X.value('EarDedType[1]','nvarchar(max)')=L.NodeID)":"case when INV.VoucherType=12 then "+e.ActualTable+"."+a+" else null end":407==e.CategoryValue?e.ActualColumn="case when INV.VoucherType=13 then "+e.ActualTable+"."+a+" else null end":408==e.CategoryValue&&(e.ActualColumn="case when INV.VoucherType=14 then "+e.ActualTable+"."+a+" else null end"):e.ActualColumn="NULL":2==e.ParentCostCenterID&&("CreditLimit"==a||"DebitLimit"==a||"CreditDays"==a||"DebitDays"==a)&&this.Entities.values.Contains("TDCC")&&i.a.SessionManager.Preferences.DimWiseCreditDebit.length>0&&parseInt(i.a.SessionManager.Preferences.DimWiseCreditDebit)>5e4?e.ActualColumn="isnull((select "+a.Replace("Limit","Amount")+" from Acc_CreditDebitAmount with(nolock) where AccountID="+e.ActualTable+".AccountID and DimensionID=TDCC.dcCCNID"+(parseInt(i.a.SessionManager.Preferences.DimWiseCreditDebit)-5e4)+"),"+e.ActualTable+"."+a+")":166==e.CategoryValue&&"PolicyType"==a?e.ActualColumn="case "+e.ActualTable+"."+a+" when 1 then 'Dispose Full' when 2 then 'Sale Partial' when 3 then 'Sale Full' else 'Dispose Partial' end":this.StaticReportType>0&&113==e.ParentCostCenterID&&"Status"==e.Column&&this.Report.Preferences.ContainsKey("ReplaceStatus")?e.ActualColumn="case when "+e.ActualTable+".StatusID=429 then case when "+this.Entities.Documents+".BillDate=1 then 'Replace' when "+this.Entities.Documents+".BillDate=1 then 'Partial Replace' else 'Bounced' end else "+e.ActualTable+"."+a+" end":40054==e.CategoryValue&&a.toUpperCase().startsWith("DCALPHA")?(e.ActualColumn="case when INV.VoucherType=11 then "+e.ActualTable+"."+a+" else null end",n&&(e.ActualColumn="-"+e.ActualColumn),this.Filter.Fields.forEach((function(t){t.CDGDO.Column.toUpperCase()==a.toUpperCase()&&(e.ActualColumn=e.ActualTable+"."+a,n&&(e.ActualColumn="-"+e.ActualColumn))}))):(e.ActualColumn=e.ActualTable+"."+a,n&&(e.ActualColumn="-"+e.ActualColumn))))}else{var T="Shipping_Address"==e.Table?"3":"2";s.e.IsEmptySpace(e.ParentTableAlias)?(this.drrCCTbl=this.FieldsDialog.CostCenterTables.filter((function(t){return t.FeatureID==e.CategoryValue})),e.ActualColumn="(select "+this.GetAddressColumn(e.Column.substr(5))+" from COM_ADDRESS with(nolock) where AddressID=(select min(AddressID) from COM_ADDRESS with(nolock) where AddressTypeID="+T+" and FeatureID="+e.CategoryValue+" AND "+this.Entities[e.CategoryText]+"."+this.FieldsDialog.CostCenterTables[0].PK.toString()+"=FeaturePK))"):e.ActualColumn="(select "+this.GetAddressColumn(e.Column.substr(5))+" from COM_ADDRESS with(nolock) where AddressID=(select min(AddressID) from COM_ADDRESS with(nolock) where AddressTypeID="+T+" and FeatureID="+e.ParentCostCenterID+" AND "+this.Entities[e.ParentTableAlias]+"."+e.ParentColumn+"=FeaturePK))"}}},{key:"SetActualColumn_1",value:function(e){var t=e.CategoryText;if(null!=e.ParentCDGDO&&(t+=e.Table),e.ActualTable=this.Entities[t],e.CategoryValue>=40001&&e.CategoryValue<5e4){if(e.ActualColumn="CASE WHEN ",e.ActualColumn+=e.IsForeignKey?this.Entities[e.ParentTableAlias.Replace("_CCMAP","")]:this.Entities[e.CategoryText],e.ActualColumn+=".CostCenterID="+e.CategoryValue,"DATE"==e.DataType&&e.Column.startsWith("dcAlpha")&&(e.ActualColumn+=" and isdate("+this.Entities[t]+"."+e.Column+")=1"),e.ActualColumn+=" THEN ","DATE"==e.DataType)e.ActualColumn+="CONVERT(DATETIME,"+this.Entities[t]+"."+e.Column+")";else if(e.Column.startsWith("dcAlpha"))if(0!=e.ColumnCostCenterID&&44!=e.ColumnCostCenterID){var o,n,a;if(e.ActualTable=this.Entities[t],s.e.IsEmpty(e.ParentCostCenterSysName)){var r=i.a.report.GetTableColumns(e.ColumnCostCenterID);o=r.TableName,n=r.PrimaryKey,a=r.ColumnName}else o=e.ParentCostCenterSysName,n=e.ParentCostCenterColSysName,a=e.ParentColumn;e.ActualColumn+="(select "+a+" from "+o+" with(nolock) where "+n+"="+this.Entities[t]+"."+e.Column+")"}else e.ActualColumn+=this.Entities[t]+"."+e.Column;else e.ActualColumn+=this.Entities[t]+"."+e.Column;e.ActualColumn+=" ELSE NULL END"}else e.ActualColumn="DATE"==e.DataType?"CONVERT(DATETIME,"+this.Entities[t]+"."+e.Column+")":this.Entities[t]+"."+e.Column}},{key:"GetKeyWordColumn",value:function(e,t){var o=this,a="ACC";if(t.IsInventory&&(a="INV"),t.IsInventory)if(11361==e.FieldValue||11415==e.FieldValue||27266==e.FieldValue||182==e.FieldValue){if(0==this.StaticReportType&&!s.e.IsEmpty(e.ALLOtherDocuments)&&!e.ALLOtherDocuments.Contains(t.AbsDocID.toString()))return"null";var l=e.ExecutedDocument,D="",C=null,u=null,c=!1,I=!1;if("ReportViewModel"==this.ClassName&&(null!=this.ToDatePicker&&(this.ToDatePicker.Visible||this.FromDatePicker.Dependantinuse)&&(C=this.ToDatePicker.Date),null!=this.FromDatePicker&&(this.FromDatePicker.Visible||this.FromDatePicker.Dependantinuse)&&(u=this.FromDatePicker.Date),this.Preferences.ContainsKey("ExeQty_ConsiderDocDate")?D=null!=C&&C?",null,'"+C.ToString("dd MMM yyyy")+"'":",null,null":"FOR_PERIOD"==e.Formula?(D=null!=u&&u?",'"+u.ToString("dd MMM yyyy")+"'":",null",D+=null!=C&&C?",'"+C.ToString("dd MMM yyyy")+"'":",null"):"AFTER_PERIOD"==e.Formula?null!=C&&C?(u=C.AddDays(1),C=null,D=",'"+u.ToString("dd MMM yyyy")+"',null"):(u=null,D=",null,null"):D=",null,null",this.Preferences.ContainsKey("ExeQty_DontShowUnApproved")?(c=!0,D+=",1"):(c=!1,D+=",0"),this.Preferences.ContainsKey("ExeQty_ConsiderRejected")?(I=!0,D+=",1"):(I=!1,D+=",0"),!s.e.IsEmptySpace(e.ExecutedDocument)&&l.Contains(",")&&(l="",n.dtExDocs.ContainsKey(Math.abs(t.DocID))||n.dtExDocs.push(Math.abs(t.DocID),i.a.report.GetReportDetails(4,Math.abs(t.DocID)).Tables[0]),n.dtExDocs[Math.abs(t.DocID)].forEach((function(t){e.ExecutedDocument.Contains(t.CostCenterID.toString())&&(l.length>0&&(l+=","),l+=t.CostCenterID.toString())})),0==l.length&&(l="-123"))),11361==e.FieldValue){if(this.IsNewFromClause&&this.Filter.IsReportViewScreen&&this.Report.Preferences.ContainsKey("ExeQty_TblFunCall")&&(D+=null!=u&&u?",'"+u.ToString("dd MMM yyyy")+"'":",null",D+=null!=C&&C?",'"+C.ToString("dd MMM yyyy")+"'":",null"),s.e.IsEmptySpace(l)){var h="";return Math.abs(t.DocID)>4e4&&Math.abs(t.DocID)<5e4&&t.IsInventory&&(h=i.a.report.GetExecutedQtyQuery(0,Math.abs(t.DocID).toString(),u,C,c,I)).Contains("NUM.")&&0==this.StaticReportType&&null!=(ce=this.Entities.keys.find((function(e){return e.endsWith("COM_DocNumData")})))&&(h=h.Replace("NUM.",this.Entities[ce]+".")),s.e.IsEmpty(h)?"0":h}return l.Contains(",")?this.IsNewFromClause&&this.Filter.IsReportViewScreen&&this.Report.Preferences.ContainsKey("ExeQty_TblFunCall")?(++this.ExQCnt,this.FromTagExtra+=" left join dbo.fnRPT_ExeQtyByDocsNewAll("+Math.abs(t.DocID)+",'"+l+"'"+D+") ExQ"+this.ExQCnt+" on ExQ"+this.ExQCnt+".InvDocDetailsID=INV.InvDocDetailsID",e.ActualTable="ExQ"+this.ExQCnt+".ExQty","isnull(ExQ"+this.ExQCnt+".ExQty,0)"):"dbo.fnRPT_ExeQtyByDocsNew(INV.CostCenterID,INV.InvDocDetailsID,'"+l+"'"+D+")":this.IsNewFromClause&&this.Filter.IsReportViewScreen&&this.Report.Preferences.ContainsKey("ExeQty_TblFunCall")?(++this.ExQCnt,this.FromTagExtra+=" left join dbo.fnRPT_ExeQtyByDocNewAll("+Math.abs(t.DocID)+","+l+D+") ExQ"+this.ExQCnt+" on ExQ"+this.ExQCnt+".InvDocDetailsID=INV.InvDocDetailsID",e.ActualTable="ExQ"+this.ExQCnt+".ExQty","isnull(ExQ"+this.ExQCnt+".ExQty,0)"):"dbo.fnRPT_ExeQtyByDocNew(INV.CostCenterID,INV.InvDocDetailsID,"+l+D+")"}if(11415==e.FieldValue)return this.StaticReportType>0?"dbo.fnRPT_ExeDocNosByDocNew(D.CostCenterID,D.InvDocDetailsID,'"+l+"'"+D+")":"dbo.fnRPT_ExeDocNosByDocNew(INV.CostCenterID,INV.InvDocDetailsID,'"+l+"'"+D+")";if(27266==e.FieldValue)return this.StaticReportType>0?"dbo.fnRPT_ExeDocDateByDocNew(D.CostCenterID,D.InvDocDetailsID,'"+l+"'"+D+")":"dbo.fnRPT_ExeDocDateByDocNew(INV.CostCenterID,INV.InvDocDetailsID,'"+l+"'"+D+")";if(182==e.FieldValue){var d=this.StaticReportType>0?"D":"INV",T="",y="",m=" FROM INV_DocDetails EINV with(nolock) ",A=l;if(t.AbsDocID>4e4&&t.AbsDocID<5e4&&!s.e.IsEmpty(A)&&A.Contains(t.AbsDocID.toString())){var p=(A=A.Replace(t.AbsDocID.toString(),"")).split(",");A="";for(var E=0;E<p.length;E++){var N=p[E];0!=N.length&&(A.length>0&&(A+=","),A+=N)}if(0==A.length)return"null"}if("FLOAT"==e.DataType)e.Column.startsWith("dcCalcNum")?(T="sum(ENUM."+e.Column+")",m+=" INNER JOIN COM_DocNumData ENUM WITH(NOLOCK) ON ENUM.InvDocDetailsID=EINV.InvDocDetailsID"):T="sum(EINV."+e.Column+")";else if("DATE"==e.DataType)if("ApprovalDate"==e.Column)if(null!=e.Formula&&e.Formula.startsWith("LEVEL")){var S;T=" top 1 (select convert(datetime,CreatedDate) from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID\nfrom COM_Approvals with(nolock) where RowType=1 and (StatusID=441 or StatusID=369"+(1==(S=s.e.Int(e.Formula.substr(5)))?" or StatusID=371":"")+") and ccid=EINV.costcenterid and ccnodeid=EINV.DocID AND (DocDetID=0 OR DocDetID=EINV.InvDocDetailsID) and WorkFlowLevel="+S+" order by ApprovalID desc))"}else T=" top 1 (select convert(datetime,CreatedDate) from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID\nfrom COM_Approvals with(nolock) where RowType=1 and StatusID=369 and ccid=EINV.costcenterid and ccnodeid=EINV.DocID AND (DocDetID=0 OR DocDetID=EINV.InvDocDetailsID) order by ApprovalID desc))";else T="max(EINV."+e.Column+")";else if(e.Column.startsWith("dcAlpha"))T="ETXT."+e.Column,m+=" INNER JOIN COM_DocTextData ETXT WITH(NOLOCK) ON ETXT.InvDocDetailsID=EINV.InvDocDetailsID";else if(e.Column.startsWith("CreditAccount"))T="EA.AccountName",m+=" INNER JOIN ACC_Accounts EA WITH(NOLOCK) ON EA.AccountID=EINV.CreditAccount";else if(e.Column.startsWith("DebitAccount"))T="EA.AccountName",m+=" INNER JOIN ACC_Accounts EA WITH(NOLOCK) ON EA.AccountID=EINV.DebitAccount";else if(e.Column.startsWith("Posting"))T="EA."+e.Column.substr(e.Column.length-11,11),s.e.IsEmptySpace(A)?m+=" JOIN ACC_DocDetails EACC with(nolock) on EACC.InvDocDetailsID=EINV.InvDocDetailsID INNER JOIN ACC_Accounts EA WITH(NOLOCK) ON EA.AccountID=EACC."+e.Column.substr(7,e.Column.length-11):m=" FROM ACC_DocDetails EINV with(nolock) INNER JOIN ACC_Accounts EA WITH(NOLOCK) ON EA.AccountID=EINV."+e.Column.substr(7,e.Column.length-11);else if(e.Column.startsWith("UOM"))T="U.UnitName",m+=" INNER JOIN COM_UOM U WITH(NOLOCK) ON U.UOMID=EINV.Unit";else if("ApprovalBy"==e.Column)if(null!=e.Formula&&e.Formula.startsWith("LEVEL")){var O=s.e.Int(e.Formula.substr(5));T=" top 1 (select CreatedBy from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID\nfrom COM_Approvals with(nolock) where RowType=1 and (StatusID=441 or StatusID=369"+(1==O?" or StatusID=371":"")+") and ccid=EINV.costcenterid and ccnodeid=EINV.DocID AND (DocDetID=0 OR DocDetID=EINV.InvDocDetailsID) and WorkFlowLevel="+O+" order by ApprovalID desc))"}else T=" top 1 (select CreatedBy from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID\nfrom COM_Approvals with(nolock) where RowType=1 and StatusID=369 and ccid=EINV.costcenterid and ccnodeid=EINV.DocID AND (DocDetID=0 OR DocDetID=EINV.InvDocDetailsID) order by ApprovalID desc))";else T="EINV."+e.Column;return s.e.IsEmptySpace(A)?(y=" WHERE EINV.LinkedInvDocDetailsID="+d+".InvDocDetailsID",y+=c?" and EINV.StatusID=369":" and EINV.StatusID!=376"):(m+=" INNER JOIN dbo.fnRPT_ExeDetailsIDByDoc(INV.CostCenterID,INV.InvDocDetailsID",A.Contains(",")?m+=",'"+A+"'":m+=","+A,m+=D+") AS ED  ON EINV.InvDocDetailsID=ED.DetailsID"),"FLOAT"==e.DataType||"DATE"==e.DataType||"ApprovalBy"==e.Column?T="(SELECT "+T+m+y+")":(0==y.length?y=" WHERE ":y+=" AND ",T="STUFF((SELECT distinct ', '+"+T+m+(y+=T+" is not null and "+T+"!=''")+" FOR XML PATH('')),1,2,'')"),T}}else{if(209==e.FieldValue){var g=this.StaticReportType>0?"D":"INV",F="",f=" FROM INV_DocDetails EINV with(nolock) ";if("DATE"==e.DataType)F="ApprovalDate"==e.Column?"(select convert(datetime,CreatedDate) from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID\nfrom COM_Approvals with(nolock) where RowType=1 and StatusID=369 and ccid=EINV.costcenterid and ccnodeid=EINV.DocID AND (DocDetID=0 OR DocDetID=EINV.InvDocDetailsID) order by ApprovalID desc))":"EINV."+e.Column;else if(e.Column.startsWith("dcCalcNum"))F="ENUM."+e.Column,f+=" INNER JOIN COM_DocNumData ENUM WITH(NOLOCK) ON ENUM.InvDocDetailsID=EINV.InvDocDetailsID";else if(e.Column.startsWith("dcAlpha"))F="ETXT."+e.Column,f+=" INNER JOIN COM_DocTextData ETXT WITH(NOLOCK) ON ETXT.InvDocDetailsID=EINV.InvDocDetailsID";else if(e.Column.startsWith("CreditAccount"))F="EA.AccountName",f+=" INNER JOIN ACC_Accounts EA WITH(NOLOCK) ON EA.AccountID=EINV.CreditAccount";else if(e.Column.startsWith("DebitAccount"))F="EA.AccountName",f+=" INNER JOIN ACC_Accounts EA WITH(NOLOCK) ON EA.AccountID=EINV.DebitAccount";else if(e.Column.startsWith("Posting"))F="EA."+e.Column.substr(e.Column.length-11,11),f+=" JOIN ACC_DocDetails EACC with(nolock) on EACC.InvDocDetailsID=EINV.InvDocDetailsID INNER JOIN ACC_Accounts EA WITH(NOLOCK) ON EA.AccountID=EACC."+e.Column.substr(7,e.Column.length-11);else if(e.Column.startsWith("UOM"))F="U.UnitName",f+=" INNER JOIN COM_UOM U WITH(NOLOCK) ON U.UOMID=EINV.Unit";else if("ApprovalBy"==e.Column)if(null!=e.Formula&&e.Formula.startsWith("LEVEL")){var R;F=" top 1 (select CreatedBy from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID\nfrom COM_Approvals with(nolock) where RowType=1 and (StatusID=441 or StatusID=369"+(1==(R=s.e.Int(e.Formula.substr(5)))?" or StatusID=371":"")+") and ccid=EINV.costcenterid and ccnodeid=EINV.DocID AND (DocDetID=0 OR DocDetID=EINV.InvDocDetailsID) and WorkFlowLevel="+R+" order by ApprovalID desc))"}else F=" top 1 (select CreatedBy from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID\nfrom COM_Approvals with(nolock) where RowType=1 and StatusID=369 and ccid=EINV.costcenterid and ccnodeid=EINV.DocID AND (DocDetID=0 OR DocDetID=EINV.InvDocDetailsID) order by ApprovalID desc))";else F="EINV."+e.Column;return F="case when "+g+".LinkedInvDocDetailsID>0 then (SELECT "+F+f+" WHERE EINV.InvDocDetailsID="+g+".LinkedInvDocDetailsID) else null end"}if(13964==e.FieldValue){var P=s.e.IsEmptySpace(e.ExecutedDocument)?"":e.ExecutedDocument;return this.StaticReportType>0?"dbo.fnRPT_RefDocQty(D.CostCenterID,D.InvDocDetailsID,'"+P+"')":"dbo.fnRPT_RefDocQty(INV.CostCenterID,INV.InvDocDetailsID,'"+P+"')"}if(11484==e.FieldValue){var b=s.e.IsEmptySpace(e.ExecutedDocument)?"":e.ExecutedDocument;return this.StaticReportType>0?"dbo.fnRPT_RefDocNos(D.CostCenterID,D.InvDocDetailsID,'"+b+"')":"dbo.fnRPT_RefDocNos(INV.CostCenterID,INV.InvDocDetailsID,'"+b+"')"}if(11514==e.FieldValue){if(s.e.IsEmptySpace(e.ExecutedDocument))return this.StaticReportType>0?"(SELECT convert(datetime,DocDate) FROM INV_DocDetails with(nolock)\tWHERE InvDocDetailsID IN \n(select LinkedInvDocDetailsID from INV_DocDetails with(nolock) WHERE InvDocDetailsID=D.InvDocDetailsID and LinkedInvDocDetailsID>0))":"(SELECT convert(datetime,DocDate) FROM INV_DocDetails with(nolock)\tWHERE InvDocDetailsID IN \n(select LinkedInvDocDetailsID from INV_DocDetails with(nolock) WHERE InvDocDetailsID=INV.InvDocDetailsID and LinkedInvDocDetailsID>0))";var V=s.e.IsEmptySpace(e.ExecutedDocument)?"":e.ExecutedDocument;return this.StaticReportType>0?"dbo.fnRPT_RefDocDate(D.CostCenterID,D.InvDocDetailsID,'"+V+"')":"dbo.fnRPT_RefDocDate(INV.CostCenterID,INV.InvDocDetailsID,'"+V+"')"}if(11362==e.FieldValue){if(this.IsInventory){var v="",M="",_=" and A.StatusID!=376";if(this.Entities.values.Contains("TDCC"))if(s.e.IsEmpty(e.DimensionsFilter)){M=" AND A.ProductID=INV.ProductID";var L=0;i.a.SessionManager.Preferences.ContainsKey("Maintain Dimensionwise stock")&&(L=s.e.Int(i.a.SessionManager.Preferences["Maintain Dimensionwise stock"])),0==L&&"True"==i.a.SessionManager.Preferences.EnableLocationWise.toString()&&"True"==i.a.SessionManager.Preferences["LW Reports"]&&(L=50002),0==L&&"True"==i.a.SessionManager.Preferences.EnableDivisionWise.toString()&&"True"==i.a.SessionManager.Preferences["DW Reports"]&&(L=50001),L>0&&(v=" AND DCC.dcCCNID"+(L-5e4)+"=TDCC.dcCCNID"+(L-5e4))}else{var w=e.DimensionsFilter.split("~");w.length>1&&""!=w[1]&&w[1].split(",").forEach((function(e){_+=" and A.StatusID!="+e})),(""==w[0]?[]:w[0].split(",")).forEach((function(e){"3"==e?M=" AND A.ProductID=INV.ProductID":v+=" AND DCC.dcCCNID"+(parseInt(e)-5e4)+"=TDCC.dcCCNID"+(parseInt(e)-5e4)}))}else M=" AND A.ProductID=INV.ProductID";return v.length>0&&(M+=v,v=" INNER JOIN COM_DOCCCDATA DCC with(nolock) ON DCC.InvDocDetailsID=A.InvDocDetailsID"),"(SELECT ISNULL(SUM(A.UOMConvertedQty*A.VoucherType),0)\tFROM INV_DocDetails A WITH(NOLOCK)"+v+"\nWHERE (A.VoucherType=1 OR A.VoucherType=-1) AND A.IsQtyIgnored=0"+_+M+")"}return"0"}if(11363==e.FieldValue)return this.IsInventory?"(SELECT ISNULL(SUM(A.UOMConvertedQty*A.VoucherType),0)\tFROM INV_DocDetails A WITH(NOLOCK)\nWHERE A.ProductID=INV.ProductID AND (A.VoucherType=1 OR A.VoucherType=-1) AND A.IsQtyIgnored=0 AND A.StatusID<>376)":"0";if(148==e.FieldValue)return this.IsInventory?"(SELECT ISNULL(SUM(A.UOMConvertedQty*A.VoucherType),0)\tFROM INV_DocDetails A WITH(NOLOCK)\nWHERE A.ProductID=INV.ProductID AND A.BatchID>1 AND A.BatchID=INV.BatchID AND (A.VoucherType=1 OR A.VoucherType=-1) AND A.IsQtyIgnored=0 AND A.StatusID<>376)":"NULL";if(11693==e.FieldValue){if(this.IsInventory){var x=this.Entities.ContainsKey("Documents")?this.Entities.Documents:"INV";return"(select convert(datetime,max(LD.DocDate)) from INV_DocDetails LD with(nolock) where LD.RefInvDocDetailsID="+x+".InvDocDetailsID and LD.BatchID="+x+".BatchID and LD.VoucherType=-1 AND LD.IsQtyIgnored=0 AND LD.ProductID="+x+".ProductID AND LD.DocDate<=@To AND LD.StatusID<>376)"}return"NULL"}if(26428==e.FieldValue)return 0==t.DocID&&this.Entities.ContainsKey("Product")?"(SELECT ISNULL(SUM(A.UOMConvertedQty*A.VoucherType),0)\tFROM INV_DocDetails A WITH(NOLOCK)\nWHERE A.ProductID="+this.Entities.Product+".ProductID AND (A.VoucherType=1 OR A.VoucherType=-1) AND A.IsQtyIgnored=0 AND A.StatusID<>376)":"0";if(208==e.FieldValue)return 0==t.DocID&&this.Entities.ContainsKey("Product")?"case when exists(select ProductID from ADM_SchemesDiscounts with(nolock) where ProductID="+this.Entities.Product+".ProductID) then 'Y' else 'N' end":this.StaticReportType>0||this.IsInventory?"case when exists(select ProductID from ADM_SchemesDiscounts with(nolock) where ProductID=D.ProductID) then 'Y' else 'N' end":"";if(170==e.FieldValue){if(0==t.DocID&&this.Entities.ContainsKey("Product")){var G,k="",B="",H=0;i.a.SessionManager.Preferences.ContainsKey("Maintain Dimensionwise stock")&&(H=s.e.Int(i.a.SessionManager.Preferences["Maintain Dimensionwise stock"])),0==H&&"True"==i.a.SessionManager.Preferences.EnableLocationWise.toString()&&"True"==i.a.SessionManager.Preferences["LW Reports"]&&(H=50002),50002==H&&i.a.SessionManager.LocationID>0&&(B=" INNER JOIN COM_DOCCCDATA DCC WITH(NOLOCK) ON DCC.InvDocDetailsID=A.InvDocDetailsID AND DCC.dcCCNID2="+i.a.SessionManager.LocationID);var W="LATEST"==e.Formula;"DATE"==e.DataType?G=(W=!0)?"top 1 convert(datetime,A."+e.Column+")":"max(convert(datetime,A."+e.Column+"))":"FLOAT"==e.DataType?(e.Column.startsWith("dcCalcNum")?(k+=" INNER JOIN COM_DocNumData NUM WITH(NOLOCK) ON NUM.InvDocDetailsID=A.InvDocDetailsID",G="NUM."+e.Column):("Rate"==e.Column&&(W=!0),G="A."+e.Column),G=W?"top 1 "+G:"ISNULL(SUM("+G+"),0)"):e.Column.startsWith("dcAlpha")?(k+=" INNER JOIN COM_DocTextData TXT WITH(NOLOCK) ON TXT.InvDocDetailsID=A.InvDocDetailsID",G="top 1 "+(G="TXT."+e.Column),W=!0):(W=!0,G="top 1 A."+e.Column);var U="(SELECT "+G+" FROM INV_DocDetails A WITH(NOLOCK)"+k+B;return U+=" WHERE A.ProductID="+this.Entities.Product+".ProductID AND A.StatusID<>376",s.e.IsEmptySpace(e.ExecutedDocument)||(e.ExecutedDocument.Contains(",")?U+=" AND A.CostCenterID IN ("+e.ExecutedDocument+")":U+=" AND A.CostCenterID="+e.ExecutedDocument),W&&(U+=" order by A.DocDate desc"),U+=")"}return"NULL"}if(25900==e.FieldValue){if(0==t.DocID&&this.Entities.ContainsKey("Product")){var K="",Q="",X=0;if(i.a.SessionManager.Preferences.ContainsKey("Maintain Dimensionwise stock")&&(X=s.e.Int(i.a.SessionManager.Preferences["Maintain Dimensionwise stock"])),0==X&&"True"==i.a.SessionManager.Preferences.EnableLocationWise.toString()&&"True"==i.a.SessionManager.Preferences["LW Reports"]&&(X=50002),50002==X&&i.a.SessionManager.LocationID>0&&(K=" AND DCC.dcCCNID2="+i.a.SessionManager.LocationID),e.ParentCCDefaultColID>5e4){var j=this.Filter.CostCenterFilters.find((function(t){return t.CostCenterID==e.ParentCCDefaultColID}));if(j&&(j.SelectedNodes.length>0||!j.DeleteButtonVisibility)){K.length>0&&(K+=" AND "),K+=" AND DCC.dcCCNID"+(e.ParentCCDefaultColID-5e4)+" IN (";for(var Y=0;Y<j.SelectedNodes.length;Y++)Y>0&&(K+=","),K+=j.SelectedNodes[Y].Id;0==j.SelectedNodes.length&&(K+="-12912"),K+=")"}}return K.length>0&&(Q=" INNER JOIN COM_DOCCCDATA DCC WITH(NOLOCK) ON DCC.InvDocDetailsID=A.InvDocDetailsID"),"(SELECT ISNULL(SUM(A.UOMConvertedQty*A.VoucherType),0)\tFROM INV_DocDetails A WITH(NOLOCK)"+Q+"\tWHERE A.ProductID="+this.Entities.Product+".ProductID AND (A.VoucherType=1 OR A.VoucherType=-1) AND A.IsQtyIgnored=0 AND A.StatusID<>376"+K+")"}return"0"}if(11420==e.FieldValue){if(this.IsInventory){var J="",q="",z="",Z=" and A.StatusID!=376";if(this.Entities.values.Contains("TDCC"))if(s.e.IsEmpty(e.DimensionsFilter)){z=" AND A.ProductID=INV.ProductID";var $=0;i.a.SessionManager.Preferences.ContainsKey("Maintain Dimensionwise stock")&&($=s.e.Int(i.a.SessionManager.Preferences["Maintain Dimensionwise stock"])),0==$&&"True"==i.a.SessionManager.Preferences.EnableLocationWise.toString()&&"True"==i.a.SessionManager.Preferences["LW Reports"]&&($=50002),0==$&&"True"==i.a.SessionManager.Preferences.EnableDivisionWise.toString()&&"True"==i.a.SessionManager.Preferences["DW Reports"]&&($=50001),$>0&&(q=" AND DCC.dcCCNID"+($-5e4)+"=TDCC.dcCCNID"+($-5e4))}else{var ee=e.DimensionsFilter.split("~");ee.length>1&&""!=ee[1]&&ee[1].split(",").forEach((function(e){Z+=" and A.StatusID!="+e})),(""==ee[0]?[]:ee[0].split(",")).forEach((function(e){"3"==e?z=" AND A.ProductID=INV.ProductID":q+=" AND DCC.dcCCNID"+(parseInt(e)-5e4)+"=TDCC.dcCCNID"+(parseInt(e)-5e4)}))}else z=" AND A.ProductID=INV.ProductID";return q.length>0&&(z+=q,q=" INNER JOIN COM_DOCCCDATA DCC with(nolock) ON DCC.InvDocDetailsID=A.InvDocDetailsID"),J="(SELECT ISNULL(SUM(A.UOMConvertedQty*A.VoucherType),0)\tFROM INV_DocDetails A WITH(NOLOCK)"+q+" WHERE A.StatusID!=376 AND A.ProductID=INV.ProductID AND (A.VoucherType=1 OR A.VoucherType=-1) AND A.IsQtyIgnored=0"+Z+z,null!=this.Report&&!s.e.IsEmpty(e.DimensionsFilter)&&e.DimensionsFilter.Contains("FROMDATE$1")?J+=" AND (A.DocumentType=3 OR A.DocDate<convert(float,convert(datetime,'"+this.Report.FromDatePicker.Date.ToString("dd MMM yyyy")+"')))":J+=" AND (A.DocumentType=3 OR A.DocDate<INV.DocDate)",J+=")"}return"NULL"}if("HoldQuantity"==e.Column){var te="(select INV.HoldQuantity-(case when release>INV.HoldQuantity then INV.HoldQuantity else release end) Executed\nfrom  (\nSELECT isnull(sum(case when ";return s.e.IsEmpty(i.a.SessionManager.Preferences.HoldResCancelledDocs)?te+="l.IsQtyIgnored=0":te+="(l.IsQtyIgnored=0 or l.Costcenterid in("+i.a.SessionManager.Preferences.HoldResCancelledDocs+"))",te+="then l.Quantity else l.ReserveQuantity end),0) release \nFROM INV_DocDetails l WITH(NOLOCK) WHERE INV.InvDocDetailsID=l.LinkedInvDocDetailsID) as t)"}if(26419==e.FieldValue||26420==e.FieldValue||50453==e.FieldValue||26419==e.ParentCCDefaultColID||26420==e.ParentCCDefaultColID||50453==e.ParentCCDefaultColID){var oe="",ne="",ie=this.GetDimensionFilterForStock("DCCX.dcCCNID"),se="";ie.length>0&&(ne=" INNER JOIN COM_DocCCData DCCX WITH(NOLOCK)  ON DCCX.InvDocDetailsID=DX.InvDocDetailsID");var ae="";this.StaticReportType>0?ae="P.ProductID":this.Entities.ContainsKey("Product")?ae=this.Entities.Product+".ProductID":(ae="INV.ProductID",s.e.IsEmpty(e.DimensionsFilter)||(ne=" INNER JOIN COM_DocCCData DCCX WITH(NOLOCK)  ON DCCX.InvDocDetailsID=DX.InvDocDetailsID",ie="",e.DimensionsFilter.split(",").forEach((function(e){ie+=" AND DCCX.dcCCNID"+(parseInt(e)-5e4)+"="+o.Entities.Documents_CCMAP+".dcCCNID"+(parseInt(e)-5e4)}))));var re="sum(case when l.IsQtyIgnored=0 then l.UOMConvertedQty else l.ReserveQuantity end)";if(re=s.e.IsEmpty(i.a.SessionManager.Preferences.HoldResCancelledDocs)?"sum(case when l.IsQtyIgnored=0 then l.UOMConvertedQty else l.ReserveQuantity end)":"sum(case when (l.IsQtyIgnored=0 or l.Costcenterid in("+i.a.SessionManager.Preferences.HoldResCancelledDocs+")) then l.UOMConvertedQty else l.ReserveQuantity end)",ie.length>0){var le=0;i.a.SessionManager.Preferences.ContainsKey("Maintain Dimensionwise stock")&&(le=s.e.Int(i.a.SessionManager.Preferences["Maintain Dimensionwise stock"])),le>0&&(se=" left JOIN COM_DocCCData DCCXL WITH(NOLOCK)  ON DCCXL.InvDocDetailsID=l.InvDocDetailsID AND  DCCXL.dcCCNID"+(le-5e4)+"=DCCX.dcCCNID"+(le-5e4),re=s.e.StringIsNullOrEmpty(i.a.SessionManager.Preferences.HoldResCancelledDocs)?"sum(case when DCCXL.InvDocDetailsID is not null and l.IsQtyIgnored=0 then l.UOMConvertedQty when DCCXL.InvDocDetailsID is not null THEN l.ReserveQuantity else 0 end)":"sum(case when DCCXL.InvDocDetailsID is not null and (l.IsQtyIgnored=0 or l.Costcenterid in("+i.a.SessionManager.Preferences.HoldResCancelledDocs+")) then l.UOMConvertedQty when DCCXL.InvDocDetailsID is not null THEN l.ReserveQuantity else 0 end)")}if(26419==e.FieldValue||26419==e.ParentCCDefaultColID)oe="(select isnull(sum(HoldQuantity-rel),0) from (select HoldQuantity,case when release>HoldQuantity then HoldQuantity else release end rel from \n                        (SELECT DX.HoldQuantity\n,isnull((select "+re+" from INV_DocDetails l WITH(NOLOCK)"+se+" where DX.InvDocDetailsID=l.LinkedInvDocDetailsID),0) release\nFROM INV_DocDetails DX WITH(NOLOCK)"+ne+"\nWHERE DX.ProductID="+ae+" AND DX.IsQtyIgnored=1 and DX.StatusID",!s.e.IsEmpty(i.a.SessionManager.Preferences.ConsiderUnAppInHold)&&Object(r.j)(i.a.SessionManager.Preferences.ConsiderUnAppInHold)?"ReportViewModel"==this.ClassName&&this.Preferences.ContainsKey("IncludeUnPostedDocsHoldQty")&&"1"==this.Preferences.IncludeUnPostedDocsHoldQty?oe+=" not in (372,376)":oe+="AddEditReportViewModel"==this.ClassName&&null!=this.Options.GLIncludeUnPostedDocsHoldQty&&this.Options.GLIncludeUnPostedDocsHoldQty.Visible&&this.Options.GLIncludeUnPostedDocsHoldQty.IsChecked?" not in (372,376)":" in (371,441,369)":"ReportViewModel"==this.ClassName&&this.Preferences.ContainsKey("IncludeUnPostedDocsHoldQty")&&"1"==this.Preferences.IncludeUnPostedDocsHoldQty?oe+=" not in (372,376)":oe+="AddEditReportViewModel"==this.ClassName&&null!=this.Options.GLIncludeUnPostedDocsHoldQty&&this.Options.GLIncludeUnPostedDocsHoldQty.Visible&&this.Options.GLIncludeUnPostedDocsHoldQty.IsChecked?" not in (372,376)":"=369",oe+=" and DX.DocumentType in (7,9,11,12,24) and DX.VoucherType=-1 "+ie+" \n                ) as t)as temp) ";else if(26420==e.FieldValue||26420==e.ParentCCDefaultColID){var De="";16==this.StaticReportType&&null!=this.oReportDialog&&(De=" and DX.DocDate<=convert(float,convert(datetime,'"+this.oReportDialog.ToDate.Date.ToString("dd MMM yyyy")+"'))"),ie+=De,oe="(select isnull(sum(HoldQuantity-rel),0) from (select HoldQuantity,case when release>HoldQuantity then HoldQuantity else release end rel from\n                    (SELECT DX.ReserveQuantity HoldQuantity\n,isnull((select "+re+" from INV_DocDetails l WITH(NOLOCK)"+se+" where DX.InvDocDetailsID=l.LinkedInvDocDetailsID"+De.replace("DX.DocDate","l.DocDate")+"),0) release\nFROM INV_DocDetails DX WITH(NOLOCK)"+ne+"\nWHERE DX.ProductID="+ae+" AND DX.IsQtyIgnored=1 and DX.StatusID",!s.e.IsEmpty(i.a.SessionManager.Preferences.ConsiderUnAppInHold)&&Object(r.j)(i.a.SessionManager.Preferences.ConsiderUnAppInHold)?oe+=" in (371,441,369)":oe+="=369",!s.e.IsEmpty(i.a.SessionManager.Preferences.ConsiderUnAppInHold)&&Object(r.j)(i.a.SessionManager.Preferences.ConsiderUnAppInHold)?"ReportViewModel"==this.ClassName&&this.Preferences.ContainsKey("IncludeUnPostedDocsReserveQty")&&"1"==this.Preferences.IncludeUnPostedDocsReserveQty.ToString()?oe+=" not in (372,376)":oe+="AddEditReportViewModel"==this.ClassName&&null!=this.Options.GLIncludeUnPostedDocsReserveQty&&this.Options.GLIncludeUnPostedDocsReserveQty.Visible&&this.Options.GLIncludeUnPostedDocsReserveQty.IsChecked?" not in (372,376)":" in (371,441,369)":"ReportViewModel"==this.ClassName&&this.Preferences.ContainsKey("IncludeUnPostedDocsReserveQty")&&"1"==this.Preferences.IncludeUnPostedDocsReserveQty.ToString()?oe+=" not in (372,376)":oe+="AddEditReportViewModel"==this.ClassName&&null!=this.Options.GLIncludeUnPostedDocsReserveQty&&this.Options.GLIncludeUnPostedDocsReserveQty.Visible&&this.Options.GLIncludeUnPostedDocsReserveQty.IsChecked?" not in (372,376)":"=369",oe+=" and DX.DocumentType in (7,9,11,12,24) and DX.VoucherType=-1 "+ie+" \n) as t)as temp) "}else 50453!=e.FieldValue&&50453!=e.ParentCCDefaultColID||(oe="(select isnull(sum(HoldQuantity-rel),0) from (select HoldQuantity,case when release>HoldQuantity then HoldQuantity else release end rel from\n                    (SELECT DX.ReserveQuantity HoldQuantity\n,isnull((select "+re+" from INV_DocDetails l WITH(NOLOCK)"+se+" where DX.InvDocDetailsID=l.LinkedInvDocDetailsID),0) release\nFROM INV_DocDetails DX WITH(NOLOCK)"+ne+"\nWHERE DX.ProductID="+ae+" AND DX.IsQtyIgnored=1 and DX.StatusID=369  and DX.DocumentType in (1,2,4,10,25,26,27) and DX.VoucherType=1 "+ie+"\n) as t)as temp) ");return oe}if(11383==e.FieldValue||11384==e.FieldValue){var Ce="dcCCNID2";return e.ParentCCDefaultColID>5e4&&e.ParentCCDefaultColID<51e3&&(Ce="dcCCNID"+(e.ParentCCDefaultColID-5e4)),"(SELECT TOP 1 "+(11383==e.FieldValue?"TOLOC.Code":"TOLOC.Name")+" FROM Inv_DocDetails ToINV WITH(NOLOCK) INNER JOIN COM_DocCCData TOCC WITH(NOLOCK) ON TOCC.InvDocDetailsID=ToINV.InvDocDetailsID INNER JOIN COM_Location TOLOC WITH(NOLOCK) ON TOCC."+Ce+"=TOLOC.NodeID WHERE ToINV.voucherno=INV.voucherno AND ToINV.DocSeqNo=INV.DocSeqNo AND ToINV.VoucherType!=INV.VoucherType)"}if(11424==e.FieldValue)return"(SELECT TOP 1 S.ProfileName FROM ADM_SchemesDiscounts S WITH(NOLOCK) WHERE S.SchemeID=INV.IsQtyFreeOffer)";if(11425==e.FieldValue)return this.StaticReportType>0?"(CASE WHEN D.IsQtyFreeOffer=1 OR (D.ParentSchemeID!='' and D.ParentSchemeID is not null) THEN D.Quantity ELSE 0.0 END)":"(CASE WHEN INV.IsQtyFreeOffer=1 OR (INV.ParentSchemeID!='' and INV.ParentSchemeID is not null) THEN INV.Quantity ELSE 0.0 END)";if(189==e.FieldValue)return"(select top 1 Rate from INV_DocDetails with(nolock) where  ProductID="+(this.StaticReportType>0?"D":"INV")+".ProductID and UOMConvertedQty>0"+(s.e.IsEmptySpace(e.ExecutedDocument)?" and IsQtyIgnored=0":" and CostCenterID IN ("+e.ExecutedDocument+")")+" order by docdate desc)";if(11509==e.FieldValue)return"(select top 1 StockValue/UOMConvertedQty from INV_DocDetails with(nolock) where  ProductID="+(this.StaticReportType>0?"D":"INV")+".ProductID and VoucherType=1 and UOMConvertedQty>0"+(s.e.IsEmptySpace(e.ExecutedDocument)?" and IsQtyIgnored=0":" and CostCenterID IN ("+e.ExecutedDocument+")")+" order by docdate desc)";if(11510==e.FieldValue){var ue=s.e.IsEmptySpace(e.ExecutedDocument)?" and IsQtyIgnored=0":" and CostCenterID IN ("+e.ExecutedDocument+")";return this.StaticReportType>0?"(select top 1 StockValue/UOMConvertedQty from INV_DocDetails with(nolock) where  ProductID=D.ProductID and VoucherType=1 and UOMConvertedQty>0"+ue+" order by docdate desc)":0==t.DocID&&this.Entities.ContainsKey("Product")?"(select top 1 StockValue/UOMConvertedQty from INV_DocDetails with(nolock) where  ProductID="+this.Entities.Product+".ProductID and VoucherType=1 and UOMConvertedQty>0"+ue+" order by docdate desc)":"0"}if(11511==e.FieldValue||11512==e.FieldValue||11513==e.FieldValue)return this.IsAvgRateExists=!0,this.StaticReportType>0?"NULL":0==t.DocID&&this.Entities.ContainsKey("Product")||this.Entities.values.Contains("INV")?"0.0":"null";if(188==e.FieldValue){if(this.StaticReportType>0)return"NULL";var ce;if(ce=this.Entities.keys.find((function(e){return e.endsWith("COM_DocNumData")}))){var Ie=s.e.Int(e.Formula);return"(select X.value('@Remarks','nvarchar(max)') from "+this.Entities[ce]+".Remarks.nodes('/XML/Row') as Data(X) where X.value('@Columnname','nvarchar(50)')='dcNum"+Ie+"')"}return"NULL"}if(e.FieldValue>=164&&e.FieldValue<=167||e.FieldValue>=11657&&e.FieldValue<=11658){var he="STUFF( (select";return 164==e.FieldValue?he+="', '+SA1.AccountName from acc_docdetails S1 with(nolock)  inner join acc_accounts SA1 with(nolock) on SA1.AccountID=S1.DebitAccount\nwhere S1.InvDocDetailsID=INV.InvDocDetailsID  group by SA1.AccountName":165==e.FieldValue?he+="', '+SA1.AccountName from acc_docdetails S1 with(nolock)  inner join acc_accounts SA1 with(nolock) on SA1.AccountID=S1.CreditAccount\nwhere S1.InvDocDetailsID=INV.InvDocDetailsID  group by SA1.AccountName":166==e.FieldValue?he+="', '+convert(nvarchar,sum(S1.Amount)) from acc_docdetails S1 with(nolock)  inner join acc_accounts SA1 with(nolock) on SA1.AccountID=S1.DebitAccount\nwhere S1.InvDocDetailsID=INV.InvDocDetailsID  group by SA1.AccountName":167==e.FieldValue?he+="', '+convert(nvarchar,sum(S1.Amount)) from acc_docdetails S1 with(nolock)  inner join acc_accounts SA1 with(nolock) on SA1.AccountID=S1.CreditAccount\nwhere S1.InvDocDetailsID=INV.InvDocDetailsID  group by SA1.AccountName":11657==e.FieldValue?he+="', '+convert(nvarchar,sum(S1.AmountFC)) from acc_docdetails S1 with(nolock)  inner join acc_accounts SA1 with(nolock) on SA1.AccountID=S1.DebitAccount\nwhere S1.InvDocDetailsID=INV.InvDocDetailsID  group by SA1.AccountName":11658==e.FieldValue&&(he+="', '+convert(nvarchar,sum(S1.AmountFC)) from acc_docdetails S1 with(nolock)  inner join acc_accounts SA1 with(nolock) on SA1.AccountID=S1.CreditAccount\nwhere S1.InvDocDetailsID=INV.InvDocDetailsID  group by SA1.AccountName"),he+=" FOR XML PATH(''),type).value('.','nvarchar(max)'),1,2,'')"}if(204==e.FieldValue)return"STUFF((SELECT ', '+SerialNumber from INV_SerialStockProduct with(nolock) where InvDocDetailsID="+(0==this.StaticReportType?"INV":"D")+".InvDocDetailsID FOR XML PATH('')),1,2,'')";if(181==e.FieldValue){var de="",Te="Code"==e.Column?"Code":"Name",ye=this.StaticReportType>0?"D":a;if(16==this.StaticReportType)return de;if(13==this.StaticReportType||81==this.StaticReportType||82==this.StaticReportType||83==this.StaticReportType||158==this.StaticReportType){if(this.Filter.IsReportViewScreen&&(this.ReportParams.ContainsKey("BinDetail")&&this.ReportParams.Remove("BinDetail"),this.Preferences.ContainsKey("BinDetail")&&"1"==this.Preferences.BinDetail))return this.GroupFromTag.Contains("BIN.NodeID")||(this.GroupFromTag+=" left join INV_BinDetails BD with(nolock) on BD.InvDocDetailsID="+ye+".InvDocDetailsID left join "+e.ParentCostCenterSysName+" BIN with(nolock) ON BIN.NodeID=BD.BinID"),this.ReportParams.ContainsKey("BinInfo")&&this.ReportParams.Remove("BinInfo"),this.ReportParams.ContainsKey("BinDetail")||this.ReportParams.push("BinDetail",""),"BIN."+Te;de="STUFF((SELECT distinct ', '+B."+Te,(81!=this.StaticReportType&&"2"!=e.Formula||82==this.StaticReportType||83==this.StaticReportType)&&(de+="+'-'+convert(nvarchar,Quantity)"),de+=" FROM INV_BinDetails BD with(nolock) inner join "+e.ParentCostCenterSysName+" B with(nolock) ON B.NodeID=BD.BinID WHERE BD.InvDocDetailsID="+ye+".InvDocDetailsID\n                FOR XML PATH('')),1,2,'')",this.ReportParams.ContainsKey("BinInfo")||this.ReportParams.push("BinInfo",""),this.ReportParams.BinInfo=de}else de=0==this.StaticReportType?"STUFF((SELECT distinct ', '+B."+Te+"+'-'+convert(nvarchar,Quantity) FROM INV_BinDetails BD with(nolock) inner join "+e.ParentCostCenterSysName+" B with(nolock) ON B.NodeID=BD.BinID WHERE BD.InvDocDetailsID="+ye+".InvDocDetailsID FOR XML PATH('')),1,2,'')":"NULL";return de}if(26648==e.FieldValue){if(this.IsInventory&&("TRUE"==i.a.SessionManager.Preferences["LW Bins"].toUpperCase()||"TRUE"==i.a.SessionManager.Preferences["DW Bins"].toUpperCase())){var me=i.a.common.GetDataTable("RPT037","");if(me.Columns[0].Contains("TableName")&&me.Table[0].length>0){var Ae="dcCCNID1",pe="Division";"TRUE"==i.a.SessionManager.Preferences["LW Bins"].toUpperCase()&&(Ae="dcCCNID2",pe="Location");for(var Ee="",Ne=0;Ne<this.Objects.length;Ne++)if(this.Entities.keys[Ne].endsWith("_CCMAP")&&"COM_DOCCCDATA"==this.Objects[Ne].Table.toUpperCase()){Ee=this.Entities.keys[Ne];break}if(!s.e.IsEmpty(Ee))return"(select TOP 1 D.Name from INV_ProductBins B with(nolock)\ninner join "+me.Table[0].TableName.toString()+" D with(nolock) on B.BinNodeID=D.NodeID\nwhere B."+pe+"="+this.Entities[Ee]+"."+Ae+" AND B.NodeID=INV.ProductID AND B.CostCenterID=3)"}}return"NULL"}}else{if(11366==e.FieldValue)return this.StaticReportType>0?"(SELECT top 1 CPDC.VoucherNo FROM ACC_DocDetails CPDC with(nolock) WHERE CPDC.RefCCID=400 AND CPDC.refnodeid=D.AccDocDetailsID and CPDC.CostCenterID=(select TOP 1ConvertAS from ADM_DocumentTypes DTP with(nolock) where DTP.CostCenterID=D.CostCenterID ))":"(SELECT top 1 CPDC.VoucherNo FROM ACC_DocDetails CPDC with(nolock) WHERE CPDC.RefCCID=400 AND CPDC.refnodeid=ACC.AccDocDetailsID and CPDC.CostCenterID=(select ConvertAS from ADM_DocumentTypes D with(nolock) where d.CostCenterID=ACC.CostCenterID ))";if(11367==e.FieldValue)return this.StaticReportType>0?"(SELECT top 1 CPDC.VoucherNo FROM ACC_DocDetails CPDC with(nolock) WHERE CPDC.RefCCID=400 AND CPDC.refnodeid=D.AccDocDetailsID and CPDC.CostCenterID=(select TOP 1 ConvertAS from ADM_DocumentTypes DTP with(nolock) where DTP.CostCenterID=D.CostCenterID ))":"(SELECT top 1 CONVERT(DATETIME,CPDC.DocDate) FROM ACC_DocDetails CPDC with(nolock) WHERE CPDC.RefCCID=400 AND CPDC.refnodeid=ACC.AccDocDetailsID and CPDC.CostCenterID=(select ConvertAS from ADM_DocumentTypes D with(nolock) where d.CostCenterID=ACC.CostCenterID ))";if(11410==e.FieldValue)return"(SELECT top 1 CONVERT(DATETIME,CPDC.DocDate) FROM ACC_DocDetails CPDC with(nolock) WHERE CPDC.RefCCID=400 AND CPDC.refnodeid=ACC.AccDocDetailsID and CPDC.CostCenterID=(select IntermediateConvertion from ADM_DocumentTypes D with(nolock) where d.CostCenterID=ACC.CostCenterID ))";if(11411==e.FieldValue)return this.StaticReportType>0?"(SELECT top 1 CPDC.VoucherNo FROM ACC_DocDetails CPDC with(nolock) WHERE CPDC.RefCCID=400 AND CPDC.refnodeid=D.AccDocDetailsID and CPDC.CostCenterID=(select IntermediateConvertion from ADM_DocumentTypes DT with(nolock) where dT.CostCenterID=D.CostCenterID ))":"(SELECT top 1 CPDC.VoucherNo FROM ACC_DocDetails CPDC with(nolock) WHERE CPDC.RefCCID=400 AND CPDC.refnodeid=ACC.AccDocDetailsID and CPDC.CostCenterID=(select IntermediateConvertion from ADM_DocumentTypes D with(nolock) where d.CostCenterID=ACC.CostCenterID ))";if("DebitAmount"==e.Column)return"(CASE WHEN ACC.DebitAccount>0 THEN ACC.Amount ELSE 0 END)";if("CreditAmount"==e.Column)return"(CASE WHEN ACC.CreditAccount>0 THEN ACC.Amount ELSE 0 END)";if(210==e.FieldValue)return"NULL"}if(214==e.FieldValue){var Se="";1!=this.StaticReportType&&-2!=this.StaticReportType||(a="D");var Oe=s.e.IsEmpty(e.DimensionsFilter)?[]:e.DimensionsFilter.split("~");if(Oe.length>2&&Oe[1].length>0&&Oe[2].length>0){var ge,Fe=function(){for(var e=!1,n=!1,i=Oe[2].split(","),s=function(s){if(s>0&&(Se+=","),i[s].startsWith("EFPD_"))"EFPD_AccDocDetailsID"==i[s]?n=!0:"EFPD_InvDocDetailsID"!=i[s]&&"EFPD_ProductID"!=i[s]||(e=!0),Se+=n&&t.IsInventory||e&&!t.IsInventory?"null":"EFPD_Account"==i[s]?t.IsDebit?a+".DebitAccount":a+".CreditAccount":a+"."+i[s].Replace("EFPD_","");else if(i[s].startsWith("EF_"))Se=o.SetExtFunctionParams(i[s],Se);else if(i[s].startsWith("COL_")&&"ReportViewModel"==o.ClassName&&(ge=o.BaseReportColumns.find((function(e){return e.ID==i[s].substr(4)})))){var r=ge.CDGDO.IsForeignKey?ge.CDGDO.ParentCostCenterID:ge.CDGDO.CategoryValue;400!=r&&(r<4e4||r>5e4)&&("NULL"!=ge.CDGDO.ActualColumn?(o.drrCCTbl=o.FieldsDialog.CostCenterTables.filter((function(e){return e.FeatureID==r})),Se+=ge.CDGDO.ActualTable+"."+o.drrCCTbl[0].PK.toString()):Se+="NULL")}},r=0;r<i.length;r++)s(r);return{v:Se.length>0?Se="dbo."+Oe[1]+"("+Se+")":"null"}}();if("object"==typeof Fe)return Fe.v}return"null"}if(11364==e.FieldValue)return"CASE WHEN (SELECT COUNT(*) FROM COM_Files WITH(NOLOCK) WHERE FeatureID="+a+".CostCenterID AND FeaturePK="+a+".DocID)>0 THEN 'YES' ELSE 'NO' END";if(11516==e.FieldValue)return"stuff((select ','+Note from COM_Notes WITH(NOLOCK) WHERE FeatureID="+a+".CostCenterID AND FeaturePK="+a+".DocID FOR XML PATH('')),1,1,'')";if(11690==e.FieldValue)return"stuff((select distinct ','+Note from COM_Notes WITH(NOLOCK) WHERE FeatureID="+a+".RefCCID AND FeaturePK="+a+".RefNodeid),1,1,'')";if("ProductImage"==e.Column)return"(select top 1 F.GUID+'.'+F.FileExtension from COM_Files F WITH(NOLOCK) where F.FeatureID=3 and F.IsProductImage=1 and F.FeaturePK="+this.Entities[e.CategoryText]+".ProductID and F.IsDefaultImage=1)";if("DimensionImage"==e.Column)return"(select top 1 F.GUID+'.'+F.FileExtension from COM_Files F WITH(NOLOCK) where F.FeatureID="+(e.ParentCostCenterID>0?e.ParentCostCenterID:e.CategoryValue)+" and F.IsProductImage=1 and F.FeaturePK="+this.Entities[e.CategoryText]+".NodeID and F.IsDefaultImage=1)";if(11368==e.FieldValue)return" (SELECT ISNULL(SUM(abs(AdjAmount)),0) FROM COM_Billwise CB WITH(NOLOCK) WHERE IsNewReference=0 AND (CB.RefDocNo="+a+".VoucherNo OR CB.DocNo="+a+".VoucherNo))";if(11409==e.FieldValue)return"INV"==a?"AddEditReportViewModel"==this.ClassName&&this.Options.ExcludePDCAdjust.IsChecked||"ReportViewModel"==this.ClassName&&this.Preferences.ContainsKey("ExcludePDCsAdjust")&&"1"==this.Preferences.ExcludePDCsAdjust?" (SELECT ISNULL(SUM(abs(AdjAmount)),0) FROM COM_Billwise CB WITH(NOLOCK) WHERE CB.StatusID Not in (370) AND IsNewReference=0 and DynamicInvDocDetailsID is null AND ((CB.RefDocNo="+a+".VoucherNo and "+a+".DocSeqNo=CB.RefDocSeqNo) OR (CB.DocNo="+a+".VoucherNo AND "+a+".DocSeqNo=CB.DocSeqNo)))":" (SELECT ISNULL(SUM(abs(AdjAmount)),0) FROM COM_Billwise CB WITH(NOLOCK) WHERE IsNewReference=0 and DynamicInvDocDetailsID is null AND ((CB.RefDocNo="+a+".VoucherNo and "+a+".DocSeqNo=CB.RefDocSeqNo) OR (CB.DocNo="+a+".VoucherNo AND "+a+".DocSeqNo=CB.DocSeqNo)))":"AddEditReportViewModel"==this.ClassName&&this.Options.ExcludePDCAdjust.IsChecked||"ReportViewModel"==this.ClassName&&this.Preferences.ContainsKey("ExcludePDCsAdjust")&&"1"==this.Preferences.ExcludePDCsAdjust?" (SELECT ISNULL(SUM(abs(AdjAmount)),0) FROM COM_Billwise CB WITH(NOLOCK) WHERE CB.StatusID Not in (370) AND IsNewReference=0 AND ((CB.RefDocNo="+a+".VoucherNo and "+a+".DocSeqNo=CB.RefDocSeqNo) OR (CB.DocNo="+a+".VoucherNo AND "+a+".DocSeqNo=CB.DocSeqNo)))":" (SELECT ISNULL(SUM(abs(AdjAmount)),0) FROM COM_Billwise CB WITH(NOLOCK) WHERE IsNewReference=0 AND ((CB.RefDocNo="+a+".VoucherNo and "+a+".DocSeqNo=CB.RefDocSeqNo) OR (CB.DocNo="+a+".VoucherNo AND "+a+".DocSeqNo=CB.DocSeqNo)))";if(213==e.FieldValue)return"stuff(\n(select ','+convert(nvarchar, convert(datetime,LastDate),106) from\n(SELECT DocNo, DocDate LastDate FROM COM_Billwise CB WITH(NOLOCK) WHERE IsNewReference=0 AND (CB.RefDocNo=INV.VoucherNo) \nUNION ALL\nSELECT RefDocNo,RefDocDate LastDate FROM COM_Billwise CB WITH(NOLOCK) WHERE IsNewReference=0 AND (CB.DocNo=INV.VoucherNo)\n) as T\ngroup by DocNo,LastDate FOR XML PATH('')), 1,1,'')";if(11369==e.FieldValue)return"(SELECT TOP 1 CONVERT(DATETIME,LastDate) FROM (\nSELECT DocDate LastDate FROM COM_Billwise CB WITH(NOLOCK) WHERE IsNewReference=0 AND (CB.RefDocNo="+a+".VoucherNo)\nUNION\nSELECT RefDocDate LastDate FROM COM_Billwise CB WITH(NOLOCK) WHERE IsNewReference=0 AND (CB.DocNo="+a+".VoucherNo) ) AS T ORDER BY LastDate DESC)";if(11370==e.FieldValue)return"(SELECT TOP 1 DocNo FROM (\nSELECT DocDate LastDate,CB.DocNo DocNo FROM COM_Billwise CB WITH(NOLOCK) WHERE IsNewReference=0 AND (CB.RefDocNo="+a+".VoucherNo)\nUNION\nSELECT RefDocDate LastDate,CB.RefDocNo DocNo FROM COM_Billwise CB WITH(NOLOCK) WHERE IsNewReference=0 AND (CB.DocNo="+a+".VoucherNo) ) AS T ORDER BY LastDate DESC)";if(11414==e.FieldValue)return this.StaticReportType>0?"dbo.fnRPT_GetAdjustedDocNos(D.VoucherNo)":"dbo.fnRPT_GetAdjustedDocNos("+a+".VoucherNo)";if(527==e.FieldValue)return this.StaticReportType>0?"dbo.fnRPT_GetAdjustedDocChequeDate(D.VoucherNo)":"dbo.fnRPT_GetAdjustedDocChequeDate("+a+".VoucherNo)";if(528==e.FieldValue)return this.StaticReportType>0?"dbo.fnRPT_GetAdjustedDocMaturityDate(D.VoucherNo)":"dbo.fnRPT_GetAdjustedDocMaturityDate("+a+".VoucherNo)";if(180==e.FieldValue){var fe=this.StaticReportType>0?"D":a;return"STUFF((SELECT distinct ', '+B.BillNo FROM (\nSELECT CB.DocNo DocNo FROM COM_Billwise CB WITH(NOLOCK) WHERE IsNewReference=0 AND CB.RefDocNo="+fe+".VoucherNo\nUNION\nSELECT CB.RefDocNo DocNo FROM COM_Billwise CB WITH(NOLOCK) WHERE IsNewReference=0 AND CB.DocNo="+fe+".VoucherNo\n)AS T inner join inv_docdetails B with(nolock) on B.VoucherNo=T.DocNo\nwhere B.BillNo is not null and B.BillNo!=''\nFOR XML PATH('')),1,2,'')"}if(11506==e.FieldValue)return" (SELECT ISNULL(SUM(abs(AdjAmount)),0) FROM COM_ChequeReturn CB WITH(NOLOCK) WHERE IsNewReference=0 AND ((CB.RefDocNo="+a+".VoucherNo and "+a+".DocSeqNo=CB.RefDocSeqNo)))";if(11507==e.FieldValue)return this.StaticReportType>0?"dbo.fnRPT_GetChequeRetunAdjustedDocNos(D.VoucherNo)":"dbo.fnRPT_GetChequeRetunAdjustedDocNos("+a+".VoucherNo)";if(11659==e.FieldValue)return this.StaticReportType>0?"dbo.fnRPT_GetChequeRetunAdjustedDocDate(D.VoucherNo)":"dbo.fnRPT_GetChequeRetunAdjustedDocDate("+a+".VoucherNo)";if(202==e.FieldValue)return this.StaticReportType>0?"dbo.fnRPT_GetAdjustedDocInfo(D.VoucherNo)":"dbo.fnRPT_GetAdjustedDocInfo("+a+".VoucherNo)";if(11371==e.FieldValue||11372==e.FieldValue)return this.IsOpeningStockExists=!0,"0.0";if(11373==e.FieldValue||11374==e.FieldValue)return this.IsClosingStockExists=!0,"0.0";if(11377==e.FieldValue||11378==e.FieldValue||11379==e.FieldValue||11380==e.FieldValue){var Re=a+".docid",Pe=this.BaseReportColumns.find((function(e){return 95==e.CDGDO.CategoryValue||103==e.CDGDO.CategoryValue||104==e.CDGDO.CategoryValue||129==e.CDGDO.CategoryValue}));Pe&&95==Pe.CDGDO.CategoryValue?(a=this.Entities.Contract,Re=this.Entities.Contract+".ContractID"):Pe&&129==Pe.CDGDO.CategoryValue&&(a=this.Entities["Unit Reservation"],Re=this.Entities["Unit Reservation"]+".QuotationID");var be=0;if(null!=e.Formula&&e.Formula.startsWith("LEVEL")&&(be=s.e.Int(e.Formula.substr(5)),this.IsNewFromClause&&(this.FromTagExtra.Contains("COM_ApprovalSummary")||(this.FromTagExtra+=" left join COM_ApprovalSummary WFT on WFT.DocID="+Re,0!=t.DocID&&-1!=t.DocID&&-2!=t.DocID&&(this.FromTagExtra+=" and WFT.CCID="+Math.abs(t.DocID)),400==e.CategoryValue&&(this.FromTagExtra+=" and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID="+a+".InvDocDetailsID)")),11378!=e.FieldValue||this.FromTagExtra.Contains("WFTU"+be+" ")||(this.FromTagExtra+=" left join ADM_Users WFTU"+be+" with(nolock) on WFT.L"+be+"UserID=WFTU"+be+".UserID "))),11377==e.FieldValue)return null!=e.Formula&&e.Formula.startsWith("LEVEL")?this.IsNewFromClause?"convert(datetime,floor(WFT.L"+be+"CreatedDate))":"(select convert(DATETIME,CreatedDate) from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID from COM_Approvals with(nolock) \nwhere (StatusID=441 or StatusID=369"+(1==be?" or StatusID=371":"")+") and RowType=1 and ccid="+a+".costcenterid and ccnodeid="+Re+(400==e.CategoryValue?" AND (DocDetID=0 OR DocDetID="+a+".InvDocDetailsID)":"")+" and WorkFlowLevel="+be+" order by ApprovalID desc))":"(select convert(datetime,CreatedDate) from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID\nfrom COM_Approvals with(nolock) where RowType=1 and ccid="+a+".costcenterid and ccnodeid="+Re+(400==e.CategoryValue?" AND (DocDetID=0 OR DocDetID="+a+".InvDocDetailsID)":"")+" order by ApprovalID desc))";if(11378==e.FieldValue)return null!=e.Formula&&e.Formula.startsWith("LEVEL")?this.IsNewFromClause?"WFTU"+be+"."+e.Column:"(select U."+e.Column+" from COM_Approvals A with(nolock) \ninner join ADM_Users U with(nolock) on A.UserID=U.UserID \nwhere A.ApprovalID IN (select top 1 ApprovalID from COM_Approvals with(nolock) \nwhere (StatusID=441 or StatusID=369"+(1==be?" or StatusID=371":"")+") and RowType=1 and ccid="+a+".costcenterid and ccnodeid="+Re+(400==e.CategoryValue?" AND (DocDetID=0 OR DocDetID="+a+".InvDocDetailsID)":"")+" and WorkFlowLevel="+be+" order by ApprovalID desc))":"(select CreatedBy from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID\nfrom COM_Approvals with(nolock) where RowType=1 and ccid="+a+".costcenterid and ccnodeid="+Re+(400==e.CategoryValue?" AND (DocDetID=0 OR DocDetID="+a+".InvDocDetailsID)":"")+" order by ApprovalID desc))";if(11379==e.FieldValue)return null!=e.Formula&&e.Formula.startsWith("LEVEL")?this.IsNewFromClause?"WFT.L"+be+"Remarks":"(select Remarks from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID from COM_Approvals with(nolock) \nwhere (StatusID=441 or StatusID=369"+(1==be?" or StatusID=371":"")+") and RowType=1 and ccid="+a+".costcenterid and ccnodeid="+Re+(400==e.CategoryValue?" AND (DocDetID=0 OR DocDetID="+a+".InvDocDetailsID)":"")+" and WorkFlowLevel="+be+" order by ApprovalID desc))":"(select Remarks from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID\nfrom COM_Approvals with(nolock) where RowType=1 and ccid="+a+".costcenterid and ccnodeid="+Re+(400==e.CategoryValue?" AND (DocDetID=0 OR DocDetID="+a+".InvDocDetailsID)":"")+" order by ApprovalID desc))";if(11380==e.FieldValue)return null!=e.Formula&&e.Formula.startsWith("LEVEL")?this.IsNewFromClause?"WFT.L"+be+"Status":"(select S.Status from COM_Approvals A with(nolock) \ninner join COM_Status S with(nolock) on A.StatusID=S.StatusID \nwhere A.ApprovalID IN (select top 1 ApprovalID from COM_Approvals with(nolock) \nwhere (StatusID=441 or StatusID=369"+(1==be?" or StatusID=371":"")+") and RowType=1 and ccid="+a+".costcenterid and ccnodeid="+Re+(400==e.CategoryValue?" AND (DocDetID=0 OR DocDetID="+a+".InvDocDetailsID)":"")+" and WorkFlowLevel="+be+" order by ApprovalID desc))":"(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID\nfrom COM_Approvals with(nolock) where RowType=1 and ccid="+a+".costcenterid and ccnodeid="+Re+(400==e.CategoryValue?" AND (DocDetID=0 OR DocDetID="+a+".InvDocDetailsID)":"")+" order by ApprovalID desc)))"}else{if(11666==e.FieldValue)return"(select top 1 ReviseReason from "+(this.IsInventory?"INV_DocDetails":"ACC_DocDetails")+"_History with(nolock) where VoucherNo="+a+".VoucherNo and ReviseReason is not null)";if(11381==e.FieldValue)return"CASE WHEN (SELECT COUNT(*) FROM COM_CCSchedules WITH(NOLOCK) WHERE CostCenterID="+a+".CostCenterID AND NodeID="+a+".DocID)>0 THEN 'YES' ELSE 'NO' END";if(11692==e.FieldValue)return"(select Status from CRM_Activities ACT with(nolock) join COM_Status S on S.StatusID=ACT.StatusID and ActivityID=(select max(ActivityID) from CRM_Activities ACT with(nolock) where ACT.CostCenterID="+a+".CostCenterID and ACT.NodeID="+a+".DocID))";if(!(95!=e.CategoryValue&&103!=e.CategoryValue&&104!=e.CategoryValue&&129!=e.CategoryValue||"RentAmount"!=e.Column&&"DiscountAmount"!=e.Column&&"Discount"!=e.Column))return 103==e.CategoryValue||129==e.CategoryValue?"isnull((select "+e.Column+" from "+e.Table+" with(nolock) where QuotationID=T0.QuotationID and Sno=1),0)":"isnull((select "+e.Column+" from "+e.Table+" with(nolock) where CONTRACTID=T0.CONTRACTID and Sno=1),0)";if(101==e.CategoryValue){if(""==e.Column)return this.IsBudgetFound=!0,"0.0"}else if("RefNO"==e.Column){if(Math.abs(t.DocID)>4e4&&Math.abs(t.DocID)<5e4&&t.IsInventory)return"(SELECT TOP 1 VoucherNo FROM INV_DocDetails Ref WITH(NOLOCK) WHERE Ref.InvDocDetailsID=INV.LinkedInvDocDetailsID)"}else if(11375==e.FieldValue||11490==e.FieldValue||53517==e.FieldValue||11418==e.FieldValue||11419==e.FieldValue||11684==e.FieldValue||191==e.FieldValue||11751==e.FieldValue||12109==e.FieldValue||e.FieldValue>=11700&&e.FieldValue<=11750||e.FieldValue>=11951&&e.FieldValue<=11955)this.strHistorySepChar=11375==e.FieldValue||11490==e.FieldValue||11751==e.FieldValue||12109==e.FieldValue||53517==e.FieldValue||e.FieldValue>=11951&&e.FieldValue<=11955?"_":"",this.IsHistory=!0,this.iHistoryStatusID=e.FieldValue,11490==e.FieldValue&&(this.IsRevision=!0);else{if(11406==e.FieldValue)return"0.0";if(11408==e.FieldValue||e.FieldValue>=11485&&e.FieldValue<=11489)return"0.0";if("LATEST"==e.Formula){if(t.DocID>4e4&&t.DocID<5e4&&t.IsInventory&&0==e.IsForeignKey)return"DocDate"==e.Column?"(select TOP 1 CONVERT(DATETIME,A.DocDate) from inv_docdetails A with(nolock) where A.productid=INV.productID AND A.costcenterid="+e.CategoryValue+" order by A.DocDate desc,A.CreatedDate desc)":"(select TOP 1 "+e.Column+" from inv_docdetails A with(nolock) where A.productid=INV.productID AND A.costcenterid="+e.CategoryValue+" order by A.DocDate desc,A.CreatedDate desc)"}else if("OLDEST"==e.Formula){if(t.DocID>4e4&&t.DocID<5e4&&t.IsInventory&&0==e.IsForeignKey)return"DocDate"==e.Column?"(select TOP 1 CONVERT(DATETIME,A.DocDate) from inv_docdetails A with(nolock) where A.productid=INV.productID AND A.costcenterid="+e.CategoryValue+" order by A.DocDate asc,A.CreatedDate asc)":"(select TOP 1 "+e.Column+" from inv_docdetails A with(nolock) where A.productid=INV.productID AND A.costcenterid="+e.CategoryValue+" order by A.DocDate asc,A.CreatedDate asc)"}else{if("H"==e.Formula){if((Le=this.Filter.Fields.find((function(e){return"DATE"==e.CDGDO.DataType})))&&e.IsForeignKey){var Ve=e.CategoryText.split(".")[0];if(this.Entities.ContainsKey(Ve)){var ve=e.ColumnCostCenterID;return 25472==e.FieldValue?ve=1:25467==e.FieldValue&&(ve=2),this.drrCCTbl=this.FieldsDialog.CostCenterTables.filter((function(t){return t.FeatureID==e.CategoryValue})),"(select top 1 HDD."+e.Column+" from COM_HistoryDetails HD left join "+e.ParentCostCenterSysName+" HDD with(nolock) on HD.HistoryNodeID=HDD.NodeID\nwhere HD.costcenterid="+e.CategoryValue+" and HD.NodeID="+this.Entities[Ve]+"."+this.drrCCTbl[0].PK.toString()+" and HD.HistoryCCID="+ve+"\nand FromDate<=convert(float,convert(datetime,'"+Le.ToDatePicker.Date.ToString("dd MMM yyyy")+"')) order by FromDate desc)"}}return"#"}if(44==e.ColumnCostCenterID||44==e.LocalReference){var Me;if(0==t.DocID?Me="CRM_CONTACTS"==e.Table.toUpperCase()||e.Table.endsWith("Extended")?e.CategoryText+e.Table:e.CategoryText:(Me=e.CategoryText+e.Table,this.Entities.ContainsKey(Me)||(Me=e.CategoryText)),this.Entities.ContainsKey(Me)){e.ActualTable=this.Entities[Me]+"."+e.Column;var _e=this.Entities[Me]+"."+e.Column;return"case when "+_e+" is not null and isnumeric("+_e+")=1 then (select TOP 1 Name from COM_Lookup L with(nolock) where L.NodeID="+_e+") else '' end"}}else{if(e.FieldValue>=93&&e.FieldValue<=99||169==e.FieldValue||11649==e.FieldValue||11650==e.FieldValue||11651==e.FieldValue||11665==e.FieldValue){var Le=this.Filter.Fields.find((function(e){return 169==e.CDGDO.FieldValue}));if(this.Entities.ContainsKey("Asset Management")){if(94==e.FieldValue)return"(select sum(convert(float,ChangeValue)) from ACC_AssetChanges DP with(nolock) where DP.ChangeType=0 and DP.AssetID="+this.Entities["Asset Management"]+".AssetID)";if(93==e.FieldValue)return"(select sum(convert(float,ChangeValue)) from ACC_AssetChanges DP with(nolock) where DP.ChangeType=5 and DP.AssetID="+this.Entities["Asset Management"]+".AssetID)";if(11649==e.FieldValue)return"stuff((select ','+convert(nvarchar, convert(datetime,Date),106) from ACC_AssetsHistory with(nolock) where AssetManagementID="+this.Entities["Asset Management"]+".AssetID order by HistoryID FOR XML PATH('')), 1,1,'')";if(11650==e.FieldValue)return"stuff((select ','+VoucherNo from ACC_AssetsHistory with(nolock) where AssetManagementID="+this.Entities["Asset Management"]+".AssetID order by HistoryID FOR XML PATH('')), 1,1,'')";if(11651==e.FieldValue)return"stuff((select ','+(case PolicyType when 1 then 'Dispose Full' when 2 then 'Sale Partial' when 3 then 'Sale Full' else 'Dispose Partial' end) from ACC_AssetsHistory with(nolock) where AssetManagementID="+this.Entities["Asset Management"]+".AssetID order by HistoryID FOR XML PATH('')), 1,1,'')";if(11665==e.FieldValue)return null!=Le?"(select top 1 case PolicyType when 1 then 'Dispose Full' when 2 then 'Sale Partial' when 3 then 'Sale Full' else 'Dispose Partial' end from ACC_AssetsHistory with(nolock) where AssetManagementID="+this.Entities["Asset Management"]+".AssetID and [Date]<=convert(float,convert(datetime,'"+Le.ToDatePicker.Date.ToString("dd MMM yyyy")+"')) order by Date desc)":"(select top 1 case PolicyType when 1 then 'Dispose Full' when 2 then 'Sale Partial' when 3 then 'Sale Full' else 'Dispose Partial' end from ACC_AssetsHistory with(nolock) where AssetManagementID="+this.Entities["Asset Management"]+".AssetID order by Date desc)";if(null!=Le)if(99==e.FieldValue||98==e.FieldValue||97==e.FieldValue){var we="";if(s.e.IsEmpty(e.DimensionsFilter)){if(99==e.FieldValue)return"(select sum(DepAmount) from ACC_AssetDepSchedule DP with(nolock) where DP.AssetID="+this.Entities["Asset Management"]+".AssetID and DP.DeprEndDate<=convert(float,convert(datetime,'"+Le.ToDatePicker.Date.ToString("dd MMM yyyy")+"')))";if(98==e.FieldValue)return"(select sum(DepAmount) from ACC_AssetDepSchedule DP with(nolock) where DP.AssetID="+this.Entities["Asset Management"]+".AssetID and DP.DeprEndDate<convert(float,convert(datetime,'"+Le.FromDatePicker.Date.ToString("dd MMM yyyy")+"')))";if(97==e.FieldValue)return"(select sum(DepAmount) from ACC_AssetDepSchedule DP with(nolock) where DP.AssetID="+this.Entities["Asset Management"]+".AssetID  and DP.DeprEndDate>=convert(float,convert(datetime,'"+Le.FromDatePicker.Date.ToString("dd MMM yyyy")+"'))  and DP.DeprEndDate<=convert(float,convert(datetime,'"+Le.ToDatePicker.Date.ToString("dd MMM yyyy")+"')))"}else{var xe;if(e.DimensionsFilter.split(",").forEach((function(e){(xe=o.GetDimensionFilter(parseInt(e))).length>0&&(we+=" AND DCC.dcCCNID"+(parseInt(e)-5e4)+" in ("+xe+")")})),xe=" join ACC_DocDetails D with(nolock) on D.DocID=DP.DocID join COM_DocCCDATA DCC with(nolock) on D.AccDocDetailsID=DCC.AccDocDetailsID",we=" and D.DebitAccount>0"+we,99==e.FieldValue)return"(select sum(D.Amount) from ACC_AssetDepSchedule DP with(nolock)"+xe+" where DP.AssetID="+this.Entities["Asset Management"]+".AssetID"+we+" and DP.DeprEndDate<=convert(float,convert(datetime,'"+Le.ToDatePicker.Date.ToString("dd MMM yyyy")+"')))";if(98==e.FieldValue)return"(select sum(D.Amount) from ACC_AssetDepSchedule DP with(nolock)"+xe+" where DP.AssetID="+this.Entities["Asset Management"]+".AssetID"+we+" and DP.DeprEndDate<convert(float,convert(datetime,'"+Le.FromDatePicker.Date.ToString("dd MMM yyyy")+"')))";if(97==e.FieldValue)return"(select sum(D.Amount) from ACC_AssetDepSchedule DP with(nolock)"+xe+" where DP.AssetID="+this.Entities["Asset Management"]+".AssetID"+we+"  and DP.DeprEndDate>=convert(float,convert(datetime,'"+Le.FromDatePicker.Date.ToString("dd MMM yyyy")+"'))  and DP.DeprEndDate<=convert(float,convert(datetime,'"+Le.ToDatePicker.Date.ToString("dd MMM yyyy")+"')))"}}else{if(96==e.FieldValue)return"(select sum(convert(float,ChangeValue)) from ACC_AssetChanges DP with(nolock) where DP.ChangeType=0 and DP.AssetID="+this.Entities["Asset Management"]+".AssetID and DP.ChangeDate>=convert(float,convert(datetime,'"+Le.FromDatePicker.Date.ToString("dd MMM yyyy")+"'))  and DP.ChangeDate<=convert(float,convert(datetime,'"+Le.ToDatePicker.Date.ToString("dd MMM yyyy")+"')))";if(95==e.FieldValue)return"(select sum(convert(float,ChangeValue)) from ACC_AssetChanges DP with(nolock) where DP.ChangeType=5 and DP.AssetID="+this.Entities["Asset Management"]+".AssetID and DP.ChangeDate>=convert(float,convert(datetime,'"+Le.FromDatePicker.Date.ToString("dd MMM yyyy")+"'))  and DP.ChangeDate<=convert(float,convert(datetime,'"+Le.ToDatePicker.Date.ToString("dd MMM yyyy")+"')))"}}return"NULL"}if(61==e.ColumnCostCenterID&&"VehicleName"==e.Column){var Ge=e.CategoryText;return null!=e.ParentCDGDO&&(Ge+=e.Table),this.Entities.ContainsKey(Ge)?this.Entities[Ge]+".Make+'-'+"+this.Entities[Ge]+".Model+'-'+"+this.Entities[Ge]+".Variant":"NULL"}if(11396==e.FieldValue||11396==e.ParentCCDefaultColID||11689==e.FieldValue||11689==e.ParentCCDefaultColID){var ke="";if(12==this.StaticReportType)ke="Account";else if(this.Entities.ContainsKey(e.CategoryText))ke=e.CategoryText;else for(var Be=0;Be<this.Objects.length;Be++)if("acc_accounts"==s.e.LowerCase(this.Objects[Be].Table)){ke=this.Entities.keys[Be];break}if(s.e.IsEmpty(ke))return"0";var He,We=!1,Ue="",Ke="";(He=this.GetDimensionFilterForStock("DCC.dcCCNID")).length>0&&(Ke=" INNER JOIN COM_DocCCData DCC WITH(NOLOCK)  ON DCC.AccDocDetailsID=ACC.AccDocDetailsID"),11689==e.FieldValue||11689==e.ParentCCDefaultColID?(We=!0,He+=" AND (ACC.StatusID=370 or ACC.StatusID=439)"):(0==this.UnPostedDocsList.length?Ue=" AND (ACC.StatusID=369 or ACC.StatusID=429)":Ue+=" AND ACC.StatusID IN (369,429,"+this.UnPostedDocsList+")",He+=this.PDCInclude?" AND (ACC.StatusID=370 OR (ACC.DocumentType<>14 AND ACC.DocumentType<>19"+Ue+"))":" AND ACC.DocumentType<>14 AND ACC.DocumentType<>19"+Ue);var Qe=this.Filter.Fields.find((function(e){return 101==e.CDGDO.FieldValue||23145==e.CDGDO.FieldValue}));if(Qe)if(He+=" AND CONVERT(DATETIME,ACC.DocDate)","Between"==Qe.Condition.SelectedValue||"NotBetween"==Qe.Condition.SelectedValue)He+=Qe.Condition.SelectedItem.Parent,He+="'"+Qe.FromDatePicker.Date.ToString("dd MMM yyyy")+"' AND ",He+="'"+Qe.ToDatePicker.Date.ToString("dd MMM yyyy")+"'";else if("FUTURE"==Qe.Condition.SelectedValue||"PAST"==Qe.Condition.SelectedValue){var Xe=s.e.Int(Qe.FromValue.TextBox.Text);0==Xe&&(Xe=1),He+=" BETWEEN ","FUTURE"==Qe.Condition.SelectedValue?(He+="'"+Date.Today().ToString("dd MMM yyyy")+"' AND ",He+="'"+Date.Today().AddDays(Xe).ToString("dd MMM yyyy")+"'"):(He+="'"+Date.Today().AddDays(-Xe).ToString("dd MMM yyyy")+"' AND ",He+="'"+Date.Today().ToString("dd MMM yyyy")+"'")}else He+=Qe.Condition.SelectedItem.Parent,He+="'"+Qe.FromDatePicker.Date.ToString("dd MMM yyyy")+"'";else null!=this.oReportDialog&&(this.oReportDialog.FromDate.Visible||this.oReportDialog.ToDate.Visible)&&(He+=" AND ACC.DocDate",this.oReportDialog.FromDate.Visible&&(He+=">=CONVERT(float,CONVERT(DATETIME,'"+this.oReportDialog.FromDate.Date.ToString("dd MMM yyyy")+"'))"),this.oReportDialog.ToDate.Visible&&(He+="<=CONVERT(float,CONVERT(DATETIME,'"+this.oReportDialog.ToDate.Date.ToString("dd MMM yyyy")+"'))"));var je="(ISNULL((select SUM(Amount) FROM ACC_DocDetails ACC with(nolock)"+Ke+" WHERE ACC.DebitAccount="+this.Entities[ke]+".AccountID"+He+"),0)";return Ke.length>0&&!We&&(je+="+ISNULL((select SUM(Amount) FROM ACC_DocDetails ACC with(nolock) INNER JOIN COM_DocCCData DCC WITH(NOLOCK)  ON DCC.InvDocDetailsID=ACC.InvDocDetailsID WHERE ACC.DebitAccount="+this.Entities[ke]+".AccountID"+He+"),0)"),je+="-( ISNULL((select SUM(Amount) FROM ACC_DocDetails ACC with(nolock)"+Ke+"\nWHERE ACC.CreditAccount="+this.Entities[ke]+".AccountID"+He+"),0)",Ke.length>0&&!We&&(je+="+ISNULL((select SUM(Amount) FROM ACC_DocDetails ACC with(nolock) INNER JOIN COM_DocCCData DCC WITH(NOLOCK)  ON DCC.InvDocDetailsID=ACC.InvDocDetailsID\nWHERE ACC.CreditAccount="+this.Entities[ke]+".AccountID"+He+"),0)"),je+=")",je+=")"}if(101==e.FieldValue)return"NULL";if(8==e.ParentCostCenterID)try{var Ye,Je=e.CategoryValue;this.drrCCTbl=this.FieldsDialog.CostCenterTables.filter((function(e){return e.FeatureID==Je})),Ye=e.AssignedDimID>0&&this.Entities.ContainsKey("Documents_CCMAP")?this.Entities.Documents_CCMAP+".dcCCNID"+(e.CategoryValue-5e4):this.Entities[e.CategoryText.substr(0,e.CategoryText.lastIndexOf("."))]+"."+this.drrCCTbl[0].PK.toString();var qe=e.AssignedDimID>0?e.AssignedDimID:e.ParentCCDefaultColID;return this.drrCCTbl=this.FieldsDialog.CostCenterTables.filter((function(e){return e.FeatureID==qe})),"dbo.fnRPT_AssignedData("+Je+","+Ye+","+qe+",'"+this.drrCCTbl[0].TableName.toString()+"')"}catch(ze){return Logger.ErrorLog("Assigned: "+ze.stack),"#"}else if(25144==e.FieldValue||25144==e.ParentCCDefaultColID)try{return"dbo. fnGet_GetAssignedListForActivity("+this.Entities[e.CategoryText]+".ActivityID,0)"}catch(Ze){return"#"}else if(24246==e.FieldValue||25534==e.FieldValue||27252==e.FieldValue||27292==e.FieldValue)try{return this.drrCCTbl=this.FieldsDialog.CostCenterTables.filter((function(t){return t.FeatureID==e.CategoryValue})),"dbo.fnGet_GetAssignedListForFeatures("+e.CategoryValue+","+this.Entities[e.CategoryText]+"."+this.drrCCTbl[0].PK.toString()+")  "}catch($e){return"#"}else if(24246==e.ParentCCDefaultColID||25534==e.ParentCCDefaultColID||27252==e.ParentCCDefaultColID||27292==e.ParentCCDefaultColID)try{return this.drrCCTbl=this.FieldsDialog.CostCenterTables.filter((function(t){return t.FeatureID==e.ColumnCostCenterID})),"dbo.fnGet_GetAssignedListForFeatures("+e.ColumnCostCenterID+","+this.Entities[e.CategoryText]+"."+this.drrCCTbl[0].PK.toString()+")  "}catch(et){return"#"}}}}}return""}},{key:"IgnoreObject",value:function(e,t){return!(!this.IgnoreObjectsForFields.Contains(t.FieldValue)&&!this.IgnoreObjectsForFields.Contains(t.ParentCCDefaultColID))||8==t.ParentCostCenterID||null!=t.ChildCDGDO&&8==t.ChildCDGDO.ParentCostCenterID||0==t.CategoryValue&&0==t.FieldValue||!(205!=t.FieldValue&&206!=t.FieldValue&&207!=t.FieldValue||e.ShowAccountingData)||!(95!=t.CategoryValue&&103!=t.CategoryValue&&104!=t.CategoryValue&&129!=t.CategoryValue||"RentAmount"!=t.Column&&"DiscountAmount"!=t.Column&&"Discount"!=t.Column)}},{key:"ParseFormula",value:function(e,t){var o;if(e.FormulaErrorMessage="",188!=e.CDGDO.FieldValue){var i=new u.a;i.SetKeyWords("REPORT");var a=[];if(t){if(o=e.Formula.Text,n.IgnoreFormulas.Contains(o))return void(e.FormulaExpression="")}else o=e.Expression.Text;i.ParseFormula(o,a);for(var r,l="",D=!1,C=null,I=a.length-1;I>=0;I--){var h=a[I];r=h.getTokenValue().toString(),h.getTokenClass()!=u.d.OPERAND||null==C||C.getTokenClass()!=u.d.OPERAND?C=h:(C.SetAll("USERDEF",C.getTokenID(),u.d.OPERAND,u.e.REFERENCE,h.tokenValue.toString()+C.tokenValue.toString()),a.RemoveAt(I))}for(var d=0;d<a.length;d++){D=!1;var T=a[d];if(r=T.getTokenValue().toString(),T.getTokenClass()==u.d.OPERAND&&T.getTokenType()==u.e.REFERENCE){for(var y=0;y<this.BaseReportColumns.length;y++){var m=this.BaseReportColumns[y];if((!t||m!=e)&&0==s.e.stringCompare(m.Caption.Text.Replace(" ",""),r,!0)){D=!0,r=m.ID;break}}if(!D){for(var A=0;A<this.ReportGroups.length;A++){var p=this.ReportGroups[A];if(!s.e.IsEmpty(p.Prefix.Text)&&(p!=e||e.ID.length<33)&&0==s.e.stringCompare(p.Prefix.Text.Replace(" ",""),r,!0)){D=!0,r=p.ID;break}}if(!D&&(this.FieldsDialog.RefreshFieldsData_2(this.FieldsViewTbl,e.CDGDO.CategoryValue),this.FieldsView=this.FieldsViewTbl.filter((function(t){return t.CostCenterID==e.CDGDO.CategoryValue&&t.FormulaColumn==r})),this.FieldsView.length>0)){var E=void 0,N=new c.a;for(this.FieldsDialog.SetCDGDO_3(N,this.FieldsView[0],s.e.String(this.FieldsView[0].ParentCCDefaultColID)),E=0;E<this.FormulaObjects.length&&(this.FormulaObjects[E].CategoryValue!=N.CategoryValue||this.FormulaObjects[E].FieldValue!=N.FieldValue);E++);E==this.FormulaObjects.length&&this.FormulaObjects.push(N),r="F"+E}}}"STRING"==T.getTokenName()?l+='"'+r+'"':(T.getTokenType()==u.e.KEYWORD&&(l+=" "),l+=r,T.getTokenType()==u.e.KEYWORD&&(l+=" "))}if(t){if(e.FormulaExpression=l,e.FormulaExpression.startsWith("LEVEL")&&(e.CDGDO.FieldValue>=11377&&e.CDGDO.FieldValue<=11380||182==e.CDGDO.FieldValue))return void(e.FormulaExpression="");this.IsAuthLevelReport||(e.FormulaExpression.startsWith("LEVEL")?s.e.IsNum(e.FormulaExpression.substr(5))&&(this.IsAuthLevelReport=!0):this.CheckFormula(l,e.Formula.Text,e))}else e.ColumnFilterExpression=l,this.CheckFormula(l,e.Expression.Text,e)}else e.FormulaExpression=""}},{key:"CheckFormula",value:function(e,t,o){}},{key:"GetTextField_AllDocuments",value:function(e,t){return i.a.report.DataSet("RPT035",Math.abs(e).toString(),t)}},{key:"GetLatestOldestQuery",value:function(e,t,o){if(0==s.e.stringCompare(e.Formula,"LATEST",!0)){if(0==e.IsForeignKey)return 0==s.e.stringCompare(e.DataType,"DATE",!0)?"(select TOP 1 CONVERT(DATETIME,A."+e.Column+" ) from inv_docdetails A with(nolock) @CCWHERE@ where A.productid="+t+".productID AND A.costcenterid="+e.CategoryValue+" order by A.DocDate desc,A.CreatedDate desc)":e.Column.startsWith("dcCalcNum")||e.Column.startsWith("dcNum")?"(select TOP 1 N."+e.Column+" from inv_docdetails A with(nolock) inner join COM_DocNumData N with(nolock) on N.invdocdetailsid=A.invdocdetailsid @CCWHERE@ where A.productid="+t+".productID AND A.costcenterid="+e.CategoryValue+" order by A.DocDate desc,A.CreatedDate desc)":"(select TOP 1 A."+e.Column+" from inv_docdetails A with(nolock) @CCWHERE@ where A.productid="+t+".productID AND A.costcenterid="+e.CategoryValue+" order by A.DocDate desc,A.CreatedDate desc)";if(2==e.ParentCostCenterID)return"(select top 1 "+e.Column+" from ACC_Accounts with(nolock) where AccountID=(select TOP 1 A."+e.ParentColumn+" from inv_docdetails A with(nolock) @CCWHERE@\nwhere A.productid="+t+".productID AND A.costcenterid="+e.CategoryValue+" order by A.DocDate desc,A.CreatedDate desc))"}else if(0==s.e.stringCompare(e.Formula,"OLDEST",!0)){if(0==e.IsForeignKey)return 0==s.e.stringCompare(e.DataType,"DATE",!0)?"(select TOP 1 CONVERT(DATETIME,A."+e.Column+" ) from inv_docdetails A with(nolock) @CCWHERE@ where A.productid="+t+".productID AND A.costcenterid="+e.CategoryValue+" order by A.DocDate asc,A.CreatedDate asc)":e.Column.startsWith("dcCalcNum")||e.Column.startsWith("dcNum")?"(select TOP 1 N."+e.Column+" from inv_docdetails A with(nolock) inner join COM_DocNumData N with(nolock) on N.invdocdetailsid=A.invdocdetailsid @CCWHERE@ where A.productid="+t+".productID AND A.costcenterid="+e.CategoryValue+" order by A.DocDate asc,A.CreatedDate asc)":"(select TOP 1 A."+e.Column+" from inv_docdetails A with(nolock) @CCWHERE@ where A.productid="+t+".productID AND A.costcenterid="+e.CategoryValue+" order by A.DocDate asc,A.CreatedDate asc)";if(2==e.ParentCostCenterID)return"(select top 1 "+e.Column+" from ACC_Accounts with(nolock) where AccountID=(select TOP 1 A."+e.ParentColumn+" from inv_docdetails A with(nolock) @CCWHERE@\nwhere A.productid="+t+".productID AND A.costcenterid="+e.CategoryValue+" order by A.DocDate asc,A.CreatedDate asc))"}return"NULL"}},{key:"GetDimensionFilterForStock",value:function(e){var t="",o=0;null!=this.oReportDialog&&(o=this.oReportDialog.StockDimensionID);var n="";return null!=this.oReportDialog&&this.oReportDialog.Locations.Visible&&null!=this.oReportDialog.LocationWhere&&(n=s.e.IsEmpty(this.oReportDialog.LocationWhere)?"-1":this.oReportDialog.LocationWhere,t+=" AND "+e+(this.oReportDialog.StockDimensionID-5e4)+" IN ("+n+") "),(null!=this.oReportDialog?this.oReportDialog.CostCenterFilters:this.Filter.CostCenterFilters).forEach((function(n){if(n.SelectedNodes.length>0||!n.DeleteButtonVisibility)if(n.CostCenterID>5e4&&n.SelectedNodes.length>0&&n.CostCenterID!=o)if(t+=" AND ",1==n.SelectedNodes.length)t+=e+(n.CostCenterID-5e4)+"="+n.SelectedNodes[0].Id;else{t+=e+(n.CostCenterID-5e4)+" IN (";for(var i=0;i<n.SelectedNodes.length;i++)i>0&&(t+=","),t+=n.SelectedNodes[i].Id;t+=")"}else n.DeleteButtonVisibility||(t+=" AND ",t+=e+(n.CostCenterID-5e4)+"=-12912")})),t}},{key:"GetDimensionFilter",value:function(e){var t="",o=(null!=this.oReportDialog?this.oReportDialog.CostCenterFilters:this.Filter.CostCenterFilters).find((function(t){return t.CostCenterID==e}));if(!o)return"";if(o.SelectedNodes.length>0||!o.DeleteButtonVisibility)if(o.CostCenterID>5e4&&o.SelectedNodes.length>0)if(1==o.SelectedNodes.length)t+=o.SelectedNodes[0].Id;else for(var n=0;n<o.SelectedNodes.length;n++)n>0&&(t+=","),t+=o.SelectedNodes[n].Id;else o.DeleteButtonVisibility||(t+="-12912");return t}},{key:"GetLink_IDColumn",value:function(e,t){if("3"==t.LinkType.SelectedValue||"4"==t.LinkType.SelectedValue){var o=t.CDGDO.IsForeignKey?t.CDGDO.ParentCostCenterID:t.CDGDO.CategoryValue;if(400!=o&&(o<4e4||o>5e4)&&"NULL"!=t.CDGDO.ActualColumn)return this.drrCCTbl=this.FieldsDialog.CostCenterTables.filter((function(e){return e.FeatureID==o})),","+e+"."+this.drrCCTbl[0].PK.toString()+" AS ["+t.ID+"_ID]"}return""}},{key:"SetExtFunctionParams",value:function(e,t){return"EF_FROMDATE"==e?"ReportViewModel"==this.ClassName?(this.SetDatePickers(),t+="'"+this.FromDatePicker.Date.ToString("dd MMM yyyy")+"'"):112!=this.StaticReportType&&165!=this.StaticReportType||(t+="'EF_FROMDATE'"):"EF_TODATE"==e?"ReportViewModel"==this.ClassName?(this.SetDatePickers(),t+="'"+this.ToDatePicker.Date.ToString("dd MMM yyyy")+"'"):112!=this.StaticReportType&&165!=this.StaticReportType||(t+="'EF_TODATE'"):"EF_ASONDATE"==e?112!=this.StaticReportType&&165!=this.StaticReportType||(t+="'EF_ASONDATE'"):"EF_LoginLocationID"==e&&"ReportViewModel"==this.ClassName?t+=i.a.SessionManager.LocationID:"EF_LoginDivisionID"==e&&"ReportViewModel"==this.ClassName?t+=i.a.SessionManager.DivisionID:"EF_USERID"==e?t+=i.a.SessionManager.UserID:"EF_USERNAME"==e&&(t+="'"+i.a.SessionManager.UserName+"'"),t}},{key:"GetAddressColumn",value:function(e){if(e.startsWith("CCNID")){var t=s.e.GetTagTableName(5e4+parseInt(e.substring(5)));e="(select Name from "+t+" with(nolock) where NodeID=A."+e+")"}return e}},{key:"ShowFilter",get:function(){return this._ShowFilter},set:function(e){e!=this._ShowFilter&&(e?(this.ShowReport=!1,this.ShowStaticFilter=!1,this.ShowPrintDesigner=!1,this.ShowOptions=!1):null!=this.PrefetchReportTreeFilter&&(this.PrefetchReportTreeFilter.ReportWidth="480",this.PrefetchReportTreeFilter.ReportHeight="430"),this._ShowFilter=e)}},{key:"ShowStaticFilter",get:function(){return this._ShowStaticFilter},set:function(e){e!=this._ShowStaticFilter&&(e?(this.ShowFilter=!1,this.ShowReport=!1,this.ShowPrintDesigner=!1,this.ShowOptions=!1):null!=this.PrefetchReportTreeFilter&&(this.PrefetchReportTreeFilter.ReportWidth="480",this.PrefetchReportTreeFilter.ReportHeight="430"),this._ShowStaticFilter=e)}},{key:"ShowReport",get:function(){return this._ShowReport},set:function(e){e!=this._ShowReport&&(e&&(this.ShowFilter=!1,this.ShowStaticFilter=!1,this.ShowPrintDesigner=!1,this.ShowOptions=!1,this.ShowMasters=!1,this.IsSSRS?(this.ReportVisibility=!1,this.SSRSVisibility=!0,this.ShowRightPanel=!1):this.ReportVisibility=!0,this.Chart&&this.Chart.RefreshChart()),this._ShowReport=e)}},{key:"ReportVisibility",get:function(){return this._ReportVisibility},set:function(e){e!=this._ReportVisibility&&(e&&(this.ShowMasters=!1),this._ReportVisibility=e)}},{key:"ShowMasters",get:function(){return this._ShowMasters},set:function(e){e!=this._ShowMasters&&(e&&(this.ReportVisibility=!1),this._ShowMasters=e)}},{key:"ShowPrintDesigner",get:function(){return this._ShowPrintDesigner},set:function(e){}},{key:"ShowOptions",get:function(){return this._ShowOptions},set:function(e){e!=this._ShowOptions&&(e&&(this.ShowFilter=!1,this.ShowReport=!1,this.ShowStaticFilter=!1,this.ShowPrintDesigner=!1),this._ShowOptions=e)}}],[{key:"IPrefetchFilter",value:function(){n.HistoryTables.push(11375,["INV_DocDetails","ACC_DocDetails","COM_DocCCData","COM_DocNumData","COM_DocTextData"]),n.HistoryTables.push(11490,["INV_DocDetails","ACC_DocDetails","COM_DocCCData","COM_DocNumData","COM_DocTextData"]),n.HistoryTables.push(53517,["REN_Contract","REN_ContractExtended","REN_ContractParticulars","REN_ContractPayTerms"]),n.HistoryTables.push(11418,["ACC_Accounts","ACC_AccountsExtended"]),n.HistoryTables.push(11419,["INV_Product","INV_ProductExtended"]),n.HistoryTables.push(11684,["PRD_BillOfMaterial","PRD_BillOfMaterialExtended","PRD_BOMProducts","PRD_BOMResources","PRD_BOMStages"]),n.HistoryTables.push(191,["ADM_Users"]),n.HistoryTables.push(11701,["COM_Division","COM_CCCCDATA"]),n.HistoryTables.push(11702,["COM_Location","COM_CCCCDATA"]),n.HistoryTables.push(11703,["COM_Branch","COM_CCCCDATA"]),n.HistoryTables.push(11704,["COM_Department","COM_CCCCDATA"]),n.HistoryTables.push(11705,["COM_Salesman","COM_CCCCDATA"]),n.HistoryTables.push(11706,["COM_Category","COM_CCCCDATA"]),n.HistoryTables.push(11707,["COM_Area","COM_CCCCDATA"]),n.HistoryTables.push(11708,["COM_Teritory","COM_CCCCDATA"]);for(var e=9;e<=50;e++)n.HistoryTables.push(11700+e,["COM_CC"+(5e4+e),"COM_CCCCDATA"]);n.HistoryTables.push(11751,["COM_CC50051","COM_CCCCDATA"]),n.HistoryTables.push(12109,["PAY_EmpPay"]),n.HistoryTables.push(11951,["PAY_EmpDetail"]),n.HistoryTables.push(11952,["PAY_EmpDetail"]),n.HistoryTables.push(11953,["PAY_EmpDetail"]),n.HistoryTables.push(11954,["PAY_EmpDetail"]),n.HistoryTables.push(11955,["PAY_EmpDetail"])}},{key:"IsGroupTree",value:function(e){return(2==e.CostCenterID||3==e.CostCenterID||e.CostCenterID>5e4)&&(e.SelectedNodes.filter((function(e){return e.IsGroup})).length>0||!(""==i.a.SessionManager.Preferences.DynamicTrees||!i.a.SessionManager.Preferences.DynamicTrees.split(",").Contains(e.CostCenterID.toString())))}}]),o}(l.b)).dtExDocs=new a.c,n.ForeignMAPTables=["COM_ADDRESS","CRM_ACTIVITIES","CRM_FEEDBACK","COM_NOTES","CRM_LEADCVRDETAILS","COM_CONTACTS"],n.HistoryTables=new a.c,n.IgnoreFormulas=["FOR_PERIOD","AFTER_PERIOD"],n)},USNh:function(e,t,o){"use strict";o.d(t,"b",(function(){return C})),o.d(t,"a",(function(){return u})),o.d(t,"c",(function(){return c})),o.d(t,"d",(function(){return I}));var n,i=o("Do2H"),s=o("Lp6j"),a=o("EQd/"),r=o("0/4Q"),l=o("ScVY"),D=o("NkMH"),C=((n=function(){function e(t,o){var s=this;_classCallCheck(this,e),this.FormulaExpression="",this.ColumnFilterExpression="",this.FormulaErrorMessage="",this.ColumnFiltersXML="",this.SubTotalXML="",this.ColumnFiltersUsed=[],this.ID=null,this.SubTotalRoundOffs=null,this.IsGroup=!1,this.IsReportMappingFilter=!1,this.IgnoreCheckedEvent=!1,this.Screen=null,this.DimensionsFilterVisible=!1,this.ALLOtherDocsVisible=!1,this.LINKINGExpanderVisibility=!1,this.RepeatExpanderVisibility=!0,this.RepeatPrevDataFull=!1,this.RepeatPrevDiff=!1,this.RepeatPrevPercent=!1,this.RepeatPrevDataOfCurrYr=!1,this.RepeatPrevDataSeperately=!1,this.Screen=t,this.IsGroup=o,this.CDGDO=new u,this.Caption=new a.d(0),this.Caption.Label=i.a.GetResource("Reports_Caption"),this.ArabicCaption=new a.d(0),this.ArabicCaption.Label=i.a.GetResource("Reports_ArabicCaption"),this.Type=new a.d(0),this.Type.Label=i.a.GetResource("AccountCreate_Type"),this.Type.Visible=!1,this.CType=new r.e(0),this.CType.Visible=!0,this.CType.Items=n.CTypeList,this.CType.SelectedValue="FLOAT",this.Formula=new a.d(0),this.Formula.Label=i.a.GetResource("DocumentDesigner_Formula"),this.FormulaEvaluateAtEnd=new r.e(0),this.FormulaEvaluateAtEnd.Label=i.a.GetResource("Reports_EvaluateAtEnd"),this.FormulaEvaluateAtEnd.Items=n.items_Evaluate,this.FormulaEvaluateAtEnd.SelectedValue="1",this.Prefix=new a.d(0),this.Prefix.Label=i.a.GetResource("Reports_Prefix"),this.Prefix.TextChangedCommand.Subscribe(this,"OnPrefixChanged"),this.DisplayMode=new r.e(0),this.DisplayMode.Label=i.a.GetResource("DisplayMode"),this.DisplayMode.Items.push(r.d.ComboBoxItems_2("Detailed","Detailed")),this.DisplayMode.Items.push(r.d.ComboBoxItems_2("Summary","Summary")),this.DisplayMode.SelectedValue="Detailed",this.DisplayMode.SelectedItem=this.DisplayMode.Items[0],this.ShowAsColumn=new r.e(0),this.ShowAsColumn.Label=i.a.GetResource("Reports_ShowAsColumn"),this.ShowAsColumn.Items=n.cmbTrueFalse,this.ShowAsColumn.SelectedValue="0",this.ShowAsColumn.SelectedItem=this.ShowAsColumn.Items[1],this.ShowCaption=new r.e(0),this.ShowCaption.Label="Show Caption",this.ShowCaption.SelectedValue="1",this.ShowLevel=new r.e(0),this.ShowLevel.Label=i.a.GetResource("Reports_ShowLevel"),this.ShowLevel.Items=n.items_ShowLevel,this.ShowLevel.SelectedValue="0",this.ShowLevel.SelectionChangedCommand.Subscribe(this,"OnSelectionChanged"),this.ShowAssigned=new r.e(0),this.ShowAssigned.Label=i.a.GetResource("Assigned"),null!=t&&null!=t.FieldsDialog&&(t.FieldsDialog.ReportFilterCostCenterList.filter((function(e){return e.FeatureID>5e4})).sort((function(e,t){return e.Name>t.Name})).forEach((function(e){s.ShowAssigned.Items.push(r.d.ComboBoxItems_2(e.Name.toString(),e.FeatureID.toString()))})),this.ShowAssigned.Items.length>0&&(this.ShowAssigned.SelectedValue=this.ShowAssigned.Items[0].Value)),this.ExecutedDocument=new r.b(0),this.ExecutedDocument.Label="Executed Document",this.ExecutedDocument.Visible=!1,null!=t&&(this.ExecutedDocument.Items=t.ListOfInvDocuments,this.ExecutedDocument.CheckedChangedCommand.Subscribe(this,"OnListBoxCheckedChanged")),this.AccountingDocument=new r.b(0),this.AccountingDocument.Label="Accounting Documents",this.AccountingDocument.Visible=!1,null!=t&&(this.AccountingDocument.Items=t.ListOfAccEffectDocuments,this.AccountingDocument.CheckedChangedCommand.Subscribe(this,"OnListBoxCheckedChanged")),this.Alignment_Header=new r.e(0),this.Alignment_Header.Label=i.a.GetResource("Reports_Alignment"),this.Alignment_Header.Items=n.items_Alignment,this.Alignment_Header.SelectedValue="Center",this.Alignment_Header.SelectionChangedCommand.Subscribe(this,"OnSelectionChanged"),this.BackgroundClr_Header=new a.d(0),this.BackgroundClr_Header.Label=i.a.GetResource("Reports_BackgroundClr"),this.BackgroundClr_Header.Text="#FFFFFFFF",this.ForegroundClr_Header=new a.d(0),this.ForegroundClr_Header.Label=i.a.GetResource("Reports_ForegroundClr"),this.ForegroundClr_Header.Text="#FF000000",this.Font_Header=new r.e(0),this.Font_Header.Label=i.a.GetResource("Reports_Font"),this.Font_Header.Items=n.FontItems,this.Font_Header.SelectedValue="Calibri",this.FontSize_Header=new a.d(0),this.FontSize_Header.Label=i.a.GetResource("Reports_FontSize"),this.FontSize_Header.DataType="INT",this.FontSize_Header.Text="12",this.FontStyle_Header=new D.a,this.FontStyle_Header.Label=i.a.GetResource("Reports_FontStyle"),this.Bold_Header=new D.a,this.Italic_Header=new D.a,this.Underline_Header=new D.a,this.Width=new a.d(0),this.Width.Label=i.a.GetResource("ListView_Width"),this.Width.DataType="INT",this.Width.Text="120",this.Height=new a.d(0),this.Height.Label=i.a.GetResource("Reports_Height"),this.Height.DataType="INT",this.Height.Text="22",this.Alignment=new r.e(0),this.Alignment.Label=i.a.GetResource("Reports_Alignment"),this.Alignment.Items=n.items_Alignment,this.Alignment.SelectedValue="Left",this.BackgroundClr=new a.d(0),this.BackgroundClr.Label=i.a.GetResource("Reports_BackgroundClr"),this.BackgroundClr.Text="#FFFFFFFF",this.ForegroundClr=new a.d(0),this.ForegroundClr.Label=i.a.GetResource("Reports_ForegroundClr"),this.ForegroundClr.Text="#FF000000",this.Font=new r.e(0),this.Font.Label=i.a.GetResource("Reports_Font"),this.Font.Items=n.FontItems,this.Font.SelectedValue="Calibri",this.FontSize=new a.d(0),this.FontSize.Label=i.a.GetResource("Reports_FontSize"),this.FontSize.DataType="INT",this.FontSize.Text="13",this.FontStyle=new D.a,this.FontStyle.Label=i.a.GetResource("Reports_FontStyle"),this.Visibility=new r.e(0),this.Visibility.Label=i.a.GetResource("Reports_Visibility"),this.Visibility.Items=n.cmbTrueFalse,this.Visibility.SelectedValue="1",this.PrintVisibility=new r.e(0),this.PrintVisibility.Label="Print Visibility",this.PrintVisibility.Items=n.cmbTrueFalse,this.PrintVisibility.SelectedValue="1",this.Row=new a.d(0),this.Row.Label=i.a.GetResource("Reports_Row"),this.Row.DataType="INT",this.Row.Text="0",this.Column=new a.d(0),this.Column.Label=i.a.GetResource("Reports_Column"),this.Column.DataType="INT",this.Column.Text="0",this.Bold=new D.a,this.Italic=new D.a,this.Underline=new D.a,this.ShowUnder=new r.e(0),this.ShowUnder.Label=i.a.GetResource("Reports_ShowUnder"),null!=t&&(this.ShowUnder.Items=t.ShowUnder),this.STShowCollapsable=new r.e(0),this.STShowCollapsable.Label="Show @ Collapase",this.STShowCollapsable.Items=n.cmbTrueFalse,this.STShowCollapsable.SelectedValue="0",this.STShowCollapsable.Visible=!1,this.Border=new r.e(0),this.Border.Label=i.a.GetResource("Reports_Border"),this.Border.Visible=!1,this.Decimals=new r.e(0),this.Decimals.Label=i.a.GetResource("Reports_Decimals"),this.Decimals.Items=n.items_Decimals,this.Decimals.SelectedValue="-1",this.RoundOff=new a.d(0),this.RoundOff.Label=i.a.GetResource("Reports_Data"),this.RoundOff.DataType="FLOAT",this.RoundOff.Text="0.0",this.RoundOff_RT=new a.d(0),this.RoundOff_RT.Label=i.a.GetResource("Reports_ReportTotal2"),this.RoundOff_RT.DataType="FLOAT",this.RoundOff_RT.Text="0.0",this.RoundOff_ST=[],this.Commas=new r.e(0),this.Commas.Label=i.a.GetResource("Reports_Commas"),this.Commas.Items=n.items_Commas,this.Commas.SelectedValue="-1",this.Currency=new r.e(0),this.Currency.Label=i.a.GetResource("Reports_Currency"),this.Currency.Items=n.cmbTrueFalse,this.Currency.SelectedValue="0",this.NegativeNumber=new r.e(0),this.NegativeNumber.Label=i.a.GetResource("Reports_NegativeNumber"),this.NumberFormat=new a.d(0),this.NumberFormat.Text="",this.ShowAvg=new r.e(0),this.ShowAvg.Label="Show Average",this.ShowAvg.Items=n.cmbTrueFalse,this.ShowAvg.SelectedValue="0",this.ShowDefaultSign=new r.e(0),this.ShowDefaultSign.Label=i.a.GetResource("Reports_ShowDefaultSign"),this.ShowDefaultSign.Items=n.cmbTrueFalse,this.ShowDefaultSign.SelectedValue="0",this.PercentageOn=new r.e(0),this.PercentageOn.Label=i.a.GetResource("Reports_ShowPercentage"),null!=t&&(this.PercentageOn.Items=t.PercentageOnFields),this.PercentageOn.SelectedValue="",this.CumulativeTotals=new r.e(0),this.CumulativeTotals.Label="Cumulative Totals",this.CumulativeTotals.Items=n.items_CumulativeTotals,this.CumulativeTotals.SelectedValue="",this.PrevRowValue=new r.e(0),this.PrevRowValue.Label="Prev Row Value",null!=t&&(this.PrevRowValue.Items=t.PercentageOnFields),this.PrevRowValue.SelectedValue="",this.Expression=new a.d(0),this.Expression.Label=i.a.GetResource("Reports_Expression"),this.Sort=new r.e(0),this.Sort.Label=i.a.GetResource("Reports_Sort"),this.Sort.Items=n.items_Sort,this.Sort.SelectedValue="",this.Sort.Visible=!0,this.WrapText=new r.e(0),this.WrapText.Label=i.a.GetResource("Reports_WrapText"),this.WrapText.Items=n.cmbTrueFalse,this.WrapText.SelectedValue="0",this.WrapTextPrint=new r.e(0),this.WrapTextPrint.Label="Wrap Text(Print)",this.WrapTextPrint.Items=n.cmbTrueFalse,this.WrapTextPrint.SelectedValue="1",this.PrintChars=new a.d(0),this.PrintChars.Label="Print Chars",this.PrintChars.Text="0",this.PrintOnce=new r.e(0),this.PrintOnce.Label=i.a.GetResource("Reports_PrintOnce"),this.PrintOnce.Items=n.cmbTrueFalse,this.PrintOnce.SelectedValue="0",this.SuppressZero=new r.e(0),this.SuppressZero.Label="Suppress Zero",this.SuppressZero.Items=n.cmbTrueFalse,this.SuppressZero.SelectedValue="0",this.PinnedColumn=new r.e(0),this.PinnedColumn.Label=i.a.GetResource("Pinned Column"),this.PinnedColumn.Items=n.cmbTrueFalse,this.PinnedColumn.SelectedValue="0",this.DateType=new r.e(0),this.DateType.Label=i.a.GetResource("Reports_DateType"),this.DateType.Items=n.items_DateType,this.DateType.Text=i.a.SessionManager.Preferences["Date Format"],this.LinkType=new r.e(0),this.LinkType.Label=i.a.GetResource("Reports_LinkType"),this.LinkType.Items=n.items_LinkType,this.LinkType.SelectedValue="0",this.LinkType.SelectionChangedCommand.Subscribe(this,"OnSelectionChanged"),this.LinkDimension=new r.e(0),this.LinkDimension.Label="Show",this.LinkDimension.Items=n.items_LinkDocument,this.LinkDimension.SelectedValue="0",this.LinkDimension.Visible=!1,this.LinkDimensionView=new r.e(0),this.LinkDimensionView.Label="",this.LinkDimensionView.Items=n.items_LinkDimensionView,this.LinkDimensionView.SelectedValue="0",this.LinkDimensionView.Visible=!1,this.LinkReport=new r.e(0),this.LinkReport.Label="Link Report",this.LinkReport.Items=null!=t?t.MappedReportsList:null,this.LinkReport.SelectedValue="0",this.LinkReport.Visible=!1,this.RepeatType=new r.e(0),this.RepeatType.Label=i.a.GetResource("Reports_RepeatType"),this.RepeatType.SelectedValue="0",this.RepeatType.Items.push(r.d.ComboBoxItems_2("None","0")),null!=t&&111==t.StaticReportType?this.RepeatType.Items.push(r.d.ComboBoxItems_2("Repeat","1")):this.RepeatType.Items=n.items_RepeatType,this.RepeatNext=new a.d(0),this.RepeatNext.Label=i.a.GetResource("Reports_RepeatNext"),this.RepeatNext.Text="0",this.RepeatOn=new r.e(0),this.RepeatOn.Label=i.a.GetResource("Reports_RepeatOn"),null!=t&&(this.RepeatOn.Items=t.ReportNonNumericFields),this.RepeatEmptyColumns=new r.e(0),this.RepeatEmptyColumns.Label="Empty Columns",this.RepeatEmptyColumns.Items=n.items_RepeatEmptyCol,this.RepeatEmptyColumns.SelectedValue="0",this.UseOnce=new r.e(0),this.UseOnce.Label=i.a.GetResource("Reports_UseOnce"),this.UseOnce.Items=n.items_UseOnce,this.UseOnce.SelectedValue="0",this.RepeatPrevData=new r.e(0),this.RepeatPrevData.SelectedValue="0",this.RepeatPrevData.Items=n.items_RepeatPrevData,o&&(this.ShowAsColumn.SelectionChangedCommand.Subscribe(this,"OnShowAsColumnChange"),this.ShowCaption.Visible=!1,this.Width.Text="-1"),this.SetDataType(),this.Bold.Enable=!1,this.Bold_Header.Enable=!0,this.Italic.Enable=!1,this.Italic_Header.Enable=!1,this.Underline.Enable=!1,this.Underline_Header.Enable=!1}return _createClass(e,[{key:"OnButtonClick",value:function(e){}},{key:"OnSelectionChanged",value:function(e){"LinkType"==e&&("1"==this.LinkType.SelectedValue?(this.LinkDimension.Visible=!0,this.LinkDimension.Label="Show",this.LinkDimension.Items=n.items_LinkDocument,this.LinkDimensionView.Visible=!1):"3"==this.LinkType.SelectedValue?(this.LinkDimension.Visible=!0,this.LinkDimension.Label="Link Dimension",this.LinkDimension.Items=n.items_LinkDimension,this.LinkDimensionView.Visible=!0):"9"==this.LinkType.SelectedValue?(this.LinkDimension.Visible=!0,this.LinkDimension.Label="Type",this.LinkDimension.Items=n.items_LinkAdd,this.LinkDimensionView.Visible=!1):(this.LinkDimension.SelectedValue="0",this.LinkDimension.Visible=!1,this.LinkDimensionView.Visible=!1),this.LinkReport.Visible="6"==this.LinkType.SelectedValue)}},{key:"OnListBoxCheckedChanged",value:function(e){}},{key:"SetDataType",value:function(){this.Type.DBColumnName=this.CDGDO.DataType,0!=this.CDGDO.FieldValue&&214!=this.CDGDO.FieldValue?(this.Type.Text=this.CDGDO.DataType,this.Type.Visible=!0,this.CType.Visible=!1):(this.CType.SelectedValue=this.CDGDO.DataType,this.CType.Visible=!0,this.Type.Visible=!1),this.Decimals.Visible=!1,this.RoundOff.Visible=!1,this.RoundOff_RT.Visible=!1,this.Commas.Visible=!1,this.SuppressZero.Visible=!1,this.Currency.Visible=!1,this.NegativeNumber.Visible=!1,this.PercentageOn.Visible=!1,this.CumulativeTotals.Visible=!1,this.PrevRowValue.Visible=!1,this.Expression.Visible=!1,this.WrapText.Visible=!1,this.PinnedColumn.Visible=!1,this.WrapTextPrint.Visible=!1,this.PrintChars.Visible=!1,this.NumberFormat.Visible=!1,this.ShowAvg.Visible=!1,this.DateType.Visible=!1,this.ShowLevel.Visible=!1,this.ALLOtherDocsVisible=!1,this.ShowAssigned.Visible=this.CDGDO.ParentCostCenterID>5e4&&null!=this.CDGDO.ChildCDGDO&&8==this.CDGDO.ChildCDGDO.ParentCostCenterID,"INT"==this.CDGDO.DataType||"FLOAT"==this.CDGDO.DataType||"Float"==this.CDGDO.DataType||"TIME"==this.CDGDO.DataType?(this.Decimals.Visible=!0,this.RoundOff.Visible=!0,this.RoundOff_RT.Visible=!0,this.Commas.Visible=!0,this.SuppressZero.Visible=!0,this.Currency.Visible=!0,this.NegativeNumber.Visible=!0,this.PercentageOn.Visible=!0,this.CumulativeTotals.Visible=!0,this.PrevRowValue.Visible=!0,this.Expression.Visible=!0,this.WrapText.Visible=!0,this.NumberFormat.Visible=!0,this.ShowAvg.Visible=!0,this.CDGDO.CategoryValue>-5e4&&this.CDGDO.CategoryValue<-4e4&&(this.ALLOtherDocsVisible=!0,this.ALLOtherDocsLabel="Other Documents")):"Date"==this.CDGDO.DataType||"DATE"==this.CDGDO.DataType?this.DateType.Visible=!0:"IMAGE"==this.CDGDO.DataType?(this.WrapText.Visible=!0,this.WrapText.Label="Stretch Image"):(this.WrapText.Label=i.a.GetResource("Reports_WrapText"),this.Expression.Visible=!0,this.WrapText.Visible=!0,this.WrapTextPrint.Visible=!0,this.PrintChars.Visible=!0,this.ShowLevel.Visible=!0),Screen,!this.IsGroup&&Screen,170==this.CDGDO.FieldValue||182==this.CDGDO.FieldValue||189==this.CDGDO.FieldValue||11361==this.CDGDO.FieldValue||11415==this.CDGDO.FieldValue||11509==this.CDGDO.FieldValue||11510==this.CDGDO.FieldValue||27266==this.CDGDO.FieldValue||11484==this.CDGDO.FieldValue||13964==this.CDGDO.FieldValue||11514==this.CDGDO.FieldValue?(this.ExecutedDocument.Visible=!0,0==this.ExecutedDocument.Items.length&&Screen,182!=this.CDGDO.FieldValue&&11361!=this.CDGDO.FieldValue&&11415!=this.CDGDO.FieldValue&&27266!=this.CDGDO.FieldValue||(this.ALLOtherDocsVisible=!0,this.ALLOtherDocsLabel="For Documents")):this.ExecutedDocument.Visible=!1,11691==this.CDGDO.FieldValue&&(this.LinkType.SelectedValue="5"),this.AccountingDocument.Visible="FutureTrDedit"==this.ID||"FutureTrCredit"==this.ID,this.DimensionsFilterVisible=97==this.CDGDO.FieldValue||98==this.CDGDO.FieldValue||99==this.CDGDO.FieldValue||214==this.CDGDO.FieldValue||11362==this.CDGDO.FieldValue||11420==this.CDGDO.FieldValue||-173==this.CDGDO.ParentCostCenterID||26419==this.CDGDO.ParentCCDefaultColID||26420==this.CDGDO.ParentCCDefaultColID||50453==this.CDGDO.ParentCCDefaultColID}},{key:"OnShowAsColumnChange",value:function(e){}},{key:"OnPrefixChanged",value:function(e){}},{key:"ColumnFiltersColor",get:function(){return s.e.IsEmpty(this.ColumnFiltersXML)?null:"#FF00A9DA"}}],[{key:"ColumnProperties",value:function(){n.cmbTrueFalse.push(r.d.ComboBoxItems_2("True","1")),n.cmbTrueFalse.push(r.d.ComboBoxItems_2("False","0")),n.items_Evaluate.push(r.d.ComboBoxItems_2("True","1")),n.items_Evaluate.push(r.d.ComboBoxItems_2("False","0")),n.items_Evaluate.push(r.d.ComboBoxItems_2("Repeat/Matrix/Tree Group","2")),n.items_Evaluate.push(r.d.ComboBoxItems_2("Tree Node","3")),n.items_ShowLevel.push(r.d.ComboBoxItems_2("False","0")),n.items_ShowLevel.push(r.d.ComboBoxItems_2("True","1")),n.items_ShowLevel.push(r.d.ComboBoxItems_2("True (Totals At End)","2")),n.FontItems.push(r.d.ComboBoxItems_2("Arial","Arial")),n.FontItems.push(r.d.ComboBoxItems_2("Calibri","Calibri")),n.FontItems.push(r.d.ComboBoxItems_2("Times New Roman","Times New Roman")),n.FontItems.push(r.d.ComboBoxItems_2("Algerian","Algerian")),n.FontItems.push(r.d.ComboBoxItems_2("Verdana","Verdana")),n.FontItems.push(r.d.ComboBoxItems_2("Elephant","Elephant")),n.FontItems.push(r.d.ComboBoxItems_2("Bernard MT","Bernard MT")),n.FontItems.push(r.d.ComboBoxItems_2("Century Gothic","Century Gothic")),n.FontItems.push(r.d.ComboBoxItems_2("Code Pro Lc","Code Pro Lc")),n.CTypeList.push(r.d.ComboBoxItems_2("FLOAT","FLOAT")),n.CTypeList.push(r.d.ComboBoxItems_2("DATE","DATE")),n.CTypeList.push(r.d.ComboBoxItems_2("TIME","TIME")),n.CTypeList.push(r.d.ComboBoxItems_2("STRING","STRING")),n.items_Alignment.push(r.d.ComboBoxItems_2("Left","Left")),n.items_Alignment.push(r.d.ComboBoxItems_2("Center","Center")),n.items_Alignment.push(r.d.ComboBoxItems_2("Right","Right")),n.items_Decimals.push(r.d.ComboBoxItems_2("0","0")),n.items_Decimals.push(r.d.ComboBoxItems_2("GP","-1")),n.items_Decimals.push(r.d.ComboBoxItems_2("1","1")),n.items_Decimals.push(r.d.ComboBoxItems_2("2","2")),n.items_Decimals.push(r.d.ComboBoxItems_2("3","3")),n.items_Decimals.push(r.d.ComboBoxItems_2("4","4")),n.items_Decimals.push(r.d.ComboBoxItems_2("5","5")),n.items_Decimals.push(r.d.ComboBoxItems_2("6","6")),n.items_Decimals.push(r.d.ComboBoxItems_2("7","7")),n.items_Decimals.push(r.d.ComboBoxItems_2("8","8")),n.items_Decimals.push(r.d.ComboBoxItems_2("9","9")),n.items_Commas.push(r.d.ComboBoxItems_2("None","0")),n.items_Commas.push(r.d.ComboBoxItems_2("GP","-1")),n.items_Commas.push(r.d.ComboBoxItems_2("Millions","1")),n.items_Commas.push(r.d.ComboBoxItems_2("Lakhs","2")),n.items_CumulativeTotals.push(r.d.ComboBoxItems_2("False","")),n.items_CumulativeTotals.push(r.d.ComboBoxItems_2("True","0")),n.items_CumulativeTotals.push(r.d.ComboBoxItems_2("Till Group 1","1")),n.items_CumulativeTotals.push(r.d.ComboBoxItems_2("Till Group 2","2")),n.items_CumulativeTotals.push(r.d.ComboBoxItems_2("Till Group 3","3")),n.items_CumulativeTotals.push(r.d.ComboBoxItems_2("Till Group 4","4")),n.items_CumulativeTotals.push(r.d.ComboBoxItems_2("Till Group 5","5")),n.items_CumulativeTotals.push(r.d.ComboBoxItems_2("For Repeat Columns","-2")),n.items_Sort.push(r.d.ComboBoxItems_2("None","")),n.items_Sort.push(r.d.ComboBoxItems_2("Ascending","ASC")),n.items_Sort.push(r.d.ComboBoxItems_2("Descending","DESC")),n.items_Sort.push(r.d.ComboBoxItems_2("Ascending (Numeric)","NUM ASC")),n.items_Sort.push(r.d.ComboBoxItems_2("Descending (Numeric)","NUM DESC")),n.items_Sort.push(r.d.ComboBoxItems_2("Tree Order","TREE ASC")),n.items_DateType.push(r.d.ComboBoxItems_2("None","None")),n.items_DateType.push(r.d.ComboBoxItems_2("dd/MM/yyyy","dd/MM/yyyy")),n.items_DateType.push(r.d.ComboBoxItems_2("MM/dd/yyyy","MM/dd/yyyy")),n.items_DateType.push(r.d.ComboBoxItems_2("dd/MMM/yyyy","dd/MMM/yyyy")),n.items_DateType.push(r.d.ComboBoxItems_2("MMM/dd/yyyy","MMM/dd/yyyy")),n.items_DateType.push(r.d.ComboBoxItems_2("dd-MM-yyyy","dd-MM-yyyy")),n.items_DateType.push(r.d.ComboBoxItems_2("dd-MM-yy","dd-MM-yy")),n.items_DateType.push(r.d.ComboBoxItems_2("dd-MMM-yyyy","dd-MMM-yyyy")),n.items_DateType.push(r.d.ComboBoxItems_2("MMM-yy","MMM-yy")),n.items_DateType.push(r.d.ComboBoxItems_2("MMM-yyyy","MMM-yyyy")),n.items_DateType.push(r.d.ComboBoxItems_2("MMM/yy","MMM/yy")),n.items_DateType.push(r.d.ComboBoxItems_2("MMM/yyyy","MMM/yyyy")),n.items_DateType.push(r.d.ComboBoxItems_2("MMM","MMM")),n.items_DateType.push(r.d.ComboBoxItems_2("MMMM","MMMM")),n.items_DateType.push(r.d.ComboBoxItems_2("yyyy","yyyy")),n.items_DateType.push(r.d.ComboBoxItems_2("HH:mm","HH:mm")),n.items_DateType.push(r.d.ComboBoxItems_2("hh:mm a","hh:mm a")),n.items_DateType.push(r.d.ComboBoxItems_2("dd/MM/yyyy hh:mm","dd/MM/yyyy hh:mm a")),n.items_DateType.push(r.d.ComboBoxItems_2("MM/dd/yyyy hh:mm","MM/dd/yyyy hh:mm a")),n.items_DateType.push(r.d.ComboBoxItems_2("dd/MMM/yyyy hh:mm","dd/MMM/yyyy hh:mm a")),n.items_DateType.push(r.d.ComboBoxItems_2("MMM/dd/yyyy hh:mm","MMM/dd/yyyy hh:mm a")),n.items_DateType.push(r.d.ComboBoxItems_2("dd-MM-yyyy hh:mm","dd-MM-yyyy hh:mm a")),n.items_DateType.push(r.d.ComboBoxItems_2("dd-MM-yy hh:mm","dd-MM-yy hh:mm a")),n.items_DateType.push(r.d.ComboBoxItems_2("dd/MM/yyyy HH:mm","dd/MM/yyyy HH:mm")),n.items_DateType.push(r.d.ComboBoxItems_2("MM/dd/yyyy HH:mm","MM/dd/yyyy HH:mm")),n.items_DateType.push(r.d.ComboBoxItems_2("dd/MMM/yyyy HH:mm","dd/MMM/yyyy HH:mm")),n.items_DateType.push(r.d.ComboBoxItems_2("MMM/dd/yyyy HH:mm","MMM/dd/yyyy HH:mm")),n.items_DateType.push(r.d.ComboBoxItems_2("dd-MM-yyyy HH:mm","dd-MM-yyyy HH:mm")),n.items_DateType.push(r.d.ComboBoxItems_2("dd-MM-yy HH:mm","dd-MM-yy HH:mm")),n.items_DateType.push(r.d.ComboBoxItems_2("HH:mm:ss","HH:mm:ss")),n.items_DateType.push(r.d.ComboBoxItems_2("hh:mm:ss tt","hh:mm:ss tt")),n.items_DateType.push(r.d.ComboBoxItems_2("dd/MM/yyyy hh:mm:ss","dd/MM/yyyy hh:mm:ss tt")),n.items_DateType.push(r.d.ComboBoxItems_2("MM/dd/yyyy hh:mm:ss","MM/dd/yyyy hh:mm:ss tt")),n.items_DateType.push(r.d.ComboBoxItems_2("dd/MMM/yyyy hh:mm:ss","dd/MMM/yyyy hh:mm:ss tt")),n.items_DateType.push(r.d.ComboBoxItems_2("MMM/dd/yyyy hh:mm:ss","MMM/dd/yyyy hh:mm:ss tt")),n.items_DateType.push(r.d.ComboBoxItems_2("dd-MM-yyyy hh:mm:ss","dd-MM-yyyy hh:mm:ss tt")),n.items_DateType.push(r.d.ComboBoxItems_2("dd-MM-yy hh:mm:ss","dd-MM-yy hh:mm:ss tt")),n.items_LinkType.push(r.d.ComboBoxItems_2("None","0")),n.items_LinkType.push(r.d.ComboBoxItems_2("Document","1")),n.items_LinkType.push(r.d.ComboBoxItems_2("Document ID","8")),n.items_LinkType.push(r.d.ComboBoxItems_2("Document Detail ID","2")),n.items_LinkType.push(r.d.ComboBoxItems_2("Dimension","3")),n.items_LinkType.push(r.d.ComboBoxItems_2("Dimension Node","4")),n.items_LinkType.push(r.d.ComboBoxItems_2("Attachment","5")),n.items_LinkType.push(r.d.ComboBoxItems_2("Mapped Reports","6")),n.items_LinkType.push(r.d.ComboBoxItems_2("URL","7")),n.items_LinkType.push(r.d.ComboBoxItems_2("Add","9")),n.items_LinkDimension.push(r.d.ComboBoxItems_2("","0")),n.items_LinkDimension.push(r.d.ComboBoxItems_2("Sales Contract","95")),n.items_LinkDimension.push(r.d.ComboBoxItems_2("Purchase Contract","104")),n.items_LinkDimension.push(r.d.ComboBoxItems_2("Quotation","103")),n.items_LinkDimension.push(r.d.ComboBoxItems_2("Unit Reservation","129")),n.items_LinkDimension.push(r.d.ComboBoxItems_2("","0")),n.items_LinkDimension.push(r.d.ComboBoxItems_2("Preview","-4")),n.items_LinkDocument.push(r.d.ComboBoxItems_2("","0")),n.items_LinkDocument.push(r.d.ComboBoxItems_2("Map","-2")),n.items_LinkDocument.push(r.d.ComboBoxItems_2("Popup","-3")),n.items_LinkDocument.push(r.d.ComboBoxItems_2("Preview","-4")),n.items_LinkDocument.push(r.d.ComboBoxItems_2("Approval History","-1")),n.items_LinkAdd.push(r.d.ComboBoxItems_2("","0")),n.items_LinkAdd.push(r.d.ComboBoxItems_2("Activity","1")),n.items_LinkAdd.push(r.d.ComboBoxItems_2("Attachment","2")),n.items_RepeatType.push(r.d.ComboBoxItems_2("","0")),n.items_RepeatType.push(r.d.ComboBoxItems_2("Daily","1")),n.items_RepeatType.push(r.d.ComboBoxItems_2("Weekly","6")),n.items_RepeatType.push(r.d.ComboBoxItems_2("Hourly12","7")),n.items_RepeatType.push(r.d.ComboBoxItems_2("Hourly24","8")),n.items_RepeatType.push(r.d.ComboBoxItems_2("Monthly","2")),n.items_RepeatType.push(r.d.ComboBoxItems_2("Quarterly","3")),n.items_RepeatType.push(r.d.ComboBoxItems_2("Half-Yearly","5")),n.items_RepeatType.push(r.d.ComboBoxItems_2("Yearly","4")),n.items_RepeatType.push(r.d.ComboBoxItems_2("Dimension","10")),n.items_RepeatPrevData.push(r.d.ComboBoxItems_2("0","0")),n.items_RepeatPrevData.push(r.d.ComboBoxItems_2("1","1")),n.items_RepeatPrevData.push(r.d.ComboBoxItems_2("2","2")),n.items_RepeatPrevData.push(r.d.ComboBoxItems_2("3","3")),n.items_UseOnce.push(r.d.ComboBoxItems_2("False","0")),n.items_UseOnce.push(r.d.ComboBoxItems_2("True","1")),n.items_UseOnce.push(r.d.ComboBoxItems_2("True (Club Totals)","2")),n.items_UseOnce.push(r.d.ComboBoxItems_2("Distinct","-1")),n.items_RepeatEmptyCol.push(r.d.ComboBoxItems_2("Hide","0")),n.items_RepeatEmptyCol.push(r.d.ComboBoxItems_2("Show Nodes","2")),n.items_RepeatEmptyCol.push(r.d.ComboBoxItems_2("Show All","1"))}}]),e}()).ReportHelper=null,n.CTypeList=[],n.FontItems=[],n.cmbTrueFalse=[],n.items_Alignment=[],n.items_Decimals=[],n.items_Commas=[],n.items_CumulativeTotals=[],n.items_Sort=[],n.items_DateType=[],n.items_LinkType=[],n.items_LinkDimension=[],n.items_LinkDimensionView=[],n.items_LinkDocument=[],n.items_LinkAdd=[],n.items_RepeatType=[],n.items_UseOnce=[],n.items_RepeatEmptyCol=[],n.items_RepeatPrevData=[],n.items_Evaluate=[],n.items_ShowLevel=[],n),u=function(){function e(){_classCallCheck(this,e),this.IsForeignKey=!1,this.ParentCostCenterID=0,this.AssignedDimID=0,this.ParentCCDefaultColID=0,this.DataType="FLOAT",this.CategoryValue=0,this.LocalReference=0,this.FieldValue=0,this.DocumentType=0,this.ExecutedDocument="",this.DimensionsFilter=null,this.ALLOtherDocuments=null,this.Visible=!1,this.ColumnCostCenterID=0,this.ColumnCCListViewTypeID=0,this.ParentCDGDO=null,this.ChildCDGDO=null,this.Visible=!0}return _createClass(e,[{key:"CloneObject",value:function(){var t=new e;for(var o in this)t[o]=this[o];return t}}]),e}(),c=function(){function e(t,o){_classCallCheck(this,e),this.Report=t,this.Obj=o}return _createClass(e,[{key:"OnButtonClick",value:function(e){"SearchCategory"!=e&&"SearchField"!=e||this.Report.FieldsDialog.ShowDialog(null,this.Obj.CDGDO)}}]),e}(),I=function(e){_inherits(o,e);var t=_createSuper(o);function o(){var e;return _classCallCheck(this,o),(e=t.apply(this,arguments)).Screen=null,e.dsFields=null,e.StaticFilterCols=null,e}return _createClass(o,null,[{key:"GetColumnFilter",value:function(e,t){var o,n,a,r,l,D,C="",u=0;e=(e=e.Replace('Condition="<"','Condition="&lt;"')).Replace('Condition="<="','Condition="&lt;="');var c=new s.f;c.LoadXml(e);for(var I=0;I<c.DocumentElement.children.length;I++){var h=c.DocumentElement.children[I];"AND"==(o=h.attributes.And.value)?o="&&":"OR"==o&&(o="||"),n=""!=h.attributes.Field.value?h.attributes.Field.value:"",a=h.attributes.Condition.value,r=h.attributes.ValueType.value,l=h.attributes.Value.value,D=null!=h.attributes.Value_Key?h.attributes.Value_Key.value:"0",u=0,null!=h.attributes.ValueCCID&&(u=parseInt(h.attributes.ValueCCID.value),t.Contains(n)||t.push(n)),""!=n&&(n="x."+n,"XDATEX"==r&&(n="+"+n+".ToServerDate()")),C+=" "+o;var d=r,T=n,y=n;switch("XDATEX"==d&&("FROMDATE"!=(l=l.toUpperCase())&&"TODATE"!=l&&"SYSTMEDATE"!=l||(l="@"+l+"@")),a){case"=":case"<>":if("LISTBOX"==d){var m=i.a.report.GetGrouplft_rgt(u,D);C+=m.length>0?"="==a?" ("+y+"lft_CF>="+m[0].lft.toString()+" && "+y+"lft_CF<="+m[0].rgt.toString()+")":" ("+y+"lft_CF<"+m[0].lft.toString()+" || "+y+"lft_CF>"+m[0].rgt.toString()+")":" 1=0"}else C+=" "+T+a+"+new Date('"+l+"').OnlyDate()";break;case"LIKE":case"NOT LIKE":C+=" "+T+" "+a+" '%"+l+"%'";break;case"IS NULL":case"IS NOT NULL":C+=" "+T+" "+a;break;case">":case">=":case"<":case"<=":C+=" "+T+a+"+new Date('"+l+"').OnlyDate()";break;case"PAST_TODATE":"XDATEX"==d&&s.e.Int(l)>0&&(C+=" ("+T+">=+new Date('@XTODATEX_"+l+"@').OnlyDate() && "+y+"<=+new Date('@TODATE@').OnlyDate())")}}return C.length>0&&(C="!("+C+")"),C}},{key:"GetRowFilter",value:function(e,t){var o,n,a,r,l,D,C="",u=0,c=new s.f;c.LoadXml(e);for(var I=c.DocumentElement.children,h=0;h<I.length;h++){var d=I[h];if(o=d.attributes.And.value,n=""!=d.attributes.Field.value?d.attributes.Field.value:"",a=d.attributes.Condition.value,r=d.attributes.ValueType.value,l=d.attributes.Value.value,D=null!=d.attributes.Value_Key?d.attributes.Value_Key.value:"0",u=0,null!=d.attributes.ValueCCID)if(u=parseInt(d.attributes.ValueCCID.value),1==t&&2==u)n="A1.lft";else if(n.Contains("~")){var T=n.split("~");n=T[1]+".lft"}C+=" "+o;var y=r,m=n,A=n;switch("XDATEX"==y&&("FROMDATE"!=(l=l.toUpperCase())&&"TODATE"!=l&&"SYSTMEDATE"!=l||(l="@"+l+"@")),a){case"=":case"<>":if("LISTBOX"==y){var p=i.a.report.GetGrouplft_rgt(u,D);C+=p.length>0?"="==a?" ("+A+">="+p[0].lft.toString()+" and "+A+"<="+p[0].rgt.toString()+")":" ("+A+"<"+p[0].lft.toString()+" or "+A+">"+p[0].rgt.toString()+")":" 1=0"}else C+=" "+m+a+"'"+l+"'";break;case"LIKE":case"NOT LIKE":C+=" "+m+" "+a+" '%"+l+"%'";break;case">":case">=":case"<":case"<=":C+=" "+m+a+"'"+l+"'";break;case"PAST_TODATE":"XDATEX"==y&&s.e.Int(l)>0&&(C+=" ("+m+">='@XTODATEX_"+l+"@' and "+A+"<='@TODATE@')")}}return C.length>0&&(C="("+C+")"),C}}]),o}(l.b)}}]);