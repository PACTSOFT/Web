function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var i,n=_getPrototypeOf(e);if(t){var s=_getPrototypeOf(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return _possibleConstructorReturn(this,i)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{"XR/+":function(e,t,i){"use strict";i.r(t),i.d(t,"AddEditTenantViewModel",(function(){return P}));var n=i("mrSG"),s=i("Do2H"),a=i("Lp6j"),o=i("eQJW"),r=i("NkMH"),l=i("VxiT"),c=i("n56n"),h=i("0/4Q"),d=i("EQd/"),u=i("xnJf"),g=i("OvA8"),m=i("4HhE"),b=i("JIg3"),S=i("jgdN"),f=i("Jnyl"),D=i("CQvG"),T=i("DKUf"),p=i("ScVY"),C=i("4k0m"),y=i("++IR"),V=i("THE7"),E=i("knKa"),I=i("Huqd"),O=i("bwbx"),A=i("c6C+"),w=i("RJs6"),P=function(e){_inherits(p,e);var t=_createSuper(p);function p(e,i,n){var a;_classCallCheck(this,p),(a=t.call(this)).CostCenterID=0,a.AttachmentVisibility=!1,a.ReportInfoVisibility=!0,a.ReportsList=[],a.ScreenObject=new l.a,a.ADM={},a.TntObj={},a.Status=new h.e(27284),a.UserName=new d.d(27282),a.Password=new d.d(27283),a.txtCode=new d.d(25694),a.Type=new c.b(25695),a.Position=new c.b(25696),a.FstName=new d.d(25697),a.MdlName=new d.d(25698),a.LstName=new d.d(25699),a.LeaseSignatory=new d.d(25700),a.ContactPerson=new d.d(25701),a.Phone1=new d.d(25702),a.Phone2=new d.d(25703),a.Email=new d.d(25704),a.Fax=new d.d(25705),a.IDNumber=new d.d(25706),a.Profession=new d.d(25707),a.Posting=new c.b(25708),a.Group=new c.b(25789),a.RightRegionVisibility=!1,a.Title="",a.TenantID=0,a.FileID=0,a.IsPhotoDelete=!1,a.IsPhotoChanged=!1,a.IsAttachmentMandatory=!1,a.AccountPhoto="",a.PhotoTextVisibility=!1,a.guid="",a.FileExtension="",a.FileDescription="",a.ActualFileName="",a.NoteVisibility=!1,a.ActVisibility=!1,a.NodeID=0,a.PrimaryVisibility=!1,a.ContactVisibility=!1,a.RetValue=0,a.ParentId=0,a.ErrorMessage="Missing Report Parameter ' ",a.Dset=null,a.ClassName="AddEditTenantViewModel",Logger.InfoLog("AddEditTenantViewModel::Entering AddEditTenantViewModel With SelectedNodeID="+e+",Parent="+i+",IsGroup="+n);try{a.ButtonSave=new r.a,a.ButtonCustomize=new r.a,a.ButtonEIDRead=new r.a,0==e?s.a.SessionManager.HideUnathorizedAccess?a.ButtonSave.Visible=s.a.SessionManager.IsActionAssigned(94,"Create"):a.ButtonSave.Enable=s.a.SessionManager.IsActionAssigned(94,"Create"):s.a.SessionManager.HideUnathorizedAccess?a.ButtonSave.Visible=s.a.SessionManager.IsActionAssigned(94,"Update"):a.ButtonSave.Enable=s.a.SessionManager.IsActionAssigned(94,"Update"),s.a.SessionManager.HideUnathorizedAccess?a.ButtonCustomize.Visible=s.a.SessionManager.IsActionAssigned(94,"Customize"):a.ButtonCustomize.Enable=s.a.SessionManager.IsActionAssigned(94,"Customize"),s.a.SessionManager.HideUnathorizedAccess?a.ButtonEIDRead.Visible=s.a.SessionManager.IsActionAssigned(94,"EIDRead"):a.ButtonEIDRead.Enable=s.a.SessionManager.IsActionAssigned(94,"EIDRead"),s.a.SessionManager.Preferences.ContainsKey("EIDMapping")&&""!=s.a.SessionManager.Preferences.EIDMapping.toString()||(a.ButtonEIDRead.Visible=!1),a.CostCenterID=94,a.Title=s.a.GetResource("TNT_Title"),a.DisplayMessage="",a.MessageVisibility=!1,a.ScreenObject.LoadScreen_2(_assertThisInitialized(a),94),a.LoadImageDimensions(),a.ViewAttachments=new g.ViewAttachmentViewModel(_assertThisInitialized(a),s.a.SessionManager,s.a.admin),a.ViewNotes=new w.a(_assertThisInitialized(a),s.a.SessionManager,s.a.admin),a.ViewActivities=new D.b(_assertThisInitialized(a)),a.Activities=new T.a(_assertThisInitialized(a),!1),a.ViewActivities.Activities=a.Activities,a.ViewContacts=new V.a(_assertThisInitialized(a)),a.TntObj.TenantID=e,a.TenantID=a.TntObj.TenantID,a.loadtabs(),a.load(),a.Posting.SelectedValue=154,a.Group.SelectedValue=1,a.AutoGenerateCode(),a.PhotoTextVisibility=!0,a.ParentId=i,a.ScreenObject.CustomTab.Pages.forEach((function(e){"Contacts"==e.Name&&(a.PContact=new E.a,a.PContact.QuickAddContactViewModel_2(_assertThisInitialized(a)),a.PContact.IsPrimaryContact=!0,a.PContact.Visiblebtns=!1,a.PContact.Countryvisible=!0,a.PrimaryVisibility=!0)})),e>0&&(a.LoadEditData(),a.Title=s.a.GetResource("TNT_Edit")),a.Password.Enable=!a.Password.IsReadOnly,a.ContactVisibility=!1,null!=a.PContact&&(a.PrimaryVisibility=!0),a.ReportView()}catch(o){Logger.ErrorLog("AddEditTenantViewModel:: AddEditTenantViewModel"+o.stack)}return Logger.InfoLog("AddEditTenantViewModel::Exiting AddEditTenantViewModel With SelectedNodeID="+e+",Parent="+i+",IsGroup="+n),a}return _createClass(p,[{key:"GetXML",value:function(){Logger.InfoLog("AddEditUnitsViewModel::Entering GetXML"),Logger.InfoLog("AddEditUnitsViewModel::Exiting GetXML")}},{key:"OnShowNote",value:function(){}},{key:"OnAddNote",value:function(){this.Note=new A.AddNoteViewModel,this.Note.AddNoteViewModel_2(this)}},{key:"OnShowAttachment",value:function(){Logger.InfoLog("AddEditAccountScreenViewModel::Entering OnShowAttachment"),Logger.InfoLog("AddEditAccountScreenViewModel::Exiting OnShowAttachment")}},{key:"OnAddAttachment",value:function(){Logger.InfoLog("AddEditAccountScreenViewModel::Entering AddAttachment"),Logger.InfoLog("AddEditAccountScreenViewModel::Exiting AddAttachment")}},{key:"OnShowContact",value:function(){Logger.InfoLog("AddEditTenantViewModel::Entering OnShowContact"),Logger.InfoLog("AddEditTenantViewModel::Exiting OnShowContact")}},{key:"OnAddContact",value:function(){Logger.InfoLog("AddEditTenantViewModel::Entering AddContact"),Logger.InfoLog("AddEditTenantViewModel::Entering AddContact")}},{key:"ReportView",value:function(){var e=this;this.ReportDimension=new c.b(0),this.ReportDimension.CCID=this.CostCenterID,this.ReportDimension.TypeID=1,this.ReportDimension.SelectedValue=this.TenantID,this.ReportsList=[],this.ReportDimension.OnPactListBoxValueChanged.Subscribe(this,"OnReportsLinkClick");var t=[];null!=this.ScreenObject.Data&&this.ScreenObject.Data.Tables.length>6&&this.ScreenObject.Data.Tables[6].forEach((function(i){var n=new r.a;n.DBColumnID=parseInt(i.ReportID),n.Label=i.ReportName.toString(),e.ScreenObject.Data.Columns[6].Contains("Shortcut")&&(n.KeyTip=i.Shortcut.toString()),e.ScreenObject.Data.Columns[6].Contains("DisplayAsPopup")&&""!=i.DisplayAsPopup.toString()&&(n.Dependantinuse="1"==i.DisplayAsPopup.toString()),e.ScreenObject.Data.Columns[6].Contains("Width")&&""!=i.Width.toString()&&(n.Width=i.Width.toString()),e.ScreenObject.Data.Columns[6].Contains("Height")&&""!=i.Height.toString()&&(n.Length=i.Height.toString()),e.ScreenObject.Data.Columns[6].Contains("DocumentField")&&""!=i.DocumentField.toString()&&(n.Formula=i.DocumentField.toString()),e.ScreenObject.Data.Columns[6].Contains("mapxml")&&""!=i.mapxml.toString()&&(n.ToolTipDescription=i.mapxml.toString()),t.Contains(parseInt(i.ReportID))||(t.push(parseInt(i.ReportID)),e.ReportsList.push(n))}))}},{key:"OnReportsLinkClick",value:function(e){return Object(n.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,o,r,l,c,h,d,u,g;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([i.e(2),i.e(1),i.e(3),i.e(5),i.e(4),i.e(6),i.e(7),i.e(10),i.e(9),i.e(8),i.e(12),i.e(11),i.e(13),i.e(19),i.e(15),i.e(21),i.e(20),i.e(16),i.e(14),i.e(18),i.e(17),i.e(22),i.e(23),i.e(24),i.e(25),i.e(28),i.e(30),i.e(29),i.e(32),i.e(31),i.e(27),i.e(26),i.e(35),i.e(37),i.e(38),i.e(36),i.e(33),i.e(34),i.e(39),i.e(40),i.e(41),i.e(212)]).then(i.bind(null,"ThYU"));case 2:return n=t.sent,o=n.ReportViewModel,t.next=6,Promise.all([i.e(32),i.e(37)]).then(i.bind(null,"YU11"));case 6:r=t.sent,l=r.ReportViewComponent,h={strXML:""},d=new o,this.ReportDimension.SelectedValue=this.TenantID,this.DisplayMessage=this.GetReportFilterXML(e,h),c=h.strXML,0==this.DisplayMessage.length&&(null!=(u=this.ReportsList.find((function(t){return t.DBColumnID==parseInt(e)})))&&u.Dependantinuse?(d.ReportViewModel_Document(this.CostCenterID,c,parseInt(e),!0,null,null),!a.e.IsEmpty(u.Width)&&parseFloat(u.Width)>0&&(d.RptWidth=parseFloat(u.Width)),!a.e.IsEmpty(u.length)&&parseFloat(u.length)>0&&(d.RptHeight=parseFloat(u.length)),d.DocumentObject=this,s.a.page.HideDialog(),s.a.page.ShowDialog(d,l,{Title:"",HideClose:!0,ShowCenter:!0})):((g=new o).ReportViewModel_Document(this.CostCenterID,c,parseInt(e),!1,null,null),g.DocumentObject=this,s.a.page.HideDialog(),s.a.page.addNewTab({component:l,params:{obj:g}})));case 10:case"end":return t.stop()}}),t,this)})))}},{key:"GetReportFilterXML",value:function(e,t){var i=this,n="";t.strXML="";var s=this.ScreenObject.Data.Tables[6];s=s.filter((function(t){return t.ReportID==e}));var a,r=!1;s.forEach((function(e){Object(o.j)(e.GroupLevel)&&(r=!0)})),n+="<XML",r&&(n+=' GroupLevel="1"'),n+=" >";for(var l=function(e){a=s[e].ReportField.toString(),n+="<Row ",n+='ColID ="'+a+'" ';for(var t=0;t<i.ScreenObject.StaticFields.length;t++)if(i.ScreenObject.StaticFields[t].DBColumnID==parseInt(s[e].DocumentField.toString()))if(i.ScreenObject.StaticFields[t]instanceof d.d){if(""==i.ScreenObject.StaticFields[t].Text)return{v:(alert(i.ErrorMessage+i.ScreenObject.StaticFields[t].Label+" '"),"Empty Value")};"SNO"==s[e].SysColumnName.toString()?n+='Value ="'+i.ReportDimension.SelectedValue+'" ':n+='Value ="'+i.ScreenObject.StaticFields[t].Text+'" '}else if(i.ScreenObject.StaticFields[t]instanceof f.a){if(""==i.ScreenObject.StaticFields[t].TextBox.Text||""==i.ScreenObject.StaticFields[t].ComboBox.SelectedValue)return{v:(alert(i.ErrorMessage+i.ScreenObject.StaticFields[t].Label+" '"),"Empty Value")};n+='Value ="'+i.ScreenObject.StaticFields[t].ComboBox.SelectedValue+'" '}else if(i.ScreenObject.StaticFields[t]instanceof d.c){if(""==i.ScreenObject.StaticFields[t].Text)return{v:(alert(i.ErrorMessage+i.ScreenObject.StaticFields[t].Label+" '"),"Empty Value")};n+='Value ="'+i.ScreenObject.StaticFields[t].Text+'" '}else if(i.ScreenObject.StaticFields[t]instanceof b.a||i.ScreenObject.StaticFields[t]instanceof b.d||i.ScreenObject.StaticFields[t]instanceof b.c){if(i.ScreenObject.StaticFields[t]instanceof b.a||i.ScreenObject.StaticFields[t]instanceof b.d){if(""==i.ScreenObject.StaticFields[t].Text)return{v:(alert(i.ErrorMessage+i.ScreenObject.StaticFields[t].Label+" '"),"Empty Value")};n+='Value ="'+i.ScreenObject.StaticFields[t].Date.ToString("dd/MMM/yyyy")+'" '}else if(i.ScreenObject.StaticFields[t]instanceof b.c){if(!i.ScreenObject.StaticFields[t].Date)return{v:(alert(i.ErrorMessage+i.ScreenObject.StaticFields[t].Label+" '"),"Empty Value")};n+='Value ="'+i.ScreenObject.StaticFields[t].Date.ToString("dd/MMM/yyyy")+'" '}}else if(i.ScreenObject.StaticFields[t]instanceof c.b){if(""==i.ScreenObject.StaticFields[t].Text)return{v:(alert(i.ErrorMessage+i.ScreenObject.StaticFields[t].Label+" '"),"Empty Value")};n+='Value ="'+i.ScreenObject.StaticFields[t].SelectedValue+'" '}else if(i.ScreenObject.StaticFields[t]instanceof I.a){if(""==i.ScreenObject.StaticFields[t].Text)return{v:(alert(i.ErrorMessage+i.ScreenObject.StaticFields[t].Label+" '"),"Empty Value")};n+='Value ="'+i.ScreenObject.StaticFields[t].SelectedValue+'" '}i.ScreenObject.CustomTab.Pages.forEach((function(t){t.Fields.forEach((function(t){if(null!=t&&(t instanceof d.d||t instanceof f.a||t instanceof d.c||t instanceof b.a||t instanceof b.d||t instanceof b.c||t instanceof c.b||t instanceof I.a)&&t.DBColumnID==parseInt(s[e].DocumentField.toString()))if(t instanceof d.d){if(""==t.Text)return alert(i.ErrorMessage+t.Label+" '"),"Empty Value";n+='Value ="'+t.Text+'" '}else if(t instanceof f.a){if(""==t.TextBox.Text||""==t.ComboBox.SelectedValue)return alert(i.ErrorMessage+t.Label+" '"),"Empty Value";n+='Value ="'+t.TextBox.Text+'" '}else if(t instanceof d.c){if(""==t.Text)return alert(i.ErrorMessage+t.Label+" '"),"Empty Value";n+='Value ="'+t.Text+'" '}else if(t instanceof b.a||t instanceof b.d||t instanceof b.c){if(t||t){if(""==t.Text)return alert(i.ErrorMessage+t.Label+" '"),"Empty Value";n+='Value ="'+t.Date.ToString("dd/MMM/yyyy")+'" '}else if(t instanceof b.c){if(!t.Date)return alert(i.ErrorMessage+t.Label+" '"),"Empty Value";n+='Value ="'+t.Date.ToString("dd/MMM/yyyy")+'" '}}else if(t instanceof c.b){if(""==t.Text&&0==t.SelectedValue)return alert(i.ErrorMessage+t.Label+" '"),"Empty Value";n+='Value ="'+t.SelectedValue+'" '}else if(t instanceof I.a){if(""==t.Text)return alert(i.ErrorMessage+t.Label+" '"),"Empty Value";n+='Value ="'+t.SelectedValue+'" '}}))})),n+=" />"},h=0;h<s.length;h++){var u=l(h);if("object"==typeof u)return u.v}return n+="</XML>",t.strXML=n.toString(),""}},{key:"LoadImageDimensions",value:function(){}},{key:"AutoGenerateCode",value:function(){var e=s.a.common.GetAutoSequence(94,"","94",s.a.SessionManager.CompanyIndex.toString()),t=this.ScreenObject.Data.Tables[4].filter((function(e){return"CodeAutoGen"==e.Name}));t.length>0&&Object(o.j)(t[0].Value)&&(this.txtCode.Enable=!1,this.txtCode.Mandatory=!1,0==this.TenantID&&(this.txtCode.Text=e))}},{key:"loadtabs",value:function(){Logger.InfoLog("AddEditTenantViewModel::Entering loadtabs");try{this.AssignRowColumns();for(var e=this.ScreenObject.CustomTab.Pages.length-1;e>=0;e--){var t=this.ScreenObject.CustomTab.Pages[e];switch(t.Name){case"Attachments":t.Fields.push(this.ViewAttachments);break;case"Activities":t.Fields.push(this.ViewActivities);break;case"Contacts":t.Fields.push(this.ViewContacts);break;case"Notes":t.Fields.push(this.ViewNotes)}}}catch(i){Logger.InfoLog("AddEditTenantViewModel::Error loadtabs"+i.stack)}Logger.InfoLog("AddEditTenantViewModel::Exiting loadtabs")}},{key:"AssignRowColumns",value:function(){Logger.InfoLog("AddEditTenantViewModel::Entering AssignRowColumns");try{var e;e=this.ScreenObject.CustomFields.length;for(var t=0;t<e;t++)this.ScreenObject.CustomFields[t].Row=t/4,this.ScreenObject.CustomFields[t].Column=t%4}catch(i){Logger.InfoLog("AddEditTenantViewModel::Error AssignRowColumns")}Logger.InfoLog("AddEditTenantViewModel::Exiting AssignRowColumns")}},{key:"load",value:function(){var e=this;Logger.InfoLog("AddEditTenantViewModel::Entering load");try{this.ScreenObject.Data.Tables[3].forEach((function(t){e.Status.Items.push(h.d.ComboBoxItems_2(t[Object.keys(t)[1]].toString(),t[Object.keys(t)[0]].toString()))})),this.Status.DefaultValue="462",this.Status.SelectedValue="462"}catch(t){Logger.InfoLog("AddEditTenantViewModel::Exiting load"+t.stack)}Logger.InfoLog("AddEditTenantViewModel::Exiting load")}},{key:"LoadEditData",value:function(){if(Logger.InfoLog("AddEditTenantViewModel::Entering LoadEditData"),this.Dset=s.a.rental.GetTenantDetails(this.TntObj.TenantID),Object.assign(this.TntObj,this.Dset.obj),this.txtCode.Text=a.e.StringValue(this.TntObj.Code),this.Type.SelectedValue=this.TntObj.TypeID,this.Position.SelectedValue=this.TntObj.PositionID,this.FstName.Text=a.e.StringValue(this.TntObj.FirstName),this.MdlName.Text=a.e.StringValue(this.TntObj.MiddleName),this.LstName.Text=a.e.StringValue(this.TntObj.LastName),this.LeaseSignatory.Text=a.e.StringValue(this.TntObj.LeaseSignatory),this.ContactPerson.Text=a.e.StringValue(this.TntObj.ContactPerson),this.Phone1.Text=a.e.StringValue(this.TntObj.Phone1),this.Phone2.Text=a.e.StringValue(this.TntObj.Phone2),this.Email.Text=a.e.StringValue(this.TntObj.Email),this.Fax.Text=a.e.StringValue(this.TntObj.Fax),this.UserName.Text=a.e.StringValue(this.TntObj.UserName),this.Password.Text=a.e.StringValue(this.Decrypt(this.TntObj.Password)),this.Status.SelectedValue=a.e.StringValue(this.TntObj.StatusID),this.IDNumber.Text=a.e.StringValue(this.TntObj.IDNumber),this.Profession.Text=a.e.StringValue(this.TntObj.Profession),this.Posting.SelectedValue=a.e.IntTryParse(this.TntObj.PostingID),this.LoadCustomFieldsData(this.Dset.Tables[0]),this.ScreenObject.LoadCustomFieldsData(this.Dset.Tables[1]),this.ScreenObject.LoadCustomFieldsCCData(this.Dset.Tables[2]),this.Dset.Tables.length>3&&this.ViewNotes.LoadNotes(this.Dset.Tables[3]),this.Dset.Tables.length>4){this.ViewAttachments.LoadAttachments(this.Dset.Tables[4]);var e=this.Dset.Tables[4].filter((function(e){return 1==e.IsProductImage}));e.length>0?(this.PhotoTextVisibility=!1,this.FileID=parseInt(e[0].FileID),this.AccountPhoto=a.e.GetPath(e[0].GUID.toString()+"."+e[0].FileExtension.toString()),this.ActualFileName=e[0].ActualFileName.toString()):(this.FileID=0,this.PhotoTextVisibility=!0)}this.Dset.Tables.length>6&&this.ViewActivities.LoadActivityData(this.Dset.Tables[6]),this.Dset.Tables.length>7&&this.ViewContacts.LoadContacts(this.Dset.Tables[7],this.Dset.Tables[7]),null!=this.PContact&&this.Dset.Tables.length>8&&this.PContact.LoadContacts(this.Dset.Tables[8]),this.ScreenObject.CanApprove(this.Dset.Tables[0][0],this.Dset.Tables[5][0],this.ButtonSave),Logger.InfoLog("AddEditTenantViewModel::Exiting LoadEditData")}},{key:"getFields",value:function(){var e,t=this;Logger.InfoLog("AddEditTenantViewModel::Entering getFields");var i="";return this.ScreenObject.CustomTab.Pages.forEach((function(t){t.Fields.forEach((function(t){t instanceof m.c&&!a.e.IsEmpty(t.DBColumnName)&&!t.DBColumnName.toLowerCase().Contains("alpha")&&!t.DBColumnName.toLowerCase().Contains("ccnid")&&(t instanceof d.d?"Passport"!=t.DBColumnName&&"Nationality"!=t.DBColumnName&&"SponsorName"!=t.DBColumnName&&"SponsorPassport"!=t.DBColumnName&&"License"!=t.DBColumnName&&"LicenseIssuedBy"!=t.DBColumnName||(e=t.Text,a.e.IsEmpty(e)&&(e="",null),i+=t.DBColumnName+"=N'"+e.replace("'","''")+"',"):t instanceof h.e?(e=t.SelectedValue,a.e.IsEmpty(e)&&(e=""),i+=t.DBColumnName+"=N'"+e+"',"):t instanceof b.c?t.Date&&(e=t.Date.ToString("dd/MMM/yyyy"),a.e.IsEmpty(e)&&(e=""),i+=t.DBColumnName+"='"+e+"',"):t instanceof b.a?(e=t.Date.ToString("dd/MMM/yyyy"),a.e.IsEmpty(e)&&(e=""),i+=t.DBColumnName+"=Convert(float,Convert(DateTime,'"+e+"')),"):t instanceof S.a&&(e=t.Text,a.e.IsEmpty(e)&&(e=""),i+=t.DBColumnName+"='"+e+"',"))}))})),this.ScreenObject.HeaderFields.forEach((function(n){!(n instanceof m.c)||a.e.IsEmpty(n.DBColumnName)||n.DBColumnName.toLowerCase().Contains("alpha")||n.DBColumnName.toLowerCase().Contains("ccnid")||t.ScreenObject.StaticFields.Contains(n)||(n instanceof d.d?"Passport"!=n.DBColumnName&&"Nationality"!=n.DBColumnName&&"SponsorName"!=n.DBColumnName&&"SponsorPassport"!=n.DBColumnName&&"License"!=n.DBColumnName&&"LicenseIssuedBy"!=n.DBColumnName||(e=n.Text,a.e.IsEmpty(e)&&(e="",null),i+=n.DBColumnName+"=N'"+e.replace("'","''")+"',"):n instanceof h.e?(e=n.SelectedValue,a.e.IsEmpty(e)&&(e=""),i+=n.DBColumnName+"=N'"+e+"',"):n instanceof b.c?n.Date&&(e=n.Date.ToString("dd/MMM/yyyy"),a.e.IsEmpty(e)&&(e=""),i+=n.DBColumnName+"='"+e+"',"):n instanceof b.a?(e=n.Date.ToString("dd/MMM/yyyy"),a.e.IsEmpty(e)&&(e=""),i+=n.DBColumnName+"=Convert(float,Convert(DateTime,'"+e+"')),"):n instanceof S.a&&(e=n.Text,a.e.IsEmpty(e)&&(e=""),i+=n.DBColumnName+"='"+e+"',"))})),i+=null!=this.UserName.Text&&""!=this.UserName.Text?"Username='"+this.UserName.Text+"',":"Username='',",i+=null!=this.Password.Text&&""!=this.Password.Text?"Password='"+this.Encrypt(this.Password.Text)+"',":"Password='',",null!=this.Status.SelectedValue&&(i+="StatusID='"+this.Status.SelectedValue+"',"),Logger.InfoLog("AddEditTenantViewModel::Exiting getFields"),i.toString()}},{key:"LoadCustomFieldsData",value:function(e){if(Logger.InfoLog("AddEditTenantViewModel:: Entering LoadCustomFieldsData"),this.ScreenObject.CheckViewForUser(!0),null!=e&&e.length>0){try{this.ScreenObject.CustomTab.Pages.forEach((function(t){t.Fields.forEach((function(t){if(t instanceof m.c&&null!=t.DBColumnName&&null!=e[0][t.DBColumnName])if(t instanceof d.d)t.Text=e[0][t.DBColumnName].toString();else if(t instanceof h.e)t.SelectedValue=e[0][t.DBColumnName].toString();else if(t instanceof b.c)!a.e.StringIsNullOrEmpty(e[0][t.DBColumnName])&&a.e.isValidDate(e[0][t.DBColumnName].toString())&&(t.Date=new Date(e[0][t.DBColumnName]));else if(t instanceof b.a)!a.e.StringIsNullOrEmpty(e[0][t.DBColumnName])&&a.e.isValidDate(e[0][t.DBColumnName].toString())&&(t.Date=new Date(e[0][t.DBColumnName]));else if(t instanceof S.a)t.Text=e[0][t.DBColumnName].toString();else if(t instanceof c.b){var i=a.e.IntTryParse(e[0][t.DBColumnName].toString());!a.e.StringIsNullOrEmpty(e[0][t.DBColumnName])&&i>0&&(t.SelectedValue=parseInt(e[0][t.DBColumnName].toString()))}}))})),this.ScreenObject.HeaderFields.forEach((function(t){if(t instanceof m.c&&null!=t.DBColumnName&&null!=e[0][t.DBColumnName])if(t instanceof d.d)t.Text=e[0][t.DBColumnName].toString();else if(t instanceof h.e)t.SelectedValue=e[0][t.DBColumnName].toString();else if(t instanceof b.c)!a.e.StringIsNullOrEmpty(e[0][t.DBColumnName])&&a.e.isValidDate(e[0][t.DBColumnName].toString())&&(t.Date=e[0][t.DBColumnName].toString());else if(t instanceof b.a)!a.e.StringIsNullOrEmpty(e[0][t.DBColumnName])&&a.e.isValidDate(e[0][t.DBColumnName].toString())&&(t.Date=e[0][t.DBColumnName].toString());else if(t instanceof S.a)t.Text=e[0][t.DBColumnName].toString();else if(t instanceof c.b){var i=a.e.IntTryParse(e[0][t.DBColumnName]);!a.e.StringIsNullOrEmpty(e[0][t.DBColumnName])&&i>0&&(t.SelectedValue=parseInt(e[0][t.DBColumnName].toString()))}}))}catch(t){Logger.ErrorLog("AddEditTenantViewModel:: LoadCustomFieldsData : "+t.stack)}Logger.InfoLog("AddEditTenantViewModel:: Exiting LoadCustomFieldsData")}}},{key:"OnCustomize",value:function(e){"Report"==e.toString()?(this.AttachmentVisibility=!1,this.ActVisibility=!1,this.PrimaryVisibility=!1,this.ReportInfoVisibility=!0,this.ReportInfoVisibility=!0,s.a.page.ShowDialog(this,O.a,{Title:"Reports"})):"Cancel"==e.toString()&&(this.ReportInfoVisibility=!1)}},{key:"Encrypt",value:function(e){return e}},{key:"Decrypt",value:function(e){return e}},{key:"OnSave",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(Logger.InfoLog("AddEditTenantViewModel:: Inside OnSave"),"Read"==e.toString()||"ReadEID"==e.toString()){var n="",o="",r="";a.e.IsEmpty(n)||(this.AccountPhoto=n,this.IsPhotoChanged=!0,this.PhotoTextVisibility=!1);for(var l=0;l<this.ViewAttachments.AttachmentsList.length;l++)"EIDSignature.jpg"==this.ViewAttachments.AttachmentsList[l].ActualFileName&&(this.ViewAttachments.SelectedAttachment=this.ViewAttachments.AttachmentsList[l],this.ViewAttachments.OnCmnItem_Click("DELETE"));a.e.IsEmpty(o)||(this.Attachment=new u.AddAttachmentViewModel,this.Attachment.AddAttachmentViewModel_2(this),this.Attachment.AliasFileName=o,this.Attachment.RelativeFileName=o,this.Attachment.FileDescription="Signature",this.Attachment.ActualFileName="EIDSignature.jpg",this.Attachment.FilePath=o,this.Attachment.FileExtension="jpg",this.Attachment.AttachmentID=0,this.Attachment._Flg=!0,this.ViewAttachments.AttachmentsList.push(this.Attachment)),a.e.IsEmpty(r)||(this.DisplayMessage=r,this.MessageVisibility=!0)}else if("DeletePhoto"==e.toString())this.IsPhotoDelete=!0,this.AccountPhoto="",this.ActualFileName="",this.IsPhotoChanged=!1,this.PhotoTextVisibility=!0,this.DisplayMessage="";else if("PopUp"==e.toString()){null!=this.Dset&&this.Dset.Tables[4].filter((function(e){return"jpg"==e.FileExtension||"png"==e.FileExtension})).forEach((function(e){a.e.GetPath(e.GUID.toString()+"."+e.FileExtension.toString())+";"}))}else if("MouseDown"==e.toString()||"UploadPhoto"==e.toString()){var c;if(0==i.srcElement.files[0].length)return this.DisplayMessage=s.a.GetResource("File_NoPhoto"),void(this.MessageVisibility=!0);if(!i.srcElement.files[0].type.match("image"))return this.DisplayMessage=s.a.GetResource("File_NoPhoto"),void(this.MessageVisibility=!0);(c=i.target.files[0].name.split(".")).length>1&&(this.FileExtension=c[c.length-1]),this.AccountPhoto=i.target.files[0].name;var h=i.target.files[0],g=new FileReader;g.onload=function(i){var n=new Image;n.src=i.target.result,n.onload=function(n){t.ImgFile=i.target.result,e.srcElement.value=""}},g.readAsDataURL(h),setTimeout((function(){t.getGuid(h)}),100),this.IsPhotoChanged=!0}else if("ShowApprove"==e.toString()){var m=new C.a(94,this.TntObj.TenantID,this.ScreenObject,this);s.a.page.ShowDialog(m,y.a,{ShowCenter:!0,Title:s.a.GetResource("ApproveReject")})}else if("Print"==e.toString())this.DisplayMessage="Please Wait Printing Data...",s.a.report.ExportPDF_Masters(94,this.TenantID.toString(),0,"PDF").subscribe((function(e){console.log(e),s.a.SessionManager.Download(e.FileName,"Print"),a.e.IsEmpty(e.Message)&&!a.e.IsEmpty(e.FileName)&&(t.DisplayMessage="Exported Successfully")}),(function(e){console.log(e)}));else if("Preview"==e.toString())this.DisplayMessage="Please Wait Printing Data...",s.a.report.ExportPDF_Masters(94,this.TenantID.toString(),0,"PDF").subscribe((function(e){console.log(e),s.a.SessionManager.Download(e.FileName,"Preview"),a.e.IsEmpty(e.Message)&&!a.e.IsEmpty(e.FileName)&&(t.DisplayMessage="Exported Successfully")}),(function(e){console.log(e)}));else if("Save"==e.toString())try{var b=this.ScreenObject.ValidateData();if(!a.e.IsEmpty(b))return this.DisplayMessage=b,void(this.MessageVisibility=!0);if(this.IsAttachmentMandatory&&null!=this.ViewAttachments){var S=0;if(this.ViewAttachments.AttachmentsList.length>0&&this.ViewAttachments.AttachmentsList.forEach((function(e){e.IsProductImage||S++})),0==S)return this.DisplayMessage="Attachment is mandatory",void(this.MessageVisibility=!0)}if(!this.ScreenObject.ValidateDataonSave())return;this.TntObj.Code=this.txtCode.Text,this.Type.Enable&&(this.TntObj.TypeID=this.Type.SelectedValue),this.Position.Enable&&(this.TntObj.PositionID=this.Position.SelectedValue),this.TntObj.FirstName=this.FstName.Text,this.TntObj.MiddleName=this.MdlName.Text,this.TntObj.LastName=this.LstName.Text,this.TntObj.LeaseSignatory=this.LeaseSignatory.Text,this.TntObj.ContactPerson=this.ContactPerson.Text,this.Posting.Enable&&(this.TntObj.PostingID=this.Posting.SelectedValue),this.TntObj.Phone1=this.Phone1.Text,this.TntObj.Phone2=this.Phone2.Text,this.TntObj.Email=this.Email.Text,this.TntObj.Fax=this.Fax.Text,this.TntObj.IDNumber=this.IDNumber.Text,this.TntObj.Profession=this.Profession.Text,this.txtCode.Visible&&this.txtCode.Enable||(this.TntObj.Code=this.txtCode.Text),this.Type.Visible&&this.Type.Enable||(this.TntObj.TypeID=this.Type.SelectedValue),this.Position.Visible&&this.Position.Enable||(this.TntObj.PositionID=this.Position.SelectedValue),this.FstName.Visible&&this.FstName.Enable||(this.TntObj.FirstName=this.txtCode.Text),this.MdlName.Visible&&this.MdlName.Enable||(this.TntObj.MiddleName=this.txtCode.Text),this.LstName.Visible&&this.LstName.Enable||(this.TntObj.LastName=this.txtCode.Text),this.Posting.Visible&&this.Posting.Enable||(this.TntObj.PostingID=0),this.LeaseSignatory.Visible&&this.LeaseSignatory.Enable||(this.TntObj.LeaseSignatory=this.txtCode.Text),this.ContactPerson.Visible&&this.ContactPerson.Enable||(this.TntObj.ContactPerson=this.txtCode.Text),this.Phone1.Visible&&this.Phone1.Enable||(this.TntObj.Phone1=this.txtCode.Text),this.Phone2.Visible&&this.Phone2.Enable||(this.TntObj.Phone2=this.txtCode.Text),this.Email.Visible&&this.Email.Enable||(this.TntObj.Email=this.txtCode.Text),this.Fax.Visible&&this.Fax.Enable||(this.TntObj.Fax=this.txtCode.Text),this.IDNumber.Visible&&this.IDNumber.Enable||(this.TntObj.IDNumber=this.txtCode.Text),this.Profession.Visible&&this.Profession.Enable||(this.TntObj.Profession=this.txtCode.Text),this.TntObj.IsGroup=!1,this.TntObj.SelectedNodeId=this.Group.SelectedValue,this.TntObj.TabsData=this.getFields().Trim(","),this.TntObj.CustomFieldsQuery=this.ScreenObject.GetCustomFieldsQuery(),this.TntObj.CustomCostCenterFieldsQuery=this.ScreenObject.GetCustomCostCenterFieldsQuery(),this.TntObj.ActivityXml=this.ViewActivities.ActivitiesXML(),this.TntObj.NotesXML=this.ViewNotes.GetXML();try{this.TntObj.AttachmetsXML=this.ViewAttachments.GetXML();var f="";this.IsPhotoChanged&&!a.e.IsEmpty(this.AccountPhoto)?(f+=0==this.FileID?'<Row Action="NEW"':'<Row Action="MODIFY"',s.a.SessionManager.IsWebApplication?(f+=' AttachmentID="'+this.FileID+'"',f+=' FilePath="'+this.AccountPhoto+'"',f+=' ActualFileName="'+this.AccountPhoto.substr(this.AccountPhoto.lastIndexOf("\\")+1)+'"',f+=' RelativeFileName="'+this.AccountPhoto+'"',f+=' FileExtension="'+this.FileExtension+'"',f+=' FileDescription="'+d.d.GetValidXml(this.FileDescription)+'"',f+=' IsProductImage="1"',f+=' IsDefaultImage="1"',f+=' GUID="'+this.guid+'"',f+="/>"):(f+=' AttachmentID="'+this.FileID+'"',f+=' FilePath="'+this.AccountPhoto+'"',f+=' RelativeFileName="'+this.AccountPhoto+'"',f+=' FileExtension="'+this.FileExtension+'"',f+=' FileDescription="'+d.d.GetValidXml(this.FileDescription)+'"',f+=' IsProductImage="1"',f+=' IsDefaultImage="1"',f+=' GUID="'+this.guid+'"',f+="/>")):this.IsPhotoDelete&&this.FileID>0&&(f+='<Row Action="DELETE"',f+=' AttachmentID="'+this.FileID+'"/>'),f.length>0&&(f="<AttachmentsXML>"+f+"</AttachmentsXML>",this.TntObj.AttachmetsXML=this.TntObj.AttachmetsXML+f.toString())}catch(D){return this.DisplayMessage=s.a.GetResource("Upload_Path_notExists"),void(this.MessageVisibility=!0)}this.TntObj.PrimaryContactQuery=null!=this.PContact?this.PContact.GetXML():"",this.TntObj.ContactsXML=this.ViewContacts.GetXML(),this.TntObj.WID=this.ScreenObject.CheckWorkFlow(),s.a.rental.SaveTenant(this.TntObj,"SaveTenant").subscribe((function(e){t.DisplayMessage=e.Message,t.MessageVisibility=!0,t.RetValue=e.RetValue,t.RetValue>0&&(t.txtCode.Text="",t.FstName.Text="",t.MdlName.Text="",t.LstName.Text="",t.LeaseSignatory.Text="",t.Phone1.Text="",t.Phone2.Text="",t.Email.Text="",t.Fax.Text="",t.IDNumber.Text="",t.Profession.Text="",t.AutoGenerateCode(),t.ScreenObject.Clear(),t.ViewAttachments.AttachmentsListObj.Clear(),t.ViewContacts.ContactsListObj.Clear(),t.ViewContacts.DeletedContacts.Clear(),t.ViewNotes.NotesList.Clear(),t.ViewNotes.DeletedNotes.Clear(),null!=t.PContact&&t.PContact.ClearFields(),t.AccountPhoto="",t.PhotoTextVisibility=!0,t.ViewActivities.ActivityGridData.Clear(),t.ViewActivities.ActivityGridDataObj.Clear(),t.ActualFileName="",t.ParentId>0&&(t.Group.SelectedValue=t.ParentId))}),(function(e){console.log(" Unit Save : "+JSON.stringify(e))}))}catch(b){Logger.ErrorLog("AddEditTenantViewModel:: OnSave : "+b.stack)}Logger.InfoLog("AddEditTenantViewModel:: Exiting OnSave")}},{key:"getGuid",value:function(e){var t=this,i=new FormData;i.append("ImageUpload",e),i.append("FileUpload",e),i.append("UserName",s.a.SessionManager.UserID),s.a.common.UploadAttachments(i).subscribe((function(e){t.guid=e,t.guid=t.guid.split(".")[0],t.AccountPhoto=a.e.GetPath(t.guid+"."+t.FileExtension)}),(function(e){console.log("Error : "+JSON.stringify(e))}))}}]),p}(p.b)}}]);