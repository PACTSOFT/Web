(window.webpackJsonp=window.webpackJsonp||[]).push([[218],{LPVC:function(e,t,s){"use strict";s.r(t),s.d(t,"LookupsViewModel",(function(){return L})),s.d(t,"QuickAddLookupsViewModel",(function(){return k}));var i=s("eQJW"),o=s("ScVY"),a=s("4HhE"),n=s("ockk"),d=s("0/4Q"),l=s("EQd/"),u=s("NkMH"),p=s("Do2H"),h=s("Lp6j"),r=s("8B8H");class L extends o.b{constructor(){super(...arguments),this.NodeID=0,this.ButtonClick=new a.b,this.LookupsTableObj=new r.a,this.LookupTypes=new d.e(0),this.Code=new l.d(0),this.Name=new l.d(0),this.AliasName=new l.d(0),this.ButtonAddLookup=new u.a,this.ButtonSave=new u.a,this.ButtonAdd=new u.a,this.ButtonEdit=new u.a,this.ButtonDelete=new u.a,this.ColLists=[],this.LookupType=0,this.isTravel=!1}get Title(){return this._ScreenName}set Title(e){e!=this._ScreenName&&(this._ScreenName=e)}get DisplayName(){return this._DisplayName}set DisplayName(e){e!=this._DisplayName&&(this._DisplayName=e)}get angularGrid(){return this.LookupsTableObj.angularGrid}get LookupsTable(){return this.LookupsTableObj.Table}get LookupsTableColumns(){return this.LookupsTableObj.TableColumns}get ColumnSource(){return this.LookupsTableObj.Columns}get contextVisible(){return this.LookupsTableObj.contextVisible}set contextVisible(e){this.LookupsTableObj.contextVisible=e}get AddEditLookupVisibility(){return this._AddEditLookupVisibility}set AddEditLookupVisibility(e){e&&(this.AddEditLookupTypeVisibility=!1),this._AddEditLookupVisibility!=e&&(this._AddEditLookupVisibility=e)}get AddEditLookupTypeVisibility(){return this._AddEditLookupTypeVisibility}set AddEditLookupTypeVisibility(e){e&&(this.AddEditLookupVisibility=!1),this._AddEditLookupTypeVisibility!=e&&(this._AddEditLookupTypeVisibility=e)}LookupsViewModel(e,t=0,s=!1){this.LookupType=t,this.isTravel=s,p.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=p.a.SessionManager.IsActionAssigned(44,"Create"):this.ButtonSave.Enable=p.a.SessionManager.IsActionAssigned(44,"Create"),p.a.SessionManager.HideUnathorizedAccess?this.ButtonEdit.Visible=p.a.SessionManager.IsActionAssigned(44,"Update"):this.ButtonEdit.Enable=p.a.SessionManager.IsActionAssigned(44,"Update"),this.AddEditLookupVisibility=!1,p.a.SessionManager.HideUnathorizedAccess?this.ButtonDelete.Visible=p.a.SessionManager.IsActionAssigned(44,"Delete"):this.ButtonDelete.Enable=p.a.SessionManager.IsActionAssigned(44,"Delete"),p.a.SessionManager.HideUnathorizedAccess?this.ButtonAddLookup.Visible=p.a.SessionManager.IsActionAssigned(44,"Add Lookup"):this.ButtonAddLookup.Enable=p.a.SessionManager.IsActionAssigned(44,"Add Lookup"),this.Title=e,this.ButtonClick.Subscribe(this,"CommandController"),this.DisplayName=this.Title,this.AddGridColumns(),this.LookupTypes.SelectionChangedCommand.Subscribe(this,"OnLookupChanged"),this.LoadLookupTypes(),s&&(this.ButtonAddLookup.Visible=!1)}LoadLookupTypes(){let e=p.a.admin.GetLookupTypes().Tables[0],t="124,125,126,127,128,129,130,131,132,133,134,135,136,137,140,142,143,144,145,146,147".split(",");e=e.filter(this.isTravel?e=>t.Contains(e.NodeID.toString()):e=>!t.Contains(e.NodeID.toString()));for(let s=0;s<e.length;s++)this.LookupTypes.Items.push(d.d.ComboBoxItems_2(h.e.StringValue(e[s].ResourceName),e[s].NodeID.toString()));this.LookupTypes.Items.length>0&&(this.LookupType>0?(this.LookupTypes.SetSelectedItem(this.LookupType.toString()),this.LookupTypes.SelectedValue=this.LookupType.toString()):(this.LookupTypes.SelectedItem=this.LookupTypes.Items[0],this.LookupTypes.SelectedValue=this.LookupTypes.Items[0].Value),this.OnLookupChanged(""))}AddGridColumns(){this.LookupsTableColumns.push("NodeID"),this.LookupsTableColumns.push("Code"),this.LookupsTableColumns.push("Name"),this.LookupsTableColumns.push("IsDefault"),this.LookupsTableColumns.push("Status");let e=new n.a;e=new n.a,e.DisplayMember="Code",e.Header=p.a.GetResource("CCGroup_Code"),e.DataType="TextBlock",e.Width=180,e.ReadOnly=!0,e.IsVisible=!0,this.LookupsTableObj.Columns.push(e),e=new n.a,e=new n.a,e.DisplayMember="Name",e.Header=p.a.GetResource("CCGroup_Name"),e.DataType="TextBlock",e.Width=320,e.ReadOnly=!0,e.IsVisible=!0,this.LookupsTableObj.Columns.push(e),e=new n.a,e.DisplayMember="IsDefault",e.Header=p.a.GetResource("CCGroup_IsDefault"),e.DataType="RadioButton",e.Width=150,e.ReadOnly=!1,e.IsVisible=!0,this.LookupsTableObj.Columns.push(e)}OnLookupChanged(e){this.NodeID=0,this.MessageVisibility=!1,this.DisplayMessage="",this.Code.Text="",this.Name.Text="",this.AliasName.Text="";let t=p.a.admin.GetLookupDataByType(parseInt(this.LookupTypes.SelectedValue));this.LookupsTableObj.Table=t.Tables[0],this.LookupsTableObj.refreshids();try{this.LookupsTableObj.Table.forEach(e=>{""!=e.IsDefault.toString()&&0!=Object(i.j)(e.IsDefault)||(e.IsDefault=!1)})}catch(s){throw" error"}}CommandController(e){switch(this.DisplayMessage="",e.toString()){case"ADD":this.NodeID=0,this.Code.Text="",this.Name.Text="",this.AliasName.Text="",this.AddEditLookupVisibility=!0;break;case"EDIT":null!=this.SelectedLookup&&(this.NodeID=parseInt(this.SelectedLookup.NodeID),this.Code.Text=this.SelectedLookup.Code.toString(),this.Name.Text=this.SelectedLookup.Name.toString(),this.AliasName.Text=this.SelectedLookup.AliasName.toString(),this.AddEditLookupVisibility=!0);break;case"DELETE":break;case"Cancel":this.AddEditLookupVisibility=!1,this.AddEditLookupTypeVisibility=!1;break;case"Save":this.OnSaveLookup();break;case"Update":this.OnUpdate();break;case"ADDLOOKUPTYPE":this.NodeID=0,this.Code.Text="",this.Name.Text="",this.AliasName.Text="",this.AddEditLookupTypeVisibility=!0;break;case"SaveLOOKUPTYPE":this.OnSaveLookupType()}}OnUpdate(){Logger.InfoLog("LookupsViewModel::Entering OnUpdate");try{if(null!=this.LookupsTableObj.Table&&this.LookupsTableObj.Table.length>0){let e="";e+="<XML>";let t,s=0;for(let i=0;i<this.LookupsTableObj.Table.length;i++)s="True"==this.LookupsTableObj.Table[i].IsDefault.toString()?1:0,e+="<Row Default='"+s+"' NodeID='"+this.LookupsTableObj.Table[i].NodeID.toString()+"' />";e+="</XML>",t=p.a.admin.UpdateLookups(e.toString()).RetValue,t>0&&(this.MessageVisibility=!0,this.DisplayMessage="Updated Sucessfully")}}catch(e){Logger.ErrorLog("LookupsViewModel::OnUpdate"+e.stack)}}OnSaveLookup(){Logger.InfoLog("LookupsViewModel::Entering OnSaveLookup");try{if(h.e.IsEmpty(this.Name.Text))return void(this.DisplayMessage="Enter Name");let e,t=p.a.admin.SetLookup(parseInt(this.LookupTypes.SelectedValue),this.NodeID,this.Code.Text,this.Name.Text,h.e.IsEmpty(this.AliasName.Tag)?this.AliasName.Text:this.AliasName.Tag,1);this.DisplayMessage=t.Message,e=t.RetValue,e>0&&this.OnLookupChanged(""),Logger.InfoLog("LookupAddViewModel::Exiting OnSaveLookup")}catch(e){Logger.ErrorLog("LookupAddViewModel::OnSaveLookup"+e.stack)}}OnDeleteCallBack(){let e,t=p.a.admin.DeleteLookup(parseInt(this.SelectedLookup.NodeID));this.DisplayMessage=t.Message,e=t.RetValue,e>0&&this.OnLookupChanged(null)}OnSaveLookupType(){Logger.InfoLog("LookupsViewModel::Entering OnSaveLookupType");try{if(h.e.IsEmpty(this.Name.Text))return void(this.DisplayMessage="Enter Name");let e,t=p.a.admin.SetLookupType(0,this.Name.Text);this.DisplayMessage=t.Message,e=t.RetValue,e>0&&(this.LoadLookupTypes(),this.LookupTypes.SelectedValue=e.toString()),Logger.InfoLog("LookupAddViewModel::Exiting OnSaveLookupType")}catch(e){Logger.ErrorLog("LookupAddViewModel::OnSaveLookupType"+e.stack)}}}class k extends o.b{constructor(){super(...arguments),this.NodeID=0,this.ClassName="QuickAddLookupsViewModel",this.ButtonClick=new a.b,this.Code=new l.d(0),this.Name=new l.d(0),this.AliasName=new l.d(0),this.ButtonSave=new u.a}QuickAddLookupsViewModel(e,t){this.NodeID=t,this.LookupTypeID=e,this.Name.Label=p.a.GetResource("CCGroup_Name"),0==t?(this.Title="Quick Add Lookup",p.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=p.a.SessionManager.IsActionAssigned(44,"Create"):this.ButtonSave.Enable=p.a.SessionManager.IsActionAssigned(44,"Create")):(this.Title="Edit Lookup",p.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=p.a.SessionManager.IsActionAssigned(44,"Update"):this.ButtonSave.Enable=p.a.SessionManager.IsActionAssigned(44,"Update")),this.ButtonClick.Subscribe(this,"CommandController")}CommandController(e){switch(this.DisplayMessage="",e.toString()){case"Cancel":p.a.page.HideDialog();break;case"Save":this.OnSaveLookup();break;case"Update":this.OnUpdate()}}OnUpdate(){}OnSaveLookup(){Logger.InfoLog("QuickAddLookupsViewModel::Entering OnSaveLookup");try{if(h.e.IsEmpty(this.Name.Text))return void(this.DisplayMessage="Enter Name");let e,t=p.a.admin.SetLookup(this.LookupTypeID,this.NodeID,this.Code.Text,this.Name.Text,this.AliasName.Text,1);this.DisplayMessage=t.Message,e=t.RetValue,e>0&&(this.NodeID=e,p.a.page.HideDialog())}catch(e){Logger.ErrorLog("QuickAddLookupsViewModel::OnSaveLookup"+e.stack)}}}}}]);