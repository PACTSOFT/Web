(window.webpackJsonp=window.webpackJsonp||[]).push([[133],{"F+4J":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var s=i("Do2H");class a{constructor(){this.TeamID=0,this.Status=0,this.IsGroup=!1,this.FetaureID=0,this.FeatureNodeID=0,this.TeamNodeID=0,this.UserID=0,this.ActivityID=0,this.isTeam=0,this.isRole=0,this.isGroup=0}GetAssignedDetails(e,t,i){let a=[];a.push(e),a.push(t),a.push(i),a.push(s.a.SessionManager.UserID),a.push(s.a.SessionManager.LanguageID);let n="?CompanyIndex="+s.a.SessionManager.CompanyIndex+"&param="+JSON.stringify(a);return s.a.crmService.GetAssignedList(n)}GetCRMHistoryDetails(e,t){Logger.InfoLog("Team:: Inside GetCRMHistoryDetails");let i=[];i.push(e),i.push(t),i.push(s.a.SessionManager.UserID),i.push(s.a.SessionManager.LanguageID);let a="?param="+JSON.stringify(i);return Logger.InfoLog("Team:: Success: DBH.GetCRMHistoryDetails "+e.ToString()),s.a.crmService.GetCRMHistoryDetails(a)}FeatureAssign(){let e=[];return e.push(this.FetaureID),e.push(this.FeatureNodeID),e.push(this.TeamNodeID),e.push(this.UserID),e.push(this.isTeam),e.push(this.UsersXML),e.push(this.RolesXML),e.push(this.GroupXML),e.push(s.a.SessionManager.CompanyGUID),e.push(s.a.SessionManager.UserName),e.push(s.a.SessionManager.LanguageID),s.a.crmService.AssignFeature(e)}ActivityAssign(){let e=[];return e.push(this.FetaureID),e.push(this.FeatureNodeID),e.push(this.TeamNodeID),e.push(this.UserID),e.push(this.isTeam),e.push(this.UsersXML),e.push(this.RolesXML),e.push(this.GroupXML),e.push(s.a.SessionManager.CompanyGUID),e.push(s.a.SessionManager.UserName),e.push(s.a.SessionManager.LanguageID),e.push(this.ActivityID),s.a.crmService.ActivityAssign(e)}SetInvite(){let e=[];return e.push(this.FetaureID),e.push(this.FeatureNodeID),e.push(this.TeamNodeID),e.push(this.UserID),e.push(this.isTeam),e.push(this.UsersXML),e.push(this.RolesXML),e.push(this.GroupXML),e.push(s.a.SessionManager.CompanyGUID),e.push(s.a.SessionManager.UserName),e.push(s.a.SessionManager.LanguageID),e.push(this.InviteComments),s.a.crmService.SetInvite(e)}SetInviteStatus(e){Logger.InfoLog("Team::Entering SetInviteStatus");try{let t=[];t.push(e),t.push(s.a.SessionManager.UserName),t.push(s.a.SessionManager.UserID),t.push(s.a.SessionManager.LanguageID);let i=s.a.crmService.SetInviteStatus(t);return Logger.InfoLog("Team::Exiting SetInviteStatus"),i}catch(t){return Logger.ErrorLog("Team::SetInviteStatus"+t.stack),""}}AssignMultipleFeature(){let e=[];return e.push(this.FetaureID),e.push(this.NodesXML),e.push(this.TeamNodeID),e.push(this.UserID),e.push(this.isTeam),e.push(this.UsersXML),e.push(this.RolesXML),e.push(this.GroupXML),e.push(s.a.SessionManager.CompanyGUID),e.push(s.a.SessionManager.UserName),e.push(s.a.SessionManager.LanguageID),s.a.crmService.AssignMultipleFeature(e)}}},UlzB:function(e,t,i){"use strict";i.r(t),i.d(t,"InvitesViewModel",(function(){return d}));var s=i("Do2H"),a=i("Lp6j"),n=i("ScVY"),r=i("4HhE"),o=i("8B8H"),h=i("JIg3"),l=i("ockk"),u=i("F+4J");class d extends n.b{constructor(){super(),this.SaveInvite=new r.b,this._ActivityID=0,this._SearchDate=new h.a(0),this.dset=[]}get ActivityID(){}set ActivityID(e){this._ActivityID=e}get SearchDate(){return this._SearchDate}set SearchDate(e){this._SearchDate=e}InvitesViewModel_1(e,t,i){Logger.InfoLog("InvitesViewModel :: entering "),this.IsInvite=i,this.InviteGrid=new o.a,this.dset=t,this.IsInvite?(this.LblText="Invities",this.Title="Invities",this.CancelVisibility=!0,this.Width="1000",this.SaveVisibility=!0,this.SearchVisibility=!0,this.AddGridColumns()):(this.LblText="Attendies",this.Title="Attendies",this.CancelVisibility=!0,this.Width="600",this.SaveVisibility=!1,this.SearchVisibility=!1,this.AddAttendiesGridColumns()),this.LoadData(),this.SaveInvite.Subscribe(this,"onSaveInvite"),Logger.InfoLog("InvitesViewModel :: exiting ")}InvitesViewModel_2(e,t,i,s){this.InvitesViewModel_1(e,t,i),Logger.InfoLog("InvitesViewModel :: entering "),this.ActivityID=s,Logger.InfoLog("InvitesViewModel :: exiting ")}BuildTempTable(){Logger.InfoLog("InvitesViewModel :: entering BuildTempTable "),this.InviteGrid.Table=[],this.InviteGrid.Width=(parseInt(this.Width)-25).toString(),this.InviteGrid.Height=300,this.InviteGrid.TableColumns.push("SNo"),this.InviteGrid.TableColumns.push("ActivityID"),this.InviteGrid.TableColumns.push("Customer"),this.InviteGrid.TableColumns.push("Subject"),this.InviteGrid.TableColumns.push("StartDate"),this.InviteGrid.TableColumns.push("EndDate"),this.InviteGrid.TableColumns.push("RequestedBy"),this.InviteGrid.TableColumns.push("RequestedDate"),this.InviteGrid.TableColumns.push("InviteComments"),this.InviteGrid.TableColumns.push("InviteStatus"),Logger.InfoLog("InvitesViewModel :: exiting BuildTempTable ")}AddGridColumns(){Logger.InfoLog("InvitesViewModel :: entering AddGridColumns "),this.BuildTempTable();let e=[],t=new l.a;t=new l.a,t.DisplayMember="SNo",t.Header=s.a.GetResource("UOM_Sno"),t.DataType="TextBlock",t.Width=50,t.ReadOnly=!0,t.IsVisible=!0,e.push(t),t=new l.a,t.ComboData=this.ReturnStatus(),t.DisplayMember="InviteStatus",t.ValueMember="Value",t.ValueBinding="InviteStatus",t.Header="Status",t.DataType="ComboBox",t.Width=100,t.IsVisible=!0,e.push(t),t=new l.a,t.DisplayMember="Customer",t.Header="Customer",t.DataType="TextBlock",t.Width=150,t.IsVisible=!0,e.push(t),t=new l.a,t.DisplayMember="Subject",t.Header="Subject",t.DataType="TextBlock",t.Width=150,t.IsVisible=!0,e.push(t),t=new l.a,t.DisplayMember="StartDate",t.Header="Start Date",t.DataType="TextBlock",t.Width=150,t.IsVisible=!0,e.push(t),t=new l.a,t.DisplayMember="EndDate",t.Header="End Date",t.DataType="TextBlock",t.Width=150,t.IsVisible=!0,e.push(t),t=new l.a,t.DisplayMember="RequestedBy",t.Header="Requested By",t.DataType="TextBlock",t.Width=80,t.IsVisible=!0,e.push(t),t=new l.a,t.DisplayMember="RequestedDate",t.Header="Requested Date",t.DataType="TextBlock",t.Width=150,t.IsVisible=!0,e.push(t),t=new l.a,t.DisplayMember="InviteComments",t.Header="Comments",t.DataType="TextBlock",t.Width=150,t.IsVisible=!0,e.push(t),this.InviteGrid.Columns=e,this.InviteGrid.OnCellEditEnding.Subscribe(this,"OnGridCellEditEnding"),Logger.InfoLog("InvitesViewModel :: exiting AddGridColumns ")}BuildAttendiesTempTable(){Logger.InfoLog("InvitesViewModel :: entering BuildTempTable "),this.InviteGrid.Table=[],this.InviteGrid.Width=(parseInt(this.Width)-25).toString(),this.InviteGrid.Height=300,this.InviteGrid.TableColumns.push("SNo"),this.InviteGrid.TableColumns.push("ActivityID"),this.InviteGrid.TableColumns.push("CreatedBy"),this.InviteGrid.TableColumns.push("UserName"),this.InviteGrid.TableColumns.push("InviteStatus"),this.InviteGrid.TableColumns.push("InvAtt"),Logger.InfoLog("InvitesViewModel :: exiting BuildTempTable ")}AddAttendiesGridColumns(){Logger.InfoLog("InvitesViewModel :: entering AddGridColumns "),this.BuildAttendiesTempTable();let e=[],t=new l.a;t=new l.a,t.DisplayMember="SNo",t.Header=s.a.GetResource("UOM_Sno"),t.DataType="TextBlock",t.Width=50,t.ReadOnly=!0,t.IsVisible=!0,e.push(t),t=new l.a,t.DisplayMember="UserName",t.Header="User",t.DataType="TextBlock",t.Width=150,t.IsVisible=!0,e.push(t),t=new l.a,t.DisplayMember="InviteStatus",t.Header="Status",t.DataType="TextBlock",t.Width=150,t.IsVisible=!0,e.push(t),t=new l.a,t.DisplayMember="InvAtt",t.Header="Invite / Attendies",t.DataType="TextBlock",t.Width=150,t.IsVisible=!0,e.push(t),this.InviteGrid.Columns=e,Logger.InfoLog("InvitesViewModel :: exiting AddGridColumns ")}ReturnStatus(){let e=[];return e.push({InviteStatus:"",Value:""}),e.push({InviteStatus:"Accepted",Value:"Accepted"}),e.push({InviteStatus:"Rejected",Value:"Rejected"}),e.push({InviteStatus:"Cancelled",Value:"Cancelled"}),e}OnGridCellEditEnding(e,t,i){if("InviteStatus"==t){if(Logger.InfoLog("InvitesViewModel::Entering OnGridCellEditEnding ColName="+t.toString()),"Cancelled"==e.InviteStatus.toString())e.InviteStatus="",this.DisplayMessage="Select Accepted/Rejected",this.MessageVisibility=!0;else{let t=s.a.common.GetDataSetQuery("SELECT statusid from crm_activities WITH(NOLOCK) where activityid in (select inviterefactid from crm_activities WITH(NOLOCK) where activityid="+e.ActivityID.toString()+")");null!=t&&t.Tables.length>0&&t.Tables[0].forEach(t=>{if("413"==t.statusid.toString())return this.DisplayMessage="Activity is Closed, click on save to update status",e.InviteStatus="Cancelled",void(this.MessageVisibility=!0)})}Logger.InfoLog("InvitesViewModel::Exiting OnGridCellEditEnding ColName="+t.toString())}}LoadData(){if(Logger.InfoLog("InvitesViewModel :: entering LoadData "),null!=this.dset&&this.dset.Tables.length>0){this.InviteGrid.Clear();let e=0;this.IsInvite?this.dset.Tables[0].length>0&&this.dset.Tables[0].forEach(t=>{let i=[];e+=1,i.SNo=e,a.e.hasprop(t,"CustomerID")&&(i.Customer=t.CustomerID),a.e.hasprop(t,"ActSubject")&&(i.Subject=t.ActSubject),a.e.hasprop(t,"InviteComments")&&(i.InviteComments=t.InviteComments),a.e.hasprop(t,"InviteStatus")&&(i.InviteStatus=t.InviteStatus),a.e.hasprop(t,"ActStartDate")&&(i.StartDate=t.ActStartDate.toString()+" "+new Date(t.ActStartTime.toString()).ToString("hh:mm:ss tt")),a.e.hasprop(t,"ActEndDate")&&(i.EndDate=t.ActEndDate+" "+new Date(t.ActEndTime.toString()).ToString("hh:mm:ss tt")),a.e.hasprop(t,"UserName")&&(i.RequestedBy=t.UserName),a.e.hasprop(t,"CreatedDate")&&(i.RequestedDate=t.CreatedDate),i.ActivityID=t.ActivityID,this.InviteGrid.addRow(i)}):this.dset.Tables[0].length>0&&this.dset.Tables[0].forEach(t=>{let i=[];e+=1,i.SNo=e,a.e.hasprop(t,"ActivityID")&&(i.ActivityID=t.ActivityID),a.e.hasprop(t,"CreatedBy")&&(i.CreatedBy=t.CreatedBy),a.e.hasprop(t,"UserName")&&(i.UserName=t.UserName),a.e.hasprop(t,"InviteStatus")&&(i.InviteStatus=t.InviteStatus),a.e.hasprop(t,"InvAtt")&&(i.InvAtt=t.InvAtt),this.InviteGrid.addRow(i)})}Logger.InfoLog("InvitesViewModel :: exiting LoadData ")}onSaveInvite(e){if(null!=e){if(Logger.InfoLog("InvitesViewModel :: entering onSaveInvite, sender "+e.toString()),"Cancel"==e.toString())s.a.page.HideDialog();else if("Search"==e.toString()){if(null!=this.SearchDate.Date){this.DisplayMessage="",this.MessageVisibility=!1;let e=s.a.cases.GetInvities(-100,-100,-100,0,this.SearchDate.Date);null!=e&&e.Tables.length>0&&(e.Tables[0].length>0?(this.dset=e,this.LoadData()):(this.DisplayMessage="No invitations",this.InviteGrid.Clear(),this.MessageVisibility=!0))}}else if("Clear"==e.toString())this.InviteGrid.Clear();else try{let e="";if(e=this.GetInviteXML(),""!=e.toString()){let t=new u.a,i=-1,s=t.SetInviteStatus(e);this.DisplayMessage=s.message,i=s.RetValue,i>0&&(this.DisplayMessage="Saved Successfully",this.MessageVisibility=!0,Logger.InfoLog("InvitesViewModel :: Exiting onSaveInvite set invite error "))}}catch(t){throw Logger.ErrorLog("InvitesViewModel :: Exiting onSaveInvite set invite error "+t.Message),""}Logger.InfoLog("InvitesViewModel :: exiting onSaveInvite ")}}GetInviteXML(){Logger.InfoLog("InvitesViewModel :: entering GetInviteXML ");let e="";try{for(let t=0;t<this.InviteGrid.Table.length;t++)""!=this.InviteGrid.Table[t].InviteStatus.toString()&&(e+="<Row  ",e+=' ActivityID="'+this.InviteGrid.Table[t].ActivityID.toString()+'"',e+=' InviteComments="'+this.InviteGrid.Table[t].InviteComments.toString()+'"',e+=' InviteStatus="'+this.InviteGrid.Table[t].InviteStatus.toString()+'"',e+=" />");e.length>0&&(e="<XML>"+e+"</XML>")}catch(t){return Logger.ErrorLog("InvitesViewModel :: exiting GetInviteXML error message is "+t.Message),this.DisplayMessage=t,this.MessageVisibility=!0,""}return Logger.InfoLog("InvitesViewModel :: exiting GetInviteXML "),e.toString()}}}}]);