(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{fVK4:function(e,t,l){"use strict";l.d(t,"a",(function(){return r}));var a=l("dH+5"),n=l("mvPR"),o=l("Lp6j");class r{constructor(e){this.sanitizer=e,this.cellFormatter=(e,t,l,r,i,p)=>{let s="";if(!i||t>=i.Cells.length)return"";if(o.e.IsEmpty(i.Cells[t].Text))return s=this.SetBackColor(i.Cells[t],r.DataContext),s.length>0?'<div style="'+s+'">&nbsp;</div>':"";let c,C,g=!1,u=r.DataContext,A=r.DataContext,D="",h="",m="",T=i;g=!1;let I=a.a.None;if(C=i.Cells[t],c=A.ColumnType,null!=C.CellAppearance&&null!=C.CellAppearance.ColumnType&&(c=C.CellAppearance.ColumnType,null!=c&&c.startsWith("LINK_")&&(I="LINK_ATTACHMENT"==c?a.a.Attachment:a.a.Document)),"IMAGE"!=c||T.Type!=n.f.Detail&&T.Type!=n.f.SubDetail)if("LEAVE_BAR"==c&&T.Type==n.f.Detail)D="div";else if(I!=a.a.None||A.LinkType!=a.a.None&&A.LinkType!=a.a.DimensionNode&&T.Type==n.f.Detail)D="a";else if(D="div",null!=C.Text&&C.Text.startsWith("<FlowDocument")){let e=o.c.GetFlowString(C.Text);e.startsWith("@@@")&&e.endsWith("@@@")?(g=!0,C.Value=e):h=e}else h=C.Text;else g=!0,D="div";if(!C.IsNormal&&C.level>0&&(s+="padding-left:"+15*C.level+"px;"),C.IsNormal||null==C.CellAppearance?null!=u.DataAppearance&&("Right"!=u.DataAppearance.Alignment&&"Center"!=u.DataAppearance.Alignment||(s+="text-align:"+u.DataAppearance.Alignment+";")):"Right"!=C.CellAppearance.Alignment&&"Center"!=C.CellAppearance.Alignment||(s+="text-align:"+C.CellAppearance.Alignment+";"),C.IsNegativeRed?s+="color:Red;":C.IsNormal||null==C.CellAppearance||o.e.IsEmpty(C.CellAppearance.ForeColor)?null!=u.DataAppearance.ForeColor&&(s+="color:"+this.getColor(u.DataAppearance.ForeColor)+";"):s+="color:"+this.getColor(C.CellAppearance.ForeColor)+";",s+=!C.IsNormal&&null!=C.CellAppearance&&C.CellAppearance.FontSize>0?"font-size:"+C.CellAppearance.FontSize+"px;":"font-size:"+u.DataAppearance.FontSize+"px;",(T.IsSelected||!C.IsNormal&&null!=C.CellAppearance&&C.CellAppearance.IsBold||u.DataAppearance.IsBold)&&(s+="font-weight:600;"),g){if(!o.e.IsEmpty(C.Text))try{D="div",m=C.Text.startsWith("<FlowDocument")?C.Value.toString().substring(3,C.Value.toString().length-3):C.Text,m='<img src="'+o.e.GetPath(m)+'" style="height:'+(T.Height-2)+'px;">'}catch(x){}}else if("a"==D)if(D="div",s+=this.SetBackColor(C,u),o.e.IsEmptySpace(C.Text)||!C.Text.Contains(",")||A.LinkType!=a.a.Document&&I!=a.a.Document)if(A.LinkType==a.a.Attachment||I==a.a.Attachment)if(C.Text.Contains(",")){let e,t=C.Text.split(",");e=T.DataRow?o.e.StringIsNullOrEmpty(T.DataRow[A.ID+"_ID"])?T.DataRow[A.ID].toString().split(","):T.DataRow[A.ID+"_ID"].toString().split(","):C.Value?C.Value.toString().split(","):C.Text.split(",");let l=Math.min(e.length,t.length);for(let a=0;a<l;a++)m+="<a tag='"+e[a]+"'>",m+=a<l-1?t[a]+", ":t[a],m+="<a/>"}else{let e;e=T.DataRow?o.e.StringIsNullOrEmpty(T.DataRow[A.ID+"_ID"])?T.DataRow[A.ID].toString():T.DataRow[A.ID+"_ID"].toString():C.Value?C.Value.toString():C.Text,m+="<a tag='"+e+"'>"+C.Text+"<a/>"}else m+="<a>",m+=C.Text,m+="</a>";else{let e=C.Text.split(",");for(let t=0;t<e.length;t++)m+="<a>",m+=t<e.length-1?e[t]+",":e[t],m+="<a/>"}else s+=this.SetBackColor(C,u);return h.length>0&&(h=h.Replace("<","&lt;"),h=h.Replace(">","&gt;")),s=""+s,D="<"+D+(s.length>0?" style='"+s+"'":"")+">"+h+m+"</"+D+">",D},this.cellFormatterAGGrid=(e,t,l,r)=>{let i=e,p="";if(!i||t>=i.Cells.length)return"";if(o.e.IsEmpty(i.Cells[t].Text))return p=this.SetBackColor(i.Cells[t],l.DataContext),r.style.cssText+=p,p.length>0?this.sanitizer.bypassSecurityTrustHtml('<div style="'+p+'">&nbsp;</div>'):"";let s,c,C=!1,g=l.DataContext,u=l.DataContext,A="",D="",h="",m=i;C=!1;let T=a.a.None;if(c=i.Cells[t],s=u.ColumnType,null!=c.CellAppearance&&null!=c.CellAppearance.ColumnType&&(s=c.CellAppearance.ColumnType,null!=s&&s.startsWith("LINK_")&&(T="LINK_ATTACHMENT"==s?a.a.Attachment:a.a.Document)),"IMAGE"!=s||m.Type!=n.f.Detail&&m.Type!=n.f.SubDetail)if("LEAVE_BAR"==s&&m.Type==n.f.Detail)A="div";else if(T!=a.a.None||u.LinkType!=a.a.None&&u.LinkType!=a.a.DimensionNode&&m.Type==n.f.Detail)A="a";else if(A="div",null!=c.Text&&c.Text.startsWith("<FlowDocument")){let e=o.c.GetFlowString(c.Text);e.startsWith("@@@")&&e.endsWith("@@@")?(C=!0,c.Value=e):D=e}else D=c.Text;else C=!0,A="div";if(!c.IsNormal&&c.level>0&&(p+="padding-left:"+15*c.level+"px;"),c.IsNormal||null==c.CellAppearance?null!=g.DataAppearance&&("Right"!=g.DataAppearance.Alignment&&"Center"!=g.DataAppearance.Alignment||(p+="text-align:"+g.DataAppearance.Alignment+";")):"Right"!=c.CellAppearance.Alignment&&"Center"!=c.CellAppearance.Alignment||(p+="text-align:"+c.CellAppearance.Alignment+";"),c.IsNegativeRed?p+="color:Red;":c.IsNormal||null==c.CellAppearance||o.e.IsEmpty(c.CellAppearance.ForeColor)?null!=g.DataAppearance.ForeColor&&(p+="color:"+this.getColor(g.DataAppearance.ForeColor)+";"):p+="color:"+this.getColor(c.CellAppearance.ForeColor)+";",p+=!c.IsNormal&&null!=c.CellAppearance&&c.CellAppearance.FontSize>0?"font-size:"+c.CellAppearance.FontSize+"px;":"font-size:"+g.DataAppearance.FontSize+"px;",(m.IsSelected||!c.IsNormal&&null!=c.CellAppearance&&c.CellAppearance.IsBold||g.DataAppearance.IsBold)&&(p+="font-weight:600;"),C){if(!o.e.IsEmpty(c.Text))try{A="div",h=c.Text.startsWith("<FlowDocument")?c.Value.toString().substring(3,c.Value.toString().length-3):c.Text,h='<img src="'+o.e.GetPath(h)+'" style="height:'+(m.Height-2)+'px;">'}catch(I){}}else if("a"==A)if(A="div",p+=this.SetBackColor(c,g),o.e.IsEmptySpace(c.Text)||!c.Text.Contains(",")||u.LinkType!=a.a.Document&&T!=a.a.Document)if(u.LinkType==a.a.Attachment||T==a.a.Attachment)if(c.Text.Contains(",")){let e,t=c.Text.split(",");e=m.DataRow?o.e.StringIsNullOrEmpty(m.DataRow[u.ID+"_ID"])?m.DataRow[u.ID].toString().split(","):m.DataRow[u.ID+"_ID"].toString().split(","):c.Value?c.Value.toString().split(","):c.Text.split(",");let l=Math.min(e.length,t.length);for(let a=0;a<l;a++)h+="<a tag='"+e[a]+"'>",h+=a<l-1?t[a]+", ":t[a],h+="<a/>"}else{let e;e=m.DataRow?o.e.StringIsNullOrEmpty(m.DataRow[u.ID+"_ID"])?m.DataRow[u.ID].toString():m.DataRow[u.ID+"_ID"].toString():c.Value?c.Value.toString():c.Text,h+="<a tag='"+e+"'>"+c.Text+"<a/>"}else h+="<a>",h+=c.Text,h+="</a>";else{let e=c.Text.split(",");for(let t=0;t<e.length;t++)h+="<a>",h+=t<e.length-1?e[t]+",":e[t],h+="<a/>"}else p+=this.SetBackColor(c,g);return D.length>0&&(D=D.Replace("<","&lt;"),D=D.Replace(">","&gt;")),p=""+p,A="<"+A+(p.length>0?" style='"+p+"'":"")+">"+D+h+"</"+A+">",r.style.cssText+=p,this.sanitizer.bypassSecurityTrustHtml(A)}}setColSpan(e){let t={columns:{}};for(let l=0;l<e.Cells.length;l++)e.Cells[l].ColSpan>1&&(t.columns[l]={colspan:e.Cells[l].ColSpan},l+=e.Cells[l].ColSpan-1);return t}SetBackColor(e,t){let l="";return e.IsNormal||null==e.CellAppearance||o.e.IsEmpty(e.CellAppearance.BackColor)?null!=t.DataAppearance.BackColor&&(l=this.getColor(t.DataAppearance.BackColor)):l=this.getColor(e.CellAppearance.BackColor),""!=l&&"White"!=l&&"#FFFFFF"!=l.toString().toUpperCase()&&(l="background-color:"+l+";"),l}getColor(e){return 9==e.length&&e.startsWith("#")&&(e="#"+e.substr(3)),e}}}}]);