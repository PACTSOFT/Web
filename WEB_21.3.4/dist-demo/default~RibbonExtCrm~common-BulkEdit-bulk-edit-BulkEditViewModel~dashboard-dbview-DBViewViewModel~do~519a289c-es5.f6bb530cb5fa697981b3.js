function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var i,o=_getPrototypeOf(e);if(t){var r=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,r)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{BBu9:function(e,t,i){"use strict";i.r(t),i.d(t,"PrefetchReportCells",(function(){return g})),i.d(t,"ReOrderLevelNewViewModel",(function(){return M}));var o=i("mrSG"),r=i("Do2H"),s=i("Lp6j"),n=i("vTM8"),l=i("8iaB"),a=i("0/4Q"),u=i("4HhE"),d=i("n56n"),h=i("7JXL"),c=i("ZDA+"),D=i("ockk"),m=i("x+Dt"),C=i("8B8H"),f=i("EQd/"),p=i("JIg3"),S=i("uMy8"),I=i("6z9j"),y=i("ktgv"),T=i("MCLT"),P=i("PDNK"),b=i("dH+5"),O=i("Jnyl"),R=i("CUWK"),g=function e(){_classCallCheck(this,e),this.ROColID=null,this.Type=null,this.indReport=0,this.value=null,this.IsDimension=!1,this.DimensionID=1},E=function(e){return e[e.None=0]="None",e[e.BOM=1]="BOM",e[e.RawMaterial=2]="RawMaterial",e[e.FinishedProduct=3]="FinishedProduct",e}({}),M=function(e){_inherits(g,e);var t=_createSuper(g);function g(e,i,o){var r;return _classCallCheck(this,g),(r=t.call(this)).ButtonsVisibility=!0,r._GridVisibility=!1,r.ShowAutoPost=!1,r.FilterVisibility=!1,r.ShowPostFilter=!1,r.ColumnsSource=null,r.RecordCount="",r.AutoPostMessage="",r.DateFilter="",r.ProfileName="",r.ShowBOMProducts=E.None,r.ProductsByVoucher=!1,r.ProductsByVoucher_Temp=!1,r.ProductsByRowSelection=!1,r.IsKitProjection=!1,r.DocumentVisibility=!1,r.AllowToAdd=!1,r.IsNew=!0,r.DialogAction=null,r.Documents=new a.e(0),r.TreeVisibility=!0,r.SalesFilterVisible=!1,r.AvgSaleByTrMn=!1,r.BOMGridWithReport=!1,r.Slot1=new f.d(0),r.Slot2=new f.d(0),r.Slot3=new f.d(0),r.SalesForeCastDays=new f.d(0),r.ToDateFilter=new p.a(0),r.FromDate=new p.a(0),r.ToDate=new p.a(0),r.colAvgSales=null,r.colReOrderQty=null,r.colOrderQty=null,r.colVendor=null,r.colUOM=null,r.DWPCProfile=null,r.xDocPref=new s.f,r.ExpectedQTY1="",r.ExpectedQTY2="",r.ExpectedQTY3="",r.CommitedQTY1="",r.CommitedQTY2="",r.CommitedQTY3="",r.SalesDocs="",r.BatchPreExpiry="",r.lstBatchExpirySlabs=new Array,r.drReport=null,r.DimensionFilter=null,r.LocationCols=new n.a,r.totalALL=new n.a,r.totalSELECTED=new n.a,r.SelectedLocations="",r.SelectedAvgLocations="",r.SelectedReOrderLocations="",r.SelectTag="",r.FromTag="",r.ReportID=112,r.worker=new u.a,r.dsReportDefn=null,r.dtPCProfile=null,r.strHiddenFields="",r.DefaultSortColumn="",r.SalesCostColumn="",r.SalesValueColumn="",r.DontIncludeExpiredProducts=!1,r.DontIncludePreExpiryProducts=!1,r.ExpiryPickFromProduct=!1,r.IsReportDB=!1,r.HidePrefetch=!1,r.ReorderDimension=0,r.PreExpiryProductDays=0,r.JOBDimension=0,r.DocumentMappingColumns=new Array,r.lstSaleSlots=new n.a,r.lstPCProfiles=new n.a,r.SalesSlotType="",r.PostedQtyFor="",r.ExeQty_DontShowUnApproved=!1,r.iLoop=0,r.sno=0,r.ProductsIDs=new Array,r.ObjArray=[],r.dsClass=null,r.strPrevGroup=null,r.indGrpColumn=1,r.GroupNo=0,r.dsProduct=null,r.dicFPQty=new n.c,r.dicFPConvertionQty=new n.a,r.dicKitProjection=new n.c,r.lstKitProjection=new Array,r.IsAutoPost=!0,r.ReorderBasedOnProductGroup_Report=!1,r.indPostIndex=0,r.iVendorCount=0,r.ChunkSize=2,r.lstVendors=new Array,r.lstPostDocsGroup=new Array,r.dtVoucherDetails=null,r.strDimensionLinkQry="",r.DocumentNumber=null,r.DocDefaultCCFields=new n.c,r.DocumentLinkDimensions=new Array,r.PostDocsGroupBy="",r.postworkerCancel=!1,r.postworkerIsBusy=!1,r.ClassName="ReOrderLevelNewViewModel",r.ReportID=i,r.dsReportDefn=o,r.Title=e,r.DisplayName=e,r.FilterVisibility=!0,r.GridVisibility=!1,r.InitFilterScreen(),r.HidePrefetch&&r.OnButtonClick("FilterOK"),r}return _createClass(g,[{key:"worker_DoWork",value:function(e,t){this.DisplayName=r.a.GetResource("Loading"),this.ButtonsVisibility=!1;try{this.RefreshDateFilter(),this.LoadReOrderGrid(t)}catch(i){Logger.ErrorLog("ReOrderLevel:: LoadReOrderGrid",i)}this.ButtonsVisibility=!0,this.DisplayName=this.Title}},{key:"worker_RunWorkerCompleted",value:function(e,t){this.RecordCount="",this.ReOrderGrid.UpdateTotals(),this.ReOrderGrid.refreshDataView()}},{key:"InitFilterScreen",value:function(){var e,t=this;if(this.ToDateFilter.Label="As On",this.ToDateFilter.LblWidth="50",this.Slot1.Label=r.a.GetResource("Report_LblSlot1"),this.Slot2.Label=r.a.GetResource("Report_LblSlot2"),this.Slot3.Label=r.a.GetResource("Report_LblSlot3"),this.Slot1.Width="70",this.Slot2.Width="70",this.Slot3.Width="70",this.SalesForeCastDays.Text="90",this.SalesForeCastDays.Label="Fore Cast Days",this.SalesForeCastDays.LblWidth="100",this.SalesForeCastDays.Width="170",this.FromDate.Label=r.a.GetResource("Reports_LblFromDate"),this.ToDate.Label=r.a.GetResource("Reports_LblToDate"),this.FromDate.Date=r.a.SessionManager.ReportsFromDate,this.ProductStatus=new a.e(0),this.ProductStatus.Label=r.a.GetResource("Reports_ProductStatus"),this.ProductStatus.Items.push(a.d.ComboBoxItems_2(r.a.GetResource("RevenUReport_Active"),"31")),this.ProductStatus.Items.push(a.d.ComboBoxItems_2(r.a.GetResource("RevenUReport_InActive"),"32")),this.ProductStatus.Items.push(a.d.ComboBoxItems_2(r.a.GetResource("DocumentDesigner_Displayboth"),"0")),this.ProductStatus.SelectedValue="0",this.tree=new Array,this.CostCenterFilters=new Array,this.Report=new Array,this.CostCenters=new a.e(0),this.CostCenters.Label=r.a.GetResource("Reports_SelectCostCenter"),this.CostCenters.LblWidth="160",this.CostCenters.SelectionChangedCommand.Subscribe(this,"OnCostCenterChange"),null==this.dsReportDefn)e=r.a.report.DataSet("RPT046",this.ReportID.toString());else{e=r.a.report.DataSet("RPT047",this.ReportID.toString());var i=this.dsReportDefn.Tables[0].Copy();i.TableName="dtDefn",e.Tables.push(i)}this.JOBDimension=s.e.Int(e.Tables[1][0].Value),s.e.IsEmpty(this.Title)&&(this.Title=e.Tables[2][0].ReportName.toString(),this.DisplayName=this.Title);var o=new s.f;o.LoadXml(e.Tables[2][0].ReportDefnXML.toString()),this.xDocPref.LoadXml(e.Tables[2][0].CustomPreferences.toString());var l=y.CostCenterPicker.GetDSBuffer().Tables[4].filter((function(e){return e.FeatureID>5e4||[3,16,40,76,78].Contains(e.FeatureID)})),u={FeatureID:-101,Name:"Product Vendors"};l.push(u),(u={}).FeatureID=-102,u.Name="Kit & Assembled Products",l.push(u),l.SortBy(["Name"]);var d=new n.c,h=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"TreeDimensionsFilter");if(null!=h&&h.childNodes.forEach((function(e){l.filter((function(t){return t.FeatureID==e.attributes.CCID.value})).length>0&&!d.ContainsKey(parseInt(e.attributes.CCID.value))&&d.push(parseInt(e.attributes.CCID.value),null!=e.attributes.Mandatory)})),null!=(h=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"HidePrefetch"))&&"1"==h.innerHTML&&(this.HidePrefetch=!0),null!=(h=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"PrefetchReportList"))){var c=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"ProductsByVoucher");null!=c&&"1"==c.innerHTML&&(this.ProductsByVoucher=!0),null!=(c=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"ProductsByRowSelection"))&&"1"==c.innerHTML&&(this.ProductsByRowSelection=!0),h.childNodes.forEach((function(e){var i=t.CostCenters.Items.find((function(t){return"50"==t.Value&&t.Parent==e.attributes.ID.value}));null!=i?e.attributes.ColID.value.length>0&&(i.Aliasname+="\x11"+e.attributes.ColID.value+"~"+e.attributes.ROColID.value):(i=a.d.ComboBoxItems_3(e.attributes.Name.value,"50",e.attributes.ID.value),e.attributes.ColID.value.length>0&&(i.Aliasname=e.attributes.ColID.value+"~"+e.attributes.ROColID.value),t.CostCenters.Items.push(i))}))}r.a.SessionManager.Preferences.ContainsKey("ReportsFrom")&&(this.IsReportDB="1"==r.a.SessionManager.Preferences.ReportsFrom,null!=(h=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"ReportsFrom"))&&("TrDB"==h.innerHTML?this.IsReportDB=!1:"RptDB"==h.innerHTML&&(this.IsReportDB=!0))),null!=h&&h.childNodes.forEach((function(e){l.filter((function(t){return t.FeatureID==e.attributes.CCID.value})).length>0&&!d.ContainsKey(parseInt(e.attributes.CCID.value))&&d.push(parseInt(e.attributes.CCID.value),null!=e.attributes.Mandatory)})),l.forEach((function(e){var i=parseInt(e.FeatureID);i>5e4?(0==d.length||d.ContainsKey(i))&&(t.CostCenters.Items.push(a.d.ComboBoxItems_2(e.Name.toString(),e.FeatureID.toString())),d.length>0&&d[i]&&(t.CostCenters.Items[t.CostCenters.Items.length-1].Aliasname="1")):t.CostCenters.Items.push(a.d.ComboBoxItems_2(e.Name.toString(),e.FeatureID.toString()))})),this.CostCenters.Visible=!0,this.LoadTreeData(o.SelectSingleNode("PactRevenURpts/Filters/PreDataFetch")),this.Documents.Label="Document",this.Documents.LblWidth="80",this.Documents.Width="280";var D;if(null!=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"DefaultSortColumn")&&(this.DefaultSortColumn=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"DefaultSortColumn").innerHTML),(s.e.IsEmptySpace(this.DefaultSortColumn)||"ProductName"!=this.DefaultSortColumn)&&(this.DefaultSortColumn="ProductCode"),this.ChunkSize=parseInt(s.f.SelectSingleNode(this.xDocPref.DocumentElement,"ChunkSize").innerHTML),D=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"DefaultDocument").innerHTML,this.ExpectedQTY1=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"ExpectedQTY1").innerHTML,this.ExpectedQTY2=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"ExpectedQTY2").innerHTML,this.ExpectedQTY3=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"ExpectedQTY3").innerHTML,this.CommitedQTY1=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"CommitedQTY1").innerHTML,this.CommitedQTY2=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"CommitedQTY2").innerHTML,this.CommitedQTY3=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"CommitedQTY3").innerHTML,this.ProductsBasedOn=null!=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"ProductsBasedOn")?s.f.SelectSingleNode(this.xDocPref.DocumentElement,"ProductsBasedOn").innerHTML.split(","):[],this.DataBasedOn=null!=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"DataBasedOn")?s.f.SelectSingleNode(this.xDocPref.DocumentElement,"DataBasedOn").innerHTML.split(","):[],this.SalesDocs=null!=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"SalesDocs")?s.f.SelectSingleNode(this.xDocPref.DocumentElement,"SalesDocs").innerHTML:"",h=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"HideSalesFilter"),this.SalesFilterVisible=null==h||"1"!=h.innerHTML,h=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"AvgSaleByTrMn"),this.AvgSaleByTrMn=null!=h&&"1"==h.innerHTML,h=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"ShowBOMGrid"),this.BOMGridWithReport=null!=h&&"1"==h.innerHTML,h=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"PODisable"),this.Documents.Enable=null==h||"1"!=h.innerHTML,h=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"POAuto"),this.IsAutoPost=null!=h&&"1"==h.innerHTML,h=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"ReorderBasedOnProductGroup"),this.ReorderBasedOnProductGroup_Report=null!=h&&"1"==h.innerHTML,h=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"ToDateFilter"),this.ToDateFilter.Visible=null!=h&&"1"==h.innerHTML,h=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"PostDocsGroupBy"),this.PostDocsGroupBy=null!=h?h.innerHTML:"",this.ExeQty_DontShowUnApproved=null!=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"ExeQty_DontShowUnApproved"),this.PostedQtyFor=null==s.f.SelectSingleNode(this.xDocPref.DocumentElement,"PostedQtyFor")?"":s.f.SelectSingleNode(this.xDocPref.DocumentElement,"PostedQtyFor").innerHTML,this.SalesSlotType=null==s.f.SelectSingleNode(this.xDocPref.DocumentElement,"ShowSlot")?"":s.f.SelectSingleNode(this.xDocPref.DocumentElement,"ShowSlot").innerHTML,"Yearly"==this.SalesSlotType){var m=new Date(Date.Today().getFullYear(),r.a.SessionManager.AccountingFromMonth-1,1);m>Date.Today()&&(m=m.AddYears(-1));Date.Today();this.Slot1.Text=(Date.Today().Subtract(m).Days+1).toString(),this.Slot1.DependantOn=1==r.a.SessionManager.AccountingFromMonth?m.getFullYear().toString():m.getFullYear().toString()+"-"+((m.getFullYear()+1)%100).toString(),m,m=m.AddYears(-1),this.Slot2.Text=(Date.Today().Subtract(m).Days+1).toString(),this.Slot2.DependantOn=1==r.a.SessionManager.AccountingFromMonth?m.getFullYear().toString():m.getFullYear().toString()+"-"+((m.getFullYear()+1)%100).toString(),m,m=m.AddYears(-1),this.Slot3.Text=(Date.Today().Subtract(m).Days+1).toString(),this.Slot3.DependantOn=1==r.a.SessionManager.AccountingFromMonth?m.getFullYear().toString():m.getFullYear().toString()+"-"+((m.getFullYear()+1)%100).toString(),this.Slot1.Enable=!1,this.Slot2.Enable=!1,this.Slot3.Enable=!1}else if("Monthly"==this.SalesSlotType){var C=new Date(Date.Today().getFullYear(),Date.Today().getMonth(),1);Date.Today();this.Slot1.Text=(Date.Today().Subtract(C).Days+1).toString(),this.Slot1.DependantOn=C.ToString("MMM-yy"),C,C=C.AddMonths(-1),this.Slot2.Text=(Date.Today().Subtract(C).Days+1).toString(),this.Slot2.DependantOn=C.ToString("MMM-yy"),C,C=C.AddMonths(-1),this.Slot3.Text=(Date.Today().Subtract(C).Days+1).toString(),this.Slot3.DependantOn=C.ToString("MMM-yy"),this.Slot1.Enable=!1,this.Slot2.Enable=!1,this.Slot3.Enable=!1}else this.Slot1.Text=null==s.f.SelectSingleNode(this.xDocPref.DocumentElement,"Slot1")?"30":s.f.SelectSingleNode(this.xDocPref.DocumentElement,"Slot1").innerHTML,this.Slot2.Text=null==s.f.SelectSingleNode(this.xDocPref.DocumentElement,"Slot2")?"60":s.f.SelectSingleNode(this.xDocPref.DocumentElement,"Slot2").innerHTML,this.Slot3.Text=null==s.f.SelectSingleNode(this.xDocPref.DocumentElement,"Slot3")?"90":s.f.SelectSingleNode(this.xDocPref.DocumentElement,"Slot3").innerHTML;var f,p=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"DontIncludeExpiredProducts");if(this.DontIncludeExpiredProducts=null!=p&&"1"==p.innerHTML,p=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"DontIncludePreExpiryProducts"),this.DontIncludePreExpiryProducts=null!=p&&"1"==p.innerHTML,this.DontIncludePreExpiryProducts&&(p=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"ExpiryPickFromProduct"),this.ExpiryPickFromProduct=null!=p&&"1"==p.innerHTML,this.ExpiryPickFromProduct||(this.PreExpiryProductDays=s.e.Int(s.f.SelectSingleNodeText(this.xDocPref.DocumentElement,"PreExpiryProductDays")))),null!=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"ExpirySlab1")&&((f=s.e.Int(s.f.SelectSingleNodeText(this.xDocPref.DocumentElement,"ExpirySlab1")))>0&&this.lstBatchExpirySlabs.push(f)),null!=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"ExpirySlab2")&&((f=s.e.Int(s.f.SelectSingleNodeText(this.xDocPref.DocumentElement,"ExpirySlab2")))>0&&(0==this.lstBatchExpirySlabs.length||this.lstBatchExpirySlabs[this.lstBatchExpirySlabs.length-1]<f)&&this.lstBatchExpirySlabs.push(f)),null!=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"ExpirySlab3")&&((f=s.e.Int(s.f.SelectSingleNodeText(this.xDocPref.DocumentElement,"ExpirySlab3")))>0&&(0==this.lstBatchExpirySlabs.length||this.lstBatchExpirySlabs[this.lstBatchExpirySlabs.length-1]<f)&&this.lstBatchExpirySlabs.push(f)),this.ChunkSize<=0&&(this.ChunkSize=25),e.Tables[0].forEach((function(e){t.Documents.Items.push(a.d.ComboBoxItems_2(e.DocumentName.toString(),e.CostCenterID.toString())),e.CostCenterID.toString()==D&&(t.Documents.SelectedValue=D,t.Documents.SelectedItem=t.Documents.Items[t.Documents.Items.length-1])})),this.drReport=e.Tables[2][0],this.InitReOrderGrid(o),null!=e.Tables[2][0].KPIXML&&e.Tables[2][0].KPIXML.toString().length>0&&this.ReOrderGrid.InitKPI(e.Tables[2][0].KPIXML.toString()),s.e.IsEmpty(this.Documents.SelectedValue)&&(this.Documents.SelectedValue=this.Documents.Items[0].Value,this.Documents.SelectedItem=this.Documents.Items[0]),!s.e.IsEmpty(e.Tables[2][0].RowColumnReportsMap)){var S=new s.f;S.LoadXml(e.Tables[2][0].RowColumnReportsMap.toString()),this.ReOrderGrid.ContextMenu=new n.a,s.f.SelectNodes(S.DocumentElement,"RowReport").forEach((function(e){t.ReOrderGrid.ContextMenu.push(s.f.SelectSingleNodeText(e,"Name"),e)})),0==this.ReOrderGrid.ContextMenu.length&&(this.ReOrderGrid.ContextMenu=null),this.ReOrderGrid.ContextMenuClick.subscribe((function(){t.OnContextMenuClick(null)}))}this.ProductsByBOM=new P.b,this.ProductsByBOM.Label="Show Products By",this.ProductsByBOM.Items.push(new P.a),this.ProductsByBOM.Items[0].IsChecked=!0,this.ProductsByBOM.Items.push(new P.a),this.ProductsByBOM.Items.push(new P.a),this.ProductsByBOM.Items[0].Label="Bom",this.ProductsByBOM.Items[1].Label="Raw Material",this.ProductsByBOM.Items[2].Label="Finished Product"}},{key:"InitReOrderGrid",value:function(e){var t,i=this,o=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"ShowVendor");this.Vendor=new d.b(0),this.Vendor.Label=r.a.GetResource("Inv_Vendor"),null!=o&&"HeaderWise"==o.innerHTML?(this.Vendor.CCID=2,this.Vendor.TypeID=2,this.Vendor.Visible=!0):this.Vendor.Visible=!1,this.BOMGrid=new C.a,this.BOMGrid.Visible=!1,this.BOMGrid.Width="",this.BOMGrid.Height=130,this.BOMGrid.Table=[],this.BOMGrid.TableColumns.push("BOMID"),this.BOMGrid.TableColumns.push("BOM"),this.BOMGrid.TableColumns.push("Qty"),this.BOMGrid.TableColumns.push("UnitType"),this.BOMGrid.TableColumns.push("UOM"),this.BOMGrid.TableColumns.push("UOM_Key"),this.BOMGrid.Columns=new Array,(t=new D.a).Header="BOM",t.DisplayMember="BOM",t.Width=120,t.ReadOnly=!0,this.BOMGrid.Columns.push(t),(t=new D.a).Header="Qty",t.DisplayMember="Qty",t.DataType="FLOAT",t.Width=50,t.IsCalculated=1,t.DisableTab=!0,t.DecimalPoints=r.a.SessionManager.Preferences.DecimalsinQty,this.BOMGrid.Columns.push(t),(t=new D.a).Header="Type",t.ValueBinding="UnitType",t.Width=55,t.IsCalculated=1,t.DisableTab=!0,t.DataType="ComboBox",t.DisplayMember="Name",t.ValueMember="Value";var n=new Array;n.push(a.d.ComboBoxItems_2("BOM","1")),n.push(a.d.ComboBoxItems_2("Qty","2")),t.ComboData=n,this.BOMGrid.Columns.push(t),(t=new D.a).Header=r.a.GetResource("UOM"),t.CostCenterID=11,t.TypeID=1,t.DataType="LISTBOX",t.DisplayMember="UOM",t.ValueMember="UOM_Key",t.Width=90,this.BOMGrid.Columns.push(t),this.BOMGrid.OnBeginEdit.Subscribe(this,"BOMGridBeginEdit"),this.KitGrid=new C.a,this.KitGrid.Width="",this.KitGrid.Height=120,this.KitGrid.Visible=!1,this.MOGrid=new C.a,this.MOGrid.Width="",this.MOGrid.Height=120,this.MOGrid.Visible=!1,this.ReOrderGrid=new C.a,this.ReOrderGrid.Width="",this.ReOrderGrid.Height=0,this.ReOrderGrid.HeaderHeight=40,this.ReOrderGrid.CalcTotalsOnDataView=!0,this.ReOrderGrid.Table=[],this.ReOrderGrid.TableColumns.push("Sno"),this.ReOrderGrid.TableColumns.push("ProductCode"),this.ReOrderGrid.TableColumns.push("ProductName"),this.ReOrderGrid.TableColumns.push("ProductName_Key"),this.ReOrderGrid.TableColumns.push("QOH"),this.ReOrderGrid.TableColumns.push("Variance"),this.ReOrderGrid.TableColumns.push("Variance_RED"),this.ReOrderGrid.TableColumns.push("OrderQty"),this.ReOrderGrid.TableColumns.push("UOM"),this.ReOrderGrid.TableColumns.push("UOM_Key"),this.ReOrderGrid.TableColumns.push("Vendor"),this.ReOrderGrid.TableColumns.push("Vendor_Key");var l=new Array,u=e.SelectNodes("PactRevenURpts/PactRevenURptDef/Columns/ColumnDef"),h=new Array;e.SelectNodes("PactRevenURpts/PactRevenURptDef/ReportTotal/Columns/Column").forEach((function(e){h.push(e.innerHTML)}));var c=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"ReorderDimension");this.ReorderDimension=null!=c?parseInt(c.innerHTML):50002;var f=r.a.report.GetLocations(this.ReorderDimension),p=f,I=0;new Array,this.totalALL.Clear(),this.totalSELECTED.Clear(),this.LocationCols.Clear();var y=1,T=e.SelectSingleNode("PactRevenURpts/PactRevenURptDef/FrozeColumns");null!=T&&(y=parseInt(T.innerHTML)),(t=new D.a).Header=r.a.GetResource("AssetManagement_SNo"),t.DisplayMember="Sno",t.Width=40,t.ReadOnly=!0,t.IsFrozen=!0,l.push(t);for(var P=["SalesQty","SalesValue","SalesCost","SalesProfit","Class"],O="",R=0;R<u.length;R++){var g=u[R];if((t=new D.a).ReadOnly=!0,t.DisableTab=!0,t.IsCalculated=1,t.Header=this.GetNodeValue(g,"Identity/Caption"),t.DisplayMember=this.GetNodeValue(g,"Identity/ID"),t.ID=t.DisplayMember,t.DataType=this.GetNodeValue(g,"Identity/Type").toUpperCase(),"ProductGroup"==t.DisplayMember&&(t.DataType=""),h.Contains(t.DisplayMember)&&(t.ShowTotal=!0),"ProductCode"!=t.ID&&"ProductName"!=t.ID||"3"!=this.GetNodeValue(g,"Linking/Type")||(t.DataType="LINK"),this.GetNodeValue(g,"HeaderAppearance/BackGrndColor").length>0&&(t.HeaderBackColor=this.GetNodeValue(g,"HeaderAppearance/BackGrndColor")),this.GetNodeValue(g,"HeaderAppearance/ForeGrndColor").length>0&&(t.HeaderForegroundColor=this.GetNodeValue(g,"HeaderAppearance/ForeGrndColor")),33==t.DisplayMember.length){t.Formula=this.GetNodeValue(g,"Identity/Expression"),0!=s.e.stringCompare(t.Formula,"LATEST",!0)&&0!=s.e.stringCompare(t.Formula,"OLDEST",!0)||(t.Formula="");var E=this.GetNodeValue(g,"Identity/SysColumn");s.e.IsEmpty(E)||(E.startsWith("dcCalcNum")?E=E.Replace("dcCalcNum","dcCalcdcNum"):E.startsWith("dcCCNID")&&this.ReOrderGrid.TableColumns.push(t.DisplayMember+"_ID"),t.SectionName=E,this.DocumentMappingColumns.push(t))}else"SalesCost"==t.DisplayMember?this.SalesCostColumn=this.GetNodeValue(g,"Identity/SysColumn"):"SalesValue"==t.DisplayMember&&(this.SalesValueColumn=this.GetNodeValue(g,"Identity/SysColumn"));if(t.Expression=this.GetNodeValue(g,"Format/ColumnFilterExpression"),l.length==y&&(t.IsFrozen=!0),"FLOAT"==t.DataType)if(s.e.IsNum(this.GetNodeValue(g,"Format/Decimals"))){var M=s.e.Int(this.GetNodeValue(g,"Format/Decimals"));t.DecimalPoints=-1==M?parseInt(r.a.SessionManager.Preferences.DecimalsinAmount).toString():M.toString()}else t.DecimalPoints=r.a.SessionManager.Preferences.DecimalsinQty;"AvgSale"==t.DisplayMember?this.colAvgSales=t:"ReOrderQty"==t.DisplayMember?this.colReOrderQty=t:"Vendor"==t.DisplayMember?(this.colVendor=t,t.ReadOnly=null!=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"DisableVendor"),this.Vendor.Visible?t.IsVisible=!1:(t.CostCenterID=2,t.TypeID=100,t.DataType="LISTBOX",t.DisplayMember="Vendor",t.ValueMember="Vendor_Key")):"UOM"==t.DisplayMember?(this.colUOM=t,t.ReadOnly=!1,t.CostCenterID=11,t.TypeID=1,t.DataType="LISTBOX",t.DisplayMember="UOM",t.ValueMember="UOM_Key"):"OrderQty"==t.DisplayMember?(this.colOrderQty=t,t.ReadOnly=!1,t.Formula=this.GetNodeValue(g,"Identity/Expression")):("Variance"==t.DisplayMember||"OrderValue"==t.DisplayMember)&&(t.Formula=this.GetNodeValue(g,"Identity/Expression")),this.ReOrderGrid.TableColumns.Contains(t.DisplayMember)||this.ReOrderGrid.TableColumns.push(t.DisplayMember),"0"==this.GetNodeValue(g,"HeaderAppearance/Visibility")&&(t.IsVisible=!1),t.Width=""!=this.GetNodeValue(g,"Width")?parseInt(this.GetNodeValue(g," Width")):90;var N=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"Locations/"+t.DisplayMember);if(null!=N&&""!=N.innerHTML&&"-1"!=N.innerHTML){if(!P.Contains(t.DisplayMember))if("continue"===function(){for(var e=N.innerHTML.split(","),o=function(o){var r=t.Clone();-1==(I=parseInt(e[o]))?(r.Header=r.Header+" ALL LOCATIONS",i.totalALL.push(t.DisplayMember,0),r.DisplayMember=t.DisplayMember+"_ALL"):-2==I?(r.Header=r.Header+" TOTAL",i.totalSELECTED.push(t.DisplayMember,0),r.DisplayMember=t.DisplayMember+"_SELECTED"):(p=f.filter((function(t){return t.NodeID==e[o]})),r.Header=p.length>0?r.Header+" "+p[0].Name.toString():r.Header+" "+e[o],i.LocationCols.ContainsKey(e[o])||i.LocationCols.push(e[o],new Array),i.LocationCols[e[o]].push(t.DisplayMember),r.DisplayMember=t.DisplayMember+"_"+e[o]),i.ReOrderGrid.TableColumns.Contains(r.DisplayMember)||i.ReOrderGrid.TableColumns.push(r.DisplayMember),l.push(r)},r=0;r<e.length;r++)o(r);return"continue"}())continue;0==O.length&&(O=N.innerHTML)}l.push(t)}for(var v=-1,V=0;V<l.length;V++)P.Contains(l[V].DisplayMember)&&(-1==v&&(v=V),l[V].IsVisible||(l[V].Dependantinuse=!0),this.lstSaleSlots.push(l[V].DisplayMember,l[V]),l.RemoveAt(V),V--);if(this.lstSaleSlots.length>0)if(0==O.length)if("Yearly"==this.SalesSlotType||"Monthly"==this.SalesSlotType)for(var G=function(e){i.lstSaleSlots.keys.forEach((function(o){(t=i.lstSaleSlots[o].Clone()).BarcodeDef=t.Header,t.Header=t.Header+" "+e.toString(),t.DisplayMember=t.DisplayMember+e.toString(),l.Insert(v,t),i.ReOrderGrid.TableColumns.Contains(t.DisplayMember)||i.ReOrderGrid.TableColumns.push(t.DisplayMember),v++}))},B=3;B>=1;B--)G(B);else for(var F=function(e){i.lstSaleSlots.keys.forEach((function(o){(t=i.lstSaleSlots[o].Clone()).BarcodeDef=t.Header,t.Header=t.Header+" "+e.toString(),t.DisplayMember=t.DisplayMember+e.toString(),l.Insert(v,t),i.ReOrderGrid.TableColumns.Contains(t.DisplayMember)||i.ReOrderGrid.TableColumns.push(t.DisplayMember),v++}))},L=1;L<=3;L++)F(L);else for(var w=O.split(","),x=function(e){var o=void 0,r=w[e];for(o="Yearly"==i.SalesSlotType||"Monthly"==i.SalesSlotType?3:1;;)if(I=parseInt(r),i.lstSaleSlots.keys.forEach((function(e){(t=i.lstSaleSlots[e].Clone()).BarcodeDef=t.Header,t.DisplayMember=t.DisplayMember+o.toString(),-1==I?(t.Header=t.Header+" ALL LOCATIONS",t.BarcodeProp=" ALL LOCATIONS",i.totalALL.push(t.DisplayMember,0),t.Header=t.Header+"  ALL LOCATIONS",t.DisplayMember=t.DisplayMember+"_ALL"):-2==I?(t.Header=t.Header+" TOTAL",t.BarcodeProp=" TOTAL",i.totalSELECTED.push(t.DisplayMember,0),t.DisplayMember=t.DisplayMember+"_SELECTED"):((p=f.filter((function(e){return e.NodeID==r}))).length>0?(t.Header=t.Header+" "+p[0].Name.toString(),t.BarcodeProp=" "+p[0].Name.toString()):(t.Header=t.Header+" "+r,t.BarcodeProp=" "+r),i.LocationCols.ContainsKey(r)||i.LocationCols.push(r,new Array),i.LocationCols[r].push(t.DisplayMember),t.DisplayMember=t.DisplayMember+"_"+r),l.Insert(v,t),i.ReOrderGrid.TableColumns.Contains(t.DisplayMember)||i.ReOrderGrid.TableColumns.push(t.DisplayMember),v++})),"Yearly"==i.SalesSlotType||"Monthly"==i.SalesSlotType){if(0==--o)break}else if(++o>3)break},A=0;A<w.length;A++)x(A);this.DWPCProfile=l.find((function(e){return"DWPCProfile"==e.DisplayMember&&e.IsVisible})),null!=this.DWPCProfile&&(this.DWPCProfile.ShowTotal=!1,l.Remove(this.DWPCProfile));var k=l.find((function(e){return"BatchPreExpiry"==e.DisplayMember&&e.IsVisible}));if(null!=k&&k.IsVisible&&this.lstBatchExpirySlabs.length>0){for(var _=0;_<this.lstBatchExpirySlabs.length;_++)this.BatchPreExpiry+=" S"+_+'="'+this.lstBatchExpirySlabs[_]+'"';this.BatchPreExpiry.length>0&&(this.BatchPreExpiry="<Exp"+this.BatchPreExpiry+"/>");var H=l.indexOf(k);l.Remove(k);for(var K=0;K<this.lstBatchExpirySlabs.length;K++)(t=k.Clone()).Header=t.Header+" [",t.Header+=0==K?"1":(this.lstBatchExpirySlabs[K-1]+1).toString(),t.Header+="-"+this.lstBatchExpirySlabs[K].toString()+"]",t.DisplayMember="BEx"+K.toString(),l.Insert(H+K,t),this.ReOrderGrid.TableColumns.Contains(t.DisplayMember)||this.ReOrderGrid.TableColumns.push(t.DisplayMember)}this.SelectedAvgLocations="",this.SelectedReOrderLocations="",this.LocationCols.keys.forEach((function(e){var t={Key:e,Value:i.LocationCols[e]};t.Value.Contains("AvgRate")&&(i.SelectedAvgLocations.length>0&&(i.SelectedAvgLocations+=","),i.SelectedAvgLocations+=t.Key),(t.Value.Contains("ReOrderLevel")||t.Value.Contains("ReOrderQty")||t.Value.Contains("SellingPrice"))&&(i.SelectedReOrderLocations.length>0&&(i.SelectedReOrderLocations+=","),i.SelectedReOrderLocations+=t.Key)})),["BalanceQty","ReOrderLevel","ExpQty1","ExpQty2","ExpQty3","ComQty1","ComQty2","ComQty3","CY1","CY2","CY3","CYAvgSale","FC1","FC2","FC3","FCPYAvgSale","OrderQty"].forEach((function(e){i.totalSELECTED.ContainsKey(e)||(i.totalSELECTED.push(e,0),i.ReOrderGrid.TableColumns.push(e+"_SELECTED"))})),this.SelectedLocations="",this.LocationCols.keys.forEach((function(e){i.SelectedLocations.length>0&&(i.SelectedLocations+=","),i.SelectedLocations+=e})),null==this.colOrderQty&&((t=new D.a).Header=r.a.GetResource("Inv_OrderQty"),t.DisplayMember="OrderQty",t.DataType="FLOAT",t.Width=80,t.IsCalculated=1,t.DisableTab=!0,t.DecimalPoints=r.a.SessionManager.Preferences.DecimalsinQty,l.push(t)),null==this.colUOM&&((t=new D.a).Header=r.a.GetResource("UOM"),t.CostCenterID=11,t.TypeID=1,t.DataType="LISTBOX",t.DisplayMember="UOM",t.ValueMember="UOM_Key",t.Width=80,l.push(t)),this.Vendor.Visible||null!=this.colVendor||((t=new D.a).Header=r.a.GetResource("Inv_Vendor"),t.CostCenterID=2,t.TypeID=100,t.DataType="LISTBOX",t.DisplayMember="Vendor",t.ValueMember="Vendor_Key",t.Width=120,l.push(t));var W=e.SelectSingleNode("PactRevenURpts/PactRevenURptDef/Query/Select");this.SelectTag=null!=W?s.e.DecodeXML(W.innerHTML):"",W=e.SelectSingleNode("PactRevenURpts/PactRevenURptDef/Query/From"),this.FromTag=null!=W?W.innerHTML:"",l.forEach((function(e){if(!s.e.IsEmptySpace(e.Formula)){var t=e.Formula,i=new S.a;i.SetKeyWords("REPORT");var o=[];i.ParseFormula(t,o);for(var r,n="",a=null,u=o.length-1;u>=0;u--){var d=o[u];r=d.getTokenValue().toString(),d.getTokenClass()!=S.d.OPERAND||null==a||a.getTokenClass()!=S.d.OPERAND?a=d:(a.tokenValue=d.tokenValue.toString()+a.tokenValue.toString(),o.RemoveAt(u))}o.forEach((function(e){var t=e;if(r=t.getTokenValue().toString(),t.getTokenClass()==S.d.OPERAND)for(var i=0;i<l.length;i++){var o=l[i];if(0==s.e.stringCompare(o.Header.Replace(" ",""),r,!0)){r=o.DisplayMember;break}}"STRING"==t.getTokenName()?n+='"'+r+'"':(t.getTokenType()==S.e.KEYWORD&&(n+=" "),n+=r,t.getTokenType()==S.e.KEYWORD&&(n+=" "))})),e.Formula=n}})),this.ReOrderGrid.CanUserSortColumns=!0,this.ReOrderGrid.Columns=l,this.ReOrderGrid.ConstructFormulaFields(!1),this.ReOrderGrid.IgnoreFormulaKeywords=new Array,this.ReOrderGrid.IgnoreFormulaKeywords.push("FROMDATE"),this.ReOrderGrid.IgnoreFormulaKeywords.push("TODATE"),this.ReOrderGrid.IgnoreFormulaKeywords.push("SYSTEMDATE"),this.ReOrderGrid.IgnoreFormulaKeywords.push("CURRENT_YEARSTART"),this.ReOrderGrid.fldDict.ContainsKey("FROMDATE")||this.ReOrderGrid.fldDict.push("FROMDATE",new S.c("FROMDATE","")),this.ReOrderGrid.fldDict.ContainsKey("TODATE")||this.ReOrderGrid.fldDict.push("TODATE",new S.c("TODATE","")),this.ReOrderGrid.fldDict.ContainsKey("SYSTEMDATE")||this.ReOrderGrid.fldDict.push("SYSTEMDATE",new S.c("SYSTEMDATE","")),this.ReOrderGrid.fldDict.ContainsKey("CURRENT_YEARSTART")||this.ReOrderGrid.fldDict.push("CURRENT_YEARSTART",new S.c("CURRENT_YEARSTART","")),this.ReOrderGrid.fldDict.SYSTEMDATE.setFieldValue(Date.Today()),this.ReOrderGrid.fldDict.CURRENT_YEARSTART.setFieldValue(new Date(Date.Today().getFullYear(),0,1)),this.ReOrderGrid.OnLinkClick.Subscribe(this,"OnLinkClick"),this.ReOrderGrid.OnBeginEdit.Subscribe(this,"OnGridBeginEdit"),["BalanceQty","ReOrderLevel","ReOrderQty","SellingPrice","LastPrice","ExpQty1","ExpQty2","ExpQty3","ComQty1","ComQty2","ComQty3","CY1","CY2","CY3","CYAvgSale","FC1","FC2","FC3","FCPYAvgSale","AvgRate","SalesQty","SalesValue","SalesCost","SalesProfit"].forEach((function(e){if(0==l.filter((function(t){return t.DisplayMember.startsWith(e)&&t.IsVisible})).length&&0==l.filter((function(t){return!s.e.IsEmpty(t.Formula)&&t.Formula.Contains(e)})).length){for(var t=l.length-1;t>=0;t--)l[t].DisplayMember.startsWith(e)&&(i.ReOrderGrid.TableColumns.Contains(l[t].DisplayMember)&&i.ReOrderGrid.TableColumns.Remove(l[t].DisplayMember),l.RemoveAt(t));i.totalSELECTED.ContainsKey(e)&&i.totalSELECTED.Remove(e),i.totalALL.ContainsKey(e)&&i.totalALL.Remove(e),i.LocationCols.values.forEach((function(t){t.Contains(e)&&t.Remove(e)})),i.strHiddenFields+=e+","}})),this.strHiddenFields=this.strHiddenFields.TrimEnd(","),this.AvgSaleByTrMn&&(this.strHiddenFields+=",AvgSaleByTrMn"),this.ColumnsSource=this.ReOrderGrid.Columns,this.PostDataFetchFilterFields=new Array,this.ReOrderGrid.Columns.forEach((function(e){if(e.IsVisible&&e.ReadOnly){var t=new b.b;t.ID=e.DisplayMember,t.ColumnType=e.DataType,t.HeaderText=e.Header;var o=new m.a;o.PostDataField_1(t,i),i.PostDataFetchFilterFields.push(o)}}))}},{key:"GetNodeValue",value:function(e,t){var i="";return e&&(i=s.f.SelectSingleNodeText(e,t)),i}},{key:"BOMGridBeginEdit",value:function(e){return"DataGridPactListBoxColumn"==e.args.column.className&&"1"==e.args.item.UnitType.toString()}},{key:"LoadReOrderGrid",value:function(e){var t=this,i=!1;this.ReportData=this.ReOrderGrid.Table,this.RecordCount="",this.ProductsIDs.Clear();var o=0;this.VendorWHERE="";var l=this.GetDimensionFilter("CCMAP.CCNID",this.ProductsBasedOn,!0),a=this.GetFilterNodes(16);this.BomWHERE=this.GetFilterNodes(76),this.MOWHERE=this.GetFilterNodes(78),this.JobWHERE=this.JOBDimension>0?this.GetFilterNodes(this.JOBDimension):"",this.KitWHERE=this.GetFilterNodes(-102),this.BOMSelect="";var u="",d="",h="",c="";this.ProductsByVoucher_Temp=!1,this.ShowBOMProducts=E.None;var D=this.CostCenterFilters.find((function(e){return 3==e.CostCenterID}));if(null!=D&&null!=D.SelectedNodes&&D.SelectedNodes.length>0){var m=D.GetSeqNosListWithRoots();D.IsOneSelected||(D.IsGroupExists?(c=" AND P.ProductID=GTP.GTID",h=m.Contains(",")?",(select T.ProductID GTID from INV_Product T with(nolock),INV_Product GT1 with(nolock) where T.lft BETWEEN GT1.lft AND GT1.rgt AND GT1.ProductID IN ("+m+") group by T.ProductID) AS GTP ":",(select T.ProductID GTID from INV_Product T with(nolock),INV_Product GT1 with(nolock) where T.lft BETWEEN GT1.lft AND GT1.rgt AND GT1.ProductID="+m+" group by T.ProductID) AS GTP "):c=m.Contains(",")?" AND P.ProductID IN ("+m+")":" AND P.ProductID="+m)}this.dsProduct=null;var C=this.CostCenterFilters.find((function(e){return-101==e.CostCenterID})),f=this.CostCenterFilters.filter((function(e){return 50==e.CostCenterID&&null!=e.SelectedNodes&&e.SelectedNodes.length>0}));if(this.ReportSelectedNodes=new Array,f.forEach((function(e){t.ReportSelectedNodes.AddRange(e.SelectedNodes.filter((function(e){return 0==e.IsGroup})))})),null!=C&&C.SelectedNodes.length>0){for(var p=0;p<C.SelectedNodes.length;p++)p>0&&(this.VendorWHERE+=","),this.VendorWHERE+=C.SelectedNodes[p].Id;this.Vendor.Visible&&(this.Vendor.SelectedValue=C.SelectedNodes[0].Id)}var S=this.Report.length>0&&this.Report[0].Preferences.ContainsKey("UseBomInReorder");if(this.dicFPQty=new n.c,S&&0==this.BomWHERE.length&&this.ReportSelectedNodes.length>0){this.BomWHERE="",this.ShowBOMProducts=this.ProductsByBOM.Items[1].IsChecked?E.RawMaterial:this.ProductsByBOM.Items[2].IsChecked?E.FinishedProduct:E.BOM;var I=-1,y=this.Report[0].Preferences.ContainsKey("ReorderQtyColumn")?this.Report[0].Preferences.ReorderQtyColumn:"";if(this.Report.length>0){var T=this.Report[0].ReportColumns.find((function(e){return e.ID==y}));null!=T&&(I=this.Report[0].ReportColumns.indexOf(T))}if(this.ReportSelectedNodes.forEach((function(e){t.dicFPQty.ContainsKey(e.Id)?-1!=I&&(o=0,(o=s.e.Double(e.Tag.Cells[I].Value))>0&&(t.dicFPQty[e.Id]+=o)):(t.BomWHERE.length>0&&(t.BomWHERE+=","),t.BomWHERE+=e.Id,o=0,-1!=I&&(o=s.e.Double(e.Tag.Cells[I].Value)),o<=0&&(o=1),t.dicFPQty.push(e.Id,o))})),this.ShowBOMProducts==E.FinishedProduct)S=!1,this.ProductsByVoucher=!1,this.BomWHERE="";else{var P=r.a.report.GetDataTable("RPT048",this.BomWHERE);this.BomWHERE="",P.forEach((function(e){t.BomWHERE.length>0&&(t.BomWHERE+=","),t.BomWHERE+=e.BOMID.toString()}));var b=[];P.forEach((function(e){var i={};i.BOMID=e.BOMID,i.BOM=e.BOMCode.toString(),i.Qty=t.dicFPQty[parseInt(e.ProductID)],i.UOM=e.UOMID.toString(),i.UOM_key=e.UOMID.toString(),i.UnitType="2",b.push(i)})),this.BOMGrid.Table=b}}if(!S&&this.ReportSelectedNodes.length>0){this.ProductsByVoucher&&(this.ProductsByVoucher_Temp=!0),this.dsProduct={Tables:[],Columns:[]};var O=[];this.dsProduct.Columns[0]=[],this.dsProduct.Columns[0].push("ProductID"),this.dsProduct.Columns[0].push("VoucherNo"),this.dsProduct.Columns[0].push("ReorderDetailsID"),this.ReportSelectedNodes.forEach((function(e){if(t.ProductsByVoucher||!t.ProductsIDs.Contains(e.Id)){var i={};O.push(i),i.ProductID=e.Id,e.Text.length>1&&(i.VoucherNo=e.Text[1],i.ReorderDetailsID=parseInt(e.Text[2])),t.ProductsIDs.push(e.Id)}})),this.dsProduct.Tables.push(O)}else if(c.length>0||l.length>0||this.VendorWHERE.length>0||this.BomWHERE.length>0||this.MOWHERE.length>0||a.length>0||this.KitWHERE.length>0||null!=D&&D.IsOneSelected)if(this.ReorderBasedOnProductGroup_Report&&0==this.BOMSelect.length&&0==u.length&&0==d.length&&0=="".length&&0==this.VendorWHERE.length&&(i=!0),this.VendorWHERE.length>0)r.a.report.ReportDataTable("RPT049",this.IsReportDB,h,this.VendorWHERE,c).forEach((function(e){t.ProductsIDs.push(parseInt(e[0]))}));else{var R="",g="";l.Contains("CCMAP.CCNID")&&(R+=" INNER JOIN COM_CCCCData CCMAP with(nolock) ON CostCenterID=3 AND CCMAP.NodeID=P.ProductID ",g+=l),this.BomWHERE.length>0?(this.ShowBOMProducts=this.ProductsByBOM.Items[1].IsChecked?E.RawMaterial:this.ProductsByBOM.Items[2].IsChecked?E.FinishedProduct:E.BOM,R+=" INNER JOIN PRD_BOMProducts BP with(nolock) ON BP.ProductID=P.ProductID AND BP.ProductUse=1",this.BomWHERE.Contains(",")?g+=" AND BP.BOMID IN ("+this.BomWHERE+")":g+=" AND BP.BOMID="+this.BomWHERE,R+=" LEFT JOIN COM_UOM PU with(nolock) ON PU.UOMID=P.UOMID LEFT JOIN COM_UOM U with(nolock) ON U.UOMID=BP.UOMID",this.BOMSelect=",BP.BOMID,BP.Quantity*isnull(U.Conversion,1)/isnull(PU.Conversion,1) ConvertedQty"):this.MOWHERE.length>0?(R+=" INNER JOIN PRD_BOMProducts BP with(nolock) ON BP.ProductID=P.ProductID AND BP.ProductUse=1",R+=" INNER JOIN PRD_MFGOrderBOMs MB with(nolock) ON MB.BOMID=BP.BOMID",this.MOWHERE.Contains(",")?g+=" AND MB.MFGOrderID IN ("+this.MOWHERE+")":g+=" AND MB.MFGOrderID="+this.MOWHERE,R+=" LEFT JOIN COM_UOM PU with(nolock) ON PU.UOMID=P.UOMID LEFT JOIN COM_UOM U with(nolock) ON U.UOMID=BP.UOMID",u=",MB.MFGOrderID MOID,MB.Quantity*BP.Quantity*isnull(U.Conversion,1)/isnull(PU.Conversion,1) ConvertedQty"):this.KitWHERE.length>0&&(this.IsKitProjection?(this.ShowBOMProducts=E.None,this.dicKitProjection.Clear(),this.KitWHERE.Contains(",")?g+=" AND P.ProductID IN ("+this.KitWHERE+")":g+=" AND P.ProductID="+this.KitWHERE):(this.ShowBOMProducts=E.BOM,R+=" INNER JOIN INV_ProductBundles KP with(nolock) ON KP.ProductID=P.ProductID",this.KitWHERE.Contains(",")?g+=" AND KP.ParentProductID IN ("+this.KitWHERE+")":g+=" AND KP.ParentProductID="+this.KitWHERE,d=",KP.ParentProductID,KP.Quantity KitQty")),a.length>0&&(R+=" INNER JOIN INV_Batches B with(nolock) ON B.ProductID=P.ProductID",a.Contains(",")?g+=" AND B.BatchID IN ("+a+")":g+=" AND B.BatchID="+a),c.length>0&&(R+=h),R+=" WHERE P.IsGroup=0",R+=g,c.length>0&&(R+=c),"0"!=this.ProductStatus.SelectedValue&&(R+=" AND P.StatusID="+this.ProductStatus.SelectedValue),R=(R+=this.ShowBOMProducts==E.BOM?this.BomWHERE.length>0?" ORDER BY BP.BOMID,P.ProductCode":this.KitWHERE.length>0?this.IsKitProjection?" ORDER BY P."+this.DefaultSortColumn:" ORDER BY KP.ParentProductID,P."+this.DefaultSortColumn:" ORDER BY P."+this.DefaultSortColumn:i?" ORDER BY Ord":" ORDER BY P."+this.DefaultSortColumn).Insert(0,i?"SELECT G.ProductID,G."+this.DefaultSortColumn+" Ord"+this.BOMSelect+u+d+" FROM INV_Product P with(nolock) join INV_Product G with(nolock) on P.ParentID=G.ProductID":"SELECT P.ProductID"+this.BOMSelect+u+d+" FROM INV_Product P with(nolock)"),this.BomWHERE.length>0?(R+=" SELECT BOMID,UOMID,FPQty,BOMName FROM PRD_BillOfMaterial BOM with(nolock) ",this.BomWHERE.Contains(",")?R+=" WHERE BOM.BOMID IN ("+this.BomWHERE+")":R+=" WHERE BOM.BOMID="+this.BomWHERE,R+=" select UOMID,UnitName,Conversion from COM_UOM with(nolock) order by BaseID,Conversion desc"):this.MOWHERE.length>0||this.KitWHERE.length>0&&(this.IsKitProjection?(R+=" SELECT KP.ParentProductID,KP.ProductID,KP.Quantity KitQty FROM INV_ProductBundles KP with(nolock)",this.KitWHERE.Contains(",")?R+=" WHERE KP.ParentProductID IN ("+this.KitWHERE+")":R+=" WHERE KP.ParentProductID="+this.KitWHERE):(R+=" SELECT KP.ParentProductID,KP.ProductID,KP.Quantity,P.ProductName KitName FROM INV_ProductBundles KP with(nolock) \n                    inner join INV_Product P with(nolock) on KP.ParentProductID=P.ProductID",this.KitWHERE.Contains(",")?R+=" WHERE KP.ParentProductID IN ("+this.KitWHERE+")":R+=" WHERE KP.ParentProductID="+this.KitWHERE));var M=0;this.dsProduct=r.a.report.DataSet("RPT022",R.toString()),this.dsProduct.Tables[0].forEach((function(e){M=parseInt(e[t.dsProduct.Columns[0][0]]),t.ShowBOMProducts!=E.BOM&&t.ProductsIDs.Contains(M)||t.ProductsIDs.push(M)}))}if(0!=this.ProductsIDs.length){if(this.dsClass=null,this.lstSaleSlots.length>0&&this.lstSaleSlots.ContainsKey("Class")&&(c.length>0||l.length>0)){var N="",v="";l.Contains("CCMAP.CCNID")&&(N+=" INNER JOIN COM_CCCCData CCMAP with(nolock) ON CostCenterID=3 AND CCMAP.NodeID=P.ProductID ",v+=l);var V=[];V.push(N),V.push(v),V.push(this.SalesDocs),V.push(parseInt(this.Slot1.Text)),V.push(parseInt(this.Slot2.Text)-parseInt(this.Slot1.Text)),V.push(parseInt(this.Slot3.Text)-parseInt(this.Slot2.Text)),V.push(r.a.SessionManager.UserID),V.push(r.a.SessionManager.LanguageID),this.dsClass=r.a.inventory.GetReOrderABC(V)}var G,B=this.GetDimensionFilter("DCC.dcCCNID",this.DataBasedOn,!0);(G=this.SelectTag.Replace("@CCWHERE@",B.length>0?" INNER JOIN COM_DocCCData DCC with(nolock) ON A.InvDocDetailsID=DCC.InvDocDetailsID "+B:"")).Contains("EF_FROMDATE")&&(G=G.Replace("EF_FROMDATE",this.FromDate.Date.ToString("dd MMM yyyy"))),G.Contains("EF_TODATE")&&(G=G.Replace("EF_TODATE",this.ToDate.Date.ToString("dd MMM yyyy"))),G.Contains("EF_ASONDATE")&&(G=G.Replace("EF_ASONDATE",this.ToDateFilter.Date.ToString("dd MMM yyyy")));var F=0;if(this.DataBasedOn.Contains("50002")){var L=this.CostCenterFilters.find((function(e){return 50002==e.CostCenterID}));L&&L.SelectedNodes.length>0&&(F=L.SelectedNodes[0].Id)}var w="";this.DontIncludePreExpiryProducts?w=this.ExpiryPickFromProduct?" and (B.ExpiryDate is null or B.ExpiryDate>=TP.PreexpiryDays)":" and (B.ExpiryDate is null or B.ExpiryDate>=convert(float,convert(datetime,'"+Date.Today().AddDays(this.PreExpiryProductDays).ToString("dd MMM yyyy")+"')))":this.DontIncludeExpiredProducts&&(w=" and (B.ExpiryDate is null or B.ExpiryDate>=convert(float,convert(datetime,'"+Date.Today().ToString("dd MMM yyyy")+"')))"),this.ObjArray=[],this.ObjArray.push(""),this.ObjArray.push(this.ToDateFilter.Visible?this.ToDateFilter.Date:null),this.ObjArray.push(i),this.ObjArray.push(this.ExpectedQTY1),this.ObjArray.push(this.ExpectedQTY2),this.ObjArray.push(this.ExpectedQTY3),this.ObjArray.push(this.CommitedQTY1),this.ObjArray.push(this.CommitedQTY2),this.ObjArray.push(this.CommitedQTY3),this.ObjArray.push(this.SalesDocs),this.ObjArray.push(this.FromDate.Date),this.ObjArray.push(this.ToDate.Date),this.ObjArray.push(parseInt(this.Slot1.Text)),this.ObjArray.push(parseInt(this.Slot2.Text)-parseInt(this.Slot1.Text)),this.ObjArray.push(parseInt(this.Slot3.Text)-parseInt(this.Slot2.Text)),this.ObjArray.push(B),this.ObjArray.push(this.ReorderDimension>0&&50002!=this.ReorderDimension?this.ReorderDimension:null!=this.DimensionFilter?this.DimensionFilter.CostCenterID:50002),this.ObjArray.push(this.SelectedLocations),this.ObjArray.push(this.SelectedAvgLocations),this.ObjArray.push(this.SelectedReOrderLocations),this.ObjArray.push(this.strHiddenFields),this.ObjArray.push(F),this.ObjArray.push(this.SalesCostColumn),this.ObjArray.push(this.SalesValueColumn),this.ObjArray.push(G),this.ObjArray.push(this.FromTag),this.ObjArray.push(w),this.ObjArray.push(this.BatchPreExpiry),this.ObjArray.push(this.ExeQty_DontShowUnApproved),this.ObjArray.push(this.PostedQtyFor),this.ObjArray.push(r.a.SessionManager.UserID),this.ObjArray.push(r.a.SessionManager.LanguageID);for(var x=function(e){t.lstSaleSlots.keys[e];var i=t.lstSaleSlots.values[e],o=parseInt(t.Slot1.Text);if(k=t.ColumnsSource.filter((function(e){return e.DisplayMember.startsWith(i.DisplayMember+"1")})),!(o>0))return k.forEach((function(e){e.IsVisible=!1})),"continue";k.forEach((function(e){e.Header=e.BarcodeDef,e.Header+=0==e.BarcodeProp.length?"\r\n":" ",e.Header+="Yearly"==t.SalesSlotType||"Monthly"==t.SalesSlotType?t.Slot1.DependantOn:"1 - "+o,e.IsVisible=!e.Dependantinuse,e.BarcodeProp.length>0&&(e.Header+="\r\n"+e.BarcodeProp)}));var r=parseInt(t.Slot2.Text);if(k=t.ColumnsSource.filter((function(e){return e.DisplayMember.startsWith(i.DisplayMember+"2")})),!(r>0))return k.forEach((function(e){e.IsVisible=!1})),"continue";k.forEach((function(e){e.Header=e.BarcodeDef,e.Header+=0==e.BarcodeProp.length?"\r\n":" ",e.Header+="Yearly"==t.SalesSlotType||"Monthly"==t.SalesSlotType?t.Slot2.DependantOn:o+1+"-"+r,e.IsVisible=!e.Dependantinuse,e.BarcodeProp.length>0&&(e.Header+="\r\n"+e.BarcodeProp)}));var s=parseInt(t.Slot3.Text);(k=t.ColumnsSource.filter((function(e){return e.DisplayMember.startsWith(i.DisplayMember+"3")}))).forEach(s>0?function(e){e.Header=e.BarcodeDef,e.Header+=0==e.BarcodeProp.length?"\r\n":" ",e.Header+="Yearly"==t.SalesSlotType||"Monthly"==t.SalesSlotType?t.Slot3.DependantOn:r+1+"-"+s,e.IsVisible=!e.Dependantinuse,e.BarcodeProp.length>0&&(e.Header+="\r\n"+e.BarcodeProp)}:function(e){e.IsVisible=!1})},A=0;A<this.lstSaleSlots.keys.length;A++){var k;x(A)}this.lstSaleSlots.length>0&&(this.ReOrderGrid.RefreshColumns(),this.ColumnsSource=this.ReOrderGrid.Columns),this.strPrevGroup=null,this.RecordCount="[Displaying 0 of "+this.ProductsIDs.length+" Rows]",this.dicFPConvertionQty=new n.a,this.BomWHERE.length>0&&this.BOMGrid.Table.forEach((function(e){if("1"!=e.UnitType.toString()){var i=t.dsProduct.Tables[1].filter((function(t){return t.BOMID==e.BOMID})),o=parseFloat(e.Qty),r=1,s=1,n=1;if(""!=e.UOM_key.toString()){if(i[0].UOMID.toString().length>0){var l=t.dsProduct.Tables[2].filter((function(e){return e.UOMID==i[0].UOMID}));l.length>0&&(s=parseFloat(l[0].Conversion)),s<0&&(s=1)}var a=t.dsProduct.Tables[2].filter((function(t){return t.UOMID==e.UOM_key}));a.length>0&&(r=parseFloat(a[0].Conversion)),0==r&&(r=1),n=parseFloat(i[0].FPQty),o=parseFloat(e.Qty)*r/(n*s),t.dicFPConvertionQty.push(i[0].BOMID.toString(),o)}}})),this.ShowBOMProducts==E.BOM||this.ProductsByVoucher_Temp?(this.ReOrderGrid.CanUserSortColumns=!1,this.ReOrderGrid.TableColumns.Contains("StyleIsBold")||this.ReOrderGrid.TableColumns.push("StyleIsBold"),this.ReOrderGrid.TableColumns.Contains("VoucherNo")||this.ReOrderGrid.TableColumns.push("VoucherNo"),this.ReOrderGrid.TableColumns.Contains("GroupNo")||this.ReOrderGrid.TableColumns.push("GroupNo"),this.ReOrderGrid.TableColumns.Contains("IsGroupRow")||this.ReOrderGrid.TableColumns.push("IsGroupRow"),this.ReOrderGrid.TableColumns.Contains("ReorderDetailsID")||this.ReOrderGrid.TableColumns.push("ReorderDetailsID")):this.ReOrderGrid.CanUserSortColumns=!0,this.ReOrderGrid.fldDict.FROMDATE.setFieldValue(this.FromDate.Date),this.ReOrderGrid.fldDict.TODATE.setFieldValue(this.ToDate.Date),this.indGrpColumn=1,this.GroupNo=0;var _=this.ReOrderGrid.Columns.find((function(e){return e.IsVisible&&"Sno"!=e.DisplayMember&&"FLOAT"!=e.DataType&&"DATE"!=e.DataType}));null!=_&&(this.indGrpColumn=this.ReOrderGrid.TableColumns.indexOf(_.DisplayMember),this.indGrpColumn<0&&(this.indGrpColumn=1)),this.iLoop=0,this.sno=0,this.LoadReorderGrid_CallBack()}}},{key:"LoadReorderGrid_CallBack",value:function(){var e=this;if(this.iLoop>=this.ProductsIDs.length)this.LoadReorderGrid_Complete();else if(this.worker.CancellationPending)this.worker.Cancel=!0;else{for(var t,i="",o=0,n=0,l=new Array,a=this.iLoop;a<this.ProductsIDs.length&&a-this.iLoop<this.ChunkSize;a++)l.Contains(this.ProductsIDs[a])||(i.length>0&&(i+=","),i+=this.ProductsIDs[a],l.push(this.ProductsIDs[a]));this.ObjArray[0]=i.toString(),r.a.inventory.GetReOrderLevelData(this.ObjArray).then((function(i){var r,l,a,u,d,h=i,c=e.ToDate.Date.Subtract(e.FromDate.Date).Days+1;(c<1&&(c=1),s.e.Int(e.SalesForeCastDays.Text),null!=e.dsClass&&(h.Columns[0].push("Class1"),h.Columns[0].push("Class2"),h.Columns[0].push("Class3"),h.Tables[0].forEach((function(t){var i=e.dsClass.Tables[0].filter((function(e){return e.ProductID==t.ProductID}));i.length>0&&(t.Class1=i[0].Class),(i=e.dsClass.Tables[1].filter((function(e){return e.ProductID==t.ProductID}))).length>0&&(t.Class2=i[0].Class),(i=e.dsClass.Tables[2].filter((function(e){return e.ProductID==t.ProductID}))).length>0&&(t.Class3=i[0].Class)}))),null!=e.dtPCProfile&&e.lstPCProfiles.length>0)&&(e.lstPCProfiles.keys.forEach((function(e){h.Columns[0].push(e)})),h.Tables[0].forEach((function(t){e.dtPCProfile.filter((function(e){return e.ProductID==t.ProductID})).forEach((function(e){t["DWPCProfile_"+e.ProfileID.toString()+"_"+e.DimID.toString()]=e.Rate}))})));for(var D=1;D<h.Columns[1].length;D++)h.Columns[0].push(h.Columns[1][D]);r=a=h.Tables[0],h.Tables[0],l=u=h.Tables[1],d=h.Columns[1];for(var m=e.dsProduct.Tables.length>1&&e.dsProduct.Tables[1].length>0?e.dsProduct.Tables[1]:null,C=function(i){if(0==(r=a.filter((function(t){return t.ProductID==e.ProductsIDs[i]}))).length)return"continue";if(e.ShowBOMProducts==E.BOM&&e.BomWHERE.length>0&&e.strPrevGroup!=e.dsProduct.Tables[0][i].BOMID.toString()){s.e.IsEmpty(e.strPrevGroup)||e.AddSubTotal(e.indGrpColumn,m[0].BOMName.toString(),e.GroupNo),e.sno=0,e.strPrevGroup=e.dsProduct.Tables[0][i].BOMID.toString();var c=e.ReOrderGrid.NewRow();m=e.dsProduct.Tables[1].filter((function(t){return t.BOMID==e.strPrevGroup})),c[e.ReOrderGrid.TableColumns[e.indGrpColumn]]=m[0].BOMName.toString(),c.StyleIsBold=1,c.GroupNo=++e.GroupNo,c.IsGroupRow=!0,e.ReOrderGrid.addRow(c)}else if(e.ShowBOMProducts==E.BOM&&e.KitWHERE.length>0&&e.strPrevGroup!=e.dsProduct.Tables[0][i].ParentProductID.toString()){e.sno=0,e.strPrevGroup=e.dsProduct.Tables[0][i].ParentProductID.toString();var D=e.ReOrderGrid.NewRow();m=e.dsProduct.Tables[1].filter((function(t){return t.ParentProductID==e.strPrevGroup})),D[e.ReOrderGrid.TableColumns[e.indGrpColumn]]=m[0].KitName.toString(),D.StyleIsBold=1,D.GroupNo=++e.GroupNo,D.IsGroupRow=!0,e.ReOrderGrid.addRow(D)}else if(e.ProductsByVoucher_Temp&&e.strPrevGroup!=e.dsProduct.Tables[0][i].VoucherNo.toString()){e.sno=0,e.strPrevGroup=e.dsProduct.Tables[0][i].VoucherNo.toString();var C=e.ReOrderGrid.NewRow();C[e.ReOrderGrid.TableColumns[e.indGrpColumn]]=e.strPrevGroup,C.StyleIsBold=1,C.GroupNo=++e.GroupNo,C.IsGroupRow=!0,e.ReOrderGrid.addRow(C)}for(var f=0;f<e.totalSELECTED.length;f++)e.totalSELECTED[e.totalSELECTED.keys[f]]=0;var p=e.ReOrderGrid.NewRow();if(h.Columns[0].forEach((function(t){e.ReOrderGrid.TableColumns.Contains(t)&&(p[t]=r[0][t])})),p.ProductName_Key=r[0].ProductID,null!=e.dsProduct&&(e.BOMSelect.length>0||e.ShowBOMProducts==E.FinishedProduct)){var S=0;if(e.ShowBOMProducts==E.BOM)if(e.dicFPConvertionQty.ContainsKey(e.strPrevGroup))S+=e.dicFPConvertionQty[e.strPrevGroup]*parseFloat(e.dsProduct.Tables[0][i].ConvertedQty);else{var I=e.BOMGrid.Table.filter((function(t){return t.BOMID==e.strPrevGroup}));S+=parseFloat(I[0].Qty)*parseFloat(e.dsProduct.Tables[0][i].ConvertedQty)}else e.ShowBOMProducts==E.FinishedProduct?e.dicFPQty.ContainsKey(e.ProductsIDs[i])&&(S=e.dicFPQty[e.ProductsIDs[i]]):e.dsProduct.Tables[0].filter((function(e){return e.ProductID==r[0].ProductID})).forEach((function(t){if(e.dicFPConvertionQty.ContainsKey(t.BOMID.toString()))S+=e.dicFPConvertionQty[t.BOMID.toString()]*parseFloat(t.ConvertedQty);else{var i=e.BOMGrid.Table.filter((function(e){return e.BOMID==t.BOMID}));S+=parseFloat(i[0].Qty)*parseFloat(t.ConvertedQty)}}));p.RequiredQty=S}else if(null!=e.dsProduct&&e.MOWHERE.length>0){var y=0;e.dsProduct.Tables[0].filter((function(e){return e.ProductID==r[0].ProductID})).forEach((function(t){var i=e.MOGrid.Table.filter((function(e){return e.MOID==t.MOID}));y+=parseFloat(i[0].Qty)*parseFloat(t.ConvertedQty)})),p.RequiredQty=y}else if(null!=e.dsProduct&&e.KitWHERE.length>0)if(e.IsKitProjection);else{var T=0;if(e.ShowBOMProducts==E.BOM){var P=e.KitGrid.Table.filter((function(t){return t.KitID==e.strPrevGroup}));T+=parseFloat(P[0].Qty)*parseFloat(e.dsProduct.Tables[0][i].KitQty)}else e.dsProduct.Tables[0].filter((function(e){return e.ProductID==r[0].ProductID})).forEach((function(t){var i=e.KitGrid.Table.filter((function(e){return e.KitID==t.ParentProductID}));T+=parseFloat(i[0].Qty)*parseFloat(t.KitQty)}));p.RequiredQty=T}if(r.forEach((function(i){t=i.TAGID.toString(),e.LocationCols.ContainsKey(t)?e.LocationCols[t].forEach((function(o){p[o+"_"+t]=i[o],e.totalSELECTED.ContainsKey(o)&&(n=s.e.Double(i[o]),e.totalSELECTED[o]+=n)})):"-1"==t&&e.totalALL.keys.forEach((function(e){p[e+"_ALL"]=i[e]}))})),e.totalSELECTED.keys.forEach((function(t){p[t+"_SELECTED"]=e.totalSELECTED[t]})),e.totalALL.keys.forEach((function(t){p[t]=e.totalALL[t]})),e.Vendor.Visible)if(0==e.VendorWHERE.length&&h.Tables[2].length>0&&parseInt(h.Tables[2][0].VendorID)>0)e.Vendor.SelectedValue=parseInt(h.Tables[2][0].VendorID),p.Vendor=h.Tables[2][0].VendorName,e.VendorWHERE="1=1";else{var b=h.Tables[2].filter((function(t){return t.VendorID==e.Vendor.SelectedValue}));b>0&&(p.Vendor=b[0].VendorName)}else{var O=h.Tables[2].filter((function(t){return t.ProductID==e.ProductsIDs[i]}));O.length>0?(p.Vendor=O[0].VendorName,p.Vendor_Key=O[0].VendorID):p.Vendor_Key=0}if((l=u.filter((function(t){return t.ProductID==e.ProductsIDs[i]}))).length>0)for(var R=1;R<d.length;R++)try{p[d[R]]=l[0][d[R]]}catch(v){}if(e.ReportSelectedNodes.length>0)if(e.ProductsByVoucher_Temp){p.VoucherNo=e.dsProduct.Tables[0][i].VoucherNo,p.ReorderDetailsID=e.dsProduct.Tables[0][i].ReorderDetailsID;var g=e.ReportSelectedNodes[i].Tree;if(null!=g)for(var M=0;M<g.length;M++){var N=g[M];if(null!=N.value){if(!e.ReOrderGrid.TableColumns.Contains(N.ROColID)){Logger.ErrorLog("Reorder Column not found: "+N.ROColID);continue}N.IsDimension?(p[N.ROColID]=N.value,e.ReOrderGrid.TableColumns.Contains(N.ROColID+"_ID")?p[N.ROColID+"_ID"]=N.DimensionID:e.ReOrderGrid.TableColumns.Contains("Vendor_Key")&&"Vendor"==N.ROColID&&(p.Vendor_Key=N.DimensionID)):"FLOAT"==N.Type||"INT"==N.Type?s.e.IsNum(N.value)&&(p[N.ROColID]=s.e.Double(N.value)):"DATE"==N.Type?s.e.isValidDate(N.value)&&(p[N.ROColID]=new Date(N.value)):p[N.ROColID]=N.value}}}else e.ReportSelectedNodes.filter((function(t){return t.Id==e.ProductsIDs[i]})).forEach((function(t){var i=t.Tree;if(null!=i)for(var o=0;o<i.length;o++){var r=i[o];if(null!=r.value){if(!e.ReOrderGrid.TableColumns.Contains(r.ROColID)){Logger.ErrorLog("Reorder Column not found: "+r.ROColID);continue}r.IsDimension?(p[r.ROColID]=r.value,e.ReOrderGrid.TableColumns.Contains(r.ROColID+"_ID")&&(p[r.ROColID+"_ID"]=r.DimensionID)):"FLOAT"==r.Type||"INT"==r.Type?s.e.IsNum(r.value)&&(n=s.e.Double(r.value),p[r.ROColID]=null==p[r.ROColID]?n:parseFloat(p[r.ROColID])+n):"DATE"==r.Type?s.e.isValidDate(r.value)&&(p[r.ROColID]=new Date(r.value)):p[r.ROColID]=null==p[r.ROColID]?r.value:p[r.ROColID].toString()+","+r.value.toString()}}}));p.Sno=++e.sno,e.ReOrderGrid.TableColumns.Contains("GroupNo")&&(p.GroupNo=e.GroupNo),e.ReOrderGrid.addRow(p),e.ReOrderGrid.EvaluateFormulas(p,!0)?e.ReOrderGrid.removeRow(p):(o=s.e.Double(p.Variance))<0&&(p.Variance_RED="1"),e.IsKitProjection&&e.KitWHERE.length>0&&(o=e.CalculateKitProjection(e.ObjArray,e.ProductsIDs[i],e.dsProduct),p.Variance=o,p.Variance_RED="0"),i==e.ProductsIDs.length-1&&e.ShowBOMProducts==E.BOM&&e.BomWHERE.length>0&&e.AddSubTotal(e.indGrpColumn,m[0].BOMName.toString(),e.GroupNo)},f=e.iLoop;f<e.ProductsIDs.length&&f-e.iLoop<e.ChunkSize;f++)C(f);e.RecordCount="[Displaying "+(e.iLoop+e.ChunkSize)+" of "+e.ProductsIDs.length+" Rows]",e.iLoop+=e.ChunkSize,e.ReOrderGrid.refreshDataView(),e.LoadReorderGrid_CallBack()}))}}},{key:"LoadReorderGrid_Complete",value:function(){this.IsKitProjection&&this.KitWHERE.length>0&&this.CheckDuplicateKitProducts(),this.RecordCount="",this.worker_RunWorkerCompleted(null,null)}},{key:"AddSubTotal",value:function(e,t,i){var o=this.ReOrderGrid.NewRow();o[this.ReOrderGrid.TableColumns[e]]=" Total :: "+t,o.StyleIsBold=1,o.GroupNo=i,o.IsGroupRow=!0;for(var r=1;r<this.ReOrderGrid.Columns.length;r++)this.ReOrderGrid.Columns[r].ShowTotal&&this.ReOrderGrid.TableColumns.Contains(this.ReOrderGrid.Columns[r].DisplayMember)&&(o[this.ReOrderGrid.Columns[r].DisplayMember]=this.ReOrderGrid.Table.filter((function(e){return e.GroupNo==i})).Compute("sum",this.ReOrderGrid.Columns[r].DisplayMember));this.ReOrderGrid.addRow(o)}},{key:"RefreshReOrderGridColumns",value:function(){var e=new Array;this.ReOrderGrid.Columns.forEach((function(t){e.push(t)})),this.ReOrderGrid.Columns=e}},{key:"CalculateKitProjection",value:function(e,t,i){var o=this,n=0,l="",a=i.Tables[1].filter((function(e){return e.ParentProductID==t}));return a.forEach((function(e){l.length>0&&(l+=","),l+=e.ProductID})),l.length>0&&function(){var t,i=0,u=0;e[0]=l;var d,h=r.a.inventory.GetReOrderLevelData(e);h.Columns[0].push("RequiredQty");for(var c=h.Tables[0],D=function(e){var r=a[e];if(0==(d=c.filter((function(e){return e.ProductID==r.ProductID}))).length)return"continue";for(var l=0;l<o.totalSELECTED.length;l++)o.totalSELECTED[o.totalSELECTED.keys[l]]=0;var D=o.ReOrderGrid.NewRow();h.Columns[0].forEach((function(e){o.ReOrderGrid.TableColumns.Contains(e)&&(D[e]=d[0][e])})),D.ProductName_Key=d[0].ProductID,d.forEach((function(e){t=e.TAGID.toString(),o.LocationCols.ContainsKey(t)?o.LocationCols[t].forEach((function(i){D[i+"_"+t]=e[i],o.totalSELECTED.ContainsKey(i)&&(u=s.e.Double(e[i]),o.totalSELECTED[i]+=u)})):"-1"==t&&o.totalALL.keys.forEach((function(t){D[t+"_ALL"]=e[t]}))})),o.totalSELECTED.keys.forEach((function(e){D[e+"_SELECTED"]=o.totalSELECTED[e]})),o.totalALL.keys.forEach((function(e){D[e]=o.totalALL[e]})),o.ReOrderGrid.EvaluateFormulas(D,!0),i=s.e.Double(D.Variance);var m=parseFloat(r.KitQty);if(i<m)return n=0,"break";var C=Math.floor(i/m);(0==n||n>C)&&(n=C)},m=0;m<a.length;m++){var C=D(m);if("continue"!==C&&"break"===C)break}}(),n>0&&a.forEach((function(e){var i=parseInt(e.ProductID);o.dicKitProjection.ContainsKey(i)||o.dicKitProjection.push(i,new Array),o.dicKitProjection[i].push(t)})),n}},{key:"CheckDuplicateKitProducts",value:function(){var e=this;this.ReOrderGrid.Table.forEach((function(t){if(s.e.Double(t.Variance)>0)for(var i=0;i<e.dicKitProjection.keys.length;i++){var o=e.dicKitProjection[i];if(o.Contains(parseInt(t.ProductName_Key))&&o.length>1){t.Variance_RED="1";break}}}))}},{key:"LoadTreeData",value:function(e){var t=this;this.tree=new Array;var i=s.f.SelectSingleNode(e,"TreeFilter"),o=0;if("True"==r.a.SessionManager.Preferences.EnableLocationWise.toString()&&"True"==r.a.SessionManager.Preferences["LW Reports"]?o=50002:r.a.SessionManager.Preferences.ContainsKey("Maintain Dimensionwise stock")&&(o=s.e.Int(r.a.SessionManager.Preferences["Maintain Dimensionwise stock"])),50001==o){var n=this.CostCenters.Items.find((function(e){return"50001"==e.Value}));null!=n&&(n.Aliasname="");var l=!1;if(s.f.SelectNodes(e,"TreeFilter/FilterDef").forEach((function(e){"50001"==s.f.SelectSingleNode(e,"CCID").innerHTML&&(l=!0)})),!l){var a=0==s.f.SelectNodes(i,"FilterDef").length?"1":"0";a="<FilterDef>"+(a="<CCID>50001</CCID><GridViewID>0</GridViewID><IsDefaultCC>"+a+"</IsDefaultCC><DefaultValues>"+r.a.SessionManager.DivisionID+"</DefaultValues>")+"</FilterDef>",s.f.AppendChild(i,a)}}if(50002==o){var u=this.CostCenters.Items.find((function(e){return"50002"==e.Value}));null!=u&&(u.Aliasname="");for(var d=null,c=s.f.SelectNodes(e,"TreeFilter/FilterDef"),D=0;D<c.length;D++){var m=c[D];if("50002"==s.f.SelectSingleNodeText(m,"CCID")){d=m;break}}var C=s.f.SelectSingleNode(this.xDocPref.DocumentElement,"SelectAllLocations"),f=null!=C&&"1"==C.innerHTML;if(null==d){var p=0==s.f.SelectNodes(i,"FilterDef").length?"1":"0";p="<FilterDef>"+(p=f||0==r.a.SessionManager.LocationID?"<CCID>50002</CCID><GridViewID>0</GridViewID><IsDefaultCC>"+p+"</IsDefaultCC><DefaultValues>"+r.a.SessionManager.LocationWhere+"</DefaultValues>":"<CCID>50002</CCID><GridViewID>0</GridViewID><IsDefaultCC>"+p+"</IsDefaultCC><DefaultValues>"+r.a.SessionManager.LocationID+"</DefaultValues>")+"</FilterDef>",s.f.AppendChild(i,p)}else{var S=s.f.SelectSingleNode(d,"DefaultValues");if(null!=S)if(f)S.innerHTML=r.a.SessionManager.LocationWhere;else if(0==S.innerHTML.length)S.innerHTML=0!=r.a.SessionManager.LocationID?r.a.SessionManager.LocationID.toString():r.a.SessionManager.LocationWhere;else{var I=S.innerHTML.split(","),y=r.a.SessionManager.LocationWhere.split(","),T="";I.forEach((function(e){y.Contains(e)&&(T.length>0&&(T+=","),T+=e)})),S.innerHTML=T}}}if("1"!=r.a.SessionManager.UserID&&"1"!=r.a.SessionManager.RoleID&&null!=this.CostCenters)for(var P=r.a.SessionManager.Preferences.ContainsKey("Dimension List")?r.a.SessionManager.Preferences["Dimension List"].split(","):[],b=this.CostCenters.Items.filter((function(e){return"1"==e.Aliasname})),O=function(t){var o=b[t],n="";if(P.Contains(o.Value)){var l=r.a.report.IsGroupNode(parseInt(o.Value),0);r.a.report.DataSet("RPT017",l.TableName,o.Value,r.a.SessionManager.UserID).Tables[0].forEach((function(e){n.length>0&&(n+=","),n+=e.NodeID.toString()}))}for(var a=null,u=s.f.SelectNodes(e,"TreeFilter/FilterDef"),d=0;d<u.length;d++){var h=u[d];if(s.f.SelectSingleNodeText(h,"CCID")==o.Value){a=h;break}}if(null==a){var c;c="<FilterDef>"+(c=0==s.f.SelectNodes(i,"FilterDef").length?"<CCID>"+o.Value+"</CCID><GridViewID>0</GridViewID><IsDefaultCC>1</IsDefaultCC><DefaultValues>"+n+"</DefaultValues>":"<CCID>"+o.Value+"</CCID><GridViewID>0</GridViewID><IsDefaultCC>0</IsDefaultCC><DefaultValues>"+n+"</DefaultValues>")+"</FilterDef>",s.f.AppendChild(i,c)}else{var D=a.SelectSingleNode("DefaultValues");null!=D&&0==D.innerHTML.length&&(D.innerHTML=n)}},R=0;R<b.length;R++)O(R);var g,E=!1,M=s.f.SelectNodes(e,"TreeFilter/FilterDef/IsDefaultCC");if(M.length>0){for(var N=0;N<M.length;N++)if("1"==M[N].innerHTML){E=!0;break}E||(M[0].innerHTML="1")}for(var v=s.f.SelectNodes(e,"TreeFilter/FilterDef"),V=function(e){var i=v[e],o=s.f.SelectSingleNode(i,"CCID").innerHTML,r=t.CostCenters.Items.find((function(e){return e.Value==o}));if(null==r)return"continue";if(g="44"!=o&&"50"!=o||null==s.f.SelectSingleNode(i,"LookupTypeID")?0:parseInt(s.f.SelectSingleNode(i,"LookupTypeID").innerHTML),("44"==r.Value||"50"==r.Value)&&r.Parent!=g.toString())return"continue";var n=new h.a(parseInt(o),g.toString(),r.Name,t);n.SetSelectedNodes(i),"1"==s.f.SelectSingleNode(i,"IsDefaultCC").innerHTML&&(r.CurrID=1,parseInt(o),null!=s.f.SelectSingleNode(i,"GridViewID")?parseInt(s.f.SelectSingleNode(i,"GridViewID").innerHTML):0),"1"==s.f.SelectSingleNode(i,"IsDefaultCC").innerHTML&&(t.CostCenters.SelectedValue=o,t.CostCenters.SelectedItem=r,t.OnCostCenterChange(null)),"1"==r.Aliasname&&(n.DeleteButtonVisibility=!1),t.CostCenterFilters.push(n)},G=0;G<v.length;G++)V(G)}},{key:"OnButtonClick",value:function(e){var t=this;if(this.DisplayMessage="","Regenerate"==e)this.GridVisibility=!1,this.FilterVisibility=!0;else if("PostFilters"==e)this.ShowPostFilter=!0,this.BOMGrid.refreshUI(),this.BOMGrid.refreshDataView();else if("PostFilterOK"==e||"PostFilterClear"==e)null!=this.PostDataFetchFilterFields&&this.FilterorClear(e);else if("PostFilterCancel"==e)this.ShowPostFilter=!1;else if("NEXT"==e)this.LoadNextDocument("NEXT");else if("CLOSE"==e)this.DocumentVisibility=!1,this.GridVisibility=!0;else if("Post"==e)this.PostDocuments();else if("PostClose"==e)if(this.postworkerIsBusy){if(confirm("Do you want to cancel posting?"))return this.postworkerCancel=!0,void(this.AutoPostMessage="")}else this.ShowAutoPost=!1,this.AutoPostMessage="";else if("FilterOK"==e){var i=0,o=0,n=0;try{i=parseInt(this.Slot1.Text)}catch(T){return void(this.DisplayMessage="Enter Valid Number")}try{o=parseInt(this.Slot2.Text)}catch(P){return void(this.DisplayMessage="Enter Valid Number")}try{n=parseInt(this.Slot3.Text)}catch(b){return void(this.DisplayMessage="Enter Valid Number")}if(i>=o||o>=n)return void(this.DisplayMessage="Enter Valid Slot Numbers");if(this.DisplayMessage="",this.FilterVisibility=!1,this.GridVisibility=!0,null!=this.DWPCProfile){this.dtPCProfile=null,this.lstPCProfiles.Clear();var l=!1,a="",u=new Array,d=this.CostCenterFilters.find((function(e){return 40==e.CostCenterID&&null!=e.SelectedNodes&&e.SelectedNodes.length>0}));null!=d&&d.SelectedNodes.filter((function(e){return 0==e.IsGroup})).forEach((function(e){u.Contains(e.Id)||(u.push(e.Id),a.length>0&&(a+=","),a+=e.Id.toString())}));for(var D=this.ColumnsSource.length-1;D>=0;D--){var m=this.ColumnsSource[D];null!=m.DisplayMember&&m.DisplayMember.startsWith("DWPCProfile")&&(l=!0,this.ReOrderGrid.TableColumns.Contains(m.DisplayMember)&&this.ReOrderGrid.TableColumns.Remove(m.DisplayMember),this.ColumnsSource.Remove(m))}if(a.length>0){l=!0;var C=[];C.push(a),C.push(r.a.SessionManager.UserID),C.push(r.a.SessionManager.LanguageID),this.dtPCProfile.SortBy(["ProfileName","Dimension"]);var f=null;this.dtPCProfile.ToTable(!0,["ProfileID","DimID","ProfileName","Dimension"]).forEach((function(e){var i=t.DWPCProfile.Clone();e.ProfileID.toString()!=f?(f=e.ProfileID.toString(),i.Header=e.ProfileName.toString()+"\r\n"+e.Dimension.toString()):i.Header=e.Dimension.toString(),i.DisplayMember="DWPCProfile_"+e.ProfileID.toString()+"_"+e.DimID.toString(),null==t.ColumnsSource.find((function(e){return e.DisplayMember==i.DisplayMember}))&&(t.lstPCProfiles.push(i.DisplayMember,"ProfileID="+e.ProfileID.toString()+" and DimID="+e.DimID.toString()),t.ReOrderGrid.TableColumns.push(i.DisplayMember),t.ColumnsSource.push(i))}))}l&&(this.ReOrderGrid.RefreshColumns(),this.ColumnsSource=this.ReOrderGrid.Columns)}this.ReOrderGrid.Table.Clear(),this.worker.IsBusy=!0,this.worker_DoWork(null,null)}else if("FilterCancel"==e)null!=this.ReOrderGrid.Table?(this.FilterVisibility=!1,this.GridVisibility=!0):r.a.page.removeTab(this);else if("Export"==e){this.ReOrderGrid.ExportExcelNew(0,this.Title,this.DateFilter,void 0),(void 0).length>0&&(this.DisplayMessage=void 0)}else if("Save"==e){if(this.DialogAction="Save",(void 0).IsOkClick){Logger.GetLogFilePath(),(new Date).ToString("_yyyyMMdd_HHmmss");var p={Tables:[]};p.Tables.push(this.ReOrderGrid.Table.Copy()),null!=this.BOMGrid.Table&&p.Tables.push(this.BOMGrid.Table.Copy());var S="";S+="<AttachmentsXML><Row ",s.e.IsEmpty((void 0).List.SelectedValue)?(S+=' Action="NEW"',S+=' AttachmentID="0"'):(S+=' Action="MODIFY"',S+=' AttachmentID="'+(void 0).List.SelectedValue+'"'),r.a.report.GetReportData(5,this.ReportID,S.toString()),this.ProfileName=(void 0).Name.Text,this.RefreshDateFilter()}}else if("Open"==e)try{if(this.DialogAction="Open",(void 0).IsOkClick){var I=new s.f;if(I.ReadXml(void 0),this.ReOrderGrid.Table=I.Tables[0],this.ReportData=this.ReOrderGrid.Table,this.ProfileName=(void 0).Name.Text,this.RefreshDateFilter(),I.Tables.Contains("BOM")){if(this.BOMGrid.Table=I.Tables.BOM,this.BOMGrid.Table.length>0){this.BOMGrid.Visible=!0;var y=this.CostCenterFilters.find((function(e){return 76==e.CostCenterID}));null==y&&((y=new h.a(76,"","Bill Of Material",this)).SelectedNodes=new Array,this.CostCenterFilters.push(y)),this.BOMGrid.Table.forEach((function(e){if(null!=e.BOMID){var t=new c.a;t.Id=parseInt(e.BOMID),y.SelectedNodes.push(t)}})),y.SelectedNodesTag="[FILTER]"}}else null!=this.BOMGrid.Table&&this.BOMGrid.Clear()}}catch(O){Logger.ErrorLog("Open File Error:",O)}}},{key:"OnCostCenterChange",value:function(e){return Object(o.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,o,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.e.IsEmpty(this.CostCenters.SelectedValue)){e.next=15;break}if(null==this.CostCenters.SelectedItem||50!=parseInt(this.CostCenters.SelectedValue)){e.next=13;break}if(this.ReportWidth="480",this.ReportHeight="430",0!=this.Report.length&&this.Report[0].ReportID==parseInt(this.CostCenters.SelectedItem.Parent)){e.next=10;break}return this.ReportLoaded=!1,e.next=6,Promise.all([i.e(2),i.e(1),i.e(3),i.e(5),i.e(4),i.e(6),i.e(7),i.e(10),i.e(9),i.e(8),i.e(12),i.e(11),i.e(13),i.e(19),i.e(15),i.e(21),i.e(20),i.e(16),i.e(14),i.e(18),i.e(17),i.e(22),i.e(23),i.e(24),i.e(25),i.e(28),i.e(30),i.e(29),i.e(32),i.e(31),i.e(27),i.e(26),i.e(35),i.e(37),i.e(38),i.e(36),i.e(33),i.e(34),i.e(39),i.e(40),i.e(41),i.e(212)]).then(i.bind(null,"ThYU"));case 6:t=e.sent,o=t.ReportViewModel,(r=new o).ReportViewModel_Document(112,"<XML></XML>",parseInt(this.CostCenters.SelectedItem.Parent),!1,null,null),r.ShowHeaderButtons=!1,r.ShowRightPanel=!1,r.SearchVisibility=!1,r.PrefetchReportTreeFilter=this,r.PrefetchReportTreeFilter.PrefetchReportType=112,this.Report.Clear(),this.Report.push(r);case 10:this.TreeVisibility=!1,e.next=15;break;case 13:0!=this.tree.length&&this.tree[0].CostCenterID==parseInt(this.CostCenters.SelectedValue)||(n=0,null==this.CostCenters.SelectedItem||s.e.IsEmpty(this.CostCenters.SelectedItem.Parent)||(n=s.e.Int(this.CostCenters.SelectedItem.Parent)),this.LoadCostCenterTree(parseInt(this.CostCenters.SelectedValue),n,0,null)),this.TreeVisibility=!0;case 15:case"end":return e.stop()}}),e,this)})))}},{key:"OnDocCallBack",value:function(){if(null!=this.Document&&this.Document.DialogResult){if(null==this.AutoPostGrid){this.AutoPostGrid=new C.a,this.AutoPostGrid.Width="",this.AutoPostGrid.Table=[],this.AutoPostGrid.TableColumns.push("Sno"),this.AutoPostGrid.TableColumns.push("DocNo"),this.AutoPostGrid.TableColumns.push("ErrorMessage");var e=new Array,t=new D.a;t.Header="#",t.DisplayMember="Sno",t.Width=35,t.ReadOnly=!0,e.push(t),(t=new D.a).Header="Voucher No",t.DisplayMember="DocNo",t.DataType="LINK_VOUCHER",t.Width=130,t.ReadOnly=!0,e.push(t),(t=new D.a).Header="Error Message",t.DisplayMember="ErrorMessage",t.Width=350,t.ReadOnly=!0,e.push(t),this.AutoPostGrid.Columns=e}this.AutoPostGrid.Clear();for(var i=0;i<100;i++)this.AutoPostGrid.addEmptyRow();this.AutoPostMessage="Posting Documents... Please wait.",this.ShowAutoPost=!0,this.postworker_DoWork("",{})}}},{key:"LoadCostCenterTree",value:function(e,t,i,o){this.tree.Clear();var n,l="";if(50002==e&&"1"!=r.a.SessionManager.RoleID&&"True"==r.a.SessionManager.Preferences.EnableLocationWise.toString()&&"True"==r.a.SessionManager.Preferences["LW Reports"]&&(l=s.e.IsEmpty(r.a.SessionManager.LocationWhere)?"A.NodeID IN (-1234)":"A.NodeID IN ("+r.a.SessionManager.LocationWhere+")"),null==o)for(var a=0;a<this.CostCenterFilters.length;a++){var d=this.CostCenterFilters[a];if(d.CostCenterID==e&&d.LookupTypeID==t){o=d.SelectedNodes;break}}44==e&&t>0&&(l="A.LookupType="+t);var h="";s.f.SelectNodes(this.xDocPref.DocumentElement,"GridViewFilter").forEach((function(t){t.attributes.CCID.value==e&&(h+=t.attributes.GID.value+",")})),n=new I.a,null==o?n.TreeViewModel_5(e,this,i,l,h):n.TreeViewModel_6(e,this,i,l,o,h),n.LookupTypeID=t,n.HeaderVisiblity=!1,n.OnNodeSelected||(n.OnNodeSelected=new u.b,n.OnNodeSelected.Subscribe(this,"OnNodeSelected"),this.NodeSelectedCallBack=new u.b,this.NodeSelectedCallBack.Subscribe(this,"OnNodeSelectedCallBack")),this.tree.push(n)}},{key:"OnNodeSelectedCallBack",value:function(){var e=this;if(76==this.tree[0].CostCenterID)this.tree[0].SelectedNodes.length>0?(this.BOMGrid.Visible=!0,this.BOMGrid.Clear(),this.tree[0].SelectedNodes.forEach((function(t){var i={};i.BOMID=t.Id,i.BOM=t.Text.length>0?t.Text[0]:"BOM";var o=e.BOMGrid.Table.filter((function(e){return e.BOMID==t.Id}));o.length>0?(i.Qty=o[0].Qty,i.UnitType=o[0].UnitType,i.UOM=o[0].UOM,i.UOM_Key=o[0].UOM_Key):(i.Qty=1,i.UnitType="1"),e.BOMGrid.addRow(i)})),null!=(n=this.CostCenterFilters.find((function(e){return 76==e.CostCenterID})))&&(n.IsVisible=!1)):(this.BOMGrid.Visible=!1,null!=(n=this.CostCenterFilters.find((function(e){return 76==e.CostCenterID})))&&(n.IsVisible=!1));else if(-102==this.tree[0].CostCenterID)if(this.tree[0].SelectedNodes.length>0){if(null==this.KitGrid.Table){this.KitGrid.Table=[],this.KitGrid.TableColumns.push("KitID"),this.KitGrid.TableColumns.push("Kit"),this.KitGrid.TableColumns.push("Qty");var t=new Array,i=new D.a;i.Header="Kit",i.DisplayMember="Kit",i.Width=160,i.ReadOnly=!0,t.push(i),(i=new D.a).Header="Qty",i.DisplayMember="Qty",i.DataType="FLOAT",i.Width=70,i.IsCalculated=1,i.DisableTab=!0,i.DecimalPoints=r.a.SessionManager.Preferences.DecimalsinQty,t.push(i),this.KitGrid.Columns=t}this.KitGrid.Visible=!0,this.KitGrid.Clear(),this.tree[0].SelectedNodes.forEach((function(t){if(!t.IsGroup){var i={};i.KitID=t.Id,i.Kit=t.Text.length>0?t.Text[0]:"Kit";var o=e.KitGrid.Table.filter((function(e){return e.KitID==t.Id}));i.Qty=o.length>0?o[0].Qty:1,e.KitGrid.addRow(i)}})),null!=(n=this.CostCenterFilters.find((function(e){return-102==e.CostCenterID})))&&(n.IsVisible=!1)}else this.KitGrid.Visible=!1,null!=(n=this.CostCenterFilters.find((function(e){return-102==e.CostCenterID})))&&(n.IsVisible=!1);else if(78==this.tree[0].CostCenterID)if(this.tree[0].SelectedNodes.length>0){if(null==this.MOGrid.Table){this.MOGrid.Table=[],this.MOGrid.TableColumns.push("MOID"),this.MOGrid.TableColumns.push("MO"),this.MOGrid.TableColumns.push("Qty");var o=new Array,s=new D.a;s.Header="MO",s.DisplayMember="MO",s.Width=140,s.ReadOnly=!0,o.push(s),(s=new D.a).Header="Qty",s.DisplayMember="Qty",s.DataType="FLOAT",s.Width=90,s.IsCalculated=1,s.DisableTab=!0,s.DecimalPoints=r.a.SessionManager.Preferences.DecimalsinQty,o.push(s),this.MOGrid.Columns=o}this.MOGrid.Visible=!0,this.MOGrid.Clear(),this.tree[0].SelectedNodes.forEach((function(t){if(!t.IsGroup){var i={};i.MOID=t.Id,i.MO=t.Text.length>0?t.Text[0]:"MO";var o=e.MOGrid.Table.filter((function(e){return e.MOID==t.Id}));i.Qty=o.length>0?o[0].Qty:1,e.MOGrid.addRow(i)}})),null!=(n=this.CostCenterFilters.find((function(e){return 78==e.CostCenterID})))&&(n.IsVisible=!1)}else{var n;this.MOGrid.Visible=!1,null!=(n=this.CostCenterFilters.find((function(e){return 78==e.CostCenterID})))&&(n.IsVisible=!1)}}},{key:"postworker_DoWork",value:function(e,t){this.indPostIndex=0,this.ShowAutoPost=!0,this.postworkerCancel=!1,this.postworkerIsBusy=!0,this.LoadNextDocument("FIRST")}},{key:"postworker_Completed",value:function(){this.postworkerIsBusy=!1;var e=this.AutoPostGrid.Table.filter((function(e){return!Object(T.isNullOrUndefined)(e.DocNo)})),t=this.AutoPostGrid.Table.filter((function(e){return!Object(T.isNullOrUndefined)(e.Errormessage)}));0==e.length&&0==t.length?this.AutoPostMessage="No Data Found to Post":e.length>0&&t.length>0?this.AutoPostMessage="Partially Posted":0==e.length&&t.length>0?this.AutoPostMessage="Error in Posting":e.length>0&&0==t.length&&(this.AutoPostMessage="Posting Completed")}},{key:"PostDocuments",value:function(){var e=this;if(this.iVendorCount=0,this.lstVendors.Clear(),this.lstPostDocsGroup.Clear(),this.dtVoucherDetails=null,this.Document=null,this.Vendor.Visible)if(this.PostDocsGroupBy.length>0){var t=this.PostDocsGroupBy.split(",");this.ReOrderGrid.Table.ToTable(!0,t).forEach((function(i){var o;e.lstVendors.push(e.Vendor.SelectedValue.toString());for(var r=function(e){o=o.filter(null==i[t[e]]?function(i){return null==i[t[e]]}:function(o){return o[t[e]]==i[t[e]]})},s=0;s<t.length;s++)r(s);o=o((function(e){return e.OrderQty>0})),e.lstPostDocsGroup.push(o)}))}else this.lstVendors.push(this.Vendor.SelectedValue.toString());else{var i=["Vendor_Key"];this.PostDocsGroupBy.length>0&&i.AddRange(this.PostDocsGroupBy.split(",")),this.ReOrderGrid.Table.ToTable(!0,i).forEach((function(t){e.lstVendors.push(s.e.StringValue(t.Vendor_Key));for(var o=e.ReOrderGrid.Table,r=function(e){o=o.filter(null==t[i[e]]?function(t){return null==t[i[e]]}:function(o){return o[i[e]]==t[i[e]]})},n=0;n<i.length;n++)r(n);o=o.filter((function(e){return e.OrderQty>0})),e.lstPostDocsGroup.push(o)}))}this.lstVendors.length>0&&(this.dvItems=this.ReOrderGrid.Table,R.RibbonExtViewModel.GetDocumentObject(parseInt(this.Documents.SelectedValue),this.Documents.SelectedItem.Name,!1).then((function(t){e.Document=t,e.Document.GenratePrefix=!0,e.Document.SaveCallBack=new u.b,e.Document.SaveCallBack.Subscribe(e,"OnSaveCallBack"),e.Document.SaveCallBackMethod.Subscribe(e,"SaveCallBack_Complete"),e.Document.DialogResult?e.OnDocNumberDelegate():e.Document.DocNumberDelegate.Subscribe(e,"OnDocNumberDelegate")})))}},{key:"OnDocNumberDelegate",value:function(){var e=this;if(this.DocumentNumber=this.Document.DocumentNumber,this.IsAutoPost?(this.DocDefaultCCFields.Clear(),this.Document.ScreenObject._CCFields.filter((function(e){return e instanceof d.b})).forEach((function(t){var i=t;i.CCID>5e4&&!e.DocDefaultCCFields.ContainsKey(i.CCID)&&e.DocDefaultCCFields.push(i.CCID,i.SelectedValue)}))):(this.GridVisibility=!1,this.DocumentVisibility=!0),this.DocumentLinkDimensions.Clear(),this.strDimensionLinkQry="",this.Document.ScreenObject.Preferences.ContainsKey("DimensionWise")&&""!=this.Document.ScreenObject.Preferences.DimensionWise){var t=0;this.Document.ScreenObject.Preferences.DimensionWise.split(",").forEach((function(i){if((t=s.e.Int(i))>0&&t>5e4){e.strDimensionLinkQry+=",DCC.dcCCNID"+(t-5e4);var o=e.Document.ScreenObject._CCFields.find((function(e){return e instanceof d.b&&e.CCID==t}));o&&e.DocumentLinkDimensions.push(o)}}))}this.IsAutoPost?this.OnDocCallBack():this.LoadNextDocument("FIRST")}},{key:"LoadNextDocument",value:function(e){var t=this;if(this.iVendorCount>=this.lstVendors.length)return this.DocumentVisibility=!1,this.GridVisibility=!0,void(this.IsAutoPost&&this.postworker_Completed());if(this.DocumentLinkDimensions.length>0){var i=new Array;this.DocumentLinkDimensions.forEach((function(e){var o=t.Document.ScreenObject._CCFields.find((function(t){return t instanceof d.b&&t.CCID==e.CCID}));null!=o&&i.push(o)})),this.DocumentLinkDimensions=i}if("NEXT"==e&&this.Document.clear(1),this.iVendorCount<this.lstVendors.length){if(this.dvItems=this.lstPostDocsGroup.length>this.iVendorCount?this.lstPostDocsGroup[this.iVendorCount]:this.ReOrderGrid.Table.filter((function(e){return e.OrderQty>0})),0==this.dvItems.length)return this.iVendorCount++,void this.LoadNextDocument(this.IsAutoPost?"SAVE":"NEXT");this.lstVendors[this.iVendorCount].length>0&&(this.Document.ScreenObject.IsPurchase?(this.Document.ScreenObject.CreditAccount.SelectedValue=parseInt(this.lstVendors[this.iVendorCount]),this.Document.ScreenObject.OnGetReference(this.Document.ScreenObject.CreditAccount.Name)):(this.Document.ScreenObject.DebitAccount.SelectedValue=parseInt(this.lstVendors[this.iVendorCount]),this.Document.ScreenObject.OnGetReference(this.Document.ScreenObject.DebitAccount.Name)));for(var o=this.Document.GRIDTABLE.length;o<this.dvItems.length+5;o++){var n=this.Document.ScreenObject.GridDataObj.NewRow();this.Document.ScreenObject.GridDataObj.addRow(n)}if(this.ProductsByVoucher_Temp){var l=function(){var e="";t.dvItems.ToTable(!0,["ReorderDetailsID"]).forEach((function(t){e.length>0&&(e+=","),e+="'"+t.ReorderDetailsID.toString()+"'"}));var i="SELECT D.InvDocDetailsID,D.ProductID,D.CostCenterID,D.VoucherNo"+t.strDimensionLinkQry+" FROM INV_DocDetails D with(nolock)";t.strDimensionLinkQry.length>0&&(i+=" inner join com_docccdata DCC on DCC.InvDocDetailsID=D.InvDocDetailsID"),i+=" WHERE D.InvDocDetailsID IN ("+e+")";for(var o=r.a.report.ReportDataTable("RPT022",t.IsReportDB,i),n=0,l=new Array,a=new Array,u=function(i){var r=function(){var r=o.filter((function(o){return o.VoucherNo==e&&o.InvDocDetailsID==t.dvItems[i].ReorderDetailsID}));if(r.length>0){var u={};u.InvDocDetailsID=parseInt(r[0].InvDocDetailsID),n=parseInt(r[0].CostCenterID),l.push(u)}if(a.push(t.dvItems[i]),i==t.dvItems.length-1||t.dvItems[i+1].VoucherNo.toString()!=e){var d=null;return n>0&&null!=t.Document.ScreenObject.Link&&(d=t.Document.ScreenObject.Link.LinkCombo.Items.find((function(e){return e.Parent==n.toString()}))),null!=d?(t.strDimensionLinkQry.length>0&&r.length>0&&t.DocumentLinkDimensions.forEach((function(e){s.e.StringIsNullOrEmpty(r[0][e.DBColumnName])||(e.SelectedValue=parseInt(r[0][e.DBColumnName]))})),t.Document.FillLink(e,parseInt(d.Value),l,new Array),t.Document.RefreshGrid||(t.Document.RefreshGrid=!0),a.forEach((function(e){var i=t.Document.GRIDTABLE.filter((function(t){return t.LinkedInvDocDetailsID==e.ReorderDetailsID}));i.length>0&&(i[0][i[0].LinkedFieldName.toString()]=e.OrderQty)}))):a.forEach((function(e){t.AddProductToDocument(e)})),"break"}};for(l.Clear(),a.Clear(),n=0,e=t.dvItems[i].VoucherNo.toString(),t.dvItems[i].ReorderDetailsID.toString();i<t.dvItems.length;i++){if("break"===r())break}d=i},d=0;d<t.dvItems.length;d++)u(d);if(0==t.Document.GRIDTABLE.length||null==t.Document.GRIDTABLE[0].ProductID_Key)return{v:(t.iVendorCount++,void t.LoadNextDocument(t.IsAutoPost?"SAVE":"NEXT"))}}();if("object"==typeof l)return l.v}else this.dvItems.forEach((function(e){t.AddProductToDocument(e)}));this.iVendorCount++,this.IsAutoPost&&this.AutoSaveDocument()}}},{key:"AddProductToDocument",value:function(e){for(var t=this,i=!1,o=null,r=0;r<this.Document.ScreenObject.GridData.length;r++){var n=this.Document.ScreenObject.GridData[r];if(""==s.e.String(n.ProductID_Key)){o=n;break}}null==o&&(i=!0,o=this.Document.ScreenObject.GridDataObj.NewRow()),o.ProductCode=e.ProductCode.toString(),o.ProductName=e.ProductName.toString(),o.ProductID_Key=e.ProductName_Key.toString(),this.Document.AddProductData(o,!1,!1),o.Quantity=e.OrderQty,e.UOM_Key.toString()!=o.Unit_Key.toString()?(o.Unit=e.UOM.toString(),o.Unit_Key=e.UOM_Key.toString(),this.Document.OnProductUnitChange(o)):""!=o.Quantity.toString()&&""!=o.UOMConversion.toString()?o.UOMConvertedQty=parseFloat(o.UOMConversion.toString())*parseFloat(o.Quantity.toString()):""!=o.Quantity.toString()&&(o.UOMConvertedQty=o.Quantity.toString()),this.DocumentMappingColumns.length>0&&this.DocumentMappingColumns.forEach((function(i){if(i.SectionName.startsWith("dcCCNID"))if(t.Document.ScreenObject.GridDataColumns.Contains(i.SectionName))o[i.SectionName]=e[i.DisplayMember],o[i.SectionName+"_Key"]=e[i.DisplayMember+"_ID"];else{var r=t.Document.ScreenObject._CCFields.find((function(e){return e.DBColumnName==i.SectionName}));r instanceof d.b&&null!=e[i.DisplayMember+"_ID"]&&(r.SelectedValue=parseInt(e[i.DisplayMember+"_ID"]),r.IsAutoLoad&&(r.SelectedValueText=e[i.DisplayMember].toString()))}else if(t.Document.ScreenObject.GridDataColumns.Contains(i.SectionName))o[i.SectionName]=e[i.DisplayMember];else{var s=t.Document.ScreenObject._TextFields.find((function(e){return e.DBColumnName==i.SectionName}));if(null!=s)if(s instanceof f.d)s.Text=e[i.DisplayMember].toString();else if(s instanceof f.c)s.Text=e[i.DisplayMember].toString();else if(s instanceof O.a)s.TextBox.Text=e[i.DisplayMember].toString();else if(s instanceof p.a)try{s.Date=new Date(e[i.DisplayMember])}catch(n){}}})),i&&this.Document.ScreenObject.GridDataObj.addRow(o),this.Document.CalculateTotals(o,!1)}},{key:"SaveCallBack_Complete",value:function(){var e=this;if(this.IsAutoPost){if(this.postworkerCancel)return void(this.ShowAutoPost=!1);this.Document.RetValue<0&&(this.AutoPostGrid.Table[this.indPostIndex].ErrorMessage=this.Document.DisplayMessage),this.AutoPostGrid.Table[this.indPostIndex].Sno=this.indPostIndex+1,this.AutoPostGrid.invalidate(),this.indPostIndex++,this.LoadNextDocument("NEXT")}else this.iVendorCount<this.lstVendors.length?R.RibbonExtViewModel.GetDocumentObject(parseInt(this.Documents.SelectedValue),this.Documents.SelectedItem.Name,!1).then((function(t){e.Document=t,e.Document.GenratePrefix=!0,e.Document.SaveCallBack=new u.b,e.Document.SaveCallBack.Subscribe(e,"OnSaveCallBack"),e.LoadNextDocument("SAVE")})):(this.DocumentVisibility=!1,this.GridVisibility=!0)}},{key:"OnSaveCallBack",value:function(e,t){return this.IsAutoPost&&this.AutoPostGrid.Table.length>this.indPostIndex&&(this.AutoPostGrid.Table[this.indPostIndex].DocNo=this.Document.ScreenObject.VoucherNo),""}},{key:"AutoSaveDocument",value:function(){this.AutoPostGrid.Table.length>this.indPostIndex?this.Document.SaveInventoryDocument("Save",!1):(this.indPostIndex++,this.LoadNextDocument("NEXT"))}},{key:"OnLinkClick",value:function(e,t,i){"ProductCode"!=t&&"ProductName"!=t||null!=e.ProductName_Key&&R.RibbonExtViewModel.ShowAddProductScreenViewModel(parseInt(e.ProductName_Key),"EDIT",0,!1)}},{key:"OnGridBeginEdit",value:function(e,t,i){return"1"==s.e.String(e.StyleIsBold)}},{key:"GetDimensionFilter",value:function(e,t,i){var o="";return this.CostCenterFilters.forEach((function(r){if((r.SelectedNodes.length>0||!r.DeleteButtonVisibility&&i)&&r.CostCenterID>5e4&&t.Contains(r.CostCenterID.toString()))if(o+=" AND ",1==r.SelectedNodes.length)o+=e+(r.CostCenterID-5e4)+"="+r.SelectedNodes[0].Id;else{o+=e+(r.CostCenterID-5e4)+" IN (";for(var s=0;s<r.SelectedNodes.length;s++)s>0&&(o+=","),o+=r.SelectedNodes[s].Id;0==r.SelectedNodes.length&&(o+="-123"),o+=")"}})),o.toString()}},{key:"GetFilterNodes",value:function(e){var t="",i=this.CostCenterFilters.find((function(t){return t.CostCenterID==e}));if(i&&i.SelectedNodes.length>0)if(1==i.SelectedNodes.length)t+=i.SelectedNodes[0].Id;else for(var o=0;o<i.SelectedNodes.length;o++)i.SelectedNodes[o].IsGroup||(t.length>0&&(t+=","),t+=i.SelectedNodes[o].Id);return t.toString()}},{key:"FilterorClear",value:function(e){var t=this;this.MessageVisibility=!1;var i=!0,o="";if("PostFilterClear"!=e){for(var r=function(e){var r=t.PostDataFetchFilterFields[e];if("None"!=r.Condition.SelectedValue)if(i=!1,"DATE"==r.DataType)"Between"==r.Condition.SelectedValue||"NotBetween"==r.Condition.SelectedValue?("NotBetween"==r.Condition.SelectedValue&&(o+=" not ("),o+="["+r.ColumnName+"] >= '"+r.FromDate.Date+"' and  ["+r.ColumnName+"] <= '"+r.ToDate.Date+"' ","NotBetween"==r.Condition.SelectedValue&&(o+=" ) "),o+=" and "):o+="["+r.ColumnName+"]"+r.Condition.SelectedItem.Parent+" '"+r.FromDate.Date+"' and ";else if("Between"==r.Condition.SelectedValue||"NotBetween"==r.Condition.SelectedValue)"NotBetween"==r.Condition.SelectedValue&&(o+=" not ("),null!=r.FromValue.TextBox.Text&&""!=r.FromValue.TextBox.Text.Trim()&&(o+="["+r.ColumnName+"] >= '"+r.FromValue.TextBox.Text+"' "),null!=r.ToValue.Text&&""!=r.ToValue.Text.Trim()&&(null!=r.FromValue.TextBox.Text&&""!=r.FromValue.TextBox.Text.Trim()&&(o+=" and "),o+="["+r.ColumnName+"] <= '"+r.ToValue.Text+"' "),"NotBetween"==r.Condition.SelectedValue&&(o+=" ) "),o+=" and ";else if(r.FromDropDown.Visible)if(r.FromDropDown.Items[0].IsChecked)o+=" 1=1 and ";else{var s="";s+="(",r.FromDropDown.Items.forEach((function(e){e.IsChecked&&("Equal"==r.Condition.SelectedValue?(s.length>1&&(s+=" OR "),s+=""==e.Name?"(["+r.ColumnName+"] is null or ["+r.ColumnName+"]='')":"["+r.ColumnName+"]='"+e.Name+"'"):(s.length>1&&(s+=" and "),s+="[NULL]"==e.Name?"(["+r.ColumnName+"] is not null and ["+r.ColumnName+"]<>'')":"["+r.ColumnName+"]<>'"+e.Name+"'"))})),1==s.length&&(s+="1!=1"),o+=(s+=") and ").toString()}else null!=r.FromValue.TextBox.Text&&""!=r.FromValue.TextBox.Text.Trim()&&(o+="Contains"==r.Condition.SelectedValue||"NotContain"==r.Condition.SelectedValue?"["+r.ColumnName+"]"+r.Condition.SelectedItem.Parent+" '%"+r.FromValue.TextBox.Text+"%'  and ":"["+r.ColumnName+"]"+r.Condition.SelectedItem.Parent+" '"+r.FromValue.TextBox.Text+"' and ")},s=0;s<this.PostDataFetchFilterFields.length;s++)r(s);i&&(this.MessageVisibility=!0,this.DisplayMessage="Please choose at least one condition to filter")}if(""!=o&&o.length>4||"PostFilterClear"==e){if(null==this.ReOrderGrid.Table)return;"PostFilterClear"==e?(this.PostDataFetchFilterFields.forEach((function(e){e.Condition.SelectedValue="None",e.FromValue.TextBox.Text="",e.ToValue.Text=""})),this.ReOrderGrid.Table=this.ReportData):(this.PostFilterData=this.ReportData.Copy(),this.PostFilterData=l.a.FilterData(this.PostFilterData,this.PostDataFetchFilterFields),this.ReOrderGrid.Table=this.PostFilterData),this.ReOrderGrid.UpdateTotals(),this.ReOrderGrid.refreshDataView()}}},{key:"onColumnCheckedChanged",value:function(e){try{if(null!=e){var t=this.ColumnsSource.find((function(t){return t.DisplayMember==e.ColumnName}));if(t){t.IsVisible=!!e.ShowColumn;var i=new Array;this.ColumnsSource.forEach((function(e){i.push(e)})),this.ReOrderGrid.Columns=i,this.ReOrderGrid.RefreshColumns()}}}catch(o){Logger.ErrorLog("ReOrderLevelNewViewModel::Error onColumnCheckedChanged",o)}}},{key:"OnContextMenuClick",value:function(e){return Object(o.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var o,n,l,a,u,d,h,c,D;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e,l=this.ReOrderGrid.SelectedItem,a="",a+="<XML>","RowReport"==n.Name&&(this.ReportID=parseInt(n.attributes.ID.value),s.f.SelectNodes(n,"Filters/ColumnFilter").forEach((function(e){o=e.attributes.PID.value+"_ID",Object(T.isUndefined)(l[o])&&("ProductCode"!=e.attributes.PID.value&&"ProductName"!=e.attributes.PID.value||(o="ProductName_Key")),null!=l[o]&&(a+="<Row ColID='"+e.attributes.CID.value+"' Value='"+l[o].toString()+"'/>")}))),a+="</XML>",t.next=4,Promise.all([i.e(2),i.e(1),i.e(3),i.e(5),i.e(4),i.e(6),i.e(7),i.e(10),i.e(9),i.e(8),i.e(12),i.e(11),i.e(13),i.e(19),i.e(15),i.e(21),i.e(20),i.e(16),i.e(14),i.e(18),i.e(17),i.e(22),i.e(23),i.e(24),i.e(25),i.e(28),i.e(30),i.e(29),i.e(32),i.e(31),i.e(27),i.e(26),i.e(35),i.e(37),i.e(38),i.e(36),i.e(33),i.e(34),i.e(39),i.e(40),i.e(41),i.e(212)]).then(i.bind(null,"ThYU"));case 4:return u=t.sent,d=u.ReportViewModel,t.next=8,Promise.all([i.e(32),i.e(37)]).then(i.bind(null,"YU11"));case 8:h=t.sent,c=h.ReportViewComponent,(D=new d).ReportViewModel_Document(50,a.toString(),this.ReportID,!1,this,n),r.a.page.addNewTab({component:c,params:{obj:D}});case 12:case"end":return t.stop()}}),t,this)})))}},{key:"RefreshDateFilter",value:function(){this.DateFilter=this.FromDate.Date.ToString(r.a.SessionManager.Preferences["Date Format"]),this.DateFilter+="  to  "+this.ToDate.Date.ToString(r.a.SessionManager.Preferences["Date Format"]),this.ProfileName.length>0&&(this.DateFilter+=" ["+this.ProfileName+"]")}},{key:"GridVisibility",get:function(){return this._GridVisibility},set:function(e){var t=this;this._GridVisibility=e,this.BOMGrid&&this.BOMGrid.Visible&&setTimeout((function(){t.BOMGrid.refreshUI()}),200)}},{key:"Table",get:function(){return this.ReOrderGrid.Table}}]),g}(l.a)},"x+Dt":function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var o=i("Do2H"),r=i("Lp6j"),s=i("0/4Q"),n=i("Jnyl"),l=i("EQd/"),a=i("JIg3"),u=i("n56n"),d=i("wlFP"),h=function(){function e(){_classCallCheck(this,e),this.ShowColumnObj=new d.a,this.CheckBoxVisibility=!1,this.ReOrder=null,this.LstFilter=null,this.ReportViewModel=null,this.LockCheckedChanged=!1}return _createClass(e,[{key:"PostDataField_1",value:function(e,t){"ReportViewModel"==t.ClassName?this.ReportViewModel=t:"ReOrderLevelNewViewModel"==t.ClassName?this.ReOrder=t:"FilterDialogViewModel"==t.ClassName&&(this.LstFilter=t),this.ShowColumnObj.CheckedChangedCommand.Subscribe(t,"onColumnCheckedChanged",this),this.DataType=e.ColumnType,this.ColumnName=e.ID,this.Header=e.HeaderText,this.ShowColumn=!0,this.CheckBoxVisibility=!0,this.Condition=new s.e(0),this.FromValue=new n.a(0),this.ToValue=new l.d(0),this.FromDate=new a.a(0),this.ToDate=new a.a(0),this.FromDropDown=new s.b,this.FromList=new u.b(0),this.ToList=new u.b(0),this.Condition.LblWidth="80",this.FromValue.LblWidth=this.FromValue.TextBox.LblWidth="80",this.ToValue.LblWidth="80",this.FromDate.LblWidth="80",this.ToDate.LblWidth="80",this.FromDropDown.LblWidth="80",this.FromList.LblWidth="80",this.ToList.LblWidth="80",this.Condition.Label=o.a.GetResource("Reports_Condition"),this.FromValue.Label=this.FromValue.TextBox.Label=o.a.GetResource("Reports_FromValue"),this.ToValue.Label=o.a.GetResource("Reports_ToValue"),this.FromDate.Label=o.a.GetResource("Reports_FromValue"),this.ToDate.Label=o.a.GetResource("Reports_ToValue"),this.LoadConditions(this.DataType),this.Condition.SelectionChangedCommand.Subscribe(this,"OnConditionChange"),this.FromDropDown.CheckedChangedCommand.Subscribe(this,"OnCheckedChanged"),this.FromValue.Visible=!1,this.ToValue.Visible=!1,this.FromDate.Visible=!1,this.ToDate.Visible=!1,this.FromDropDown.Visible=!1,this.FromList.Visible=!1,this.ToList.Visible=!1,"INT"!=this.DataType&&"DATE"!=this.DataType&&"FLOAT"!=this.DataType&&(this.FromDropDown.DataType="TEXT")}},{key:"PostDataField_2",value:function(e){this.DataType=e.CDGDO.DataType,this.ColumnName=e.CDGDO.CategoryText,this.Header=e.Caption.Text,this.ShowColumn=!0,this.CheckBoxVisibility=!1,this.FromDropDown=new s.b,this.FromDropDown.Visible=!1,this.Condition=e.Condition,this.FromValue=e.FromValue,this.ToValue=e.ToValue,this.FromDate=e.FromDatePicker,this.ToDate=e.ToDatePicker,this.FromList=e.FromList,this.ToList=e.ToList,e.OnConditionSelectionChanged(this.Condition.SelectedValue)}},{key:"OnConditionChange",value:function(e){var t,i=this;if(null==(null===(t=this.ReportViewModel)||void 0===t?void 0:t.DocsLanding))if(this.FromDropDown.Label=this.FromDate.Label=this.FromValue.Label=this.FromValue.TextBox.Label=o.a.GetResource("Service_Value"),this.FromValue.Visible=!1,this.ToValue.Visible=!1,this.FromDate.Visible=!1,this.ToDate.Visible=!1,this.FromDropDown.Visible=!1,"DATE"==this.DataType)"Between"==this.Condition.SelectedValue||"NotBetween"==this.Condition.SelectedValue?(this.FromDate.Visible=!0,this.ToDate.Visible=!0,this.FromDate.Label=o.a.GetResource("Reports_FromValue")):"None"!=this.Condition.SelectedValue&&(this.FromDate.Visible=!0);else if("Between"==this.Condition.SelectedValue||"NotBetween"==this.Condition.SelectedValue)this.FromValue.Visible=!0,this.ToValue.Visible=!0,this.FromValue.TextBox.Label=o.a.GetResource("Reports_FromValue");else if("Equal"==this.Condition.SelectedValue||"NotEqual"==this.Condition.SelectedValue)if("TEXT"==this.FromDropDown.DataType){if(this.FromDropDown.Visible=!0,0==this.FromDropDown.Items.length)if(this.FromDropDown.Items.push(s.c.CheckedListBoxItem_2("ALL",!0)),this.FromDropDown.SelectedValue="ALL",null!=this.ReportViewModel&&null!=this.ReportViewModel.ReportData){if(this.ReportViewModel.ReportDataColumns.Contains(this.ColumnName))(null!=this.ReportViewModel.PostFilterData?this.ReportViewModel.PostFilterData.ToTable(!0,[this.ColumnName]):this.ReportViewModel.ReportData.ToTable(!0,[this.ColumnName])).forEach((function(e){i.FromDropDown.Items.push(s.c.CheckedListBoxItem_2(r.e.String(e[i.ColumnName]),!0))}))}else if(null!=this.ReportViewModel)for(var n=function(e){if(i.ReportViewModel.ReportColumns[e].ID==i.ColumnName){var t=[];return i.ReportViewModel.Data.forEach((function(o){null!=o.Cells[e].Text&&(t.Contains(o.Cells[e].Text)||(t.push(o.Cells[e].Text),i.FromDropDown.Items.push(s.c.CheckedListBoxItem_2(o.Cells[e].Text,!0))))})),"break"}},l=0;l<this.ReportViewModel.ReportColumns.length;l++){if("break"===n(l))break}else null!=this.ReOrder&&null!=this.ReOrder.ReOrderGrid.Table&&this.ReOrder.ReOrderGrid.Table.Columns.Contains(this.ColumnName)&&this.ReOrder.ReOrderGrid.Table.DefaultView.ToTable(!0,[this.ColumnName]).forEach((function(e){i.FromDropDown.Items.push(s.c.CheckedListBoxItem_2(r.e.String(e[i.ColumnName]),!0))}))}else this.FromValue.Visible=!0;else"None"!=this.Condition.SelectedValue&&(this.FromValue.Visible=!0);else this.OnConditionChange_DocumentsList(e)}},{key:"OnConditionChange_DocumentsList",value:function(e){this.FromDropDown.Label=this.FromList.Label=this.FromDate.Label=this.FromValue.Label=this.FromValue.TextBox.Label=o.a.GetResource("Service_Value"),this.FromValue.Visible=!1,this.ToValue.Visible=!1,this.FromDate.Visible=!1,this.ToDate.Visible=!1,this.FromDropDown.Visible=!1,this.FromList.Visible=!1,"DATE"==this.DataType?"Between"==this.Condition.SelectedValue||"NotBetween"==this.Condition.SelectedValue?(this.FromDate.Visible=!0,this.ToDate.Visible=!0,this.FromDate.Label=o.a.GetResource("Reports_FromValue")):"None"!=this.Condition.SelectedValue&&(this.FromDate.Visible=!0):"Between"==this.Condition.SelectedValue||"NotBetween"==this.Condition.SelectedValue?(this.FromValue.Visible=!0,this.ToValue.Visible=!0,this.FromValue.TextBox.Label=o.a.GetResource("Reports_FromValue")):"Equal"==this.Condition.SelectedValue||"NotEqual"==this.Condition.SelectedValue?"TEXT"==this.FromDropDown.DataType?this.FromList.Visible=!0:this.FromValue.Visible=!0:"None"!=this.Condition.SelectedValue&&(this.FromValue.Visible=!0)}},{key:"LoadConditions",value:function(e){this.Condition.Items.Clear(),"INT"==e||"FLOAT"==e||"Float"==e||"Date"==e||"DATE"==e?(this.Condition.Items.push(s.d.ComboBoxItems_3(o.a.GetResource("Reports_None"),"None","")),this.Condition.Items.push(s.d.ComboBoxItems_3(o.a.GetResource("Reports_Between"),"Between"," BETWEEN ")),this.Condition.Items.push(s.d.ComboBoxItems_3(o.a.GetResource("Reports_NotBetween"),"NotBetween"," NOT BETWEEN ")),this.Condition.Items.push(s.d.ComboBoxItems_3(o.a.GetResource("Reports_Equal"),"Equal","=")),this.Condition.Items.push(s.d.ComboBoxItems_3(o.a.GetResource("Reports_NotEqual"),"NotEqual","<>")),this.Condition.Items.push(s.d.ComboBoxItems_3(o.a.GetResource("Reports_Lessthan"),"Lessthan","<")),this.Condition.Items.push(s.d.ComboBoxItems_3(o.a.GetResource("Reports_LessthanOrEqual"),"LessthanOrEqual","<=")),this.Condition.Items.push(s.d.ComboBoxItems_3(o.a.GetResource("Reports_Greaterthan"),"Greaterthan",">")),this.Condition.Items.push(s.d.ComboBoxItems_3(o.a.GetResource("Reports_GreaterthanOrEqual"),"Greaterthan Or Equal",">=")),this.Condition.SelectedValue="None"):(this.Condition.Items.push(s.d.ComboBoxItems_3(o.a.GetResource("Reports_None"),"None","")),this.Condition.Items.push(s.d.ComboBoxItems_3(o.a.GetResource("Reports_Between"),"Between"," BETWEEN ")),this.Condition.Items.push(s.d.ComboBoxItems_3(o.a.GetResource("Reports_NotBetween"),"NotBetween"," NOT BETWEEN ")),this.Condition.Items.push(s.d.ComboBoxItems_3(o.a.GetResource("Com_Contains"),"Contains"," LIKE ")),this.Condition.Items.push(s.d.ComboBoxItems_3(o.a.GetResource("Reports_NotContain"),"NotContain"," NOT LIKE ")),this.Condition.Items.push(s.d.ComboBoxItems_3(o.a.GetResource("Reports_Equal"),"Equal","=")),this.Condition.Items.push(s.d.ComboBoxItems_3(o.a.GetResource("Reports_NotEqual"),"NotEqual","<>")),this.Condition.Items.push(s.d.ComboBoxItems_3(o.a.GetResource("Com_BeginsWith"),"BeginsWith","BeginsWith")),this.Condition.Items.push(s.d.ComboBoxItems_3(o.a.GetResource("Com_EndsWith"),"EndsWith","EndsWith")),this.Condition.SelectedValue="None")}},{key:"OnCheckedChanged",value:function(e){if(!this.LockCheckedChanged&&e.item instanceof s.c){var t=e.item;if("ALL"==t.Value){if(this.LockCheckedChanged=!0,this.FromDropDown.Items.length>0)for(var i=1;i<this.FromDropDown.Items.length;i++)this.FromDropDown.Items[i].IsChecked=t.IsChecked;this.LockCheckedChanged=!1}else{if(this.LockCheckedChanged=!0,this.FromDropDown.Items.length>0)if(t.IsChecked){this.FromDropDown.Items[0].IsChecked=!0;for(var o=1;o<this.FromDropDown.Items.length;o++)if(!this.FromDropDown.Items[o].IsChecked){this.FromDropDown.Items[0].IsChecked=!1;break}}else this.FromDropDown.Items[0].IsChecked=!1;this.LockCheckedChanged=!1}this.LockCheckedChanged=!1}}},{key:"Clear",value:function(){this.Condition.SelectedValue="None",this.FromValue.TextBox.Text="",this.ToValue.Text="",this.FromDropDown.Items.Clear()}},{key:"ShowColumn",get:function(){return this.ShowColumnObj.IsChecked},set:function(e){this.ShowColumnObj.IsChecked=e}}]),e}()}}]);