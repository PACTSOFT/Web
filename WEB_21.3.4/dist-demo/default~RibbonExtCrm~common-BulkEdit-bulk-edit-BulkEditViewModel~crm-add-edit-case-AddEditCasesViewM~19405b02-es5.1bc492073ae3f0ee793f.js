function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var s,i=_getPrototypeOf(e);if(t){var a=_getPrototypeOf(this).constructor;s=Reflect.construct(i,arguments,a)}else s=i.apply(this,arguments);return _possibleConstructorReturn(this,s)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,s){return t&&_defineProperties(e.prototype,t),s&&_defineProperties(e,s),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[35,109],{"/aGy":function(e,t,s){"use strict";s.d(t,"a",(function(){return p}));var i=s("3Pt+"),a=s("fXoL"),n=s("sYmb");function o(e,t){if(1&e&&(a.Zb(0,"div",15),a.Wc(1,"\n                    "),a.Vb(2,16),a.Wc(3,"\n                "),a.Yb()),2&e){var s=a.lc();a.Db(2),a.tc("obj",s.obj.Mode)("group",s.form)}}function r(e,t){if(1&e&&(a.Zb(0,"div",15),a.Wc(1,"\n                    "),a.Vb(2,16),a.Wc(3,"\n                "),a.Yb()),2&e){var s=a.lc();a.Db(2),a.tc("obj",s.obj.Customer)("group",s.form)}}function l(e,t){if(1&e&&(a.Zb(0,"div",15),a.Wc(1,"\n                    "),a.Vb(2,16),a.Wc(3,"\n                "),a.Yb()),2&e){var s=a.lc();a.Db(2),a.tc("obj",s.obj.Contracts)("group",s.form)}}function u(e,t){if(1&e&&(a.Zb(0,"div",15),a.Wc(1,"\n                    "),a.Vb(2,16),a.Wc(3,"\n                "),a.Yb()),2&e){var s=a.lc();a.Db(2),a.tc("obj",s.obj.Product)("group",s.form)}}function c(e,t){if(1&e&&(a.Zb(0,"div",15),a.Wc(1,"\n                    "),a.Vb(2,16),a.Wc(3,"\n                "),a.Yb()),2&e){var s=a.lc();a.Db(2),a.tc("obj",s.obj.SerailNo)("group",s.form)}}function d(e,t){if(1&e&&(a.Zb(0,"div",15),a.Wc(1,"\n                    "),a.Vb(2,16),a.Wc(3,"\n                "),a.Yb()),2&e){var s=a.lc();a.Db(2),a.tc("obj",s.obj.BomCode)("group",s.form)}}function C(e,t){if(1&e&&(a.Zb(0,"div",15),a.Wc(1,"\n                    "),a.Vb(2,16),a.Wc(3,"\n                "),a.Yb()),2&e){var s=a.lc();a.Db(2),a.tc("obj",s.obj.BomName)("group",s.form)}}function m(e,t){if(1&e&&a.Vb(0,16),2&e){var s=a.lc(2).$implicit,i=a.lc();a.tc("obj",s.CC)("group",i.form)}}function h(e,t){if(1&e&&a.Vb(0,16),2&e){var s=a.lc(3).$implicit,i=a.lc();a.tc("obj",s.Condition)("group",i.form)}}function b(e,t){if(1&e&&a.Vb(0,16),2&e){var s=a.lc(3).$implicit,i=a.lc();a.tc("obj",s.FromValue)("group",i.form)}}function S(e,t){if(1&e&&(a.Zb(0,"div"),a.Wc(1,"\n                            "),a.Zb(2,"label",20),a.Wc(3),a.Yb(),a.Wc(4,"\n                            "),a.Zb(5,"div",2),a.Wc(6,"\n                                "),a.Zb(7,"div",21),a.Wc(8,"\n                                    "),a.Uc(9,h,1,2,"ng-container",18),a.Wc(10,"\n                                "),a.Yb(),a.Wc(11,"\n                                "),a.Zb(12,"div",22),a.Wc(13,"\n                                    "),a.Uc(14,b,1,2,"ng-container",18),a.Wc(15,"\n                                "),a.Yb(),a.Wc(16,"\n                            "),a.Yb(),a.Wc(17,"                           \n                        "),a.Yb()),2&e){var s=a.lc(2).$implicit;a.Db(3),a.Yc("",s.Header," "),a.Db(6),a.tc("ngIf",s.Condition.Visible),a.Db(5),a.tc("ngIf",s.FromValue.Visible)}}function D(e,t){if(1&e&&(a.Zb(0,"div",15),a.Wc(1,"\n                        "),a.Uc(2,m,1,2,"ng-container",18),a.Wc(3,"\n                        "),a.Uc(4,S,18,3,"div",19),a.Wc(5,"                          \n                    "),a.Yb()),2&e){var s=a.lc().$implicit;a.Db(2),a.tc("ngIf",s.CC.Visible),a.Db(2),a.tc("ngIf",!s.CC.Visible)}}function g(e,t){if(1&e&&(a.Xb(0),a.Wc(1,"\n                    "),a.Uc(2,D,6,2,"div",17),a.Wc(3,"\n                "),a.Wb()),2&e){var s=t.$implicit;a.Db(2),a.tc("ngIf",s.Visible)}}var p=function(){var e=function(){function e(t){_classCallCheck(this,e),this.translate=t,this.form=new i.j({})}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}();return e.\u0275fac=function(t){return new(t||e)(a.Tb(n.e))},e.\u0275cmp=a.Nb({type:e,selectors:[["app-case-search"]],decls:62,vars:22,consts:[[1,"master-screen",2,"padding-bottom","4px","width","1000px"],[1,"PACTHeaderFields","dialogSubBody"],[2,"display","flex"],[1,"row","form-row",2,"display","block","flex-direction","column","width","300px"],["class","form-group col-xl-12 col-md-12 col-sm-12 col-xs-12 PACTControl",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"btnMetroDiv","secondary-btn-group",2,"margin","auto","text-align","center"],[1,"secondary-btn-wicon",3,"click"],[1,"fa-light","fa-check"],[1,"fa-light","fa-times"],[2,"flex-direction","column","width","700px","margin-left","10px","padding-left","15px","border-left","solid 1px gray"],[1,"documentgrid","row","form-row",2,"width","100%"],[2,"width","100%",3,"obj","group"],[1,"Pactdailogfooter"],[1,"primary-btn-wicon",3,"click"],[1,"form-group","col-xl-12","col-md-12","col-sm-12","col-xs-12","PACTControl"],["FieldDirective","",3,"obj","group"],["class","form-group col-xl-12  col-md-12 col-sm-12 col-xs-12 PACTControl",4,"ngIf"],["FieldDirective","",3,"obj","group",4,"ngIf"],[4,"ngIf"],[1,"input_cntrl_label"],[2,"display","block","flex-direction","column","width","90px"],[2,"display","block","flex-direction","column"]],template:function(e,t){1&e&&(a.Zb(0,"div",0),a.Wc(1,"\n    "),a.Zb(2,"div",1),a.Wc(3,"\n        "),a.Zb(4,"div",2),a.Wc(5,"\n            "),a.Zb(6,"div",3),a.Wc(7,"\n                "),a.Uc(8,o,4,2,"div",4),a.Wc(9,"\n                "),a.Uc(10,r,4,2,"div",4),a.Wc(11,"\n                "),a.Uc(12,l,4,2,"div",4),a.Wc(13,"\n                "),a.Uc(14,u,4,2,"div",4),a.Wc(15,"\n                "),a.Uc(16,c,4,2,"div",4),a.Wc(17,"\n                "),a.Uc(18,d,4,2,"div",4),a.Wc(19,"\n                "),a.Uc(20,C,4,2,"div",4),a.Wc(21,"              \n                "),a.Uc(22,g,4,1,"ng-container",5),a.Wc(23,"\n                \n                "),a.Zb(24,"div",6),a.Wc(25,"\n                    "),a.Zb(26,"span",7),a.hc("click",(function(){return t.obj.onSave("Filter")})),a.Ub(27,"i",8),a.Wc(28),a.mc(29,"translate"),a.Yb(),a.Wc(30,"\n                    "),a.Zb(31,"span",7),a.hc("click",(function(){return t.obj.onSave("Clear")})),a.Ub(32,"i",9),a.Wc(33),a.mc(34,"translate"),a.Yb(),a.Wc(35,"\n                "),a.Yb(),a.Wc(36,"\n            "),a.Yb(),a.Wc(37,"\n\n            "),a.Zb(38,"div",10),a.Wc(39,"\n                "),a.Zb(40,"div",11),a.Wc(41,"\n                    "),a.Ub(42,"app-PactGridView",12),a.Wc(43,"\n                "),a.Yb(),a.Wc(44,"                               \n            "),a.Yb(),a.Wc(45,"\n        "),a.Yb(),a.Wc(46,"\n    "),a.Yb(),a.Wc(47,"\n    "),a.Zb(48,"div",13),a.Wc(49,"\n        "),a.Zb(50,"div"),a.Wc(51,"\n            "),a.Zb(52,"button",14),a.hc("click",(function(){return t.obj.onSave("OK")})),a.Wc(53),a.mc(54,"translate"),a.Yb(),a.Wc(55,"\n            "),a.Zb(56,"button",7),a.hc("click",(function(){return t.obj.onSave("Close")})),a.Wc(57),a.mc(58,"translate"),a.Yb(),a.Wc(59,"\n        "),a.Yb(),a.Wc(60,"\n    "),a.Yb(),a.Wc(61,"\n"),a.Yb()),2&e&&(a.Db(8),a.tc("ngIf",t.obj.Mode.Visible),a.Db(2),a.tc("ngIf",t.obj.Customer.Visible),a.Db(2),a.tc("ngIf",t.obj.Contracts.Visible),a.Db(2),a.tc("ngIf",t.obj.Product.Visible),a.Db(2),a.tc("ngIf",t.obj.SerailNo.Visible),a.Db(2),a.tc("ngIf",t.obj.BomCode.Visible),a.Db(2),a.tc("ngIf",t.obj.BomName.Visible),a.Db(2),a.tc("ngForOf",t.obj.ProductFields),a.Db(6),a.Xc(a.nc(29,14,"Filter")),a.Db(5),a.Xc(a.nc(34,16,"Clear")),a.Db(9),a.tc("obj",t.obj.GridDataObj)("group",t.form),a.Db(11),a.Xc(a.nc(54,18,"Ok")),a.Db(4),a.Xc(a.nc(58,20,"Close")))},encapsulation:2}),e}()},"2Dtv":function(e,t,s){"use strict";s.r(t),s.d(t,"AssignFeatureViewModel",(function(){return m}));var i=s("Do2H"),a=s("Lp6j"),n=s("JIg3"),o=s("0/4Q"),r=s("ScVY"),l=s("EQd/"),u=s("DKUf"),c=s("CQvG"),d=s("m+Ff"),C=s("F+4J"),m=function(e){_inherits(s,e);var t=_createSuper(s);function s(){var e;return _classCallCheck(this,s),(e=t.call(this)).LabelVisibility=!1,e.DetailButtonVisibility=!0,e.TeamVisible=!0,e.AssignDate=new n.a(0),e.RolesItemsObj=new o.b,e.UsersItemsObj=new o.b,e.GroupsItemsObj=new o.b,e.TypeOfAssigning=new o.e(0),e.Teams=new o.e(0),e.AssignUser=new o.e(0),e.InviteComments=new l.c(0),e.SelectedNode=new o.b,e.objTeam=new C.a,e.dtUsers=[],e._CCNodeID=0,e._CCID=0,e._ActivityID=0,e.Ret=0,e.userexists=!1,e.AssignXML="",e.Roles="",e.Users="",e.Grps="",e}return _createClass(s,[{key:"AssignFeatureViewModel_1",value:function(e,t,s){this._CCNodeID=t,this.SelectedNode.Visible=!1,this._CCID=s,this.Parent=e,this.Parent instanceof d.RCalenderViewModel||this.Parent instanceof u.a?(this.InviteComments.Visible=!0,this.InviteComments.Label="Comments"):this.InviteComments.Visible=!1,this.onLoadScreen(e)}},{key:"AssignFeatureViewModel_2",value:function(e,t,s){this.SelectedNode.Items=t,this.SelectedNode.Visible=!0,this._CCID=s,this.Parent instanceof d.RCalenderViewModel?(this.InviteComments.Visible=!0,this.InviteComments.Label="Comments"):this.InviteComments.Visible=!1,this.Parent=e,this.onLoadScreen(e)}},{key:"onLoadScreen",value:function(e){this.Title=i.a.GetResource("CRMTeam_Assign"),this.TypeOfAssigning.SelectionChangedCommand.Subscribe(this,"OnTypeChange"),this.Teams.SelectionChangedCommand.Subscribe(this,"OnChange"),this.RolesItemsObj.CheckedChangedCommand.Subscribe(this,"OnCheckedChanged"),this.UsersItemsObj.CheckedChangedCommand.Subscribe(this,"OnCheckedChanged"),this.GroupsItemsObj.CheckedChangedCommand.Subscribe(this,"OnCheckedChanged"),this.TypeOfAssigning.Label="Type",this.OnLoad(),this.Teams.Label=i.a.GetResource("CRMTeam_Title"),this.AssignDate.Label=i.a.GetResource("CRMTeam_AssignDate"),this.AssignUser.Label=i.a.GetResource("CRMTeam_AssignTo"),this.AssignDate.Text=Date.Today().ToString(i.a.SessionManager.Preferences["Date Format"].toString()),this.RolesItems.Visible=!1,this.UsersItems.Visible=!1,this.GroupsItems.Visible=!1;try{if(this._CCNodeID>0&&(this.dset=this.objTeam.GetAssignedDetails(this._CCID,this._CCNodeID,0),null!=this.dset&&this.dset.Tables.length>0)){if(this.dset.Tables[0].length>0){this.TypeOfAssigning.Items.push(o.d.ComboBoxItems_2("Team","1"));for(var t=0;t<this.dset.Tables[0].length;t++)this.Teams.Items.push(o.d.ComboBoxItems_2(this.dset.Tables[0][t].TeamName.toString(),this.dset.Tables[0][t].TeamID.toString()))}this.dset.Tables.length>1&&(this.dtUsers=this.dset.Tables[1]),this.dset.Tables.length>3&&this.dset.Columns[3].Contains("Company")&&this.dset.Tables[3].length>0&&(this.CompanyName=a.e.String(this.dset.Tables[3][0][this.dset.Columns[3][0]])),this.LabelVisibility=!1;var s=0;if(this.dset.Tables.length>4&&this.dset.Columns[4].Contains("UserName")&&this.dset.Tables[4].length>0&&(s=this.dset.Tables[4].filter((function(e){return e.UserName!=i.a.SessionManager.UserName})).length),!(e instanceof c.b)&&this.dset.Tables.length>2&&this.dset.Columns[2].Contains("CCID")&&this.dset.Tables[2].length>0){var n=this.dset.Tables[2].filter((function(e){return e.UserID>1&&0==e.TeamNodeID}));if(n.length>0)for(var r=0;r<n.length;r++)for(var l=0;l<this.UsersItems.Items.length;l++)if(this.UsersItems.Items[l].Value==n[r].UserID.toString()){0==s&&(this.UsersItems.Items[l].Enable=!1),this.UsersItems.Items[l].IsChecked=!0,this.userexists||(this.userexists=!0);break}if((n=this.dset.Tables[2].filter((function(e){return 1==e.IsGroup}))).length>0)for(var u=0;u<n.length;u++)for(var d=0;d<this.GroupsItems.Items.length;d++)if(this.GroupsItems.Items[d].Value==n[u].TeamNodeID.toString()){this.GroupsItems.Items[d].IsChecked=!0,this.userexists||(this.userexists=!0);break}if((n=this.dset.Tables[2].filter((function(e){return 1==e.IsRole}))).length>0)for(var C=0;C<n.length;C++)for(var m=0;m<this.RolesItems.Items.length;m++)if(this.RolesItems.Items[m].Value==n[C].TeamNodeID.toString()){this.RolesItems.Items[m].IsChecked=!0,this.userexists||(this.userexists=!0);break}(n=this.dset.Tables[2].filter((function(e){return e.TeamNodeID>1&&1==e.IsTeam}))).length>0&&(this.Teams.SelectedValue=n[0].TeamNodeID.toString()),(n=this.dset.Tables[2].filter((function(e){return e.TeamNodeID>1&&e.UserID>0}))).length>0&&(this.Teams.SelectedValue=n[0].TeamNodeID.toString(),this.AssignUser.SelectedValue=n[0].UserID.toString())}}}catch(h){throw Logger.ErrorLog("AssignFeatureViewModel::error ",h),h}}},{key:"OnCheckedChanged",value:function(e){var t=e.item;if("0"==(t=e.item).Value){if(this.RolesItems.Items.Contains(t))for(var s=0;s<this.RolesItems.Items.length;s++)this.RolesItems.Items[s].IsChecked=t.IsChecked;if(this.UsersItems.Items.Contains(t))for(var i=0;i<this.UsersItems.Items.length;i++)this.UsersItems.Items[i].IsChecked=t.IsChecked;if(this.GroupsItems.Items.Contains(t))for(var a=0;a<this.GroupsItems.Items.length;a++)this.GroupsItems.Items[a].IsChecked=t.IsChecked}else t.IsChecked||(this.RolesItems.Items.Contains(t)&&(this.RolesItems[0].IsChecked=!1),this.UsersItems.Items.Contains(t)&&(this.UsersItems[0].IsChecked=!1),this.GroupsItems.Items.Contains(t)&&(this.GroupsItems[0].IsChecked=!1))}},{key:"OnLoad",value:function(){var e=i.a.common.GetWorkFlowScreenDetails(!0);if(null!=e){if(e.Tables.length>1){e.Tables[1].length>0&&this.TypeOfAssigning.Items.push(o.d.ComboBoxItems_2("Users","2")),this.UsersItems.Items.push(o.c.CheckedListBoxItem_3("All","0"));for(var t=0;t<e.Tables[1].length;t++)this.UsersItems.Items.push(o.c.CheckedListBoxItem_3(e.Tables[1][t].UserName.toString(),e.Tables[1][t].UserID.toString()))}if(e.Tables.length>0){e.Tables[0].length>0&&this.TypeOfAssigning.Items.push(o.d.ComboBoxItems_2("Roles","3")),this.RolesItems.Items.push(o.c.CheckedListBoxItem_3("All","0"));for(var s=0;s<e.Tables[0].length;s++)this.RolesItems.Items.push(o.c.CheckedListBoxItem_3(e.Tables[0][s].Name.toString(),e.Tables[0][s].RoleID.toString()))}if(e.Tables.length>2){e.Tables[2].length>0&&this.TypeOfAssigning.Items.push(o.d.ComboBoxItems_2("Group","4")),this.GroupsItems.Items.push(o.c.CheckedListBoxItem_3("All","0"));for(var a=0;a<e.Tables[2].length;a++)this.GroupsItems.Items.push(o.c.CheckedListBoxItem_3(e.Tables[2][a].GroupName.toString(),e.Tables[2][a].GroupID.toString()))}}}},{key:"OnSave",value:function(e){if("Cancel"==e.toString())i.a.page.HideDialog(),this.Parent instanceof c.b?this.Parent.Activities.AssignVisiblity=!1:this.Parent instanceof d.RCalenderViewModel?(this.Parent.Activities.IsPopup||(this.Parent.ActVisibility=!0),this.Parent.AssignVisiblity=!1):this.Parent instanceof u.a||"AddEditLeads"==this.Parent.ClassName?("AddEditLeads"==this.Parent.ClassName&&this.Parent.IsAssign&&(this.Parent.Status.SelectedValue="419"),i.a.page.HideDialog()):this.Parent.AssignVisiblity=!1;else if("Search_Roles"==e.toString());else if("Search_Users"==e.toString());else if("Search_Groups"==e.toString());else if("0"==this.TypeOfAssigning.SelectedValue||null==this.TypeOfAssigning.SelectedValue)this.DisplayMessage="Please select type to assign";else{if(this.userexists&&73==this._CCID&&!confirm("Open Activities will trasfer to Assigned users, Are you sure you want to continue?"))return;if(this.Users="",this.Roles="",this.Grps="",null!=this.Parent&&this.Parent instanceof c.b){var t=this.Parent.SelectedRow;if(null!=t){if(this.GetNodeNames(),!a.e.StringIsNullOrEmpty(this.DisplayMessage))return void(this.MessageVisibility=!0);t.UsersXML=this.Users,t.RolesXML=this.Roles,t.isEdited="1",t.GroupXML=this.Grps,t.TeamNodeID=parseInt(this.Teams.SelectedValue),"0"!=this.AssignUser.SelectedValue&&null!=this.AssignUser.SelectedValue?(t.UserID=parseInt(this.AssignUser.SelectedValue),t.isTeam="0"):(t.UserID="0",t.isTeam="1"),this.Parent.ActivityGridDataObj.updateRow(t),i.a.page.HideDialog()}return}if(this.objTeam.FetaureID=this._CCID,this.SelectedNode.Visible){var s="";this.SelectedNode.Items.filter((function(e){return e.IsChecked&&e.Value})).forEach((function(e){s+='<Row NodeID="'+e.toString()+'" ></Row>'})),s.length>0&&(s="<XML>"+s+"</XML>",this.objTeam.NodesXML=s.toString())}else this.objTeam.FeatureNodeID=this._CCNodeID;if(this.GetNodeNames(),!a.e.StringIsNullOrEmpty(this.DisplayMessage))return void(this.MessageVisibility=!0);if(this.objTeam.UsersXML=this.Users,this.objTeam.RolesXML=this.Roles,this.objTeam.GroupXML=this.Grps,this.objTeam.TeamNodeID=parseInt(this.Teams.SelectedValue),"0"!=this.AssignUser.SelectedValue&&null!=this.AssignUser.SelectedValue?(this.objTeam.UserID=parseInt(this.AssignUser.SelectedValue),this.objTeam.isTeam=0):(this.objTeam.UserID=0,this.objTeam.isTeam=1),this.Parent instanceof d.RCalenderViewModel||this.Parent instanceof u.a){this.objTeam.InviteComments=null!=this.InviteComments.Text?this.InviteComments.Text:"";var n=this.objTeam.SetInvite();this.Ret=n.RetValue,this.DisplayMessage=n.Message,this.Ret>0?(this.MessageVisibility=!0,this.Parent instanceof d.RCalenderViewModel&&(this.Parent.ActVisibility=!0,this.Parent.AssignVisiblity=!1),Logger.InfoLog("AssignFeatureViewModel :: Exiting OnSave set invite error ")):this.MessageVisibility=!0}else if(null!=this.Parent&&"PACT.VIEWMODEL.ViewEventsViewModel"==this.Parent.toString()){var o=this.Parent.ActivityData.Rows.indexOf(this.Parent.SelectedRow.Row),r=this.Parent.ActivityGridData.filter(this.Parent.FilterStatus)[o];r.UsersXML=this.Users,r.RolesXML=this.Roles,r.GroupXML=this.Grps,this.Parent.ActivityGridData.AcceptChanges(),this.objTeam.FetaureID=128,this.objTeam.ActivityID=this._ActivityID;var l=this.objTeam.ActivityAssign();this.Ret=l.RetValue,this.DisplayMessage=l.Message}else if(this.SelectedNode.Visible){var C=this.objTeam.AssignMultipleFeature();this.Ret=C.RetValue,this.DisplayMessage=C.Message}else{if(0==this._CCNodeID){var m="";return m+="<XML>",m+="<Row TeamNodeID='"+this.objTeam.TeamNodeID+"'",m+=" UserID='"+this.objTeam.UserID+"'",m+=" isTeam='"+this.objTeam.isTeam+"'",m+=" RolesXML='"+this.objTeam.RolesXML+"'",m+=" UsersXML='"+this.objTeam.UsersXML+"'",m+=" GroupXML='"+this.objTeam.GroupXML+"' />",m+="</XML>",this.AssignXML=m.toString(),this.MessageVisibility=!0,void(this.DisplayMessage=i.a.GetResource("CRMTeam_Save"))}if(this.dset.Tables.length>2&&0==this.dset.Tables[2].length&&""==this.objTeam.RolesXML&&""==this.objTeam.UsersXML&&""==this.objTeam.GroupXML&&0==this.objTeam.TeamNodeID)this.DisplayMessage="There was No Selection";else{var h=this.objTeam.FeatureAssign();this.Ret=h.RetValue,this.DisplayMessage=h.Message}}this.Ret>0?(this.DisplayMessage=this.dset.Tables.length>2&&this.dset.Columns[2].Contains("CCID")&&this.dset.Tables[2].length>0&&""==this.objTeam.RolesXML&&""==this.objTeam.UsersXML&&""==this.objTeam.GroupXML&&0==this.objTeam.TeamNodeID?i.a.GetResource("CRMTeam_UnAssigned"):i.a.GetResource("CRMTeam_Save"),null!=this.Parent&&"AddEditLeads"==this.Parent.ClassName&&(this.Parent.IsAssign=!0)):this.Ret<0&&(this.DisplayMessage=i.a.GetResource("CRMTeam_Error")),this.MessageVisibility=!0,this.LabelVisibility=!1}}},{key:"GetNodeNames",value:function(){this.DisplayMessage="",this.Roles="",this.Users="",this.Grps="";for(var e=0;e<this.RolesItems.Items.length;e++)this.RolesItems.Items[e].IsChecked&&"0"!=this.RolesItems.Items[e].Value&&(this.Roles+=this.RolesItems.Items[e].Value+",");this.Roles=this.Roles.Trim(",");for(var t=0;t<this.UsersItems.Items.length;t++)this.UsersItems.Items[t].IsChecked&&"0"!=this.UsersItems.Items[t].Value&&(this.Users+=this.UsersItems.Items[t].Value+",");this.Users=this.Users.Trim(",");for(var s=0;s<this.GroupsItems.Items.length;s++)this.GroupsItems.Items[s].IsChecked&&"0"!=this.GroupsItems.Items[s].Value&&(this.Grps+=this.GroupsItems.Items[s].Value+",");this.Grps=this.Grps.Trim(",");var a=i.a.SessionManager.GetActionDays(this._CCID,"Assign");if(a>0){if(this.Roles.split(",").length>a)return void(this.DisplayMessage=i.a.GetResource("Only ("+a+") Role(s) can be Assigned"));if(this.Users.split(",").length>a)return void(this.DisplayMessage=i.a.GetResource("Only ("+a+") User(s) can be Assigned"));if(this.Grps.split(",").length>a)return void(this.DisplayMessage=i.a.GetResource("Only ("+a+") Group(s) can be Assigned"));if(this.Roles.split(",").length+this.Users.split(",").length+this.Grps.split(",").length<a)return void(this.DisplayMessage=i.a.GetResource("Assign atleast ("+a+") Role/User/Group"))}}},{key:"OnTypeChange",value:function(e){"0"!=this.TypeOfAssigning.SelectedValue&&null!=this.TypeOfAssigning.SelectedValue&&(this.TeamVisible=!1,this.RolesItems.Visible=!1,this.UsersItems.Visible=!1,this.GroupsItems.Visible=!1,"1"==this.TypeOfAssigning.SelectedValue?this.TeamVisible=!0:"2"==this.TypeOfAssigning.SelectedValue?this.UsersItems.Visible=!0:"3"==this.TypeOfAssigning.SelectedValue?this.RolesItems.Visible=!0:"4"==this.TypeOfAssigning.SelectedValue&&(this.GroupsItems.Visible=!0))}},{key:"OnChange",value:function(e){"0"!=this.Teams.SelectedValue&&null!=this.Teams.SelectedValue&&(this.AssignUser.Items.Clear(),this.LoadUsers())}},{key:"LoadUsers",value:function(){var e=this,t=this.dtUsers.filter((function(t){return t.TeamID==e.Teams.SelectedValue}));if(t.length>0){this.AssignUser.Items.Clear();for(var s=0;s<t.length;s++)this.AssignUser.Items.push(o.d.ComboBoxItems_2(t[s].UserName.toString(),t[s].UserID.toString()))}}},{key:"RolesItems",get:function(){return this.RolesItemsObj}},{key:"UsersItems",get:function(){return this.UsersItemsObj}},{key:"GroupsItems",get:function(){return this.GroupsItemsObj}}]),s}(r.b)},"2mtM":function(e,t,s){"use strict";s.d(t,"a",(function(){return l}));var i=s("Do2H"),a=s("Lp6j"),n=s("ScVY"),o=s("8B8H"),r=s("ockk"),l=function(e){_inherits(s,e);var t=_createSuper(s);function s(e){var i;_classCallCheck(this,s),(i=t.call(this)).ListObj=new o.a,i.ColumnSpan="4",i.Parent=e,i.ListObj.Table=[],i.ListObj.Columns=[],i.ListObj.ColumnSpan=4,i.ListObj.TableColumns.push("AssignFrom"),i.ListObj.TableColumns.push("AssignTo"),i.ListObj.TableColumns.push("Date"),i.ListObj.TableColumns.push("Time");var a=new r.a;return a.Header="Assign From",a.DisplayMember="AssignFrom",a.Width=250,a.ReadOnly=!0,i.ListObj.Columns.push(a),(a=new r.a).Header="AssignTo",a.DisplayMember="AssignTo",a.Width=250,a.ReadOnly=!0,i.ListObj.Columns.push(a),(a=new r.a).Header="Date",a.DisplayMember="Date",a.Width=250,a.ReadOnly=!0,i.ListObj.Columns.push(a),(a=new r.a).Header="Time",a.DisplayMember="Time",a.Width=250,a.ReadOnly=!0,i.ListObj.Columns.push(a),i}return _createClass(s,[{key:"LoadHistroy_1",value:function(e,t){try{this.ListObj.Clear()}catch(s){Logger.InfoLog("ViewAssignHistroyViewModel::Exiting LoadHistroy")}Logger.InfoLog("ViewAssignHistroyViewModel::Exiting LoadHistroy")}},{key:"LoadHistroy_2",value:function(e){try{if(this.ListObj.Clear(),null!=e&&e.length>0)for(var t=0;t<e.length;t++){var s=this.ListObj.NewRow();s.AssignFrom=e[t].ASSIGNEDFROM.toString(),s.AssignTo=e[t].ASSIGNEDTO.toString(),s.Date=new Date(e[t].DATE).ToString(i.a.SessionManager.Preferences["Date Format"].toString()),a.e.IsEmpty(e[t].TIME.toString())||(s.Time=new Date(e[t].TIME).ToString("hh:mm:ss tt")),this.ListObj.addRow(s)}}catch(n){}}}]),s}(n.b)},E6JT:function(e,t,s){"use strict";s.d(t,"a",(function(){return b}));var i=s("Do2H"),a=s("Lp6j"),n=s("eQJW"),o=s("EQd/"),r=s("JIg3"),l=s("n56n"),u=s("0/4Q"),c=s("Jnyl"),d=s("ScVY"),C=s("VxiT"),m=s("4HhE"),h=s("NkMH"),b=function(e){_inherits(s,e);var t=_createSuper(s);function s(e){var a,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;_classCallCheck(this,s),(a=t.call(this)).ScreenObject=new C.a,a.Feedback=new o.c(0),a.FeedbackDate=new r.b(0),a.Fields=new Array,a.FeedbackVisibility=!0,a.isEdit=!1,a.oText=null,a.oDate=null,a.oCombo=null,a.oTextArea=null,a.OComboText=null,a.ButtonSave=new h.a,a.isView=!1,a.DiscussionClick=new m.b,73!=e.Parent.CostCenterID&&(a.FeedbackVisibility=!0),a.Title="Follow Up";try{a.ScreenObject.Data=null==e||null==e.ScreenObject.Data?i.a.crmService.GetFeedbackDetails(114):e.ScreenObject.Data,a.Oparent=e,0==d&&null!=a.Oparent&&(d=a.Oparent.Parent.CostCenterID),i.a.SessionManager.HideUnathorizedAccess?a.ButtonSave.Visible=i.a.SessionManager.IsActionAssigned(d,"FollowUp_Create"):a.ButtonSave.Enable=i.a.SessionManager.IsActionAssigned(d,"FollowUp_Create"),a.Feedback.Label=i.a.GetResource("Feed_Diss"),a.FeedbackDate.Label=i.a.GetResource("Feed_Date");for(var b=0,S=0,D=0;D<a.ScreenObject.Data.Tables[0].length;D++){if("TEXT"==a.ScreenObject.Data.Tables[0][D].UserColumnType.toString()||"NUMERIC"==a.ScreenObject.Data.Tables[0][D].UserColumnType.toString())a.ScreenObject.Data.Tables[0][D].Iscolumninuse&&a.ScreenObject.Data.Tables[0][D].IsColumnUserDefined&&(a.oText=new o.d(0),a.oText.Label=a.ScreenObject.Data.Tables[0][D].UserColumnName.toString(),a.oText.DBColumnName=a.ScreenObject.Data.Tables[0][D].CostCenterColID.toString(),a.oText.SysColumnName=a.ScreenObject.Data.Tables[0][D].SysColumnName.toString(),a.oText.DBColumnID=parseInt(a.ScreenObject.Data.Tables[0][D].CostCenterColID),a.oText.Column=b,a.oText.Row=S,S+=1),a.Fields.push(a.oText);else if("DATE"==a.ScreenObject.Data.Tables[0][D].UserColumnType.toString())a.ScreenObject.Data.Tables[0][D].Iscolumninuse&&a.ScreenObject.Data.Tables[0][D].IsColumnUserDefined&&(a.oDate=new r.a(0),a.oDate.Label=a.ScreenObject.Data.Tables[0][D].UserColumnName.toString(),a.oDate.DBColumnName=a.ScreenObject.Data.Tables[0][D].CostCenterColID.toString(),a.oDate.SysColumnName=a.ScreenObject.Data.Tables[0][D].SysColumnName.toString(),a.oDate.Column=b,a.oDate.DBColumnID=parseInt(a.ScreenObject.Data.Tables[0][D].CostCenterColID),a.oDate.Row=S,S+=1),a.Fields.push(a.oDate);else if("COMBOBOX"==a.ScreenObject.Data.Tables[0][D].UserColumnType.toString()){if(a.ScreenObject.Data.Tables[0][D].Iscolumninuse&&a.ScreenObject.Data.Tables[0][D].IsColumnUserDefined){a.oCombo=new u.e(0),a.oCombo.Label=a.ScreenObject.Data.Tables[0][D].UserColumnName.toString(),a.oCombo.DBColumnName=a.ScreenObject.Data.Tables[0][D].CostCenterColID.toString(),a.oCombo.DBColumnID=parseInt(a.ScreenObject.Data.Tables[0][D].CostCenterColID),a.oCombo.SysColumnName=a.ScreenObject.Data.Tables[0][D].SysColumnName.toString(),a.oCombo.Column=b;var g=a.ScreenObject.Data.Tables[0][D].UserProbableValues.toString().Trim();if(g.length>0){for(var p=g.split(";"),I=0;I<p.length;I++)a.oCombo.Items.push(u.d.ComboBoxItems_2(p[I],p[I]));a.oCombo.SelectedValue=a.oCombo.Items[0].Value}a.oCombo.Row=S,S+=1}a.Fields.push(a.oCombo)}else"TEXTAREA"==a.ScreenObject.Data.Tables[0][D].UserColumnType.toString()?(a.ScreenObject.Data.Tables[0][D].Iscolumninuse&&a.ScreenObject.Data.Tables[0][D].IsColumnUserDefined&&(a.oTextArea=new o.c(0),a.oTextArea.Label=a.ScreenObject.Data.Tables[0][D].UserColumnName.toString(),a.oTextArea.DBColumnName=a.ScreenObject.Data.Tables[0][D].CostCenterColID.toString(),a.oTextArea.SysColumnName=a.ScreenObject.Data.Tables[0][D].SysColumnName.toString(),a.oTextArea.DBColumnID=parseInt(a.ScreenObject.Data.Tables[0][D].CostCenterColID),a.oTextArea.Column=b,a.oTextArea.Row=S,S+=1),a.Fields.push(a.oTextArea)):"COMBOTEXT"==a.ScreenObject.Data.Tables[0][D].UserColumnType.toString()?(a.ScreenObject.Data.Tables[0][D].Iscolumninuse&&a.ScreenObject.Data.Tables[0][D].IsColumnUserDefined&&(a.OComboText=new c.a(0),a.OComboText.Label=a.ScreenObject.Data.Tables[0][D].UserColumnName.toString(),a.OComboText.DBColumnName=a.ScreenObject.Data.Tables[0][D].CostCenterColID.toString(),a.OComboText.DBColumnID=parseInt(a.ScreenObject.Data.Tables[0][D].CostCenterColID),a.OComboText.SysColumnName=a.ScreenObject.Data.Tables[0][D].SysColumnName.toString(),a.OComboText.Column=b,a.OComboText.Row=S,S+=1),a.Fields.push(a.OComboText)):"LISTBOX"==a.ScreenObject.Data.Tables[0][D].UserColumnType.toString()&&(a.ScreenObject.Data.Tables[0][D].Iscolumninuse&&a.ScreenObject.Data.Tables[0][D].IsColumnUserDefined&&(a.oPactCombo=new l.b(0),a.oPactCombo.CCID=parseInt(a.ScreenObject.Data.Tables[0][D].ColumnCostCenterID),a.oPactCombo.TypeID=0==a.ScreenObject.Data.Tables[0][D].ColumnCCListViewTypeID.toString().Trim().length?1:parseInt(a.ScreenObject.Data.Tables[0][D].ColumnCCListViewTypeID),a.oPactCombo.DBColumnID=parseInt(a.ScreenObject.Data.Tables[0][D].CostCenterColID),a.oPactCombo.Label=a.ScreenObject.Data.Tables[0][D].UserColumnName.toString(),a.oPactCombo.DBColumnName=a.ScreenObject.Data.Tables[0][D].CostCenterColID.toString(),a.oPactCombo.SysColumnName=a.ScreenObject.Data.Tables[0][D].SysColumnName.toString(),a.oPactCombo.Column=b,a.oPactCombo.Row=S,S+=1),a.Fields.push(a.oPactCombo));3==b&&(S+=1,b=0),b+=1}if(a.FeedbackDate.CustomFormat=i.a.SessionManager.Preferences["Date Format"]+" hh:mm:ss tt",a.FeedbackDate.Date=new Date,a.ScreenObject.Data.Tables.length>8?a.ScreenObject.Data.Tables[8].forEach((function(e){"Date"==e.SysColumnName.toString()&&(a.FeedbackDate.DBColumnID=parseInt(e.CostCenterColID.toString()),a.FeedbackDate.Visible=Object(n.j)(e.IsVisible.toString()),a.FeedbackDate.Enable=Object(n.j)(e.IsEditable.toString())),"Feedback"==e.SysColumnName.toString()&&(a.Feedback.DBColumnID=parseInt(e.CostCenterColID.toString()),a.Feedback.Visible=Object(n.j)(e.IsVisible.toString()),a.Feedback.Enable=Object(n.j)(e.IsEditable.toString()))})):null!=e&&e.FeedBackDataObj.Columns.forEach((function(e){"Feedback"==e.DisplayMember?a.Feedback.Visible=e.IsVisible:"Date"==e.DisplayMember&&(a.FeedbackDate.Visible=e.IsVisible)})),a.ScreenObject.SetView(a.FeedbackDate,!1),a.ScreenObject.SetView(a.Feedback,!1),a.Fields.forEach((function(e){a.ScreenObject.SetView(e,!1)})),null!=a.Oparent&&null!=a.Oparent.Parent&&("AddEditLeads"==a.Oparent.Parent.ClassName||"AddEditOpportunity"==a.Oparent.Parent.ClassName))try{var y=null,T=null,f=null;if("AddEditLeads"==a.Oparent.Parent.ClassName?null!=(T=a.Oparent.Parent).ScreenObject&&(y=T.ScreenObject.Data):"AddEditOpportunity"==a.Oparent.Parent.ClassName&&(null!=(f=a.Oparent.Parent).ScreenObject&&(y=f.ScreenObject.Data)),null!=y){if(0==y.Tables.length)return _possibleConstructorReturn(a);var P=y.Tables[4].Select("Name='AutoPupulateSuppliers'");if(P.length>0&&""!=P[0].Value.toString()){if(0==parseInt(P[0].Value.toString()))return _possibleConstructorReturn(a);var O=null;if(null!=a.Fields){var V,v,M="";if("AddEditLeads"==a.Oparent.Parent.ClassName){if(null!=T.LeadsProduct.ProductColumnSource&&(null==(O=T.LeadsProduct.ProductColumnSource.Where((function(e){return 0!=e.CostCenterID&&e.CostCenterID==parseInt(P[0].Value)})).FirstOrDefault())||null==O.ID))return _possibleConstructorReturn(a);for(var N=0;N<T.LeadsProduct.ProductGrid.length;N++)""!=T.LeadsProduct.ProductGrid.Rows[N].ProductID_Key.toString()&&null!=T.LeadsProduct.ProductGrid.Rows[N].ProductID_Key.toString()&&(M+=T.LeadsProduct.ProductGrid.Rows[N][O.ValueMember]+",")}else if("AddEditOpportunity"==a.Oparent.Parent.ClassName){if(null!=f.LeadsProduct.ProductColumnSource&&(null==(O=f.LeadsProduct.ProductColumnSource.Where((function(e){return 0!=e.CostCenterID&&e.CostCenterID==parseInt(P[0].Value)})).FirstOrDefault())||null==O.ID))return _possibleConstructorReturn(a);for(var L=0;L<f.LeadsProduct.ProductGrid.length;L++)""!=f.LeadsProduct.ProductGrid.Rows[L].ProductID_Key.toString()&&null!=f.LeadsProduct.ProductGrid.Rows[L].ProductID_Key.toString()&&(M+=f.LeadsProduct.ProductGrid.Rows[L][O.ValueMember]+",")}if(0==M.length)return _possibleConstructorReturn(a);for(var j=0;j<a.Fields.length;j++)if(null!=(V=a.Fields[j])&&V instanceof l.b&&V.CCID==parseInt(P[0].Value)){(v=V).CustomWhere=" a.NodeID  in ("+M.TrimEnd(",")+")",v.Refresh();break}}}}}catch(w){}}catch(R){throw Logger.ErrorLog("FeedbackViewModel:: FeedbackViewModel",R),R}return a}return _createClass(s,[{key:"OnDiscussionClick",value:function(e){}},{key:"OnSave",value:function(e){try{if("Cancel"==e.toString())i.a.page.HideDialog();else if("Save"==e.toString()&&(this.Feedback.Visible||(this.Feedback.Text=" "),null!=this.Feedback.Text&&""!=this.Feedback.Text)){if(null!=this.Oparent.SelectedRow&&this.isEdit){this.Oparent.SelectedRow.View="View",this.Oparent.SelectedRow.Date=this.FeedbackDate.Date.ToString("dd/MMM/yyyy hh:mm:ss tt"),this.Oparent.SelectedRow.Date_Key=this.FeedbackDate.Date;var t=null!=this.Feedback.Text?this.Feedback.Text.toString():"";null!=this.Feedback.Tag&&""!=this.Feedback.Tag&&(t=this.Feedback.Tag),this.Oparent.SelectedRow.FeedBack=t,this.Oparent.SelectedRow.CreatedBy=i.a.SessionManager.UserName,this.Oparent.SelectedRow.Imagefilepath=a.e.IsEmpty(i.a.SessionManager.UserPhoto)?"":a.e.GetPath(i.a.SessionManager.UserPhoto);for(var s=0;s<this.Fields.length;s++){var n=this.Fields[s];n instanceof o.d?this.Oparent.SelectedRow[n.SysColumnName]=n.Text:n instanceof r.a?this.Oparent.SelectedRow[n.SysColumnName]=n.Date:n instanceof u.e?this.Oparent.SelectedRow[n.SysColumnName]=n.SelectedValue:n instanceof c.a?this.Oparent.SelectedRow[n.SysColumnName]=n.TextBox.Text:n instanceof o.c?this.Oparent.SelectedRow[n.SysColumnName]=n.Text:n instanceof l.b&&(this.Oparent.SelectedRow[n.SysColumnName+"_Key"]=n.SelectedValue,this.Oparent.SelectedRow[n.SysColumnName]=n.Text)}this.Oparent.FeedBackDataObj.updateRow(this.Oparent.SelectedRow),this.Oparent.SelectedRow=null}else{var d=this.Oparent.FeedBackDataObj.NewRow();d.View="View",d.Date=this.FeedbackDate.Date.ToString("dd/MMM/yyyy hh:mm:ss tt"),d.Date_Key=this.FeedbackDate.Date;var C=null!=this.Feedback.Text?this.Feedback.Text.toString():"";null!=this.Feedback.Tag&&""!=this.Feedback.Tag&&(C=this.Feedback.Tag),d.FeedBack=C,d.CreatedBy=i.a.SessionManager.UserName,d.Imagefilepath=a.e.IsEmpty(i.a.SessionManager.UserPhoto)?"":a.e.GetPath(i.a.SessionManager.UserPhoto);for(var m=0;m<this.Fields.length;m++){var h=this.Fields[m];h instanceof o.d?d[h.SysColumnName]=h.Text:h instanceof r.a?d[h.SysColumnName]=h.Date:h instanceof u.e?d[h.SysColumnName]=h.SelectedValue:h instanceof c.a?d[h.SysColumnName]=h.TextBox.Text:h instanceof o.c?d[h.SysColumnName]=h.Text:h instanceof l.b&&(d[h.SysColumnName+"_Key"]=h.SelectedValue,d[h.SysColumnName]=h.Text)}this.Oparent.FeedBackDataObj.addRow(d)}this.Feedback.Text="",this.FeedbackDate.Date=new Date,this.isEdit=!1,this.ClearFields()}}catch(b){throw Logger.ErrorLog("FeedbackViewModel:: OnSave",b),b}}},{key:"ClearFields",value:function(){for(var e=0;e<this.Fields.length;e++){var t=this.Fields[e];t instanceof o.d&&(this.oText=t,this.oText.Text=""),t instanceof r.a&&(this.oDate=t),t instanceof u.e&&(this.oCombo=t,this.oCombo.SelectedValue=""),t instanceof c.a&&(this.OComboText=t,this.OComboText.TextBox.Text=""),t instanceof o.c&&(this.oTextArea=t,this.oTextArea.Text=""),t instanceof l.b&&(this.oPactCombo=t,this.oPactCombo.SelectedValue=0)}}}]),s}(d.b)},GQfG:function(e,t,s){"use strict";s.d(t,"a",(function(){return l}));var i=s("Do2H"),a=s("ScVY"),n=s("JIg3"),o=s("r2z3"),r=s("V7Sd"),l=function(e){_inherits(s,e);var t=_createSuper(s);function s(e,i,a){var o;return _classCallCheck(this,s),(o=t.call(this)).CloseDate=new n.c(0),o.NodeID=0,o.CCID=0,o.retuval=0,o.NodeID=e,o.CCID=a,o.CloseDate.Label="Closed Date",o.Parent=i,86==a?o.Title="Close Lead":73==a&&(o.Title="Close Case"),o}return _createClass(s,[{key:"OnClose",value:function(e){var t,s;if(null!=e&&"Close"==e.toString()){var a=new o.a;a.LeadID=this.NodeID;var n=a.CloseLead(this.NodeID,this.CCID,this.CloseDate.Date);this.DisplayMessage=n.Message,this.retuval=n.RetValue,this.retuval>0&&(this.Parent instanceof r.TreeViewPageComponent?(this.Parent.DisplayMessage=this.DisplayMessage,this.Parent.Refresh()):null!=this.Parent&&"AddEditLeads"==(null===(t=this.Parent)||void 0===t?void 0:t.ClassName)?(this.Parent.DisplayMessage=this.DisplayMessage,i.a.page.HideDialog()):null!=this.Parent&&"AddEditCasesViewModel"==(null===(s=this.Parent)||void 0===s?void 0:s.ClassName)&&(this.Parent.ButtonSave.Enable=!1,this.Parent.DisplayMessage=this.DisplayMessage,i.a.page.HideDialog()))}else null!=this.Parent&&i.a.page.HideDialog()}}]),s}(a.b)},Hzm0:function(e,t,s){"use strict";s.r(t),s.d(t,"AddEditCasesViewModel",(function(){return _}));var i=s("mrSG"),a=s("Do2H"),n=s("Lp6j"),o=s("eQJW"),r=s("ScVY"),l=s("GQfG"),u=s("W7OG"),c=s("E6JT"),d=s("nFYD"),C=s("NkMH"),m=s("2mtM"),h=s("ockk"),b=s("EQd/"),S=s("JIg3"),D=s("0/4Q"),g=s("DKUf"),p=s("CQvG"),I=s("RJs6"),y=s("xnJf"),T=s("OvA8"),f=s("5DrK"),P=s("VxiT"),O=s("n56n"),V=s("8B8H"),v=s("yJmf"),M=s("4HhE"),N=function(e){_inherits(s,e);var t=_createSuper(s);function s(){var e;return _classCallCheck(this,s),(e=t.call(this)).setGridFocus=!1,e.Width=0,e.GridDataObj=new V.a,e.AccountVisible=!1,e.CRMCustomerVisible=!1,e.ScreenWidth=0,e.ScreenHeight=0,e.SerailNo=new b.d(0),e.BomCode=new b.d(0),e.BomName=new b.d(0),e.Product=new O.b(0),e.Mode=new D.e(0),e.Contracts=new D.e(0),e.Customer=new O.b(0),e.PreCheckContractMandatory=!1,e.prodds=null,e.GridDataObj.Table=[],e.GridDataObj.Columns=[],e}return _createClass(s,[{key:"CaseSearchViewModel_1",value:function(e){var t;this.MParent=e,this.BomName.Label="Name",this.BomName.Visible=!0,this.BomCode.Label="Code",this.BomCode.Visible=!0,this.ScreenWidth=900,this.ScreenHeight=400,this.Customer.Visible=!1,this.Product.Visible=!1,this.SerailNo.Visible=!1,this.Contracts.Visible=!1,this.AccountVisible=!0,this.CRMCustomerVisible=!1,(t=new h.a).Header="#",t.DisplayMember="Sno",t.DataType="TextBlock",t.Width=24,t.IsVisible=!0,t.ReadOnly=!0,t.IsFrozen=!0,this.ColumnSource.push(t),(t=new h.a).Header="Name",t.DisplayMember="Name",t.DataType="TextBlock",t.Width=150,t.IsVisible=!0,t.ReadOnly=!0,t.IsFrozen=!0,this.ColumnSource.push(t),(t=new h.a).Header="Code",t.DisplayMember="Code",t.DataType="TextBlock",t.Width=100,t.IsVisible=!0,t.ReadOnly=!0,t.IsFrozen=!0,this.ColumnSource.push(t),this.GridDataObj.TableColumns.push("Sno"),this.GridDataObj.TableColumns.push("BOMID"),this.GridDataObj.TableColumns.push("Name"),this.GridDataObj.TableColumns.push("Code"),this.GridDataObj.Columns=this.ColumnSource}},{key:"CaseSearchViewModel_2",value:function(e){if(this.Parent=e,this.ScreenWidth=900,this.ScreenHeight=400,this.BomName.Visible=!1,this.BomCode.Visible=!1,this.Customer.Visible=!0,this.Product.Visible=!0,this.SerailNo.Visible=!0,this.Contracts.Visible=!0,this.AccountVisible=!0,this.CRMCustomerVisible=!1,this.Customer.Label="Customer",this.Customer.CCID=2,this.Customer.TypeID=2,this.Customer.SelectedValue=0,this.Mode.Label="Mode",this.Mode.Items.Clear(),this.Mode.Items.push(D.d.ComboBoxItems_2("Account","1")),null!=this.Parent&&null!=this.Parent.ScreenObject.Data&&this.Parent.ScreenObject.Data.Tables.length>3&&this.Parent.ScreenObject.Data.Tables[4].length>0){var t=this.Parent.ScreenObject.Data.Tables[4].filter((function(e){return"CustomerInMode"==e.Name}));t.length>0&&""!=t[0].Value.toString()&&Object(o.j)(t[0].Value)&&this.Mode.Items.push(D.d.ComboBoxItems_2("CRM-Customers","2")),(t=this.Parent.ScreenObject.Data.Tables[4].filter((function(e){return"Contractselectionmandatory"==e.Name}))).length>0&&""!=t[0].Value.toString()&&Object(o.j)(t[0].Value)&&(this.PreCheckContractMandatory=!0)}var s;this.Mode.SelectedValue="1",this.Mode.SelectionChangedCommand.Subscribe(this,"onSave"),this.Product.CCID=3,this.Product.TypeID=10,this.SerailNo.Label="Serail No",this.Product.Label="Product",this.Contracts.Label="Contracts",this.Customer.OnPactListBoxValueChanged.Subscribe(this,"CustomerChanged"),(s=new h.a).Header="#",s.DisplayMember="Sno",s.DataType="TextBlock",s.Width=24,s.IsVisible=!0,s.ReadOnly=!0,s.IsFrozen=!0,this.ColumnSource.push(s),(s=new h.a).Header="Customer",s.DisplayMember="Customer",s.DataType="TextBlock",s.Width=150,s.IsVisible=!0,s.ReadOnly=!0,s.IsFrozen=!0,this.ColumnSource.push(s),(s=new h.a).Header="Contract",s.DisplayMember="Contract",s.DataType="TextBlock",s.Width=100,s.IsVisible=!0,s.ReadOnly=!0,s.IsFrozen=!1,this.ColumnSource.push(s),(s=new h.a).Header="Product",s.DisplayMember="Product",s.DataType="TextBlock",s.Width=150,s.IsVisible=!0,s.ReadOnly=!0,s.IsFrozen=!1,this.ColumnSource.push(s),(s=new h.a).Header="SerialNo",s.DisplayMember="SerialNo",s.DataType="TextBlock",s.Width=100,s.IsVisible=!0,s.ReadOnly=!0,s.IsFrozen=!1,this.ColumnSource.push(s),this.GridDataObj.TableColumns.push("Sno"),this.GridDataObj.TableColumns.push("ProductID"),this.GridDataObj.TableColumns.push("SerialNo"),this.GridDataObj.TableColumns.push("Product"),this.GridDataObj.TableColumns.push("Contract"),this.GridDataObj.TableColumns.push("Customer"),this.GridDataObj.TableColumns.push("CustomerID"),this.GridDataObj.TableColumns.push("DocID"),this.ProductFields=new Array;var i=a.a.inventory.GetProductSearchFields(161);if(null!=i&&i.Tables.length>0&&!i.Columns[0].Contains("ErrorMessage"))for(var n=0;n<i.Tables[0].length;n++)(s=new h.a).Header=i.Tables[0][n].ResourceData.toString(),s.DisplayMember="LISTBOX"==i.Tables[0][n].ColumnDataType.toString()?"Name"+i.Tables[0][n].SysColumnName.toString():i.Tables[0][n].SysColumnName.toString(),s.DataType="TextBlock",s.Width=100,s.IsVisible=!0,s.ReadOnly=!0,s.IsFrozen=!1,this.GridDataObj.TableColumns.Contains(i.Tables[0][n].SysColumnName.toString())||(this.ColumnSource.push(s),this.GridDataObj.TableColumns.push(i.Tables[0][n].SysColumnName.toString()),"LISTBOX"==i.Tables[0][n].ColumnDataType.toString()&&this.GridDataObj.TableColumns.push("Name"+i.Tables[0][n].SysColumnName.toString()),this.ProductFields.push(new L(i.Tables[0][n].ColumnDataType.toString(),i.Tables[0][n].SysColumnName.toString(),i.Tables[0][n].ResourceData.toString(),i.Tables[0][n].ColumnCostCenterID.toString(),i.Tables[0][n].ColumnCCListViewTypeID.toString(),Object(o.j)(i.Tables[0][n].iscolumninuse.toString()))));this.GridDataObj.Columns=this.ColumnSource,this.CustomerChanged(null),Logger.InfoLog("CaseSearchViewModel::Exiting CaseSearchViewModel")}},{key:"CustomerChanged",value:function(e){this.Contracts.Items.Clear();var t=this.Parent.Casesmodel.GetCustomerContracts(this.Customer.SelectedValue);if(null!=t&&t.Tables.length>0&&t.Tables[0].length>0&&t.Columns[0].Contains("DocID"))for(var s=0;s<t.Tables[0].length;s++)this.Contracts.Items.push(D.d.ComboBoxItems_2(t.Tables[0][s].VoucherNo.toString(),t.Tables[0][s].DocID.toString()))}},{key:"onSave",value:function(e){var t=this;if("Clear"==e)this.GridDataObj.Clear(),this.Contracts.SelectedValue="",this.Customer.SelectedValue=0,this.Product.SelectedValue=0,this.SerailNo.Text="",this.BomCode.Text="",this.BomName.Text="";else if("Mode"==e)"2"==this.Mode.SelectedValue?(this.ScreenWidth=320,this.ScreenHeight=400,this.AccountVisible=!1,this.CRMCustomerVisible=!0,this.Product.Visible=!1,this.SerailNo.Visible=!1,this.Contracts.Visible=!1,this.Customer.CCID=83,this.Customer.TypeID=1,this.Customer.Refresh(),this.Customer.SelectedValue=0):(this.Customer.CCID=2,this.Customer.TypeID=2,this.Customer.Refresh(),this.ScreenWidth=900,this.Customer.SelectedValue=0,this.ScreenHeight=400,this.AccountVisible=!0,this.CRMCustomerVisible=!1,this.Product.Visible=!0,this.SerailNo.Visible=!0,this.Contracts.Visible=!0);else if("CustomerOk"==e){if(null!=this.Parent&&null!=this.Parent.ScreenObject.Data&&this.Parent.ScreenObject.Data.Tables.length>4&&this.Parent.ScreenObject.Data.Tables[4].length>0){var s=this.Parent.ScreenObject.Data.Tables[4].filter((function(e){return"DontAllowInActiveAccountstoCreateCases"==e.Name}));if(s.length>0&&""!=s[0].Value.toString()&&Object(o.j)(s[0].Value)){var i=a.a.common.GetDataSet("CRM004",this.Customer.SelectedValue.toString());if(null!=i&&i.Tables.length>0&&i.Tables[0].length>0){if(!a.a.SessionManager.IsActionAssigned(73,"Allow cases for inactive accounts/customers"))return void(this.DisplayMessage="Cannot Create Cases For Inactive Customers");alert("Note: Selected customer instanceof inactive")}}}null!=this.Parent&&this.Customer.SelectedValue>0&&(this.Parent.Customer.CCID=83,this.Parent.Customer.TypeID=1,this.Parent.Customer.Refresh(),this.Parent.CustomerMode=2,this.Parent.Customer.SelectedValue=this.Customer.SelectedValue,this.Parent.Customer.DBColumnName="CustomerID",this.Parent.ScreenObject.OnGetReference(this.Parent.Customer),a.a.page.HideDialog())}else if("Mouse"==e||"OK"==e){if(null!=this.MParent)return void(null!=this.SelectedRow&&""!=this.SelectedRow.BomID.toString()&&null!=this.MParent.SelectedBom&&(this.MParent.SelectedBom.BOM_Key=parseInt(this.SelectedRow.BomID.toString()),this.MParent.SelectedBom.BOM=this.SelectedRow.Name.toString()));if(null!=this.Parent&&null!=this.Parent.ScreenObject.Data&&this.Parent.ScreenObject.Data.Tables[4].length>0){var r=this.Parent.ScreenObject.Data.Tables[4].filter((function(e){return"DontAllowInActiveAccountstoCreateCases"==e.Name}));if(r.length>0&&""!=r[0].Value.toString()&&Object(o.j)(r[0].Value)){var l=0;this.Customer.SelectedValue>0?l=this.Customer.SelectedValue:null!=this.SelectedRow&&""!=this.SelectedRow.CustomerID.toString()&&(l=parseInt(this.SelectedRow.CustomerID));var u=a.a.common.GetDataSet("CRM005",l.toString());if(null!=u&&u.Tables.length>0&&u.Tables[0].length>0){if(!a.a.SessionManager.IsActionAssigned(73,"Allow cases for inactive accounts/customers"))return void(this.DisplayMessage="Cannot Create Cases For Inactive Accounts");alert("Note: Selected account instanceof inactive")}}var c;if(c=a.a.SessionManager.IsActionAssigned(73,"Contract Selection Mandatory"),this.PreCheckContractMandatory&&c&&null==this.Contracts.SelectedValue&&"1"!=a.a.SessionManager.RoleID)return void(this.DisplayMessage="Contract selection mandatory")}if(null!=this.Parent&&(this.Parent.Customer.CCID=2,this.Parent.Customer.TypeID=2,this.Parent.Customer.Refresh(),this.Parent.CustomerMode=1),null!=this.SelectedRow){if(null!=this.Parent){""!=this.SelectedRow.CustomerID.toString()&&(this.Parent.Customer.SelectedValue=parseInt(this.SelectedRow.CustomerID.toString())),this.Parent.Customer.SelectedValue>0&&(this.Parent.Customer.DBColumnName="AccountID",this.Parent.ScreenObject.OnGetReference(this.Parent.Customer));for(var d=0;d<this.Parent.ScreenObject.HeaderFields.length;d++)if(this.Parent.ScreenObject.HeaderFields[d]instanceof O.e){this.Parent.ScreenObject.HeaderFields[d].Customer.SelectedValue=this.Customer.SelectedValue,this.Parent.ScreenObject.HeaderFields[d].Customer.TypeID=this.Customer.TypeID,this.Parent.ScreenObject.HeaderFields[d].Customer.CCID=this.Customer.CCID,this.Parent.ScreenObject.HeaderFields[d].Customer.DBColumnName=this.Customer.DBColumnName,this.Parent.ScreenObject.HeaderFields[d].Customer.Label=this.Customer.Label,this.Parent.ScreenObject.HeaderFields[d].Customer.IsReadOnly=!0,this.Parent.ScreenObject.HeaderFields[d].Customer.IsEnabled=!1,this.Parent.ScreenObject.HeaderFields[d].Customer.RefreshDataDel.Call();break}if(""!=this.SelectedRow.ProductID.toString()&&(0==this.Parent.Product.Items.filter((function(e){return e.Value==t.SelectedRow.ProductID.toString()})).length&&this.Parent.Product.Items.push(D.d.ComboBoxItems_2(this.SelectedRow.Product.toString(),this.SelectedRow.ProductID.toString())),this.Parent.Product.SelectedValue=this.SelectedRow.ProductID.toString()),""!=this.SelectedRow.Contract.toString()&&(0==this.Parent.Contract.Items.filter((function(e){return e.Value==t.SelectedRow.DocID.toString()})).length&&this.Parent.Contract.Items.push(D.d.ComboBoxItems_2(this.SelectedRow.Contract.toString(),this.SelectedRow.DocID.toString())),this.Parent.Contract.SelectedValue=this.SelectedRow.DocID.toString()),""!=this.SelectedRow.SerialNo.toString()&&(this.Parent.SerialNumber.Text=this.SelectedRow.SerialNo.toString()),null!=this.prodds&&"0"!=this.SelectedRow.DocID.toString()){var C=this.prodds.Tables[0].filter((function(e){return e.DocID==t.SelectedRow.DocID.toString()}));if(C.length>0){if(this.prodds.Columns[0].Contains("CaseType")){var m=0,h=0;this.prodds.Columns[0].Contains("CaseCount")&&n.e.IsNum(C[0].CaseCount)&&(h=parseInt(C[0].CaseCount.toString())),this.prodds.Columns[0].Contains("AllotedCases")&&n.e.IsNum(C[0].AllotedCases)&&(m=parseInt(C[0].AllotedCases.toString())),this.Parent.Billing.SelectedValue=h>=m||"10001"==C[0].CaseType.toString()&&this.prodds.Columns[0].Contains("MonthCases")&&""!=C[0].MonthCases.toString()&&parseFloat(C[0].MonthCases.toString())>0?"139":"138"}if(this.prodds.Tables.length>1){var b=this.prodds.Tables[1].filter((function(e){return e.CostCenterID==C[0].Costcenterid.toString()}));b.length>0&&n.e.Int(b[0].PrefValue.toString())>5e4&&this.Parent.ScreenObject.CustomTab.Pages.forEach((function(e){e.Fields.forEach((function(e){e instanceof O.b&&e.CCID==parseInt(b[0].PrefValue.toString())&&""!=C[0]["dcCCNID"+(e.CCID-5e4)].toString()&&(e.SelectedValue=parseInt(C[0]["dcCCNID"+(e.CCID-5e4)].toString()))}))}))}if(this.prodds.Tables.length>2&&this.prodds.Columns[2].Contains("CostCenterIDLinked")&&this.prodds.Columns[2].Contains("DocumentLinkDefID")){var g=this.prodds.Tables[2].filter((function(e){return e.CostCenterIDLinked==C[0].Costcenterid.toString()}));if(g.length>0&&this.prodds.Columns[0].Contains("InvDocDetailsID")){var p=this.Parent.Casesmodel.GetDocDetails(g[0].DocumentLinkDefID.toString(),C[0].InvDocDetailsID.toString());if(null!=p&&p.Tables.length>1&&p.Tables[1].length>0)for(var I=function(e){var s="",i=p.Tables[0][e].BASECOL.toString();p.Columns[1].Contains(p.Tables[0][e].LINKCOL.toString())&&(s=p.Tables[1][0][p.Tables[0][e].LINKCOL.toString()].toString());var a=!1;if(t.Parent.ScreenObject.CustomTab.Pages.forEach((function(e){e.Fields.forEach((function(e){e instanceof M.c&&e.DBColumnName.toLowerCase()==i.toLowerCase()&&(a=!0,t.FillValue(e,s))}))})),!a)for(var n in t.Parent){var o=t.Parent[n];if(o instanceof M.c||o instanceof O.b||o instanceof S.a){var r=o;null==r&&(r=o),null!=r&&r instanceof M.c&&null!=r.DBColumnName&&r.DBColumnName.toLowerCase()==i.toLowerCase()&&(a=!0,t.FillValue(r,s))}}},y=0;y<p.Tables[0].length;y++)I(y)}}}}}}else if(null!=this.Parent&&this.Customer.SelectedValue>0){this.Parent.Customer.SelectedValue=this.Customer.SelectedValue,this.Parent.Customer.SelectedValue>0&&(this.Parent.Customer.DBColumnName="AccountID",this.Parent.ScreenObject.OnGetReference(this.Parent.Customer));for(var T=0;T<this.Parent.ScreenObject.HeaderFields.length;T++)if(this.Parent.ScreenObject.HeaderFields[T]instanceof O.e){this.Parent.ScreenObject.HeaderFields[T].Customer.SelectedValue=this.Customer.SelectedValue,this.Parent.ScreenObject.HeaderFields[T].Customer.TypeID=this.Customer.TypeID,this.Parent.ScreenObject.HeaderFields[T].Customer.CCID=this.Customer.CCID,this.Parent.ScreenObject.HeaderFields[T].Customer.DBColumnName=this.Customer.DBColumnName,this.Parent.ScreenObject.HeaderFields[T].Customer.Label=this.Customer.Label,this.Parent.ScreenObject.HeaderFields[T].Customer.SelectedIndex=this.Customer.SelectedIndex,this.Parent.ScreenObject.HeaderFields[T].Customer.IsReadOnly=!0,this.Parent.ScreenObject.HeaderFields[T].Customer.IsEnabled=!1,this.Parent.ScreenObject.HeaderFields[T].Customer.RefreshData=!this.Parent.ScreenObject.HeaderFields[T].Customer.RefreshData,this.Parent.ScreenObject.HeaderFields[T].Customer.Text=this.Customer.Text;break}}if(null!=this.Parent&&0==this.Parent.Customer.SelectedValue)return this.DisplayMessage="Select Customer",void(this.MessageVisibility=!0);a.a.page.HideDialog()}else if("Filter"==e){this.GridDataObj.Clear();var f=this.GetQuery();if(null!=this.Parent){this.prodds=this.Parent.Casesmodel.SearchCases(this.Customer.SelectedValue,this.Contracts.SelectedValue,this.SerailNo.Text,this.Product.SelectedValue,this.Parent.CaseDate.Date,f),Logger.InfoLog("AddEditCaseViewModel:: AddEditCasesVieModel onSave, SearchCases");try{if(null!=this.prodds&&this.prodds.Tables.length>0&&this.prodds.Columns[0].Contains("ErrorMessage"))Logger.ErrorLog("AddEditCaseViewModel:: AddEditCasesVieModel onSave, error message ="+this.prodds.Tables[0][0].ErrorMessage.toString());else if(null!=this.prodds&&this.prodds.Tables.length>0&&!this.prodds.Columns[0].Contains("ErrorMessage")){Logger.InfoLog("AddEditCaseViewModel:: AddEditCasesVieModel onSave, sender=Filter, rowcount "+this.prodds.Tables[0].length);for(var P=0;P<this.prodds.Tables[0].length;P++){var V=this.GridDataObj.NewRow();V.Sno=(P+1).toString();for(var v=0;v<this.GridDataObj.TableColumns.length;v++)"SNO"!=this.GridDataObj.TableColumns[v]&&(this.GridDataObj.TableColumns[v].Contains("Date")?null!=this.prodds.Tables[0][P][this.GridDataObj.TableColumns[v]]&&(V[this.GridDataObj.TableColumns[v]]=new Date(this.prodds.Tables[0][P][this.GridDataObj.TableColumns[v]]).ToString(a.a.SessionManager.Preferences["Date Format"])):this.prodds.Columns[0].Contains(this.GridDataObj.TableColumns[v])&&(V[this.GridDataObj.TableColumns[v]]=this.prodds.Tables[0][P][this.GridDataObj.TableColumns[v]]));V.ProductID=this.prodds.Tables[0][P].ProductID,V.CustomerID=this.prodds.Tables[0][P].creditAccount,this.prodds.Columns[0].Contains("dcAlpha6")&&(V.SerialNo=this.prodds.Tables[0][P].dcAlpha6),V.Product=this.prodds.Tables[0][P].ProductName,V.Contract=this.prodds.Tables[0][P].VoucherNo,V.Customer=this.prodds.Tables[0][P].AccountName,V.DocID=this.prodds.Tables[0][P].DocID,this.GridDataObj.addRow(V)}}}catch(w){throw Logger.ErrorLog("AddEditCaseViewModel:: AddEditCasesVieModel onSave, sender=Filter ",w),w}}else if(null!=this.MParent){var N="Select BOMID,BOMCode,BOMName from PRD_BillOfMaterial  WITH(NOLOCK)";if(""!=this.BomName.Text&&(N+=" where BOMName like '%"+this.BomName.Text+"%'"),""!=this.BomCode.Text&&(N+=""!=this.BomName.Text?" and BOMCode like '%"+this.BomCode.Text+"%'":" where BOMCode like '%"+this.BomCode.Text+"%'"),this.prodds=a.a.report.DataSet("RPT022",N),null!=this.prodds&&this.prodds.Tables.length>0&&!this.prodds.Columns[0].Contains("ErrorMessage"))for(var L=0;L<this.prodds.Tables[0].length;L++){var j=this.GridDataObj.NewRow();j.Sno=(L+1).toString(),j.BomID=this.prodds.Tables[0][L].BOMID,j.Code=this.prodds.Tables[0][L].BOMCode,j.Name=this.prodds.Tables[0][L].BOMName,this.GridDataObj.addRow(j)}}}else"Close"==e&&(null!=this.Parent&&(this.Parent.Customer.CCID=2,this.Parent.Customer.TypeID=2,this.Parent.Customer.Refresh(),this.Parent.CustomerMode=1),a.a.page.HideDialog(),null!=this.Parent&&(this.Parent.isClose=!0));"AddEditCasesViewModel"==this.Parent.ClassName&&(2==this.Parent.Customer.CCID?this.Parent.ScreenObject.GetLinkReferenceData(27304,73,this.Parent.Customer.SelectedValue):83==this.Parent.Customer.CCID&&this.Parent.ScreenObject.GetLinkReferenceData(27303,73,this.Parent.Customer.SelectedValue))}},{key:"GetQuery",value:function(){if(null==this.ProductFields||0==this.ProductFields.length)return"";for(var e="",t="",s=0;s<this.ProductFields.length;s++){if(this.ProductFields[s].CC.Visible){if(!(this.ProductFields[s].CC.SelectedValue>0))continue;if(!this.ProductFields[s].IsColumnInuse)continue;t="="+this.ProductFields[s].CC.SelectedValue}else{if(null==this.ProductFields[s].FromValue.Text||""==this.ProductFields[s].FromValue.Text.Trim())continue;if(this.ProductFields[s].DataType.toUpperCase().Contains("DATE"))t=" ='"+this.ProductFields[s].FromValue.Text+"' ";else switch(this.ProductFields[s].Condition.SelectedValue){case"1":t=" ='"+this.ProductFields[s].FromValue.Text+"' ";break;case"2":t=" <>'"+this.ProductFields[s].FromValue.Text+"' ";break;case"3":t=" like '"+this.ProductFields[s].FromValue.Text+"%' ";break;case"4":t=" like '%"+this.ProductFields[s].FromValue.Text+"' ";break;case"5":t=" like '%"+this.ProductFields[s].FromValue.Text+"%' ";break;case"6":t=" not like '%"+this.ProductFields[s].FromValue.Text+"%' "}}"description"==this.ProductFields[s].ColumnName.toLowerCase()?e+=" p."+this.ProductFields[s].ColumnName+t+" and ":this.ProductFields[s].DataType.toLowerCase().Contains("date")?e+=" CONVERT(DATETIME,Cases."+this.ProductFields[s].ColumnName+")"+t+" and ":e+=this.ProductFields[s].ColumnName+t+" and "}return e.length>5?e.substring(1,e.length-4):""}},{key:"FillValue",value:function(e,t){e instanceof O.b&&n.e.IsNum(t)?e.SelectedValue=parseInt(t):e instanceof b.d?e.Text=t:e instanceof D.e?e.SelectedValue=t:(e instanceof S.a&&n.e.isValidDate(t)||e instanceof S.c&&n.e.isValidDate(t))&&(e.Date=new Date(t))}},{key:"GridData",get:function(){return this.GridDataObj.Table}},{key:"ColumnSource",get:function(){return this.GridDataObj.Columns}},{key:"SelectedRow",get:function(){return this.GridDataObj.SelectedItem}}]),s}(r.b),L=function(){function e(t,s,i,o,r,l){_classCallCheck(this,e),this.IsColumnInuse=!1,this.IsColumnInuse=l,this.DataType=t,this.ColumnName=s,this.Header=i,this.Condition=new D.e(0),this.FromValue=new b.d(0),this.CC=new O.b(0);var u=n.e.Int(o);u>0?(this.CC.CCID=u,u=n.e.Int(r),this.CC.TypeID=u,this.CC.Visible=!0,this.Condition.Visible=!1,this.FromValue.Visible=!1):(this.CC.Visible=!1,this.Condition.Visible=!0,this.FromValue.Visible=!0),this.Condition.Label=a.a.GetResource("Reports_Condition"),this.FromValue.Label=a.a.GetResource("Reports_FromValue"),this.LoadConditions(this.DataType)}return _createClass(e,[{key:"LoadConditions",value:function(e){this.Condition.Items.Clear(),this.Condition.Items.push(D.d.ComboBoxItems_2(a.a.GetResource("Com_Equals"),"1")),this.Condition.Items.push(D.d.ComboBoxItems_2(a.a.GetResource("Com_NotEquals"),"2")),this.Condition.Items.push(D.d.ComboBoxItems_2(a.a.GetResource("Com_BeginsWith"),"3")),this.Condition.Items.push(D.d.ComboBoxItems_2(a.a.GetResource("Com_EndsWith"),"4")),this.Condition.Items.push(D.d.ComboBoxItems_2(a.a.GetResource("Com_Contains"),"5")),this.Condition.Items.push(D.d.ComboBoxItems_2(a.a.GetResource("Com_NotContains"),"6")),this.Condition.SelectedValue="5"}}]),e}(),j=s("/aGy"),w=s("THE7"),R=s("2Dtv"),B=s("sDFv"),A=s("ouML"),k=s("vgHJ"),F=s("Jnyl"),G=s("Huqd"),E=s("bwbx"),_=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,s,i){var l;if(_classCallCheck(this,r),(l=t.call(this))._ContactVisibility=!1,l._DetailsVisibility=!1,l.ReportInfoVisibility=!0,l.EnableSearch=!0,l.ReportsList=[],l._CloseVisiblity=!1,l.ParentId=0,l.PrintVisible=!1,l.ButtonWaive=new C.a,l.RejectVisiblity=!1,l.btnHistoryVisible=!1,l.AutoActivity=!1,l.BtnApprove=new C.a,l.PrintViewVisible=!1,l.WFDocLevelList=[],l.dsLoad=null,l.CaseID=0,l.AssignVisiblity=!1,l.WaiveVisibility=!1,l.RetValue=0,l.ChangeVisible=!1,l.CName=new b.a(24234),l.CaseDate=new S.a(24233),l.Status=new D.e(24235),l.Customer=new O.b(24238),l.ContractLine=new D.e(24241),l.Product=new D.e(24240),l.Contract=new D.e(24239),l.ServiceLevel=new D.e(24243),l.Group=new O.b(24398),l.CaseType=new O.b(24397),l.CaseOrigin=new O.b(24237),l.CasePriority=new O.b(24236),l.Mode=new D.e(53516),l._CDate=Date.Today(),l.Billing=new D.e(25891),l.AssignedBy=new b.d(24246),l.User=new D.e(0),l.WaiveOffDate=new b.d(0),l.Comments=new b.d(0),l.AssignedDate=new b.d(24247),l.SerialNumber=new b.d(24242),l.CreatedDate=new b.d(24245),l.Owner=new b.d(24244),l.Subject=new b.d(27293),l.ReasonsObj=new V.a,l.NodeID=0,l.CostCenterID=0,l.DocumentType=0,l.Casesmodel=new f.a,l.ServiceDriven=!0,l.lstatusid="",l.AllowCreationofCase=!1,l.ActMandatory=!1,l.AutoAssign=!0,l.ColLists=new Array,l.CustomerMode=1,l.RefCCID=0,l.RefNodeID=0,l.isClose=!1,l.ActVisibility=!1,l.AttachmentVisibility=!1,l.NoteVisibility=!0,l.FeedbackVisibility=!1,l.prevstatus="",l.AssignStatus="",l.CloseStatus="",l.ErrorMessage="Missing Report Parameter ' ",l.dvContractProducts=null,l.dvServiceTypes=null,l.dvTechnicians=null,l.dvTechnicianData=null,l.ClassName="AddEditCasesViewModel",l.ParentId=s,l.Group.SelectionChangedCommand.Subscribe(_assertThisInitialized(l),"OnGroupSelectionChanged"),l.Status.SelectionChangedCommand.Subscribe(_assertThisInitialized(l),"onStatusChanged"),l.Customer.OnChangeCase=new M.b,l.Customer.OnChangeCase.Subscribe(_assertThisInitialized(l),"OnSave"),l.Customer.CCID=2,l.Customer.TypeID=2,l.CostCenterID=73,l.NodeID=e,l.CaseID=e,l.CaseID=e,l.ViewAssignHistroy=new m.a(_assertThisInitialized(l)),l.ProductGrid=new u.a(_assertThisInitialized(l),73),l.ViewFeedback=new d.a(_assertThisInitialized(l)),l.ViewNotes=new I.a(_assertThisInitialized(l)),l.ViewAttachments=new T.ViewAttachmentViewModel(_assertThisInitialized(l)),l.ViewActivities=new p.b(_assertThisInitialized(l)),l.Activities=new g.a(_assertThisInitialized(l),!1),l.ViewContacts=new w.a(_assertThisInitialized(l)),l.ViewActivities.Activities=l.Activities,l.ScreenObject=new P.a,l.ScreenObject.LoadScreen_2(_assertThisInitialized(l),73),l.AddCustomer(),l.Customer.OnPactListBoxValueChanged.Subscribe(l.ScreenObject,"OnGetReference"),l.ChangeVisible=a.a.SessionManager.IsActionAssigned(l.CostCenterID,"Change Customer"),null!=l.ScreenObject.Data&&l.ScreenObject.Data.Tables.length>7&&l.ScreenObject.Data.Columns[7].Contains("IsParentCodeInherited")&&l.ScreenObject.Data.Tables[7].length>0){l.ScreenObject.InitAutoCode(l.ScreenObject.Data.Tables[7],l.Casesmodel.IsGroup);var c=l.ScreenObject.Data.Tables[4].filter((function(e){return"DefaultAssignStatus"==e.Name}));c.length>0&&(l.AssignStatus=c[0].Value.toString()),(c=l.ScreenObject.Data.Tables[4].filter((function(e){return"DefaultCloseStatus"==e.Name}))).length>0&&(l.CloseStatus=c[0].Value.toString())}l.Mode.Items.push(D.d.ComboBoxItems_2("Manual","Manual")),l.Mode.Items.push(D.d.ComboBoxItems_2("PM","PM")),l.Mode.SelectedValue="Manual",l.Customer.CCID=2,l.ButtonEmail=new C.a,l.ButtonSave=new C.a,l.ButtonClose=new C.a,l.ButtonAssign=new C.a,a.a.SessionManager.HideUnathorizedAccess?l.ButtonAssign.Visible=a.a.SessionManager.IsActionAssigned(73,"Assign"):l.ButtonAssign.Enable=a.a.SessionManager.IsActionAssigned(73,"Assign"),l.ChangeVisible=a.a.SessionManager.IsActionAssigned(l.CostCenterID,"Change Customer"),e>0?(l.DisplayName=a.a.GetResource("CRMCase_EditCase"),l.PrintVisible=!0,l.PrintViewVisible=!0,a.a.SessionManager.HideUnathorizedAccess?l.ButtonWaive.Visible=a.a.SessionManager.IsActionAssigned(l.CostCenterID,"Waive Off"):l.ButtonWaive.Enable=a.a.SessionManager.IsActionAssigned(l.CostCenterID,"Waive Off"),a.a.SessionManager.HideUnathorizedAccess?l.ButtonEmail.Visible=a.a.SessionManager.IsActionAssigned(l.CostCenterID,"Email"):l.ButtonEmail.Enable=a.a.SessionManager.IsActionAssigned(l.CostCenterID,"Email")):(l.DisplayName=a.a.GetResource("CRMCase_AddCase"),l.ButtonWaive.Visible=!1,l.ButtonEmail.Visible=!1),l.Title=l.DisplayName,l.BtnApprove.Visible=!1,l.AssignedBy.Enable=!1,l.CaseID=e,l.Casesmodel.SelectedNodeID=l.ParentId,l.dsLoad=l.Casesmodel.GetCaseScreenDetails(l.CaseID);var h,y=l.ScreenObject.Data.Tables[4].filter((function(e){return"ServiceDriven"==e.Name}));if(l.ServiceDriven=!(y.length>0&&""!=n.e.String(y[0].Value))||Object(o.j)(y[0].Value),null!=l.ScreenObject.HeaderFields&&l.ScreenObject.HeaderFields.length>0){l.ScreenObject.HeaderFields[0].Visible=l.ServiceDriven,l.ScreenObject.HeaderFields[0].Row=3,l.ScreenObject.HeaderFields[0].ColumnSpan=4;var v=l.ScreenObject.HeaderFields[0];l.ScreenObject.HeaderFields=l.ScreenObject.HeaderFields.slice(1),l.ScreenObject.HeaderFields.InsertAt(v,l.ScreenObject.HeaderFields.length+1)}return y=l.ScreenObject.Data.Tables[4].filter((function(e){return"AutoAssign"==e.Name})),l.AutoAssign=!(y.length>0&&""!=n.e.String(y[0].Value)&&Object(o.j)(y[0].Value)),y=l.ScreenObject.Data.Tables[4].filter((function(e){return"AllowCreationofCase"==e.Name})),l.AllowCreationofCase=y.length>0&&""!=y[0].Value.toString()&&Object(o.j)(y[0].Value),l.AllowCreationofCase&&((y=l.ScreenObject.Data.Tables[4].filter((function(e){return"StatusDuplicateCreationofCases"==e.Name}))).length>0&&""!=y[0].Value.toString()&&(l.lstatusid=y[0].Value.toString())),y=l.ScreenObject.Data.Tables[4].filter((function(e){return"Activitymandatorywhilecreatingcase"==e.Name})),l.ActMandatory=y.length>0&&""!=y[0].Value.toString()&&Object(o.j)(y[0].Value),(h=l.ScreenObject.Data.Tables[4].filter((function(e){return"AutoActivity"==e.Name}))).length>0&&!n.e.IsEmpty(h[0].Value)&&(l.AutoActivity=Object(o.j)(h[0].Value)),(h=l.ScreenObject.Data.Tables[4].filter((function(e){return"EnableSearch"==e.Name}))).length>0&&""!=h[0].Value.toString()&&(l.EnableSearch=Object(o.j)(h[0].Value)),0==e&&l.ScreenObject.SetAutoCode(l.CName,l.Casesmodel.IsGroup,l.ParentId,l.ScreenObject.Data.Tables[7]),l.ScreenObject.Data.Tables[5].forEach((function(e){(!n.e.hasprop(e,"IsVisible")||n.e.IsEmpty(e.IsVisible)||Object(o.j)(e.IsVisible))&&l.Status.Items.push(D.d.ComboBoxItems_2(e.Name.toString(),e.NodeID.toString())),n.e.hasprop(e,"IsDefault")&&!n.e.IsEmpty(e.IsDefault)&&Object(o.j)(e.IsDefault)&&(l.Status.SelectedValue=e.NodeID.toString())})),l.ScreenObject.Data.Tables[6].forEach((function(e){l.Billing.Items.push(D.d.ComboBoxItems_2(e.Name.toString(),e.NodeID.toString()))})),l.OnLoad(),l.AddGridColumns(),l.ScreenObject.StaticFields.sort((function(e,t){return e.Row>t.Row||e.Row==t.Row&&e.Column>t.Column?1:-1})),l.ScreenObject.HeaderFields.sort((function(e,t){return e.Row>t.Row||e.Row==t.Row&&e.Column>t.Column?1:-1})),0==l.CaseID&&l.EnableSearch?(l.CaseSearch=new N,l.CaseSearch.CaseSearchViewModel_2(_assertThisInitialized(l)),a.a.page.ShowDialog(l.CaseSearch,j.a,{ShowCenter:!0,Title:"Search"})):l.CaseID>0?(l.Casesmodel.CaseID=l.CaseID,l.LoadData(),l.Status.SelectedValue!=l.CloseStatus&&"1001"!=l.Status.SelectedValue&&"1002"!=l.Status.SelectedValue&&"1003"!=l.Status.SelectedValue?a.a.SessionManager.HideUnathorizedAccess?l.ButtonClose.Visible=a.a.SessionManager.IsActionAssigned(l.CostCenterID,"Close"):l.ButtonClose.Enable=a.a.SessionManager.IsActionAssigned(l.CostCenterID,"Close"):(l.ButtonClose.Visible=!1,l.Status.Enable=!1)):((h=l.ScreenObject.Data.Tables[4].filter((function(e){return"DefaultModeSelection"==e.Name}))).length>0&&""!=h[0].Value.toString()?(l.CustomerMode=parseInt(h[0].Value.toString()),2==l.CustomerMode?(l.Customer.CCID=83,l.Customer.TypeID=1,l.Customer.DBColumnName="CustomerID"):(l.Customer.CCID=2,l.Customer.TypeID=2,l.Customer.DBColumnName="AccountID")):(l.Customer.CCID=83,l.CustomerMode=2,l.Customer.TypeID=1,l.Customer.DBColumnName="CustomerID"),l.Customer.Refresh()),null!=l.ScreenObject.CustomTab.SelectedTab&&l.onTabSelectionChanged(l.ScreenObject.CustomTab.SelectedTab),l.ReportView(),l.setVisibilityoff(),l.ReportInfoVisibility=!0,_possibleConstructorReturn(l)}return _createClass(r,[{key:"OnAddAttachment",value:function(){this.Attachment=new y.AddAttachmentViewModel,this.Attachment.AddAttachmentViewModel_2(this)}},{key:"ReportView",value:function(){var e=this;this.ReportDimension=new O.b(0),this.ReportDimension.CCID=this.CostCenterID,this.ReportDimension.TypeID=1,this.ReportDimension.SelectedValue=this.CaseID,this.ReportsList=[],this.ReportDimension.OnPactListBoxValueChanged.Subscribe(this,"OnReportsLinkClick");var t=[];null!=this.ScreenObject.Data&&this.ScreenObject.Data.Tables.length>8&&this.ScreenObject.Data.Tables[8].forEach((function(s){var i=new C.a;i.DBColumnID=parseInt(s.ReportID),i.Label=s.ReportName.toString(),e.ScreenObject.Data.Columns[8].Contains("Shortcut")&&(i.KeyTip=s.Shortcut.toString()),e.ScreenObject.Data.Columns[8].Contains("DisplayAsPopup")&&""!=s.DisplayAsPopup.toString()&&(i.Dependantinuse="1"==s.DisplayAsPopup.toString()),e.ScreenObject.Data.Columns[8].Contains("Width")&&""!=s.Width.toString()&&(i.Width=s.Width.toString()),e.ScreenObject.Data.Columns[8].Contains("Height")&&""!=s.Height.toString()&&(i.Length=s.Height.toString()),e.ScreenObject.Data.Columns[8].Contains("DocumentField")&&""!=s.DocumentField.toString()&&(i.Formula=s.DocumentField.toString()),e.ScreenObject.Data.Columns[8].Contains("mapxml")&&""!=s.mapxml.toString()&&(i.ToolTipDescription=s.mapxml.toString()),t.Contains(parseInt(s.ReportID))||(t.push(parseInt(s.ReportID)),e.ReportsList.push(i))}))}},{key:"OnReportsLinkClick",value:function(e){return Object(i.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i,o,r,l,u,c,d,C,m;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([s.e(2),s.e(1),s.e(3),s.e(5),s.e(4),s.e(6),s.e(7),s.e(10),s.e(9),s.e(8),s.e(12),s.e(11),s.e(13),s.e(19),s.e(15),s.e(21),s.e(20),s.e(16),s.e(14),s.e(18),s.e(17),s.e(22),s.e(23),s.e(24),s.e(25),s.e(28),s.e(30),s.e(29),s.e(32),s.e(31),s.e(27),s.e(26),s.e(35),s.e(37),s.e(38),s.e(36),s.e(33),s.e(34),s.e(39),s.e(40),s.e(41),s.e(212)]).then(s.bind(null,"ThYU"));case 2:return i=t.sent,o=i.ReportViewModel,t.next=6,Promise.all([s.e(32),s.e(37)]).then(s.bind(null,"YU11"));case 6:r=t.sent,l=r.ReportViewComponent,c={strXML:""},d=new o,this.ReportDimension.SelectedValue=this.CaseID,this.DisplayMessage=this.GetReportFilterXML(e,c),u=c.strXML,0==this.DisplayMessage.length&&(null!=(C=this.ReportsList.find((function(t){return t.DBColumnID==parseInt(e)})).FirstOrDefault())&&C.Dependantinuse?(d.ReportViewModel_Document(this.CostCenterID,u,parseInt(e),!0,null,null),!n.e.IsEmpty(C.Width)&&parseFloat(C.Width)>0&&(d.RptWidth=parseFloat(C.Width)),!n.e.IsEmpty(C.length)&&parseFloat(C.length)>0&&(d.RptHeight=parseFloat(C.length)),d.DocumentObject=this,a.a.page.HideDialog(),a.a.page.ShowDialog(d,l,{Title:"",HideClose:!0,ShowCenter:!0})):((m=new o).ReportViewModel_Document(this.CostCenterID,u,parseInt(e),!1,null,null),m.DocumentObject=this,a.a.page.HideDialog(),a.a.page.addNewTab({component:l,params:{obj:m}})));case 10:case"end":return t.stop()}}),t,this)})))}},{key:"GetReportFilterXML",value:function(e,t){var s=this,i="";t.strXML="";var a=this.ScreenObject.Data.Tables[8];a=a.filter((function(t){return t.ReportID==e}));var n,r=!1;a.forEach((function(e){Object(o.j)(e.GroupLevel)&&(r=!0)})),i+="<XML",r&&(i+=' GroupLevel="1"'),i+=" >";for(var l=function(e){n=a[e].ReportField.toString(),i+="<Row ",i+='ColID ="'+n+'" ';for(var t=0;t<s.ScreenObject.HeaderFields.length;t++)if(s.ScreenObject.HeaderFields[t].DBColumnID==parseInt(a[e].DocumentField.toString()))if(s.ScreenObject.HeaderFields[t]instanceof O.e){if(""==s.Customer.Text)return{v:(alert(s.ErrorMessage+s.Customer.Label+" '"),"Empty Value")};i+='Value ="'+s.Customer.SelectedValue+'" '}else if(s.ScreenObject.HeaderFields[t]instanceof b.d){if(""==s.ScreenObject.HeaderFields[t].Text)return{v:(alert(s.ErrorMessage+s.ScreenObject.HeaderFields[t].Label+" '"),"Empty Value")};"SNO"==a[e].SysColumnName.toString()?i+='Value ="'+s.ReportDimension.SelectedValue+'" ':i+='Value ="'+s.ScreenObject.HeaderFields[t].Text+'" '}else if(s.ScreenObject.HeaderFields[t]instanceof F.a){if(""==s.ScreenObject.HeaderFields[t].TextBox.Text||""==s.ScreenObject.HeaderFields[t].ComboBox.SelectedValue)return{v:(alert(s.ErrorMessage+s.ScreenObject.HeaderFields[t].Label+" '"),"Empty Value")};i+='Value ="'+s.ScreenObject.HeaderFields[t].ComboBox.SelectedValue+'" '}else if(s.ScreenObject.HeaderFields[t]instanceof b.c){if(""==s.ScreenObject.HeaderFields[t].Text)return{v:(alert(s.ErrorMessage+s.ScreenObject.HeaderFields[t].Label+" '"),"Empty Value")};i+='Value ="'+s.ScreenObject.HeaderFields[t].Text+'" '}else if(s.ScreenObject.HeaderFields[t]instanceof S.a||s.ScreenObject.HeaderFields[t]instanceof S.d||s.ScreenObject.HeaderFields[t]instanceof S.c){if(s.ScreenObject.HeaderFields[t]instanceof S.a||s.ScreenObject.HeaderFields[t]instanceof S.d){if(""==s.ScreenObject.HeaderFields[t].Text)return{v:(alert(s.ErrorMessage+s.ScreenObject.HeaderFields[t].Label+" '"),"Empty Value")};i+='Value ="'+s.ScreenObject.HeaderFields[t].Date.ToString("dd/MMM/yyyy")+'" '}else if(s.ScreenObject.HeaderFields[t]instanceof S.c){if(!s.ScreenObject.HeaderFields[t].Date)return{v:(alert(s.ErrorMessage+s.ScreenObject.HeaderFields[t].Label+" '"),"Empty Value")};i+='Value ="'+s.ScreenObject.HeaderFields[t].Date.ToString("dd/MMM/yyyy")+'" '}}else if(s.ScreenObject.HeaderFields[t]instanceof O.b){if(""==s.ScreenObject.HeaderFields[t].Text)return{v:(alert(s.ErrorMessage+s.ScreenObject.HeaderFields[t].Label+" '"),"Empty Value")};i+='Value ="'+s.ScreenObject.HeaderFields[t].SelectedValue+'" '}else if(s.ScreenObject.HeaderFields[t]instanceof G.a){if(""==s.ScreenObject.HeaderFields[t].Text)return{v:(alert(s.ErrorMessage+s.ScreenObject.HeaderFields[t].Label+" '"),"Empty Value")};i+='Value ="'+s.ScreenObject.HeaderFields[t].SelectedValue+'" '}s.ScreenObject.CustomTab.Pages.forEach((function(t){t.Fields.forEach((function(t){if(null!=t&&(t instanceof b.d||t instanceof F.a||t instanceof b.c||t instanceof S.a||t instanceof S.d||t instanceof S.c||t instanceof O.b||t instanceof G.a)&&t.DBColumnID==parseInt(a[e].DocumentField.toString()))if(t instanceof b.d){if(""==t.Text)return alert(s.ErrorMessage+t.Label+" '"),"Empty Value";i+='Value ="'+t.Text+'" '}else if(t instanceof F.a){if(""==t.TextBox.Text||""==t.ComboBox.SelectedValue)return alert(s.ErrorMessage+t.Label+" '"),"Empty Value";i+='Value ="'+t.TextBox.Text+'" '}else if(t instanceof b.c){if(""==t.Text)return alert(s.ErrorMessage+t.Label+" '"),"Empty Value";i+='Value ="'+t.Text+'" '}else if(t instanceof S.a||t instanceof S.d||t instanceof S.c){if(t||t){if(""==t.Text)return alert(s.ErrorMessage+t.Label+" '"),"Empty Value";i+='Value ="'+t.Date.ToString("dd/MMM/yyyy")+'" '}else if(t instanceof S.c){if(!t.Date)return alert(s.ErrorMessage+t.Label+" '"),"Empty Value";i+='Value ="'+t.Date.ToString("dd/MMM/yyyy")+'" '}}else if(t instanceof O.b){if(""==t.Text&&0==t.SelectedValue)return alert(s.ErrorMessage+t.Label+" '"),"Empty Value";i+='Value ="'+t.SelectedValue+'" '}else if(t instanceof G.a){if(""==t.Text)return alert(s.ErrorMessage+t.Label+" '"),"Empty Value";i+='Value ="'+t.SelectedValue+'" '}}))})),i+=" />"},u=0;u<a.length;u++){var c=l(u);if("object"==typeof c)return c.v}return i+="</XML>",t.strXML=i.toString(),""}},{key:"OnShowContact",value:function(){}},{key:"OnAddContact",value:function(){}},{key:"AddCustomer",value:function(){this.ScreenObject.HeaderFields.Remove(this.Customer);var e=new O.e;e.SectionSeqNo=this.Customer.SectionSeqNo,e.Row=this.Customer.Row,e.Column=this.Customer.Column,e.ColumnSpan=this.Customer.ColumnSpan,e.DBColumnID=this.Customer.DBColumnID,this.ScreenObject.HeaderFields.push(e),this.ReportInfoVisibility=!1}},{key:"onStatusChanged",value:function(e){return this.Status.SelectedValue==this.CloseStatus?(this.DisplayMessage="Use close process",void(this.Status.SelectedValue=this.prevstatus)):this.Status.SelectedValue==this.AssignStatus?(this.DisplayMessage="Use assign process",void(this.Status.SelectedValue=this.prevstatus)):void(this.prevstatus=this.Status.SelectedValue)}},{key:"OnContractLineChange",value:function(e){var t=this;if(Logger.InfoLog("AddEditCaseViewModel:: OnContractLineChange Begin"),null!=this.ContractLine&&this.ContractLine.Items.length>0&&"0"!=this.ContractLine.SelectedValue&&null!=this.dsetContract&&this.dsetContract.length>0){var s=this.dsetContract.filter((function(e){return e.ContractLineID==t.ContractLine.SelectedValue}));s.length>0&&(this.Product.SelectedValue=s[0].ProductID.toString(),this.SerialNumber.Text=s[0].SerialNumber.toString(),this.CheckWarranty())}Logger.InfoLog("AddEditCaseViewModel:: OnContractLineChange End")}},{key:"OnSerialNo_LostFoucs",value:function(e){this.CheckWarranty()}},{key:"CheckWarranty",value:function(){}},{key:"OnLoad",value:function(){this.AssignRowColumns();for(var e=this.ScreenObject.CustomTab.Pages.length-1;e>=0;e--){var t=this.ScreenObject.CustomTab.Pages[e];switch(t.Name){case"Contacts":t.Fields.push(this.ViewContacts);break;case"Products":t.Fields.push(this.ProductGrid);break;case"Activities":t.Fields.push(this.ViewActivities);break;case"History":t.Fields.push(this.ViewAssignHistroy.ListObj);break;case"Notes":t.Fields.push(this.ViewNotes);break;case"Attachments":t.Fields.push(this.ViewAttachments);break;case"Follow Up":t.Fields.push(this.ViewFeedback)}}}},{key:"AssignRowColumns",value:function(){for(var e=this.ScreenObject.CustomFields.length,t=0;t<e;t++)this.ScreenObject.CustomFields[t].Row=t/4,this.ScreenObject.CustomFields[t].Column=t%4}},{key:"AddActivity",value:function(){null!=this.Activities.CRMCustomer&&(this.Activities.CRMCustomer.Text=this.Customer.Text),0!=this.CustomerMode&&(null!=this.Activities.CRMCustomer&&(this.Activities.CRMCustomer.Code.CCID=this.Customer.CCID,this.Activities.CRMCustomer.Code.TypeID=this.Customer.TypeID),this.Activities.CRMCustomer.Text=this.Customer.Text,this.Activities.CRMCustomer.Code.SelectedValue=this.Customer.SelectedValue,this.Activities.onCustomerSelectionChange("Customer")),null!=this.Activities.Location&&(this.Activities.Location.Text=a.a.SessionManager.LocationName)}},{key:"onTabSelectionChanged",value:function(e){null!=this.ScreenObject.CustomTab.SelectedTab&&("Activities"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.ScreenObject.CustomTab.ColumnSpan=4,this.setVisibilityoff(),this.Activities.IsPopup||(this.ActVisibility=!0),this.AddActivity(),this.Activities.Location.Enable=!1,this.Activities.AssignVisiblity=!1,this.Activities.CRMCustomer.Enable=!1):"Notes"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.ViewNotes.OnShowNewNote(null),this.setVisibilityoff(),this.NoteVisibility=!0):"Contacts"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.ScreenObject.CustomTab.ColumnSpan=4,this.setVisibilityoff(),this.ContactVisibility=!0,this.ViewContacts.OnShowNewContact(null)):"Attachments"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.setVisibilityoff(),this.ViewAttachments.ButtonAdd.Enable&&this.ViewAttachments.ButtonAdd.Visible&&(this.ViewAttachments.OnShowNewAttachment(null),this.AttachmentVisibility=!0)):"Follow Up"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.ScreenObject.CustomTab.ColumnSpan=4,this.Feedback=new c.a(this.ViewFeedback),this.setVisibilityoff()):this.setVisibilityoff())}},{key:"LoadData",value:function(){var e=this;if(this.RefCCID=0,this.RefNodeID=0,(this.ScreenObject.InheritParentCode||this.ScreenObject.IsAutoCode)&&(this.CName.Enable=!1),this.dsLoad.Tables.length>4&&this.dsLoad.Tables[4].length>0){if(this.Casesmodel.GUID=this.dsLoad.Tables[4][0].GUID.toString(),this.dsLoad.Columns[4].Contains("RefCCID")&&""!=this.dsLoad.Tables[4][0].RefCCID.toString()&&(this.RefCCID=parseInt(this.dsLoad.Tables[4][0].RefCCID.toString())),this.dsLoad.Columns[4].Contains("RefNodeID")&&""!=this.dsLoad.Tables[4][0].RefNodeID.toString()&&(this.RefNodeID=parseInt(this.dsLoad.Tables[4][0].RefNodeID.toString())),this.CName.PrefixVisibility=!1,this.CName.SuffixVisibility=!1,this.CDate=new Date(this.dsLoad.Tables[4][0].CDAte),this.CName.Text=this.dsLoad.Tables[4][0].CaseNumber.toString(),null!=this.dsLoad.Tables[4][0].StatusID.toString()&&""!=this.dsLoad.Tables[4][0].StatusID.toString()&&(this.ScreenObject.Data.Tables[5].forEach((function(t){"1001"!=e.dsLoad.Tables[4][0].StatusID.toString()&&"1002"!=e.dsLoad.Tables[4][0].StatusID.toString()&&"1003"!=e.dsLoad.Tables[4][0].StatusID.toString()||!t.Table.Columns.Contains("IsVisible")||""==t.IsVisible.toString()||Object(o.j)(t.IsVisible)||e.Status.Items.push(D.d.ComboBoxItems_2(t.Name.toString(),t.NodeID.toString()))})),this.Status.SelectedValue=this.dsLoad.Tables[4][0].StatusID.toString(),this.prevstatus=this.Status.SelectedValue),null!=this.Status.SelectedValue&&""!=this.Status.SelectedValue&&this.Status.SelectedValue==this.CloseStatus&&(a.a.SessionManager.IsActionAssigned(this.CostCenterID,"Allow Edit For Close Tickets")||(this.ButtonSave.Enable=!1,this.DisplayMessage="Case is closed cannot be edited")),this.Group.SelectedValue=parseInt(this.dsLoad.Tables[4][0].ParentID),this.dsLoad.Columns[4].Contains("CustomerMode")&&null!=this.dsLoad.Tables[4][0].CustomerMode.toString()&&""!=this.dsLoad.Tables[4][0].CustomerMode.toString()?(this.CustomerMode=""!=this.dsLoad.Tables[4][0].CustomerMode.toString()&&"0"!=this.dsLoad.Tables[4][0].CustomerMode.toString()?parseInt(this.dsLoad.Tables[4][0].CustomerMode):1,1==this.CustomerMode?(this.Customer.CCID=2,this.Customer.TypeID=2,this.Customer.Refresh(),this.Customer.DBColumnName="AccountID"):2==this.CustomerMode&&(this.Customer.CCID=83,this.Customer.TypeID=1,this.Customer.Refresh(),this.Customer.DBColumnName="CustomerID")):(this.Customer.CCID=2,this.Customer.TypeID=2,this.Customer.Refresh(),this.Customer.DBColumnName="AccountID"),null!=this.dsLoad.Tables[4][0].CustomerID.toString()&&""!=this.dsLoad.Tables[4][0].CustomerID.toString()&&(this.Customer.SelectedValue=parseInt(this.dsLoad.Tables[4][0].CustomerID)),this.Customer.SelectedValue>0&&this.ScreenObject.OnGetReference(this.Customer),n.e.IsEmpty(this.dsLoad.Tables[4][0].SerialNumber)||(this.SerialNumber.Text=this.dsLoad.Tables[4][0].SerialNumber.toString()),n.e.IsEmpty(this.dsLoad.Tables[4][0].SvcContractID)||(this.Contract.Items.push(D.d.ComboBoxItems_2(n.e.StringValue(this.dsLoad.Tables[4][0].VoucherNo),this.dsLoad.Tables[4][0].SvcContractID.toString())),this.Contract.SelectedValue=this.dsLoad.Tables[4][0].SvcContractID.toString()),n.e.IsEmpty(this.dsLoad.Tables[4][0].ContractLineID)||null!=this.ContractLine&&(this.ContractLine.SelectedValue=this.dsLoad.Tables[4][0].ContractLineID.toString()),n.e.IsEmpty(this.dsLoad.Tables[4][0].CaseTypeLookupID)||(this.CaseType.SelectedValue=this.dsLoad.Tables[4][0].CaseTypeLookupID.toString()),n.e.IsEmpty(this.dsLoad.Tables[4][0].ProductID)||(this.Product.Items.push(D.d.ComboBoxItems_2(this.dsLoad.Tables[4][0].ProductName.toString(),this.dsLoad.Tables[4][0].ProductID.toString())),this.Product.SelectedValue=this.dsLoad.Tables[4][0].ProductID.toString()),n.e.IsEmpty(this.dsLoad.Tables[4][0].CaseOriginLookupID)||(this.CaseOrigin.SelectedValue=this.dsLoad.Tables[4][0].CaseOriginLookupID.toString()),null!=this.dsLoad.Tables[4][0].BillingMethod.toString()&&""!=this.dsLoad.Tables[4][0].BillingMethod.toString()&&(this.Billing.SelectedValue=this.dsLoad.Tables[4][0].BillingMethod.toString()),"140"==this.Billing.SelectedValue&&(this.Casesmodel.User=parseInt(this.dsLoad.Tables[4][0].WaiveBy),n.e.isValidDate(this.dsLoad.Tables[4][0].WaiveDate1)&&(this.Casesmodel.WaveDate=new Date(this.dsLoad.Tables[4][0].WaiveDate1)),this.Casesmodel.Comments=this.dsLoad.Tables[4][0].Comments.toString()),n.e.IsEmpty(this.dsLoad.Tables[4][0].Mode)||(this.Mode.SelectedValue=this.dsLoad.Tables[4][0].Mode.toString()),n.e.IsEmpty(this.dsLoad.Tables[4][0].ServiceLvlLookupID.toString())||(this.ServiceLevel.SelectedValue=this.dsLoad.Tables[4][0].ServiceLvlLookupID),n.e.IsEmpty(this.dsLoad.Tables[4][0].CreatedBy)||(this.Owner.Text=this.dsLoad.Tables[4][0].CreatedBy.toString()),n.e.IsEmpty(this.dsLoad.Tables[4][0].CreatedDate1)||(this.CreatedDate.Text=new Date(this.dsLoad.Tables[4][0].CreatedDate1.toString()).ToString(a.a.SessionManager.Preferences["Date Format"].toString())),n.e.IsEmpty(this.dsLoad.Tables[4][0].Subject)||(this.Subject.Text=this.dsLoad.Tables[4][0].Subject.toString()),n.e.IsEmpty(this.dsLoad.Tables[4][0].AssignedUser)||(this.AssignedBy.Text=this.dsLoad.Tables[4][0].AssignedUser.toString()),n.e.IsEmpty(this.dsLoad.Tables[4][0].ADate)||(this.AssignedDate.Text=new Date(this.dsLoad.Tables[4][0].ADate.toString()).ToString(a.a.SessionManager.Preferences["Date Format"].toString())),this.dsLoad.Tables.length>5&&this.dsLoad.Tables[5].length>0)for(var t=0;t<this.dsLoad.Tables[5].length;t++){var s=this.ReasonsObj.NewRow();s.ServiceTypeID=this.dsLoad.Tables[5][t].ServiceTypeID.toString(),s.ServiceReasonID=this.dsLoad.Tables[5][t].ServiceReasonID.toString(),s.ServiceReasonID_Key=this.dsLoad.Tables[5][t].Reason.toString(),s.VoiceOfCustomer=this.dsLoad.Tables[5][t].VoiceOfCustomer.toString(),s.NODEID=this.dsLoad.Tables[5][t].Techincian.toString(),s.NODEID_Key=this.dsLoad.Tables[5][t].NODEID_Key.toString(),s.TechComments=this.dsLoad.Tables[5][t].TechinicianComments.toString(),this.ReasonsObj.addRow(s)}if(null!=this.dsLoad&&this.dsLoad.Tables.length>6&&this.dsLoad.Tables[6].length>0&&this.ScreenObject.LoadCustomFieldsData(this.dsLoad.Tables[6]),this.ViewAssignHistroy.LoadHistroy_1(73,this.Casesmodel.CaseID),null!=this.dsLoad&&this.dsLoad.Tables.length>7&&this.dsLoad.Tables[7].length>0&&this.ViewActivities.LoadActivityData(this.dsLoad.Tables[7]),null!=this.dsLoad&&this.dsLoad.Tables.length>8&&this.dsLoad.Tables[8].length>0&&this.ScreenObject.LoadCustomFieldsCCData(this.dsLoad.Tables[8]),null!=this.dsLoad&&this.dsLoad.Tables.length>9&&this.dsLoad.Tables[9].length>0&&this.ProductGrid.LoadProductData(this.dsLoad.Tables[9],this.dsLoad.Columns[9]),null!=this.dsLoad&&this.dsLoad.Tables.length>10&&this.dsLoad.Tables[10].length>0&&this.ViewNotes.LoadNotes(this.dsLoad.Tables[10]),null!=this.dsLoad&&this.dsLoad.Tables.length>11&&this.dsLoad.Tables[11].length>0&&this.ViewAttachments.LoadAttachments(this.dsLoad.Tables[11]),null!=this.dsLoad&&this.dsLoad.Tables.length>12&&this.dsLoad.Tables[12].length>0&&this.ViewFeedback.LoadData(this.dsLoad.Tables[12]),null!=this.dsLoad&&this.dsLoad.Tables.length>13&&this.dsLoad.Tables[13].length>0&&this.ViewContacts.LoadContacts_1(this.dsLoad.Tables[13]),a.a.SessionManager.IsWebApplication||this.LoadReport(),this.dsLoad.Columns[4].Contains("WorkFlowID")&&this.dsLoad.Tables[4].length>0&&null!=this.dsLoad.Tables[4][0].WorkFlowID&&parseInt(this.dsLoad.Tables[4][0].WorkFlowID.toString())>0&&(this.Casesmodel.Wid=parseInt(this.dsLoad.Tables[4][0].WorkFlowID.toString()),this.btnHistoryVisible=!0,""!=this.dsLoad.Tables[4][0].canApprove.toString()&&Object(o.j)(this.dsLoad.Tables[4][0].canApprove.toString())&&(this.BtnApprove.Visible=!0,this.ButtonSave.Enable=!1),""!=this.dsLoad.Tables[4][0].canEdit.toString()&&Object(o.j)(this.dsLoad.Tables[4][0].canEdit.toString())&&(this.ButtonSave.Enable=!!a.a.SessionManager.IsActionAssigned(this.CostCenterID,"Edit Approved Contracts")),"1002"!=this.Status.SelectedValue&&"1001"!=this.Status.SelectedValue&&"1003"!=this.Status.SelectedValue||(this.PrintVisible=!1,this.PrintViewVisible=!1,this.ButtonAssign.Visible=!1,this.ButtonClose.Visible=!1,this.ButtonEmail.Visible=!1,this.ButtonWaive.Visible=!1,this.Status.IsReadOnly=!0),this.dsLoad.Tables.length>14&&this.dsLoad.Columns[14].Contains("WorkFlowLevel"))){var i,r;i=this.dsLoad.Tables[15],r=this.dsLoad.Tables[14];var l=0;""!=this.dsLoad.Tables[4][0].WorkFlowLevel.toString()&&(l=parseInt(this.dsLoad.Tables[4][0].WorkFlowLevel.toString())),r.length>0&&parseInt(r[r.length-1].StatusID);for(var u=r.length>0?parseInt(r[0].WorkFlowLevel)-1:0,c=0;c<i.length;c++){var d=new B.a(parseInt(i[0].WID),parseInt(i[c].LevelID),i[c].LevelName.toString(),this.CostCenterID,this.CostCenterID,this.CaseDate.Date);c==u&&(d.IsPending=!0,d.Label="C"),0==c&&(d.LeftLineBrush="#FFFFFFFF"),c==i.length-1&&(d.RightLineBrush="#FFFFFFFF"),this.WFDocLevelList.push(d)}for(var C=r.length-1;C>=0;C--){var m=parseInt(r[C].WorkFlowLevel);if(m<=l&&m<=this.WFDocLevelList.length&&!this.WFDocLevelList[m-1].IsSet){this.WFDocLevelList[m-1].IsSet=!0,this.WFDocLevelList[m-1].ModifiedBy=r[C].Status.toString()+" By "+r[C].CreatedBy.toString(),r[C].FirstName.toString().length>0&&(this.WFDocLevelList[m-1].ModifiedBy+="("+r[C].FirstName.toString()+")");var h=new Date(r[C].Date);this.WFDocLevelList[m-1].ModifiedBy+=" On "+h.ToString(a.a.SessionManager.Preferences["Date Format"]);var b=parseInt(r[C].StatusID);1003==b?this.WFDocLevelList[m-1].IsRejected=!0:1002==b?this.WFDocLevelList[m-1].IsApproved=!0:426!=b&&427!=b||(this.WFDocLevelList[m-1].IsPending=!0,this.WFDocLevelList[m-1].Label=" P")}}}}}},{key:"setVisibilityoff",value:function(){this.AttachmentVisibility=!1,this.FeedbackVisibility=!1,this.NoteVisibility=!1,this.WaiveVisibility=!1,this.ActVisibility=!1,this.ContactVisibility=!1,this.CloseVisiblity=!1,this.AssignVisiblity=!1}},{key:"OnSave",value:function(e){return Object(i.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i,o,r,u,c,d,C,m,h,S,D,g,p,I,y,T,f,P,O,V,M,L,w,B;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.e(112).then(s.bind(null,"wunX"));case 2:return i=t.sent,o=i.CloseLeadComponent,t.next=6,Promise.resolve().then(s.bind(null,"yWgc"));case 6:return r=t.sent,u=r.AssignFeatureComponent,t.next=10,Promise.resolve().then(s.bind(null,"wnwj"));case 10:return c=t.sent,d=c.SendEmailSMSViewModel,t.next=14,Promise.resolve().then(s.bind(null,"7i9q"));case 14:return C=t.sent,m=C.SendEmailSMSComponent,t.next=18,Promise.resolve().then(s.bind(null,"5FTv"));case 18:if(h=t.sent,S=h.VoucherExportExcel,"Assign"==e.toString()&&(this.setVisibilityoff(),(this.CaseID>0||null==this.AssignFeature)&&(this.AssignVisiblity=!0),this.AssignFeature=new R.AssignFeatureViewModel,this.AssignFeature.AssignFeatureViewModel_1(this,this.CaseID,73),a.a.page.ShowDialog(this.AssignFeature,u)),"ChangeCustomer"!=e.toString()){t.next=24;break}this.CaseSearch=new N,this.CaseSearch.CaseSearchViewModel_2(this),a.a.page.ShowDialog(this.CaseSearch,j.a,{ShowCenter:!0,Title:"Search"}),t.next=94;break;case 24:if("Print"!=e&&"PrintPreview"!=e||!(this.CaseID>0)){t.next=29;break}D=S.GetLocationPrintLayouts(this.CostCenterID,1,this.CaseID),a.a.report.ExportPDF_Masters(this.CostCenterID,this.CaseID.toString(),parseInt(D.Tables[0].DocPrintLayoutID),"PDF").subscribe((function(t){console.log(t),"Print"!=e&&"PrintPreview"!=e||setTimeout((function(){a.a.SessionManager.printTab(t.FileName)}),500)}),(function(e){console.log(e)})),t.next=94;break;case 29:if(!("Close"==e&&this.CaseID>0)){t.next=36;break}if(null!=(g=a.a.common.GetDataSet("CRM003",this.CaseID.toString()))&&g.Tables.length>0&&0==g.Tables[0].length){t.next=33;break}return t.abrupt("return",(this.DisplayMessage="Activities are pending, Close all activities to close Case",void(this.ReportInfoVisibility=!1)));case 33:this.CloseCase=new l.a(this.CaseID,this,73),a.a.page.ShowDialog(this.CloseCase,o,{ShowCenter:!0,NoWidth:!0}),this.ReportInfoVisibility=!1,t.next=94;break;case 36:if("WaiveOff"!=e.toString()){t.next=40;break}this.setVisibilityoff(),this.WaiveVisibility=!0,this.Comments=new b.d(0),this.Comments.Label="Comments",this.User.SelectedValue=a.a.SessionManager.UserID.toString(),this.WaiveOffDate.Text=(new Date).ToString(a.a.SessionManager.Preferences["Date Format"].toString()),a.a.page.ShowDialog(this,v.a,{ShowCenter:!1,NoWidth:!0,Title:"Waive Off"}),t.next=94;break;case 40:if("Report"!=e.toString()){t.next=44;break}this.setVisibilityoff(),this.ReportInfoVisibility=!0,a.a.page.ShowDialog(this,E.a,{Title:"Reports"}),t.next=94;break;case 44:if("Cancel"!=e.toString()){t.next=48;break}this.ReportInfoVisibility=!1,t.next=94;break;case 48:if("SaveWave"!=e.toString()){t.next=54;break}if(""!=this.User.SelectedValue){t.next=51;break}return t.abrupt("return",void(this.DisplayMessage="Please Select User"));case 51:this.Billing.SelectedValue="140",this.Casesmodel.User=parseInt(this.User.SelectedValue),this.Casesmodel.Comments=this.Comments.Text,this.Casesmodel.WaveDate=new Date(this.WaiveOffDate.Text),this.WaiveVisibility=!1,a.a.page.HideDialog(),t.next=94;break;case 54:if("CancelWave"!=e.toString()){t.next=58;break}this.User.SelectedValue=a.a.SessionManager.UserID.toString(),this.WaiveVisibility=!1,a.a.page.HideDialog(),t.next=94;break;case 58:if("Save"!=e){t.next=93;break}if(t.prev=59,0!=this.Customer.SelectedValue){t.next=62;break}return t.abrupt("return",(this.DisplayMessage="Select "+this.Customer.Label,void(this.MessageVisibility=!0)));case 62:if(this.Casesmodel.CaseID=this.CaseID,0!=this.Casesmodel.CaseID||!this.AllowCreationofCase||n.e.IsEmpty(this.lstatusid)){t.next=68;break}if(p=0,I=0,y="",2==this.Customer.CCID?I=1:83==this.Customer.CCID&&(I=2),!(null!=(T=a.a.common.GetDataSet3("CRM002",this.lstatusid.toString().Replace(";",","),I.toString(),this.Customer.SelectedValue.toString()))&&T.Tables.length>0&&T.Tables[0].length>0&&""!=T.Tables[0][0][0].toString()&&(p=parseInt(T.Tables[0][0][1].toString()),y=T.Tables[0][0][0].toString(),p>0&&!confirm("Case already opened with Customer and Case Number is "+y+", Are you sure you want to continue?")))){t.next=68;break}return t.abrupt("return");case 68:if(0!=this.Casesmodel.CaseID||null==this.ViewActivities||!this.ActMandatory||0!=this.ViewActivities.ActivityGridData.length){t.next=70;break}return t.abrupt("return",void alert("Activity is mandatory"));case 70:if(P=this.ScreenObject.ValidateData(),n.e.IsEmpty(P)){t.next=73;break}return t.abrupt("return",void(this.DisplayMessage=P));case 73:if(0!=this.Casesmodel.CaseID){t.next=79;break}if(O={StrCode:this.Casesmodel.CaseNumber,CodePrefix:this.Casesmodel.CodePrefix,CodeNumber:this.Casesmodel.CodeNumber},this.DisplayMessage=this.ScreenObject.SetAutoCodeParams_2(this.CName,this.ParentId,this.ScreenObject.Data.Tables[7],this.CDate,O),this.Casesmodel.CaseNumber=O.StrCode,this.Casesmodel.CodePrefix=O.CodePrefix,this.Casesmodel.CodeNumber=O.CodeNumber,!(this.DisplayMessage.length>0)){t.next=77;break}return t.abrupt("return");case 77:t.next=80;break;case 79:this.Casesmodel.CaseNumber=this.CName.Text;case 80:if(null!=this.CaseDate.Date){t.next=82;break}return t.abrupt("return",void(this.DisplayMessage="Please Enter Case Date"));case 82:if(this.Casesmodel.CaseDate=new Date(this.CaseDate.Date.ToString("dd/MMM/yyyy")),this.Casesmodel.StatusID=""!=this.Status.SelectedValue?parseInt(this.Status.SelectedValue):0,this.Casesmodel.Group=this.Group.SelectedValue,this.Casesmodel.IsGroup=!1,this.Casesmodel.Customer=this.Customer.SelectedValue,this.Casesmodel.CaseTypeID=this.CaseType.SelectedValue,this.Casesmodel.CaseOriginID=this.CaseOrigin.SelectedValue,this.Casesmodel.CasePriorityID=this.CasePriority.SelectedValue,this.Casesmodel.Mode=""!=this.Mode.SelectedValue?this.Mode.SelectedValue:"Manual",this.Casesmodel.ServiceLevelID=parseInt(this.ServiceLevel.SelectedValue),this.Casesmodel.SVCContractID="0"!=this.Contract.SelectedValue&&null!=this.Contract.SelectedValue&&""!=this.Contract.SelectedValue?parseInt(this.Contract.SelectedValue):0,this.Casesmodel.ContractID=""!=this.ContractLine.SelectedValue?parseInt(this.ContractLine.SelectedValue):0,this.Casesmodel.ProductID=""!=this.Product.SelectedValue?parseInt(this.Product.SelectedValue):1,this.Casesmodel.ProductXML=this.ProductGrid.GetProductXML(),this.Casesmodel.FeedbackXML=this.ViewFeedback.GetXML(),this.Casesmodel.Billing=""!=this.Billing.SelectedValue?parseInt(this.Billing.SelectedValue):0,this.Casesmodel.SerialNo=this.SerialNumber.Text,this.Casesmodel.Description="",this.Casesmodel.Subject=this.Subject.Text,this.Casesmodel.CustomFieldsQuery=this.ScreenObject.GetCustomFieldsQuery(),this.Casesmodel.CustomCCQuery=this.ScreenObject.GetCustomCostCenterFieldsQuery(),this.Reasons.length>0){for(V="",V+="<XML>",M=0;M<this.Reasons.length;M++)V+="<Row Rowno='"+M.toString()+"'",V+=" SeviceType='"+this.Reasons[M].ServiceTypeID.toString()+"'",V+=" ServiceReasonID='"+this.Reasons[M].ServiceReasonID.toString()+"'",V+=" VoiceOfCustomer='"+this.Reasons[M].VoiceOfCustomer.toString()+"'",V+=" NODEID='"+this.Reasons[M].NODEID.toString()+"'",V+=" TechComments='"+this.Reasons[M].TechComments.toString()+"' />";V+="</XML>",this.Casesmodel.ServiceXML=V.toString()}if(this.Casesmodel.ActivityXml=this.ViewActivities.ActivitiesXML(),this.AutoActivity&&0==this.CaseID&&(n.e.IsEmpty(this.Casesmodel.ActivityXml)||"<ScheduleActivityXml></ScheduleActivityXml>"==this.Casesmodel.ActivityXml)&&(this.AddActivity(),null!=this.Activities.Subject&&null!=this.Subject&&(this.Activities.Subject.Text=this.Subject.Text),null!=this.Activities.Status&&n.e.IsEmpty(this.Activities.Status.SelectedValue)&&(this.Activities.Status.SelectedValue="412"),this.Activities.onSaveActivity("Save"),this.Casesmodel.ActivityXml=this.ViewActivities.ActivitiesXML()),this.Casesmodel.NoteXML=this.ViewNotes.GetXML(),this.Casesmodel.AttachmentXML=this.ViewAttachments.GetXML(),this.Casesmodel.CustomerMode=this.CustomerMode,this.Casesmodel.CaseContacts=this.ViewContacts.GetXML(),this.Casesmodel.AssignXML=0==this.CaseID&&null!=this.AssignFeature?this.AssignFeature.AssignXML:"",0==this.CaseID&&(this.Casesmodel.Wid=this.ScreenObject.CheckWorkFlow()),this.ScreenObject.ValidateDataonSave()){t.next=85;break}return t.abrupt("return");case 85:L=this.Casesmodel.SaveCase(this.RefCCID,this.RefNodeID),f=L.RetValue,this.DisplayMessage=L.Message,this.RetValue=f,f>0&&(this.MessageVisibility=!0,this.ClearFields(),this.ScreenObject.IsAutoCode&&this.AutoGenerateCode(),this.ProductGrid.ClearGrid(),this.ViewFeedback.FeedBackDataObj.Table.Clear(),this.ViewActivities.ActivityGridDataObj.Clear(),this.ViewAssignHistroy.ListObj.Clear()),t.next=91;break;case 89:t.prev=89,t.t0=t.catch(59);case 91:t.next=94;break;case 93:"Email"==e?this.CaseID>0&&a.a.page.ShowDialog(new d(!0,this.CostCenterID,this.CaseID,this),m):"RejectVisiblity"==e.toString()?(this.setVisibilityoff(),this.RejectVisiblity=!0,this.RejectRemarks=""):"Approve"==e.toString()?(a.a.SessionManager.IsActionAssigned(this.CostCenterID,"Save Cases on approve")&&this.OnSave("Save"),0,w=this.ScreenObject.SetComStatus(this.CaseID,"Approve"==e,this.RejectRemarks,this.Casesmodel.GUID,this.CostCenterID),B=w.RetValue,this.DisplayMessage=w.Message,B>0&&(this.BtnApprove.Visible=!1,this.BtnApprove.Visible=!1,this.RejectVisiblity=!1,this.ClearFields()),this.MessageVisibility=!0):"Cancel"==e.toString()?this.setVisibilityoff():"ViewHistory"==e.toString()&&a.a.page.ShowDialog(new A.DocumentDraftsViewModel(this,3),k.DocumentDraftsComponent);case 94:Logger.InfoLog("AddEditCaseViewModel:: OnSave End");case 95:case"end":return t.stop()}}),t,this,[[59,89]])})))}},{key:"OnGroupSelectionChanged",value:function(e){this.Group.SelectedValue>0&&(this.ParentId=this.Group.SelectedValue,this.AutoGenerateCode())}},{key:"AutoGenerateCode",value:function(){0==this.CaseID&&(this.Casesmodel.SelectedNodeID=this.Group.SelectedValue>0?this.Group.SelectedValue:this.ParentId,null!=this.CDate.Date?this.ScreenObject.SetAutoCode(this.CName,this.Casesmodel.IsGroup,this.ParentId,this.ScreenObject.Data.Tables[7],this.CDate):this.ScreenObject.SetAutoCode(this.CName,this.Casesmodel.IsGroup,this.ParentId,this.ScreenObject.Data.Tables[7]))}},{key:"ClearFields",value:function(){this.ButtonWaive.Visible=!1,this.CName.Text="",this.CaseDate.Text=(new Date).ToString(a.a.SessionManager.Preferences["Date Format"].toString()),this.Customer.SelectedValue=0,this.Contract.SelectedValue="0",this.ContractLine.SelectedValue="0",this.Mode.SelectedValue="Manual",this.SerialNumber.Text="",this.Casesmodel.CaseID=0,this.Product.SelectedValue="0",this.CaseType.SelectedValue=0,this.CaseOrigin.SelectedValue=0,this.CasePriority.SelectedValue=0,this.AssignedDate.Text="",this.ReasonsObj.Clear(),this.Owner.Text=a.a.SessionManager.UserName,this.CreatedDate.Text=this.AssignedDate.Text=this.CaseDate.Text,this.Billing.SelectedValue="139",this.Group.SelectedValue=1,this.ViewActivities.Activity.SelectedValue="-1",this.ViewActivities.ActivityGridDataObj.Clear(),this.ViewActivities.ActivityGridDataObj.addEmptyRow(),this.ViewActivities.ActivityGridDataObj.addEmptyRow(),this.ScreenObject.Clear(),this.Casesmodel.Comments="",this.Casesmodel.User=0,this.ViewAssignHistroy.ListObj.Clear(),this.ViewNotes.NotesListObj.Clear(),this.ViewAttachments.AttachmentsList.Clear(),this.CaseID=0,this.Casesmodel.Wid=0,this.WFDocLevelList.Clear(),this.btnHistoryVisible=!1,this.BtnApprove.Visible=!1}},{key:"OnServiceContractChange",value:function(e){if("Account"==e.toString()){if(0!=this.Customer.SelectedValue){var t=this.Casesmodel.GetServiceDetailsAtCases(this.Customer.SelectedValue);if(this.Contract.Items.Clear(),this.Product.Items.Clear(),null!=t&&t.Columns[0].Contains("VOUCHERNO")&&t.Tables[0].length>0){for(var s=0;s<t.Tables[0].length;s++)this.Contract.Items.push(D.d.ComboBoxItems_2(t.Tables[0][s].VOUCHERNO.toString(),t.Tables[0][s].DOCID.toString()));this.dvContractProducts=t.Tables[1]}}}else"Contract"==e.toString()&&"0"!=this.Contract.SelectedValue&&null!=this.Contract.SelectedValue&&this.LoadProducts()}},{key:"LoadProducts",value:function(){var e=this;if("0"!=this.Contract.SelectedValue&&null!=this.Contract.SelectedValue&&(this.Product.Items.Clear(),null!=this.dvContractProducts&&this.dvContractProducts.length>0))for(var t=this.dvContractProducts.filter((function(t){return t.DocID==e.Contract.SelectedValue})),s=0;s<t.length;s++)this.Product.Items.push(D.d.ComboBoxItems_2(t[s].ProductName.toString(),t[s].ProductID.toString()))}},{key:"OnCellEditEnding",value:function(e){try{var t=e.item;t.ServiceTypeID.toString().length>0&&(this.dvServiceTypes.filter((function(e){return e.ServiceTypeID=t.ServiceTypeID.toString()})),this.dvTechnicians.filter((function(e){return e.ServiceTypeID=t.ServiceTypeID.toString()})))}catch(s){Logger.InfoLog("AddEditCaseViewModel:: OnCellEditEnding Exception")}}},{key:"AddGridColumns",value:function(){this.BuildTempDataTable();var e=new h.a;this.dsLoad.Tables.length>3&&(this.dvServiceTypes=this.dsLoad.Tables[3]),e.ValueBinding="ServiceTypeID",e.Header=a.a.GetResource("CRMCases_Service"),e.DataType="ComboBox",e.DisplayMember="ServiceName",e.ValueMember="ServiceTypeID",e.Width=150,e.ComboData=this.dsLoad.Tables[0],this.ColLists.push(e),(e=new h.a).ValueBinding="ServiceReasonID",e.Header=a.a.GetResource("CRMCases_Reason"),e.DataType="PactComboBox",e.DisplayMember="Reason",e.ValueMember="ServiceReasonID",e.FilterCondition="ServiceTypeID={0}",e.FilterColumn="ServiceTypeID",e.Width=150,e.ComboData=this.dvServiceTypes,this.ColLists.push(e),this.dsLoad.Tables.Count>1&&(this.dvServiceTypes=this.dsLoad.Tables[1]),(e=new h.a).DisplayMember="VoiceOfCustomer",e.Header=a.a.GetResource("CRMCases_VoiceOfCustomer"),e.DataType="TextBlock",e.Width=300,e.IsVisible=!0,this.ColLists.push(e),this.dsLoad.Tables.length>2&&(this.dvTechnicians=this.dsLoad.Tables[2]),(e=new h.a).ValueBinding="NODEID",e.Header=a.a.GetResource("CRMCases_Technician"),e.DataType="PactComboBox",e.DisplayMember="Technician",e.ValueMember="NODEID",e.FilterCondition="ServiceTypeID={0}",e.FilterColumn="ServiceTypeID",e.Width=150,e.ComboData=this.dvTechnicians,this.ColLists.push(e),(e=new h.a).DisplayMember="TechComments",e.Header=a.a.GetResource("CRMCases_TechComments"),e.DataType="TextBlock",e.Width=400,e.IsVisible=!0,this.ColLists.push(e),this.ColumnSource=this.ColLists,this.ReasonsObj.Columns=this.ColLists;for(var t=0;t<this.dsLoad.Tables[3].length;t++)this.User.Items.push(D.d.ComboBoxItems_2(this.dsLoad.Tables[3][t].UserName.toString(),this.dsLoad.Tables[3][t].UserID.toString()));this.Group.SelectedValue=0==this.Casesmodel.SelectedNodeID?1:this.Casesmodel.SelectedNodeID,this.Owner.Text=a.a.SessionManager.UserName,this.CreatedDate.Text=(new Date).ToString(a.a.SessionManager.Preferences["Date Format"].toString()),this.AssignedDate.Text=this.CreatedDate.Text,Logger.InfoLog("AddEditCaseViewModel:: AddGridColumns Leave")}},{key:"BuildTempDataTable",value:function(){this.ReasonsObj.Table=[],this.ReasonsObj.TableColumns.push("ServiceTypeID"),this.ReasonsObj.TableColumns.push("ServiceReasonID"),this.ReasonsObj.TableColumns.push("ServiceReasonID_Key"),this.ReasonsObj.TableColumns.push("VoiceOfCustomer"),this.ReasonsObj.TableColumns.push("NODEID"),this.ReasonsObj.TableColumns.push("NODEID_Key"),this.ReasonsObj.TableColumns.push("TechComments")}},{key:"CheckIsBillable",value:function(){var e=this;if(!(this.CaseID>0)){var t=this.Casesmodel.SearchCases(0,this.Contract.SelectedValue,"",0,this.CaseDate.Date,"");if(t.Columns[0].Contains("DocID")){var s=t.Tables[0].filter((function(t){return t.DocID==e.Contract.SelectedValue}));if(s.length>0&&t.Columns[0].Contains("CaseType")){var i=0,a=0;t.Columns[0].Contains("CaseCount")&&n.e.IsNum(s[0].CaseCount)&&(a=parseInt(s[0].CaseCount.toString())),t.Columns[0].Contains("AllotedCases")&&n.e.IsNum(s[0].AllotedCases)&&(i=parseInt(s[0].AllotedCases.toString())),this.Billing.SelectedValue=a>i||"10001"==s[0].CaseType.toString()&&t.Columns[0].Contains("MonthCases")&&""!=s[0].MonthCases.toString()&&parseFloat(s[0].MonthCases.toString())>0?"139":"138"}}}}},{key:"LoadReport",value:function(){var e=this.ScreenObject.CustomTab.Pages.find((function(e){return"Documents"==e.Name}));if(null!=e&&null!=this.dsLoad){var t=this.dsLoad.Tables[1].filter((function(e){return"LinkDimension"==e.Name}));if(t.length>0&&""!=t[0].Value.toString()&&this.dsLoad.Tables[10].length>0){var s,i=0,a=0,o=parseInt(t[0].Value)-5e4;0==(a=n.e.Int(this.dsLoad.Tables[10][0].CCCaseID))&&(a=-123);var r=" AND DCC.dcCCNID"+o+"="+a,l="";if((t=this.ScreenObject.Data.Tables[4].filter((function(e){return"CreateDocuments"==e.Name}))).length>0&&""!=t[0].Value.toString()&&(l=t[0].Value.toString().Replace(";",",")),s=n.e.Int(this.dsLoad.Tables[4][0].RefCCID),i=n.e.Int(this.dsLoad.Tables[4][0].RefNodeID),l.length>0){var u="<XML><Row ColID='300' Value='"+l+"'/>";u+="<Row ColID='CRM_Cases_DocumentsTab' Value='"+r+"'/>",0!=i&&0!=s||(i=-1234),u+='<Row ColID="CRM_CasesRef_DocumentsTab" Value=" AND INV.DocID='+i+'"/>',u+="</XML>",null==this.Report?(this.Report.ShowHeaderButtons=!1,this.Report.ShowRightPanel=!1,this.Report.SearchVisibility=!1,e.Fields.Clear(),e.Fields.push(this.Report)):(this.Report.LoadDocFilterXML(u),this.Report.OnReportClick(this.Report.ReportID,0))}}}}},{key:"onDateChanged",value:function(e){this.AutoGenerateCode()}},{key:"ContactVisibility",get:function(){return this._CloseVisiblity},set:function(e){e!=this._ContactVisibility&&(this._ContactVisibility=e,this._ContactVisibility&&(this.PrintVisible=!1,this.DetailsVisibility=!1,this.FeedbackVisibility=!1))}},{key:"DetailsVisibility",get:function(){return this._DetailsVisibility},set:function(e){e!=this._DetailsVisibility&&(this._DetailsVisibility=e,this._DetailsVisibility&&(this.NoteVisibility=!1,this.AttachmentVisibility=!1))}},{key:"CloseVisiblity",get:function(){return this._CloseVisiblity},set:function(e){e!=this._CloseVisiblity&&(this._CloseVisiblity=e,this._CloseVisiblity&&(this.ContactVisibility=!1,this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.ActVisibility=!1,this.ContactVisibility=!1,this.FeedbackVisibility=!1,this.WaiveVisibility=!1))}},{key:"Contact",get:function(){return this._Contact},set:function(e){e!=this._Contact&&(this._Contact=e)}},{key:"CDate",get:function(){return this._CDate},set:function(e){e!=this._CDate&&(this._CDate=e,this.CaseDate.Date=e,this.CheckIsBillable(),this.onDateChanged(this.CDate),this.CreatedDate.Text=this.AssignedDate.Text=this.CaseDate.Text)}},{key:"Reasons",get:function(){return this.ReasonsObj.Table}}]),r}(r.b)},W7OG:function(e,t,s){"use strict";s.d(t,"a",(function(){return v}));var i=s("mrSG"),a=s("Do2H"),n=s("Lp6j"),o=s("eQJW"),r=s("ScVY"),l=s("NkMH"),u=s("8B8H"),c=s("ockk"),d=s("r2z3"),C=s("CUWK"),m=s("EQd/"),h=s("0/4Q"),b=s("n56n"),S=s("4HhE"),D=s("JIg3"),g=s("Jnyl"),p=s("Huqd"),I=s("MCKn"),y=s("vTM8"),T=s("uMy8"),f=s("lUlH"),P=s("pcVU"),O=function(e){_inherits(s,e);var t=_createSuper(s);function s(e,i,n){var o;_classCallCheck(this,s),(o=t.call(this)).Save=new S.b,o.ds=null,o.ProductGridObj=new u.a,o.CustomerChecked=new S.b,o.ccid=0,o.CCNodeID=0,o.Title=o.DisplayName="Email Templates",o.Save.Subscribe(_assertThisInitialized(o),"OnSave"),o.ccid=i,o.CCNodeID=n,o.Parent=e;var r,l=null;if(l="1"==a.a.SessionManager.UserID||"1"==a.a.SessionManager.RoleID?a.a.common.GetDataSet("CRM005",i.toString()):a.a.common.GetDataSet3("CRM006",i.toString(),a.a.SessionManager.UserID,a.a.SessionManager.RoleID),o.ColumnSource=[],(r=new c.a).Header="Select",r.DisplayMember="isChecked",r.DataType="CheckBox",r.Width=50,r.IsVisible=!0,o.ColumnSource.push(r),(r=new c.a).Header="TemplateName",r.DisplayMember="TemplateName",r.Width=180,r.IsVisible=!0,r.ReadOnly=!0,o.ColumnSource.push(r),o.ProductGridObj.Table=[],o.ProductGridObj.TableColumns.push("isChecked"),o.ProductGridObj.TableColumns.push("TemplateName"),o.ProductGridObj.TableColumns.push("TemplateID"),o.ProductGridObj.Columns=o.ColumnSource,null!=l&&l.Tables[0].length>0)for(var d=0;d<l.Tables[0].length;d++){var C=o.ProductGridObj.NewRow();C[d][0]=!1,C[d][1]=l.Tables[0][d].TemplateName.toString(),C[d][2]=l.Tables[0][d].TemplateID.toString(),o.ProductGridObj.addRow(C)}return o}return _createClass(s,[{key:"OnSave",value:function(e){if("Cancel"==e)a.a.page.HideDialog();else{if(this.DisplayMessage="",this.MessageVisibility=!1,0==this.CCNodeID)return;var t="";if(null!=this.ProductGrid&&this.ProductGrid.length>0)for(var s=0;s<this.ProductGrid.length;s++)null!=this.ProductGrid[s].isChecked.toString()&&Object(o.j)(this.ProductGrid[s].isChecked)&&""!=this.ProductGrid[s].TemplateID.toString()&&(t+=this.ProductGrid[s].TemplateID.toString()+",");if(t.length>0){var i="",n="",r=null;("AddEditLeads"==this.Parent.ClassName||"AddEditCasesViewModel"==this.Parent.ClassName||"AddEditOpportunity"==this.Parent.ClassName)&&(r=this.Parent.ViewFeedback.FeedBackGrid.Table),null!=r&&r.forEach((function(e){r.Columns.Contains("Print")&&"TRUE"==e.Print.toString().toUpperCase()&&e.NodeID.toString().length>0&&parseInt(e.NodeID)>0&&(n.length>0&&(n+=","),n+=e.NodeID.toString())})),n.length>0&&(i+="<LeadFollowUp>",i+=" NodeID NOT IN ("+n+")",i+="</LeadFollowUp>"),i.length>0&&(i="<XML>"+i+"</XML>"),this.DisplayMessage=(new d.a).SetEmailTemplatesForProduct(this.ccid,this.CCNodeID,t.Trim(","),i.toString())}else this.DisplayMessage="Please select atleast one email template";this.MessageVisibility=!0}}},{key:"angularGrid",get:function(){return this.ProductGridObj.angularGrid}},{key:"ProductGrid",get:function(){return this.ProductGridObj.Table}},{key:"ProductColumnSource",get:function(){return this.ProductGridObj.Columns}}]),s}(r.b),V=s("cxZg"),v=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,s){var i;_classCallCheck(this,r),(i=t.call(this)).Module="CRM",i.Visible=!0,i.CostCenter=new h.e,i.Leadid=0,i.ColumnSpan="4",i.RowIndex=0,i.ProductGridObj=new u.a,i._SelectAll=!1,i.SerialNo=0,i.lstProducts=new Array,i.ProdID=0,i.bOnClick=!1,i.CRMProductCCID=0,i.CostCenterID=0,i.SrcProductValueMapping="",i.DestProductValueMapping="",i.DS=null,i.dbCRMProduct=null,i.SelectUnCheck=0,i.parent=e,i.CostCenterID=s,i.ClassName="LeadsProductViewModel",i.CostCenter.Label=a.a.GetResource("Preferences_CreateDocuments"),i.CostCenter.LblWidth="120",i.ProductGridObj.SelectAll.Visible=!0,i.ButtonEmail=new l.a,a.a.SessionManager.HideUnathorizedAccess?i.ButtonEmail.Visible=a.a.SessionManager.IsActionAssigned(i.CostCenterID,"Product_Email"):i.ButtonEmail.Enable=a.a.SessionManager.IsActionAssigned(i.CostCenterID,"Product_Email"),i.ProductGridObj.CellEditEnding.Subscribe(_assertThisInitialized(i),"OnCellEditEnding"),i.ProductGridObj.BeginEdit.Subscribe(_assertThisInitialized(i),"onBeginEdit"),i.CRMProductCCID="0"!=a.a.SessionManager.Preferences["CRM-Products"].toString()&&n.e.IsNum(a.a.SessionManager.Preferences["CRM-Products"])?parseInt(a.a.SessionManager.Preferences["CRM-Products"].toString()):3;var d,C=a.a.cases.GetPreferencesatCRM(s);if(null!=C&&C.Tables.length>0&&C.Tables[0].length>0)for(var m=0;m<C.Tables[0].length;m++)i.CostCenter.Items.push(h.d.ComboBoxItems_2(C.Tables[0][m].DOCNAME.toString(),C.Tables[0][m].DOCID.toString()));i.ProductGridObj.Table=[],i.ProductGridObj.TableColumns.push("isChecked"),i.ProductGridObj.TableColumns.push("ProductName"),i.ProductGridObj.TableColumns.push("ProductCode"),i.ProductGridObj.TableColumns.push("ProductID_Key"),i.ProductGridObj.TableColumns.push("Description"),i.ProductGridObj.TableColumns.push("CRMProduct"),i.ProductGridObj.TableColumns.push("CRMProduct_Key"),i.ProductGridObj.TableColumns.push("Qty"),i.ProductGridObj.TableColumns.push("UOM"),i.ProductGridObj.TableColumns.push("UOM_Key"),i.ProductGridObj.TableColumns.push("isEdit"),i.ProductGridObj.TableColumns.push("CurrencyID"),i.ProductGridObj.TableColumns.push("CurrencyID_Key");for(var b=1;b<=50;b++)i.ProductGridObj.TableColumns.push("Alpha"+b),i.ProductGridObj.TableColumns.push("CCNID"+b),i.ProductGridObj.TableColumns.push("CCNID"+b+"_Key");i.ProductColumnSource=new Array,86==s?i.DS=a.a.crmService.GetFeedbackDetails(115):73==s?i.DS=a.a.crmService.GetFeedbackDetails(156):89==s?i.DS=a.a.crmService.GetFeedbackDetails(154):88==s&&(i.DS=a.a.crmService.GetFeedbackDetails(155)),(d=new c.a).Header="Select",d.DisplayMember="isChecked",d.DataType="CheckBox",d.Width=50,d.IsVisible=!0,d.CheckedChanged.Subscribe(_assertThisInitialized(i),"OnCheckedChanged"),i.ProductColumnSource.push(d),i.dvCnt=i.DS.Tables[0],i.dvCntTable=i.DS.Tables[0];try{for(var S=null,D=null,g="",p=null,I=null,y=0,T=0;T<i.DS.Tables[0].length;T++)if("Description"==i.DS.Tables[0][T].SysColumnName.toString())(d=new c.a).Header="Description",d.DisplayMember="Description",d.Width=n.e.IsEmpty(i.DS.Tables[0][T].Width)?150:parseInt(i.DS.Tables[0][T].Width.toString()),d.IsVisible=!0,d.ReadOnly=!Object(o.j)(i.DS.Tables[0][T].IsEditable),i.ProductColumnSource.push(d);else if("ProductID"==i.DS.Tables[0][T].SysColumnName.toString())(d=new c.a).Header="Product",d.DisplayMember="ProductName",d.ValueMember="ProductID_Key",d.DataType="LISTBOX",d.Width=n.e.IsEmpty(i.DS.Tables[0][T].Width)?230:parseInt(i.DS.Tables[0][T].Width.toString()),d.CostCenterID=3,d.TypeID=10,d.ID=i.DS.Tables[0][T].CostCenterColID.toString(),d.IsVisible=!0,d.ReadOnly=!Object(o.j)(i.DS.Tables[0][T].IsEditable),i.ProductColumnSource.push(d);else if("Quantity"==i.DS.Tables[0][T].SysColumnName.toString())(d=new c.a).Header="Qty",d.DisplayMember="Qty",d.DataType="INT",d.Width=n.e.IsEmpty(i.DS.Tables[0][T].Width)?150:parseInt(i.DS.Tables[0][T].Width.toString()),d.IsVisible=!0,d.ReadOnly=!Object(o.j)(i.DS.Tables[0][T].IsEditable),i.ProductColumnSource.push(d);else if("UOM"==i.DS.Tables[0][T].SysColumnName.toString())(d=new c.a).Header="UOM",d.DisplayMember="UOM",d.ValueMember="UOM_Key",d.DataType="LISTBOX",d.IsVisible=!0,d.Width=n.e.IsEmpty(i.DS.Tables[0][T].Width)?230:parseInt(i.DS.Tables[0][T].Width.toString()),d.ID=i.DS.Tables[0][T].CostCenterColID.toString(),d.CostCenterID=11,d.TypeID=1,d.ReadOnly=!Object(o.j)(i.DS.Tables[0][T].IsEditable),i.ProductColumnSource.push(d);else if("CurrencyID"==i.DS.Tables[0][T].SysColumnName.toString())(d=new c.a).Header="Currency",d.DisplayMember="CurrencyID",d.ValueMember="CurrencyID_Key",d.DataType="LISTBOX",d.IsVisible=!0,d.Width=n.e.IsEmpty(i.DS.Tables[0][T].Width)?80:parseInt(i.DS.Tables[0][T].Width.toString()),d.ID=i.DS.Tables[0][T].CostCenterColID.toString(),d.CostCenterID=12,d.TypeID=1,d.ReadOnly=!Object(o.j)(i.DS.Tables[0][T].IsEditable),i.ProductColumnSource.push(d);else if("CRMProduct"==i.DS.Tables[0][T].SysColumnName.toString()&&""!=a.a.SessionManager.Preferences["CRM-Products"].toString()&&"0"!=a.a.SessionManager.Preferences["CRM-Products"].toString())d=new c.a,null!=i.DS&&i.DS.Tables.length>1&&i.DS.Tables[2].length>0&&(d.ComboData=i.DS.Tables[2]),d.DisplayMember="CRMProduct",d.ValueMember="CRMProduct_Key",d.DataType="LISTBOX",d.Header="CRM-Products",d.Width=n.e.IsEmpty(i.DS.Tables[0][T].Width)?230:parseInt(i.DS.Tables[0][T].Width.toString()),d.ID=i.DS.Tables[0][T].CostCenterColID.toString(),d.CostCenterID=parseInt(a.a.SessionManager.Preferences["CRM-Products"].toString()),d.TypeID=1,d.ReadOnly=!Object(o.j)(i.DS.Tables[0][T].IsEditable),d.IsVisible=!0,i.ProductColumnSource.push(d);else if(i.DS.Tables[0][T].IsVisible&&i.DS.Tables[0][T].SysColumnName.toString().Contains("Alpha")){if((d=new c.a).Header=i.DS.Tables[0][T].UserColumnName.toString(),d.DefaultValue=i.DS.Tables[0][T].UserDefaultValue.toString(),"Date"==i.DS.Tables[0][T].UserColumnType.toString())d.DisplayMember=i.DS.Tables[0][T].SysColumnName.toString(),d.DataType="DATE",i.ProductGridObj.TableColumns.push(i.DS.Tables[0][T].SysColumnName.toString()+"_Key");else if("DateTime"==i.DS.Tables[0][T].UserColumnType.toString())d.DisplayMember=i.DS.Tables[0][T].SysColumnName.toString(),d.DataType="DATETIME",i.ProductGridObj.TableColumns.push(i.DS.Tables[0][T].SysColumnName.toString()+"_Key");else if("LISTBOX"==i.DS.Tables[0][T].UserColumnType.toString())d.DisplayMember=i.DS.Tables[0][T].SysColumnName.toString(),d.ValueMember=i.DS.Tables[0][T].SysColumnName.toString()+"_Key",d.DataType="LISTBOX",d.CostCenterID=parseInt(i.DS.Tables[0][T].ColumnCostCenterID),d.TypeID=0==i.DS.Tables[0][T].ColumnCCListViewTypeID.toString().Trim().length?1:parseInt(i.DS.Tables[0][T].ColumnCCListViewTypeID),i.ProductGridObj.TableColumns.push(i.DS.Tables[0][T].SysColumnName.toString()+"_Key");else if("Time"==i.DS.Tables[0][T].UserColumnType.toString())d.DisplayMember=i.DS.Tables[0][T].SysColumnName.toString(),d.DataType="TIME",i.ProductGridObj.TableColumns.push(i.DS.Tables[0][T].SysColumnName.toString()+"_Key");else if("Numeric"==i.DS.Tables[0][T].UserColumnType.toString())d.DisplayMember=i.DS.Tables[0][T].SysColumnName.toString(),d.DataType="FLOAT";else if("COMBOBOX"==i.DS.Tables[0][T].UserColumnType.toString()){if(d.ValueBinding=i.DS.Tables[0][T].SysColumnName.toString(),d.DataType="ComboBox",d.DisplayMember="Name",d.ValueMember="Value",S=[],(g=i.DS.Tables[0][T].UserProbableValues.toString().Trim()).length>0)for(D=g.split(";"),y=0;y<D.length;y++)S.push(h.d.ComboBoxItems_2(D[y],D[y]));d.ComboData=S,i.ProductGridObj.TableColumns.push(i.DS.Tables[0][T].SysColumnName.toString()+"_Key")}else if("DATE"==i.DS.Tables[0][T].UserColumnType.toString())d.DataType="DATE",d.DisplayMember=i.DS.Tables[0][T].SysColumnName.toString(),i.ProductGridObj.TableColumns.push(i.DS.Tables[0][T].SysColumnName.toString()+"_Key");else if("LOOKUP"==i.DS.Tables[0][T].UserColumnType.toString()){if(d.ValueBinding=i.DS.Tables[0][T].SysColumnName.toString(),d.DataType="ComboBox",d.DisplayMember="Name",d.ValueMember="Value",null!=(I=f.a.GetLookupData(parseInt(i.DS.Tables[0][T].ColumnCCListViewTypeID)))){for(S=[],y=0;y<I.length;y++)S.push(h.d.ComboBoxItems_2(I[y].Name.toString(),I[y].NodeID.toString()));d.ComboData=S}i.ProductGridObj.TableColumns.push(i.DS.Tables[0][T].SysColumnName.toString()+"_Key")}else d.DisplayMember=i.DS.Tables[0][T].SysColumnName.toString(),d.DataType="TEXTBOX";i.DS.Columns[0].Contains("Cformula")&&!n.e.IsEmpty(i.DS.Tables[0][T].Cformula)&&(d.Formula=i.DS.Tables[0][T].Cformula.toString()),d.Width=n.e.IsEmpty(i.DS.Tables[0][T].Width)?150:parseInt(i.DS.Tables[0][T].Width.toString()),d.IsVisible=!0,d.ReadOnly=!Object(o.j)(i.DS.Tables[0][T].IsEditable),d.ExcludeFilter=!1,i.ProductColumnSource.push(d)}else i.DS.Tables[0][T].IsVisible&&i.DS.Tables[0][T].SysColumnName.toString().Contains("Alpha")&&"LISTBOX"==i.DS.Tables[0][T].UserColumnType.toString().toUpperCase()?((d=new c.a).Header=i.DS.Tables[0][T].UserColumnName.toString(),d.DisplayMember=i.DS.Tables[0][T].SysColumnName.toString(),d.ValueMember=i.DS.Tables[0][T].SysColumnName.toString()+"_Key",d.DataType="LISTBOX",d.Width=n.e.IsEmpty(i.DS.Tables[0][T].Width)?150:parseInt(i.DS.Tables[0][T].Width.toString()),d.CostCenterID=parseInt(i.DS.Tables[0][T].ColumnCostCenterID),i.ProductGridObj.TableColumns.Contains(d.ValueMember)||i.ProductGridObj.TableColumns.push(d.ValueMember),d.TypeID=0==i.DS.Tables[0][T].ColumnCCListViewTypeID.toString().Trim().length?1:parseInt(i.DS.Tables[0][T].ColumnCCListViewTypeID),d.ExcludeFilter=i.DS.Tables[0][T].Filter.toString().Trim().length>0&&"0"==i.DS.Tables[0][T].Filter.toString(),d.ReadOnly=!Object(o.j)(i.DS.Tables[0][T].IsEditable),i.ProductColumnSource.push(d)):i.DS.Tables[0][T].IsVisible&&i.DS.Tables[0][T].SysColumnName.toString().Contains("CCNID")&&"LISTBOX"==i.DS.Tables[0][T].UserColumnType.toString().toUpperCase()&&((d=new c.a).ID=i.DS.Tables[0][T].CostCenterColID.toString(),d.Header=i.DS.Tables[0][T].UserColumnName.toString(),d.DisplayMember=i.DS.Tables[0][T].SysColumnName.toString(),d.ValueMember=i.DS.Tables[0][T].SysColumnName.toString()+"_Key",d.DataType="LISTBOX",d.Width=n.e.IsEmpty(i.DS.Tables[0][T].Width)?150:parseInt(i.DS.Tables[0][T].Width.toString()),d.CostCenterID=parseInt(i.DS.Tables[0][T].ColumnCostCenterID),d.TypeID=0==i.DS.Tables[0][T].ColumnCCListViewTypeID.toString().Trim().length?1:parseInt(i.DS.Tables[0][T].ColumnCCListViewTypeID),d.ExcludeFilter=i.DS.Tables[0][T].Filter.toString().Trim().length>0&&"0"==i.DS.Tables[0][T].Filter.toString(),d.ReadOnly=!Object(o.j)(i.DS.Tables[0][T].IsEditable),i.DS.Columns[0].Contains("dependanton")&&"0"!=n.e.String(i.DS.Tables[0][T].dependanton)&&(null!=(p=i.DS.Tables[0].Select("ColumnCostCenterID="+i.DS.Tables[0][T].dependanton.toString()))&&p.length>0&&(d.DependantOn=p[0].SysColumnName.toString(),i.DS.Columns[0].Contains("dependancy")&&!n.e.IsEmpty(i.DS.Tables[0][T].dependancy)&&(d.Dependancy=parseInt(i.DS.Tables[0][T].dependancy.toString())),i.DS.Columns[0].Contains("filterinuse")&&!n.e.IsEmpty(i.DS.Tables[0][T].filterinuse)&&(d.Dependantinuse=Object(o.j)(i.DS.Tables[0][T].filterinuse.toString())))),i.ProductColumnSource.push(d))}catch(V){}for(var P=0;P<15;P++)i.ProductGridObj.addEmptyRow(),i.ProductGrid[P][0]=!1;i.ConstructFormula();var O=null;return"AddEditLeads"==i.parent.ClassName?O=a.a.crmService.GetProductValueMapping(86):"AddEditOpportunity"==i.parent.ClassName&&(O=a.a.crmService.GetProductValueMapping(89)),null!=O&&O.Tables.length>0&&O.Tables[0].length>0&&O.Columns[0].Contains("SOURCE")&&(i.SrcProductValueMapping=O.Tables[0][0].SOURCE.toString(),i.DestProductValueMapping=O.Tables[0][0].DESTINATION.toString()),i}return _createClass(r,[{key:"OnMessageCallBack",value:function(){this.res="Yes"}},{key:"OnClick",value:function(e){var t=this;if("Email"==e.toString()){var s=-1,i=-1;"AddEditLeads"==this.parent.ClassName?(s=this.parent.LeadID,i=86):"AddEditCasesViewModel"==this.parent.ClassName?(s=this.parent.CaseID,i=73):"AddEditOpportunity"==this.parent.ClassName&&(s=this.parent.OppID,i=89);var r=new O(this.parent,i,s);a.a.page.ShowDialog(r,V.a,{ShowCenter:!0,NoWidth:!0})}else if(!n.e.IsEmpty(this.CostCenter.SelectedValue)){if(!Object(o.j)(d.a.ReturnValidPermission(parseInt(this.CostCenter.SelectedValue),"Create")))return void alert("Access Denied! ");this.res="No";for(var l=0;l<this.ProductGrid.length;l++)if(""==n.e.StringValue(this.ProductGrid[l].isEdit)&&Object(o.j)(this.ProductGrid[l].isChecked)&&!n.e.IsEmpty(this.ProductGrid[l].ProductID_Key)){this.bOnClick=!0,"AddEditLeads"==this.parent.ClassName&&this.parent.OnSave("Save"),"AddEditOpportunity"==this.parent.ClassName&&this.parent.OnSave("Save"),"AddEditCasesViewModel"==this.parent.ClassName&&this.parent.OnSave("Save");break}var u=-1,c=-1;if("AddEditLeads"==this.parent.ClassName){u=this.parent.LeadID,c=86;var p=(new d.a).GetLead(u);if(null!=p&&p.Tables.length>1&&p.Tables[0].length>0&&p.Columns[0].Contains("IsApproved")&&(""==p.Tables[0][0].IsApproved.toString()||!Object(o.j)(p.Tables[0][0].IsApproved)))return void alert("Lead should be in approved status! ")}else"AddEditCasesViewModel"==this.parent.ClassName?(u=this.parent.CaseID,c=73):"AddEditOpportunity"==this.parent.ClassName&&(u=this.parent.OppID,c=89);if(u<=0)return;var y=d.a.GetLeadScrenDetails(c);console.log("CostCenterid"),console.log(y.Tables[4]);var T=y.Tables[4].filter((function(e){return e.Costcenterid==t.CostCenter.SelectedValue})),f=!1,P=null;this.ProductGrid.length>0&&null!=this.ProductGrid&&C.RibbonExtViewModel.GetDocumentObject(parseInt(this.CostCenter.SelectedValue),this.CostCenter.GetText(),!1).then((function(e){e.ScreenObject.RefCCId=c,e.ScreenObject.RefNodeID=u,a.a.page.addNewTab({title:e.DisplayName,component:I.AddEditDocumentComponent,params:{obj:e}});for(var s=0,i=0;i<t.ProductGrid.length;i++)if(Object(o.j)(t.ProductGrid[i].isChecked)&&!n.e.IsEmpty(t.ProductGrid[i].ProductID_Key)&&!n.e.IsEmpty(t.ProductGrid[i].isEdit)){++s>9&&e.ScreenObject.GridDataObj.addEmptyRow(),e.ScreenObject.GridData.forEach((function(e){}));for(var r=0;r<e.ScreenObject.GridData.length;r++){var l=e.ScreenObject.GridData[r];if(n.e.IsEmpty(l.ProductID_Key)){P=l;break}}if(null==P&&(f=!0,P=e.ScreenObject.GridDataObj.NewRow()),e.ScreenObject.GridDataColumns.Contains("ProductName")&&t.ProductGridObj.TableColumns.Contains("ProductName")&&(P.ProductName=t.ProductGrid[i].ProductName.toString()),e.ScreenObject.GridDataColumns.Contains("ProductCode")&&t.ProductGridObj.TableColumns.Contains("ProductCode")&&(P.ProductCode=t.ProductGrid[i].ProductCode.toString()),P.ProductID_Key=t.ProductGrid[i].ProductID_Key.toString(),e.AddProductData(P,!1,!1),P.Quantity=n.e.IsEmpty(t.ProductGrid[i].Qty)?"1":t.ProductGrid[i].Qty.toString(),s>9&&(P.DocSeqNo=s),"AddEditLeads"==t.parent.ClassName){var d=t.parent;if(null!=d.ScreenObject)for(var C=0;C<T.length;C++)if(e.ScreenObject.GridDataColumns.Contains(T[C].LSysColumnName.toString()))if(T[C].BSysColumnName.toString().toUpperCase().Contains("LDALPHA")&&"86"==T[C].BCostcenterid.toString())d.ds.Columns[4].Contains(T[C].BSysColumnName.toString())&&(P[T[C].LSysColumnName.toString()]=d.ds.Tables[4][0][T[C].BSysColumnName.toString()].toString());else if(T[C].BSysColumnName.toString().toUpperCase().Contains("CCNID")&&"115"!=T[C].BCostcenterid.toString())d.ds.Columns[11].Contains(T[C].BSysColumnName.toString())&&(P[T[C].LSysColumnName.toString()+"_Key"]=d.ds.Tables[11][0][T[C].BSysColumnName.toString()].toString());else if(T[C].BSysColumnName.toString().toUpperCase().Contains("CCNID")&&"115"==T[C].BCostcenterid.toString())t.ProductGridObj.TableColumns.Contains(T[C].BSysColumnName.toString())&&(P[T[C].LSysColumnName.toString()+"_Key"]=t.ProductGrid[i][T[C].BSysColumnName.toString()+"_Key"].toString());else if(T[C].BSysColumnName.toString().toLowerCase().Contains("alpha")&&"115"==T[C].BCostcenterid.toString()){if(t.ProductGridObj.TableColumns.Contains(T[C].BSysColumnName.toString()))try{P[T[C].LSysColumnName.toString()]=t.ProductGrid[i][T[C].BSysColumnName.toString()].toString()}catch(j){P[T[C].LSysColumnName.toString()]="0.0"}}else T[C].BSysColumnName.toString().toLowerCase().Contains("description")&&"115"==T[C].BCostcenterid.toString()?t.ProductGridObj.TableColumns.Contains(T[C].BSysColumnName.toString())&&(P[T[C].LSysColumnName.toString()]=t.ProductGrid[i][T[C].BSysColumnName.toString()].toString()):T[C].BSysColumnName.toString().toLowerCase().Contains("crmproduct")&&"115"==T[C].BCostcenterid.toString()&&""!=a.a.SessionManager.Preferences["CRM-Products"].toString()&&"0"!=a.a.SessionManager.Preferences["CRM-Products"].toString()&&t.ProductGridObj.TableColumns.Contains(T[C].BSysColumnName.toString())&&(P[T[C].LSysColumnName.toString()+"_Key"]=t.ProductGrid[i][T[C].BSysColumnName.toString()+"_Key"].toString());else"DebitAccount"!=T[C].LSysColumnName.toString()&&"CreditAccount"!=T[C].LSysColumnName.toString()||(e.ScreenObject.GridDataColumns.Contains(T[C].LUserColumnName.toString())?e.ScreenObject.GridDataColumns.Contains(T[C].LSysColumnName.toString()+"_Key")&&(P[T[C].LUserColumnName.toString()]=d.ds.Tables[0][0][T[C].BSysColumnName.toString()].toString(),P[T[C].LSysColumnName.toString()+"_Key"]=d.ds.Tables[0][0].SelectedModeID.toString()):"DebitAccount"==T[C].LSysColumnName.toString()?e.ScreenObject.DebitAccount.SelectedValue=parseInt(d.ds.Tables[0][0].SelectedModeID.toString()):"CreditAccount"==T[C].LSysColumnName.toString()&&(e.ScreenObject.CreditAccount.SelectedValue=parseInt(d.ds.Tables[0][0].SelectedModeID.toString())))}if("AddEditOpportunity"==t.parent.ClassName){var p=t.parent;if(null!=p.ScreenObject)for(var y=0;y<T.length;y++)if(e.ScreenObject.GridDataColumns.Contains(T[y].LSysColumnName.toString()))if(T[y].BSysColumnName.toString().toUpperCase().Contains("LDALPHA")&&"89"==T[y].BCostcenterid.toString())p.ds.Columns[8].Contains(T[y].BSysColumnName.toString())&&(P[T[y].LSysColumnName.toString()]=p.ds.Tables[8][0][T[y].BSysColumnName.toString()].toString());else if(T[y].BSysColumnName.toString().toUpperCase().Contains("CCNID")&&"154"!=T[y].BCostcenterid.toString())p.ds.Columns[11].Contains(T[y].BSysColumnName.toString())&&(P[T[y].LSysColumnName.toString()+"_Key"]=p.ds.Tables[11][0][T[y].BSysColumnName.toString()].toString());else if(T[y].BSysColumnName.toString().toUpperCase().Contains("CCNID")&&"154"==T[y].BCostcenterid.toString())t.ProductGridObj.TableColumns.Contains(T[y].BSysColumnName.toString())&&(P[T[y].LSysColumnName.toString()+"_Key"]=t.ProductGrid[i][T[y].BSysColumnName.toString()+"_Key"].toString());else if(T[y].BSysColumnName.toString().toLowerCase().Contains("alpha")&&"154"==T[y].BCostcenterid.toString()){if(t.ProductGridObj.TableColumns.Contains(T[y].BSysColumnName.toString()))try{P[T[y].LSysColumnName.toString()]=t.ProductGrid[i][T[y].BSysColumnName.toString()].toString()}catch(j){P[T[y].LSysColumnName.toString()]="0.0"}}else T[y].BSysColumnName.toString().toUpperCase().Contains("QUANTITY")&&"89"==T[y].BCostcenterid.toString()?t.ProductGridObj.TableColumns.Contains("Qty")&&(P[T[y].LSysColumnName.toString()]=t.ProductGrid[i].Qty.toString()):T[y].BSysColumnName.toString().toLowerCase().Contains("description")&&"154"==T[y].BCostcenterid.toString()?t.ProductGridObj.TableColumns.Contains(T[y].BSysColumnName.toString())&&(P[T[y].LSysColumnName.toString()]=t.ProductGrid[i][T[y].BSysColumnName.toString()].toString()):T[y].BSysColumnName.toString().toLowerCase().Contains("crmproduct")&&"154"==T[y].BCostcenterid.toString()&&""!=a.a.SessionManager.Preferences["CRM-Products"].toString()&&"0"!=a.a.SessionManager.Preferences["CRM-Products"].toString()&&t.ProductGridObj.TableColumns.Contains(T[y].BSysColumnName.toString())&&(P[T[y].LSysColumnName.toString()+"_Key"]=t.ProductGrid[i][T[y].BSysColumnName.toString()+"_Key"].toString());else"DebitAccount"!=T[y].LSysColumnName.toString()&&"CreditAccount"!=T[y].LSysColumnName.toString()||(e.ScreenObject.GridDataColumns.Contains(T[y].LUserColumnName.toString())?e.ScreenObject.GridDataColumns.Contains(T[y].LSysColumnName.toString()+"_Key")&&(P[T[y].LUserColumnName.toString()]=p.ds.Tables[1][0][T[y].BSysColumnName.toString()].toString(),P[T[y].LSysColumnName.toString()+"_Key"]=p.ds.Tables[1][0].SelectedModeID.toString()):"DebitAccount"==T[y].LSysColumnName.toString()?e.ScreenObject.DebitAccount.SelectedValue=parseInt(p.ds.Tables[1][0].SelectedModeID.toString()):"CreditAccount"==T[y].LSysColumnName.toString()&&(e.ScreenObject.CreditAccount.SelectedValue=parseInt(p.ds.Tables[1][0].SelectedModeID.toString())))}if("AddEditCasesViewModel"==t.parent.ClassName){var O=t.parent;if(null!=O.ScreenObject)for(var V=0;V<T.length;V++)e.ScreenObject.GridDataColumns.Contains(T[V].LSysColumnName.toString())&&(T[V].BSysColumnName.toString().toUpperCase().Contains("LDALPHA")&&"73"==T[V].BCostcenterid.toString()?O.dsLoad.Columns[6].Contains(T[V].BSysColumnName.toString())&&(P[T[V].LSysColumnName.toString()]=O.dsLoad.Tables[6][0][T[V].BSysColumnName.toString()].toString()):T[V].BSysColumnName.toString().toUpperCase().Contains("CCNID")&&"156"!=T[V].BCostcenterid.toString()?O.dsLoad.Columns[8].Contains(T[V].BSysColumnName.toString())&&(P[T[V].LSysColumnName.toString()+"_Key"]=O.dsLoad.Tables[8][0][T[V].BSysColumnName.toString()].toString()):T[V].BSysColumnName.toString().toUpperCase().Contains("CCNID")&&"156"==T[V].BCostcenterid.toString()?t.ProductGridObj.TableColumns.Contains(T[V].BSysColumnName.toString())&&(P[T[V].LSysColumnName.toString()+"_Key"]=t.ProductGrid[i][T[V].BSysColumnName.toString()+"_Key"].toString()):T[V].BSysColumnName.toString().toLowerCase().Contains("alpha")&&"156"==T[V].BCostcenterid.toString()||T[V].BSysColumnName.toString().toLowerCase().Contains("description")&&"156"==T[V].BCostcenterid.toString()?t.ProductGridObj.TableColumns.Contains(T[V].BSysColumnName.toString())&&(P[T[V].LSysColumnName.toString()]=t.ProductGrid[i][T[V].BSysColumnName.toString()].toString()):T[V].BSysColumnName.toString().toLowerCase().Contains("crmproduct")&&"156"==T[V].BCostcenterid.toString()&&""!=a.a.SessionManager.Preferences["CRM-Products"].toString()&&"0"!=a.a.SessionManager.Preferences["CRM-Products"].toString()&&t.ProductGridObj.TableColumns.Contains(T[V].BSysColumnName.toString())&&(P[T[V].LSysColumnName.toString()+"_Key"]=t.ProductGrid[i][T[V].BSysColumnName.toString()+"_Key"].toString()))}f&&e.ScreenObject.GridDataObj.addRow(P),e.CalculateTotals(P,!1)}if(e.RefreshGrid=!e.RefreshGrid,null!=T&&T.length>0){var v;if("AddEditLeads"==t.parent.ClassName)!function(){var s=null,i=null,a=null,r=t.parent;if(null!=r.ScreenObject){if(t.ProductColumnSource.find((function(e){return 12==e.CostCenterID}))){for(var l=0,u=0;u<t.ProductGrid.length;u++)if(!n.e.IsEmpty(t.ProductGrid[u].ProductID_Key)&&Object(o.j)(t.ProductGrid[u].isChecked)){l=u;break}try{null!=e.Currency&&(e.Currency.Currency.SelectedValue=n.e.IsEmpty(t.ProductGrid[l].CurrencyID_Key)?"1":t.ProductGrid[l].CurrencyID_Key.toString(),e.Currency.ExchangeRate.Text=e.ScreenObject.GetExchangeRate(parseInt(e.Currency.Currency.SelectedValue),e.DocumentDate).toString())}catch(I){}}for(var c=0;c<T.length;c++)for(var d=0;d<e.ScreenObject.CustomTab.Pages.length;d++)for(var C=0;C<e.ScreenObject.CustomTab.Pages[d].Fields.length;C++){var D=e.ScreenObject.CustomTab.Pages[d].Fields[C];if(D instanceof S.c&&null!=D.DBColumnName)if(D instanceof m.d)s=D,r.ds.Columns[4].Contains(T[c].BSysColumnName.toString())&&s.DBColumnID==parseInt(T[c].CostCenterColIDLinked)?s.Text=r.ds.Tables[4][0][T[c].BSysColumnName.toString()].toString():r.ds.Columns[0].Contains(T[c].BSysColumnName.toString())&&s.DBColumnID==parseInt(T[c].CostCenterColIDLinked)?s.Text=r.ds.Tables[0][0][T[c].BSysColumnName.toString()].toString():r.ds.Columns[3].Contains(T[c].BSysColumnName.toString())&&s.DBColumnID==parseInt(T[c].CostCenterColIDLinked)&&(s.Text="SalutationID"==T[c].BSysColumnName.toString()&&r.ds.Columns[3].Contains("Salutation")?r.ds.Tables[3][0].Salutation.toString():("FirstName"==T[c].BSysColumnName.toString()&&r.ds.Columns[3].Contains("FirstName")||"MiddleName"==T[c].BSysColumnName.toString()&&r.ds.Columns[3].Contains("MiddleName ")||"LastName"==T[c].BSysColumnName.toString()&&r.ds.Columns[3].Contains("LastName")||"JobTitle"==T[c].BSysColumnName.toString()&&r.ds.Columns[3].Contains("JobTitle")||"Email"==T[c].BSysColumnName.toString()&&r.ds.Columns[3].Contains("Email")||"Phone1"==T[c].BSysColumnName.toString()&&r.ds.Columns[3].Contains("Phone1")||"Phone2"==T[c].BSysColumnName.toString()&&r.ds.Columns[3].Contains("Phone2"),r.ds.Tables[3][0][T[c].BSysColumnName.toString()].toString()));else if(D instanceof h.e)i=D,r.ds.Columns[4].Contains(T[c].BSysColumnName.toString())&&i.DBColumnID==parseInt(T[c].CostCenterColIDLinked)?D.SelectedValue=r.ds.Tables[4][0][T[c].BSysColumnName.toString()].toString():r.ds.Columns[0].Contains(T[c].BSysColumnName.toString())&&i.DBColumnID==parseInt(T[c].CostCenterColIDLinked)?D.SelectedValue=r.ds.Tables[0][0][T[c].BSysColumnName.toString()].toString():r.ds.Columns[3].Contains(T[c].BSysColumnName.toString())&&i.DBColumnID==parseInt(T[c].CostCenterColIDLinked)&&(D.SelectedValue=r.ds.Tables[3][0][T[c].BSysColumnName.toString()].toString());else if(D instanceof b.b)if(a=D,r.ds.Columns[11].Contains(T[c].BSysColumnName.toString())&&a.DBColumnID==parseInt(T[c].CostCenterColIDLinked))if(v=t.ProductColumnSource.find((function(e){return e.CostCenterID==a.CCID})),a.IsAutoLoad=!1,v){for(var g=0,p=0;p<t.ProductGrid.length;p++)if(!n.e.IsEmpty(t.ProductGrid[p].ProductID_Key)&&null!=t.ProductGrid[p].isChecked.toString()&&Object(o.j)(t.ProductGrid[p].isChecked)){g=p;break}try{a.SelectedValue=parseInt(t.ProductGrid[g][T[c].BSysColumnName.toString()+"_Key"].toString())}catch(j){a.SelectedValue=parseInt(r.ds.Tables[11][0][T[c].BSysColumnName.toString()])}}else a.SelectedValue=parseInt(r.ds.Tables[11][0][T[c].BSysColumnName.toString()]);else if("26636"==T[c].CostCenterColIDBase.toString()&&a.DBColumnID==parseInt(T[c].CostCenterColIDLinked))a.IsAutoLoad=!1,a.SelectedValue=null!=t.parent.ContactList&&null!=t.parent.ContactList.SelectedValue&&""!=t.parent.ContactList.SelectedValue?parseInt(t.parent.ContactList.SelectedValue):n.e.IsEmpty(r.ds.Tables[0][0].ContactID)?0:parseInt(r.ds.Tables[0][0].ContactID.toString());else if(r.ds.Columns[4].Contains(T[c].BSysColumnName.toString())&&a.DBColumnID==parseInt(T[c].CostCenterColIDLinked))a.IsAutoLoad=!1,a.SelectedValue=n.e.IsEmpty(r.ds.Tables[4][0][T[c].BSysColumnName.toString()])?0:parseInt(r.ds.Tables[4][0][T[c].BSysColumnName.toString()]);else if(r.ds.Columns[0].Contains(T[c].BSysColumnName.toString())&&a.DBColumnID==parseInt(T[c].CostCenterColIDLinked)){a.IsAutoLoad=!1;try{a.SelectedValue=r.ds.Columns[0].Contains("SelectedModeID")&&r.ds.Columns[0].Contains("Mode")&&"3"==r.ds.Tables[0][0].Mode.toString()?n.e.IsEmpty(r.ds.Tables[0][0].SelectedModeID)?0:parseInt(r.ds.Tables[0][0].SelectedModeID):0,44==a.CCID&&(a.SelectedValue=r.ds.Columns[0].Contains(T[c].BSysColumnName.toString())?n.e.IsEmpty(r.ds.Tables[0][0][T[c].BSysColumnName.toString()])?0:parseInt(r.ds.Tables[0][0][T[c].BSysColumnName.toString()]):0)}catch(j){a.SelectedValue=0}}}}}();if("AddEditOpportunity"==t.parent.ClassName&&function(){var s=null,i=null,a=t.parent;if(null!=a.ScreenObject){if(t.ProductColumnSource.find((function(e){return 12==e.CostCenterID}))){for(var r=0,l=0;l<t.ProductGrid.length;l++)if(!n.e.IsEmpty(t.ProductGrid[l].ProductID_Key)&&Object(o.j)(t.ProductGrid[l].isChecked)){r=l;break}try{null!=e.Currency&&(e.Currency.Currency.SelectedValue=n.e.IsEmpty(t.ProductGrid[r].CurrencyID_Key)?"1":t.ProductGrid[r].CurrencyID_Key.toString(),e.Currency.ExchangeRate.Text=e.ScreenObject.GetExchangeRate(parseInt(e.Currency.Currency.SelectedValue),e.DocumentDate).toString())}catch(p){}}for(var u=0;u<T.length;u++)for(var c=0;c<e.ScreenObject.CustomTab.Pages.length;c++)for(var d=0;d<e.ScreenObject.CustomTab.Pages[c].Fields.length;d++){var C=e.ScreenObject.CustomTab.Pages[c].Fields[d];if(C instanceof S.c&&null!=C.DBColumnName)if(C instanceof m.d)s=C,a.ds.Columns[8].Contains(T[u].BSysColumnName.toString())&&s.DBColumnID==parseInt(T[u].CostCenterColIDLinked)?s.Text=a.ds.Tables[8][0][T[u].BSysColumnName.toString()].toString():a.ds.Columns[13].Contains(T[u].BSysColumnName.toString())&&s.DBColumnID==parseInt(T[u].CostCenterColIDLinked)?s.Text=null!=a.ds&&a.ds.Tables[13].length>0&&("FirstName"==T[u].BSysColumnName.toString()&&a.ds.Columns[13].Contains("FirstName")||"MiddleName"==T[u].BSysColumnName.toString()&&a.ds.Columns[13].Contains("MiddleName ")||"LastName"==T[u].BSysColumnName.toString()&&a.ds.Columns[13].Contains("LastName")||"JobTitle"==T[u].BSysColumnName.toString()&&a.ds.Columns[13].Contains("JobTitle")||"Email"==T[u].BSysColumnName.toString()&&a.ds.Columns[13].Contains("Email")||"Phone1"==T[u].BSysColumnName.toString()&&a.ds.Columns[13].Contains("Phone1")||"Phone2"==T[u].BSysColumnName.toString()&&a.ds.Columns[13].Contains("Phone2"))?a.ds.Tables[13][0][T[u].BSysColumnName.toString()].toString():"SalutationID"==T[u].BSysColumnName.toString()&&a.ds.Columns[13].Contains("Salutation")?a.ds.Tables[13][0].Salutation.toString():a.ds.Tables[13][0][T[u].BSysColumnName.toString()].toString():(a.ds.Columns[1].Contains(T[u].BSysColumnName.toString())&&s.DBColumnID==parseInt(T[u].CostCenterColIDLinked)&&"Subject"==T[u].BSysColumnName.toString()&&a.ds.Columns[1].Contains("Subject")||a.ds.Columns[1].Contains(T[u].BSysColumnName.toString())&&s.DBColumnID==parseInt(T[u].CostCenterColIDLinked))&&(s.Text=a.ds.Tables[1][0][T[u].BSysColumnName.toString()].toString());else if(C instanceof h.e)C,a.ds.Columns[8].Contains(T[u].BSysColumnName.toString())&&s.DBColumnID==parseInt(T[u].CostCenterColIDLinked)&&(C.SelectedValue=a.ds.Tables[8][0][T[u].BSysColumnName.toString()].toString());else if(C instanceof b.b)if(i=C,a.ds.Columns[11].Contains(T[u].BSysColumnName.toString())&&i.DBColumnID==parseInt(T[u].CostCenterColIDLinked))if(v=t.ProductColumnSource.find((function(e){return e.CostCenterID==i.CCID})),i.IsAutoLoad=!1,v){for(var D=0,g=0;g<t.ProductGrid.length;g++)if(!n.e.IsEmpty(t.ProductGrid[g].ProductID_Key)&&Object(o.j)(t.ProductGrid[g].isChecked)){D=g;break}try{i.SelectedValue=parseInt(t.ProductGrid[D][T[u].BSysColumnName.toString()+"_Key"].toString()),e.ScreenObject.GetLinkReferenceData(i.DBColumnID,e.CostCenterID,i.SelectedValue,e.DocumentDate,i.DBColumnName,i.CCID,null)}catch(j){i.SelectedValue=parseInt(a.ds.Tables[11][0][T[u].BSysColumnName.toString()])}}else i.SelectedValue=parseInt(a.ds.Tables[11][0][T[u].BSysColumnName.toString()]);else if("25402"==T[u].CostCenterColIDBase.toString()&&i.DBColumnID==parseInt(T[u].CostCenterColIDLinked))i.IsAutoLoad=!1,i.SelectedValue=null!=t.parent.ContactCombo&&null!=t.parent.ContactCombo.SelectedValue&&""!=t.parent.ContactCombo.SelectedValue?parseInt(t.parent.ContactCombo.SelectedValue):n.e.IsEmpty(a.ds.Tables[1][0].ContactID)?0:parseInt(a.ds.Tables[1][0].ContactID.toString());else if(a.ds.Columns[8].Contains(T[u].BSysColumnName.toString())&&i.DBColumnID==parseInt(T[u].CostCenterColIDLinked))i.IsAutoLoad=!1,i.SelectedValue=n.e.IsEmpty(a.ds.Tables[8][0][T[u].BSysColumnName.toString()])?0:parseInt(a.ds.Tables[8][0][T[u].BSysColumnName.toString()]);else if(a.ds.Columns[1].Contains(T[u].BSysColumnName.toString())&&i.DBColumnID==parseInt(T[u].CostCenterColIDLinked)){i.IsAutoLoad=!1;try{i.SelectedValue=a.ds.Columns[1].Contains("CustomerID")||a.ds.Columns[1].Contains("SelectedModeID")?a.ds.Columns[1].Contains("Mode")&&"4"==a.ds.Tables[1][0].Mode.toString()?n.e.IsEmpty(a.ds.Tables[1][0].CustomerID)?0:parseInt(a.ds.Tables[1][0].CustomerID):a.ds.Columns[1].Contains("Mode")&&"3"==a.ds.Tables[1][0].Mode.toString()?n.e.IsEmpty(a.ds.Tables[1][0].SelectedModeID)?0:parseInt(a.ds.Tables[1][0].SelectedModeID):0:0,44==i.CCID&&(i.SelectedValue=a.ds.Columns[1].Contains(T[u].BSysColumnName.toString())&&""!=a.ds.Tables[1][0][T[u].BSysColumnName.toString()].toString()?parseInt(a.ds.Tables[1][0][T[u].BSysColumnName.toString()]):0)}catch(j){i.SelectedValue=0}}}}}(),"AddEditCasesViewModel"==t.parent.ClassName&&null!=t.parent.ScreenObject)for(var M=function(s){for(var i=0;i<e.ScreenObject.CustomTab.Pages.length;i++)e.ScreenObject.CustomTab.Pages[i].Fields.forEach((function(e){e instanceof S.c&&null!=e.DBColumnName&&t.mapCaseField(e,T,s)}));e.ScreenObject.HeaderFields.forEach((function(e){e instanceof S.c&&null!=e.DBColumnName&&t.mapCaseField(e,T,s)}))},N=0;N<T.length;N++)M(N)}e.ScreenObject.HeaderFields.forEach((function(e){e instanceof D.d?e.SetFocus=!0:e instanceof g.a&&e.TextBox.SetFocus?e.TextBox.SetFocus=!1:e instanceof S.c&&e.SetFocus&&(e.SetFocus=!1)})),e.ScreenObject.SetDefaultValuesforCostCenters(0);for(var L=0;L<e.ScreenObject.GridData.length;L++)n.e.IsEmpty(e.ScreenObject.GridData[L].ProductID_Key)||e.CalculateTotals(e.ScreenObject.GridData[L],!1)}))}}},{key:"mapCaseField",value:function(e,t,s){var i=null,o=null,r=null,l=null,u=this.parent;e instanceof m.d?(i=e,"assigneddate"!=t[s].BSysColumnName.toString().toLowerCase()&&"createddate"!=t[s].BSysColumnName.toString().toLowerCase()&&"assignedto"!=t[s].BSysColumnName.toString().toLowerCase()&&"customerid"!=t[s].BSysColumnName.toString().toLowerCase()||i.DBColumnID!=parseInt(t[s].CostCenterColIDLinked)?u.dsLoad.Columns[6].Contains(t[s].BSysColumnName.toString())&&i.DBColumnID==parseInt(t[s].CostCenterColIDLinked)?i.Text=u.dsLoad.Tables[6][0][t[s].BSysColumnName.toString()].toString():u.dsLoad.Columns[9].Contains(t[s].BSysColumnName.toString())&&i.DBColumnID==parseInt(t[s].CostCenterColIDLinked)?i.Text=u.dsLoad.Tables[9][0][t[s].BSysColumnName.toString()].toString():u.dsLoad.Columns[4].Contains(t[s].BSysColumnName.toString())&&i.DBColumnID==parseInt(t[s].CostCenterColIDLinked)&&(i.Text=u.dsLoad.Tables[4][0][t[s].BSysColumnName.toString()].toString()):"assigneddate"==t[s].BSysColumnName.toString().toLowerCase()?n.e.IsEmpty(u.dsLoad.Tables[4][0].ADate)||(i.Text=new Date(u.dsLoad.Tables[4][0].ADate.toString()).ToString(a.a.SessionManager.Preferences["Date Format"])):"createddate"==t[s].BSysColumnName.toString().toLowerCase()?n.e.IsEmpty(u.dsLoad.Tables[4][0].CDAte)||(i.Text=new Date(u.dsLoad.Tables[4][0].CDAte.toString()).ToString(a.a.SessionManager.Preferences["Date Format"])):"assignedto"==t[s].BSysColumnName.toString().toLowerCase()?n.e.IsEmpty(u.dsLoad.Tables[4][0].AssignedUser)||(i.Text=u.dsLoad.Tables[4][0].AssignedUser.toString()):"customerid"==t[s].BSysColumnName.toString().toLowerCase()&&(n.e.IsEmpty(u.dsLoad.Tables[4][0].Customer)||(i.Text=u.dsLoad.Tables[4][0].Customer.toString()))):e instanceof h.e?(o=e,u.dsLoad.Columns[6].Contains(t[s].BSysColumnName.toString())&&o.DBColumnID==parseInt(t[s].CostCenterColIDLinked)?e.SelectedValue=u.dsLoad.Tables[6][0][t[s].BSysColumnName.toString()].toString():u.dsLoad.Columns[9].Contains(t[s].BSysColumnName.toString())&&o.DBColumnID==parseInt(t[s].CostCenterColIDLinked)?e.SelectedValue=u.dsLoad.Tables[9][0][t[s].BSysColumnName.toString()].toString():u.dsLoad.Columns[4].Contains(t[s].BSysColumnName.toString())&&o.DBColumnID==parseInt(t[s].CostCenterColIDLinked)&&(e.SelectedValue=u.dsLoad.Tables[4][0][t[s].BSysColumnName.toString()].toString())):e instanceof b.b?(r=e,u.dsLoad.Columns[8].Contains(t[s].BSysColumnName.toString())&&r.DBColumnID==parseInt(t[s].CostCenterColIDLinked)?(r.IsAutoLoad=!1,r.SelectedValue=parseInt(u.dsLoad.Tables[8][0][t[s].BSysColumnName.toString()])):u.dsLoad.Columns[6].Contains(t[s].BSysColumnName.toString())&&r.DBColumnID==parseInt(t[s].CostCenterColIDLinked)&&""!=u.dsLoad.Tables[12][0][t[s].BSysColumnName.toString()].toString()?n.e.IsNum(u.dsLoad.Tables[6][0][t[s].BSysColumnName.toString()])&&(r.IsAutoLoad=!1,r.SelectedValue=parseInt(u.dsLoad.Tables[6][0][t[s].BSysColumnName.toString()].toString())):u.dsLoad.Columns[4].Contains(t[s].BSysColumnName.toString())&&r.DBColumnID==parseInt(t[s].CostCenterColIDLinked)&&n.e.IsNum(u.dsLoad.Tables[4][0][t[s].BSysColumnName.toString()])&&(r.IsAutoLoad=!1,r.SelectedValue=parseInt(u.dsLoad.Tables[4][0][t[s].BSysColumnName.toString()]))):e instanceof p.a&&(l=e,u.dsLoad.Columns[8].Contains(t[s].BSysColumnName.toString())&&l.DBColumnID==parseInt(t[s].CostCenterColIDLinked)?l.SelectedValue=parseInt(u.dsLoad.Tables[8][0][t[s].BSysColumnName.toString()]):u.dsLoad.Columns[6].Contains(t[s].BSysColumnName.toString())&&l.DBColumnID==parseInt(t[s].CostCenterColIDLinked)&&""!=u.dsLoad.Tables[6][0][t[s].BSysColumnName.toString()].toString()?n.e.IsNum(u.dsLoad.Tables[6][0][t[s].BSysColumnName.toString()])&&(l.SelectedValue=parseInt(u.dsLoad.Tables[6][0][t[s].BSysColumnName.toString()].toString())):u.dsLoad.Columns[4].Contains(t[s].BSysColumnName.toString())&&l.DBColumnID==parseInt(t[s].CostCenterColIDLinked)&&n.e.IsNum(u.dsLoad.Tables[4][0][t[s].BSysColumnName.toString()])&&(l.SelectedValue=parseInt(u.dsLoad.Tables[4][0][t[s].BSysColumnName.toString()])))}},{key:"onCopy",value:function(e){e.Column.DataGridOwner.CommitEdit();var t;t=e.column.field;for(var s=0;s<this.ProductGrid.length;s++)if(n.e.Int(this.ProductGrid[s].ProductID_Key)>0||n.e.Int(this.ProductGrid[s].CRMProduct_Key)>0){if(this.ProductGrid[s][t]=n.e.String(e.Item.Row[t]),"DataGridDateColumn"==e.column.className&&this.ProductGridObj.TableColumns.Contains(t+"_key"))this.ProductGrid[s][t+"_key"]=e.Item.Row[t+"_key"].toString();else if("DataGridPactListBoxColumn"==e.column.className){var i=this.ProductColumnSource.find((function(e){return e.DisplayMember==t}));i&&(this.ProductGrid[s][i.ValueMember]=e.Item.Row[i.ValueMember].toString())}this.CalculateTotals(this.ProductGrid[s])}}},{key:"onSearchProduct",value:function(e){return Object(i.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i,n,o,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("DataGridPactListBoxColumn"!=e.column.className||3!=e.column.CostCenterID){t.next=10;break}return t.next=3,Promise.resolve().then(s.bind(null,"JUeo"));case 3:return i=t.sent,n=i.ProductSearchCatalogViewModel,t.next=7,Promise.resolve().then(s.bind(null,"V52s"));case 7:o=t.sent,r=o.ProductSearchCatalogComponent,a.a.page.ShowDialog(new n(this,268,3,null,null),r);case 10:case"end":return t.stop()}}),t,this)})))}},{key:"ConstructFormula",value:function(){var e=this;this.eval=new T.b,this.fldDict=new y.a;var t=new T.c;(t=new T.c).setFieldDetails("RATE",3,1,"",0,!1,!1),this.fldDict.push("RATE",t),(t=new T.c).setFieldDetails("QTY",3,1,"",0,!1,!1),this.fldDict.push("QTY",t),this.ProductColumnSource.forEach((function(s){e.fldDict.ContainsKey(s.Header)||((t=new T.c).setFieldDetails(s.Header,3,1,"",0,!1,!1),e.fldDict.push(s.Header,t))}))}},{key:"GetProductXML",value:function(){for(var e="",t=0;t<this.ProductGrid.length;t++)if(!n.e.IsEmpty(this.ProductGrid[t].ProductID_Key)){e+="<Row ",e+=' Product="'+this.ProductGrid[t].ProductID_Key.toString()+'"',""!=a.a.SessionManager.Preferences["CRM-Products"].toString()&&"0"!=a.a.SessionManager.Preferences["CRM-Products"].toString()?e+=' CRMProduct="'+this.ProductGrid[t].CRMProduct_Key.toString()+'"':e+=' CRMProduct="0"',e+=' Desc="'+r.GetValidXml(n.e.StringValue(this.ProductGrid[t].Description))+'"',e+=' UOM="'+n.e.String(this.ProductGrid[t].UOM_Key)+'"',e+=' Qty="'+n.e.String(this.ProductGrid[t].Qty)+'" ',n.e.IsEmpty(this.ProductGrid[t].CurrencyID_Key)?e+=' Currency="1" ':e+=' Currency="'+n.e.String(this.ProductGrid[t].CurrencyID_Key)+'" ';for(var s=0;s<this.ProductColumnSource.length;s++)"DATE"==this.ProductColumnSource[s].DataType&&this.ProductColumnSource[s].DisplayMember.toLowerCase().Contains("alpha")?n.e.IsEmpty(this.ProductGrid[t][this.ProductColumnSource[s].DisplayMember+"_Key"])||(e+=this.ProductColumnSource[s].DisplayMember+'="'+new Date(this.ProductGrid[t][this.ProductColumnSource[s].DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy")+'" '):"DATETIME"!=this.ProductColumnSource[s].DataType&&"TIME"!=this.ProductColumnSource[s].DataType||!this.ProductColumnSource[s].DisplayMember.toLowerCase().Contains("alpha")?"ComboBox"==this.ProductColumnSource[s].DataType&&this.ProductColumnSource[s].ValueBinding.toLowerCase().Contains("alpha")?e+=this.ProductColumnSource[s].ValueBinding+'="'+m.d.GetValidXml(this.ProductGrid[t][this.ProductColumnSource[s].ValueBinding].toString())+'" ':"PactComboBox"==this.ProductColumnSource[s].DataType&&this.ProductColumnSource[s].ValueBinding.toLowerCase().Contains("alpha")?e+=this.ProductColumnSource[s].ValueBinding+'="'+m.d.GetValidXml(this.ProductGrid[t][this.ProductColumnSource[s].ValueBinding+"_Key"].toString())+'" ':"LISTBOX"==this.ProductColumnSource[s].DataType&&0!=this.ProductColumnSource[s].CostCenterID&&this.ProductColumnSource[s].DisplayMember.toLowerCase().Contains("alpha")?e+=this.ProductColumnSource[s].DisplayMember+'="'+this.ProductGrid[t][this.ProductColumnSource[s].ValueMember].toString()+'" ':this.ProductColumnSource[s].DisplayMember.toLowerCase().Contains("alpha")&&(e+=this.ProductColumnSource[s].DisplayMember+'="'+m.d.GetValidXml(this.ProductGrid[t][this.ProductColumnSource[s].DisplayMember].toString())+'" '):n.e.IsEmpty(this.ProductGrid[t][this.ProductColumnSource[s].DisplayMember+"_Key"])||(e+=this.ProductColumnSource[s].DisplayMember+'="'+new Date(this.ProductGrid[t][this.ProductColumnSource[s].DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy hh:mm:ss tt")+'" ');for(var i=1;i<=50;i++)n.e.IsEmpty(this.ProductGrid[t]["CCNID"+i+"_Key"])||"0"==this.ProductGrid[t]["CCNID"+i+"_Key"].toString()?e+=" CCNID"+i+'="1"':e+=" CCNID"+i+'="'+this.ProductGrid[t]["CCNID"+i+"_Key"].toString()+'"';e+="/>"}return e.length>0&&(e="<XML>"+e+"</XML>"),Logger.InfoLog("OpportunityProductXML::Exiting GetXML which RETURN XML="+e),e.toString()}},{key:"GetCRMProductName",value:function(){var e=null;""!=a.a.SessionManager.Preferences["CRM-Products"].toString()&&"0"!=a.a.SessionManager.Preferences["CRM-Products"].toString()&&(null!=(e=a.a.admin.GetTableData(parseInt(a.a.SessionManager.Preferences["CRM-Products"].toString())))&&(this.dbCRMProduct=e.Tables[0]))}},{key:"LoadProductData",value:function(e,t){var s=this;if(null!=e||0!=e.length){this.ProductGridObj.Clear(),this.GetCRMProductName();for(var i=null,o=function(o){var l=e[o];if((i=s.ProductGridObj.NewRow()).ProductID_Key=l.ProductID,i.isChecked=!1,i.CRMProduct_Key=l.CRMProduct,null!=s.dbCRMProduct){var u=s.dbCRMProduct.filter((function(e){return e.NODEID==l.CRMProduct}));u.length>0&&(i.CRMProduct=u[0].Name)}i.ProductName=l.ProductName,i.ProductCode=l.ProductCode,i.Description=r.GetValidXmlReserve(l.Description.toString()),i.Qty=l.Quantity,i.UOM=l.UnitName,i.isEdit=!0,i.UOM_Key=l.UOMID,i.CurrencyID=l.CurrName,i.CurrencyID_Key=l.CurrencyID;for(var c=0;c<s.ProductColumnSource.length;c++)if(s.ProductColumnSource[c].CostCenterID>0)s.ProductColumnSource[c].DisplayMember.toLowerCase().Contains("alpha")&&n.e.IsNum(l[s.ProductColumnSource[c].DisplayMember])&&(i[s.ProductColumnSource[c].DisplayMember+"_Key"]=l[s.ProductColumnSource[c].DisplayMember]);else if("DATE"==s.ProductColumnSource[c].DataType||"DATETIME"==s.ProductColumnSource[c].DataType||"TIME"==s.ProductColumnSource[c].DataType){if(!n.e.IsEmpty(l[s.ProductColumnSource[c].DisplayMember]))if("DATETIME"==s.ProductColumnSource[c].DataType)try{i[s.ProductColumnSource[c].DisplayMember]=new Date(l[s.ProductColumnSource[c].DisplayMember].toString()).ToString(a.a.SessionManager.Preferences["Date Format"]+" hh:mm:ss tt"),i[s.ProductColumnSource[c].DisplayMember+"_Key"]=l[s.ProductColumnSource[c].DisplayMember].toString()}catch(C){}else if("TIME"==s.ProductColumnSource[c].DataType)try{i[s.ProductColumnSource[c].DisplayMember]=new Date(l[s.ProductColumnSource[c].DisplayMember].toString()).ToString("hh:mm:ss tt"),i[s.ProductColumnSource[c].DisplayMember+"_Key"]=l[s.ProductColumnSource[c].DisplayMember].toString()}catch(m){}else try{i[s.ProductColumnSource[c].DisplayMember]=new Date(l[s.ProductColumnSource[c].DisplayMember].toString()).ToString(a.a.SessionManager.Preferences["Date Format"]),i[s.ProductColumnSource[c].DisplayMember+"_Key"]=new Date(l[s.ProductColumnSource[c].DisplayMember].toString())}catch(h){}}else"ComboBox"==s.ProductColumnSource[c].DataType?i[s.ProductColumnSource[c].ValueBinding]=l[s.ProductColumnSource[c].ValueBinding]:"PactComboBox"==s.ProductColumnSource[c].DataType?(i[s.ProductColumnSource[c].ValueBinding]=l[s.ProductColumnSource[c].ValueBinding],i[s.ProductColumnSource[c].ValueBinding+"_Key"]=l[s.ProductColumnSource[c].ValueBinding]):"FLOAT"==s.ProductColumnSource[c].DataType?n.e.IsNum(l[s.ProductColumnSource[c].DisplayMember])&&(i[s.ProductColumnSource[c].DisplayMember]=l[s.ProductColumnSource[c].DisplayMember]):t.Contains(s.ProductColumnSource[c].DisplayMember)&&(i[s.ProductColumnSource[c].DisplayMember]=l[s.ProductColumnSource[c].DisplayMember]);for(var d=1;d<=50;d++)n.e.IsEmpty(l["CCNID"+d+"_Key"])||(i["CCNID"+d+"_Key"]=l["CCNID"+d+"_Key"].toString(),i["CCNID"+d]=l["CCNID"+d].toString());s.ProductGridObj.addRow(i)},l=0;l<e.length;l++)o(l);this.CalculateProductvalue();for(var u=e.length;u<15;u++)this.ProductGridObj.addEmptyRow(),this.ProductGrid[u][0]=!1;this.ProductGridObj.refreshDataView()}}},{key:"FillDefaultValues",value:function(e){this.ProductColumnSource.forEach((function(t){!n.e.IsEmpty(t.DefaultValue)&&null!=t.ValueBinding&&""!=t.ValueBinding&&t.ValueBinding.toLowerCase().Contains("alpha")?""==e[t.ValueBinding].toString()&&(e[t.ValueBinding]=t.DefaultValue):!n.e.IsEmpty(t.DefaultValue)&&null!=t.DisplayMember&&""!=t.DisplayMember&&t.DisplayMember.toLowerCase().Contains("alpha")&&""==e[t.DisplayMember].toString()&&(n.e.IsEmpty(t.DefaultValue)||"today"!=t.DefaultValue.toLowerCase()?e[t.DisplayMember]=t.DefaultValue:"DATETIME"==t.DataType?(e[t.DisplayMember+"_Key"]=new Date,e[t.DisplayMember]=e[t.DisplayMember+"_Key"].ToString(a.a.SessionManager.Preferences["Date Format"]+" hh:mm:ss tt")):"TIME"==t.DataType?(e[t.DisplayMember+"_Key"]=new Date,e[t.DisplayMember]=e[t.DisplayMember+"_Key"].ToString("hh:mm:ss tt")):"DATE"==t.DataType&&(e[t.DisplayMember]=Date.Today().ToString(a.a.SessionManager.Preferences["Date Format"]),e[t.DisplayMember+"_Key"]=Date.Today()))}))}},{key:"PopulateSuppliersBasedOnCRMProduct",value:function(e){var t=this;if(""!=e.CRMProduct_Key.toString()&&0!=parseInt(e.CRMProduct_Key.toString())&&!(e.Table.Select("CRMProduct_Key="+e.CRMProduct_Key.toString()).length>1||null==this.parent||"AddEditLeads"!=this.parent.ClassName&&"AddEditOpportunity"!=this.parent.ClassName)){var s,i=function(){var i=null;if("AddEditLeads"==t.parent.ClassName){var r=t.parent;null!=r.ScreenObject&&(i=r.ScreenObject.Data)}else if("AddEditOpportunity"==t.parent.ClassName){var l=t.parent;null!=l.ScreenObject&&(i=l.ScreenObject.Data)}var u=null;if(null!=i){if(0==i.Tables.length)return{v:void 0};var d=i.Tables[4].Select("Name='DimensionMappingProfileName'");if(d.length>0&&!n.e.IsEmpty(d[0].Value)){if(0==parseInt(d[0].Value.toString()))return{v:void 0};var C=i.Tables[4].Select("Name='EnableAutoPopulateSuppliers'");if(C.length>0&&!n.e.IsEmpty(C[0].Value)&&!Object(o.j)(C[0].Value.toString()))return{v:void 0};null!=t.ProductColumnSource&&((C=i.Tables[4].Select("Name='AutoPupulateSuppliers'")).length>0&&!n.e.IsEmpty(C[0].Value)&&(u=t.ProductColumnSource.find((function(e){return 0!=e.CostCenterID&&e.CostCenterID==parseInt(C[0].Value)}))));var m=[];m.push(t.CRMProductCCID),m.push(e.CRMProduct_Key.toString()),m.push(d[0].Value),m.push(a.a.SessionManager.UserID),m.push(a.a.SessionManager.LanguageID);var h=a.a.admin.GetDimensionMappingByFilter(m);null!=h&&h.Tables.length>0&&h.Tables[0].length>0&&function(){var i=h.Tables[0],o=h.Columns[0],r=new Array,l=null,d=null,C=new Array;if(h.Columns[0].Contains("DefXml")){(l=new n.f).LoadXml(i[0].DefXml.toString()),d=l.SelectNodes("XML/Row");for(var m=0;m<d.length;m++)null!=d[m].attributes.cols&&""!=d[m].attributes.cols.value&&parseInt(d[m].attributes.cols.value)!=t.CRMProductCCID&&r.push(parseInt(d[m].attributes.cols.value))}for(var b=t.ProductGrid.indexOf(e),S=0;S<i.length;S++){b>=t.ProductGrid.length&&t.ProductGridObj.addEmptyRow(),t.ProductGrid[b].CRMProduct=e.CRMProduct.toString(),n.e.IsEmpty(e.CRMProduct_Key)||(t.ProductGrid[b].CRMProduct_Key=e.CRMProduct_Key.toString()),n.e.IsEmpty(e.ProductID_Key)||(t.ProductGrid[b].ProductID_Key=e.ProductID_Key.toString()),t.ProductGrid[b].ProductName=e.ProductName.toString(),t.ProductGrid[b].ProductCode=e.ProductCode.toString(),t.ProductGrid[b].UOM=e.UOM.toString(),t.ProductGrid[b].UOM_Key=e.UOM_Key.toString();for(var D=function(e){if(t.ProductGridObj.TableColumns.Contains(o[e].toLowerCase())&&o[e].Contains("CCNID")){if(0==r.length)return"break";if(0==r.find((function(t){return t==5e4+parseInt(o[e].Replace("CCNID",""))})))return"continue";try{C.push(o[e]),C.push(o[e]+"_key"),t.ProductGrid[b][o[e]+"_key"]=i[S][o[e]].toString(),t.ProductGrid[b][o[e]]=i[S]["CC"+o[e].Replace("CCNID","")].toString()}catch(s){}}},g=0;g<o.length;g++){var p=D(g);if("break"===p)break}for(var I=function(s){t.ProductGridObj.TableColumns[s].toLowerCase().Contains("ccnid")?t.ProductGridObj.TableColumns[s]!=u.DisplayMember&&t.ProductGridObj.TableColumns[s]!=u.ValueMember&&0==C.filter((function(e){return e.toString().toLowerCase()==t.ProductGridObj.TableColumns[s].toLowerCase()})).length&&(t.ProductGrid[b][t.ProductGridObj.TableColumns[s]]=e[t.ProductGridObj.TableColumns[s]].toString()):n.e.IsEmpty(e[t.ProductGridObj.TableColumns[s]])||(t.ProductGrid[b][t.ProductGridObj.TableColumns[s]]=e[t.ProductGridObj.TableColumns[s]].toString())},y=0;y<t.ProductGridObj.TableColumns.length;y++)I(y);if(e.Table.Columns.Contains("Description")&&(t.ProductGrid[b].Description=e.Description.toString()),t.FillDefaultValues(t.ProductGrid[b]),null==u&&(u=new c.a),(s=t.ProductColumnSource.find((function(e){return null!=e.DisplayMember&&e.DisplayMember==u.DisplayMember})))&&null!=s.ID){var T=0;86==t.CostCenterID?T=115:73==t.CostCenterID?T=156:89==t.CostCenterID?T=154:88==t.CostCenterID&&(T=155),t.dvCnt=t.dvCntTable.filter((function(e){return null!=e.LocalReference&&(e.LocalReference==s.ID||26642==e.LocalReference)})),t.dvCnt.length>0&&""!=s.ValueMember&&!n.e.IsEmpty(t.ProductGrid[b][s.ValueMember])&&a.a.common.GetLinkReferenceData(parseInt(s.ID),T,parseInt(t.ProductGrid[b][s.ValueMember].toString()),t.ProductGrid[b])}b++}}()}}}();if("object"==typeof i)return i.v}}},{key:"OnCellEditEnding",value:function(e){var t=e.item;if("DataGridComboBoxColumn"!=e.column.className){if("DataGridPactListBoxColumn"==e.column.className){var s=e.column.field,i=this.ProductColumnSource.find((function(e){return null!=e.DisplayMember&&e.DisplayMember==s}));if(null!=i&&null!=i.ValueMember&&n.e.IsNum(t[i.ValueMember])&&parseInt(t[i.ValueMember])>0&&parseInt(t[i.ValueMember])==this.ProdID)return;this.CRMProductCCID>0&&(3!=this.CRMProductCCID||"ProductName"!=s||n.e.IsEmpty(t.ProductID_Key)?this.CRMProductCCID>5e4&&"CRMProduct"==s&&!n.e.IsEmpty(t.CRMProduct_Key)&&this.LoadCRMProductData(t,parseInt(t.CRMProduct_Key)):this.LoadCRMProductData(t,parseInt(t.ProductID_Key)));var o=0;if(86==this.CostCenterID?o=115:73==this.CostCenterID?o=156:89==this.CostCenterID?o=154:88==this.CostCenterID&&(o=155),this.FillDefaultValues(t),null==t.ProductID_Key&&""==t.ProductID_Key.toString()&&""!=a.a.SessionManager.Preferences["CRM-Products"].toString()&&"0"!=a.a.SessionManager.Preferences["CRM-Products"].toString()&&null!=this.DS&&this.DS.Tables.length>3&&this.DS.Tables[3].length>0&&this.DS.Tables[3].length>0&&this.DS.Columns[3].Contains("NAME")&&!n.e.IsEmpty(this.DS.Tables[3][0].NAME)&&(this.DS.Tables.length>4&&this.DS.Tables[4].length>0?(t.ProductID_Key=this.DS.Tables[4][0].ProductID.toString(),t.ProductName=this.DS.Tables[4][0].PRODUCTNAME.toString(),t.ProductCode=this.DS.Tables[4][0].PRODUCTCODE.toString()):(t.ProductID_Key="0",t.ProductName="DynamicSet",t.ProductCode="DynamicSet"),this.Load(t,parseInt(t.ProductID_Key))),"ProductName"==s)this.Load(t,parseInt(t.ProductID_Key)),null!=this.dvCnt&&(r=this.ProductColumnSource.find((function(e){return null!=e.DisplayMember&&e.DisplayMember==s})))&&null!=r.ID&&(this.dvCnt=this.dvCntTable.filter((function(e){return null!=e.LocalReference&&(e.LocalReference==r.ID||26658==e.LocalReference)})),this.dvCnt.length>0&&""!=r.ValueMember&&!n.e.IsEmpty(t[r.ValueMember])&&a.a.common.GetLinkReferenceData(26658,o,parseInt(t.ProductID_Key.toString()),t));else if("CRMProduct"==s)null!=this.dvCnt&&(r=this.ProductColumnSource.find((function(e){return null!=e.DisplayMember&&e.DisplayMember==s})))&&null!=r.ID&&(this.dvCnt=this.dvCntTable.filter((function(e){return null!=e.LocalReference&&(e.LocalReference==r.ID||26642==e.LocalReference)})),this.dvCnt.length>0&&""!=r.ValueMember&&!n.e.IsEmpty(t[r.ValueMember])&&a.a.common.GetLinkReferenceData(26642,o,parseInt(t.CRMProduct_Key.toString()),t)),this.PopulateSuppliersBasedOnCRMProduct(t);else if(null!=this.dvCnt){var r;(r=this.ProductColumnSource.find((function(e){return null!=e.DisplayMember&&e.DisplayMember==s})))&&null!=r.ID&&r.CostCenterID>5e4&&(this.dvCnt=this.dvCntTable.filter((function(e){return null!=e.LocalReference&&e.LocalReference==r.ID})),this.dvCnt.length>0&&""!=r.ValueMember&&!n.e.IsEmpty(t[r.ValueMember])&&a.a.common.GetLinkReferenceData(parseInt(r.ID),o,parseInt(t[r.ValueMember]),t))}}this.CalculateProductvalue(),this.CalculateTotals(t),this.ProductGridObj.updateRow(t)}}},{key:"CalculateProductvalue",value:function(){var e=this,t=0;if(0!=this.SrcProductValueMapping.length){if(this.SrcProductValueMapping.length>0&&this.ProductGridObj.TableColumns.Contains(this.SrcProductValueMapping))for(var s=0;s<this.ProductGrid.length;s++)!n.e.IsEmpty(this.ProductGrid[s].ProductID_Key)&&n.e.IsNum(this.ProductGrid[s][this.SrcProductValueMapping])&&(t+=parseFloat(this.ProductGrid[s][this.SrcProductValueMapping]));if(this.DestProductValueMapping.length>0){var i=!1;if("AddEditLeads"==this.parent.ClassName){var a=this.parent;if(null!=a.ScreenObject){if(!i){var o=a.ScreenObject.StaticFields.find((function(t){return t instanceof S.c&&null!=t.DBColumnName&&t.DBColumnName.toLowerCase()==e.DestProductValueMapping.toString().toLowerCase()}));o instanceof m.d&&(i=!0,o.Text=t.ToString("N2"))}if(!i)for(var r=0;r<a.ScreenObject.CustomTab.Pages.length;r++)if((c=a.ScreenObject.CustomTab.Pages[r].Fields.find((function(t){return t instanceof S.c&&null!=t.DBColumnName&&t.DBColumnName.toLowerCase()==e.DestProductValueMapping.toString().toLowerCase()})))instanceof m.d){c.Text=t.ToString("N2");break}}}else if("AddEditOpportunity"==this.parent.ClassName){var l=this.parent;if(null!=l.ScreenObject&&(i||(c=l.ScreenObject.StaticFields.find((function(t){return t instanceof S.c&&null!=t.DBColumnName&&t.DBColumnName.toLowerCase()==e.DestProductValueMapping.toString().toLowerCase()})))instanceof m.d&&(i=!0,c.Text=t.ToString("N2")),!i))for(var u=0;u<l.ScreenObject.CustomTab.Pages.length;u++){var c;if((c=l.ScreenObject.CustomTab.Pages[u].Fields.find((function(t){return t instanceof S.c&&null!=t.DBColumnName&&t.DBColumnName.toLowerCase()==e.DestProductValueMapping.toString().toLowerCase()})))instanceof m.d){c.Text=t.ToString("N2");break}}}}}}},{key:"Load",value:function(e,t){var s=a.a.inventory.GetProductData(parseInt(e.ProductID_Key.toString()));s.Tables.length>0&&s.Tables[0].length>0&&s.Columns[0].Contains("UOMID")&&!n.e.IsEmpty(s.Tables[0][0].UOMID)&&(e.UOM=s.Tables[0][0].UnitName.toString(),e.UOM_Key=s.Tables[0][0].UOMID.toString()),null==this.ProductColumnSource.find((function(e){return"Description"==e.Header}))||n.e.IsEmpty(e.ProductID_Key)||s.Tables.length>0&&s.Tables[0].length>0&&s.Columns[0].Contains("Description")&&!n.e.IsEmpty(s.Tables[0][0].uomid)&&(e.Description=s.Tables[0][0].Description.toString())}},{key:"LoadCRMProductData",value:function(e,t){var s=this,i=null;this.CRMProductCCID>5e4&&(i=a.a.common.GetCostCenterDetails(0,this.CRMProductCCID,t,0));var o=new P.a;o.ProductID=t,null!=(i=o.GetCopyProductDetails(t))&&i.Tables.length>7&&(this.ProductColumnSource.forEach((function(t){if(t.CostCenterID>5e4&&t.CostCenterID!=s.CRMProductCCID&&s.ProductGridObj.TableColumns.Contains("CCNID"+(t.CostCenterID-5e4))){var a="CCNID"+(t.CostCenterID-5e4);e[a+"_Key"]=n.e.StringValue(i.Tables[7][0][a].toString()),e[a]=n.e.StringValue(i.Tables[7][0][a.Replace("CCNID","NAME")])}})),this.ProductGridObj.updateRow(e))}},{key:"AddProductToGrid",value:function(e){var t=a.a.inventory.GetProductData(e);if(null!=t&&t.Tables.length>0&&t.Tables[0].length>0){var s=t.Tables[0][0],i=this.ProductGridObj.NewRow();this.ProductGrid.InsertAt(i,this.RowIndex),i.ProductID_Key=e,i.ProductName=s.ProductName,i.Description=s.Description,i.Qty="1",i.UOM=s.UnitName,i.UOM_Key=s.UOMID}}},{key:"FillDictionary",value:function(e){var t=this,s=this.ProductColumnSource;this.fldDict.keys.forEach((function(i){var a=i,o=s.filter((function(e){return e.Header==t.fldDict[a].getFieldName()}));o.length>0&&"ComboBox"==o[0].DataType&&!n.e.IsEmpty(e[o[0].ValueBinding])?t.fldDict[a].setFieldValue(e[o[0].ValueBinding]):o.length>0&&"PactComboBox"==o[0].DataType&&!n.e.IsEmpty(e[o[0].ValueBinding+"_Key"])?t.fldDict[a].setFieldValue(e[o[0].ValueBinding+"_Key"]):o.length>0&&("DATE"==o[0].DataType||"DATETIME"==o[0].DataType||"TIME"==o[0].DataType)&&!n.e.IsEmpty(e[o[0].DisplayMember+"_Key"])?t.fldDict[a].setFieldValue(e[o[0].DisplayMember+"_Key"]):o.length>0&&"ComboBox"!=o[0].DataType&&"DATE"!=o[0].DataType&&"DATETIME"!=o[0].DataType&&"TIME"!=o[0].DataType&&"PactComboBox"!=o[0].DataType&&!n.e.IsEmpty(e[o[0].DisplayMember])?n.e.IsNum(e[o[0].DisplayMember])?t.fldDict[a].setFieldValue(null!=o[0].DecimalPoints&&""!=o[0].DecimalPoints?parseFloat(e[o[0].DisplayMember].toString()).ToString("N"+o[0].DecimalPoints):e[o[0].DisplayMember]):t.fldDict[a].setFieldValue(e[o[0].DisplayMember]):t.fldDict[a].setFieldValue(o.length>0&&("STRING"==o[0].DataType||"TEXT"==o[0].DataType||"LINK"==o[0].DataType)?"":0)})),this.ProductGridObj.TableColumns.Contains("Rate")&&!n.e.IsEmpty(e.Rate)?this.fldDict.RATE.setFieldValue(e.Rate):this.fldDict.RATE.setFieldValue(0),this.ProductGridObj.TableColumns.Contains("Qty")&&!n.e.IsEmpty(e.Qty)?this.fldDict.QTY.setFieldValue(e.Qty):this.fldDict.QTY.setFieldValue(0)}},{key:"CalculateTotals",value:function(e){this.FillDictionary(e);for(var t,s=this.ProductColumnSource,i=0;i<s.length;i++)if(null!=s[i].Formula&&""!=s[i].Formula&&4!=s[i].SectionID){try{t=this.eval.EvaluateExpression(s[i].Formula,this.fldDict).toString(),n.e.IsNum(t)&&(null!=s[i].DecimalPoints&&""!=s[i].DecimalPoints?e[s[i].DisplayMember]=parseFloat(t.toString()).ToString("N"+s[i].DecimalPoints):null!=t&&(e[s[i].DisplayMember]=t.toString())),this.CalculateProductvalue()}catch(a){Logger.ErrorLog("","Formua evaluation calculate totals",a)}"Qty"==s[i].DisplayMember?this.fldDict.QTY.setFieldValue(e.Qty):"Rate"==s[i].DisplayMember&&this.fldDict.RATE.setFieldValue(e.Rate)}}},{key:"onBeginEdit",value:function(e){var t=e.args;if("DataGridPactListBoxColumn"==e.args.column.className){var s=t.column.internalColumnEditor.collection,i=this.ProductColumnSource.find((function(t){return null!=t.DisplayMember&&t.DisplayMember==e.args.column.field})),o=e.args.item;if(this.ProdID=null!=i&&null!=i.ValueMember&&this.ProductGridObj.TableColumns.Contains(i.ValueMember)&&n.e.Int(o[i.ValueMember])>0?parseInt(o[i.ValueMember]):0,11==s.CostCenterID){var r="";this.ProductGridObj.TableColumns.Contains("ProductID_Key")&&(r=o.ProductID_Key.toString());var l=" (BaseID IN ";l+=" (SELECT     BaseID ",l=(l+=" FROM          COM_UOM AS COM_UOM_1 with(nolock) ")+" WHERE      (UOMID =(select UOMID from inv_product with(nolock) where productid="+r+") ))) ",""==r&&(l=" (BaseID IN ",l+=" (SELECT     BaseID ",l+=" FROM          COM_UOM AS COM_UOM_1 with(nolock) ",l+=" WHERE      (UOMID =-1 ))) "),s.FilterCondition=l}else if(3==s.CostCenterID)""!=a.a.SessionManager.Preferences["CRM-Products"].toString()&&"0"!=a.a.SessionManager.Preferences["CRM-Products"].toString()&&null!=this.DS&&this.DS.Tables.length>3&&this.DS.Tables[3].length>0&&this.DS.Tables[3].length>0&&this.DS.Columns[3].Contains("NAME")&&!n.e.IsEmpty(this.DS.Tables[3][0].NAME)&&(this.DS.Tables.length>4&&this.DS.Tables[4].length>0?(o.ProductID_Key=this.DS.Tables[4][0].ProductID.toString(),o.ProductName=this.DS.Tables[4][0].PRODUCTNAME.toString(),o.ProductCode=this.DS.Tables[4][0].PRODUCTCODE.toString()):(o.ProductID_Key="0",o.ProductName="DynamicSet",o.ProductCode="DynamicSet"),this.Load(o,parseInt(o.ProductID_Key)),t.Cancel=!0);else if(s.CostCenterID>5e4&&""!=i.DependantOn){var u="";if(i.Dependantinuse)this.ProductGridObj.TableColumns.Contains(i.DependantOn+"_Key")&&n.e.Int(o[i.DependantOn+"_Key"])>1&&(u="("+i.DependantOn+"="+o[i.DependantOn+"_Key"].toString(),1==i.Dependancy&&(u+=" OR "+i.DisplayMember.Replace("dc","")+"=1 "),u+=")");else if(this.ProductGridObj.TableColumns.Contains(i.DependantOn+"_Key")&&n.e.Int(o[i.DependantOn+"_Key"])>1){var c=this.ProductColumnSource.find((function(e){return null!=e.DisplayMember&&e.DisplayMember.toLowerCase()==i.DependantOn.toLowerCase()}));c&&(s.Join=5==i.Dependancy?" join COM_CostCenterCostCenterMap DCCM with(nolock) on a.NodeID=DCCM.NodeID and DCCM.CostCenterID="+i.CostCenterID+" and  DCCM.ParentCostCenterID="+c.CostCenterID+" and DCCM.ParentNodeID="+o[i.DependantOn+"_Key"].toString():" join COM_CostCenterCostCenterMap DCCM with(nolock) on a.NodeID=DCCM.ParentNodeID and DCCM.ParentCostCenterID="+i.CostCenterID+" and  DCCM.CostCenterID="+c.CostCenterID+" and DCCM.NodeID="+o[i.DependantOn+"_Key"].toString())}s.Where=null!=s.FilterCondition&&""!=s.FilterCondition?"and "+u:u}}}},{key:"ClearGrid",value:function(){if(this.bOnClick){for(var e=0;e<this.ProductGrid.length;e++)""!=this.ProductGrid[e].isEdit.toString()&&null!=this.ProductGrid[e].isEdit.toString()||!Object(o.j)(this.ProductGrid[e].isChecked)||n.e.IsEmpty(this.ProductGrid[e].ProductID_Key)||(this.ProductGrid[e].isEdit=!0);this.ProductGridObj.refreshDataView()}else{this.ProductGridObj.Clear();for(var t=0;t<15;t++)this.ProductGridObj.addEmptyRow(),this.ProductGrid[t][0]=!1}}},{key:"SelectUnselectAll",value:function(e){for(var t=0;t<this.ProductGrid.length;t++)0==this.SelectUnCheck&&(this.ProductGridObj.TableColumns.Contains("ProductID_Key")&&n.e.Int(this.ProductGrid[t].ProductID_Key)>0||this.ProductGridObj.TableColumns.Contains("CRMProduct_Key")&&n.e.Int(this.ProductGrid[t].CRMProduct_Key)>0)&&(this.ProductGrid[t].isChecked=e);this.SelectUnCheck=0}},{key:"OnCheckedChanged",value:function(e,t){t||1==this.SelectAll&&(this.SelectUnCheck=1,this.SelectAll=!1)}},{key:"angularGrid",get:function(){return this.ProductGridObj.angularGrid}},{key:"ProductGrid",get:function(){return this.ProductGridObj.Table}},{key:"ProductColumnSource",get:function(){return this.ProductGridObj.Columns},set:function(e){this.ProductGridObj.Columns=e}},{key:"SelectedRow",get:function(){return this.ProductGridObj.SelectedItem},set:function(e){this.ProductGridObj.SelectedItem=e}},{key:"SelectAll",get:function(){return this._SelectAll},set:function(e){e!=this._SelectAll&&(this._SelectAll=e,this.SelectUnselectAll(e))}}],[{key:"GetValidXml",value:function(e){return(e=(e=(e=e.Replace("&","&amp;")).Replace("'","&apos;&apos;")).Replace('"',"&quot;")).Replace("<","&lt;")}},{key:"GetValidXmlReserve",value:function(e){return(e=(e=(e=e.Replace("&amp;","&")).Replace("''","'")).Replace("&quot;",'"')).Replace("&lt;","<")}}]),r}(r.b)},cxZg:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var i=s("fXoL"),a=s("sYmb"),n=function(){var e=function(){function e(t){_classCallCheck(this,e),this.translate=t}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}();return e.\u0275fac=function(t){return new(t||e)(i.Tb(a.e))},e.\u0275cmp=i.Nb({type:e,selectors:[["app-view-email-templates"]],decls:29,vars:7,consts:[[1,"master-screen",2,"width","300px"],[1,"PACTHeaderFields","dialogSubBody"],[1,"row","form-row"],[1,"form-group","col-xl-12","col-md-12","col-sm-12","col-xs-12","PACTControl",2,"height","180px"],["FieldDirective","",3,"obj"],[1,"Pactdailogfooter"],[1,"primary-btn-wicon",3,"click"],[1,"secondary-btn-wicon",3,"click"],[1,"fa-light","fa-rectangle-xmark"]],template:function(e,t){1&e&&(i.Zb(0,"div",0),i.Wc(1,"\n    "),i.Zb(2,"div",1),i.Wc(3,"\n\n        "),i.Zb(4,"div",2),i.Wc(5,"\n            "),i.Zb(6,"div",3),i.Wc(7,"\n                "),i.Vb(8,4),i.Wc(9,"\n            "),i.Yb(),i.Wc(10,"\n        "),i.Yb(),i.Wc(11,"\n\n    "),i.Yb(),i.Wc(12,"\n    "),i.Zb(13,"div",5),i.Wc(14,"\n      "),i.Zb(15,"div"),i.Wc(16,"\n        "),i.Zb(17,"button",6),i.hc("click",(function(){return t.obj.OnSave("OK")})),i.Wc(18),i.mc(19,"translate"),i.Yb(),i.Wc(20,"\n        "),i.Zb(21,"button",7),i.hc("click",(function(){return t.obj.OnSave("Cancel")})),i.Ub(22,"i",8),i.Wc(23),i.mc(24,"translate"),i.Yb(),i.Wc(25,"\n      "),i.Yb(),i.Wc(26,"\n  "),i.Yb(),i.Wc(27,"\n"),i.Yb(),i.Wc(28,"\n")),2&e&&(i.Db(8),i.tc("obj",t.obj.ProductGridObj),i.Db(10),i.Xc(i.nc(19,3,"Com_OK")),i.Db(5),i.Xc(i.nc(24,5,"Cancel")))},encapsulation:2}),e}()},nFYD:function(e,t,s){"use strict";s.d(t,"a",(function(){return D}));var i=s("Do2H"),a=s("Lp6j"),n=s("ScVY"),o=s("VxiT"),r=s("8B8H"),l=s("NkMH"),u=s("ockk"),c=s("EQd/"),d=s("JIg3"),C=s("n56n"),m=s("0/4Q"),h=s("Jnyl"),b=s("z5gp"),S=s("E6JT"),D=function(e){_inherits(s,e);var t=_createSuper(s);function s(e){var a;_classCallCheck(this,s),(a=t.call(this)).Module="CRM",a.Visible=!0,a.ScreenObject=new o.a,a.ColumnSpan="4",a.FeedBackDataObj=new r.a,a.ButtonAdd=new l.a,a.res="";try{var n;a.ClassName="ViewFeedbackViewModel",a.Parent=e,a.ScreenObject.Data=i.a.crmService.GetFeedbackDetails(114),i.a.SessionManager.HideUnathorizedAccess?a.ButtonAdd.Visible=i.a.SessionManager.IsActionAssigned(a.Parent.CostCenterID,"FollowUp_Create"):a.ButtonAdd.Enable=i.a.SessionManager.IsActionAssigned(a.Parent.CostCenterID,"FollowUp_Create"),a.FeedBackDataObj.CanUserAddRows=!0,i.a.SessionManager.IsActionAssigned(a.Parent.CostCenterID,"FollowUp_Delete")&&(a.FeedBackDataObj.CanUserDeleteRows=!0),a.FeedBackDataObj.CanUserResizeColumns=!0,a.FeedBackDataObj.OnLinkClick.Subscribe(_assertThisInitialized(a),"OnGridLinkClick"),a.FeedBackDataObj.ContextMenu=[],i.a.SessionManager.IsActionAssigned(a.Parent.CostCenterID,"FollowUp_Update")&&a.FeedBackDataObj.ContextMenu.push("EDIT","EDIT"),i.a.SessionManager.IsActionAssigned(a.Parent.CostCenterID,"FollowUp_Delete")&&a.FeedBackDataObj.ContextMenu.push("DELETE","DELETE"),a.FeedBackDataObj.Table=[],a.FeedBackDataObj.TableColumns.push("NodeID"),a.FeedBackDataObj.TableColumns.push("FeedBack"),a.FeedBackDataObj.TableColumns.push("Date"),a.FeedBackDataObj.TableColumns.push("Date_Key"),a.FeedBackDataObj.TableColumns.push("CreatedBy"),a.FeedBackDataObj.TableColumns.push("View"),a.FeedBackDataObj.TableColumns.push("Imagefilepath"),a.FeedBackDataObj.RowHeight=30,a.FeedBackDataObj.Columns=new Array,(n=new u.a).Header=i.a.GetResource("View"),n.DisplayMember="View",n.DataType="LINK",n.Width=50,n.IsVisible=!0,n.ReadOnly=!0,a.FeedBackDataObj.Columns.push(n),(n=new u.a).Header=i.a.GetResource("Feed_Date"),n.DisplayMember="Date",n.DataType="TEXTBOX",n.Width=150,n.IsVisible=!0,n.ReadOnly=!0,a.FeedBackDataObj.Columns.push(n),(n=new u.a).Header=i.a.GetResource("UserName"),n.DisplayMember="CreatedBy",n.DataType="TEXTBOX",n.Width=150,n.IsVisible=!0,n.ReadOnly=!0,a.FeedBackDataObj.Columns.push(n),(n=new u.a).Header=i.a.GetResource("Image"),n.DisplayMember="Imagefilepath",n.DataType="IMAGE",n.Width=75,n.ReadOnly=!0,a.FeedBackDataObj.Columns.push(n),(n=new u.a).Header=i.a.GetResource("Feed_Diss"),n.DisplayMember="FeedBack",n.DataType="TEXTBOX",n.Width=350,n.IsVisible=!0,n.ReadOnly=!0,a.FeedBackDataObj.Columns.push(n);for(var c=0;c<a.ScreenObject.Data.Tables[0].length;c++)"True"==a.ScreenObject.Data.Tables[0][c].IsVisible.toString()&&a.ScreenObject.Data.Tables[0][c].SysColumnName.toString().Contains("CCNID")?((n=new u.a).Header=a.ScreenObject.Data.Tables[0][c].UserColumnName.toString(),n.CostCenterID=parseInt(a.ScreenObject.Data.Tables[0][c].ColumnCostCenterID),n.TypeID=1,n.DataType="LISTBOX",n.DisplayMember=a.ScreenObject.Data.Tables[0][c].SysColumnName.toString(),n.ValueMember=a.ScreenObject.Data.Tables[0][c].SysColumnName.toString()+"_Key",n.Width=170,n.IsVisible=!0,n.ReadOnly=!0,a.FeedBackDataObj.Columns.push(n),a.FeedBackDataObj.TableColumns.push(n.DisplayMember),a.FeedBackDataObj.TableColumns.push(n.ValueMember)):"True"==a.ScreenObject.Data.Tables[0][c].IsVisible.toString()&&a.ScreenObject.Data.Tables[0][c].SysColumnName.toString().Contains("Alpha")&&((n=new u.a).Header=a.ScreenObject.Data.Tables[0][c].UserColumnName.toString(),n.DisplayMember=a.ScreenObject.Data.Tables[0][c].SysColumnName.toString(),n.DataType="TEXTBOX",n.Width=150,n.IsVisible=!0,n.ReadOnly=!0,a.FeedBackDataObj.Columns.push(n),a.FeedBackDataObj.TableColumns.push(n.DisplayMember))}catch(d){throw Logger.ErrorLog("ViewFeedbackViewModel:: ViewFeedbackViewModel",d),d}return Logger.InfoLog("ViewFeedbackViewModel::Exiting ViewFeedbackViewModel"),a}return _createClass(s,[{key:"OnGridLinkClick",value:function(e,t,s){if("View"==t){this.OnCmnItem_Click("EDIT"),this.Parent.Feedback.FeedbackDate.Enable=!1,this.Parent.Feedback.Feedback.Enable=!1;for(var i=0;i<this.Parent.Feedback.Fields.length;i++)this.Parent.Feedback.Fields[i].Enable=!1;this.Parent.Feedback.ButtonSave.Enable=!1,this.Parent.Feedback.isView=!0}}},{key:"ViewFeedbackViewModel",value:function(){}},{key:"OnNewClick",value:function(e){73==this.Parent.CostCenterID&&(this.Parent.ReportInfoVisibility=!1),this.Parent.Feedback=new S.a(this),this.Parent.Feedback.isView=!1,i.a.page.ShowDialog(this.Parent.Feedback,b.a,{ShowCenter:!0,NoWidth:!0}),this.Parent.FeedbackVisibility=!0}},{key:"OnCmnItem_Click",value:function(e){if(Logger.InfoLog("ViewFeedbackViewModel::Entering OnCmnItem_Click"),null!=e&&"EDIT"==e.toString()){if(!i.a.SessionManager.IsActionAssigned(this.Parent.CostCenterID,"FollowUp_Update")&&!i.a.SessionManager.IsActionAssigned(this.Parent.CostCenterID,"FollowUp_Read"))return;if(null!=this.FeedBackDataObj.SelectedItem&&(this.SelectedRow=this.FeedBackDataObj.SelectedItem,""!=this.SelectedRow.Date.toString())){this.OnNewClick(""),this.Parent.Feedback.FeedbackDate.Date=new Date(this.SelectedRow.Date),this.Parent.Feedback.Feedback.Text=this.SelectedRow.FeedBack.toString(),this.Parent.Feedback.isEdit=!0;for(var t=0;t<this.Parent.Feedback.Fields.length;t++){var s=this.Parent.Feedback.Fields[t];s instanceof c.d?s.Text=this.SelectedRow[s.SysColumnName].toString():s instanceof d.a?s.Date=new Date(this.SelectedRow[s.SysColumnName].toString()):s instanceof m.e?s.SelectedValue=this.SelectedRow[s.SysColumnName].toString():s instanceof h.a?s.TextBox.Text=this.SelectedRow[s.SysColumnName].toString():s instanceof c.c?s.Text=this.SelectedRow[s.SysColumnName].toString():s instanceof C.b&&""!=this.SelectedRow[s.SysColumnName].toString()&&null!=this.SelectedRow[s.SysColumnName]&&(s.SelectedValue=parseInt(this.SelectedRow[s.SysColumnName+"_Key"]))}}}else if(null!=e&&"DELETE"==e.toString()){if(!i.a.SessionManager.IsActionAssigned(this.Parent.CostCenterID,"FollowUp_Delete"))return;null!=this.FeedBackDataObj.SelectedItem&&(this.SelectedRow=this.FeedBackDataObj.SelectedItem,this.FeedBackDataObj.removeRow(this.SelectedRow))}Logger.InfoLog("ViewFeedbackViewModel::Exiting OnCmnItem_Click")}},{key:"OnMessageCallBack",value:function(){this.res="Yes"}},{key:"GetXML",value:function(){var e=this;try{var t="";t+="<XML>";for(var s=function(s){""!=e.FeedBackDataObj.Table[s].Date.toString()&&(t+="<Row ",t+=' Date="'+e.FeedBackDataObj.Table[s].Date+'"',t+=' FeedBack="'+c.d.GetValidXml(e.FeedBackDataObj.Table[s].FeedBack.toString())+'"',t+=' CreatedBy="'+e.FeedBackDataObj.Table[s].CreatedBy.toString()+'" ',e.FeedBackDataObj.Columns.forEach((function(i){i.DisplayMember.Contains("CCNID")?t+=i.DisplayMember+'="'+e.FeedBackDataObj.Table[s][i.ValueMember].toString()+'" ':i.DisplayMember.Contains("Alpha")&&(t+=i.DisplayMember+'="'+c.d.GetValidXml(e.FeedBackDataObj.Table[s][i.DisplayMember].toString())+'"')})),t+="></Row>  ")},i=0;i<this.FeedBackDataObj.Table.length;i++)s(i);return(t+="</XML>").toString()}catch(a){return""}}},{key:"LoadData",value:function(e){var t=this;this.FeedBackDataObj.Table.Clear();try{for(var i=function(i){var n=t.FeedBackDataObj.NewRow();n.NodeID=e[i].NodeID,n.View="View",n.Date=new Date(e[i].CDate).ToString("dd/MMM/yyyy hh:mm:ss tt"),n.Date_Key=new Date(e[i].CDate),n.FeedBack=s.GetValidXmlReserve(e[i].Feedback),n.CreatedBy=e[i].CreatedBy.toString(),n.Imagefilepath=a.e.IsEmpty(e[i].Imagefilepath)?"":a.e.GetPath(e[i].Imagefilepath.toString()),t.FeedBackDataObj.Columns.forEach((function(t){t.DisplayMember.Contains("CCNID")?n[t.ValueMember]=e[i][t.DisplayMember]:t.DisplayMember.Contains("Alpha")&&(n[t.DisplayMember]=s.GetValidXmlReserve(e[i][t.DisplayMember].toString()))})),t.FeedBackDataObj.addRow(n),t.FeedBackDataObj.RefreshGrid=!t.FeedBackDataObj.RefreshGrid},n=0;n<e.length;n++)i(n)}catch(o){Logger.ErrorLog("ViewFeedbackViewModel:: LoadData",o)}}},{key:"angularGrid",get:function(){return this.FeedBackDataObj.angularGrid}},{key:"SelectedRow",get:function(){return this.FeedBackDataObj.SelectedItem},set:function(e){this.FeedBackDataObj.SelectedItem=e}},{key:"FeedBackData",get:function(){return this.FeedBackDataObj.Table}}],[{key:"GetValidXmlReserve",value:function(e){return null==e||null==e?"":e=(e=(e=(e=e.Replace("&amp;","&")).Replace("''","'")).Replace("&quot;",'"')).Replace("&lt;","<")}}]),s}(n.b)},yJmf:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var i=s("vfbs"),a=s("fXoL"),n=s("sYmb");function o(e,t){if(1&e){var s=a.ac();a.Zb(0,"div",1),a.Wc(1,"\n    \n    "),a.Zb(2,"div",2),a.Wc(3,"\n        "),a.Zb(4,"div",3),a.Wc(5,"\n            "),a.Vb(6,4),a.Wc(7,"\n        "),a.Yb(),a.Wc(8,"\n        "),a.Zb(9,"div",3),a.Wc(10,"\n            "),a.Vb(11,4),a.Wc(12,"\n        "),a.Yb(),a.Wc(13,"\n        "),a.Zb(14,"div",3),a.Wc(15,"\n            "),a.Vb(16,4),a.Wc(17,"\n        "),a.Yb(),a.Wc(18,"\n        \n        \n  "),a.Yb(),a.Wc(19,"\n  "),a.Zb(20,"div",5),a.Wc(21,"\n    "),a.Zb(22,"div"),a.Wc(23,"\n        "),a.Zb(24,"button",6),a.hc("click",(function(){return a.Ic(s),a.lc().obj.OnSave("SaveWave")})),a.Wc(25,"Ok"),a.Yb(),a.Wc(26,"\n        "),a.Zb(27,"button",7),a.hc("click",(function(){return a.Ic(s),a.lc().obj.OnSave("CancelWave")})),a.Ub(28,"i",8),a.Wc(29),a.mc(30,"translate"),a.Yb(),a.Wc(31,"\n    "),a.Yb(),a.Wc(32,"      \n  "),a.Yb(),a.Wc(33,"\n"),a.Yb()}if(2&e){var i=a.lc();a.Db(6),a.tc("obj",i.obj.User)("group",i.group),a.Db(5),a.tc("obj",i.obj.WaiveOffDate)("group",i.group),a.Db(5),a.tc("obj",i.obj.Comments)("group",i.group),a.Db(13),a.Xc(a.nc(30,7,"Cancel"))}}var r=function(){var e=function(e){_inherits(s,e);var t=_createSuper(s);function s(e){var i;return _classCallCheck(this,s),(i=t.call(this)).translate=e,i}return _createClass(s,[{key:"ngOnInit",value:function(){}}]),s}(i.a);return e.\u0275fac=function(t){return new(t||e)(a.Tb(n.e))},e.\u0275cmp=a.Nb({type:e,selectors:[["app-quick-waive"]],features:[a.Ab],decls:1,vars:1,consts:[["class","master-screen","style","width: 300px;",4,"ngIf"],[1,"master-screen",2,"width","300px"],[1,"PACTHeaderFields","dialogSubBody"],[1,"form-group","row","PACTControl"],["FieldDirective","",3,"obj","group"],[1,"Pactdailogfooter"],[1,"primary-btn-wicon",3,"click"],[1,"secondary-btn-wicon",3,"click"],[1,"fa-light","fa-rectangle-xmark"]],template:function(e,t){1&e&&a.Uc(0,o,34,9,"div",0),2&e&&a.tc("ngIf",t.obj.WaiveVisibility)},encapsulation:2}),e}()},z5gp:function(e,t,s){"use strict";s.d(t,"a",(function(){return c}));var i=s("vfbs"),a=s("fXoL"),n=s("sYmb");function o(e,t){if(1&e&&(a.Zb(0,"div",9),a.Wc(1,"\n          "),a.Vb(2,10),a.Wc(3,"\n        "),a.Yb()),2&e){var s=a.lc();a.Db(2),a.tc("obj",s.obj.FeedbackDate)("group",s.obj.ScreenObject.form)}}function r(e,t){if(1&e&&(a.Zb(0,"div",9),a.Wc(1,"\n            "),a.Vb(2,10),a.Wc(3,"\n        "),a.Yb()),2&e){var s=a.lc();a.Db(2),a.tc("obj",s.obj.Feedback)("group",s.obj.ScreenObject.form)}}function l(e,t){if(1&e&&(a.Zb(0,"div",9),a.Wc(1,"\n                "),a.Vb(2,10),a.Wc(3,"\n            "),a.Yb()),2&e){var s=a.lc().$implicit,i=a.lc();a.Db(2),a.tc("obj",s)("group",i.obj.ScreenObject.form)}}function u(e,t){if(1&e&&(a.Xb(0),a.Wc(1,"\n            "),a.Uc(2,l,4,2,"div",2),a.Wc(3,"\n        "),a.Wb()),2&e){var s=t.$implicit;a.Db(2),a.tc("ngIf",s.Visible)}}var c=function(){var e=function(e){_inherits(s,e);var t=_createSuper(s);function s(e){var i;return _classCallCheck(this,s),(i=t.call(this)).translate=e,i}return _createClass(s,[{key:"ngOnInit",value:function(){}}]),s}(i.a);return e.\u0275fac=function(t){return new(t||e)(a.Tb(n.e))},e.\u0275cmp=a.Nb({type:e,selectors:[["app-feed-back"]],features:[a.Ab],decls:28,vars:10,consts:[[1,"master-screen",3,"formGroup"],[1,"PACTHeaderFields","dialogSubBody"],["class","form-group col PACTControl",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"Pactdailogfooter"],[1,"primary-btn-wicon",3,"click"],[1,"fa-light","fa-floppy-disk"],[1,"secondary-btn-wicon",3,"click"],[1,"fa-light","fa-rectangle-xmark"],[1,"form-group","col","PACTControl"],["FieldDirective","",3,"obj","group"]],template:function(e,t){1&e&&(a.Zb(0,"div",0),a.Wc(1,"\n    "),a.Zb(2,"div",1),a.Wc(3,"\n        "),a.Uc(4,o,4,2,"div",2),a.Wc(5,"\n        "),a.Uc(6,r,4,2,"div",2),a.Wc(7,"\n        "),a.Uc(8,u,4,1,"ng-container",3),a.Wc(9,"\n        \n    "),a.Yb(),a.Wc(10,"\n    "),a.Zb(11,"div",4),a.Wc(12,"\n      "),a.Zb(13,"div"),a.Wc(14,"\n            "),a.Zb(15,"button",5),a.hc("click",(function(){return t.obj.OnSave("Save")})),a.Ub(16,"i",6),a.Wc(17),a.mc(18,"translate"),a.Yb(),a.Wc(19,"\n             "),a.Zb(20,"button",7),a.hc("click",(function(){return t.obj.OnSave("Cancel")})),a.Ub(21,"i",8),a.Wc(22),a.mc(23,"translate"),a.Yb(),a.Wc(24,"\n        "),a.Yb(),a.Wc(25,"      \n      "),a.Yb(),a.Wc(26,"\n  "),a.Yb(),a.Wc(27,"\n  \n  \n  ")),2&e&&(a.tc("formGroup",t.obj.ScreenObject.form),a.Db(4),a.tc("ngIf",t.obj.FeedbackDate.Visible),a.Db(2),a.tc("ngIf",t.obj.Feedback.Visible),a.Db(2),a.tc("ngForOf",t.obj.Fields),a.Db(9),a.Xc(a.nc(18,6,"Save")),a.Db(5),a.Xc(a.nc(23,8,"cancel")))},encapsulation:2}),e}()}}]);