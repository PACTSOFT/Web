(window.webpackJsonp=window.webpackJsonp||[]).push([[79],{g9Ew:function(e,t,s){"use strict";s.r(t),s.d(t,"ACC_Asset",(function(){return D}));var o=s("Do2H"),l=s("Lp6j"),i=s("vTM8"),a=s("eQJW"),h=s("1xwR"),r=s("mvPR"),n=s("MCLT");class D extends h.b{constructor(e){super(e),this.i=0,this.k=0,this.jAccount=0,this.dsTrail=null,this.Balance=0,this.OpBalance=0,this.colBalanceIndex=-1,this.colDebitIndex=-1,this.colCreditIndex=-1,this.colSpanBF=-1,this.colSubTotalStartIndex=0,this.GroupTotalIndex=0,this.CntMonths=0,this.dtStart=Date.Today(),this.IncludeBFInTotals=!1,this.AccountsWithOutTransactions=!1,this.AccountsWithZeroBalance=!1,this.PDCSeperate=!1,this.PDCDrCrSeperate=!1,this.STAccountWise=!1,this.STMonthWise=!1,this.STDayWise=!1,this.ShowGeneralLedgerDetailReport=!1,this.TBIsAccountWise=!1,this.TBOpeningDrCrSeperately=!1,this.TBTransactionsDrCrSeperately=!1,this.OpenCompany=!1,this.ShowTagWise=!1,this.TBShowdetailsofControlGroups=!1,this.UnPostedDocsSeparately=!1,this.AllowAddRows=!1,this.GroupTotalsAtEnd=!1,this.GroupTotalsSeperate=!1,this.DontShowSummaryGroupTotals=!1,this.TagID=0,this.TagTableName=null,this.CountMonths=0,this.IsNewAccount=!0,this.Col1=0,this.Col2=0,this.dec="",this.LocationWhere="",this.filter="",this.LevelNo=0,this.dvDepr=null,this.dvDeprTable=null,this.lstTotal=null,this.lstParents=new Array}LoadReport(){if(this.GrdRow=-1,this.GroupTotalIndex=-1,this.colSubTotalStartIndex=-1,this.lstTotal=new Array,this.DataSetCollection.Clear(),this.ViewModel.lstGroupIndex.Clear(),this.ViewModel.lstGroup.length>0)for(this.k=0;this.k<this.oColumns.length;this.k++)if(this.ViewModel.lstGroup[0].TotalCols.ContainsKey(this.oColumns[this.k].ID)){this.colSubTotalStartIndex=this.k;break}let e="",t="";if(this.ViewModel.oReportDialog.Locations.Visible&&null!=this.ViewModel.oReportDialog.LocationWhere&&(t=" AND A.LocationID IN ("+this.ViewModel.oReportDialog.LocationWhere+")"),116==this.ViewModel.StaticReportType||117==this.ViewModel.StaticReportType){let s=this.ViewModel.oReportDialog.GetSeqNosList();this.dec="N2",e=" select A.IsGroup,A.AssetID,Convert(datetime,A.DeprStartDate) as DeprStartDate,A.AssetName,A.PurchaseValue as OriginalPurchase,A.DeprStartValue as PurchaseCurrent,A.EstimateLife as LifeYrs\n,isnull((select sum(DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) <'"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"'),0) as ToDateDepreciation,\n(A.PurchaseValue+A.DeprStartValue)-isnull((select sum(DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) <'"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"'),0) as OpeningValue,\nisnull((select sum(DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) <'"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"'),0) + isnull((select sum(DepAmount) from ACC_AssetDepSchedule ADS where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) >='"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"' and Convert(datetime,ADS.DeprEndDate) <='"+this.ViewModel.ToDatePicker.Date.ToString("dd MMM yyyy")+"'),0) as ReportDepreciation,\n(A.PurchaseValue+A.DeprStartValue)-(isnull((select sum(DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) <'"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"'),0) + isnull((select sum(DepAmount) from ACC_AssetDepSchedule ADS where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) >='"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"' and Convert(datetime,ADS.DeprEndDate) <='"+this.ViewModel.ToDatePicker.Date.ToString("dd MMM yyyy")+"'),0)) as NetValue,\n(select Count(*) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) <'"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"') as Number \n, A.lft,A.Depth,A.ParentID from ACC_Assets A with(nolock) where A.AssetID IN ("+s+") and A.AssetID > 1 "+t+" Order By A.lft\n\n                        select AssetID,Convert(datetime,DeprStartDate) DeprStartDate,DepAmount from ACC_AssetDepSchedule with(nolock)\n                        WHERE AssetID IN ("+s+") and Convert(datetime,DeprStartDate)>='"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"' and Convert(datetime,DeprEndDate )<='"+this.ViewModel.ToDatePicker.Date.ToString("dd MMM yyyy")+"'"}else if(118==this.ViewModel.StaticReportType){let s=this.ViewModel.oReportDialog.GetSeqNosList();e="select G.AssetName AssetGroup,G.AssetName+ ' Upto '+'"+this.ViewModel.FromDatePicker.Date.ToString("MMM yyyy")+"'+' (Last Year)' DATEGROUP,A.IsGroup,A.AssetID,A.AssetName,Convert(datetime,A.DeprStartDate) as DateofCapitalisation,A.PurchaseValue as Cost,\n                        Convert(nvarchar(50),(isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) <'"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"'),0)/A.PurchaseValue)*100)+'%' as Rate,\n                        isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) <'"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"'),0) as AccDepreciation,\n                        A.PurchaseValue-isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) <'"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"'),0) as WDVToDate,\n                        isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprEndDate) <'"+this.ViewModel.ToDatePicker.Date.ToString("dd MMM yyyy")+"'),0) as ChargedUpto,\n                        (A.PurchaseValue-isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) <'"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"'),0))-\n                        (isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprEndDate) <'"+this.ViewModel.ToDatePicker.Date.ToString("dd MMM yyyy")+"'),0)) as WDVTillDate \n                        , A.lft,A.Depth,A.ParentID,0 as History "+this.ViewModel.SelectTag+"\n                        from  Acc_Assets A with(nolock) LEFT JOIN Acc_Assets G with(nolock) ON G.AssetID=A.ParentID"+this.ViewModel.FromTag+"\n                        where  A.IsGroup=0 AND A.AssetID in ("+s+") and A.AssetID > 1 "+t,e+=" UNION ALL\n                        select G.AssetName AssetGroup,G.AssetName+ ' - CURRENT YEAR' DATEGROUP,A.IsGroup,A.AssetID,A.AssetName,Convert(datetime,A.DeprStartDate) as DateofCapitalisation,A.PurchaseValue as Cost,\n                        Convert(nvarchar(50),(isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) <'"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"'),0)/A.PurchaseValue)*100)+'%' as Rate,\n                        isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) >='"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"' and Convert(datetime,ADS.DeprEndDate) <='"+this.ViewModel.ToDatePicker.Date.ToString("dd MMM yyyy")+"' ),0) as AccDepreciation,\n                        A.PurchaseValue-isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) >='"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"' and Convert(datetime,ADS.DeprEndDate) <='"+this.ViewModel.ToDatePicker.Date.ToString("dd MMM yyyy")+"'),0) as WDVToDate,\n                        isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) >='"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"' and Convert(datetime,ADS.DeprEndDate) <='"+this.ViewModel.ToDatePicker.Date.ToString("dd MMM yyyy")+"'),0) as ChargedUpto,\n                        (A.PurchaseValue-isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) >='"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"' and Convert(datetime,ADS.DeprEndDate) <='"+this.ViewModel.ToDatePicker.Date.ToString("dd MMM yyyy")+"'),0))-\n                        (isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) >='"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"' and Convert(datetime,ADS.DeprEndDate) <='"+this.ViewModel.ToDatePicker.Date.ToString("dd MMM yyyy")+"'),0)) as WDVTillDate \n                        , A.lft,A.Depth,A.ParentID,1 as History "+this.ViewModel.SelectTag+"\n                        from  Acc_Assets A with(nolock) LEFT JOIN Acc_Assets G with(nolock) ON G.AssetID=A.ParentID "+this.ViewModel.FromTag+"\n                        where A.IsGroup=0 AND A.AssetID in ("+s+") and A.AssetID > 1 "+t+" Order By AssetGroup,DATEGROUP desc"}if(120==this.ViewModel.StaticReportType){let s=0,a="",h="",r="",n="";new i.a,this.ViewModel.ReportGroups.forEach(e=>{e.CDGDO.ColumnCostCenterID>5e4?(e.CDGDO.ParentTableAlias="C"+e.CDGDO.ColumnCostCenterID,h+=e.CDGDO.ParentTableAlias+"."+e.CDGDO.Column+" AS "+e.ID+",",r+=" INNER JOIN "+e.CDGDO.ParentCostCenterSysName+" AS "+e.CDGDO.ParentTableAlias,r+=" with(nolock) ON "+e.CDGDO.ParentTableAlias+".NodeID=CC."+e.CDGDO.ParentColumn,a+=e.ID+","):72==e.CDGDO.ColumnCostCenterID&&"ParentID"==e.CDGDO.ParentColumn&&(h+="AG."+e.CDGDO.Column+" AS "+e.ID+",",a+=e.ID+","),"1"!=e.ShowAsColumn.SelectedValue&&s++}),r.length>0&&(r=" INNER JOIN COM_CCCCData CC with(nolock) ON CC.CostCenterID=72 AND CC.NodeID=A.AssetID"+r),a.length>0&&(a=" ORDER BY "+a.TrimEnd(",")),this.ViewModel.Preferences.ContainsKey("Status")&&"Active"==this.ViewModel.Preferences.Status&&(n=" and A.StatusID=1  "),this.ViewModel.Preferences.ContainsKey("Status")&&"Dispose"==this.ViewModel.Preferences.Status&&(n=" and A.StatusID=0");let D=this.ViewModel.oReportDialog.GetSeqNosList(),A=new Date((new Date).getFullYear(),o.a.SessionManager.AccountingFromMonth-1,1);A>Date.Today()&&(A=A.AddYears(-1)),e=" select A.AssetID,"+h+"\nA.AssetCode,A.AssetName,AG.AssetCode GroupCode,AG.AssetName GroupName,AG.PurchaseInvoiceNo,Convert(datetime,A.PurchaseDate) PurchaseDate,A.PurchaseValue,\nisnull((select sum(AC.AssetNewValue-AC.AssetOldValue) from ACC_AssetChanges AC with(nolock) where AC.AssetID=A.AssetID and  AC.ChangeType in (0,2)),0) as Addition,\nisnull((select case when sum(AC.AssetNewValue-AC.AssetOldValue)<0 then sum(AC.AssetNewValue-AC.AssetOldValue)*(-1) else sum(AC.AssetNewValue-AC.AssetOldValue) end  from ACC_AssetChanges AC with(nolock) where AC.AssetID=A.AssetID and  AC.ChangeType in (1,3)),0) as Deletion,\n((A.PurchaseValue+isnull((select sum(AC.AssetNewValue-AC.AssetOldValue) from ACC_AssetChanges AC with(nolock) where AC.AssetID=A.AssetID and  AC.ChangeType in (0,2)),0))-isnull((select case when sum(AC.AssetNewValue-AC.AssetOldValue)<0 then sum(AC.AssetNewValue-AC.AssetOldValue)*(-1) else sum(AC.AssetNewValue-AC.AssetOldValue) end from ACC_AssetChanges AC with(nolock) where AC.AssetID=A.AssetID and  AC.ChangeType in (1,3)),0)) as NetCost,\nA.EstimateLife,\nA.PreviousDepreciation+isnull((select sum(D.DepAmount) from ACC_AssetDepSchedule D with(nolock) where D.AssetID=A.AssetID and Convert(datetime,D.DeprStartDate)<'"+A+"' and D.DocID IS NOT NULL),0) as PreviousDepreciation,\nisnull((select sum(D.DepAmount) from ACC_AssetDepSchedule D with(nolock) where D.AssetID=A.AssetID and Convert(datetime,D.DeprStartDate)>='"+A+"' and D.DocID IS NOT NULL),0) as CurrentYearDepreciation,\n(A.PreviousDepreciation+isnull((select sum(D.DepAmount) from ACC_AssetDepSchedule D with(nolock) where D.AssetID=A.AssetID and Convert(datetime,D.DeprStartDate)<'"+A+"' and D.DocID IS NOT NULL),0))+(isnull((select sum(D.DepAmount) from ACC_AssetDepSchedule D with(nolock) where D.AssetID=A.AssetID and Convert(datetime,D.DeprStartDate)>='"+A+"' and D.DocID IS NOT NULL),0)) as TotalDepreciation,\n(((A.PurchaseValue+isnull((select sum(AC.AssetNewValue-AC.AssetOldValue) from ACC_AssetChanges AC with(nolock) where AC.AssetID=A.AssetID and  AC.ChangeType in (0,2)),0))-isnull((select case when sum(AC.AssetNewValue-AC.AssetOldValue)<0 then sum(AC.AssetNewValue-AC.AssetOldValue)*(-1) else sum(AC.AssetNewValue-AC.AssetOldValue) end from ACC_AssetChanges AC with(nolock) where AC.AssetID=A.AssetID and  AC.ChangeType in (1,3)),0))\n-((A.PreviousDepreciation+isnull((select sum(D.DepAmount) from ACC_AssetDepSchedule D with(nolock) where D.AssetID=A.AssetID and Convert(datetime,D.DeprStartDate)<'"+A+"' and D.DocID IS NOT NULL),0))+(isnull((select sum(D.DepAmount) from ACC_AssetDepSchedule D with(nolock) where D.AssetID=A.AssetID and Convert(datetime,D.DeprStartDate)>='"+A+"' and D.DocID IS NOT NULL),0)))) as NetBalance\nFROM ACC_Assets A with(nolock) INNER JOIN ACC_Assets AG with(nolock) ON AG.AssetID=A.ParentID\n"+r+" WHERE A.AssetID IN ("+D+") and A.IsGroup=0 "+n+a+t,o.a.report.ReportDataSetAsync("RPT022",this.ViewModel.IsReportDB,e).then(e=>{this.ds=e,this.dv=this.dvTable=this.ds.Tables[0],this.dvColumns=this.ds.Columns[0],this.ViewModel.ReportData=this.ds.Tables[0],this.ViewModel.ConstructFormulaFields(!0),this.ViewModel.totals=l.e.NumArray(this.ViewModel.ReportColumns.length,this.ViewModel.lstGroup.length+1),this.ViewModel.hiddenTotals=l.e.NumArray(this.ViewModel.HiddenNumericColumns.length,this.ViewModel.lstGroup.length+1),this.ViewModel.RenderData(this.dv),this.ViewModel.CheckAndAddTotals(this.dv),this.LoadReport_Complete()})}if(116==this.ViewModel.StaticReportType||117==this.ViewModel.StaticReportType)this.CntMonths=0,o.a.report.ReportDataSetAsync("RPT022",this.ViewModel.IsReportDB,e).then(e=>{this.ds=e,120!=this.ViewModel.StaticReportType&&(this.dvDepr=this.dvDeprTable=this.ds.Tables[1]);let t=new Array;for(let s=0;s<this.ViewModel.ColumnSource.length;s++)if(t.push(this.ViewModel.ColumnSource[s]),116==this.ViewModel.StaticReportType&&"MONTHS"==this.ViewModel.ColumnSource[s].ID){for(this.dtStart=this.ViewModel.FromDatePicker.Date;this.dtStart<=this.ViewModel.ToDatePicker.Date;){let e=t[7].Clone();e.HeaderText=this.dtStart.ToString("MMM yyyy"),e.ID=this.dtStart.ToString("MMMyyyy"),t.push(e),this.ds.Tables[0].Columns.push(e.ID),this.CntMonths++,this.dtStart=this.dtStart.AddMonths(1)}t.Remove(this.ViewModel.ColumnSource[s])}this.ViewModel.ReportColumns=t,this.oColumns=this.ViewModel.ReportColumns,this.dv=this.ds.Tables[0],this.addTrialBalance(),this.AddReportTotals(),this.LoadReport_Complete()});else if(118==this.ViewModel.StaticReportType){let t=-1,s=-1,a=-1,h=-1,n=-1;this.AggTotal=l.e.NumArray(this.oColumns.length+1,2),o.a.report.ReportDataSetAsync("RPT022",this.ViewModel.IsReportDB,e).then(e=>{this.ds=e,this.ViewModel.RenderData(this.ds.Tables[0]),this.ViewModel.CheckAndAddTotals(this.ds.Tables[0]),this.oRow=this.NewReportRow_2(r.f.Header,this.HeaderAppearance),this.oRow.Cells[0].Text="SUMMARY",this.oRow.Cells[0].CellAppearance.IsUnderline=!0,this.oRow.Cells[0].ColSpan=this.oRow.Cells.length,this.ViewModel.addRow(this.oRow);for(let l=0;l<this.oColumns.length;l++)"Cost"==this.oColumns[l].ID.toString()&&(t=l),"AccDepreciation"==this.oColumns[l].ID.toString()&&(s=l),"WDVToDate"==this.oColumns[l].ID.toString()&&(a=l),"ChargedUpto"==this.oColumns[l].ID.toString()&&(h=l),"WDVTillDate"==this.oColumns[l].ID.toString()&&(n=l);let o,D,A,d=this.ds.Tables[0].ToTable(!0,["ParentID","AssetGroup"]),C=new i.a,u=l.e.NumArray(this.oColumns.length,2);for(let i=0;i<3;i++){0==i?(o="1",D=" (CURRENT YEAR)"):1==i?(o="0",D=" (LAST YEAR)"):(o="0",D=" (CURRENT + LAST YEAR)");for(let e=0;e<d.length;e++){if(this.oRow=this.NewReportRow(),this.oRow.Cells[0].ColSpan=3,A=d[e].AssetGroup.toString(),2!=i){C.ContainsKey(A)||C.push(A,l.e.NumArray(this.oColumns.length,2)),this.oRow.Cells[0].Text="TOTAL - "+d[e].AssetGroup.toString()+D;let r=this.ds.Tables[0].filter(t=>t.History==o&&t.ParentID==d[e][d.Columns[0][0]]),p=r.Compute("sum","Cost");-1!=t&&(this.ViewModel.SetCellValue(p,this.oColumns[t].DataFormat,"FLOAT",this.oRow.Cells[t]),null!=p&&(C[A][t][i]+=parseFloat(p),u[t][i]+=parseFloat(p))),p=r.Compute("sum","AccDepreciation"),-1!=s&&(this.ViewModel.SetCellValue(p,this.oColumns[s].DataFormat,"FLOAT",this.oRow.Cells[s]),null!=p&&(C[A][s][i]+=parseFloat(p),u[s][i]+=parseFloat(p))),p=r.Compute("sum","WDVToDate"),-1!=a&&(this.ViewModel.SetCellValue(p,this.oColumns[a].DataFormat,"FLOAT",this.oRow.Cells[a]),null!=p&&(C[A][a][i]+=parseFloat(p),u[a][i]+=parseFloat(p))),p=r.Compute("sum","ChargedUpto"),-1!=h&&(this.ViewModel.SetCellValue(p,this.oColumns[h].DataFormat,"FLOAT",this.oRow.Cells[h]),null!=p&&(C[A][h][i]+=parseFloat(p),u[h][i]+=parseFloat(p))),p=r.Compute("sum","WDVTillDate"),-1!=n&&(this.ViewModel.SetCellValue(p,this.oColumns[n].DataFormat,"FLOAT",this.oRow.Cells[n]),null!=p&&(C[A][n][i]+=parseFloat(p),u[n][i]+=parseFloat(p)))}else this.oRow.Cells[0].Text="GRAND TOTAL - "+A+D,C.ContainsKey(A)&&(-1!=t&&this.ViewModel.SetCellValue(C[A][t][0]+C[A][t][1],this.oColumns[t].DataFormat,"FLOAT",this.oRow.Cells[t]),-1!=s&&this.ViewModel.SetCellValue(C[A][s][0]+C[A][s][1],this.oColumns[s].DataFormat,"FLOAT",this.oRow.Cells[s]),-1!=a&&this.ViewModel.SetCellValue(C[A][a][0]+C[A][a][1],this.oColumns[a].DataFormat,"FLOAT",this.oRow.Cells[a]),-1!=h&&this.ViewModel.SetCellValue(C[A][h][0]+C[A][h][1],this.oColumns[h].DataFormat,"FLOAT",this.oRow.Cells[h]),-1!=n&&this.ViewModel.SetCellValue(C[A][n][0]+C[A][n][1],this.oColumns[n].DataFormat,"FLOAT",this.oRow.Cells[n]));this.ViewModel.addRow(this.oRow)}this.oRow=this.NewReportRow_2(r.f.SubTotal,this.GrossTotalAppearance),this.oRow.Cells[0].ColSpan=3,this.oRow.Cells[0].Text="GRAND TOTAL - "+D,2!=i?(-1!=t&&(this.ViewModel.SetCellValue(u[t][i],this.oColumns[t].DataFormat,"FLOAT",this.oRow.Cells[t]),this.oRow.Cells[t].CellAppearance.Alignment="Right"),-1!=s&&(this.ViewModel.SetCellValue(u[s][i],this.oColumns[s].DataFormat,"FLOAT",this.oRow.Cells[s]),this.oRow.Cells[s].CellAppearance.Alignment="Right"),-1!=a&&(this.ViewModel.SetCellValue(u[a][i],this.oColumns[a].DataFormat,"FLOAT",this.oRow.Cells[a]),this.oRow.Cells[a].CellAppearance.Alignment="Right"),-1!=h&&(this.ViewModel.SetCellValue(u[h][i],this.oColumns[h].DataFormat,"FLOAT",this.oRow.Cells[h]),this.oRow.Cells[h].CellAppearance.Alignment="Right"),-1!=n&&(this.ViewModel.SetCellValue(u[n][i],this.oColumns[n].DataFormat,"FLOAT",this.oRow.Cells[n]),this.oRow.Cells[n].CellAppearance.Alignment="Right")):(-1!=t&&(this.ViewModel.SetCellValue(u[t][0]+u[t][1],this.oColumns[t].DataFormat,"FLOAT",this.oRow.Cells[t]),this.oRow.Cells[t].CellAppearance.Alignment="Right"),-1!=s&&(this.ViewModel.SetCellValue(u[s][0]+u[s][1],this.oColumns[s].DataFormat,"FLOAT",this.oRow.Cells[s]),this.oRow.Cells[s].CellAppearance.Alignment="Right"),-1!=a&&(this.ViewModel.SetCellValue(u[a][0]+u[a][1],this.oColumns[a].DataFormat,"FLOAT",this.oRow.Cells[a]),this.oRow.Cells[a].CellAppearance.Alignment="Right"),-1!=h&&(this.ViewModel.SetCellValue(u[h][0]+u[h][1],this.oColumns[h].DataFormat,"FLOAT",this.oRow.Cells[h]),this.oRow.Cells[h].CellAppearance.Alignment="Right"),-1!=n&&(this.ViewModel.SetCellValue(u[n][0]+u[n][1],this.oColumns[n].DataFormat,"FLOAT",this.oRow.Cells[n]),this.oRow.Cells[n].CellAppearance.Alignment="Right")),this.ViewModel.addRow(this.oRow)}this.LoadReport_Complete()})}}LoadReport_Complete(){this.ViewModel.FormulasCalculated=!0,this.ViewModel.process_RunWorkerCompleted()}AddReportTotals(){if(116==this.ViewModel.StaticReportType||117==this.ViewModel.StaticReportType||120==this.ViewModel.StaticReportType){this.UpdateTreeTotals(0),this.row=this.NewReportRow_2(r.f.ReportTotal,this.ViewModel.GrpReportTotal.SubTotalAppearance),this.ViewModel.GrpReportTotal.Height>0&&(this.row.Height=this.ViewModel.GrpReportTotal.Height),this.row.LevelNo=0;let e=-1;for(this.k=0;this.k<this.ViewModel.ColumnSource.length;this.k++)0!=this.ViewModel.GrpReportTotal.TotalCols.length&&this.ViewModel.GrpReportTotal.TotalCols.ContainsKey(this.oColumns[this.k].ID)&&(-1==e&&(e=this.k),this.row.Cells[this.k].CellAppearance.Alignment="Right",this.ViewModel.SetCellValue(this.lstTotal[0][this.k].toString(),this.oColumns[this.k].DataFormat,this.oColumns[this.k].ColumnType,this.row.Cells[this.k]));for(this.k=this.ViewModel.ColumnSource.length;this.k<this.oColumns.length;this.k++)-1==e&&(e=this.k),this.row.Cells[this.k].CellAppearance.Alignment="Right",this.ViewModel.SetCellValue(this.lstTotal[0][this.k].toString(),this.oColumns[this.k].DataFormat,this.oColumns[this.k].ColumnType,this.row.Cells[this.k]);this.row.Cells[0].Text=o.a.GetResource("Reports_ReportTotal"),e>0&&(this.GrdRow++,this.row.Cells[0].ColSpan=e,this.ViewModel.addRow(this.row))}else{this.GrdRow++,this.row=this.NewReportRow_2(r.f.ReportTotal,this.ViewModel.GrpReportTotal.SubTotalAppearance),this.ViewModel.GrpReportTotal.Height>0&&(this.row.Height=this.ViewModel.GrpReportTotal.Height),this.row.LevelNo=1;let e=-1;for(this.k=0;this.k<this.oColumns.length;this.k++)this.ViewModel.GrpReportTotal.TotalCols.ContainsKey(this.oColumns[this.k].ID)&&(-1==e&&(e=this.k),this.row.Cells[this.k].CellAppearance.Alignment="Right",this.ViewModel.SetCellValue(this.AggTotal[0].toString(),this.oColumns[this.k].DataFormat,"FLOAT",this.row.Cells[this.k]));this.row.Cells[0].Text=o.a.GetResource("Reports_ReportTotal"),e>0&&(this.row.Cells[0].ColSpan=e,this.ViewModel.addRow(this.row))}}LoadReportWithPostFilters(e){}addTrialBalance(){for(this.lstParents.Clear(),this.lstTotal.Clear(),this.lstParents.push(this.NewReportRow()),this.lstTotal.push(new Array(this.oColumns.length).fill(0)),this.k=0;this.k<this.dv.length;this.k++){this.oRow=this.NewReportRow(),this.oRow.LevelNo=parseInt(this.dv[this.k].Depth)-1,this.oRow.Cells[1].IsNormal=!1,this.oRow.IsGroup=Object(a.j)(this.dv[this.k].IsGroup),this.oRow.DataRow=this.dv[this.k];let e=parseInt(this.dv[this.k].AssetID);if(this.oRow.Cells[1].level=this.oRow.LevelNo,this.UpdateTreeTotals(this.oRow.LevelNo),Object(a.j)(this.dv[this.k].IsGroup)){this.lstParents.push(this.oRow),new Array(this.oColumns.length).fill(0),this.oRow.Type=r.f.BalanceBF;for(let e=0;e<this.oRow.Cells.length;e++)this.oRow.Cells[e].IsNormal=!1,this.oRow.Cells[e].CellAppearance=this.BalanceBFAppearance_Data.Clone(),this.oRow.Cells[e].CellAppearance.Alignment=this.oColumns[e].DataAppearance.Alignment}else 120!=this.ViewModel.StaticReportType&&(this.dvDepr=this.dvDeprTable.filter(t=>t.AssetID==e),this.dvDepr.forEach(e=>{let t=new Date(e.DeprStartDate).ToString("MMMyyyy");this.dvColumns.Contains(t)&&(this.dv[this.k][t]=e.DepAmount)}));for(let t=0;t<this.oColumns.length;t++)this.CellValue=null,Object(n.isUndefined)(this.dv[this.k][this.oColumns[t].ID])||(this.CellValue=this.dv[this.k][this.oColumns[t].ID]),null!=this.CellValue&&(this.ViewModel.SetCellValue(this.CellValue,this.oColumns[t].DataFormat,this.oColumns[t].ColumnType,this.oRow.Cells[t]),l.e.IsNum(this.CellValue)&&(this.dbl=l.e.Double(this.CellValue),this.lstTotal.length>0&&(this.lstTotal[this.lstTotal.length-1][t]+=this.dbl)));if(this.GrdRow++,this.ViewModel.addRow(this.oRow),120!=this.ViewModel.StaticReportType&&!this.oRow.IsGroup){let e=0,t=this.ViewModel.FromDatePicker.Date,s=this.ViewModel.FromDatePicker.Date,o=parseInt(this.dv[this.k].Number);for(let l=0;l<this.ViewModel.ReportColumns.length;l++)this.ViewModel.ReportColumns[l].ID==t.ToString("MMMyyyy")&&(e=l);if(t=t.AddMonths(1),this.oRow=this.NewReportRow(),this.oRow.LevelNo=parseInt(this.dv[this.k].Depth)-1,this.oRow.Cells[0].IsNormal=!1,this.oRow.Cells[0].Text=null!=this.dv[this.k].DeprStartDate?o.toString()+" & "+new Date(this.dv[this.k].DeprStartDate).ToString("dd/MMM/yyyy"):o.toString(),116==this.ViewModel.StaticReportType){for(let t=0;t<this.CntMonths;t++)this.dvColumns.Contains(s.ToString("MMMyyyy"))&&null!=this.dv[this.k][s.ToString("MMMyyyy")]&&(this.oRow.Cells[e].Text=(o+1).toString(),o++),t>0&&1==o&&(this.oRow.Cells[0].Text=-t+" & "+new Date(this.dv[this.k].DeprStartDate).ToString("dd/MMM/yyyy")),e++,s=s.AddMonths(1);this.CntMonths>0&&0==o&&(this.oRow.Cells[0].Text=-this.CntMonths+" & "+new Date(this.dv[this.k].DeprStartDate).ToString("dd/MMM/yyyy"))}this.ViewModel.addRow(this.oRow),s=this.ViewModel.FromDatePicker.Date,e=0;for(let l=0;l<this.ViewModel.ReportColumns.length;l++)this.ViewModel.ReportColumns[l].ID==t.ToString("MMMyyyy")&&(e=l);if(this.oRow=this.NewReportRow(),this.oRow.LevelNo=parseInt(this.dv[this.k].Depth)-1,this.oRow.Cells[0].IsNormal=!1,this.oRow.Cells[0].Text="Net Book Value",116==this.ViewModel.StaticReportType){let t=0;for(let o=0;o<this.CntMonths;o++)this.dvColumns.Contains(s.ToString("MMMyyyy"))&&(null!=this.dv[this.k][s.ToString("MMMyyyy")]&&(0==t?t=parseFloat(this.dv[this.k].OpeningValue.toString())-parseFloat(this.dv[this.k][s.ToString("MMMyyyy")].toString()):t-=parseFloat(this.dv[this.k][s.ToString("MMMyyyy")].toString()),this.oRow.Cells[e-1].Text=t.toString()),e++,s=s.AddMonths(1))}this.GrdRow++,this.ViewModel.addRow(this.oRow)}}}UpdateTreeTotals(e){for(let t=this.lstTotal.length-1;t>e;t--){if(t>0)for(let e=0;e<this.lstTotal[t].length;e++)this.lstTotal[t-1][e]+=this.lstTotal[t][e];if(!this.GroupTotalsAtEnd||this.DontShowSummaryGroupTotals&&!this.lstParents[t].IsExpanded)for(let e=0;e<this.oColumns.length;e++)"FLOAT"==this.oColumns[e].ColumnType&&this.ViewModel.SetCellValue(this.lstTotal[t][e],this.oColumns[e].DataFormat,"FLOAT",this.lstParents[t].Cells[e]);if(e<=this.LevelNo){let e=!1;if(0==this.AccountsWithOutTransactions&&0==this.lstTotal[t][2]&&0==this.lstTotal[t][3]&&0==this.lstTotal[t][4]&&0==this.lstTotal[t][5]&&(this.GrdRow--,e=!0,this.ViewModel.Data.Remove(this.lstParents[t])),this.AccountsWithZeroBalance||e||0==this.lstTotal[t][6]&&0==this.lstTotal[t][7]&&(this.GrdRow--,e=!0,this.ViewModel.Data.Remove(this.lstParents[t])),!e){let e=this.ViewModel.Data.indexOf(this.lstParents[t]);if(e>=0)if(!this.GroupTotalsAtEnd||this.DontShowSummaryGroupTotals&&!this.lstParents[t].IsExpanded)this.GroupTotalsSeperate&&-1!=this.colBalanceIndex&&(this.lstParents[t].Cells[this.GroupTotalIndex].Text=this.lstParents[t].Cells[this.colBalanceIndex].Text,this.lstParents[t].Cells[this.colBalanceIndex].Text=""),this.ViewModel.Data.Remove(this.lstParents[t]),this.ViewModel.Data.Insert(e,this.lstParents[t]);else{this.oSubTotal=this.NewReportRow(),this.oSubTotal.Type=r.f.BalanceBF,this.oSubTotal.Parent=this.lstParents[t].Parent,this.oSubTotal.LevelNo=this.lstParents[t].LevelNo,this.oSubTotal.Cells[1].IsNormal=!1,this.oSubTotal.IsGroup=!0,this.oSubTotal.Visible=this.lstParents[t].Visible,this.oSubTotal.Cells[1].level=this.lstParents[t].LevelNo,this.oSubTotal.Cells[1].Text=this.lstParents[t].Cells[1].Text+" - Total ",this.oSubTotal.Cells[1].CellAppearance=this.GrossTotalAppearance_Data.Clone(),this.oSubTotal.Cells[1].CellAppearance.Alignment=this.oColumns[1].DataAppearance.Alignment;for(let e=0;e<this.oColumns.length;e++)"FLOAT"==this.oColumns[e].ColumnType&&(this.oSubTotal.Cells[e].IsNormal=!1,this.oSubTotal.Cells[e].CellAppearance=this.GrossTotalAppearance_Data.Clone(),this.oSubTotal.Cells[e].CellAppearance.Alignment=this.oColumns[e].DataAppearance.Alignment,this.ViewModel.SetCellValue(this.lstTotal[t][e],this.oColumns[e].DataFormat,"FLOAT",this.oSubTotal.Cells[e]));this.GroupTotalsSeperate&&-1!=this.colBalanceIndex&&(this.oSubTotal.Cells[this.GroupTotalIndex].IsNormal=!1,this.oSubTotal.Cells[this.GroupTotalIndex].CellAppearance=this.GrossTotalAppearance_Data.Clone(),this.oSubTotal.Cells[this.GroupTotalIndex].CellAppearance.Alignment=this.oColumns[this.GroupTotalIndex].DataAppearance.Alignment,this.oSubTotal.Cells[this.GroupTotalIndex].Text=this.oSubTotal.Cells[this.colBalanceIndex].Text,this.oSubTotal.Cells[this.colBalanceIndex].Text=""),this.GrdRow++,this.ViewModel.addRow(this.oSubTotal)}}}this.lstParents.RemoveAt(t),this.lstTotal.RemoveAt(t)}}}}}]);