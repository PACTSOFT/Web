(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{H45g:function(e,t,i){"use strict";i.d(t,"a",(function(){return L}));var n=i("3Pt+"),s=i("fXoL"),o=i("ofXK"),a=i("q8k3"),r=i("qSjU"),l=i("towX"),c=i("sYmb");function D(e,t){if(1&e&&(s.Zb(0,"div",23),s.Wc(1,"\n                        "),s.Vb(2,8),s.Wc(3,"\n                        "),s.Wc(4,"\n                    "),s.Yb()),2&e){const e=s.lc(2);s.Db(2),s.tc("obj",e.obj.CostCenters)("group",e.form)}}function d(e,t){if(1&e&&(s.Zb(0,"div",23),s.Wc(1,"\n                                "),s.Vb(2,8),s.Wc(3,"\n                                "),s.Wc(4,"\n                            "),s.Yb()),2&e){const e=s.lc(4);s.Db(2),s.tc("obj",e.obj.CostCenters)("group",e.form)}}function u(e,t){if(1&e&&(s.Zb(0,"app-pact-tree",26),s.Wc(1,"\n                            "),s.Uc(2,d,5,2,"div",21),s.Wc(3,"\n                        "),s.Yb()),2&e){const e=t.$implicit,i=s.lc(3);s.tc("obj",e),s.Db(2),s.tc("ngIf",i.obj.CostCenters.Visible)}}function h(e,t){if(1&e&&(s.Zb(0,"div",24),s.Wc(1,"\n                        "),s.Uc(2,u,4,2,"app-pact-tree",25),s.Wc(3,"\n                    "),s.Yb()),2&e){const e=s.lc(2);s.Db(2),s.tc("ngForOf",e.obj.tree)}}function g(e,t){if(1&e&&(s.Zb(0,"div",20),s.Wc(1,"\n                "),s.Zb(2,"div"),s.Wc(3,"\n                    "),s.Uc(4,D,5,2,"div",21),s.Wc(5,"\n                    "),s.Uc(6,h,4,1,"div",22),s.Wc(7,"\n                "),s.Yb(),s.Wc(8,"\n            "),s.Yb()),2&e){const e=s.lc();s.Db(4),s.tc("ngIf",e.obj.CostCenters.Visible&&0==e.obj.tree.length),s.Db(2),s.tc("ngIf",e.obj.tree.length>0)}}function m(e,t){if(1&e&&(s.Zb(0,"div",12),s.Wc(1,"\n                "),s.Vb(2,10),s.Wc(3,"\n            "),s.Yb()),2&e){const e=s.lc();s.Db(2),s.tc("obj",e.obj.rdo)}}function b(e,t){if(1&e&&(s.Zb(0,"div",12),s.Wc(1,"\n                    "),s.Vb(2,10),s.Wc(3,"\n                "),s.Yb()),2&e){const e=s.lc();s.Db(2),s.tc("obj",e.obj.BankAccounts)}}function C(e,t){if(1&e&&(s.Zb(0,"div",12),s.Wc(1,"\n                    "),s.Vb(2,10),s.Wc(3,"\n                "),s.Yb()),2&e){const e=s.lc();s.Db(2),s.tc("obj",e.obj.Documents)}}function I(e,t){if(1&e&&(s.Zb(0,"div",5),s.Wc(1,"\n                "),s.Zb(2,"div",12),s.Wc(3,"\n                    "),s.Vb(4,10),s.Wc(5,"\n                "),s.Yb(),s.Wc(6,"\n                "),s.Zb(7,"div",12),s.Wc(8,"\n                    "),s.Vb(9,10),s.Wc(10,"\n                "),s.Yb(),s.Wc(11,"\n            "),s.Yb()),2&e){const e=s.lc();s.Db(4),s.tc("obj",e.obj.FilterON),s.Db(5),s.tc("obj",e.obj.SortON)}}function S(e,t){if(1&e&&(s.Zb(0,"div",12),s.Wc(1,"\n                    "),s.Zb(2,"fieldset"),s.Wc(3,"\n                        "),s.Zb(4,"legend"),s.Wc(5),s.mc(6,"translate"),s.Yb(),s.Wc(7,"\n                        "),s.Vb(8,10),s.Wc(9,"\n                    "),s.Yb(),s.Wc(10,"\n                "),s.Yb()),2&e){const e=s.lc();s.Db(5),s.Xc(s.nc(6,2,e.obj.Stat.Label)),s.Db(3),s.tc("obj",e.obj.Stat)}}function p(e,t){if(1&e&&(s.Zb(0,"div",12),s.Wc(1,"\n                    "),s.Vb(2,10),s.Wc(3,"\n                "),s.Yb()),2&e){const e=s.lc();s.Db(2),s.tc("obj",e.obj.Location)}}function y(e,t){if(1&e&&(s.Zb(0,"div",12),s.Wc(1,"\n                    "),s.Vb(2,10),s.Wc(3,"\n                "),s.Yb()),2&e){const e=s.lc();s.Db(2),s.tc("obj",e.obj.Division)}}function P(e,t){if(1&e&&s.Vb(0,30),2&e){const e=s.lc().$implicit;s.tc("obj",e)}}function f(e,t){if(1&e&&(s.Xb(0),s.Wc(1,"\n                    "),s.Uc(2,P,1,1,"ng-container",29),s.Wc(3,"\n                "),s.Wb()),2&e){const e=t.$implicit;s.Db(2),s.tc("ngIf",e.IsVisible)}}function T(e,t){if(1&e&&(s.Zb(0,"div",27),s.Wc(1,"\n                "),s.Uc(2,f,4,1,"ng-container",28),s.Wc(3,"\n            "),s.Yb()),2&e){const e=s.lc();s.Db(2),s.tc("ngForOf",e.obj.CostCenterFilters)}}function M(e,t){if(1&e){const e=s.ac();s.Zb(0,"button",16),s.hc("click",(function(){return s.Ic(e),s.lc().obj.OnButtonClick("SetAsDefault")})),s.Wc(1),s.mc(2,"translate"),s.Yb()}2&e&&(s.Db(1),s.Xc(s.nc(2,1,"Set As Default")))}let L=(()=>{class e{constructor(){}ngOnInit(){this.form=new n.j({})}ngAfterViewInit(){if(0==this.obj.TreeVisibility){let e=document.createDocumentFragment(),t=document.querySelector(".cPostedDoc");for(;t.firstChild;){let i=t.removeChild(t.firstChild);e.appendChild(i)}t.parentNode.replaceChild(e,t)}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Nb({type:e,selectors:[["app-posted-document-dialog"]],inputs:{obj:"obj"},decls:106,vars:32,consts:[[1,"master-screen",2,"padding-bottom","4px","height","100%"],[1,"cPostedDoc",2,"display","flex","height","100%"],["class","rpttree_div","style","width: 50%;display: flex;flex-direction: column;height: calc(100% - 50px);",4,"ngIf"],[1,"PACTHeaderFields","PDCDialog",2,"display","block","overflow","auto","max-height","calc(100% - 44px)","padding","15px","padding-right","12px","width","50%"],["class","form-group row form-row col-xl-6 col-md-6 col-sm-12 col-xs-12 PACTControl",4,"ngIf"],[1,"row"],["class","row",4,"ngIf"],["Style","width: 120px;",1,"form-group","row","form-row","PACTControl"],["FieldDirective","",3,"obj","group"],[1,"form-group","row","form-row","select-no-border"],["FieldDirective","",3,"obj"],[1,"form-group","row","form-row","col-xl-12","col-md-12","col-sm-12","col-xs-12","PACTControl"],[1,"form-group","row","form-row","col-xl-6","col-md-6","col-sm-12","col-xs-12","PACTControl"],["style","display: flex;flex-wrap: wrap;",4,"ngIf"],[1,"Pactdailogfooter",2,"margin-top","-50px"],[2,"margin","auto"],[1,"primary-btn-wicon",3,"click"],[1,"secondary-btn-wicon",3,"click"],[1,"fa-light","fa-rectangle-xmark"],["class","primary-btn-wicon",3,"click",4,"ngIf"],[1,"rpttree_div",2,"width","50%","display","flex","flex-direction","column","height","calc(100% - 50px)"],["class","CostCenters_select","style","margin: 5px;display: flex;align-items: center;",4,"ngIf"],["style","padding-right: 0px !important;height:  calc(100% - 50px);",4,"ngIf"],[1,"CostCenters_select",2,"margin","5px","display","flex","align-items","center"],[2,"padding-right","0px !important","height","calc(100% - 50px)"],[3,"obj",4,"ngFor","ngForOf"],[3,"obj"],[2,"display","flex","flex-wrap","wrap"],[4,"ngFor","ngForOf"],["ScreenDirective","",3,"obj",4,"ngIf"],["ScreenDirective","",3,"obj"]],template:function(e,t){1&e&&(s.Zb(0,"div",0),s.Wc(1,"\n    "),s.Zb(2,"div",1),s.Wc(3,"\n        "),s.Wc(4,"\n            "),s.Uc(5,g,9,2,"div",2),s.Wc(6,"\n        "),s.Wc(7,"\n\n        "),s.Zb(8,"div",3),s.Wc(9,"\n            "),s.Uc(10,m,4,1,"div",4),s.Wc(11,"\n            "),s.Zb(12,"div",5),s.Wc(13,"\n                "),s.Uc(14,b,4,1,"div",4),s.Wc(15,"\n                "),s.Uc(16,C,4,1,"div",4),s.Wc(17,"\n            "),s.Yb(),s.Wc(18,"\n            "),s.Uc(19,I,12,2,"div",6),s.Wc(20,"\n            "),s.Zb(21,"div",5),s.Wc(22,"\n                "),s.Zb(23,"div",7),s.Wc(24,"\n                    "),s.Vb(25,8),s.Wc(26,"\n                "),s.Yb(),s.Wc(27,"\n                "),s.Zb(28,"div",7),s.Wc(29,"\n                    "),s.Vb(30,8),s.Wc(31,"\n                "),s.Yb(),s.Wc(32,"\n                "),s.Zb(33,"div",9),s.Wc(34,"\n                    "),s.Vb(35,10),s.Wc(36,"\n                "),s.Yb(),s.Wc(37,"\n            "),s.Yb(),s.Wc(38,"\n            "),s.Zb(39,"div",5),s.Wc(40,"\n                "),s.Zb(41,"div",11),s.Wc(42,"\n                    "),s.Vb(43,10),s.Wc(44,"\n                "),s.Yb(),s.Wc(45,"\n                "),s.Wc(46,"\n            "),s.Yb(),s.Wc(47,"\n            "),s.Zb(48,"div",5),s.Wc(49,"\n                "),s.Zb(50,"div",12),s.Wc(51,"\n                    "),s.Vb(52,10),s.Wc(53,"\n                "),s.Yb(),s.Wc(54,"\n                "),s.Uc(55,S,11,4,"div",4),s.Wc(56,"\n            "),s.Yb(),s.Wc(57,"\n            "),s.Zb(58,"div",5),s.Wc(59,"\n                "),s.Uc(60,p,4,1,"div",4),s.Wc(61,"\n                "),s.Uc(62,y,4,1,"div",4),s.Wc(63,"\n            "),s.Yb(),s.Wc(64,"\n            "),s.Zb(65,"div",5),s.Wc(66,"\n                "),s.Zb(67,"div",12),s.Wc(68,"\n                    "),s.Vb(69,10),s.Wc(70,"\n                "),s.Yb(),s.Wc(71,"\n            "),s.Yb(),s.Wc(72,"\n            "),s.Zb(73,"div",5),s.Wc(74,"\n                "),s.Zb(75,"div",12),s.Wc(76,"\n                    "),s.Vb(77,10),s.Wc(78,"\n                "),s.Yb(),s.Wc(79,"\n            "),s.Yb(),s.Wc(80,"\n            "),s.Uc(81,T,4,1,"div",13),s.Wc(82,"\n\n        "),s.Yb(),s.Wc(83,"\n    "),s.Yb(),s.Wc(84,"\n    "),s.Zb(85,"div",14),s.Wc(86,"\n        "),s.Zb(87,"div",15),s.Wc(88,"\n            "),s.Zb(89,"button",16),s.hc("click",(function(){return t.obj.OnButtonClick("OK")})),s.Wc(90),s.mc(91,"translate"),s.Yb(),s.Wc(92,"\n            "),s.Zb(93,"button",17),s.hc("click",(function(){return t.obj.OnButtonClick("Cancel")})),s.Ub(94,"i",18),s.Wc(95),s.mc(96,"translate"),s.Yb(),s.Wc(97,"\n            "),s.Uc(98,M,3,3,"button",19),s.Wc(99,"\n            "),s.Zb(100,"button",16),s.hc("click",(function(){return t.obj.OnButtonClick("Reset")})),s.Wc(101),s.mc(102,"translate"),s.Yb(),s.Wc(103,"\n        "),s.Yb(),s.Wc(104,"\n    "),s.Yb(),s.Wc(105,"\n"),s.Yb()),2&e&&(s.Sc("width",t.obj.IsMobile?"100%":t.obj.TreeVisibility?"1050px":"550px"),s.Db(5),s.tc("ngIf",t.obj.TreeVisibility),s.Db(3),s.Sc("width",t.obj.TreeVisibility?"50%":"100%"),s.Db(2),s.tc("ngIf",t.obj.rdo),s.Db(4),s.tc("ngIf",t.obj.BankAccounts&&t.obj.BankAccounts.Visible),s.Db(2),s.tc("ngIf",t.obj.Documents.Visible),s.Db(3),s.tc("ngIf",t.obj.IsPDC),s.Db(6),s.tc("obj",t.obj.FromDate)("group",t.form),s.Db(5),s.tc("obj",t.obj.ToDate)("group",t.form),s.Db(5),s.tc("obj",t.obj.DateRanges),s.Db(8),s.tc("obj",t.obj.ForeignCurrency),s.Db(9),s.tc("obj",t.obj.Filter),s.Db(3),s.tc("ngIf",t.obj.IsPDC),s.Db(5),s.tc("ngIf",t.obj.Location.Visible),s.Db(2),s.tc("ngIf",t.obj.IsPDC&&t.obj.Division.Visible),s.Db(7),s.tc("obj",t.obj.DimensionWise),s.Db(8),s.tc("obj",t.obj.PostConversionDate),s.Db(4),s.tc("ngIf",t.obj.TreeVisibility),s.Db(9),s.Xc(s.nc(91,26,"Com_OK")),s.Db(5),s.Xc(s.nc(96,28,"Cancel")),s.Db(3),s.tc("ngIf",t.obj.IsPDC),s.Db(3),s.Xc(s.nc(102,30,"Reset")))},directives:[o.t,a.a,o.s,r.a,l.a],pipes:[c.d],encapsulation:2}),e})()},KHrY:function(e,t,i){"use strict";i.r(t),i.d(t,"PostedDocumentViewModel",(function(){return G}));var n=i("mrSG"),s=i("Do2H"),o=i("Lp6j"),a=i("eQJW"),r=i("ScVY"),l=i("4HhE"),c=i("JIg3"),D=i("0/4Q"),d=i("wlFP"),u=i("PDNK"),h=i("n56n"),g=i("AGpa"),m=i("w8Sz"),b=i("6z9j"),C=i("ZDA+"),I=i("8iaB"),S=i("7JXL"),p=i("/G+I");class y extends I.a{constructor(){super(),this.LocationCheckedChanged=new l.b,this.ButtonClick=new l.b,this.IsQuit=!0,this.IsOK=!1,this.FromDate=new c.a(0),this._ClearSelectedNodes=!1,this.Documents=new D.e(0),this.ToDate=new c.a(0),this.DateRanges=new D.e(0),this.Location=new D.b,this.Division=new D.b,this.DimensionWise=new D.b,this.Dimension=0,this._PostConversionDate=new d.a(0),this.IsPDC=!0,this.BankAccounts=new h.b(0),this.LockCheckedChanged=!1}get TreeVisibility(){return!(!s.a.SessionManager.Preferences.ContainsKey("PDCTreeFilter")||"True"!=s.a.SessionManager.Preferences.PDCTreeFilter)}get ClearSelectedNodes(){return this._ClearSelectedNodes}set ClearSelectedNodes(e){this._ClearSelectedNodes=e,this.tree.length>0&&(this.tree[0].ClearAllSelectedNodes=!this.tree[0].ClearAllSelectedNodes)}get PostConversionDate(){return this._PostConversionDate}PostedDocumentDialogViewModel(e){this.IsPDC=!1,this.Title="Trust Reciept",this.Trparent=e,this.Load(),this.TreeVisibility&&(this.CostCenters.Label=s.a.GetResource("Reports_SelectCostCenter"))}PostedDocumentDialogViewModel_1(e){this.parent=e,this.Title=s.a.GetResource("DocumentDesigner_PostedDocument"),this.Load(),this.TreeVisibility&&(this.CostCenters.Label=s.a.GetResource("Reports_SelectCostCenter"))}Load(){if(this.BankAccounts.Label=s.a.GetResource("Reports_BankName"),this.FromDate.Label=s.a.GetResource("DocumentDesigner_FromDate"),this.ToDate.Label=s.a.GetResource("DocumentDesigner_ToDate"),this.FromDate.Date=s.a.SessionManager.ReportsFromDate,this.DateRanges=m.a.getDateRanges(),this.DateRanges.SelectionChangedCommand.Subscribe(this,"OnDateRangesSelectionChanged"),this.PostConversionDate.Label=s.a.GetResource("PostonConversionDate"),this.ButtonClick.Subscribe(this,"OnButtonClick"),this.LocationCheckedChanged.Subscribe(this,"OnLocationCheckedChanged"),this.Location=new D.b,this.Location.CheckedChangedCommand.Subscribe(this,"OnLocationCheckedChanged"),this.Location.Items.push(D.c.CheckedListBoxItem_6("All","All",!1,50002)),this.Location.Visible="True"==s.a.SessionManager.Preferences.EnableLocationWise.toString(),this.tree=[],this.CostCenterFilters=[],this.CostCenters=new D.e(0),this.CostCenters.SelectionChangedCommand.Subscribe(this,"OnCostCenterChange"),this.Division=new D.b,this.Division.CheckedChangedCommand.Subscribe(this,"OnLocationCheckedChanged"),this.Division.Items.push(D.c.CheckedListBoxItem_6("All","All",!1,50001)),this.Division.Visible="True"==s.a.SessionManager.Preferences.EnableDivisionWise.toString(),s.a.SessionManager.Preferences.ContainsKey("PDCFilterDimension")&&null!=s.a.SessionManager.Preferences.PDCFilterDimension&&""!=s.a.SessionManager.Preferences.PDCFilterDimension.toString()&&"0"!=s.a.SessionManager.Preferences.PDCFilterDimension.toString()&&(this.Dimension=parseInt(s.a.SessionManager.Preferences.PDCFilterDimension.toString())),this.DimensionWise=new D.b,this.DimensionWise.CheckedChangedCommand.Subscribe(this,"OnLocationCheckedChanged"),this.DimensionWise.Items.push(D.c.CheckedListBoxItem_6("All","All",!1,this.Dimension)),this.DimensionWise.Visible=this.Dimension>5e4,this.IsPDC){let e,t,i;this.PostConversionDate.Visible=s.a.SessionManager.IsActionAssigned(4e4,"Post on Conversion Date"),this.Documents.Label=s.a.GetResource("lblPDCDocument"),s.a.SessionManager.Preferences.ContainsKey("IntermediatePDCAccListview")&&null!=s.a.SessionManager.Preferences.IntermediatePDCAccListview&&""!=s.a.SessionManager.Preferences.IntermediatePDCAccListview.toString()&&"0"!=s.a.SessionManager.Preferences.IntermediatePDCAccListview.toString()?(this.BankAccounts.CCID=2,this.BankAccounts.TypeID=parseInt(s.a.SessionManager.Preferences.IntermediatePDCAccListview.toString()),this.BankAccounts.Refresh()):(this.BankAccounts.CCID=2,this.BankAccounts.TypeID=2,this.BankAccounts.Refresh()),null!=this.parent&&null!=this.parent.ForeignCurrency?this.ForeignCurrency=this.parent.ForeignCurrency:(this.ForeignCurrency=new g.a,s.a.common.GetDataSet("PDDVM01","").Tables[0].forEach(e=>{this.ForeignCurrency.ComboBox.Items.push(D.d.ComboBoxItems_2(e.Name.toString(),e.CurrencyID.toString()))}),this.ForeignCurrency.ComboBox.Items.length>0&&(this.ForeignCurrency.ComboBox.SelectedValue=this.ForeignCurrency.ComboBox.Items[0].Value)),this.Filter=new u.b("Documents"),e=new u.a("All",0,"Filter"),e.Group=this.Filter,null!=parent&&0==this.parent.Filter&&(e.IsChecked=!0),e.Label=s.a.GetResource("ComLanguageAll"),this.Filter.Items.push(e),e=new u.a("PDR",1,"Filter"),e.Group=this.Filter,null!=parent&&1==this.parent.Filter&&(e.IsChecked=!0),e.Label=s.a.GetResource("PDR"),this.Filter.Items.push(e),e=new u.a("PDP",2,"Filter"),e.Group=this.Filter,null!=parent&&2==this.parent.Filter&&(e.IsChecked=!0),e.Label=s.a.GetResource("PDP"),this.Filter.Items.push(e),this.Stat=new D.e(0),this.Stat.Label=s.a.GetResource("lblPDCStatus"),this.Stat.Items.push(D.d.ComboBoxItems_2(s.a.GetResource("ComLanguageAll"),"0")),this.Stat.Items.push(D.d.ComboBoxItems_2(s.a.GetResource("PDC"),"370")),this.Stat.Items.push(D.d.ComboBoxItems_2(s.a.GetResource("PDC_Posted"),"369")),this.Stat.Items.push(D.d.ComboBoxItems_2(s.a.GetResource("DocumentDesigner_Bounced"),"429")),this.Stat.Items.push(D.d.ComboBoxItems_2("Discounted","439")),this.Stat.Items.push(D.d.ComboBoxItems_2("Cancelled","376")),s.a.SessionManager.IsActionAssigned(4e4,"Replace")&&(this.Stat.Items.push(D.d.ComboBoxItems_2(s.a.GetResource("Replace"),"1")),this.Stat.Items.push(D.d.ComboBoxItems_2(s.a.GetResource("ReplacePartial"),"2"))),s.a.SessionManager.Preferences.ContainsKey("PDCHoldDimension")&&!o.e.IsEmpty(s.a.SessionManager.Preferences.PDCHoldDimension)&&s.a.SessionManager.Preferences.PDCHoldDimension.length>1&&s.a.common.GetDataSet("PDDVM02",s.a.SessionManager.Preferences.PDCHoldDimension).Tables[0].forEach(e=>this.Stat.Items.push(D.d.ComboBoxItems_2(e.Name.toString(),"HOLD_"+e.NodeID.toString()))),this.Stat.SelectedValue=this.parent.Status,this.FilterON=new u.b(s.a.GetResource("Reports_LblFilterOn")),t=new u.a("Doc Date",0,"FilterON"),t.Group=this.FilterON,null!=parent&&0==this.parent.Filter&&(t.IsChecked=!0),t.Label=s.a.GetResource("Doc_Date"),this.FilterON.Items.push(t),t=new u.a("Maturity Date",1,"FilterON"),t.Group=this.FilterON,null!=this.parent&&1==this.parent.Filter&&(t.IsChecked=!0),t.Label=s.a.GetResource("Maturity_Date"),this.FilterON.Items.push(t),this.SortON=new u.b(s.a.GetResource("Reports_LblSortOn")),i=new u.a("Doc Date",0,"SortON"),i.Group=this.SortON,null!=parent&&0==this.parent.Filter&&(i.IsChecked=!0),i.Label=s.a.GetResource("Doc_Date"),this.SortON.Items.push(i),i=new u.a("Maturity Date",1,"SortON"),i.Group=this.SortON,null!=parent&&1==this.parent.Filter&&(i.IsChecked=!0),i.Label=s.a.GetResource("Maturity_Date"),this.SortON.Items.push(i),this.Documents.Items.push(D.d.ComboBoxItems_2("",""));let n=s.a.admin.GetPDCDocs();if(null!=n&&n.Tables.length>0){for(let e=0;e<n.Tables[0].length;e++)this.Documents.Items.push(D.d.ComboBoxItems_2(n.Tables[0][e][n.Columns[0][0]].toString(),n.Tables[0][e][n.Columns[0][1]].toString()));if(this.TreeVisibility&&n.Tables.length>1)for(let e=0;e<n.Tables[1].length;e++)this.CostCenters.Items.push(D.d.ComboBoxItems_2(n.Tables[1][e][n.Columns[1][0]].toString(),n.Tables[1][e][n.Columns[1][1]].toString()))}if(this.Documents.SelectedValue=this.parent.DocumentPicked,null!=this.parent){if(this.Location.Visible){let e=s.a.admin.getLocationRoles(["50002",s.a.SessionManager.LangID]),t=s.a.SessionManager.LocationWhere.split(","),i=o.e.IsEmpty(this.parent.Locations)?[{LocationID:s.a.SessionManager.LocationID.toString()}]:this.parent.Locations.split(",");if(null!=e&&e.Tables.length>0&&e.Tables[0].length>0)for(let n=0;n<e.Tables[0].length;n++)Object(a.j)(e.Tables[0][n].IsGroup.toString())||t.Contains(e.Tables[0][n][e.Columns[0][0]].toString())&&(i.Contains(e.Tables[0][n][e.Columns[0][0]].toString())?this.Location.Items.push(D.c.CheckedListBoxItem_6(e.Tables[0][n][e.Columns[0][2]].toString(),e.Tables[0][n][e.Columns[0][0]].toString(),!0,50002)):this.Location.Items.push(D.c.CheckedListBoxItem_6(e.Tables[0][n][e.Columns[0][2]].toString(),e.Tables[0][n][e.Columns[0][0]].toString(),!1,50002)))}if(this.Division.Visible){let e=s.a.admin.getLocationRoles([50001,s.a.SessionManager.LangID]),t=this.Location.Visible?s.a.SessionManager.DivisionWhere.split(","):s.a.SessionManager.LocationWhere.split(","),i=o.e.IsEmpty(this.parent.Divisions)?this.Location.Visible?s.a.SessionManager.DivisionID.toString():s.a.SessionManager.LocationID.toString():this.parent.Divisions.split(",");if(null!=e&&e.Tables.length>0&&e.Tables[0].length>0)for(let n=0;n<e.Tables[0].length;n++)Object(a.j)(e.Tables[0][n].IsGroup.toString())||t.Contains(e.Tables[0][n][e.Columns[0][0]].toString())&&(i.Contains(e.Tables[0][n][e.Columns[0][0]].toString())?this.Division.Items.push(D.c.CheckedListBoxItem_6(e.Tables[0][n][e.Columns[0][2]].toString(),e.Tables[0][n][e.Columns[0][0]].toString(),!0,50001)):this.Division.Items.push(D.c.CheckedListBoxItem_6(e.Tables[0][n][e.Columns[0][2]].toString(),e.Tables[0][n][e.Columns[0][0]].toString(),!1,50001)))}if(this.DimensionWise.Visible){let e=!1;e="1"!=s.a.SessionManager.UserID&&s.a.SessionManager.Preferences.ContainsKey("Dimension List")&&!o.e.IsEmpty(s.a.SessionManager.Preferences["Dimension List"])&&s.a.SessionManager.Preferences["Dimension List"].toString().Contains(this.Dimension.toString());let t=s.a.common.GetDataSet3("PDDVM03",this.Dimension.toString(),""+e,s.a.SessionManager.UserID+","+s.a.SessionManager.LanguageID),i=this.parent.Dimensions.split(",");if(null!=t&&t.Tables.length>0&&t.Tables[0].length>0){for(let e=0;e<t.Tables[0].length;e++)Object(a.j)(t.Tables[0][e].IsGroup.toString())||(i.Contains(t.Tables[0][e][t.Columns[0][0]].toString())?this.DimensionWise.Items.push(D.c.CheckedListBoxItem_6(t.Tables[0][e].Name.toString(),t.Tables[0][e].NodeID.toString(),!0,this.Dimension)):this.DimensionWise.Items.push(D.c.CheckedListBoxItem_6(t.Tables[0][e].Name.toString(),t.Tables[0][e].NodeID.toString(),!1,this.Dimension)));this.DimensionWise.Label=t.Tables.length>1&&t.Tables[1].length>0?t.Tables[1][0][t.Columns[1][0]].toString():"Dimension"}}this.ToDate.Date=this.parent.ToDate,this.BankAccounts.SelectedValue=this.parent.BankID,this.PostConversionDate.IsChecked=this.parent.PostonconversionDate}if(s.a.SessionManager.Preferences.ContainsKey("DefaultPostConversionDate")&&""!=s.a.SessionManager.Preferences.DefaultPostConversionDate&&(this.PostConversionDate.IsChecked=Object(a.j)(s.a.SessionManager.Preferences.DefaultPostConversionDate)),null!=this.parent){let e=s.a.admin.GetDefaultPDC(1),t=e.Tables.length>0?e.Tables[0]:null;if(null!=t&&t.length>0&&!o.e.IsEmpty(t[0].UserProbableValues)){let e=new o.f;e.LoadXml(t[0].UserProbableValues.toString()),e.SelectNodes("XML/Row").forEach(e=>{if(this.BankAccounts.SelectedValue=parseInt(e.attributes.Bank.value),this.FilterON.Items[parseInt(e.attributes.FilterOn.value)].IsChecked=!0,this.SortON.Items[parseInt(e.attributes.SortOn.value)].IsChecked=!0,this.Filter.Items[parseInt(e.attributes.Document.value)].IsChecked=!0,this.Stat.SelectedValue=e.attributes.Status.value.toString(),this.PostConversionDate.IsChecked=Object(a.j)(e.attributes.PostonconversionDate.value),null!=e.attributes.Documents&&""!=e.attributes.Documents.value&&(this.Documents.SelectedValue=e.attributes.Documents.value),null!=parent&&null!=this.parent.ForeignCurrency||null!=e.attributes.FCChecked&&(this.ForeignCurrency.CheckBox.IsChecked=Object(a.j)(e.attributes.FCChecked.value),this.ForeignCurrency.ComboBox.SelectedValue=e.attributes.FCID.value),this.Location.Visible){let t=e.attributes.Locations.value.toString().split(",");for(let e=0;e<this.Location.Items.length;e++)for(let i=0;i<t.length;i++)this.Location.Items[e].Value.toString()==t[i].toString()&&(this.Location.Items[e].IsChecked=!0)}if(this.Division.Visible&&null!=e.attributes.Divisions){let t=e.attributes.Divisions.value.toString().split(",");for(let e=0;e<this.Division.Items.length;e++)for(let i=0;i<t.length;i++)this.Division.Items[e].Value.toString()==t[i].toString()&&(this.Division.Items[e].IsChecked=!0)}if(this.DimensionWise.Visible&&null!=e.attributes.Dimensions&&this.Dimension.toString()==e.attributes.Dimension.value.toString()){let t=e.attributes.Dimensions.value.toString().split(",");for(let e=0;e<this.DimensionWise.Items.length;e++)for(let i=0;i<t.length;i++)this.DimensionWise.Items[e].Value.toString()==t[i].toString()&&(this.DimensionWise.Items[e].IsChecked=!0)}if(this.TreeVisibility&&null!=this.CostCenterFilters){let i,n="",s="",o="",a=[],r=0;for(let l=0;l<e.attributes.length;l++)if(e.attributes[l].name.startsWith("TreeFilterDimension_")){a=[],n=e.attributes[l].name.Replace("TreeFilterDimension_",""),s=e.attributes[l].value;let c=s.split(",");if(null!=c&&c.length>0)for(let e=0;e<c.length;e++)if(null!=c[e]&&""!=c[e].toString()){let t=new C.a;t.Id=parseInt(c[e]),a.push(t)}var t=this.CostCenters.Items.find(e=>e.Value==n);null!=t&&(o=t.Name),i=new S.a(parseInt(n),"",o,this),i.SelectedNodes=a,i.SelectedNodesTag="[FILTER]",this.CostCenterFilters.push(i),0==r&&(this.CostCenters.SelectedItem=t,this.CostCenters.SelectedValue=n,this.OnCostCenterChange(null)),r++}}})}}}else{this.BankAccounts.CCID=2,this.BankAccounts.TypeID=2,this.BankAccounts.Refresh(),this.Filter=new u.b("Documents");let e=new u.a("All",0,"Filter");e.Group=this.Filter,null!=this.Trparent&&0==this.Trparent.Filter&&(e.IsChecked=!0),e.Label=s.a.GetResource("ComLanguageAll"),this.Filter.Items.push(e),e=new u.a("pending",1,"Filter"),e.Group=this.Filter,null!=this.Trparent&&1==this.Trparent.Filter&&(e.IsChecked=!0),e.Label=s.a.GetResource("PDR"),this.Filter.Items.push(e),this.FromDate.Date=this.Trparent.FromDate,this.ToDate.Date=this.Trparent.toDate,this.BankAccounts.SelectedValue=this.Trparent.BankAccounts.SelectedValue,this.Documents.Visible=!1}}OnCostCenterChange(e){if(!o.e.IsEmpty(this.CostCenters.SelectedValue)&&(0==this.tree.length||this.tree[0].CostCenterID!=parseInt(this.CostCenters.SelectedValue))){let e=0;null==this.CostCenters.SelectedItem||o.e.IsEmpty(this.CostCenters.SelectedItem.Parent)||(e=o.e.Int(this.CostCenters.SelectedItem.Parent)),this.LoadCostCenterTree(parseInt(this.CostCenters.SelectedValue),e,0,null)}}LoadCostCenterTree(e,t,i,n){this.tree.Clear();let a="";50002==e&&"True"==s.a.SessionManager.Preferences.EnableLocationWise.toString()&&"True"==s.a.SessionManager.Preferences["LW Reports"]&&(a=o.e.IsEmpty(s.a.SessionManager.LocationWhere)?"a.NodeID IN (-1234)":"a.NodeID IN ("+s.a.SessionManager.LocationWhere+")");let r=new b.a;if(null==n)for(let s=0;s<this.CostCenterFilters.length;s++){const i=this.CostCenterFilters[s];if(i.CostCenterID==e&&i.LookupTypeID==t){n=i.SelectedNodes;break}}null==n?r.TreeViewModel_5(e,this,i,a,""):r.TreeViewModel_6(e,this,i,a,n,""),r.LookupTypeID=t,r.HeaderVisiblity=!1,r.OnNodeSelected||(r.OnNodeSelected=new l.b,r.OnNodeSelected.Subscribe(this,"OnNodeSelected")),this.tree.push(r)}GetLocation(e,t){let i="";if(e.Visible){for(let t=1;t<e.Items.length;t++)e.Items[t].IsChecked&&(i.length>0&&(i+=","),i+=e.Items[t].Value);t&&(0==i.length&&(i="-100"),e.Items[0].IsChecked&&"1"==s.a.SessionManager.RoleID&&(i=""))}return i}OnLocationCheckedChanged(e){if(!this.LockCheckedChanged&&e.item instanceof D.c){let t=e.item,i=50001==t.Type||50002==t.Type?50001==t.Type?this.Division:this.Location:this.DimensionWise;if("All"==t.Value){this.LockCheckedChanged=!0;for(let e=1;e<i.Items.length;e++)i.Items[e].IsChecked=t.IsChecked;this.LockCheckedChanged=!1}else{if(this.LockCheckedChanged=!0,t.IsChecked){i.Items[0].IsChecked=!0;for(let e=1;e<i.Items.length;e++)if(!i.Items[e].IsChecked){i.Items[0].IsChecked=!1;break}}else i.Items[0].IsChecked=!1;this.LockCheckedChanged=!1}this.LockCheckedChanged=!1}}OnButtonClick(e){if("Cancel"==e.toString())s.a.page.HideDialog();else if("SetAsDefault"==e.toString()){let e="";if(e+="<XML>",e+="<Row ",e+='Bank="'+this.BankAccounts.SelectedValue+'" ',e+='FilterOn="'+this.FilterON.CheckedItem.FeatureID+'" ',e+='SortOn="'+this.SortON.CheckedItem.FeatureID+'" ',e+='Document="'+this.Filter.CheckedItem.FeatureID+'" ',e+='Status="'+this.Stat.SelectedValue+'" ',e+='Locations="'+this.GetLocation(this.Location,!1)+'" ',e+='Divisions="'+this.GetLocation(this.Division,!1)+'" ',e+='PostonconversionDate="'+this.PostConversionDate.IsChecked+'" ',e+='Documents="'+this.Documents.SelectedValue+'" ',this.DimensionWise.Visible&&(e+='Dimension="'+this.Dimension+'" ',e+='Dimensions="'+this.GetLocation(this.DimensionWise,!1)+'" '),null!=this.ForeignCurrency&&(e+='FCChecked="'+this.ForeignCurrency.CheckBox.IsChecked+'" ',e+='FCID="'+(""==this.ForeignCurrency.ComboBox.SelectedValue?"0":this.ForeignCurrency.ComboBox.SelectedValue)+'" '),this.TreeVisibility&&null!=this.CostCenterFilters&&this.CostCenterFilters.length>0){let t="";for(let i=0;i<this.CostCenterFilters.length;i++){t="";for(let e=0;e<this.CostCenterFilters[i].SelectedNodes.length;e++)e>0&&(t+=","),t+=this.CostCenterFilters[i].SelectedNodes[e].Id;t.length>0&&(e+="TreeFilterDimension_"+this.CostCenterFilters[i].CostCenterID+'="'+t+'" ')}}e+="/>",e+="</XML>";let t=0;s.a.admin.SetDefaultPDC(e.toString(),!0,1,t)}else if("Reset"==e.toString())s.a.admin.SetDefaultPDC("",!1,1,0),this.BankAccounts.SelectedValue=0,this.Stat.SelectedValue="0",this.Documents.SelectedValue="",this.Location.Items.length>0&&this.Location.Items.forEach(e=>{e.IsChecked=!1});else if("LocationSearch"==e);else if("DivisionSearch"==e);else if("DimensionWiseSearch"==e);else try{this.IsPDC&&null!=parent?(this.parent.DialogResult=!0,this.parent.FromDate=this.FromDate.Date,this.parent.ForeignCurrency=this.ForeignCurrency,this.parent.ToDate=this.ToDate.Date,this.parent.BankID=this.BankAccounts.SelectedValue,this.parent.Filter=this.Filter.CheckedItem.FeatureID,null!=this.Stat.SelectedValue&&this.Stat.SelectedValue.startsWith("HOLD_")?(this.parent.Status="0",this.parent.HoldDimFilter=parseInt(this.Stat.SelectedValue.replace("HOLD_",""))):(this.parent.Status=this.Stat.SelectedValue,this.parent.HoldDimFilter=0),this.parent.DocumentPicked=this.Documents.SelectedValue,this.parent.Locations=this.GetLocation(this.Location,!0),this.parent.Divisions=this.GetLocation(this.Division,!0),this.parent.Dimensions=this.GetLocation(this.DimensionWise,!0),this.parent.PostonconversionDate=this.PostConversionDate.IsChecked,this.parent.FilterOn=this.FilterON.Items[0].IsChecked?"DocDate":"ChequeMaturityDate",this.parent.SortOn=this.SortON.Items[0].IsChecked?"DocDate":"ChequeMaturityDate",this.parent.TreeWhere="",this.TreeVisibility&&null!=this.CostCenterFilters&&this.CostCenterFilters.length>0&&(this.parent.TreeWhere=this.GetDimensionFilter("L.dcCCNID")),this.parent.LoadData(),this.parent.PDCDialog=this,s.a.page.HideDialog()):null!=this.Trparent&&(this.Trparent.DialogResult=!0,this.Trparent.FromDate=this.FromDate.Date,this.Trparent.toDate=this.ToDate.Date,this.Trparent.BankAccounts.SelectedValue=this.BankAccounts.SelectedValue,this.Trparent.Filter=this.Filter.CheckedItem.FeatureID,this.Trparent.LoadData(),s.a.page.HideDialog())}catch(t){Logger.ErrorLog("PostedDocumentDialogViewModel","OnButtonClick",t.Message)}}GetDimensionFilter(e,t=null){let i="";return this.CostCenterFilters.forEach(n=>{if(n.CostCenterID>5e4&&(null==t||!t.Contains(n.CostCenterID)))if(n.SelectedNodes.length>0)if(1==n.SelectedNodes.length)i+=" AND ",i+=e+(n.CostCenterID-5e4)+"="+n.SelectedNodes[0].Id;else{let t="1"==s.a.SessionManager.UserID||"1"==s.a.SessionManager.RoleID;if(null==(n.DeleteButtonVisibility||t?n.SelectedNodes.find(e=>2==e.Id&&e.IsGroup):null))if(i+=" AND ",p.IPrefetchFilter.IsGroupTree(n)&&(n.DeleteButtonVisibility||t)){let t="";for(let e=0;e<n.SelectedNodes.length;e++)null!=n.SelectedNodes[e].Parent&&n.SelectedNodes[e].Parent.IsSelected||(t.length>0&&(t+=","),t+=n.SelectedNodes[e].Id);0==t.length&&(t+=-12912),i+=e+(n.CostCenterID-5e4)+" IN ",i+=" (select T.NodeID GTID from "+this.GetTagTableName(n.CostCenterID)+" T with(nolock),"+this.GetTagTableName(n.CostCenterID)+" GTP with(nolock) where T.lft BETWEEN GTP.lft AND GTP.rgt AND GTP.NodeID IN "+t.toString()+")  group by T.NodeID)"}else{i+=e+(n.CostCenterID-5e4)+" IN (";for(let e=0;e<n.SelectedNodes.length;e++)e>0&&(i+=","),i+=n.SelectedNodes[e].Id;i+=")"}}else n.DeleteButtonVisibility||(i+=" AND ",i+=e+(n.CostCenterID-5e4)+"=-12912")}),i.toString()}GetTagTableName(e){return 2==e?"ACC_Accounts":3==e?"INV_Product":7==e?"ADM_Users":50001==e?"COM_Division":50002==e?"COM_Location":50003==e?"COM_Branch":50004==e?"COM_Department":50005==e?"COM_Salesman":50006==e?"COM_Category":50007==e?"COM_Area":50008==e?"COM_Teritory":"COM_CC"+e}OnDateRangesSelectionChanged(e){}}var P=i("lUlH"),f=i("8B8H"),T=i("vTM8"),M=i("uMy8"),L=i("ockk"),A=i("H45g"),V=i("Iab2");let G=(()=>{class e extends r.b{constructor(){super(),this.SavePostedDocument=new l.b,this.ConvertMatDateequaltosysdate=!1,this.ConvertMatDatelessthanequaltosysdate=!1,this.MessageVisibility=!1,this._SelectMaturityDate=!1,this._SelectLessThanMaturityDate=!1,this.DialogResult=!1,this.FromDate=new Date,this.ToDate=new Date,this.Filter=0,this.HoldDimFilter=0,this.Locations="",this.Divisions="",this.Status="0",this.DocumentPicked="",this.Dimensions="",this.TreeWhere="",this.PostonconversionDate=!1,this.IsPDCHoldDimension=!1,this.dtTmp=null,this.dtActions=null,this.ActionSummary="",this._ScreenObject=new P.a(4e4,0),this.onLoad(),this.SetLockDims(),this.DialogResult=!1;let e=new y;e.PostedDocumentDialogViewModel_1(this),s.a.page.ShowDialog(e,A.a),this.PstDocGrid.Height=500}get ScreenObject(){return this._ScreenObject}get SelectMaturityDate(){return this._SelectMaturityDate}set SelectMaturityDate(e){e!=this._SelectMaturityDate&&(this._SelectMaturityDate=e,this.selectConvert(!0))}get SelectLessThanMaturityDate(){return this._SelectLessThanMaturityDate}set SelectLessThanMaturityDate(e){e!=this._SelectLessThanMaturityDate&&(this._SelectLessThanMaturityDate=e,this.selectConvert(!1))}PostedDocumentViewModel_1(t){this.ActionSummary="",Logger.InfoLog("PostedDocumentViewModel:: Inside PostedDocumentViewModel main "),this._ScreenObject=new P.a(4e4,0),e.SetDimensionQuery(),this.onLoad(),this.LoadDashData(t),Logger.InfoLog("PostedDocumentViewModel:: Exiting PostedDocumentViewModel ")}static SetDimensionQuery(){Logger.InfoLog("PostedDocumentViewModel:: Inside SetDimensionQuery  "),this.strSelect=",ChequeBankName",this.strJoin="";try{let e=new o.f;e.LoadXml(s.a.SessionManager.Preferences["PDC Customize Screen"]);for(let t=0;t<e.DocumentElement.children.length;t++){let i=e.DocumentElement.children[t];if("DIM"==i.attributes.Type.value){let e=(parseInt(i.attributes.ID.value)-5e4).toString();this.strSelect+=",L.dcCCNID"+e+",D"+e+".Name AS DIM"+i.attributes.ID.value,this.strJoin+=" LEFT JOIN "+o.e.GetTagTableName(parseInt(i.attributes.ID.value))+" AS D"+e+" ON L.dcCCNID"+e+"=D"+e+".NodeID"}else"FLD"!=i.attributes.Type.value||"CommonNarration"!=i.attributes.ID.value&&"LineNarration"!=i.attributes.ID.value||(this.strSelect+=","+i.attributes.ID.value)}}catch(e){Logger.ErrorLog("PDC Dimension Query Error..",e)}Logger.InfoLog("PostedDocumentViewModel:: Exiting SetDimensionQuery  ")}onLoad(){Logger.InfoLog("PostedDocumentViewModel:: Inside onLoad  "),this.DisplayName=s.a.GetResource("DocumentDesigner_PostedDocument"),this.InitColumns(),this.ConvertMatDatelessthanequaltosysdate=s.a.SessionManager.IsActionAssigned(4e4,"Convert maturity date lessthan or equalto sysdate"),this.ConvertMatDateequaltosysdate=s.a.SessionManager.IsActionAssigned(4e4,"Convert maturity date equal to system date"),this.SavePostedDocument.Subscribe(this,"ButtonSave"),this.PstDocGrid.BeginEdit.Subscribe(this,"OnBeginEdit"),this.PstDocGrid.CellEditEnding.Subscribe(this,"OnEditend"),this.PstDocGrid.OnPreviewKeyDown.Subscribe(this,"OnPreviewKeyDown"),Logger.InfoLog("PostedDocumentViewModel:: Exiting onLoad  ")}OnPreviewKeyDown(e,t){let i="";if(e.grid.getCellEditor()&&e.grid.getCellEditor().args.column.name&&(i=e.grid.getCellEditor().args.column.name),117==t.which&&("Action"==i||"clrDate"==i)){if("YES"!=(confirm("Do you want to override all.?")?"Yes":"No").toUpperCase())return!0;let t=this.PstDocGrid.Table;for(let n=0;n<t.length;n++)("Action"!=i||this.isActionExists(t[n],e[i].toString()))&&(t[n][i]=e[i].toString(),this.PstDocGrid.TableColumns.Contains(i+"_Key")&&(t[n][i+"_Key"]=e[i+"_Key"].toString()),this.UpdateAction(t[n]));return!0}return!1}isActionExists(e,t){let i=this.dtActions;i.RowFilter=o.e.IsEmpty(e.StatusID)||370!=parseInt(e.StatusID.toString())?o.e.IsEmpty(e.StatusID)||439!=parseInt(e.StatusID.toString())?o.e.IsEmpty(e.StatusID)||369!=parseInt(e.StatusID.toString())?"Value=2 or Value=100":"Value=2 or Value=0  or Value=4 or Value=5 or Value=100":"Value=1 or Value=0 or Value=100":"Value=1 or Value=0 or Value=4 or Value=5 or Value=3 or Value=100";for(let n=0;n<i.length;n++)if(i[n].Value.toString()==t)return!0;return!1}SetLockDims(){return Object(n.b)(this,void 0,void 0,(function*(){const{AddEditDocumentViewModel:e}=yield Promise.all([i.e(2),i.e(1),i.e(3),i.e(5),i.e(4),i.e(6),i.e(7),i.e(10),i.e(9),i.e(12),i.e(11),i.e(13),i.e(19),i.e(15),i.e(21),i.e(20),i.e(16),i.e(14),i.e(18),i.e(17),i.e(22),i.e(148)]).then(i.bind(null,"1Cra"));if("true"==s.a.SessionManager.Preferences.UseDimWiseLock.toLowerCase()&&""!=s.a.SessionManager.Preferences["DimensionWiseLockData Customize Screen"]&&"<XML></XML>"!=s.a.SessionManager.Preferences["DimensionWiseLockData Customize Screen"]){this.ScreenObject.LockWhere="";let t="",i="",n=new T.a,a=0,r=0,l=s.a.common.GetDataSet("PDVM01",""),c=new o.f;c.LoadXml(s.a.SessionManager.Preferences["DimensionWiseLockData Customize Screen"]),c.SelectNodes("XML/Row").forEach(s=>{if(null!=s.attributes.ID&&!o.e.IsEmpty(s.attributes.ID.value)){r++;let c=!1;a=parseInt(s.attributes.ID.value),null!=l&&l.Tables.length>0&&l.Tables[0].length>0&&l.Tables[0].filter(e=>e.CostCenterID==a).length>0&&(c=!0),n.push(a.toString(),c),c?(i+=" left join "+o.e.GetTagTableName(a)+" CC"+r+" with(nolock) on C."+e.GetPrimarkyKey(a,!0)+"=CC"+r+"."+e.GetPrimarkyKey(a)+"\n\t\t\t\t\t\t\t\tleft join "+o.e.GetTagTableName(a)+" CJ"+r+" with(nolock) on CJ"+r+".lft between CC"+r+".lft and CC"+r+".rgt",a>5e4?t+=" and (b.dcCCNID"+(a-5e4)+"=CJ"+r+".NodeID or c.CCNID"+(a-5e4)+"=0)":3==a?t+=" and (a.ProductID=CJ"+r+".ProductID or c.ProductID=0)":2==a&&(t+=" and (a.DebitAccount=CJ"+r+".AccountID or a.CreditAccount=CJ"+r+".AccountID or c.AccountID=0)")):a>5e4?t+=" and (b.dcCCNID"+(a-5e4)+"=c.CCNID"+(a-5e4)+" or c.CCNID"+(a-5e4)+"=0)":3==a?t+=" and (a.ProductID=c.ProductID or c.ProductID=0)":2==a?t+=" and (a.DebitAccount=c.AccountID or a.CreditAccount=c.AccountID or c.AccountID=0)":400==a&&(t+=" and (a.CostCenterID=c.DocumentID or c.DocumentID=1)")}}),this.ScreenObject.LockWhere=""!=i?'<XML where="'+t+'" join="'+i+'"></XML>':t}}))}UpdateActionSummary(){if(Logger.InfoLog("PostedDocumentViewModel:: Inside UpdateActionSummary()  "),this.dtTmp=[],this.dtTmp=this.PstDocGrid.Table,this.ActionSummary="",Logger.InfoLog("PDC Rows Count :: "+this.dtTmp.length+" Actions Count :: "+this.dtActions.length),null!=this.dtActions&&this.dtActions.length>0){let e=0,t="",i=1,n=null;for(let a=0;a<this.dtActions.length;a++)e=0,t="Action_Key='"+this.dtActions[a].Name.toString()+"'",e=o.e.DTComputeSUM(this.dtTmp.filter(e=>e.Action_Key==this.dtActions[a].Name.toString()),"Amount",!1),n=this.dtTmp.filter(e=>e.Action_Key==this.dtActions[a].Name.toString()),Logger.InfoLog("Expression :: "+t+" Length : "+n.length),0!=e&&(this.ActionSummary+=this.dtActions[a].Name.toString()+" ( "+n.length+" )  : "+e.ToString("N"+s.a.SessionManager.Preferences.DecimalsinAmount)+"\t",i%2==0&&(this.ActionSummary+="\r\n"),i++);Logger.InfoLog("Action Summary :: "+this.ActionSummary)}Logger.InfoLog("PostedDocumentViewModel:: End UpdateActionSummary()  ")}OnEditend(e){this.PstDocGrid.TableColumns.Contains("Penalty")&&!o.e.IsEmpty(s.a.SessionManager.Preferences.PenaltyFormula.Trim())&&"DataGridPactComboBoxColumn"==e.column.className&&"Action"==e.column.DataGridColumn.SelectedValueBinding&&this.UpdateAction(e.item)}UpdateAction(e){if(o.e.IsEmpty(e.Action)||"0"!=e.Action.toString())Object.keys(e).Contains("Penalty")&&(e.Penalty=null);else{let i,n=new T.a,a=new M.c;a.setFieldDetails("Amount",1,1,"",1,!1,!1),n.push("Amount",a);let r=n;n.Amount.setFieldValue(e.Amount.toString());var t=s.a.eval.EvaluateExpression(s.a.SessionManager.Preferences.PenaltyFormula,r).toString();i=o.e.DoubleTryParse(t.toString()),null!=t&&"Infinity"!=t.toString()&&"-Infinity"!=t.toString()&&"NaN"!=t.toString()&&o.e.DoubleTryParse(t.toString())&&(e.Penalty=t.toString())}this.UpdateActionSummary()}OnBeginEdit(e){let t=e.args;if(Logger.InfoLog("PostedDocumentViewModel:: Inside OnBeginEdit"),"DataGridPactComboBoxColumn"==t.column.className){if("Action"==t.model.SelectedValueBinding){let e=t.item;if(""!=e.StatusID.toString()&&452==parseInt(e.StatusID.toString()))return void(t.Cancel=!0);t.column.internalColumnEditor.collection.ItemsSource=t.column.DgCol.ComboData,t.column.internalColumnEditor.collection.ItemsSource=o.e.IsEmpty(e.StatusID)||370!=parseInt(e.StatusID.toString())?o.e.IsEmpty(e.StatusID)||439!=parseInt(e.StatusID.toString())?o.e.IsEmpty(e.StatusID)||369!=parseInt(e.StatusID.toString())?!o.e.IsEmpty(e.StatusID)&&429==parseInt(e.StatusID.toString())&&o.e.hasprop(e,"AdjCnt")&&!o.e.IsEmpty(e.AdjCnt)&&parseInt(e.AdjCnt.toString())>0?t.column.DgCol.ComboData.filter(e=>"false"==e):o.e.IsEmpty(e.StatusID)||376!=parseInt(e.StatusID.toString())?t.column.DgCol.ComboData.filter(e=>2==e.Value||100==e.Value):t.column.DgCol.ComboData.filter(e=>"false"==e):t.column.DgCol.ComboData.filter(e=>2==e.Value||0==e.Value||4==e.Value||5==e.Value||100==e.Value):t.column.DgCol.ComboData.filter(e=>1==e.Value||0==e.Value||100==e.Value):t.column.DgCol.ComboData.filter(e=>1==e.Value||0==e.Value||4==e.Value||5==e.Value||3==e.Value||100==e.Value)}}else if("DataGridDateColumn"==t.column.className){let e=t.column.internalColumnEditor.collection.SelectedValueBinding,i=t.Item;if(""!=i.StatusID.toString()&&452==parseInt(i.StatusID.toString()))return void(t.Cancel=!0);if("clrDate_Key"==e){if(o.e.IsEmpty(i.Action)||1!=parseInt(i.Action.toString())&&0!=parseInt(i.Action.toString())&&4!=parseInt(i.Action.toString())&&5!=parseInt(i.Action.toString()))return void(t.Cancel=!0)}else if("HoldDate_Key"==e&&"370"!=t.item.StatusID.toString())return void(t.Cancel=!0)}else if("DataGridPactListBoxColumn"==t.column.className){let e=t.column.internalColumnEditor.collection,i=e.SelectedValueBinding,n=t.Item;if(!o.e.IsEmpty(n.StatusID)&&452==parseInt(n.StatusID.toString()))return void(t.Cancel=!0);if(!o.e.IsEmpty(n.BankIDs))return void(t.Cancel=!0);if(!o.e.IsEmpty(n.StatusID)&&439==parseInt(n.StatusID.toString()))return void(t.Cancel=!0);if("19"!=n.DocumentType.toString()&&!s.a.SessionManager.IsActionAssigned(43,"PDPBankChange"))return void(t.Cancel=!0);if("HoldDimension_Key"==i&&"370"!=n.StatusID.toString())return void(t.Cancel=!0);2==e.CostCenterID&&(this.PstDocGrid.TableColumns.Contains("dcCCNID1")&&!o.e.IsEmpty(n.dcCCNID1)&&parseInt(n.dcCCNID1.toString())>0&&(e.DivisionID=parseInt(n.dcCCNID1.toString())),this.PstDocGrid.TableColumns.Contains("dcCCNID2")&&!o.e.IsEmpty(n.dcCCNID2)&&parseInt(n.dcCCNID2.toString())>0&&(e.LocationID=parseInt(n.dcCCNID2.toString())))}Logger.InfoLog("PostedDocumentViewModel:: Exiting OnBeginEdit")}InitColumns(){Logger.InfoLog("PostedDocumentViewModel:: Inside InitColumns");let t=[];t.Columns=[],t.Columns.push("Name"),t.Columns.push("Value"),t.Columns.push("Status");let i,n=[];n.Name="",n.Value=100,t.push(n),s.a.SessionManager.IsActionAssigned(4e4,"Convert")&&(n=[],n.Name=s.a.GetResource("Pdc_Convert"),n.Value=1,t.push(n)),s.a.SessionManager.IsActionAssigned(4e4,"UnConvert")&&(n=[],n.Name=s.a.GetResource("Pdc_unConvert"),n.Value=2,t.push(n)),s.a.SessionManager.IsActionAssigned(4e4,"Bounce")&&(n=[],n.Name=s.a.GetResource("DocumentDesigner_Bounce"),n.Value=0,t.push(n)),s.a.SessionManager.IsActionAssigned(4e4,"Replace")&&(n=[],n.Name=s.a.GetResource("Replace"),n.Value=4,t.push(n),n=[],n.Name=s.a.GetResource("ReplacePartial"),n.Value=5,t.push(n)),s.a.SessionManager.IsActionAssigned(4e4,"Cancel")&&(n=[],n.Name="Cancel",n.Value=3,t.push(n)),this.dtActions=[],this.dtActions=t.filter(e=>""!=e.Name),this.IsPDCHoldDimension=!1,s.a.SessionManager.Preferences.ContainsKey("PDCHoldDimension")&&!o.e.IsEmpty(s.a.SessionManager.Preferences.PDCHoldDimension)&&s.a.SessionManager.Preferences.PDCHoldDimension.length>1&&(this.IsPDCHoldDimension=!0),this.PstDocGrid=new f.a,this.PstDocGrid.CanUserSortColumns=!0,this.PstDocGrid.Columns=[],this.PstDocGrid.Width="",this.PstDocGrid.CalcTotalsOnDataView=!0;let a=[],r=[];if(s.a.SessionManager.Preferences.ContainsKey("PDC Screen Widths")&&""!=s.a.SessionManager.Preferences["PDC Screen Widths"]){let e=new o.f;e.LoadXml(s.a.SessionManager.Preferences["PDC Screen Widths"]);for(let t=0;t<e.DocumentElement.childNodes.length;t++){let n=e.DocumentElement.children[t];i=new L.a,i.Header=n.attributes.Header.value,i.DisplayMember=n.attributes.Name.value,i.DisplayIndex=parseInt(n.attributes.index.value),i.Width=parseInt(n.attributes.WIDTH.value),a.push(i)}}i=new L.a,i.Header=s.a.GetResource("DocumentDesigner_Sno"),i.DisplayMember="Sno",i.ReadOnly=!0,i.IsFrozen=!0,i.Width=45;var l=a.filter(e=>e.DisplayMember==i.DisplayMember);let c;null!=l?(i.DisplayIndex=l.DisplayIndex,i.Width=l.Width):a.length>0&&(i.IsVisible=!1),r.push(i),i=new L.a,i.Header=s.a.GetResource("DocumentDesigner_VoucherNo"),i.DisplayMember="VoucherNo",i.DataType="LINK",i.Click.Subscribe(this,"onClick"),i.ReadOnly=!0,i.IsFrozen=!0,i.Width=100,null!=(l=a.filter(e=>e.DisplayMember==i.DisplayMember))?(i.DisplayIndex=l.DisplayIndex,i.Width=l.Width):a.length>0&&(i.IsVisible=!1),r.push(i),i=new L.a,i.Header=s.a.GetResource("DocumentDesigner_VoucherDate"),i.DisplayMember="DocDateFormat",i.ReadOnly=!0,i.DataType="DATE",i.Width=80,null!=(l=a.filter(e=>e.DisplayMember==i.DisplayMember))?(i.DisplayIndex=l.DisplayIndex,i.Width=l.Width):a.length>0&&(i.IsVisible=!1),r.push(i),i=new L.a,i.Header=s.a.GetResource("DocumentDesigner_Account"),i.DisplayMember="AccountID",i.ValueMember="AccountID_Key",i.ReadOnly=!0,i.Width=150,null!=(l=a.filter(e=>e.DisplayMember==i.DisplayMember))?(i.DisplayIndex=l.DisplayIndex,i.Width=l.Width):a.length>0&&(i.IsVisible=!1),r.push(i),i=new L.a,i.Header=s.a.GetResource("DocumentDesigner_ChequeNo"),i.DisplayMember="ChequeNumber",i.ReadOnly=!0,i.Width=100,null!=(l=a.filter(e=>e.DisplayMember==i.DisplayMember))?(i.DisplayIndex=l.DisplayIndex,i.Width=l.Width):a.length>0&&(i.IsVisible=!1),r.push(i),i=new L.a,i.Header=s.a.GetResource("Service_ChequeDate"),i.DisplayMember="ChequeDateFormat",i.ReadOnly=!0,i.DataType="DATE",i.Width=80,null!=(l=a.filter(e=>e.DisplayMember==i.DisplayMember))?(i.DisplayIndex=l.DisplayIndex,i.Width=l.Width):a.length>0&&(i.IsVisible=!1),r.push(i),i=new L.a,i.Header=s.a.GetResource("DocumentDesigner_Amount"),i.DisplayMember="Amount",i.ReadOnly=!0,i.DataType="FLOAT",i.DecimalPoints=s.a.SessionManager.Preferences.DecimalsinAmount,i.Width=100,i.IsCalculated=1,i.ShowTotal=!0,null!=(l=a.filter(e=>e.DisplayMember==i.DisplayMember))?(i.DisplayIndex=l.DisplayIndex,i.Width=l.Width):a.length>0&&(i.IsVisible=!1),r.push(i),i=new L.a,i.Header=s.a.GetResource("DocumentDesigner_MaturityDate"),i.DisplayMember="MaturityDateFormat",i.ReadOnly=!0,i.DataType="DATE",i.Width=80,null!=(l=a.filter(e=>e.DisplayMember==i.DisplayMember))?(i.DisplayIndex=l.DisplayIndex,i.Width=l.Width):a.length>0&&(i.IsVisible=!1),r.push(i),i=new L.a,i.Header=s.a.GetResource("DocumentDesigner_Bank"),i.DisplayMember="BankAccountID",i.ValueMember="BankAccountID_Key",i.DataType="LISTBOX",i.CostCenterID=2,c=o.e.IntTryParse(s.a.SessionManager.Preferences.PDCAccountListView),i.TypeID=s.a.SessionManager.Preferences.ContainsKey("PDCAccountListView")&&o.e.IntTryParse(s.a.SessionManager.Preferences.PDCAccountListView)?parseInt(s.a.SessionManager.Preferences.PDCAccountListView):51,i.Width=150,null!=(l=a.filter(e=>e.DisplayMember==i.DisplayMember))?(i.DisplayIndex=l.DisplayIndex,i.Width=l.Width):a.length>0&&(i.IsVisible=!1),r.push(i),i=new L.a,i.Header=s.a.GetResource("Ren_CntrctPayee"),i.DisplayMember="ChequeBankName",i.ReadOnly=!0,i.Width=100,null!=(l=a.filter(e=>e.DisplayMember==i.DisplayMember))?(i.DisplayIndex=l.DisplayIndex,i.Width=l.Width):a.length>0&&(i.IsVisible=!1),r.push(i);let D=new o.f;D.LoadXml(s.a.SessionManager.Preferences["PDC Customize Screen"]);for(let e=0;e<D.DocumentElement.children.length;e++){let t=D.DocumentElement.children[e];"DIM"==t.attributes.Type.value?(i=new L.a,i.Header=t.attributes.Header.value,i.DisplayMember="DIM"+t.attributes.ID.value,i.ReadOnly=!0,i.Width=100,null!=(l=a.filter(e=>e.DisplayMember==i.DisplayMember))?(i.DisplayIndex=l.DisplayIndex,i.Width=l.Width):a.length>0&&(i.IsVisible=!1),r.push(i)):"FLD"==t.attributes.Type.value&&(i=new L.a,i.Header=t.attributes.Header.value,i.DisplayMember=t.attributes.ID.value,i.ReadOnly=!0,i.Width=150,null!=(l=a.filter(e=>e.DisplayMember==i.DisplayMember))?(i.DisplayIndex=l.DisplayIndex,i.Width=l.Width):a.length>0&&(i.IsVisible=!1),r.push(i))}if(i=new L.a,i.Header=s.a.GetResource("DocumentDesigner_Action"),i.ValueBinding="Action",i.DataType="PactComboBox",i.DisplayMember="Name",i.ValueMember="Value",i.Width=70,i.ComboData=t,null!=(l=a.filter(e=>e.DisplayMember==i.ValueBinding))?(i.DisplayIndex=l.DisplayIndex,i.Width=l.Width):a.length>0&&(i.IsVisible=!1),r.push(i),s.a.SessionManager.Preferences.ContainsKey("PostPenalty")&&"true"==s.a.SessionManager.Preferences.PostPenalty.toLowerCase()){let e=i.DisplayIndex;i=new L.a,i.Header="Penalty",i.DisplayMember="Penalty",s.a.SessionManager.IsActionAssigned(4e4,"EditPenalty")||(i.ReadOnly=!0),i.DataType="FLOAT",i.DecimalPoints=s.a.SessionManager.Preferences.DecimalsinAmount,i.Width=100,i.IsCalculated=1,i.ShowTotal=!0,null!=(l=a.filter(e=>e.DisplayMember==i.DisplayMember))?(i.DisplayIndex=l.DisplayIndex,i.Width=l.Width):i.DisplayIndex=e+1,r.push(i)}i=new L.a,i.Header=s.a.GetResource("DocumentDesigner_ConvertOn"),i.DisplayMember="clrDate",i.ValueMember="clrDate_Key",i.DataType="DATE",i.ReadOnly=!1,i.Width=90,null!=(l=a.filter(e=>e.DisplayMember==i.DisplayMember))?(i.DisplayIndex=l.DisplayIndex,i.Width=l.Width):a.length>0&&(i.IsVisible=!1),r.push(i),i=new L.a,i.Header=s.a.GetResource("DocumentDesigner_Status"),i.DisplayMember="Status",i.ReadOnly=!0,i.Width=100,null!=(l=a.filter(e=>e.DisplayMember==i.DisplayMember))?(i.DisplayIndex=l.DisplayIndex,i.Width=l.Width):a.length>0&&(i.IsVisible=!1),r.push(i),i=new L.a,i.Header=s.a.GetResource("PDC_DocNo"),i.DisplayMember="ConvertedDocNo",i.ReadOnly=!0,i.Width=120,i.DataType="LINK",i.Click.Subscribe(this,"OnDocLink"),null!=(l=a.filter(e=>e.DisplayMember==i.DisplayMember))?(i.DisplayIndex=l.DisplayIndex,i.Width=l.Width):a.length>0&&(i.IsVisible=!1),r.push(i),i=new L.a,i.Header="User",i.DisplayMember="ConvertedDocUser",i.ReadOnly=!0,i.Width=120,i.DataType="LINK",i.Click.Subscribe(this,"OnDocLink"),null!=(l=a.filter(e=>e.DisplayMember==i.DisplayMember))?(i.DisplayIndex=l.DisplayIndex,i.Width=l.Width):a.length>0&&(i.IsVisible=!1),r.push(i),i=new L.a,i.Header="Date",i.DisplayMember="ConvertedDocDate_Key",i.ReadOnly=!0,i.Width=120,i.DataType="LINK",i.Click.Subscribe(this,"OnDocLink"),null!=(l=a.filter(e=>"ConvertedDocDate"==e.DisplayMember))?(i.DisplayIndex=l.DisplayIndex,i.Width=l.Width):a.length>0&&(i.IsVisible=!1),r.push(i),i=new L.a,i.Header=s.a.GetResource("PDC_InterDocNo"),i.DisplayMember="InterMediateVoucherNO",i.ReadOnly=!0,i.Width=120,i.DataType="LINK",i.Click.Subscribe(this,"OnInterDocLink"),null!=(l=a.filter(e=>e.DisplayMember==i.DisplayMember))?(i.DisplayIndex=l.DisplayIndex,i.Width=l.Width):a.length>0&&(i.IsVisible=!1),r.push(i),i=new L.a,i.Header="User",i.DisplayMember="InterMediateDocUser",i.ReadOnly=!0,i.Width=120,i.DataType="LINK",i.Click.Subscribe(this,"OnDocLink"),null!=(l=a.filter(e=>e.DisplayMember==i.DisplayMember))?(i.DisplayIndex=l.DisplayIndex,i.Width=l.Width):a.length>0&&(i.IsVisible=!1),r.push(i),i=new L.a,i.Header="Date",i.DisplayMember="InterMediateDocDate_Key",i.ReadOnly=!0,i.Width=120,i.DataType="LINK",i.Click.Subscribe(this,"OnDocLink"),null!=(l=a.filter(e=>"InterMediateDocDate"==e.DisplayMember))?(i.DisplayIndex=l.DisplayIndex,i.Width=l.Width):a.length>0&&(i.IsVisible=!1),r.push(i),i=new L.a,i.Header="Bounced Doc No",i.DisplayMember="BouncedVoucher",i.ReadOnly=!0,i.Width=110,i.DataType="LINK",i.Click.Subscribe(this,"OnBouncedDocLink"),null!=(l=a.filter(e=>e.DisplayMember==i.DisplayMember))?(i.DisplayIndex=l.DisplayIndex,i.Width=l.Width):a.length>0&&(i.IsVisible=!1),r.push(i),i=new L.a,i.Header="User",i.DisplayMember="BouncedDocUser",i.ReadOnly=!0,i.Width=120,i.DataType="LINK",i.Click.Subscribe(this,"OnDocLink"),null!=(l=a.filter(e=>e.DisplayMember==i.DisplayMember))?(i.DisplayIndex=l.DisplayIndex,i.Width=l.Width):a.length>0&&(i.IsVisible=!1),r.push(i),i=new L.a,i.Header="Date",i.DisplayMember="BouncedDocDate_Key",i.ReadOnly=!0,i.Width=120,i.DataType="LINK",i.Click.Subscribe(this,"OnDocLink"),null!=(l=a.filter(e=>"BouncedDocDate"==e.DisplayMember))?(i.DisplayIndex=l.DisplayIndex,i.Width=l.Width):a.length>0&&(i.IsVisible=!1),r.push(i),this.IsPDCHoldDimension&&(i=new L.a,i.DataType="LISTBOX",i.Header="Hold Dimension",i.ValueMember="HoldDimension_Key",i.DisplayMember="HoldDimension",i.CostCenterID=parseInt(s.a.SessionManager.Preferences.PDCHoldDimension),null!=(l=a.filter(e=>"HoldDimension"==e.DisplayMember))?(i.DisplayIndex=l.DisplayIndex,i.Width=l.Width):(i.DisplayIndex=r.length,i.Width=120),r.push(i),s.a.SessionManager.Preferences.PDCHoldDate.length>0&&(i=new L.a,i.Header="Hold Date",i.DisplayMember="HoldDate",i.ValueMember="HoldDate_Key",i.DataType="DATE",i.ReadOnly=!1,null!=(l=a.filter(e=>"HoldDate"==e.DisplayMember))?(i.DisplayIndex=l.DisplayIndex,i.Width=l.Width):(i.DisplayIndex=r.length,i.Width=90),r.push(i)),s.a.SessionManager.Preferences.PDCHoldRemarks.length>0&&(i=new L.a,i.Header="Hold Remarks",i.DisplayMember="HoldRemarks",i.ReadOnly=!1,null!=(l=a.filter(e=>"HoldRemarks"==e.DisplayMember))?(i.DisplayIndex=l.DisplayIndex,i.Width=l.Width):(i.DisplayIndex=r.length,i.Width=140),r.push(i))),r.sort((e,t)=>e.DisplayIndex-t.DisplayIndex).forEach(e=>{this.PstDocGrid.Columns.push(e)}),this.PstDocGrid.SearchVisible=!0,this.PstDocGrid.FilterVisible=!0,this.PstDocGrid.SearchColStartIndex=1,this.PstDocGrid.AddSearchCols(),e.SetDimensionQuery(),Logger.InfoLog("PostedDocumentViewModel:: Exiting InitColumns")}onClick(){return Object(n.b)(this,void 0,void 0,(function*(){const{AddEditDocumentViewModel:e}=yield Promise.all([i.e(2),i.e(1),i.e(3),i.e(5),i.e(4),i.e(6),i.e(7),i.e(10),i.e(9),i.e(12),i.e(11),i.e(13),i.e(19),i.e(15),i.e(21),i.e(20),i.e(16),i.e(14),i.e(18),i.e(17),i.e(22),i.e(148)]).then(i.bind(null,"1Cra")),{AddEditDocumentComponent:t}=yield Promise.all([i.e(4),i.e(6)]).then(i.bind(null,"MCKn"));if(Logger.InfoLog("PostedDocumentViewModel:: Inside onClick"),null!=this.PstDocGrid.SelectedItem&&!o.e.IsEmpty(this.PstDocGrid.SelectedItem.CostCenterID)){let i=new e(parseInt(this.PstDocGrid.SelectedItem.CostCenterID),"",!0),n={};Object.assign(n,{component:t,params:{obj:i}}),n.title=i.ScreenName,s.a.page.addNewTab(n),s.a.page.setActiveTab(s.a.page.indexOf(i)),i.ScreenObject.DocPrefix.ComboBox.SelectedValue=this.PstDocGrid.SelectedItem.DocPrefix.toString(),i.ScreenObject.DocPrefix.TextBox.Text=this.PstDocGrid.SelectedItem.DocNumber.toString(),i.OnDocPrefixChanged("lostFocus"),i.ScreenObject.FillDocumentPrefix(!0)}Logger.InfoLog("PostedDocumentViewModel:: Exiting onClick")}))}OnDocLink(e){return Object(n.b)(this,void 0,void 0,(function*(){const{AddEditDocumentViewModel:e}=yield Promise.all([i.e(2),i.e(1),i.e(3),i.e(5),i.e(4),i.e(6),i.e(7),i.e(10),i.e(9),i.e(12),i.e(11),i.e(13),i.e(19),i.e(15),i.e(21),i.e(20),i.e(16),i.e(14),i.e(18),i.e(17),i.e(22),i.e(148)]).then(i.bind(null,"1Cra")),{AddEditDocumentComponent:t}=yield Promise.all([i.e(4),i.e(6)]).then(i.bind(null,"MCKn"));if(Logger.InfoLog("PostedDocumentViewModel:: Inside OnDocLink"),null!=this.PstDocGrid.SelectedItem&&!o.e.IsEmpty(this.PstDocGrid.SelectedItem.ConvertedDocNo))try{let i=this.ScreenObject.GetDocDetailsByAccID(parseInt(this.PstDocGrid.SelectedItem.ConvertedAccDocID.toString()));if(null!=i&&i.Tables.length>0&&i.Tables[0].length>0){let n=new e(parseInt(i.Tables[0][0].CCID),i.Tables[0][0].ResourceData.toString(),!0),o={};Object.assign(o,{component:t,params:{obj:n}}),o.title=n.ScreenName,s.a.page.addNewTab(o),s.a.page.setActiveTab(s.a.page.indexOf(n)),n.ScreenObject.DocPrefix.ComboBox.SelectedValue=i.Tables[0][0].Prefix.toString(),n.ScreenObject.DocPrefix.TextBox.Text=i.Tables[0][0].DocNumber.toString(),n.OnDocPrefixChanged("lostFocus"),n.ScreenObject.FillDocumentPrefix(!0)}}catch(n){Logger.ErrorLog("PostedDocumentViewModel","OnLinkClickEvent",n.Message)}Logger.InfoLog("PostedDocumentViewModel:: Exiting OnDocLink")}))}OnInterDocLink(e){return Object(n.b)(this,void 0,void 0,(function*(){const{AddEditDocumentViewModel:e}=yield Promise.all([i.e(2),i.e(1),i.e(3),i.e(5),i.e(4),i.e(6),i.e(7),i.e(10),i.e(9),i.e(12),i.e(11),i.e(13),i.e(19),i.e(15),i.e(21),i.e(20),i.e(16),i.e(14),i.e(18),i.e(17),i.e(22),i.e(148)]).then(i.bind(null,"1Cra")),{AddEditDocumentComponent:t}=yield Promise.all([i.e(4),i.e(6)]).then(i.bind(null,"MCKn"));if(Logger.InfoLog("PostedDocumentViewModel:: Inside OnInterDocLink"),null!=this.PstDocGrid.SelectedItem&&!o.e.IsEmpty(this.PstDocGrid.SelectedItem.InterMediateVoucherNO))try{let i=this.ScreenObject.GetDocDetailsByAccID(parseInt(this.PstDocGrid.SelectedItem.InterMediateDocID.toString()));if(null!=i&&i.Tables.length>0&&i.Tables[0].length>0){let n=new e(parseInt(i.Tables[0][0].CCID),i.Tables[0][0].ResourceData.toString(),!0),o={};Object.assign(o,{component:t,params:{obj:n}}),o.title=n.ScreenName,s.a.page.addNewTab(o),s.a.page.setActiveTab(s.a.page.indexOf(n)),n.ScreenObject.DocPrefix.ComboBox.SelectedValue=i.Tables[0][0].Prefix.toString(),n.ScreenObject.DocPrefix.TextBox.Text=i.Tables[0][0].DocNumber.toString(),n.OnDocPrefixChanged("lostFocus"),n.ScreenObject.FillDocumentPrefix(!0)}}catch(n){Logger.ErrorLog("PostedDocumentViewModel","OnLinkClickEvent",n.Message)}Logger.InfoLog("PostedDocumentViewModel:: Exiting OnInterDocLink")}))}OnBouncedDocLink(e){return Object(n.b)(this,void 0,void 0,(function*(){const{AddEditDocumentViewModel:e}=yield Promise.all([i.e(2),i.e(1),i.e(3),i.e(5),i.e(4),i.e(6),i.e(7),i.e(10),i.e(9),i.e(12),i.e(11),i.e(13),i.e(19),i.e(15),i.e(21),i.e(20),i.e(16),i.e(14),i.e(18),i.e(17),i.e(22),i.e(148)]).then(i.bind(null,"1Cra")),{AddEditDocumentComponent:t}=yield Promise.all([i.e(4),i.e(6)]).then(i.bind(null,"MCKn"));if(Logger.InfoLog("PostedDocumentViewModel:: Inside OnBouncedDocLink"),null!=this.PstDocGrid.SelectedItem&&!o.e.IsEmpty(this.PstDocGrid.SelectedItem.BouncedVoucher))try{let i=this.ScreenObject.GetDocDetailsByAccID(parseInt(this.PstDocGrid.SelectedItem.BouncedVoucherDocID.toString()));if(null!=i&&i.Tables.length>0&&i.Tables[0].length>0){let n=new e(parseInt(i.Tables[0][0].CCID),i.Tables[0][0].ResourceData.toString(),!0),o={};Object.assign(o,{component:t,params:{obj:n}}),o.title=n.ScreenName,s.a.page.addNewTab(o),s.a.page.setActiveTab(s.a.page.indexOf(n)),n.ScreenObject.DocPrefix.ComboBox.SelectedValue=i.Tables[0][0].Prefix.toString(),n.ScreenObject.DocPrefix.TextBox.Text=i.Tables[0][0].DocNumber.toString(),n.OnDocPrefixChanged("lostFocus"),n.ScreenObject.FillDocumentPrefix(!0)}}catch(n){Logger.ErrorLog("PostedDocumentViewModel","OnLinkClickEvent",n.Message)}Logger.InfoLog("PostedDocumentViewModel:: Exiing OnBouncedDocLink")}))}LoadData(){this.ActionSummary="",Logger.InfoLog("PostedDocumentViewModel:: Inside LoadData");let t=0;this.ForeignCurrency.CheckBox.IsChecked&&(t=o.e.IntTryParse(this.ForeignCurrency.ComboBox.SelectedValue));let i=[];i.push(this.FilterOn),i.push(this.SortOn),i.push(this.FromDate.ToString("dd/MMM/yyyy")),i.push(this.ToDate.ToString("dd/MMM/yyyy")),i.push(t),i.push(this.Locations),i.push(this.Divisions),i.push(this.Dimensions),i.push(this.BankID),i.push("1"==this.Status||"2"==this.Status?"429":this.Status),i.push(this.Filter),i.push(e.strSelect),i.push(e.strJoin),i.push(this.DocumentPicked);let n="";"1"==this.Status||"2"==this.Status?n=" and D.BillDate is not null and D.BillDate="+this.Status:"429"==this.Status&&(n=" and (D.BillDate is null or D.BillDate not in(1,2)) "),this.HoldDimFilter>0&&(n+=" and L.dcCCNID"+(parseInt(s.a.SessionManager.Preferences.PDCHoldDimension)-5e4)+"="+this.HoldDimFilter),this.TreeWhere.length>0&&(n+=this.TreeWhere),i.push(n);let a=s.a.document.GetPDCDocuments(i);this.LoadDashData(a),this.DateText=this.FromDate.ToString(s.a.SessionManager.Preferences["Date Format"])+"  -  "+this.ToDate.ToString(s.a.SessionManager.Preferences["Date Format"]),this.MessageVisibility=!1,Logger.InfoLog("PostedDocumentViewModel:: Exiting LoadData")}LoadDashData(e){let t=e.Tables[0];if(Logger.InfoLog("PostedDocumentViewModel:: Inside LoadDashData"),null!=t){e.Columns[0].Contains("Sno")||(e.Columns[0].push("Sno"),e.Columns[0].push("DocDateFormat"),e.Columns[0].push("MaturityDateFormat"),e.Columns[0].push("ChequeDateFormat"),e.Columns[0].push("clrDate"),e.Columns[0].push("clrDate_Key"),e.Columns[0].push("Action"),e.Columns[0].push("Action_Key"),e.Columns[0].push("StatusForDisplay"),e.Columns[0].push("ConvertedDocNo"),e.Columns[0].push("ConvertedAccDocID"),e.Columns[0].push("ConvertedDocDate_Key"),e.Columns[0].push("InterMediateDocDate_Key"),e.Columns[0].push("BouncedDocDate_Key"),e.Columns[0].Contains("InterMediateVoucherNO")||e.Columns[0].push("InterMediateVoucherNO"),e.Columns[0].Contains("InterMediateDocID")||e.Columns[0].push("InterMediateDocID"),e.Columns[0].push("AccIDs"),e.Columns[0].push("BankIDs"),e.Columns[0].push("GroupIDs"),e.Columns[0].Contains("ConvertedDocDate")||e.Columns[0].push("ConvertedDocDate"),e.Columns[0].Contains("InterMediateDocDate")||e.Columns[0].push("InterMediateDocDate"),s.a.SessionManager.Preferences.ContainsKey("PostPenalty")&&"true"==s.a.SessionManager.Preferences.PostPenalty.toLowerCase()&&e.Columns[0].push("Penalty"),this.IsPDCHoldDimension&&!e.Columns[0].Contains("HoldDimension")&&(e.Columns[0].push("HoldDimension"),e.Columns[0].push("HoldDimension_Key"),e.Columns[0].push("HoldDate"),e.Columns[0].push("HoldDate_Key"),e.Columns[0].push("HoldRemarks")));for(let a=0;a<=t.length-1;a++){o.e.IsEmpty(t[a].DocDate)||(t[a].DocDateFormat=s.a.SessionManager.Preferences.ContainsKey("Date Format")&&""!=s.a.SessionManager.Preferences["Date Format"]?new Date(t[a].DocDate.toString()).ToString(s.a.SessionManager.Preferences["Date Format"]):new Date(t[a].DocDate.toString()).ToString("dd/MMM/yyyy")),o.e.IsEmpty(t[a].ChequeMaturityDate)||(t[a].MaturityDateFormat=s.a.SessionManager.Preferences.ContainsKey("Date Format")&&""!=s.a.SessionManager.Preferences["Date Format"]?new Date(t[a].ChequeMaturityDate.toString()).ToString(s.a.SessionManager.Preferences["Date Format"]):new Date(t[a].ChequeMaturityDate.toString()).ToString("dd/MMM/yyyy")),e.Columns[0].Contains("ChequeDate")&&!o.e.IsEmpty(t[a].ChequeDate)&&(t[a].ChequeDateFormat=s.a.SessionManager.Preferences.ContainsKey("Date Format")&&""!=s.a.SessionManager.Preferences["Date Format"]?new Date(t[a].ChequeDate.toString()).ToString(s.a.SessionManager.Preferences["Date Format"]):new Date(t[a].ChequeDate.toString()).ToString("dd/MMM/yyyy")),this.IsPDCHoldDimension&&(e.Columns[0].Contains("HoldDate_Key")&&null!=t[a].HoldDate_Key&&(t[a].HoldDate=new Date(t[a].HoldDate_Key).ToString(s.a.SessionManager.Preferences["Date Format"])),e.Columns[0].Contains("HoldDimension_Old")||e.Columns[0].push("HoldDimension_Old"),t[a].HoldDimension_Old=t[a].HoldDimension_Key),t[a].Sno=a+1,o.e.IsEmpty(t[a].BillDate)||(t[a].clrDate_Key=this.PostonconversionDate?new Date:new Date(t[a].BillDate)),"429"==t[a].StatusID.toString()&&(e.Columns[0].Contains("BillNo")&&"1"==t[a].BillNo.toString()?t[a].Status=s.a.GetResource("Replaced"):e.Columns[0].Contains("BillNo")&&"2"==t[a].BillNo.toString()&&(t[a].Status=s.a.GetResource("ReplacedPartial")));try{"PDC"==t[a].Status.toString()&&(this.PostonconversionDate?t[a].clrDate=s.a.SessionManager.Preferences.ContainsKey("Date Format")&&""!=s.a.SessionManager.Preferences["Date Format"]?(new Date).ToString(s.a.SessionManager.Preferences["Date Format"]):(new Date).ToString("dd/MMM/yyyy"):o.e.IsEmpty(t[a].BillDate.toString())||(t[a].clrDate=s.a.SessionManager.Preferences.ContainsKey("Date Format")&&""!=s.a.SessionManager.Preferences["Date Format"]?new Date(t[a].BillDate.toString()).ToString(s.a.SessionManager.Preferences["Date Format"]):new Date(t[a].BillDate.toString()).ToString("dd/MMM/yyyy")))}catch(i){Logger.ErrorLog("PostedDocumentViewModel","LoadDashData",i.Message)}if("True"==t[a].IsNegative.toString()){let e=t[a].BankAccountID_Key.toString(),i=t[a].BankAccountID.toString();t[a].BankAccountID_Key=t[a].AccountID_Key.toString(),t[a].BankAccountID=t[a].AccountID.toString(),t[a].AccountID_Key=e,t[a].AccountID=i}!e.Columns[0].Contains("DocumentType")||o.e.IsEmpty(t[a].DocumentType)||16!=parseInt(t[a].DocumentType.toString())&&19!=parseInt(t[a].DocumentType.toString())&&14!=parseInt(t[a].DocumentType.toString())||e.Columns[0].Contains("BankID")&&!o.e.IsEmpty(t[a].BankID)&&parseInt(t[a].BankID.toString())>0&&(t[a].BankAccountID_Key=parseInt(t[a].BankID.toString()),t[a].BankAccountID=t[a].BankName.toString()),e.Columns[0].Contains("ConvertedVoucherNO")&&!o.e.IsEmpty(t[a].ConvertedVoucherNO)?(t[a].ConvertedDocNo=t[a].ConvertedVoucherNO,o.e.IsEmpty(t[a].ConvertedDocDate)||(t[a].ConvertedDocDate_Key=new Date(t[a].ConvertedDocDate.toString()).ToString(s.a.SessionManager.Preferences["Date Format"]))):t[a].ConvertedDocDate_Key=null,e.Columns[0].Contains("ConvertedDocID")&&!o.e.IsEmpty(t[a].ConvertedDocID)&&(t[a].ConvertedAccDocID=t[a].ConvertedDocID),e.Columns[0].Contains("InterMediateVoucherNO")&&!o.e.IsEmpty(t[a].InterMediateVoucherNO)?(t[a].InterMediateVoucherNO=t[a].InterMediateVoucherNO,o.e.IsEmpty(t[a].InterMediateDocDate)||(t[a].InterMediateDocDate_Key=new Date(t[a].InterMediateDocDate.toString()).ToString(s.a.SessionManager.Preferences["Date Format"]))):t[a].InterMediateDocDate_Key=null,t[a].BouncedDocDate_Key=e.Columns[0].Contains("BouncedDocDate")&&!o.e.IsEmpty(t[a].BouncedDocDate)?new Date(t[a].BouncedDocDate.toString()).ToString(s.a.SessionManager.Preferences["Date Format"]):null,e.Columns[0].Contains("InterMediateDocID")&&!o.e.IsEmpty(t[a].InterMediateDocID)&&(t[a].InterMediateDocID=t[a].InterMediateDocID)}let n=[];for(let i=0;i<t.length;i++)if(!n.Contains(t[i])){let s,a=0,r="",l="",c="";if(e.Columns[0].Contains("RefNodeID")&&(s=t.filter(e=>400==e.RefCCID&&e.RefNodeID==t[i].AccDocDetailsID),s.length>0)){r=l=c="";for(let e=0;e<s.length;e++)r+=s[e].AccDocDetailsID.toString()+",",c+=s[e].AccountID_Key.toString()+",",l+=s[e].BankAccountID_Key.toString()+",",n.push(s[e]);t[i].GroupIDs=r,t[i].AccIDs=c,t[i].BankIDs=l,s=t.filter(e=>e.AccDocDetailsID==t[i].AccDocDetailsID.toString()),s.length>1&&(t[i]!=s[1]&&"439"==s[1].StatusID.toString()?(t[i].StatusID=s[1].StatusID,t[i].Status=s[1].Status,n.push(s[1])):t[i]==s[1]&&"439"==s[0].StatusID.toString()&&(t[i].StatusID=s[0].StatusID,t[i].Status=s[0].Status,n.push(s[0])));continue}if(s=t.filter(e=>e.ChequeNumber==o.e.StringValue(t[i].ChequeNumber).toString().replace("'","''")&&e.VoucherNo==o.e.StringValue(t[i].VoucherNo).toString()&&e.BankAccountID_Key==o.e.StringValue(t[i].BankAccountID_Key).toString()),s.length>1){let e=new Array;e.push(parseInt(o.e.String(s[0].AccountID_Key)));for(let t=1;t<s.length;t++)o.e.IsEmpty(s[t].Amount)||("True"==s[t].IsNegative.toString()?a-=parseFloat(s[t].Amount.toString()):a+=parseFloat(s[t].Amount.toString())),r+=s[t].AccDocDetailsID.toString()+",",c+=s[t].AccountID_Key.toString()+",",e.Contains(parseInt(s[t].AccountID_Key.toString()))||(l+=s[t].AccountID.toString()+","),e.push(parseInt(s[t].AccountID_Key.toString())),n.push(s[t]);s[0].GroupIDs=r,s[0].AccIDs=c,s[0].Amount=o.e.IsEmpty(s[0].Amount)?a:parseFloat(s[0].Amount.toString())+a,s[0].AccountID=s[0].AccountID.toString()+l}}for(let e=0;e<n.length;e++)t.Remove(n[e]);this.PstDocGrid.Table=t,this.PstDocGrid.TableColumns=e.Columns[0],this.PstDocGrid.setRowid(),this.PstDocGrid.UpdateTotals()}Logger.InfoLog("PostedDocumentViewModel:: Exiting LoadDashData")}ButtonSave(e){if(Logger.InfoLog("PostedDocumentViewModel:: Inside ButtonSave sender ="+e.toString()),this.DisplayMessage="","Save"==e){let e="",t="";for(let i=0;i<=this.PstDocGrid.Table.length-1;i++)if(""!=o.e.StringValue(this.PstDocGrid.Table[i].Action).toString()&&"100"!=this.PstDocGrid.Table[i].Action.toString()){let t,n;if("1"==this.PstDocGrid.Table[i].Action.toString()&&this.PstDocGrid.TableColumns.Contains("HoldDate_Key")&&!o.e.IsEmpty(this.PstDocGrid.Table[i].HoldDate_Key)&&o.e.isValidDate(this.PstDocGrid.Table[i].HoldDate_Key.toString())&&!o.e.IsEmpty(this.PstDocGrid.Table[i].clrDate_Key)&&o.e.isValidDate(this.PstDocGrid.Table[i].clrDate_Key.toString())&&new Date(this.PstDocGrid.Table[i].clrDate_Key.toString())<new Date(this.PstDocGrid.Table[i].HoldDate_Key.toString()))return n=this.PstDocGrid.Table[i].HoldDate_Key.toString(),n=this.PstDocGrid.Table[i].clrDate_Key.toString(),this.Setselectedrow(i),this.DisplayMessage="Converted date can not be less than hold date at row no:"+this.PstDocGrid.Table[i].Sno.toString(),void(this.MessageVisibility=!0);if(o.e.isValidDate(this.PstDocGrid.Table[i].clrDate_Key.toString())&&new Date(this.PstDocGrid.Table[i].clrDate_Key.toString())<s.a.SessionManager.AccountingDate)return this.Setselectedrow(i),this.DisplayMessage="Converted date can not be less than Accounting Date at row no:"+this.PstDocGrid.Table[i].Sno.toString(),void(this.MessageVisibility=!0);if(t=s.a.SessionManager.Preferences.ContainsKey("Lock Data Between"),"1"!=s.a.SessionManager.RoleID&&s.a.SessionManager.Preferences.ContainsKey("Lock Data Between")&&t&&Object(a.j)(s.a.SessionManager.Preferences["Lock Data Between"])&&o.e.isValidDate(this.PstDocGrid.Table[i].clrDate_Key.toString())&&(n=new Date(this.PstDocGrid.Table[i].clrDate_Key.toString()),n.Date>=new Date(s.a.SessionManager.Preferences.LockDataFromDate).Date&&n.Date<=new Date(s.a.SessionManager.Preferences.LockDataToDate).Date))return this.DisplayMessage="Document Date Locked",void(this.MessageVisibility=!0);if(""!=o.e.StringValue(this.PstDocGrid.Table[i].BankIDs).toString()){let t=this.PstDocGrid.Table[i].GroupIDs.toString().split(","),n=this.PstDocGrid.Table[i].AccIDs.toString().split(","),s=this.PstDocGrid.Table[i].BankIDs.toString().split(",");for(let a=0;a<t.length-1;a++)e+='<Row ID="'+t[a]+'" ',e+=' StatusID="369" ',"4"==this.PstDocGrid.Table[i].Action.toString()?e+='ACTION="0"  IsReplace="1" ':"5"==this.PstDocGrid.Table[i].Action.toString()?e+='ACTION="0"  IsReplace="2" ':e+='ACTION="'+this.PstDocGrid.Table[i].Action.toString()+'" ',""!=o.e.StringValue(this.PstDocGrid.Table[i].clrDate_Key).toString()&&(e+='PostedDate="'+new Date(this.PstDocGrid.Table[i].clrDate_Key.toString()).ToString("dd/MMM/yyyy")+'" '),e+='CostCenterID="'+this.PstDocGrid.Table[i].CostCenterID.toString()+'" ',e+='VoucherNo="'+this.PstDocGrid.Table[i].VoucherNo.toString()+'" ',"19"==o.e.StringValue(this.PstDocGrid.Table[i].DocumentType).toString()||"16"==o.e.StringValue(this.PstDocGrid.Table[i].DocumentType).toString()?"1"==this.PstDocGrid.Table[i].Action.toString()?(e+='CreditAccountID="'+n[a]+'" ',e+='DebitAccountID="'+s[a]+'" '):(e+='CreditAccountID="'+s[a]+'" ',e+='DebitAccountID="'+n[a]+'" '):"1"==this.PstDocGrid.Table[i].Action.toString()?(e+='CreditAccountID="'+s[a]+'" ',e+='DebitAccountID="'+n[a]+'" '):(e+='DebitAccountID="'+s[a]+'" ',e+='CreditAccountID="'+n[a]+'" '),e+='ACTUAL="'+n[a]+'" ',e+="/>";continue}if(e+='<Row ID="'+this.PstDocGrid.Table[i].AccDocDetailsID.toString()+'" ',e+=' StatusID="369" ',"4"==this.PstDocGrid.Table[i].Action.toString()?e+='ACTION="0"  IsReplace="1" ':"5"==this.PstDocGrid.Table[i].Action.toString()?e+='ACTION="0"  IsReplace="2" ':e+='ACTION="'+this.PstDocGrid.Table[i].Action.toString()+'" ',""!=o.e.StringValue(this.PstDocGrid.Table[i].clrDate_Key).toString()&&(e+='PostedDate="'+new Date(this.PstDocGrid.Table[i].clrDate_Key.toString()).ToString("dd/MMM/yyyy")+'" '),e+='CostCenterID="'+this.PstDocGrid.Table[i].CostCenterID.toString()+'" ',e+='VoucherNo="'+this.PstDocGrid.Table[i].VoucherNo.toString()+'" ',"19"==o.e.StringValue(this.PstDocGrid.Table[i].DocumentType).toString()?"1"==this.PstDocGrid.Table[i].Action.toString()?(e+='CreditAccountID="'+this.PstDocGrid.Table[i].AccountID_Key.toString()+'" ',e+='DebitAccountID="'+this.PstDocGrid.Table[i].BankAccountID_Key.toString()+'" '):(e+='CreditAccountID="'+this.PstDocGrid.Table[i].BankAccountID_Key.toString()+'" ',e+='DebitAccountID="'+this.PstDocGrid.Table[i].AccountID_Key.toString()+'" ',this.PstDocGrid.TableColumns.Contains("Penalty")&&!o.e.IsEmpty(this.PstDocGrid.Table[i].Penalty)&&parseFloat(this.PstDocGrid.Table[i].Penalty.toString())>0&&(e+='Penalty="'+this.PstDocGrid.Table[i].Penalty.toString()+'" ')):"1"==this.PstDocGrid.Table[i].Action.toString()?(e+='CreditAccountID="'+this.PstDocGrid.Table[i].BankAccountID_Key.toString()+'" ',e+='DebitAccountID="'+this.PstDocGrid.Table[i].AccountID_Key.toString()+'" '):(e+='DebitAccountID="'+this.PstDocGrid.Table[i].BankAccountID_Key.toString()+'" ',e+='CreditAccountID="'+this.PstDocGrid.Table[i].AccountID_Key.toString()+'" ',this.PstDocGrid.TableColumns.Contains("Penalty")&&!o.e.IsEmpty(this.PstDocGrid.Table[i].Penalty)&&parseFloat(this.PstDocGrid.Table[i].Penalty.toString())>0&&(e+='Penalty="'+this.PstDocGrid.Table[i].Penalty.toString()+'" ')),e+='ACTUAL="'+this.PstDocGrid.Table[i].ActDr.toString()+'" ',this.IsPDCHoldDimension&&this.PstDocGrid.TableColumns.Contains("HoldDimension_Key")&&null!=this.PstDocGrid.Table[i].HoldDimension_Key&&1!=parseInt(this.PstDocGrid.Table[i].HoldDimension_Key)&&(e+='IsHold="1" '),e+="/>",""!=o.e.StringValue(this.PstDocGrid.Table[i].GroupIDs).toString()){let t=this.PstDocGrid.Table[i].GroupIDs.toString().split(","),n=this.PstDocGrid.Table[i].AccIDs.toString().split(",");for(let s=0;s<t.length-1;s++)e+='<Row ID="'+t[s]+'" ',e+=' StatusID="369" ',"4"==this.PstDocGrid.Table[i].Action.toString()?e+='ACTION="0"  IsReplace="1" ':"5"==this.PstDocGrid.Table[i].Action.toString()?e+='ACTION="0"  IsReplace="2" ':e+='ACTION="'+this.PstDocGrid.Table[i].Action.toString()+'" ',o.e.IsEmpty(this.PstDocGrid.Table[i].clrDate_Key)||(e+='PostedDate="'+new Date(this.PstDocGrid.Table[i].clrDate_Key.toString()).ToString("dd/MMM/yyyy")+'" '),e+='CostCenterID="'+this.PstDocGrid.Table[i].CostCenterID.toString()+'" ',e+='VoucherNo="'+this.PstDocGrid.Table[i].VoucherNo.toString()+'" ',"19"==o.e.StringValue(this.PstDocGrid.Table[i].DocumentType).toString()?"1"==this.PstDocGrid.Table[i].Action.toString()?(e+='CreditAccountID="'+n[s]+'" ',e+='DebitAccountID="'+this.PstDocGrid.Table[i].BankAccountID_Key.toString()+'" '):(e+='CreditAccountID="'+this.PstDocGrid.Table[i].BankAccountID_Key.toString()+'" ',e+='DebitAccountID="'+n[s]+'" '):"1"==this.PstDocGrid.Table[i].Action.toString()?(e+='CreditAccountID="'+this.PstDocGrid.Table[i].BankAccountID_Key.toString()+'" ',e+='DebitAccountID="'+n[s]+'" '):(e+='DebitAccountID="'+this.PstDocGrid.Table[i].BankAccountID_Key.toString()+'" ',e+='CreditAccountID="'+n[s]+'" '),e+='ACTUAL="'+n[s]+'" ',e+=' Dupl="'+this.PstDocGrid.Table[i].AccDocDetailsID.toString()+'" ',this.IsPDCHoldDimension&&this.PstDocGrid.TableColumns.Contains("HoldDimension_Key")&&null!=this.PstDocGrid.Table[i].HoldDimension_Key&&1!=parseInt(this.PstDocGrid.Table[i].HoldDimension_Key)&&(e+='IsHold="1" '),e+="/>"}}else this.IsPDCHoldDimension&&this.PstDocGrid.TableColumns.Contains("HoldDimension_Key")&&null!=this.PstDocGrid.Table[i].HoldDimension_Key&&(1==parseInt(this.PstDocGrid.Table[i].HoldDimension_Key)&&parseInt(this.PstDocGrid.Table[i].HoldDimension_Old)==parseInt(this.PstDocGrid.Table[i].HoldDimension_Key)||(t+='<Row ID="'+this.PstDocGrid.Table[i].AccDocDetailsID.toString()+'" ',t+='HoldDimension="'+this.PstDocGrid.Table[i].HoldDimension_Key.toString()+'" ',1!=parseInt(this.PstDocGrid.Table[i].HoldDimension_Key)&&(this.PstDocGrid.TableColumns.Contains("HoldDate_Key")&&null!=this.PstDocGrid.Table[i].HoldDate_Key&&(t+='HoldDate="'+new Date(this.PstDocGrid.Table[i].HoldDate_Key).ToString("dd-MMM-yyyy")+'" '),this.PstDocGrid.TableColumns.Contains("HoldRemarks")&&(t+='HoldRemarks="'+this.PstDocGrid.Table[i].HoldRemarks.toString()+'" ')),t+="/>"));if(e.length>0||t.length>0){e="<XML>"+e,e+="</XML>",t.length>0&&(t="<XML>"+t,t+="</XML>");let i=s.a.document.SetPostDocuments(e.toString(),t.toString(),this.PostonconversionDate,this.ScreenObject.LockWhere);null!=i&&i.Tables.length>0&&i.Tables[i.Tables.length-1].length>0&&i.Columns[i.Tables.length-1].Contains("ErrorMessage")&&(this.DisplayMessage=i.Tables[i.Tables.length-1][0].ErrorMessage.toString(),i.Tables.length>2&&i.Tables[i.Tables.length-2].length>0&&(this.DisplayMessage=this.DisplayMessage+" :: ",i.Tables[i.Tables.length-2].forEach(e=>{this.DisplayMessage=this.DisplayMessage+e.VoucherNo.toString()+","}),this.DisplayMessage=this.DisplayMessage.TrimEnd(",")+" Documents Locked"),i.Tables.length>=3&&i.Tables[i.Tables.length-3].forEach(e=>{if(i.Columns[i.Tables.length-3].Contains("AccDocDetailsID")){let t=this.PstDocGrid.Table.filter(t=>t.AccDocDetailsID==e.AccDocDetailsID);t.length>0&&(t[0].ConvertedDocNo=o.e.String(e.VoucherNo),t[0].ConvertedAccDocID=o.e.String(e.ConvertedAccDocID),t[0].InterMediateVoucherNO=o.e.String(e.InterMediateVoucherNO),t[0].InterMediateDocID=o.e.String(e.InterMediateDocID),t[0].Action="",t[0].clrDate="",t[0].StatusID=e.StatusID,i.Columns[i.Tables.length-3].Contains("IsReplace")&&!o.e.IsEmpty(e.IsReplace)?"1"==o.e.String(e.IsReplace)?t[0].Status=s.a.GetResource("Replaced"):"2"==e.IsReplace.toString()&&(t[0].Status=s.a.GetResource("ReplacedPartial")):t[0].Status=o.e.String(e.ConvertedStatus),this.PstDocGrid.updateRow(t[0]))}})),this.MessageVisibility=!0}}else if("Refresh"==e)if(null!=this.PDCDialog)s.a.page.ShowDialog(this.PDCDialog,A.a);else{let e=new y;e.PostedDocumentDialogViewModel_1(this),s.a.page.ShowDialog(e,A.a)}else if("Customize"==e);else if("CustomizePrint"==e);else if("Export"==e){this.MessageVisibility=!0,this.DisplayMessage="Exporting data please wait...";let e=this.GetExportHTML();const t=new Blob([e],{type:"text/plain;charser=utf-8"});V.saveAs(t,this.DisplayName+"_XlsExport_"+(new Date).getTime()+".xls")}Logger.InfoLog("PostedDocumentViewModel:: exiting ButtonSave sender ="+e.toString())}Setselectedrow(e){this.PstDocGrid.SelectedItem=this.PstDocGrid.Table[e]}selectConvert(e){if(Logger.InfoLog("PostedDocumentViewModel:: inside selectConvert "),e)for(let t=0;t<=this.PstDocGrid.Table.length-1;t++)o.e.IsEmpty(this.PstDocGrid.Table[t].StatusID)||370!=parseInt(this.PstDocGrid.Table[t].StatusID.toString())||o.e.IsEmpty(this.PstDocGrid.Table[t].ChequeMaturityDate)||new Date(this.PstDocGrid.Table[t].ChequeMaturityDate.toString()).Date!=(new Date).Date||(this.PstDocGrid.Table[t].Action=this.SelectMaturityDate?"1":"");else for(let t=0;t<=this.PstDocGrid.Table.length-1;t++)!o.e.IsEmpty(this.PstDocGrid.Table[t].StatusID)&&370==parseInt(this.PstDocGrid.Table[t].StatusID.toString())&&!o.e.IsEmpty(this.PstDocGrid.Table[t].ChequeMaturityDate)&&new Date(this.PstDocGrid.Table[t].ChequeMaturityDate.toString()).Date<=(new Date).Date&&(this.PstDocGrid.Table[t].Action=this.SelectLessThanMaturityDate?"1":"");Logger.InfoLog("PostedDocumentViewModel:: exiting selectConvert ")}GetExportHTML(){Logger.InfoLog("PostedDocumentViewModel:: inside GetExportHTML ");let e="",t="";e+="<html><meta charset='utf-8' /><body style='color:blac;background-color:white;'>",t+=".hdr{text-align:cente; padding:5px; background-color:#4F81BD;color:white;font-family:Arial;font-size:11pt} ",t+=".grp{padding:2p; background-color:#87CEEB; color:#FFFCF7;font-family:arial; font-size:10pt;}",t+=".tot{background-color:whit; color:red;font-family:arial; font-weight:bold; font-size:8pt;}",t+=".alt{background-color:whitesmok; color:black; font-family:arial; font-size:9pt; align:right;}",e+="<style>"+t.toString()+"</style>";let i,n=0;for(let s=0;s<this.PstDocGrid.Columns.length;s++)n+=this.PstDocGrid.Columns[s].Width;e+="<table>",e+="\r\n<tr><td align='center'><h2>",e+=s.a.SessionManager.CompanyName,e+="</h2></td></tr>",e+="\r\n<tr><td align='center'><h3 style='vertical-align:middl;'>",e+=this.DisplayName,e+="</h3></td></tr>",e+="\r\n<tr><td align='center'>",e+=" From :  "+this.FromDate.ToString(s.a.SessionManager.Preferences["Date Format"]),e+=" &nbs;&nbsp;&nbsp;To :  "+this.ToDate.ToString(s.a.SessionManager.Preferences["Date Format"]),e+="</td></tr>",e+="<tr><td style='padding-top:10p;'><table border=1 width='"+n+"' style='border-collapse:collapse;  font-family:arial; font-size:9pt;' >",e+="<COLGROUP>";for(let s=0;s<this.PstDocGrid.Columns.length;s++)o.e.IsEmpty(this.PstDocGrid.Columns[s].DataType)||"FLOAT"!=this.PstDocGrid.Columns[s].DataType?e+="<COL style=''>":e+="<COL style='text-align:righ;'>";e+="</COLGROUP>",e+="<tr style=''>";for(let s=0;s<this.PstDocGrid.Columns.length;s++)e+="<th class='hdr' width='"+this.PstDocGrid.Columns[s].Width,e+="' >",e+=this.PstDocGrid.Columns[s].Header,e+="</th>";e+="</tr>";for(let s=0;s<this.PstDocGrid.Table.length;s++){e+="<tr",s%2==1&&(e+=" class=alt"),e+=">";for(let t=0;t<this.PstDocGrid.Columns.length;t++)e+="<td",o.e.IsEmpty(this.PstDocGrid.Columns[t].DataType)||"FLOAT"!=this.PstDocGrid.Columns[t].DataType?e+=" align='left'":e+=" align='right'",e+=">",i=o.e.IsEmpty(this.PstDocGrid.Columns[t].DataType)||"PactComboBox"!==this.PstDocGrid.Columns[t].DataType?this.PstDocGrid.Columns[t].DisplayMember:this.PstDocGrid.Columns[t].ValueBinding+"_Key",this.PstDocGrid.TableColumns.Contains(i)&&("ChequeNumber"==i&&!o.e.IsEmpty(this.PstDocGrid.Table[s][i])&&this.PstDocGrid.Table[s][i].toString().startsWith("0")?e+="'"+this.PstDocGrid.Table[s][i].toString():e+=o.e.String(this.PstDocGrid.Table[s][i])),e+="</td>";e+="</tr>"}return e+="</table>",e+="</td></tr></table>",e+="</body><html>",Logger.InfoLog("PostedDocumentViewModel:: exiting GetExportHTML "),e}}return e.strSelect="",e.strJoin="",e})()}}]);