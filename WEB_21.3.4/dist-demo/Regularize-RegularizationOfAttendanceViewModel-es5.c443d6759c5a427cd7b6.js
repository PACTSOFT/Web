function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var n,i=_getPrototypeOf(e);if(t){var a=_getPrototypeOf(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[74],{AfpE:function(e,t,n){"use strict";n.r(t),n.d(t,"RegularizationOfAttendanceViewModel",(function(){return c}));var i=n("ScVY"),a=n("4HhE"),s=n("JIg3"),o=n("EQd/"),r=n("Lp6j"),u=n("Do2H"),l=n("zUnb"),c=function(e){_inherits(n,e);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.call(this)).ButtonClick=new a.b,e.SelectedEmpID=0,e.dtDay=new Date,e.dtpCheckInDate=new s.c(0),e.dtpCheckInTime=new s.b,e.dtpCheckOutDate=new s.c(0),e.dtpCheckOutTime=new s.b,e.txtRemarks=new o.d(0),e.DocID=0,e}return _createClass(n,[{key:"RegularizationOfAttendanceViewModel",value:function(e){Logger.InfoLog("RegularizationOfAttendanceViewModel::Entering RegularizationOfAttendanceViewModel()"),this.DisplayMessage="",this.SelectedEmpID=parseInt(e[1]),this.dtDay=new Date(e[2]),this.ButtonClick.Subscribe(this,"Button_Click"),this.dtpCheckInDate.CustomFormat=u.a.SessionManager.Preferences["Date Format"],this.dtpCheckOutDate.CustomFormat=u.a.SessionManager.Preferences["Date Format"],this.lblTotalTime="00.00",this.dtpCheckInTime.CustomFormat="HH:mm",this.dtpCheckInTime.ShowTimePicker=!0,this.dtpCheckOutTime.CustomFormat="HH:mm",this.dtpCheckOutTime.ShowTimePicker=!0,this.dtpCheckInDate.SelectedDateChanged.Subscribe(this,"onDateChanged"),this.dtpCheckInTime.SelectedDateChanged.Subscribe(this,"onDateChanged"),this.dtpCheckOutDate.SelectedDateChanged.Subscribe(this,"onDateChanged"),this.dtpCheckOutTime.SelectedDateChanged.Subscribe(this,"onDateChanged");var t=u.a.common.GetDataTable("RegAtt003",this.SelectedEmpID.toString()+"~"+this.dtDay.ToString("dd MMM yyyy"));null!=t&&t.length>0&&(this.DocID=parseInt(t[0].DocID),this.lblDocNo=t[0].VoucherNo.toString(),this.lblDocDate=new Date(t[0].VoucherDate).ToString(u.a.SessionManager.Preferences["Date Format"]),this.lblEmpCode=t[0].EmpCode.toString(),this.lblEmpName=t[0].EmpName.toString(),this.dtpCheckInDate.Date=r.e.IsEmpty(t[0].CheckInDate)?null:new Date(t[0].CheckInDate),this.dtpCheckInTime.Date=r.e.IsEmpty(t[0].CheckInTime)?null:new Date(t[0].CheckInTime),this.dtpCheckOutDate.Date=r.e.IsEmpty(t[0].CheckOutDate)?null:new Date(t[0].CheckOutDate),this.dtpCheckOutTime.Date=r.e.IsEmpty(t[0].CheckOutTime)?null:new Date(t[0].CheckOutTime)),Logger.InfoLog("RegularizationOfAttendanceViewModel::Exiting RegularizationOfAttendanceViewModel()")}},{key:"onDateChanged",value:function(e){if(null!=e){var t,n,i=null,a=null,s=new Date;i=new Date(this.dtpCheckInDate.Date),s=new Date(this.dtpCheckInTime.Date),t=new Date(i.getFullYear(),i.getMonth(),i.getDay(),s.getHours(),s.getMinutes(),s.getSeconds()),this.dtpCheckInTime.Date=t,a=new Date(this.dtpCheckOutDate.Date),s=new Date(this.dtpCheckOutTime.Date),n=new Date(a.getFullYear(),a.getMonth(),a.getDay(),s.getHours(),s.getMinutes(),s.getSeconds()),this.dtpCheckOutTime.Date=n,this.lblTotalTime=null!=i&&null!=t&&null!=a&&null!=n?this.CalculateTotalTime(i,t,a,n):"00.00"}}},{key:"Button_Click",value:function(e){if(Logger.InfoLog("RegularizationOfAttendanceViewModel::Entering Button_Click"),"OK"==e.toString()){if(!this.ValidateScreen())return;if(!confirm("Are you sure want to proceed.?"))return;var t=u.a.common.ExecuteQuery_ReturnString("RegAtt002",this.dtpCheckInDate.Date.ToString("dd/MMM/yyyy")+"~"+this.dtpCheckInTime.Date.ToString("dd/MMM/yyyy HH:mm")+"~"+this.dtpCheckOutDate.Date.ToString("dd/MMM/yyyy")+"~"+this.dtpCheckOutTime.Date.ToString("dd/MMM/yyyy HH:mm")+"~"+this.lblTotalTime+"~"+this.DocID+"~"+this.lblDocNo+"~"+this.txtRemarks.Text);if(t.Trim().length>0)return this.DisplayMessage="Error : "+t,void(this.MessageVisibility=!0);var n=u.a.common.GetDataTable("RegAtt004",this.DocID.toString());null!=n&&n.length>0&&parseInt(n[0].WorkFlowID)>0&&u.a.common.ExecuteQuery_ReturnString("RegAtt005",this.DocID.toString()),this.DialogResult=!0}else"Cancel"==e.toString()&&(this.DialogResult=!1);u.a.page.HideDialog(),Logger.InfoLog("RegularizationOfAttendanceViewModel::Exiting Button_Click")}},{key:"CalculateTotalTime",value:function(e,t,n,i){if(t=new Date(e.getFullYear(),e.getMonth(),e.getDate(),t.getHours(),t.getMinutes(),t.getSeconds()),(i=new Date(n.getFullYear(),n.getMonth(),n.getDate(),i.getHours(),i.getMinutes(),i.getSeconds()))<t)return"00.00";var a=i.Subtract(t);return a.Hours<0&&(a=a.add(l.TimeSpan.FromDays(1))),(24*a.Days+a.Hours).PrefixZero(2)+"."+a.Minutes.PrefixZero(2)}},{key:"SaveStatus",value:function(e,t,n){!(arguments.length>3&&void 0!==arguments[3])||arguments[3];var i=null,a="";null!=(i=this.SetDocStatus(e,t,n,(new Date).Date(),this.txtRemarks.Text,!0,""))&&i.Tables.length>0&&i.Tables[0].length>0&&i.Columns[0].Contains("status")&&(a+="Document Status - ["+i.Tables[0][0].status.toString()+"] \r\n"),null!=i&&i.Tables.length>0&&i.Tables[i.Tables.length-1].length>0&&i.Columns[i.Columns.length-1].Contains("ErrorMessage")&&(a+=i.Tables[i.Tables.length-1][0].ErrorMessage.toString()),this.DisplayMessage=a,this.MessageVisibility=!0}},{key:"SetDocStatus",value:function(e,t,n,i,a,s,o){Logger.InfoLog("VoucherGenerator:: Inside SetDocStatus");var r=[];r.push(e),r.push(null!=a?a:""),r.push(i.ToString("dd/MMM/yyyy")),r.push(!0),r.push(this.DocID),r.push(40089),r.push(t),r.push(n),r.push(s),r.push(o),r.push(u.a.SessionManager.CompanyGUID),r.push(u.a.SessionManager.UserName),r.push(u.a.SessionManager.UserID),r.push(u.a.SessionManager.RoleID),r.push(u.a.SessionManager.LanguageID);var l=u.a.document.SetDocStatus(r);return Logger.InfoLog("VoucherGenerator:: Exiting SetDocStatus"),l}},{key:"ValidateScreen",value:function(){if(null==this.dtpCheckInDate.Date||r.e.IsEmpty(this.dtpCheckInDate.Date))return this.DisplayMessage="Select Check-in Date",this.dtpCheckInDate.SetFocus=!0,this.MessageVisibility=!0,!1;if(null==this.dtpCheckInTime.Date||r.e.IsEmpty(this.dtpCheckInTime.Date))return this.DisplayMessage="Select Check-in Time",this.dtpCheckInTime.SetFocus=!0,this.MessageVisibility=!0,!1;if(null==this.dtpCheckOutDate.Date||r.e.IsEmpty(this.dtpCheckOutDate.Date))return this.DisplayMessage="Select Check-out Date",this.dtpCheckOutDate.SetFocus=!0,this.MessageVisibility=!0,!1;if(null==this.dtpCheckOutTime.Date||r.e.IsEmpty(this.dtpCheckOutTime.Date))return this.DisplayMessage="Select Check-out Time",this.dtpCheckOutTime.SetFocus=!0,this.MessageVisibility=!0,!1;if(parseFloat(this.lblTotalTime)>24)return this.DisplayMessage="Total time can not exceed 24 Hours",this.dtpCheckOutTime.SetFocus=!0,this.MessageVisibility=!0,!1;var e=u.a.common.GetDataTable("RegAtt006","");if(null!=e&&e.length>0&&"True"==r.e.String(e[0].PrefValue)&&this.txtRemarks.Text.length<=0)return this.DisplayMessage="Remarks Mandatory",this.txtRemarks.SetFocus=!0,this.MessageVisibility=!0,!1;var t=u.a.common.GetDataTable("RegAtt001",this.SelectedEmpID.toString()+"~"+this.dtpCheckInDate.Date.ToString("dd/MMM/yyyy")+"~"+this.DocID);return!(null!=t&&t.length>0&&(this.DisplayMessage="Data already existed on the Selected Date for the Employee @ Voucher No. : "+t.Rows[0].VoucherNo,this.dtpCheckInDate.SetFocus=!0,this.MessageVisibility=!0,1))}}]),n}(i.b)}}]);