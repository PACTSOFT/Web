(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{C58A:function(t,e,i){"use strict";i.r(e),i.d(e,"RecurAppointmentViewModel",(function(){return d}));var s=i("Do2H"),a=i("Lp6j"),n=i("ScVY"),r=i("0/4Q"),o=i("PDNK"),l=i("EQd/"),h=i("c9yc"),c=i("JIg3"),u=i("wlFP");class d extends n.b{constructor(t){super(),this.isCanceled=!1,this.FrequencyText="",this.headerVisible=!0,this.ScheduleID=0,this.FreqType=1,this.FreqInterval=0,this.FreqSubdayType=0,this.FreqSubdayInterval=0,this.FreqRelativeInterval=0,this.FreqRecurrenceFactor=0,this.ErrorMessage="",this.isOk=!1,this.DontFireEndDateChange=!1,this.Parent=t,this.Title=s.a.GetResource("Com_AppointmentRecurrence"),this.InitProperties(),this.EndingTime.Visible=!1,this.Duration.Visible=!1}InitProperties(){this.StartingTime=new r.e(0),this.StartingTime.Label=s.a.GetResource("DocumentDesigner_DocPrefixStart"),this.StartingTime.LblWidth="80";let t=new Date(2012,0,1);for(let s=0;s<49;s++)this.StartingTime.Items.push(r.d.ComboBoxItems_2(t.ToString("hh:mm a"),t.ToString("hh:mm a"))),t=t.AddMinutes(s>=0&&s<=46?30:29.99);this.StartingTime.SelectedValue=this.StartingTime.Items[0].Value,this.EndingTime=new r.e(0),this.EndingTime.Label=s.a.GetResource("Packages_EndDate"),t=new Date(2012,0,1);for(let s=0;s<48;s++)this.EndingTime.Items.push(r.d.ComboBoxItems_2(t.ToString("hh:mm a"),s.toString())),t=t.AddMinutes(30);this.EndingTime.SelectedValue=this.EndingTime.Items[0].Value,this.Duration=new r.e(0),this.Duration.Label=s.a.GetResource("Com_Duration"),this.Duration.Items.push(r.d.ComboBoxItems_2("30","30")),this.Duration.Items.push(r.d.ComboBoxItems_2("40","40")),this.Duration.SelectedValue="30",this.Duration.SelectedItem=this.Duration.Items[0],this.RecurrencePattern=new o.b("");let e=new o.a("Once",1);e.Group=this.RecurrencePattern,e.GroupName="RecurrencePattern",e.Label=s.a.GetResource("Com_Once"),e.IsChecked=!0,this.RecurrencePattern.Items.push(e),e=new o.a("Daily",4),e.Group=this.RecurrencePattern,e.GroupName="RecurrencePattern",e.Label=s.a.GetResource("Reports_LblDaily"),this.RecurrencePattern.Items.push(e),e=new o.a("Weekly",8),e.Group=this.RecurrencePattern,e.GroupName="RecurrencePattern",e.Label=s.a.GetResource("Com_Weekly"),this.RecurrencePattern.Items.push(e),e=new o.a("Monthly",16),e.Group=this.RecurrencePattern,e.GroupName="RecurrencePattern",e.Label=s.a.GetResource("Com_Monthly"),this.RecurrencePattern.Items.push(e),e=new o.a("Yearly",64),e.Group=this.RecurrencePattern,e.Label=s.a.GetResource("Com_Yearly"),this.RecurrencePattern.Items.push(e),this.RecurrencePattern.Items[0].IsChecked=!0,this.DailyEvery=new o.b(""),e=new o.a("DailyEveryDay",1),e.Group=this.DailyEvery,e.GroupName="1",e.IsChecked=!0,e.Label=s.a.GetResource("Com_Every"),this.DailyEvery.Items.push(e),e=new o.a("DailyEveryWeekDay",2),e.Group=this.DailyEvery,this.DailyEvery.Items.push(e),this.WeeklyRecurEvery=new l.d(0),this.WeeklyRecurEvery.Text="1",this.WeeklyRecurEvery.Label=s.a.GetResource("Com_Recurevery"),this.WeeklyRecurEvery.LblWidth="70",this.WeeklyDays=new h.a(""),this.WeeklyDays.Items.push(u.a.PactCheckBoxData_1(s.a.GetResource("Com_Sunday"),1)),this.WeeklyDays.Items.push(u.a.PactCheckBoxData_1(s.a.GetResource("Com_Monday"),2)),this.WeeklyDays.Items.push(u.a.PactCheckBoxData_1(s.a.GetResource("Com_Tuesday"),4)),this.WeeklyDays.Items.push(u.a.PactCheckBoxData_1(s.a.GetResource("Com_Wednesday"),8)),this.WeeklyDays.Items.push(u.a.PactCheckBoxData_1(s.a.GetResource("Com_Thursday"),16)),this.WeeklyDays.Items.push(u.a.PactCheckBoxData_1(s.a.GetResource("Com_Friday"),32)),this.WeeklyDays.Items.push(u.a.PactCheckBoxData_1(s.a.GetResource("Com_Saturday"),64)),this.WeeklyDays.Items.map(t=>t.Label=t.DBColumnName),this.MonthlyEvery=new o.b(""),e=new o.a("MonthlyDayOf",1),e.Group=this.MonthlyEvery,e.IsChecked=!0,e.Label=s.a.GetResource("Doc_Day"),this.MonthlyEvery.Items.push(e),e=new o.a("MonthlyTheFirst",2),e.Group=this.MonthlyEvery,e.Label=s.a.GetResource("Com_The"),this.MonthlyEvery.Items.push(e),this.MonthlyDayOf=new l.d(0),this.MonthlyDayOf.Text=(new Date).getDate().toString(),this.MonthlyDayMonths=new l.d(0),this.MonthlyDayMonths.Text="1",this.MonthlyTheFirst=new r.e(0),this.MonthlyTheFirst.LblWidth="1",this.MonthlyTheFirst.Items.push(r.d.ComboBoxItems_2(s.a.GetResource("first"),"1")),this.MonthlyTheFirst.Items.push(r.d.ComboBoxItems_2(s.a.GetResource("second"),"2")),this.MonthlyTheFirst.Items.push(r.d.ComboBoxItems_2(s.a.GetResource("third"),"4")),this.MonthlyTheFirst.Items.push(r.d.ComboBoxItems_2(s.a.GetResource("fourth"),"8")),this.MonthlyTheFirst.Items.push(r.d.ComboBoxItems_2(s.a.GetResource("last"),"16")),this.MonthlyTheFirst.SelectedValue="1",this.MonthlyTheWeekDay=new r.e(0),this.MonthlyTheWeekDay.LblWidth="1",this.MonthlyTheWeekDay.Items.push(r.d.ComboBoxItems_2(s.a.GetResource("Doc_Day"),"8")),this.MonthlyTheWeekDay.Items.push(r.d.ComboBoxItems_2(s.a.GetResource("Com_Sunday"),"1")),this.MonthlyTheWeekDay.Items.push(r.d.ComboBoxItems_2(s.a.GetResource("Com_Monday"),"2")),this.MonthlyTheWeekDay.Items.push(r.d.ComboBoxItems_2(s.a.GetResource("Com_Tuesday"),"3")),this.MonthlyTheWeekDay.Items.push(r.d.ComboBoxItems_2(s.a.GetResource("Com_Wednesday"),"4")),this.MonthlyTheWeekDay.Items.push(r.d.ComboBoxItems_2(s.a.GetResource("Com_Thursday"),"5")),this.MonthlyTheWeekDay.Items.push(r.d.ComboBoxItems_2(s.a.GetResource("Com_Friday"),"6")),this.MonthlyTheWeekDay.Items.push(r.d.ComboBoxItems_2(s.a.GetResource("Com_Saturday"),"7"));let i=(new Date).getDay();this.MonthlyTheWeekDay.SelectedValue=this.MonthlyTheWeekDay.Items[i].Value,this.MonthlyTheMonths=new l.d(0),this.MonthlyTheMonths.Text="1",this.YearlyEvery=new o.b(""),e=new o.a("YearlyEvery",1),e.Group=this.YearlyEvery,e.IsChecked=!0,this.YearlyEvery.Items.push(e),e=new o.a("YearlyTheFirst",2),e.Group=this.YearlyEvery,this.YearlyEvery.Items.push(e),this.YearlyEveryMonth=new r.e(0);for(let s=1;s<=12;s++){let t=new Date(2012,s-1,1);this.YearlyEveryMonth.Items.push(r.d.ComboBoxItems_2(t.ToString("MMMM"),s.toString()))}this.YearlyEveryMonth.SelectedValue=Date.Today().getMonth().toString(),this.YearlyEveryMonthDay=new l.d(0),this.YearlyEveryMonthDay.Text=Date.Today().getDate().toString(),this.YearlyTheFirst=new r.e(0),this.YearlyTheFirst.Items=this.MonthlyTheFirst.Items,this.YearlyTheFirst.SelectedValue="1",this.YearlyTheWeekDay=new r.e(0),this.YearlyTheWeekDay.Items=this.MonthlyTheWeekDay.Items,this.YearlyTheWeekDay.SelectedValue=this.MonthlyTheWeekDay.SelectedValue,this.YearlyTheMonth=new r.e(0),this.YearlyTheMonth.Items=this.YearlyEveryMonth.Items,this.YearlyTheMonth.SelectedValue=Date.Today().getMonth().toString(),this.RangeEnd=new o.b(""),e=new o.a("NoEndDate",1),e.Group=this.RangeEnd,e.GroupName="RangeEnd",e.IsChecked=!0,e.Label=s.a.GetResource("Com_Noenddate"),e.IsChecked=!0,e.CheckedChangedCommand.Subscribe(this,"OnReccurrenceCheckedChanged","Yearly"),this.RangeEnd.Items.push(e),e=new o.a("EndBy",2),e.Group=this.RangeEnd,e.GroupName="RangeEnd",e.Label=s.a.GetResource("Com_Endby"),e.CheckedChangedCommand.Subscribe(this,"OnReccurrenceCheckedChanged","Yearly"),this.RangeEnd.Items.push(e),this.FirstPostingDate=new c.a(0),this.FirstPostingDate.Label=s.a.GetResource("DocumentDesigner_DocPrefixStart"),this.EndDate=new c.a(0),this.EndDate.LblWidth="1",this.EndDate.SelectedDateChanged.Subscribe(this,"EndDate_PropertyChanged"),this.Occurrences=new l.d(0),this.Occurrences.Label=s.a.GetResource("Com_Occurrences"),this.Occurrences.Text="10"}EndDate_PropertyChanged(t,e){this.DontFireEndDateChange||(this.RangeEnd.Items[1].IsChecked?this.CalculateOccurrences():this.RangeEnd.Items[1].IsChecked=!0)}LoadEditData(t){if(this.ScheduleID=parseInt(t.ScheduleID),this.FreqType=parseInt(t.FreqType),this.FreqInterval=parseInt(t.FreqInterval),this.FreqSubdayType=parseInt(t.FreqSubdayType),this.FreqSubdayInterval=parseInt(t.FreqSubdayInterval),this.FreqRelativeInterval=parseInt(t.FreqRelativeInterval),this.FreqRecurrenceFactor=parseInt(t.FreqRecurrenceFactor),this.Occurrences.Text=a.e.IsEmpty(t.Occurrence)?"0":t.Occurrence.toString(),1==this.FreqType)this.RecurrencePattern.Items[0].IsChecked=!0;else if(4==this.FreqType)this.RecurrencePattern.Items[1].IsChecked=!0,this.DailyEvery.Items[0].IsChecked=!0,this.DailyEvery.Items[0].GroupName=this.FreqInterval.toString();else if(8==this.FreqType){this.RecurrencePattern.Items[2].IsChecked=!0;let t=this.FreqInterval;for(let e=this.WeeklyDays.Items.length-1;e>=0;e--)t>=this.WeeklyDays.Items[e].FeatureID?(this.WeeklyDays.Items[e].IsChecked=!0,t-=this.WeeklyDays.Items[e].FeatureID):this.WeeklyDays.Items[e].IsChecked=!1;this.WeeklyRecurEvery.Text=this.FreqRecurrenceFactor.toString()}else 16==this.FreqType?(this.RecurrencePattern.Items[3].IsChecked=!0,this.MonthlyEvery.Items[0].IsChecked=!0,this.MonthlyDayOf.Text=this.FreqInterval.toString(),this.MonthlyDayMonths.Text=this.FreqRecurrenceFactor.toString()):32==this.FreqType&&(this.RecurrencePattern.Items[3].IsChecked=!0,this.MonthlyEvery.Items[1].IsChecked=!0,this.MonthlyTheWeekDay.SelectedValue=this.FreqInterval.toString(),this.MonthlyTheFirst.SelectedValue=this.FreqRelativeInterval.toString(),this.MonthlyTheMonths.Text=this.FreqRecurrenceFactor.toString());0!=this.FreqType&&(this.FrequencyText=this.RecurrencePattern.CheckedItem.Label),this.FirstPostingDate.Date=new Date(t.CStartDate),a.e.isValidDate(t.CEndDate)?(this.EndDate.Date=this.FirstPostingDate.Date,this.EndDate.Visible=!1,this.RangeEnd.Items[0].IsChecked=!0):(this.RangeEnd.Items[1].IsChecked=!0,this.EndDate.Date=new Date(t.CEndDate),this.CalculateOccurrences());let e=t.StartTime.toString();if(e.length>0)if(e.Contains(":"))this.StartingTime.SelectedValue=Date.WithTime(e).ToString("hh:mm a");else{let t=Date.Today();t=t.AddHours(parseFloat(e.substr(0,2))),t=t.AddMinutes(parseFloat(e.substr(2,2))),this.StartingTime.SelectedValue=t.ToString("hh:mm a")}}SetSaveData(){if(this.FreqType=this.RecurrencePattern.CheckedItem.FeatureID,1==this.FreqType)this.FreqInterval=0;else if(4==this.FreqType)this.FreqInterval=parseInt(this.DailyEvery.Items[0].GroupName);else if(8==this.FreqType){if(this.FreqInterval=0,this.WeeklyDays.Items.forEach(t=>{t.IsChecked&&(this.FreqInterval+=t.FeatureID)}),0==this.FreqInterval)return void this.Parent.SetErroMessage("Select Day.");this.FreqRecurrenceFactor=parseInt(this.WeeklyRecurEvery.Text)}else 16==this.FreqType&&(this.MonthlyEvery.Items[0].IsChecked?(this.FreqInterval=parseInt(this.MonthlyDayOf.Text),this.FreqRecurrenceFactor=parseInt(this.MonthlyDayMonths.Text)):(this.FreqType=32,this.FreqInterval=parseInt(this.MonthlyTheWeekDay.SelectedValue),this.FreqRelativeInterval=parseInt(this.MonthlyTheFirst.SelectedValue),this.FreqRecurrenceFactor=parseInt(this.MonthlyTheMonths.Text)))}OnButtonClick(t){if(this.FrequencyText=this.RecurrencePattern.CheckedItem.Label,"OK"==t){let t;if(this.RecurrencePattern.Items[1].IsChecked){if(this.DailyEvery.Items[0].IsChecked&&(t=a.e.Int(this.DailyEvery.Items[0].GroupName),t<=0))return void alert("Invalid Day")}else if(this.RecurrencePattern.Items[2].IsChecked){if(t=a.e.Int(this.WeeklyRecurEvery.Text),t<=0)return void alert("Invalid Every Week")}else if(this.RecurrencePattern.Items[3].IsChecked)if(this.MonthlyEvery.Items[0].IsChecked){if(t=a.e.Int(this.MonthlyDayOf.Text),t<=0)return void alert("Invalid Day");if(t=a.e.Int(this.MonthlyDayMonths.Text),t<=0)return void alert("Invalid Every Month")}else if(this.MonthlyEvery.Items[1].IsChecked&&(t=a.e.Int(this.MonthlyTheMonths.Text),t<=0))return void alert("Invalid Every Month");this.isOk=!0,"ActivitiesViewModel"==this.Parent.ClassName&&this.Parent.IsPopup&&this.Parent.IsPopupRecur(),s.a.page.HideDialog()}else"Cancel"==t&&(this.isOk=!1,s.a.page.HideDialog())}onCancel(t){this.isCanceled=!0,this.isOk=!1,s.a.page.HideDialog()}OnOccurrencesLeave(t){this.CalculateEndDate(),this.RangeEnd.Items[1].IsChecked=!0}OnReccurrenceCheckedChanged(t){this.RangeEnd.Items[0].IsChecked||this.RangeEnd.Items[1].IsChecked&&this.CalculateOccurrences()}CalculateEndDate(){let t=10,e=1;try{t=parseInt(this.Occurrences.Text)}catch(s){}let i=this.FirstPostingDate.Date;if(this.RecurrencePattern.Items[1].IsChecked){for(this.FreqInterval=parseInt(this.DailyEvery.Items[0].GroupName);e<t;)i=i.AddDays(this.FreqInterval),e++;this.DontFireEndDateChange=!0,this.EndDate.Date=i,this.DontFireEndDateChange=!1}else if(this.RecurrencePattern.Items[2].IsChecked){if(this.WeeklyDays.Items.filter(t=>1==t.IsChecked).length>0){for(this.FreqInterval=parseInt(this.WeeklyRecurEvery.Text),e=0;!(this.WeeklyDays.Items[i.getDay()].IsChecked&&(e++,e>=t));)i=i.AddDays(1),0==i.getDay()&&this.FreqInterval>1&&(i=i.AddDays(7*(this.FreqInterval-1)));this.DontFireEndDateChange=!0,this.EndDate.Date=i,this.DontFireEndDateChange=!1}}else if(this.RecurrencePattern.Items[3].IsChecked)if(this.MonthlyEvery.Items[0].IsChecked){for(this.FreqInterval=parseInt(this.MonthlyDayOf.Text),this.FreqRecurrenceFactor=parseInt(this.MonthlyDayMonths.Text),this.FreqInterval<i.getDate()?(i=i.AddMonths(1),i=i.AddDays(this.FreqInterval-i.getDate()),this.FirstPostingDate.Date=i):i=this.GetDate(i,this.FreqInterval);e<t;)i=i.AddMonths(this.FreqRecurrenceFactor),this.FreqInterval!=i.getDate()&&(i=this.GetDate(i,this.FreqInterval)),e++;this.DontFireEndDateChange=!0,this.EndDate.Date=i,this.DontFireEndDateChange=!1}else{if("8"==this.MonthlyTheWeekDay.SelectedValue)for("1"==this.MonthlyTheFirst.SelectedValue?1!=i.getDate()&&(i=new Date(i.getFullYear(),i.getMonth(),1).AddMonths(1)):"16"==this.MonthlyTheFirst.SelectedValue&&(i=new Date(i.getFullYear(),i.getMonth(),1).AddMonths(1).AddDays(-1)),this.FreqRecurrenceFactor=parseInt(this.MonthlyTheMonths.Text);e<t;)i="16"==this.MonthlyTheFirst.SelectedValue?new Date(i.getFullYear(),i.getMonth(),1).AddMonths(this.FreqRecurrenceFactor+1).AddDays(-1):i.AddMonths(this.FreqRecurrenceFactor),e++;else for(this.FreqRecurrenceFactor=parseInt(this.MonthlyTheMonths.Text);e<t;)i=i.AddMonths(this.FreqRecurrenceFactor),e++;this.DontFireEndDateChange=!0,this.EndDate.Date=i,this.DontFireEndDateChange=!1}}CalculateOccurrences(){let t=0,e=this.FirstPostingDate.Date,i=this.EndDate.Date;if(this.RecurrencePattern.Items[1].IsChecked){for(this.FreqInterval=parseInt(this.DailyEvery.Items[0].GroupName);e<=i;)e=e.AddDays(this.FreqInterval),t++;this.Occurrences.Text=t.toString()}else if(this.RecurrencePattern.Items[2].IsChecked){if(this.WeeklyDays.Items.filter(t=>1==t.IsChecked).length>0){for(this.FreqInterval=parseInt(this.WeeklyRecurEvery.Text);e<=i;)this.WeeklyDays.Items[e.getDay()].IsChecked&&t++,e=e.AddDays(1),0==e.getDay()&&this.FreqInterval>1&&(e=e.AddDays(7*(this.FreqInterval-1)));this.Occurrences.Text=t.toString()}}else if(this.RecurrencePattern.Items[3].IsChecked)if(this.MonthlyEvery.Items[0].IsChecked){for(this.FreqInterval=parseInt(this.MonthlyDayOf.Text),this.FreqRecurrenceFactor=parseInt(this.MonthlyDayMonths.Text),this.FreqInterval<e.getDate()?(e=e.AddMonths(1),e=e.AddDays(this.FreqInterval-e.getDate()),this.FirstPostingDate.Date=e):e=this.GetDate(e,this.FreqInterval);e<=i;)e=e.AddMonths(this.FreqRecurrenceFactor),this.FreqInterval!=e.getDate()&&(e=this.GetDate(e,this.FreqInterval)),t++;this.Occurrences.Text=t.toString()}else{if("8"==this.MonthlyTheWeekDay.SelectedValue)for("1"==this.MonthlyTheFirst.SelectedValue?1!=e.getDate()&&(e=new Date(e.getFullYear(),e.getMonth(),1).AddMonths(1)):"16"==this.MonthlyTheFirst.SelectedValue&&(e=new Date(e.getFullYear(),e.getMonth(),1).AddMonths(1).AddDays(-1)),this.FreqRecurrenceFactor=parseInt(this.MonthlyTheMonths.Text);e<=i;)e=e.AddMonths(this.FreqRecurrenceFactor),t++;else for(this.FreqRecurrenceFactor=parseInt(this.MonthlyTheMonths.Text);e<=i;)e=e.AddMonths(this.FreqRecurrenceFactor),t++;this.Occurrences.Text=t.toString()}}GetDate(t,e){try{t=new Date(t.getFullYear(),t.getMonth(),e)}catch(i){try{t=new Date(t.getFullYear(),t.getMonth(),e-1)}catch(s){try{t=new Date(t.getFullYear(),t.getMonth(),e-2)}catch(a){try{t=new Date(t.getFullYear(),t.getMonth(),e-3)}catch(n){}}}}return t}}},CQvG:function(t,e,i){"use strict";i.d(e,"b",(function(){return D})),i.d(e,"a",(function(){return C}));var s=i("Do2H"),a=i("Lp6j"),n=i("ockk"),r=i("0/4Q"),o=i("8B8H"),l=i("NkMH"),h=i("EQd/"),c=i("xnJf"),u=i("OvA8"),d=i("JIg3"),m=i("n56n"),S=i("Jnyl"),y=i("31sV"),A=i("yWgc");class D{constructor(t){this.Module="CASES",this.ClassName="ViewActivitiesViewModel",this.Visible=!0,this.ViewActivityInSection=!1,this.CloseVisible=!1,this.AssignVisible=!1,this.Activity=new r.e(0),this.tempActivityGridDataColumn=[],this.ActivityGridDataObj=new o.a,this.tempActivityDataColumn=[],this.CostCenterID=0,this.AssignVisiblity=!0,this.NodeID=0,this.ActVisibility=!1,this.ColumnSpan="4",this.DeletedActivity=[],this.ButtonAdd=new l.a,this.ButtonUpdate=new l.a,this.ButtonDelete=new l.a,this.DS=null,this.FilterStatus="",this.TempSchID=-1e3,this.SchID=-2e3,this.NodeID=t.NodeID,this.CostCenterID=t.CostCenterID,this.Activities=t.Activities,this.Parent=t,this.contextVisible=!0,null!=this.Activities&&(this.Activities.ActivitiesVisibility=!0),this.Activity.Label=s.a.GetResource("CRMOpportunity_Activities"),this.Activity.LblWidth="80",this.Activity.Items.push(r.d.ComboBoxItems_2("All","-1")),this.Activity.Items.push(r.d.ComboBoxItems_2("Open","1")),this.Activity.Items.push(r.d.ComboBoxItems_2("Confirmed","4")),this.Activity.Items.push(r.d.ComboBoxItems_2("Closed","2")),this.Activity.Items.push(r.d.ComboBoxItems_2("Re-Schedule","3")),this.Activity.Items.push(r.d.ComboBoxItems_2("In-Progress","5")),this.Activity.Items.push(r.d.ComboBoxItems_2("On-Hold","6")),this.Activity.SelectedValue="-1",this.ActivitisActualData(),t.CostCenterID>4e4&&t.CostCenterID<5e4?s.a.SessionManager.HideUnathorizedAccess?(this.ButtonUpdate.Visible=s.a.SessionManager.IsActionAssigned(1e3,"Activity_Create"),this.ButtonDelete.Visible=s.a.SessionManager.IsActionAssigned(1e3,"Activity_Delete")):(this.ButtonUpdate.Enable=s.a.SessionManager.IsActionAssigned(1e3,"Activity_Edit"),this.ButtonDelete.Enable=s.a.SessionManager.IsActionAssigned(1e3,"Activity_Delete")):(s.a.SessionManager.HideUnathorizedAccess?this.ButtonAdd.Visible=s.a.SessionManager.IsActionAssigned(1e3,"Activity_Create"):this.ButtonAdd.Enable=s.a.SessionManager.IsActionAssigned(1e3,"Activity_Create"),s.a.SessionManager.HideUnathorizedAccess?this.ButtonUpdate.Visible=s.a.SessionManager.IsActionAssigned(1e3,"Activity_Edit"):this.ButtonUpdate.Enable=s.a.SessionManager.IsActionAssigned(1e3,"Activity_Edit"),this.AssignVisible=s.a.SessionManager.IsActionAssigned(1e3,"Assign"),s.a.SessionManager.HideUnathorizedAccess?this.ButtonDelete.Visible=s.a.SessionManager.IsActionAssigned(1e3,"Activity_Delete"):this.ButtonDelete.Enable=s.a.SessionManager.IsActionAssigned(1e3,"Activity_Delete")),this.ButtonUpdate.Visible||this.ButtonDelete.Visible||(this.contextVisible=!1),this.ActivityGridDataObj.OnLinkClick.Subscribe(this,"OnCmnItem_Click"),this.ActivityGridDataObj.ContextMenuClickSubject.subscribe(t=>{this.OnCmnItem_Click("",t.item.Tag)}),this.ActivityGridDataObj.ContextMenu.Items=[];let e=new n.b;e.Header=s.a.GetResource("EDIT"),e.Tag="EDIT",e.Visibility=this.ButtonUpdate.Visible,this.ActivityGridDataObj.ContextMenu.Items.push(e),e=new n.b,e.Header=s.a.GetResource("DELETE"),e.Tag="DELETE",e.Visibility=this.ButtonDelete.Visible,this.ActivityGridDataObj.ContextMenu.Items.push(e)}OnSave(){Logger.InfoLog("AssignViewModel::Entering Save"),Logger.InfoLog("AssignViewModel::Exiting Save")}get angularGrid(){return this.ActivityGridDataObj.angularGrid}get ActivityGridData(){return this.ActivityGridDataObj.Table}get ActivityColumnSource(){return this.ActivityGridDataObj.Columns}set ActivityColumnSource(t){this.ActivityGridDataObj.Columns=t}get ActivityColumn(){return this.ActivityGridDataObj.TableColumns}get SelectedRow(){return this.ActivityGridDataObj.SelectedItem}set SelectedRow(t){this.ActivityGridDataObj.SelectedItem=t}get contextVisible(){return this.ActivityGridDataObj.contextVisible}set contextVisible(t){this.ActivityGridDataObj.contextVisible=t}OnCmnItem_Click(t,e){var i,n,o,l,D;switch(Logger.InfoLog("ViewNoteViewModel::Entering OnCmnItem_Click with Command="+t),this.Activities.enablecontrols(!this.Activities.isView),this.Activities.isView?(this.Activities.ButtonSave.Visible=!1,this.Activities.ButtonReschedule.Visible=!1,this.Activities.ButtonAttachments.Visible=!1,this.Activities.ButtonCustomize.Visible=!1):this.Activities.buttonsAction(),null!=this.Activities.CRMCustomer.Text&&""!=this.Activities.CRMCustomer.Text||null==this.Parent||("AddDContactViewModel"==this.Parent.ClassName?this.Activities.CRMCustomer.Text=this.Parent.Customer.Text:"AddEditLeads"==this.Parent.ClassName||"AddEditOpportunity"==this.Parent.ClassName?this.Activities.CRMCustomer.Text=this.Parent.Company.Text:"AddEditCasesViewModel"==this.Parent.ClassName?this.Activities.CRMCustomer.Text=this.Parent.Customer.Text:"AddEditCampaignViewModel"==this.Parent.ClassName?this.Activities.CRMCustomer.Text=this.Parent.txtName.Text:"QuickAddCaseViewModel"==this.Parent.ClassName?this.Activities.CRMCustomer.Text=this.Parent.Customer.Text:"AddCustomerViewModel"==this.Parent.ClassName?this.Activities.CRMCustomer.Text=this.Parent.CustomerName.Text:"AddEditRenContractViewModel"==this.Parent.ClassName?this.Activities.CRMCustomer.Text=this.Parent.Tenant.Text:"AddEditTenantViewModel"==this.Parent.ClassName&&(this.Activities.CRMCustomer.Text=this.Parent.FstName.Text)),e){case"ADD":if(null==this.Activities)return;if(this.SelectedRow=null,this.Activities.Selectedrow=null,this.Activities.ActivityID=0,this.Activities.buttonsAction(),this.Activities.ActivityType.SelectedValue="1",this.Activities.StatusSelectedValue="412",this.Activities.Subject.Text="",this.Activities.Priority.SelectedValue="2",this.Activities.PctComplete.Text="",this.Activities.Location.Text="",this.Activities.IsAllDayActivity.IsChecked=!0,this.Activities.ActualCloseDate.Date=new Date,this.Activities.ActualCloseTime.SelectedValue="12:00 AM",this.Activities.Remarks.Text="",this.Activities.Remarks.Tag="",this.Activities.Remarks.Xaml="",this.Activities.ActivitiesVisibility=!0,this.Activities.ClearFields(),this.Activities.AssignVisiblity=!1,this.Activities.ViewAttachVisible=!1,null!=this.Activities.ViewAttachments&&this.Activities.ViewAttachments.AttachmentsListObj.Clear(),null!=this.Activities&&this.Activities.SetActions(),!(null===(i=this.Activities)||void 0===i?void 0:i.ActivityOnScreen)&&"AddEditDocumentViewModel"==this.Parent.ClassName&&this.Parent.ScreenObject.Preferences.ContainsKey("ActivityAsPopUp")&&"True"==this.Parent.ScreenObject.Preferences.ActivityAsPopUp.toString())return void s.a.page.ShowDialog(this.Activities,y.ActivitiesComponent,{ShowCenter:!0,Title:s.a.GetResource("Activities")});if(this.Parent instanceof C||"AddEditLeads"==this.Parent.ClassName||"AddEditCasesViewModel"==this.Parent.ClassName||"AddCustomerViewModel"==this.Parent.ClassName){if("AddEditLeads"==this.Parent.ClassName&&this.Parent.ContactsBasedOnLeads&&this.Parent.LeadID>0&&(this.Activities.CRMContactPerson.CustomWhere="a.Featurepk ="+this.Parent.LeadID+" and a.Featureid=86  ",this.Activities.CRMContactPerson.Refresh(),this.Activities.CRMContactPerson.SelectedIndex=0),"AddEditCasesViewModel"==this.Parent.ClassName.toString()){let t;for(let e=0;e<this.Activities.Fields.length;e++){let i=this.Activities.Fields[e];i instanceof m.b&&i.CCID>5e4&&(t=this.Parent.ScreenObject.GetCustomCCField(i.CCID),null!=t&&(i.SelectedValue=t.SelectedValue))}}else"AddCustomerViewModel"==this.Parent.ClassName.toString()&&this.Parent.CustomerID>0&&(this.Activities.CRMContactPerson.CustomWhere="a.Featurepk ="+this.Parent.CustomerID+" and a.Featureid=83  ",this.Activities.CRMContactPerson.Refresh(),this.Activities.CRMContactPerson.SelectedIndex=0);(null===(n=this.Activities)||void 0===n?void 0:n.ActivityOnScreen)||(this.Activities.IsPopup?(this.ActivitiesPopup=this.Activities,s.a.page.ShowDialog(this.ActivitiesPopup,y.ActivitiesComponent,{ShowCenter:!0,Title:s.a.GetResource("Activities")}),this.Parent.ActVisibility=!1):(this.Parent.ActVisibility=!0,s.a.page.ShowDialog(this.Activities,y.ActivitiesComponent,{Title:s.a.GetResource("Activities")})))}else this.Parent.ActVisibility=!0,(null===(o=this.Activities)||void 0===o?void 0:o.ActivityOnScreen)||s.a.page.ShowDialog(this.Activities,y.ActivitiesComponent,{Title:s.a.GetResource("Activities")});break;case"ASSIGN":if(null!=this.SelectedRow){if(null==this.Activities)return;this.Activities.ActivitiesVisibility=!1,this.Activities.AssignVisiblity=!0;let t=[],e=[],i=[];t=a.e.IsEmpty(this.SelectedRow.UsersXML)?"":this.SelectedRow.UsersXML.toString().split(","),e=a.e.IsEmpty(this.SelectedRow.RolesXML)?"":this.SelectedRow.RolesXML.toString().split(","),i=a.e.IsEmpty(this.SelectedRow.GroupXML)?"":this.SelectedRow.GroupXML.toString().split(",");for(let s=0;s<this.Activities.AssignFeature.RolesItems.Items.length;s++)for(let t=0;t<e.length;t++){if(e[t]==this.Activities.AssignFeature.RolesItems.Items[s].Value){this.Activities.AssignFeature.RolesItems.Items[s].IsChecked=!0;break}this.Activities.AssignFeature.RolesItems.Items[s].IsChecked=!1}for(let s=0;s<this.Activities.AssignFeature.UsersItems.Items.length;s++)for(let e=0;e<t.length;e++){if(t[e]==this.Activities.AssignFeature.UsersItems.Items[s].Value){this.Activities.AssignFeature.UsersItems.Items[s].IsChecked=!0;break}this.Activities.AssignFeature.UsersItems.Items[s].IsChecked=!1}for(let s=0;s<this.Activities.AssignFeature.GroupsItems.Items.length;s++)for(let t=0;t<i.length;t++){if(i[t]==this.Activities.AssignFeature.GroupsItems.Items[s].Value){this.Activities.AssignFeature.GroupsItems.Items[s].IsChecked=!0;break}this.Activities.AssignFeature.GroupsItems.Items[s].IsChecked=!1}s.a.page.ShowDialog(this.Activities.AssignFeature,A.AssignFeatureComponent,{ShowCenter:!0}),this.Activities.IsPopup&&(this.ActVisibility=!0,this.Parent.ActVisibility=!0)}break;case"EDIT":case"View":if(null!=this.SelectedRow){let t=this.SelectedRow,e=0;if(this.Parent.ActVisibility=!0,this.Activities.ActivitiesVisibility=!0,this.Activities.AssignVisiblity=!1,e=a.e.IntTryParse(t.ActivityID),e>0){if("AddEditDocumentViewModel"!=this.Parent.ClassName&&parseInt(t.SchID)<0&&("3"!=t.ActivityTypeID.toString()||"4"!=t.ActivityTypeID.toString()))return void(this.Activities.IsPopup&&(this.ActivitiesPopup=this.Activities,this.Parent.ActVisibility=!1,this.ActVisibility=!1,(null===(l=this.Activities)||void 0===l?void 0:l.ActivityOnScreen)||s.a.page.ShowDialog(this.ActivitiesPopup,y.ActivitiesComponent,{ShowCenter:!0})));if(null==this.Activities)return;if(this.Activities.ButtonSave.Visible=a.e.IsEmpty(t.UserName)||t.UserName.toString().toLowerCase()==s.a.SessionManager.UserName.toLowerCase()?s.a.SessionManager.IsActionAssigned(1e3,"Activity_Edit"):s.a.SessionManager.IsActionAssigned(1e3,"Can_edit_All_Activities"),this.Activities.ActivityID=parseInt(t.ActivityID.toString()),this.Activities.ActivityType.SelectedValue=t.ActivityTypeID.toString(),a.e.IsEmpty(t.ScheduleID)||null==t.ScheduleID||""==t.ScheduleID.toString()||"0"==t.ScheduleID.toString()||this.Activities.Recur.LoadEditData(t),!a.e.IsEmpty(t.FreqType)&&null!=t.FreqType&&""!=t.FreqType.toString()){let e=parseInt(t.FreqType.toString());1==e?this.Activities.ActivityText.Text="Once":4==e?this.Activities.ActivityText.Text="Daily":8==e?this.Activities.ActivityText.Text="Weekly":e>=16&&(this.Activities.ActivityText.Text="Monthly")}if("1"==this.Activities.ActivityType.SelectedValue||"2"==this.Activities.ActivityType.SelectedValue?this.Activities.Exp.Visible=!1:"3"!=this.Activities.ActivityType.SelectedValue&&"4"!=this.Activities.ActivityType.SelectedValue||(this.Activities.Exp.Visible=!1,this.Activities.StartDate.Visible=!0,this.Activities.StartTime.Visible=!0,this.Activities.EndDate.Visible=!0,this.Activities.EndTime.Visible=!0),this.Activities.StatusSelectedValue=a.e.String(t.SchStatus),this.Activities.Subject.Text=t.Subject.toString(),this.Activities.Priority.SelectedValue=t.Priority.toString(),this.Activities.PctComplete.Text=t.PctComplete.toString(),this.Activities.Location.Text=t.Location.toString(),a.e.IsEmpty(t.SchID)||(this.Activities.SchID=parseInt(t.SchID.toString())),this.Activities.IsAllDayActivity.IsChecked="0"!=t.IsAllDayActivity.toString(),null!=t.ActualCloseDate_Key&&""!=t.ActualCloseDate_Key.toString()&&(this.Activities.ActualCloseDate.Date=1900==new Date(t.ActualCloseDate_Key.toString()).getFullYear()?new Date:new Date(t.ActualCloseDate_Key.toString()),this.Activities.ActualCloseDate.CustomFormat=s.a.SessionManager.Preferences["Date Format"].toString()),a.e.IsEmpty(t.ActualCloseTime)?this.Activities.ActualCloseTime.SelectedIndex=0:this.Activities.ActualCloseTime.SelectedValue=new Date(t.ActualCloseTime.toString()).ToString("hh:mm:ss a"),this.Activities.CRMCustomer.Text=t.CustomerID.toString(),this.Activities.CRMContactPerson.SelectedValue=a.e.IsEmpty(t.ContactID)?0:parseInt(t.ContactID.toString()),this.Activities.Remarks.Text=t.Remarks.toString(),a.e.IsEmpty(t.ActStartDate_Key)||(this.Activities.StartDate.Date=new Date(t.ActStartDate_Key.toString())),a.e.IsEmpty(t.ActEndDate_Key)||(this.Activities.EndDate.Date=new Date(t.ActEndDate_Key.toString())),a.e.IsEmpty(t.StartDateTime_Key)||(this.Activities.ActStartDate.Date=new Date(t.StartDateTime_Key.toString()),this.Activities.ActStartTime.AddItem(new Date(t.StartDateTime_Key.toString()).ToString("hh:mm:ss tt"),new Date(t.StartDateTime_Key.toString()).ToString("hh:mm:ss tt")),this.Activities.ActStartTime.SelectedValue=new Date(t.StartDateTime_Key.toString()).ToString("hh:mm:ss tt")),a.e.IsEmpty(t.EndDateTime_Key)||(this.Activities.ActEndDate.Date=new Date(t.EndDateTime_Key.toString()),this.Activities.ActEndTime.AddItem(new Date(t.EndDateTime_Key.toString()).ToString("hh:mm:ss tt"),new Date(t.EndDateTime_Key.toString()).ToString("hh:mm:ss tt")),this.Activities.ActEndTime.SelectedValue=new Date(t.EndDateTime_Key.toString()).ToString("hh:mm:ss tt")),this.Activities.TotalDuration=a.e.IsEmpty(t.TotalDuration)?0:parseInt(t.TotalDuration.toString()),this.Activities.laststartdate=a.e.IsEmpty(t.LastStartDate)?null:new Date(t.LastStartDate.toString()),this.Activities.StartTime.SelectedValue=new Date(t.ActStartTime.toString()).ToString("hh:mm:ss a"),this.Activities.EndTime.SelectedValue=new Date(t.ActEndTime.toString()).ToString("hh:mm:ss a"),this.Activities.AssignUserList.SelectedValue=t.AssignUserID.toString(),this.Activities.ViewAttachVisible=!1,null!=t.AttachmentXML&&""!=t.AttachmentXML.toString()){this.Activities.ViewAttachVisible=!0;let e=new a.f;try{this.Activities.ViewAttachments=new u.ViewAttachmentViewModel(this.Activities),e.LoadXml(t.AttachmentXML.toString());let i=e.SelectNodes("AttachmentsXML/Row");this.Activities.ViewAttachments.AttachmentsListObj.Clear(),i.forEach(t=>{let e=new c.AddAttachmentViewModel;e.AddAttachmentViewModel_2(this.Activities),e.AttachmentID=parseInt(t.attributes.AttachmentID.value),e.ActualFileName=t.attributes.ActualFileName.value,e.FileExtension=t.attributes.FileExtension.value,e.FileDescription=t.attributes.FileDescription.value,e.Guid=t.attributes.GUID.value,e.RelativeFileName=t.attributes.RelativeFileName.value,e.IsProductImage=!1,null!=t.attributes.IsSign&&"1"==t.attributes.IsSign.value&&(e.IsSign=!0),this.Activities.ViewAttachments.AttachmentsListObj.addRow(e)})}catch(g){console.log("AttachmentXML"+g.stack)}}let e,i=null,n=null,o=null,A=null,D=null,C=null;for(let s=0;s<this.Activities.Fields.length;s++){let l=this.Activities.Fields[s];if(l instanceof h.d&&(i=l,i.Text=a.e.StringValue(t[i.SysColumnName])),l instanceof d.b){D=l;try{D.Date=new Date(t[D.SysColumnName].toString())}catch(p){let t=new Date;D.Date=new Date(1900,1,1,t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds())}}else l instanceof d.a&&(n=l,a.e.IsEmpty(t[n.SysColumnName])||(n.Date=new Date(t[n.SysColumnName].toString())));l instanceof r.e&&(o=l,o.SelectedValue=t[o.SysColumnName].toString()),l instanceof S.a&&(C=l,C.TextBox.Text=t[C.SysColumnName].toString()),l instanceof h.c&&(A=l,A.Text=t[A.SysColumnName].toString()),l instanceof m.b&&(e=l,a.e.IsEmpty(t[e.SysColumnName])||(e.SelectedValue=a.e.IsEmpty(t[e.SysColumnName+"_Key"])?0:parseInt(t[e.SysColumnName+"_Key"])))}this.Activities.Selectedrow=t}else null!=this.Activities&&(this.Activities.Selectedrow=t,this.Activities.ActivityID=0,this.Activities.ActivityType.SelectedValue="1",this.Activities.StatusSelectedValue="412",this.Activities.Subject.Text="",this.Activities.Priority.SelectedValue="2",this.Activities.PctComplete.Text="",this.Activities.Location.Text="",this.Activities.IsAllDayActivity.IsChecked=!0,this.Activities.ActualCloseDate.Date=new Date,this.Activities.ActualCloseTime.SelectedValue="12:00:00 AM",this.Activities.CRMCustomer.Text="",this.Activities.Remarks.Text="",this.Activities.Remarks.Xaml="",this.Activities.StartDate.Date=new Date,this.Activities.EndDate.Date=new Date,this.Activities.StartTime.SelectedValue="09:00:00 AM",this.Activities.EndTime.SelectedValue="09:30:00 AM",this.Activities.ActStartDate.Date=null,this.Activities.ActEndDate.Date=null,this.Activities.TotalDuration=0,this.Activities.laststartdate=null,this.Activities.ActStartTime.SelectedValue="",this.Activities.ActEndTime.SelectedValue="");!this.CloseVisible||this.Parent instanceof C||"AddEditDocumentViewModel"==this.Parent.ClassName&&this.Parent.ScreenObject.Preferences.ContainsKey("ActivityAsPopUp")&&"True"==this.Parent.ScreenObject.Preferences.ActivityAsPopUp.toString()||s.a.page.HideDialog()}else null!=this.Activities&&(this.Activities.Selectedrow=null,this.Activities.ActivityID=0,this.Activities.ActivityType.SelectedValue="1",this.Activities.StatusSelectedValue="412",this.Activities.Subject.Text="",this.Activities.Priority.SelectedValue="2",this.Activities.PctComplete.Text="",this.Activities.Location.Text="",this.Activities.IsAllDayActivity.IsChecked=!0,this.Activities.ActualCloseDate.Date=new Date,this.Activities.ActualCloseTime.SelectedValue="12:00 AM",this.Activities.Remarks.Text="",this.Activities.Remarks.Xaml="",this.Activities.ActStartDate.Date=null,this.Activities.ActEndDate.Date=null,this.Activities.TotalDuration=0,this.Activities.laststartdate=null,this.Activities.ActStartTime.SelectedValue="",this.Activities.ActEndTime.SelectedValue="");null!=this.Activities&&this.Activities.SetActions(),!(null===(D=this.Activities)||void 0===D?void 0:D.ActivityOnScreen)&&"AddEditDocumentViewModel"==this.Parent.ClassName&&this.Parent.ScreenObject.Preferences.ContainsKey("ActivityAsPopUp")&&"True"==this.Parent.ScreenObject.Preferences.ActivityAsPopUp.toString()?s.a.page.ShowDialog(this.Activities,y.ActivitiesComponent,{Title:s.a.GetResource("Activities")}):null!=this.Parent&&(this.Parent instanceof C||"AddEditLeads"==this.Parent.ClassName.toString()||"AddEditCasesViewModel"==this.Parent.ClassName.toString())&&this.Activities.IsPopup?(this.ActivitiesPopup=this.Activities,this.Parent.ActVisibility=!1,this.ActVisibility=!1,s.a.page.ShowDialog(this.ActivitiesPopup,y.ActivitiesComponent,{ShowCenter:!0,Title:s.a.GetResource("Activities")})):(this.Parent.ActVisibility=!0,this.ActVisibility=!0,s.a.page.ShowDialog(this.Activities,y.ActivitiesComponent,{Title:s.a.GetResource("Activities")}));break;case"DELETE":if(null!=this.SelectedRow){let t=0;"0"!=this.SelectedRow.ActivityID.toString()&&(t=parseInt(this.SelectedRow.ActivityID.toString())),this.ActivityGridData.Remove(this.SelectedRow),this.ActivityGridDataObj.refreshDataView(),t>0&&this.DeletedActivity.push(t)}break;case"Cancel":s.a.page.HideDialog()}Logger.InfoLog("ViewNoteViewModel::Exiting OnCmnItem_Click")}ActivitisActualData(){this.ActivityGridDataObj=new o.a;let t=this.BindActivityGridData();if(this.DS=s.a.cases.GetActivitiesCustomFields(this.CostCenterID,this.NodeID),null!=this.DS&&this.DS.Tables.length>0){let e=this.DS.Tables[0];for(let i=0;i<e.length;i++)e[i].SysColumnName.toString().Contains("Alpha")&&"LISTBOX"==e[i].UserColumnType.toString().toUpperCase()?(t=new n.a,t.Header=e[i].UserColumnName.toString(),t.DisplayMember=e[i].SysColumnName.toString(),t.DataType="ListBox",t.Width=150,t.IsVisible=!0,t.ReadOnly=!0,this.ActivityColumnSource.push(t),this.tempActivityGridDataColumn.push(e[i].SysColumnName.toString()+"_Key"),this.tempActivityGridDataColumn.push(e[i].SysColumnName.toString())):e[i].SysColumnName.toString().Contains("Alpha")&&(t=new n.a,t.Header=e[i].UserColumnName.toString(),t.DisplayMember=e[i].SysColumnName.toString(),t.DataType="TEXTBOX",t.Width=150,t.IsVisible=!0,t.ReadOnly=!0,this.ActivityColumnSource.push(t),this.tempActivityDataColumn.push(e[i].SysColumnName.toString()),this.tempActivityGridDataColumn.push(e[i].SysColumnName.toString())),e[i].SysColumnName.toString().Contains("CCNID")&&!this.tempActivityGridDataColumn.Contains(e[i].SysColumnName.toString()+"_Key")&&(t=new n.a,t.Header=e[i].UserColumnName.toString(),t.DisplayMember=e[i].SysColumnName.toString(),t.DataType="ListBox",t.Width=150,t.IsVisible=!0,t.ReadOnly=!0,this.ActivityColumnSource.push(t),this.tempActivityGridDataColumn.push(e[i].SysColumnName.toString()+"_Key"),this.tempActivityGridDataColumn.push(e[i].SysColumnName.toString()))}}BindActivityGridData(){let t;return this.ActivityColumnSource=[],t=new n.a,t.Header="View",t.DisplayMember="View",t.DataType="LINK",t.Width=70,t.IsVisible=!0,t.ReadOnly=!0,this.ActivityColumnSource.push(t),t=new n.a,t.Header="Activity",t.DisplayMember="Activity",t.Width=150,t.IsVisible=!0,t.ReadOnly=!0,this.ActivityColumnSource.push(t),t=new n.a,t.Header="Start Date",t.DisplayMember="ActStartDate",t.ValueMember="ActStartDate_Key",t.DataType="TEXTBOX",t.Width=100,t.IsVisible=!0,t.ReadOnly=!0,this.ActivityColumnSource.push(t),t=new n.a,t.Header="End Date",t.DisplayMember="ActEndDate",t.ValueMember="ActEndDate_Key",t.DataType="TEXTBOX",t.Width=100,t.IsVisible=!0,t.ReadOnly=!0,this.ActivityColumnSource.push(t),t=new n.a,t.Header="Subject",t.DisplayMember="Subject",t.DataType="TEXTBOX",t.Width=150,t.IsVisible=!0,t.ReadOnly=!0,this.ActivityColumnSource.push(t),this.Parent instanceof C&&(t=new n.a,t.Header="Contact",t.DisplayMember="CRMContactPerson",t.DataType="TEXTBOX",t.Width=120,t.IsVisible=!0,t.ReadOnly=!0,this.ActivityColumnSource.push(t)),t=new n.a,t.Header="Status",t.DisplayMember="Status",t.DataType="TEXTBOX",t.Width=60,t.IsVisible=!0,t.ReadOnly=!0,this.ActivityColumnSource.push(t),t=new n.a,t.Header="Customer",t.DisplayMember="CustomerID",t.DataType="TEXTBOX",t.Width=150,t.IsVisible=!0,t.ReadOnly=!0,this.ActivityColumnSource.push(t),t=new n.a,t.Header="Discussion",t.DisplayMember="Remarks",t.DataType="TEXTBOX",t.Width=200,t.IsVisible=!0,t.ReadOnly=!0,this.ActivityColumnSource.push(t),t=new n.a,t.Header="Location",t.DisplayMember="Location",t.DataType="TEXTBOX",t.Width=120,t.IsVisible=!1,t.ReadOnly=!0,this.ActivityColumnSource.push(t),t=new n.a,t.Header="Created by",t.DisplayMember="UserName",t.DataType="TEXTBOX",t.Width=150,t.IsVisible=!0,t.ReadOnly=!0,this.ActivityColumnSource.push(t),t=new n.a,t.Header="Created Date",t.DisplayMember="CreatedDate",t.DataType="TEXTBOX",t.Width=150,t.IsVisible=!0,t.ReadOnly=!0,this.ActivityColumnSource.push(t),t=new n.a,t.Header="Assign User",t.DisplayMember="AssignUser",t.DataType="TEXTBOX",t.Width=150,t.IsVisible=!0,t.ReadOnly=!0,this.ActivityColumnSource.push(t),t=new n.a,t.Header="Assign Date",t.DisplayMember="AssignDate",t.DataType="TEXTBOX",t.Width=150,t.IsVisible=!0,t.ReadOnly=!0,this.ActivityColumnSource.push(t),this.tempActivityGridDataColumn.push("View"),this.tempActivityGridDataColumn.push("Activity"),this.tempActivityGridDataColumn.push("Date"),this.tempActivityGridDataColumn.push("Subject"),this.tempActivityGridDataColumn.push("Status"),this.tempActivityGridDataColumn.push("CostCenterID"),this.tempActivityGridDataColumn.push("Schedule"),this.tempActivityGridDataColumn.push("ScheduleID"),this.tempActivityGridDataColumn.push("Recurrence"),this.tempActivityGridDataColumn.push("SchStatus"),this.tempActivityGridDataColumn.push("FreqType"),this.tempActivityGridDataColumn.push("FreqInterval"),this.tempActivityGridDataColumn.push("FreqSubdayType"),this.tempActivityGridDataColumn.push("FreqSubdayInterval"),this.tempActivityGridDataColumn.push("FreqRelativeInterval"),this.tempActivityGridDataColumn.push("FreqRecurrenceFactor"),this.tempActivityGridDataColumn.push("CStartDate"),this.tempActivityGridDataColumn.push("UserName"),this.tempActivityGridDataColumn.push("CEndDate"),this.tempActivityGridDataColumn.push("StartTime"),this.tempActivityGridDataColumn.push("strGroups"),this.tempActivityGridDataColumn.push("strRoles"),this.tempActivityGridDataColumn.push("strUsers"),this.tempActivityGridDataColumn.push("ActivityID"),this.tempActivityGridDataColumn.push("ActivityTypeID"),this.tempActivityGridDataColumn.push("NodeID"),this.tempActivityGridDataColumn.push("StatusID"),this.tempActivityGridDataColumn.push("Location"),this.tempActivityGridDataColumn.push("Priority"),this.tempActivityGridDataColumn.push("PctComplete"),this.tempActivityGridDataColumn.push("IsAllDayActivity"),this.tempActivityGridDataColumn.push("ActualCloseDate"),this.tempActivityGridDataColumn.push("ActualCloseDate_Key"),this.tempActivityGridDataColumn.push("ActualCloseTime"),this.tempActivityGridDataColumn.push("CustomerID"),this.tempActivityGridDataColumn.push("ContactID"),this.tempActivityGridDataColumn.push("Remarks"),this.tempActivityGridDataColumn.push("AssignGroupID"),this.tempActivityGridDataColumn.push("AssignRoleID"),this.tempActivityGridDataColumn.push("AssignUserID"),this.tempActivityGridDataColumn.push("ActStartDate"),this.tempActivityGridDataColumn.push("ActEndDate"),this.tempActivityGridDataColumn.push("ActStartDate_Key"),this.tempActivityGridDataColumn.push("ActEndDate_Key"),this.tempActivityGridDataColumn.push("ActStartTime"),this.tempActivityGridDataColumn.push("ActEndTime"),this.tempActivityGridDataColumn.push("UsersXML"),this.tempActivityGridDataColumn.push("RolesXML"),this.tempActivityGridDataColumn.push("GroupXML"),this.tempActivityGridDataColumn.push("TeamNodeID"),this.tempActivityGridDataColumn.push("UserID"),this.tempActivityGridDataColumn.push("isTeam"),this.tempActivityGridDataColumn.push("isEdited"),this.tempActivityGridDataColumn.push("SchID"),this.tempActivityGridDataColumn.push("AttachmentXML"),this.tempActivityGridDataColumn.push("CreatedDate"),this.tempActivityGridDataColumn.push("CreatedDate_Key"),this.tempActivityGridDataColumn.push("AssignUser"),this.tempActivityGridDataColumn.push("AssignDate"),this.tempActivityGridDataColumn.push("EndDateTime"),this.tempActivityGridDataColumn.push("EndDateTime_Key"),this.tempActivityGridDataColumn.push("StartDateTime"),this.tempActivityGridDataColumn.push("StartDateTime_Key"),this.tempActivityGridDataColumn.push("TotalDuration"),this.tempActivityGridDataColumn.push("LastStartDate"),this.Parent instanceof C&&this.tempActivityGridDataColumn.push("CRMContactPerson"),t}OnButtonClick(t){s.a.page.HideDialog()}onStatusSelectedChanged(t){if(null!=t&&null!=t){let e=[];"-1"==t.toString()?(this.FilterStatus="",e=this.ActivityGridData[0]):"1"==t.toString()?(this.FilterStatus="412",e=this.ActivityGridData.filter(t=>"412"==t.schStatus)):"2"==t.toString()?(this.FilterStatus="413",e=this.ActivityGridData.filter(t=>"413"==t.schStatus)):"3"==t.toString()?(this.FilterStatus="414",e=this.ActivityGridData.filter(t=>"414"==t.schStatus)):(this.FilterStatus="8",e=this.ActivityGridData.filter(t=>"8"==t.schStatus))}}LoadActivityData(t,e=""){let i=s.a.empService.GetQueryData(0,"dsetAssignedList",this.CostCenterID,this.NodeID,"");if(this.ActivityGridDataObj.Clear(),null==t||0==t.length)return;let n=null;n=""==e?t:t.filter(e),n.forEach(t=>{let e=this.ActivityGridDataObj.NewRow();e.View="View",e.ScheduleID=t.ScheduleID,e.SchID=t.ScheduleID,e.FreqType=t.FreqType,e.FreqInterval=t.FreqInterval,e.FreqSubdayType=t.FreqSubdayType,e.FreqSubdayInterval=t.FreqSubdayInterval,e.FreqRelativeInterval=t.FreqRelativeInterval,e.FreqRecurrenceFactor=t.FreqRecurrenceFactor,e.CStartDate=t.CStartDate,e.CEndDate=t.CEndDate,e.StartTime=t.StartTime,e.ActivityID=t.ActivityID,e.ActivityTypeID=a.e.String(t.ActivityTypeID),e.CostCenterID=89,e.NodeID="1",e.SchStatus=t.ActStatus.toString(),e.Subject=this.GetValidXmlReserve(t.ActSubject.toString()),e.Priority=a.e.String(t.Priority),e.PctComplete=a.e.String(t.PctComplete),e.Location=a.e.String(t.Location),e.IsAllDayActivity=t.IsAllDayActivity.toString().toUpperCase()=="True".toUpperCase()?"1":"0",e.ActualCloseDate=a.e.String(t.ActualCloseDate),e.ActualCloseTime=a.e.String(t.ActualCloseTime),e.CustomerID=this.GetValidXmlReserve(t.CustomerID.toString()),null!=t.CRMContactPerson&&e.CRMContactPerson&&(e.CRMContactPerson=t.CRMContactPerson.toString()),e.ContactID=t.ContactID?this.GetValidXmlReserve(t.ContactID.toString()):0,e.Remarks=this.GetValidXmlReserve(t.Remarks.toString()),null==t.UserName||a.e.IsEmpty(t.UserName)||(e.UserName=t.UserName.toString()),e.AssignGroupID="1",e.AssignRoleID="1",e.AssignUserID=a.e.String(t.AssignUserID),null!=t.CreatedDate&&(e.CreatedDate=new Date(t.CreatedDate).ToString(s.a.SessionManager.Preferences["Date Format"].toString()),e.CreatedDate_Key=new Date(t.CreatedDate)),a.e.IsEmpty(t.StartDateTime)||(e.StartDateTime=new Date(t.StartDateTime).ToString(s.a.SessionManager.Preferences["Date Format"].toString()),e.StartDateTime_Key=new Date(t.StartDateTime)),a.e.IsEmpty(t.EndDateTime)||(e.EndDateTime=new Date(t.EndDateTime).ToString(s.a.SessionManager.Preferences["Date Format"].toString()),e.EndDateTime_Key=new Date(t.EndDateTime)),a.e.IsEmpty(t.TotalDuration)||(e.TotalDuration=t.TotalDuration.toString()),a.e.IsEmpty(t.LastStartDate)||(e.LastStartDate=new Date(t.LastStartDate.toString())),a.e.IsEmpty(t.ActStartDate)||(e.ActStartDate=new Date(t.ActStartDate).ToString(s.a.SessionManager.Preferences["Date Format"].toString()),e.ActStartDate_Key=new Date(t.ActStartDate)),a.e.IsEmpty(t.ActEndDate)||(e.ActEndDate=new Date(t.ActEndDate).ToString(s.a.SessionManager.Preferences["Date Format"].toString()),e.ActEndDate_Key=new Date(t.ActEndDate)),a.e.IsEmpty(t.ActStartTime)||(e.ActStartTime=t.ActStartTime),a.e.IsEmpty(t.ActEndTime)||(e.ActEndTime=t.ActEndTime),"1"==a.e.String(t.ActivityTypeID)?e.Activity="Appointment Regular":"2"==a.e.String(t.ActivityTypeID)?e.Activity="Task Regular":"3"==a.e.String(t.ActivityTypeID)?e.Activity="Appointment Recurring":"3"==a.e.String(t.ActivityTypeID)&&(e.Activity="Task Recurring"),a.e.IsEmpty(t.ActualCloseDate)||(e.ActualCloseDate=new Date(t.ActualCloseDate.toString()).ToString(s.a.SessionManager.Preferences["Date Format"].toString()),e.ActualCloseDate_Key=new Date(t.ActualCloseDate)),e.Subject=this.GetValidXmlReserve(t.ActSubject.toString()),"412"==a.e.String(t.ActStatus)?e.Status="Open":"413"==a.e.String(t.ActStatus)?e.Status="Close":"414"==a.e.String(t.ActStatus)?e.Status="Re-Schedule":"8"==a.e.String(t.ActStatus)?e.Status="Confirmed":"9"==a.e.String(t.ActStatus)?e.Status="In-Progress":"12"==a.e.String(t.ActStatus)&&(e.Status="On-Hold");for(let i=0;i<this.tempActivityGridDataColumn.length;i++)this.tempActivityGridDataColumn[i].toLowerCase().Contains("alpha")&&Object.keys(t).Contains(this.tempActivityGridDataColumn[i])?e[this.tempActivityGridDataColumn[i]]=this.GetValidXmlReserve(t[this.tempActivityGridDataColumn[i]].toString()):this.tempActivityGridDataColumn[i].toUpperCase().Contains("CCNID")&&Object.keys(t).Contains(this.tempActivityGridDataColumn[i])&&Object.keys(t).Contains(this.tempActivityGridDataColumn[i]+"_Key")&&(e[this.tempActivityGridDataColumn[i]+"_Key"]=this.GetValidXmlReserve(t[this.tempActivityGridDataColumn[i]+"_Key"].toString()),e[this.tempActivityGridDataColumn[i]+""]=this.GetValidXmlReserve(t[this.tempActivityGridDataColumn[i]].toString()));let n="",r="",o="";if(null!=i&&i.Tables.length>0&&i.Tables[0].length>0){let l=i.Tables[0];if(null!=l&&null!=l){if(l=l.filter(e=>e.ISFROMACTIVITY==t.ActivityID&&e.USERID>1&&0==e.TeamNodeID),l.length>0)for(let t=0;t<l.length;t++)n+=l[t].USERID.toString()+",";if(e.UsersXML=n.Trim(","),l=i.Tables[0],l=l.filter(e=>e.ISFROMACTIVITY==t.ActivityID&&"True"==e.IsGroup),l.length>0)for(let t=0;t<l.length;t++)o+=l[t].TeamNodeID.toString()+",";if(e.GroupXML=o.Trim(","),l=i.Tables[0],l=l.filter(e=>e.ISFROMACTIVITY==t.ActivityID&&"True"==e.IsRole),l.length>0)for(let t=0;t<l.length;t++)r+=l[t].TeamNodeID.toString()+",";e.RolesXML=r.Trim(","),l=i.Tables[0],l=l.filter(e=>e.ISFROMACTIVITY==t.ActivityID&&e.TeamNodeID>1&&"True"==e.isTeam),l.length>0&&(e.TeamNodeID=l[0].TeamNodeID.toString(),e.isTeam="1"),l=i.Tables[0],l=l.filter(e=>e.ISFROMACTIVITY==t.ActivityID&&e.TeamNodeID>1&&e.UserID>0),l.length>0&&(e.TeamNodeID=l[0].TeamNodeID.toString(),e.isTeam="0",e.UserID=l[0].UserID.toString())}if(i.Tables.length>2){let r=i.Tables[2];null!=r&&null!=r&&(n="",r[0].ISFROMACTIVITY&&(r=r.filter(e=>e.ISFROMACTIVITY==t.ActivityID),r.length>0&&(e.AssignUser=r[0].UserData.toString(),a.e.IsEmpty(r[0].ActAssignDate)||(e.AssignDate=new Date(r[0].ActAssignDate).ToString(s.a.SessionManager.Preferences["Date Format"].toString()+" hh:mm:ss tt")))))}}if(null!=i&&i.Tables.length>0&&i.Tables[1].length>0){let s=i.Tables[1];if(null!=s&&null!=s){let n="";if(s=s.filter(e=>144==e.FeatureID&&e.FeaturePK==t.ActivityID),s.length>0){for(let t=0;t<s.length;t++)n+='<Row Action="MODIFY"',n+=' AttachmentID="'+s[t].FileID.toString()+'"',n+=' ActualFileName="'+s[t].ActualFileName.toString()+'"',n+=' RelativeFileName="'+s[t].RelativeFileName.toString()+'"',n+=' FileExtension="'+s[t].FileExtension+'"',n+=' GUID="'+s[t].GUID+'"',n+=' FileDescription="'+h.d.GetValidXml(s[t].FileDescription.toString())+'" ',n+=' IsProductImage="0"',!i.Columns[1].Contains("IsSign")||a.e.IsEmpty(s[t].IsSign)||"true"!=s[t].IsSign.toString().toLowerCase()&&"1"!=s[t].IsSign.toString()||(n+=' IsSign="1"'),n+="/>";n.length>0&&(n="<AttachmentsXML>"+n+"</AttachmentsXML>",e.AttachmentXML=n.toString())}}}this.ActivityGridDataObj.addRow(e)}),null!=this.SelectedRow&&(this.SelectedRow=null),null!=this.Activities&&(this.Activities.ClearFields(),this.Activities.OneActivity&&this.ActivityGridDataObj.Table.length>0&&(this.SelectedRow=this.ActivityGridDataObj.Table[0],this.OnCmnItem_Click("EDIT","EDIT")))}GetValidXmlReserve(t){return(t=(t=(t=t.Replace("&amp;","&")).Replace("''","'")).Replace("&quot;",'"')).Replace("&lt;","<")}ActivitiesXML(){var t;let e="";e+="<ScheduleActivityXml>";let i=1,s="";(null===(t=this.Activities)||void 0===t?void 0:t.OneActivity)&&this.Activities.onSaveActivity("Save"),this.ActivityGridDataObj.Table.forEach(t=>{if(!a.e.StringIsNullOrEmpty(t.Activity)){if(e+="<Row ",a.e.IsEmpty(t.ActivityID)||"0"==a.e.String(t.ActivityID)?(e+=' rowno="'+i+'" ',e+=' ActivityID="'+a.e.String(t.ActivityID)+'" ',i++):(e+=' rowno="0" ',e+=' ActivityID="'+a.e.String(t.ActivityID)+'"'),e+=' ScheduleID="'+a.e.String(t.ScheduleID)+'"',e+=' SchID="'+a.e.String(t.SchID)+'"',e+=' Status=""',e+=' FreqType="'+a.e.String(t.FreqType)+'"',e+=' FreqInterval="'+a.e.String(t.FreqInterval)+'"',e+=' FreqSubdayType="'+a.e.String(t.FreqSubdayType)+'"',e+=' FreqSubdayInterval="'+a.e.String(t.FreqSubdayInterval)+'"',e+=' FreqRelativeInterval="'+a.e.String(t.FreqRelativeInterval)+'"',e+=' FreqRecurrenceFactor="'+a.e.String(t.FreqRecurrenceFactor)+'"',""==a.e.String(t.CStartDate)?e+=' CStartDate=""':e+=' CStartDate="'+new Date(a.e.String(t.CStartDate)).ToString("dd/MMM/yyyy")+'"',""!=a.e.String(t.CEndDate)?e+=' CEndDate="'+new Date(a.e.String(t.CEndDate)).ToString("dd/MMM/yyyy")+'"':e+=' CEndDate=""',""==a.e.String(t.StartTime))e+=' StartTime=""';else{let i=new Date(a.e.String(t.StartTime));e+=' StartTime="'+i.getHours().PrefixZero(2)+":"+i.getMinutes().PrefixZero(2)+":"+i.getSeconds().PrefixZero(2)+'"'}"3"==a.e.String(t.ActivityTypeID)||"4"==a.e.String(t.ActivityTypeID)?(e+=' isRecu="1"',e+=' ActivityTypeID="'+a.e.String(t.ActivityTypeID)+'"'):(e+=' isRecu="0"',e+=' ActivityTypeID="'+a.e.String(t.ActivityTypeID)+'"'),e+=' CostCenterID="'+this.CostCenterID+'"',e+=' NodeID="'+this.NodeID+'"',e+=' StatusID="'+a.e.String(t.schStatus)+'"',e+=' Subject="'+this.GetValidXml(a.e.String(t.Subject))+'"',e+=' Priority="'+a.e.String(t.Priority)+'"',e+=' PctComplete="'+a.e.String(t.PctComplete)+'"',e+=' Location="'+this.GetValidXml(a.e.String(t.Location))+'"',e+=' IsAllDayActivity="'+("TRUE"==a.e.String(t.IsAllDayActivity).toUpperCase()?"1":"0")+'"';let r=new Date;if(a.e.IsEmpty(t.ActualCloseDate_Key))e+=' ActualCloseDate=""';else{try{r=new Date(a.e.String(t.ActualCloseDate_Key))}catch(n){}e+=' ActualCloseDate="'+r.ToString("dd/MMM/yyyy")+'"'}if(""==a.e.String(t.ActualCloseTime))e+=' ActualCloseTime=""';else{try{r=new Date(a.e.String(t.ActualCloseTime))}catch(n){}e+=' ActualCloseTime="'+r.ToString("dd/MMM/yyyy hh:mm:ss")+'"'}e+=' CustomerID="'+this.GetValidXml(a.e.String(t.CustomerID))+'"',null!=t.ContactID&&(e+=' ContactID="'+this.GetValidXml(a.e.String(t.ContactID))+'"'),e+=' Remarks="'+this.GetValidXml(a.e.String(t.Remarks))+'"',e+=' AssignGroupID="1"',e+=' AssignRoleID="1"',e+=' AssignUserID="'+a.e.String(t.AssignUserID)+'"',e+=' ActStartDate="'+new Date(a.e.String(t.ActStartDate_Key)).ToString("dd/MMM/yyyy")+'"',e+=' ActEndDate="'+new Date(a.e.String(t.ActEndDate_Key)).ToString("dd/MMM/yyyy")+'"',e+=' ActStartTime="'+a.e.String(t.ActStartTime)+'"',e+=' ActEndTime="'+a.e.String(t.ActEndTime)+'"',e+=' UsersXML="'+a.e.String(t.UsersXML)+'"',e+=' RolesXML="'+a.e.String(t.RolesXML)+'"',e+=' GroupXML="'+a.e.String(t.GroupXML)+'"',e+=' TeamNodeID="'+a.e.String(t.TeamNodeID)+'"',e+=' UserID="'+a.e.String(t.UserID)+'"',e+=' isTeam="'+a.e.String(t.isTeam)+'"';for(let e=1;e<=50;e++)this.tempActivityGridDataColumn.Contains("Alpha"+e)&&(s+="Alpha"+e+"='"+this.GetValidXml(a.e.String(t["Alpha"+e]))+"' ,");for(let e=1;e<=50;e++)this.tempActivityGridDataColumn.Contains("CCNID"+e)&&""!=a.e.String(t["CCNID"+e+"_Key"])&&(s+="CCNID"+e+"='"+("0"==a.e.String(t["CCNID"+e+"_Key"])?"1":a.e.String(t["CCNID"+e+"_Key"]))+"' ,");""!=s&&(e+=' ExtraUserDefinedFields ="'+s.substr(0,s.length-2)+'" '),e+=' AttachmentXML ="'+this.EncodedXMLString(a.e.String(t.AttachmentXML))+'" ',s="",null==t.isEdited||a.e.IsEmpty(t.isEdited)?e+=' isEdited="0"':e+=' isEdited="1"',e+="/>"}});for(let a=0;a<this.DeletedActivity.length;a++)e+='<DeleteRow Action="DELETE"',e+=' ActivityID="'+this.DeletedActivity[a].toString()+'"/>';return e+="</ScheduleActivityXml>",e.toString()}FMActivitiesXML(t){let e="";e+="<ScheduleActivityXml>";let i=1,s="";if(this.ActivityGridData.length>0&&!a.e.IsEmpty(this.ActivityGridData[t].activity)){if(e+="<Row ","0"==this.ActivityGridData[t].ActivityID.toString()||""==this.ActivityGridData[t].ActivityID.toString()?(e+=' rowno="'+i+'" ',e+=' ActivityID="'+this.ActivityGridData[t].ActivityID.toString()+'" ',i++):(e+=' rowno="0" ',e+=' ActivityID="'+this.ActivityGridData[t].ActivityID+'"'),e+=' ScheduleID="'+a.e.String(this.ActivityGridData[t].ScheduleID)+'"',e+=' SchID="'+a.e.String(this.ActivityGridData[t].SchID)+'"',e+=' Status=""',e+=' FreqType="'+a.e.String(this.ActivityGridData[t].FreqType)+'"',e+=' FreqInterval="'+a.e.String(this.ActivityGridData[t].FreqInterval)+'"',e+=' FreqSubdayType="'+a.e.String(this.ActivityGridData[t].FreqSubdayType)+'"',e+=' FreqSubdayInterval="'+a.e.String(this.ActivityGridData[t].FreqSubdayInterval)+'"',e+=' FreqRelativeInterval="'+a.e.String(this.ActivityGridData[t].FreqRelativeInterval)+'"',e+=' FreqRecurrenceFactor="'+a.e.String(this.ActivityGridData[t].FreqRecurrenceFactor)+'"',""==a.e.String(this.ActivityGridData[t].CStartDate)?e+=' CStartDate=""':e+=' CStartDate="'+new Date(this.ActivityGridData[t].CStartDate).ToString("dd/MMM/yyyy")+'"',""!=this.ActivityGridData[t].CEndDate.toString()?e+=' CEndDate="'+new Date(this.ActivityGridData[t].CEndDate).ToString("dd/MMM/yyyy")+'"':e+=' CEndDate=""',""==a.e.String(this.ActivityGridData[t].StartTime))e+=' StartTime=""';else{let i=new Date(this.ActivityGridData[t].StartTime);e+=' StartTime="'+i.getHours().ToString("00")+":"+i.getMinutes().ToString("00")+":"+i.getSeconds().ToString("00")+'"'}"3"==this.ActivityGridData[t].ActivityTypeID.toString()||"4"==this.ActivityGridData[t].ActivityTypeID.toString()?(e+=' isRecu="1"',e+=' ActivityTypeID="'+this.ActivityGridData[t].ActivityTypeID.toString()+'"'):(e+=' isRecu="0"',e+=' ActivityTypeID="'+this.ActivityGridData[t].ActivityTypeID.toString()+'"'),e+=' CostCenterID="'+this.CostCenterID+'"',e+=' NodeID="'+this.NodeID+'"',e+=' StatusID="'+this.ActivityGridData[t].schStatus.toString()+'"',e+=' Subject="'+this.GetValidXml(this.ActivityGridData[t].Subject.toString())+'"',e+=' Priority="'+this.ActivityGridData[t].Priority.toString()+'"',e+=' PctComplete="'+this.ActivityGridData[t].PctComplete.toString()+'"',e+=' Location="'+this.GetValidXml(this.ActivityGridData[t].Location.toString())+'"',e+=' IsAllDayActivity="'+("TRUE"==this.ActivityGridData[t].IsAllDayActivity.toString().toUpperCase()?"1":"0")+'"';let r=new Date;if(""==this.ActivityGridData[t].ActualCloseDate_Key.toString())e+=' ActualCloseDate=""';else{try{r=new Date(this.ActivityGridData[t].ActualCloseDate_Key)}catch(n){}e+=' ActualCloseDate="'+r.getDate().ToString("dd/MMM/yyyy")+'"'}if(""==a.e.String(this.ActivityGridData[t].ActualCloseTime))e+=' ActualCloseTime=""';else{try{r=new Date(this.ActivityGridData[t].ActualCloseTime)}catch(n){}e+=' ActualCloseTime="'+r.ToString("dd/MMM/yyyy hh:mm:ss")+'"'}e+=' CustomerID="'+this.GetValidXml(this.ActivityGridData[t].CustomerID.toString())+'"',this.tempActivityGridDataColumn.Contains("ContactID")&&(e+=' ContactID="'+this.GetValidXml(this.ActivityGridData[t].ContactID.toString())+'"'),e+=' Remarks="'+this.GetValidXml(this.ActivityGridData[t].Remarks.toString())+'"',e+=' AssignGroupID="1"',e+=' AssignRoleID="1"',e+=' AssignUserID="'+this.ActivityGridData[t].AssignUserID.toString()+'"',e+=' ActStartDate="'+new Date(this.ActivityGridData[t].ActStartDate_Key.toString()).ToString("dd/MMM/yyyy")+'"',e+=' ActEndDate="'+new Date(this.ActivityGridData[t].ActEndDate_Key.toString()).ToString("dd/MMM/yyyy")+'"',e+=' ActStartTime="'+this.ActivityGridData[t].ActStartTime.toString()+'"',e+=' ActEndTime="'+this.ActivityGridData[t].ActEndTime.toString()+'"',e+=' UsersXML="'+this.ActivityGridData[t].UsersXML.toString()+'"',e+=' RolesXML="'+this.ActivityGridData[t].RolesXML.toString()+'"',e+=' GroupXML="'+this.ActivityGridData[t].GroupXML.toString()+'"',e+=' TeamNodeID="'+this.ActivityGridData[t].TeamNodeID.toString()+'"',e+=' UserID="'+this.ActivityGridData[t].UserID.toString()+'"',e+=' isTeam="'+this.ActivityGridData[t].isTeam.toString()+'"';for(let e=1;e<=50;e++)this.tempActivityGridDataColumn.Contains("Alpha"+e)&&(s+="Alpha"+e+"='"+this.GetValidXml(this.ActivityGridData[t]["Alpha"+e].toString())+"' ,");for(let e=1;e<=50;e++)this.tempActivityGridDataColumn.Contains("CCNID"+e)&&""!=this.ActivityGridData[t]["CCNID"+e+"_Key"].toString()&&(s+="CCNID"+e+"='"+("0"==this.ActivityGridData[t]["CCNID"+e+"_Key"].toString()?"1":this.ActivityGridData[t]["CCNID"+e+"_Key"].toString())+"' ,");""!=s&&(e+=' ExtraUserDefinedFields ="'+s.substr(0,s.length-2)+'" '),e+=' AttachmentXML ="'+this.EncodedXMLString(this.ActivityGridData[t].AttachmentXML.toString())+'" ',s="",this.tempActivityGridDataColumn.Contains("isEdited")&&null!=this.ActivityGridData[t].isEdited&&""!=this.ActivityGridData[t].isEdited.toString()?e+=' isEdited="1"':e+=' isEdited="0"',e+="/>"}for(let a=0;a<this.DeletedActivity.length;a++)e+='<DeleteRow Action="DELETE"',e+=' ActivityID="'+this.DeletedActivity[a].toString()+'"/>';return e+="</ScheduleActivityXml>",e.toString()}EncodedXMLString(t){return a.e.IsEmpty(t)?"":t.replace("&","&amp;").replace("<","&lt;").replace(">","&gt;").replace('"',"&quot;")}GetValidXml(t){return(t=(t=(t=t.Replace("&","&amp;")).Replace("'","&apos;&apos;")).Replace('"',"&quot;")).Replace("<","&lt;")}returnTimeString(t){return t.length>1?t:("0"+t).toString()}}class C{constructor(){this.CostCenterID=0,this.NodeID=0,this.ActVisibility=!1,this.TextFields=[]}}},DKUf:function(t,e,i){"use strict";i.d(e,"a",(function(){return M}));var s=i("mrSG"),a=i("Do2H"),n=i("Lp6j"),r=i("eQJW"),o=i("xnJf"),l=i("8B8H"),h=i("4HhE"),c=i("EQd/"),u=i("0/4Q"),d=i("JIg3"),m=i("wlFP"),S=i("n56n"),y=i("CQvG"),A=i("NkMH"),D=i("OvA8"),C=i("Jnyl"),g=i("3Pt+"),p=i("ScVY"),b=i("OQq8"),v=i("ThyT"),T=i("SLWk"),I=i("ockk"),R=i("9WDa"),V=i("bgvB"),w=i("C58A");class M extends p.b{constructor(t,e){super(),this.Module="CASES",this.ClassName="ActivitiesViewModel",this.Visible=!0,this.ActivityOnScreen=!1,this.OneActivity=!1,this.AttachmentVisibility=!1,this.ViewAttachVisible=!1,this.ActivityDrawView=!1,this.ActSign=new V.c(0),this.tempActivitiesTempGridCol=[],this.ActVisibile=!0,this.FeatureWiseLable=new b.a,this.InviteLabel=new b.a,this.Fields=[],this.ColumnSpan="4",this.res="",this._ActivityID=0,this.ActivityText=new c.d(25130),this.Subject=new c.d(25135),this.Priority=new u.e(25136),this.Location=new c.d(25138),this.AssignUserList=new u.e(25144),this.PctComplete=new c.d(25137),this.StartDate=new d.a(26020),this.EndDate=new d.a(26021),this.StartTime=new u.e(25948),this.EndTime=new u.e(25949),this.IsAllDayActivity=new m.a(25139),this.ActualCloseDate=new d.a(25140),this.CRMCustomer=new S.c(25141),this.Remarks=new c.d(25142),this.HistoryVisibility=!0,this.ActivitiesVisibility=!0,this._AssignVisiblity=!0,this.Enabled=!0,this.AssignVisiblity2=!1,this.HeaderVisible=!0,this.ButtonsVisible=!0,this.RecrVisible=!1,this.CRMContactPerson=new S.b(0),this.CustomerType=new u.e(0),this.ActualCloseTime=new u.e(0),this.ActivityFrequency=new h.b,this.CustomerChangeCommand=new h.b,this.ActivityTypeSelectedChanged=new h.b,this.SaveActivity=new h.b,this.CancelActivity=new h.b,this.ViewHistory=new h.b,this.StatusSelectedChanged=new h.b,this.Click=new h.b,this.TimeChanged=new h.b,this.DateChanged=new h.b,this.dtPreferences=null,this.StatusVisible=!0,this.Status=new u.e(0),this.CheckdRecurPattern=0,this.CheckdMonthlyEvery=0,this.CheckdRangeEnd=0,this.Selectedrow=null,this._StatusSelectedText="0",this._StatusSelectedValue="412",this.FeatureLable="",this.CostCenterID=0,this.Width="230",this._IsPopup=!1,this.DisableCCFields=!0,this.UseActivityQuickAdd=!1,this.NodeID=0,this.ActVisibility=!1,this._SelectedStatusIndex=0,this.dr={},this.ActStartDate=new d.c(0),this.ActEndDate=new d.c(0),this.ActivityDuration="",this.ActStartTime=new u.e(0),this.ActEndTime=new u.e(0),this.StartVisible=!1,this.StopVisible=!1,this.HoldVisible=!1,this.StartStopVisible=!1,this.oText=null,this.oDate=null,this.oCombo=null,this.oTextArea=null,this.OComboText=null,this.oTime=null,this.FromCalendar=!1,this.TotalDuration=0,this.laststartdate=null,this.durtimer=null,this.Hrs=0,this.min=0,this.sec=0,this.SchID=-1e3,this.isView=!1,this.Customize=!1,this.objParent=t,this.ViewAttachments=new D.ViewAttachmentViewModel(this),this.Title=a.a.GetResource("Activities"),this.form=new g.j({}),this.dtPreferences=a.a.empService.GetQueryData(0,"ActivityPref","","",""),this.Exp=new c.d,this.Exp.DefaultValue="Test",this.InitCombobox(),this.InviteLabel.Visible=!1,this.FromCalendar=e,this.ActivityFrequency.Subscribe(this,"onActivityFrequancy"),this.CustomerType.SelectionChangedCommand.Subscribe(this,"OnCustomerTypeChange"),this.Recur=new w.RecurAppointmentViewModel(this),this.ActivitiesTempGrid=new l.a,this.AddActivityTempGridColumns(),this.Exp.Visible=!0,this.CRMCustomer.Text="",this.CRMCustomer.Code.SelectionChangedCommand.Subscribe(this,"onCustomerSelectionChange","Customer"),this.CRMContactPerson.CCID=65,this.CRMContactPerson.TypeID=1,this.SelectedStatusIndex=0,this.ActivityType.SelectedIndex=0,this.Exp.Visible=!1,this.ActSign.Visible=!1,this.PctComplete.Visible=!1,this.Priority.Visible=!1,this.ActivityText.Visible=!1,this.Location.Visible=!0,this.ActualCloseDate.Visible=!1,this.ActualCloseTime.Visible=!1,this.DateChanged.Subscribe(this,"OnStartDateChange"),this.Click.Subscribe(this,"OnClick"),this.TimeChanged.Subscribe(this,"OnTimeChanged"),this.ViewHistory.Subscribe(this,"onViewHistory"),this.AssignUserList.SelectedValue=a.a.SessionManager.UserID.toString(),this.ButtonSave=new A.a,this.ButtonCustomize=new A.a,this.ButtonAttachments=new A.a,this.ButtonReschedule=new A.a,this.CustomerType.SelectedValue="0",this.OnCustomerTypeChange(null),this.Remarks.RowSpan=4,this.AssignUserList.Enable=a.a.SessionManager.IsActionAssigned(1e3,"Assign"),this.AssignUserList.Enable?this.LoadAssignedUsers():(this.AssignUserList.Items.push(u.d.ComboBoxItems_2(a.a.SessionManager.UserName,a.a.SessionManager.UserID.toString())),this.AssignUserList.SelectedValue=a.a.SessionManager.UserID.toString()),this.buttonsAction(),this.CustomerType.Visible=!1,this.CRMCustomer.Visible=!0,this.CustomerType.Visible=null!=this.objParent&&1e3==this.objParent.CostCenterID,this.LoadData(t),this.enablecontrols(!0),this.FeatureWiseLable=new b.a,this.FeatureWiseLable.ClickCommand.Subscribe(this,"OnFeatureLableClick"),this.InviteLabel.ClickCommand.Subscribe(this,"OnFeatureLableClick"),this.FromCalendar?(this.FeatureWiseLable.Visible=!0,this.FeatureWiseLable.Label="test",this.FeatureWiseLable.DBColumnName="1",this.FeatureWiseLable.FeatureID=t.CostCenterID):this.FeatureWiseLable.Visible=!1,null!=this.objParent&&this.objParent.NodeID>0&&this.FilterSupplierBasedonCRMProduct(this.objParent.CostCenterID,this.objParent.NodeID)}OnShowAttachment(){}OnAddAttachment(){this.Attachment=new o.AddAttachmentViewModel,this.Attachment.AddAttachmentViewModel_2(this)}OnMessageCallBack(){this.res="Yes"}get ActivityID(){return this._ActivityID}set ActivityID(t){var e;this._ActivityID=t,0==this._ActivityID?this.InviteLabel.Visible=!1:201!=(null===(e=this.objParent)||void 0===e?void 0:e.DocumentType)&&(this.InviteLabel.Visible=!0)}OnSave(){Logger.InfoLog("AssignViewModel::Entering Save"),Logger.InfoLog("AssignViewModel::Exiting Save")}get AssignVisiblity(){return this._AssignVisiblity}set AssignVisiblity(t){0==t&&(this.AssignVisiblity2=!1),t!=this._AssignVisiblity&&(this._AssignVisiblity=t)}get StatusSelectedText(){return this._StatusSelectedText}set StatusSelectedText(t){t!=this._StatusSelectedText?(this._StatusSelectedText=t,this.Status.Text=this._StatusSelectedText):null==this.Status.Text&&(this.Status.Text=this._StatusSelectedText)}get StatusSelectedValue(){return this._StatusSelectedValue}set StatusSelectedValue(t){t!=this._StatusSelectedValue?(this._StatusSelectedValue=t,this.Status.SelectedValue=this._StatusSelectedValue):null==this.Status.SelectedValue&&(this.Status.SelectedValue=this._StatusSelectedValue)}SetErroMessage(t){}get IsPopup(){return this._IsPopup}set IsPopup(t){this._IsPopup!=t&&(this._IsPopup=t,this.AssignRowColumns())}get SelectedStatusIndex(){return this._SelectedStatusIndex}set SelectedStatusIndex(t){this._SelectedStatusIndex=t,this.Status.SelectedIndex=this._SelectedStatusIndex}onActivityTypeSelectedChanged(t){return Object(s.b)(this,void 0,void 0,(function*(){if(null==this.ActivityType.SelectedValue)return this.Exp.Visible=!1,this.PctComplete.Visible=!1,this.Priority.Visible=!1,this.ActivityText.Visible=!1,void(this.Location.Visible=!0);"1"==this.ActivityType.SelectedValue||"2"==this.ActivityType.SelectedValue?(this.Exp.Visible=!1,this.PctComplete.Visible=!1,this.Priority.Visible=!1,this.StartDate.Visible=!0,this.EndDate.Visible=!0,this.EndTime.Visible=!0,this.StartTime.Visible=!0,this.Location.Visible=!0,this.ActivityText.Visible=!1):"3"!=this.ActivityType.SelectedValue&&"4"!=this.ActivityType.SelectedValue||(this.Exp.Visible=!0,this.AssignRowColumns(),this.PctComplete.Visible=!1,this.Priority.Visible=!1,this.StartDate.Visible=!1,this.EndDate.Visible=!1,this.EndTime.Visible=!1,this.StartTime.Visible=!1,this.Location.Visible=!0,this.ActivityText.Visible=!0,this.Recur=new w.RecurAppointmentViewModel(this),this.ActivityText.Text="")}))}LoadCustomFields(t){let e=a.a.cases.GetActivitiesCustomFields(t);this.LoadCustomFields_DS(e)}LoadCustomFields_DS(t){this.Fields.Clear();let e=0,i=0,s=0,o="";if(null!=t&&t.Tables.length>3&&t.Tables[3].length>0){let e=t.Tables[3].filter(t=>"ActivityAsPopUp"==t.Name);this._IsPopup=e.length>0&&!n.e.IsEmpty(e[0].Value)&&Object(r.j)(e[0].Value.toString()),e=t.Tables[3].filter(t=>"DisableDimensionsatActivities"==t.Name),e.length>0&&!n.e.IsEmpty(e[0].Value)&&(this.DisableCCFields=Object(r.j)(e[0].Value.toString())),e=t.Tables[3].filter(t=>"ActivityFields"==t.Name),e.length>0&&!n.e.IsEmpty(e[0].Value)&&(o=e[0].Value.toString()),e=t.Tables[3].filter(t=>"UseActivityQuickAdd"==t.Name),e.length>0&&!n.e.IsEmpty(e[0].Value)&&(this.UseActivityQuickAdd=Object(r.j)(e[0].Value.toString()))}if(null!=this.objParent&&this.objParent instanceof y.a?this._IsPopup=!0:null==this.objParent||"QuickAddLeads"!=this.objParent.ClassName&&"QuickAddCaseViewModel"!=this.objParent.ClassName||(this._IsPopup=!1),e=0,this.IsPopup?(i=6,s=1):(i=14,s=4),null!=t&&t.Tables.length>0){for(let a=0;a<t.Tables[0].length;a++){if("TEXT"==t.Tables[0][a].UserColumnType.toString()||"NUMERIC"==t.Tables[0][a].UserColumnType.toString())"true"==t.Tables[0][a].Iscolumninuse.toString().toLowerCase()&&"true"==t.Tables[0][a].IsColumnUserDefined.toString().toLowerCase()&&(this.oText=new c.d(0),this.oText.Label=t.Tables[0][a].UserColumnName.toString(),this.oText.DBColumnName=t.Tables[0][a].CostCenterColID.toString(),this.oText.SysColumnName=t.Tables[0][a].SysColumnName.toString(),this.oText.Row=i,this.oText.Column=e,this.oText.ColumnSpan=s),this.Fields.push(this.oText);else if("DATE"==t.Tables[0][a].UserColumnType.toString())"true"==t.Tables[0][a].Iscolumninuse.toString().toLowerCase()&&"true"==t.Tables[0][a].IsColumnUserDefined.toString().toLowerCase()&&(this.oDate=new d.a(0),this.oDate.Label=t.Tables[0][a].UserColumnName.toString(),this.oDate.DBColumnName=t.Tables[0][a].CostCenterColID.toString(),this.oDate.SysColumnName=t.Tables[0][a].SysColumnName.toString(),this.oDate.Row=i,this.oDate.Column=e,this.oDate.ColumnSpan=s),this.Fields.push(this.oDate);else if("TIME"==t.Tables[0][a].UserColumnType.toString()){if("true"==t.Tables[0][a].Iscolumninuse.toString().toLowerCase()&&"true"==t.Tables[0][a].IsColumnUserDefined.toString().toLowerCase()){let n=new Date;this.oTime=new d.b(0),this.oTime.Label=t.Tables[0][a].UserColumnName.toString(),this.oTime.DBColumnName=t.Tables[0][a].CostCenterColID.toString(),this.oTime.SysColumnName=t.Tables[0][a].SysColumnName.toString(),this.oTime.ShowTimePicker=!0,this.oTime.CustomFormat="hh:mm:ss a",this.oTime.Date=new Date(1900,1,1,n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()),this.oTime.Row=i,this.oTime.Column=e,this.oTime.ColumnSpan=s}this.Fields.push(this.oTime)}else if("COMBOBOX"==t.Tables[0][a].UserColumnType.toString()){if("true"==t.Tables[0][a].Iscolumninuse.toString().toLowerCase()&&"true"==t.Tables[0][a].IsColumnUserDefined.toString().toLowerCase()){this.oCombo=new u.e(0),this.oCombo.Label=t.Tables[0][a].UserColumnName.toString(),this.oCombo.DBColumnName=t.Tables[0][a].CostCenterColID.toString(),this.oCombo.SysColumnName=t.Tables[0][a].SysColumnName.toString();let n=t.Tables[0][a].UserProbableValues.toString().Trim();if(n.length>0){let t=n.split(";");for(let e=0;e<t.length;e++)this.oCombo.Items.push(u.d.ComboBoxItems_2(t[e],t[e]));this.oCombo.SelectedValue=this.oCombo.Items[0].Value}this.oCombo.Row=i,this.oCombo.Column=e,this.oCombo.ColumnSpan=s}this.Fields.push(this.oCombo)}else"TEXTAREA"==t.Tables[0][a].UserColumnType.toString()?("true"==t.Tables[0][a].Iscolumninuse.toString().toLowerCase()&&"true"==t.Tables[0][a].IsColumnUserDefined.toString().toLowerCase()&&(this.oTextArea=new c.c(0),this.oTextArea.Label=t.Tables[0][a].UserColumnName.toString(),this.oTextArea.DBColumnName=t.Tables[0][a].CostCenterColID.toString(),this.oTextArea.SysColumnName=t.Tables[0][a].SysColumnName.toString(),this.oTextArea.Row=i,this.oTextArea.Column=e,this.oTextArea.ColumnSpan=s),this.Fields.push(this.oTextArea)):"COMBOTEXT"==t.Tables[0][a].UserColumnType.toString()?("true"==t.Tables[0][a].Iscolumninuse.toString().toLowerCase()&&"true"==t.Tables[0][a].IsColumnUserDefined.toString().toLowerCase()&&(this.OComboText=new C.a(0),this.OComboText.Label=t.Tables[0][a].UserColumnName.toString(),this.OComboText.DBColumnName=t.Tables[0][a].CostCenterColID.toString(),this.OComboText.SysColumnName=t.Tables[0][a].SysColumnName.toString(),this.OComboText.Row=i,this.OComboText.Column=e,this.OComboText.ColumnSpan=s),this.Fields.push(this.OComboText)):"LISTBOX"==t.Tables[0][a].UserColumnType.toString()&&("true"==t.Tables[0][a].Iscolumninuse.toString().toLowerCase()&&"true"==t.Tables[0][a].IsColumnUserDefined.toString().toLowerCase()&&(this.oPactCombo=new S.b(0),this.oPactCombo.CCID=parseInt(t.Tables[0][a].ColumnCostCenterID),this.oPactCombo.TypeID=0==t.Tables[0][a].ColumnCCListViewTypeID.toString().Trim().length?1:parseInt(t.Tables[0][a].ColumnCCListViewTypeID),this.oPactCombo.Label=t.Tables[0][a].UserColumnName.toString(),this.oPactCombo.DBColumnName=t.Tables[0][a].CostCenterColID.toString(),this.oPactCombo.SysColumnName=t.Tables[0][a].SysColumnName.toString(),this.oPactCombo.DBColumnID=parseInt(t.Tables[0][a].ColumnCostCenterID),this.oPactCombo.Row=i,this.oPactCombo.Column=e,this.oPactCombo.ColumnSpan=s),this.Fields.push(this.oPactCombo));this.IsPopup?3==e?(i+=1,e=0):e+=1:i+=1}if(t.Tables.length>1&&t.Columns[1].Contains("SysColumnName")&&t.Tables[1].length>0)for(let e=0;e<t.Tables[1].length;e++)null!=(l=this.Fields.find(i=>i.SysColumnName.toUpperCase()==t.Tables[1][e].SysColumnName.toString().toUpperCase()))&&null!=l&&this.DisableCCFields&&(l.IsReadOnly=!0);if(t.Tables.length>2&&t.Columns[2].Contains("CostCenterColIDBase")&&t.Tables[2].length>0)for(let e=0;e<t.Tables[2].length;e++){var l;null!=(l=this.Fields.find(i=>i.DBColumnName==t.Tables[2][e].CostCenterColIDBase.toString()))&&null!=l&&(l.IsReadOnly=!0)}this.UseActivityQuickAdd&&t.Tables.length>3&&t.Tables[4].length>0?this.ArrangeQiuckScreen(t.Tables[4]):!this.UseActivityQuickAdd&&t.Tables.length>3&&t.Tables[4].length>0&&this.AssignProperties(t.Tables[4])}this.AssignRowColumns(o),this.ButtonSave.Visible=a.a.SessionManager.IsActionAssigned(1e3,this.ActivityID>0?"Activity_Edit":"Activity_Create")}RecurInitialize(){return Object(s.b)(this,void 0,void 0,(function*(){const{RecurAppointmentViewModel:t}=yield Promise.resolve().then(i.bind(null,"C58A"));this.Recur=new t(this)}))}AssignProperties(t){try{let e=t.find(t=>"StatusID"==t.SysColumnName);this.Status.Mandatory=e.length>0&&parseInt(e[0].IsMandatory)>0,e=t.find(t=>"Subject"==t.SysColumnName),this.Subject.Mandatory=e.length>0&&parseInt(e[0].IsMandatory)>0,e=t.find(t=>"CustomerType"==t.SysColumnName),this.CustomerType.Mandatory=e.length>0&&parseInt(e[0].IsMandatory)>0,e=t.find(t=>"ContactID"==t.SysColumnName),this.CRMContactPerson.Mandatory=e.length>0&&parseInt(e[0].IsMandatory)>0}catch(e){}}LoadData(t){return Object(s.b)(this,void 0,void 0,(function*(){if(null!=t){if(null==this.objParent||"QuickAddLeads"!=this.objParent.ClassName){const{AssignFeatureViewModel:e}=yield Promise.all([i.e(23),i.e(131)]).then(i.bind(null,"2Dtv"));this.AssignFeature=new e,this.AssignFeature.AssignFeatureViewModel_1(this.objParent.ViewActivities,t.NodeID,t.CostCenterID),this.HistoryVisibility=!("AddEditDocumentViewModel"!=t.ClassName||this.objParent.ScreenObject.Preferences.ContainsKey("ActivityAsPopUp")&&"True"==this.objParent.ScreenObject.Preferences.ActivityAsPopUp.toString())}null!=this.objParent.ViewActivities&&null!=this.objParent.ViewActivities.DS?this.LoadCustomFields_DS(this.objParent.ViewActivities.DS):this.LoadCustomFields(this.objParent.CostCenterID)}}))}SetActions(){if(this.StartStopVisible=!1,null!=this.durtimer&&(this.durtimer.Enabled=!1),this.EnableStart&&0!=this.ActivityID){if(this.StartStopVisible=!0,this.StartVisible=!1,this.StopVisible=!1,this.HoldVisible=!1,"8"==this.Status.SelectedValue||"12"==this.Status.SelectedValue||"412"==this.Status.SelectedValue||"414"==this.Status.SelectedValue)this.StartVisible=!0;else if("9"==this.Status.SelectedValue){this.HoldVisible=this.StopVisible=!0;let t=0;this.laststartdate&&this.laststartdate<new Date&&(t=n.e.GetDatesTotalMinutes(new Date,this.laststartdate),this.TotalDuration+=t,null==this.durtimer&&(this.durtimer=new n.d,this.durtimer.Interval=1e3,this.durtimer.Elapsed(this,"durtimer_Elapsed")),this.sec=0,this.durtimer.Enabled=!0)}this.Hrs=parseFloat(Math.round(this.TotalDuration/60).toString()),this.min=this.TotalDuration%60,this.ActivityDuration=this.Hrs.toString()+"."+this.min.toString()+"."+this.sec.toString()}}durtimer_Elapsed(t,e){this.sec+=1,60==this.sec&&(this.sec=0,this.min+=1,60==this.min&&(this.Hrs+=1,this.min=0)),this.ActivityDuration=this.Hrs.toString()+"."+this.min.toString()+"."+this.sec.toString()}buttonsAction(){0==this.ActivityID?a.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=a.a.SessionManager.IsActionAssigned(1e3,"Activity_Create"):this.ButtonSave.Enable=a.a.SessionManager.IsActionAssigned(1e3,"Activity_Create"):a.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=a.a.SessionManager.IsActionAssigned(1e3,"Activity_Edit"):this.ButtonSave.Enable=a.a.SessionManager.IsActionAssigned(1e3,"Activity_Edit"),a.a.SessionManager.HideUnathorizedAccess?this.ButtonReschedule.Visible=a.a.SessionManager.IsActionAssigned(1e3,"ReSchedule"):this.ButtonReschedule.Enable=a.a.SessionManager.IsActionAssigned(1e3,"ReSchedule"),a.a.SessionManager.HideUnathorizedAccess?this.ButtonCustomize.Visible=a.a.SessionManager.IsActionAssigned(1e3,"Customize"):this.ButtonCustomize.Enable=a.a.SessionManager.IsActionAssigned(1e3,"Customize"),a.a.SessionManager.HideUnathorizedAccess?this.ButtonAttachments.Visible=a.a.SessionManager.IsActionAssigned(1e3,"Attachment"):this.ButtonAttachments.Enable=a.a.SessionManager.IsActionAssigned(1e3,"Attachment")}AssignRowColumns(t=""){let e=null;if(""!=t?e=t.split(","):"AddEditDocumentViewModel"==this.objParent.ClassName&&this.objParent.ScreenObject.Preferences.ContainsKey("ActivityFields")&&""!=this.objParent.ScreenObject.Preferences.ActivityFields.toString()&&(e=this.objParent.ScreenObject.Preferences.ActivityFields.toString().split(",")),this.ActivityType.Label=a.a.GetResource("Activities_ActivityTypeName"),this.Status.Label=a.a.GetResource("Activities_Status"),this.Subject.Label=a.a.GetResource("Activities_Subject"),this.Priority.Label=a.a.GetResource("Activities_Priority"),this.Location.Label=a.a.GetResource("Activities_Location"),this.PctComplete.Label=a.a.GetResource("Activities_PctComplete"),this.Exp.Label=a.a.GetResource("Activities_Schedule"),this.StartDate.Label=a.a.GetResource("StartDate"),this.EndDate.Label=a.a.GetResource("EndDate"),this.IsAllDayActivity.Label=a.a.GetResource("Activities_IsAllDayActivity"),this.ActualCloseDate.Label=a.a.GetResource("Activities_ActualCloseDate"),this.ActualCloseTime.Label=a.a.GetResource("Activities_ActualCloseTime"),this.AssignUserList.Label=a.a.GetResource("Activities_AssignedTo"),this.CustomerType.Label=a.a.GetResource("Activities_CustomerType"),this.CRMContactPerson.Label=a.a.GetResource("Com_Contacts_ContactPerson"),this.Remarks.Label=a.a.GetResource("Activities_Remarks"),this.ActStartDate.Label="Actual Start Date",this.ActEndDate.Label="Actual End Date",this.ActStartDate.Visible=this.ActEndDate.Visible=!!this.EnableStart,this.IsPopup){this.Width="900";let t=new Array;4==this.ActivityType.ColumnSpan&&(this.ActivityType.ColumnSpan=3),4==this.Status.ColumnSpan&&(this.Status.ColumnSpan=3),4==this.Subject.ColumnSpan&&(this.Subject.ColumnSpan=3),4==this.StartDate.ColumnSpan&&(this.StartDate.ColumnSpan=1),4==this.EndDate.ColumnSpan&&(this.EndDate.ColumnSpan=1),null!=e&&e.length>1?(this.ActivityType.Visible=!1,this.Status.Visible=!1,this.Subject.Visible=!1,this.Priority.Visible=!1,this.PctComplete.Visible=!1,this.CRMCustomer.Visible=!1,this.CRMContactPerson.Visible=!1,this.StartDate.Visible=!1,this.EndDate.Visible=!1,this.IsAllDayActivity.Visible=!1,this.ActualCloseDate.Visible=!1,this.AssignUserList.Visible=!1,this.Remarks.Visible=!1,this.ActStartDate.Visible=!1,this.ActEndDate.Visible=!1,this.ActSign.Visible=!1,e.forEach(e=>{switch(e){case"ActivityTypeID":this.ActivityType.Visible=!0,t.push(this.ActivityType);break;case"StatusID":this.Status.Visible=!0,t.push(this.Status);break;case"Subject":this.Subject.Visible=!0,t.push(this.Subject);break;case"Priority":this.Priority.Visible=!0,t.push(this.Priority);break;case"PctComplete":this.PctComplete.Visible=!0,t.push(this.PctComplete);break;case"CustomerID":this.CRMCustomer.Visible=!0,t.push(this.CRMCustomer);break;case"ContactId":this.CRMContactPerson.Visible=!0,t.push(this.CRMContactPerson);break;case"StartDate":this.StartDate.Visible=!0,t.push(this.StartDate);break;case"EndDate":this.EndDate.Visible=!0,t.push(this.EndDate);break;case"IsAllDayActivity":this.IsAllDayActivity.Visible=!0,t.push(this.IsAllDayActivity);break;case"ActualCloseDate":this.ActualCloseTime.Visible=!0,t.push(this.ActualCloseDate),t.push(this.ActualCloseTime);break;case"AssignGroupID":this.AssignUserList.Visible=!0,t.push(this.AssignUserList);break;case"Remarks":this.Remarks.Visible=!0;break;case"ActStartDate":this.ActStartDate.Visible=!0,t.push(this.ActStartDate);break;case"ActEndDate":this.ActEndDate.Visible=!0,t.push(this.ActEndDate);break;case"Sign":this.ActSign.Visible=!0,this.ActivityDrawView=!0}})):(t.push(this.ActivityType),t.push(this.Status),t.push(this.Subject),t.push(this.StartDate),t.push(this.EndDate),"3"!=this.ActivityType.SelectedValue&&"4"!=this.ActivityType.SelectedValue||t.push(this.Exp),t.push(this.IsAllDayActivity),t.push(this.ActualCloseDate),t.push(this.ActualCloseTime),t.push(this.AssignUserList),t.push(this.ActStartDate),t.push(this.ActEndDate),t.push(this.CustomerType),t.push(this.CRMCustomer),t.push(this.CRMContactPerson)),this.Setposition(t),this.Remarks.Visible&&(this.Remarks.Row=0,this.Remarks.Column=3),this.ViewAttachments.Row="5",this.ViewAttachments.Column="0",this.ViewAttachments.ColumnSpan=4}else if(this.FeatureWiseLable.Row=10,this.Width="230",null!=e&&e.length>1){this.ActivityType.Visible=!1,this.Status.Visible=!1,this.Subject.Visible=!1,this.Priority.Visible=!1,this.PctComplete.Visible=!1,this.CRMCustomer.Visible=!1,this.CRMContactPerson.Visible=!1,this.StartDate.Visible=!1,this.EndDate.Visible=!1,this.IsAllDayActivity.Visible=!1,this.ActualCloseDate.Visible=!1,this.AssignUserList.Visible=!1,this.Remarks.Visible=!1,this.ActStartDate.Visible=!1,this.ActEndDate.Visible=!1,this.ActSign.Visible=!1;let t=1;for(let i=0;i<e.length;i++,t++)switch(e[i]){case"ActivityTypeID":this.ActivityType.Row=t,this.ActivityType.Column=0,this.ActivityType.ColumnSpan=4,this.ActivityType.Visible=!0;break;case"StatusID":this.Status.Row=t,this.Status.Column=0,this.Status.ColumnSpan=4,this.Status.Visible=!0;break;case"Subject":this.Subject.Row=t,this.Subject.Column=0,this.Subject.ColumnSpan=4,this.Subject.Visible=!0;break;case"Priority":this.Priority.Row=t,this.Priority.Column=0,this.Priority.ColumnSpan=4,this.Priority.Visible=!0;break;case"PctComplete":this.PctComplete.Row=t,this.PctComplete.Column=0,this.PctComplete.ColumnSpan=4,this.PctComplete.Visible=!0;break;case"CustomerID":this.CRMCustomer.Row=t,this.CRMCustomer.Column=0,this.CRMCustomer.ColumnSpan=4,this.CRMCustomer.Visible=!0;break;case"ContactId":this.CRMContactPerson.Row=t,this.CRMContactPerson.Column=0,this.CRMContactPerson.ColumnSpan=4,this.CRMContactPerson.Visible=!0;break;case"StartDate":this.StartDate.Row=t,this.StartDate.Column=0,this.StartDate.ColumnSpan=4,this.StartDate.Visible=!0;break;case"EndDate":this.EndDate.Row=t,this.EndDate.Column=0,this.EndDate.ColumnSpan=4,this.EndDate.Visible=!0;break;case"IsAllDayActivity":this.IsAllDayActivity.Row=t,this.IsAllDayActivity.Column=0,this.IsAllDayActivity.ColumnSpan=4,this.IsAllDayActivity.Visible=!0;break;case"ActualCloseDate":this.ActualCloseDate.Row=t,this.ActualCloseDate.Column=0,this.ActualCloseDate.ColumnSpan=4,this.ActualCloseDate.Visible=!0,t++,this.ActualCloseTime.Row=t,this.ActualCloseTime.Column=0,this.ActualCloseTime.ColumnSpan=4,this.ActualCloseTime.Visible=!0;break;case"AssignGroupID":this.AssignUserList.Row=t,this.AssignUserList.Column=0,this.AssignUserList.ColumnSpan=4,this.AssignUserList.Visible=!0;break;case"Remarks":this.Remarks.Row=t,this.Remarks.Column=0,this.Remarks.ColumnSpan=4,this.Remarks.Visible=!0,t+=3;break;case"ActStartDate":this.ActStartDate.Row=t,this.ActStartDate.Column=0,this.ActStartDate.ColumnSpan=4,this.ActStartDate.Visible=!0;break;case"ActEndDate":this.ActEndDate.Row=t,this.ActEndDate.Column=0,this.ActEndDate.ColumnSpan=4,this.ActEndDate.Visible=!0;break;case"Sign":this.ActSign.Row=t,this.ActSign.Column=0,this.ActSign.ColumnSpan=4,this.ActSign.Visible=!0,t++}}else this.ActivityType.Row=1,this.ActivityType.Column=0,this.ActivityType.ColumnSpan=4,this.Status.Row=2,this.Status.Column=0,this.Status.ColumnSpan=4,this.Subject.Row=3,this.Subject.Column=0,this.Subject.ColumnSpan=4,this.Exp.Row=4,this.Exp.Column=0,this.Exp.ColumnSpan=4,this.StartDate.Row=4,this.StartDate.Column=0,this.StartDate.ColumnSpan=4,this.EndDate.Row=5,this.EndDate.Column=0,this.EndDate.ColumnSpan=4,this.IsAllDayActivity.Row=6,this.IsAllDayActivity.Column=0,this.IsAllDayActivity.ColumnSpan=4,this.ActualCloseDate.Row=7,this.ActualCloseDate.Column=0,this.ActualCloseDate.ColumnSpan=4,this.ActualCloseTime.Row=7,this.ActualCloseTime.Column=0,this.ActualCloseTime.ColumnSpan=4,this.CustomerType.Row=8,this.CustomerType.Column=0,this.CustomerType.ColumnSpan=4,this.CRMCustomer.Row=9,this.CRMCustomer.Column=0,this.CRMCustomer.ColumnSpan=4,this.CRMContactPerson.Row=10,this.CRMContactPerson.Column=0,this.CRMContactPerson.ColumnSpan=4,this.AssignUserList.Row=11,this.AssignUserList.Column=0,this.AssignUserList.ColumnSpan=4,this.ActStartDate.Row=12,this.ActStartDate.Column=0,this.ActStartDate.ColumnSpan=4,this.ActEndDate.Row=13,this.ActEndDate.Column=0,this.ActEndDate.ColumnSpan=4,this.Remarks.Row=14,this.Remarks.Column=0,this.Remarks.ColumnSpan=4,this.ViewAttachments.Row="15",this.ViewAttachments.Column="0"}Setposition(t){let e=0,i=0,s=1;for(let a=0;a<t.length;a++){let r=t[a];null!=r&&r.Visible&&(s=1,s=n.e.Int(r.ColumnSpan),s<1&&(s=1),i+s>3&&(e++,i=0),r.Row=e,r.Column=i,i+=s)}}CheckSign(){}ArrangeQiuckScreen(t){let e=t.filter(t=>"ActivityTypeID"==t.SysColumnName);e.length>0?(this.ActivityType.Label=e[0].ResourceData.toString(),this.ActivityType.Row=e[0].QuickAddOrder):this.ActivityType.Visible=!1,e=t.filter(t=>"StatusID"==t.SysColumnName),e.length>0?(this.Status.Label=e[0].ResourceData.toString(),this.Status.Row=e[0].QuickAddOrder):this.Status.Visible=!1,e=t.filter(t=>"Subject"==t.SysColumnName),e.length>0?(this.Subject.Label=e[0].ResourceData.toString(),this.Subject.Row=e[0].QuickAddOrder):this.Subject.Visible=!1,e=t.filter(t=>"Priority"==t.SysColumnName),e.length>0?(this.Priority.Label=e[0].ResourceData.toString(),this.Priority.Row=e[0].QuickAddOrder):this.Priority.Visible=!1,e=t.filter(t=>"Location"==t.SysColumnName),e.length>0?(this.Location.Label=e[0].ResourceData.toString(),this.Location.Row=e[0].QuickAddOrder):this.Location.Visible=!1,e=t.filter(t=>"PctComplete"==t.SysColumnName),e.length>0?(this.PctComplete.Label=e[0].ResourceData.toString(),this.PctComplete.Row=e[0].QuickAddOrder):this.PctComplete.Visible=!1,e=t.filter(t=>"ScheduleID"==t.SysColumnName),e.length>0?(this.Exp.Label=e[0].ResourceData.toString(),this.Exp.Row=e[0].QuickAddOrder):this.Exp.Visible=!1,e=t.filter(t=>"StartDate"==t.SysColumnName),e.length>0?(this.StartDate.Label=e[0].ResourceData.toString(),this.StartDate.Row=e[0].QuickAddOrder):this.StartDate.Visible=!1,e=t.filter(t=>"EndDate"==t.SysColumnName),e.length>0?(this.EndDate.Label=e[0].ResourceData.toString(),this.EndDate.Row=e[0].QuickAddOrder):this.EndDate.Visible=!1,e=t.filter(t=>"IsAllDayActivity"==t.SysColumnName),e.length>0?(this.IsAllDayActivity.Label=e[0].ResourceData.toString(),this.IsAllDayActivity.Row=e[0].QuickAddOrder):this.IsAllDayActivity.Visible=!1,e=t.filter(t=>"ActualCloseDate"==t.SysColumnName),e.length>0?(this.ActualCloseDate.Label=e[0].ResourceData.toString(),this.ActualCloseDate.Row=e[0].QuickAddOrder):this.ActualCloseDate.Visible=!1,e=t.filter(t=>"ActualCloseTime"==t.SysColumnName),e.length>0?(this.ActualCloseTime.Label=e[0].ResourceData.toString(),this.ActualCloseTime.Row=e[0].QuickAddOrder):this.ActualCloseTime.Visible=!1,e=t.filter(t=>"CustomerType"==t.SysColumnName),e.length>0?(this.CustomerType.Label=e[0].ResourceData.toString(),this.CustomerType.Row=e[0].QuickAddOrder):this.CustomerType.Visible=!1,e=t.filter(t=>"CustomerID"==t.SysColumnName),e.length>0?(this.CRMCustomer.Label=e[0].ResourceData.toString(),this.CRMCustomer.Row=e[0].QuickAddOrder):this.CRMCustomer.Visible=!1,e=t.filter(t=>"ContactID"==t.SysColumnName),e.length>0?(this.CRMContactPerson.Label=e[0].ResourceData.toString(),this.CRMContactPerson.Row=e[0].QuickAddOrder):this.CRMContactPerson.Visible=!1,e=t.filter(t=>"AssignUserID"==t.SysColumnName),e.length>0?(this.AssignUserList.Label=e[0].ResourceData.toString(),this.AssignUserList.Row=e[0].QuickAddOrder):this.AssignUserList.Visible=!1,e=t.filter(t=>"Remarks"==t.SysColumnName),e.length>0?(this.Remarks.Label=e[0].ResourceData.toString(),this.Remarks.Row=e[0].QuickAddOrder):this.Remarks.Visible=!1,this.Fields.forEach(i=>{e=t.filter(t=>t.SysColumnName==i.SysColumnName),e.length>0?(i.Label=e[0].ResourceData.toString(),i.Row=e[0].QuickAddOrder):i.Visible=!1}),this.ViewAttachments.Row=t.length.toString()}FilterSupplierBasedonCRMProduct(t,e){if(86==t||89==t){let i=a.a.cases.GetSuppliersByCRMProduct(t,e),s=-1;if(null!=i&&i.Tables.length>0&&i.Columns[0].Contains("MapCCID")&&i.Tables[0].length>0){let t,e,a="";for(let s=0;s<i.Tables[0].length;s++)a+=i.Tables[0][s][i.Columns[0][0]]+",";if(s=parseInt(i.Tables[0][0].MapCCID),0==a.length)return;for(let i=0;i<this.Fields.length;i++)if(t=this.Fields[i],null!=t&&t instanceof S.b&&t.DBColumnID==s){e=t,e.CustomWhere=" a.NodeID  in ("+a.TrimEnd(",")+")",e.Refresh();break}}}}OnStartDateChange(t){"StartDate"==t.toString()?new Date(this.EndDate.Date)<new Date(this.StartDate.Date)&&(this.EndDate.Date=this.StartDate.Date):"EndDate"==t.toString()&&new Date(this.StartDate.Date)>new Date(this.EndDate.Date)&&(this.EndDate.Date=this.StartDate.Date)}OnFeatureLableClick(t){return Object(s.b)(this,void 0,void 0,(function*(){if("Invite"==t.toString()){if("413"==this.StatusSelectedValue)alert("Activity is closed");else if(this.ActivityID>0){const{AssignFeatureViewModel:t}=yield Promise.all([i.e(23),i.e(131)]).then(i.bind(null,"2Dtv")),{AssignFeatureComponent:e}=yield Promise.resolve().then(i.bind(null,"yWgc"));a.a.page.ShowDialog((new t).AssignFeatureViewModel_1(this,this.ActivityID,this.CostCenterID),e,{ShowCenter:!0,Title:a.a.GetResource("View Activities")})}}else if("Attendees"==t.toString()){if(this.ActivityID>0){let t=a.a.cases.GetAttendiesList(this.ActivityID);if(null!=t&&t.Tables.length>0){if(!(t.Tables[0].length>0))return void alert("No Intivitations");{const{InvitesViewModel:e}=yield i.e(133).then(i.bind(null,"UlzB")),{InvitesComponent:s}=yield i.e(134).then(i.bind(null,"dvUr"));a.a.page.ShowDialog((new e).InvitesViewModel_2(a.a.SessionManager.UserID,t,!1,this.ActivityID),s,{ShowCenter:!0,Title:a.a.GetResource("Invites")})}}}}else if(0!=this.FeatureWiseLable.FeatureID){const{RibbonExtViewModel:t}=yield Promise.resolve().then(i.bind(null,"CUWK"));t.LoadScreenFromActivity(this.FeatureWiseLable)}}))}ActivitiesViewModel(){this.dtPreferences=a.a.common.GetDataSet("ACT001",""),this.Exp=new c.d,this.Exp.DefaultValue="Test",this.Exp.Visible=!1,this.CRMContactPerson.CCID=65,this.ActivitiesTempGrid=new l.a,this.ActivitiesTempGrid.Table=[],this.AddActivityTempGridColumns(),this.ViewActivities=new y.b(this),this.ViewAttachments=new D.ViewAttachmentViewModel(this),this.InitCombobox(),this.ButtonSave=new A.a,this.LoadAssignedUsers()}onViewHistory(t){a.a.page.ShowDialog(this.objParent.ViewActivities,v.ViewActivitiesComponent,{ShowCenter:!0,Title:a.a.GetResource("View Activities"),VarWidth:!0})}OnTimeChanged(t){let e;null!=t&&(e=parseInt(t.toString()),e<=this.StartTime.SelectedIndex)&&(this.EndTime.SelectedIndex=this.StartTime.SelectedIndex+1)}OnClick(t){const e=t;"1"==this.ActivityType.SelectedValue.toString()&&(1==e.IsChecked?(this.StartTime.SelectedValue="12:30:00 AM",this.EndTime.SelectedValue="12:30:00 AM",this.StartTime.Enable=!1,this.EndTime.Enable=!1):(this.StartTime.SelectedValue="08:00:00 AM",this.EndTime.SelectedValue="08:30:00 AM",this.StartTime.Enable=!0,this.EndTime.Enable=!0))}onActivityFrequancy(){return Object(s.b)(this,void 0,void 0,(function*(){const{RecurAppointmentComponent:t}=yield Promise.resolve().then(i.bind(null,"8PvV"));a.a.page.ShowDialog(this.Recur,t,{ShowCenter:!0}).subscribe(()=>{this.Recur.isOk&&(0==this.ActivityID&&(this.SchID=this.SchID<0?this.SchID-1:-1e3),this.ActivityText.Text=this.Recur.FrequencyText,this.ActivitiesTempGrid.Table.Clear(),this.GenerateActivity(this.SchID))})}))}IsPopupRecur(){}OnCustomerTypeChange(t){"1"==this.CustomerType.SelectedValue?(this.CRMCustomer.Code.Visible=!0,this.CRMCustomer.TextVisible=!1,this.CRMCustomer.Code.CCID=2,this.CRMCustomer.Label="Account",this.CRMCustomer.Code.TypeID=2,this.CRMCustomer.Code.CustomWhere="",this.CRMCustomer.Code.SelectedValue=0,this.CRMCustomer.Code.Refresh()):"2"==this.CustomerType.SelectedValue?(this.CRMCustomer.Code.Visible=!0,this.CRMCustomer.TextVisible=!1,this.CRMCustomer.Code.CCID=83,this.CRMCustomer.Label="Customer",this.CRMCustomer.Code.TypeID=1,this.CRMCustomer.Code.SelectedValue=0,this.CRMCustomer.Code.Refresh()):(this.CRMCustomer.Label="Customer",this.CRMCustomer.Code.Visible=!1,this.CRMCustomer.TextVisible=!0)}onCustomerSelectionChange(t){null!=t&&"Customer"==t.toString()&&(this.CRMCustomer.Code.SelectedValue>0?(this.CRMCustomer.Code.Visible||this.CRMCustomer.Code.SelectedValue>0)&&(83==this.CRMCustomer.Code.CCID?(this.CRMContactPerson.CustomWhere="a.Featurepk ="+this.CRMCustomer.Code.SelectedValue+" and a.Featureid=83  ",this.CRMContactPerson.Refresh(),this.CRMContactPerson.SelectedIndex=0):2==this.CRMCustomer.Code.CCID&&(this.CRMContactPerson.CustomWhere="a.Featurepk ="+this.CRMCustomer.Code.SelectedValue+" and a.Featureid=2  ",this.CRMContactPerson.Refresh(),this.CRMContactPerson.SelectedIndex=0)):83==this.CRMCustomer.Code.CCID?(this.CRMContactPerson.CustomWhere=" a.Featureid=83  ",this.CRMContactPerson.Refresh(),this.CRMContactPerson.SelectedIndex=0):2==this.CRMCustomer.Code.CCID&&(this.CRMContactPerson.CustomWhere="  a.Featureid=2  ",this.CRMContactPerson.Refresh(),this.CRMContactPerson.SelectedIndex=0))}InitCombobox(){this.Status=new u.e,this.Status.Items.push(u.d.ComboBoxItems_2("Open","412")),this.Status.Items.push(u.d.ComboBoxItems_2("Confirmed","8")),this.Status.Items.push(u.d.ComboBoxItems_2("In-Progress","9")),this.Status.Items.push(u.d.ComboBoxItems_2("On-Hold","12")),this.Status.Items.push(u.d.ComboBoxItems_2("Close","413")),this.Status.Items.push(u.d.ComboBoxItems_2("Re-Schedule","414")),this.CustomerType=new u.e(0),this.CustomerType.Items.push(u.d.ComboBoxItems_2("None","0")),this.CustomerType.Items.push(u.d.ComboBoxItems_2("Account","1")),this.CustomerType.Items.push(u.d.ComboBoxItems_2("CRM-Customers","2")),this.ActivityType=new u.e(0),this.ActivityType.Items=[],this.ActivityType.Items.push(u.d.ComboBoxItems_2("Appointment Regular","1")),this.ActivityType.Items.push(u.d.ComboBoxItems_2("Appointment Recurring","3")),a.a.SessionManager.IsActionAssigned(1e3,"Task Regular")&&this.ActivityType.Items.push(u.d.ComboBoxItems_2("Task Regular","2")),a.a.SessionManager.IsActionAssigned(1e3,"Task Recurring")&&this.ActivityType.Items.push(u.d.ComboBoxItems_2("Task Recurring","4")),this.ActivityType.SelectionChangedCommand.Subscribe(this,"onActivityTypeSelectedChanged"),this.SaveActivity.Subscribe(this,"onSaveActivity"),this.CancelActivity.Subscribe(this,"onCancelActivity"),this.Status.SelectionChangedCommand.Subscribe(this,"onStatusSelectedChanged"),this.ActivityType.SelectedValue="1",this.Priority.Items.push(u.d.ComboBoxItems_2("Low","1")),this.Priority.Items.push(u.d.ComboBoxItems_2("Normal","2")),this.Priority.Items.push(u.d.ComboBoxItems_2("High","3")),this.Priority.SelectedIndex=1,this.Priority.SelectedValue="2";let t=0,e="08:00:00 AM",i="08:00:00 AM",s=this.dtPreferences.Tables[0].filter(t=>"ActivityDuration"==t.Name);s.length>0&&!n.e.IsEmpty(s[0].value)&&(t=n.e.Int(s[0].value)),s=this.dtPreferences.Tables[0].filter(t=>"ActivityStartTime"==t.Name),null!=s&&s.length>0&&!n.e.IsEmpty(s[0].value)&&(e=s[0].value.toString()),s=this.dtPreferences.Tables[0].filter(t=>"ActivityEndTime"==t.Name),null!=s&&s.length>0&&!n.e.IsEmpty(s[0].value)&&(i=s[0].value.toString()),"AddEditDocumentViewModel"==this.objParent.ClassName?(this.EnableStart=!(!this.objParent.ScreenObject.Preferences.ContainsKey("EnableStart")||"True"!=this.objParent.ScreenObject.Preferences.EnableStart.toString()),this.IsPopup=!(!this.objParent.ScreenObject.Preferences.ContainsKey("ActivityAsPopUp")||"True"!=this.objParent.ScreenObject.Preferences.ActivityAsPopUp.toString())):(s=this.dtPreferences.Tables[0].filter(t=>"EnableStart"==t.Name),null!=s&&s.length>0&&!n.e.IsEmpty(s[0].value)&&(this.EnableStart=s[0].value.toString(),this.EnableStart=Object(r.j)(s[0].value.toString()))),0==t&&(t=30);let o=a.a.cases.TimeChange(e,i,t);for(let a=0;a<o;a++){let i="";i=Date.WithTime(e).AddMinutes(a*t).ToString("hh:mm:ss a"),this.ActualCloseTime.Items.push(u.d.ComboBoxItems_2(i,i)),this.StartTime.Items.push(u.d.ComboBoxItems_2(i,i)),this.EndTime.Items.push(u.d.ComboBoxItems_2(i,i))}s=this.dtPreferences.Tables[0].filter(t=>"ActivityDefaultStartTime"==t.Name),null!=s&&s.length>0&&!n.e.IsEmpty(s[0].Value)?(this.StartTime.SelectedValue=s[0].Value.toString(),this.StartTime.SelectedIndex=this.StartTime.Items.indexOf(this.StartTime.Items.find(t=>t.Value==s[0].Value.toString()))):(this.StartTime.SelectedValue=e,this.StartTime.SelectedIndex=0),s=this.dtPreferences.Tables[0].filter(t=>"ActivityDefaultEndTime"==t.Name),null!=s&&s.length>0&&!n.e.IsEmpty(s[0].Value)?(this.EndTime.SelectedValue=s[0].Value.toString(),this.EndTime.SelectedIndex=this.EndTime.Items.indexOf(this.EndTime.Items.find(t=>t.Value==s[0].Value.toString()))):(this.EndTime.SelectedValue=Date.WithTime(e).AddMinutes(t).ToString("hh:mm:ss a"),this.EndTime.SelectedIndex=1)}onStatusSelectedChanged(t){if(!(this.objParent.ClassName=this.objParent.ScreenObject.Preferences.ContainsKey("ActivityFields")&&""!=this.objParent.ScreenObject.Preferences.ActivityFields.toString()))return null==this.StatusSelectedValue?(this.ActualCloseDate.Visible=!1,this.ActualCloseTime.Visible=!1,this.StartDate.Visible=!1,this.StartTime.Visible=!1,this.EndDate.Visible=!1,void(this.EndTime.Visible=!1)):void("412"==this.StatusSelectedValue.toString()||"414"==this.StatusSelectedValue.toString()?(this.ActualCloseDate.Visible=!1,this.ActualCloseTime.Visible=!1,this.StartDate.Visible=!0,this.StartTime.Visible=!0,this.EndDate.Visible=!0,this.EndTime.Visible=!0,this.StartDate.Enable=!0,this.StartTime.Enable=!0,this.EndDate.Enable=!0,this.EndTime.Enable=!0,"3"!=this.ActivityType.SelectedValue&&"4"!=this.ActivityType.SelectedValue||this.AssignRowColumns()):"413"==this.StatusSelectedValue.toString()&&(this.ActualCloseDate.Visible=!0,this.ActualCloseTime.Visible=!0,this.ActualCloseDate.Date=new Date,this.StartDate.Visible=!0,this.StartTime.Visible=!0,this.EndDate.Visible=!0,this.EndTime.Visible=!0,this.StartDate.Enable=!1,this.StartTime.Enable=!1,this.EndDate.Enable=!1,this.EndTime.Enable=!1))}onCancelActivity(t){"Customize"==t.toString()?this.Customize=!0:"Attachment"==t.toString()?(this.OnAddAttachment(),this.ActivityOnScreen||(this.ActVisibile=!1),this.ViewAttachVisible=!0,this.AttachmentVisibility=!0,a.a.page.ShowDialog(this.Attachment,R.a,{Title:"Attachment"}).subscribe(()=>{this.ActVisibile=!0,this.ViewAttachVisible=!0,this.AttachmentVisibility=!1})):a.a.page.HideDialog()}GenerateActivity(t){let e=1,i=0;try{e=parseInt(this.Recur.Occurrences.Text)}catch(a){}let s=new Date(this.Recur.FirstPostingDate.Date.toString()).AddDays(-1);if(this.Recur.RecurrencePattern.Items[1].IsChecked)for(this.Recur.FreqInterval=parseInt(this.Recur.DailyEvery.Items[0].GroupName);i<e;)s=s.AddDays(this.Recur.FreqInterval),this.AddRows(s,t),i++;else if(this.Recur.RecurrencePattern.Items[2].IsChecked){if(this.Recur.WeeklyDays.Items.filter(t=>1==t.IsChecked).length>0)for(this.Recur.FreqInterval=parseInt(this.Recur.WeeklyRecurEvery.Text),i=0;;){let a=s.getDay();for(let n=0;n<7;n++,a++){if(7==a&&(a=0),this.Recur.WeeklyDays.Items[a].IsChecked&&(this.AddRows(s,t),i++,i>=e))return;s=s.AddDays(1)}this.Recur.FreqInterval>1&&(s=s.AddDays(7*(this.Recur.FreqInterval-1)))}}else if(this.Recur.RecurrencePattern.Items[3].IsChecked)if(this.Recur.MonthlyEvery.Items[0].IsChecked){if(this.Recur.FreqInterval=parseInt(this.Recur.MonthlyDayOf.Text),this.Recur.FreqRecurrenceFactor=parseInt(this.Recur.MonthlyDayMonths.Text),this.Recur.FreqInterval<s.getDate())s=s.AddMonths(1),s=s.AddDays(s.getDate()-this.Recur.FreqInterval),this.Recur.FirstPostingDate.Date=s;else try{s=new Date(s.getFullYear(),s.getMonth(),this.Recur.FreqInterval)}catch(n){try{s=new Date(s.getFullYear(),s.getMonth(),this.Recur.FreqInterval-1)}catch(r){try{s=new Date(s.getFullYear(),s.getMonth(),this.Recur.FreqInterval-2)}catch(o){try{s=new Date(s.getFullYear(),s.getMonth(),this.Recur.FreqInterval-3)}catch(l){}}}}for(;i<e;)s=s.AddMonths(this.Recur.FreqRecurrenceFactor),this.AddRows(s,t),i++}else if("8"==this.Recur.MonthlyTheWeekDay.SelectedValue)for("1"==this.Recur.MonthlyTheFirst.SelectedValue?1!=s.getDate()&&(s=new Date(s.getFullYear(),s.getMonth(),1).AddMonths(1)):"16"==this.Recur.MonthlyTheFirst.SelectedValue&&(s=new Date(s.getFullYear(),s.getMonth(),1).AddMonths(1).AddDays(-1)),this.Recur.FreqRecurrenceFactor=parseInt(this.Recur.MonthlyTheMonths.Text);i<e;)s="16"==this.Recur.MonthlyTheFirst.SelectedValue?new Date(s.getFullYear(),s.getMonth(),1).AddMonths(this.Recur.FreqRecurrenceFactor+1).AddDays(-1):s.AddMonths(this.Recur.FreqRecurrenceFactor),this.AddRows(s,t),i++;else for(this.Recur.FreqRecurrenceFactor=parseInt(this.Recur.MonthlyTheMonths.Text);i<e;)s=s.AddMonths(this.Recur.FreqRecurrenceFactor),this.AddRows(s,t),i++}AddRows(t,e){null!=this.Recur.StartingTime.SelectedValue&&""!=this.Recur.StartingTime.SelectedValue&&(t=new Date(t.ToString("dd/MMM/yyyy")+" "+this.Recur.StartingTime.SelectedValue));let i=this.ActivitiesTempGrid.addNewRowEmpty();i.sno=this.ActivitiesTempGrid.Table.length+1,i.StartDate=t.ToString(a.a.SessionManager.Preferences["Date Format"]+" hh:mm a"),i.StartTime=t.ToString("hh:mm a"),i.StartDate_Key=t,i.EndDate=t.ToString(a.a.SessionManager.Preferences["Date Format"]+" hh:mm a"),i.EndTime=t.ToString("hh:mm a"),i.EndDate_Key=t,i.Status="Schedule",i.ActivityID=this.ActivityID,i.SchID=e,this.ActivitiesTempGrid.Table.push(i)}AddActivityTempGridColumns(){this.ActivitiesTempGrid.Table=[],this.tempActivitiesTempGridCol.push("sno"),this.tempActivitiesTempGridCol.push("StartDate"),this.tempActivitiesTempGridCol.push("StartDate_Key"),this.tempActivitiesTempGridCol.push("StartTime"),this.tempActivitiesTempGridCol.push("EndDate"),this.tempActivitiesTempGridCol.push("EndDate_Key"),this.tempActivitiesTempGridCol.push("EndTime"),this.tempActivitiesTempGridCol.push("Status"),this.tempActivitiesTempGridCol.push("ActivityID"),this.tempActivitiesTempGridCol.push("SchID")}LoadAssignedUsers(){let t=null;if(t=a.a.empService.GetQueryData(0,"LoadAssignedUsers","","",""),"1"!=a.a.SessionManager.UserID&&this.AssignUserList.Items.push(u.d.ComboBoxItems_2(a.a.SessionManager.UserName,a.a.SessionManager.UserID.toString())),null!=t&&t.Tables.length>0&&t.Tables[0].length>0&&t.Columns[0].Contains("UserName"))for(let e=0;e<t.Tables[0].length;e++)this.AssignUserList.Items.push(u.d.ComboBoxItems_2(t.Tables[0][e].UserName.toString(),t.Tables[0][e].UserID.toString()))}onSaveActivity(t){return Object(s.b)(this,void 0,void 0,(function*(){let e={Latitude:"",Longitude:"",Address1:"",Address2:"",City:"",State:"",Country:"",PinCode:""};if(null!=t&&"ViewSign"==t.toString()){let t=this.ViewAttachments.AttachmentsList.find(t=>t.IsSign);return void(null!=t&&t.OpenFile())}if(null!=t&&("Start"==t.toString()||"Stop"==t.toString()||"Hold"==t.toString())){try{let t=yield n.e.UserCurrentLocation();null!=t&&(e.Latitude=t.coords.latitude,e.Longitude=t.coords.longitude,null!=t.address?(e.Address1=t.address.Address1,e.Address2=t.address.Address2,e.City=t.address.City,e.State=t.address.State,e.Country=t.address.Country,e.PinCode=t.address.PinCode):e.Address1=yield n.e.GetUsersCurrentAddress(t))}catch(o){}let i=new Date,s=0;"Start"==t.toString()?(s=1,"9"==this.Status.SelectedValue&&(s=2)):"Stop"==t.toString()?s=4:"Hold"==t.toString()&&(s=3);let r=new E;if("Start"==t.toString()){r.FromDate.Label="Start Date";for(let t=0;t<this.StartTime.Items.length;t++)r.FromTime.Items.push(u.d.ComboBoxItems_2(this.StartTime.Items[t].Name,this.StartTime.Items[t].Value))}else{"Stop"==t.toString()?r.FromDate.Label="End Date":(r.FromDate.Label="Hold Date",r.Reason.Visible=!0,r.Reason.Label="Reason");for(let t=0;t<this.EndTime.Items.length;t++)r.FromTime.Items.push(u.d.ComboBoxItems_2(this.EndTime.Items[t].Name,this.EndTime.Items[t].Value))}let l=(new Date).ToString("hh:mm:ss a");return r.FromTime.AddItem(l,l),r.FromTime.SelectedValue=l,void a.a.page.ShowDialog(r,T.a,{ShowCenter:!0,Title:r.Title},()=>{if(r.DailogResult&&r.DailogResult){i=n.e.IsEmpty(r.FromTime.SelectedValue)?r.FromDate.Date:new Date(r.FromDate.Date.ToString("dd/MMM/yyyy")+" "+r.FromTime.SelectedValue);let o=[];o.push(this.ActivityID),o.push(i),o.push(s),r.Reason.Visible&&!n.e.IsEmpty(r.Reason.Text)?o.push(r.Reason.Text):o.push(""),o.push(e.Longitude),o.push(e.Latitude),o.push(e.Address1),o.push(e.Address2),o.push(e.City),o.push(e.State),o.push(e.Country),o.push(e.PinCode),o.push(a.a.SessionManager.CompanyGUID),o.push(a.a.SessionManager.UserName),o.push(a.a.SessionManager.LanguageID);let l=a.a.cases.SetActivityLog(o);if(this.DisplayMessage=l.obj.MessageText,this.MessageVisibility=!0,l.obj.RetValue>0)return"Start"==t.toString()?(1==s&&(this.ActStartDate.Date=i,this.ActStartTime.AddItem(i.ToString("hh:mm:ss a"),i.ToString("hh:mm:ss a")),this.ActStartTime.SelectedValue=i.ToString("hh:mm:ss a"),this.laststartdate=i),this.Status.SelectedValue="9"):"Stop"==t.toString()?(this.Status.SelectedValue="413",this.ActEndDate.Date=i,this.ActEndTime.AddItem(i.ToString("hh:mm:ss a"),i.ToString("hh:mm:ss a")),this.ActEndTime.SelectedValue=i.ToString("hh:mm:ss a"),null!=l&&l.Tables.length>0&&l.Tables[0].length>0&&l.Columns[0].Contains("duration")&&""!=l.Tables[0][0].duration.toString()&&(this.TotalDuration=parseInt(l.Tables[0][0].duration.toString())),this.laststartdate=null):(this.Status.SelectedValue="12",null!=l&&l.Tables.length>0&&l.Tables[0].length>0&&l.Columns[0].Contains("duration")&&""!=l.Tables[0][0].duration.toString()&&(this.TotalDuration=parseInt(l.Tables[0][0].duration.toString())),this.laststartdate=null),void this.SetActions()}})}if(null!=t&&"Detail"==t.toString()){let t=[];t.push(this.ActivityID),t.push((new Date).ToString("dd/MMM/yyyy")),t.push(10),t.push(""),t.push(e.Longitude),t.push(e.Latitude),t.push(e.Address1),t.push(e.Address2),t.push(e.City),t.push(e.State),t.push(e.Country),t.push(e.PinCode),t.push(a.a.SessionManager.CompanyGUID),t.push(a.a.SessionManager.UserName),t.push(a.a.SessionManager.LanguageID);let i=a.a.cases.SetActivityLog(t),s=new E;s.Title="History",s.PickDateViewModel(1),s.DetailGrid.Table=[],s.DetailGrid.TableColumns.push("StartDate"),s.DetailGrid.TableColumns.push("StartDate_Key"),s.DetailGrid.TableColumns.push("EndDate"),s.DetailGrid.TableColumns.push("EndDate_Key"),s.DetailGrid.TableColumns.push("Remarks"),s.DetailGrid.Columns=[];let r=new I.a;r.Header="Start",r.DisplayMember="StartDate",r.Width=130,s.DetailGrid.Columns.push(r),r=new I.a,r.Header="End",r.DisplayMember="EndDate",r.Width=130,s.DetailGrid.Columns.push(r),r=new I.a,r.Header="Reason",r.DisplayMember="Remarks",r.Width=150,s.DetailGrid.Columns.push(r);for(let e=0;e<i.Tables[0].length;e++){let t=s.DetailGrid.NewRow();n.e.IsEmpty(i.Tables[0][e].StartDate)||(t.StartDate_Key=new Date(i.Tables[0][e].StartDate.toString()),t.StartDate=new Date(i.Tables[0][e].StartDate.toString()).ToString(a.a.SessionManager.Preferences["Date Format"]+" hh:mm a")),n.e.IsEmpty(i.Tables[0][e].EndDate)||(t.EndDate_Key=new Date(i.Tables[0][e].EndDate.toString()),t.EndDate=new Date(i.Tables[0][e].EndDate.toString()).ToString(a.a.SessionManager.Preferences["Date Format"]+" hh:mm a")),t.Remarks=n.e.StringValue(i.Tables[0][e].Remarks),s.DetailGrid.addRow(t)}return void a.a.page.ShowDialog(s,T.a,{ShowCenter:!0,Title:s.Title})}if(n.e.IsEmpty(this.Status.SelectedValue))return void alert("Select Status");if(this.Status.Mandatory&&n.e.IsEmpty(this.Status.SelectedValue))return void alert("Please Select the Status");if(this.Subject.Mandatory&&n.e.IsEmpty(this.Subject.Text))return void alert("Please Enter the subject");if(this.CustomerType.Mandatory&&n.e.IsEmpty(this.CustomerType.SelectedValue))return void alert("Please Select the customer type");if(this.CRMContactPerson.Mandatory&&n.e.IsEmpty(this.CRMContactPerson.Text))return void alert("Please Select the Contact Person");if(null!=this.dtPreferences&&this.dtPreferences.Tables.length>0)try{if(this.StatusSelectedValue=this.Status.SelectedValue,"413"==this.StatusSelectedValue){let t=this.dtPreferences.Tables[0].filter(t=>"AttachmentAtClosedActivity"==t.Name);if(t.length>0&&""!=t[0].value.toString()&&Object(r.j)(t[0].value)&&null!=this.ViewAttachments&&0==this.ViewAttachments.AttachmentsList.length)return void alert("Please Include Attachment,While Closing Activity")}}catch(l){}this.res="No";let s=-1;if("ReSchedule"==t.toString()&&this.ActivityID>0){const{MessageDialogViewModel:t}=yield i.e(118).then(i.bind(null,"gk6P")),{MessageDialogViewModelComponent:e}=yield i.e(0).then(i.bind(null,"cc1I"));let n=new t;n.MessageDialogViewModel_3(this,a.a.GetResource("Reschedule: This action will close current event and creates a new event with selected date & time. \r\nDo you want to continue?"),"Yes","No"),n.Date.Visible=!0,n.Date.Label="Reschedule Date",n.Date.Date=this.StartDate.Date,n.StartTime.Visible=!0;for(let i=0;i<this.StartTime.Items.length;i++)n.StartTime.Items.push(this.StartTime.Items[i]);return n.StartTime.SelectedValue=this.StartTime.SelectedValue,void a.a.page.ShowDialog(n,e,{ShowCenter:!0,Title:n.lblTitle}).subscribe(()=>{"Yes"==this.res&&(this.StartTime.SelectedValue=n.StartTime.SelectedValue,this.StartDate.Date=n.Date.Date,s=1,this.onSaveActivity_Complete(s))})}if("ReSchedule"!=t.toString()||0!=this.ActivityID){if(this.objParent.Activities=this,this.MessageVisibility=!1,this.DisplayMessage="",null!=this.StartDate.Date&&null!=this.EndDate.Date&&(new Date(this.StartDate.Date)>new Date(this.EndDate.Date)||new Date(this.EndDate.Date)<new Date(this.StartDate.Date)))return this.MessageVisibility=!0,void(this.DisplayMessage="Invalid Date Selection");if(a.a.SessionManager.IsActionAssigned(1e3,"Do not allow future dated activities")||a.a.SessionManager.IsActionAssigned(1e3,"Do not allow past dated activities")){let t=a.a.empService.GetQueryData(0,"getdate","","","");if(a.a.SessionManager.IsActionAssigned(1e3,"Do not allow future dated activities")&&this.StartDate.Date>new Date(t.Tables[0][0][Object.keys(t.Tables[0][0])[0]]).AddDays(a.a.SessionManager.GetActionDays(1e3,"Do not allow future dated activities")))return this.MessageVisibility=!0,void(this.DisplayMessage="Future date activities not allowed");if(a.a.SessionManager.IsActionAssigned(1e3,"Do not allow past dated activities")&&this.StartDate.Date<new Date(t.Tables[0][0][Object.keys(t.Tables[0][0])[0]]).AddDays(-a.a.SessionManager.GetActionDays(1e3,"Do not allow past dated activities")))return this.MessageVisibility=!0,void(this.DisplayMessage="Back dated activities not allowed")}this.onSaveActivity_Complete(s)}}))}onSaveActivity_Complete(t){return Object(s.b)(this,void 0,void 0,(function*(){if(this.FromCalendar){let e=1,i=0;if("3"==this.ActivityType.SelectedValue||"4"==this.ActivityType.SelectedValue){e=this.ActivitiesTempGrid.Table.length;let t=a.a.common.GetDataSet("CALACT001","");null!=t&&t.Tables[0].length>0&&(i=n.e.IsEmpty(t.Tables[0][0][t.Columns[0][0]])?1:parseInt(t.Tables[0][0][t.Columns[0][0]]))}this.ActivityID>0&&(e=1);for(let s=0;s<e;s++){let e=null,r=[];r.push(parseInt(this.ActivityType.SelectedValue)),r.push(0),"RCalenderViewModel"==this.objParent.ClassName?(e=this.objParent,r.push(-100!=e.CCID?e.CCID:1e3)):r.push(86),this.Status.SelectedValue!=this.StatusSelectedValue&&(this.StatusSelectedValue=this.Status.SelectedValue),r.push(parseInt(this.StatusSelectedValue)),r.push(this.Subject.Text),r.push(parseInt(this.Priority.SelectedValue)),r.push(this.Location.Text),r.push(this.IsAllDayActivity.IsChecked),"1"==this.CustomerType.SelectedValue||"2"==this.CustomerType.SelectedValue?(r.push(this.CRMCustomer.Code.Text),r.push(this.CRMCustomer.Code.SelectedValue)):(r.push(this.CRMCustomer.Text),r.push(0)),r.push(this.CustomerType.Visible?this.CustomerType.Items.find(t=>t.Value==this.CustomerType.SelectedValue).Name:"None");let o,l=this.Remarks.Xaml.toString();null!=this.Remarks.Tag&&""!=this.Remarks.Tag&&(l=this.Remarks.Tag),r.push(l),this.ActivityID>0?(r.push(this.StartDate.Date),r.push(this.EndDate.Date)):0==this.ActivityID&&("3"==this.ActivityType.SelectedValue||"4"==this.ActivityType.SelectedValue?(r.push(new Date(this.ActivitiesTempGrid.Table[s].StartDate_Key).ToString("dd/MMM/yyyy")),r.push(new Date(this.ActivitiesTempGrid.Table[s].EndDate_Key).ToString("dd/MMM/yyyy"))):(r.push(this.StartDate.Date.ToString("dd/MMM/yyyy")),r.push(this.EndDate.Date.ToString("dd/MMM/yyyy")))),o=this.ActualCloseDate.Date.ToString("dd/MMM/yyyy hh:mm a"),r.push(this.ActualCloseDate.Visible?o:"01/01/1900"),r.push("01/01/1900 "+n.e.String(this.ActualCloseTime.SelectedValue)),r.push("01/01/1900 "+this.StartTime.SelectedValue),r.push("01/01/1900 "+this.EndTime.SelectedValue),r.push(t),r.push(null!=this.AssignUserList&&this.AssignUserList.Items.length>0&&!n.e.IsEmpty(this.AssignUserList.SelectedValue)?parseInt(this.AssignUserList.SelectedValue):a.a.SessionManager.UserID);let h="";for(let t=0;t<this.Fields.length;t++){let e=this.Fields[t];e instanceof c.d&&(this.oText=e,h+=this.oText.SysColumnName+"='"+this.oText.Text.Replace("'","''")+"' ,"),e instanceof d.b?(this.oTime=e,h+=this.oTime.SysColumnName+"='"+this.oTime.Date+"' ,"):e instanceof d.a&&(this.oDate=e,h+=this.oDate.SysColumnName+"='"+this.oDate.Date+"' ,"),e instanceof u.e&&(this.oCombo=e,h+=this.oCombo.SysColumnName+"='"+this.oCombo.SelectedValue.Replace("'","''")+"' ,"),e instanceof C.a&&(this.OComboText=e,h+=this.OComboText.SysColumnName+"='"+this.OComboText.TextBox.Text.Replace("'","''")+"' ,"),e instanceof c.c&&(this.oTextArea=e,h+=this.oTextArea.SysColumnName+"='"+this.oTextArea.Text.Replace("'","''")+"' ,"),e instanceof S.b&&(this.oPactCombo=e,h+=this.oPactCombo.SysColumnName+"='"+this.oPactCombo.SelectedValue+"' ,")}if(r.push(h.length>0?h.toString().Trim(","):""),r.push(null!=this.ViewAttachments?this.ViewAttachments.GetXML():""),"RCalenderViewModel"==this.objParent.ClassName&&(e=this.objParent,r.push(e.ActivityID)),"3"==this.ActivityType.SelectedValue||"4"==this.ActivityType.SelectedValue){this.Recur.SetSaveData(),r.push(i),r.push(this.Recur.FreqType),r.push(this.Recur.FreqInterval),r.push(this.Recur.FreqSubdayType),r.push(this.Recur.FreqSubdayInterval),r.push(this.Recur.FreqRelativeInterval),r.push(this.Recur.FreqRecurrenceFactor),r.push(this.Recur.FirstPostingDate.Date.ToString("dd/MMM/yyyy"));let t=new Date(this.Recur.StartingTime.SelectedValue);r.push(t.getHours().PrefixZero(2)+":"+t.getMinutes().PrefixZero(2)+":"+t.getSeconds().PrefixZero(2)),r.push(this.Recur.EndDate.Date.ToString("dd/MMM/yyyy")),r.push(t.getHours().PrefixZero(2)+":"+t.getMinutes().PrefixZero(2)+":"+t.getSeconds().PrefixZero(2))}else r.push(0),r.push(0),r.push(0),r.push(0),r.push(0),r.push(0),r.push(0),r.push(null),r.push(null),r.push(null),r.push(null);r.push(this.CRMContactPerson.SelectedValue>0?this.CRMContactPerson.SelectedValue:null);let m=0,y=a.a.cases.SaveActivity(r,m);this.DisplayMessage=y.Message,m=y.RetValue,this.MessageVisibility=!0,m>0&&(e.ActivityID=0,this.IsPopup&&a.a.page.HideDialog(),"3"!=this.ActivityType.SelectedValue&&"4"!=this.ActivityType.SelectedValue&&this.ClearFields())}this.FromCalendar&&alert(this.DisplayMessage)}else{let e="",i="",s="";if(1==t){if(null==this.Selectedrow)return;this.Selectedrow.schStatus=413,this.Selectedrow.Status="Close",this.Selectedrow.isEdited="1",e=this.dr.UsersXML.toString(),s=this.dr.GroupXML.toString(),i=this.dr.RolesXML.toString(),this.Selectedrow=null,this.ActivityID=0}if(0==this.ActivityID&&null==this.Selectedrow){let n=1;"3"!=this.ActivityType.SelectedValue&&"4"!=this.ActivityType.SelectedValue||(n=this.ActivitiesTempGrid.Table.length);for(let r=0;r<n;r++){if(this.dr=this.objParent.ViewActivities.ActivityGridDataObj.NewRow(),this.Recur.SetSaveData(),0==this.objParent.ViewActivities.ActivityGridDataObj.Columns.length&&(this.objParent.ViewActivities.ActivitisActualData(),this.dr=this.objParent.ViewActivities.ActivityGridDataObj.NewRow()),this.dr.View="View",this.dr.FreqType=this.Recur.FreqType,this.dr.FreqInterval=this.Recur.FreqInterval,this.dr.FreqSubdayType=this.Recur.FreqSubdayType,this.dr.FreqSubdayInterval=this.Recur.FreqSubdayInterval,this.dr.FreqRelativeInterval=this.Recur.FreqRelativeInterval,this.dr.FreqRecurrenceFactor=this.Recur.FreqRecurrenceFactor,null!=this.dr.UserName&&(this.dr.UserName=a.a.SessionManager.UserName),"3"==this.ActivityType.SelectedValue||"4"==this.ActivityType.SelectedValue){this.dr.CStartDate=new Date(this.Recur.FirstPostingDate.Date),this.dr.CEndDate=new Date(this.Recur.EndDate.Date);let t=new Date(this.ActivitiesTempGrid.Table[r].StartTime.toString());this.dr.StartTime=this.returnTimeString(t.getHours().toString())+":"+this.returnTimeString(t.getMinutes().toString())+":"+this.returnTimeString(t.getSeconds().toString()),this.dr.ActStartDate=new Date(this.ActivitiesTempGrid.Table[r].StartDate_Key).ToString(a.a.SessionManager.Preferences["Date Format"].toString()),this.dr.ActStartDate_Key=new Date(this.ActivitiesTempGrid.Table[r].StartDate_Key),this.dr.ActEndDate=new Date(this.ActivitiesTempGrid.Table[r].EndDate_Key).ToString(a.a.SessionManager.Preferences["Date Format"].toString()),this.dr.ActEndDate_Key=new Date(this.ActivitiesTempGrid.Table[r].EndDate_Key),this.dr.ActStartTime="01/01/1900 "+this.ActivitiesTempGrid.Table[r].StartTime.toString(),this.dr.ActEndTime="01/01/1900 "+this.ActivitiesTempGrid.Table[r].EndTime.toString(),this.dr.SchID=this.ActivitiesTempGrid.Table[r].SchID.toString(),this.dr.ScheduleID=this.ActivitiesTempGrid.Table[r].SchID.toString()}else{this.dr.CStartDate=this.Recur.FirstPostingDate.Date,this.dr.CEndDate=this.Recur.RangeEnd.Items[0].IsChecked?null:this.Recur.EndDate.Date;let t=Date.WithTime(this.Recur.StartingTime.SelectedValue);this.dr.StartTime=this.returnTimeString(t.getHours().toString())+":"+this.returnTimeString(t.getMinutes().toString())+":"+this.returnTimeString(t.getSeconds().toString()),this.dr.ActStartDate=this.StartDate.Date.ToString(a.a.SessionManager.Preferences["Date Format"].toString()),this.dr.ActStartDate_Key=this.StartDate.Date,this.dr.ActEndDate=this.EndDate.Date.ToString(a.a.SessionManager.Preferences["Date Format"].toString()),this.dr.ActEndDate_Key=this.EndDate.Date,this.dr.ActStartTime="01/01/1900 "+this.StartTime.SelectedValue,this.dr.ActEndTime="01/01/1900 "+this.EndTime.SelectedValue,this.dr.SchID=0,this.dr.ScheduleID=0}if(this.dr.ActivityID="0",this.dr.ActivityTypeID=this.ActivityType.SelectedValue,this.dr.CostCenterID=89,this.dr.NodeID="1",this.Status.SelectedValue!=this.StatusSelectedValue&&(this.StatusSelectedValue=this.Status.SelectedValue),this.dr.schStatus=this.StatusSelectedValue,this.dr.Subject=this.Subject.Text,this.dr.Priority=this.Priority.SelectedValue,this.dr.PctComplete=this.PctComplete.Text,this.dr.Location=this.Location.Text,this.dr.IsAllDayActivity=this.IsAllDayActivity.IsChecked,1==this.ActualCloseDate.Visible)this.dr.ActualCloseDate_key=this.ActualCloseDate.Date,this.dr.ActualCloseDate=this.ActualCloseDate.Date.ToString(a.a.SessionManager.Preferences["Date Format"].toString()),this.dr.ActualCloseTime=this.ActualCloseTime.SelectedValue.toString();else if("3"==this.ActivityType.SelectedValue||"4"==this.ActivityType.SelectedValue){this.dr.ActualCloseDate=this.Recur.EndDate.Date;let t=Date.WithTime(this.Recur.StartingTime.SelectedValue);this.dr.ActualCloseTime=this.returnTimeString(t.getHours().toString())+":"+this.returnTimeString(t.getMinutes().toString())+":"+this.returnTimeString(t.getSeconds().toString())}else this.dr.ActualCloseDate="",this.dr.ActualCloseTime="";this.dr.CustomerID=this.CRMCustomer.Text,this.dr.ContactID=this.CRMContactPerson.SelectedValue>0?this.CRMContactPerson.SelectedValue:0;let n=null!=this.Remarks.Xaml?this.Remarks.Xaml.toString():"";null!=this.Remarks.Tag&&""!=this.Remarks.Tag&&(n=this.Remarks.Tag),this.dr.Remarks=n,this.dr.AssignGroupID="1",this.dr.AssignRoleID="1",this.dr.AssignUserID=this.AssignUserList.SelectedValue,1==t&&(this.dr.UsersXML=e,this.dr.GroupXML=s,this.dr.RolesXML=i),this.ActivityType.Text=this.ActivityType.GetText(),this.dr.Activity=this.ActivityType.Text,this.dr.Subject=this.Subject.Text,this.dr.AttachmentXML=this.ViewAttachments.GetXML(),"412"==this.StatusSelectedValue?this.dr.Status="Open":"413"==this.StatusSelectedValue?this.dr.Status="Close":"8"==this.StatusSelectedValue?this.dr.Status="Confirmed":"414"==this.StatusSelectedValue&&(this.dr.Status="Re-Schedule");for(let t=0;t<this.Fields.length;t++){let e=this.Fields[t];e instanceof c.d?(this.oText=e,this.dr[this.oText.SysColumnName]=this.oText.Text):e instanceof d.b?(this.oTime=e,this.dr[this.oTime.SysColumnName]=this.oTime.Date):e instanceof d.a?(this.oDate=e,this.dr[this.oDate.SysColumnName]=this.oDate.Date):e instanceof u.e?(this.oCombo=e,this.dr[this.oCombo.SysColumnName]=this.oCombo.SelectedValue):e instanceof C.a?(this.OComboText=e,this.dr[this.OComboText.SysColumnName]=this.OComboText.TextBox.Text):e instanceof c.c?(this.oTextArea=e,this.dr[this.oTextArea.SysColumnName]=this.oTextArea.Text):e instanceof S.b&&(this.oPactCombo=e,this.dr[this.oPactCombo.SysColumnName+"_Key"]=this.oPactCombo.SelectedValue,this.dr[this.oPactCombo.SysColumnName]=this.oPactCombo.Text)}this.objParent.ViewActivities.ActivityGridData.push(this.dr),this.objParent.ViewActivities.ActVisibility=!0,this.objParent.ViewActivities.ActivityGridDataObj.RefreshGridView()}this.OneActivity||null!=this.objParent&&"QuickAddLeads"==this.objParent.ClassName||this.ClearFields()}else{this.Recur.SetSaveData(),this.Selectedrow.FreqType=this.Recur.FreqType,this.Selectedrow.FreqInterval=this.Recur.FreqInterval,this.Selectedrow.FreqSubdayType=this.Recur.FreqSubdayType,this.Selectedrow.FreqSubdayInterval=this.Recur.FreqSubdayInterval,this.Selectedrow.FreqRelativeInterval=this.Recur.FreqRelativeInterval,this.Selectedrow.FreqRecurrenceFactor=this.Recur.FreqRecurrenceFactor,this.Selectedrow.CStartDate=this.Recur.FirstPostingDate.Date,this.Selectedrow.CEndDate=this.Recur.RangeEnd.Items[0].IsChecked?null:this.Recur.EndDate.Date;let t=Date.WithTime(this.Recur.StartingTime.SelectedValue);this.Selectedrow.StartTime=this.returnTimeString(t.getHours().toString())+":"+this.returnTimeString(t.getMinutes().toString())+":"+this.returnTimeString(t.getSeconds().toString()),this.Selectedrow.ActivityTypeID=this.ActivityType.SelectedValue,this.Selectedrow.CostCenterID=this.objParent.CostCenterID,this.Selectedrow.NodeID=1,this.Status.SelectedValue!=this.StatusSelectedValue&&(this.StatusSelectedValue=this.Status.SelectedValue),this.Selectedrow.schStatus=this.StatusSelectedValue,this.Selectedrow.Subject=this.Subject.Text,this.Selectedrow.Priority=this.Priority.SelectedValue,this.Selectedrow.PctComplete=this.PctComplete.Text,this.Selectedrow.Location=this.Location.Text,this.Selectedrow.IsAllDayActivity=this.IsAllDayActivity.IsChecked,1==this.ActualCloseDate.Visible?(this.Selectedrow.ActualCloseDate_key=this.ActualCloseDate.Date,this.Selectedrow.ActualCloseDate=this.ActualCloseDate.Date.ToString(a.a.SessionManager.Preferences["Date Format"].toString()),this.Selectedrow.ActualCloseTime="01/01/1900 "+this.ActualCloseTime.SelectedValue.toString()):"1"!=this.ActivityType.SelectedValue&&"2"!=this.ActivityType.SelectedValue||(this.Selectedrow.ActualCloseDate="",this.Selectedrow.ActualCloseTime=""),this.Selectedrow.ActStartDate=this.StartDate.Date.ToString(a.a.SessionManager.Preferences["Date Format"].toString()),this.Selectedrow.ActStartDate_Key=this.StartDate.Date,this.Selectedrow.ActEndDate=this.EndDate.Date.ToString(a.a.SessionManager.Preferences["Date Format"].toString()),this.Selectedrow.ActEndDate_Key=this.EndDate.Date,this.Selectedrow.ActStartTime="01/01/1900 "+this.StartTime.SelectedValue,this.Selectedrow.ActEndTime="01/01/1900 "+this.EndTime.SelectedValue,this.Selectedrow.CustomerID=this.CRMCustomer.Text,this.CRMContactPerson.SelectedValue>0&&(this.Selectedrow.ContactID=this.CRMContactPerson.SelectedValue);let e=this.Remarks.Xaml.toString();null!=this.Remarks.Tag&&""!=this.Remarks.Tag&&(e=this.Remarks.Tag),this.Selectedrow.Remarks=e,this.Selectedrow.AssignGroupID="1",this.Selectedrow.AssignRoleID="1",this.Selectedrow.AssignUserID=this.AssignUserList.SelectedValue,this.ActivityType.Text=this.ActivityType.GetText(),this.Selectedrow.Activity=this.ActivityType.Text,this.Selectedrow.isEdited="1",this.Selectedrow.Subject=this.Subject.Text,this.Selectedrow.AttachmentXML=this.ViewAttachments.GetXML(),"412"==this.StatusSelectedValue?this.Selectedrow.Status="Open":"413"==this.StatusSelectedValue?this.Selectedrow.Status="Close":"8"==this.StatusSelectedValue?this.Selectedrow.Status="Confirmed":"414"==this.StatusSelectedValue?this.Selectedrow.Status="Re-Schedule":"9"==this.StatusSelectedValue?this.Selectedrow.Status="In-Progress":"12"==this.StatusSelectedValue&&(this.Selectedrow.Status="On-Hold");for(let i=0;i<this.Fields.length;i++){let t=this.Fields[i];if(t instanceof c.d&&(this.oText=t,this.Selectedrow[this.oText.SysColumnName]=this.oText.Text),t instanceof d.b){let e=t;if(this.oTime=t,e.Date){let t=e.Date;e.ShowTimePicker&&1900!=e.Date.getFullYear()&&(t=new Date(1900,1,1),t=t.AddHours(e.Date.getHours()),t=t.AddMinutes(e.Date.getMinutes()),t=t.AddSeconds(e.Date.getSeconds())),this.Selectedrow[this.oTime.SysColumnName]=t.ToString("dd/MMM/yyyy hh:mm a")}else this.Selectedrow[this.oTime.SysColumnName]=this.oTime.Date}else t instanceof d.a&&(this.oDate=t,this.Selectedrow[this.oDate.SysColumnName]=this.oDate.Date);t instanceof u.e&&(this.oCombo=t,this.Selectedrow[this.oCombo.SysColumnName]=this.oCombo.SelectedValue),t instanceof C.a&&(this.OComboText=t,this.Selectedrow[this.OComboText.SysColumnName]=this.OComboText.TextBox.Text),t instanceof c.c&&(this.oTextArea=t,this.Selectedrow[this.oTextArea.SysColumnName]=this.oTextArea.Text),t instanceof S.b&&(this.oPactCombo=t,this.Selectedrow[this.oPactCombo.SysColumnName+"_Key"]=this.oPactCombo.SelectedValue,this.Selectedrow[this.oPactCombo.SysColumnName]=this.oPactCombo.Text)}this.objParent.ViewActivities.ActivityGridDataObj.updateRow(this.Selectedrow),this.objParent.ViewActivities.ActivityData=this.objParent.ViewActivities.ActivityGridData,this.OneActivity||null!=this.objParent&&("QuickAddLeads"==this.objParent.ClassName||"QuickAddCaseViewModel"==this.objParent.ClassName)||this.ClearFields()}if("AddEditDocumentViewModel"==this.objParent.ClassName&&this.CheckSign(),this.objParent.NodeID>0){let t=[];t.push(this.objParent.ViewActivities.ActivitiesXML()),t.push(this.objParent.CostCenterID),t.push(this.objParent.NodeID),t.push(a.a.SessionManager.CompanyGUID),t.push(n.e.NewGuid()),t.push(a.a.SessionManager.UserName),t.push(new Date),t.push(a.a.SessionManager.LanguageID);let e=0,i=a.a.cases.SetActivitiesAndSchedules(t);if(this.DisplayMessage=i.Message,this.FromCalendar&&alert(this.DisplayMessage),e=i.RetValue,this.MessageVisibility=!0,e>0){if(0==this.ActivityID){let t=this.objParent.ViewActivities.ActivityGridData.filter(t=>0==t.ActivityID);null!=t&&t.length>0&&(t[0].ActivityID=e)}else if(this.objParent.ViewActivities.tempActivityDataColumn.Contains("isEdited")){let t=this.objParent.ViewActivities.ActivityGridData.filter(t=>"1"==t.isEdited);null!=t&&t.length>0&&(t[0].isEdited="")}this.ActivityID=0,this.Selectedrow=null}}}}))}returnTimeString(t){return t.length>1?t:("0"+t).toString()}ClearFields(){if(this.OneActivity&&(this.Selectedrow=null),this.ActivityID=0,this.FeatureLable="",this.Subject.Text="",null!=this.ViewAttachments&&this.ViewAttachments.AttachmentsListObj.Clear(),this.ViewAttachVisible=!1,this.Location.Enable&&(this.Location.Text=""),this.CRMCustomer.Enable&&(this.CRMCustomer.Text=""),this.Remarks.Text="",this.Remarks.Xaml="",this.CRMContactPerson.Text="",this.ActStartDate.Date=null,this.ActStartTime.SelectedValue="",this.ActEndDate.Date=null,this.ActSign.Visible){let t=this.ActSign.Row;this.ActSign=new V.c(0),this.IsPopup?this.Remarks.Visible?(this.ActSign.Row=4,this.ActSign.Column=3):(this.ActSign.Row=0,this.ActSign.Column=3):this.ActSign.Row=t}this.ActEndTime.SelectedValue="",this.StartDate.Date=new Date,this.EndDate.Date=new Date,this.AssignUserList.SelectedValue=a.a.SessionManager.UserID.toString();for(let t=0;t<this.Fields.length;t++){let e=this.Fields[t];e instanceof c.d&&(this.oText=e,this.oText.Text=""),e instanceof d.a&&(this.oDate=e),e instanceof u.e&&(this.oCombo=e,this.oCombo.SelectedValue=""),e instanceof C.a&&(this.OComboText=e,this.OComboText.TextBox.Text=""),e instanceof c.c&&(this.oTextArea=e,this.oTextArea.Text=""),e instanceof S.b&&(this.oPactCombo=e,this.oPactCombo.SelectedValue=0)}this.SetActions()}enablecontrols(t){this.Fields.forEach(e=>{e.Enable=t}),this.ActivityType.Enable=t,this.Exp.Enable=t,this.ActivityText.Enable=t,this.Status.Enable=t,this.Subject.Enable=t,this.StartDate.Enable=t,this.EndDate.Enable=t,this.IsAllDayActivity.Enable=t,this.ActualCloseDate.Enable=t,this.ActualCloseTime.Enable=t,this.CustomerType.Enable=t,this.CRMContactPerson.Enable=t,this.AssignUserList.Enable=t,this.StartTime.Enable=t,this.EndTime.Enable=t,this.ButtonSave.Enable=t}}class E extends p.b{constructor(){super(),this.FromDate=new d.a,this.FromTime=new u.e(0),this.Reason=new c.d(0),this.ButtonClick=new h.b,this.Reason.Visible=!1,this.Reason.Label="Reason",this.ButtonClick.Subscribe(this,"onCLick"),this.Title="Select Date"}PickDateViewModel(t){this.Type=t,this.ButtonClick.Subscribe(this,"onCLick"),1==t?(this.DetailGrid=new l.a,this.GridVisible=!0):this.Title="Select Date"}onCLick(t){"OK"==t&&(this.DailogResult=!0),a.a.page.HideDialog()}}},yWgc:function(t,e,i){"use strict";i.r(e),i.d(e,"AssignFeatureComponent",(function(){return A}));var s=i("3Pt+"),a=i("fXoL");function n(t,e){if(1&t&&(a.Zb(0,"div",9),a.Wc(1,"\n          "),a.Vb(2,10),a.Wc(3,"\n        "),a.Yb()),2&t){const t=a.lc();a.Db(2),a.tc("obj",t.obj.SelectedNode)("group",t.obj.form)}}function r(t,e){if(1&t&&(a.Zb(0,"div",9),a.Wc(1,"\n            "),a.Vb(2,10),a.Wc(3,"\n          "),a.Yb()),2&t){const t=a.lc();a.Db(2),a.tc("obj",t.obj.InviteComments)("group",t.obj.form)}}function o(t,e){if(1&t&&(a.Zb(0,"div",9),a.Wc(1,"\n            "),a.Vb(2,10),a.Wc(3,"\n          "),a.Yb()),2&t){const t=a.lc();a.Db(2),a.tc("obj",t.obj.TypeOfAssigning)("group",t.obj.form)}}function l(t,e){if(1&t&&(a.Zb(0,"div",9),a.Wc(1,"\n              "),a.Vb(2,10),a.Wc(3,"\n            "),a.Yb()),2&t){const t=a.lc(2);a.Db(2),a.tc("obj",t.obj.Teams)("group",t.obj.form)}}function h(t,e){if(1&t&&(a.Zb(0,"div",9),a.Wc(1,"\n              "),a.Vb(2,10),a.Wc(3,"\n            "),a.Yb()),2&t){const t=a.lc(2);a.Db(2),a.tc("obj",t.obj.AssignUser)("group",t.obj.form)}}function c(t,e){if(1&t&&(a.Zb(0,"div"),a.Wc(1),a.Yb()),2&t){const t=a.lc(2);a.Db(1),a.Yc("\n                ",t.obj.CompanyName,"\n            ")}}function u(t,e){if(1&t&&(a.Zb(0,"div"),a.Wc(1,"\n            "),a.Uc(2,l,4,2,"div",2),a.Wc(3,"\n            "),a.Uc(4,h,4,2,"div",2),a.Wc(5,"\n            "),a.Uc(6,c,2,1,"div",3),a.Wc(7,"\n        "),a.Yb()),2&t){const t=a.lc();a.Db(2),a.tc("ngIf",t.obj.Teams.Visible),a.Db(2),a.tc("ngIf",t.obj.AssignUser.Visible),a.Db(2),a.tc("ngIf",t.obj.LabelVisibility)}}function d(t,e){if(1&t&&(a.Zb(0,"div",9),a.Wc(1,"\n            "),a.Vb(2,10),a.Wc(3,"\n        "),a.Yb()),2&t){const t=a.lc();a.Db(2),a.tc("obj",t.obj.RolesItemsObj)("group",t.obj.form)}}function m(t,e){if(1&t&&(a.Zb(0,"div",9),a.Wc(1,"\n            "),a.Vb(2,10),a.Wc(3,"\n        "),a.Yb()),2&t){const t=a.lc();a.Db(2),a.tc("obj",t.obj.UsersItemsObj)("group",t.obj.form)}}function S(t,e){if(1&t&&(a.Zb(0,"div",9),a.Wc(1,"\n            "),a.Vb(2,10),a.Wc(3,"\n        "),a.Yb()),2&t){const t=a.lc();a.Db(2),a.tc("obj",t.obj.GroupsItemsObj)("group",t.obj.form)}}function y(t,e){if(1&t&&(a.Zb(0,"div",9),a.Wc(1,"\n            "),a.Vb(2,10),a.Wc(3,"\n          "),a.Yb()),2&t){const t=a.lc();a.Db(2),a.tc("obj",t.obj.AssignDate)("group",t.obj.form)}}let A=(()=>{class t{constructor(){this.group=new s.j({})}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=a.Nb({type:t,selectors:[["app-assign-feature"]],decls:37,vars:15,consts:[[1,"master-screen",3,"formGroup"],[1,"PACTHeaderFields","dialogSubBody"],["class","form-group col PACTControl",4,"ngIf"],[4,"ngIf"],[1,"Pactdailogfooter"],[1,"primary-btn-wicon",3,"click"],[1,"fa-light","fa-floppy-disk"],[1,"secondary-btn-wicon",3,"click"],[1,"fa-light","fa-rectangle-xmark"],[1,"form-group","col","PACTControl"],["FieldDirective","",3,"obj","group"]],template:function(t,e){1&t&&(a.Zb(0,"div",0),a.Wc(1,"\n    "),a.Zb(2,"div",1),a.Wc(3,"\n        "),a.Uc(4,n,4,2,"div",2),a.Wc(5,"\n        "),a.Uc(6,r,4,2,"div",2),a.Wc(7,"\n          "),a.Uc(8,o,4,2,"div",2),a.Wc(9,"\n         "),a.Uc(10,u,8,3,"div",3),a.Wc(11,"\n\n        "),a.Uc(12,d,4,2,"div",2),a.Wc(13,"\n        "),a.Uc(14,m,4,2,"div",2),a.Wc(15,"\n        "),a.Uc(16,S,4,2,"div",2),a.Wc(17,"\n          \n          "),a.Uc(18,y,4,2,"div",2),a.Wc(19,"\n  "),a.Yb(),a.Wc(20,"\n\n  "),a.Zb(21,"div",4),a.Wc(22,"\n    "),a.Zb(23,"div"),a.Wc(24,"\n        "),a.Zb(25,"button",5),a.hc("click",(function(){return e.obj.OnSave("Save")})),a.Ub(26,"i",6),a.Wc(27),a.mc(28,"translate"),a.Yb(),a.Wc(29,"\n        "),a.Zb(30,"button",7),a.hc("click",(function(){return e.obj.OnSave("Cancel")})),a.Ub(31,"i",8),a.Wc(32),a.mc(33,"translate"),a.Yb(),a.Wc(34,"\n    "),a.Yb(),a.Wc(35,"      \n  "),a.Yb(),a.Wc(36,"\n"),a.Yb()),2&t&&(a.tc("formGroup",e.obj.group),a.Db(4),a.tc("ngIf",e.obj.SelectedNode.Visible),a.Db(2),a.tc("ngIf",e.obj.InviteComments.Visible),a.Db(2),a.tc("ngIf",e.obj.TypeOfAssigning.Visible),a.Db(2),a.tc("ngIf",e.obj.TeamVisible),a.Db(2),a.tc("ngIf",e.obj.RolesItemsObj.Visible),a.Db(2),a.tc("ngIf",e.obj.UsersItemsObj.Visible),a.Db(2),a.tc("ngIf",e.obj.GroupsItemsObj.Visible),a.Db(2),a.tc("ngIf",e.obj.AssignDate.Visible),a.Db(9),a.Xc(a.nc(28,11,"Save")),a.Db(5),a.Xc(a.nc(33,13,"Cancel")))},encapsulation:2}),t})()}}]);