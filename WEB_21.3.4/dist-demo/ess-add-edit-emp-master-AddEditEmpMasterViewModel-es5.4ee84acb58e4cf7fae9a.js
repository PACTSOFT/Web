function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var i,a=_getPrototypeOf(e);if(t){var s=_getPrototypeOf(this).constructor;i=Reflect.construct(a,arguments,s)}else i=a.apply(this,arguments);return _possibleConstructorReturn(this,i)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[163,214],{"4k0m":function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var a=i("Do2H"),s=i("ScVY"),n=i("EQd/"),l=i("0/4Q"),o=function(e){_inherits(i,e);var t=_createSuper(i);function i(e,s,l,o){var r;return _classCallCheck(this,i),(r=t.call(this)).Remarks=new n.c(0),r.CostCenterID=0,r.NodeID=0,r.Parent=null,r.retValWeb=0,r.IsUpdated=!1,r.CostCenterID=e,r.NodeID=s,r.Parent=o,r.ScreenObject=l,r.Remarks.Label=a.a.GetResource("Remarks"),r}return _createClass(i,[{key:"SaveStatus",value:function(e,t,i){!(arguments.length>3&&void 0!==arguments[3])||arguments[3];var a=!1,s=null;"MonthlyPayrollViewModel"==this.Parent.ClassName?(null!=(s=this.Parent.SetDocStatus(e,t,i,new Date,this.Remarks.Text,!0,""))&&s.Tables.length>0&&s.Tables[0].length>0&&s.Columns[0].Contains("status")&&(this.Parent.DocStatus="["+s.Tables[0][0].status.toString()+"]",a=!0),null!=s&&s.Tables.length>0&&s.Tables[s.Tables.length-1].length>0&&s.Columns[s.Tables.length-1].Contains("ErrorMessage")&&(this.Parent.this.DisplayMessage=s.Tables[s.Tables.length-1][0].ErrorMessage.toString()),this.Parent.this.MessageVisibility=!0,a&&this.Parent.btnClear_Click()):"FinalSettlementViewModel"==this.Parent.ClassName&&(null!=(s=this.Parent.SetDocStatus(e,t,i,new Date,this.Remarks.Text,!0,""))&&s.Tables.length>0&&s.Tables[0].length>0&&s.Columns[0].Contains("status")&&(this.Parent.DocStatus="["+s.Tables[0][0].status.toString()+"]",a=!0),null!=s&&s.Tables.length>0&&s.Tables[s.Tables.length-1].length>0&&s.Columns[s.Tables.length-1].Contains("ErrorMessage")&&(this.Parent.this.DisplayMessage=s.Tables[s.Tables.length-1][0].ErrorMessage.toString()),this.Parent.this.MessageVisibility=!0,a&&this.Parent.Button_Click("Clear"))}},{key:"onButtonClick",value:function(e){var t=0;if(40054==this.CostCenterID)"Approve"==e?a.a.SessionManager.IsActionAssigned(this.CostCenterID,"Edit")?this.Parent.btnPost_Click():this.SaveStatus(369,parseInt(this.Parent.oCMP.arrLstOthMPFields[0].dvPayProcessed[0].WorkFlowID),""):"Reject"==e&&this.SaveStatus(372,0,""),a.a.page.HideDialog();else if(40095==this.CostCenterID)"Approve"==e?a.a.SessionManager.IsActionAssigned(this.CostCenterID,"Edit")?(this.Parent.sCmdParameter="Approve",this.Parent.Button_Click("Save")):this.SaveStatus(369,this.Parent.WID,""):"Reject"==e&&this.SaveStatus(372,0,""),a.a.page.HideDialog();else{var i=this.ScreenObject.CurrentStatus;if("Approve"==e){if(!this.IsSaveValidated())return;var s=a.a.common.ApproveCostCenter(this.CostCenterID,this.NodeID,i,this.Remarks.Text,!1,0);this.DisplayMessage=s.Message,(t=s.RetValue)>0&&(this.IsUpdated||(this.ScreenObject.ButtonApproveVisible=!1,this.UpdateStatusID(t),null!=this.ScreenObject.drpStatus&&(null==this.ScreenObject.drpStatus.Items.find((function(e){return e.Value==t.toString()}))&&("1001"==t.toString()?this.ScreenObject.drpStatus.Items.push(l.d.ComboBoxItems_2("Un Approved","1001")):"1002"==t.toString()?this.ScreenObject.drpStatus.Items.push(l.d.ComboBoxItems_2("Approved","1002")):this.ScreenObject.drpStatus.Items.push(l.d.ComboBoxItems_2("Rejected","1003"))),this.ScreenObject.drpStatus.SelectedValue=t.toString(),this.ScreenObject.drpStatus.SetSelectedItem(t.toString())),a.a.SessionManager.IsWebApplication&&(this.retValWeb=t)),a.a.page.HideDialog())}else if("Reject"==e){if(!this.IsSaveValidated())return;var n=a.a.common.ApproveCostCenter(this.CostCenterID,this.NodeID,i,this.Remarks.Text,!0,0);this.DisplayMessage=n.Message,(t=n.RetValue)>0&&(this.IsUpdated||(this.UpdateStatusID(t),null!=this.ScreenObject.drpStatus&&(null==this.ScreenObject.drpStatus.Items.find((function(e){return e.Value==t.toString()}))&&("1001"==t.toString()?this.ScreenObject.drpStatus.Items.push(l.d.ComboBoxItems_2("Un Approved","1001")):"1002"==t.toString()?this.ScreenObject.drpStatus.Items.push(l.d.ComboBoxItems_2("Approved","1002")):this.ScreenObject.drpStatus.Items.push(l.d.ComboBoxItems_2("Rejected","1003"))),this.ScreenObject.drpStatus.SelectedValue=t.toString(),this.ScreenObject.drpStatus.SetSelectedItem(t.toString())),a.a.SessionManager.IsWebApplication&&(this.retValWeb=t)),a.a.page.HideDialog())}else a.a.page.HideDialog()}}},{key:"UpdateStatusID",value:function(e){this.ScreenObject.CurrentStatus=e,"QuickAddAccountScreenViewModel"==this.Parent.ClassName||"AddEditAccountScreenViewModel"==this.Parent.ClassName?this.Parent.obj.StatusID=e:"QuickAddProductViewModel"==this.Parent.ClassName?this.Parent.objProduct.ProductStatus=e:"AddProductScreenViewModel"==this.Parent.ClassName?this.Parent.oProduct.ProductStatus=e:"QuickAddCostCenterViewModel"==this.Parent.ClassName||"AddCostCenterViewModel"==this.Parent.ClassName?this.Parent.objCostCenter.Status=e:"AddEditEmpMasterViewModel"==this.Parent.ClassName&&(this.Parent.objEmp.StatusID=e)}},{key:"IsSaveValidated",value:function(){if(this.IsUpdated=!1,"QuickAddAccountScreenViewModel"==this.Parent.ClassName){var e=this.Parent;if(e.ButtonSave.Visible&&e.ButtonSave.Enable){if(e.SaveMethod("APPROVE_CALL"),0!=e.AccountID)return this.DisplayMessage=e.DisplayMessage,e.DisplayMessage="",!1;this.IsUpdated=!0,e.DisplayMessage=""}}else if("AddEditAccountScreenViewModel"==this.Parent.ClassName){var t=this.Parent;if(t.ButtonSave.Visible&&t.ButtonSave.Enable){if(t.OnSaveAccount("APPROVE_CALL"),0!=t.AccountID)return this.DisplayMessage=t.DisplayMessage,t.DisplayMessage="",!1;this.IsUpdated=!0,t.DisplayMessage=""}}else if("QuickAddProductViewModel"==this.Parent.ClassName){var i=this.Parent;if(i.ButtonSave.Visible&&i.ButtonSave.Enable){if(i.onSaveProduct("APPROVE_CALL"),0!=i.objProduct.ProductID)return this.DisplayMessage=i.DisplayMessage,i.DisplayMessage="",!1;this.IsUpdated=!0,i.DisplayMessage=""}}else if("AddProductScreenViewModel"==this.Parent.ClassName){var a=this.Parent;if(a.ButtonSave.Visible&&a.ButtonSave.Enable){if(a.OnSaveProduct("APPROVE_CALL"),0!=a.ProductID)return this.DisplayMessage=a.DisplayMessage,a.DisplayMessage="",!1;this.IsUpdated=!0,a.DisplayMessage=""}}else if("QuickAddCostCenterViewModel"==this.Parent.ClassName){var s=this.Parent;if(s.ButtonSave.Visible&&s.ButtonSave.Enable){if(s.SaveMethod(),0!=s.NodeID)return this.DisplayMessage=s.DisplayMessage,s.DisplayMessage="",!1;this.IsUpdated=!0,s.DisplayMessage=""}}else if("AddCostCenterViewModel"==this.Parent.ClassName){var n=this.Parent;if(n.ButtonSave.Visible&&n.ButtonSave.Enable){if(n.OnSaveCostCenter("Save"),0!=n.NodeID)return this.DisplayMessage=n.DisplayMessage,n.DisplayMessage="",!1;this.IsUpdated=!0,n.DisplayMessage=""}}else if("AddEditEmpMasterViewModel"==this.Parent.ClassName){var l=this.Parent;if(l.ButtonSave.Visible&&l.ButtonSave.Enable){if(l.OnSaveEmployee("Save"),0!=l.NodeID)return this.DisplayMessage=l.DisplayMessage,l.DisplayMessage="",!1;this.IsUpdated=!0,l.DisplayMessage=""}}return!0}}]),i}(s.b)},"5FTv":function(e,t,i){"use strict";i.r(t),i.d(t,"VoucherExportExcel",(function(){return s}));var a=i("Do2H"),s=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"GetPrintLayouts",value:function(e,t){var i=[];return i.push(e),i.push(t),i.push(0),i.push(parseInt(a.a.SessionManager.RoleID)),i.push(parseInt(a.a.SessionManager.UserID)),i.push(a.a.SessionManager.LanguageID),a.a.report.GetPrintLayout(i)}},{key:"GetPrintLayouts_1",value:function(e,t,i){var s=[];return s.push(e),s.push(t),s.push(i),s.push(null),s.push(a.a.SessionManager.RoleID),s.push(a.a.SessionManager.UserID),s.push(a.a.SessionManager.LanguageID),a.a.report.GetPrintLayouts(s)}},{key:"GetLocationPrintLayouts",value:function(e,t,i){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,n=[];return n.push(s),n.push(e),n.push(t),n.push(a.a.SessionManager.LocationID),n.push(a.a.SessionManager.RoleID),n.push(a.a.SessionManager.UserID),n.push(i),n.push(a.a.SessionManager.LanguageID),a.a.report.GetPrintLayouts(n)}},{key:"GetLayoutTemplates",value:function(e,t,i){var s=[];return s.push(2),s.push(t),s.push(i),s.push(e),s.push(a.a.SessionManager.RoleID),s.push(a.a.SessionManager.UserID),s.push(a.a.SessionManager.LanguageID),a.a.report.GetPrintLayouts(s)}},{key:"AllowRePrint",value:function(e,t,i){var s=[];return s.push(3),s.push(e),s.push(t),s.push(i),s.push(a.a.SessionManager.RoleID),s.push(a.a.SessionManager.UserID),s.push(a.a.SessionManager.LanguageID),a.a.report.GetPrintLayouts(s)}}]),e}()},bB3S:function(e,t,i){"use strict";i.r(t),i.d(t,"AddEditEmpMasterViewModel",(function(){return W})),i.d(t,"PayIdentityGridViewModel",(function(){return U}));var a=i("ScVY"),s=i("EQd/"),n=i("0/4Q"),l=i("VxiT"),o=i("n56n"),r=i("NkMH"),d=i("bgvB"),c=i("eQJW"),h=i("4HhE"),u=i("INyF"),m=i("QQWi"),p=i("JIg3"),g=i("8B8H"),D=i("ockk"),y=i("Lp6j"),b=i("Do2H"),S=i("vTM8"),C=i("uMy8"),f=i("MRsC"),I=i("vVAv"),T=i("RJs6"),A=i("OvA8"),E=i("xnJf"),P=i("jgdN"),v=function(){function e(t,i){_classCallCheck(this,e),this.SaveCallBack=null,this.Fields=[],this.oText=null,this.oDate=null,this.oCombo=null,this.oTextArea=null,this.OComboText=null,this.oTime=null,this.CostCenterID=0,this.AttachmentVisibility=!1,this.NodeID=0,this.Institute="",this.University="",this.Title="",this.Duration="",this.GradeRPercentage="",this.Remarks="",this.DocumentVisibility=!1,this.IsModified=!1,this.ScreenObject=new l.a,this.MessageVisibility=!1,this.DisplayMessage="",this.AddDocumentText="",this.FeatureID=0,this.FeaturePK=0,this.DocumentType=251,this.dvLookUps=[],Logger.InfoLog("AddEditEmpDocumentsViewModel::Entering AddEditEmpDocumentsViewModel with Parent="+t),this.Parent=t,this.DocumentType=i,this.ButtonSecurity(),this.InitLookUps(),this.ViewAttachments=new A.ViewAttachmentViewModel(this,b.a.SessionManager,b.a.admin),this.OnAddAttachment(),Logger.InfoLog("AddEditEmpDocumentsViewModel::Exiting AddEditEmpDocumentsViewModel")}return _createClass(e,[{key:"OnShowAttachment",value:function(){Logger.InfoLog("AddProductViewModel::Entering OnShowAttachment"),Logger.InfoLog("AddProductViewModel::Exiting OnShowAttachment")}},{key:"OnAddAttachment",value:function(){Logger.InfoLog("AddProductViewModel::Entering AddAttachment");var e="";null!=this.Attachment&&(e=this.Attachment.ColID);var t=null;null!=this.Attachment&&(t=this.Attachment.RowID),this.Attachment=new E.AddAttachmentViewModel,this.Attachment.AddAttachmentViewModel_2(this),""==e?(this.Attachment.ColID="",this.Attachment.RowID=null):(this.Attachment.ColID=e,this.Attachment.RowID=t),this.ViewAttachments.AttachmentsList.forEach((function(e){e.Height=null==e.RowID&&y.e.StringIsNullOrEmpty(e.ColID)?20:0})),this.Attachment.RowID=null,this.Attachment.ColID="",Logger.InfoLog("AddProductViewModel::Entering AddAttachment")}},{key:"ButtonSecurity",value:function(){this.ButtonCustomize=new r.a,b.a.SessionManager.HideUnathorizedAccess?this.ButtonCustomize.Visible=b.a.SessionManager.IsActionAssigned(this.Parent.CostCenterID,"Customize"):this.ButtonCustomize.Enable=b.a.SessionManager.IsActionAssigned(this.Parent.CostCenterID,"Customize")}},{key:"InitLookUps",value:function(){if(251==this.DocumentType?this.AddDocumentText=b.a.GetResource("Add")+" "+b.a.GetResource("EmpMaster_Qualification"):252==this.DocumentType?this.AddDocumentText=b.a.GetResource("Add")+" "+b.a.GetResource("EmpMaster_Certification"):253==this.DocumentType?this.AddDocumentText=b.a.GetResource("Add")+" "+b.a.GetResource("EmpMaster_PrevEmployment"):254==this.DocumentType?this.AddDocumentText=b.a.GetResource("Add")+" "+b.a.GetResource("EmpMaster_MedicalHistory"):255==this.DocumentType&&(this.AddDocumentText=b.a.GetResource("Add")+" "+b.a.GetResource("EmpMaster_DependentInfo")),this.ScreenObject.LoadQuickScreen(this,this.DocumentType),this.dvLookUps=this.ScreenObject.Data.Tables[5],this.ScreenObject.CheckViewForUser(!1),null!=this.ScreenObject&&this.ScreenObject.StaticFields.length>0)if(251==this.DocumentType)for(var e=0;e<this.ScreenObject.StaticFields.length;e++)if(this.dvLookUps=this.ScreenObject.Data.Tables[5],"Field1"==this.ScreenObject.StaticFields[e].DBColumnName){for(var t=1900;t<=2200;t++)this.ScreenObject.StaticFields[e].Items.push(n.d.ComboBoxItems_2(t.toString(),t.toString()));this.ScreenObject.StaticFields[e].SelectedValue="1900"}else"Field2"==this.ScreenObject.StaticFields[e].DBColumnName?(this.dvLookUps=this.dvLookUps.filter((function(e){return 103==e.LookupType})),n.e.FillComboWithDefaultOption(this.dvLookUps,this.ScreenObject.StaticFields[e])):"Field3"==this.ScreenObject.StaticFields[e].DBColumnName?(this.dvLookUps=this.dvLookUps.filter((function(e){return 109==e.LookupType})),n.e.FillComboWithDefaultOption(this.dvLookUps,this.ScreenObject.StaticFields[e])):"Field4"==this.ScreenObject.StaticFields[e].DBColumnName&&(this.dvLookUps=this.dvLookUps.filter((function(e){return 110==e.LookupType})),n.e.FillComboWithDefaultOption(this.dvLookUps,this.ScreenObject.StaticFields[e]));else if(252==this.DocumentType)for(var i=0;i<this.ScreenObject.StaticFields.length;i++)this.dvLookUps=this.ScreenObject.Data.Tables[5],"Field3"==this.ScreenObject.StaticFields[i].DBColumnName?(this.dvLookUps=this.dvLookUps.filter((function(e){return 103==e.LookupType})),n.e.FillComboWithDefaultOption(this.dvLookUps,this.ScreenObject.StaticFields[i])):"Field4"==this.ScreenObject.StaticFields[i].DBColumnName&&(this.dvLookUps=this.dvLookUps.filter((function(e){return 101==e.LookupType})),n.e.FillComboWithDefaultOption(this.dvLookUps,this.ScreenObject.StaticFields[i]));else if(253==this.DocumentType);else if(254==this.DocumentType)for(var a=0;a<this.ScreenObject.StaticFields.length;a++)this.dvLookUps=this.ScreenObject.Data.Tables[5],"Field1"==this.ScreenObject.StaticFields[a].DBColumnName&&(this.dvLookUps=this.dvLookUps.filter((function(e){return 107==e.LookupType})),n.e.FillComboWithDefaultOption(this.dvLookUps,this.ScreenObject.StaticFields[a]));else if(255==this.DocumentType)for(var s=0;s<this.ScreenObject.StaticFields.length;s++)this.dvLookUps=this.ScreenObject.Data.Tables[5],"Field4"==this.ScreenObject.StaticFields[s].DBColumnName?(this.ScreenObject.StaticFields[s].Items.push(n.d.ComboBoxItems_2("Male","Male")),this.ScreenObject.StaticFields[s].Items.push(n.d.ComboBoxItems_2("Female","Female")),this.ScreenObject.StaticFields[s].Items.push(n.d.ComboBoxItems_2("Others","Others")),this.ScreenObject.StaticFields[s].SelectedValue="Male"):"Field5"==this.ScreenObject.StaticFields[s].DBColumnName?(this.dvLookUps=this.dvLookUps.filter((function(e){return 111==e.LookupType})),n.e.FillComboWithDefaultOption(this.dvLookUps,this.ScreenObject.StaticFields[s])):"Field15"==this.ScreenObject.StaticFields[s].DBColumnName?(this.dvLookUps=this.dvLookUps.filter((function(e){return 108==e.LookupType})),n.e.FillComboWithDefaultOption(this.dvLookUps,this.ScreenObject.StaticFields[s])):"Field16"==this.ScreenObject.StaticFields[s].DBColumnName&&(this.ScreenObject.StaticFields[s].Items.push(n.d.ComboBoxItems_2("Yes","Yes")),this.ScreenObject.StaticFields[s].Items.push(n.d.ComboBoxItems_2("No","No")),this.ScreenObject.StaticFields[s].SelectedValue="Yes")}},{key:"OnSaveDocument",value:function(e){var t=this;if(null!=e&&"Cancel"==e.toString())return this.Parent.EmpDocumentsVisibility=!1,void b.a.page.HideDialog();if(null!=e&&"Customize"==e.toString());else{if(Logger.InfoLog("AddEmpDocumentiewModel::Entering OnSaveDocument"),this.DisplayMessage=this.ScreenObject.ValidateData(),this.DisplayMessage.length>0)return;if((this.NodeID>0||this.NodeID<-1e4)&&(this.IsModified=!0),null!=this.Parent){Logger.InfoLog("AddEmpDocumentiewModel::Entering OnSaveDocument"),(this.NodeID>0||this.NodeID<-1e4)&&(this.IsModified=!0);var i=null;if(null==this.Parent.ViewEmpDocuments.SelectedRow){i=this.Parent.ViewEmpDocuments.GridListObj.NewRow();for(var a=0;a<this.Parent.ViewEmpDocuments.tempGridListCols.length;a++)i[this.Parent.ViewEmpDocuments.tempGridListCols[a]]=null}else null!=this.Parent.ViewEmpDocuments.SelectedRow&&(i=this.Parent.ViewEmpDocuments.SelectedRow);for(var l=function(e){var a=t.ScreenObject.StaticFields[e];a instanceof h.c&&null!=a.DBColumnName&&(t.Parent.ViewEmpDocuments.tempGridListCols.Contains(a.DBColumnName)||t.Parent.ViewEmpDocuments.tempGridListCols.push(a.DBColumnName),a.DBColumnName.toUpperCase().startsWith("CCNID")&&(t.Parent.ViewEmpDocuments.tempGridListCols.Contains(a.DBColumnName+"_Key")||t.Parent.ViewEmpDocuments.tempGridListCols.push(a.DBColumnName+"_Key")),a instanceof n.e&&(t.Parent.ViewEmpDocuments.tempGridListCols.Contains(a.DBColumnName+"_Key")||t.Parent.ViewEmpDocuments.tempGridListCols.push(a.DBColumnName+"_Key")),a instanceof s.d||a instanceof s.a||a instanceof s.c?i[a.DBColumnName]=""!=a.Text?a.Text:"":a instanceof n.e?(i[a.DBColumnName+"_Key"]=null!=a.SelectedItem?a.SelectedItem.Value:null!=a.SelectedValue?a.SelectedValue:"",b.a.SessionManager.IsWebApplication?null!=a.SelectedValue&&null!=a.SelectedValue&&(d=a.Items.find((function(e){return e.Value==a.SelectedValue})),i[a.DBColumnName]=null!=d?d.Name:""):i[a.DBColumnName]=null!=a.SelectedItem?a.SelectedItem.Name:""):a instanceof p.b?i[a.DBColumnName]=y.e.StringIsNullOrEmpty(a.Date)?"":a.Date.toString():a instanceof p.c?i[a.DBColumnName]=b.a.SessionManager.IsWebApplication?y.e.StringIsNullOrEmpty(a.Date)?"":new Date(a.Date).ToString("dd/MMM/yyyy"):y.e.StringIsNullOrEmpty(a.Text)||y.e.StringIsNullOrEmpty(a.Date)?"":new Date(a.Date).ToString("dd/MMM/yyyy"):a instanceof p.a?i[a.DBColumnName]=y.e.StringIsNullOrEmpty(a.Text)||y.e.StringIsNullOrEmpty(a.Date)?"":a.Date.ToString("dd/MMM/yyyy"):a instanceof P.a?i[a.DBColumnName]=""!=a.Text?a.Text:"":a instanceof o.b&&(i[a.DBColumnName+"_Key"]=0!=a.SelectedValue?a.SelectedValue:0))},r=0;r<this.ScreenObject.StaticFields.length;r++){var d;l(r)}i.DType=this.DocumentType.toString();var c=this.ViewAttachments.GetXML();i.AttachmentXML=c,null==this.Parent.ViewEmpDocuments.SelectedRow&&this.Parent.ViewEmpDocuments.GridListObj.addRow(i),this.Parent.ViewEmpDocuments.SelectedRow=null,this.ClearFields(),Logger.InfoLog("AddContactViewModel::Exiting OnSaveContact")}this.DocumentVisibility=!1,Logger.InfoLog("AddContactViewModel::Exiting OnSaveContact")}}},{key:"ClearFields",value:function(){this.ScreenObject.Clear(),this.ViewAttachments=new A.ViewAttachmentViewModel(this,b.a.SessionManager,b.a.admin),this.OnAddAttachment()}},{key:"OnSaveDocumentByDialog",value:function(e){var t=this;if(this.DisplayMessage="",null!=e&&"Cancel"==e.toString())b.a.page.HideDialog();else{Logger.InfoLog("AddEditEmpDocumentViewModel::Entering OnSaveDocumentByDialog"),(this.NodeID>0||this.NodeID<-1e4)&&(this.IsModified=!0);var i=null,a=null,l=null,r="";i="",a="",l="",r+='<Data><Row Action="NEW"',r+=' NodeID="0"';var d="",c=this.Fields.find((function(e){return"Institute"==e.DBColumnName.toString()}));if(null!=c&&null!=c&&c instanceof s.d&&(this.Institute=c.Text),""==this.Institute.Trim())return;for(var u=0;u<this.Fields.length;u++){var m=this.Fields[u];m instanceof h.c&&null!=m.DBColumnName&&(d="",m instanceof s.d||m instanceof s.a||m instanceof s.c?d=""!=m.Text?m.Text:"":m instanceof n.e?d=""!=m.SelectedValue?m.SelectedValue:"":m instanceof p.b?d=y.e.StringIsNullOrEmpty(m.Date)?"":m.Date.toString():m instanceof p.c?d=y.e.StringIsNullOrEmpty(m.Text)||y.e.StringIsNullOrEmpty(m.Date)?"":new Date(m.Date).ToString("dd/MMM/yyyy"):m instanceof p.a?d=y.e.StringIsNullOrEmpty(m.Text)||y.e.StringIsNullOrEmpty(m.Date)?"":m.Date.ToString("dd/MMM/yyyy"):m instanceof P.a?d=y.e.StringIsNullOrEmpty(m.Text)?"":m.Text:m instanceof o.b&&(d=(0!=m.SelectedValue?m.SelectedValue:0).toString()),m.DBColumnName.toLowerCase().Contains("alpha")?a+=m.DBColumnName+"=N'"+this.GetValidXml(d)+"',":m.DBColumnName.toUpperCase().startsWith("CCNID")?l+=m.DBColumnName+"='"+d+"',":i+=m.DBColumnName+"=N'"+d+"',")}r+=' StaticFields ="'+i.toString().Trim(",")+'" ',r+=' ExtraTextFields ="'+a.toString().Trim(",")+'" ',r+=' CCFields ="'+l.toString().Trim(",")+'" ',r+="/></Data>";var g="",D=0,S={};S.AccountID=this.FeatureID,S.WID=this.FeaturePK,S.CCMapXML=r.toString(),b.a.empService.SaveEmpDocument(S,"SaveEmpDocument").subscribe((function(e){g=e.Message,(D=e.RetValue)>0||D<-1e4?(t.NodeID=D,b.a.page.HideDialog(),null!=t.SaveCallBack&&t.SaveCallBack.Call(t)):t.DisplayMessage=g}),(function(e){console.log("Save Add Edit Emp document : "+JSON.stringify(e))})),Logger.InfoLog("AddEditEmpDocumentViewModel::Exiting OnSaveDocumentByDialog")}}},{key:"GetValidXml",value:function(e){return s.d.GetValidXml(e)}},{key:"FillCustomFields",value:function(){var e=this;this.Fields.Clear();var t=0,i=0;i=0,t=0,this.ScreenObject.StaticFields.length>0&&this.ScreenObject.StaticFields.forEach((function(a){a.Row=i,a.Column=t,e.Fields.push(a),2==t?(i+=1,t=0):t+=1}))}}]),e}(),M=i("t9b3"),V=i("3Pt+"),N=function(){function e(t){_classCallCheck(this,e),this.Module="PAY",this.ClassName="ViewEmpDocumentsViewModel",this.Visible=!0,this.contextVisible=!0,this.iDocumentTypeID=251,this.ColumnSpan="4",this.GridListObj=new g.a,this.ButtonAdd=new r.a,this.ButtonUpdate=new r.a,this.ButtonDelete=new r.a,this.DeletedAddress=new Array,Logger.InfoLog("ViewEmpDocumentsViewModel::Entering ViewEmpDocumentsViewModel with Parent="+t),this.form=new V.j({}),this.GridListObj.Columns=[],b.a.SessionManager.HideUnathorizedAccess?this.ButtonAdd.Visible=b.a.SessionManager.IsActionAssigned(t.CostCenterID,"Qualification_Create"):this.ButtonAdd.Enable=b.a.SessionManager.IsActionAssigned(t.CostCenterID,"Qualification_Create"),b.a.SessionManager.HideUnathorizedAccess?this.ButtonUpdate.Visible=b.a.SessionManager.IsActionAssigned(t.CostCenterID,"Qualification_Update"):this.ButtonUpdate.Enable=b.a.SessionManager.IsActionAssigned(t.CostCenterID,"Qualification_Update"),b.a.SessionManager.HideUnathorizedAccess?this.ButtonDelete.Visible=b.a.SessionManager.IsActionAssigned(t.CostCenterID,"Qualification_Delete"):this.ButtonDelete.Enable=b.a.SessionManager.IsActionAssigned(t.CostCenterID,"Qualification_Delete"),this.ButtonUpdate.Visible||this.ButtonDelete.Visible||(this.contextVisible=!1),this.DocumentTypes=new n.e(0),this.DocumentTypes.Label=b.a.GetResource("DocumentType"),this.DocumentTypes.SelectionChangedCommand.Subscribe(this,"DocumentTypes_SelectionChanged"),this.GridListObj.Clear(),this.tempGridListCols=[],this.tempGridListCols.push("NodeID"),this.tempGridListCols.push("EmpSeqNo"),this.tempGridListCols.push("DType");for(var i=1;i<=30;i++)this.tempGridListCols.Contains("Field"+i)||this.tempGridListCols.push("Field"+i),this.tempGridListCols.Contains("Field"+i+"_Key")||this.tempGridListCols.push("Field"+i+"_Key");this.tempGridListCols.Contains("AttachmentXML")||this.tempGridListCols.push("AttachmentXML"),this.Parent=t,this.Parent=t,"AddEditEmpMasterViewModel"==this.Parent.ClassName&&(this.DocumentTypes.Items.push(n.d.ComboBoxItems_2("Qualifications","Qualifications")),this.DocumentTypes.Items.push(n.d.ComboBoxItems_2("Certifications","Certifications")),this.DocumentTypes.Items.push(n.d.ComboBoxItems_2("Previous Employment","PrevEmployment")),this.DocumentTypes.Items.push(n.d.ComboBoxItems_2("Medical History","MedicalHistory")),this.DocumentTypes.Items.push(n.d.ComboBoxItems_2("Dependent Info","DependentInfo"))),this.DocumentTypes.Items.length>0&&(this.DocumentTypes.SelectedValue=this.DocumentTypes.Items[0].Value,this.DocumentTypes_SelectionChanged("")),Logger.InfoLog("ViewEmpDocumentsViewModel::Exiting ViewEmpDocumentsViewModel")}return _createClass(e,[{key:"DocumentTypes_SelectionChanged",value:function(e){"Qualifications"==this.DocumentTypes.SelectedValue?this.iDocumentTypeID=251:"Certifications"==this.DocumentTypes.SelectedValue?this.iDocumentTypeID=252:"PrevEmployment"==this.DocumentTypes.SelectedValue?this.iDocumentTypeID=253:"MedicalHistory"==this.DocumentTypes.SelectedValue?this.iDocumentTypeID=254:"DependentInfo"==this.DocumentTypes.SelectedValue&&(this.iDocumentTypeID=255),this.LoadGridColumns(this.iDocumentTypeID),""==e?null!=this.OwnedScreen&&null!=this.OwnedScreen.dsEdit&&this.LoadDocuments(this.OwnedScreen.dsEdit.Tables[13]):this.LoadDocuments(null!=this.OwnedScreen&&null!=this.OwnedScreen.dsEdit?this.OwnedScreen.dsEdit.Tables[13]:null)}},{key:"LoadGridColumns",value:function(e){var t=b.a.admin.GetDimensionTabGridData(e,this.iDocumentTypeID);if(null!=t&&t.Tables.length>1&&t.Columns[2].Contains("USERCOLUMNNAME")&&t.Tables[2].length>0){var i=[];if(i=t.Tables[2],this.GridColumnSource.Clear(),i.length>0)for(var a=new D.a,s=0;s<i.length;s++)this.tempGridListCols.Contains(i[s].SysColumnName.toString())||(this.tempGridListCols.push(i[s].SysColumnName.toString()),i[s].SysColumnName.toString().toUpperCase().startsWith("CCNID")&&this.tempGridListCols.push(i[s].SysColumnName.toString()+"_Key")),(a=new D.a).Header=i[s].USERCOLUMNNAME.toString(),i[s].SysColumnName.toString().toUpperCase().startsWith("CCNID")?(a.ValueMember=i[s].SysColumnName.toString()+"_Key",a.DisplayMember=i[s].SysColumnName.toString()):(a.ValueMember=i[s].SysColumnName.toString(),a.DisplayMember=i[s].SysColumnName.toString()),a.DataType="TextBlock",a.ReadOnly=!0,a.Width=0==parseInt(i[s].Width)?150:parseInt(i[s].Width),this.GridColumnSource.push(a)}else this.LoadStaticColumns()}},{key:"LoadStaticColumns",value:function(){var e=this,t=[],i=(new l.a).GetScreenInfo(this.iDocumentTypeID),a=null,s=[];null!=i&&null!=i&&i.Tables.length>3&&i.Tables[i.Tables.length-2].length>0?function(){var n=i.Tables[i.Tables.length-2];if((n=n.filter((function(e){return e.Tabid>0}))).sort((function(e,t){return e.Tabid-t.Tabid})),n.length>0)for(var l=function(e){null!=(s=i.Tables[0].filter((function(t){return t.CostCenterColID==n[e].Tabid.toString()})))&&null!=s&&s.length>0&&((a=new D.a).Header=s[0].ResourceData.toString(),a.DisplayMember=s[0].SysColumnName.toString(),a.DataType="TextBlock",a.ReadOnly=!0,a.IsVisible=null!=n[e].IsVisible&&null!=n[e].IsVisible&&"TRUE"==n[e].IsVisible.toString().toUpperCase(),a.Width=150,t.push(a),"COMBOBOX"==s[0].ResourceData.toString().toUpperCase()&&((a=new D.a).Header=s[0].ResourceData.toString()+"_Key",a.DisplayMember=s[0].SysColumnName.toString()+"_Key",a.DataType="TextBlock",a.ReadOnly=!0,a.Width=150,a.IsVisible=!1,t.push(a)))},o=0;o<n.length;o++)l(o);else e.AddEmpDocumentsColumnsToGrid(t,a)}():this.AddEmpDocumentsColumnsToGrid(t,a),this.GridColumnSource=t}},{key:"AddEmpDocumentsColumnsToGrid",value:function(e,t){251==this.iDocumentTypeID?((t=new D.a).Header=b.a.GetResource("Year"),t.DisplayMember="Field1",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Year_Key",t.DisplayMember="Field1_Key",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,t.IsVisible=!1,e.push(t),(t=new D.a).Header=b.a.GetResource("Qualification"),t.DisplayMember="Field3",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header=b.a.GetResource("Qualification"),t.DisplayMember="Field3_Key",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,t.IsVisible=!1,e.push(t),(t=new D.a).Header=b.a.GetResource("QualificationLevel"),t.DisplayMember="Field4",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header=b.a.GetResource("QualificationLevel"),t.DisplayMember="Field4_Key",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,t.IsVisible=!1,e.push(t),(t=new D.a).Header=b.a.GetResource("Grade_Percentage"),t.DisplayMember="Field8",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header=b.a.GetResource("Remarks"),t.DisplayMember="Field9",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t)):252==this.iDocumentTypeID?((t=new D.a).Header="Domain",t.DisplayMember="Field3",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Certification",t.DisplayMember="Field4",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Grade / Percentage",t.DisplayMember="Field6",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Date",t.DisplayMember="Field1",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Valid Till",t.DisplayMember="Field2",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Remarks",t.DisplayMember="Field7",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t)):253==this.iDocumentTypeID?((t=new D.a).Header="From",t.DisplayMember="Field1",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="To",t.DisplayMember="Field2",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Company",t.DisplayMember="Field3",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Company Details",t.DisplayMember="Field4",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Location",t.DisplayMember="Field5",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Department",t.DisplayMember="Field6",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Designation",t.DisplayMember="Field7",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Remarks",t.DisplayMember="Field11",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t)):254==this.iDocumentTypeID?((t=new D.a).Header="Medical Test",t.DisplayMember="Field1",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Result",t.DisplayMember="Field3",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Valid Till",t.DisplayMember="Field2",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Remarks",t.DisplayMember="Field4",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t)):255==this.iDocumentTypeID&&((t=new D.a).Header="Name",t.DisplayMember="Field1",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Date of Birth",t.DisplayMember="Field2",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Age",t.DisplayMember="Field3",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Sex",t.DisplayMember="Field4",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Relation",t.DisplayMember="Field5",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t),(t=new D.a).Header="Insurance",t.DisplayMember="Field16",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=150,e.push(t))}},{key:"OnCmnItem_Click",value:function(e){var t=this;switch(Logger.InfoLog("ViewEmpDocumentsViewModel::Entering OnCmnItem_Click with Command="+e),e){case"EDIT":if(null!=this.SelectedRow){null==this.Parent.EmpDocuments&&(this.Parent.EmpDocuments=new v(this.Parent,this.iDocumentTypeID)),this.Parent.EmpDocumentsVisibility=!0;var i=this.SelectedRow;if(null==i||null==i)return;if(null!=i&&""!=i.NodeID.toString()&&(this.Parent.EmpDocuments.NodeID=""!=i.NodeID.toString()?parseInt(i.NodeID.toString()):0),this.Parent.EmpDocuments.ScreenObject.Clear(),this.Parent.EmpDocuments.ScreenObject.FillControls(i,i,i,null),null!=i.AttachmentXML&&""!=i.AttachmentXML.toString()){var a=new y.f;try{this.Parent.EmpDocuments.ViewAttachments=new A.ViewAttachmentViewModel(this.Parent.EmpDocuments),a.LoadXml(i.AttachmentXML.toString());var s=a.SelectNodes("AttachmentsXML/Row");this.Parent.EmpDocuments.ViewAttachments.AttachmentsListObj.Clear(),s.forEach((function(e){var i=new E.AddAttachmentViewModel;i.AddAttachmentViewModel_2(t.Parent.EmpDocuments),i.AttachmentID=parseInt(e.attributes.AttachmentID.Value),i.ActualFileName=e.attributes.ActualFileName.Value,i.FileExtension=e.attributes.FileExtension.Value,i.FileDescription=e.attributes.FileDescription.Value,i.FilePath=y.e.GetPath(e.attributes.GUID.Value+"."+e.attributes.FileExtension.Value),i.RelativeFileName=e.attributes.RelativeFileName.Value,i.IsProductImage=!1,i.guid=e.attributes.GUID.Value,t.Parent.EmpDocuments.ViewAttachments.AttachmentsListObj.addRow(i)}))}catch(l){}}}break;case"DELETE":null!=this.SelectedRow&&(""!=this.SelectedRow.NodeID.toString()&&"0"!=this.SelectedRow.NodeID.toString()&&this.DeletedAddress.push(n.d.ComboBoxItems_1(this.SelectedRow.NodeID.toString())),this.GridList.Remove(this.SelectedRow))}Logger.InfoLog("ViewEmpDocumentsViewModel::Exiting OnCmnItem_Click")}},{key:"onCanCmnItem_Click",value:function(e){return!0}},{key:"GetXML",value:function(){var e=this;Logger.InfoLog("ViewEmpDocumentsViewModel::Entering GetXML");for(var t=null,i=null,a=null,s="",n=0;n<this.GridList.length;n++){t="",i="",a="",""==this.GridList[n].NodeID.toString()||"0"==this.GridList[n].NodeID.toString()?s+='<Row Action="NEW"':s+='<Row Action="MODIFY"',s+=' NodeID="'+this.GridList[n].NodeID.toString()+'"',s+=' DType="'+this.GridList[n].DType.toString()+'"';for(var l=function(s){e.tempGridListCols[s].toLowerCase().Contains("_key")||e.tempGridListCols[s].Contains("NodeID")||null!=e.Parent.EmpDocuments&&e.Parent.EmpDocuments.ScreenObject.StaticFields.find((function(t){return t.DBColumnName==e.tempGridListCols[s]}))&&(e.tempGridListCols[s].toLowerCase().Contains("alpha")?i+=e.tempGridListCols[s]+"=N'"+e.GetValidXml(e.GridList[n][e.tempGridListCols[s]].toString())+"',":e.tempGridListCols[s].toUpperCase().startsWith("CCNID")?a+=e.tempGridListCols[s]+"='"+e.GridList[n][e.tempGridListCols[s]+"_Key"].toString()+"',":e.tempGridListCols.Contains(e.tempGridListCols[s]+"_Key")&&""!=e.GridList[n][e.tempGridListCols[s]+"_Key"].toString()?t+=e.tempGridListCols[s]+"=N'"+e.GetValidXml(e.GridList[n][e.tempGridListCols[s]+"_Key"].toString())+"',":t+=e.tempGridListCols[s]+"=N'"+e.GetValidXml(e.GridList[n][e.tempGridListCols[s]].toString())+"',")},o=0;o<this.tempGridListCols.length;o++)l(o);s+=' StaticFields ="'+t.toString().Trim(",")+'" ',s+=' ExtraTextFields ="'+i.toString().Trim(",")+'" ',s+=' CCFields ="'+a.toString().Trim(",")+'" ',s+=' AttachmentXML ="'+this.EncodedXMLString(this.GridList[n].AttachmentXML.toString())+'" ',s+="/>"}for(var r=0;r<this.DeletedAddress.length;r++)s+='<Row Action="DELETE"',s+=' NodeID="'+this.DeletedAddress[r].Name+'"/>';return s.length>0&&(s="<Data>"+s+"</Data>"),Logger.InfoLog("ViewEmpDocumentsViewModel::Exiting GetXML which RETURN XML="+s),s.toString()}},{key:"EncodedXMLString",value:function(e){return y.e.StringIsNullOrEmpty(e)?"":e.replace("&","&amp;").replace("<","&lt;").replace(">","&gt;").replace('"',"&quot;")}},{key:"OnShowNew",value:function(e){Logger.InfoLog("ViewEmpDocumentsViewModel::Entering OnShowNewContact");try{if(null!=e&&null!=e||(e="Save"),"Customize"==e.toString()){"AddEditEmpMasterViewModel"==this.Parent.ClassName&&this.Parent.CostCenterID}else this.ButtonAdd.Enable&&this.ButtonAdd.Visible&&(this.Parent.EmpDocuments=new v(this.Parent,this.iDocumentTypeID),b.a.page.ShowDialog(this.Parent.EmpDocuments,M.a,{Title:this.Parent.EmpDocuments.AddDocumentText}),this.Parent.EmpDocumentsVisibility=!0);Logger.InfoLog("ViewEmpDocumentsViewModel::Exiting OnShowNewContact")}catch(t){Logger.ErrorLog("ViewEmpDocumentsViewModel:: OnShowNewContact"+t.stack)}}},{key:"LoadDocuments",value:function(e){var t=this;if(null!=e&&e.length>0){var i=e;i=i.filter((function(e){return 251==e.DType||252==e.DType||253==e.DType||254==e.DType||255==e.DType})),e=i}var a=b.a.empService.GetQueryData(0,"LoadDocumentsEmp","","","");if(this.GridListObj.Table=this.GridList.filter((function(e){return e.DType==+t.iDocumentTypeID})),null!=e&&null!=e&&(this.GridListObj.Clear(),Logger.InfoLog("ViewEmpDocumentsViewModel::Entering LoadContacts with TableData"+e),251==this.iDocumentTypeID?(this.tempGridListCols.Contains("Field1_Key")||this.tempGridListCols.push("Field1_Key"),this.tempGridListCols.Contains("Field2_Key")||this.tempGridListCols.push("Field2_Key"),this.tempGridListCols.Contains("Field3_Key")||this.tempGridListCols.push("Field3_Key"),this.tempGridListCols.Contains("Field4_Key")||this.tempGridListCols.push("Field4_Key")):252==this.iDocumentTypeID?(this.tempGridListCols.Contains("Field3_Key")||this.tempGridListCols.push("Field3_Key"),this.tempGridListCols.Contains("Field4_Key")||this.tempGridListCols.push("Field4_Key")):253==this.iDocumentTypeID||(254==this.iDocumentTypeID?this.tempGridListCols.Contains("Field1_Key")||this.tempGridListCols.push("Field1_Key"):255==this.iDocumentTypeID&&(this.tempGridListCols.Contains("Field4_Key")||this.tempGridListCols.push("Field4_Key"),this.tempGridListCols.Contains("Field5_Key")||this.tempGridListCols.push("Field5_Key"),this.tempGridListCols.Contains("Field15_Key")||this.tempGridListCols.push("Field15_Key"),this.tempGridListCols.Contains("Field16_Key")||this.tempGridListCols.push("Field16_Key"))),this.tempGridListCols.Contains("EmpSeqNo")||this.tempGridListCols.push("EmpSeqNo"),this.tempGridListCols.Contains("AttachmentXML")||this.tempGridListCols.push("AttachmentXML"),0!=e.length)){if(null!=this.Parent.EmpDocuments)for(var n=0;n<this.Parent.EmpDocuments.ScreenObject.StaticFields.length;n++){var l=this.Parent.EmpDocuments.ScreenObject.StaticFields[n];l instanceof h.c&&null!=l.DBColumnName&&(this.tempGridListCols.Contains(l.DBColumnName)||(this.tempGridListCols.push(l.DBColumnName),l.DBColumnName.toUpperCase().startsWith("CCNID")&&this.tempGridListCols.push(l.DBColumnName+"_Key")))}for(var o=function(i){for(var n={},l=0;l<t.tempGridListCols.length;l++)n[t.tempGridListCols[l]]=null;for(var o=0;o<t.tempGridListCols.length;o++)t.tempGridListCols[o].toLowerCase().Contains("_key")||y.e.hasprop(e[i],t.tempGridListCols[o])&&(t.tempGridListCols[o].toString().toUpperCase().startsWith("CCNID")?n[t.tempGridListCols[o]+"_Key"]=e[i][t.tempGridListCols[o]].toString():n[t.tempGridListCols[o]]=t.GetValidXmlReserve(y.e.StringValue(e[i][t.tempGridListCols[o]]).toString()));if(n.NodeID=parseInt(e[i].NodeID),n.EmpSeqNo=parseInt(e[i].EmployeeID),n.DType=e[i].DType.toString(),251==parseInt(n.DType)?(n.Field1_Key=n.Field1,n.Field2_Key=n.Field2,n.Field3_Key=n.Field3,n.Field4_Key=n.Field4):252==parseInt(n.DType)?(n.Field3_Key=n.Field3,n.Field4_Key=n.Field4):253==parseInt(n.DType)||(254==parseInt(n.DType)?n.Field1_Key=n.Field1:255==parseInt(n.DType)&&(n.Field4_Key=n.Field4,n.Field5_Key=n.Field5,n.Field15_Key=n.Field15,n.Field16_Key=n.Field16)),null!=a&&null!=a&&a.Tables.length>0&&a.Tables[0].length>0){var r=a.Tables[0];if(null!=r&&null!=r){var d="";if((r=r.filter((function(e){return e.FeatureID==n.DType.toString()&&e.FeaturePK==n.NodeID.toString()}))).length>0){for(var c=0;c<r.length;c++)d+='<Row Action="MODIFY"',d+=' AttachmentID="'+r[c].FileID.toString()+'"',d+=' FilePath="'+y.e.GetPath(r[c].GUID.toString()+"."+r[c].FileExtension.toString())+'"',d+=' ActualFileName="'+s.d.GetValidXml(r[c].ActualFileName.toString())+'"',d+=' RelativeFileName="'+s.d.GetValidXml(r[c].RelativeFileName.toString())+'"',d+=' FileExtension="'+r[c].FileExtension+'"',d+=' GUID="'+r[c].GUID+'"',d+=' FileDescription="'+s.d.GetValidXml(r[c].FileDescription.toString())+'" ',d+=' IsProductImage="0"',d+="/>";d.length>0&&(d="<AttachmentsXML>"+d+"</AttachmentsXML>",n.AttachmentXML=d.toString())}}}t.GridListObj.addRow(n)},r=0;r<e.length;r++)o(r);null!=e&&this.UpdateNodeNosToData(),Logger.InfoLog("ViewEmpDocumentsViewModel::Exiting LoadContacts")}}},{key:"UpdateNodeNosToData",value:function(){var e=this;if(null!=this.OwnedScreen)for(var t,i=this.OwnedScreen.ScreenObject.Data.Tables[8],a=function(a){251==parseInt(e.GridList[a].DType)?(y.e.StringIsNullOrEmpty(e.GridList[a].Field2_Key)||null!=(t=i.filter((function(t){return t.NodeID==e.GridList[a].Field2_Key.toString()})))&&t.length>0&&(e.GridList[a].Field2=t[0].Name),y.e.StringIsNullOrEmpty(e.GridList[a].Field3_Key)||null!=(t=i.filter((function(t){return t.NodeID==e.GridList[a].Field3_Key.toString()})))&&t.length>0&&(e.GridList[a].Field3=t[0].Name),y.e.StringIsNullOrEmpty(e.GridList[a].Field4_Key)||null!=(t=i.filter((function(t){return t.NodeID==e.GridList[a].Field4_Key.toString()})))&&t.length>0&&(e.GridList[a].Field4=t[0].Name)):252==parseInt(e.GridList[a].DType)?(y.e.StringIsNullOrEmpty(e.GridList[a].Field3_Key)||null!=(t=i.filter((function(t){return t.NodeID==e.GridList[a].Field3_Key.toString()})))&&t.length>0&&(e.GridList[a].Field3=t[0].Name),y.e.StringIsNullOrEmpty(e.GridList[a].Field4_Key)||null!=(t=i.filter((function(t){return t.NodeID==e.GridList[a].Field4_Key.toString()})))&&t.length>0&&(e.GridList[a].Field4=t[0].Name)):253==parseInt(e.GridList[a].DType)||(254==parseInt(e.GridList[a].DType)?y.e.StringIsNullOrEmpty(e.GridList[a].Field1_Key)||null!=(t=i.filter((function(t){return t.NodeID==e.GridList[a].Field1_Key.toString()})))&&t.length>0&&(e.GridList[a].Field1=t[0].Name):255==parseInt(e.GridList[a].DType)&&(y.e.StringIsNullOrEmpty(e.GridList[a].Field5_Key)||null!=(t=i.filter((function(t){return t.NodeID==e.GridList[a].Field5_Key.toString()})))&&t.length>0&&(e.GridList[a].Field5=t[0].Name),y.e.StringIsNullOrEmpty(e.GridList[a].Field15_Key)||null!=(t=i.filter((function(t){return t.NodeID==e.GridList[a].Field15_Key.toString()})))&&t.length>0&&(e.GridList[a].Field15=t[0].Name)))},s=0;s<this.GridList.length;s++)a(s)}},{key:"GetValidXml",value:function(e){return s.d.GetValidXml(e)}},{key:"GetValidXmlReserve",value:function(e){return(e=(e=(e=e.Replace("&amp;","&")).Replace("''","'")).Replace("&quot;",'"')).Replace("&lt;","<")}},{key:"angularGrid",get:function(){return this.GridListObj.angularGrid}},{key:"GridList",get:function(){return this.GridListObj.Table}},{key:"GridColumnSource",get:function(){return this.GridListObj.Columns},set:function(e){this.GridListObj.Columns=e}},{key:"SelectedRow",get:function(){return this.GridListObj.SelectedItem},set:function(e){this.GridListObj.SelectedItem=e}}]),e}(),w=i("4k0m"),F=i("++IR"),L=i("BJEe"),O=i("v5j5"),B=i("wJuo"),k=i("x68t"),G=i("THE7"),x=i("5FTv"),R=i("ia84"),_=i("SW+i"),j=i("wlFP"),W=function(e){_inherits(i,e);var t=_createSuper(i);function i(e,a,h,y,C){var f,E;if(_classCallCheck(this,i),(f=t.call(this)).ClassName="AddEditEmpMasterViewModel",f.objEmp=new m.a,f.Opacity=1,f.DialogResult=!1,f.NextPreviousVisibility=!0,f.DisplayMessage="",f.MessageVisibility=!1,f.EmpCurrentStatusVisibility=!1,f.EmpCurrentStatus="",f._ScreenName="",f.ScreenObject=new l.a,f.NodeID=0,f.EmpCode=s.a.PactCodeData_1(3e4),f.EmpName=s.d.PactTextBoxData_1(30001),f.AliasName=s.d.PactTextBoxData_1(30062),f.Status=n.e.PactComboBoxData1(30002),f.EmpType=n.e.PactComboBoxData1(30357),f.EmpGroup=o.b.PactListBoxData_1(30003),f.DateOfJoining=new p.a(30359),f.DateOfBirth=new p.a(30360),f.RptManager=o.b.PactListBoxData_1(30358),f.Gender=n.e.PactComboBoxData1(30361),f.ProbationDays=s.d.PactTextBoxData_1(30362),f.DateOfConfirmation=new p.a(30363),f.ButtonSave=new r.a,f.ButtonApprove=new r.a,f.ButtonAppraisal=new r.a,f.ButtonCustomize=new r.a,f.EmpImage=new d.b,f.plBoxSalaryAccount=o.b.PactListBoxData_1(0),f.plBoxPayableAccount=o.b.PactListBoxData_1(0),f.FileID=0,f.FileExtension="",f.FileDescription="",f.IsPhotoDelete=!1,f.IsPhotoChanged=!1,f.ActualFileName="",f.AccountPhoto="",f.PhotoTextVisibility=!1,f.AttachmentVisibility=!1,f.NoteVisibility=!1,f.DetailsVisibility=!1,f.ContactVisibility=!1,f.AddressVisibility=!1,f.CCMapVisibility=!1,f.EmpDocumentsVisibility=!1,f.CostCenterID=0,f.ParentId=0,f.RetValue=0,f.guid="",f.EmpAttachmentguid="",f.ParentFeatureID=0,f.PNodeID=0,f.pcbPayrollType=null,f.pcbPaymentMode=null,f.pcbALType=null,f.pcbVacationPeriod=null,f.pcbMaritalStatus=null,f.pcbNationality=null,f.pcbReligion=null,f.txtBasicMonthly=null,f.txtVacDaysPerMonth=null,f.ptxtNetSalary=null,f.dtpNextAppraisal=null,f.DateOfRelieve=null,f.iPayrollTabIndex=-1,f.iAppraisalTabIndex=-1,f.iAccLinkTabIndex=-1,f.iBankNodeID=0,f.IsEdit=!1,f.isLoad=!1,f.dsPayStructure=null,f.sFilter="",f.dsGetBankDetails_web=null,f.AddeditAppraisalViewmodel=null,f.iAccruCnt=0,f.iEarCnt=0,f.fldDict=new S.a,f.sDecimalsAmount="N"+b.a.SessionManager.Preferences.DecimalsinAmount,f.webtotEarnings=0,f.webtotDeductions=0,f.oEvalPayFormulas=null,f.NextPrevID=0,f.ProfileID=-1,f.oFinalTab=null,f.IsExportPrint=!1,f.sXpsFileName="",f.drSelPrintLayout=null,f.dsTotLayouts=null,f.MoreThanOneLayout=!1,f.EmpImage.RowSpan=3,f.EmpImage.Row=0,f.EmpImage.Column=3,f.CostCenterID=50051,f.NodeID=e,f.ScreenName=y,f.MessageVisibility=!1,f.DisplayMessage="",f.AccountPhoto="",f.ParentId=h,f.objEmp.NodeID=f.NodeID,f.objEmp.IsGroup=C,f.objEmp.DOJ=new Date,f.objEmp.DOB=new Date,f.objEmp.DOConfirmation=new Date,f.ViewContacts=new G.a(_assertThisInitialized(f)),f.ViewNotes=new T.a(_assertThisInitialized(f),b.a.SessionManager,b.a.admin),f.ViewAttachments=new A.ViewAttachmentViewModel(_assertThisInitialized(f),b.a.SessionManager,b.a.admin),f.ViewAddress=new u.a(_assertThisInitialized(f)),f.ViewCCMapping=new I.a(_assertThisInitialized(f)),f.ViewCCMapping.ViewCCMappingViewModel_1(_assertThisInitialized(f),f.CostCenterID,f.NodeID),null==f.ScreenObject.StaticFields&&(f.ScreenObject.StaticFields=[]),f.ScreenObject.LoadScreen_1(_assertThisInitialized(f),50051,C),f.LoadImageDimensions(),f.plBoxSalaryAccount=f.GetScreenControl("SalaryAccID"),f.plBoxPayableAccount=f.GetScreenControl("PayableAccID"),f.pcbPayrollType=f.GetScreenControl("PayType"),null!=f.pcbPayrollType&&f.pcbPayrollType.SelectionChangedCommand.Subscribe(_assertThisInitialized(f),"PayrollType_SelectionChanged"),f.DateOfJoining=f.GetScreenControl("DOJ"),f.DateOfJoining.SelectedDateChanged.Subscribe(_assertThisInitialized(f),"DateOfJoining_SelectedDateChanged"),f.ProbationDays=f.GetScreenControl("ProbationDays"),f.ProbationDays.LostFocusCommand.Subscribe(_assertThisInitialized(f),"ProbationDays_LostFocus"),f.ProbationDays.Text=""!=b.a.SessionManager.Preferences.DefaultProbationDays&&parseInt(b.a.SessionManager.Preferences.DefaultProbationDays)>0?b.a.SessionManager.Preferences.DefaultProbationDays:"0",f.ProbationDays_LostFocus(f.ProbationDays),f.DateOfRelieve=f.GetScreenControl("DORelieve"),f.dtpNextAppraisal=f.GetScreenControl("NextAppraisalDate"),f.ptxtNetSalary=f.GetScreenControl("NetSalary"),null!=f.ptxtNetSalary&&(f.ptxtNetSalary.Enable=!1),f.txtBasicMonthly=f.GetScreenControl("BasicMonthly"),f.txtBasicMonthly.LostFocusCommand.Subscribe(_assertThisInitialized(f),"txtBasicMonthly_LostFocus"),f.dsPayStructure=f.objEmp.GetQueryData(f.NodeID,"dsPayStructure","","",""),f.dgvPayrollEar=new g.a,f.dgvPayrollEar.Columns=[],f.dgvPayrollEar.Height=250,f.dgvPayrollEar.Width="",(E=new D.a).Header=b.a.GetResource("Payroll_EmpSNo"),E.DisplayMember="SlNo",E.ID="SlNo",E.Width=60,E.ReadOnly=!0,f.dgvPayrollEar.Columns.push(E),(E=new D.a).Header=b.a.GetResource("Earnings"),E.DisplayMember="Earnings",E.ID="Earnings",E.Width=250,E.ReadOnly=!0,f.dgvPayrollEar.Columns.push(E),(E=new D.a).Header=b.a.GetResource("Value"),E.DisplayMember="EarValue",E.ID="EarValue",E.DefaultValue=(0).ToString(f.sDecimalsAmount),E.Width=130,E.ReadOnly=!1,E.DataType="FLOAT",E.ShowTotal=!0,E.IsCalculated=1,E.DecimalPoints="2",f.dgvPayrollEar.Columns.push(E),f.dgvPayrollAccrual=new g.a,f.dgvPayrollAccrual.Columns=[],f.dgvPayrollAccrual.Height=150,f.dgvPayrollAccrual.Width="",f.dgvPayrollAccrual.Visible=!1,(E=new D.a).Header=b.a.GetResource("Payroll_EmpSNo"),E.DisplayMember="SlNo",E.ID="SlNo",E.Width=60,E.ReadOnly=!0,f.dgvPayrollAccrual.Columns.push(E),(E=new D.a).Header="Accrual Type",E.DisplayMember="Earnings",E.ID="Earnings",E.Width=250,E.ReadOnly=!0,f.dgvPayrollAccrual.Columns.push(E),(E=new D.a).Header=b.a.GetResource("Value"),E.DisplayMember="EarValue",E.ID="EarValue",E.DefaultValue=(0).ToString(f.sDecimalsAmount),E.Width=130,E.ReadOnly=!1,E.DataType="FLOAT",E.ShowTotal=!0,E.IsCalculated=1,E.DecimalPoints="2",f.dgvPayrollAccrual.Columns.push(E),f.dgvPayrollDed=new g.a,f.dgvPayrollDed.Columns=[],f.dgvPayrollDed.Height=250,f.dgvPayrollDed.Width="",(E=new D.a).Header=b.a.GetResource("Payroll_EmpSNo"),E.DisplayMember="SlNo",E.ID="SlNo",E.Width=60,E.ReadOnly=!0,f.dgvPayrollDed.Columns.push(E),(E=new D.a).Header=b.a.GetResource("Deductions"),E.DisplayMember="Deductions",E.ID="Deductions",E.Width=250,E.ReadOnly=!0,f.dgvPayrollDed.Columns.push(E),(E=new D.a).Header=b.a.GetResource("Value"),E.DisplayMember="DedValue",E.ID="DedValue",E.DefaultValue=(0).ToString(f.sDecimalsAmount),E.Width=130,E.ReadOnly=!0,E.DataType="FLOAT",E.ShowTotal=!0,E.IsCalculated=1,E.DecimalPoints="2",f.dgvPayrollDed.Columns.push(E),f.dgvPayrollEar.Table=[],f.dgvPayrollEar.TableColumns.push("SlNo"),f.dgvPayrollEar.TableColumns.push("Earnings"),f.dgvPayrollEar.TableColumns.push("EarValue"),f.dgvPayrollEar.TableColumns.push("EarAddToNet"),f.dgvPayrollEar.TableColumns.push("EarFType"),f.dgvPayrollEar.TableColumns.push("Earnings_GRAY"),f.dgvPayrollEar.TableColumns.push("EarValue_GRAY"),f.dgvPayrollEar.TableColumns.push("EarSNo"),f.dgvPayrollEar.TableColumns.push("EarFormula"),f.dgvPayrollEar.TableColumns.push("EarROff"),f.dgvPayrollEar.TableColumns.push("EarComponentID"),f.dgvPayrollEar.TableColumns.push("IsVisible"),f.dgvPayrollEar.TableColumns.push("IsAccrualType"),f.dgvPayrollAccrual.Table=[],f.dgvPayrollAccrual.TableColumns.push("SlNo"),f.dgvPayrollAccrual.TableColumns.push("Earnings"),f.dgvPayrollAccrual.TableColumns.push("EarValue"),f.dgvPayrollAccrual.TableColumns.push("EarAddToNet"),f.dgvPayrollAccrual.TableColumns.push("EarFType"),f.dgvPayrollAccrual.TableColumns.push("Earnings_GRAY"),f.dgvPayrollAccrual.TableColumns.push("EarValue_GRAY"),f.dgvPayrollAccrual.TableColumns.push("EarSNo"),f.dgvPayrollAccrual.TableColumns.push("EarFormula"),f.dgvPayrollAccrual.TableColumns.push("EarROff"),f.dgvPayrollAccrual.TableColumns.push("EarComponentID"),f.dgvPayrollAccrual.TableColumns.push("IsVisible"),f.dgvPayrollAccrual.TableColumns.push("IsAccrualType"),f.dgvPayrollDed.Table=[],f.dgvPayrollDed.TableColumns.push("SlNo"),f.dgvPayrollDed.TableColumns.push("Deductions"),f.dgvPayrollDed.TableColumns.push("DedValue"),f.dgvPayrollDed.TableColumns.push("DedAddToNet"),f.dgvPayrollDed.TableColumns.push("DedFType"),f.dgvPayrollDed.TableColumns.push("Deductions_GRAY"),f.dgvPayrollDed.TableColumns.push("DedValue_GRAY"),f.dgvPayrollDed.TableColumns.push("DedSNo"),f.dgvPayrollDed.TableColumns.push("DedFormula"),f.dgvPayrollDed.TableColumns.push("DedROff"),f.dgvPayrollDed.TableColumns.push("DedComponentID"),f.dgvPayrollDed.TableColumns.push("IsVisible"),f.dgvPayrollEar.BeginEdit.Subscribe(_assertThisInitialized(f),"dgvPayrollEar_BeginEdit"),f.dgvPayrollEar.CellEditEnding.Subscribe(_assertThisInitialized(f),"dgvPayrollEar_EndEdit"),f.dgvPayrollAccrual.BeginEdit.Subscribe(_assertThisInitialized(f),"dgvPayrollAccrual_BeginEdit"),f.dgvPayrollAccrual.CellEditEnding.Subscribe(_assertThisInitialized(f),"dgvPayrollAccrual_EndEdit"),f.dgvPayrollDed.BeginEdit.Subscribe(_assertThisInitialized(f),"dgvPayrollDed_BeginEdit"),f.dgvPayrollDed.CellEditEnding.Subscribe(_assertThisInitialized(f),"dgvPayrollDed_EndEdit"),f.LoadPayrollGrid(),f.dgvPayrollEar.Column=0,f.dgvPayrollEar.Row=2,f.dgvPayrollEar.ColumnSpan=2,f.dgvPayrollEar.RowSpan=5,f.dgvPayrollAccrual.Column=0,f.dgvPayrollAccrual.Row=2,f.dgvPayrollAccrual.ColumnSpan=2,f.dgvPayrollAccrual.RowSpan=5,f.dgvPayrollDed.Column=2,f.dgvPayrollDed.Row=2,f.dgvPayrollDed.ColumnSpan=2,f.dgvPayrollDed.RowSpan=5,f.ScreenObject.CustomTab.Pages.find((function(e){return 720==e.DBColumnID})),f.iPayrollTabIndex=f.ScreenObject.CustomTab.Pages.findIndex((function(e){return 720==e.DBColumnID})),f.ScreenObject.CustomTab.Pages[f.iPayrollTabIndex].Fields.push(f.dgvPayrollEar),f.ScreenObject.CustomTab.Pages[f.iPayrollTabIndex].Fields.push(f.dgvPayrollDed),f.ScreenObject.CustomTab.Pages[f.iPayrollTabIndex].Fields.push(f.dgvPayrollAccrual),f.iAccruCnt>0&&(f.dgvPayrollAccrual.Visible=!0),b.a.SessionManager.Preferences.ContainsKey("ConsiderGradeWiseSalarySlabs")&&"True"==b.a.SessionManager.Preferences.ConsiderGradeWiseSalarySlabs){var P=new r.a;P.Label="Pick Min.",P.Column=3,P.Row=0,P.ImgData="btn_min",P.Icon="fa-light fa-windows-maximize",P.ComParam="PickMin",P.Margin="-30,2,40,2",P.Width="50",f.ScreenObject.CustomTab.Pages[f.iPayrollTabIndex].Fields.push(P);var v=new r.a;v.Label="Pick Max.",v.Column=3,v.Row=0,P.ImgData="btn_min",P.Icon="fa-light fa-windows-maximize",v.ComParam="PickMax",v.Margin="40,2,2,2",v.Width="50",f.ScreenObject.CustomTab.Pages[f.iPayrollTabIndex].Fields.push(v)}f.dgvAppraisal=new g.a,f.dgvAppraisal.DoubleClick.Subscribe(_assertThisInitialized(f),"dgvAppraisal_CellDoubleClick"),f.dgvAppraisal.Columns=[],f.dgvAppraisal.Height=250,f.dgvAppraisal.Width="",f.dgvAppraisal.Table=[],(E=new D.a).Header=b.a.GetResource("Payroll_EmpSNo"),E.DisplayMember="SlNo",E.ID="SlNo",E.Width=60,E.ReadOnly=!0,f.dgvAppraisal.Columns.push(E),(E=new D.a).Header=b.a.GetResource("Payroll_AppraisalDate"),E.DisplayMember="AppraisalDate",E.ID="AppraisalDate",E.Width=100,E.ReadOnly=!0,f.dgvAppraisal.Columns.push(E),(E=new D.a).Header=b.a.GetResource("Payroll_NetSalary"),E.DisplayMember="NetSalary",E.ID="NetSalary",E.Width=100,E.DataType="FLOAT",E.ReadOnly=!0,f.dgvAppraisal.Columns.push(E),(E=new D.a).Header=b.a.GetResource("Payroll_Basic"),E.DisplayMember="Basic",E.ID="Basic",E.Width=90,E.DataType="FLOAT",E.ReadOnly=!0,f.dgvAppraisal.Columns.push(E),f.LoadAppraisalGrid(),(E=new D.a).Header=b.a.GetResource("Payroll_Remarks"),E.DisplayMember="Remarks",E.ID="Remarks",E.Width=150,E.ReadOnly=!0,f.dgvAppraisal.Columns.push(E),(E=new D.a).Header=b.a.GetResource("Payroll_Reason"),E.DisplayMember="Reason",E.ID="Reason",E.Width=150,E.ReadOnly=!0,f.dgvAppraisal.Columns.push(E),(E=new D.a).Header=b.a.GetResource("Payroll_AppraisalType"),E.DisplayMember="AppraisalType",E.ID="AppraisalType",E.Width=100,E.ReadOnly=!0,E.IsVisible=!(!b.a.SessionManager.Preferences.ContainsKey("ShowApprslTypeLookUpFldsInApprPopup")||"True"!=b.a.SessionManager.Preferences.ShowApprslTypeLookUpFldsInApprPopup),f.dgvAppraisal.Columns.push(E),f.dgvAppraisal.Column=0,f.dgvAppraisal.Row=0,f.dgvAppraisal.ColumnSpan=4,f.dgvAppraisal.RowSpan=5,f.ScreenObject.CustomTab.Pages.find((function(e){return 726==e.DBColumnID})),f.iAppraisalTabIndex=f.ScreenObject.CustomTab.Pages.findIndex((function(e){return 726==e.DBColumnID})),f.ScreenObject.CustomTab.Pages[f.iAppraisalTabIndex].Fields.push(f.dgvAppraisal),f.pcbALType=new n.e,f.pcbALType.Row=1,f.pcbALType.Column=0,f.pcbALType.DBColumnName="pcbALType",f.pcbALType.Items.push(n.d.ComboBoxItems_1("Earnings")),f.pcbALType.Items.push(n.d.ComboBoxItems_1("Deductions")),f.pcbALType.Items.push(n.d.ComboBoxItems_1("Loans")),f.pcbALType.SelectionChangedCommand.Subscribe(_assertThisInitialized(f),"pcbALType_SelectionChanged"),f.dgvAccLinking=new g.a,f.dgvAccLinking.Columns=[],f.dgvAccLinking.Height=250,f.dgvAccLinking.Width="",f.dgvAccLinking.DBColumnName="EMPACCOUNTLINK",(E=new D.a).Header=b.a.GetResource("Payroll_EmpSNo"),E.DisplayMember="SlNo",E.ID="SlNo",E.Width=60,E.ReadOnly=!0,f.dgvAccLinking.Columns.push(E),(E=new D.a).Header=b.a.GetResource("Payroll_EmpComponentName"),E.DisplayMember="ComponentName",E.ID="ComponentName",E.Width=300,E.ReadOnly=!0,f.dgvAccLinking.Columns.push(E),(E=new D.a).Header=b.a.GetResource("Payroll_EmpDebitAccount"),E.DisplayMember="DebitAccountID",E.ID="DebitAccountID",E.DataType="LISTBOX",E.CostCenterID=2,E.TypeID=2,E.Width=250,E.IsVisible=!0,f.dgvAccLinking.Columns.push(E),(E=new D.a).Header=b.a.GetResource("Payroll_EmpCreditAccount"),E.DisplayMember="CreditAccountID",E.ID="CreditAccountID",E.DataType="LISTBOX",E.CostCenterID=2,E.TypeID=2,E.Width=250,E.IsVisible=!0,f.dgvAccLinking.Columns.push(E),f.dgvAccLinking.Column=0,f.dgvAccLinking.Row=2,f.dgvAccLinking.ColumnSpan=4,f.dgvAccLinking.RowSpan=5,f.dgvAccLinking.Table=[],f.LoadAccountLinkingGrid(),f.ScreenObject.CustomTab.Pages.find((function(e){return 732==e.DBColumnID})),f.iAccLinkTabIndex=f.ScreenObject.CustomTab.Pages.findIndex((function(e){return 732==e.DBColumnID})),f.ScreenObject.CustomTab.Pages[f.iAccLinkTabIndex].Fields.push(f.pcbALType),f.ScreenObject.CustomTab.Pages[f.iAccLinkTabIndex].Fields.push(f.dgvAccLinking),f.pcbALType.SelectedValue=f.pcbALType.Items[0].Value,f.pcbALType_SelectionChanged(""),f.ViewEmpDocuments=new N(_assertThisInitialized(f)),f.ViewEmpDocuments.OwnedScreen=_assertThisInitialized(f);for(var M=f.ScreenObject.CustomTab.Pages.length-1;M>=0;M--){var V=f.ScreenObject.CustomTab.Pages[M];switch(V.Name){case"Notes":V.Fields.push(f.ViewNotes);break;case"Contacts":V.Fields.push(f.ViewContacts);break;case"Address":V.Fields.push(f.ViewAddress);break;case"Attachments":V.Fields.push(f.ViewAttachments);break;case"Assign":V.Fields.push(f.ViewCCMapping);break;case"Documents":V.Fields.push(f.ViewEmpDocuments)}}f.ContactVisibility=!1,f.DetailsVisibility=!1,f.AttachmentVisibility=!1,f.AddressVisibility=!1,f.CCMapVisibility=!1,f.EmpDocumentsVisibility=!1,f.ScreenObject.CustomTab.OnTabChange.Subscribe(_assertThisInitialized(f),"OnTabSelectionChanged"),f.EmpGroup.SelectionChangedCommand.Subscribe(_assertThisInitialized(f),"OnGroupSelectionChanged"),f.pc1=f.GetScreenControl("iBank"),f.pc1.SelectionChangedCommand.Subscribe(_assertThisInitialized(f),"GetBankDetails");var w=f.GetScreenControl("AttSetType");if(w.Items[0].CheckedChangedCommand.Subscribe(_assertThisInitialized(f),"AttSetTypeCheckedChanged"),w.Items[1].CheckedChangedCommand.Subscribe(_assertThisInitialized(f),"AttSetTypeCheckedChanged"),f.AttSetTypeCheckedChanged(w.Items[0]),f.ButtonSave=new r.a,f.ButtonCustomize=new r.a,f.ButtonAppraisal=new r.a,0==f.NodeID?(f.DisplayName=-1==y.indexOf("Add")?b.a.GetResource("Add")+" "+y:y,b.a.SessionManager.HideUnathorizedAccess?f.ButtonSave.Visible=b.a.SessionManager.IsActionAssigned(f.CostCenterID,"Create"):f.ButtonSave.Enable=b.a.SessionManager.IsActionAssigned(f.CostCenterID,"Create"),f.EmpGroup.SelectedValue=f.ParentId,f.EmpGroup.DefaultValue=f.EmpGroup.SelectedValue.toString(),f.IsEdit=!1):(f.DisplayName=-1==y.indexOf("Edit")?b.a.GetResource("Edit")+" "+y:y,b.a.SessionManager.HideUnathorizedAccess?f.ButtonSave.Visible=b.a.SessionManager.IsActionAssigned(f.CostCenterID,"Update"):f.ButtonSave.Enable=b.a.SessionManager.IsActionAssigned(f.CostCenterID,"Update"),f.IsEdit=!0),b.a.SessionManager.HideUnathorizedAccess?f.ButtonAppraisal.Visible=b.a.SessionManager.IsActionAssigned(f.CostCenterID,"Appraisal"):f.ButtonAppraisal.Enable=b.a.SessionManager.IsActionAssigned(f.CostCenterID,"Appraisal"),b.a.SessionManager.HideUnathorizedAccess?f.ButtonCustomize.Visible=b.a.SessionManager.IsActionAssigned(f.CostCenterID,"Customize"):f.ButtonCustomize.Enable=b.a.SessionManager.IsActionAssigned(f.CostCenterID,"Customize"),null!=f.ScreenObject.Data&&f.ScreenObject.Data.Tables.length>0&&f.ScreenObject.Data.Tables[0].length>0){var F,L;f.ScreenObject.Data.Tables.length>2&&f.ScreenObject.Data.Tables[3].forEach((function(e){f.Status.Items.push(n.d.ComboBoxItems_2(e[Object.keys(e)[1]].toString(),e[Object.keys(e)[0]].toString()))})),f.dvLookUps=f.ScreenObject.Data.Tables[8],f.ScreenObject.Data.Tables.length>8&&((F=f.dvLookUps.filter((function(e){return"104"==e.LookupType})))&&f.FillComboWithDefaultOption(F,f.EmpType,!0),(F=f.dvLookUps.filter((function(e){return"123"==e.LookupType})))&&f.FillComboWithDefaultOption(F,f.Gender,!0)),f.ScreenObject.HeaderFields.length>0&&f.ScreenObject.HeaderFields.forEach((function(e){if(e instanceof n.e)if("MaritalStatus"==e.DBColumnName)f.pcbMaritalStatus=e,(F=f.dvLookUps.filter((function(e){return"122"==e.LookupType})))&&f.FillComboWithDefaultOption(F,e,!0);else if("PayType"==e.DBColumnName)e.Items.push(n.d.ComboBoxItems_2("Monthly","Monthly")),e.Items.push(n.d.ComboBoxItems_2("Weekly","Weekly")),e.Items.push(n.d.ComboBoxItems_2("Daily","Daily")),e.Items.push(n.d.ComboBoxItems_2("Hourly","Hourly")),e.SelectedValue="Monthly";else if("IsAllowOT"==e.DBColumnName)e.Items.push(n.d.ComboBoxItems_2("Yes","Yes")),e.Items.push(n.d.ComboBoxItems_2("No","No")),e.SelectedValue="No";else if("WeeklyOff1"==e.DBColumnName||"WeeklyOff2"==e.DBColumnName)e.Items.push(n.d.ComboBoxItems_2("None","None")),e.Items.push(n.d.ComboBoxItems_2("Sunday","Sunday")),e.Items.push(n.d.ComboBoxItems_2("Monday","Monday")),e.Items.push(n.d.ComboBoxItems_2("Tuesday","Tuesday")),e.Items.push(n.d.ComboBoxItems_2("Wednesday","Wednesday")),e.Items.push(n.d.ComboBoxItems_2("Thursday","Thursday")),e.Items.push(n.d.ComboBoxItems_2("Friday","Friday")),e.Items.push(n.d.ComboBoxItems_2("Saturday","Saturday")),e.SelectedValue="None";else if("PaymentMode"==e.DBColumnName)f.pcbPaymentMode=e,f.pcbPaymentMode.Items.push(n.d.ComboBoxItems_2("Cash","Cash")),f.pcbPaymentMode.Items.push(n.d.ComboBoxItems_2("Cheque","Cheque")),f.pcbPaymentMode.Items.push(n.d.ComboBoxItems_2("Bank Transfer","Bank Transfer")),f.pcbPaymentMode.Items.push(n.d.ComboBoxItems_2("Demand Draft","Demand Draft")),f.pcbPaymentMode.SelectionChangedCommand.Subscribe(_assertThisInitialized(f),"PaymentMode_SelectionChanged"),f.pcbPaymentMode.SelectedValue="Cash",f.PaymentMode_SelectionChanged("");else if("VacationPeriod"==e.DBColumnName)e.Items.push(n.d.ComboBoxItems_2("Half Yearly","Half Yearly")),e.Items.push(n.d.ComboBoxItems_2("Yearly","Yearly")),e.Items.push(n.d.ComboBoxItems_2("Two Years","Two Years")),e.SelectedValue="Yearly";else if("TktAirClass"==e.DBColumnName)e.Items.push(n.d.ComboBoxItems_2("First Class","First Class")),e.Items.push(n.d.ComboBoxItems_2("Business Class","Business Class")),e.Items.push(n.d.ComboBoxItems_2("Economy Class","Economy Class"));else if("Nationality"==e.DBColumnName)f.pcbNationality=e,(F=f.dvLookUps.filter((function(e){return"108"==e.LookupType})))&&f.FillComboWithDefaultOption(F,e,!0);else if("Religion"==e.DBColumnName)f.pcbReligion=e,(F=f.dvLookUps.filter((function(e){return"114"==e.LookupType})))&&f.FillComboWithDefaultOption(F,e,!0);else if("CanCreateUser"==e.DBColumnName)e.Items.push(n.d.ComboBoxItems_2("Yes","Yes")),e.Items.push(n.d.ComboBoxItems_2("No","No")),e.SelectedValue="No";else if("RoleID"==e.DBColumnName){var t=f.GetRoles();t.Tables.length>0&&t.Tables[0].length>0&&t.Tables[0].forEach((function(t){e.Items.push(n.d.ComboBoxItems_2(t.Name.toString(),t.RoleID.toString())),b.a.SessionManager.StringIsNullOrEmpty(t.IsUserDefined)||"FALSE"!=t.IsUserDefined.toString().toUpperCase()||b.a.SessionManager.StringIsNullOrEmpty(t.CompanyGUID)||"HRM-Employee-Role"!=t.CompanyGUID.toString()||(e.SelectedValue=t.RoleID.toString())}))}else"IsManager"==e.DBColumnName&&(e.Items.push(n.d.ComboBoxItems_2("Yes","Yes")),e.Items.push(n.d.ComboBoxItems_2("No","No")),e.SelectedValue="No");else e instanceof o.b&&("SalaryAccID"==e.DBColumnName?b.a.SessionManager.Preferences.ContainsKey("CreateSalaryAcc")&&"True"==b.a.SessionManager.Preferences.CreateSalaryAcc&&parseInt(b.a.SessionManager.Preferences.CreateSalaryAccGrp)>0&&(e.CustomWhere=" a.IsGroup=0 AND a.ParentID="+parseInt(b.a.SessionManager.Preferences.CreateSalaryAccGrp)):"PayableAccID"==e.DBColumnName&&b.a.SessionManager.Preferences.ContainsKey("CreatePayableAcc")&&"True"==b.a.SessionManager.Preferences.CreatePayableAcc&&parseInt(b.a.SessionManager.Preferences.CreatePayableAccGrp)>0&&(e.CustomWhere=" a.IsGroup=0 AND a.ParentID="+parseInt(b.a.SessionManager.Preferences.CreatePayableAccGrp)))})),f.ScreenObject.CustomTab.Pages.length>0&&f.ScreenObject.CustomTab.Pages.forEach((function(e){e.Fields.forEach((function(e){if(e instanceof n.e)if("MaritalStatus"==e.DBColumnName)f.pcbMaritalStatus=e,(F=f.dvLookUps.filter((function(e){return"122"==e.LookupType})))&&f.FillComboWithDefaultOption(F,e,!0);else if("PayType"==e.DBColumnName)e.Items.push(n.d.ComboBoxItems_2("Monthly","Monthly")),e.Items.push(n.d.ComboBoxItems_2("Weekly","Weekly")),e.Items.push(n.d.ComboBoxItems_2("Daily","Daily")),e.Items.push(n.d.ComboBoxItems_2("Hourly","Hourly")),e.SelectedValue="Monthly";else if("IsAllowOT"==e.DBColumnName)e.Items.push(n.d.ComboBoxItems_2("Yes","Yes")),e.Items.push(n.d.ComboBoxItems_2("No","No")),e.SelectedValue="No";else if("WeeklyOff1"==e.DBColumnName||"WeeklyOff2"==e.DBColumnName)e.Items.push(n.d.ComboBoxItems_2("None","None")),e.Items.push(n.d.ComboBoxItems_2("Sunday","Sunday")),e.Items.push(n.d.ComboBoxItems_2("Monday","Monday")),e.Items.push(n.d.ComboBoxItems_2("Tuesday","Tuesday")),e.Items.push(n.d.ComboBoxItems_2("Wednesday","Wednesday")),e.Items.push(n.d.ComboBoxItems_2("Thursday","Thursday")),e.Items.push(n.d.ComboBoxItems_2("Friday","Friday")),e.Items.push(n.d.ComboBoxItems_2("Saturday","Saturday")),e.SelectedValue="None";else if("PaymentMode"==e.DBColumnName)f.pcbPaymentMode=e,f.pcbPaymentMode.Items.push(n.d.ComboBoxItems_2("Cash","Cash")),f.pcbPaymentMode.Items.push(n.d.ComboBoxItems_2("Cheque","Cheque")),f.pcbPaymentMode.Items.push(n.d.ComboBoxItems_2("Bank Transfer","Bank Transfer")),f.pcbPaymentMode.Items.push(n.d.ComboBoxItems_2("Demand Draft","Demand Draft")),f.pcbPaymentMode.SelectionChangedCommand.Subscribe(_assertThisInitialized(f),"PaymentMode_SelectionChanged"),f.pcbPaymentMode.SelectedValue="Cash",f.PaymentMode_SelectionChanged("");else if("VacationPeriod"==e.DBColumnName)e.Items.push(n.d.ComboBoxItems_2("Half Yearly","Half Yearly")),e.Items.push(n.d.ComboBoxItems_2("Yearly","Yearly")),e.Items.push(n.d.ComboBoxItems_2("Two Years","Two Years")),e.SelectedValue="Yearly";else if("TktAirClass"==e.DBColumnName)e.Items.push(n.d.ComboBoxItems_2("First Class","First Class")),e.Items.push(n.d.ComboBoxItems_2("Business Class","Business Class")),e.Items.push(n.d.ComboBoxItems_2("Economy Class","Economy Class"));else if("Nationality"==e.DBColumnName)f.pcbNationality=e,(F=f.dvLookUps.filter((function(e){return"108"==e.LookupType})))&&f.FillComboWithDefaultOption(F,e,!0);else if("Religion"==e.DBColumnName)f.pcbReligion=e,(F=f.dvLookUps.filter((function(e){return"114"==e.LookupType})))&&f.FillComboWithDefaultOption(F,e,!0);else if("CanCreateUser"==e.DBColumnName)e.Items.push(n.d.ComboBoxItems_2("Yes","Yes")),e.Items.push(n.d.ComboBoxItems_2("No","No")),e.SelectedValue="No";else if("RoleID"==e.DBColumnName){var t=f.GetRoles();t.Tables.length>0&&t.Tables[0].length>0&&t.Tables[0].forEach((function(t){e.Items.push(n.d.ComboBoxItems_2(t.Name.toString(),t.RoleID.toString())),b.a.SessionManager.StringIsNullOrEmpty(t.IsUserDefined)||"FALSE"!=t.IsUserDefined.toString().toUpperCase()||b.a.SessionManager.StringIsNullOrEmpty(t.CompanyGUID)||"HRM-Employee-Role"!=t.CompanyGUID.toString()||(e.SelectedValue=t.RoleID.toString())}))}else"IsManager"==e.DBColumnName&&(e.Items.push(n.d.ComboBoxItems_2("Yes","Yes")),e.Items.push(n.d.ComboBoxItems_2("No","No")),e.SelectedValue="No");else e instanceof o.b&&("SalaryAccID"==e.DBColumnName?b.a.SessionManager.Preferences.ContainsKey("CreateSalaryAcc")&&"True"==b.a.SessionManager.Preferences.CreateSalaryAcc&&parseInt(b.a.SessionManager.Preferences.CreateSalaryAccGrp)>0&&(e.CustomWhere=" a.IsGroup=0 AND a.ParentID="+parseInt(b.a.SessionManager.Preferences.CreateSalaryAccGrp)):"PayableAccID"==e.DBColumnName&&b.a.SessionManager.Preferences.ContainsKey("CreatePayableAcc")&&"True"==b.a.SessionManager.Preferences.CreatePayableAcc&&parseInt(b.a.SessionManager.Preferences.CreatePayableAccGrp)>0&&(e.CustomWhere=" a.IsGroup=0 AND a.ParentID="+parseInt(b.a.SessionManager.Preferences.CreatePayableAccGrp)));e instanceof n.b&&"CheckInOutDevice"==e.DBColumnName&&(e.Items.push(n.c.CheckedListBoxItem_3("Desktop","1")),e.Items.push(n.c.CheckedListBoxItem_3("Web","2")),e.Items.push(n.c.CheckedListBoxItem_3("Mobile","3")))}))})),f.Title=f.DisplayName,null!=(L=f.ScreenObject.Data.Tables[5].filter((function(e){return"CapsLock"==e.Name})))&&L.length>0&&"true"==L[0].Value.toString().toLowerCase()&&(f.EmpName.IsAllCaps=!0),null!=(L=f.ScreenObject.Data.Tables[5].filter((function(e){return"CapsToFirstLetter"==e.Name})))&&L.length>0&&"true"==L[0].Value.toString().toLowerCase()&&(f.EmpName.IsFirstLetterCaps=!0),(L=f.ScreenObject.Data.Tables[5].filter((function(e){return"AttachementThumbnail"==e.Name}))).length>0&&Object(c.j)(L[0].Value)&&(f.ViewAttachments.GridView=!0),null!=f.ScreenObject.Data&&f.ScreenObject.Data.Tables.length>7&&f.ScreenObject.Data.Columns[7].Contains("IsParentCodeInherited")&&f.ScreenObject.Data.Tables[7].length>0&&f.ScreenObject.InitAutoCode(f.ScreenObject.Data.Tables[7],f.objEmp.IsGroup),f.IsPhotoChanged=!1,f.PhotoTextVisibility=!0,f.AccountPhoto="";var O=f.objEmp.GetQueryData(0,"dtApprRes","","","");if(null!=O&&O.length>0){var B=O.filter((function(e){return"dcAlpha3"==e.SysColumnName}));null!=B&&B.length>0&&(f.ButtonAppraisal.Label=B[0].ResourceData.toString())}f.Status.SelectedValue=""!=b.a.SessionManager.Preferences.DefaultEmpStatus?b.a.SessionManager.Preferences.DefaultEmpStatus:"250",f.txtVacDaysPerMonth=f.GetScreenControl("VacDaysPerMonth"),null!=f.txtVacDaysPerMonth&&(f.txtVacDaysPerMonth.Currency.SelectedValue=b.a.SessionManager.Preferences.DefVacationDaysMonthlyOrYearly,f.txtVacDaysPerMonth.ExchangeRate.Text=b.a.SessionManager.Preferences.DefVacationDays);var k=f.objEmp.LoadStructure_1(b.a.SessionManager.PayrollMonthEnd.ToString("dd/MMM/yyyy"),f.sFilter);null!=k&&k.Tables.length>0&&(f.dvCCData=k.Tables[0]);var x=f.objEmp.GetQueryData(0,"dvDimsData","","","");if(null!=x&&null!=x&&(f.dvDimsData=x),f.ScreenObject.NodeID=f.NodeID,b.a.SessionManager.Preferences.ContainsKey("AttendanceDimension")&&""!=b.a.SessionManager.Preferences.AttendanceDimension.toString()&&"4"!=b.a.SessionManager.Preferences.AttendanceDimension.toString()){var R=f.objEmp.GetQueryData(0,"AttendanceDimension",f.ScreenObject.GetTableName(parseInt(b.a.SessionManager.Preferences.AttendanceDimension)),"","");if(null!=R&&R.length>0){var _=f.GetScreenControl("AttSetDimNodes");if(_ instanceof n.b){_.Items.push(n.c.CheckedListBoxItem_3("All","-1"));for(var j=0;j<R.length;j++)_.Items.push(n.c.CheckedListBoxItem_3(R[j].Name.toString(),R[j].NodeID.toString()))}}}f.EmpCurrentStatus="",0!=f.NodeID?(f.FillControls(),f.EmpCurrentStatusVisibility=!0):(f.EmpCurrentStatusVisibility=!1,f.objEmp.GUID="",f.NextPreviousVisibility=!1,f.AutoGenerateCode()),f.CheckViewForUser(0)}return f.RestrictSaveButton(),f.pcbALType_SelectionChanged(""),_possibleConstructorReturn(f)}return _createClass(i,[{key:"OnComboChange",value:function(e){console.log(e)}},{key:"OnPListChange",value:function(e){}},{key:"fn_AttachmentVisibility",value:function(){this.AttachmentVisibility?(this.DetailsVisibility=!1,this.ContactVisibility=!1,this.NoteVisibility=!1,this.AddressVisibility=!1,this.CCMapVisibility=!1,this.EmpDocumentsVisibility=!1):this.ContactVisibility||this.NoteVisibility||this.AddressVisibility||this.AttachmentVisibility||this.CCMapVisibility||this.EmpDocumentsVisibility||(this.DetailsVisibility=!0)}},{key:"fn_NoteVisibility",value:function(){this.NoteVisibility?(this.DetailsVisibility=!1,this.ContactVisibility=!1,this.AttachmentVisibility=!1,this.AddressVisibility=!1,this.CCMapVisibility=!1,this.EmpDocumentsVisibility=!1):this.ContactVisibility||this.NoteVisibility||this.AddressVisibility||this.AttachmentVisibility||this.CCMapVisibility||this.EmpDocumentsVisibility||(this.DetailsVisibility=!0)}},{key:"fn_DetailsVisibility",value:function(){this.DetailsVisibility&&(this.ContactVisibility=!1,this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.AddressVisibility=!1,this.CCMapVisibility=!1,this.EmpDocumentsVisibility=!1)}},{key:"fn_ContactVisibility",value:function(){this.ContactVisibility?(this.DetailsVisibility=!1,this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.AddressVisibility=!1,this.CCMapVisibility=!1,this.EmpDocumentsVisibility=!1):this.ContactVisibility||this.NoteVisibility||this.AddressVisibility||this.AttachmentVisibility||this.CCMapVisibility||this.EmpDocumentsVisibility||(this.DetailsVisibility=!0)}},{key:"fn_AddressVisibility",value:function(){this.AddressVisibility?(this.DetailsVisibility=!1,this.ContactVisibility=!1,this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.CCMapVisibility=!1,this.EmpDocumentsVisibility=!1):this.ContactVisibility||this.NoteVisibility||this.AddressVisibility||this.AttachmentVisibility||this.CCMapVisibility||this.EmpDocumentsVisibility||(this.DetailsVisibility=!0)}},{key:"fn_CCMapVisibility",value:function(){this.CCMapVisibility?(this.DetailsVisibility=!1,this.ContactVisibility=!1,this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.EmpDocumentsVisibility=!1):this.ContactVisibility||this.NoteVisibility||this.AddressVisibility||this.AttachmentVisibility||this.CCMapVisibility||this.EmpDocumentsVisibility||(this.DetailsVisibility=!0)}},{key:"fn_EmpDocumentsVisibility",value:function(){this.EmpDocumentsVisibility?(this.DetailsVisibility=!1,this.ContactVisibility=!1,this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.CCMapVisibility=!1,this.AddressVisibility=!1):this.ContactVisibility||this.NoteVisibility||this.AddressVisibility||this.AttachmentVisibility||this.CCMapVisibility||this.EmpDocumentsVisibility||(this.DetailsVisibility=!0)}},{key:"FillComboWithDefaultOption",value:function(e,t,i){b.a.SessionManager.Logger.InfoLog("Administration:: Inside FillComboWithDefaultOption");try{i&&t.Items.push(n.d.ComboBoxItems_2("","0")),null!=e&&e.length>0?e.forEach((function(e){t.Items.push(n.d.ComboBoxItems_2(e.Name.toString(),e.NodeID.toString())),b.a.SessionManager.StringIsNullOrEmpty(e.IsDefault)||Object(c.j)(e.IsDefault)&&(t.SelectedValue=e.NodeID.toString(),t.DefaultValue=e.NodeID.toString())})):i&&(t.SelectedValue="0",t.DefaultValue="0")}catch(a){b.a.SessionManager.Logger.InfoLog("Administration:: Leaving FillComboWithDefaultOption")}b.a.SessionManager.Logger.InfoLog("Administration:: Leaving FillComboWithDefaultOption")}},{key:"CheckTabViewForUser",value:function(){var e=this,t=this.ScreenObject.Data.Tables[this.ScreenObject.Data.Tables.length-1];t.sort((function(e,t){return e.TabOrder-t.TabOrder}));for(var i=function(i){var a=1;if(null!=t[i].CCTabID&&""!=t[i].CCTabID){a=parseInt(t[i].CCTabID);var s=e.ScreenObject.CustomTab.Pages.find((function(e){return e.DBColumnID==a}));null!=s&&null!=s&&(s.Visible=!b.a.SessionManager.StringIsNullOrEmpty(t[i].IsVisible)&&0!==y.e.Int(t[i].IsVisible))}else a=1;var n=e.ScreenObject.Data.Tables[e.ScreenObject.Data.Tables.length-2];if(null!=n&&null!=n&&n.length>0&&n.some((function(e){return e.hasOwnProperty("CostCenterColID")}))&&(n=n.filter((function(e){return"0"==e.CostCenterColID&&e.Tabid>0}))),null!=n&&null!=n&&n.length>0&&n.some((function(e){return e.hasOwnProperty("CostCenterColID")}))&&(null!=(n=n.filter((function(e){return e.Tabid==a})))&&n.length>0)){var l=e.ScreenObject.CustomTab.Pages.find((function(e){return e.DBColumnID==a}));null!=l&&null!=l&&(!y.e.IsEmpty(n[0].IsReadOnly)&&Object(c.j)(n[0].IsReadOnly)&&(l.IsReadOnly=!0),l.Visible=!(y.e.IsEmpty(n[0].IsVisible)||!Object(c.j)(n[0].IsVisible)))}},a=0;a<t.length;a++)i(a)}},{key:"CheckViewForUser",value:function(e){if(null!=this.ScreenObject.Data&&this.ScreenObject.Data.Tables.length>3&&this.ScreenObject.Data.Tables[this.ScreenObject.Data.Tables.length-2].length>0){for(var t=0;t<this.dgvPayrollEar.Table.length;t++)y.e.StringIsNullOrEmpty(this.dgvPayrollEar.Table[t].EarSNo)||this.SetView(this.dgvPayrollEar.Table[t],e,"Earnings");for(var i=0;i<this.dgvPayrollDed.Table.length;i++)y.e.StringIsNullOrEmpty(this.dgvPayrollDed.Table[i].DedSNo)||this.SetView(this.dgvPayrollDed.Table[i],e,"Deductions");if(0==this.dgvPayrollEar.Table.filter((function(e){return"False"!=e.IsVisible})).length){var a=this.dgvPayrollEar.NewRow();this.dgvPayrollEar.addRow(a)}if(0==this.dgvPayrollDed.Table.filter((function(e){return"False"!=e.IsVisible})).length){var s=this.dgvPayrollDed.NewRow();this.dgvPayrollDed.addRow(s)}for(var n=0;n<this.dgvAppraisal.Columns.length;n++)y.e.StringIsNullOrEmpty(this.dgvAppraisal.Columns[n].DisplayMember)||!this.dgvAppraisal.Columns[n].DisplayMember.startsWith("Earning")&&!this.dgvAppraisal.Columns[n].DisplayMember.startsWith("Deduction")||this.SetView(this.dgvAppraisal.Columns[n],e,"Appraisal");var l=this.ScreenObject.Data.Tables[this.ScreenObject.Data.Tables.length-2];null!=(l=(l=l.filter((function(e){return(2==e.Mode||3==e.Mode)&&2000005==e.CostCenterColID}))).filter(this.IsEdit?function(e){return(2==e.Mode||3==e.Mode)&&2000005==e.CostCenterColID}:function(e){return(1==e.Mode||3==e.Mode)&&2000005==e.CostCenterColID}))&&null!=l&&l.length>0&&(this.dgvPayrollEar.Visible=Object(c.j)(l[0].IsVisible.toString()),this.dgvPayrollEar.IsReadOnly=!Object(c.j)(l[0].IsEditable.toString()));var o=this.ScreenObject.Data.Tables[this.ScreenObject.Data.Tables.length-2];null!=(o=o.filter(this.IsEdit?function(e){return(2==e.Mode||3==e.Mode)&&2000015==e.CostCenterColID}:function(e){return(1==e.Mode||3==e.Mode)&&2000015==e.CostCenterColID}))&&o.length>0&&(this.dgvPayrollDed.Visible=Object(c.j)(o[0].IsVisible.toString()),this.dgvPayrollDed.IsReadOnly=!Object(c.j)(o[0].IsEditable.toString()))}this.CheckTabViewForUser()}},{key:"SetView",value:function(e,t,i){var a=this.ScreenObject.Data.Tables[this.ScreenObject.Data.Tables.length-2],s=this.ScreenObject.Data.Tables[0];a=a.filter(this.IsEdit?function(e){return 2==e.Mode||3==e.Mode}:function(e){return 1==e.Mode||3==e.Mode}),e instanceof h.c?a=a.filter((function(t){return t.SysColumnName==e.DBColumnName})):e instanceof D.a&&(a="combobox"==e.DataType.toLowerCase()?a.filter((function(t){return t.SysColumnName==e.ValueBinding})):e.DisplayMember.startsWith("Earning")||e.DisplayMember.startsWith("Deduction")?a.filter((function(t){return t.CostCenterColID==3e6+parseInt(e.ID)})):a.filter((function(t){return t.SysColumnName==e.DisplayMember}))),"Earnings"==i&&(a=a.filter((function(t){return t.CostCenterColID==1e6+parseInt(e.EarComponentID)}))),"Deductions"==i&&(a=a.filter((function(t){return t.CostCenterColID==1e6+parseInt(e.DedComponentID)}))),a.length>0?e instanceof h.c?e.Visible=Object(c.j)(a[0].IsVisible.toString()):e.IsVisible=Object(c.j)(a[0].IsVisible.toString()):(e instanceof h.c?s=s.filter((function(t){return t.SysColumnName==e.DBColumnName})):e instanceof D.a&&(s="combobox"==e.DataType.toLowerCase()?s.filter((function(t){return t.SysColumnName==e.ValueBinding})):s.filter(3==e.CostCenterID||2==e.CostCenterID?function(t){return t.CostcenterColID==e.ID}:function(t){return t.SysColumnName==e.DisplayMember})),e instanceof D.a&&(e.EditOption=0),(e instanceof h.c||e instanceof D.a)&&(e.Expression=""),(e instanceof h.c||e instanceof D.a)&&(e.Message=""),(e instanceof h.c||e instanceof D.a)&&(e.Action=0))}},{key:"LoadAccountLinkingGrid",value:function(){var e=this.dsPayStructure.Tables[1];if(e=e.filter((function(e){return 1==e.Type||2==e.Type||3==e.Type})),this.dgvAccLinking.Table.Clear(),null!=e&&null!=e&&e.length>0)for(var t={},i=0;i<e.length;i++)(t=this.dgvAccLinking.NewRow()).SlNo=e[i].Serial.toString(),t.ComponentName=e[i].ComponentName.toString(),t.ComponentID=e[i].ComponentID.toString(),t.ComponentType=e[i].Type.toString(),t.ComponentSNO=e[i].SNo.toString(),t.DebitAccountID_Key=null,t.DebitAccountID=null,t.CreditAccountID_Key=null,t.CreditAccountID=null,this.dgvAccLinking.addRow(t)}},{key:"pcbALType_SelectionChanged",value:function(e){switch(this.isLoad||(this.TempdgvAccLinkingTable=this.dgvAccLinking.Table,this.isLoad=!0),this.dgvAccLinking.Table=this.TempdgvAccLinkingTable,this.pcbALType.SelectedValue){case"Earnings":this.dgvAccLinking.Table=this.dgvAccLinking.Table.filter((function(e){return 1==e.ComponentType})),this.dgvAccLinking.setRowid();break;case"Deductions":this.dgvAccLinking.Table=this.dgvAccLinking.Table.filter((function(e){return 2==e.ComponentType})),this.dgvAccLinking.setRowid();break;case"Loans":this.dgvAccLinking.Table=this.dgvAccLinking.Table.filter((function(e){return 3==e.ComponentType})),this.dgvAccLinking.setRowid()}}},{key:"cmnAppr_Click",value:function(e){if(null!=e&&"Delete"==e.toString()&&null!=this.dgvAppraisal.SelectedItem){var t=this.dgvAppraisal.SelectedItem;if(!confirm("Are you sure want to Delete.?"))return;if(this.objEmp.GetQueryData(this.pc1.SelectedValue,"cmnAppr_Click",t.SeqNo.toString(),"",""),this.LoadAppraisalGrid(),this.dgvAppraisal.Table.length>0){for(var i=0,a=this.dgvAppraisal.Table.length-1;a>=0;a--)if(!y.e.StringIsNullOrEmpty(this.dgvAppraisal.Table[a].SeqNo)){i=a;break}this.txtBasicMonthly.Text=this.dgvAppraisal.Table[i].Basic.toString(),this.txtBasicMonthly_LostFocus(this.txtBasicMonthly)}}}},{key:"DateOfJoining_SelectedDateChanged",value:function(e){if("False"==b.a.SessionManager.Preferences.AcceptFutureDatesForDOJ&&e.Date>new Date)return this.DisplayMessage="You can not enter future dates. It should be Less than or Equal to the System Date",e.Date=(new Date).ToString("dd/MMM/yyyy"),e.SetFocus=!0,void(this.MessageVisibility=!0);""!=this.ProbationDays.Text.trim()&&parseInt(this.ProbationDays.Text)>0&&(this.DateOfConfirmation.Date=this.DateOfJoining.Date.AddDays(parseInt(this.ProbationDays.Text)))}},{key:"GetRoles",value:function(){var e;try{b.a.SessionManager.Logger.InfoLog("AddEditEmpMasterViewModel::Entering GetRoles");var t="";"1"!=b.a.SessionManager.UserID?(t=b.a.SessionManager.Preferences.ContainsKey("LWRole")&&"true"==b.a.SessionManager.Preferences.LWRole.toLowerCase()?b.a.SessionManager.LocationWhereWithParent:null,b.a.SessionManager.Preferences.ContainsKey("DWRole")&&"true"==b.a.SessionManager.Preferences.DWRole.toLowerCase()?t+=b.a.SessionManager.DivisionID>0?"~"+b.a.SessionManager.DivisionID.toString():"~"+b.a.SessionManager.DivisionWhere:t+="~null"):(t=null,t+="~null"),t+="~"+b.a.SessionManager.UserID,t+="~"+b.a.SessionManager.LanguageID,e=this.objEmp.getUserRoles("",t)}catch(i){b.a.SessionManager.Logger.ErrorLog("AddEditEmpMasterViewModel:: GetRoles"+i)}return e}},{key:"PaymentMode_SelectionChanged",value:function(e){var t;switch(this.pcbPaymentMode.SelectedValue){case"Bank Transfer":null!=this.dsEdit&&this.dsEdit.Tables[0].length>0?(this.pc1.Enable=!0,this.pc1=this.GetScreenControl("iBank"),this.pc1.SelectedValue=parseInt(this.dsEdit.Tables[0][0].iBank),this.GetBankDetails(this.pc1),(t=this.GetScreenControl("BankAccNo")).Text=this.dsEdit.Tables[0][0].BankAccNo.toString(),t.Enable=!0,(t=this.GetScreenControl("IBANNo")).Text=this.dsEdit.Tables[0][0].IBANNo.toString(),t.Enable=!0):(this.pc1.Enable=!0,(t=this.GetScreenControl("BankAccNo")).Enable=!0,(t=this.GetScreenControl("IBANNo")).Enable=!0);break;default:null!=this.pc1&&(this.pc1.Enable=!1),(t=this.GetScreenControl("BankAccNo")).Enable=!1,(t=this.GetScreenControl("IBANNo")).Enable=!1,t=this.GetScreenControl("BankBranch"),t=this.GetScreenControl("BankRoutingCode"),t=this.GetScreenControl("BankAgentCode")}}},{key:"GetBankDetails",value:function(e){if(this.pc1.SelectedValue>0&&((0==this.iBankNodeID||this.iBankNodeID!=this.pc1.SelectedValue)&&(this.iBankNodeID=this.pc1.SelectedValue),this.iBankNodeID>0)){this.GetScreenControl("BankBranch").Text="",this.GetScreenControl("BankRoutingCode").Text="",this.GetScreenControl("BankAgentCode").Text="";var t=this.objEmp.GetQueryData(this.pc1.SelectedValue,"GetBankDetails","","","");null!=t&&t.Tables.length>0&&t.Tables[0].length>0&&(b.a.SessionManager.IsWebApplication&&(this.dsGetBankDetails_web=t),this.GetScreenControl("BankBranch").Text=y.e.String(t.Tables[0][0].ccAlpha2),this.GetScreenControl("BankRoutingCode").Text=y.e.String(t.Tables[0][0].ccAlpha8),this.GetScreenControl("BankAgentCode").Text=y.e.String(t.Tables[0][0].ccAlpha7))}}},{key:"dgvAppraisal_CellDoubleClick",value:function(e,t,i){if(this.ButtonAppraisal.Visible&&this.ButtonAppraisal.Enable){var a=e.grid.getData().getItems()[e.row];y.e.IsEmpty(a.SeqNo)||(this.AddeditAppraisalViewmodel=new L.a(this,this.NodeID,this.dtpNextAppraisal.Date,parseInt(a.SeqNo)),b.a.page.ShowDialog(this.AddeditAppraisalViewmodel,O.a,{ShowCenter:!0,Title:this.AddeditAppraisalViewmodel.Title}))}}},{key:"LoadPayrollGrid",value:function(){if(this.dgvPayrollEar.Clear(),this.dgvPayrollAccrual.Clear(),this.dgvPayrollDed.Clear(),this.iAccruCnt=this.iEarCnt=0,null!=this.dsPayStructure&&null!=this.dsPayStructure&&this.dsPayStructure.Tables.length>0){var e,t=this.dsPayStructure.Tables[0].length>0?this.dsPayStructure.Tables[0]:this.dsPayStructure.Tables[1],i=t;t=t.filter((function(e){return 1==e.Type&&"Yes"==e.Applicable&&"OverTime"!=e.FieldType}));for(var a=0;a<t.length;a++)y.e.IsEmpty(t[a].Behaviour)||"Accruals"!=t[a].Behaviour.toString()&&"Accruals-AccumulateForPreviousYears"!=t[a].Behaviour.toString()?(this.iEarCnt++,(e=this.dgvPayrollEar.NewRow()).SlNo=this.iEarCnt.toString(),e.IsAccrualType=!1):(this.iAccruCnt++,(e=this.dgvPayrollAccrual.NewRow()).SlNo=this.iAccruCnt.toString(),e.IsAccrualType=!0),e.Earnings=1==b.a.SessionManager.LanguageID?t[a].ComponentName.toString():y.e.String(t[a].ResourceData),e.EarComponentID=t[a].ComponentID.toString(),e.EarSNo=t[a].SNo.toString(),e.EarFormula=t[a].Formula.toString(),e.EarRoff=t[a].ROff.toString(),e.EarValue=(0).ToString(this.sDecimalsAmount),e.EarAddToNet=t[a].AddToNet.toString(),e.EarFType=t[a].FieldType.toString(),"EmployeeMaster"!=e.EarFType.toString()?(e.Earnings_GRAY="1",e.EarValue_GRAY="1"):(e.Earnings_GRAY=null,e.EarValue_GRAY=null),e.IsVisible=null,Object(c.j)(e.IsAccrualType)?this.dgvPayrollAccrual.addRow(e):this.dgvPayrollEar.addRow(e);t=(t=i).filter((function(e){return 2==e.Type&&"Yes"==e.Applicable&&"NetSalary"!=e.FieldType&&"OverTime"!=e.FieldType}));for(var s=0;s<t.length;s++)(e=this.dgvPayrollDed.NewRow()).SlNo=(s+1).toString(),e.Deductions=1==b.a.SessionManager.LanguageID?t[s].ComponentName.toString():y.e.String(t[s].ResourceData),e.DedComponentID=t[s].ComponentID.toString(),e.DedSNo=t[s].SNo.toString(),e.DedFormula=t[s].Formula.toString(),e.DedROff=t[s].ROff.toString(),e.DedValue=(0).ToString(this.sDecimalsAmount),e.DedAddToNet=t[s].AddToNet.toString(),e.DedFType=t[s].FieldType.toString(),"EmployeeMaster"!=e.DedFType.toString()?(e.Deductions_GRAY="1",e.DedValue_GRAY="1"):(e.Deductions_GRAY=null,e.DedValue_GRAY=null),e.IsVisible=null,this.dgvPayrollDed.addRow(e)}this.dgvPayrollEar.AddExtraEmptyRows(20),this.dgvPayrollAccrual.AddExtraEmptyRows(20),this.dgvPayrollDed.AddExtraEmptyRows(20)}},{key:"LoadAppraisalGrid",value:function(){this.dgvAppraisal.Clear();for(var e=this.dgvAppraisal.Columns.length-4;e>=4;e--)if(this.dgvAppraisal.Columns[e].DisplayMember.startsWith("Earning")||this.dgvAppraisal.Columns[e].DisplayMember.startsWith("Deduction")){var t=this.dgvAppraisal.Table.indexOf(this.dgvAppraisal.Columns[e].DisplayMember);this.dgvAppraisal.Table.splice(t,1),this.dgvAppraisal.Columns.Remove(this.dgvAppraisal.Columns[e])}if(null!=this.dsPayStructure&&null!=this.dsPayStructure&&this.dsPayStructure.Tables.length>0){var i,a=this.dsPayStructure.Tables[0].length>0?this.dsPayStructure.Tables[0]:this.dsPayStructure.Tables[1],s=a;a=a.filter((function(e){return 1==e.Type&&"Yes"==e.Applicable&&("Net"==e.AddToNet||"NetAndTax"==e.AddToNet)&&"OverTime"!=e.FieldType}));for(var n=3,l=0;l<a.length;l++)(y.e.IsEmpty(a[l].Behaviour)||"Accruals"!=a[l].Behaviour.toString()&&"Accruals-AccumulateForPreviousYears"!=a[l].Behaviour.toString())&&(n++,(i=new D.a).Header=1==b.a.SessionManager.LanguageID?a[l].ComponentName.toString():y.e.String(a[l].ResourceData),i.DisplayMember="Earning"+a[l].SNo.toString(),i.ID=a[l].ComponentID.toString(),i.Width=90,i.DataType="FLOAT",i.ReadOnly=!0,i.HeaderBackColor="LightBlue",this.dgvAppraisal.Columns.splice(n,0,i),this.dgvAppraisal.TableColumns.push("Earning"+a[l].SNo.toString()));a=(a=s).filter((function(e){return 2==e.Type&&"Yes"==e.Applicable&&("Net"==e.AddToNet||"NetAndTax"==e.AddToNet)&&"NetSalary"!=e.FieldType&&"OverTime"!=e.FieldType}));for(var o=0;o<a.length;o++)n++,(i=new D.a).Header=1==b.a.SessionManager.LanguageID?a[o].ComponentName.toString():y.e.String(a[o].ResourceData),i.DisplayMember="Deduction"+a[o].SNo.toString(),i.ID=a[o].ComponentID.toString(),i.Width=90,i.DataType="FLOAT",i.ReadOnly=!0,i.HeaderBackColor="LightCoral",this.dgvAppraisal.Columns.splice(n,0,i),this.dgvAppraisal.TableColumns.push("Deduction"+a[o].SNo.toString())}this.dgvAppraisal.Table.Clear();var r=this.objEmp.GetQueryData(this.NodeID,"dgvAppraisal","","","");if(null!=r&&r.length>0)for(var d={},c=0;c<r.length;c++){(d={}).SeqNo=r[c].SeqNo.toString(),d.SlNo=(c+1).toString(),d.AppraisalDate=new Date(r[c].AppraisalDate),d.Basic=parseFloat(r[c].BasicMonthly).ToString(this.sDecimalsAmount),d.NetSalary=parseFloat(r[c].NetSalary).ToString(this.sDecimalsAmount),d.Remarks=y.e.StringIsNullOrEmpty(r[c].Remarks)?"":r[c].Remarks.toString(),d.Reason=y.e.StringIsNullOrEmpty(r[c].Reason)?"":r[c].Reason.toString(),d.AppraisalType=y.e.StringIsNullOrEmpty(r[c].sAppraisalType)?"":r[c].sAppraisalType.toString();for(var h=4;h<this.dgvAppraisal.Columns.length;h++)(this.dgvAppraisal.Columns[h].DisplayMember.startsWith("Earning")||this.dgvAppraisal.Columns[h].DisplayMember.startsWith("Deduction"))&&(d[this.dgvAppraisal.Columns[h].DisplayMember]=parseFloat(r[c][this.dgvAppraisal.Columns[h].DisplayMember]).ToString(this.sDecimalsAmount));this.dgvAppraisal.Table.push(d)}this.dgvAppraisal.AddExtraEmptyRows(20)}},{key:"RoundOffValue",value:function(e,t){if(t>0&&e>0){var i,a=!1;(i=e%t)>0&&(t/i<=2&&(a=!0),e-=i,a&&(e+=t))}return e.ToString(this.sDecimalsAmount).Replace(",","")}},{key:"GetUnpaidDays",value:function(){try{var e,t,i,a=new Date,s=new Date,n=0,l=(this.objEmp.DOJ.getDay(),new Date);if(e=b.a.SessionManager.PayrollMonth,t=b.a.SessionManager.PayrollMonthStart,i=b.a.SessionManager.PayrollMonthEnd,l=null==this.DateOfRelieve.Date||""==this.DateOfRelieve.Date.toString()?new Date("01-Jan-9000"):new Date(this.DateOfRelieve.Date),e.DaysInMonth(),this.objEmp.DOJ>t)if("Actual Days"!=b.a.SessionManager.Preferences.PayDays){var o=parseInt(b.a.SessionManager.Preferences.PayDays);for(a=t,s=this.objEmp.DOJ;a<s;)a.getDate()!=a.DaysInMonth()?(a.getDate()>o||n++,a=a.AddDays(1)):(n+=o-a.getDate()+1,a=a.AddDays(1));if(l<i)for(a=l,s=i;a<s;)a.getDate()!=a.DaysInMonth()?(a.getDate()>o||n++,a=a.AddDays(1)):(n+=o-a.getDate()+1,a=a.AddDays(1))}else n+=y.e.GetDateDifference(this.objEmp.DOJ,t),l<i&&(n+=y.e.GetDateDifference(i,l));else if(l<i)if("Actual Days"!=b.a.SessionManager.Preferences.PayDays){var r=parseInt(b.a.SessionManager.Preferences.PayDays);for(a=l,s=i;a<s;)a.getDate()!=a.DaysInMonth()?(a.getDate()>r||n++,a=a.AddDays(1)):(n+=r-a.getDate()+1,a=a.AddDays(1))}else n+=y.e.GetDateDifference(i,l);return n}catch(d){return 0}}},{key:"ExecuteFormulas",value:function(){var e,t=this,i=this.objEmp.GetQueryData(this.NodeID,"GetDtForEmp","","","");e="Actual Days"==b.a.SessionManager.Preferences.EmpMasterPayDays?y.e.GetDateDifference(b.a.SessionManager.PayrollMonthEnd,b.a.SessionManager.PayrollMonthStart)+1:parseInt(b.a.SessionManager.Preferences.EmpMasterPayDays);var a,s=0,n=0,l=(0).ToString(this.sDecimalsAmount);this.fldDict=new S.a,a=new C.c("Basic",""),this.fldDict.push("Basic",a),this.fldDict.Basic.setFieldValue(this.txtBasicMonthly.Text),a=new C.c("ServiceDays",""),this.fldDict.push("ServiceDays",a),this.fldDict.ServiceDays.setFieldValue(y.e.GetDateDifference(new Date,this.objEmp.DOJ)+1),a=new C.c("WeeklyOffs",""),this.fldDict.push("WeeklyOffs",a),this.fldDict.WeeklyOffs.setFieldValue(0),a=new C.c("LeavesTaken",""),this.fldDict.push("LeavesTaken",a),this.fldDict.LeavesTaken.setFieldValue(0),a=new C.c("VacDaysTaken",""),this.fldDict.push("VacDaysTaken",a),this.fldDict.VacDaysTaken.setFieldValue(0),a=new C.c("VacDays",""),this.fldDict.push("VacDays",a),this.fldDict.VacDays.setFieldValue(0),a=new C.c("VacAmount",""),this.fldDict.push("VacAmount",a),this.fldDict.VacAmount.setFieldValue(0),a=new C.c("VacEncashDays",""),this.fldDict.push("VacEncashDays",a),this.fldDict.VacEncashDays.setFieldValue(0),a=new C.c("VacEncashAmount",""),this.fldDict.push("VacEncashAmount",a),this.fldDict.VacEncashAmount.setFieldValue(0),a=new C.c("VacExcessDays",""),this.fldDict.push("VacExcessDays",a),this.fldDict.VacExcessDays.setFieldValue(0),a=new C.c("VacExcessAmount",""),this.fldDict.push("VacExcessAmount",a),this.fldDict.VacExcessAmount.setFieldValue(0),a=new C.c("VacNetAmount",""),this.fldDict.push("VacNetAmount",a),this.fldDict.VacNetAmount.setFieldValue(0),a=new C.c("TotalDays",""),this.fldDict.push("TotalDays",a),this.fldDict.TotalDays.setFieldValue(e),a=new C.c("DaysAttended",""),this.fldDict.push("DaysAttended",a),this.fldDict.DaysAttended.setFieldValue(e),a=new C.c("UnpaidDays",""),this.fldDict.push("UnpaidDays",a),this.fldDict.UnpaidDays.setFieldValue(this.GetUnpaidDays()),a=new C.c("LOPDays",""),this.fldDict.push("LOPDays",a),this.fldDict.LOPDays.setFieldValue(0),a=new C.c("Holidays",""),this.fldDict.push("Holidays",a),this.fldDict.Holidays.setFieldValue(0),a=new C.c("AdjDays",""),this.fldDict.push("AdjDays",a),this.fldDict.AdjDays.setFieldValue(0),a=new C.c("EmpType",""),this.fldDict.push("EmpType",a),null!=this.EmpType.GetselectedItem()?this.fldDict.EmpType.setFieldValue(this.EmpType.GetselectedItem().Name):this.fldDict.EmpType.setFieldValue(""),a=new C.c("Gender",""),this.fldDict.push("Gender",a),null!=this.Gender.GetselectedItem()?this.fldDict.Gender.setFieldValue(this.Gender.GetselectedItem().Name):this.fldDict.Gender.setFieldValue(""),a=new C.c("MaritalStatus",""),this.fldDict.push("MaritalStatus",a),null!=this.pcbMaritalStatus.GetselectedItem()?this.fldDict.MaritalStatus.setFieldValue(this.pcbMaritalStatus.GetselectedItem().Name):this.fldDict.MaritalStatus.setFieldValue(""),a=new C.c("Nationality",""),this.fldDict.push("Nationality",a),null!=this.pcbNationality.GetselectedItem()?this.fldDict.Nationality.setFieldValue(this.pcbNationality.GetselectedItem().Name):this.fldDict.Nationality.setFieldValue(""),a=new C.c("Religion",""),this.fldDict.push("Religion",a),null!=this.pcbReligion.GetselectedItem()?this.fldDict.Religion.setFieldValue(this.pcbReligion.GetselectedItem().Name):this.fldDict.Religion.setFieldValue(""),a=new C.c("ChildrenCount",""),this.fldDict.push("ChildrenCount",a);var r=this.ViewEmpDocuments.GridListObj.Table;null!=(r=r.filter((function(e){return 255==e.DType})))&&null!=r?(r=r.filter((function(e){return e.EmpSeqNo==t.objEmp.NodeID&&"Children"==e.Field5})),this.fldDict.ChildrenCount.setFieldValue(r.length)):this.fldDict.ChildrenCount.setFieldValue(0),a=new C.c("ChildrenDays",""),this.fldDict.push("ChildrenDays",a);var d=0;if(null!=(r=this.ViewEmpDocuments.GridListObj.Table)&&null!=r&&(r=r.filter((function(e){return e.EmpSeqNo==t.objEmp.NodeID&&"Children"==e.Field5}))),r.length>0)for(var c=r,h=0;h<c.length;h++)if(new Date(c[h].Field2)>=b.a.SessionManager.PayrollMonthStart&&new Date(c[h].Field2)<=b.a.SessionManager.PayrollMonthEnd)d+=y.e.GetDateDifference(b.a.SessionManager.PayrollMonthEnd,new Date(c[h].Field2))+1;else{var u=0,m=0,p=0,g={iY:u,iM:m,iD:p};y.e.GetYearsMonthsDays(new Date(c[h].Field2),b.a.SessionManager.PayrollMonthEnd,g),m=g.iM,p=g.iD,18==(u=g.iY)&&0==m?d+=b.a.SessionManager.PayrollMonthEnd.Subtract(b.a.SessionManager.PayrollMonthStart).Days+1-p:u<18&&(d+=b.a.SessionManager.PayrollMonthEnd.Subtract(b.a.SessionManager.PayrollMonthStart).Days+1)}this.fldDict.ChildrenDays.setFieldValue(d),a=new C.c("PayrollMonthNo",""),this.fldDict.push("PayrollMonthNo",a),this.fldDict.PayrollMonthNo.setFieldValue(b.a.SessionManager.PayrollMonth.iMonth()),a=new C.c("PayrollYearNo",""),this.fldDict.push("PayrollYearNo",a),this.fldDict.PayrollYearNo.setFieldValue(b.a.SessionManager.PayrollMonth.getFullYear()),a=new C.c("DOJMonth",""),this.fldDict.push("DOJMonth",a),this.fldDict.DOJMonth.setFieldValue(this.objEmp.DOJ.iMonth()),a=new C.c("DOJYear",""),this.fldDict.push("DOJYear",a),this.fldDict.DOJYear.setFieldValue(this.objEmp.DOJ.getFullYear()),a=new C.c("DORMonth",""),this.fldDict.push("DORMonth",a),null!=i&&i.length>0&&!y.e.IsEmpty(i[0].CDORelieve)?this.fldDict.DORMonth.setFieldValue(new Date(i[0].CDORelieve).iMonth()):this.fldDict.DORMonth.setFieldValue(1),a=new C.c("DORYear",""),this.fldDict.push("DORYear",a),null!=i&&i.length>0&&!y.e.IsEmpty(i[0].CDORelieve)?this.fldDict.DORYear.setFieldValue(new Date(i[0].CDORelieve).getFullYear()):this.fldDict.DORYear.setFieldValue(2200),a=new C.c("EmpConfirmationDate",""),this.fldDict.push("EmpConfirmationDate",a),this.fldDict.EmpConfirmationDate.setFieldValue(new Date(this.DateOfConfirmation.Date)),a=new C.c("LeaveFromDate",""),this.fldDict.push("LeaveFromDate",a),this.fldDict.LeaveFromDate.setFieldValue(new Date),a=new C.c("LeaveNoOfDays",""),this.fldDict.push("LeaveNoOfDays",a),this.fldDict.LeaveNoOfDays.setFieldValue(0),a=new C.c("EmpVacationDays",""),this.fldDict.Add("EmpVacationDays",a),this.fldDict.EmpVacationDays.setFieldValue(0),a=new C.c("AppraisalMonthNo",""),this.fldDict.push("AppraisalMonthNo",a);var D=null;null!=this.dsEdit&&(D=this.dsEdit.Tables[14]),null!=D&&D.length>1?(D.sort((function(e,t){return t.EffectFrom-e.EffectFrom})),this.fldDict.AppraisalMonthNo.setFieldValue(new Date(D[0].ApraisalDate).iMonth())):this.fldDict.AppraisalMonthNo.setFieldValue(0),a=new C.c("VacDaysPayYes",""),this.fldDict.push("VacDaysPayYes",a),this.fldDict.VacDaysPayYes.setFieldValue(0),a=new C.c("VacDaysPayNo",""),this.fldDict.push("VacDaysPayNo",a),this.fldDict.VacDaysPayNo.setFieldValue(0),null!=this.dsEdit&&(D=this.dsEdit.Tables[14]);var f=null,I=0;if(null!=this.dsPayStructure&&(f=this.dsPayStructure.Tables[1]),null!=D&&D.length>0&&(null!=(D=D.filter((function(e){return e.ApraisalDate<=b.a.SessionManager.PayrollMonthEnd.ToString("dd MMM yyyy")})))&&D.length>1&&(D.sort((function(e,t){return t.ApraisalDate-e.ApraisalDate})),null!=f&&f.length>0&&(null!=(f=f.filter((function(e){return 1==e.Type&&"Yes"==e.Applicable})))&&f.length>0))))for(var T=0;T<f.length;T++)y.e.IsEmpty(b.a.SessionManager.Preferences.GosiComponent)||b.a.SessionManager.Preferences.GosiComponent!=f[T].ComponentID.toString()||(I=parseFloat(D[1]["Earning"+parseInt(f[T].SNo)]));a=new C.c("PreviousGosiValue",""),this.fldDict.push("PreviousGosiValue",a),this.fldDict.PreviousGosiValue.setFieldValue(I),a=new C.c("TotCheckInLateMins",""),this.fldDict.push("TotCheckInLateMins",a),this.fldDict.TotCheckInLateMins.setFieldValue(0),a=new C.c("TotCheckOutEarlyMins",""),this.fldDict.push("TotCheckOutEarlyMins",a),this.fldDict.TotCheckOutEarlyMins.setFieldValue(0),a=new C.c("TotBreak1MoreMins",""),this.fldDict.push("TotBreak1MoreMins",a),this.fldDict.TotBreak1MoreMins.setFieldValue(0),a=new C.c("TotBreak2MoreMins",""),this.fldDict.push("TotBreak2MoreMins",a),this.fldDict.TotBreak2MoreMins.setFieldValue(0),a=new C.c("TotBreak3MoreMins",""),this.fldDict.push("TotBreak3MoreMins",a),this.fldDict.TotBreak3MoreMins.setFieldValue(0),a=new C.c("TotBreak4MoreMins",""),this.fldDict.push("TotBreak4MoreMins",a),this.fldDict.TotBreak4MoreMins.setFieldValue(0),a=new C.c("TotBreak5MoreMins",""),this.fldDict.push("TotBreak5MoreMins",a),this.fldDict.TotBreak5MoreMins.setFieldValue(0),a=new C.c("TotLateHrsToDeduct",""),this.fldDict.push("TotLateHrsToDeduct",a),this.fldDict.TotLateHrsToDeduct.setFieldValue(0),a=new C.c("TotLateLeavesToDeduct",""),this.fldDict.push("TotLateLeavesToDeduct",a),this.fldDict.TotLateLeavesToDeduct.setFieldValue(0),a=new C.c("TotWorkingMinsLessBy",""),this.fldDict.push("TotWorkingMinsLessBy",a),this.fldDict.TotWorkingMinsLessBy.setFieldValue(0),a=new C.c("TotAbsentMinsLessBy",""),this.fldDict.push("TotAbsentMinsLessBy",a),this.fldDict.TotAbsentMinsLessBy.setFieldValue(0),this.dvCCData=this.dvCCData.filter((function(e){return e.EmpSeqNo==t.objEmp.NodeID}));var A="",E="";if(a=new C.c("RptManagerCode",""),this.fldDict.push("RptManagerCode",a),a=new C.c("RptManagerName",""),this.fldDict.push("RptManagerName",a),this.dvCCData.length>0&&!y.e.IsEmpty(this.dvCCData[0].RptManager)){var P=this.dvDimsData.filter((function(e){return"RptManager"==e.SysColName&&e.NodeID==t.dvCCData[0].RptManager.toString()}));P.length>0&&(A=P[0].Code.toString(),E=P[0].Name.toString())}if(this.fldDict.RptManagerCode.setFieldValue(A),this.fldDict.RptManagerName.setFieldValue(E),this.dvCCData.length>0)for(var v=function(e){var i=Object.keys(t.dvCCData[0])[e];if(!i.Contains("CCNID"))return"continue";var s=t.dvDimsData.filter((function(e){return e.SysColName==i}));if(s.length>0){var n=s[0].UserColumnName.toString();a=new C.c(s[0].UserColumnName.toString()+"Code",""),t.fldDict.push(s[0].UserColumnName.toString()+"Code",a),a=new C.c(s[0].UserColumnName.toString()+"Name",""),t.fldDict.push(s[0].UserColumnName.toString()+"Name",a),(s=t.dvDimsData.filter((function(e){return e.SysColName==i&&e.NodeID==t.dvCCData[0][i].toString()}))).length>0?(t.fldDict[s[0].UserColumnName.toString()+"Code"].setFieldValue(s[0].Code.toString()),t.fldDict[s[0].UserColumnName.toString()+"Name"].setFieldValue(s[0].Name.toString())):(t.fldDict[n+"Code"].setFieldValue(""),t.fldDict[n+"Name"].setFieldValue(""));var l=t.ScreenObject.GetCustomField(i);if(null!=l){var r="";(l instanceof o.b||l instanceof o.a)&&(r=l.SelectedValue.toString()),"0"==r&&(r="1"),(s=t.dvDimsData.filter((function(e){return e.SysColName==i&&e.NodeID==r}))).length>0?(t.fldDict[s[0].UserColumnName.toString()+"Code"].setFieldValue(s[0].Code.toString()),t.fldDict[s[0].UserColumnName.toString()+"Name"].setFieldValue(s[0].Name.toString())):(t.fldDict[n+"Code"].setFieldValue(""),t.fldDict[n+"Name"].setFieldValue(""))}}},M=0;M<Object.keys(this.dvCCData[0]).length;M++)v(M);for(var V=0;V<this.dgvPayrollEar.Table.length;V++)y.e.StringIsNullOrEmpty(this.dgvPayrollEar.Table[V].EarSNo)||(a=new C.c(this.dgvPayrollEar.Table[V].Earnings.toString(),""),this.fldDict.push(this.dgvPayrollEar.Table[V].Earnings.toString(),a),this.fldDict[this.dgvPayrollEar.Table[V].Earnings.toString()].setFieldValue(this.dgvPayrollEar.Table[V].EarValue.toString()),a=new C.c("Calc"+this.dgvPayrollEar.Table[V].Earnings.toString(),""),this.fldDict.push("Calc"+this.dgvPayrollEar.Table[V].Earnings.toString(),a),this.fldDict["Calc"+this.dgvPayrollEar.Table[V].Earnings.toString()].setFieldValue(this.dgvPayrollEar.Table[V].EarValue.toString()),a=new C.c("Arr_"+this.dgvPayrollEar.Table[V].Earnings.toString(),""),this.fldDict.push("Arr_"+this.dgvPayrollEar.Table[V].Earnings.toString(),a),this.fldDict["Arr_"+this.dgvPayrollEar.Table[V].Earnings.toString()].setFieldValue(0),a=new C.c("Adj_"+this.dgvPayrollEar.Table[V].Earnings.toString(),""),this.fldDict.push("Adj_"+this.dgvPayrollEar.Table[V].Earnings.toString(),a),this.fldDict["Adj_"+this.dgvPayrollEar.Table[V].Earnings.toString()].setFieldValue(0));for(var N=0;N<this.dgvPayrollAccrual.Table.length;N++)y.e.StringIsNullOrEmpty(this.dgvPayrollAccrual.Table[N].EarSNo)||(a=new C.c(this.dgvPayrollAccrual.Table[N].Earnings.toString(),""),this.fldDict.push(this.dgvPayrollAccrual.Table[N].Earnings.toString(),a),this.fldDict[this.dgvPayrollAccrual.Table[N].Earnings.toString()].setFieldValue(this.dgvPayrollAccrual.Table[N].EarValue.toString()),a=new C.c("Calc"+this.dgvPayrollAccrual.Table[N].Earnings.toString(),""),this.fldDict.push("Calc"+this.dgvPayrollAccrual.Table[N].Earnings.toString(),a),this.fldDict["Calc"+this.dgvPayrollAccrual.Table[N].Earnings.toString()].setFieldValue(this.dgvPayrollAccrual.Table[N].EarValue.toString()),a=new C.c("Arr_"+this.dgvPayrollAccrual.Table[N].Earnings.toString(),""),this.fldDict.push("Arr_"+this.dgvPayrollAccrual.Table[N].Earnings.toString(),a),this.fldDict["Arr_"+this.dgvPayrollAccrual.Table[N].Earnings.toString()].setFieldValue(0),a=new C.c("Adj_"+this.dgvPayrollAccrual.Table[N].Earnings.toString(),""),this.fldDict.push("Adj_"+this.dgvPayrollAccrual.Table[N].Earnings.toString(),a),this.fldDict["Adj_"+this.dgvPayrollAccrual.Table[N].Earnings.toString()].setFieldValue(0));for(var w=0;w<this.dgvPayrollDed.Table.length;w++)y.e.StringIsNullOrEmpty(this.dgvPayrollDed.Table[w].DedSNo)||(a=new C.c(this.dgvPayrollDed.Table[w].Deductions.toString(),""),this.fldDict.Add(this.dgvPayrollDed.Table[w].Deductions.toString(),a),this.fldDict[this.dgvPayrollDed.Table[w].Deductions.toString()].setFieldValue(this.dgvPayrollDed.Table[w].DedValue.toString()),a=new C.c("Calc"+this.dgvPayrollDed.Table[w].Deductions.toString(),""),this.fldDict.push("Calc"+this.dgvPayrollDed.Table[w].Deductions.toString(),a),this.fldDict["Calc"+this.dgvPayrollDed.Table[w].Deductions.toString()].setFieldValue(this.dgvPayrollDed.Table[w].DedValue.toString()),a=new C.c("Arr_"+this.dgvPayrollDed.Table[w].Deductions.toString(),""),this.fldDict.push("Arr_"+this.dgvPayrollDed.Table[w].Deductions.toString(),a),this.fldDict["Arr_"+this.dgvPayrollDed.Table[w].Deductions.toString()].setFieldValue(0),a=new C.c("Adj_"+this.dgvPayrollDed.Table[w].Deductions.toString(),""),this.fldDict.push("Adj_"+this.dgvPayrollDed.Table[w].Deductions.toString(),a),this.fldDict["Adj_"+this.dgvPayrollDed.Table[w].Deductions.toString()].setFieldValue(0));for(var F=this.fldDict,L=0;L<this.dgvPayrollEar.Table.length;L++)if(!y.e.StringIsNullOrEmpty(this.dgvPayrollEar.Table[L].EarSNo)){if(!y.e.StringIsNullOrEmpty(this.dgvPayrollEar.Table[L].EarFormula))try{l=parseFloat(b.a.eval.EvaluateExpression(this.dgvPayrollEar.Table[L].EarFormula.toString(),F)).ToString(this.sDecimalsAmount),this.dgvPayrollEar.Table[L].EarValue=this.RoundOffValue(parseFloat(l),parseFloat(this.dgvPayrollEar.Table[L].EarRoff)),this.fldDict[this.dgvPayrollEar.Table[L].Earnings.toString()].setFieldValue(this.dgvPayrollEar.Table[L].EarValue.toString()),this.fldDict["Calc"+this.dgvPayrollEar.Table[L].Earnings.toString()].setFieldValue(this.dgvPayrollEar.Table[L].EarValue.toString())}catch(k){}y.e.StringIsNullOrEmpty(this.dgvPayrollEar.Table[L].EarAddToNet)||"Net"!=this.dgvPayrollEar.Table[L].EarAddToNet.toString()&&"NetAndTax"!=this.dgvPayrollEar.Table[L].EarAddToNet.toString()||(s+=parseFloat(this.dgvPayrollEar.Table[L].EarValue))}for(var O=0;O<this.dgvPayrollAccrual.Table.length;O++)if(!y.e.StringIsNullOrEmpty(this.dgvPayrollAccrual.Table[O].EarSNo)){if(!y.e.StringIsNullOrEmpty(this.dgvPayrollAccrual.Table[O].EarFormula))try{l=parseFloat(b.a.eval.EvaluateExpression(this.dgvPayrollAccrual.Table[O].EarFormula.toString(),F)).ToString(this.sDecimalsAmount),this.dgvPayrollAccrual.Table[O].EarValue=this.RoundOffValue(parseFloat(l),parseFloat(this.dgvPayrollAccrual.Table[O].EarROff)),this.fldDict[this.dgvPayrollAccrual.Table[O].Earnings.toString()].setFieldValue(this.dgvPayrollAccrual.Table[O].EarValue.toString()),this.fldDict["Calc"+this.dgvPayrollAccrual.Table[O].Earnings.toString()].setFieldValue(this.dgvPayrollAccrual.Table[O].EarValue.toString())}catch(G){}parseFloat(this.dgvPayrollAccrual.Table[O].EarValue)}for(var B=0;B<this.dgvPayrollDed.Table.length;B++)if(!y.e.StringIsNullOrEmpty(this.dgvPayrollDed.Table[B].DedSNo)){if(!y.e.StringIsNullOrEmpty(this.dgvPayrollDed.Table[B].DedFormula))try{l=b.a.eval.EvaluateExpression(this.dgvPayrollDed.Table[B].DedFormula.toString(),F).toString(),l=parseFloat(l).ToString(this.sDecimalsAmount),"ESI"==this.dgvPayrollDed.Table[B].Deductions.toString().toUpperCase()?l=b.a.SessionManager.Round(Math.ceil(parseFloat(l)),this.sDecimalsAmount):"PT"==this.dgvPayrollDed.Table[B].Deductions.toString().toUpperCase()&&function(){var e=l.Replace(",","");l=(0).ToString(t.sDecimalsAmount);var i=t.dsPayStructure.Tables[0].length>0?t.dsPayStructure.Tables[0]:t.dsPayStructure.Tables[1];if(i.length>0){var a=new Date(i[0].PayrollMonth),s=new Date,n=new Date,o=new Date,r={PayrollMonth:s,PayrollMonthStart:n,PayrollMonthEnd:o};y.e.SetPayrollDate(a,r),s=r.PayrollMonth,n=r.PayrollMonthStart,o=r.PayrollMonthEnd;var d=t.objEmp.GetQueryData(t.NodeID,"SetEmpAsOnStatus",s,n,o);if(null!=d&&d.Tables.length>0){var c="1";d.Tables[0].length>0?c=d.Tables[0][0].PTDimension.toString():d.Tables[1].length>0&&(c=d.Tables[1][0].PTDimension.toString());var h=d.Tables[2];if(d.Tables[0].length>0||d.Tables[1].length>0){var u=d.Tables[2];if(null!=(u=u.filter((function(e){return e.NodeID==c&&""!=e.Formula})))&&u.length>0&&!y.e.IsEmpty(u[0].Formula)){var m=t.fldDict;l=parseFloat(b.a.eval.EvaluateExpression(u[0].Formula.toString(),m)).toString()}else(h=h.filter((function(t){return t.NodeID==c&&t.FromSlab<=e&&t.ToSlab>=e}))).length>0&&(l=y.e.String(h[0].Amount))}}}}(),this.dgvPayrollDed.Table[B].DedValue=this.RoundOffValue(parseFloat(l),parseFloat(this.dgvPayrollDed.Table[B].DedROff)),this.fldDict[this.dgvPayrollDed.Table[B].Deductions.toString()].setFieldValue(this.dgvPayrollDed.Table[B].DedValue.toString()),this.fldDict["Calc"+this.dgvPayrollDed.Table[B].Deductions.toString()].setFieldValue(this.dgvPayrollDed.Table[B].DedValue.toString())}catch(x){}y.e.StringIsNullOrEmpty(this.dgvPayrollDed.Table[B].DedAddToNet)||"Net"!=this.dgvPayrollDed.Table[B].DedAddToNet.toString()&&"NetAndTax"!=this.dgvPayrollDed.Table[B].DedAddToNet.toString()||(n+=parseFloat(this.dgvPayrollDed.Table[B].DedValue))}this.dgvPayrollEar.Columns[2].footer=s.ToString(this.sDecimalsAmount),this.dgvPayrollDed.Columns[2].footer=n.ToString(this.sDecimalsAmount),this.dgvPayrollEar.RefreshGridView(),this.dgvPayrollEar.UpdateFooter(),this.dgvPayrollEar.refreshDataView(),this.dgvPayrollAccrual.RefreshGridView(),this.dgvPayrollAccrual.refreshDataView(),this.dgvPayrollDed.RefreshGridView(),this.dgvPayrollDed.UpdateFooter(),this.dgvPayrollDed.refreshDataView(),this.ptxtNetSalary.Text=(s-n).ToString(this.sDecimalsAmount),this.webtotEarnings=s,this.webtotDeductions=n}},{key:"txtBasicMonthly_LostFocus",value:function(e){try{var t=parseFloat(this.txtBasicMonthly.Text.trim());this.txtBasicMonthly.Text=t.ToString(this.sDecimalsAmount)}catch(i){this.txtBasicMonthly.Text=(0).ToString(this.sDecimalsAmount)}this.ExecuteFormulas()}},{key:"ProbationDays_LostFocus",value:function(e){try{""!=this.ProbationDays.Text.trim()&&parseInt(this.ProbationDays.Text)>0&&(this.DateOfConfirmation.Date=this.DateOfJoining.Date.AddDays(parseInt(this.ProbationDays.Text)))}catch(t){return this.DisplayMessage="Enter Valid data",this.ProbationDays.SetFocus=!0,void(this.MessageVisibility=!0)}}},{key:"dgvPayrollAccrual_BeginEdit",value:function(e,t,i){return"EarValue"!=e.args.column.field||y.e.StringIsNullOrEmpty(e.args.item.EarValue_GRAY)||"1"!=e.args.item.EarValue_GRAY.toString()?(e.args.Cancel=!1,!1):(e.args.Cancel=!0,!0)}},{key:"dgvPayrollAccrual_EndEdit",value:function(e,t,i){"EarValue"==(t=e.column.field)&&(""==y.e.String(e.item[t]).Trim()&&(e.item[t]=(0).ToString(this.sDecimalsAmount),this.dgvPayrollAccrual.updateRow(e.item)),this.ExecuteFormulas())}},{key:"dgvPayrollEar_BeginEdit",value:function(e,t,i){return"EarValue"!=e.args.column.field||y.e.StringIsNullOrEmpty(e.args.item.EarValue_GRAY)||"1"!=e.args.item.EarValue_GRAY.toString()?(e.args.Cancel=!1,!1):(e.args.Cancel=!0,!0)}},{key:"dgvPayrollDed_BeginEdit",value:function(e,t,i){return"DedValue"==t&&"1"==e.DedValue_GRAY.toString()?(e.args.Cancel=!0,!0):(e.args.Cancel=!1,!1)}},{key:"GetDtGrSalSalbs",value:function(){var e="",t=this.ScreenObject.GetCustomField("CCNID53");null!=t&&null!=t&&("0"==(e=t.SelectedValue.toString())&&(e="1")),this.dtGrSalSalbs=this.objEmp.GetQueryData(this.NodeID,"GetDtGrSalSalbs",e,"","")}},{key:"dgvPayrollEar_EndEdit",value:function(e,t,i){var a={};if(a=e.item,"EarValue"==(t=e.column.field)){if(""==a[t].toString().trim()&&(a[t]=(0).ToString(this.sDecimalsAmount)),b.a.SessionManager.Preferences.ContainsKey("ConsiderGradeWiseSalarySlabs")&&"True"==b.a.SessionManager.Preferences.ConsiderGradeWiseSalarySlabs&&(null!=this.dtGrSalSalbs&&null!=this.dtGrSalSalbs||this.GetDtGrSalSalbs(),null!=this.dtGrSalSalbs&&null!=this.dtGrSalSalbs&&this.dtGrSalSalbs.length>0)){var s=null;if(null!=(s=this.dtGrSalSalbs.filter("EarValue"==t?function(e){return e.ComponentID==a.EarComponentID.toString()}:function(e){return e.ComponentID==a.DedComponentID.toString()}))&&null!=s&&s.length>0&&this.ValidateGradeWiseSalarySlabsApplicableFormula(s[0])){var n,l,o;n=y.e.DoubleTryParse(a[t].toString()),l=y.e.DoubleTryParse(s[0].MinAmount.toString()),o=y.e.DoubleTryParse(s[0].MaxAmount.toString()),n>=l&&n<=o||("Stop"==s[0].AlertType.toString()?(alert('"'+s[0].ComponentName.toString()+'" Amount should be in between '+l+"  and  "+o),a[t]=(0).ToString(this.sDecimalsAmount)):confirm('"'+s[0].ComponentName.toString()+'" Amount should be in between '+l+"  and  "+o+"\r\nDo you want to proceed.?")||(a[t]=(0).ToString(this.sDecimalsAmount)))}}this.ExecuteFormulas()}}},{key:"dgvPayrollDed_EndEdit",value:function(e,t,i){if("DedValue"==t){if(""==e[t].toString().Trim()&&(e[t]=(0).ToString(this.sDecimalsAmount)),b.a.SessionManager.Preferences.ContainsKey("ConsiderGradeWiseSalarySlabs")&&"True"==b.a.SessionManager.Preferences.ConsiderGradeWiseSalarySlabs&&(null!=this.dtGrSalSalbs&&null!=this.dtGrSalSalbs||this.GetDtGrSalSalbs(),null!=this.dtGrSalSalbs&&null!=this.dtGrSalSalbs&&this.dtGrSalSalbs.length>0)){var a=null;if(null!=(a=this.dtGrSalSalbs.filter("EarValue"==t?function(t){return t.ComponentID==e.EarComponentID.toString()}:function(t){return t.ComponentID==e.DedComponentID.toString()}))&&null!=a&&a.length>0&&this.ValidateGradeWiseSalarySlabsApplicableFormula(a[0])){var s,n,l;s=y.e.DoubleTryParse(e[t].toString()),n=y.e.DoubleTryParse(a[0].MinAmount.toString()),l=y.e.DoubleTryParse(a[0].MaxAmount.toString()),s>=n&&s<=l||("Stop"==a[0].AlertType.toString()?(alert('"'+a[0].ComponentName.toString()+'" Amount should be in between '+n+"  and  "+l),e[t]=(0).ToString(this.sDecimalsAmount)):confirm('"'+a[0].ComponentName.toString()+'" Amount should be in between '+n+"  and  "+l+"\r\nDo you want to proceed.?")||(e[t]=(0).ToString(this.sDecimalsAmount)))}}this.ExecuteFormulas()}}},{key:"ValidateGradeWiseSalarySlabsApplicableFormula",value:function(e){if(null!=e&&null!=e&&""!=y.e.String(e.ApplicableFormula).Trim()){this.oEvalPayFormulas=new f.b,this.oEvalPayFormulas.isValidGWSlabs=!0,this.oEvalPayFormulas.sEmpSeqNo=this.NodeID.toString();var t={PayrollMonth:this.oEvalPayFormulas.PayrollMonth,PayrollMonthStart:this.oEvalPayFormulas.PayrollMonthStart,PayrollMonthEnd:this.oEvalPayFormulas.PayrollMonthEnd};if(y.e.SetPayrollDate(new Date,t),this.oEvalPayFormulas.PayrollMonth=t.PayrollMonth,this.oEvalPayFormulas.PayrollMonthStart=t.PayrollMonthStart,this.oEvalPayFormulas.PayrollMonthEnd=t.PayrollMonthEnd,this.oEvalPayFormulas.arrLstCPFields[6].Clear(),this.oCPF=new f.a,this.oCPF.ComponentName="GrdWiseSalSlabsFormula",this.oCPF.SNo=1,this.oCPF.Formula=e.ApplicableFormula.toString(),this.oCPF.dEarned=this.oCPF.dActual="0",this.oEvalPayFormulas.arrLstCPFields[6].push(this.oCPF),this.oEvalPayFormulas.Intialize(),this.oEvalPayFormulas.othMPField.BasicMonthly=""==this.txtBasicMonthly.Text?0:parseFloat(this.txtBasicMonthly.Text),this.oEvalPayFormulas.othMPField.TotalLeaves=0,this.oEvalPayFormulas.othMPField.DaysAttended=this.oEvalPayFormulas.othMPField.TotalDays,null!=this.EmpType.GetselectedItem()&&(this.oEvalPayFormulas.sEmpType=this.EmpType.GetselectedItem().Name),null!=this.Gender.GetselectedItem()&&(this.oEvalPayFormulas.sGender=this.Gender.GetselectedItem().Name),null!=this.pcbMaritalStatus.GetselectedItem()&&(this.oEvalPayFormulas.sMaritalStatus=this.pcbMaritalStatus.GetselectedItem().Name),null!=this.pcbNationality.GetselectedItem()&&(this.oEvalPayFormulas.sNationality=this.pcbNationality.GetselectedItem().Name),null!=this.pcbReligion.GetselectedItem()&&(this.oEvalPayFormulas.sReligion=this.pcbReligion.GetselectedItem().Name),this.oEvalPayFormulas.Parent=this,this.oEvalPayFormulas.ExecuteAllFormulas(),"GrdWiseSalSlabsFormula"==this.oEvalPayFormulas.arrLstCPFields[6][0].ComponentName)return 0!=parseFloat(this.oEvalPayFormulas.arrLstCPFields[6][0].dEarned)}return!0}},{key:"GetScreenControl",value:function(e){var t=null;if(null!=this.ScreenObject&&null!=this.ScreenObject.HeaderFields){if(this.ScreenObject.HeaderFields.length>0&&(t=this.ScreenObject.HeaderFields.find((function(t){return t instanceof h.c&&t.DBColumnName==e}))))return t;for(var i=0;i<this.ScreenObject.CustomTab.Pages.length;i++)if(t=this.ScreenObject.CustomTab.Pages[i].Fields.find((function(t){return t instanceof h.c&&t.DBColumnName==e})))return t}return null}},{key:"PayrollType_SelectionChanged",value:function(){switch(this.pcbPayrollType.SelectedValue){case"Monthly":this.ScreenObject.CustomTab.Pages.forEach((function(e){e.Fields.forEach((function(e){e instanceof s.d&&("BasicMonthly"==e.DBColumnName?e.Enable=!0:("BasicWeekly"==e.DBColumnName||"BasicDaily"==e.DBColumnName||"BasicHourly"==e.DBColumnName)&&(e.Enable=!1))}))}));break;case"Weekly":this.ScreenObject.CustomTab.Pages.forEach((function(e){e.Fields.forEach((function(e){e instanceof s.d&&("BasicMonthly"==e.DBColumnName?e.Enable=!1:"BasicWeekly"==e.DBColumnName?e.Enable=!0:("BasicDaily"==e.DBColumnName||"BasicHourly"==e.DBColumnName)&&(e.Enable=!1))}))}));break;case"Daily":this.ScreenObject.CustomTab.Pages.forEach((function(e){e.Fields.forEach((function(e){e instanceof s.d&&("BasicMonthly"==e.DBColumnName||"BasicWeekly"==e.DBColumnName?e.Enable=!1:"BasicDaily"==e.DBColumnName?e.Enable=!0:"BasicHourly"==e.DBColumnName&&(e.Enable=!1))}))}));break;case"Hourly":this.ScreenObject.CustomTab.Pages.forEach((function(e){e.Fields.forEach((function(e){e instanceof s.d&&("BasicMonthly"==e.DBColumnName||"BasicWeekly"==e.DBColumnName||"BasicDaily"==e.DBColumnName?e.Enable=!1:"BasicHourly"==e.DBColumnName&&(e.Enable=!0))}))}))}}},{key:"OnTabSelectionChanged",value:function(e){null!=this.ScreenObject.CustomTab.SelectedTab&&("Notes"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.AttachmentVisibility=!1,this.ContactVisibility=!1,this.AddressVisibility=!1,this.CCMapVisibility=!1,this.EmpDocumentsVisibility=!1,this.ViewNotes.OnShowNewNotes(null)):"Attachments"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.ViewAttachments=new A.ViewAttachmentViewModel(this,b.a.SessionManager,b.a.admin),this.NoteVisibility=!1,this.ContactVisibility=!1,this.AddressVisibility=!1,this.CCMapVisibility=!1,this.EmpDocumentsVisibility=!1):"Contacts"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.AddressVisibility=!1,this.CCMapVisibility=!1,this.EmpDocumentsVisibility=!1,this.ViewContacts.OnShowNewContact(null)):"Address"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.ContactVisibility=!1,this.CCMapVisibility=!1,this.EmpDocumentsVisibility=!1,this.ViewAddress.OnShowNewAddress(null)):"Assign"==this.ScreenObject.CustomTab.SelectedTab.Name?b.a.SessionManager.IsActionAssigned(2,"Map")?(this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.ContactVisibility=!1,this.AddressVisibility=!1,this.EmpDocumentsVisibility=!1,this.ViewCCMapping.OnShowCC(null)):(this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.ContactVisibility=!1,this.AddressVisibility=!1,this.CCMapVisibility=!1,this.EmpDocumentsVisibility=!1):"Documents"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.ContactVisibility=!1,this.CCMapVisibility=!1,this.AddressVisibility=!1,this.ViewEmpDocuments.OnShowNew(null)):(this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.ContactVisibility=!1,this.AddressVisibility=!1,this.CCMapVisibility=!1,this.EmpDocumentsVisibility=!1))}},{key:"OnGroupSelectionChanged",value:function(e){this.EmpGroup.SelectedValue>0&&(this.EmpGroup.DefaultValue=this.EmpGroup.SelectedValue.toString(),this.AutoGenerateCode())}},{key:"AutoGenerateCode",value:function(){0==this.NodeID&&(this.objEmp.SelectedNodeID=this.EmpGroup.SelectedValue>0?this.EmpGroup.SelectedValue:this.ParentId,this.ScreenObject.SetAutoCode(this.EmpCode,this.objEmp.IsGroup,this.objEmp.SelectedNodeID,this.ScreenObject.Data.Tables[7]))}},{key:"GetRecords",value:function(e){this.ButtonSave.Enable||(this.ButtonSave.Enable=!0);var t=0;this.iBankNodeID=0;var i=!1;"NEXT"==e.toString().toUpperCase()?i=!0:"PREVIOUS"==e.toString().toUpperCase()&&(i=!1);var a=null;if(b.a.SessionManager.sWHEmpFilteredEmpSeqNos.length>0){if(null!=(a=this.objEmp.GetQueryData(0,"EmpFilteredEmpSeqNos",b.a.SessionManager.sWHEmpFilteredEmpSeqNos,"",""))&&a.Tables.length>0&&a.Tables[0].length>0)for(var s=0;s<a.Tables[0].length;s++)if(a.Tables[0][s].NodeID.toString()==this.NextPrevID.toString()){if(i)try{t=parseInt(a.Tables[0][s+1].NodeID.toString())}catch(n){}else try{t=parseInt(a.Tables[0][s-1].NodeID.toString())}catch(l){}break}}else null!=(a=b.a.common.GetNextPreviousRecords(this.CostCenterID,this.NextPrevID,i,0,this.objEmp.IsGroup?1:0))&&a.Tables.length>0&&a.Tables[0].length>0&&(t=parseInt(a.Tables[0][0][Object.keys(a.Tables[0][0])[0]]));0!=t&&(this.NextPrevID=t,this.NodeID=t,1!=this.NodeID&&this.FillControls())}},{key:"GetNextPreviousRecords",value:function(e,t,i,a){null==a&&(a=0),b.a.SessionManager.Logger.InfoLog("Administration:: Entering GetDivisions");var s="";return s=e,s+="~"+t,s+="~"+i,s+="~"+a,s+="~"+b.a.SessionManager.UserName,b.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"True"==b.a.SessionManager.Preferences.EnableLocationWise.toString()&&(2==e&&b.a.SessionManager.Preferences.ContainsKey("LW Accounts")&&"True"==b.a.SessionManager.Preferences["LW Accounts"].toString()||3==e&&b.a.SessionManager.Preferences.ContainsKey("LW Products")&&"True"==b.a.SessionManager.Preferences["LW Products"].toString()||e>5e4&&b.a.SessionManager.Preferences.ContainsKey("LocationWiseDimension")&&b.a.SessionManager.Preferences.LocationWiseDimension.split(",").Contains(e.toString()))?b.a.SessionManager.LocationID>0?s+="~"+b.a.SessionManager.LocationID:""!=b.a.SessionManager.LocationWhere&&(s+="~"+b.a.SessionManager.LocationWhere):s+="~0",b.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"True"==b.a.SessionManager.Preferences.EnableLocationWise.toString()&&b.a.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&"True"==b.a.SessionManager.Preferences.EnableDivisionWise.toString()&&(2==e&&b.a.SessionManager.Preferences.ContainsKey("DW Accounts")&&"True"==b.a.SessionManager.Preferences["DW Accounts"].toString()||3==e&&b.a.SessionManager.Preferences.ContainsKey("DW Products")&&"True"==b.a.SessionManager.Preferences["DW Products"].toString()||e>5e4&&b.a.SessionManager.Preferences.ContainsKey("DivisionWiseDimension")&&b.a.SessionManager.Preferences.DivisionWiseDimension.split(",").Contains(e.toString()))?b.a.SessionManager.DivisionID>0?s+="~"+b.a.SessionManager.DivisionID:""!=b.a.SessionManager.DivisionWhere&&(s+="~"+b.a.SessionManager.DivisionWhere):s+="~0",b.a.SessionManager.Logger.InfoLog("Administration:: Success: DBH.SetCCCCMap "),this.objEmp.GetNextPreviousRecords(s)}},{key:"FillControls",value:function(){var e=this;b.a.SessionManager.Logger.InfoLog("AddEditEmpMasterViewModel::Entering FillData"),this.ScreenObject.Clear(),this.ClearOtherControls(),this.NextPrevID=this.NodeID,this.objEmp.NodeID=this.NodeID,this.dsEdit=this.objEmp.GetEmpMasterDetails(),this.AccountPhoto="",this.EmpCode.Text=this.objEmp.EmpCode,this.ScreenObject.IsAutoCode&&(this.EmpCode.Enable=!1),this.ScreenObject.IsAutoName&&(this.EmpName.Enable=!1),this.EmpName.Text=this.objEmp.EmpName,this.AliasName.Text=this.objEmp.EmpAliasName,this.Status.SelectedValue=this.objEmp.StatusID.toString(),this.EmpGroup.SelectedValue=this.objEmp.ParentID,this.EmpGroup.Enable=!1,this.EmpType.SelectedValue=this.objEmp.EmpTypeID.toString(),this.DateOfJoining.Date=this.objEmp.DOJ,this.DateOfBirth.Date=this.objEmp.DOB,this.RptManager.SelectedValue=this.objEmp.RptManager,this.Gender.SelectedValue=this.objEmp.Gender,this.ProbationDays.Text=this.objEmp.ProbationDays.toString(),this.DateOfConfirmation.Date=this.objEmp.DOConfirmation,this.guid=this.objEmp.GUID,this.ScreenObject.LoadCustomFieldsData(this.dsEdit.Tables[0]),this.GetBankDetails(this.pc1),this.ScreenObject.LoadCustomFieldsCCData(this.dsEdit.Tables[7],this.dsEdit.Tables[12]),this.ViewCCMapping.LoadData(this.dsEdit.Tables[5],this.dsEdit.Columns[5]),this.ViewContacts.LoadContacts(this.dsEdit.Tables[1],this.dsEdit.Columns[1]),this.ViewAttachments.LoadAttachments(this.dsEdit.Tables[3]),this.ViewNotes.LoadNotes(this.dsEdit.Tables[2]),this.ViewAddress.LoadContacts(this.dsEdit.Tables[6]),this.ViewEmpDocuments.GridListObj.Clear(),this.ViewEmpDocuments.LoadDocuments(this.dsEdit.Tables[13]),this.ScreenObject.LoadIdentityControlsDataXML(this.dsEdit.Tables[13]),this.EmpDocumentsVisibility=!1;var t,i=this.dsEdit.Tables[14];if(i.sort((function(e,t){return t.EffectFrom-e.EffectFrom})),i.sort((function(e,t){return t.SeqNo-e.SeqNo})),i.length>0){for(var a=0;a<this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields.length;a++)this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[a]instanceof h.c&&("BasicMonthly"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[a].DBColumnName&&"BasicWeekly"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[a].DBColumnName&&"BasicDaily"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[a].DBColumnName&&"BasicHourly"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[a].DBColumnName&&"NetSalary"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[a].DBColumnName&&"AnnualCTC"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[a].DBColumnName||(this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[a].Text=parseFloat(i[0][this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[a].DBColumnName]).ToString(this.sDecimalsAmount)));if(null!=this.dgvPayrollEar&&null!=this.dgvPayrollEar&&null!=this.dgvPayrollEar.Table&&this.dgvPayrollEar.Table.length>0)for(var s=0;s<this.dgvPayrollEar.Table.length;s++)y.e.StringIsNullOrEmpty(this.dgvPayrollEar.Table[s].EarSNo)||(this.dgvPayrollEar.Table[s].EarValue=parseFloat(i[0]["Earning"+this.dgvPayrollEar.Table[s].EarSNo]).ToString(this.sDecimalsAmount));if(null!=this.dgvPayrollAccrual&&null!=this.dgvPayrollAccrual&&null!=this.dgvPayrollAccrual.Table&&this.dgvPayrollAccrual.Table.length>0)for(var n=0;n<this.dgvPayrollAccrual.Table.length;n++)y.e.StringIsNullOrEmpty(this.dgvPayrollAccrual.Table[n].EarSNo)||(this.dgvPayrollAccrual.Table[n].EarValue=parseFloat(i[0]["Earning"+this.dgvPayrollAccrual.Table[n].EarSNo]).ToString(this.sDecimalsAmount));if(null!=this.dgvPayrollDed&&null!=this.dgvPayrollDed&&null!=this.dgvPayrollDed.Table&&this.dgvPayrollDed.Table.length>0)for(var l=0;l<this.dgvPayrollDed.Table.length;l++)y.e.StringIsNullOrEmpty(this.dgvPayrollDed.Table[l].DedSNo)||(this.dgvPayrollDed.Table[l].DedValue=parseFloat(i[0]["Deduction"+this.dgvPayrollDed.Table[l].DedSNo]).ToString(this.sDecimalsAmount));this.ExecuteFormulas()}if(this.LoadAppraisalGrid(),this.txtBasicMonthly_LostFocus(this.txtBasicMonthly),null!=this.dgvAccLinking&&null!=this.dgvAccLinking&&null!=this.dgvAccLinking.Table&&this.dgvAccLinking.Table.length>0)for(var o,r=function(t){y.e.StringIsNullOrEmpty(e.dgvAccLinking.Table[t].ComponentID)||(null!=(o=e.dsEdit.Tables[15].filter((function(i){return i.ComponentID==e.dgvAccLinking.Table[t].ComponentID.toString()})))&&null!=o&&o.length>0&&(e.dgvAccLinking.Table[t].DebitAccountID=o[0].DebitAccountName.toString(),e.dgvAccLinking.Table[t].DebitAccountID_Key=o[0].DebitAccountID.toString(),e.dgvAccLinking.Table[t].CreditAccountID=o[0].CreditAccountName.toString(),e.dgvAccLinking.Table[t].CreditAccountID_Key=o[0].CreditAccountID.toString()),e.TempdgvAccLinkingTable=e.dgvAccLinking.Table)},d=0;d<this.dgvAccLinking.Table.length;d++)r(d);this.dsEdit.Tables.length>10&&this.dsEdit.Tables[10].length>0&&this.ScreenObject.CanApprove(this.dsEdit.Tables[0][0],this.dsEdit.Tables[10][0],this.ButtonSave),(t=this.dsEdit.Tables[3].filter((function(e){return 1==e.IsProductImage&&(1==e.IsDefaultImage||1==e.IsDefaultImage)}))).length>0?(this.PhotoTextVisibility=!1,this.FileID=parseInt(t[0].FileID),this.EmpAttachmentguid=t[0].GUID.toString(),this.FileExtension=t[0].FileExtension.toString(),this.AccountPhoto=y.e.GetPath(t[0].GUID.toString()+"."+t[0].FileExtension.toString())):(this.FileID=0,this.PhotoTextVisibility=!0),b.a.SessionManager.IsOffline&&this.NodeID>0&&(this.ButtonSave.Visible=!1),"Bank Transfer"==this.pcbPaymentMode.SelectedValue&&(this.pc1=this.GetScreenControl("BankAccNo"),null!=this.pc1&&(this.pc1.Enable=!0),this.pc1=this.GetScreenControl("IBANNo"),null!=this.pc1&&(this.pc1.Enable=!0),this.pc1=this.GetScreenControl("iBank"),null!=this.pc1&&(this.pc1.Enable=!0));var c=this.GetScreenControl("AttSetType");if(this.AttSetTypeCheckedChanged(1==c.Items[0].IsChecked?c.Items[0]:c.Items[1]),this.SetEmpAsOnStatus(),this.CheckViewForUser(0),this.RestrictSaveButton(),b.a.SessionManager.Preferences.ContainsKey("DisableEmployeePayrollTabafterPayrollProcessed")&&"True"==b.a.SessionManager.Preferences.DisableEmployeePayrollTabafterPayrollProcessed){var u=b.a.common.GetDataTable("AEEMP002",this.NodeID.toString());if(null!=u&&u.length>0){for(var m=0;m<this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields.length;m++)this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[m]instanceof h.c&&("BasicMonthly"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[m].DBColumnName&&"BasicWeekly"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[m].DBColumnName&&"BasicDaily"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[m].DBColumnName&&"BasicHourly"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[m].DBColumnName&&"NetSalary"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[m].DBColumnName&&"AnnualCTC"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[m].DBColumnName||(this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[m].IsReadOnly=!0));this.dgvPayrollEar.IsReadOnly=!0,this.dgvPayrollDed.IsReadOnly=!0,this.dgvPayrollAccrual.IsReadOnly=!0}}}},{key:"SetEmpAsOnStatus",value:function(){this.EmpCurrentStatus="";var e=this.objEmp.GetQueryData(this.NodeID,"SetEmpAsOnStatus","","","").Tables[0];null!=e&&e.length>0&&(this.EmpCurrentStatus="Active"==y.e.String(e[0].AsOnStatus)?" ["+b.a.GetResource("EmpActive")+"]":"Inactive"==y.e.String(e[0].AsOnStatus)?" ["+b.a.GetResource("EmpInActive")+"]":"Cancelled"==y.e.String(e[0].AsOnStatus)?" ["+b.a.GetResource("EmpCancelled")+"]":"Absconded"==y.e.String(e[0].AsOnStatus)?" ["+b.a.GetResource("EmpAbsconded")+"]":"Resigned"==y.e.String(e[0].AsOnStatus)?" ["+b.a.GetResource("EmpResigned")+"]":"Terminated With Cause"==y.e.String(e[0].AsOnStatus)?" ["+b.a.GetResource("EmpTerminatedwithcause")+"]":" ["+y.e.String(e[0].AsOnStatus)+"]"),b.a.SessionManager.Logger.InfoLog("AddEditEmpMasterViewModel::Exiting FillData")}},{key:"LoadImageDimensions",value:function(){var e=new d.b;e.Row="0";var t=90,i=this.ScreenObject.Data.Tables[5].filter((function(e){return"ImageDimensions"==e.Name}));if(i.length>0&&!y.e.IsEmpty(i[0].Value)){var a=new y.f;a.LoadXml(i[0].Value.toString()),null==a.DocumentElement.attributes.ShowImage||"0"!=a.DocumentElement.attributes.ShowImage.value,e.RowSpan=null!=a.DocumentElement.attributes.RowSpan&&""!=a.DocumentElement.attributes.RowSpan.value?a.DocumentElement.attributes.RowSpan.value:"3",e.ColumnSpan=null!=a.DocumentElement.attributes.ColumnSpan&&""!=a.DocumentElement.attributes.ColumnSpan.value?a.DocumentElement.attributes.ColumnSpan.value:"1",e.Column="1"==e.ColumnSpan?"3":"2"==e.ColumnSpan?"2":"3"==e.ColumnSpan?"1":"4"==e.ColumnSpan?"0":"3",t=this.AccountPhoto.length>0?45*parseInt(e.RowSpan):45*parseInt(e.RowSpan)-20,e.ImageHeight=t.toString()}else e.RowSpan="3",e.Column="3",e.ColumnSpan="1",e.ImageHeight=t.toString()}},{key:"OnSaveEmployee",value:function(e){var t=this;if("PickMin"==e.toString()||"PickMax"==e.toString()){if(b.a.SessionManager.Preferences.ContainsKey("ConsiderGradeWiseSalarySlabs")&&"True"==b.a.SessionManager.Preferences.ConsiderGradeWiseSalarySlabs&&(this.dtGrSalSalbs=b.a.empService.GetQueryData(0,"ValidateDtGrSalSalbs","","",""),null!=this.dtGrSalSalbs&&this.dtGrSalSalbs.length>0)){for(var i=null,a=function(a){if(!y.e.IsEmpty(t.dgvPayrollEar.Table[a].EarFType)&&"EmployeeMaster"==t.dgvPayrollEar.Table[a].EarFType.toString()&&(null!=(i=t.dtGrSalSalbs.filter((function(e){return e.ComponentID==y.e.String(t.dgvPayrollEar.Table[a].EarComponentID)})))&&i.length>0&&t.ValidateGradeWiseSalarySlabsApplicableFormula(i[0]))){var s=0,n=0;s=y.e.Double(i[0].MinAmount),n=y.e.Double(i[0].MaxAmount),t.dgvPayrollEar.Table[a].EarValue="PickMin"==e.toString()?s.toString():n.toString()}},s=0;s<this.dgvPayrollEar.Table.length;s++)a(s);for(var n=function(a){if(!y.e.IsEmpty(t.dgvPayrollDed.Table[a].DedFType)&&"EmployeeMaster"==t.dgvPayrollDed.Table[a].DedFType.toString()&&(null!=(i=t.dtGrSalSalbs.filter((function(e){return e.ComponentID==y.e.String(t.dgvPayrollDed.Table[a].DedComponentID)})))&&i.length>0&&t.ValidateGradeWiseSalarySlabsApplicableFormula(i[0]))){var s=0,n=0;s=y.e.Double(i[0].MinAmount),n=y.e.Double(i[0].MaxAmount),t.dgvPayrollDed.Table[a].DedValue="PickMin"==e.toString()?s.toString():n.toString()}},l=0;l<this.dgvPayrollDed.Table.length;l++)n(l)}this.ExecuteFormulas()}else if("Contact"==e.toString());else if("Note"==e.toString());else if("Attachment"==e.toString());else if("NewContact"==e.toString());else if("NewAttachment"==e.toString());else if("NewAddress"==e.toString());else if("NewNote"==e.toString());else if("ShowApprove"==e.toString()){var o=new w.a(50051,this.NodeID,this.ScreenObject,this);b.a.page.ShowDialog(o,F.a,{ShowCenter:!0,Title:b.a.GetResource("ApproveReject")})}else if("Save"==e.toString()){b.a.SessionManager.Logger.InfoLog("AddEditEmpMasterViewModel::Entering OnSaveEmployee");try{var r=this.ScreenObject.ValidateData();if(!b.a.SessionManager.StringIsNullOrEmpty(r))return this.DisplayMessage=r,void(this.MessageVisibility=!0);if(!this.objEmp.IsGroup&&""!=b.a.SessionManager.Preferences.MinAgeForEmployee&&parseInt(b.a.SessionManager.Preferences.MinAgeForEmployee)>0){var d=parseInt(b.a.SessionManager.Preferences.MinAgeForEmployee);if(this.DateOfJoining.Date.Subtract(this.DateOfBirth.Date).TotalDays/365<d)return this.DisplayMessage="Employee should be atleast "+d+" years of age.",this.MessageVisibility=!0,void(this.DateOfBirth.SetFocus=!0)}var u=this.GetScreenControl("LoginUserID");if(null!=u){var m=b.a.empService.GetQueryData(0,"LoginUserID",this.EmpCode.Text,u.Text.toString(),"");if(null!=m&&m.length>0)return this.DisplayMessage="User Already Created with same LoginUserID",void(this.MessageVisibility=!0)}if(null!=this.EmpType&&"0"==this.EmpType.SelectedValue||""==this.EmpType.SelectedValue)return this.DisplayMessage="Please select the employee type",void(this.MessageVisibility=!0);if(!this.ScreenObject.ValidateDataonSave())return;if(this.objEmp.NodeID>0&&(302==parseInt(this.Status.SelectedValue)||303==parseInt(this.Status.SelectedValue)||304==parseInt(this.Status.SelectedValue))){var p=b.a.common.GetDataTable("AEEMP003",this.objEmp.NodeID.toString());if(null!=p&&p.length>0&&1==parseInt(p[0].VALID))return this.DisplayMessage="Status '"+this.Status.GetselectedItem().Name+"' Can be changed only after RelieveDate",void(this.MessageVisibility=!0)}if(b.a.SessionManager.Preferences.ContainsKey("ConsiderGradeWiseSalarySlabs")&&"True"==b.a.SessionManager.Preferences.ConsiderGradeWiseSalarySlabs){var g="",D=this.ScreenObject.GetCustomField("CCNID53");if(null!=D&&null!=D&&("0"==(g=D.SelectedValue.toString())&&(g="1")),this.dtGrSalSalbs=this.objEmp.GetQueryData(this.NodeID,"GradewiseSalarySlabs",g,"",""),this.dtGrSalSalbs&&null!=this.dtGrSalSalbs&&this.dtGrSalSalbs.length>0){for(var S,C="",f=!1,I=function(e){if(!y.e.StringIsNullOrEmpty(t.dgvPayrollEar.Table[e].EarFType)&&"EmployeeMaster"==t.dgvPayrollEar.Table[e].EarFType.toString()&&(null!=(S=t.dtGrSalSalbs.filter((function(i){return i.ComponentID==t.dgvPayrollEar.Table[e].EarComponentID.toString()})))&&null!=S&&S.length>0&&t.ValidateGradeWiseSalarySlabsApplicableFormula(S[0]))){var i,a,s;i=b.a.SessionManager.DoubleTryParse(t.dgvPayrollEar.Table[e].EarValue.toString()),a=b.a.SessionManager.DoubleTryParse(S[0].MinAmount.toString()),s=b.a.SessionManager.DoubleTryParse(S[0].MaxAmount.toString()),i>=a&&i<=s||("Stop"==S[0].AlertType.toString()?(f=!0,C+='\r\n"'+S[0].ComponentName.toString()+'" Amount should be in between '+a+"  and  "+s):C+='\r\n"'+S[0].ComponentName.toString()+'" Amount should be in between '+a+"  and  "+s)}},T=0;T<this.dgvPayrollEar.Table.length;T++)I(T);for(var A=function(e){if(!y.e.StringIsNullOrEmpty(t.dgvPayrollDed.Table[e].DedFType)&&"EmployeeMaster"==t.dgvPayrollDed.Table[e].DedFType.toString()&&(null!=(S=t.dtGrSalSalbs.filter((function(i){return i.ComponentID==t.dgvPayrollDed.Table[e].DedComponentID.toString()})))&&null!=S&&S.length>0&&t.ValidateGradeWiseSalarySlabsApplicableFormula(S[0]))){var i,a,s;i=b.a.SessionManager.DoubleTryParse(t.dgvPayrollDed.Table[e].DedValue.toString()),a=b.a.SessionManager.DoubleTryParse(S[0].MinAmount.toString()),s=b.a.SessionManager.DoubleTryParse(S[0].MaxAmount.toString()),i>=a&&i<=s||("Stop"==S[0].AlertType.toString()?(f=!0,C+='\r\n"'+S[0].ComponentName.toString()+'" Amount should be in between '+a+"  and  "+s):C+='\r\n"'+S[0].ComponentName.toString()+'" Amount should be in between '+a+"  and  "+s)}},E=0;E<this.dgvPayrollDed.Table.length;E++)A(E);if(C.length>0){if(f)return void alert(C);if(!confirm(C+"\r\nDo you want to proceed.?"))return}}}if(0==this.objEmp.NodeID){var P,v,M={StrCode:this.objEmp.EmpCode,CodePrefix:this.objEmp.CodePrefix,CodeNumber:this.objEmp.CodeNumber};if(this.DisplayMessage=this.ScreenObject.SetAutoCodeParams_3(this.EmpCode,this.objEmp.SelectedNodeID,this.ScreenObject.Data.Tables[7],M),this.objEmp.EmpCode=M.StrCode,this.objEmp.CodePrefix=M.CodePrefix,this.objEmp.CodeNumber=M.CodeNumber,this.DisplayMessage.length>0)return;if(null!=(P=this.GetScreenControl("CanCreateUser"))&&"Yes"==P.SelectedValue&&b.a.SessionManager.LicenseSettings.ContainsKey("EFeature11"))if((v=parseInt(b.a.SessionManager.LicenseSettings.EFeature11))>0){var V=b.a.common.GetDataTable("AEEMP001","");if(v<=parseInt(V[0][Object.keys(V[0])[0]]))return this.DisplayMessage="Maximum "+v.toString()+" ESS Users Allowed.",void(this.MessageVisibility=!0)}}else this.objEmp.EmpCode=this.EmpCode.Text.trim();this.objEmp.EmpName=this.EmpName.Text.trim(),this.objEmp.EmpAliasName=this.AliasName.Text,this.objEmp.StatusID=parseInt(this.Status.SelectedValue),this.objEmp.EmpTypeID=parseInt(this.EmpType.SelectedValue),this.objEmp.SelectedNodeID=parseInt(this.EmpGroup.SelectedValue.toString()),this.objEmp.DOJ=this.DateOfJoining.Date,this.objEmp.DOB=this.DateOfBirth.Date,this.objEmp.RptManager=parseInt(this.RptManager.SelectedValue.toString()),this.objEmp.Gender=this.Gender.SelectedValue,this.objEmp.ProbationDays=parseInt(this.ProbationDays.Text),this.objEmp.DOConfirmation=this.DateOfConfirmation.Date,this.objEmp.NotesXML=this.ViewNotes.GetXML(),this.objEmp.ContactsXML=this.ViewContacts.GetXML(),this.objEmp.AddressXML=this.ViewAddress.GetXML();try{this.objEmp.AttachmetsXML=this.ViewAttachments.GetXML(),this.objEmp.AttachmetsXML+=this.ScreenObject.GetExtraAttachmentXML();var N="";this.IsPhotoChanged&&!y.e.IsEmpty(this.AccountPhoto)?(N+=0==this.FileID?'<Row Action="NEW"':'<Row Action="MODIFY"',b.a.SessionManager.IsWebApplication&&(N+=' AttachmentID="'+this.FileID+'"',N+=' FilePath="'+this.AccountPhoto+'"',N+=' ActualFileName="'+this.AccountPhoto.substring(this.AccountPhoto.lastIndexOf("\\")+1)+'"',N+=' RelativeFileName="'+this.AccountPhoto+'"',N+=' FileExtension="'+this.FileExtension+'"',N+=' FileDescription=""',N+=' IsProductImage="1"',N+=' IsDefaultImage="1"',N+=' GUID="'+this.EmpAttachmentguid+'"',N+="/>")):this.IsPhotoDelete&&this.FileID>0&&(N+='<Row Action="DELETE"',N+=' AttachmentID="'+this.FileID+'"/>'),N.length>0&&(N="<AttachmentsXML>"+N,N+="</AttachmentsXML>",this.objEmp.AttachmetsXML=this.objEmp.AttachmetsXML+N)}catch(ee){return b.a.SessionManager.Logger.ErrorLog("AddEditEmpMasterViewModel:: OnSaveEmployee :: Attachments Exception : "),this.DisplayMessage=b.a.SessionManager.translate.instant("Upload_Path_notExists"),void(this.MessageVisibility=!0)}this.objEmp.CustomFieldsQuery=this.ScreenObject.GetCustomFieldsQuery(),this.objEmp.CustomCostCenterFieldsQuery=this.ScreenObject.GetCustomCostCenterFieldsQuery(),this.objEmp.HistoryXML=this.ScreenObject.HistoryCCXML,this.objEmp.CCMapXML="";var L="";if("TRUE"==b.a.SessionManager.Preferences.EnableLocationWise.toUpperCase()&&b.a.SessionManager.Preferences.LocationWiseDimension.split(",").Contains("50051")){if(null!=this.objEmp.CustomCostCenterFieldsQuery&&this.objEmp.CustomCostCenterFieldsQuery.length>0){var O=this.objEmp.CustomCostCenterFieldsQuery.split(",");if(O.length>0)for(var G=0;G<O.length;G++)null!=O[G]&&O[G].Contains("CCNID2=")&&(L+='<Row  CostCenterId="50002" NodeID="'+O[G].replace("'","").replace("'","").substring(7)+'" />')}if(""==L)return this.DisplayMessage="Select atleast one Location",void(this.MessageVisibility=!0);this.objEmp.CCMapXML+="<XML>"+L+"</XML>"}else this.objEmp.CCMapXML="";if(null!=this.dsEdit&&this.dsEdit.Tables[0].length>0?Date.parse(this.dsEdit.Tables[0][0].cDOJ.toString())>0&&(this.TempDOJ=new Date(this.dsEdit.Tables[0][0].cDOJ.toString())):Date.parse(this.DateOfJoining.Date.ToString("dd/MMM/yyyy"))>0&&(this.TempDOJ=new Date(this.DateOfJoining.Date.ToString("dd/MMM/yyyy"))),!y.e.IsEmpty(this.objEmp.HistoryXML)){var x=new y.f,R=new Date,_="";x.LoadXml(this.objEmp.HistoryXML);var j=x.SelectNodes("History/XML/Row");if(null!=j&&j.length>0){for(var W=0;W<j.length;W++){var U=j[W];if("2"!=U.attributes.Modified.value.toString()&&"50053"==U.attributes.CCID.value.toString()){_="Grade",R=new Date(U.attributes.FromDate.value);break}}if("Grade"==_.toString()&&new Date(R).ToString("MMM/yyyy")!=new Date(this.DateOfJoining.Date).ToString("MMM/yyyy")&&new Date(this.TempDOJ).ToString("MMM/yyyy")==new Date(this.DateOfJoining.Date).ToString("MMM/yyyy"))return this.DisplayMessage="Please check the date of joining of Employee and dependency with Grade",void(this.MessageVisibility=!0);for(var H=0;H<j.length;H++){var K=j[H];if("2"!=K.attributes.Modified.value.toString()&&"50002"==K.attributes.CCID.value.toString()){_="Location",R=new Date(K.attributes.FromDate.value);break}}}if("Location"==_.toString()&&new Date(R).ToString("MMM/yyyy")!=new Date(this.DateOfJoining.Date).ToString("MMM/yyyy")&&new Date(this.TempDOJ).ToString("MMM/yyyy")==new Date(this.DateOfJoining.Date).ToString("MMM/yyyy"))return this.DisplayMessage="Please check the date of joining of Employee and dependency with Location",void(this.MessageVisibility=!0)}if(null!=this.dsEdit&&null!=this.dsEdit&&this.dsEdit.Tables[12].length>0&&this.TempDOJ.ToString("dd/MMM/yyyy")!=this.DateOfJoining.Date.ToString("dd/MMM/yyyy")){if(!confirm("Changing of Date of Join will effect on History, Appraisal Data and Others Documents. So, Are you sure want to Change the Date of Joining.?"))return void(this.DateOfJoining.Date=this.TempDOJ);var Y=this.objEmp.GetQueryData(this.NodeID,"DateOfJoining",this.DateOfJoining.Date.ToString("dd/MMM/yyyy"),"",""),X=Y.Tables[0];if(null!=X&&X.length>0){if((X=Y.Tables[1]).length>0&&null!=X)return this.DisplayMessage="Date of joining Cannot be changed Monthly Payroll Processed '"+X[0].VoucherNo.toString()+"'",void(this.MessageVisibility=!0);if((X=Y.Tables[2]).length>0&&null!=X)return this.DisplayMessage="Date of joining Cannot be changed daily payroll posted '"+X[0].VoucherNo.toString()+"'",void(this.MessageVisibility=!0);if((X=Y.Tables[3]).length>0&&null!=X)return this.DisplayMessage="Date of joining Cannot be changed Hours Definition Chart data Exists '"+X[0].VoucherNo.toString()+"' W.E.F Date",void(this.MessageVisibility=!0);if((X=Y.Tables[4]).length>0&&null!=X)return this.DisplayMessage="Date of joining Cannot be changed Document Data Exists '"+X[0].VoucherNo.toString()+"' Dependency With DocDate",void(this.MessageVisibility=!0)}}this.objEmp.DocumentsXML=this.ViewEmpDocuments.GetXML(),this.objEmp.AccLinkXML=this.GetAccountsLinkingXML(),this.objEmp.PrimaryContactQuery="",this.objEmp.GUID=this.guid;for(var J="",z=0;z<this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields.length;z++)this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[z]instanceof h.c&&("BasicMonthly"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[z].DBColumnName&&"BasicWeekly"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[z].DBColumnName&&"BasicDaily"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[z].DBColumnName&&"BasicHourly"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[z].DBColumnName&&"NetSalary"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[z].DBColumnName&&"AnnualCTC"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[z].DBColumnName||y.e.StringIsNullOrEmpty(this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[z].Text)||(J+=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[z].DBColumnName+"="+this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[z].Text.toString().Replace(",","")+","));if(null!=this.dgvPayrollEar&&null!=this.dgvPayrollEar&&null!=this.dgvPayrollEar.Table&&this.dgvPayrollEar.Table.length>0)for(var Q=0;Q<this.dgvPayrollEar.Table.length;Q++)y.e.StringIsNullOrEmpty(this.dgvPayrollEar.Table[Q].EarSNo)||y.e.StringIsNullOrEmpty(this.dgvPayrollEar.Table[Q].EarValue.toString().trim())||(J+="Earning"+this.dgvPayrollEar.Table[Q].EarSNo+"="+this.dgvPayrollEar.Table[Q].EarValue.toString().Replace(",","")+",");if(null!=this.dgvPayrollAccrual&&null!=this.dgvPayrollAccrual&&null!=this.dgvPayrollAccrual.Table&&this.dgvPayrollAccrual.Table.length>0)for(var q=0;q<this.dgvPayrollAccrual.Table.length;q++)y.e.StringIsNullOrEmpty(this.dgvPayrollAccrual.Table[q].EarSNo)||(J+="Earning"+this.dgvPayrollAccrual.Table[q].EarSNo+"="+this.dgvPayrollAccrual.Table[q].EarValue.toString().Replace(",","")+",");if(null!=this.dgvPayrollDed&&null!=this.dgvPayrollDed.Table&&this.dgvPayrollDed.Table.length>0)for(var Z=0;Z<this.dgvPayrollDed.Table.length;Z++)y.e.StringIsNullOrEmpty(this.dgvPayrollDed.Table[Z].DedSNo)||y.e.StringIsNullOrEmpty(this.dgvPayrollDed.Table[Z].DedValue.toString().trim())||(J+="Deduction"+this.dgvPayrollDed.Table[Z].DedSNo+"="+this.dgvPayrollDed.Table[Z].DedValue.toString().Replace(",","")+",");this.objEmp.WID=this.ScreenObject.CheckWorkFlow(),this.objEmp.PayQuery=J,this.objEmp.dsPayStructure=this.dsPayStructure,this.objEmp.IDHistoryXML=this.ScreenObject.GetIdentityControlsDataXML(),this.objEmp.PaymentModeXML=this.ScreenObject.GetPaymentModeDataXML(),this.objEmp.IsImport=!1;this.objEmp.SaveEmpMaster("","SaveEmpMaster").subscribe((function(e){if(t.DisplayMessage=e.Message,t.RetValue=e.RetValue,e.RetValue,t.RetValue>0){b.a.SessionManager.GetEmpWhere(),t.DisplayName="Add "+t.ScreenName,t.ClearScreen();var i=t.ScreenObject.Data.Tables[5].filter((function(e){return"ShowCurrentSavedData"==e.Name}));i.length>0&&!y.e.IsEmpty(i[0].Value)&&Object(c.j)(i[0].Value)&&(t.NodeID=t.RetValue,t.FillControls())}}),(function(e){console.log("Employee Master Save : "+JSON.stringify(e))})),this.MessageVisibility=!0,b.a.SessionManager.Logger.InfoLog("AddEditEmpMasterViewModel::Exiting OnSaveEmployee")}catch(ee){b.a.SessionManager.Logger.ErrorLog("AddEditEmpMasterViewModel:: OnSaveEmployee")}}else if("Appraisal"==e.toString())this.Appraisal_Click();else if("MouseDown"==e.toString());else if("DeletePhoto"==e.toString())confirm("Are you sure you want to delete Image?")&&(this.IsPhotoDelete=!0,this.AccountPhoto="",this.DialogResult=!1,this.ActualFileName="",this.IsPhotoChanged=!1,this.PhotoTextVisibility=!0,this.DisplayMessage="");else if("UploadPhoto"==e.toString()){var $=new B.a;$.PopupAttachmentsViewModel_1(this.CostCenterID,this.NodeID,this),b.a.page.ShowDialog($,k.a,{ShowCenter:!0,Title:"Add Images"})}else if("PopUp"==e.toString()){this.dsEdit&&null!=this.dsEdit&&this.dsEdit.Tables[3].filter((function(e){return"jpg"==e.FileExtension||"png"==e.FileExtension})).forEach((function(e){y.e.GetPath(e.GUID.toString()+"."+e.FileExtension.toString())+";"}))}else"Print"==e.toString()?this.btnPrint_Click():"PrintPreview"==e.toString()&&this.btnPrintPreview_Click()}},{key:"ClearScreen",value:function(){this.AccountPhoto="",this.PhotoTextVisibility=!0;var e=this.EmpGroup.SelectedValue;this.ScreenObject.Clear(),this.ViewAddress.ContactsListObj.Clear(),this.ViewContacts.grData.Clear(),this.ViewContacts.DeletedContacts.Clear(),this.ViewNotes.NotesListObj.Clear(),this.ViewNotes.DeletedNotes.Clear(),this.ViewAttachments.AttachmentsListObj.Clear(),this.ViewCCMapping.Clear(),this.ViewAddress.DeletedAddress.Clear(),this.ViewAttachments.DeletedAttachments.Clear(),this.ViewCCMapping.OnShowCC(null),this.ViewAttachments.OnShowNewAttachment(null),this.EmpGroup.SelectedValue=e,this.IsPhotoDelete=!1,this.dsEdit=null,this.AutoGenerateCode(),this.NodeID=0,this.objEmp.NodeID=0,this.EmpName.SetFocus=!0,this.dtGrSalSalbs=null,this.ClearOtherControls()}},{key:"RestrictSaveButton",value:function(){0==this.NodeID?b.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=b.a.SessionManager.IsActionAssigned(this.CostCenterID,"Create"):this.ButtonSave.Enable=b.a.SessionManager.IsActionAssigned(this.CostCenterID,"Create"):b.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=b.a.SessionManager.IsActionAssigned(this.CostCenterID,"Update"):this.ButtonSave.Enable=b.a.SessionManager.IsActionAssigned(this.CostCenterID,"Update"),b.a.SessionManager.IsRptManagerUser&&b.a.SessionManager.Preferences.ContainsKey("DontAllowRptMgrToEditSubordinateData")&&"TRUE"==b.a.SessionManager.Preferences.DontAllowRptMgrToEditSubordinateData.toUpperCase()&&b.a.SessionManager.UserName.Trim().toUpperCase()!=this.EmpCode.Text.Trim().toUpperCase()&&(b.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=!1:this.ButtonSave.Enable=!1)}},{key:"GetAccountsLinkingXML",value:function(){if(null!=this.dgvAccLinking&&null!=this.dgvAccLinking&&null!=this.dgvAccLinking.Table&&this.dgvAccLinking.Table.length>0){var e="";e+="<Rows>",e+='<Row EmpSeqNo="'+this.NodeID+'" ComponentID="-301" Type="-301" SNo="'+-301,e+=null!=this.plBoxSalaryAccount&&null!=this.plBoxSalaryAccount?'" DebitAccountID="'+this.plBoxSalaryAccount.SelectedValue:'" DebitAccountID="0',e+='" CreditAccountID="0" />',e+='<Row EmpSeqNo="'+this.NodeID+'" ComponentID="-302" Type="-302" SNo="'+-302,e+=null!=this.plBoxPayableAccount&&null!=this.plBoxPayableAccount?'" DebitAccountID="'+this.plBoxPayableAccount.SelectedValue:'" DebitAccountID="0',e+='" CreditAccountID="0" />';for(var t=0;t<this.dgvAccLinking.Table.length;t++)y.e.StringIsNullOrEmpty(this.dgvAccLinking.Table[t].ComponentName)||y.e.StringIsNullOrEmpty(this.dgvAccLinking.Table[t].DebitAccountID_Key)&&y.e.StringIsNullOrEmpty(this.dgvAccLinking.Table[t].CreditAccountID_Key)||(e+='<Row EmpSeqNo="'+this.NodeID+'" ComponentID="'+this.dgvAccLinking.Table[t].ComponentID.toString()+'" Type="'+this.dgvAccLinking.Table[t].ComponentType.toString()+'" SNo="'+this.dgvAccLinking.Table[t].ComponentSNO.toString(),y.e.StringIsNullOrEmpty(this.dgvAccLinking.Table[t].DebitAccountID_Key)?e+='" DebitAccountID="0':e+='" DebitAccountID="'+this.dgvAccLinking.Table[t].DebitAccountID_Key.toString(),y.e.StringIsNullOrEmpty(this.dgvAccLinking.Table[t].CreditAccountID_Key)?e+='" CreditAccountID="0':e+='" CreditAccountID="'+this.dgvAccLinking.Table[t].CreditAccountID_Key.toString(),e+='" />');return e+="</Rows>"}return""}},{key:"OnDeleteCallBack",value:function(){}},{key:"Appraisal_Click",value:function(){this.NodeID>0?(this.AddeditAppraisalViewmodel=new L.a(this,this.NodeID,this.dtpNextAppraisal.Date,0),b.a.page.ShowDialog(this.AddeditAppraisalViewmodel,O.a,{ShowCenter:!0,Title:this.AddeditAppraisalViewmodel.Title})):(this.DisplayMessage="Select any Employee",this.MessageVisibility=!0)}},{key:"btnPrint_Click",value:function(){this.NodeID>0?this.PrintEmployee():(this.DisplayMessage="",this.MessageVisibility=!0)}},{key:"btnPrintPreview_Click",value:function(){this.NodeID>0?this.PrintEmployee():(this.DisplayMessage="",this.MessageVisibility=!0)}},{key:"PrintEmployee",value:function(){var e=this;this.MoreThanOneLayout=!1;var t=this.NodeID;this.IsExportPrint=!1;var i=null,a=x.VoucherExportExcel.GetLocationPrintLayouts(this.CostCenterID,0,t);if(this.IsExportPrint)i=null;else{if(null==a||0==a.Tables[0].length)return b.a.GetResource("Err_PrintLayoutNotDefined");if(a.Tables[0].length>1){this.MoreThanOneLayout=!0;var s=new R.VPTDialogViewModel(a.Tables[0]);b.a.page.ShowDialog(s,_.VPTDialogComponent,{ShowCenter:!0},(function(){s.IsOkClicked&&(i=s.SelectedRow),null!=i&&b.a.report.ExportPDF_Masters(e.CostCenterID,t.toString(),parseInt(i.DocPrintLayoutID),"PDF").subscribe((function(t){b.a.SessionManager.printTab(t.FileName),y.e.IsEmpty(t.Message)&&!y.e.IsEmpty(t.FileName)&&(e.DisplayMessage="Printed Sucessfully")}),(function(t){e.DisplayMessage="Error in Preview",console.log(t)}))}))}else i=a.Tables[0][0]}this.dsTotLayouts=a,this.drSelPrintLayout=i,null==i||this.MoreThanOneLayout||b.a.report.ExportPDF_Masters(this.CostCenterID,t.toString(),parseInt(i.DocPrintLayoutID),"PDF").subscribe((function(t){console.log(t),b.a.SessionManager.Download(t.FileName,"abcd"),b.a.SessionManager.printTab(t.FileName),y.e.IsEmpty(t.Message)&&!y.e.IsEmpty(t.FileName)&&(e.DisplayMessage="printed Successfully")}),(function(t){e.DisplayMessage="Error in Preview",console.log(t)}))}},{key:"ClearOtherControls",value:function(){if(this.ViewEmpDocuments.GridListObj.Clear(),this.LoadPayrollGrid(),this.LoadAppraisalGrid(),this.LoadAccountLinkingGrid(),this.dgvPayrollEar.Columns[2].footer=(0).ToString(this.sDecimalsAmount),this.dgvPayrollDed.Columns[2].footer=(0).ToString(this.sDecimalsAmount),this.dgvPayrollEar.UpdateFooter(),this.dgvPayrollDed.UpdateFooter(),this.ProbationDays.Text=!y.e.StringIsNullOrEmpty(b.a.SessionManager.Preferences.DefaultProbationDays)&&parseInt(b.a.SessionManager.Preferences.DefaultProbationDays)>0?b.a.SessionManager.Preferences.DefaultProbationDays:"0",this.ProbationDays_LostFocus(this.ProbationDays),this.Status.SelectedValue=""!=b.a.SessionManager.Preferences.DefaultEmpStatus?b.a.SessionManager.Preferences.DefaultEmpStatus:"250",null!=this.txtVacDaysPerMonth&&(this.txtVacDaysPerMonth.Currency.SelectedValue=b.a.SessionManager.Preferences.DefVacationDaysMonthlyOrYearly,this.txtVacDaysPerMonth.ExchangeRate.Text=b.a.SessionManager.Preferences.DefVacationDays),this.ScreenObject.CustomTab.Pages.length>0)for(var e=0;e<this.ScreenObject.CustomTab.Pages.length;e++)for(var t=this.ScreenObject.CustomTab.Pages[e],i=0;i<t.Fields.length;i++){var a=t.Fields[i];if(a instanceof n.b&&("CheckInOutDevice"==a.DBColumnName||"AttSetDimNodes"==a.DBColumnName))for(var s=0;s<a.Items.length;s++)a.Items[s].IsChecked=!1;a instanceof j.a&&(a.IsChecked=!1)}if(b.a.SessionManager.Preferences.ContainsKey("DisableEmployeePayrollTabafterPayrollProcessed")&&"True"==b.a.SessionManager.Preferences.DisableEmployeePayrollTabafterPayrollProcessed){for(var l=0;l<this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields.length;l++)this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[l]instanceof h.c&&("BasicMonthly"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[l].DBColumnName&&"BasicWeekly"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[l].DBColumnName&&"BasicDaily"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[l].DBColumnName&&"BasicHourly"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[l].DBColumnName&&"NetSalary"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[l].DBColumnName&&"AnnualCTC"!=this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[l].DBColumnName||(this.ScreenObject.CustomTab.Pages[this.iPayrollTabIndex].Fields[l].IsReadOnly=!1));this.dgvPayrollEar.IsReadOnly=!1,this.dgvPayrollDed.IsReadOnly=!1,this.dgvPayrollAccrual.IsReadOnly=!1}this.RestrictSaveButton()}},{key:"AttSetTypeCheckedChanged",value:function(e){this.GetScreenControl("AttSetDimNodes").Enable="Dimension"==e.DBColumnName}}]),i}(a.b),U=function(){function e(){_classCallCheck(this,e),this.ButtonClick=new h.b,this.DisplayMessage="",this.MessageVisibility=!1,this.CostCenterID=0,this.sDBColumnName="",this.sUserColumnName="",this.dsData=null,this.drLastRow=null,this.IsIdentity=!1,this.IsPaymentMode=!1}return _createClass(e,[{key:"PayIdentityGridViewModel_3",value:function(e,t,i){this.CostCenterID=e,this.sDBColumnName=t,""!=i&&(this.dsData=new y.f,this.dsData.ReadXml(i)),this.ButtonClick.Subscribe(this,"OnButtonClick"),this.dgv=new g.a,this.dgv.OnBeginEdit.Subscribe(this,"dgv_BeginEdit"),this.dgv.OnCellEditEnding.Subscribe(this,"dgv_EndEdit"),this.dgv.CanUserAddRows=!0,this.dgv.Width="",this.dgv.Table=[],50051==e&&("PassportNo"==t||"VisaNo"==t||"IqamaNo"==t||"ContractNo"==t||"IDNo"==t||"LicenseNo"==t||"MedicalNo"==t?(this.IsIdentity=!0,this.Title=t.substring(0,t.length-2)+" Details - History",this.dgv.TableColumns.push("SNo"),this.dgv.TableColumns.push("Number"),this.dgv.TableColumns.push("IssDate"),this.dgv.TableColumns.push("IssDate_Key"),this.dgv.TableColumns.push("ExpDate"),this.dgv.TableColumns.push("ExpDate_Key"),"ContractNo"==t&&(this.dgv.TableColumns.push("ExtendDate"),this.dgv.TableColumns.push("ExtendDate_Key"))):"PaymentMode"==t&&(this.IsPaymentMode=!0,this.Title="Payment Modes",this.dgv.TableColumns.push("SNo"),this.dgv.TableColumns.push("PaymentMode"),this.dgv.TableColumns.push("PaymentMode_Key"),this.dgv.TableColumns.push("iBank"),this.dgv.TableColumns.push("iBank_Key"),this.dgv.TableColumns.push("BankBranch"),this.dgv.TableColumns.push("BankRoutingCode"),this.dgv.TableColumns.push("BankAgentCode"),this.dgv.TableColumns.push("BankAccNo"),this.dgv.TableColumns.push("IBANNo"),this.dgv.TableColumns.push("StatusID")));var a=[],s=new D.a;if(s.Header="#",s.DisplayMember="SNo",s.ID="SNo",s.Width=30,s.ReadOnly=!0,a.push(s),this.IsIdentity)(s=new D.a).Header="Number",s.DisplayMember="Number",s.ID="Number",s.Width=220,a.push(s),(s=new D.a).Header="Iss. Date",s.DisplayMember="IssDate",s.DataType="DATE",s.Width=120,a.push(s),(s=new D.a).Header="Exp. Date",s.DisplayMember="ExpDate",s.DataType="DATE",s.Width=120,a.push(s),"ContractNo"==t&&((s=new D.a).Header="Extend Date",s.DisplayMember="ExtendDate",s.DataType="DATE",s.Width=120,a.push(s));else if(this.IsPaymentMode){(s=new D.a).Header="Mode of Payment",s.ValueBinding="PaymentMode",s.DataType="ComboBox",s.DisplayMember="Name",s.ValueMember="Value",s.Width=150;var l=new Array;l.push(n.d.ComboBoxItems_2("Cash","Cash")),l.push(n.d.ComboBoxItems_2("Cheque","Cheque")),l.push(n.d.ComboBoxItems_2("Bank Transfer","Bank Transfer")),l.push(n.d.ComboBoxItems_2("Demand Draft","Demand Draft")),s.ComboData=l,a.push(s),(s=new D.a).Header="Bank Name",s.DisplayMember="iBank",s.DataType="LISTBOX",s.CostCenterID=50068,s.TypeID=1,s.Width=150,a.push(s),(s=new D.a).Header="Bank Branch",s.DisplayMember="BankBranch",s.DataType="TextBlock",s.Width=120,s.ReadOnly=!0,a.push(s),(s=new D.a).Header="Bank Routing Code",s.DisplayMember="BankRoutingCode",s.DataType="TextBlock",s.Width=120,s.ReadOnly=!0,a.push(s),(s=new D.a).Header="Bank Agent Code",s.DisplayMember="BankAgentCode",s.DataType="TextBlock",s.Width=120,s.ReadOnly=!0,a.push(s),(s=new D.a).Header="Bank Account No.",s.DisplayMember="BankAccNo",s.DataType="TextBlock",s.Width=120,a.push(s),(s=new D.a).Header="IBAN Number",s.DisplayMember="IBANNo",s.DataType="TextBlock",s.Width=120,a.push(s),(s=new D.a).Header="Status",s.ValueBinding="StatusID",s.DataType="ComboBox",s.DisplayMember="Name",s.ValueMember="Value",s.Width=100,(l=new Array).push(n.d.ComboBoxItems_2("Active","1")),l.push(n.d.ComboBoxItems_2("Inactive","2")),s.ComboData=l,a.push(s)}this.dgv.Columns=a,this.Clear(),null!=this.dsData&&null!=this.dsData.Tables&&this.dsData.Tables[0].length>0&&this.Load(this.dsData.Tables[0],this.dsData.Columns[0])}},{key:"dgv_BeginEdit",value:function(e,t,i){return!(!this.IsPaymentMode||"iBank"!=t&&"BankAccNo"!=t&&"IBANNo"!=t||!y.e.IsEmpty(e.PaymentMode)&&"Bank Transfer"==e.PaymentMode.toString())}},{key:"dgv_EndEdit",value:function(e,t,i){try{if(this.IsPaymentMode&&"iBank"==t&&!y.e.IsEmpty(e.iBank_Key)){var a=parseInt(e.iBank_Key),s=b.a.common.GetDataSet("AEEMP004",a.toString());null!=s&&s.Tables.length>0&&s.Tables[0].length>0&&(e.BankBranch=s.Tables[0][0].ccAlpha2.toString(),e.BankRoutingCode=s.Tables[0][0].ccAlpha8.toString(),e.BankAgentCode=s.Tables[0][0].ccAlpha7.toString()),this.dgv.updateRow(e)}}catch(n){}}},{key:"OnButtonClick",value:function(e){if("Cancel"==e)this.DialogResult=!1;else if("OK"==e){if(this.IsIdentity)for(var t=0;t<this.dgv.Table.length;t++){if(!y.e.IsEmpty(this.dgv.Table[t].Number)&&""!=this.dgv.Table[t].Number.toString().Trim()&&!y.e.IsEmpty(this.dgv.Table[t].IssDate_Key)&&this.dgv.Table[t].IssDate_Key.toString().length>0&&!y.e.IsEmpty(this.dgv.Table[t].ExpDate_Key)&&this.dgv.Table[t].ExpDate_Key.toString().length>0&&new Date(this.dgv.Table[t].IssDate_Key)>new Date(this.dgv.Table[t].ExpDate_Key))return this.DisplayMessage="ExpDate Should be greater than IssDate",void(this.MessageVisibility=!0);var i=this.GetLastConsideredRow(t);if(t>0&&i>-1&&!y.e.IsEmpty(this.dgv.Table[i].ExpDate_Key)&&!y.e.IsEmpty(this.dgv.Table[t].IssDate_Key)&&new Date(this.dgv.Table[t].IssDate_Key)<new Date(this.dgv.Table[i].ExpDate_Key))return this.DisplayMessage="IssDate Should be greater than "+new Date(this.dgv.Table[i].ExpDate_Key).ToString("dd MMM yyyy"),void(this.MessageVisibility=!0)}else if(this.IsPaymentMode){for(var a=0,s=0,n=0;n<this.dgv.Table.length;n++)y.e.IsEmpty(this.dgv.Table[n].PaymentMode)||""==this.dgv.Table[n].PaymentMode.toString().Trim()||(s++,y.e.IsEmpty(this.dgv.Table[n].StatusID)||"1"!=this.dgv.Table[n].StatusID.toString()||1==++a&&(this.drLastRow=this.dgv.Table[n]));if(0==s)return this.DisplayMessage="Enter atlest one Payment Mode",void(this.MessageVisibility=!0);if(0==a)return this.DisplayMessage="Set atleast one Payment Mode as Active",void(this.MessageVisibility=!0);if(a>1)return this.DisplayMessage="You can not set morethan one Payment Mode as Active",void(this.MessageVisibility=!0);for(var l=0;l<this.dgv.Table.length;l++)if(!y.e.IsEmpty(this.dgv.Table[l].PaymentMode)&&"Bank Transfer"==this.dgv.Table[l].PaymentMode.toString().Trim()&&y.e.IsEmpty(this.dgv.Table[l].iBank_Key))return this.DisplayMessage="Select Bank Name at Row No. "+(l+1),void(this.MessageVisibility=!0)}this.DialogResult=!0}b.a.page.HideDialog()}},{key:"Load",value:function(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.dgv.Table.Clear();for(var a=0;a<e.length;a++){var s=this.dgv.NewRow();if(s.SNo=a+1,this.IsIdentity)s.Number=e[a].Number,i.Contains("IssDate")&&!y.e.IsEmpty(e[a].IssDate)&&(s.IssDate=new Date(e[a].IssDate).ToString(b.a.SessionManager.Preferences["Date Format"]),s.IssDate_Key=new Date(e[a].IssDate)),i.Contains("ExpDate")&&!y.e.IsEmpty(e[a].ExpDate)&&(s.ExpDate=new Date(e[a].ExpDate).ToString(b.a.SessionManager.Preferences["Date Format"]),s.ExpDate_Key=new Date(e[a].ExpDate)),i.Contains("ExtendDate")&&!y.e.IsEmpty(e[a].ExtendDate)&&(s.ExtendDate=new Date(e[a].ExtendDate).ToString(b.a.SessionManager.Preferences["Date Format"]),s.ExtendDate_Key=new Date(e[a].ExtendDate));else if(this.IsPaymentMode){if(s.PaymentMode=e[a].PaymentMode,s.iBank_Key=e[a].iBank.toString(),!y.e.IsEmpty(s.iBank_Key)&&""!=s.iBank_Key.toString().Trim()&&parseInt(s.iBank_Key)>0){var n=b.a.common.GetDataSet("AEEMP004",s.iBank_Key.toString());null!=n&&n.Tables.length>0&&n.Tables[0].length>0&&(s.BankBranch=n.Tables[0][0].ccAlpha2.toString(),s.BankRoutingCode=n.Tables[0][0].ccAlpha8.toString(),s.BankAgentCode=n.Tables[0][0].ccAlpha7.toString())}s.BankAccNo=e[a].BankAccNo.toString(),s.IBANNo=e[a].IBANNo.toString(),s.StatusID=e[a].StatusID}this.dgv.addRow(s)}this.dgv.RefreshGrid=!0;for(var l=0;l<10;l++)(t=this.dgv.NewRow()).SNo=e.length+l+1,this.dgv.addRow(t)}},{key:"Clear",value:function(){var e;this.dgv.Table.Clear();for(var t=0;t<10;t++)(e=this.dgv.NewRow()).SNo=t+1,this.dgv.addRow(e)}},{key:"GetXML",value:function(){var e=this,t="",i=0;return this.dgv.Table.forEach((function(a){if(50051==e.CostCenterID)if(i++,e.IsIdentity){if(!y.e.IsEmpty(a.Number)){t+='<Row Number="'+a.Number.toString()+'"',!y.e.IsEmpty(a.IssDate_Key)&&a.IssDate_Key.toString().length>0&&(t+=' IssDate="'+new Date(a.IssDate_Key).ToString("dd MMM yyyy")+'"',!y.e.IsEmpty(a.ExpDate_Key)&&a.ExpDate_Key.toString().length>0&&(t+=' ExpDate="'+new Date(a.ExpDate_Key).ToString("dd MMM yyyy")+'"'),"ContractNo"==e.sDBColumnName&&!y.e.IsEmpty(a.ExtendDate_Key)&&a.ExtendDate_Key.toString().length>0&&(t+=' ExtendDate="'+new Date(a.ExtendDate_Key).ToString("dd MMM yyyy")+'"'));var s="";"PassportNo"==e.sDBColumnName?s="-51001":"VisaNo"==e.sDBColumnName?s="-51002":"IqamaNo"==e.sDBColumnName?s="-51003":"ContractNo"==e.sDBColumnName?s="-51004":"IDNo"==e.sDBColumnName?s="-51005":"LicenseNo"==e.sDBColumnName?s="-51006":"MedicalNo"==e.sDBColumnName&&(s="-51007"),t+=' DType="'+s+'"',t+=' sDType="'+e.sDBColumnName.substring(0,e.sDBColumnName.length-2)+'"',t+=' SNo="'+i+'"',t+="/>",e.drLastRow=a}}else e.IsPaymentMode&&(y.e.IsEmpty(a.PaymentMode)||""==a.PaymentMode.toString().Trim()||(t+='<Row PaymentMode="'+a.PaymentMode.toString()+'"',!y.e.IsEmpty(a.iBank_Key)&&a.iBank_Key.toString().length>0?t+=' iBank="'+a.iBank_Key.toString()+'"':t+=' iBank="0"',!y.e.IsEmpty(a.BankAccNo)&&a.BankAccNo.toString().length>0?t+=' BankAccNo="'+a.BankAccNo.toString()+'"':t+=' BankAccNo=""',!y.e.IsEmpty(a.IBANNo)&&a.IBANNo.toString().length>0?t+=' IBANNo="'+a.IBANNo.toString()+'"':t+=' IBANNo=""',!y.e.IsEmpty(a.StatusID)&&a.StatusID.toString().length>0?t+=' StatusID="'+a.StatusID.toString()+'"':t+=' StatusID="2"',t+=' DType="-51011"',t+=' sDType="PaymentMode"',t+=' SNo="'+i+'"',t+="/>",!y.e.IsEmpty(a.StatusID)&&a.StatusID.toString().length>0&&"1"==a.StatusID.toString()&&(e.drLastRow=a)))})),t.length>0&&(t="<XML>"+t+"</XML>"),t.toString()}},{key:"GetLastConsideredRow",value:function(e){for(var t=e-1;t>=0;t--)if(!y.e.IsEmpty(this.dgv.Table[t].Number))return t;return-1}}]),e}()},wJuo:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var a=i("Do2H"),s=i("Lp6j"),n=i("eQJW"),l=i("4HhE"),o=i("OvA8"),r=i("xnJf"),d=function(){function e(){_classCallCheck(this,e),this.parent=null,this.SubmitClick=new l.b,this._AttachmentVisibility=!1,this.ClassName="PopupAttachmentsViewModel"}return _createClass(e,[{key:"OnShowAttachment",value:function(){Logger.InfoLog("AddProductViewModel::Entering OnShowAttachment"),Logger.InfoLog("AddProductViewModel::Exiting OnShowAttachment")}},{key:"OnAddAttachment",value:function(){Logger.InfoLog("AddProductViewModel::Entering AddAttachment"),this.Attachment=new r.AddAttachmentViewModel,this.Attachment.AddAttachmentViewModel_2(this),Logger.InfoLog("AddProductViewModel::Entering AddAttachment")}},{key:"PopupAttachmentsViewModel_1",value:function(e,t,i){var a,l,d,c=this;this.parent=i,this.AttachmentVisibility=!0,this.OnAddAttachment(),this.CostCenterID=e,this.NID=t,this._ViewAttachments=new o.ViewAttachmentViewModel(this),this.SubmitClick.Subscribe(this,"ListAttachments");var h=0,u="",m="";if("AddProductScreenViewModel"==(null===(a=this.parent)||void 0===a?void 0:a.ClassName)?(h=i.FileID,u=i.ProductPhoto,m=i.FileDescription):"AddEditAccountViewModel"==(null===(l=this.parent)||void 0===l?void 0:l.ClassName)||"AddUsersViewModel"==(null===(d=this.parent)||void 0===d?void 0:d.ClassName)?(h=i.FileID,u=i.AccountPhoto):(h=this.parent.FileID,u=this.parent.AccountPhoto,m=this.parent.FileDescription),null!=i){if(!s.e.IsEmpty(u)){var p=new r.AddAttachmentViewModel;if(p.AddAttachmentViewModel_2(this),p.AttachmentID=h,h>0){var g=null;"AddProductScreenViewModel"==this.parent.ClassName||"AddEditAccountViewModel"==this.parent.ClassName?g=i.ds.Tables[4].filter((function(e){return e.FileID==h})):"AddUsersViewModel"==this.parent.ClassName||"AddCostCenterViewModel"==this.parent.ClassName?g=this.parent.ds.Tables[3].filter((function(e){return e.FileID==h})):"AddEditEmpMasterViewModel"==this.parent.ClassName?g=this.parent.dsEdit.Tables[3].filter((function(e){return e.FileID==h})):"AddEditPropertyViewModel"==i.ClassName?g=i.ds.Tables[18].filter((function(e){return e.FileID==h})):"AddEditUnitsViewModel"==i.ClassName?g=i.ds.Tables[6].filter((function(e){return e.FileID==h})):"AddEditTenantViewModel"==i.ClassName&&(g=i.Dset.Tables[4].filter((function(e){return e.FileID==h}))),g.length>0&&(p.ActualFileName=g[0].ActualFileName.toString(),p.FileExtension=g[0].FileExtension.toString(),p.FileDescription=g[0].FileDescription.toString(),p.FilePath="",p.Guid=g[0].GUID.toString(),p.RelativeFileName=g[0].RelativeFileName.toString(),p.MainFilePath=g[0].FilePath.toString(),p.IsProductImage=!0,p.IsDefaultImage=!0,p.IsDefaultImageVisible=!0,p.CancelVisible=!1,p.Guid=g[0].GUID.toString(),s.e.hasprop(g[0],"HasThumb")&&(p.HasThumb=Object(n.j)(g[0].HasThumb)))}else{p.FilePath=u,p.MainFilePath=u,p.RelativeFileName=u,p.ActualFileName=p.FilePath.substr(p.FilePath.lastIndexOf("\\")+1);var D=p.FilePath.split("."),y="";D.length>1&&(y=D[D.length-1]),p.FileExtension=y,p.FileDescription=m,p.IsProductImage=!0,p.IsDefaultImage=!0,p.IsDefaultImageVisible=!0,p.CancelVisible=!1,p.Guid=this.parent.guid}this.ViewAttachments.AttachmentsList.push(p)}var b=[];(s.e.IsType(i,"IAttachment")||s.e.hasprop(i,"ViewAttachments"))&&(b=this.parent.ViewAttachments.AttachmentsList),b.forEach((function(e){if(e.IsProductImage){var t=new r.AddAttachmentViewModel;t.AddAttachmentViewModel_2(c),t.AttachmentID=e.AttachmentID,t.ActualFileName=e.ActualFileName,t.FileExtension=e.FileExtension,t.FileDescription=e.FileDescription,t.MainFilePath=e.MainFilePath,t.FilePath=e.FilePath,t.Guid=e.guid,t.RelativeFileName=e.RelativeFileName,t.IsProductImage=e.IsProductImage,t.IsDefaultImage=e.IsDefaultImage,t.IsDefaultImageVisible=!0,t.HasThumb=e.HasThumb,c.ViewAttachments.AttachmentsList.push(t)}}))}}},{key:"ListAttachments",value:function(e){var t=this;if("Submit"==e.toString()){if("AddProductScreenViewModel"==this.parent.ClassName){var i=0;this.ViewAttachments.AttachmentsList.forEach((function(e){var a=t.parent.ViewAttachments.AttachmentsList.filter((function(t){return t.RelativeFileName==e.RelativeFileName}));e.IsDefaultImage?(i++,null!=a&&a.length>0&&t.parent.ViewAttachments.AttachmentsList.Remove(a),(s.e.IsEmpty(e.FilePath)||t.parent.ProductPhoto==e.FilePath)&&t.parent.ProductPhoto.Contains(s.e.GetPath(e.guid+"."+e.FileExtension))||(t.parent.FileID=e.AttachmentID,t.parent.ProductPhoto=s.e.IsEmpty(e.guid)?e.FilePath:s.e.GetPath(e.guid+"."+e.FileExtension),t.parent.ActualFileName=e.ActualFileName,t.parent.ThumbnailPhoto=e.ThumbnailPhoto,t.parent.guid=e.guid,t.parent.Guid=e.guid,t.parent.FileExtension=e.FileExtension,t.parent.IsPhotoChanged=!0,t.parent.PhotoTextVisibility=!1,t.parent.DisplayMessage="",t.parent.MessageVisibility=!1,t.parent.FileDescription=e.FileDescription),e.IsModified=!0):null==a||0==a.length?(e.AttachmentID>0?(e.IsModified=!0,null!=(a=t.parent.ViewAttachments.AttachmentsList.filter((function(t){return t.AttachmentID==e.AttachmentID})))&&t.parent.ViewAttachments.AttachmentsList.Remove(a)):(e.IsModified=!1,e._Flg=!0),t.parent.ViewAttachments.AttachmentsList.push(e)):(a.FileDescription=e.FileDescription,a.IsModified=!0)})),0==i&&(this.parent.ProductPhoto="",this.parent.ActualFileName="",this.parent.ThumbnailPhoto="",this.parent.IsPhotoChanged=!1,this.parent.IsPhotoDelete=!1,this.parent.DialogResult=!1,this.parent.PhotoTextVisibility=!0,this.parent.DisplayMessage="",this.parent.FileDescription=""),this.ViewAttachments.DeletedAttachments.forEach((function(e){t.parent.ViewAttachments.DeletedAttachments.push(e);var i=t.parent.ViewAttachments.AttachmentsList.find((function(t){return t.AttachmentID==e.AttachmentID}));null!=i&&t.parent.ViewAttachments.AttachmentsList.Remove(i)}))}else if("AddEditAccountViewModel"==this.parent.ClassName){var n=0;this.ViewAttachments.AttachmentsList.forEach((function(e){var i=t.parent.ViewAttachments.AttachmentsList.filter((function(t){return t.RelativeFileName==e.RelativeFileName}));e.IsDefaultImage?(n++,null!=i&&i.length>0&&t.parent.ViewAttachments.AttachmentsList.Remove(i),(s.e.IsEmpty(e.FilePath)||t.parent.AccountPhoto==e.FilePath)&&t.parent.AccountPhoto.Contains(s.e.GetPath(e.guid+"."+e.FileExtension))||(t.parent.FileID=e.AttachmentID,t.parent.AccountPhoto=s.e.IsEmpty(e.guid)?e.FilePath:s.e.GetPath(e.guid+"."+e.FileExtension),t.parent.ActualFileName=e.ActualFileName,t.parent.guid=e.guid,t.parent.Guid=e.guid,t.parent.FileExtension=e.FileExtension,t.parent.IsPhotoChanged=!0,t.parent.PhotoTextVisibility=!1,t.parent.DisplayMessage="",t.parent.MessageVisibility=!1),e.IsModified=!0):null==i||0==i.length?(e.AttachmentID>0?(e.IsModified=!0,null!=(i=t.parent.ViewAttachments.AttachmentsList.filter((function(t){return t.AttachmentID==e.AttachmentID})))&&t.parent.ViewAttachments.AttachmentsList.Remove(i)):(e.IsModified=!1,e._Flg=!0),t.parent.ViewAttachments.AttachmentsList.push(e)):(i.FileDescription=e.FileDescription,i.IsModified=!0)})),0==n&&(this.parent.AccountPhoto="",this.parent.ActualFileName="",this.parent.IsPhotoChanged=!1,this.parent.IsPhotoDelete=!1,this.parent.PhotoTextVisibility=!0,this.parent.DisplayMessage=""),this.ViewAttachments.DeletedAttachments.forEach((function(e){t.parent.ViewAttachments.DeletedAttachments.push(e);var i=t.parent.ViewAttachments.AttachmentsList.filter((function(t){return t.AttachmentID==e.AttachmentID}));null!=i&&t.parent.ViewAttachments.AttachmentsList.Remove(i)}))}else if("AddUsersViewModel"==this.parent.ClassName){var l=0;this.ViewAttachments.AttachmentsList.forEach((function(e){var i=t.parent.ViewAttachments.AttachmentsList.filter((function(t){return t.RelativeFileName==e.RelativeFileName}));e.IsDefaultImage?(l++,null!=i&&i.length>0&&t.parent.ViewAttachments.AttachmentsList.Remove(i),(s.e.IsEmpty(e.FilePath)||t.parent.AccountPhoto==e.FilePath)&&t.parent.AccountPhoto.Contains(s.e.GetPath(e.guid+"."+e.FileExtension))||(t.parent.FileID=e.AttachmentID,t.parent.AccountPhoto=s.e.IsEmpty(e.guid)?e.FilePath:s.e.GetPath(e.guid+"."+e.FileExtension),t.parent.ActualFileName=e.ActualFileName,t.parent.IsPhotoChanged=!0,t.parent.PhotoTextVisibility=!1,t.parent.DisplayMessage="",t.parent.MessageVisibility=!1),e.IsModified=!0):null==i||0==i.length?(e.AttachmentID>0?(e.IsModified=!0,null!=(i=t.parent.ViewAttachments.AttachmentsList.filter((function(t){return t.AttachmentID==e.AttachmentID})))&&t.parent.ViewAttachments.AttachmentsList.Remove(i)):(e.IsModified=!1,e._Flg=!0),t.parent.ViewAttachments.AttachmentsList.push(e)):(i.FileDescription=e.FileDescription,i.IsModified=!0)})),0==l&&(this.parent.AccountPhoto="",this.parent.ActualFileName="",this.parent.IsPhotoChanged=!1,this.parent.IsPhotoDelete=!1,this.parent.DialogResult=!1,this.parent.PhotoTextVisibility=!0,this.parent.DisplayMessage=""),this.ViewAttachments.DeletedAttachments.forEach((function(e){t.parent.ViewAttachments.DeletedAttachments.push(e);var i=t.parent.ViewAttachments.AttachmentsList.find((function(t){return t.AttachmentID==e.AttachmentID}));i&&t.parent.ViewAttachments.AttachmentsList.Remove(i)}))}else if("AddCostCenterViewModel"==this.parent.ClassName){var o=0;this.ViewAttachments.AttachmentsList.forEach((function(e){var i=t.parent.ViewAttachments.AttachmentsList.filter((function(t){return t.RelativeFileName==e.RelativeFileName}));e.IsDefaultImage?(o++,null!=i&&i.length>0&&t.parent.ViewAttachments.AttachmentsList.Remove(i),(s.e.IsEmpty(e.FilePath)||t.parent.AccountPhoto==e.FilePath)&&t.parent.AccountPhoto.Contains(s.e.GetPath(e.guid))||(t.parent.FileID=e.AttachmentID,t.parent.AccountPhoto=s.e.IsEmpty(e.guid)?e.FilePath:s.e.GetPath(e.guid),t.parent.ThumbnailPhoto=e.ThumbnailPhoto,t.parent.ActualFileName=e.ActualFileName,t.parent.guid=e.guid,t.parent.Guid=e.guid,t.parent.FileExtension=e.FileExtension,t.parent.IsPhotoChanged=!0,t.parent.PhotoTextVisibility=!1,t.parent.DisplayMessage="",t.parent.MessageVisibility=!1),e.IsModified=!0):null==i||0==i.length?(e.AttachmentID>0?(e.IsModified=!0,null!=(i=t.parent.ViewAttachments.AttachmentsList.filter((function(t){return t.AttachmentID==e.AttachmentID})))&&t.parent.ViewAttachments.AttachmentsList.Remove(i)):(e.IsModified=!1,e._Flg=!0),t.parent.ViewAttachments.AttachmentsList.push(e)):(i.FileDescription=e.FileDescription,i.IsModified=!0)})),0==o&&(this.parent.AccountPhoto="",this.parent.ThumbnailPhoto="",this.parent.ActualFileName="",this.parent.IsPhotoChanged=!1,this.parent.IsPhotoDelete=!1,this.parent.PhotoTextVisibility=!0,this.parent.DisplayMessage=""),this.ViewAttachments.DeletedAttachments.forEach((function(e){t.parent.ViewAttachments.DeletedAttachments.push(e);var i=t.parent.ViewAttachments.AttachmentsList.find((function(t){return t.AttachmentID==e.AttachmentID}));i&&t.parent.ViewAttachments.AttachmentsList.Remove(i)}))}else if("AddEditEmpMasterViewModel"==this.parent.ClassName||"AddEditPropertyViewModel"==this.parent.ClassName||"AddEditUnitsViewModel"==this.parent.ClassName||"AddEditTenantViewModel"==this.parent.ClassName){var r=0;this.ViewAttachments.AttachmentsList.forEach((function(e){var i=t.parent.ViewAttachments.AttachmentsList.filter((function(t){return t.RelativeFileName==e.RelativeFileName}));e.IsDefaultImage?(r++,null!=i&&t.parent.ViewAttachments.AttachmentsList.Remove(i),(s.e.IsEmpty(e.FilePath)||t.parent.AccountPhoto==e.FilePath)&&t.parent.AccountPhoto.Contains(s.e.GetPath(e.guid+"."+e.FileExtension))||(t.parent.FileID=e.AttachmentID,t.parent.AccountPhoto=s.e.IsEmpty(e.guid)?e.FilePath:s.e.GetPath(e.guid+"."+e.FileExtension),t.parent.ActualFileName=e.ActualFileName,t.parent.IsPhotoChanged=!0,t.parent.PhotoTextVisibility=!1,t.parent.EmpAttachmentguid=e.guid.toString(),t.parent.DisplayMessage="",t.parent.FileExtension=e.FileExtension,t.parent.MessageVisibility=!1,t.parent.FileDescription=e.FileDescription),e.IsModified=!0):null==i||0==i.length?(e.AttachmentID>0?(e.IsModified=!0,null!=(i=t.parent.ViewAttachments.AttachmentsList.filter((function(t){return t.AttachmentID==e.AttachmentID})))&&t.parent.ViewAttachments.AttachmentsList.Remove(i)):(e.IsModified=!1,e._Flg=!0),t.parent.ViewAttachments.AttachmentsList.push(e)):(i.FileDescription=e.FileDescription,i.IsModified=!0)})),0==r&&(this.parent.AccountPhoto="",this.parent.ActualFileName="",this.parent.IsPhotoChanged=!1,this.parent.IsPhotoDelete=!1,this.parent.PhotoTextVisibility=!0,this.parent.DisplayMessage="",this.parent.FileDescription=""),this.ViewAttachments.DeletedAttachments.forEach((function(e){t.parent.ViewAttachments.DeletedAttachments.push(e);var i=t.parent.ViewAttachments.AttachmentsList.filter((function(t){return t.AttachmentID==e.AttachmentID}));null!=i&&t.parent.ViewAttachments.AttachmentsList.Remove(i)}))}a.a.page.HideDialog()}else a.a.page.HideDialog()}},{key:"ProductPhoto",get:function(){return this._ProductPhoto},set:function(e){e!=this._ProductPhoto&&(this._ProductPhoto=e)}},{key:"AttachmentVisibility",get:function(){return this._AttachmentVisibility},set:function(e){e!=this._AttachmentVisibility&&(this._AttachmentVisibility=e)}},{key:"Attachment",get:function(){return this._Attachment},set:function(e){e!=this._Attachment&&(this._Attachment=e)}},{key:"ViewAttachments",get:function(){return this._ViewAttachments},set:function(e){e!=this._ViewAttachments&&(this._ViewAttachments=e)}}]),e}()}}]);