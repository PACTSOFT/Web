(window.webpackJsonp=window.webpackJsonp||[]).push([[61,141,150,160],{EggS:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var s=i("Do2H"),n=i("Lp6j"),a=i("eQJW");class o{constructor(){this.CustomerID=0,this.CustomerTypeID=0,this.StatusID=0,this.AccountID=0,this.ParentID=0,this.SelectedNodeID=0,this.CodeNumber=0,this.IsGroup=!1,this.CreditDays=0,this.CreditLimit=0,this.DebitDays=0,this.Debitlimit=0,this.IsCode=!1,this.ActivityXml="",this.CCXML=""}SaveCustomerQuick(){try{let e=[];return e.push(this.CustomerID),e.push(null!=this.CustomerCode?this.CustomerCode:""),e.push(null!=this.CustomerName?this.CustomerName:""),e.push(this.StatusID),e.push(this.CodePrefix),e.push(this.CodeNumber),e.push(this.StaticFieldsQuery),e.push(this.CustomFieldsQuery),e.push(this.CustomCostCenterFieldsQuery),e.push(s.a.SessionManager.CompanyGUID),e.push(this.GUID),e.push(""),e.push(s.a.SessionManager.UserName),e.push(s.a.SessionManager.RoleID),e.push(s.a.SessionManager.LanguageID),s.a.crmService.SetCustomerQuick(e)}catch(e){return Logger.ErrorLog("Account:: SaveAccountQuick"+e.stack),""}}SaveCustomer(){Logger.InfoLog("Customer:: Inside SaveCustomer");try{0==this.CustomerID&&(this.GUID=n.e.NewGuid());let e=[];return e.push(this.CustomerID),e.push(null!=this.CustomerCode?this.CustomerCode:""),e.push(null!=this.CustomerName?this.CustomerName:""),e.push(null!=this.AliasName?this.AliasName:""),e.push(this.CustomerTypeID),e.push(this.StatusID),e.push(this.AccountID),e.push(this.SelectedNodeID),e.push(this.IsGroup),e.push(this.CreditDays),e.push(this.CreditLimit),e.push(null!=this.UserName?this.UserName:""),e.push(null!=this.Password?this.Password:""),e.push(null!=this.OnlineCustType?this.OnlineCustType:""),e.push(s.a.SessionManager.CompanyGUID),e.push(null!=this.GUID?this.GUID:"GUID"),e.push(""),e.push(s.a.SessionManager.UserName),e.push(this.CustomFieldsQuery),e.push(this.CustomCostCenterFieldsQuery),e.push(this.ContactsXML),e.push(this.AttachmetsXML),e.push(this.NotesXML),e.push(this.AddressXML),e.push(this.ActivityXml),e.push(this.CCXML),e.push(!1),e.push(null==this.PrimaryContactQuery?"":this.PrimaryContactQuery),e.push(s.a.SessionManager.RoleID),e.push(s.a.SessionManager.LanguageID),e.push(null!=this.CodePrefix?this.CodePrefix:""),e.push(this.CodeNumber),e.push(this.IsCode),s.a.crmService.SaveCustomer(e)}catch(e){return Logger.ErrorLog("Customer:: SaveCustomer"+e.stack),""}}GetCustomerDetails(){let e=s.a.crmService.GetCustomerInfo("?UserID="+s.a.SessionManager.UserID+"&RoleID="+s.a.SessionManager.RoleID+"&LangID="+s.a.SessionManager.LangID+"&CustomerID="+this.CustomerID);return!e.Columns[0].Contains("ErrorMessage")&&e.Tables.length>0&&e.Tables[0].length>0&&(this.CustomerID=parseInt(e.Tables[0][0].CustomerID),this.CustomerCode=n.e.String(e.Tables[0][0].CustomerCode),this.CustomerName=n.e.String(e.Tables[0][0].CustomerName),this.AliasName=n.e.String(e.Tables[0][0].AliasName),n.e.IsEmpty(e.Tables[0][0].CustomerTypeID)||(this.CustomerTypeID=parseInt(e.Tables[0][0].CustomerTypeID)),this.StatusID=parseInt(e.Tables[0][0].StatusID),n.e.IsEmpty(e.Tables[0][0].AccountID)||(this.AccountID=parseInt(e.Tables[0][0].AccountID)),this.IsGroup=Object(a.j)(e.Tables[0][0].IsGroup),n.e.IsEmpty(e.Tables[0][0].CreditDays)||(this.CreditDays=parseInt(e.Tables[0][0].CreditDays)),n.e.IsEmpty(e.Tables[0][0].CreditLimit)||(this.CreditLimit=parseFloat(e.Tables[0][0].CreditLimit)),this.ParentID=parseInt(e.Tables[0][0].ParentID),this.GUID=n.e.String(e.Tables[0][0].GUID),this.Description=n.e.String(e.Tables[0][0].Description),this.CodePrefix=n.e.String(e.Tables[0][0].CodePrefix),this.UserName=n.e.String(e.Tables[0][0].UserName),this.OnlineCustType=n.e.String(e.Tables[0][0].OnlineCustType),this.Password=n.e.String(e.Tables[0][0].Password),n.e.IsEmpty(e.Tables[0][0].CodeNumber)||(this.CodeNumber=parseInt(e.Tables[0][0].CodeNumber))),e}DeleteCustomer(e,t){try{let i=[];return i.push(e),i.push(t),i.push(s.a.SessionManager.RoleID),i.push(s.a.SessionManager.LanguageID),Logger.InfoLog("Customer:: Success: DBH.DeleteCustomer "+e.toString()),s.a.crmService.RemoveCustomer(i)}catch(i){return Logger.ErrorLog("LEAD::DeleteLead"+i.stack),""}}}},NipM:function(e,t,i){"use strict";i.r(t),i.d(t,"BulkEditViewModel",(function(){return T})),i.d(t,"BulkEditFilter",(function(){return b})),i.d(t,"BulkEditReplace",(function(){return E}));var s=i("mrSG"),n=i("Do2H"),a=i("Lp6j"),o=i("vTM8"),r=i("eQJW"),l=i("NkMH"),h=i("JIg3"),D=i("EQd/"),u=i("ScVY"),d=i("8B8H"),C=i("ockk"),c=i("0/4Q"),m=i("mvPR"),p=i("uMy8"),I=i("ThYU"),g=i("w8Sz"),S=i("XJLh"),y=i("BJEe");class T extends u.b{constructor(e,t=null){super(),this.ButtonApprove=new l.a,this.AppMessageVisibility=!1,this._AppDisplayMessage="",this.Remarks=new D.d(0),this.AppRejDate=new h.a(0),this.SuspendVisiblity=!1,this.CostCenterName="",this.DisplayName="",this.Title="",this.ReplaceVisibility=!1,this.DeleteVisibility=!1,this.ShowRightPanel=!0,this.SaveButtonVisible=!1,this.IsBarcode=!1,this.HideTitle=!1,this.Replace=null,this.IsLWApproval=!1,this.ID=0,this.CostCenterID=0,this.MainTableName="",this.dvFields=null,this.dvFieldsNew=null,this.IsDetailVoucher=!1,this.IsSelectOnRowLeave=!0,this.IsApproval=!1,this.IsProductExists=!1,this.HideFilterDialog=!1,this.HideProductImage=!1,this.ShowFilter=!1,this.RemarksApprove=!1,this.RemarksReject=!1,this.RemarksSuspend=!1,this.SelectedFields=[],this.DateColIDs=new Array,this.EditColumns=new Array,this.EditColumnsDr=[],this.Entities=new o.a,this.ProductImageVisibility=!1,this.ApproveVisibility=!1,this.PhotoTextVisibility=!1,this.ProductID=0,this.ProductPhoto="",this.ReportID=0,this.DB=null,this.IsDocument=!1,this.PrimaryKey="",this.PrimaryColumns="",this.ReportObj=null,this.Report=[],this.AddressFields=new Array,this.docAllowCols=["billno","billdate","linenarration","commonnarration","chequenumber","chequematuritydate"],this.ReportFilterVisible=!1,this.oDocPayroll=null,this.vnofield="",this.cprimary=null,this.strVoucherNo="VoucherNo",this.dicBarLayouts=new o.a,this.ClassName="BulkEditViewModel",this.FromDate=new h.a,this.FromDate.Label=n.a.GetResource("Calender_FromDate"),this.ToDate=new h.a,this.ToDate.Label=n.a.GetResource("Calender_ToDate"),this.FromDate.CustomFormat=n.a.SessionManager.Preferences["Date Format"],this.ToDate.CustomFormat=n.a.SessionManager.Preferences["Date Format"],this.FromDate.Date=new Date(n.a.SessionManager.AccountingDate),this.ToDate.Date=new Date,this.DateRanges=g.a.getDateRanges(),this.DateRanges.SelectionChangedCommand.Subscribe(this,"OnDateRangesSelectionChanged"),this.AppRejDate.CustomFormat=n.a.SessionManager.Preferences["Date Format"],this.AppRejDate.Date=new Date,this.ID=e,this.DB=t,this.InitGrids(),this.EditGrid.SelectAll.Visible=!0,this.Margin="2",null!=t&&(this.HideFilterDialog=!0,this.ShowRightPanel=!1,this.HideTitle=!0,this.EditGrid.SearchCols.Width="140",this.EditGrid.SearchOptions.Width="100",this.EditGrid.SearchText.Width="130",this.Margin="2"),this.HideFilterDialog&&(this.ReportFilterVisible=!1,this.EditGrid.Visible=!0,(null!=this.ReportObj&&this.ReportObj.IsDefaultSortColumnExists||n.a.SessionManager.IsWebApplication)&&(this.bgWorker_DoWork(null,null),this.bgWorker_RunWorkerCompleted(null,null)))}get AppDisplayMessage(){return this._AppDisplayMessage}set AppDisplayMessage(e){e!=this._AppDisplayMessage&&(this._AppDisplayMessage=e,this.AppMessageVisibility=!a.e.IsEmpty(this._AppDisplayMessage))}bgWorker_DoWork(e,t){null!=this.ReportObj?null!=this.ReportObj.oReportDialog?this.ReportObj.oReportDialog.OnOkClick("OK"):this.ReportObj.Filter.OnButtonClick("OK"):this.RefreshData()}bgWorker_RunWorkerCompleted(e,t){this.DisplayName=this.Title,null==this.DB&&this.HideFilterDialog&&null!=this.EditGrid.Table&&0==this.EditGrid.Table.length&&(this.DisplayMessage="No Data Available.")}AddAddressColumns(e,t){let i,s=["ContactPerson","Address1","Address2","Address3","City","State","Zip","Country","Phone1","Phone2","Fax","Email1","Email2","URL","AddressName"],n="Account",a=e.filter(e=>e.CostCenterID==t);a.length>0&&(n=a[0].CostCenterName.toString());for(let o=0;o<s.length;o++)i={},i.SysTableName="COM_Address",i.UserColumnName=i.SysColumnName=s[o],i.ColumnCostCenterID=i.CostCenterID=t,i.CostCenterName=n,i.CostCenterColID=4e5+o+200*t,i.IsForeignKey=!1,i.IsColumnUserDefined=!1,e.push(i)}InitGrids(){this.SaveButtonVisible=!0;let e=n.a.common.BulkEditDetals(6,this.ID,0);this.CostCenterID=parseInt(e.Tables[0][0].CostCenterID),this.DisplayName=a.e.String(e.Tables[0][0].Name),this.Title=this.DisplayName,this.MainTableName=a.e.String(e.Tables[1][0].TableName),this.CostCenterName=a.e.String(e.Tables[1][0].Name);let t=n.a.common.BulkEditDetals(2,0,this.CostCenterID);2==this.CostCenterID&&this.AddAddressColumns(t.Tables[0],this.CostCenterID);let i=new a.f;i.LoadXml(a.e.String(e.Tables[0][0].Options)),this.IsSelectOnRowLeave=null!=i.SelectSingleNode("XML/SelectOnRowLeave"),this.IsDetailVoucher=null!=i.SelectSingleNode("XML/DetailsVoucher"),this.HideFilterDialog=null!=i.SelectSingleNode("XML/HideFilterDialog"),this.HideProductImage=null!=i.SelectSingleNode("XML/HideProductImage"),this.IsApproval=null!=i.SelectSingleNode("XML/ApproveDocuments"),this.ShowFilter=null!=i.SelectSingleNode("XML/ShowFilter"),this.IsApproval&&(this.RemarksApprove=null!=i.SelectSingleNode("XML/RemarksApprove"),this.RemarksReject=null!=i.SelectSingleNode("XML/RemarksReject"),this.RemarksSuspend=null!=i.SelectSingleNode("XML/RemarksSuspend")),this.IsBarcode=null!=i.SelectSingleNode("XML/BarcodePrint"),this.IsBarcode&&(this.SaveButtonVisible=!1,this.IsDetailVoucher=!0),3!=this.CostCenterID||this.HideProductImage||(this.ProductImageVisibility=!0),this.CostCenterID>4e4&&this.CostCenterID<5e4?(this.IsDocument=!0,this.IsLWApproval=!!(this.IsDetailVoucher&&e.Tables[2].length>0&&1==parseInt(e.Tables[2][0].IsLineWise)),this.AppRejDate.Visible=t.Tables[3].filter(e=>"AppDate"==e.PrefName&&"True"==e.PrefValue).length>0):this.AppRejDate.Visible=!1;let s,o=t.Tables[0];this.dvFields=o,this.dvFieldsNew=o,null!=i.SelectSingleNode("XML/Report")?(this.ReportID=parseInt(i.SelectSingleNode("XML/Report").innerHTML),this.InitReport()):this.ReportID=0,(this.IsDocument||2==this.CostCenterID||3==this.CostCenterID||95==this.CostCenterID||this.CostCenterID>5e4)&&this.IsApproval&&n.a.SessionManager.IsActionAssigned(49,"Document Bulk Approval")?(this.ButtonApprove.Visible=!0,this.SaveButtonVisible=!1,this.IsDocument&&this.IsLWApproval&&(this.SuspendVisiblity=n.a.SessionManager.IsActionAssigned(this.CostCenterID,"Suspend"))):this.ButtonApprove.Visible=!1,(2==this.CostCenterID||3==this.CostCenterID||this.CostCenterID>5e4)&&(this.DeleteVisibility=n.a.SessionManager.IsActionAssigned(49,"Bulk Delete"),this.DeleteVisibility&&(this.DeleteVisibility=n.a.SessionManager.IsActionAssigned(this.CostCenterID,"Delete"))),this.EditGrid=new d.a,this.EditGrid.Width="",this.EditGrid.Height=void 0,this.EditGrid.CanUserDeleteRows=!1,this.EditGrid.Columns=[],this.EditGrid.SearchVisible=!0,this.EditGrid.SearchColStartIndex=1,this.EditGrid.CanUserSortColumns=!0,this.EditGrid.Visible=!1,this.EditGrid.CellEditEnding.Subscribe(this,"EditGridOnCellEditEnding"),this.Report.length>0&&this.EditGrid.Clear(),s=new C.a,s.Header="Select",s.DisplayMember="Select",s.DataType="CheckBox",s.Width=50,s.IsFrozen=!0,s.DisableTab=!0,this.EditGrid.Columns.push(s);let l=0;i.LoadXml(a.e.String(e.Tables[0][0].FieldsXML));let h=new Array;if(this.IsDocument){let e=new p.a,i=[];t.Tables[1].forEach(t=>{i.Clear(),e.ParseFormula(a.e.String(t.Formula),i);let s=null;for(let e=i.length-1;e>=0;e--)s=i[e],s.getTokenClass()!=p.d.OPERAND||s.getTokenType()!=p.e.REFERENCE||h.Contains(s.tokenValue.toString())||h.push(s.tokenValue.toString())})}for(let u=0;u<i.DocumentElement.children.length;u++){const e=i.DocumentElement.children[u];if(this.dvFields=a.e.IsEmpty(e.attributes.ID.value)?[]:this.dvFieldsNew.filter(t=>t.CostCenterColID==e.attributes.ID.value),0!=this.dvFields.length){if(this.SelectedFields.push(this.dvFields[0]),l=parseInt(this.dvFields[0].CostCenterColID),s=new C.a,s.DisplayMember="C"+(this.SelectedFields.length-1),s.SectionName=s.DisplayMember,s.Header=a.e.String(this.dvFields[0].UserColumnName),s.Width=parseInt(e.attributes.Width.value),s.ReadOnly="YES"!=e.attributes.Edit.value,a.e.IsEmpty(e.attributes.ShowCode)||"YES"!=e.attributes.ShowCode.value||(this.dvFields[0].ShowCode="YES"),this.ButtonApprove.Visible&&(s.ReadOnly=!0),s.ID=a.e.String(this.dvFields[0].SysColumnName),"COM_ADDRESS"==a.e.String(this.dvFields[0].SysTableName).toUpperCase()&&this.AddressFields.push(s.SectionName),s.CrRefID=l,null!=this.ReportObj&&(s.OPParams=e.attributes.RPTID.value),!s.ReadOnly&&!this.IsBarcode)if(this.IsDocument)s.ID.startsWith("dcAlpha")||s.ID.toLowerCase().startsWith("dcccnid")||this.docAllowCols.Contains(s.ID.toLowerCase())?(0!=t.Tables[1].filter(e=>e.CostCenterColID==l.toString()).length||h.Contains(s.Header))&&(s.ReadOnly=!0):s.ReadOnly=!0;else if(2==this.CostCenterID&&s.ID.startsWith("AccountCode")){let e=t.Tables[2].filter(e=>0==e.IsGroupCode&&0==e.IsName);s.ReadOnly=null!=e&&e.length>0&&"true"==a.e.String(e[0].IsEnable).toLowerCase()}else if(3==this.CostCenterID&&s.ID.startsWith("ProductCode")){let e=t.Tables[2].filter(e=>0==e.IsGroupCode&&0==e.IsName);s.ReadOnly=null!=e&&e.length>0&&"true"==a.e.String(e[0].IsEnable).toLowerCase()}else if(16==this.CostCenterID&&s.ID.startsWith("BatchCode")){let e=t.Tables[3].filter(e=>"BatchCodeAutoGen"==e.Name);(e.length>0&&"true"==a.e.String(e[0].Value).toLowerCase()||t.Tables[2].length>0&&!a.e.IsEmpty(t.Tables[2][0].IsParentCodeInherited)&&Object(r.j)(t.Tables[2][0].IsParentCodeInherited))&&(s.ReadOnly=!0)}else if(93==this.CostCenterID&&s.ID.startsWith("Code")){let e=t.Tables[2].filter(e=>0==e.IsGroupCode&&0==e.IsName);s.ReadOnly=null!=e&&e.length>0&&"true"==e[0].IsEnable.toString().toLowerCase()}else if(this.CostCenterID>=50001&&this.CostCenterID<=50050&&s.ID.startsWith("Code")){let e=t.Tables[2].filter(e=>0==e.IsGroupCode&&0==e.IsName);s.ReadOnly=null!=e&&e.length>0&&"true"==a.e.String(e[0].IsEnable).toLowerCase()}if(this.SelectedFields.length<3&&(s.IsFrozen=!0),s.IsColumnUserDefined=!!Object(r.j)(this.dvFields[0].IsColumnUserDefined),s.DataType=a.e.String(this.dvFields[0].UserColumnType).toUpperCase(),241==l)s.ValueMember="AccountTypeID",s.DisplayMember="AccountType",s.ValueBinding="C"+(this.SelectedFields.length-1),s.ComboData=t.Tables[4],s.DataType="ComboBox",this.dvFields[0].IsForeignKey=!1;else if(264==l)s.ValueMember="ProductTypeID",s.DisplayMember="ProductType",s.ValueBinding="C"+(this.SelectedFields.length-1),s.ComboData=t.Tables[4],s.DataType="ComboBox",this.dvFields[0].IsForeignKey=!1;else if(252==l)s.ValueMember="Value",s.DisplayMember="Name",s.ValueBinding="C"+(this.SelectedFields.length-1),s.ComboData=b.GetBillWiseTable(),s.DataType="ComboBox";else if("StatusID"==s.ID)s.ValueMember="ID",s.DisplayMember="Name",s.ValueBinding="C"+(this.SelectedFields.length-1),s.ComboData=this.IsDocument?t.Tables[2]:t.Tables[1],s.DataType="ComboBox",this.dvFields[0].IsForeignKey=!1;else if(s.ReadOnly||!a.e.IsEmpty(this.dvFields[0].IsForeignKey)&&Object(r.j)(this.dvFields[0].IsForeignKey)&&parseInt(this.dvFields[0].ColumnCostCenterID)>0&&(s.DataType="LISTBOX",s.CostCenterID=parseInt(this.dvFields[0].ColumnCostCenterID),3!=s.CostCenterID||this.HideProductImage||(this.IsProductExists=!0,this.ProductImageVisibility=!0),s.TypeID=parseInt(this.dvFields[0].ColumnCCListViewTypeID)),"DATE"==s.DataType)s.DataType="DATE",this.DateColIDs.push("C"+(this.SelectedFields.length-1));else if(s.IsColumnUserDefined)if("DATE"==s.DataType||"DATETIME"==s.DataType||"TIME"==s.DataType)s.DataType="DATE",this.DateColIDs.push("C"+(this.SelectedFields.length-1));else if("NUMERIC"==s.DataType)s.DataType="FLOAT";else if("SELECTIONBOX"==s.DataType||"editablecombobox"==s.DataType)s.DataType="SELECTIONBOX",s.CostCenterID=this.CostCenterID;else if("COMBOBOX"==s.DataType){let e=[],t={};this.dvFields[0].UserProbableValues.toString().split(";").forEach(i=>{t={},t.Value=i,t.Name=i,e.push(t)}),s.ValueMember="Value",s.DisplayMember="Name",s.ValueBinding="C"+(this.SelectedFields.length-1),s.ComboData=e,s.DataType="ComboBox"}else if("LISTBOX"==s.DataType)s.DataType="LISTBOX",n.a.SessionManager.IsWebApplication&&(s.ValueMember="C"+(this.SelectedFields.length-1)+"_Key"),s.CostCenterID=parseInt(a.e.String(this.dvFields[0].ColumnCostCenterID)),s.TypeID=parseInt(a.e.String(this.dvFields[0].ColumnCCListViewTypeID));else if("LOOKUP"==s.DataType){s.ValueBinding=s.ID,s.DataType="ComboBox",s.DisplayMember="Name",s.ValueMember="Value";let e=n.a.common.GetDataSet("DOC019",parseInt(this.dvFields[0].ColumnCCListViewTypeID).toString());if(null!=e){let t=[];for(let i=0;i<e.length;i++)t.push(c.d.ComboBoxItems_2(e[i].Name.toString(),e[i].NodeID.toString()));s.ComboData=t}}if("FLOAT"==a.e.String(this.dvFields[0].ColumnDataType)){s.DataType="FLOAT";let e=a.e.String(this.dvFields[0].Decimal);s.ID.toLowerCase().Contains("dcnum")?!a.e.IsEmpty(e)&&parseFloat(e)>=0?s.DecimalPoints=e:n.a.SessionManager.Preferences.ContainsKey("DecimalsinExtraFields")&&""!=n.a.SessionManager.Preferences.DecimalsinExtraFields&&(s.DecimalPoints=n.a.SessionManager.Preferences.DecimalsinExtraFields):"Quantity"==s.ID?""!=e&&parseFloat(e)>=0?s.DecimalPoints=e:n.a.SessionManager.Preferences.ContainsKey("DecimalsinQty")&&""!=n.a.SessionManager.Preferences.DecimalsinQty&&(s.DecimalPoints=n.a.SessionManager.Preferences.DecimalsinQty):"Gross"==s.ID||"Rate"==s.ID?""!=e&&parseFloat(e)>=0?s.DecimalPoints=e:n.a.SessionManager.Preferences.ContainsKey("DecimalsinRate")&&""!=n.a.SessionManager.Preferences.DecimalsinRate&&(s.DecimalPoints=n.a.SessionManager.Preferences.DecimalsinRate):"Amount"==s.ID||"DebitAmount"==s.ID||"CreditAmount"==s.ID?""!=e&&parseFloat(e)>=0?s.DecimalPoints=e:n.a.SessionManager.Preferences.ContainsKey("DecimalsinAmount")&&""!=n.a.SessionManager.Preferences.DecimalsinAmount&&(s.DecimalPoints=n.a.SessionManager.Preferences.DecimalsinAmount):""!=e&&parseFloat(e)>=0&&(s.DecimalPoints=e)}else"COMBOTEXT"==a.e.String(this.dvFields[0].ColumnDataType)&&(s.DataType="LINK",s.Click.Subscribe(this,"onDocClick"),this.vnofield=s.DisplayMember);95!=this.CostCenterID||s.ReadOnly||s.ID.toLowerCase().Contains("alpha")||(s.ReadOnly=!0),s.ReadOnly?s.DisableTab=!0:(this.EditColumns.push(s),this.EditColumnsDr.push(this.dvFields[0].Row),s.DisableTab=!1),this.EditGrid.Columns.push(s),null!=this.ReportObj&&("LISTBOX"==s.DataType||"DATE"==s.DataType?(this.EditGrid.TableColumns.push(s.DisplayMember),this.EditGrid.TableColumns.push(s.DisplayMember+"_Key")):this.EditGrid.TableColumns.push("FLOAT"==s.DataType?s.DisplayMember:"ComboBox"==s.DataType?s.ValueBinding:s.DisplayMember))}else if(null!=this.ReportObj){var D=this.ReportObj.ReportColumns.find(t=>t.ID==e.attributes.RPTID.value);if(null==D||null==D)continue;s=new C.a,s.DisplayMember="RC"+this.EditGrid.TableColumns.length,s.OPParams=e.attributes.RPTID.value,s.SectionName=s.DisplayMember,s.Header=D.HeaderText,s.Width=parseInt(e.attributes.Width.value),s.ReadOnly=!0,s.DataType=D.DataAppearance.ColumnType,this.EditGrid.Columns.push(s),"DATE"==s.DataType||"DATETIME"==s.DataType?(s.DataType="DATE",this.DateColIDs.push(s.SectionName),this.EditGrid.TableColumns.push(s.DisplayMember),this.EditGrid.TableColumns.push(s.DisplayMember+"_Key")):this.EditGrid.TableColumns.push(s.DisplayMember)}}s=new C.a,s.Header="Message",s.DisplayMember="Message",s.Width=250,s.ReadOnly=!0,s.DisableTab=!0,this.EditGrid.Columns.push(s),this.EditGrid.AddSearchCols(),this.Filter=new b(t,this),this.StaticFilter=new b(t,this),this.ShowFilter?this.Filter.LoadXML(a.e.String(e.Tables[0][0].FilterXML)):this.StaticFilter.LoadXML(a.e.String(e.Tables[0][0].FilterXML)),this.IsDocument?(this.FromDate.Visible=!0,this.ToDate.Visible=!0):(this.FromDate.Visible=!1,this.ToDate.Visible=!1)}EditGridOnCellEditEnding(e){0!=e.cell&&this.IsSelectOnRowLeave&&(e.item.Select=!0)}onDocClick(e){return Object(s.b)(this,void 0,void 0,(function*(){if(null!=this.EditGrid.SelectedItem&&this.EditGrid.TableColumns.Contains(this.vnofield)){let e,t=n.a.report.GetDocumentDetailsByVoucherNo(this.EditGrid.SelectedItem[this.vnofield].toString());if(e=a.e.Int(t.obj),e>0){let e;if(e=t.Tables[0].length>0?t.Tables[0][0]:t.Tables[1][0],40054==parseInt(e.CostCenterID)){const{MonthlyPayrollComponent:t}=yield i.e(48).then(i.bind(null,"E7Kr")),{MonthlyPayrollViewModel:s}=yield i.e(47).then(i.bind(null,"+0zN"));this.oDocPayroll=new s(e.DocumentName.toString(),"",e.VoucherNo.toString()),n.a.page.addNewTab({title:e.DocumentName.toString(),component:t,params:{obj:this.oDocPayroll}})}else{const{AddEditDocumentComponent:t}=yield Promise.resolve().then(i.bind(null,"MCKn")),{AddEditDocumentViewModel:s}=yield Promise.resolve().then(i.bind(null,"1Cra"));let a=new s(parseInt(e.CostCenterID),e.DocumentName.toString(),!0);a.ScreenObject.DocPrefix.ComboBox.SelectedValue=e.DocPrefix.toString(),a.ScreenObject.DocPrefix.TextBox.Text=e.DocNumber.toString(),a.OnDocPrefixChanged("lostFocus"),a.ScreenObject.FillDocumentPrefix(!0),n.a.page.addNewTab({component:t,params:{obj:a}})}}}}))}InitReport(){let e=new I.ReportViewModel;e.ReportViewModel_1(this.ReportID),this.ReportObj=e,this.ReportObj.ScreenName="BULK",this.ReportObj.BulkEdit=this,this.Report.push(this.ReportObj),this.ReportFilterVisible=!this.HideFilterDialog}OnButtonClick(e){if(this.DisplayMessage="","Save"==e){if(null==this.EditGrid.Table)return;let e=this.EditGrid.Table.filter(e=>1==e.Select||1==e.Select);if(0==e.length)return void(this.DisplayMessage="No Rows Selected");this.CostCenterID>4e4&&this.CostCenterID<5e4?this.SaveDocument(e):this.SaveDimension(e),this.DisplayMessage=95==this.CostCenterID?"Saved successfully":"Posting Completed"}else if("Delete"==e){if(!this.DeleteVisibility)return;let e=this.EditGrid.Table.filter(e=>1==e.Select||1==e.Select);if(0==e.length)return void(this.DisplayMessage="No Rows Selected");if(!confirm("Do you want to delete selected rows?"))return;this.CostCenterID>4e4&&this.CostCenterID<5e4||this.DeleteDimension(e)}else if("BACK"==e)this.EditGrid.Visible=!0;else if("OK"==e)this.EditGrid.Visible=!0,this.Filter.FilterGrid.commitEdit(),this.RefreshData();else if("Filter"==e)this.EditGrid.Visible=!1,this.Report.length>0&&(this.Report[0].ShowFilter=!0,this.ReportFilterVisible=!0);else if("Refresh"==e)this.Report.length>0?this.Report[0].Refresh():this.RefreshData();else if("PopUp"==e);else if("Approve"==e)this.ShowRightPanel=!0,this.ProductImageVisibility=!1,this.ReplaceVisibility=!1,this.ApproveVisibility=!0,this.AppDisplayMessage="",this.AppMessageVisibility=!1,this.Remarks.Text="",n.a.page.ShowDialog(this,S.a,{ShowCenter:!0,HideClose:!0,NoWidth:!0,Title:n.a.GetResource("ApproveReject")});else if("CancelAction"==e)this.ApproveVisibility=!1,n.a.page.HideDialog(),null!=this.DB&&(this.ShowRightPanel=!1);else if("Barcode"==e){if(null==this.EditGrid.Table)return;let e=this.EditGrid.Table.filter(e=>1==e.Select||1==e.Select);if(0==e.length)return void(this.DisplayMessage="No Rows Selected");this.CostCenterID>4e4&&this.CostCenterID<5e4&&this.BarcodeDocument(e)}}RefreshData(){if(this.DisplayMessage="",2==this.CostCenterID?(this.PrimaryKey="AccountID",this.PrimaryColumns="D.AccountID,D.AccountCode,D.AccountName,D.AccountTypeID,D.IsGroup,D.StatusID,D.GUID"):3==this.CostCenterID?(this.PrimaryKey="ProductID",this.PrimaryColumns="D.ProductID,D.ProductCode,D.ProductName,D.ProductTypeID,D.GUID"):16==this.CostCenterID?(this.PrimaryKey="BatchID",this.PrimaryColumns="D.BatchID,D.BatchCode,D.BatchNumber, CONVERT(DATETIME,D.MfgDate) MfgDate, D.ProductID,CONVERT(DATETIME, D.ExpiryDate) ExpiryDate, D.MRPRate, D.RetailRate, D.StockistRate,CONVERT(DATETIME, D.RetestDate) RetestDate, D.GUID"):this.CostCenterID>5e4?(this.PrimaryKey="NodeID",this.PrimaryColumns="D.NodeID,D.Code,D.Name,D.StatusID,D.GUID"):92==this.CostCenterID?(this.PrimaryKey="NodeID",this.PrimaryColumns="D.*"):93==this.CostCenterID?(this.PrimaryKey="UnitID",this.PrimaryColumns="D.*"):94==this.CostCenterID?(this.PrimaryKey="TenantID",this.PrimaryColumns="D.*"):95==this.CostCenterID?(this.PrimaryKey="ContractID",this.PrimaryColumns="D.ContractID,D.SNO,D.ContractNumber,D.StatusID,D.GUID"):(this.PrimaryKey=0==a.e.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?"AccDocDetailsID":"InvDocDetailsID",this.PrimaryColumns=this.IsDetailVoucher?0==a.e.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?"D.AccDocDetailsID,D.VoucherNo":"D.InvDocDetailsID,D.VoucherNo":"D.VoucherNo"),this.Report.length>0)return this.ReportFilterVisible=!1,this.EditGrid.Visible=!0,void this.LoadDataFromReport();let e,t,i,s,o="",l="",h=0;this.Entities.Clear(),this.Entities.push(this.MainTableName,"D"),o+=this.PrimaryColumns,l+=this.MainTableName+" D with(nolock)",this.SelectedFields.forEach(D=>{if(i="T"+h,t=a.e.String(D.SysTableName),e=a.e.String(D.SysColumnName),2==this.CostCenterID||3==this.CostCenterID||16==this.CostCenterID||92==this.CostCenterID||93==this.CostCenterID||94==this.CostCenterID||95==this.CostCenterID||this.CostCenterID>=50001)if(t=t.toUpperCase(),0==a.e.stringCompare(t,"ACC_ACCOUNTSEXTENDED")||0==a.e.stringCompare(t,"INV_PRODUCTEXTENDED")||0==a.e.stringCompare(t,"REN_PROPERTYEXTENDED")||0==a.e.stringCompare(t,"REN_UNITSEXTENDED")||0==a.e.stringCompare(t,"REN_TENANTEXTENDED")||0==a.e.stringCompare(t,"REN_CONTRACTEXTENDED"))if(this.Entities.ContainsKey(t)||(this.Entities.push(t,"EXT"),l+=95==this.CostCenterID?" INNER JOIN "+t+" EXT with(nolock) ON EXT.NODEID=D."+this.PrimaryKey:" INNER JOIN "+t+" EXT with(nolock) ON EXT."+this.PrimaryKey+"=D."+this.PrimaryKey),e="EXT."+e,"DATE"==a.e.String(D.ColumnDataType))e="convert(datetime,"+e+")",o+=",'' AS C"+h,o+=","+e+" AS C"+h+"_Key";else if("LISTBOX"==a.e.String(D.UserColumnType)){let i;if("44"==a.e.String(D.ColumnCostCenterID))i=",case when "+e+" is not null and isnumeric("+e+")=1 then (SELECT Name FROM COM_Lookup with(nolock) WHERE NodeID="+e+") else '' end";else{let a=n.a.report.GetTableColumns(parseInt(D.ColumnCostCenterID));i=a.ColumnName,s=a.PrimaryKey,t=a.TableName,i=",case when "+e+" is not null and isnumeric("+e+")=1 then (SELECT "+i+" FROM "+t+" with(nolock) WHERE "+s+"="+e+") else '' end"}o+=i+" AS C"+h,o+=",case when isnumeric("+e+")=1 then "+e+" else convert(bigint,-1) end AS C"+h+"_Key"}else o+=","+e+" AS C"+h;else 0==a.e.stringCompare(t,"COM_CCCCDATA")?(this.Entities.ContainsKey("COM_CCCCDATA")||(this.Entities.push("COM_CCCCDATA","CCDATA"),l+=" INNER JOIN COM_CCCCData CCDATA with(nolock) ON CCDATA.NodeID=D."+this.PrimaryKey+" AND CCDATA.CostCenterID="+this.CostCenterID),this.Entities.ContainsKey(e)||(this.Entities.push(e,i),l+=" INNER JOIN "+a.e.GetTagTableName(parseInt(D.ParentCostCenterID))+" "+i+" with(nolock) ON "+i+".NodeID=CCDATA."+e),o+=","+this.Entities[e]+".Name AS C"+h,o+=",CCDATA."+e+" AS C"+h+"_Key"):0==a.e.stringCompare(t,"COM_ADDRESS")?(this.Entities.ContainsKey("COM_ADDRESS")||(this.Entities.push("COM_ADDRESS","CCADD"),o+=",CCADD.AddressID",l+=" INNER JOIN COM_ADDRESS CCADD with(nolock) ON CCADD.AddressTypeID=1 and CCADD.FeaturePK=D."+this.PrimaryKey+" AND CCADD.FeatureID="+this.CostCenterID),o+=",CCADD."+e+" C"+h):null!=D.IsForeignKey&&Object(r.j)(D.IsForeignKey)?(this.Entities.ContainsKey(e)||(this.Entities.push(e,i),l+=" INNER JOIN "+a.e.String(D.ParentCostCenterSysName)+" "+this.Entities[e]+" with(nolock) ON "+this.Entities[e]+"."+a.e.String(D.ParentCostCenterColSysName)+"=D."+e),o+=","+this.Entities[e]+"."+this.GetColumnName(D)+" AS C"+h,o+=",D."+e+" AS C"+h+"_Key"):(e="D."+e,"DATE"==a.e.String(D.ColumnDataType)?(e="convert(datetime,"+e+")",o+=",'' AS C"+h,o+=","+e+" AS C"+h+"_Key"):("D.IsBillwise"==e&&(e="convert(int,"+e+")"),o+=","+e+" AS C"+h));else if(this.CostCenterID>4e4)if(0==a.e.stringCompare(t,"COM_DocTextData"))if(this.Entities.ContainsKey("COM_DocTextData")||(this.Entities.push("COM_DocTextData","TXT"),l+=" INNER JOIN COM_DocTextData TXT with(nolock) ON TXT."+this.PrimaryKey+"=D."+this.PrimaryKey),e=this.GetMaxColumn("TXT."+e,a.e.String(D.ColumnDataType)),"DATE"==a.e.String(D.ColumnDataType))e="convert(datetime,"+e+")",o+=",'' AS C"+h,o+=","+e+" AS C"+h+"_Key";else if("LISTBOX"==a.e.String(D.UserColumnType)){let i;if("44"==a.e.String(D.ColumnCostCenterID))i=",case when "+e+" is not null and isnumeric("+e+")=1 then (SELECT Name FROM COM_Lookup with(nolock) WHERE NodeID="+e+") else '' end";else{let a=n.a.report.GetTableColumns(parseInt(D.ColumnCostCenterID));i=a.ColumnName,s=a.PrimaryKey,t=a.TableName,i=",case when "+e+" is not null and isnumeric("+e+")=1 then (SELECT "+i+" FROM "+t+" with(nolock) WHERE "+s+"="+e+") else '' end"}o+=i+" AS C"+h,o+=",case when isnumeric("+e+")=1 then "+e+" else convert(bigint,-1) end AS C"+h+"_Key"}else"LOOKUP"==a.e.String(D.UserColumnType)?(o+=","+e+" AS C"+h,o+=","+e+" AS C"+h+"_Key"):"FLOAT"==a.e.String(D.ColumnDataType)?o+=",case when isnumeric("+e+")=1 then convert(float,"+e+") else null end AS C"+h:o+=","+e+" AS C"+h;else 0==a.e.stringCompare(t,"COM_DocNumData")?(this.Entities.ContainsKey("COM_DocNumData")||(this.Entities.push("COM_DocNumData","NUM"),l+=" INNER JOIN COM_DocNumData NUM with(nolock) ON NUM."+this.PrimaryKey+"=D."+this.PrimaryKey),e=this.GetMaxColumn("NUM."+e,a.e.String(D.ColumnDataType)),o+=","+e+" AS C"+h):0==a.e.stringCompare(t,"COM_DocCCData")?(this.Entities.ContainsKey("COM_DocCCData")||(this.Entities.push("COM_DocCCData","DCC"),s=0==a.e.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?"AccDocDetailsID":"InvDocDetailsID",l+=" INNER JOIN COM_DocCCData DCC with(nolock) ON DCC."+s+"=D."+s),this.Entities.ContainsKey(e)||(this.Entities.push(e,i),l+=" INNER JOIN "+a.e.GetTagTableName(parseInt(D.ParentCostCenterID))+" "+i+" with(nolock) ON "+i+".NodeID=DCC."+e),"YES"==a.e.String(D.ShowCode)?o+=","+this.GetMaxColumn(this.Entities[e]+".Code","")+" AS C"+h:o+=","+this.GetMaxColumn(this.Entities[e]+".Name","")+" AS C"+h,o+=","+this.GetMaxColumn("DCC."+e,"")+" AS C"+h+"_Key"):null!=D.IsForeignKey&&Object(r.j)(D.IsForeignKey)&&0==["AccountTypeID","StatusID"].Contains(e)?(this.Entities.ContainsKey(e)||(this.Entities.push(e,i),l+=" INNER JOIN "+a.e.String(D.ParentCostCenterSysName)+" "+this.Entities[e]+" with(nolock) ON "+this.Entities[e]+"."+a.e.String(D.ParentCostCenterColSysName)+"=D."+e,a.e.IsEmpty(D.ParentCostCenterSysName)||"inv_product"!=a.e.String(D.ParentCostCenterSysName).toLowerCase()||(this.IsProductExists=!0)),o+=","+this.GetMaxColumn(this.Entities[e]+"."+this.GetColumnName(D),"")+" AS C"+h,o+=","+this.GetMaxColumn("D."+e,"")+" AS C"+h+"_Key"):(e=this.GetMaxColumn("D."+e,a.e.String(D.ColumnDataType)),"DATE"==a.e.String(D.ColumnDataType)?(e="convert(datetime,"+e+")",o+=",'' AS C"+h,o+=","+e+" AS C"+h+"_Key"):o+=","+e+" AS C"+h);h++}),3!=this.CostCenterID&&!this.IsProductExists||this.HideProductImage||(this.ProductImageVisibility=!0,this.ReplaceVisibility=!1,this.ApproveVisibility=!1,o+=this.IsDetailVoucher||3==this.CostCenterID?",f.GUID FileGUID, f.FileExtension FileExtension":",max(f.GUID) FileGUID, max(f.FileExtension) FileExtension",l+=" left join com_files f with(nolock) on F.featureid=3 and featurepk=d.productid  and f.isProductImage=1 and f.isDEfaultImage=1 "),this.IsDocument&&this.IsLWApproval&&(o+=",D.WorkflowID"),o="SELECT "+o,o+=" FROM "+l.toString(),o+=" WHERE 1=1",this.CostCenterID>4e4&&this.CostCenterID<5e4&&(o+=" AND D.CostCenterID="+this.CostCenterID,this.FromDate.Visible&&(o+=" AND D.DocDate>=convert(float,convert(datetime,'"+this.FromDate.Date.ToString("dd MMM yyyy")+"'))",o+=" AND D.DocDate<=convert(float,convert(datetime,'"+this.ToDate.Date.ToString("dd MMM yyyy")+"'))"));let D=this.StaticFilter.GetWhere(l,100).Trim();D.length>0&&(o+=" AND ("+D+")");let u=this.Filter.GetWhere(l,500).Trim();u.length>0&&(o+=" AND ("+u+")"),2==this.CostCenterID?o+=" ORDER BY D.AccountName":3==this.CostCenterID?o+=" ORDER BY D.ProductName":16==this.CostCenterID?o+=" ORDER BY D.BatchNumber":92==this.CostCenterID||93==this.CostCenterID?o+=" ORDER BY D.Name":94==this.CostCenterID?o+=" ORDER BY D.FirstName":this.CostCenterID>=50001?o+=" ORDER BY D.Name":this.CostCenterID>4e4&&(this.IsDetailVoucher?o+=" ORDER BY D.DocDate,D.VoucherNo,D.DocSeqNo":(o+=" GROUP BY D.DocDate,D.VoucherNo",o+=" ORDER BY D.DocDate,D.VoucherNo"));try{this.EditGrid.Clear(),o=o.Replace("%","~");let e,t,i=n.a.common.GetDataSetQuery(o.toString());i.Columns[0].push("Select"),i.Columns[0].push("Message"),i.Tables[0].forEach(i=>{i.Select=!1,this.DateColIDs.forEach(s=>{e=s+"_Key",!a.e.IsEmpty(i[e])&&i[e].toString().length>0&&(t=new Date(i[e]),i[s]=t.ToString(n.a.SessionManager.Preferences["Date Format"]))})});for(let s=0;s<i.Tables[0].length;s++)i.Tables[0][s].id=s+1;this.EditGrid.Table.AddRange(i.Tables[0]),i.Columns&&i.Columns.length>0&&(this.EditGrid.TableColumns=i.Columns[0]),this.EditGrid.refreshDataView()}catch(d){this.DisplayMessage="Error in loading data",Logger.ErrorLog("Bulk Edit-RefreshData:",d.Message)}}ShowEditGrid(){this.ReportFilterVisible=!1,this.EditGrid.Visible=!0}LoadDataFromReport(){let e,t;if(this.cprimary=null,this.EditGrid.Clear(),this.IsDocument){if(this.EditGrid.TableColumns.Contains("Message")||(this.EditGrid.TableColumns.push("Select"),this.EditGrid.TableColumns.push("Message")),this.IsDetailVoucher?(this.cprimary=this.Report[0].BaseReportColumns.find(e=>"2"==e.LinkType.SelectedValue),this.EditGrid.TableColumns.Contains("ReportPK")||this.EditGrid.TableColumns.push("ReportPK"),this.IsLWApproval&&!this.EditGrid.TableColumns.Contains("WorkFlowID")&&this.EditGrid.TableColumns.push("WorkFlowID")):this.cprimary=this.Report[0].BaseReportColumns.find(e=>"1"==e.LinkType.SelectedValue||"2"==e.LinkType.SelectedValue),null==this.cprimary||null==this.cprimary)return void(this.DisplayMessage="Please set voucher no column link type as "+(this.IsDetailVoucher?"'Document Detail'":"'Document'"));var i=this.EditGrid.Columns.find(e=>e.OPParams==this.cprimary.ID);if(null==i&&null==i)return void(this.DisplayMessage="Please select voucher no column");this.strVoucherNo=i.SectionName}else if(this.EditGrid.TableColumns.Contains("ReportPK")||(this.EditGrid.TableColumns.push("ReportPK"),this.EditGrid.TableColumns.push("Select"),this.EditGrid.TableColumns.push("Message")),this.cprimary=this.Report[0].BaseReportColumns.find(e=>(e.CDGDO.CategoryValue==this.CostCenterID||e.CDGDO.ColumnCostCenterID==this.CostCenterID||null!=e.CDGDO.ChildCDGDO&&e.CDGDO.ChildCDGDO.CategoryValue==this.CostCenterID)&&("3"==e.LinkType.SelectedValue||"4"==e.LinkType.SelectedValue)),null==this.cprimary)return void(this.DisplayMessage="Please set dimension column link type");let s=new o.a,r=new o.a;for(let n=0;n<this.EditGrid.Columns.length;n++){const e=this.EditGrid.Columns[n];if(null==e.OPParams)continue;let t=this.Report[0].BaseReportColumns.find(t=>t.ID==e.OPParams);null!=t&&r.push(e.OPParams,t)}for(let l=0;l<this.Report[0].Data.length;l++){const i=this.Report[0].Data[l];if(i.Type==m.f.Detail){t=this.EditGrid.NewRow(),t.Select=!1,null!=i.DataRow&&null!=i.DataRow[this.cprimary.ID+"_ID"]&&a.e.String(i.DataRow[this.cprimary.ID+"_ID"]).length>0&&null!=t.ReportPK&&(t.ReportPK=i.DataRow[this.cprimary.ID+"_ID"]),this.IsLWApproval&&(t.WorkFlowID=i.DataRow.WorkFlowID),null!=this.Report[0].LevelColumn&&i.IsGroup&&(t.Row_Foreground=null);for(let r=0;r<this.EditGrid.Columns.length;r++){const l=this.EditGrid.Columns[r];if(null!=l.OPParams)if("LISTBOX"==l.DataType){if(null!=i.DataRow&&null!=i.DataRow[l.OPParams])if(t[l.DisplayMember]=i.DataRow[l.OPParams],null!=i.DataRow[l.OPParams+"_ID"])t[l.DisplayMember+"_Key"]=i.DataRow[l.OPParams+"_ID"];else if(s.ContainsKey(l.OPParams)||s.push(l.OPParams,new o.a),s[l.OPParams].ContainsKey(a.e.String(i.DataRow[l.OPParams])))t[l.DisplayMember+"_Key"]=s[l.OPParams][a.e.String(i.DataRow[l.OPParams])];else if(this.dvFields=this.dvFieldsNew.filter(e=>e.CostCenterColID==l.CrRefID),this.dvFields.length>0){let e=n.a.common.GetDataSet3("BULK001",a.e.String(this.dvFields[0].ParentCostCenterColSysName),a.e.String(this.dvFields[0].ParentCostCenterSysName),a.e.String(i.DataRow[l.OPParams])).Tables[0];e.length>0&&!a.e.IsEmpty(e.ID)&&(s[l.OPParams].push(a.e.String(i.DataRow[l.OPParams]),parseInt(e[0].ID)),t[l.DisplayMember+"_Key"]=s[l.OPParams][a.e.String(i.DataRow[l.OPParams])])}}else"DATE"==l.DataType?null!=i.DataRow&&null!=i.DataRow[l.OPParams]&&!a.e.IsEmpty(i.DataRow[l.OPParams])&&a.e.String(i.DataRow[l.OPParams]).length>0&&(e=new Date(i.DataRow[l.OPParams]),t[l.DisplayMember]=e.ToString(n.a.SessionManager.Preferences["Date Format"]),t[l.DisplayMember+"_Key"]=e):"ComboBox"==l.DataType?null!=i.DataRow&&null!=i.DataRow[l.OPParams]&&(t[l.ValueBinding]=i.DataRow[l.OPParams]):null!=i.DataRow&&null!=i.DataRow[l.OPParams]&&(t[l.DisplayMember]=i.DataRow[l.OPParams])}this.EditGrid.addRow(t)}}}GetColumnName(e){let t,i;return t="parentid"==a.e.String(e.SysColumnName).toLowerCase()?this.CostCenterID:parseInt(e.ColumnCostCenterID),i=a.e.IntTryParse(a.e.String(e.ParentCCDefaultColID)),2==t?238==i?"AccountCode":"AccountName":3==t?261==i?"ProductCode":"ProductName":93==t?25624==i?"Code":"Name":94==t?25697==i?"FirstName":"LastName":16==t?"BatchNumber":"Name"}GetMaxColumn(e,t){return this.IsDetailVoucher||(e="FLOAT"!=t||e.Contains("dcAlpha")?"max("+e+")":"sum("+e+")"),e}SaveDocument(e){let t,i,s,o="",r="",l="",h=0;s=0==a.e.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?"AccDocDetailsID":"InvDocDetailsID",i=null!=this.ReportObj?"ReportPK":s;let D=a.e.NewGuid();e.forEach(u=>{if(h++,l="",r="",o="",this.EditColumns.forEach(e=>{"LISTBOX"==e.DataType&&0!=e.CostCenterID&&e.ID.toLowerCase().startsWith("dcccnid")?r+=e.ID+"="+a.e.String(u[e.ValueMember])+",":e.IsColumnUserDefined?"SELECTIONBOX"==e.DataType?o+=e.ID+"=N'"+a.e.String(u[e.DisplayMember]).Replace("'","''")+"',":e.DisplayMember.toLowerCase().Contains("dcnum")||("DATE"==e.DataType?a.e.IsEmpty(u[e.DisplayMember+"_Key"])||(o+=e.ID+"='"+new Date(u[e.DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy")+"',"):"DATETIME"==e.DataType||"TIME"==e.DataType?a.e.IsEmpty(u[e.DisplayMember+"_Key"])||(o+=e.ID+"='"+new Date(u[e.DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy hh:mm:ss tt")+"',"):o+="ComboBox"==e.DataType?e.ID+"=N'"+a.e.String(u[e.ValueBinding]).Replace("'","''")+"',":"PactComboBox"==e.DataType?e.ID+"=N'"+a.e.String(u[e.ValueBinding+"_Key"]).Replace("'","''")+"',":"LISTBOX"==e.DataType&&0!=e.CostCenterID?e.ID+"='"+a.e.String(u[e.ValueMember]).Replace("'","''")+"',":e.ID+"=N'"+a.e.String(u[e.DisplayMember]).Replace("'","''")+"',"):this.docAllowCols.Contains(e.ID.toLowerCase())&&("DATE"==e.DataType?a.e.IsEmpty(u[e.DisplayMember+"_Key"])||(l+=e.ID+"=CONVERT(INT,CONVERT(DATETIME,'"+new Date(u[e.DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy")+"')),"):l+=e.ID+"=N'"+a.e.String(u[e.DisplayMember]).Replace("'","''")+"',")}),o.length>0||r.length>0||l.length>0){o.length>0&&(o=o.substr(0,o.length-1),o=o.Insert(0,"UPDATE COM_DocTextData SET "),o+=" FROM "+this.MainTableName+" D INNER JOIN COM_DocTextData TXT ON D."+s+"=TXT."+s,this.IsDetailVoucher?(o+=" WHERE ",0==a.e.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?o+="D.AccDocDetailsID="+a.e.String(u[i]):o+="D.InvDocDetailsID="+a.e.String(u[i])):o+=" WHERE VoucherNo='"+a.e.String(u[this.strVoucherNo])+"'"),r.length>0&&(r=r.substr(0,r.length-1),r=r.Insert(0,"   UPDATE COM_DocCCData SET "),r+=" FROM "+this.MainTableName+" D INNER JOIN COM_DocCCData TXT ON D."+s+"=TXT."+s,this.IsDetailVoucher?(r+=" WHERE ",0==a.e.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?r+="D.AccDocDetailsID="+a.e.String(u[i]):r+="D.InvDocDetailsID="+a.e.String(u[i])):r+=" WHERE VoucherNo='"+a.e.String(u[this.strVoucherNo])+"'"),o+=r.toString(),l.length>0&&(l=l.substr(0,l.length-1),l=l.Insert(0,"   UPDATE "+this.MainTableName+" SET "),this.IsDetailVoucher?(l+=" WHERE ",0==a.e.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?l+="AccDocDetailsID="+a.e.String(u[i]):l+="InvDocDetailsID="+a.e.String(u[i])):l+=" WHERE VoucherNo='"+a.e.String(u[this.strVoucherNo])+"'"),o+=l.toString();try{let i,s=null;i=h==e.length||a.e.String(u[this.strVoucherNo])!=a.e.String(e[h][this.strVoucherNo])?n.a.common.BulkEditDetals_7(7,this.ID,this.CostCenterID,D,o.toString(),a.e.String(u[this.strVoucherNo]),""):n.a.common.BulkEditDetals_7(7,this.ID,this.CostCenterID,D,o.toString(),"",""),s=i,t=a.e.Int(i.obj),u.Message=t>0?"Success":s&&s.Tables.length>0&&s.Tables[0].length>0&&s.Columns[0].Contains("ServerMessage")?"Failure : "+a.e.String(s.Tables[0][0].ServerMessage):s&&s.Tables.length>0&&s.Tables[0].length>0&&s.Columns[0].Contains("ErrorMessage")?"Failure : "+a.e.String(s.Tables[0][0].ErrorMessage):"Failure",this.EditGrid.updateRow(u)}catch(d){Logger.ErrorLog("BulkEdit-SAVE: ",d.Message)}}else u.Message="NO DATA",this.EditGrid.updateRow(u)})}SaveDimension(e){let t,i="",s="",o="",l="",h="";for(let d=0;d<e.length;d++){const C=e[d];if(s="",o="",l="",h="",this.EditColumns.forEach(e=>{"SELECTIONBOX"==e.DataType?e.ID.toLowerCase().Contains("alpha")?o+=e.ID+"='"+a.e.String(C[e.DisplayMember]).Replace("'","''")+"',":s+=e.ID+"='"+a.e.String(C[e.DisplayMember]).Replace("'","''")+"',":"DATE"==e.DataType?a.e.IsEmpty(C[e.DisplayMember+"_Key"])||(e.ID.toLowerCase().Contains("alpha")?o+=e.ID+"='"+new Date(C[e.DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy")+"',":16==this.CostCenterID&&(e.ID.Contains("MfgDate")||e.ID.Contains("ExpiryDate")||e.ID.Contains("RetestDate"))||(s+=e.ID+"='"+new Date(C[e.DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy")+"',")):"DATETIME"==e.DataType||"TIME"==e.DataType?a.e.IsEmpty(C[e.DisplayMember+"_Key"])||(e.ID.toLowerCase().Contains("alpha")?o+=e.ID+"='"+new Date(C[e.DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy hh:mm:ss tt")+"',":16==this.CostCenterID&&(e.ID.Contains("MfgDate")||e.ID.Contains("ExpiryDate")||e.ID.Contains("RetestDate"))||(s+=e.ID+"='"+new Date(C[e.DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy")+"',")):"ComboBox"==e.DataType?e.ID.toLowerCase().Contains("alpha")?o+=e.ID+"='"+a.e.String(C[e.ValueBinding]).Replace("'","''")+"',":s+=e.ID+"='"+a.e.String(C[e.ValueBinding]).Replace("'","''")+"',":"PactComboBox"==e.DataType?e.ID.toLowerCase().Contains("alpha")?o+=e.ID+"='"+a.e.String(C[e.ValueBinding+"_Key"]).Replace("'","''")+"',":s+=e.ID+"='"+a.e.String(C[e.ValueBinding+"_Key"]).Replace("'","''")+"',":"LISTBOX"==e.DataType&&0!=e.CostCenterID?e.ID.toLowerCase().Contains("alpha")?o+=e.ID+"='"+a.e.String(C[e.ValueMember]).Replace("'","''")+"',":e.ID.toLowerCase().startsWith("ccnid")?l+=e.ID+"="+a.e.String(C[e.ValueMember])+",":s+=e.ID+"="+a.e.String(C[e.ValueMember])+",":this.AddressFields.Contains(e.SectionName)?h+=e.ID+"='"+a.e.String(C[e.DisplayMember]).Replace("'","''")+"',":e.IsColumnUserDefined?o+=e.ID+"='"+a.e.String(C[e.DisplayMember]).Replace("'","''")+"',":s+=e.ID+"='"+a.e.String(C[e.DisplayMember]).Replace("'","''")+"',"}),s.length>0||o.length>0||l.length>0||h.length>0)try{if(t=0,null!=this.ReportObj){if(null==C.ReportPK)continue;let e=n.a.common.GetDataSet3("BULK002",this.PrimaryColumns,this.MainTableName,this.PrimaryKey+","+a.e.String(C.ReportPK)).Tables[0];if(0==e.length)continue;e.Columns.forEach(t=>{this.EditGrid.TableColumns.Contains(t.ColumnName)||this.EditGrid.TableColumns.push(t.ColumnName),C[t.ColumnName]=e[0][t.ColumnName]})}if(2==this.CostCenterID){let e={};e.AccountID=parseInt(C.AccountID),e.GUID=a.e.String(C.GUID);var D=this.EditColumns.find(e=>"AccountCode"==e.ID);e.AccountCode=a.e.String(null!=D?C[D.DisplayMember]:C.AccountCode),e.CodePrefix=e.AccountCode,D=this.EditColumns.find(e=>"AccountName"==e.ID),e.AccountName=a.e.String(null!=D?C[D.DisplayMember]:C.AccountName),D=this.EditColumns.find(e=>"StatusID"==e.ID),e.StatusID=null!=D&&a.e.String(C[D.ValueBinding]).length>0?parseInt(C[D.ValueBinding]):parseInt(C.StatusID),D=this.EditColumns.find(e=>"AccountTypeID"==e.ID),e.AccountTypeID=null!=D&&a.e.String(C[D.ValueBinding]).length>0?parseInt(C[D.ValueBinding]):parseInt(C.AccountTypeID),e.IsGroup=Object(r.j)(C.IsGroup),e.StaticFieldsQuery=s.toString(),e.CustomFieldsQuery=o.toString(),e.CustomCostCenterFieldsQuery=l.toString(),h.length>0&&(h=h.substr(0,h.length-1),h=' <Data><Row Action="MODIFY" AddressID="'+a.e.String(C.AddressID)+'" AddressTypeID="1"  StaticFields ="'+h,h+='"/></Data>'),e.AddressXML=h.toString(),e.CCMapXML=null,n.a.accounting.SaveAccount(e,"SaveAccountQuick").subscribe(e=>{if(i=e.Message,t=e.RetValue,t>0){C.Message="Success",this.EditGrid.updateRow(C);let e=n.a.common.BulkEditDetals_7(8,t,this.CostCenterID,"","","","").ds;null!=e&&e.Tables.length>0&&e.Tables[0].length>0&&e.Columns[0].Contains("GUID")&&(C.GUID=a.e.String(e.Tables[0][0].GUID))}else C.Message="Failure : "+i,this.EditGrid.updateRow(C)},e=>{alert(JSON.stringify(e)),console.log("Bulk Edit Account Save : "+JSON.stringify(e))})}else if(3==this.CostCenterID){let e={};e.ProductID=parseInt(C.ProductID),e.GUID=a.e.String(C.GUID);let s=this.EditColumns.find(e=>"ProductCode"==e.ID);e.ProductCode=a.e.String(null!=s?C[s.DisplayMember]:C.ProductCode),e.CodePrefix=e.ProductCode,s=this.EditColumns.find(e=>"ProductName"==e.ID),e.ProductName=a.e.String(null!=s?C[s.DisplayMember]:C.ProductName),s=this.EditColumns.find(e=>"ProductTypeID"==e.ID),e.ProductType=null!=s&&a.e.String(C[s.ValueBinding]).length>0?parseInt(C[s.ValueBinding]):parseInt(C.ProductTypeID),e.CustomFieldsQuery=o.toString(),e.CustomCostCenterFieldsQuery=l.toString(),e.CCCCMapDATA=null,n.a.inventory.AddProduct("","SetProductQuick").subscribe(e=>{if(i=e.Message,t=e.RetValue,t>0){C.Message="Success",this.EditGrid.updateRow(C);let e=n.a.common.BulkEditDetals_7(8,t,this.CostCenterID,"","","","").ds;null!=e&&e.Tables.length>0&&e.Tables[0].length>0&&e.Columns[0].Contains("GUID")&&(C.GUID=a.e.String(e.Tables[0][0].GUID))}else C.Message="Failure : "+i,this.EditGrid.updateRow(C)},e=>{alert(JSON.stringify(e)),console.log("Bulk Edit Quick Product Save : "+JSON.stringify(e))})}else if(16==this.CostCenterID){let e={};e.BatchID=parseInt(C.BatchID),e.GUID=a.e.String(C.GUID),D=this.EditColumns.find(e=>"BatchCode"==e.ID),e.BatchCode=a.e.String(null!=D?C[D.DisplayMember]:C.BatchCode),e.CodePrefix=e.BatchCode,e.StaticFieldsQuery=s.toString(),e.CustomFieldsQuery=o.toString(),e.CustomCostCenterFieldsQuery=l.toString();let t=[];t.push(a.e.String(C.BatchNumber)),D=this.EditColumns.find(e=>"MfgDate"==e.ID),t.push(null!=D?new Date(a.e.String(C[D.DisplayMember+"_Key"])).ToString("dd/MMM/yyyy"):a.e.IsEmpty(C.MfgDate)?"1/JAN/1900":new Date(C.MfgDate.toString()).ToString("dd/MMM/yyyy")),D=this.EditColumns.find(e=>"ExpiryDate"==e.ID),t.push(null!=D?new Date(a.e.String(C[D.DisplayMember+"_Key"])).ToString("dd/MMM/yyyy"):a.e.IsEmpty(C.ExpiryDate)?"1/JAN/1900":new Date(C.ExpiryDate.toString()).ToString("dd/MMM/yyyy")),D=this.EditColumns.find(e=>"MRPRate"==e.ID),t.push(null!=D?parseFloat(a.e.String(C[D.DisplayMember])):parseFloat(a.e.String(C.MRPRate))),D=this.EditColumns.find(e=>"RetailRate"==e.ID),t.push(null!=D?parseFloat(a.e.String(C[D.DisplayMember])):parseFloat(a.e.String(C.RetailRate))),D=this.EditColumns.find(e=>"StockistRate"==e.ID),t.push(null!=D?parseFloat(a.e.String(C[D.DisplayMember])):parseFloat(a.e.String(C.StockistRate))),t.push(a.e.String(C.ProductID)),D=this.EditColumns.find(e=>"RetestDate"==e.ID),t.push(null!=D?new Date(a.e.String(C[D.DisplayMember+"_Key"])).ToString("dd/MMM/yyyy"):a.e.IsEmpty(C.RetestDate)?null:new Date(C.RetestDate.toString()).ToString("dd/MMM/yyyy")),t.push(0),e.StaticFieldsQuery=s.toString(),e.CustomFieldsQuery=o.toString(),e.CustomCostCenterFieldsQuery=l.toString()}else if(92==this.CostCenterID){let e={};e.PropertyID=parseInt(C.NodeID),e.GUID=C.GUID.toString(),e.IsGroup=Object(r.j)(C.IsGroup);let t=this.EditColumns.find(e=>"Code"==e.ID);e.Code=null!=t?C[t.DisplayMember].toString():C.Code.toString(),t=this.EditColumns.find(e=>"Name"==e.ID),e.Name=null!=t?C[t.DisplayMember].toString():C.Name.toString(),t=this.EditColumns.find(e=>"Status"==e.ID),e.StatusID=null!=t&&C[t.ValueBinding].toString().length>0?parseInt(C[t.ValueBinding]):parseInt(C.Status),e.DetailsXML=s.toString(),e.CustomFieldsQuery=o.toString(),e.CustomCostCenterFieldsQuery=l.toString(),n.a.rental.SaveProperty(e,"SaveProperty").subscribe(e=>{this.DisplayMessage=e.Message,this.MessageVisibility=!0},e=>{console.log(" Property Save : "+JSON.stringify(e))})}else if(93==this.CostCenterID){let e={};e.UnitID=parseInt(C.UnitID),e.GUID=C.GUID.toString(),e.IsGroup=Object(r.j)(C.IsGroup),D=this.EditColumns.find(e=>"PropertyID"==e.ID),e.Property=null!=D&&C[D.ValueBinding].toString().length>0?parseInt(C[D.ValueBinding]):!a.e.IsEmpty(C.PropertyID)&&C.PropertyID.toString().length>0?parseInt(C.PropertyID):0,D=this.EditColumns.find(e=>"Code"==e.ID),e.Code=null!=D?C[D.DisplayMember].toString():C.Code.toString(),D=this.EditColumns.find(e=>"Name"==e.ID),e.Name=null!=D?C[D.DisplayMember].toString():C.Name.toString(),D=this.EditColumns.find(e=>"Status"==e.ID),e.StatusID=null!=D&&C[D.ValueBinding].toString().length>0?parseInt(C[D.ValueBinding]):parseInt(C.Status),D=this.EditColumns.find(e=>"NodeID"==e.ID),e.UnitType=null!=D&&C[D.ValueBinding].toString().length>0?parseInt(C[D.ValueBinding]):!a.e.IsEmpty(C.NodeID)&&C.NodeID.toString().length>0?parseInt(C.NodeID):0,D=this.EditColumns.find(e=>"UnitType"==e.ID),e.TypeofUnit=null!=D&&C[D.ValueBinding].toString().length>0?parseInt(C[D.ValueBinding]):!a.e.IsEmpty(C.UnitType)&&C.UnitType.toString().length>0?parseInt(C.UnitType):0,D=this.EditColumns.find(e=>"UnitStatus"==e.ID),e.UnitStatus=null!=D&&C[D.ValueBinding].toString().length>0?parseInt(C[D.ValueBinding]):!a.e.IsEmpty(C.UnitStatus)&&C.UnitStatus.toString().length>0?parseInt(C.UnitStatus):0,D=this.EditColumns.find(e=>"RentableArea"==e.ID),e.RentalArea=null!=D&&C[D.DisplayMember].toString().length>0?parseFloat(C[D.DisplayMember]):!a.e.IsEmpty(C.RentableArea)&&C.RentableArea.toString().length>0?parseFloat(C.RentableArea):0,D=this.EditColumns.find(e=>"BuildUpArea"==e.ID),e.BuildUpArea=null!=D&&C[D.DisplayMember].toString().length>0?parseFloat(C[D.DisplayMember]):!a.e.IsEmpty(C.BuildUpArea)&&C.BuildUpArea.toString().length>0?parseFloat(C.BuildUpArea):0,D=this.EditColumns.find(e=>"FloorLookupID"==e.ID),e.Floor=null!=D&&C[D.ValueBinding].toString().length>0?parseInt(C[D.ValueBinding]):!a.e.IsEmpty(C.FloorLookupID)&&C.FloorLookupID.toString().length>0?parseInt(C.FloorLookupID):0,D=this.EditColumns.find(e=>"ViewLookupID"==e.ID),e.View=null!=D&&C[D.ValueBinding].toString().length>0?parseInt(C[D.ValueBinding]):!a.e.IsEmpty(C.ViewLookupID)&&C.ViewLookupID.toString().length>0?parseInt(C.ViewLookupID):0,D=this.EditColumns.find(e=>"NoOfBathrooms"==e.ID),e.NoOfBathrooms=null!=D&&C[D.DisplayMember].toString().length>0?parseFloat(C[D.DisplayMember]):!a.e.IsEmpty(C.NoOfBathrooms)&&C.NoOfBathrooms.toString().length>0?parseFloat(C.NoOfBathrooms):0,D=this.EditColumns.find(e=>"NoOfParkings"==e.ID),e.NoOfParkings=null!=D&&C[D.DisplayMember].toString().length>0?parseFloat(C[D.DisplayMember]):!a.e.IsEmpty(C.NoOfParkings)&&C.NoOfParkings.toString().length>0?parseFloat(C.NoOfParkings):0,D=this.EditColumns.find(e=>"ElectricityCode"==e.ID),e.ElectricityCode=null!=D?C[D.DisplayMember].toString():a.e.IsEmpty(C.ElectricityCode)?"":C.ElectricityCode.toString(),D=this.EditColumns.find(e=>"ElectricityKW"==e.ID),e.Electricity=null!=D&&C[D.DisplayMember].toString().length>0?parseFloat(C[D.DisplayMember]):!a.e.IsEmpty(C.ElectricityKW)&&C.ElectricityKW.toString().length>0?parseFloat(C.ElectricityKW):0,D=this.EditColumns.find(e=>"Rent"==e.ID),e.Amount=null!=D&&C[D.DisplayMember].toString().length>0?parseFloat(C[D.DisplayMember]):!a.e.IsEmpty(C.Rent)&&C.Rent.toString().length>0?parseFloat(C.Rent):0,D=this.EditColumns.find(e=>"RentTypeID"==e.ID),e.AmountType=null!=D&&C[D.ValueBinding].toString().length>0?parseInt(C[D.ValueBinding]):!a.e.IsEmpty(C.RentTypeID)&&C.RentTypeID.toString().length>0?parseInt(C.RentTypeID):0,D=this.EditColumns.find(e=>"DiscountAmount"==e.ID),e.Discount=null!=D&&C[D.DisplayMember].toString().length>0?parseFloat(C[D.DisplayMember]):!a.e.IsEmpty(C.DiscountAmount)&&C.DiscountAmount.toString().length>0?parseFloat(C.DiscountAmount):0,D=this.EditColumns.find(e=>"DiscountPercentage"==e.ID),e.DiscountPercentage=null!=D&&C[D.DisplayMember].toString().length>0?parseFloat(C[D.DisplayMember]):!a.e.IsEmpty(C.DiscountPercentage)&&C.DiscountPercentage.toString().length>0?parseFloat(C.DiscountPercentage):0,D=this.EditColumns.find(e=>"AnnualRent"==e.ID),e.AnnaulRent=null!=D&&C[D.DisplayMember].toString().length>0?parseFloat(C[D.DisplayMember]):!a.e.IsEmpty(C.AnnualRent)&&C.AnnualRent.toString().length>0?parseFloat(C.AnnualRent):0,D=this.EditColumns.find(e=>"MonthlyRent"==e.ID),e.MonthlyRent=null!=D&&C[D.DisplayMember].toString().length>0?parseFloat(C[D.DisplayMember]):!a.e.IsEmpty(C.MonthlyRent)&&C.MonthlyRent.toString().length>0?parseFloat(C.MonthlyRent):0,D=this.EditColumns.find(e=>"RentPerSQFT"==e.ID),e.RentperSqft=null!=D&&C[D.DisplayMember].toString().length>0?parseFloat(C[D.DisplayMember]):!a.e.IsEmpty(C.RentPerSQFT)&&C.RentPerSQFT.toString().length>0?parseFloat(C.RentPerSQFT):0,D=this.EditColumns.find(e=>"TermsConditions"==e.ID),e.TermsConditions=null!=D?C[D.DisplayMember].toString():a.e.IsEmpty(C.TermsConditions)?"":C.TermsConditions.toString(),D=this.EditColumns.find(e=>"AccountantID"==e.ID),e.Accountant=null!=D&&C[D.ValueBinding].toString().length>0?parseInt(C[D.ValueBinding]):!a.e.IsEmpty(C.AccountantID)&&C.AccountantID.toString().length>0?parseInt(C.AccountantID):0,D=this.EditColumns.find(e=>"SalesmanID"==e.ID),e.Salesman=null!=D&&C[D.ValueBinding].toString().length>0?parseInt(C[D.ValueBinding]):!a.e.IsEmpty(C.SalesmanID)&&C.SalesmanID.toString().length>0?parseInt(C.SalesmanID):0,D=this.EditColumns.find(e=>"LandlordID"==e.ID),e.Landlord=null!=D&&C[D.ValueBinding].toString().length>0?parseInt(C[D.ValueBinding]):!a.e.IsEmpty(C.LandlordID)&&C.LandlordID.toString().length>0?parseInt(C.LandlordID):0,D=this.EditColumns.find(e=>"RentalIncomeAccountID"==e.ID),e.RentalIncomeAcc=null!=D&&C[D.ValueBinding].toString().length>0?parseInt(C[D.ValueBinding]):!a.e.IsEmpty(C.RentalIncomeAccountID)&&C.RentalIncomeAccountID.toString().length>0?parseInt(C.RentalIncomeAccountID):0,D=this.EditColumns.find(e=>"PenaltyAccountID"==e.ID),e.PenaltyAcc=null!=D&&C[D.ValueBinding].toString().length>0?parseInt(C[D.ValueBinding]):!a.e.IsEmpty(C.PenaltyAccountID)&&C.PenaltyAccountID.toString().length>0?parseInt(C.PenaltyAccountID):0,D=this.EditColumns.find(e=>"RentalReceivableAccountID"==e.ID),e.RentalReceivableAcc=null!=D&&C[D.ValueBinding].toString().length>0?parseInt(C[D.ValueBinding]):!a.e.IsEmpty(C.RentalReceivableAccountID)&&C.RentalReceivableAccountID.toString().length>0?parseInt(C.RentalReceivableAccountID):0,D=this.EditColumns.find(e=>"AdvanceRentAccountID"==e.ID),e.AdvanceRentAcc=null!=D&&C[D.ValueBinding].toString().length>0?parseInt(C[D.ValueBinding]):!a.e.IsEmpty(C.AdvanceRentAccountID)&&C.AdvanceRentAccountID.toString().length>0?parseInt(C.AdvanceRentAccountID):0,D=this.EditColumns.find(e=>"ProvisionAccountID"==e.ID),e.ProvisionAccountID=null!=D&&C[D.ValueBinding].toString().length>0?parseInt(C[D.ValueBinding]):!a.e.IsEmpty(C.ProvisionAccountID)&&C.ProvisionAccountID.toString().length>0?parseInt(C.ProvisionAccountID):0,D=this.EditColumns.find(e=>"BankAccount"==e.ID),e.BankAcc=null!=D&&C[D.ValueBinding].toString().length>0?parseInt(C[D.ValueBinding]):!a.e.IsEmpty(C.BankAccount)&&C.BankAccount.toString().length>0?parseInt(C.BankAccount):0,D=this.EditColumns.find(e=>"BankLoanAccount"==e.ID),e.BankLoanAcc=null!=D&&C[D.ValueBinding].toString().length>0?parseInt(C[D.ValueBinding]):!a.e.IsEmpty(C.BankLoanAccount)&&C.BankLoanAccount.toString().length>0?parseInt(C.BankLoanAccount):0,D=this.EditColumns.find(e=>"AdvanceReceivableAccountID"==e.ID),e.AdvanceReceivableAcc=null!=D&&C[D.ValueBinding].toString().length>0?parseInt(C[D.ValueBinding]):!a.e.IsEmpty(C.AdvanceReceivableAccountID)&&C.AdvanceReceivableAccountID.toString().length>0?parseInt(C.AdvanceReceivableAccountID):0,D=this.EditColumns.find(e=>"AdvReceivableCloseAccID"==e.ID),e.AdvReceivableCloseAcc=null!=D&&C[D.ValueBinding].toString().length>0?parseInt(C[D.ValueBinding]):!a.e.IsEmpty(C.AdvReceivableCloseAccID)&&C.AdvReceivableCloseAccID.toString().length>0?parseInt(C.AdvReceivableCloseAccID):0,D=this.EditColumns.find(e=>"RentalAccount"==e.ID),e.RentAcc=null!=D&&C[D.ValueBinding].toString().length>0?parseInt(C[D.ValueBinding]):!a.e.IsEmpty(C.RentalAccount)&&C.RentalAccount.toString().length>0?parseInt(C.RentalAccount):0,D=this.EditColumns.find(e=>"RentPayableAccount"==e.ID),e.RentPayableAcc=null!=D&&C[D.ValueBinding].toString().length>0?parseInt(C[D.ValueBinding]):!a.e.IsEmpty(C.RentPayableAccount)&&C.RentPayableAccount.toString().length>0?parseInt(C.RentPayableAccount):0,D=this.EditColumns.find(e=>"AdvanceRentPaid"==e.ID),e.AdvanceRentPaid=null!=D&&C[D.ValueBinding].toString().length>0?parseInt(C[D.ValueBinding]):!a.e.IsEmpty(C.AdvanceRentPaid)&&C.AdvanceRentPaid.toString().length>0?parseInt(C.AdvanceRentPaid):0,D=this.EditColumns.find(e=>"TenantID"==e.ID),e.TenantID=null!=D&&C[D.ValueBinding].toString().length>0?parseInt(C[D.ValueBinding]):!a.e.IsEmpty(C.TenantID)&&C.TenantID.toString().length>0?parseInt(C.TenantID):0,D=this.EditColumns.find(e=>"LocationID"==e.ID),e.LocationID=null!=D&&C[D.ValueBinding].toString().length>0?parseInt(C[D.ValueBinding]):!a.e.IsEmpty(C.LocationID)&&C.LocationID.toString().length>0?parseInt(C.LocationID):0,D=this.EditColumns.find(e=>"BasedOn"==e.ID),e.BasedOn=null!=D?C[D.DisplayMember].toString():C.BasedOn.toString(),e.PostIncome=a.e.String(C.PostIncome),e.CustomFieldsQuery=o.toString(),e.CustomCCQuery=l.toString(),n.a.rental.SaveUnits(e,"SaveUnits").subscribe(e=>{this.DisplayMessage=e.Message},e=>{console.log(" Unit Save : "+JSON.stringify(e))})}else if(95==this.CostCenterID){o.Remove(o.length-1,1);let e=null;Object.keys(C).Contains("ContractID")&&(e=n.a.common.BulkEditDetals_7(11,parseInt(C.ContractID),this.CostCenterID,"",o.toString(),"","")),C.Message=e.retvalue&&e.retvalue>0?"Success":null!=e&&e.Tables.length>0&&e.Tables[0].length>0&&e.Columns[0].Contains("ServerMessage")?"Failure : "+e.Tables[0][0].ServerMessage.toString():null!=e&&e.Tables.length>0&&e.Tables[0].length>0&&e.Columns[0].Contains("ErrorMessage")?"Failure : "+e.Tables[0][0].ErrorMessage.toString():"Failure"}else if(this.CostCenterID>=50001&&this.CostCenterID<=50050){let e={};e.NodeID=parseInt(C.NodeID),e.GUID=a.e.String(C.GUID),e.CostCenterID=this.CostCenterID;let r=this.EditColumns.find(e=>"Code"==e.ID);e.Code=a.e.String(null!=r?C[r.DisplayMember]:C.Code),r=this.EditColumns.find(e=>"Name"==e.ID),e.Name=a.e.String(null!=r?C[r.DisplayMember]:C.Name),r=this.EditColumns.find(e=>"StatusID"==e.ID),e.Status=null!=r&&a.e.String(C[r.ValueBinding]).length>0?parseInt(a.e.String(C[r.ValueBinding])):parseInt(C.StatusID),e.StaticFieldsQuery=s.toString(),e.CustomFieldsQuery=o.toString(),e.CustomCostCenterFieldsQuery=l.toString(),e.CCXML="",n.a.common.SaveCostCenterQuick(e,"SaveCostCenterQuick").subscribe(e=>{if(i=e.Message,t=e.RetValue,t>0){C.Message="Success",this.EditGrid.updateRow(C);let e=n.a.common.BulkEditDetals_7(8,t,this.CostCenterID,"","","","").ds;null!=e&&e.Tables.length>0&&e.Tables[0].length>0&&e.Columns[0].Contains("GUID")&&(C.GUID=a.e.String(e.Tables[0][0].GUID))}else C.Message="Failure : "+i,this.EditGrid.updateRow(C)},e=>{alert(JSON.stringify(e)),console.log("Bulk Quick Add CostCenter Save : "+JSON.stringify(e))})}}catch(u){Logger.ErrorLog("BulkEdit-SAVE: ",u.Message)}else C.Message="NO DATA",this.EditGrid.updateRow(C)}}DeleteDimension(e){let t,i="",s="";i=null!=this.ReportObj?"ReportPK":this.PrimaryKey;let o=0;for(let l=0;l<e.length;l++){const h=e[l];try{if(t=0,null!=this.ReportObj&&a.e.IsEmpty(h.ReportPK))continue;if(2==this.CostCenterID){let e={};e.AccountID=parseInt(h[i]);let a=n.a.accounting.DeleteAccount(e.AccountID);s=a.Message,t=a.RetValue}else if(3==this.CostCenterID){let e=n.a.inventory.DeleteProduct(parseInt(h[i]));s=e.Message,t=e.RetValue}else if(this.CostCenterID>=50001&&this.CostCenterID<=50050){let e={};e.NodeID=parseInt(h[i]),e.CostCenterID=this.CostCenterID;let a=n.a.common.DeleteCostCenter(e.CostCenterID,e.NodeID);s=a.Message,t=a.RetValue}else s="Functionality not implemented";t>0?(o++,this.EditGrid.removeRow(h)):(h.Message="Failure : "+s,this.EditGrid.updateRow(h))}catch(r){Logger.ErrorLog("BulkEdit-DELETE: ",r.Message)}}this.DisplayMessage=o+" Records Deleted"}OnRowSelection(e){return!1}Cancelclick(){this.ApproveVisibility=!1,n.a.page.HideDialog(),null!=this.DB&&(this.ShowRightPanel=!1)}onClickIkon(e){this.ApprovalClick(e,null)}ApprovalClick(e,t){if(this.DisplayMessage="","Approve"==e||"Reject"==e||"Suspend"==e){if(this.RemarksApprove&&"Approve"==e&&a.e.IsEmptySpace(this.Remarks.Text))return this.DisplayMessage="Approve Remarks Mandatory",-1;if(this.RemarksReject&&"Reject"==e&&a.e.IsEmptySpace(this.Remarks.Text))return this.DisplayMessage="Reject Remarks Mandatory",-1;if(this.RemarksSuspend&&"Suspend"==e&&a.e.IsEmptySpace(this.Remarks.Text))return this.DisplayMessage="Suspend Remarks Mandatory",-1;if(2==this.CostCenterID?this.strVoucherNo="AccountID":3==this.CostCenterID?this.strVoucherNo="ProductID":95==this.CostCenterID?this.strVoucherNo="ContractID":this.CostCenterID>5e4?this.strVoucherNo="NodeID":null!=this.ReportObj&&this.EditGrid.TableColumns.Contains("ReportPK")&&(this.strVoucherNo="ReportPK"),null==t&&(t=this.EditGrid.Table.filter(e=>1==e.Select||1==e.Select)),0==t.length)return this.DisplayMessage="No Rows Selected",-1;let i="",s="",o=!1,r=0;if(o=0!=a.e.stringCompare(this.MainTableName,"ACC_DocDetails",!0),"Approve"==e?r=1:"Suspend"==e&&(r=2),this.IsDocument)if(this.IsLWApproval&&"Suspend"!=e){let e=this.PrimaryKey;null!=this.ReportObj&&(e="ReportPK");let s,n=null,o="";t.forEach(t=>{s=a.e.String(t[this.strVoucherNo]),s!=n&&(o.length>0&&(i.length>0&&(i+="\x11"),i+='<XML No="'+n+'">'+o+"</XML>"),o="",n=s),o+='<Row ID="'+a.e.String(t[e])+'" Remarks="'+a.e.EncodeXML(this.Remarks.Text)+'" WID="'+a.e.String(t.WorkflowID)+'"/>'}),o.length>0&&(i.length>0&&(i+="\x11"),i+='<XML No="'+n+'">'+o+"</XML>")}else t.forEach(e=>{if(i+=a.e.String(e[this.strVoucherNo])+",",!a.e.IsEmpty(e[this.strVoucherNo])&&"BUA-"==e[this.strVoucherNo].toString().substr(0,4)){let t=0,i=0,o=0,r=0,l=!1,h="",D="",u=new Date,d=new Date,C=new Date,c=n.a.common.GetDataSet3("BULK003",a.e.String(e[this.strVoucherNo]),"","").Tables[0];if(null!=c&&c.length>0){t=parseInt(c[0].EmpSeqNo),u=new Date(c[0].EffectFrom),d=new Date(c[0].ApplyFrom),C=new Date(c[0].NextAppraisalDate),h=c[0].Remarks.toString(),D=c[0].Reason.toString();let m=n.a.common.GetDataSet3("BULK004",a.e.String(t),u.iMonth().toString(),u.getFullYear().toString()).Tables[0];o=null!=m&&m.length>0?parseInt(m[0].SeqNo):0;let p=new y.a(null,t,new Date,o);p.isFromBulkAppraisals=!0,p.EffectFrom.Date=u,p.ActAppraisalFrom.Date=d,p.NextAppraisal.Date=C,p.Remarks.Text=h,p.Reason.Text=D;for(let e=0;e<c.length;e++){i=parseInt(c[e].ComponentID),r=parseFloat(c[e].Amt),l=!1;for(let e=0;e<p.dgvEarnings.Table.length;e++)if(p.dgvEarnings.Table[e].EarComponentID.toString()==i.toString()){p.dgvEarnings.Table[e].EarValue=r,l=!0;break}if(!l)for(let e=0;e<p.dgvDeductions.Table.length;e++)if(p.dgvDeductions.Table[e].DedComponentID.toString()==i.toString()){p.dgvDeductions.Table[e].DedValue=r;break}}p.ExecuteFormulas(),p.OnButtonClick("Save"),null!=p.DisplayMessage&&p.DisplayMessage.length>0||p.strUpdate.length>0&&(s+='<Row EmpNodeID="'+t+'" ',s+=' VoucherNo ="'+e[this.strVoucherNo].toString()+'" ',s+=' Query ="'+p.strUpdate+'" ',s+="/>")}}}),i=i.substr(0,i.length-1),s.length>0&&(s="<Data>"+s+"</Data>");else t.forEach(e=>{i+=a.e.String(e[this.strVoucherNo])+","}),i=i.substr(0,i.length-1);if(i.length>0){let l=0,h=n.a.common.BulkApprovals(this.CostCenterID,o,this.Remarks.Text,i.toString(),r,this.AppRejDate.Date.ToString("dd/MMM/yyyy"),s);return l=a.e.Int(h.obj),l>0?(this.Remarks.Text="",t.forEach(e=>{this.EditGrid.removeRow(e)}),"Suspend"==e&&(this.Report.length>0?this.Report[0].Refresh():this.RefreshData()),this.DisplayMessage="Approve"==e?e+"d Successfully":e+"ed Successfully"):this.DisplayMessage="Error in Save",l}}return 0}BarcodeDocument(e){if(0==this.EditColumns.length)return void(this.DisplayMessage="Please select ateleast one editable column.");if(null==e[0][this.EditColumns[0].DisplayMember])return void(this.DisplayMessage="Selected editable column not found.");let t,i,s,n="";if(!(this.CostCenterID>4e4&&this.CostCenterID<5e4))return void(this.DisplayMessage="Not implemented");i=0==a.e.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?"AccDocDetailsID":"InvDocDetailsID",t=null!=this.ReportObj?"ReportPK":i;let r,l=new o.a;e.forEach(e=>{s=a.e.String(e[this.strVoucherNo]),l.ContainsKey(s)||l.push(s,[]),l[s].push(e)}),l.forEach(e=>{n="",n+="<XML IgnorePositionDialog='1'>",e.Value.forEach(e=>{e.Message=null,r=a.e.IntTryParse(a.e.String(e[this.EditColumns[0].DisplayMember])),r>0?n+='<R DocDetailsID="'+a.e.String(e[t])+'" Qty="'+a.e.String(e[this.EditColumns[0].DisplayMember])+'"/>':e.Message="Invalid Quantity"}),n+="</XML>";let i=this.PrintBarcode(e.Key,n.toString());e.Value.forEach(e=>{null==e.Message&&(e.Message=i)})})}PrintBarcode(e,t){let i,s=0,o=0,r=n.a.report.GetDocumentDetailsByVoucherNo(e);if(i=a.e.Int(r.obj),!(i>0))return"Voucher Not Found";{let e;e=r.Tables[0].length>0?r.Tables[0][0]:r.Tables[1][0],s=parseInt(e.CostCenterID),o=parseInt(e.DocID)}return"Success"}OnDateRangesSelectionChanged(e){null!=this.DateRanges.SelectedValue&&g.a.SetDateRanges(this.DateRanges.SelectedValue,this.FromDate,this.ToDate)}}class b{constructor(e,t){this.dsFields=null,this.CostCenterID=0,this.ClassName="BulkEditViewModel",this.dsFields=e,this.Parent=t,(t.ClassName="BulkEditViewModel")&&(this.CostCenterID=t.CostCenterID),this.FilterGrid=new d.a,this.FilterGrid.Width="",this.FilterGrid.Height=200,this.FilterGrid.CanUserAddRows=!0,this.FilterGrid.CanUserDeleteRows=!0,this.FilterGrid.BeginEdit.Subscribe(this,"OnBeginEditing"),this.FilterGrid.CellEditEnding.Subscribe(this,"OnCellEditCommiting");let i=[],s=new C.a,n=[],a={AND:"AND",Value:"AND"};n.push(a),a={},a.AND="OR",a.Value="OR",n.push(a),a={},a.AND="(",a.Value="(",n.push(a),a={},a.AND=")",a.Value=")",n.push(a),s=new C.a,s.ComboData=n,s.DisplayMember="AND",s.ValueMember="Value",s.ValueBinding="And",s.Header="AND/OR",s.DataType="ComboBox",s.Width=80,s.IsVisible=!0,i.push(s),s=new C.a,null!=e&&(s.ComboData=e.Tables[0]),s.DisplayMember="UserColumnName",s.ValueMember="CostCenterColID",s.ValueBinding="Field",s.DataType="ComboBox",s.Header="Column",s.Width=200,s.IsVisible=!0,i.push(s),s=new C.a,s.ComboData=this.ReturnCondition(),s.DisplayMember="Condition",s.ValueMember="Value",s.ValueBinding="Condition",s.DataType="ComboBox",s.Header="Condition",s.Width=120,s.IsVisible=!0,i.push(s),s=new C.a,s.Header="Value",s.DisplayMember="MULTI",s.DataType="MULTI_TYPE",s.Width=150,i.push(s),this.FilterGrid.Columns=i,this.FilterGrid.Clear(),this.FilterGrid.TableColumns.push("And"),this.FilterGrid.TableColumns.push("Column"),this.FilterGrid.TableColumns.push("Field"),this.FilterGrid.TableColumns.push("Condition"),this.FilterGrid.TableColumns.push("MULTI"),this.FilterGrid.TableColumns.push("MULTI_TYPE"),this.FilterGrid.TableColumns.push("MULTI_FLOAT"),this.FilterGrid.TableColumns.push("MULTI_DATE"),this.FilterGrid.TableColumns.push("MULTI_LISTBOX"),this.FilterGrid.TableColumns.push("MULTI_COMBOBOX");for(let o=0;o<10;o++){let e=this.FilterGrid.NewRow();this.FilterGrid.addRow(e)}}LoadXML(e){let t=new a.f;t.LoadXml(e),this.FilterGrid.Clear(),t.DocumentElement.childNodes.length>0&&t.DocumentElement.childNodes.forEach(e=>{let t=this.FilterGrid.NewRow();if(t.And=e.attributes.And.value,a.e.IsEmpty(e.attributes.Field.value)&&(t.Field=e.attributes.Field.value),t.Condition=e.attributes.Condition.value,t.MULTI_TYPE=e.attributes.ValueType.value,t.MULTI=e.attributes.Value.value,null!=e.attributes.Value_Key&&!a.e.IsEmpty(e.attributes.Value_Key.value))switch(a.e.String(t.MULTI_TYPE)){case"DATE":case"DATETIME":t.MULTI_DATE=e.attributes.Value_Key.value;break;case"LISTBOX":t.MULTI_LISTBOX=e.attributes.Value_Key.value;break;case"COMBOBOX":t.MULTI_COMBOBOX=e.attributes.Value_Key.value}this.FilterGrid.addRow(t)});for(let i=0;i<10;i++){let e=this.FilterGrid.NewRow();this.FilterGrid.addRow(e)}}GetXML(){let e="";e+="<XML>";let t=0;for(let i=0;i<this.FilterGrid.Table.length;i++){const s=this.FilterGrid.Table[i];if(t++,""!=a.e.String(s.And)||""!=a.e.String(s.Field)){switch(e+='<Row And="',1==t&&"("!=a.e.String(s.And)||(e+=a.e.String(s.And)),e+='"',e+=' Field="'+a.e.String(s.Field)+'"',e+=' Condition="'+a.e.EncodeXML(a.e.String(s.Condition))+'"',e+=' ValueType="'+a.e.EncodeXML(a.e.String(s.MULTI_TYPE))+'"',e+=' Value="'+a.e.EncodeXML(a.e.String(s.MULTI))+'"',a.e.String(s.MULTI_TYPE)){case"DATE":e+=' Value_Key="'+a.e.EncodeXML(a.e.String(s.MULTI_DATE))+'"';break;case"LISTBOX":e+=' Value_Key="'+a.e.EncodeXML(a.e.String(s.MULTI_LISTBOX))+'"';break;case"COMBOBOX":e+=' Value_Key="'+a.e.EncodeXML(a.e.String(s.MULTI_COMBOBOX))+'"'}e+="/>"}}return e+="</XML>",e.toString()}SetFieldsData(e,t){this.dsFields=e,this.CostCenterID=t;let i=[];this.FilterGrid.Columns[1].ComboData=e.Tables[0],this.FilterGrid.Columns.forEach(e=>{i.push(e)}),this.FilterGrid.Columns=i}ReturnCondition(){let e=[],t={Condition:"Equals",Value:"=",Type:"3"};return e.push(t),t={},t.Condition="Does Not Equals",t.Value="<>",t.Type="3",e.push(t),t={},t.Condition="Is greater than",t.Value=">",t.Type="2",e.push(t),t={},t.Condition="Is greater than or equals to",t.Value=">=",t.Type="2",e.push(t),t={},t.Condition="Is less than",t.Value="<",t.Type="2",e.push(t),t={},t.Condition="Is less than or equals to",t.Value="<=",t.Type="2",e.push(t),t={},t.Condition="Contains",t.Value="LIKE",t.Type="1",e.push(t),t={},t.Condition="Does Not Contains",t.Value="NOT LIKE",t.Type="1",e.push(t),t={},t.Condition="Is Null",t.Value="IS NULL",t.Type="1",e.push(t),t={},t.Condition="Is Not Null",t.Value="IS NOT NULL",t.Type="1",e.push(t),e}OnCellEditCommiting(e){let t=e.item;if("Field"==e.column.field){if(null==this.dsFields)return;let e=""==a.e.String(t.Field)?[]:this.dsFields.Tables[0].filter(e=>e.CostCenterColID==a.e.String(t.Field));if(0==e.length)return t.MULTI="",t.MULTI_TYPE="",t.MULTI_FLOAT=null,t.MULTI_DATE=null,t.MULTI_LISTBOX=null,void(t.MULTI_COMBOBOX=null);let i=parseInt(t.Field),s=a.e.String(e[0].UserColumnType).toUpperCase();t.MULTI_TYPE="DATE"==s?"DATE":"FLOAT"==s||"NUMERIC"==s?"FLOAT":"LISTBOX"==s?"="==a.e.String(t.Condition)||"<>"==a.e.String(t.Condition)?"LISTBOX":"":241!=i&&264!=i&&252!=i&&"StatusID"!=a.e.String(e[0].SysColumnName)||"="!=a.e.String(t.Condition)&&"<>"!=a.e.String(t.Condition)?"":"COMBOBOX"}}OnBeginEditing(e){let t=e.args.item,i=e.args.column.field;if("Field"==i);else if("Condition"==i);else if("MULTI"==i){let i=""==a.e.String(t.Field)?[]:this.dsFields.Tables[0].filter(e=>e.CostCenterColID==a.e.String(t.Field));if(0==i.length)return void(e.Cancel=!0);let s=parseInt(t.Field),n=a.e.String(i[0].UserColumnType).toUpperCase();if("DATE"==n)t.MULTI_TYPE="DATE";else if("FLOAT"==n||"NUMERIC"==n)t.MULTI_TYPE="FLOAT";else if("LISTBOX"==n)e.args.column.CostCenterID=parseInt(a.e.String(i[0].ColumnCostCenterID)),e.args.column.TypeID=parseInt(a.e.String(i[0].ColumnCCListViewTypeID)),t.MULTI_TYPE="="==a.e.String(t.Condition)||"<>"==a.e.String(t.Condition)?"LISTBOX":"";else if(241==s||264==s||252==s||"StatusID"==a.e.String(i[0].SysColumnName))if("="==t.Condition.toString()||"<>"==a.e.String(t.Condition)){t.MULTI_TYPE="COMBOBOX";let n=new Array,o=null;241==s||264==s?o=this.dsFields.Tables[4]:252==s?o=b.GetBillWiseTable():"StatusID"==a.e.String(i[0].SysColumnName)&&(o=this.CostCenterID>4e4&&this.CostCenterID<5e4?this.dsFields.Tables[2]:this.dsFields.Tables[1]),o.forEach(e=>{n.push(c.d.ComboBoxItems_2(a.e.String(e[Object.keys(e)[1]]),a.e.String(e[Object.keys(e)[0]])))}),e.args.column.ComboItems=n}else t.MULTI_TYPE="";else t.MULTI_TYPE=""}}GetWhere(e,t){let i,s,o,l,h,D,u="",d=0,C=this.Parent,c="",m="",p=C.Entities,I=t;if(d=C.CostCenterID,i=C.IsDetailVoucher,C.IsDocument&&(m=0==a.e.stringCompare(C.MainTableName,"ACC_DocDetails",!0)?"AccDocDetailsID":"InvDocDetailsID"),d>4e4&&d<5e4){for(let e=0;e<this.FilterGrid.Table.length;e++){const i=this.FilterGrid.Table[e];if(I++,a.e.IsEmpty(i.And)&&a.e.IsEmpty(i.Field))continue;I==t+1&&"("!=a.e.String(i.And)||(u+=" "+a.e.String(i.And)+" ");let d=a.e.IsEmpty(i.Field)?[]:this.dsFields.Tables[0].filter(e=>e.CostCenterColID==a.e.String(i.Field));if(0==d.length)continue;let m=d[0];if(D="T"+I.toString(),h=a.e.String(m.SysTableName),l=a.e.String(m.SysColumnName),s=o="",0==a.e.stringCompare(h,"COM_DocTextData"))if(p.ContainsKey("COM_DocTextData")||p.push("COM_DocTextData","TXT"),l="TXT."+l,"DATE"==a.e.String(m.ColumnDataType)&&"IS NOT NULL"!=a.e.String(i.Condition)&&"IS NULL"!=a.e.String(i.Condition))l=" isdate("+l+")=1 and convert(datetime,"+l+")",s=o=l;else if("LISTBOX"==a.e.String(m.UserColumnType)){let e;if("44"==a.e.String(m.ColumnCostCenterID))e="case when "+l+" is not null and isnumeric("+l+")=1 then (SELECT Name FROM COM_Lookup with(nolock) WHERE NodeID="+l+") else '' end";else{let t=n.a.report.GetTableColumns(parseInt(m.ColumnCostCenterID));e=t.ColumnName,c=t.PrimaryKey,h=t.TableName,e="case when "+l+" is not null and isnumeric("+l+")=1 then (SELECT "+e+" FROM "+h+" with(nolock) WHERE "+c+"="+l+") else '' end"}s=e,o=l}else"LOOKUP"==a.e.String(m.UserColumnType)||(s=o=l);else 0==a.e.stringCompare(h,"COM_DocCCData")?(p.ContainsKey("COM_DocCCData")||p.push("COM_DocCCData","DCC"),p.ContainsKey(l)||(p.push(l,D),a.e.GetTagTableName(parseInt(m.ParentCostCenterID))),s=null==m||a.e.IsEmpty(m.ShowCode)||"YES"!=a.e.String(m.ShowCode)?p[l]+".Name":p[l]+".Code",o="DCC."+l):null!=m.IsForeignKey&&Object(r.j)(m.IsForeignKey)&&0==["AccountTypeID","StatusID"].Contains(l)?(p.ContainsKey(l)||(p.push(l,D),a.e.String(m.ParentCostCenterSysName),a.e.String(m.ParentCostCenterColSysName)),s=p[l]+"."+C.GetColumnName(m),o="D."+l):(l="D."+l,"DATE"==a.e.String(m.ColumnDataType)?(l="convert(datetime,"+l+")",s=o=l):s=o=l);let g=a.e.String(i.MULTI_TYPE);switch(a.e.String(i.Condition)){case"=":case"<>":if("LISTBOX"==g){let e;e=a.e.IntTryParse(a.e.String(i.MULTI_LISTBOX)),u+=" "+o+a.e.String(i.Condition)+e.toString()}else"COMBOBOX"==g?a.e.String(i.MULTI_COMBOBOX).length>0&&(u+=" "+o+a.e.String(i.Condition)+"'"+a.e.String(i.MULTI_COMBOBOX)+"'"):"DATE"==g?a.e.IsEmpty(i.MULTI_DATE)?u+=" "+o+a.e.String(i.Condition)+"''":u+=" "+o+a.e.String(i.Condition)+"'"+new Date(i.MULTI_DATE).ToString("dd MMM yyyy")+"'":u+=" "+s+a.e.String(i.Condition)+"'"+a.e.String(i.MULTI)+"'";break;case"LIKE":case"NOT LIKE":u+=" "+s+" "+a.e.String(i.Condition)+" '%"+a.e.String(i.MULTI)+"%'";break;case"IS NULL":case"IS NOT NULL":u+=" "+s+" "+a.e.String(i.Condition);break;case">":case">=":case"<":case"<=":u+="DATE"==g?" "+o+a.e.String(i.Condition)+"'"+new Date(i.MULTI_DATE).ToString("dd MMM yyyy")+"'":" "+s+a.e.String(i.Condition)+"'%"+a.e.String(i.MULTI)+"'%"}}C.IsApproval&&500==t&&(u.length>0&&(u+=" and "),n.a.SessionManager.Preferences.ContainsKey("CanApproveFunction")&&"TRUE"==n.a.SessionManager.Preferences.CanApproveFunction.toUpperCase()?u+=" D.WorkFlowID>0 AND dbo.fnExt_CanApprove(D."+m+",D.CostCenterID,D.WorkflowID,D.WorkFlowLevel,D.StatusID,D.CreatedDate,"+n.a.SessionManager.UserID+","+n.a.SessionManager.RoleID+")=1":u+=" D.WorkFlowID>0 AND dbo.[fnRPT_CanApprove](D.CostCenterID,D.WorkflowID,D.WorkFlowLevel,D.StatusID,D.CreatedDate,"+n.a.SessionManager.UserID+","+n.a.SessionManager.RoleID+")=1")}else{for(let e=0;e<this.FilterGrid.Table.length;e++){const i=this.FilterGrid.Table[e];if(I++,a.e.IsEmpty(i.And)&&a.e.IsEmpty(i.Field))continue;I==t+1&&"("!=a.e.String(i.And)||(u+=" "+a.e.String(i.And)+" ");let d=""==a.e.String(i.Field)?[]:this.dsFields.Tables[0].filter(e=>e.CostCenterColID==a.e.String(i.Field));if(0==d.length)continue;let m=d[0];if(D="T"+I.toString(),h=a.e.String(m.SysTableName),l=a.e.String(m.SysColumnName),s=o="",0==a.e.stringCompare(h,"ACC_AccountsExtended")||0==a.e.stringCompare(h,"INV_ProductExtended")||0==a.e.stringCompare(h,"REN_ContractExtended")||0==a.e.stringCompare(h,"REN_UnitsExtended"))if(p.ContainsKey(h)||p.push(h,"EXT"),l="EXT."+l,"DATE"==a.e.String(m.ColumnDataType))l="convert(datetime,"+l+")",s=o=l;else if("LISTBOX"==a.e.String(m.UserColumnType)){let e;if("44"==a.e.String(m.ColumnCostCenterID))e="case when "+l+" is not null and isnumeric("+l+")=1 then (SELECT Name FROM COM_Lookup with(nolock) WHERE NodeID="+l+") else '' end";else{let t=n.a.report.GetTableColumns(parseInt(m.ColumnCostCenterID));e=t.ColumnName,c=t.PrimaryKey,h=t.TableName,e="case when "+l+" is not null and isnumeric("+l+")=1 then (SELECT "+e+" FROM "+h+" with(nolock) WHERE "+c+"="+l+") else '' end"}s=e,o=l}else s=o=l;else 0==a.e.stringCompare(h,"COM_CCCCData")?(p.ContainsKey("COM_CCCCData")||p.push("COM_CCCCData","CCDATA"),p.ContainsKey(l)||(p.push(l,D),a.e.GetTagTableName(parseInt(m.ParentCostCenterID))),s=p[l]+".Name",o="CCDATA."+l):null!=m.IsForeignKey&&Object(r.j)(m.IsForeignKey)&&0==["AccountTypeID","StatusID"].Contains(l)?(p.ContainsKey(l)||(p.push(l,D),a.e.String(m.ParentCostCenterSysName),a.e.String(m.ParentCostCenterColSysName)),s=p[l]+"."+C.GetColumnName(m),o="D."+l):(l="D."+l,"DATE"==a.e.String(m.ColumnDataType)?(l="convert(datetime,"+l+")",s=o=l):s=o=l);let g=a.e.String(i.MULTI_TYPE);switch(a.e.String(i.Condition)){case"=":case"<>":if("LISTBOX"==g){let e;e=a.e.IntTryParse(a.e.String(i.MULTI_LISTBOX)),u+=" "+o+a.e.String(i.Condition)+e.toString()}else"COMBOBOX"==g?a.e.String(i.MULTI_COMBOBOX).length>0&&(u+=" "+o+a.e.String(i.Condition)+"'"+i.MULTI_COMBOBOX.toString()+"'"):u+="DATE"==g?" "+o+a.e.String(i.Condition)+"'"+new Date(i.MULTI_DATE).ToString("dd MMM yyyy")+"'":" "+s+a.e.String(i.Condition)+"'"+a.e.String(i.MULTI)+"'";break;case"LIKE":case"NOT LIKE":u+=" "+s+" "+a.e.String(i.Condition)+" '%"+a.e.String(i.MULTI)+"%'";break;case">":case">=":case"<":case"<=":u+="DATE"==g?" "+o+a.e.String(i.Condition)+"'"+new Date(i.MULTI_DATE).ToString("dd MMM yyyy")+"'":" "+s+a.e.String(i.Condition)+"'%"+a.e.String(i.MULTI)+"'%"}}C.IsApproval&&500==t&&(s=2==d?"D.AccountID":3==d?"D.ProductID":93==d?"D.UnitID":94==d?"D.TenantID":95==d?"D.ContractID":"D.NodeID",u.length>0&&(u+=" and "),u+=95==d?" D.StatusID IN (470,440,465)":" D.StatusID IN (1001,1003)",u+=95==d?" AND dbo.[fnREN_CanContractApprove]("+d+","+s+","+n.a.SessionManager.UserID+","+n.a.SessionManager.RoleID+")=1 ":" AND dbo.[fnRPT_CanCostCentetApprove]("+d+","+s+","+n.a.SessionManager.UserID+","+n.a.SessionManager.RoleID+")=1 ")}return u.toString()}static GetBillWiseTable(){let e=[],t={Value:1,Name:"YES"};return e.push(t),t.Value=0,t.Name="NO",e.push(t),e}}class E{constructor(e,t){this.Title="",this.ApplyToAll=!1,this.Parent=e,this.SourceColumn=t,this.Title=t.Header,this.FindGrid=new d.a,this.FindGrid.CanUserDeleteRows=!0,this.FindGrid.Columns=[],this.FindGrid.Columns.push(t),this.FindGrid.Columns[0].Header="Find What",this.FindGrid.Columns[0].Width=233,this.FindGrid.Table=e.EditGrid.Table;let i=this.FindGrid.NewRow();this.FindGrid.addRow(i),this.FindGrid.SelectedItem=this.FindGrid.Table[0],this.FindGrid.SelectedIndex=0,this.ReplaceGrid=new d.a,this.ReplaceGrid.CanUserDeleteRows=!0,this.ReplaceGrid.Columns=[],this.ReplaceGrid.Columns.push(t),this.ReplaceGrid.Columns[0].Header="Replace With",this.ReplaceGrid.Columns[0].Width=233,this.ReplaceGrid.Table=e.EditGrid.Table,i=this.ReplaceGrid.NewRow(),this.ReplaceGrid.addRow(i),this.ReplaceGrid.SelectedItem=this.ReplaceGrid.Table[0],this.ReplaceGrid.SelectedIndex=0}OnButtonClick(e){if(this.Parent.DisplayMessage="","Replace"==e){let e=!1,t=this.SourceColumn.SectionName+"_Key";this.Parent.EditGrid.TableColumns.Contains(t)?e=!0:t=this.SourceColumn.SectionName;let i=a.e.String(this.FindGrid.Table[0][t]);if(this.ApplyToAll)this.Parent.EditGrid.Table.forEach(i=>{i[this.SourceColumn.SectionName]=this.ReplaceGrid.Table[0][this.SourceColumn.SectionName],e&&(i[t]=this.ReplaceGrid.Table[0][t]),i.Select=!0,this.Parent.EditGrid.updateRow(i)}),this.Parent.DisplayMessage=this.Parent.EditGrid.Table.length+" Rows Replaced";else{let s=0;this.Parent.EditGrid.Table.forEach(n=>{0==a.e.stringCompare(i,a.e.String(n[t]),!0)&&(n[this.SourceColumn.SectionName]=this.ReplaceGrid.Table[0][this.SourceColumn.SectionName],e&&(n[t]=this.ReplaceGrid.Table[0][t]),n.Select=!0,this.Parent.EditGrid.updateRow(n),s++)}),this.Parent.DisplayMessage=0==s?"No Rows Found":s+" Rows Replaced"}}else"Cancel"==e&&(this.Parent.ReplaceVisibility=!1,this.Parent.ApproveVisibility=!1)}}},XJLh:function(e,t,i){"use strict";i.d(t,"a",(function(){return D}));var s=i("3Pt+"),n=i("fXoL"),a=i("ofXK"),o=i("q8k3"),r=i("sYmb");function l(e,t){if(1&e&&(n.Zb(0,"div",3),n.Wc(1,"\n            "),n.Vb(2,10),n.Wc(3,"\n        "),n.Yb()),2&e){const e=n.lc();n.Db(2),n.tc("obj",e.obj.AppRejDate)("group",e.form)}}function h(e,t){if(1&e){const e=n.ac();n.Zb(0,"button",6),n.hc("click",(function(){return n.Ic(e),n.lc().obj.onClickIkon("Suspend")})),n.Wc(1),n.mc(2,"translate"),n.Yb()}2&e&&(n.Db(1),n.Xc(n.nc(2,1,"Suspend")))}let D=(()=>{class e{constructor(){}ngOnInit(){this.form=new s.j({})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=n.Nb({type:e,selectors:[["app-bulk-edit-approve-component"]],inputs:{obj:"obj"},decls:35,vars:12,consts:[[1,"master-screen",2,"padding-bottom","4px","min-width","400px"],[1,"PACTHeaderFields","dialogSubBody"],["class","form-group row form-row col-xl-12 col-md-12 col-sm-12 col-xs-12 PACTControl",4,"ngIf"],[1,"form-group","row","form-row","col-xl-12","col-md-12","col-sm-12","col-xs-12","PACTControl"],["FieldDirective","",3,"obj"],[1,"Pactdailogfooter"],[1,"primary-btn-wicon",3,"click"],[1,"secondary-btn-wicon",3,"click"],["class","primary-btn-wicon",3,"click",4,"ngIf"],[1,"fa-light","fa-rectangle-xmark"],["FieldDirective","",3,"obj","group"]],template:function(e,t){1&e&&(n.Zb(0,"div",0),n.Wc(1,"\n    "),n.Zb(2,"div",1),n.Wc(3,"\n        "),n.Uc(4,l,4,2,"div",2),n.Wc(5,"\n        "),n.Zb(6,"div",3),n.Wc(7,"\n            "),n.Vb(8,4),n.Wc(9,"\n        "),n.Yb(),n.Wc(10,"\n        \n    "),n.Yb(),n.Wc(11,"\n    "),n.Zb(12,"div",5),n.Wc(13,"\n      "),n.Zb(14,"div"),n.Wc(15,"\n        "),n.Zb(16,"button",6),n.hc("click",(function(){return t.obj.onClickIkon("Approve")})),n.Wc(17),n.mc(18,"translate"),n.Yb(),n.Wc(19,"\n        "),n.Zb(20,"button",7),n.hc("click",(function(){return t.obj.onClickIkon("Reject")})),n.Wc(21),n.mc(22,"translate"),n.Yb(),n.Wc(23,"\n        "),n.Uc(24,h,3,3,"button",8),n.Wc(25,"\n        "),n.Wc(26,"\n        "),n.Zb(27,"button",7),n.hc("click",(function(){return t.obj.Cancelclick()})),n.Ub(28,"i",9),n.Wc(29),n.mc(30,"translate"),n.Yb(),n.Wc(31,"\n      "),n.Yb(),n.Wc(32,"\n      \n  "),n.Yb(),n.Wc(33,"\n"),n.Yb(),n.Wc(34,"\n")),2&e&&(n.Db(4),n.tc("ngIf",t.obj.AppRejDate.Visible),n.Db(4),n.tc("obj",t.obj.Remarks),n.Db(9),n.Xc(n.nc(18,6,"btnApprove")),n.Db(4),n.Xc(n.nc(22,8,"btnReject")),n.Db(3),n.tc("ngIf",t.obj.SuspendVisiblity),n.Db(5),n.Xc(n.nc(30,10,"Cancel")))},directives:[a.t,o.a],pipes:[r.d],encapsulation:2}),e})()},ouML:function(e,t,i){"use strict";i.r(t),i.d(t,"DocumentDraftsViewModel",(function(){return u}));var s=i("mrSG"),n=i("Do2H"),a=i("Lp6j"),o=i("ScVY"),r=i("8B8H"),l=i("ockk"),h=i("rJVx"),D=i("CUWK");class u extends o.b{constructor(e,t,i=0){if(super(),this.Grid=new r.a,this.IsFromDocs=!1,this.PopupWidth=0,this.ReportType=0,this.Parent=null,this.CCID=0,this.WID=0,this.LevelID=0,this.PactGridVisible=!1,this.CCID=i,this.Parent=e,this.ReportType=t,this.Parent instanceof h.GeneralDashboardViewModel||"DashAddOnsViewModel"==this.Parent.ClassName)1==t&&(this.ColSource=h.GeneralDashboardViewModel.InitColumns("Document Drafts_DashBoardCustomize"));else{let e;1==t?this.DisplayName="Drafts":2==t?this.DisplayName="Hold Documents":3==t?this.DisplayName="Approval History":4==t&&(this.DisplayName="Level Info",this.PactGrid=new r.a),this.Title=this.DisplayName,this.IsFromDocs=!0,this.FillGrid(),this.Grid.OnLinkClick.Subscribe(this,"GridLinkClick"),this.ColSource=[],1==t?(this.ColSource=h.GeneralDashboardViewModel.InitColumns("Document Drafts_DashBoardCustomize"),this.PopupWidth=22,this.ColSource.forEach(e=>{this.PopupWidth=this.PopupWidth+e.Width})):2==t?(e=new l.a,e.DataType="TextBlock",e.Header="Hold Date",e.DisplayMember="HoldDate_Key",e.Width=100,this.ColSource.push(e),e=new l.a,e.DataType="LINK",e.Header=n.a.GetResource("DocName"),e.DisplayMember="DocName",e.Width=135,this.ColSource.push(e),e=new l.a,e.DataType="TextBlock",e.Header="NetValue",e.DisplayMember="NetValue",e.Width=100,this.ColSource.push(e),e=new l.a,e.DataType="TextBlock",e.Header="NoOfProducts",e.DisplayMember="NoOfProducts",e.Width=50,this.ColSource.push(e),e=new l.a,e.DataType="LINK",e.Header=n.a.GetResource("Delete"),e.DisplayMember="Delete",e.Width=100,this.ColSource.push(e),this.PopupWidth=450):3==t?(e=new l.a,e.DataType="TextBlock",e.Header="User",e.DisplayMember="CreatedBy",e.Width=90,this.ColSource.push(e),e=new l.a,e.DataType="TextBlock",e.Header="FirstName",e.DisplayMember="FirstName",e.Width=90,this.ColSource.push(e),e=new l.a,e.DataType="TextBlock",e.Header="LastName",e.DisplayMember="LastName",e.Width=90,this.ColSource.push(e),e=new l.a,e.DataType="TextBlock",e.Header="Email",e.DisplayMember="Email1",e.Width=150,this.ColSource.push(e),e=new l.a,e.DataType="TextBlock",e.Header=n.a.GetResource("Date"),e.DisplayMember="AppDate",e.Width=128,this.ColSource.push(e),e=new l.a,e.DataType="LINK",e.Header="Level",e.DisplayMember="LevelName",e.Width=93,this.ColSource.push(e),e=new l.a,e.DataType="TextBlock",e.Header="Status",e.DisplayMember="Status",e.Width=80,this.ColSource.push(e),e=new l.a,e.DataType="Format",e.Header="Remarks",e.DisplayMember="Remarks",e.Width=190,this.ColSource.push(e),this.PopupWidth=950,"AddEditDocumentViewModel"==this.Parent.ClassName&&(e=new l.a,e.Header="WorkFlowName",e.DisplayMember="WorkFlowName",e.Width=200,this.ColSource.push(e)),this.PopupWidth=950):4==t&&(e=new l.a,e.DataType="TextBlock",e.ReadOnly=!0,e.Header="User Name",e.DisplayMember="UserName",e.Width=120,this.ColSource.push(e),e=new l.a,e.DataType="TextBlock",e.ReadOnly=!0,e.Header="First Name",e.DisplayMember="FirstName",e.Width=120,this.ColSource.push(e),e=new l.a,e.DataType="TextBlock",e.ReadOnly=!0,e.Header="Last Name",e.DisplayMember="LastName",e.Width=120,this.ColSource.push(e),this.PactGrid.Columns=this.ColSource,this.PopupWidth=400)}}get Table(){return this.Grid.Table}set Table(e){this.Grid.Table=e}get TableColumns(){return this.Grid.TableColumns}set TableColumns(e){this.Grid.TableColumns=e}get ColSource(){return this.Grid.Columns}set ColSource(e){this.Grid.Columns=e}get SelectedRow(){return this.Grid.SelectedItem}set SelectedRow(e){this.Grid.SelectedItem=e}onClick(e){event.preventDefault(),null!=this.SelectedRow&&this.LoadDraft(this.SelectedRow)}FillGrid(){let e=0,t=null;if(a.e.IsType(this.Parent,"AddEditDocumentViewModel")?(t=this.Parent,e=0==this.CCID?t.CostCenterID:this.CCID):a.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName||(e=this.CCID),1==this.ReportType||2==this.ReportType){let i;i=a.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName?null==t||38!=t.ScreenObject.DocumentType&&39!=t.ScreenObject.DocumentType?n.a.document.GetDocumentDrafts(0,e,this.ReportType,!1):n.a.document.GetDocumentDrafts(t.ScreenObject.RegisterNodeID,e,this.ReportType,!1,!0):n.a.document.GetDocumentDrafts(0,this.Parent.CostCenterID,this.ReportType,!1),i.subscribe(e=>{this.Table=e.Tables[0],this.Grid.TableColumns.Contains("Date_Text")||(this.Grid.TableColumns.push("Date_Text"),this.Grid.TableColumns.push("Delete")),this.Grid.TableColumns.Contains("HoldDate_Key")||this.Grid.TableColumns.push("HoldDate_Key"),this.Table.forEach(e=>{e.Delete="Delete",e.id=n.a.slick.rowid,e.Date_Text=new Date(e.Date).ToString(n.a.SessionManager.Preferences["Date Format"]+" hh:mm a"),null!=e.HoldDate&&(e.HoldDate_Key=new Date(e.HoldDate).ToString(n.a.SessionManager.Preferences["Date Format"]))})})}else if(3==this.ReportType){let t=null;if(a.e.IsType(this.Parent,"AddEditDocumentViewModel")?(t=this.Parent.ScreenObject.GetDocStatusHistory(),t.Tables.length>1&&t.Tables[1].length>0&&t.Columns[1].Contains("WID")&&(this.WID=parseInt(t.Tables[1][0].WID))):a.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName?a.e.IsEmpty(this.Parent.ClassName)||"AddEditCasesViewModel"!=this.Parent.ClassName||(t=this.GetDocStatusHistory(73,this.Parent.CaseID,!1)):t=n.a.rental.GetHistory(e,this.Parent.ContractID),null!=t&&t.Tables.length>0){this.Table=t.Tables[0],this.Grid.TableColumns.push("AppDate");for(let t=0;t<this.Table.length;t++)""!=this.Table[t].Date.toString()&&(this.Table[t].AppDate=new Date(this.Table[t].Date.toString()).ToString(n.a.SessionManager.Preferences["Date Format"]+" hh:mm a"));let e=0,i=0;this.Table.length>0&&(e=a.e.IntTryParse(this.Table[this.Table.length-1].WorkFlowLevel.toString()),i=a.e.IntTryParse(this.Table[this.Table.length-1].StatusID.toString())),369!=i&&(t.Tables[1]=t.Tables[1].filter(t=>t.levelID>e),t.Tables[1].forEach(e=>{let t=this.Grid.NewRow();t.LevelName=e.LevelName,t.Status="Pending",t.WorkFlowLevel=e.LevelID,this.Grid.addRow(t)}));for(let t=this.Table.length;t<7;t++)this.Grid.addEmptyRow()}}else if(4==this.ReportType){let e=null;if("WFLevelDoc"==this.Parent.ClassName?e=n.a.SessionManager.Preferences.ContainsKey("CanApproveFunction")&&"True"==n.a.SessionManager.Preferences.CanApproveFunction?n.a.report.GetExtWFDet(this.Parent.WID,this.Parent.LevelID,this.Parent.ccid,this.Parent.DOcId):n.a.report.GetWorkFlowLevelDetails(this.Parent.WID,this.Parent.LevelID,this.Parent.ccDate):this.Parent instanceof u&&(n.a.SessionManager.Preferences.ContainsKey("CanApproveFunction")&&"True"==n.a.SessionManager.Preferences.CanApproveFunction?"AddEditDocumentViewModel"==this.Parent.Parent.ClassName?e=n.a.report.GetExtWFDet(this.Parent.WID,this.Parent.LevelID,this.Parent.Parent.CostCenterID,this.Parent.Parent.ScreenObject.DocID):"ReportViewModel"==this.Parent.Parent.ClassName&&"INV_ComparisonReport"==this.Parent.Parent.StaticReportObject&&(e=n.a.report.GetExtWFDet(this.Parent.WID,this.Parent.LevelID,this.Parent.Parent.StaticReportObject.QuotationDocument,this.Parent.Parent.StatusDocID)):e=n.a.report.GetWorkFlowLevelDetails(this.Parent.WID,this.Parent.LevelID,"AddEditDocumentViewModel"==this.Parent.Parent.ClassName?this.Parent.Parent.ScreenObject.DocDate.Date:Date.Today())),null!=e){for(let t=e.Tables[0].length;t<8;t++)e.Tables[0].push();this.PactGrid.Table=e.Tables[0]}this.PactGrid.Width="",this.PactGrid.SearchVisible=!0,this.PactGrid.SearchCols.Width="85",this.PactGrid.SearchOptions.Width="90",this.PactGrid.SearchText.Width="110",this.PactGridVisible=!0}}GetDocStatusHistory(e,t,i){Logger.InfoLog("DocumentDraftsViewModel:: Inside GetDocStatusHistory");let s=[];s.push(e),s.push(t),s.push(i),s.push(n.a.SessionManager.UserID),s.push(n.a.SessionManager.LanguageID);let a=n.a.document.GetDocStatusHistory(s);return Logger.InfoLog("DocumentDraftsViewModel:: Exiting GetDocStatusHistory"),a}OnButtonClick(e){"Cancel"==e.toString()&&(a.e.IsType(this.Parent,"AddEditDocumentViewModel")&&this.CCID>0&&(this.Parent.res="No"),n.a.page.HideDialog())}DeleteDraft(e){let t;t=a.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName?n.a.document.DeleteDocumentDraft(parseInt(e.DraftID)):n.a.rental.DeleteQuotation(parseInt(e.CostCenterID),parseInt(e.DraftID)),t.RetValue>0&&this.Grid.removeRow(e)}LoadDraft(e){return Object(s.b)(this,void 0,void 0,(function*(){if(a.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName){const{AddEditDocumentViewModel:t}=yield Promise.all([i.e(2),i.e(1),i.e(3),i.e(5),i.e(4),i.e(6),i.e(7),i.e(10),i.e(9),i.e(12),i.e(11),i.e(13),i.e(19),i.e(15),i.e(21),i.e(20),i.e(16),i.e(14),i.e(18),i.e(17),i.e(22),i.e(89)]).then(i.bind(null,"1Cra")),{AddEditDocumentComponent:s}=yield Promise.all([i.e(4),i.e(6)]).then(i.bind(null,"MCKn"));let a,o;o=n.a.document.GetDocumentDrafts(parseInt(e.DraftID),0,1,!1),o.subscribe(i=>{if(a=i.Tables[0],null!=a&&a.length>0)if("AddEditDocumentViewModel"==this.Parent.ClassName||"POSDocumentViewModel"==this.Parent.ClassName)this.CCID>0||(this.Parent.clear(1),this.Parent.LoadDraftXML(a[0]),n.a.page.HideDialog(),this.Parent.ScreenObject.GridDataObj.RefreshGridView());else{let i=1==this.ReportType,o=new t(parseInt(e.CostCenterID),e.Type.toString(),i);n.a.page.addNewTab({component:s,params:{obj:o}}),o.LoadDraftXML(a[0],i)}})}else D.RibbonExtViewModel.LoadDraftRentalContract(this.Parent,parseInt(e.DraftID)),n.a.page.HideDialog()}))}GridLinkClick(e,t,i){event.preventDefault(),"Delete"==t?this.DeleteDraft(e):"Date_Text"!=t&&"DocName"!=t||this.LoadDraft(e)}}},rJVx:function(e,t,i){"use strict";i.r(t),i.d(t,"GeneralDashboardViewModel",(function(){return D}));var s=i("mrSG"),n=i("Do2H"),a=i("Lp6j"),o=i("ScVY"),r=i("NkMH"),l=i("ockk"),h=i("JIg3");class D extends o.b{constructor(){super(),this.ButtonPDC=new r.a,this.timerdashboard=new a.d,this.Date=new h.a(0),this.tdMaximize=new Array(4).fill(!1),Logger.InfoLog("DashboardViewModel::Entering DashboardViewModel"),this.timerdashboard.Enabled=!0,this.timerdashboard.Interval=6e4,n.a.SessionManager.IsWebApplication||this.timerdashboard.Elapsed(this,"timerdashboard_Elapsed"),this.DisplayName=n.a.GetResource("Dashboard_Maindashboard"),this.loadDrafts(),Logger.InfoLog("DashboardViewModel::Exiting DashboardViewModel")}loadDrafts(){return Object(s.b)(this,void 0,void 0,(function*(){const{DocumentDraftsViewModel:e}=yield i.e(150).then(i.bind(null,"ouML"));this.DocumentDrafts=new e(this,1),setTimeout(()=>{this.DocumentDrafts.FillGrid()},500);const{UnAppDocumentsViewModel:t}=yield i.e(0).then(i.bind(null,"AyOk"));this.UnApprovedDocuments=new t;const{DashBoardNotifViewModel:s}=yield Promise.all([i.e(2),i.e(1),i.e(5),i.e(26),i.e(42),i.e(0),i.e(73)]).then(i.bind(null,"Wh9R"));this.NotifEvents=new s(2),this.PDCDocuments=new s(4)}))}timerdashboard_Elapsed(e,t){n.a.page.isActiveTab(this)&&(this.OnButtonClick("RefreshPDC"),this.OnButtonClick("RefreshEvents"),this.NotifEvents.RefreshData(),this.UnApprovedDocuments.OnLoad())}OnButtonClick(e){"PostPDC"==e||("RefreshPDC"==e?(this.PDCDocuments.EventsType=4,this.PDCDocuments.InitColumns()):"PostEvents"==e||("RefreshEvents"==e?this.NotifEvents.RefreshData():"UnApproved"==e?this.UnApprovedDocuments.OnLoad():"Drafts"==e&&this.DocumentDrafts.FillGrid()))}OnMessageCallBack(){this.res="Yes"}static InitColumns(e){let t,i="",s=[];if(n.a.SessionManager.Preferences.ContainsKey(e)&&(i=n.a.SessionManager.Preferences[e]),i.length>0){let o=new a.f;o.LoadXml(i);for(let i=0;i<o.DocumentElement.children.length;i++){let a=o.DocumentElement.children[i];t=new l.a,t.Header=n.a.GetResource(a.attributes.Header.value),t.DisplayMember=a.attributes.ID.value,t.ReadOnly=!0,t.Width=parseInt(a.attributes.Width.value),s.push(t),"Un Approved Documents_DashBoardCustomize"==e?"VoucherNo"==t.DisplayMember?t.DataType="LINK":"Amount"==t.DisplayMember&&(t.DataType="FLOAT",t.DecimalPoints=n.a.SessionManager.Preferences.DecimalsinAmount.toString()):"Document Drafts_DashBoardCustomize"==e?"Date_Text"!=t.DisplayMember&&"Delete"!=t.DisplayMember||(t.DataType="LINK"):"Post Dated Documents_DashBoardCustomize"==e?"VoucherNo"==t.DisplayMember?t.DataType="LINK":"Amount"==t.DisplayMember&&(t.DataType="FLOAT",t.DecimalPoints=n.a.SessionManager.Preferences.DecimalsinAmount.toString()):"Notification Events_DashBoardCustomize"==e&&"VoucherNo"==t.DisplayMember&&(t.DataType="LINK")}}return s}static IsActionAssigned(e,t){return n.a.SessionManager.IsActionAssigned(e,t)}}}}]);