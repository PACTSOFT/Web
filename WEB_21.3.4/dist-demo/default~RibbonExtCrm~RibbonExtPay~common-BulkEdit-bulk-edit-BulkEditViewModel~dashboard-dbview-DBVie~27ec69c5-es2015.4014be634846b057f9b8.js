(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{"1xwR":function(e,t,o){"use strict";o.d(t,"a",(function(){return c})),o.d(t,"b",(function(){return d}));var i=o("Do2H"),s=o("Lp6j"),n=o("mvPR"),l=o("vTM8"),r=o("/G+I"),a=o("uMy8"),h=o("MCLT");class c{constructor(){this.IsRowKPI=!1,this.IsRepeatColExists=!1,this.IsBold=!1,this.colunmIndex=-1,this.fontSize=0,this.ColsUsed=[],this.evalParse=new a.a,this.eval=new a.b,this.fldDict=new l.a,this.fldDictIndex=[],this.eval.ThrowException=!1,this.eval.SetKeyWords("REPORT"),this.evalParse.ThrowException=!1,this.evalParse.SetKeyWords("REPORT")}KPI_1(e,t){this.Parent=t,this.ID=e.attributes.ID.value,this.Formula=e.attributes.Formula.value,this.Expression=e.attributes.Expression.value,this.BackColor=e.attributes.BackColor.value,this.ForeColor=e.attributes.ForeColor.value,Text=e.attributes.Text.value,this.Image=e.attributes.Img.value,this.IsBold=null!=e.attributes.Bold&&"1"==e.attributes.Bold.value,this.fontSize=null!=e.attributes.FontSize?parseFloat(e.attributes.FontSize.value):0,s.e.IsEmpty(Image)||(this.Image="Images/"+this.Image),this.IsRowKPI="ROW_KPI"==this.ID;let o,i=[];this.evalParse.ParseFormula(this.Expression,i);let n=null;for(let s=i.length-1;s>=0;s--){let e=i[s];o=e.getTokenValue().toString(),e.getTokenClass()!=a.d.OPERAND||null==n||n.getTokenClass()!=a.d.OPERAND?n=e:(n.tokenValue=e.tokenValue.toString()+n.tokenValue.toString(),i.RemoveAt(s))}i.forEach(e=>{let i=e;if(o=i.getTokenValue().toString(),i.getTokenClass()==a.d.OPERAND&&i.getTokenType()==a.e.REFERENCE&&(t.ColumnSourceALL.find(e=>e.ID==o)||1==t.StaticReportType||298==t.StaticReportType)){let e=new a.c;this.fldDict.ContainsKey(o)||(e=new a.c,e.setFieldDetails(o,3,1,"",0,!1,!1),this.fldDict.push(o,e),this.fldDictIndex.push(-1))}}),this.RefreshColumnIndex()}KPI_2(e,t){this.Parent=e.Parent,this.ID=this.Parent.dicRepeatColsMap[e.ID][t],this.Formula=e.Formula,this.Expression=e.Expression,this.BackColor=e.BackColor,this.ForeColor=e.ForeColor,this.Text=e.Text,this.Image=e.Image,this.IsBold=e.IsBold,this.fontSize=e.fontSize,this.Image=e.Image,this.IsRowKPI=e.IsRowKPI;let o,i=[];this.evalParse.ParseFormula(this.Expression,i);let s=null;for(let n=i.length-1;n>=0;n--){let e=i[n];o=e.getTokenValue().toString(),e.getTokenClass()!=a.d.OPERAND||null==s||s.getTokenClass()!=a.d.OPERAND?s=e:(s.tokenValue=e.tokenValue.toString()+s.tokenValue.toString(),i.RemoveAt(n))}this.Expression="",i.forEach(e=>{let i=e;if(o=i.getTokenValue().toString(),i.getTokenClass()==a.d.OPERAND&&i.getTokenType()==a.e.REFERENCE)if(this.Parent.dicRepeatColsMap.ContainsKey(o)){if(o=this.Parent.dicRepeatColsMap[o][t],!this.fldDict.ContainsKey(o)){let e=new a.c;e.setFieldDetails(o,3,1,"",0,!1,!1),this.fldDict.push(o,e),this.fldDictIndex.push(-1)}}else if(this.Parent.ColumnSourceALL.find(e=>e.ID==o)&&!this.fldDict.ContainsKey(o)){let e=new a.c;e.setFieldDetails(o,3,1,"",0,!1,!1),this.fldDict.push(o,e),this.fldDictIndex.push(-1)}"STRING"==i.getTokenName()?this.Expression+='"'+o+'"':(i.getTokenType()==a.e.KEYWORD&&(this.Expression+=" "),this.Expression+=o,i.getTokenType()==a.e.KEYWORD&&(this.Expression+=" "))})}RefreshColumnIndex(){let e=this.fldDict.keys;for(let t=0;t<e.length;t++){this.fldDictIndex[t]=-1;for(let o=0;o<this.Parent.ReportColumns.length;o++)if(this.Parent.ReportColumns[o].ID==e[t]){this.fldDictIndex[t]=o;break}}if(!this.IsRowKPI){this.colunmIndex=-1;for(let e=0;e<this.Parent.ReportColumns.length;e++)if(this.Parent.ReportColumns[e].ID==this.ID){this.colunmIndex=e;break}}}Apply(e){if(this.IsRepeatColExists){this.Apply_2(e,!1);for(let e=0;e<this.Parent.RepeatSets;e++);}else this.Apply_2(e,!1)}Apply_2(e,t){let o=0;for(let s=0;s<this.fldDict.keys.length;s++){let t={Key:this.fldDict.keys[s]};this.fldDict[t.Key].setFieldValue(null),-1!=this.fldDictIndex[o]&&this.fldDictIndex[o]<this.Parent.ReportColumns.length?this.fldDict[t.Key].setFieldValue(this.fldDictIndex[o]<e.Cells.length&&null!=e.Cells[this.fldDictIndex[o]].Value?e.Cells[this.fldDictIndex[o]].Value:"FLOAT"==this.Parent.ReportColumns[this.fldDictIndex[o]].ColumnType?0:""):null==e.DataRow||Object(h.isNullOrUndefined)(e.DataRow[t.Key])?this.fldDict[t.Key].setFieldValue(0):this.fldDict[t.Key].setFieldValue(e.DataRow[t.Key]),o++}try{if("1"==this.eval.EvaluateExpression(this.Expression,this.fldDict).toString())if(-1!=this.colunmIndex)e.Cells[this.colunmIndex].IsNormal=!1,null==e.Cells[this.colunmIndex].CellAppearance&&(e.Cells[this.colunmIndex].CellAppearance=this.Parent.ReportColumns[this.colunmIndex].DataAppearance.Clone()),e.Cells[this.colunmIndex].CellAppearance.BackColor=this.BackColor,e.Cells[this.colunmIndex].CellAppearance.ForeColor=this.ForeColor,e.Cells[this.colunmIndex].CellAppearance.ImagePath=this.Image,this.IsBold&&(e.Cells[this.colunmIndex].CellAppearance.IsBold=!0),this.fontSize>0&&(e.Cells[this.colunmIndex].CellAppearance.FontSize=this.fontSize);else if(this.IsRowKPI)for(let t=0;t<this.Parent.ReportColumns.length&&t<e.Cells.length;t++)e.Cells[t].IsNormal=!1,null==e.Cells[t].CellAppearance&&(e.Cells[t].CellAppearance=this.Parent.ReportColumns[t].DataAppearance.Clone()),e.Cells[t].CellAppearance.BackColor=this.BackColor,e.Cells[t].CellAppearance.ForeColor=this.ForeColor,this.IsBold&&(e.Cells[t].CellAppearance.IsBold=!0),this.fontSize>0&&(e.Cells[t].CellAppearance.FontSize=this.fontSize)}catch(i){}}Apply_Matrix(e,t,o,i){for(let n=0;n<this.fldDict.keys.length;n++){let t={Key:this.fldDict.keys[n]};if(this.fldDict[t.Key].setFieldValue(null),Object(h.isUndefined)(e[t.Key]))this.fldDict[t.Key].setFieldValue(0);else{let o=null;if(-1!=this.fldDictIndex[0]?o=this.Parent.ColumnSourceALL[this.fldDictIndex[0]]:null!=i.MatixRepeatID&&(o=this.Parent.ReportColumns.find(e=>e.ID==t.Key+"_"+i.MatixRepeatID)),!o){this.fldDict[t.Key].setFieldValue(0);continue}this.fldDict[t.Key].setFieldValue(null!=e[t.Key]?e[t.Key]:"FLOAT"==o.ColumnType?0:"")}}try{"1"==this.eval.EvaluateExpression(this.Expression,this.fldDict).toString()&&(t.IsNormal=!1,null==t.CellAppearance&&(t.CellAppearance=o.DataAppearance.Clone()),t.CellAppearance.BackColor=this.BackColor,t.CellAppearance.ForeColor=this.ForeColor,t.CellAppearance.ImagePath=this.Image,this.IsBold&&(t.CellAppearance.IsBold=!0),this.fontSize>0&&(t.CellAppearance.FontSize=this.fontSize))}catch(s){}}}class d{constructor(e){this.GrdRow=0,this.ChunkSize=1,this.AccountingFromMonth=i.a.SessionManager.AccountingFromMonth,this.UnPostedDocsInclude=!1,this.UnPostedDocsReserveQtyInclude=!1,this.UnPostedDocsHoldQtyInclude=!1,this.PDCInclude=!1,this.IncludeTerminatedPDC=!0,this.IncludeUnApprovedPDC=!1,this.DontApplyLocationWiseAccountsFilter=!1,this.ApplyLWAccountLFilterWhenIgnoreLoc=!1,this.UnPostedDocsList="",this.RoundOff="",this.strWhere=null,this.CellValue="",this.sbChunks="",this.BalanceBFAppearance=new n.a,this.BalanceBFAppearance_Data=new n.a,this.GrossTotalAppearance=new n.a,this.GrossTotalAppearance_Data=new n.a,this.HeaderAppearance=new n.a,this.DataSetCollection=[],this.ViewModel=e,this.oColumns=e.ReportColumns,this.BalanceBFAppearance.IsBold=!1,this.BalanceBFAppearance.ForeColor="#FF0081A6",this.BalanceBFAppearance.BackColor="White",this.BalanceBFAppearance.FontSize=12,this.BalanceBFAppearance_Data.IsBold=!1,this.BalanceBFAppearance_Data.ForeColor="#FF0081A6",this.BalanceBFAppearance_Data.BackColor="White",this.BalanceBFAppearance_Data.FontSize=12,this.BalanceBFAppearance_Data.Alignment="Right",this.GrossTotalAppearance.IsBold=!0,this.GrossTotalAppearance.ForeColor="#FF000000",this.GrossTotalAppearance.BackColor="White",this.GrossTotalAppearance.FontSize=12,this.GrossTotalAppearance_Data.IsBold=!0,this.GrossTotalAppearance_Data.ForeColor="#FF000000",this.GrossTotalAppearance_Data.BackColor="White",this.GrossTotalAppearance_Data.FontSize=12,this.GrossTotalAppearance_Data.Alignment="Right",this.HeaderAppearance.IsBold=!0,this.HeaderAppearance.ForeColor="#FF000000",this.HeaderAppearance.BackColor="White",this.HeaderAppearance.FontSize=13,this.HeaderAppearance.Alignment="Center",this.RoundOff=e.Preferences.ContainsKey("RoundOffDecimals")?e.Preferences.RoundOffDecimals:""}NewReportRow(){let e=new n.d(this.ViewModel.ReportColumns.length,this.ViewModel.RowHeight);return e.Type=n.f.Detail,e}NewReportRow_2(e,t){let o=new n.d(this.ViewModel.ReportColumns.length,this.ViewModel.RowHeight);return o.Type=e,null!=t&&(o.PrintVisible=t.IsPrintVisible),o.Cells.forEach(e=>{e.IsNormal=!1,null!=t&&(e.CellAppearance=t.Clone())}),o}NewReportRow_3(e,t,o){let i=new n.d(o,this.ViewModel.RowHeight);return i.Type=e,i.PrintVisible=t.IsPrintVisible,i.Cells.forEach(e=>{e.IsNormal=!1,e.CellAppearance=t.Clone()}),i}GetDimensionFilter(e,t=null){let o="";for(let s=0;s<this.ViewModel.oReportDialog.CostCenterFilters.length;s++){let n=this.ViewModel.oReportDialog.CostCenterFilters[s];if(n.CostCenterID>5e4&&(null==t||!t.Contains(n.CostCenterID)))if(n.SelectedNodes.length>0)if(1==n.SelectedNodes.length)o+=" AND ",o+=e+(n.CostCenterID-5e4)+"="+n.SelectedNodes[0].Id;else{let t="1"==i.a.SessionManager.UserID||"1"==i.a.SessionManager.RoleID;if(!n.DeleteButtonVisibility&&!t||!n.SelectedNodes.find(e=>2==e.Id&&e.IsGroup))if(o+=" AND ",r.IPrefetchFilter.IsGroupTree(n)&&(n.DeleteButtonVisibility||t)){let t="";for(let e=0;e<n.SelectedNodes.length;e++)null!=n.SelectedNodes[e].Parent&&n.SelectedNodes[e].Parent.IsSelected||(t.length>0&&(t+=","),t+=n.SelectedNodes[e].Id);0==t.length&&(t+=-12912),o+=e+(n.CostCenterID-5e4)+" IN ",o+=" (select T.NodeID GTID from "+d.GetTagTableName(n.CostCenterID)+" T with(nolock),"+d.GetTagTableName(n.CostCenterID)+" GTP with(nolock) where T.lft BETWEEN GTP.lft AND GTP.rgt AND GTP.NodeID IN (",o+=t.toString()+")  group by T.NodeID)"}else{o+=e+(n.CostCenterID-5e4)+" IN (";for(let e=0;e<n.SelectedNodes.length;e++)e>0&&(o+=","),o+=n.SelectedNodes[e].Id;o+=")"}}else n.DeleteButtonVisibility||(o+=" AND ",o+=e+(n.CostCenterID-5e4)+"=-12912")}return o.toString()}GetDimensionFilter_2(e,t){let o,s="";for(let n=0;n<this.ViewModel.oReportDialog.CostCenterFilters.length;n++){let l=this.ViewModel.oReportDialog.CostCenterFilters[n];if(l.CostCenterID>5e4)if(o=this.ViewModel.ReportDims.Contains(l.CostCenterID.toString())?t:e,l.SelectedNodes.length>0)if(1==l.SelectedNodes.length)s+=" AND ",s+=o+(l.CostCenterID-5e4)+"="+l.SelectedNodes[0].Id;else{let e="1"==i.a.SessionManager.UserID||"1"==i.a.SessionManager.RoleID;if(!l.DeleteButtonVisibility&&!e||!l.SelectedNodes.find(e=>2==e.Id&&e.IsGroup))if(s+=" AND ",r.IPrefetchFilter.IsGroupTree(l)&&(l.DeleteButtonVisibility||e)){let e="";for(let t=0;t<l.SelectedNodes.length;t++)null!=l.SelectedNodes[t].Parent&&l.SelectedNodes[t].Parent.IsSelected||(e.length>0&&(e+=","),e+=l.SelectedNodes[t].Id);0==e.length&&(e+=-12912),s+=o+(l.CostCenterID-5e4)+" IN ",s+=" (select T.NodeID GTID from "+d.GetTagTableName(l.CostCenterID)+" T with(nolock),"+d.GetTagTableName(l.CostCenterID)+" GTP with(nolock) where T.lft BETWEEN GTP.lft AND GTP.rgt AND GTP.NodeID IN (",s+=e.toString()+")  group by T.NodeID)"}else{s+=o+(l.CostCenterID-5e4)+" IN (";for(let e=0;e<l.SelectedNodes.length;e++)e>0&&(s+=","),s+=l.SelectedNodes[e].Id;s+=")"}}else l.DeleteButtonVisibility||(s+=" AND ",s+=o+(l.CostCenterID-5e4)+"=-12912")}return s}GetPriceFilter(){let e="",t=!1;return this.ViewModel.oReportDialog.Locations.Visible&&null!=this.ViewModel.oReportDialog.LocationWhere&&(s.e.IsEmpty(this.ViewModel.oReportDialog.LocationWhere)||this.ViewModel.oReportDialog.LocationWhere.Contains(",")||(t=!0,e+='<Row CC="'+this.ViewModel.oReportDialog.Locations.DBColumnID+'" ID="'+this.ViewModel.oReportDialog.LocationWhere+'"/>')),this.ViewModel.oReportDialog.CostCenterFilters.forEach(o=>{o.CostCenterID>5e4&&1==o.SelectedNodes.length&&(!t||this.ViewModel.oReportDialog.Locations.DBColumnID!=o.CostCenterID)&&(e+='<Row CC="'+o.CostCenterID+'" ID="'+o.SelectedNodes[0].Id+'"/>')}),e.length>0&&(e="<PC>"+e,e+="</PC>"),e.toString()}GetFilterByDimension_1(e){return d.GetFilterByDimension_3(e,this.ViewModel.oReportDialog.CostCenterFilters)}static GetFilterByDimension_3(e,t){let o="";for(let s=0;s<t.length;s++){let n=t[s];if(n.CostCenterID==e)if(n.SelectedNodes.length>0){let t=null,s="1"==i.a.SessionManager.UserID||"1"==i.a.SessionManager.RoleID;if(e>5e4&&(t=n.DeleteButtonVisibility||s?n.SelectedNodes.find(e=>2==e.Id&&e.IsGroup):null),!t)if(1==n.SelectedNodes.length)o+=n.SelectedNodes[0].Id;else for(let e=0;e<n.SelectedNodes.length;e++)e>0&&(o+=","),o+=n.SelectedNodes[e].Id}else n.DeleteButtonVisibility||(o+="-12912")}return o.toString()}static GetTagTableName(e){return 2==e?"ACC_Accounts":3==e?"INV_Product":7==e?"ADM_Users":50001==e?"COM_Division":50002==e?"COM_Location":50003==e?"COM_Branch":50004==e?"COM_Department":50005==e?"COM_Salesman":50006==e?"COM_Category":50007==e?"COM_Area":50008==e?"COM_Teritory":"COM_CC"+e}GetAccountWiseLocationWhere(e){let t="";if(!this.DontApplyLocationWiseAccountsFilter){if("TRUE"==i.a.SessionManager.Preferences["LW Accounts"].toUpperCase()){let o="";if(this.ViewModel.oReportDialog.Locations.Visible&&null!=this.ViewModel.oReportDialog.LocationWhere&&50002==this.ViewModel.oReportDialog.Locations.DBColumnID){let e=[];s.e.IsEmpty(this.ViewModel.oReportDialog.LocationWhere)?e.push("-101"):e.AddRange(this.ViewModel.oReportDialog.LocationWhere.split(","));for(let t=0;t<e.length;t++)if(t>0&&(o+=","),o+=e[t],null!=i.a.SessionManager.Locations){let o,n=i.a.SessionManager.Locations.filter(o=>o.NodeID==e[t]);null!=n&&n.length>0&&s.e.Int(n[0].parentid)>0&&(o=n[0].parentid.toString(),e.Contains(o)||e.push(o))}}else!this.ApplyLWAccountLFilterWhenIgnoreLoc||"1"==i.a.SessionManager.UserID||this.ViewModel.oReportDialog.Locations.Visible||s.e.IsEmpty(i.a.SessionManager.LocationWhere)||(o=i.a.SessionManager.LocationWhere);o.length>0&&(t=this.ViewModel.StaticReportType>=5&&this.ViewModel.StaticReportType<=8?" AND (((A.IsGroup=1 or A.AccountID in (select ParentNodeID from COM_CostCenterCostCenterMap with(nolock) where ParentCostCenterID=2 and CostCenterID=50002 AND NodeID IN ("+o+")) )) or A.ParentID=0)":4==this.ViewModel.StaticReportType?" AND ((("+e+".IsGroup=1 or "+e+".AccountID in (select ParentNodeID from COM_CostCenterCostCenterMap with(nolock) where ParentCostCenterID=2 and CostCenterID=50002 AND NodeID IN ("+o+")) )) or "+e+".ParentID=0)":" AND ((("+e+".AccountID in (select ParentNodeID from COM_CostCenterCostCenterMap with(nolock) where ParentCostCenterID=2 and CostCenterID=50002 AND NodeID IN ("+o+")) )) or "+e+".ParentID=0)")}else if("True"==i.a.SessionManager.Preferences.EnableDivisionWise.toString()&&"TRUE"==i.a.SessionManager.Preferences["DW Accounts"].toUpperCase()){let o="";if(this.ViewModel.oReportDialog.Locations.Visible&&null!=this.ViewModel.oReportDialog.LocationWhere&&50001==this.ViewModel.oReportDialog.Locations.DBColumnID){let e=[];s.e.IsEmpty(this.ViewModel.oReportDialog.LocationWhere)?e.push("-101"):e.AddRange(this.ViewModel.oReportDialog.LocationWhere.split(","));for(let t=0;t<e.length;t++)if(t>0&&(o+=","),o+=e[t],null!=i.a.SessionManager.Divisions){let o,s=i.a.SessionManager.Divisions.filter(o=>o.NodeID==e[t]);null!=s&&s.length>0&&""!=s[0].parentid.toString()&&parseInt(s[0].parentid.toString())>0&&(o=s[0].parentid.toString(),e.Contains(o)||e.push(o))}}else!this.ApplyLWAccountLFilterWhenIgnoreLoc||"1"==i.a.SessionManager.UserID||this.ViewModel.oReportDialog.Locations.Visible||s.e.IsEmpty(i.a.SessionManager.DivisionWhere)||(o=i.a.SessionManager.DivisionWhere);o.length>0&&(t=this.ViewModel.StaticReportType>=5&&this.ViewModel.StaticReportType<=8?" AND (((A.IsGroup=1 or A.AccountID in (select ParentNodeID from COM_CostCenterCostCenterMap with(nolock) where ParentCostCenterID=2 and CostCenterID=50001 AND NodeID IN ("+o+")) )) or A.ParentID=0)":4==this.ViewModel.StaticReportType?" AND ((("+e+".IsGroup=1 or "+e+".AccountID in (select ParentNodeID from COM_CostCenterCostCenterMap with(nolock) where ParentCostCenterID=2 and CostCenterID=50001 AND NodeID IN ("+o+")) )) or "+e+".ParentID=0)":" AND ((("+e+".AccountID in (select ParentNodeID from COM_CostCenterCostCenterMap with(nolock) where ParentCostCenterID=2 and CostCenterID=50001 AND NodeID IN ("+o+")) )) or "+e+".ParentID=0)")}let o=i.a.SessionManager.Preferences.ContainsKey("Dimension List")?i.a.SessionManager.Preferences["Dimension List"].split(","):[];0==t.length&&o.Contains("2")&&"1"!=i.a.SessionManager.UserID&&(t=this.ViewModel.StaticReportType>=5&&this.ViewModel.StaticReportType<=8?" AND (((A.IsGroup=1 or A.AccountID in (select ParentNodeID from COM_CostCenterCostCenterMap with(nolock) where ParentCostCenterID=2 and CostCenterID=7 AND NodeID="+i.a.SessionManager.UserID+") )) or A.ParentID=0 or "+e+".CreatedBy='"+i.a.SessionManager.UserName+"')":4==this.ViewModel.StaticReportType?" AND ((("+e+".IsGroup=1 or "+e+".AccountID in (select ParentNodeID from COM_CostCenterCostCenterMap with(nolock) where ParentCostCenterID=2 and CostCenterID=7 AND NodeID="+i.a.SessionManager.UserID+") )) or "+e+".ParentID=0 or "+e+".CreatedBy='"+i.a.SessionManager.UserName+"')":" AND ((("+e+".AccountID in (select ParentNodeID from COM_CostCenterCostCenterMap with(nolock) where ParentCostCenterID=2 and CostCenterID=7 AND NodeID="+i.a.SessionManager.UserID+") )) or "+e+".ParentID=0 or "+e+".CreatedBy='"+i.a.SessionManager.UserName+"')")}return s.e.IsEmpty(this.ViewModel.RowFiltersWhere)||(t=" AND "+this.ViewModel.RowFiltersWhere),t}GetAccountTypeWhere(e){let t="";return this.ViewModel.Preferences.ContainsKey("AccountTypesFilter")&&this.ViewModel.Preferences.AccountTypesFilter.length>0&&(t=i.a.SessionManager.Preferences.ContainsKey("IsControlAccounts")&&"TRUE"==i.a.SessionManager.Preferences.IsControlAccounts.toUpperCase()?"6,7"==this.ViewModel.Preferences.AccountTypesFilter||"7,6"==this.ViewModel.Preferences.AccountTypesFilter||this.ViewModel.Preferences.AccountTypesFilter.Contains(",")?" AND "+e+".AccountTypeID IN ("+this.ViewModel.Preferences.AccountTypesFilter+")":"7"==this.ViewModel.Preferences.AccountTypesFilter?" AND ("+e+".AccountTypeID=7 or ("+e+".IsDrCr=1 and "+e+".AccountTypeID=6))":"6"==this.ViewModel.Preferences.AccountTypesFilter?" AND ("+e+".AccountTypeID=6 or ("+e+".IsDrCr=1 and "+e+".AccountTypeID=7))":" AND "+e+".AccountTypeID="+this.ViewModel.Preferences.AccountTypesFilter:this.ViewModel.Preferences.AccountTypesFilter.Contains(",")?" AND "+e+".AccountTypeID IN ("+this.ViewModel.Preferences.AccountTypesFilter+")":" AND "+e+".AccountTypeID="+this.ViewModel.Preferences.AccountTypesFilter),t}GetProductWiseLocationWhere(e,t){let o="";if("True"==i.a.SessionManager.Preferences.EnableLocationWise.toString()&&"TRUE"==i.a.SessionManager.Preferences["LW Products"].toUpperCase()){let n=[];if(50002==this.ViewModel.oReportDialog.Locations.DBColumnID){if(!this.ViewModel.oReportDialog.Locations.Visible||null==this.ViewModel.oReportDialog.LocationWhere)return"";s.e.IsEmpty(this.ViewModel.oReportDialog.LocationWhere)?n.push("-101"):n.AddRange(this.ViewModel.oReportDialog.LocationWhere.split(","))}else{if("1"==i.a.SessionManager.UserID||"1"==i.a.SessionManager.RoleID)return"";0!=i.a.SessionManager.LocationID||s.e.IsEmptySpace(i.a.SessionManager.LocationWhere)?n.push(i.a.SessionManager.LocationID.toString()):n.AddRange(i.a.SessionManager.LocationWhere.split(","))}let l="";for(let e=0;e<n.length;e++)if(e>0&&(l+=","),l+=n[e],null!=i.a.SessionManager.Locations){let t,o=i.a.SessionManager.Locations.filter(t=>t.NodeID==n[e]);null!=o&&o.length>0&&""!=o[0].parentid.toString()&&parseInt(o[0].parentid.toString())>0&&(t=o[0].parentid.toString(),n.Contains(t)||n.push(t))}o=t?" AND ((("+e+".IsGroup=1 or "+e+".ProductID in (select ParentNodeID from COM_CostCenterCostCenterMap with(nolock) where ParentCostCenterID=3 and CostCenterID=50002 AND NodeID IN ("+l+")) )) or "+e+".ParentID=0)":" AND ((("+e+".ProductID in (select ParentNodeID from COM_CostCenterCostCenterMap with(nolock) where ParentCostCenterID=3 and CostCenterID=50002 AND NodeID IN ("+l+")) )) or "+e+".ParentID=0)"}else if("True"==i.a.SessionManager.Preferences.EnableDivisionWise.toString()&&"TRUE"==i.a.SessionManager.Preferences["DW Products"].toUpperCase()){let n=[];if(50001==this.ViewModel.oReportDialog.Locations.DBColumnID){if(!this.ViewModel.oReportDialog.Locations.Visible||null==this.ViewModel.oReportDialog.LocationWhere)return"";s.e.IsEmpty(this.ViewModel.oReportDialog.LocationWhere)?n.push("-101"):n.AddRange(this.ViewModel.oReportDialog.LocationWhere.split(","))}else{if("1"==i.a.SessionManager.UserID||"1"==i.a.SessionManager.RoleID)return"";0!=i.a.SessionManager.DivisionID||s.e.IsEmptySpace(i.a.SessionManager.DivisionWhere)?n.push(i.a.SessionManager.DivisionID.toString()):n.AddRange(i.a.SessionManager.DivisionWhere.split(","))}let l="";for(let e=0;e<n.length;e++)if(e>0&&(l+=","),l+=n[e],null!=i.a.SessionManager.Divisions){let t,o=i.a.SessionManager.Divisions.filter(t=>t.NodeID==n[e]);null!=o&&o.length>0&&""!=o[0].parentid.toString()&&parseInt(o[0].parentid.toString())>0&&(t=o[0].parentid.toString(),n.Contains(t)||n.push(t))}o=t?" AND ((("+e+".IsGroup=1 or "+e+".ProductID in (select ParentNodeID from COM_CostCenterCostCenterMap with(nolock) where ParentCostCenterID=3 and CostCenterID=50001 AND NodeID IN ("+l+")) )) or "+e+".ParentID=0)":" AND ((("+e+".ProductID in (select ParentNodeID from COM_CostCenterCostCenterMap with(nolock) where ParentCostCenterID=3 and CostCenterID=50001 AND NodeID IN ("+l+")) )) or "+e+".ParentID=0)"}s.e.IsEmpty(this.ViewModel.RowFiltersWhere)||(o=" AND "+this.ViewModel.RowFiltersWhere);let n=this.GetFilterByDimension_1(503);return n.length>0&&(o+=" AND "+e+".ProductTypeID in ("+n+")"),o}GetTagWiseQuery(e,t="Name",o="Name"){let i="SELECT NodeID,"+t+" "+o+" FROM "+d.GetTagTableName(e)+" WITH(NOLOCK) WHERE (IsGroup=0 OR NodeID=1)";e==this.ViewModel.oReportDialog.Locations.DBColumnID&&this.ViewModel.oReportDialog.Locations.Visible&&null!=this.ViewModel.oReportDialog.LocationWhere&&(s.e.IsEmpty(this.ViewModel.oReportDialog.LocationWhere)?i+=" AND 1!=1":i+=" AND NodeID IN ("+this.ViewModel.oReportDialog.LocationWhere+")");var n=this.ViewModel.oReportDialog.CostCenterFilters.filter(t=>t.CostCenterID==e);if(n.length>0){let e=n[0];if(e.SelectedNodes.length>0)if(1==e.SelectedNodes.length)i+=" AND NodeID="+e.SelectedNodes[0].Id;else{i+=" AND NodeID IN (";for(let t=0;t<e.SelectedNodes.length;t++)t>0&&(i+=","),i+=e.SelectedNodes[t].Id;i+=")"}else e.DeleteButtonVisibility||(i+=" AND NodeID=-12912")}return i+=" ORDER BY "+o,i}CheckLWAccountingDate(){let e="";this.ViewModel.oReportDialog.Locations.Visible&&null!=this.ViewModel.oReportDialog.LocationWhere&&(e=s.e.IsEmpty(this.ViewModel.oReportDialog.LocationWhere)?" AND 1!=1":" AND NodeID IN ("+this.ViewModel.oReportDialog.LocationWhere+")");let t=d.GetFilterByDimension_3(50002,this.ViewModel.oReportDialog.CostCenterFilters);t.length>0&&(e+=" AND NodeID IN ("+t+")"),this.ViewModel.DisplayMessage="";let o=i.a.report.ReportDataSet("RPT031",this.ViewModel.IsReportDB,e);o.Tables[0].length>1?this.ViewModel.DisplayMessage="Selected locations should have same Accounting period start month.'":o.Tables[0].length>0&&(this.AccountingFromMonth=parseInt(o.Tables[0][0].MonthStart))}}}}]);