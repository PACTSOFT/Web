(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{BBu9:function(e,t,i){"use strict";i.r(t),i.d(t,"PrefetchReportCells",(function(){return g})),i.d(t,"ReOrderLevelNewViewModel",(function(){return M}));var s=i("mrSG"),o=i("Do2H"),r=i("Lp6j"),l=i("vTM8"),n=i("8iaB"),a=i("0/4Q"),h=i("4HhE"),d=i("n56n"),u=i("7JXL"),c=i("ZDA+"),D=i("ockk"),m=i("x+Dt"),C=i("8B8H"),p=i("EQd/"),S=i("JIg3"),I=i("uMy8"),T=i("6z9j"),y=i("ktgv"),P=i("MCLT"),b=i("PDNK"),f=i("dH+5"),O=i("Jnyl"),R=i("CUWK");class g{constructor(){this.ROColID=null,this.Type=null,this.indReport=0,this.value=null,this.IsDimension=!1,this.DimensionID=1}}var E=function(e){return e[e.None=0]="None",e[e.BOM=1]="BOM",e[e.RawMaterial=2]="RawMaterial",e[e.FinishedProduct=3]="FinishedProduct",e}({});class M extends n.a{constructor(e,t,i){super(),this.ButtonsVisibility=!0,this._GridVisibility=!1,this.ShowAutoPost=!1,this.FilterVisibility=!1,this.ShowPostFilter=!1,this.ColumnsSource=null,this.RecordCount="",this.AutoPostMessage="",this.DateFilter="",this.ProfileName="",this.ShowBOMProducts=E.None,this.ProductsByVoucher=!1,this.ProductsByVoucher_Temp=!1,this.ProductsByRowSelection=!1,this.IsKitProjection=!1,this.DocumentVisibility=!1,this.AllowToAdd=!1,this.IsNew=!0,this.DialogAction=null,this.Documents=new a.e(0),this.TreeVisibility=!0,this.SalesFilterVisible=!1,this.AvgSaleByTrMn=!1,this.BOMGridWithReport=!1,this.Slot1=new p.d(0),this.Slot2=new p.d(0),this.Slot3=new p.d(0),this.SalesForeCastDays=new p.d(0),this.ToDateFilter=new S.a(0),this.FromDate=new S.a(0),this.ToDate=new S.a(0),this.colAvgSales=null,this.colReOrderQty=null,this.colOrderQty=null,this.colVendor=null,this.colUOM=null,this.DWPCProfile=null,this.xDocPref=new r.f,this.ExpectedQTY1="",this.ExpectedQTY2="",this.ExpectedQTY3="",this.CommitedQTY1="",this.CommitedQTY2="",this.CommitedQTY3="",this.SalesDocs="",this.BatchPreExpiry="",this.lstBatchExpirySlabs=new Array,this.drReport=null,this.DimensionFilter=null,this.LocationCols=new l.a,this.totalALL=new l.a,this.totalSELECTED=new l.a,this.SelectedLocations="",this.SelectedAvgLocations="",this.SelectedReOrderLocations="",this.SelectTag="",this.FromTag="",this.ReportID=112,this.worker=new h.a,this.dsReportDefn=null,this.dtPCProfile=null,this.strHiddenFields="",this.DefaultSortColumn="",this.SalesCostColumn="",this.SalesValueColumn="",this.DontIncludeExpiredProducts=!1,this.DontIncludePreExpiryProducts=!1,this.ExpiryPickFromProduct=!1,this.IsReportDB=!1,this.HidePrefetch=!1,this.ReorderDimension=0,this.PreExpiryProductDays=0,this.JOBDimension=0,this.DocumentMappingColumns=new Array,this.lstSaleSlots=new l.a,this.lstPCProfiles=new l.a,this.SalesSlotType="",this.PostedQtyFor="",this.ExeQty_DontShowUnApproved=!1,this.iLoop=0,this.sno=0,this.ProductsIDs=new Array,this.ObjArray=[],this.dsClass=null,this.strPrevGroup=null,this.indGrpColumn=1,this.GroupNo=0,this.dsProduct=null,this.dicFPQty=new l.c,this.dicFPConvertionQty=new l.a,this.dicKitProjection=new l.c,this.lstKitProjection=new Array,this.IsAutoPost=!0,this.ReorderBasedOnProductGroup_Report=!1,this.indPostIndex=0,this.iVendorCount=0,this.ChunkSize=2,this.lstVendors=new Array,this.lstPostDocsGroup=new Array,this.dtVoucherDetails=null,this.strDimensionLinkQry="",this.DocumentNumber=null,this.DocDefaultCCFields=new l.c,this.DocumentLinkDimensions=new Array,this.PostDocsGroupBy="",this.postworkerCancel=!1,this.postworkerIsBusy=!1,this.ClassName="ReOrderLevelNewViewModel",this.ReportID=t,this.dsReportDefn=i,this.Title=e,this.DisplayName=e,this.FilterVisibility=!0,this.GridVisibility=!1,this.InitFilterScreen(),this.HidePrefetch&&this.OnButtonClick("FilterOK")}get GridVisibility(){return this._GridVisibility}set GridVisibility(e){this._GridVisibility=e,this.BOMGrid&&this.BOMGrid.Visible&&setTimeout(()=>{this.BOMGrid.refreshUI()},200)}get Table(){return this.ReOrderGrid.Table}worker_DoWork(e,t){this.DisplayName=o.a.GetResource("Loading"),this.ButtonsVisibility=!1;try{this.RefreshDateFilter(),this.LoadReOrderGrid(t)}catch(i){Logger.ErrorLog("ReOrderLevel:: LoadReOrderGrid",i)}this.ButtonsVisibility=!0,this.DisplayName=this.Title}worker_RunWorkerCompleted(e,t){this.RecordCount="",this.ReOrderGrid.UpdateTotals(),this.ReOrderGrid.refreshDataView()}InitFilterScreen(){let e;if(this.ToDateFilter.Label="As On",this.ToDateFilter.LblWidth="50",this.Slot1.Label=o.a.GetResource("Report_LblSlot1"),this.Slot2.Label=o.a.GetResource("Report_LblSlot2"),this.Slot3.Label=o.a.GetResource("Report_LblSlot3"),this.Slot1.Width="70",this.Slot2.Width="70",this.Slot3.Width="70",this.SalesForeCastDays.Text="90",this.SalesForeCastDays.Label="Fore Cast Days",this.SalesForeCastDays.LblWidth="100",this.SalesForeCastDays.Width="170",this.FromDate.Label=o.a.GetResource("Reports_LblFromDate"),this.ToDate.Label=o.a.GetResource("Reports_LblToDate"),this.FromDate.Date=o.a.SessionManager.ReportsFromDate,this.ProductStatus=new a.e(0),this.ProductStatus.Label=o.a.GetResource("Reports_ProductStatus"),this.ProductStatus.Items.push(a.d.ComboBoxItems_2(o.a.GetResource("RevenUReport_Active"),"31")),this.ProductStatus.Items.push(a.d.ComboBoxItems_2(o.a.GetResource("RevenUReport_InActive"),"32")),this.ProductStatus.Items.push(a.d.ComboBoxItems_2(o.a.GetResource("DocumentDesigner_Displayboth"),"0")),this.ProductStatus.SelectedValue="0",this.tree=new Array,this.CostCenterFilters=new Array,this.Report=new Array,this.CostCenters=new a.e(0),this.CostCenters.Label=o.a.GetResource("Reports_SelectCostCenter"),this.CostCenters.LblWidth="160",this.CostCenters.SelectionChangedCommand.Subscribe(this,"OnCostCenterChange"),null==this.dsReportDefn)e=o.a.report.DataSet("RPT046",this.ReportID.toString());else{e=o.a.report.DataSet("RPT047",this.ReportID.toString());let t=this.dsReportDefn.Tables[0].Copy();t.TableName="dtDefn",e.Tables.push(t)}this.JOBDimension=r.e.Int(e.Tables[1][0].Value),r.e.IsEmpty(this.Title)&&(this.Title=e.Tables[2][0].ReportName.toString(),this.DisplayName=this.Title);let t=new r.f;t.LoadXml(e.Tables[2][0].ReportDefnXML.toString()),this.xDocPref.LoadXml(e.Tables[2][0].CustomPreferences.toString());let i=y.CostCenterPicker.GetDSBuffer().Tables[4].filter(e=>e.FeatureID>5e4||[3,16,40,76,78].Contains(e.FeatureID)),s={FeatureID:-101,Name:"Product Vendors"};i.push(s),s={},s.FeatureID=-102,s.Name="Kit & Assembled Products",i.push(s),i.SortBy(["Name"]);let n=new l.c,h=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"TreeDimensionsFilter");if(null!=h&&h.childNodes.forEach(e=>{i.filter(t=>t.FeatureID==e.attributes.CCID.value).length>0&&!n.ContainsKey(parseInt(e.attributes.CCID.value))&&n.push(parseInt(e.attributes.CCID.value),null!=e.attributes.Mandatory)}),h=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"HidePrefetch"),null!=h&&"1"==h.innerHTML&&(this.HidePrefetch=!0),h=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"PrefetchReportList"),null!=h){let e=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"ProductsByVoucher");null!=e&&"1"==e.innerHTML&&(this.ProductsByVoucher=!0),e=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"ProductsByRowSelection"),null!=e&&"1"==e.innerHTML&&(this.ProductsByRowSelection=!0),h.childNodes.forEach(e=>{let t=this.CostCenters.Items.find(t=>"50"==t.Value&&t.Parent==e.attributes.ID.value);null!=t?e.attributes.ColID.value.length>0&&(t.Aliasname+="\x11"+e.attributes.ColID.value+"~"+e.attributes.ROColID.value):(t=a.d.ComboBoxItems_3(e.attributes.Name.value,"50",e.attributes.ID.value),e.attributes.ColID.value.length>0&&(t.Aliasname=e.attributes.ColID.value+"~"+e.attributes.ROColID.value),this.CostCenters.Items.push(t))})}o.a.SessionManager.Preferences.ContainsKey("ReportsFrom")&&(this.IsReportDB="1"==o.a.SessionManager.Preferences.ReportsFrom,h=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"ReportsFrom"),null!=h&&("TrDB"==h.innerHTML?this.IsReportDB=!1:"RptDB"==h.innerHTML&&(this.IsReportDB=!0))),null!=h&&h.childNodes.forEach(e=>{i.filter(t=>t.FeatureID==e.attributes.CCID.value).length>0&&!n.ContainsKey(parseInt(e.attributes.CCID.value))&&n.push(parseInt(e.attributes.CCID.value),null!=e.attributes.Mandatory)}),i.forEach(e=>{let t=parseInt(e.FeatureID);t>5e4?(0==n.length||n.ContainsKey(t))&&(this.CostCenters.Items.push(a.d.ComboBoxItems_2(e.Name.toString(),e.FeatureID.toString())),n.length>0&&n[t]&&(this.CostCenters.Items[this.CostCenters.Items.length-1].Aliasname="1")):this.CostCenters.Items.push(a.d.ComboBoxItems_2(e.Name.toString(),e.FeatureID.toString()))}),this.CostCenters.Visible=!0,this.LoadTreeData(t.SelectSingleNode("PactRevenURpts/Filters/PreDataFetch")),this.Documents.Label="Document",this.Documents.LblWidth="80",this.Documents.Width="280";let d="";if(null!=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"DefaultSortColumn")&&(this.DefaultSortColumn=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"DefaultSortColumn").innerHTML),(r.e.IsEmptySpace(this.DefaultSortColumn)||"ProductName"!=this.DefaultSortColumn)&&(this.DefaultSortColumn="ProductCode"),this.ChunkSize=parseInt(r.f.SelectSingleNode(this.xDocPref.DocumentElement,"ChunkSize").innerHTML),d=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"DefaultDocument").innerHTML,this.ExpectedQTY1=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"ExpectedQTY1").innerHTML,this.ExpectedQTY2=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"ExpectedQTY2").innerHTML,this.ExpectedQTY3=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"ExpectedQTY3").innerHTML,this.CommitedQTY1=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"CommitedQTY1").innerHTML,this.CommitedQTY2=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"CommitedQTY2").innerHTML,this.CommitedQTY3=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"CommitedQTY3").innerHTML,this.ProductsBasedOn=null!=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"ProductsBasedOn")?r.f.SelectSingleNode(this.xDocPref.DocumentElement,"ProductsBasedOn").innerHTML.split(","):[],this.DataBasedOn=null!=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"DataBasedOn")?r.f.SelectSingleNode(this.xDocPref.DocumentElement,"DataBasedOn").innerHTML.split(","):[],this.SalesDocs=null!=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"SalesDocs")?r.f.SelectSingleNode(this.xDocPref.DocumentElement,"SalesDocs").innerHTML:"",h=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"HideSalesFilter"),this.SalesFilterVisible=null==h||"1"!=h.innerHTML,h=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"AvgSaleByTrMn"),this.AvgSaleByTrMn=null!=h&&"1"==h.innerHTML,h=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"ShowBOMGrid"),this.BOMGridWithReport=null!=h&&"1"==h.innerHTML,h=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"PODisable"),this.Documents.Enable=null==h||"1"!=h.innerHTML,h=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"POAuto"),this.IsAutoPost=null!=h&&"1"==h.innerHTML,h=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"ReorderBasedOnProductGroup"),this.ReorderBasedOnProductGroup_Report=null!=h&&"1"==h.innerHTML,h=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"ToDateFilter"),this.ToDateFilter.Visible=null!=h&&"1"==h.innerHTML,h=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"PostDocsGroupBy"),this.PostDocsGroupBy=null!=h?h.innerHTML:"",this.ExeQty_DontShowUnApproved=null!=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"ExeQty_DontShowUnApproved"),this.PostedQtyFor=null==r.f.SelectSingleNode(this.xDocPref.DocumentElement,"PostedQtyFor")?"":r.f.SelectSingleNode(this.xDocPref.DocumentElement,"PostedQtyFor").innerHTML,this.SalesSlotType=null==r.f.SelectSingleNode(this.xDocPref.DocumentElement,"ShowSlot")?"":r.f.SelectSingleNode(this.xDocPref.DocumentElement,"ShowSlot").innerHTML,"Yearly"==this.SalesSlotType){let e=new Date(Date.Today().getFullYear(),o.a.SessionManager.AccountingFromMonth-1,1);e>Date.Today()&&(e=e.AddYears(-1));let t=Date.Today();this.Slot1.Text=(Date.Today().Subtract(e).Days+1).toString(),this.Slot1.DependantOn=1==o.a.SessionManager.AccountingFromMonth?e.getFullYear().toString():e.getFullYear().toString()+"-"+((e.getFullYear()+1)%100).toString(),t=e,e=e.AddYears(-1),this.Slot2.Text=(Date.Today().Subtract(e).Days+1).toString(),this.Slot2.DependantOn=1==o.a.SessionManager.AccountingFromMonth?e.getFullYear().toString():e.getFullYear().toString()+"-"+((e.getFullYear()+1)%100).toString(),t=e,e=e.AddYears(-1),this.Slot3.Text=(Date.Today().Subtract(e).Days+1).toString(),this.Slot3.DependantOn=1==o.a.SessionManager.AccountingFromMonth?e.getFullYear().toString():e.getFullYear().toString()+"-"+((e.getFullYear()+1)%100).toString(),this.Slot1.Enable=!1,this.Slot2.Enable=!1,this.Slot3.Enable=!1}else if("Monthly"==this.SalesSlotType){let e=new Date(Date.Today().getFullYear(),Date.Today().getMonth(),1),t=Date.Today();this.Slot1.Text=(Date.Today().Subtract(e).Days+1).toString(),this.Slot1.DependantOn=e.ToString("MMM-yy"),t=e,e=e.AddMonths(-1),this.Slot2.Text=(Date.Today().Subtract(e).Days+1).toString(),this.Slot2.DependantOn=e.ToString("MMM-yy"),t=e,e=e.AddMonths(-1),this.Slot3.Text=(Date.Today().Subtract(e).Days+1).toString(),this.Slot3.DependantOn=e.ToString("MMM-yy"),this.Slot1.Enable=!1,this.Slot2.Enable=!1,this.Slot3.Enable=!1}else this.Slot1.Text=null==r.f.SelectSingleNode(this.xDocPref.DocumentElement,"Slot1")?"30":r.f.SelectSingleNode(this.xDocPref.DocumentElement,"Slot1").innerHTML,this.Slot2.Text=null==r.f.SelectSingleNode(this.xDocPref.DocumentElement,"Slot2")?"60":r.f.SelectSingleNode(this.xDocPref.DocumentElement,"Slot2").innerHTML,this.Slot3.Text=null==r.f.SelectSingleNode(this.xDocPref.DocumentElement,"Slot3")?"90":r.f.SelectSingleNode(this.xDocPref.DocumentElement,"Slot3").innerHTML;let u,c=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"DontIncludeExpiredProducts");if(this.DontIncludeExpiredProducts=null!=c&&"1"==c.innerHTML,c=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"DontIncludePreExpiryProducts"),this.DontIncludePreExpiryProducts=null!=c&&"1"==c.innerHTML,this.DontIncludePreExpiryProducts&&(c=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"ExpiryPickFromProduct"),this.ExpiryPickFromProduct=null!=c&&"1"==c.innerHTML,this.ExpiryPickFromProduct||(this.PreExpiryProductDays=r.e.Int(r.f.SelectSingleNodeText(this.xDocPref.DocumentElement,"PreExpiryProductDays")))),null!=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"ExpirySlab1")&&(u=r.e.Int(r.f.SelectSingleNodeText(this.xDocPref.DocumentElement,"ExpirySlab1")),u>0&&this.lstBatchExpirySlabs.push(u)),null!=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"ExpirySlab2")&&(u=r.e.Int(r.f.SelectSingleNodeText(this.xDocPref.DocumentElement,"ExpirySlab2")),u>0&&(0==this.lstBatchExpirySlabs.length||this.lstBatchExpirySlabs[this.lstBatchExpirySlabs.length-1]<u)&&this.lstBatchExpirySlabs.push(u)),null!=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"ExpirySlab3")&&(u=r.e.Int(r.f.SelectSingleNodeText(this.xDocPref.DocumentElement,"ExpirySlab3")),u>0&&(0==this.lstBatchExpirySlabs.length||this.lstBatchExpirySlabs[this.lstBatchExpirySlabs.length-1]<u)&&this.lstBatchExpirySlabs.push(u)),this.ChunkSize<=0&&(this.ChunkSize=25),e.Tables[0].forEach(e=>{this.Documents.Items.push(a.d.ComboBoxItems_2(e.DocumentName.toString(),e.CostCenterID.toString())),e.CostCenterID.toString()==d&&(this.Documents.SelectedValue=d,this.Documents.SelectedItem=this.Documents.Items[this.Documents.Items.length-1])}),this.drReport=e.Tables[2][0],this.InitReOrderGrid(t),null!=e.Tables[2][0].KPIXML&&e.Tables[2][0].KPIXML.toString().length>0&&this.ReOrderGrid.InitKPI(e.Tables[2][0].KPIXML.toString()),r.e.IsEmpty(this.Documents.SelectedValue)&&(this.Documents.SelectedValue=this.Documents.Items[0].Value,this.Documents.SelectedItem=this.Documents.Items[0]),!r.e.IsEmpty(e.Tables[2][0].RowColumnReportsMap)){let t=new r.f;t.LoadXml(e.Tables[2][0].RowColumnReportsMap.toString()),this.ReOrderGrid.ContextMenu=new l.a,r.f.SelectNodes(t.DocumentElement,"RowReport").forEach(e=>{this.ReOrderGrid.ContextMenu.push(r.f.SelectSingleNodeText(e,"Name"),e)}),0==this.ReOrderGrid.ContextMenu.length&&(this.ReOrderGrid.ContextMenu=null),this.ReOrderGrid.ContextMenuClick.subscribe(()=>{this.OnContextMenuClick(null)})}this.ProductsByBOM=new b.b,this.ProductsByBOM.Label="Show Products By",this.ProductsByBOM.Items.push(new b.a),this.ProductsByBOM.Items[0].IsChecked=!0,this.ProductsByBOM.Items.push(new b.a),this.ProductsByBOM.Items.push(new b.a),this.ProductsByBOM.Items[0].Label="Bom",this.ProductsByBOM.Items[1].Label="Raw Material",this.ProductsByBOM.Items[2].Label="Finished Product"}InitReOrderGrid(e){let t,i=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"ShowVendor");this.Vendor=new d.b(0),this.Vendor.Label=o.a.GetResource("Inv_Vendor"),null!=i&&"HeaderWise"==i.innerHTML?(this.Vendor.CCID=2,this.Vendor.TypeID=2,this.Vendor.Visible=!0):this.Vendor.Visible=!1,this.BOMGrid=new C.a,this.BOMGrid.Visible=!1,this.BOMGrid.Width="",this.BOMGrid.Height=130,this.BOMGrid.Table=[],this.BOMGrid.TableColumns.push("BOMID"),this.BOMGrid.TableColumns.push("BOM"),this.BOMGrid.TableColumns.push("Qty"),this.BOMGrid.TableColumns.push("UnitType"),this.BOMGrid.TableColumns.push("UOM"),this.BOMGrid.TableColumns.push("UOM_Key"),this.BOMGrid.Columns=new Array,t=new D.a,t.Header="BOM",t.DisplayMember="BOM",t.Width=120,t.ReadOnly=!0,this.BOMGrid.Columns.push(t),t=new D.a,t.Header="Qty",t.DisplayMember="Qty",t.DataType="FLOAT",t.Width=50,t.IsCalculated=1,t.DisableTab=!0,t.DecimalPoints=o.a.SessionManager.Preferences.DecimalsinQty,this.BOMGrid.Columns.push(t),t=new D.a,t.Header="Type",t.ValueBinding="UnitType",t.Width=55,t.IsCalculated=1,t.DisableTab=!0,t.DataType="ComboBox",t.DisplayMember="Name",t.ValueMember="Value";let s=new Array;s.push(a.d.ComboBoxItems_2("BOM","1")),s.push(a.d.ComboBoxItems_2("Qty","2")),t.ComboData=s,this.BOMGrid.Columns.push(t),t=new D.a,t.Header=o.a.GetResource("UOM"),t.CostCenterID=11,t.TypeID=1,t.DataType="LISTBOX",t.DisplayMember="UOM",t.ValueMember="UOM_Key",t.Width=90,this.BOMGrid.Columns.push(t),this.BOMGrid.OnBeginEdit.Subscribe(this,"BOMGridBeginEdit"),this.KitGrid=new C.a,this.KitGrid.Width="",this.KitGrid.Height=120,this.KitGrid.Visible=!1,this.MOGrid=new C.a,this.MOGrid.Width="",this.MOGrid.Height=120,this.MOGrid.Visible=!1,this.ReOrderGrid=new C.a,this.ReOrderGrid.Width="",this.ReOrderGrid.Height=0,this.ReOrderGrid.HeaderHeight=40,this.ReOrderGrid.CalcTotalsOnDataView=!0,this.ReOrderGrid.Table=[],this.ReOrderGrid.TableColumns.push("Sno"),this.ReOrderGrid.TableColumns.push("ProductCode"),this.ReOrderGrid.TableColumns.push("ProductName"),this.ReOrderGrid.TableColumns.push("ProductName_Key"),this.ReOrderGrid.TableColumns.push("QOH"),this.ReOrderGrid.TableColumns.push("Variance"),this.ReOrderGrid.TableColumns.push("Variance_RED"),this.ReOrderGrid.TableColumns.push("OrderQty"),this.ReOrderGrid.TableColumns.push("UOM"),this.ReOrderGrid.TableColumns.push("UOM_Key"),this.ReOrderGrid.TableColumns.push("Vendor"),this.ReOrderGrid.TableColumns.push("Vendor_Key");let l=new Array,n=e.SelectNodes("PactRevenURpts/PactRevenURptDef/Columns/ColumnDef"),h=new Array;e.SelectNodes("PactRevenURpts/PactRevenURptDef/ReportTotal/Columns/Column").forEach(e=>{h.push(e.innerHTML)});let u=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"ReorderDimension");this.ReorderDimension=null!=u?parseInt(u.innerHTML):50002;let c=o.a.report.GetLocations(this.ReorderDimension),p=c,S=0;new Array,this.totalALL.Clear(),this.totalSELECTED.Clear(),this.LocationCols.Clear();let T=1,y=e.SelectSingleNode("PactRevenURpts/PactRevenURptDef/FrozeColumns");null!=y&&(T=parseInt(y.innerHTML)),t=new D.a,t.Header=o.a.GetResource("AssetManagement_SNo"),t.DisplayMember="Sno",t.Width=40,t.ReadOnly=!0,t.IsFrozen=!0,l.push(t);let P=["SalesQty","SalesValue","SalesCost","SalesProfit","Class"],b="";for(let a=0;a<n.length;a++){let e=n[a];if(t=new D.a,t.ReadOnly=!0,t.DisableTab=!0,t.IsCalculated=1,t.Header=this.GetNodeValue(e,"Identity/Caption"),t.DisplayMember=this.GetNodeValue(e,"Identity/ID"),t.ID=t.DisplayMember,t.DataType=this.GetNodeValue(e,"Identity/Type").toUpperCase(),"ProductGroup"==t.DisplayMember&&(t.DataType=""),h.Contains(t.DisplayMember)&&(t.ShowTotal=!0),"ProductCode"!=t.ID&&"ProductName"!=t.ID||"3"!=this.GetNodeValue(e,"Linking/Type")||(t.DataType="LINK"),this.GetNodeValue(e,"HeaderAppearance/BackGrndColor").length>0&&(t.HeaderBackColor=this.GetNodeValue(e,"HeaderAppearance/BackGrndColor")),this.GetNodeValue(e,"HeaderAppearance/ForeGrndColor").length>0&&(t.HeaderForegroundColor=this.GetNodeValue(e,"HeaderAppearance/ForeGrndColor")),33==t.DisplayMember.length){t.Formula=this.GetNodeValue(e,"Identity/Expression"),0!=r.e.stringCompare(t.Formula,"LATEST",!0)&&0!=r.e.stringCompare(t.Formula,"OLDEST",!0)||(t.Formula="");let i=this.GetNodeValue(e,"Identity/SysColumn");r.e.IsEmpty(i)||(i.startsWith("dcCalcNum")?i=i.Replace("dcCalcNum","dcCalcdcNum"):i.startsWith("dcCCNID")&&this.ReOrderGrid.TableColumns.push(t.DisplayMember+"_ID"),t.SectionName=i,this.DocumentMappingColumns.push(t))}else"SalesCost"==t.DisplayMember?this.SalesCostColumn=this.GetNodeValue(e,"Identity/SysColumn"):"SalesValue"==t.DisplayMember&&(this.SalesValueColumn=this.GetNodeValue(e,"Identity/SysColumn"));if(t.Expression=this.GetNodeValue(e,"Format/ColumnFilterExpression"),l.length==T&&(t.IsFrozen=!0),"FLOAT"==t.DataType)if(r.e.IsNum(this.GetNodeValue(e,"Format/Decimals"))){let i=r.e.Int(this.GetNodeValue(e,"Format/Decimals"));t.DecimalPoints=-1==i?parseInt(o.a.SessionManager.Preferences.DecimalsinAmount).toString():i.toString()}else t.DecimalPoints=o.a.SessionManager.Preferences.DecimalsinQty;"AvgSale"==t.DisplayMember?this.colAvgSales=t:"ReOrderQty"==t.DisplayMember?this.colReOrderQty=t:"Vendor"==t.DisplayMember?(this.colVendor=t,t.ReadOnly=null!=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"DisableVendor"),this.Vendor.Visible?t.IsVisible=!1:(t.CostCenterID=2,t.TypeID=100,t.DataType="LISTBOX",t.DisplayMember="Vendor",t.ValueMember="Vendor_Key")):"UOM"==t.DisplayMember?(this.colUOM=t,t.ReadOnly=!1,t.CostCenterID=11,t.TypeID=1,t.DataType="LISTBOX",t.DisplayMember="UOM",t.ValueMember="UOM_Key"):"OrderQty"==t.DisplayMember?(this.colOrderQty=t,t.ReadOnly=!1,t.Formula=this.GetNodeValue(e,"Identity/Expression")):("Variance"==t.DisplayMember||"OrderValue"==t.DisplayMember)&&(t.Formula=this.GetNodeValue(e,"Identity/Expression")),this.ReOrderGrid.TableColumns.Contains(t.DisplayMember)||this.ReOrderGrid.TableColumns.push(t.DisplayMember),"0"==this.GetNodeValue(e,"HeaderAppearance/Visibility")&&(t.IsVisible=!1),t.Width=""!=this.GetNodeValue(e,"Width")?parseInt(this.GetNodeValue(e," Width")):90;let i=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"Locations/"+t.DisplayMember);if(null!=i&&""!=i.innerHTML&&"-1"!=i.innerHTML){if(!P.Contains(t.DisplayMember)){let e=i.innerHTML.split(",");for(let i=0;i<e.length;i++){let s=t.Clone();S=parseInt(e[i]),-1==S?(s.Header=s.Header+" ALL LOCATIONS",this.totalALL.push(t.DisplayMember,0),s.DisplayMember=t.DisplayMember+"_ALL"):-2==S?(s.Header=s.Header+" TOTAL",this.totalSELECTED.push(t.DisplayMember,0),s.DisplayMember=t.DisplayMember+"_SELECTED"):(p=c.filter(t=>t.NodeID==e[i]),s.Header=p.length>0?s.Header+" "+p[0].Name.toString():s.Header+" "+e[i],this.LocationCols.ContainsKey(e[i])||this.LocationCols.push(e[i],new Array),this.LocationCols[e[i]].push(t.DisplayMember),s.DisplayMember=t.DisplayMember+"_"+e[i]),this.ReOrderGrid.TableColumns.Contains(s.DisplayMember)||this.ReOrderGrid.TableColumns.push(s.DisplayMember),l.push(s)}continue}0==b.length&&(b=i.innerHTML)}l.push(t)}let O=-1;for(let o=0;o<l.length;o++)P.Contains(l[o].DisplayMember)&&(-1==O&&(O=o),l[o].IsVisible||(l[o].Dependantinuse=!0),this.lstSaleSlots.push(l[o].DisplayMember,l[o]),l.RemoveAt(o),o--);if(this.lstSaleSlots.length>0)if(0==b.length)if("Yearly"==this.SalesSlotType||"Monthly"==this.SalesSlotType)for(let o=3;o>=1;o--)this.lstSaleSlots.keys.forEach(e=>{t=this.lstSaleSlots[e].Clone(),t.BarcodeDef=t.Header,t.Header=t.Header+" "+o.toString(),t.DisplayMember=t.DisplayMember+o.toString(),l.Insert(O,t),this.ReOrderGrid.TableColumns.Contains(t.DisplayMember)||this.ReOrderGrid.TableColumns.push(t.DisplayMember),O++});else for(let o=1;o<=3;o++)this.lstSaleSlots.keys.forEach(e=>{t=this.lstSaleSlots[e].Clone(),t.BarcodeDef=t.Header,t.Header=t.Header+" "+o.toString(),t.DisplayMember=t.DisplayMember+o.toString(),l.Insert(O,t),this.ReOrderGrid.TableColumns.Contains(t.DisplayMember)||this.ReOrderGrid.TableColumns.push(t.DisplayMember),O++});else{let e=b.split(",");for(let i=0;i<e.length;i++){let s,o=e[i];for(s="Yearly"==this.SalesSlotType||"Monthly"==this.SalesSlotType?3:1;;)if(S=parseInt(o),this.lstSaleSlots.keys.forEach(e=>{t=this.lstSaleSlots[e].Clone(),t.BarcodeDef=t.Header,t.DisplayMember=t.DisplayMember+s.toString(),-1==S?(t.Header=t.Header+" ALL LOCATIONS",t.BarcodeProp=" ALL LOCATIONS",this.totalALL.push(t.DisplayMember,0),t.Header=t.Header+"  ALL LOCATIONS",t.DisplayMember=t.DisplayMember+"_ALL"):-2==S?(t.Header=t.Header+" TOTAL",t.BarcodeProp=" TOTAL",this.totalSELECTED.push(t.DisplayMember,0),t.DisplayMember=t.DisplayMember+"_SELECTED"):(p=c.filter(e=>e.NodeID==o),p.length>0?(t.Header=t.Header+" "+p[0].Name.toString(),t.BarcodeProp=" "+p[0].Name.toString()):(t.Header=t.Header+" "+o,t.BarcodeProp=" "+o),this.LocationCols.ContainsKey(o)||this.LocationCols.push(o,new Array),this.LocationCols[o].push(t.DisplayMember),t.DisplayMember=t.DisplayMember+"_"+o),l.Insert(O,t),this.ReOrderGrid.TableColumns.Contains(t.DisplayMember)||this.ReOrderGrid.TableColumns.push(t.DisplayMember),O++}),"Yearly"==this.SalesSlotType||"Monthly"==this.SalesSlotType){if(s--,0==s)break}else if(s++,s>3)break}}this.DWPCProfile=l.find(e=>"DWPCProfile"==e.DisplayMember&&e.IsVisible),null!=this.DWPCProfile&&(this.DWPCProfile.ShowTotal=!1,l.Remove(this.DWPCProfile));let R=l.find(e=>"BatchPreExpiry"==e.DisplayMember&&e.IsVisible);if(null!=R&&R.IsVisible&&this.lstBatchExpirySlabs.length>0){for(let t=0;t<this.lstBatchExpirySlabs.length;t++)this.BatchPreExpiry+=" S"+t+'="'+this.lstBatchExpirySlabs[t]+'"';this.BatchPreExpiry.length>0&&(this.BatchPreExpiry="<Exp"+this.BatchPreExpiry+"/>");let e=l.indexOf(R);l.Remove(R);for(let i=0;i<this.lstBatchExpirySlabs.length;i++)t=R.Clone(),t.Header=t.Header+" [",t.Header+=0==i?"1":(this.lstBatchExpirySlabs[i-1]+1).toString(),t.Header+="-"+this.lstBatchExpirySlabs[i].toString()+"]",t.DisplayMember="BEx"+i.toString(),l.Insert(e+i,t),this.ReOrderGrid.TableColumns.Contains(t.DisplayMember)||this.ReOrderGrid.TableColumns.push(t.DisplayMember)}this.SelectedAvgLocations="",this.SelectedReOrderLocations="",this.LocationCols.keys.forEach(e=>{let t={Key:e,Value:this.LocationCols[e]};t.Value.Contains("AvgRate")&&(this.SelectedAvgLocations.length>0&&(this.SelectedAvgLocations+=","),this.SelectedAvgLocations+=t.Key),(t.Value.Contains("ReOrderLevel")||t.Value.Contains("ReOrderQty")||t.Value.Contains("SellingPrice"))&&(this.SelectedReOrderLocations.length>0&&(this.SelectedReOrderLocations+=","),this.SelectedReOrderLocations+=t.Key)}),["BalanceQty","ReOrderLevel","ExpQty1","ExpQty2","ExpQty3","ComQty1","ComQty2","ComQty3","CY1","CY2","CY3","CYAvgSale","FC1","FC2","FC3","FCPYAvgSale","OrderQty"].forEach(e=>{this.totalSELECTED.ContainsKey(e)||(this.totalSELECTED.push(e,0),this.ReOrderGrid.TableColumns.push(e+"_SELECTED"))}),this.SelectedLocations="",this.LocationCols.keys.forEach(e=>{this.SelectedLocations.length>0&&(this.SelectedLocations+=","),this.SelectedLocations+=e}),null==this.colOrderQty&&(t=new D.a,t.Header=o.a.GetResource("Inv_OrderQty"),t.DisplayMember="OrderQty",t.DataType="FLOAT",t.Width=80,t.IsCalculated=1,t.DisableTab=!0,t.DecimalPoints=o.a.SessionManager.Preferences.DecimalsinQty,l.push(t)),null==this.colUOM&&(t=new D.a,t.Header=o.a.GetResource("UOM"),t.CostCenterID=11,t.TypeID=1,t.DataType="LISTBOX",t.DisplayMember="UOM",t.ValueMember="UOM_Key",t.Width=80,l.push(t)),this.Vendor.Visible||null!=this.colVendor||(t=new D.a,t.Header=o.a.GetResource("Inv_Vendor"),t.CostCenterID=2,t.TypeID=100,t.DataType="LISTBOX",t.DisplayMember="Vendor",t.ValueMember="Vendor_Key",t.Width=120,l.push(t));let g=e.SelectSingleNode("PactRevenURpts/PactRevenURptDef/Query/Select");this.SelectTag=null!=g?r.e.DecodeXML(g.innerHTML):"",g=e.SelectSingleNode("PactRevenURpts/PactRevenURptDef/Query/From"),this.FromTag=null!=g?g.innerHTML:"",l.forEach(e=>{if(!r.e.IsEmptySpace(e.Formula)){let t=e.Formula,i=new I.a;i.SetKeyWords("REPORT");let s=[];i.ParseFormula(t,s);let o,n="",a=null;for(let e=s.length-1;e>=0;e--){let t=s[e];o=t.getTokenValue().toString(),t.getTokenClass()!=I.d.OPERAND||null==a||a.getTokenClass()!=I.d.OPERAND?a=t:(a.tokenValue=t.tokenValue.toString()+a.tokenValue.toString(),s.RemoveAt(e))}s.forEach(e=>{let t=e;if(o=t.getTokenValue().toString(),t.getTokenClass()==I.d.OPERAND)for(let i=0;i<l.length;i++){let e=l[i];if(0==r.e.stringCompare(e.Header.Replace(" ",""),o,!0)){o=e.DisplayMember;break}}"STRING"==t.getTokenName()?n+='"'+o+'"':(t.getTokenType()==I.e.KEYWORD&&(n+=" "),n+=o,t.getTokenType()==I.e.KEYWORD&&(n+=" "))}),e.Formula=n}}),this.ReOrderGrid.CanUserSortColumns=!0,this.ReOrderGrid.Columns=l,this.ReOrderGrid.ConstructFormulaFields(!1),this.ReOrderGrid.IgnoreFormulaKeywords=new Array,this.ReOrderGrid.IgnoreFormulaKeywords.push("FROMDATE"),this.ReOrderGrid.IgnoreFormulaKeywords.push("TODATE"),this.ReOrderGrid.IgnoreFormulaKeywords.push("SYSTEMDATE"),this.ReOrderGrid.IgnoreFormulaKeywords.push("CURRENT_YEARSTART"),this.ReOrderGrid.fldDict.ContainsKey("FROMDATE")||this.ReOrderGrid.fldDict.push("FROMDATE",new I.c("FROMDATE","")),this.ReOrderGrid.fldDict.ContainsKey("TODATE")||this.ReOrderGrid.fldDict.push("TODATE",new I.c("TODATE","")),this.ReOrderGrid.fldDict.ContainsKey("SYSTEMDATE")||this.ReOrderGrid.fldDict.push("SYSTEMDATE",new I.c("SYSTEMDATE","")),this.ReOrderGrid.fldDict.ContainsKey("CURRENT_YEARSTART")||this.ReOrderGrid.fldDict.push("CURRENT_YEARSTART",new I.c("CURRENT_YEARSTART","")),this.ReOrderGrid.fldDict.SYSTEMDATE.setFieldValue(Date.Today()),this.ReOrderGrid.fldDict.CURRENT_YEARSTART.setFieldValue(new Date(Date.Today().getFullYear(),0,1)),this.ReOrderGrid.OnLinkClick.Subscribe(this,"OnLinkClick"),this.ReOrderGrid.OnBeginEdit.Subscribe(this,"OnGridBeginEdit"),["BalanceQty","ReOrderLevel","ReOrderQty","SellingPrice","LastPrice","ExpQty1","ExpQty2","ExpQty3","ComQty1","ComQty2","ComQty3","CY1","CY2","CY3","CYAvgSale","FC1","FC2","FC3","FCPYAvgSale","AvgRate","SalesQty","SalesValue","SalesCost","SalesProfit"].forEach(e=>{if(0==l.filter(t=>t.DisplayMember.startsWith(e)&&t.IsVisible).length&&0==l.filter(t=>!r.e.IsEmpty(t.Formula)&&t.Formula.Contains(e)).length){for(let t=l.length-1;t>=0;t--)l[t].DisplayMember.startsWith(e)&&(this.ReOrderGrid.TableColumns.Contains(l[t].DisplayMember)&&this.ReOrderGrid.TableColumns.Remove(l[t].DisplayMember),l.RemoveAt(t));this.totalSELECTED.ContainsKey(e)&&this.totalSELECTED.Remove(e),this.totalALL.ContainsKey(e)&&this.totalALL.Remove(e),this.LocationCols.values.forEach(t=>{t.Contains(e)&&t.Remove(e)}),this.strHiddenFields+=e+","}}),this.strHiddenFields=this.strHiddenFields.TrimEnd(","),this.AvgSaleByTrMn&&(this.strHiddenFields+=",AvgSaleByTrMn"),this.ColumnsSource=this.ReOrderGrid.Columns,this.PostDataFetchFilterFields=new Array,this.ReOrderGrid.Columns.forEach(e=>{if(e.IsVisible&&e.ReadOnly){let t=new f.b;t.ID=e.DisplayMember,t.ColumnType=e.DataType,t.HeaderText=e.Header;let i=new m.a;i.PostDataField_1(t,this),this.PostDataFetchFilterFields.push(i)}})}GetNodeValue(e,t){let i="";return e&&(i=r.f.SelectSingleNodeText(e,t)),i}BOMGridBeginEdit(e){return"DataGridPactListBoxColumn"==e.args.column.className&&"1"==e.args.item.UnitType.toString()}LoadReOrderGrid(e){let t=!1;this.ReportData=this.ReOrderGrid.Table,this.RecordCount="",this.ProductsIDs.Clear();let i=0;this.VendorWHERE="";let s=this.GetDimensionFilter("CCMAP.CCNID",this.ProductsBasedOn,!0),n=this.GetFilterNodes(16);this.BomWHERE=this.GetFilterNodes(76),this.MOWHERE=this.GetFilterNodes(78),this.JobWHERE=this.JOBDimension>0?this.GetFilterNodes(this.JOBDimension):"",this.KitWHERE=this.GetFilterNodes(-102),this.BOMSelect="";let a="",h="",d="",u="";this.ProductsByVoucher_Temp=!1,this.ShowBOMProducts=E.None;let c=this.CostCenterFilters.find(e=>3==e.CostCenterID);if(null!=c&&null!=c.SelectedNodes&&c.SelectedNodes.length>0){let e=c.GetSeqNosListWithRoots();c.IsOneSelected||(c.IsGroupExists?(u=" AND P.ProductID=GTP.GTID",d=e.Contains(",")?",(select T.ProductID GTID from INV_Product T with(nolock),INV_Product GT1 with(nolock) where T.lft BETWEEN GT1.lft AND GT1.rgt AND GT1.ProductID IN ("+e+") group by T.ProductID) AS GTP ":",(select T.ProductID GTID from INV_Product T with(nolock),INV_Product GT1 with(nolock) where T.lft BETWEEN GT1.lft AND GT1.rgt AND GT1.ProductID="+e+" group by T.ProductID) AS GTP "):u=e.Contains(",")?" AND P.ProductID IN ("+e+")":" AND P.ProductID="+e)}this.dsProduct=null;let D=this.CostCenterFilters.find(e=>-101==e.CostCenterID);var m=this.CostCenterFilters.filter(e=>50==e.CostCenterID&&null!=e.SelectedNodes&&e.SelectedNodes.length>0);if(this.ReportSelectedNodes=new Array,m.forEach(e=>{this.ReportSelectedNodes.AddRange(e.SelectedNodes.filter(e=>0==e.IsGroup))}),null!=D&&D.SelectedNodes.length>0){for(let e=0;e<D.SelectedNodes.length;e++)e>0&&(this.VendorWHERE+=","),this.VendorWHERE+=D.SelectedNodes[e].Id;this.Vendor.Visible&&(this.Vendor.SelectedValue=D.SelectedNodes[0].Id)}let C=this.Report.length>0&&this.Report[0].Preferences.ContainsKey("UseBomInReorder");if(this.dicFPQty=new l.c,C&&0==this.BomWHERE.length&&this.ReportSelectedNodes.length>0){this.BomWHERE="",this.ShowBOMProducts=this.ProductsByBOM.Items[1].IsChecked?E.RawMaterial:this.ProductsByBOM.Items[2].IsChecked?E.FinishedProduct:E.BOM;let e=-1,t=this.Report[0].Preferences.ContainsKey("ReorderQtyColumn")?this.Report[0].Preferences.ReorderQtyColumn:"";if(this.Report.length>0){let i=this.Report[0].ReportColumns.find(e=>e.ID==t);null!=i&&(e=this.Report[0].ReportColumns.indexOf(i))}if(this.ReportSelectedNodes.forEach(t=>{this.dicFPQty.ContainsKey(t.Id)?-1!=e&&(i=0,i=r.e.Double(t.Tag.Cells[e].Value),i>0&&(this.dicFPQty[t.Id]+=i)):(this.BomWHERE.length>0&&(this.BomWHERE+=","),this.BomWHERE+=t.Id,i=0,-1!=e&&(i=r.e.Double(t.Tag.Cells[e].Value)),i<=0&&(i=1),this.dicFPQty.push(t.Id,i))}),this.ShowBOMProducts==E.FinishedProduct)C=!1,this.ProductsByVoucher=!1,this.BomWHERE="";else{let e=o.a.report.GetDataTable("RPT048",this.BomWHERE);this.BomWHERE="",e.forEach(e=>{this.BomWHERE.length>0&&(this.BomWHERE+=","),this.BomWHERE+=e.BOMID.toString()});let t=[];e.forEach(e=>{let i={};i.BOMID=e.BOMID,i.BOM=e.BOMCode.toString(),i.Qty=this.dicFPQty[parseInt(e.ProductID)],i.UOM=e.UOMID.toString(),i.UOM_key=e.UOMID.toString(),i.UnitType="2",t.push(i)}),this.BOMGrid.Table=t}}if(!C&&this.ReportSelectedNodes.length>0){this.ProductsByVoucher&&(this.ProductsByVoucher_Temp=!0),this.dsProduct={Tables:[],Columns:[]};let e=[];this.dsProduct.Columns[0]=[],this.dsProduct.Columns[0].push("ProductID"),this.dsProduct.Columns[0].push("VoucherNo"),this.dsProduct.Columns[0].push("ReorderDetailsID"),this.ReportSelectedNodes.forEach(t=>{if(this.ProductsByVoucher||!this.ProductsIDs.Contains(t.Id)){let i={};e.push(i),i.ProductID=t.Id,t.Text.length>1&&(i.VoucherNo=t.Text[1],i.ReorderDetailsID=parseInt(t.Text[2])),this.ProductsIDs.push(t.Id)}}),this.dsProduct.Tables.push(e)}else if(u.length>0||s.length>0||this.VendorWHERE.length>0||this.BomWHERE.length>0||this.MOWHERE.length>0||n.length>0||this.KitWHERE.length>0||null!=c&&c.IsOneSelected)if(this.ReorderBasedOnProductGroup_Report&&0==this.BOMSelect.length&&0==a.length&&0==h.length&&0=="".length&&0==this.VendorWHERE.length&&(t=!0),this.VendorWHERE.length>0)o.a.report.ReportDataTable("RPT049",this.IsReportDB,d,this.VendorWHERE,u).forEach(e=>{this.ProductsIDs.push(parseInt(e[0]))});else{let e="",i="";s.Contains("CCMAP.CCNID")&&(e+=" INNER JOIN COM_CCCCData CCMAP with(nolock) ON CostCenterID=3 AND CCMAP.NodeID=P.ProductID ",i+=s),this.BomWHERE.length>0?(this.ShowBOMProducts=this.ProductsByBOM.Items[1].IsChecked?E.RawMaterial:this.ProductsByBOM.Items[2].IsChecked?E.FinishedProduct:E.BOM,e+=" INNER JOIN PRD_BOMProducts BP with(nolock) ON BP.ProductID=P.ProductID AND BP.ProductUse=1",this.BomWHERE.Contains(",")?i+=" AND BP.BOMID IN ("+this.BomWHERE+")":i+=" AND BP.BOMID="+this.BomWHERE,e+=" LEFT JOIN COM_UOM PU with(nolock) ON PU.UOMID=P.UOMID LEFT JOIN COM_UOM U with(nolock) ON U.UOMID=BP.UOMID",this.BOMSelect=",BP.BOMID,BP.Quantity*isnull(U.Conversion,1)/isnull(PU.Conversion,1) ConvertedQty"):this.MOWHERE.length>0?(e+=" INNER JOIN PRD_BOMProducts BP with(nolock) ON BP.ProductID=P.ProductID AND BP.ProductUse=1",e+=" INNER JOIN PRD_MFGOrderBOMs MB with(nolock) ON MB.BOMID=BP.BOMID",this.MOWHERE.Contains(",")?i+=" AND MB.MFGOrderID IN ("+this.MOWHERE+")":i+=" AND MB.MFGOrderID="+this.MOWHERE,e+=" LEFT JOIN COM_UOM PU with(nolock) ON PU.UOMID=P.UOMID LEFT JOIN COM_UOM U with(nolock) ON U.UOMID=BP.UOMID",a=",MB.MFGOrderID MOID,MB.Quantity*BP.Quantity*isnull(U.Conversion,1)/isnull(PU.Conversion,1) ConvertedQty"):this.KitWHERE.length>0&&(this.IsKitProjection?(this.ShowBOMProducts=E.None,this.dicKitProjection.Clear(),this.KitWHERE.Contains(",")?i+=" AND P.ProductID IN ("+this.KitWHERE+")":i+=" AND P.ProductID="+this.KitWHERE):(this.ShowBOMProducts=E.BOM,e+=" INNER JOIN INV_ProductBundles KP with(nolock) ON KP.ProductID=P.ProductID",this.KitWHERE.Contains(",")?i+=" AND KP.ParentProductID IN ("+this.KitWHERE+")":i+=" AND KP.ParentProductID="+this.KitWHERE,h=",KP.ParentProductID,KP.Quantity KitQty")),n.length>0&&(e+=" INNER JOIN INV_Batches B with(nolock) ON B.ProductID=P.ProductID",n.Contains(",")?i+=" AND B.BatchID IN ("+n+")":i+=" AND B.BatchID="+n),u.length>0&&(e+=d),e+=" WHERE P.IsGroup=0",e+=i,u.length>0&&(e+=u),"0"!=this.ProductStatus.SelectedValue&&(e+=" AND P.StatusID="+this.ProductStatus.SelectedValue),e+=this.ShowBOMProducts==E.BOM?this.BomWHERE.length>0?" ORDER BY BP.BOMID,P.ProductCode":this.KitWHERE.length>0?this.IsKitProjection?" ORDER BY P."+this.DefaultSortColumn:" ORDER BY KP.ParentProductID,P."+this.DefaultSortColumn:" ORDER BY P."+this.DefaultSortColumn:t?" ORDER BY Ord":" ORDER BY P."+this.DefaultSortColumn,e=e.Insert(0,t?"SELECT G.ProductID,G."+this.DefaultSortColumn+" Ord"+this.BOMSelect+a+h+" FROM INV_Product P with(nolock) join INV_Product G with(nolock) on P.ParentID=G.ProductID":"SELECT P.ProductID"+this.BOMSelect+a+h+" FROM INV_Product P with(nolock)"),this.BomWHERE.length>0?(e+=" SELECT BOMID,UOMID,FPQty,BOMName FROM PRD_BillOfMaterial BOM with(nolock) ",this.BomWHERE.Contains(",")?e+=" WHERE BOM.BOMID IN ("+this.BomWHERE+")":e+=" WHERE BOM.BOMID="+this.BomWHERE,e+=" select UOMID,UnitName,Conversion from COM_UOM with(nolock) order by BaseID,Conversion desc"):this.MOWHERE.length>0||this.KitWHERE.length>0&&(this.IsKitProjection?(e+=" SELECT KP.ParentProductID,KP.ProductID,KP.Quantity KitQty FROM INV_ProductBundles KP with(nolock)",this.KitWHERE.Contains(",")?e+=" WHERE KP.ParentProductID IN ("+this.KitWHERE+")":e+=" WHERE KP.ParentProductID="+this.KitWHERE):(e+=" SELECT KP.ParentProductID,KP.ProductID,KP.Quantity,P.ProductName KitName FROM INV_ProductBundles KP with(nolock) \n                    inner join INV_Product P with(nolock) on KP.ParentProductID=P.ProductID",this.KitWHERE.Contains(",")?e+=" WHERE KP.ParentProductID IN ("+this.KitWHERE+")":e+=" WHERE KP.ParentProductID="+this.KitWHERE));let r=0;this.dsProduct=o.a.report.DataSet("RPT022",e.toString()),this.dsProduct.Tables[0].forEach(e=>{r=parseInt(e[this.dsProduct.Columns[0][0]]),this.ShowBOMProducts!=E.BOM&&this.ProductsIDs.Contains(r)||this.ProductsIDs.push(r)})}if(0==this.ProductsIDs.length)return;if(this.dsClass=null,this.lstSaleSlots.length>0&&this.lstSaleSlots.ContainsKey("Class")&&(u.length>0||s.length>0)){let e="",t="";s.Contains("CCMAP.CCNID")&&(e+=" INNER JOIN COM_CCCCData CCMAP with(nolock) ON CostCenterID=3 AND CCMAP.NodeID=P.ProductID ",t+=s);let i=[];i.push(e),i.push(t),i.push(this.SalesDocs),i.push(parseInt(this.Slot1.Text)),i.push(parseInt(this.Slot2.Text)-parseInt(this.Slot1.Text)),i.push(parseInt(this.Slot3.Text)-parseInt(this.Slot2.Text)),i.push(o.a.SessionManager.UserID),i.push(o.a.SessionManager.LanguageID),this.dsClass=o.a.inventory.GetReOrderABC(i)}let p,S=this.GetDimensionFilter("DCC.dcCCNID",this.DataBasedOn,!0);p=this.SelectTag.Replace("@CCWHERE@",S.length>0?" INNER JOIN COM_DocCCData DCC with(nolock) ON A.InvDocDetailsID=DCC.InvDocDetailsID "+S:""),p.Contains("EF_FROMDATE")&&(p=p.Replace("EF_FROMDATE",this.FromDate.Date.ToString("dd MMM yyyy"))),p.Contains("EF_TODATE")&&(p=p.Replace("EF_TODATE",this.ToDate.Date.ToString("dd MMM yyyy"))),p.Contains("EF_ASONDATE")&&(p=p.Replace("EF_ASONDATE",this.ToDateFilter.Date.ToString("dd MMM yyyy")));let I=0;if(this.DataBasedOn.Contains("50002")){var T=this.CostCenterFilters.find(e=>50002==e.CostCenterID);T&&T.SelectedNodes.length>0&&(I=T.SelectedNodes[0].Id)}let y="";this.DontIncludePreExpiryProducts?y=this.ExpiryPickFromProduct?" and (B.ExpiryDate is null or B.ExpiryDate>=TP.PreexpiryDays)":" and (B.ExpiryDate is null or B.ExpiryDate>=convert(float,convert(datetime,'"+Date.Today().AddDays(this.PreExpiryProductDays).ToString("dd MMM yyyy")+"')))":this.DontIncludeExpiredProducts&&(y=" and (B.ExpiryDate is null or B.ExpiryDate>=convert(float,convert(datetime,'"+Date.Today().ToString("dd MMM yyyy")+"')))"),this.ObjArray=[],this.ObjArray.push(""),this.ObjArray.push(this.ToDateFilter.Visible?this.ToDateFilter.Date:null),this.ObjArray.push(t),this.ObjArray.push(this.ExpectedQTY1),this.ObjArray.push(this.ExpectedQTY2),this.ObjArray.push(this.ExpectedQTY3),this.ObjArray.push(this.CommitedQTY1),this.ObjArray.push(this.CommitedQTY2),this.ObjArray.push(this.CommitedQTY3),this.ObjArray.push(this.SalesDocs),this.ObjArray.push(this.FromDate.Date),this.ObjArray.push(this.ToDate.Date),this.ObjArray.push(parseInt(this.Slot1.Text)),this.ObjArray.push(parseInt(this.Slot2.Text)-parseInt(this.Slot1.Text)),this.ObjArray.push(parseInt(this.Slot3.Text)-parseInt(this.Slot2.Text)),this.ObjArray.push(S),this.ObjArray.push(this.ReorderDimension>0&&50002!=this.ReorderDimension?this.ReorderDimension:null!=this.DimensionFilter?this.DimensionFilter.CostCenterID:50002),this.ObjArray.push(this.SelectedLocations),this.ObjArray.push(this.SelectedAvgLocations),this.ObjArray.push(this.SelectedReOrderLocations),this.ObjArray.push(this.strHiddenFields),this.ObjArray.push(I),this.ObjArray.push(this.SalesCostColumn),this.ObjArray.push(this.SalesValueColumn),this.ObjArray.push(p),this.ObjArray.push(this.FromTag),this.ObjArray.push(y),this.ObjArray.push(this.BatchPreExpiry),this.ObjArray.push(this.ExeQty_DontShowUnApproved),this.ObjArray.push(this.PostedQtyFor),this.ObjArray.push(o.a.SessionManager.UserID),this.ObjArray.push(o.a.SessionManager.LanguageID);for(let o=0;o<this.lstSaleSlots.keys.length;o++){let e={Key:this.lstSaleSlots.keys[o],Value:this.lstSaleSlots.values[o]},t=parseInt(this.Slot1.Text);var P=this.ColumnsSource.filter(t=>t.DisplayMember.startsWith(e.Value.DisplayMember+"1"));if(!(t>0)){P.forEach(e=>{e.IsVisible=!1});continue}P.forEach(e=>{e.Header=e.BarcodeDef,e.Header+=0==e.BarcodeProp.length?"\r\n":" ",e.Header+="Yearly"==this.SalesSlotType||"Monthly"==this.SalesSlotType?this.Slot1.DependantOn:"1 - "+t,e.IsVisible=!e.Dependantinuse,e.BarcodeProp.length>0&&(e.Header+="\r\n"+e.BarcodeProp)});let i=parseInt(this.Slot2.Text);if(P=this.ColumnsSource.filter(t=>t.DisplayMember.startsWith(e.Value.DisplayMember+"2")),!(i>0)){P.forEach(e=>{e.IsVisible=!1});continue}P.forEach(e=>{e.Header=e.BarcodeDef,e.Header+=0==e.BarcodeProp.length?"\r\n":" ",e.Header+="Yearly"==this.SalesSlotType||"Monthly"==this.SalesSlotType?this.Slot2.DependantOn:t+1+"-"+i,e.IsVisible=!e.Dependantinuse,e.BarcodeProp.length>0&&(e.Header+="\r\n"+e.BarcodeProp)});let s=parseInt(this.Slot3.Text);(P=this.ColumnsSource.filter(t=>t.DisplayMember.startsWith(e.Value.DisplayMember+"3"))).forEach(s>0?e=>{e.Header=e.BarcodeDef,e.Header+=0==e.BarcodeProp.length?"\r\n":" ",e.Header+="Yearly"==this.SalesSlotType||"Monthly"==this.SalesSlotType?this.Slot3.DependantOn:i+1+"-"+s,e.IsVisible=!e.Dependantinuse,e.BarcodeProp.length>0&&(e.Header+="\r\n"+e.BarcodeProp)}:e=>{e.IsVisible=!1})}this.lstSaleSlots.length>0&&(this.ReOrderGrid.RefreshColumns(),this.ColumnsSource=this.ReOrderGrid.Columns),this.strPrevGroup=null,this.RecordCount="[Displaying 0 of "+this.ProductsIDs.length+" Rows]",this.dicFPConvertionQty=new l.a,this.BomWHERE.length>0&&this.BOMGrid.Table.forEach(e=>{if("1"!=e.UnitType.toString()){let t=this.dsProduct.Tables[1].filter(t=>t.BOMID==e.BOMID),i=parseFloat(e.Qty),s=1,o=1,r=1;if(""!=e.UOM_key.toString()){if(t[0].UOMID.toString().length>0){let e=this.dsProduct.Tables[2].filter(e=>e.UOMID==t[0].UOMID);e.length>0&&(o=parseFloat(e[0].Conversion)),o<0&&(o=1)}let l=this.dsProduct.Tables[2].filter(t=>t.UOMID==e.UOM_key);l.length>0&&(s=parseFloat(l[0].Conversion)),0==s&&(s=1),r=parseFloat(t[0].FPQty),i=parseFloat(e.Qty)*s/(r*o),this.dicFPConvertionQty.push(t[0].BOMID.toString(),i)}}}),this.ShowBOMProducts==E.BOM||this.ProductsByVoucher_Temp?(this.ReOrderGrid.CanUserSortColumns=!1,this.ReOrderGrid.TableColumns.Contains("StyleIsBold")||this.ReOrderGrid.TableColumns.push("StyleIsBold"),this.ReOrderGrid.TableColumns.Contains("VoucherNo")||this.ReOrderGrid.TableColumns.push("VoucherNo"),this.ReOrderGrid.TableColumns.Contains("GroupNo")||this.ReOrderGrid.TableColumns.push("GroupNo"),this.ReOrderGrid.TableColumns.Contains("IsGroupRow")||this.ReOrderGrid.TableColumns.push("IsGroupRow"),this.ReOrderGrid.TableColumns.Contains("ReorderDetailsID")||this.ReOrderGrid.TableColumns.push("ReorderDetailsID")):this.ReOrderGrid.CanUserSortColumns=!0,this.ReOrderGrid.fldDict.FROMDATE.setFieldValue(this.FromDate.Date),this.ReOrderGrid.fldDict.TODATE.setFieldValue(this.ToDate.Date),this.indGrpColumn=1,this.GroupNo=0;var b=this.ReOrderGrid.Columns.find(e=>e.IsVisible&&"Sno"!=e.DisplayMember&&"FLOAT"!=e.DataType&&"DATE"!=e.DataType);null!=b&&(this.indGrpColumn=this.ReOrderGrid.TableColumns.indexOf(b.DisplayMember),this.indGrpColumn<0&&(this.indGrpColumn=1)),this.iLoop=0,this.sno=0,this.LoadReorderGrid_CallBack()}LoadReorderGrid_CallBack(){{if(this.iLoop>=this.ProductsIDs.length)return void this.LoadReorderGrid_Complete();if(this.worker.CancellationPending)return void(this.worker.Cancel=!0);let e,t="",i=0,s=0,l=new Array;for(let o=this.iLoop;o<this.ProductsIDs.length&&o-this.iLoop<this.ChunkSize;o++)l.Contains(this.ProductsIDs[o])||(t.length>0&&(t+=","),t+=this.ProductsIDs[o],l.push(this.ProductsIDs[o]));this.ObjArray[0]=t.toString(),o.a.inventory.GetReOrderLevelData(this.ObjArray).then(t=>{let o,l,n,a,h,d,u,c=t,D=this.ToDate.Date.Subtract(this.FromDate.Date).Days+1;if(D<1&&(D=1),u=r.e.Int(this.SalesForeCastDays.Text),null!=this.dsClass&&(c.Columns[0].push("Class1"),c.Columns[0].push("Class2"),c.Columns[0].push("Class3"),c.Tables[0].forEach(e=>{let t=this.dsClass.Tables[0].filter(t=>t.ProductID==e.ProductID);t.length>0&&(e.Class1=t[0].Class),t=this.dsClass.Tables[1].filter(t=>t.ProductID==e.ProductID),t.length>0&&(e.Class2=t[0].Class),t=this.dsClass.Tables[2].filter(t=>t.ProductID==e.ProductID),t.length>0&&(e.Class3=t[0].Class)})),null!=this.dtPCProfile&&this.lstPCProfiles.length>0){let e;this.lstPCProfiles.keys.forEach(e=>{c.Columns[0].push(e)}),c.Tables[0].forEach(t=>{e=this.dtPCProfile.filter(e=>e.ProductID==t.ProductID),e.forEach(e=>{t["DWPCProfile_"+e.ProfileID.toString()+"_"+e.DimID.toString()]=e.Rate})})}for(let e=1;e<c.Columns[1].length;e++)c.Columns[0].push(c.Columns[1][e]);o=a=c.Tables[0],l=c.Tables[0],n=h=c.Tables[1],d=c.Columns[1];let m=this.dsProduct.Tables.length>1&&this.dsProduct.Tables[1].length>0?this.dsProduct.Tables[1]:null;for(let p=this.iLoop;p<this.ProductsIDs.length&&p-this.iLoop<this.ChunkSize;p++){if(o=a.filter(e=>e.ProductID==this.ProductsIDs[p]),0==o.length)continue;if(this.ShowBOMProducts==E.BOM&&this.BomWHERE.length>0&&this.strPrevGroup!=this.dsProduct.Tables[0][p].BOMID.toString()){r.e.IsEmpty(this.strPrevGroup)||this.AddSubTotal(this.indGrpColumn,m[0].BOMName.toString(),this.GroupNo),this.sno=0,this.strPrevGroup=this.dsProduct.Tables[0][p].BOMID.toString();let e=this.ReOrderGrid.NewRow();m=this.dsProduct.Tables[1].filter(e=>e.BOMID==this.strPrevGroup),e[this.ReOrderGrid.TableColumns[this.indGrpColumn]]=m[0].BOMName.toString(),e.StyleIsBold=1,e.GroupNo=++this.GroupNo,e.IsGroupRow=!0,this.ReOrderGrid.addRow(e)}else if(this.ShowBOMProducts==E.BOM&&this.KitWHERE.length>0&&this.strPrevGroup!=this.dsProduct.Tables[0][p].ParentProductID.toString()){this.sno=0,this.strPrevGroup=this.dsProduct.Tables[0][p].ParentProductID.toString();let e=this.ReOrderGrid.NewRow();m=this.dsProduct.Tables[1].filter(e=>e.ParentProductID==this.strPrevGroup),e[this.ReOrderGrid.TableColumns[this.indGrpColumn]]=m[0].KitName.toString(),e.StyleIsBold=1,e.GroupNo=++this.GroupNo,e.IsGroupRow=!0,this.ReOrderGrid.addRow(e)}else if(this.ProductsByVoucher_Temp&&this.strPrevGroup!=this.dsProduct.Tables[0][p].VoucherNo.toString()){this.sno=0,this.strPrevGroup=this.dsProduct.Tables[0][p].VoucherNo.toString();let e=this.ReOrderGrid.NewRow();e[this.ReOrderGrid.TableColumns[this.indGrpColumn]]=this.strPrevGroup,e.StyleIsBold=1,e.GroupNo=++this.GroupNo,e.IsGroupRow=!0,this.ReOrderGrid.addRow(e)}for(let e=0;e<this.totalSELECTED.length;e++)this.totalSELECTED[this.totalSELECTED.keys[e]]=0;let t=this.ReOrderGrid.NewRow();if(c.Columns[0].forEach(e=>{this.ReOrderGrid.TableColumns.Contains(e)&&(t[e]=o[0][e])}),t.ProductName_Key=o[0].ProductID,null!=this.dsProduct&&(this.BOMSelect.length>0||this.ShowBOMProducts==E.FinishedProduct)){let e=0;if(this.ShowBOMProducts==E.BOM)if(this.dicFPConvertionQty.ContainsKey(this.strPrevGroup))e+=this.dicFPConvertionQty[this.strPrevGroup]*parseFloat(this.dsProduct.Tables[0][p].ConvertedQty);else{let t=this.BOMGrid.Table.filter(e=>e.BOMID==this.strPrevGroup);e+=parseFloat(t[0].Qty)*parseFloat(this.dsProduct.Tables[0][p].ConvertedQty)}else this.ShowBOMProducts==E.FinishedProduct?this.dicFPQty.ContainsKey(this.ProductsIDs[p])&&(e=this.dicFPQty[this.ProductsIDs[p]]):this.dsProduct.Tables[0].filter(e=>e.ProductID==o[0].ProductID).forEach(t=>{if(this.dicFPConvertionQty.ContainsKey(t.BOMID.toString()))e+=this.dicFPConvertionQty[t.BOMID.toString()]*parseFloat(t.ConvertedQty);else{let i=this.BOMGrid.Table.filter(e=>e.BOMID==t.BOMID);e+=parseFloat(i[0].Qty)*parseFloat(t.ConvertedQty)}});t.RequiredQty=e}else if(null!=this.dsProduct&&this.MOWHERE.length>0){let e=0;this.dsProduct.Tables[0].filter(e=>e.ProductID==o[0].ProductID).forEach(t=>{let i=this.MOGrid.Table.filter(e=>e.MOID==t.MOID);e+=parseFloat(i[0].Qty)*parseFloat(t.ConvertedQty)}),t.RequiredQty=e}else if(null!=this.dsProduct&&this.KitWHERE.length>0)if(this.IsKitProjection);else{let e=0;if(this.ShowBOMProducts==E.BOM){let t=this.KitGrid.Table.filter(e=>e.KitID==this.strPrevGroup);e+=parseFloat(t[0].Qty)*parseFloat(this.dsProduct.Tables[0][p].KitQty)}else this.dsProduct.Tables[0].filter(e=>e.ProductID==o[0].ProductID).forEach(t=>{let i=this.KitGrid.Table.filter(e=>e.KitID==t.ParentProductID);e+=parseFloat(i[0].Qty)*parseFloat(t.KitQty)});t.RequiredQty=e}if(o.forEach(i=>{e=i.TAGID.toString(),this.LocationCols.ContainsKey(e)?this.LocationCols[e].forEach(o=>{t[o+"_"+e]=i[o],this.totalSELECTED.ContainsKey(o)&&(s=r.e.Double(i[o]),this.totalSELECTED[o]+=s)}):"-1"==e&&this.totalALL.keys.forEach(e=>{t[e+"_ALL"]=i[e]})}),this.totalSELECTED.keys.forEach(e=>{t[e+"_SELECTED"]=this.totalSELECTED[e]}),this.totalALL.keys.forEach(e=>{t[e]=this.totalALL[e]}),this.Vendor.Visible)if(0==this.VendorWHERE.length&&c.Tables[2].length>0&&parseInt(c.Tables[2][0].VendorID)>0)this.Vendor.SelectedValue=parseInt(c.Tables[2][0].VendorID),t.Vendor=c.Tables[2][0].VendorName,this.VendorWHERE="1=1";else{let e=c.Tables[2].filter(e=>e.VendorID==this.Vendor.SelectedValue);e>0&&(t.Vendor=e[0].VendorName)}else{let e=c.Tables[2].filter(e=>e.ProductID==this.ProductsIDs[p]);e.length>0?(t.Vendor=e[0].VendorName,t.Vendor_Key=e[0].VendorID):t.Vendor_Key=0}if(n=h.filter(e=>e.ProductID==this.ProductsIDs[p]),n.length>0)for(let e=1;e<d.length;e++)try{t[d[e]]=n[0][d[e]]}catch(C){}if(this.ReportSelectedNodes.length>0)if(this.ProductsByVoucher_Temp){t.VoucherNo=this.dsProduct.Tables[0][p].VoucherNo,t.ReorderDetailsID=this.dsProduct.Tables[0][p].ReorderDetailsID;let e=this.ReportSelectedNodes[p].Tree;if(null!=e)for(let i=0;i<e.length;i++){let s=e[i];if(null!=s.value){if(!this.ReOrderGrid.TableColumns.Contains(s.ROColID)){Logger.ErrorLog("Reorder Column not found: "+s.ROColID);continue}s.IsDimension?(t[s.ROColID]=s.value,this.ReOrderGrid.TableColumns.Contains(s.ROColID+"_ID")?t[s.ROColID+"_ID"]=s.DimensionID:this.ReOrderGrid.TableColumns.Contains("Vendor_Key")&&"Vendor"==s.ROColID&&(t.Vendor_Key=s.DimensionID)):"FLOAT"==s.Type||"INT"==s.Type?r.e.IsNum(s.value)&&(t[s.ROColID]=r.e.Double(s.value)):"DATE"==s.Type?r.e.isValidDate(s.value)&&(t[s.ROColID]=new Date(s.value)):t[s.ROColID]=s.value}}}else this.ReportSelectedNodes.filter(e=>e.Id==this.ProductsIDs[p]).forEach(e=>{let i=e.Tree;if(null!=i)for(let o=0;o<i.length;o++){let e=i[o];if(null!=e.value){if(!this.ReOrderGrid.TableColumns.Contains(e.ROColID)){Logger.ErrorLog("Reorder Column not found: "+e.ROColID);continue}e.IsDimension?(t[e.ROColID]=e.value,this.ReOrderGrid.TableColumns.Contains(e.ROColID+"_ID")&&(t[e.ROColID+"_ID"]=e.DimensionID)):"FLOAT"==e.Type||"INT"==e.Type?r.e.IsNum(e.value)&&(s=r.e.Double(e.value),t[e.ROColID]=null==t[e.ROColID]?s:parseFloat(t[e.ROColID])+s):"DATE"==e.Type?r.e.isValidDate(e.value)&&(t[e.ROColID]=new Date(e.value)):t[e.ROColID]=null==t[e.ROColID]?e.value:t[e.ROColID].toString()+","+e.value.toString()}}});t.Sno=++this.sno,this.ReOrderGrid.TableColumns.Contains("GroupNo")&&(t.GroupNo=this.GroupNo),this.ReOrderGrid.addRow(t),this.ReOrderGrid.EvaluateFormulas(t,!0)?this.ReOrderGrid.removeRow(t):(i=r.e.Double(t.Variance),i<0&&(t.Variance_RED="1")),this.IsKitProjection&&this.KitWHERE.length>0&&(i=this.CalculateKitProjection(this.ObjArray,this.ProductsIDs[p],this.dsProduct),t.Variance=i,t.Variance_RED="0"),p==this.ProductsIDs.length-1&&this.ShowBOMProducts==E.BOM&&this.BomWHERE.length>0&&this.AddSubTotal(this.indGrpColumn,m[0].BOMName.toString(),this.GroupNo)}this.RecordCount="[Displaying "+(this.iLoop+this.ChunkSize)+" of "+this.ProductsIDs.length+" Rows]",this.iLoop+=this.ChunkSize,this.ReOrderGrid.refreshDataView(),this.LoadReorderGrid_CallBack()})}}LoadReorderGrid_Complete(){this.IsKitProjection&&this.KitWHERE.length>0&&this.CheckDuplicateKitProducts(),this.RecordCount="",this.worker_RunWorkerCompleted(null,null)}AddSubTotal(e,t,i){let s=this.ReOrderGrid.NewRow();s[this.ReOrderGrid.TableColumns[e]]=" Total :: "+t,s.StyleIsBold=1,s.GroupNo=i,s.IsGroupRow=!0;for(let o=1;o<this.ReOrderGrid.Columns.length;o++)this.ReOrderGrid.Columns[o].ShowTotal&&this.ReOrderGrid.TableColumns.Contains(this.ReOrderGrid.Columns[o].DisplayMember)&&(s[this.ReOrderGrid.Columns[o].DisplayMember]=this.ReOrderGrid.Table.filter(e=>e.GroupNo==i).Compute("sum",this.ReOrderGrid.Columns[o].DisplayMember));this.ReOrderGrid.addRow(s)}RefreshReOrderGridColumns(){let e=new Array;this.ReOrderGrid.Columns.forEach(t=>{e.push(t)}),this.ReOrderGrid.Columns=e}CalculateKitProjection(e,t,i){let s=0,l="",n=i.Tables[1].filter(e=>e.ParentProductID==t);if(n.forEach(e=>{l.length>0&&(l+=","),l+=e.ProductID}),l.length>0){let t,i=0,a=0;e[0]=l;let h,d=o.a.inventory.GetReOrderLevelData(e);d.Columns[0].push("RequiredQty");let u=d.Tables[0];for(let e=0;e<n.length;e++){let o=n[e];if(h=u.filter(e=>e.ProductID==o.ProductID),0==h.length)continue;for(let e=0;e<this.totalSELECTED.length;e++)this.totalSELECTED[this.totalSELECTED.keys[e]]=0;let l=this.ReOrderGrid.NewRow();d.Columns[0].forEach(e=>{this.ReOrderGrid.TableColumns.Contains(e)&&(l[e]=h[0][e])}),l.ProductName_Key=h[0].ProductID,h.forEach(e=>{t=e.TAGID.toString(),this.LocationCols.ContainsKey(t)?this.LocationCols[t].forEach(i=>{l[i+"_"+t]=e[i],this.totalSELECTED.ContainsKey(i)&&(a=r.e.Double(e[i]),this.totalSELECTED[i]+=a)}):"-1"==t&&this.totalALL.keys.forEach(t=>{l[t+"_ALL"]=e[t]})}),this.totalSELECTED.keys.forEach(e=>{l[e+"_SELECTED"]=this.totalSELECTED[e]}),this.totalALL.keys.forEach(e=>{l[e]=this.totalALL[e]}),this.ReOrderGrid.EvaluateFormulas(l,!0),i=r.e.Double(l.Variance);let c=parseFloat(o.KitQty);if(i<c){s=0;break}{let e=Math.floor(i/c);(0==s||s>e)&&(s=e)}}}return s>0&&n.forEach(e=>{let i=parseInt(e.ProductID);this.dicKitProjection.ContainsKey(i)||this.dicKitProjection.push(i,new Array),this.dicKitProjection[i].push(t)}),s}CheckDuplicateKitProducts(){let e=0;this.ReOrderGrid.Table.forEach(t=>{if(e=r.e.Double(t.Variance),e>0)for(let e=0;e<this.dicKitProjection.keys.length;e++){let i=this.dicKitProjection[e];if(i.Contains(parseInt(t.ProductName_Key))&&i.length>1){t.Variance_RED="1";break}}})}LoadTreeData(e){this.tree=new Array;let t=r.f.SelectSingleNode(e,"TreeFilter"),i=0;if("True"==o.a.SessionManager.Preferences.EnableLocationWise.toString()&&"True"==o.a.SessionManager.Preferences["LW Reports"]?i=50002:o.a.SessionManager.Preferences.ContainsKey("Maintain Dimensionwise stock")&&(i=r.e.Int(o.a.SessionManager.Preferences["Maintain Dimensionwise stock"])),50001==i){var s=this.CostCenters.Items.find(e=>"50001"==e.Value);null!=s&&(s.Aliasname="");let i=!1;if(r.f.SelectNodes(e,"TreeFilter/FilterDef").forEach(e=>{"50001"==r.f.SelectSingleNode(e,"CCID").innerHTML&&(i=!0)}),!i){let e=0==r.f.SelectNodes(t,"FilterDef").length?"1":"0";e="<CCID>50001</CCID><GridViewID>0</GridViewID><IsDefaultCC>"+e+"</IsDefaultCC><DefaultValues>"+o.a.SessionManager.DivisionID+"</DefaultValues>",e="<FilterDef>"+e+"</FilterDef>",r.f.AppendChild(t,e)}}if(50002==i){var l=this.CostCenters.Items.find(e=>"50002"==e.Value);null!=l&&(l.Aliasname="");let i=null,s=r.f.SelectNodes(e,"TreeFilter/FilterDef");for(let e=0;e<s.length;e++){let t=s[e];if("50002"==r.f.SelectSingleNodeText(t,"CCID")){i=t;break}}let n=r.f.SelectSingleNode(this.xDocPref.DocumentElement,"SelectAllLocations"),a=null!=n&&"1"==n.innerHTML;if(null==i){let e=0==r.f.SelectNodes(t,"FilterDef").length?"1":"0";e=a||0==o.a.SessionManager.LocationID?"<CCID>50002</CCID><GridViewID>0</GridViewID><IsDefaultCC>"+e+"</IsDefaultCC><DefaultValues>"+o.a.SessionManager.LocationWhere+"</DefaultValues>":"<CCID>50002</CCID><GridViewID>0</GridViewID><IsDefaultCC>"+e+"</IsDefaultCC><DefaultValues>"+o.a.SessionManager.LocationID+"</DefaultValues>",e="<FilterDef>"+e+"</FilterDef>",r.f.AppendChild(t,e)}else{let e=r.f.SelectSingleNode(i,"DefaultValues");if(null!=e)if(a)e.innerHTML=o.a.SessionManager.LocationWhere;else if(0==e.innerHTML.length)e.innerHTML=0!=o.a.SessionManager.LocationID?o.a.SessionManager.LocationID.toString():o.a.SessionManager.LocationWhere;else{let t=e.innerHTML.split(","),i=o.a.SessionManager.LocationWhere.split(","),s="";t.forEach(e=>{i.Contains(e)&&(s.length>0&&(s+=","),s+=e)}),e.innerHTML=s}}}if("1"!=o.a.SessionManager.UserID&&"1"!=o.a.SessionManager.RoleID&&null!=this.CostCenters){let i=o.a.SessionManager.Preferences.ContainsKey("Dimension List")?o.a.SessionManager.Preferences["Dimension List"].split(","):[],s=this.CostCenters.Items.filter(e=>"1"==e.Aliasname);for(let l=0;l<s.length;l++){let n=s[l],a="";if(i.Contains(n.Value)){let e=o.a.report.IsGroupNode(parseInt(n.Value),0);o.a.report.DataSet("RPT017",e.TableName,n.Value,o.a.SessionManager.UserID).Tables[0].forEach(e=>{a.length>0&&(a+=","),a+=e.NodeID.toString()})}let h=null,d=r.f.SelectNodes(e,"TreeFilter/FilterDef");for(let e=0;e<d.length;e++){let t=d[e];if(r.f.SelectSingleNodeText(t,"CCID")==n.Value){h=t;break}}if(null==h){let e;e=0==r.f.SelectNodes(t,"FilterDef").length?"<CCID>"+n.Value+"</CCID><GridViewID>0</GridViewID><IsDefaultCC>1</IsDefaultCC><DefaultValues>"+a+"</DefaultValues>":"<CCID>"+n.Value+"</CCID><GridViewID>0</GridViewID><IsDefaultCC>0</IsDefaultCC><DefaultValues>"+a+"</DefaultValues>",e="<FilterDef>"+e+"</FilterDef>",r.f.AppendChild(t,e)}else{let e=h.SelectSingleNode("DefaultValues");null!=e&&0==e.innerHTML.length&&(e.innerHTML=a)}}}let n,a=0,h=0,d=!1,c=r.f.SelectNodes(e,"TreeFilter/FilterDef/IsDefaultCC");if(c.length>0){for(let e=0;e<c.length;e++)if("1"==c[e].innerHTML){d=!0;break}d||(c[0].innerHTML="1")}let D=r.f.SelectNodes(e,"TreeFilter/FilterDef");for(let o=0;o<D.length;o++){let e=D[o],t=r.f.SelectSingleNode(e,"CCID").innerHTML,i=this.CostCenters.Items.find(e=>e.Value==t);if(null==i)continue;if(n="44"!=t&&"50"!=t||null==r.f.SelectSingleNode(e,"LookupTypeID")?0:parseInt(r.f.SelectSingleNode(e,"LookupTypeID").innerHTML),("44"==i.Value||"50"==i.Value)&&i.Parent!=n.toString())continue;let s=new u.a(parseInt(t),n.toString(),i.Name,this);s.SetSelectedNodes(e),"1"==r.f.SelectSingleNode(e,"IsDefaultCC").innerHTML&&(i.CurrID=1,h=parseInt(t),a=null!=r.f.SelectSingleNode(e,"GridViewID")?parseInt(r.f.SelectSingleNode(e,"GridViewID").innerHTML):0),"1"==r.f.SelectSingleNode(e,"IsDefaultCC").innerHTML&&(this.CostCenters.SelectedValue=t,this.CostCenters.SelectedItem=i,this.OnCostCenterChange(null)),"1"==i.Aliasname&&(s.DeleteButtonVisibility=!1),this.CostCenterFilters.push(s)}}OnButtonClick(e){if(this.DisplayMessage="","Regenerate"==e)this.GridVisibility=!1,this.FilterVisibility=!0;else if("PostFilters"==e)this.ShowPostFilter=!0,this.BOMGrid.refreshUI(),this.BOMGrid.refreshDataView();else if("PostFilterOK"==e||"PostFilterClear"==e)null!=this.PostDataFetchFilterFields&&this.FilterorClear(e);else if("PostFilterCancel"==e)this.ShowPostFilter=!1;else if("NEXT"==e)this.LoadNextDocument("NEXT");else if("CLOSE"==e)this.DocumentVisibility=!1,this.GridVisibility=!0;else if("Post"==e)this.PostDocuments();else if("PostClose"==e)if(this.postworkerIsBusy){if(confirm("Do you want to cancel posting?"))return this.postworkerCancel=!0,void(this.AutoPostMessage="")}else this.ShowAutoPost=!1,this.AutoPostMessage="";else if("FilterOK"==e){let e=0,i=0,r=0;try{e=parseInt(this.Slot1.Text)}catch(s){return void(this.DisplayMessage="Enter Valid Number")}try{i=parseInt(this.Slot2.Text)}catch(l){return void(this.DisplayMessage="Enter Valid Number")}try{r=parseInt(this.Slot3.Text)}catch(n){return void(this.DisplayMessage="Enter Valid Number")}if(e>=i||i>=r)return void(this.DisplayMessage="Enter Valid Slot Numbers");if(this.DisplayMessage="",this.FilterVisibility=!1,this.GridVisibility=!0,null!=this.DWPCProfile){this.dtPCProfile=null,this.lstPCProfiles.Clear();let e=!1,i="",s=new Array;var t=this.CostCenterFilters.find(e=>40==e.CostCenterID&&null!=e.SelectedNodes&&e.SelectedNodes.length>0);null!=t&&t.SelectedNodes.filter(e=>0==e.IsGroup).forEach(e=>{s.Contains(e.Id)||(s.push(e.Id),i.length>0&&(i+=","),i+=e.Id.toString())});for(let t=this.ColumnsSource.length-1;t>=0;t--){let i=this.ColumnsSource[t];null!=i.DisplayMember&&i.DisplayMember.startsWith("DWPCProfile")&&(e=!0,this.ReOrderGrid.TableColumns.Contains(i.DisplayMember)&&this.ReOrderGrid.TableColumns.Remove(i.DisplayMember),this.ColumnsSource.Remove(i))}if(i.length>0){e=!0;let t=[];t.push(i),t.push(o.a.SessionManager.UserID),t.push(o.a.SessionManager.LanguageID),this.dtPCProfile.SortBy(["ProfileName","Dimension"]);let s=null;this.dtPCProfile.ToTable(!0,["ProfileID","DimID","ProfileName","Dimension"]).forEach(e=>{var t=this.DWPCProfile.Clone();e.ProfileID.toString()!=s?(s=e.ProfileID.toString(),t.Header=e.ProfileName.toString()+"\r\n"+e.Dimension.toString()):t.Header=e.Dimension.toString(),t.DisplayMember="DWPCProfile_"+e.ProfileID.toString()+"_"+e.DimID.toString(),null==this.ColumnsSource.find(e=>e.DisplayMember==t.DisplayMember)&&(this.lstPCProfiles.push(t.DisplayMember,"ProfileID="+e.ProfileID.toString()+" and DimID="+e.DimID.toString()),this.ReOrderGrid.TableColumns.push(t.DisplayMember),this.ColumnsSource.push(t))})}e&&(this.ReOrderGrid.RefreshColumns(),this.ColumnsSource=this.ReOrderGrid.Columns)}this.ReOrderGrid.Table.Clear(),this.worker.IsBusy=!0,this.worker_DoWork(null,null)}else if("FilterCancel"==e)null!=this.ReOrderGrid.Table?(this.FilterVisibility=!1,this.GridVisibility=!0):o.a.page.removeTab(this);else if("Export"==e){let e;this.ReOrderGrid.ExportExcelNew(0,this.Title,this.DateFilter,e),e.length>0&&(this.DisplayMessage=e)}else if("Save"==e){let e;if(this.DialogAction="Save",e.IsOkClick){Logger.GetLogFilePath(),(new Date).ToString("_yyyyMMdd_HHmmss");let t={Tables:[]};t.Tables.push(this.ReOrderGrid.Table.Copy()),null!=this.BOMGrid.Table&&t.Tables.push(this.BOMGrid.Table.Copy());let i="";i+="<AttachmentsXML><Row ",r.e.IsEmpty(e.List.SelectedValue)?(i+=' Action="NEW"',i+=' AttachmentID="0"'):(i+=' Action="MODIFY"',i+=' AttachmentID="'+e.List.SelectedValue+'"'),o.a.report.GetReportData(5,this.ReportID,i.toString()),this.ProfileName=e.Name.Text,this.RefreshDateFilter()}}else if("Open"==e)try{let e;if(this.DialogAction="Open",e.IsOkClick){let t,s=new r.f;if(s.ReadXml(t),this.ReOrderGrid.Table=s.Tables[0],this.ReportData=this.ReOrderGrid.Table,this.ProfileName=e.Name.Text,this.RefreshDateFilter(),s.Tables.Contains("BOM")){if(this.BOMGrid.Table=s.Tables.BOM,this.BOMGrid.Table.length>0){this.BOMGrid.Visible=!0;var i=this.CostCenterFilters.find(e=>76==e.CostCenterID);null==i&&((i=new u.a(76,"","Bill Of Material",this)).SelectedNodes=new Array,this.CostCenterFilters.push(i)),this.BOMGrid.Table.forEach(e=>{if(null!=e.BOMID){let t=new c.a;t.Id=parseInt(e.BOMID),i.SelectedNodes.push(t)}}),i.SelectedNodesTag="[FILTER]"}}else null!=this.BOMGrid.Table&&this.BOMGrid.Clear()}}catch(a){Logger.ErrorLog("Open File Error:",a)}}OnCostCenterChange(e){return Object(s.b)(this,void 0,void 0,(function*(){if(!r.e.IsEmpty(this.CostCenters.SelectedValue))if(null!=this.CostCenters.SelectedItem&&50==parseInt(this.CostCenters.SelectedValue)){if(this.ReportWidth="480",this.ReportHeight="430",0==this.Report.length||this.Report[0].ReportID!=parseInt(this.CostCenters.SelectedItem.Parent)){this.ReportLoaded=!1;const{ReportViewModel:e}=yield Promise.all([i.e(2),i.e(1),i.e(3),i.e(5),i.e(4),i.e(6),i.e(7),i.e(10),i.e(9),i.e(8),i.e(12),i.e(11),i.e(13),i.e(19),i.e(15),i.e(21),i.e(20),i.e(16),i.e(14),i.e(18),i.e(17),i.e(22),i.e(23),i.e(24),i.e(25),i.e(28),i.e(30),i.e(29),i.e(32),i.e(31),i.e(27),i.e(26),i.e(35),i.e(37),i.e(38),i.e(36),i.e(33),i.e(34),i.e(39),i.e(40),i.e(41),i.e(212)]).then(i.bind(null,"ThYU"));let t=new e;t.ReportViewModel_Document(112,"<XML></XML>",parseInt(this.CostCenters.SelectedItem.Parent),!1,null,null),t.ShowHeaderButtons=!1,t.ShowRightPanel=!1,t.SearchVisibility=!1,t.PrefetchReportTreeFilter=this,t.PrefetchReportTreeFilter.PrefetchReportType=112,this.Report.Clear(),this.Report.push(t)}this.TreeVisibility=!1}else{if(0==this.tree.length||this.tree[0].CostCenterID!=parseInt(this.CostCenters.SelectedValue)){let e=0;null==this.CostCenters.SelectedItem||r.e.IsEmpty(this.CostCenters.SelectedItem.Parent)||(e=r.e.Int(this.CostCenters.SelectedItem.Parent)),this.LoadCostCenterTree(parseInt(this.CostCenters.SelectedValue),e,0,null)}this.TreeVisibility=!0}}))}OnDocCallBack(){if(null!=this.Document&&this.Document.DialogResult){if(null==this.AutoPostGrid){this.AutoPostGrid=new C.a,this.AutoPostGrid.Width="",this.AutoPostGrid.Table=[],this.AutoPostGrid.TableColumns.push("Sno"),this.AutoPostGrid.TableColumns.push("DocNo"),this.AutoPostGrid.TableColumns.push("ErrorMessage");let e=new Array,t=new D.a;t.Header="#",t.DisplayMember="Sno",t.Width=35,t.ReadOnly=!0,e.push(t),t=new D.a,t.Header="Voucher No",t.DisplayMember="DocNo",t.DataType="LINK_VOUCHER",t.Width=130,t.ReadOnly=!0,e.push(t),t=new D.a,t.Header="Error Message",t.DisplayMember="ErrorMessage",t.Width=350,t.ReadOnly=!0,e.push(t),this.AutoPostGrid.Columns=e}this.AutoPostGrid.Clear();for(let e=0;e<100;e++)this.AutoPostGrid.addEmptyRow();this.AutoPostMessage="Posting Documents... Please wait.",this.ShowAutoPost=!0,this.postworker_DoWork("",{})}}LoadCostCenterTree(e,t,i,s){this.tree.Clear();let l,n="";if(50002==e&&"1"!=o.a.SessionManager.RoleID&&"True"==o.a.SessionManager.Preferences.EnableLocationWise.toString()&&"True"==o.a.SessionManager.Preferences["LW Reports"]&&(n=r.e.IsEmpty(o.a.SessionManager.LocationWhere)?"A.NodeID IN (-1234)":"A.NodeID IN ("+o.a.SessionManager.LocationWhere+")"),null==s)for(let o=0;o<this.CostCenterFilters.length;o++){let i=this.CostCenterFilters[o];if(i.CostCenterID==e&&i.LookupTypeID==t){s=i.SelectedNodes;break}}44==e&&t>0&&(n="A.LookupType="+t);let a="";r.f.SelectNodes(this.xDocPref.DocumentElement,"GridViewFilter").forEach(t=>{t.attributes.CCID.value==e&&(a+=t.attributes.GID.value+",")}),l=new T.a,null==s?l.TreeViewModel_5(e,this,i,n,a):l.TreeViewModel_6(e,this,i,n,s,a),l.LookupTypeID=t,l.HeaderVisiblity=!1,l.OnNodeSelected||(l.OnNodeSelected=new h.b,l.OnNodeSelected.Subscribe(this,"OnNodeSelected"),this.NodeSelectedCallBack=new h.b,this.NodeSelectedCallBack.Subscribe(this,"OnNodeSelectedCallBack")),this.tree.push(l)}OnNodeSelectedCallBack(){if(76==this.tree[0].CostCenterID)this.tree[0].SelectedNodes.length>0?(this.BOMGrid.Visible=!0,this.BOMGrid.Clear(),this.tree[0].SelectedNodes.forEach(e=>{let t={};t.BOMID=e.Id,t.BOM=e.Text.length>0?e.Text[0]:"BOM";let i=this.BOMGrid.Table.filter(t=>t.BOMID==e.Id);i.length>0?(t.Qty=i[0].Qty,t.UnitType=i[0].UnitType,t.UOM=i[0].UOM,t.UOM_Key=i[0].UOM_Key):(t.Qty=1,t.UnitType="1"),this.BOMGrid.addRow(t)}),null!=(e=this.CostCenterFilters.find(e=>76==e.CostCenterID))&&(e.IsVisible=!1)):(this.BOMGrid.Visible=!1,null!=(e=this.CostCenterFilters.find(e=>76==e.CostCenterID))&&(e.IsVisible=!1));else if(-102==this.tree[0].CostCenterID)if(this.tree[0].SelectedNodes.length>0){if(null==this.KitGrid.Table){this.KitGrid.Table=[],this.KitGrid.TableColumns.push("KitID"),this.KitGrid.TableColumns.push("Kit"),this.KitGrid.TableColumns.push("Qty");let e=new Array,t=new D.a;t.Header="Kit",t.DisplayMember="Kit",t.Width=160,t.ReadOnly=!0,e.push(t),t=new D.a,t.Header="Qty",t.DisplayMember="Qty",t.DataType="FLOAT",t.Width=70,t.IsCalculated=1,t.DisableTab=!0,t.DecimalPoints=o.a.SessionManager.Preferences.DecimalsinQty,e.push(t),this.KitGrid.Columns=e}this.KitGrid.Visible=!0,this.KitGrid.Clear(),this.tree[0].SelectedNodes.forEach(e=>{if(!e.IsGroup){let t={};t.KitID=e.Id,t.Kit=e.Text.length>0?e.Text[0]:"Kit";let i=this.KitGrid.Table.filter(t=>t.KitID==e.Id);t.Qty=i.length>0?i[0].Qty:1,this.KitGrid.addRow(t)}}),null!=(e=this.CostCenterFilters.find(e=>-102==e.CostCenterID))&&(e.IsVisible=!1)}else this.KitGrid.Visible=!1,null!=(e=this.CostCenterFilters.find(e=>-102==e.CostCenterID))&&(e.IsVisible=!1);else if(78==this.tree[0].CostCenterID)if(this.tree[0].SelectedNodes.length>0){if(null==this.MOGrid.Table){this.MOGrid.Table=[],this.MOGrid.TableColumns.push("MOID"),this.MOGrid.TableColumns.push("MO"),this.MOGrid.TableColumns.push("Qty");let e=new Array,t=new D.a;t.Header="MO",t.DisplayMember="MO",t.Width=140,t.ReadOnly=!0,e.push(t),t=new D.a,t.Header="Qty",t.DisplayMember="Qty",t.DataType="FLOAT",t.Width=90,t.IsCalculated=1,t.DisableTab=!0,t.DecimalPoints=o.a.SessionManager.Preferences.DecimalsinQty,e.push(t),this.MOGrid.Columns=e}this.MOGrid.Visible=!0,this.MOGrid.Clear(),this.tree[0].SelectedNodes.forEach(e=>{if(!e.IsGroup){let t={};t.MOID=e.Id,t.MO=e.Text.length>0?e.Text[0]:"MO";let i=this.MOGrid.Table.filter(t=>t.MOID==e.Id);t.Qty=i.length>0?i[0].Qty:1,this.MOGrid.addRow(t)}}),null!=(e=this.CostCenterFilters.find(e=>78==e.CostCenterID))&&(e.IsVisible=!1)}else{var e;this.MOGrid.Visible=!1,null!=(e=this.CostCenterFilters.find(e=>78==e.CostCenterID))&&(e.IsVisible=!1)}}postworker_DoWork(e,t){this.indPostIndex=0,this.ShowAutoPost=!0,this.postworkerCancel=!1,this.postworkerIsBusy=!0,this.LoadNextDocument("FIRST")}postworker_Completed(){this.postworkerIsBusy=!1;let e=this.AutoPostGrid.Table.filter(e=>!Object(P.isNullOrUndefined)(e.DocNo)),t=this.AutoPostGrid.Table.filter(e=>!Object(P.isNullOrUndefined)(e.Errormessage));0==e.length&&0==t.length?this.AutoPostMessage="No Data Found to Post":e.length>0&&t.length>0?this.AutoPostMessage="Partially Posted":0==e.length&&t.length>0?this.AutoPostMessage="Error in Posting":e.length>0&&0==t.length&&(this.AutoPostMessage="Posting Completed")}PostDocuments(){if(this.iVendorCount=0,this.lstVendors.Clear(),this.lstPostDocsGroup.Clear(),this.dtVoucherDetails=null,this.Document=null,this.Vendor.Visible)if(this.PostDocsGroupBy.length>0){let e=this.PostDocsGroupBy.split(",");this.ReOrderGrid.Table.ToTable(!0,e).forEach(t=>{let i;this.lstVendors.push(this.Vendor.SelectedValue.toString());for(let s=0;s<e.length;s++)i=i.filter(null==t[e[s]]?t=>null==t[e[s]]:i=>i[e[s]]==t[e[s]]);i=i(e=>e.OrderQty>0),this.lstPostDocsGroup.push(i)})}else this.lstVendors.push(this.Vendor.SelectedValue.toString());else{let e=["Vendor_Key"];this.PostDocsGroupBy.length>0&&e.AddRange(this.PostDocsGroupBy.split(",")),this.ReOrderGrid.Table.ToTable(!0,e).forEach(t=>{this.lstVendors.push(r.e.StringValue(t.Vendor_Key));let i=this.ReOrderGrid.Table;for(let s=0;s<e.length;s++)i=i.filter(null==t[e[s]]?t=>null==t[e[s]]:i=>i[e[s]]==t[e[s]]);i=i.filter(e=>e.OrderQty>0),this.lstPostDocsGroup.push(i)})}this.lstVendors.length>0&&(this.dvItems=this.ReOrderGrid.Table,R.RibbonExtViewModel.GetDocumentObject(parseInt(this.Documents.SelectedValue),this.Documents.SelectedItem.Name,!1).then(e=>{this.Document=e,this.Document.GenratePrefix=!0,this.Document.SaveCallBack=new h.b,this.Document.SaveCallBack.Subscribe(this,"OnSaveCallBack"),this.Document.SaveCallBackMethod.Subscribe(this,"SaveCallBack_Complete"),this.Document.DialogResult?this.OnDocNumberDelegate():this.Document.DocNumberDelegate.Subscribe(this,"OnDocNumberDelegate")}))}OnDocNumberDelegate(){if(this.DocumentNumber=this.Document.DocumentNumber,this.IsAutoPost?(this.DocDefaultCCFields.Clear(),this.Document.ScreenObject._CCFields.filter(e=>e instanceof d.b).forEach(e=>{let t=e;t.CCID>5e4&&!this.DocDefaultCCFields.ContainsKey(t.CCID)&&this.DocDefaultCCFields.push(t.CCID,t.SelectedValue)})):(this.GridVisibility=!1,this.DocumentVisibility=!0),this.DocumentLinkDimensions.Clear(),this.strDimensionLinkQry="",this.Document.ScreenObject.Preferences.ContainsKey("DimensionWise")&&""!=this.Document.ScreenObject.Preferences.DimensionWise){let e=0;this.Document.ScreenObject.Preferences.DimensionWise.split(",").forEach(t=>{if(e=r.e.Int(t),e>0&&e>5e4){this.strDimensionLinkQry+=",DCC.dcCCNID"+(e-5e4);var i=this.Document.ScreenObject._CCFields.find(t=>t instanceof d.b&&t.CCID==e);i&&this.DocumentLinkDimensions.push(i)}})}this.IsAutoPost?this.OnDocCallBack():this.LoadNextDocument("FIRST")}LoadNextDocument(e){if(this.iVendorCount>=this.lstVendors.length)return this.DocumentVisibility=!1,this.GridVisibility=!0,void(this.IsAutoPost&&this.postworker_Completed());if(this.DocumentLinkDimensions.length>0){let e=new Array;this.DocumentLinkDimensions.forEach(t=>{var i=this.Document.ScreenObject._CCFields.find(e=>e instanceof d.b&&e.CCID==t.CCID);null!=i&&e.push(i)}),this.DocumentLinkDimensions=e}if("NEXT"==e&&this.Document.clear(1),this.iVendorCount<this.lstVendors.length){if(this.dvItems=this.lstPostDocsGroup.length>this.iVendorCount?this.lstPostDocsGroup[this.iVendorCount]:this.ReOrderGrid.Table.filter(e=>e.OrderQty>0),0==this.dvItems.length)return this.iVendorCount++,void this.LoadNextDocument(this.IsAutoPost?"SAVE":"NEXT");this.lstVendors[this.iVendorCount].length>0&&(this.Document.ScreenObject.IsPurchase?(this.Document.ScreenObject.CreditAccount.SelectedValue=parseInt(this.lstVendors[this.iVendorCount]),this.Document.ScreenObject.OnGetReference(this.Document.ScreenObject.CreditAccount.Name)):(this.Document.ScreenObject.DebitAccount.SelectedValue=parseInt(this.lstVendors[this.iVendorCount]),this.Document.ScreenObject.OnGetReference(this.Document.ScreenObject.DebitAccount.Name)));for(let e=this.Document.GRIDTABLE.length;e<this.dvItems.length+5;e++){let e=this.Document.ScreenObject.GridDataObj.NewRow();this.Document.ScreenObject.GridDataObj.addRow(e)}if(this.ProductsByVoucher_Temp){let e,t="";this.dvItems.ToTable(!0,["ReorderDetailsID"]).forEach(e=>{t.length>0&&(t+=","),t+="'"+e.ReorderDetailsID.toString()+"'"});let i="SELECT D.InvDocDetailsID,D.ProductID,D.CostCenterID,D.VoucherNo"+this.strDimensionLinkQry+" FROM INV_DocDetails D with(nolock)";this.strDimensionLinkQry.length>0&&(i+=" inner join com_docccdata DCC on DCC.InvDocDetailsID=D.InvDocDetailsID"),i+=" WHERE D.InvDocDetailsID IN ("+t+")";let s=o.a.report.ReportDataTable("RPT022",this.IsReportDB,i),l=0,n=new Array,a=new Array;for(let o=0;o<this.dvItems.length;o++)for(n.Clear(),a.Clear(),l=0,t=this.dvItems[o].VoucherNo.toString(),e=this.dvItems[o].ReorderDetailsID.toString();o<this.dvItems.length;o++){let e=s.filter(e=>e.VoucherNo==t&&e.InvDocDetailsID==this.dvItems[o].ReorderDetailsID);if(e.length>0){let t={};t.InvDocDetailsID=parseInt(e[0].InvDocDetailsID),l=parseInt(e[0].CostCenterID),n.push(t)}if(a.push(this.dvItems[o]),o==this.dvItems.length-1||this.dvItems[o+1].VoucherNo.toString()!=t){let i=null;l>0&&null!=this.Document.ScreenObject.Link&&(i=this.Document.ScreenObject.Link.LinkCombo.Items.find(e=>e.Parent==l.toString())),null!=i?(this.strDimensionLinkQry.length>0&&e.length>0&&this.DocumentLinkDimensions.forEach(t=>{r.e.StringIsNullOrEmpty(e[0][t.DBColumnName])||(t.SelectedValue=parseInt(e[0][t.DBColumnName]))}),this.Document.FillLink(t,parseInt(i.Value),n,new Array),this.Document.RefreshGrid||(this.Document.RefreshGrid=!0),a.forEach(e=>{let t=this.Document.GRIDTABLE.filter(t=>t.LinkedInvDocDetailsID==e.ReorderDetailsID);t.length>0&&(t[0][t[0].LinkedFieldName.toString()]=e.OrderQty)})):a.forEach(e=>{this.AddProductToDocument(e)});break}}if(0==this.Document.GRIDTABLE.length||null==this.Document.GRIDTABLE[0].ProductID_Key)return this.iVendorCount++,void this.LoadNextDocument(this.IsAutoPost?"SAVE":"NEXT")}else this.dvItems.forEach(e=>{this.AddProductToDocument(e)});this.iVendorCount++,this.IsAutoPost&&this.AutoSaveDocument()}}AddProductToDocument(e){let t=!1,i=null;for(let s=0;s<this.Document.ScreenObject.GridData.length;s++){let e=this.Document.ScreenObject.GridData[s];if(""==r.e.String(e.ProductID_Key)){i=e;break}}null==i&&(t=!0,i=this.Document.ScreenObject.GridDataObj.NewRow()),i.ProductCode=e.ProductCode.toString(),i.ProductName=e.ProductName.toString(),i.ProductID_Key=e.ProductName_Key.toString(),this.Document.AddProductData(i,!1,!1),i.Quantity=e.OrderQty,e.UOM_Key.toString()!=i.Unit_Key.toString()?(i.Unit=e.UOM.toString(),i.Unit_Key=e.UOM_Key.toString(),this.Document.OnProductUnitChange(i)):""!=i.Quantity.toString()&&""!=i.UOMConversion.toString()?i.UOMConvertedQty=parseFloat(i.UOMConversion.toString())*parseFloat(i.Quantity.toString()):""!=i.Quantity.toString()&&(i.UOMConvertedQty=i.Quantity.toString()),this.DocumentMappingColumns.length>0&&this.DocumentMappingColumns.forEach(t=>{if(t.SectionName.startsWith("dcCCNID"))if(this.Document.ScreenObject.GridDataColumns.Contains(t.SectionName))i[t.SectionName]=e[t.DisplayMember],i[t.SectionName+"_Key"]=e[t.DisplayMember+"_ID"];else{var s=this.Document.ScreenObject._CCFields.find(e=>e.DBColumnName==t.SectionName);s instanceof d.b&&null!=e[t.DisplayMember+"_ID"]&&(s.SelectedValue=parseInt(e[t.DisplayMember+"_ID"]),s.IsAutoLoad&&(s.SelectedValueText=e[t.DisplayMember].toString()))}else if(this.Document.ScreenObject.GridDataColumns.Contains(t.SectionName))i[t.SectionName]=e[t.DisplayMember];else{var o=this.Document.ScreenObject._TextFields.find(e=>e.DBColumnName==t.SectionName);if(null!=o)if(o instanceof p.d)o.Text=e[t.DisplayMember].toString();else if(o instanceof p.c)o.Text=e[t.DisplayMember].toString();else if(o instanceof O.a)o.TextBox.Text=e[t.DisplayMember].toString();else if(o instanceof S.a)try{o.Date=new Date(e[t.DisplayMember])}catch(r){}}}),t&&this.Document.ScreenObject.GridDataObj.addRow(i),this.Document.CalculateTotals(i,!1)}SaveCallBack_Complete(){if(this.IsAutoPost){if(this.postworkerCancel)return void(this.ShowAutoPost=!1);this.Document.RetValue<0&&(this.AutoPostGrid.Table[this.indPostIndex].ErrorMessage=this.Document.DisplayMessage),this.AutoPostGrid.Table[this.indPostIndex].Sno=this.indPostIndex+1,this.AutoPostGrid.invalidate(),this.indPostIndex++,this.LoadNextDocument("NEXT")}else this.iVendorCount<this.lstVendors.length?R.RibbonExtViewModel.GetDocumentObject(parseInt(this.Documents.SelectedValue),this.Documents.SelectedItem.Name,!1).then(e=>{this.Document=e,this.Document.GenratePrefix=!0,this.Document.SaveCallBack=new h.b,this.Document.SaveCallBack.Subscribe(this,"OnSaveCallBack"),this.LoadNextDocument("SAVE")}):(this.DocumentVisibility=!1,this.GridVisibility=!0)}OnSaveCallBack(e,t){return this.IsAutoPost&&this.AutoPostGrid.Table.length>this.indPostIndex&&(this.AutoPostGrid.Table[this.indPostIndex].DocNo=this.Document.ScreenObject.VoucherNo),""}AutoSaveDocument(){this.AutoPostGrid.Table.length>this.indPostIndex?this.Document.SaveInventoryDocument("Save",!1):(this.indPostIndex++,this.LoadNextDocument("NEXT"))}OnLinkClick(e,t,i){"ProductCode"!=t&&"ProductName"!=t||null!=e.ProductName_Key&&R.RibbonExtViewModel.ShowAddProductScreenViewModel(parseInt(e.ProductName_Key),"EDIT",0,!1)}OnGridBeginEdit(e,t,i){return"1"==r.e.String(e.StyleIsBold)}GetDimensionFilter(e,t,i){let s="";return this.CostCenterFilters.forEach(o=>{if((o.SelectedNodes.length>0||!o.DeleteButtonVisibility&&i)&&o.CostCenterID>5e4&&t.Contains(o.CostCenterID.toString()))if(s+=" AND ",1==o.SelectedNodes.length)s+=e+(o.CostCenterID-5e4)+"="+o.SelectedNodes[0].Id;else{s+=e+(o.CostCenterID-5e4)+" IN (";for(let e=0;e<o.SelectedNodes.length;e++)e>0&&(s+=","),s+=o.SelectedNodes[e].Id;0==o.SelectedNodes.length&&(s+="-123"),s+=")"}}),s.toString()}GetFilterNodes(e){let t="";var i=this.CostCenterFilters.find(t=>t.CostCenterID==e);if(i&&i.SelectedNodes.length>0)if(1==i.SelectedNodes.length)t+=i.SelectedNodes[0].Id;else for(let s=0;s<i.SelectedNodes.length;s++)i.SelectedNodes[s].IsGroup||(t.length>0&&(t+=","),t+=i.SelectedNodes[s].Id);return t.toString()}FilterorClear(e){this.MessageVisibility=!1;let t=!0,i="";if("PostFilterClear"!=e){for(let e=0;e<this.PostDataFetchFilterFields.length;e++){let s=this.PostDataFetchFilterFields[e];if("None"!=s.Condition.SelectedValue)if(t=!1,"DATE"==s.DataType)"Between"==s.Condition.SelectedValue||"NotBetween"==s.Condition.SelectedValue?("NotBetween"==s.Condition.SelectedValue&&(i+=" not ("),i+="["+s.ColumnName+"] >= '"+s.FromDate.Date+"' and  ["+s.ColumnName+"] <= '"+s.ToDate.Date+"' ","NotBetween"==s.Condition.SelectedValue&&(i+=" ) "),i+=" and "):i+="["+s.ColumnName+"]"+s.Condition.SelectedItem.Parent+" '"+s.FromDate.Date+"' and ";else if("Between"==s.Condition.SelectedValue||"NotBetween"==s.Condition.SelectedValue)"NotBetween"==s.Condition.SelectedValue&&(i+=" not ("),null!=s.FromValue.TextBox.Text&&""!=s.FromValue.TextBox.Text.Trim()&&(i+="["+s.ColumnName+"] >= '"+s.FromValue.TextBox.Text+"' "),null!=s.ToValue.Text&&""!=s.ToValue.Text.Trim()&&(null!=s.FromValue.TextBox.Text&&""!=s.FromValue.TextBox.Text.Trim()&&(i+=" and "),i+="["+s.ColumnName+"] <= '"+s.ToValue.Text+"' "),"NotBetween"==s.Condition.SelectedValue&&(i+=" ) "),i+=" and ";else if(s.FromDropDown.Visible)if(s.FromDropDown.Items[0].IsChecked)i+=" 1=1 and ";else{let e="";e+="(",s.FromDropDown.Items.forEach(t=>{t.IsChecked&&("Equal"==s.Condition.SelectedValue?(e.length>1&&(e+=" OR "),e+=""==t.Name?"(["+s.ColumnName+"] is null or ["+s.ColumnName+"]='')":"["+s.ColumnName+"]='"+t.Name+"'"):(e.length>1&&(e+=" and "),e+="[NULL]"==t.Name?"(["+s.ColumnName+"] is not null and ["+s.ColumnName+"]<>'')":"["+s.ColumnName+"]<>'"+t.Name+"'"))}),1==e.length&&(e+="1!=1"),e+=") and ",i+=e.toString()}else null!=s.FromValue.TextBox.Text&&""!=s.FromValue.TextBox.Text.Trim()&&(i+="Contains"==s.Condition.SelectedValue||"NotContain"==s.Condition.SelectedValue?"["+s.ColumnName+"]"+s.Condition.SelectedItem.Parent+" '%"+s.FromValue.TextBox.Text+"%'  and ":"["+s.ColumnName+"]"+s.Condition.SelectedItem.Parent+" '"+s.FromValue.TextBox.Text+"' and ")}t&&(this.MessageVisibility=!0,this.DisplayMessage="Please choose at least one condition to filter")}if(""!=i&&i.length>4||"PostFilterClear"==e){if(null==this.ReOrderGrid.Table)return;"PostFilterClear"==e?(this.PostDataFetchFilterFields.forEach(e=>{e.Condition.SelectedValue="None",e.FromValue.TextBox.Text="",e.ToValue.Text=""}),this.ReOrderGrid.Table=this.ReportData):(this.PostFilterData=this.ReportData.Copy(),this.PostFilterData=n.a.FilterData(this.PostFilterData,this.PostDataFetchFilterFields),this.ReOrderGrid.Table=this.PostFilterData),this.ReOrderGrid.UpdateTotals(),this.ReOrderGrid.refreshDataView()}}onColumnCheckedChanged(e){try{if(null!=e){var t=this.ColumnsSource.find(t=>t.DisplayMember==e.ColumnName);if(t){t.IsVisible=!!e.ShowColumn;let i=new Array;this.ColumnsSource.forEach(e=>{i.push(e)}),this.ReOrderGrid.Columns=i,this.ReOrderGrid.RefreshColumns()}}}catch(i){Logger.ErrorLog("ReOrderLevelNewViewModel::Error onColumnCheckedChanged",i)}}OnContextMenuClick(e){return Object(s.b)(this,void 0,void 0,(function*(){let t,s=e,l=this.ReOrderGrid.SelectedItem,n="";n+="<XML>","RowReport"==s.Name&&(this.ReportID=parseInt(s.attributes.ID.value),r.f.SelectNodes(s,"Filters/ColumnFilter").forEach(e=>{t=e.attributes.PID.value+"_ID",Object(P.isUndefined)(l[t])&&("ProductCode"!=e.attributes.PID.value&&"ProductName"!=e.attributes.PID.value||(t="ProductName_Key")),null!=l[t]&&(n+="<Row ColID='"+e.attributes.CID.value+"' Value='"+l[t].toString()+"'/>")})),n+="</XML>";const{ReportViewModel:a}=yield Promise.all([i.e(2),i.e(1),i.e(3),i.e(5),i.e(4),i.e(6),i.e(7),i.e(10),i.e(9),i.e(8),i.e(12),i.e(11),i.e(13),i.e(19),i.e(15),i.e(21),i.e(20),i.e(16),i.e(14),i.e(18),i.e(17),i.e(22),i.e(23),i.e(24),i.e(25),i.e(28),i.e(30),i.e(29),i.e(32),i.e(31),i.e(27),i.e(26),i.e(35),i.e(37),i.e(38),i.e(36),i.e(33),i.e(34),i.e(39),i.e(40),i.e(41),i.e(212)]).then(i.bind(null,"ThYU")),{ReportViewComponent:h}=yield Promise.all([i.e(32),i.e(37)]).then(i.bind(null,"YU11"));let d=new a;d.ReportViewModel_Document(50,n.toString(),this.ReportID,!1,this,s),o.a.page.addNewTab({component:h,params:{obj:d}})}))}RefreshDateFilter(){this.DateFilter=this.FromDate.Date.ToString(o.a.SessionManager.Preferences["Date Format"]),this.DateFilter+="  to  "+this.ToDate.Date.ToString(o.a.SessionManager.Preferences["Date Format"]),this.ProfileName.length>0&&(this.DateFilter+=" ["+this.ProfileName+"]")}}},"x+Dt":function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var s=i("Do2H"),o=i("Lp6j"),r=i("0/4Q"),l=i("Jnyl"),n=i("EQd/"),a=i("JIg3"),h=i("n56n"),d=i("wlFP");class u{constructor(){this.ShowColumnObj=new d.a,this.CheckBoxVisibility=!1,this.ReOrder=null,this.LstFilter=null,this.ReportViewModel=null,this.LockCheckedChanged=!1}get ShowColumn(){return this.ShowColumnObj.IsChecked}set ShowColumn(e){this.ShowColumnObj.IsChecked=e}PostDataField_1(e,t){"ReportViewModel"==t.ClassName?this.ReportViewModel=t:"ReOrderLevelNewViewModel"==t.ClassName?this.ReOrder=t:"FilterDialogViewModel"==t.ClassName&&(this.LstFilter=t),this.ShowColumnObj.CheckedChangedCommand.Subscribe(t,"onColumnCheckedChanged",this),this.DataType=e.ColumnType,this.ColumnName=e.ID,this.Header=e.HeaderText,this.ShowColumn=!0,this.CheckBoxVisibility=!0,this.Condition=new r.e(0),this.FromValue=new l.a(0),this.ToValue=new n.d(0),this.FromDate=new a.a(0),this.ToDate=new a.a(0),this.FromDropDown=new r.b,this.FromList=new h.b(0),this.ToList=new h.b(0),this.Condition.LblWidth="80",this.FromValue.LblWidth=this.FromValue.TextBox.LblWidth="80",this.ToValue.LblWidth="80",this.FromDate.LblWidth="80",this.ToDate.LblWidth="80",this.FromDropDown.LblWidth="80",this.FromList.LblWidth="80",this.ToList.LblWidth="80",this.Condition.Label=s.a.GetResource("Reports_Condition"),this.FromValue.Label=this.FromValue.TextBox.Label=s.a.GetResource("Reports_FromValue"),this.ToValue.Label=s.a.GetResource("Reports_ToValue"),this.FromDate.Label=s.a.GetResource("Reports_FromValue"),this.ToDate.Label=s.a.GetResource("Reports_ToValue"),this.LoadConditions(this.DataType),this.Condition.SelectionChangedCommand.Subscribe(this,"OnConditionChange"),this.FromDropDown.CheckedChangedCommand.Subscribe(this,"OnCheckedChanged"),this.FromValue.Visible=!1,this.ToValue.Visible=!1,this.FromDate.Visible=!1,this.ToDate.Visible=!1,this.FromDropDown.Visible=!1,this.FromList.Visible=!1,this.ToList.Visible=!1,"INT"!=this.DataType&&"DATE"!=this.DataType&&"FLOAT"!=this.DataType&&(this.FromDropDown.DataType="TEXT")}PostDataField_2(e){this.DataType=e.CDGDO.DataType,this.ColumnName=e.CDGDO.CategoryText,this.Header=e.Caption.Text,this.ShowColumn=!0,this.CheckBoxVisibility=!1,this.FromDropDown=new r.b,this.FromDropDown.Visible=!1,this.Condition=e.Condition,this.FromValue=e.FromValue,this.ToValue=e.ToValue,this.FromDate=e.FromDatePicker,this.ToDate=e.ToDatePicker,this.FromList=e.FromList,this.ToList=e.ToList,e.OnConditionSelectionChanged(this.Condition.SelectedValue)}OnConditionChange(e){var t;if(null==(null===(t=this.ReportViewModel)||void 0===t?void 0:t.DocsLanding))if(this.FromDropDown.Label=this.FromDate.Label=this.FromValue.Label=this.FromValue.TextBox.Label=s.a.GetResource("Service_Value"),this.FromValue.Visible=!1,this.ToValue.Visible=!1,this.FromDate.Visible=!1,this.ToDate.Visible=!1,this.FromDropDown.Visible=!1,"DATE"==this.DataType)"Between"==this.Condition.SelectedValue||"NotBetween"==this.Condition.SelectedValue?(this.FromDate.Visible=!0,this.ToDate.Visible=!0,this.FromDate.Label=s.a.GetResource("Reports_FromValue")):"None"!=this.Condition.SelectedValue&&(this.FromDate.Visible=!0);else if("Between"==this.Condition.SelectedValue||"NotBetween"==this.Condition.SelectedValue)this.FromValue.Visible=!0,this.ToValue.Visible=!0,this.FromValue.TextBox.Label=s.a.GetResource("Reports_FromValue");else if("Equal"==this.Condition.SelectedValue||"NotEqual"==this.Condition.SelectedValue)if("TEXT"==this.FromDropDown.DataType){if(this.FromDropDown.Visible=!0,0==this.FromDropDown.Items.length)if(this.FromDropDown.Items.push(r.c.CheckedListBoxItem_2("ALL",!0)),this.FromDropDown.SelectedValue="ALL",null!=this.ReportViewModel&&null!=this.ReportViewModel.ReportData){if(this.ReportViewModel.ReportDataColumns.Contains(this.ColumnName)){let e;e=null!=this.ReportViewModel.PostFilterData?this.ReportViewModel.PostFilterData.ToTable(!0,[this.ColumnName]):this.ReportViewModel.ReportData.ToTable(!0,[this.ColumnName]),e.forEach(e=>{this.FromDropDown.Items.push(r.c.CheckedListBoxItem_2(o.e.String(e[this.ColumnName]),!0))})}}else if(null!=this.ReportViewModel){for(let e=0;e<this.ReportViewModel.ReportColumns.length;e++)if(this.ReportViewModel.ReportColumns[e].ID==this.ColumnName){let t=[];this.ReportViewModel.Data.forEach(i=>{null!=i.Cells[e].Text&&(t.Contains(i.Cells[e].Text)||(t.push(i.Cells[e].Text),this.FromDropDown.Items.push(r.c.CheckedListBoxItem_2(i.Cells[e].Text,!0))))});break}}else null!=this.ReOrder&&null!=this.ReOrder.ReOrderGrid.Table&&this.ReOrder.ReOrderGrid.Table.Columns.Contains(this.ColumnName)&&this.ReOrder.ReOrderGrid.Table.DefaultView.ToTable(!0,[this.ColumnName]).forEach(e=>{this.FromDropDown.Items.push(r.c.CheckedListBoxItem_2(o.e.String(e[this.ColumnName]),!0))})}else this.FromValue.Visible=!0;else"None"!=this.Condition.SelectedValue&&(this.FromValue.Visible=!0);else this.OnConditionChange_DocumentsList(e)}OnConditionChange_DocumentsList(e){this.FromDropDown.Label=this.FromList.Label=this.FromDate.Label=this.FromValue.Label=this.FromValue.TextBox.Label=s.a.GetResource("Service_Value"),this.FromValue.Visible=!1,this.ToValue.Visible=!1,this.FromDate.Visible=!1,this.ToDate.Visible=!1,this.FromDropDown.Visible=!1,this.FromList.Visible=!1,"DATE"==this.DataType?"Between"==this.Condition.SelectedValue||"NotBetween"==this.Condition.SelectedValue?(this.FromDate.Visible=!0,this.ToDate.Visible=!0,this.FromDate.Label=s.a.GetResource("Reports_FromValue")):"None"!=this.Condition.SelectedValue&&(this.FromDate.Visible=!0):"Between"==this.Condition.SelectedValue||"NotBetween"==this.Condition.SelectedValue?(this.FromValue.Visible=!0,this.ToValue.Visible=!0,this.FromValue.TextBox.Label=s.a.GetResource("Reports_FromValue")):"Equal"==this.Condition.SelectedValue||"NotEqual"==this.Condition.SelectedValue?"TEXT"==this.FromDropDown.DataType?this.FromList.Visible=!0:this.FromValue.Visible=!0:"None"!=this.Condition.SelectedValue&&(this.FromValue.Visible=!0)}LoadConditions(e){this.Condition.Items.Clear(),"INT"==e||"FLOAT"==e||"Float"==e||"Date"==e||"DATE"==e?(this.Condition.Items.push(r.d.ComboBoxItems_3(s.a.GetResource("Reports_None"),"None","")),this.Condition.Items.push(r.d.ComboBoxItems_3(s.a.GetResource("Reports_Between"),"Between"," BETWEEN ")),this.Condition.Items.push(r.d.ComboBoxItems_3(s.a.GetResource("Reports_NotBetween"),"NotBetween"," NOT BETWEEN ")),this.Condition.Items.push(r.d.ComboBoxItems_3(s.a.GetResource("Reports_Equal"),"Equal","=")),this.Condition.Items.push(r.d.ComboBoxItems_3(s.a.GetResource("Reports_NotEqual"),"NotEqual","<>")),this.Condition.Items.push(r.d.ComboBoxItems_3(s.a.GetResource("Reports_Lessthan"),"Lessthan","<")),this.Condition.Items.push(r.d.ComboBoxItems_3(s.a.GetResource("Reports_LessthanOrEqual"),"LessthanOrEqual","<=")),this.Condition.Items.push(r.d.ComboBoxItems_3(s.a.GetResource("Reports_Greaterthan"),"Greaterthan",">")),this.Condition.Items.push(r.d.ComboBoxItems_3(s.a.GetResource("Reports_GreaterthanOrEqual"),"Greaterthan Or Equal",">=")),this.Condition.SelectedValue="None"):(this.Condition.Items.push(r.d.ComboBoxItems_3(s.a.GetResource("Reports_None"),"None","")),this.Condition.Items.push(r.d.ComboBoxItems_3(s.a.GetResource("Reports_Between"),"Between"," BETWEEN ")),this.Condition.Items.push(r.d.ComboBoxItems_3(s.a.GetResource("Reports_NotBetween"),"NotBetween"," NOT BETWEEN ")),this.Condition.Items.push(r.d.ComboBoxItems_3(s.a.GetResource("Com_Contains"),"Contains"," LIKE ")),this.Condition.Items.push(r.d.ComboBoxItems_3(s.a.GetResource("Reports_NotContain"),"NotContain"," NOT LIKE ")),this.Condition.Items.push(r.d.ComboBoxItems_3(s.a.GetResource("Reports_Equal"),"Equal","=")),this.Condition.Items.push(r.d.ComboBoxItems_3(s.a.GetResource("Reports_NotEqual"),"NotEqual","<>")),this.Condition.Items.push(r.d.ComboBoxItems_3(s.a.GetResource("Com_BeginsWith"),"BeginsWith","BeginsWith")),this.Condition.Items.push(r.d.ComboBoxItems_3(s.a.GetResource("Com_EndsWith"),"EndsWith","EndsWith")),this.Condition.SelectedValue="None")}OnCheckedChanged(e){if(!this.LockCheckedChanged&&e.item instanceof r.c){let t=e.item;if("ALL"==t.Value){if(this.LockCheckedChanged=!0,this.FromDropDown.Items.length>0)for(let e=1;e<this.FromDropDown.Items.length;e++)this.FromDropDown.Items[e].IsChecked=t.IsChecked;this.LockCheckedChanged=!1}else{if(this.LockCheckedChanged=!0,this.FromDropDown.Items.length>0)if(t.IsChecked){this.FromDropDown.Items[0].IsChecked=!0;for(let e=1;e<this.FromDropDown.Items.length;e++)if(!this.FromDropDown.Items[e].IsChecked){this.FromDropDown.Items[0].IsChecked=!1;break}}else this.FromDropDown.Items[0].IsChecked=!1;this.LockCheckedChanged=!1}this.LockCheckedChanged=!1}}Clear(){this.Condition.SelectedValue="None",this.FromValue.TextBox.Text="",this.ToValue.Text="",this.FromDropDown.Items.Clear()}}}}]);