function _defineProperties(t,e){for(var s=0;s<e.length;s++){var o=e[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function _createClass(t,e,s){return e&&_defineProperties(t.prototype,e),s&&_defineProperties(t,s),t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var s,o=_getPrototypeOf(t);if(e){var i=_getPrototypeOf(this).constructor;s=Reflect.construct(o,arguments,i)}else s=o.apply(this,arguments);return _possibleConstructorReturn(this,s)}}function _possibleConstructorReturn(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[81],{"0T9g":function(t,e,s){"use strict";s.r(e),s.d(e,"eTradingReportFormat",(function(){return T})),s.d(e,"ACC_TradingReports",(function(){return I}));var o=s("Do2H"),i=s("Lp6j"),l=s("eQJW"),a=s("1xwR"),n=s("mvPR"),r=s("vTM8"),h=s("MCLT"),d=s("ThYU"),c=s("8iaB"),u=function t(){_classCallCheck(this,t),this.Lft=0,this.Rgt=0},T=function(t){return t[t.Vertical=0]="Vertical",t[t.Horizontal=1]="Horizontal",t[t.Plain=2]="Plain",t}({}),p=function(t){return t[t.None=0]="None",t[t.MonthWise=1]="MonthWise",t[t.QtrWise=4]="QtrWise",t[t.HalfYearWise=5]="HalfYearWise",t[t.YearWise=3]="YearWise",t[t.TagWise=2]="TagWise",t}({}),C=function t(){_classCallCheck(this,t)},I=function(t){_inherits(s,t);var e=_createSuper(s);function s(t){var o;return _classCallCheck(this,s),(o=e.call(this,t)).Show=p.None,o.k=0,o.BalIndex=0,o.LevelNo=0,o.ReportTotalIndex=0,o.CountMonths=0,o.ForeignCurrencyID=0,o.CurrencyType=0,o.CellStartPos=0,o.GroupTotalIndex=0,o.YTDIndex=0,o.YTD_LYIndex=0,o.BAL_LYIndex=0,o.TotalBudgetIndex=1,o.VariancePercentIndex=1,o.SalesPercentIndex=1,o.NegNumber=4,o.ColumnSize=0,o.AccNameIndex=0,o.FirstTypeEndIndex=0,o.GrossCellIndex=0,o.ReportRowStartIndex=0,o.TagID=0,o.CADimension=0,o.Olddbl=0,o.dbl=0,o.dblTemp=0,o.exchRate=0,o.dblTotalSales=0,o.OldReportTotalMonthWise=null,o.lstTotal=null,o.lstParents=new Array,o.STACKROWS=new Array,o.lstParentCell=new Array,o.IsIncome=!1,o.IsIncomeNegative=!1,o.IncludeOpeningStock=!1,o.IncludeClosingStock=!1,o.ShowPrevMonthData=!1,o.ShowPrevMonthDiffData=!1,o.ShowPrevMonthVarPer=!1,o.ShowdetailsofControlGroups=!1,o.GroupTotalsAtEnd=!1,o.GroupTotalsSeperate=!1,o.DontShowSummaryGroupTotals=!1,o.ShowCarryForward=!1,o.ShowNetProfitBeforeAndAfter=!1,o.ClubIncomeExpenseInPlainReport=!1,o.ShowTotalBudget=!1,o.ShowBudget=!1,o.ShowBudgetVariance=!1,o.ShowBudgetVariancePercent=!1,o.HideZeroBudgetAccounts=!1,o.ShowGrossInIncome=!1,o.ShowIncomeFirst=!1,o.IsFirstCall=!1,o.ShowAllAccounts=!1,o.IsAccountWise=!1,o.AddGrossToVariance=!1,o.IgnoreGrossRowsForBS=!1,o.ShowSalesPercentage=!1,o.ShowSalesPerMonthly=!1,o.GrossAtEnd=!1,o.NetAtEnd=!1,o.lstTagSalesTotal=new r.a,o.dvYTD=null,o.dvBAL_LY=null,o.dvYTD_LY=null,o.dvYTDTable=null,o.dvBAL_LYTable=null,o.dvYTD_LYTable=null,o.sbSpaces="",o.GrossRows=new Array(2),o.ReportFormat=T.Vertical,o.IncomeExpenseHeader=new n.a,o.GroupRowAppearance=new n.a,o.AccountID=0,o.RetainedEarningAccount=0,o.CurrentBudgetID=0,o.PreviousBudgetID=0,o.LastAccountID=0,o.FirstAccountID=0,o.LocationWhere="",o.dsNew=null,o.dsOpenCompany=null,o.dsOpeningStock=null,o.dsClosingStock=null,o.dsList=new Array,o.dv1=null,o.dv2=null,o.dvCurrentBudget=null,o.dvPrevBudget=null,o.dv1Table=null,o.dv2Table=null,o.dvCurrentBudgetTable=null,o.dvPrevBudgetTable=null,o.dv1Columns=null,o.dv2Columns=null,o.IncomeAccounts=new Array,o.lstTags=new Array,o.lstPMTags=new Array,o.dblMonBal=0,o.dblActBudget=0,o.dblClosingStock=0,o.dblOpeningStock=0,o.YearSlots=new r.a,o.QtrSlot=new r.a,o.HideTagWiseBudget=!1,o.HideEmptyDimensions=!1,o.lstTagColumns=new Array,o.lstTagVisibleColumns=new Array,o.TextFields=new r.a,o.TempData=new Array,o.IsAddRow=0,o.dblAccountsDrOpBalDiff=0,o.dblAccountsCrOpBalDiff=0,o.dblDrOpBalDiff=0,o.dblCrOpBalDiff=0,o.dblOpeningBalanceDifference=0,o.lstTagsOpeningBalance=new r.a,o.IncomeExpenseHeader.IsBold=!0,o.IncomeExpenseHeader.FontSize=14,o.IncomeExpenseHeader.ForeColor="#FF00465A",o.IncomeExpenseHeader.BackColor="White",o.GroupRowAppearance.IsBold=!1,o.GroupRowAppearance.FontSize=12,o.GroupRowAppearance.ForeColor="#FF00465A",o.GroupRowAppearance.BackColor="White",o}return _createClass(s,[{key:"LoadReport",value:function(){var t=this;if("True"!=o.a.SessionManager.Preferences.EnableLocationWise.toString()||"True"!=o.a.SessionManager.Preferences["LW Reports"]||"True"!=o.a.SessionManager.Preferences.LWAccPeriod||(this.CheckLWAccountingDate(),i.e.IsEmpty(this.ViewModel.DisplayMessage))){if(this.GrdRow=-1,this.CountMonths=0,this.Show=p.None,this.ReportTotal=new Array(2).fill(0),this.lstTotal=new Array,this.LevelNo=parseInt(this.ViewModel.Preferences.Level),this.ShowIncomeFirst="Income"==this.ViewModel.Preferences.ShowFirst,this.ViewModel.IsReportCollapsable=!0,"Vertical"==this.ViewModel.Preferences.ReportFormat?this.ReportFormat=T.Vertical:"Horizontal"==this.ViewModel.Preferences.ReportFormat?(this.ViewModel.IsReportCollapsable=!1,this.ReportFormat=T.Horizontal):this.ReportFormat=T.Plain,this.ViewModel.Preferences.ContainsKey("IncludeStock")&&(this.IncludeOpeningStock=this.ViewModel.Preferences.IncludeStock.Contains("<OpeningStock />"),this.IncludeClosingStock=this.ViewModel.Preferences.IncludeStock.Contains("<ClosingStock />")),this.PDCInclude=!(!this.ViewModel.Preferences.ContainsKey("IncludePDCs")||"1"!=this.ViewModel.Preferences.IncludePDCs),this.IncludeUnApprovedPDC=!(!this.ViewModel.Preferences.ContainsKey("IncludeUnApprovedPDC")||"1"!=this.ViewModel.Preferences.IncludeUnApprovedPDC),this.IncludeTerminatedPDC=!this.ViewModel.Preferences.ContainsKey("IncludeTerminatedPDC")||"0"!=this.ViewModel.Preferences.IncludeTerminatedPDC,this.UnPostedDocsInclude=!(!this.ViewModel.Preferences.ContainsKey("IncludeUnPostedDocs")||"1"!=this.ViewModel.Preferences.IncludeUnPostedDocs),this.UnPostedDocsList=this.UnPostedDocsInclude&&this.ViewModel.Preferences.ContainsKey("IncludeUnPostedDocsList")?this.ViewModel.Preferences.IncludeUnPostedDocsList:"",this.ShowdetailsofControlGroups=!(!this.ViewModel.Preferences.ContainsKey("ShowdetailsofControlGroups")||"1"!=this.ViewModel.Preferences.ShowdetailsofControlGroups),5==this.ViewModel.StaticReportType&&(this.ShowdetailsofControlGroups=!0),this.ForeignCurrencyID=0,this.ViewModel.Preferences.ContainsKey("ForeignCurrency")){var e=new i.f;e.LoadXml("<XML>"+this.ViewModel.Preferences.ForeignCurrency+"</XML>");var s=i.f.SelectSingleNode(e.DocumentElement,"IsChecked");null!=s&&"1"==s.innerHTML&&(s=i.f.SelectSingleNode(e.DocumentElement,"Value"),this.ForeignCurrencyID=parseInt(s.innerHTML))}else if(this.ViewModel.Preferences.ContainsKey("Currency")){var a=new i.f;a.LoadXml("<XML>"+this.ViewModel.Preferences.Currency+"</XML>"),this.CurrencyType=parseInt(i.f.SelectSingleNode(a.DocumentElement,"Type").innerHTML),1==this.CurrencyType?(i.e.IsEmpty(o.a.SessionManager.Preferences.DimensionwiseCurrency)||0==parseInt(o.a.SessionManager.Preferences.DimensionwiseCurrency))&&(this.CurrencyType=0):2==this.CurrencyType&&(this.ForeignCurrencyID=parseInt(i.f.SelectSingleNode(a.DocumentElement,"Value").innerHTML))}if(this.GroupTotalsAtEnd=!(!this.ViewModel.Preferences.ContainsKey("GroupTotalsAtEnd")||"1"!=this.ViewModel.Preferences.GroupTotalsAtEnd),this.GroupTotalsSeperate=!(!this.ViewModel.Preferences.ContainsKey("GroupTotalsSeperate")||"1"!=this.ViewModel.Preferences.GroupTotalsSeperate),this.DontShowSummaryGroupTotals=!(!this.ViewModel.Preferences.ContainsKey("DontShowSummaryGroupTotals")||"1"!=this.ViewModel.Preferences.DontShowSummaryGroupTotals),this.ClubIncomeExpenseInPlainReport=!(!this.ViewModel.Preferences.ContainsKey("ClubIncomeExpenseInPlainReport")||"1"!=this.ViewModel.Preferences.ClubIncomeExpenseInPlainReport),this.ShowCarryForward=!(!this.ViewModel.Preferences.ContainsKey("ShowCarryForward")||"1"!=this.ViewModel.Preferences.ShowCarryForward),this.ShowNetProfitBeforeAndAfter=!(!this.ViewModel.Preferences.ContainsKey("ShowNetProfit")||"BeforeAndAfter"!=this.ViewModel.Preferences.ShowNetProfit),this.ShowAllAccounts=!(!this.ViewModel.Preferences.ContainsKey("ShowAllAccounts")||"1"!=this.ViewModel.Preferences.ShowAllAccounts),this.HideZeroBudgetAccounts=!(!this.ViewModel.Preferences.ContainsKey("HideZeroBudgetAccounts")||"1"!=this.ViewModel.Preferences.HideZeroBudgetAccounts),this.IsAccountWise=!(!this.ViewModel.Preferences.ContainsKey("AccountWise")||"1"!=this.ViewModel.Preferences.AccountWise),this.DontApplyLocationWiseAccountsFilter=!(!this.ViewModel.Preferences.ContainsKey("DontApplyLocationWiseAccountsFilter")||"1"!=this.ViewModel.Preferences.DontApplyLocationWiseAccountsFilter),this.DontApplyLocationWiseAccountsFilter||(this.ApplyLWAccountLFilterWhenIgnoreLoc=!(!this.ViewModel.Preferences.ContainsKey("ApplyLWAccountLFilterWhenIgnoreLoc")||"1"!=this.ViewModel.Preferences.ApplyLWAccountLFilterWhenIgnoreLoc)),this.RetainedEarningAccount=this.ViewModel.Preferences.ContainsKey("RetainedEarningAccount")?i.e.Int(this.ViewModel.Preferences.RetainedEarningAccount):0,this.ClosingStockAccount=this.ViewModel.Preferences.ContainsKey("ClosingStockAccount")?i.e.Int(this.ViewModel.Preferences.ClosingStockAccount):0,this.AddGrossToVariance=!(!this.ViewModel.Preferences.ContainsKey("AddGrossToVariance")||"1"!=this.ViewModel.Preferences.AddGrossToVariance),this.NegNumber=this.ViewModel.Preferences.ContainsKey("NegNumber")?parseInt(this.ViewModel.Preferences.NegNumber):4,this.GrossAtEnd=!(!this.ViewModel.Preferences.ContainsKey("GrossAtEnd")||"1"!=this.ViewModel.Preferences.GrossAtEnd),this.NetAtEnd=!(!this.ViewModel.Preferences.ContainsKey("NetAtEnd")||"1"!=this.ViewModel.Preferences.NetAtEnd),this.ShowBudget=!1,this.ShowBudgetVariance=!1,this.CurrentBudgetID=0,this.PreviousBudgetID=0,this.ReportFormat==T.Vertical){var n="0";if(this.ViewModel.Preferences.ContainsKey("ShowSalesPercentage")){var r=new i.f;r.LoadXml("<XML>"+this.ViewModel.Preferences.ShowSalesPercentage+"</XML>"),"1"==i.f.SelectSingleNode(r.DocumentElement,"IsChecked").innerHTML&&(this.ShowSalesPercentage=!0,"Repeat Tag Wise"==i.f.SelectSingleNode(r.DocumentElement,"Value").innerHTML&&(this.ShowSalesPerMonthly=!0))}this.ViewModel.Preferences.ContainsKey("FinalReportsShow")&&(n=this.ViewModel.Preferences.FinalReportsShow),this.ViewModel.Preferences.ContainsKey("HideTagWiseBudget")&&"1"==this.ViewModel.Preferences.HideTagWiseBudget&&(this.HideTagWiseBudget=!0),"1"==n?(this.Show=p.MonthWise,this.ViewModel.oReportDialog.FromDate.Date.iMonth()==this.ViewModel.oReportDialog.ToDate.Date.iMonth()&&this.ViewModel.oReportDialog.FromDate.Date.getFullYear()==this.ViewModel.oReportDialog.ToDate.Date.getFullYear()&&(this.ViewModel.Preferences.ContainsKey("FinalReportsShowPrevMn")||this.ViewModel.Preferences.ContainsKey("FinalReportsShowDifference")||this.ViewModel.Preferences.ContainsKey("FinalReportsShowVarPer")||(this.Show=p.None))):"4"==n?this.Show=p.QtrWise:"5"==n?this.Show=p.HalfYearWise:"3"==n?(this.Show=p.YearWise,this.ViewModel.oReportDialog.FromDate.Date.getFullYear()==this.ViewModel.oReportDialog.ToDate.Date.getFullYear()&&(this.ViewModel.Preferences.ContainsKey("FinalReportsShowPrevMn")||this.ViewModel.Preferences.ContainsKey("FinalReportsShowDifference")||this.ViewModel.Preferences.ContainsKey("FinalReportsShowVarPer")||(this.Show=p.None))):"2"==n&&(this.Show=p.TagWise,this.TagID=parseInt(this.ViewModel.Preferences.FinalReportsShowTag),this.ViewModel.Preferences.ContainsKey("FinalReportsShowTagHideColumns")&&(this.HideEmptyDimensions=!0),this.TagColumnName="Name",this.ViewModel.Preferences.ContainsKey("FinalReportsShowTagColumn")&&("0"==this.ViewModel.Preferences.FinalReportsShowTagColumn?this.TagColumnName="Code":"2"==this.ViewModel.Preferences.FinalReportsShowTagColumn&&(this.TagColumnName="Code+'-'+Name"))),8==this.ViewModel.StaticReportType&&(this.ViewModel.Preferences.ContainsKey("CurrentBudget")&&(this.CurrentBudgetID=i.e.Int(this.ViewModel.Preferences.CurrentBudget)),this.ViewModel.Preferences.ContainsKey("PreviousBudget")&&(this.PreviousBudgetID=i.e.Int(this.ViewModel.Preferences.PreviousBudget)),this.ViewModel.Preferences.ContainsKey("ShowActualBudget")&&"1"==this.ViewModel.Preferences.ShowActualBudget&&(this.CurrentBudgetID>0||this.PreviousBudgetID>0)&&(this.ShowBudget=!0),this.ViewModel.Preferences.ContainsKey("ShowVariance")&&"1"==this.ViewModel.Preferences.ShowVariance&&(this.CurrentBudgetID>0||this.PreviousBudgetID>0)&&(this.ShowBudgetVariance=!0),this.ViewModel.Preferences.ContainsKey("ShowVariancePercent")&&"1"==this.ViewModel.Preferences.ShowVariancePercent&&(this.VariancePercentIndex=1==this.ShowBudgetVariance?2:1,(this.CurrentBudgetID>0||this.PreviousBudgetID>0)&&(this.ShowBudgetVariancePercent=!0)),this.ViewModel.Preferences.ContainsKey("ShowTotalBudget")&&"1"==this.ViewModel.Preferences.ShowTotalBudget&&(this.TotalBudgetIndex=1==this.ShowBudget?2:1,(this.CurrentBudgetID>0||this.PreviousBudgetID>0)&&(this.ShowTotalBudget=!0))),this.Show!=p.MonthWise&&this.Show!=p.QtrWise&&this.Show!=p.HalfYearWise&&this.Show!=p.YearWise||this.ViewModel.oReportDialog.ToDate.Date.Subtract(this.ViewModel.oReportDialog.FromDate.Date).TotalDays<=366&&(this.ShowPrevMonthData=this.ViewModel.Preferences.ContainsKey("FinalReportsShowPrevMn"),this.ShowPrevMonthDiffData=this.ViewModel.Preferences.ContainsKey("FinalReportsShowDifference"),this.ShowPrevMonthVarPer=this.ViewModel.Preferences.ContainsKey("FinalReportsShowVarPer"))}this.CellStartPos=0,this.dtYearStartMonth=new Date(this.ViewModel.oReportDialog.FromDate.Date.getFullYear(),this.AccountingFromMonth-1,1),this.dtYearStartMonth>this.ViewModel.oReportDialog.FromDate.Date&&(this.dtYearStartMonth=this.dtYearStartMonth.AddYears(-1)),this.YTDIndex=this.YTD_LYIndex=this.BAL_LYIndex=-1;for(var h=null,d=null,c=null,u=null,I=0;I<this.ViewModel.ColumnSourceALL.length;I++)"Bud_Budget"==this.ViewModel.ColumnSourceALL[I].ID?((c=this.ViewModel.ColumnSourceALL[I].Clone()).HeaderAppearance.IsVisible=c.DataAppearance.IsVisible=!0,this.ViewModel.ColumnSourceALL[I].HeaderAppearance.IsVisible=!1):"Bud_TotalBudget"==this.ViewModel.ColumnSourceALL[I].ID?((u=this.ViewModel.ColumnSourceALL[I].Clone()).HeaderAppearance.IsVisible=u.DataAppearance.IsVisible=!0,this.ViewModel.ColumnSourceALL[I].HeaderAppearance.IsVisible=!1):"Bud_Variance"==this.ViewModel.ColumnSourceALL[I].ID?((h=this.ViewModel.ColumnSourceALL[I].Clone()).HeaderAppearance.IsVisible=h.DataAppearance.IsVisible=!0,this.ViewModel.ColumnSourceALL[I].HeaderAppearance.IsVisible=!1):"Bud_VariancePerc"==this.ViewModel.ColumnSourceALL[I].ID&&((d=this.ViewModel.ColumnSourceALL[I].Clone()).HeaderAppearance.IsVisible=d.DataAppearance.IsVisible=!0,this.ViewModel.ColumnSourceALL[I].HeaderAppearance.IsVisible=!1);for(var D=new Array,m=0;m<this.ViewModel.ColumnSource.length;m++)if(33!=this.ViewModel.ColumnSource[m].ID.length&&"AccountCode"!=this.ViewModel.ColumnSource[m].ID&&"AccountName"!=this.ViewModel.ColumnSource[m].ID||this.TextFields.push(this.ViewModel.ColumnSource[m].ID,m),D.push(this.ViewModel.ColumnSource[m].Clone()),"Balance"==this.ViewModel.ColumnSource[m].ID){if(D[D.length-1].DataFormat.NegativeNumber=4!=this.NegNumber?this.NegNumber:0,this.ShowTotalBudget){var S=null!=u?u.Clone():D[D.length-1].Clone();S.HeaderText=null!=u?S.HeaderText:"Total Budget",S.ID="TotalBudget",S.DataFormat.NegativeNumber=0,D.InsertAt(S,D.length-1),this.ViewModel.GrpReportTotal.TotalCols.ContainsKey(S.ID)||this.ViewModel.GrpReportTotal.TotalCols.push(S.ID,this.BalIndex-1),this.BalIndex=this.BalIndex+1}if(this.ShowBudget){var A=null!=c?c.Clone():D[D.length-1].Clone();A.HeaderText=null!=c?A.HeaderText:"Budget",A.ID="BudgetBalance",A.DataFormat.NegativeNumber=0,D.InsertAt(A,D.length-1),this.ViewModel.GrpReportTotal.TotalCols.ContainsKey(A.ID)||this.ViewModel.GrpReportTotal.TotalCols.push(A.ID,this.BalIndex-1)}if(this.BalIndex=D.length-1,this.ShowBudgetVariance){var w=null!=h?h.Clone():D[this.BalIndex].Clone();w.HeaderText=null!=h?w.HeaderText:"Variance",w.ID="VarianceBalance",w.DataFormat.NegativeNumber=0,D.push(w)}if(this.ShowBudgetVariancePercent){var R=null!=d?d.Clone():D[this.BalIndex].Clone();R.HeaderText=null!=d?R.HeaderText:"Variance %",R.DataFormat.PercentageOn="BudgetBalance",R.ID="PercentVarianceBalance",R.DataFormat.NegativeNumber=0,D.push(R)}if(this.ShowSalesPercentage){var g=D[this.BalIndex].Clone();g.HeaderText="Percentage",g.width>85&&(g.width=85),g.DataFormat.PercentageOn="Balance",g.ID="SalesPercentage",g.DataFormat.NegativeNumber=0,this.SalesPercentIndex=D.length-this.BalIndex,D.push(g)}}else if("YTD"==this.ViewModel.ColumnSource[m].ID){if(4!=this.NegNumber&&(D[D.length-1].DataFormat.NegativeNumber=this.NegNumber),this.ShowBudget){var x=null!=c?c.Clone():D[D.length-1].Clone();x.HeaderText=null!=c?"YTD "+x.HeaderText:"YTD Budget",x.ID="BudgetYTD",x.DataFormat.NegativeNumber=0,D.InsertAt(x,D.length-1)}if(this.YTDIndex=D.length-1,this.ShowBudgetVariance){var P=null!=h?h.Clone():D[this.YTDIndex].Clone();P.HeaderText=null!=h?"YTD "+P.HeaderText:"YTD Variance",P.ID="VarianceYTD",P.DataFormat.NegativeNumber=0,D.push(P)}if(this.ShowBudgetVariancePercent){var f=null!=d?d.Clone():D[this.YTDIndex].Clone();f.HeaderText=null!=d?"YTD "+f.HeaderText:"YTD Variance %",f.DataFormat.PercentageOn="BudgetYTD",f.ID="PercentVarianceYTD",f.DataFormat.NegativeNumber=0,D.push(f)}}else if("LastYearBalance"==this.ViewModel.ColumnSource[m].ID){if(4!=this.NegNumber&&(D[D.length-1].DataFormat.NegativeNumber=this.NegNumber),this.ShowBudget){var B=null!=c?c.Clone():D[D.length-1].Clone();B.HeaderText=null!=c?"LastYear "+B.HeaderText:"LastYear Budget",B.ID="BudgetLastYearBalance",B.DataFormat.NegativeNumber=0,D.InsertAt(B,D.length-1)}if(this.BAL_LYIndex=D.length-1,this.ShowBudgetVariance){var b=null!=h?h.Clone():D[this.BAL_LYIndex].Clone();b.HeaderText=null!=h?"LastYear "+b.HeaderText:"LastYear Variance",b.ID="VarianceLastYearBalance",b.DataFormat.NegativeNumber=0,D.push(b)}if(this.ShowBudgetVariancePercent){var M=null!=d?d.Clone():D[this.BAL_LYIndex].Clone();M.HeaderText=null!=d?"LastYear "+M.HeaderText:"LastYear Variance %",M.DataFormat.PercentageOn="BudgetLastYearBalance",M.ID="PercentVarianceLastYearBalance",M.DataFormat.NegativeNumber=0,D.push(M)}}else if("LastYearYTD"==this.ViewModel.ColumnSource[m].ID){if(4!=this.NegNumber&&(D[D.length-1].DataFormat.NegativeNumber=this.NegNumber),this.ShowBudget){var L=null!=c?c.Clone():D[D.length-1].Clone();L.HeaderText=null!=c?"LastYear YTD "+L.HeaderText:"LastYear YTD Budget",L.ID="BudgetLastYearYTD",L.DataFormat.NegativeNumber=0,D.InsertAt(L,D.length-1)}if(this.YTD_LYIndex=D.length-1,this.ShowBudgetVariance){var V=null!=h?h.Clone():D[this.YTD_LYIndex].Clone();V.HeaderText=null!=h?"LastYear YTD "+V.HeaderText:"LastYear YTD Variance",V.ID="VarianceLastYearYTD",V.DataFormat.NegativeNumber=0,D.push(V)}if(this.ShowBudgetVariancePercent){var F=null!=d?d.Clone():D[this.YTD_LYIndex].Clone();F.HeaderText=null!=d?"LastYear YTD "+F.HeaderText:"LastYear YTD Variance %",F.DataFormat.PercentageOn="BudgetLastYearYTD",F.ID="PercentVarianceLastYearYTD",F.DataFormat.NegativeNumber=0,D.push(F)}}if(this.frmBalance=D[this.BalIndex].DataFormat.Clone(),this.frmBalance.NegativeNumber=0,this.frmBudget=D[this.BalIndex].DataFormat.Clone(),this.frmBalance.NegativeNumber=0,this.AccNameIndex=this.BalIndex-1,this.ShowBudget&&this.AccNameIndex--,this.ShowTotalBudget&&this.AccNameIndex--,this.ReportFormat==T.Plain&&(this.ClubIncomeExpenseInPlainReport?this.GroupTotalIndex=this.ViewModel.ColumnSource.length:(this.GroupTotalIndex=this.ViewModel.ColumnSource.length+1,D.push(this.ViewModel.ColumnSource[this.BalIndex].Clone()))),this.GroupTotalsSeperate){var v=this.ViewModel.ColumnSource[this.BalIndex].Clone();v.HeaderText="TOTAL",D.InsertAt(v,this.BalIndex+1),-1!=this.YTDIndex&&this.YTDIndex++,-1!=this.BAL_LYIndex&&this.BAL_LYIndex++,-1!=this.YTD_LYIndex&&this.YTD_LYIndex++}if(this.ColumnSize=D.length,this.ReportFormat==T.Horizontal)for(var O=D.length,y=0;y<O;y++)D.push(D[y].Clone());if(this.ReportFormat==T.Plain&&!this.ClubIncomeExpenseInPlainReport){var N=D[this.BalIndex],Y=D[this.BalIndex+1];this.ShowIncomeFirst?7==this.ViewModel.StaticReportType?(N.HeaderText=o.a.GetResource("Reports_LblAssets").toUpperCase(),Y.HeaderText=o.a.GetResource("Reports_LblLiabilities").toUpperCase()):(N.HeaderText=o.a.GetResource("Reports_LblIncome").toUpperCase(),Y.HeaderText=o.a.GetResource("Reports_LblExpneses").toUpperCase()):7==this.ViewModel.StaticReportType?(N.HeaderText=o.a.GetResource("Reports_LblLiabilities").toUpperCase(),Y.HeaderText=o.a.GetResource("Reports_LblAssets").toUpperCase()):(N.HeaderText=o.a.GetResource("Reports_LblExpneses").toUpperCase(),Y.HeaderText=o.a.GetResource("Reports_LblIncome").toUpperCase())}if(this.Show==p.YearWise&&(this.HideTagWiseBudget=!0),this.Show==p.MonthWise||this.Show==p.YearWise||this.Show==p.QtrWise||this.Show==p.HalfYearWise){var _,G=this.dtYearStartMonth;_=this.Show==p.YearWise?G:new Date(this.ViewModel.oReportDialog.FromDate.Date.getFullYear(),this.ViewModel.oReportDialog.FromDate.Date.getMonth(),1);var E=1,W=this.Show==p.HalfYearWise?6:3,H="",k=!0,z=D[D.length-1];for(-1!=this.BalIndex&&(z=D[this.BalIndex]);_<=this.ViewModel.oReportDialog.ToDate.Date;){var K=z.Clone();if(this.Show==p.MonthWise)K.HeaderText=_.ToString("MMM yy"),K.ID=7==this.ViewModel.StaticReportType?"Y"+_.getFullYear()+"M"+_.iMonth().ToString("00"):"Y"+_.getFullYear()+"M"+_.iMonth(),this.YearSlots.push(K.ID,_);else if(this.Show==p.QtrWise||this.Show==p.HalfYearWise){if(k){for((_=new Date(this.ViewModel.FromDatePicker.Date.getFullYear(),this.AccountingFromMonth-1,1))>this.ViewModel.FromDatePicker.Date&&(_=_.AddYears(-1)),E=1;_.AddMonths(W)<=this.ViewModel.FromDatePicker.Date;)E++,_=_.AddMonths(W);H=1==this.AccountingFromMonth?_.getFullYear().toString():_.iMonth()>=this.AccountingFromMonth?_.getFullYear().toString()+"-"+((_.getFullYear()+1)%100).toString():(_.getFullYear()-1).toString()+"-"+(_.getFullYear()%100).toString()}else E++,(this.Show==p.QtrWise&&5==E||this.Show==p.HalfYearWise&&3==E)&&(E=1),H=1==this.AccountingFromMonth?_.getFullYear().toString():_.iMonth()>=this.AccountingFromMonth?_.getFullYear().toString()+"-"+((_.getFullYear()+1)%100).toString():(_.getFullYear()-1).toString()+"-"+(_.getFullYear()%100).toString();K.HeaderText=(this.Show==p.HalfYearWise?"H":"Q")+E+" "+H,K.ID="Y"+_.getFullYear()+"M"+_.iMonth(),this.YearSlots.push(K.ID,_),k=!1;var U=new C;U.dtStart=_,U.dtEnd=_.AddMonths(W).AddDays(-1),this.QtrSlot.push(K.ID,U)}else K.HeaderText=1!=G.iMonth()?G.getFullYear().toString()+"-"+(G.getFullYear()+1).toString():G.getFullYear().toString(),K.ID="Y"+_.getFullYear(),this.YearSlots.push(K.ID,G),G=G.AddYears(1);if(this.lstTags.push(K.ID),D.push(K),++this.CountMonths,this.ShowBudget&&!this.HideTagWiseBudget){var j=null!=c?c.Clone():K.Clone();j.HeaderText=(null!=c?j.HeaderText:"Budget")+"-"+K.HeaderText,j.ID=this.Show==p.MonthWise?"Budget"+_.ToString("MMMyyyy"):this.Show==p.QtrWise||this.Show==p.HalfYearWise?"Budget"+K.ID:"Budget"+_.ToString("yyyy"),j.DataFormat.NegativeNumber=0,D.InsertAt(j,D.length-1),++this.CountMonths}if(this.ShowBudgetVariance&&!this.HideTagWiseBudget){var Q=null!=h?h.Clone():K.Clone();Q.HeaderText=(null!=h?Q.HeaderText:"Variance")+"-"+K.HeaderText,Q.ID=this.Show==p.MonthWise?"Variance"+_.ToString("MMMyyyy"):this.Show==p.QtrWise||this.Show==p.HalfYearWise?"Variance"+K.ID:"Variance"+_.ToString("yyyy"),Q.DataFormat.NegativeNumber=0,D.push(Q),++this.CountMonths}if(this.ShowBudgetVariancePercent&&!this.HideTagWiseBudget){var X=null!=d?d.Clone():K.Clone();X.HeaderText=(null!=d?X.HeaderText:"Variance %")+"-"+K.HeaderText,X.ID=this.Show==p.MonthWise?"PercentVariance"+_.ToString("MMMyyyy"):this.Show==p.QtrWise||this.Show==p.HalfYearWise?"PercentVariance"+K.ID:"PercentVariance"+_.ToString("yyyy"),X.DataFormat.NegativeNumber=0,D.push(X),++this.CountMonths}if(this.ShowPrevMonthData||this.ShowPrevMonthDiffData||this.ShowPrevMonthVarPer){var J=K.Clone(),Z=_.AddYears(-1);if(this.Show==p.MonthWise)J.HeaderText=Z.ToString("MMM yy"),J.ID=7==this.ViewModel.StaticReportType?"Y"+Z.getFullYear()+"M"+Z.iMonth().ToString("00"):"Y"+Z.getFullYear()+"M"+Z.iMonth();else if(this.Show==p.QtrWise||this.Show==p.HalfYearWise){var q=_.AddYears(-1);H=1==this.AccountingFromMonth?q.getFullYear().toString():q.iMonth()>=this.AccountingFromMonth?q.getFullYear().toString()+"-"+((q.getFullYear()+1)%100).toString():(q.getFullYear()-1).toString()+"-"+(q.getFullYear()%100).toString(),J.HeaderText=(this.Show==p.HalfYearWise?"H":"Q")+E+" "+H,J.ID="Y"+q.getFullYear()+"M"+q.iMonth();var $=new C;$.dtStart=q,$.dtEnd=q.AddMonths(W).AddDays(-1),this.QtrSlot.push(J.ID,$)}else this.Show==p.YearWise&&(J.HeaderText=Z.ToString("yyyy"),J.ID="Y"+Z.getFullYear());this.lstPMTags.push(J.ID),J.HeaderAppearance.IsVisible=this.ShowPrevMonthData,D.push(J),++this.CountMonths}if(this.ShowPrevMonthDiffData){var tt=K.Clone();_.AddYears(-1),tt.HeaderText="Diff",this.Show==p.MonthWise?tt.ID=7==this.ViewModel.StaticReportType?"DIFF_Y"+_.getFullYear()+"M"+_.iMonth().ToString("00"):"DIFF_Y"+_.getFullYear()+"M"+_.iMonth():this.Show==p.QtrWise||this.Show==p.HalfYearWise?tt.ID="DIFF_Y"+_.getFullYear()+"M"+_.iMonth():this.Show==p.YearWise&&(tt.ID="DIFF_Y"+_.getFullYear()),D.push(tt),++this.CountMonths}if(this.ShowPrevMonthVarPer){var et=K.Clone();_.AddYears(-1),et.HeaderText="Variance %",et.DataFormat.PercentageOn="DIFF",this.Show==p.MonthWise?et.ID=7==this.ViewModel.StaticReportType?"VARPER_Y"+_.getFullYear()+"M"+_.iMonth().ToString("00"):"VARPER_Y"+_.getFullYear()+"M"+_.iMonth():this.Show==p.QtrWise||this.Show==p.HalfYearWise?et.ID="VARPER_Y"+_.getFullYear()+"M"+_.iMonth():this.Show==p.YearWise&&(et.ID="VARPER_Y"+_.getFullYear()),D.push(et),++this.CountMonths}if(this.ShowSalesPerMonthly){var st=K.Clone();st.HeaderText="Percentage",st.DataFormat.PercentageOn="Balance",st.width>85&&(st.width=85),st.ID=this.Show==p.MonthWise?"SalesPercentage_Y"+_.getFullYear()+"M"+_.iMonth():this.Show==p.QtrWise||this.Show==p.HalfYearWise?"SalesPercentage_"+K.ID:"SalesPercentage_Y"+_.ToString("yyyy"),st.DataFormat.NegativeNumber=0,D.push(st),++this.CountMonths}_=this.Show==p.MonthWise?_.AddMonths(1):this.Show==p.QtrWise||this.Show==p.HalfYearWise?_.AddMonths(W):_.AddYears(1)}}else if(this.Show==p.TagWise){var ot=D[D.length-1];-1!=this.BalIndex&&(ot=D[this.BalIndex]);var it=this.GetTagWiseQuery(this.TagID,this.TagColumnName,"Name");o.a.report.DataSet("RPT022",it).Tables[0].forEach((function(e){var s=ot.Clone();if(s.HeaderText=e.Name.toString(),s.ID=e.NodeID.toString(),t.lstTagColumns.push(s.ID),D.push(s),++t.CountMonths,t.ShowBudget&&!t.HideTagWiseBudget){var o=null!=c?c.Clone():s.Clone();o.HeaderText=(null!=c?o.HeaderText:"Budget")+"-"+s.HeaderText,o.ID="Budget"+s.ID,o.DataFormat.NegativeNumber=0,D.InsertAt(o,D.length-1),++t.CountMonths}if(t.ShowBudgetVariance&&!t.HideTagWiseBudget){var i=null!=h?h.Clone():s.Clone();i.HeaderText=(null!=h?i.HeaderText:"Variance")+"-"+s.HeaderText,i.ID="Variance"+s.ID,i.DataFormat.NegativeNumber=0,D.push(i),++t.CountMonths}if(t.ShowBudgetVariancePercent&&!t.HideTagWiseBudget){var l=null!=d?d.Clone():s.Clone();l.HeaderText=(null!=d?l.HeaderText:"Variance %")+"-"+s.HeaderText,l.ID="PercentVariance"+s.ID,l.DataFormat.NegativeNumber=0,D.push(l),++t.CountMonths}if(t.ShowSalesPerMonthly){var a=s.Clone();a.HeaderText="Percentage",a.DataFormat.PercentageOn="Balance",a.width>85&&(a.width=85),a.ID="SalesPercentage_"+s.ID,a.DataFormat.NegativeNumber=0,D.push(a),++t.CountMonths}t.lstTags.push(s.ID)}))}this.ViewModel.ReportColumns=D,this.oColumns=this.ViewModel.ReportColumns,this.IsIncomeNegative=7!=this.ViewModel.StaticReportType,this.LocationWhere="",this.ViewModel.oReportDialog.Locations.Visible&&null!=this.ViewModel.oReportDialog.LocationWhere&&(this.LocationWhere=i.e.IsEmpty(this.ViewModel.oReportDialog.LocationWhere)?" AND 1<>1":" AND DCC.dcCCNID2 IN ("+this.ViewModel.oReportDialog.LocationWhere+")"),this.dsList.Clear(),this.dsBudget=null,this.ViewModel.oReportDialog.Locations.Visible&&null!=this.ViewModel.oReportDialog.LocationWhere&&i.e.IsEmpty(this.ViewModel.oReportDialog.LocationWhere),7==this.ViewModel.StaticReportType&&Object(l.j)(o.a.SessionManager.Preferences.OpenCompany)||this.Show==p.TagWise&&(this.IncludeOpeningStock||this.IncludeClosingStock)&&(this.IncludeOpeningStock&&this.SetStockBalance(!0),this.IncludeClosingStock&&this.SetStockBalance(!1)),8!=this.ViewModel.StaticReportType?(this.ReportRowStartIndex=-1,this.SetDataSet(this.ViewModel.StaticReportType).then((function(e){t.ReportFormat==T.Plain?t.LoadPlainReport():t.LoadHorizontalVerticalReports(),t.LoadReportComplete()}))):(this.ReportRowStartIndex=-1,this.SetDataSet(5).then((function(e){t.LoadHorizontalVerticalReports(),t.Olddbl=t.dbl,t.OldReportTotalMonthWise=t.ReportTotalMonthWise,t.CellStartPos=0,t.ReportRowStartIndex=t.GrdRow,t.ReportTotal[0]=t.ReportTotal[1]=0,t.GrossRows[0]=null,t.GrossRows[1]=null,t.ShowIncomeFirst=!(!t.ViewModel.Preferences.ContainsKey("ShowFirst2")||"Income"!=t.ViewModel.Preferences.ShowFirst2),t.SetDataSet(8).then((function(e){t.LoadHorizontalVerticalReports(),t.LoadReportComplete()}))})))}}},{key:"LoadReportComplete",value:function(){console.log(this.TempData);for(var t=0;t<this.TempData.length;t++){var e=this.TempData[t];e.Visible&&(this.ReportFormat==T.Horizontal&&(e.Parent=null),this.ViewModel.addRow(e))}this.ViewModel.process_RunWorkerCompleted()}},{key:"SetDataSet",value:function(t){var e,s,a=this,n="",d="",c="",u="",C="",I="",D=new Array;if(5==t?(c="4,8",u="5,9",this.IncomeAccounts.push(4),this.IncomeAccounts.push(8),D.push(5),D.push(9)):6==t?(c="4,8,11",u="5,9,12",n=",A.PL IsSummary",",A.PL",this.IncomeAccounts.push(4),this.IncomeAccounts.push(8),this.IncomeAccounts.push(11),D.push(5),D.push(9),D.push(12)):7==t?(c="1,2,7,10,13,15",u="3,6,14,16",n=",A.BS IsSummary",",A.BS",this.IncomeAccounts.push(15),this.IncomeAccounts.push(13),this.IncomeAccounts.push(1),this.IncomeAccounts.push(2),this.IncomeAccounts.push(7),D.push(3),D.push(6),D.push(14),D.push(16)):8==t&&(c="11",u="12",this.IncomeAccounts.push(11),D.push(12)),this.ViewModel.Preferences.ContainsKey("AccountTypesFilter")&&this.ViewModel.Preferences.AccountTypesFilter.length>0){for(var m=this.ViewModel.Preferences.AccountTypesFilter.split(","),S=this.IncomeAccounts.length-1;S>=0;S--)m.Contains(this.IncomeAccounts[S].toString())||this.IncomeAccounts.RemoveAt(S);for(var A=D.length-1;A>=0;A--)m.Contains(D[A].toString())||D.RemoveAt(A);this.IncomeAccounts.forEach((function(t){d.length>0&&(d+=","),d+=t.toString()})),D.forEach((function(t){d.length>0&&(d+=","),d+=t.toString()}))}else d=c+","+u;if(8==this.ViewModel.StaticReportType&&(n=",A.PLT IsSummary",",A.PLT"),this.exchRate=0,this.ForeignCurrencyID>0)e="AmountFC",s=" AND ACC.CurrencyID="+this.ForeignCurrencyID;else if(e=1==this.CurrencyType?"AmountBC":"Amount",s="",this.ViewModel.Preferences.ContainsKey("FCWithExchRate")){var w=new i.f;w.LoadXml("<XML>"+this.ViewModel.Preferences.FCWithExchRate+"</XML>");var R=i.f.SelectSingleNode(w.DocumentElement,"IsChecked");null!=R&&"1"==R.innerHTML&&(this.exchRate=i.e.Double(i.f.SelectSingleNodeText(w.DocumentElement,"TextValue")),this.exchRate<=0&&(this.exchRate=1),e="Amount/"+this.exchRate.toString())}var g=!1,x="",P="",f=this.ViewModel.oReportDialog.GetSeqNosListWithRoots();this.ViewModel.oReportDialog.IsZeroSelected||this.ViewModel.oReportDialog.IsOneSelected||(this.ViewModel.oReportDialog.IsGroupExists?(P="A.AccountID=GTP.GTID",x=f.Contains(",")?",(select T.AccountID GTID from ACC_Accounts T with(nolock),ACC_Accounts GT1 with(nolock) where T.lft BETWEEN GT1.lft AND GT1.rgt AND GT1.AccountID IN ("+f+") group by T.AccountID\nunion select T.AccountID GTID from ACC_Accounts T with(nolock) where T.IsGroup=1) AS GTP ":",(select T.AccountID GTID from ACC_Accounts T with(nolock),ACC_Accounts GT1 with(nolock) where T.lft BETWEEN GT1.lft AND GT1.rgt AND GT1.AccountID="+f+" group by T.AccountID\nunion select T.AccountID GTID from ACC_Accounts T with(nolock) where T.IsGroup=1) AS GTP ",g=!0):P=f.Contains(",")?"A.AccountID IN ("+f+")":"A.AccountID="+f),7==t&&o.a.SessionManager.Preferences.ContainsKey("ControlAccDimension")&&o.a.SessionManager.Preferences.ContainsKey("IsControlAccounts")&&"TRUE"==o.a.SessionManager.Preferences.IsControlAccounts.toUpperCase()&&(this.CADimension=parseInt(o.a.SessionManager.Preferences.ControlAccDimension));var B="",b="",M="",L=this.GetDimensionFilter("DCC.dcCCNID");(this.LocationWhere.length>0||this.Show==p.TagWise||L.length>0||this.CADimension>0)&&(b=" INNER JOIN COM_DocCCData DCC WITH(NOLOCK) ON DCC.AccDocDetailsID=ACC.AccDocDetailsID "+this.LocationWhere+L,M=" INNER JOIN COM_DocCCData DCC WITH(NOLOCK) ON DCC.InvDocDetailsID=ACC.InvDocDetailsID "+this.LocationWhere+L);var V="",F="",v="",O="",y="";this.Show==p.MonthWise?(V=",Mn",F=",CONVERT(DATETIME,DocDate) DocDate",y=",1 DocDate",v=7==this.ViewModel.StaticReportType?",'Y'+CONVERT(NVARCHAR,YEAR(DocDate))+'M'+(case when Month(DocDate)<10 then '0' else '' end)+ CONVERT(NVARCHAR,Month(DocDate)) Mn":",'Y'+CONVERT(NVARCHAR,YEAR(DocDate))+'M'+ CONVERT(NVARCHAR,Month(DocDate)) Mn",O=",YEAR(DocDate), MONTH(DocDate)"):this.Show==p.QtrWise||this.Show==p.HalfYearWise?(V=",Mn",F=",CONVERT(DATETIME,DocDate) DocDate",y=",1 DocDate",v=",CONVERT(NVARCHAR,YEAR(DocDate))+'-'+ CONVERT(NVARCHAR,Month(DocDate)) Mn",O=",YEAR(DocDate), MONTH(DocDate)"):this.Show==p.YearWise?1==this.AccountingFromMonth?(V=",Mn",F=",CONVERT(DATETIME,DocDate) DocDate",y=",1 DocDate",v=",'Y'+CONVERT(NVARCHAR,YEAR(DocDate)) Mn",O=",YEAR(DocDate)"):(V=",Mn",F=",CONVERT(DATETIME,DocDate) DocDate",y=",1 DocDate",v=7==t?",case when MONTH(DocDate)<4 and YEAR(DocDate)!=1900 then YEAR(DocDate)-1 else YEAR(DocDate) end Mn":",case when MONTH(DocDate)<4 then YEAR(DocDate)-1 else YEAR(DocDate) end Mn",O=",YEAR(DocDate),MONTH(DocDate)"):this.Show==p.TagWise&&(V=",TagID Mn",y=F=",DCC.dcCCNID"+(this.TagID-5e4)+" TagID",v=",TagID",O=",TagID"),this.CADimension>0&&(V+=",CADID,A1CC.CCNID"+(this.CADimension-5e4)+" CAD",F+=",DCC.dcCCNID"+(this.CADimension-5e4)+" CADID",y+=",DCC.dcCCNID"+(this.CADimension-5e4)+" CADID",v+=",CADID",O+=",CADID"),I="";var N="";0==this.UnPostedDocsList.length?N=" AND (ACC.StatusID=369 or ACC.StatusID=429)":N+=" AND ACC.StatusID IN (369,429,"+this.UnPostedDocsList+")";var Y="(ACC.StatusID=370 OR ACC.StatusID=439"+(this.IncludeTerminatedPDC?" OR ACC.StatusID=452":"")+(this.IncludeUnApprovedPDC?" OR ACC.StatusID=371 OR ACC.StatusID=441":"")+")";if(this.PDCInclude?(C=" AND ACC.DocumentType<>16 AND ("+Y+" OR (ACC.DocumentType<>14 AND ACC.DocumentType<>19"+N+"))",I+=" AND ("+Y+" OR (ACC.DocumentType<>14 AND ACC.DocumentType<>19"+N+"))"):(C=" AND ACC.DocumentType NOT IN (16,14,19)"+N,I+=" AND ACC.DocumentType<>14 AND ACC.DocumentType<>19"+N),7==t)B+="\nSELECT A.AccountCode,A.AccountName,ACC.Balance"+V+",ACC.OpDocBalance,A.AccountID,A.IsGroup,A.lft,A.rgt,A.AccountTypeID,A.Depth,A.BS IsSummary"+this.ViewModel.SelectTag,this.IsAccountWise&&(B+=",A.ParentID"),B+="\nFROM (",this.Show==p.YearWise&&1!=this.AccountingFromMonth&&(B+="select AccountID,'Y'+convert(nvarchar,Mn) Mn,sum(Balance) Balance,sum(OpDocBalance) OpDocBalance from ("),B+="\nSELECT T1.AccountID"+v.Replace(",CADID",",case when CA.AccountTypeID=6 or CA.AccountTypeID=7 then CADID else 1 end CADID")+",SUM(OP_Dr)+SUM(TR_Dr)-(SUM(OP_Cr)+SUM(TR_Cr)) Balance,SUM(OpDocDr)-SUM(OpDocCr) OpDocBalance\nFROM (",B+="\n--Opening Dr\nSELECT DebitAccount AccountID"+y+",ACC."+e+" OP_Dr,0 OP_Cr,0 TR_Dr,0 TR_Cr,case when ACC.DocumentType=16 then ACC."+e+" else 0 end OpDocDr,0 OpDocCr\nFROM ACC_DocDetails ACC WITH(NOLOCK)"+b+"\nWHERE (DocDate<@From OR (ACC.DocumentType=16"+N+")) "+I+s+"\nUNION ALL--Opening Cr\nSELECT CreditAccount AccountID"+y+",0 OP_Dr,ACC."+e+" OP_Cr,0 TR_Dr, 0 TR_Cr,0 OpDocDr,case when ACC.DocumentType=16 then ACC."+e+" else 0 end OpDocCr\nFROM ACC_DocDetails ACC WITH(NOLOCK)"+b+"\nWHERE (DocDate<@From OR (ACC.DocumentType=16"+N+"))  "+I+s+"\nUNION ALL--Transaction Dr\nSELECT DebitAccount AccountID"+F+",0 OP_Dr,0 OP_Cr,"+e+" TR_Dr,0 TR_Cr,0 OpDocDr,0 OpDocCr\nFROM ACC_DocDetails ACC WITH(NOLOCK)"+b+"\nWHERE (DocDate BETWEEN @From AND @To)"+C+s+"\nUNION ALL--Transaction Cr\nSELECT CreditAccount AccountID"+F+",0 OP_Dr,0 OP_Cr,0 TR_Dr,"+e+" TR_Cr,0 OpDocDr,0 OpDocCr\nFROM ACC_DocDetails ACC  WITH(NOLOCK)"+b+"\nWHERE (DocDate BETWEEN @From AND @To)"+C+s,M.length>0&&(B+="\n--INEVENTORY DATA\nUNION ALL--Opening Dr\nSELECT DebitAccount AccountID"+y+",ACC."+e+" OP_Dr,0 OP_Cr,0 TR_Dr,0 TR_Cr,0 OpDocDr,0 OpDocCr\nFROM ACC_DocDetails ACC WITH(NOLOCK)"+M+"\nWHERE (DocDate<@From OR (ACC.DocumentType=16"+N+")) "+I+s+"\nUNION ALL--Opening Cr\nSELECT CreditAccount AccountID"+y+",0 OP_Dr,ACC."+e+" OP_Cr,0 TR_Dr, 0 TR_Cr,0 OpDocDr,0 OpDocCr\nFROM ACC_DocDetails ACC WITH(NOLOCK)"+M+"\nWHERE (DocDate<@From OR (ACC.DocumentType=16"+N+")) "+I+s+"\nUNION ALL--Transaction Dr\nSELECT DebitAccount AccountID"+F+",0 OP_Dr,0 OP_Cr,"+e+" TR_Dr,0 TR_Cr,0 OpDocDr,0 OpDocCr\nFROM ACC_DocDetails ACC WITH(NOLOCK)"+M+"\nWHERE (DocDate BETWEEN @From AND @To)"+C+s+"\nUNION ALL--Transaction Cr\nSELECT CreditAccount AccountID"+F+",0 OP_Dr,0 OP_Cr,0 TR_Dr,"+e+" TR_Cr,0 OpDocDr,0 OpDocCr\nFROM ACC_DocDetails ACC  WITH(NOLOCK)"+M+"\nWHERE (DocDate BETWEEN @From AND @To)"+C+s);else{var _="";this.PDCInclude&&(_=" OR (DocDate<=@To AND (ACC.DocumentType=14 OR ACC.DocumentType=19) AND "+Y+")",C=" AND ACC.DocumentType NOT IN (16,14,19) "+N),B+="\nSELECT distinct A.AccountCode,A.AccountName,ACC.Balance"+V+",A.AccountID,A.IsGroup,A.lft,A.rgt,A.AccountTypeID,A.Depth"+n+this.ViewModel.SelectTag,this.IsAccountWise&&(B+=",A.ParentID"),B+="\nFROM (",this.Show==p.YearWise&&1!=this.AccountingFromMonth&&(B+="select AccountID,'Y'+convert(nvarchar,Mn) Mn,sum(Balance) Balance from ("),B+="\nSELECT AccountID"+v+",SUM(TR_Dr)-SUM(TR_Cr) Balance\nFROM (",B+="\n--Transaction Dr\nSELECT DebitAccount AccountID"+F+",ACC."+e+" TR_Dr,0 TR_Cr\nFROM ACC_DocDetails ACC WITH(NOLOCK)"+b+"\nWHERE (((DocDate BETWEEN @From AND @To)"+C+")"+_+")"+s+"\nUNION ALL--Transaction Cr\nSELECT CreditAccount AccountID"+F+",0 TR_Dr,ACC."+e+" TR_Cr\nFROM ACC_DocDetails ACC WITH(NOLOCK)"+b+"\nWHERE (((DocDate BETWEEN @From AND @To)"+C+")"+_+")"+s,M.length>0&&(B+="\n--INEVENTORY DATA\nUNION ALL--Transaction Dr\nSELECT DebitAccount AccountID"+F+",ACC."+e+" TR_Dr,0 TR_Cr\nFROM ACC_DocDetails ACC WITH(NOLOCK)"+M+"\nWHERE (DocDate BETWEEN @From AND @To)"+C+s+"\nUNION ALL--Transaction Cr\nSELECT CreditAccount AccountID"+F+",0 TR_Dr,ACC."+e+" TR_Cr\nFROM ACC_DocDetails ACC  WITH(NOLOCK)"+M+"\nWHERE (DocDate BETWEEN @From AND @To)"+C+s)}B+=") AS T1 ",this.CADimension>0&&(B+=" JOIN ACC_Accounts CA WITH(NOLOCK) ON CA.AccountID=T1.AccountID "),B+=" GROUP BY T1.AccountID"+O.Replace(",CADID",",case when CA.AccountTypeID=6 or CA.AccountTypeID=7 then CADID else 1 end"),this.CADimension>0&&(B+=",CA.AccountTypeID"),this.Show==p.YearWise&&1!=this.AccountingFromMonth&&(B+=") AS T1 GROUP BY AccountID,Mn"+(this.CADimension>0?"CADID":"")),B+="\n) AS ACC RIGHT JOIN ACC_Accounts A WITH(NOLOCK) ON A.AccountID=ACC.AccountID",this.HideZeroBudgetAccounts&&this.CurrentBudgetID>0&&(this.ShowBudget||this.ShowBudgetVariance)&&(B+=" inner join (SELECT AccountID FROM COM_BudgetAlloc with(nolock) WHERE BudgetDefID="+this.CurrentBudgetID+" GROUP BY AccountID) as T on T.AccountID=A.AccountID"),B+=this.ViewModel.FromTag,B+=x,this.CADimension>0&&(B+=" left JOIN COM_CCCCDATA A1CC WITH(NOLOCK) ON A1CC.CostCenterID=2 and A1CC.NodeID=A.AccountID"),B+="\nWHERE A.AccountID>1",B+=this.GetAccountWiseLocationWhere("A"),B+=this.ViewModel.HideCostCenterTree?" AND A.AccountTypeID IN ("+d+")":P.length>0?this.IsAccountWise||g?" AND ("+P+(this.CADimension>0?" or A1CC.CCNID40>1":"")+")":" AND (A.IsGroup=1 or ("+P+")"+(this.CADimension>0?" or A1CC.CCNID40>1":"")+")":" AND A.AccountTypeID IN ("+d+")",this.IsAccountWise?(B+=" AND A.IsGroup=0",B+="Code"==this.ViewModel.Preferences.TreeSortOn?" Order By AccountCode":"TreeOrder"==this.ViewModel.Preferences.TreeSortOn?" Order By lft":" Order By AccountName"):B+=" Order By lft",7!=this.ViewModel.StaticReportType||this.Show!=p.YearWise&&this.Show!=p.MonthWise||(B+=",Mn");var G="";G+="DECLARE @From FLOAT,@To FLOAT\nSET @From=CONVERT(FLOAT,CONVERT(DATETIME,'"+this.ViewModel.oReportDialog.FromDate.Date.ToString("dd MMM yyyy")+"'))\nSET @To=CONVERT(FLOAT,CONVERT(DATETIME,'"+this.ViewModel.oReportDialog.ToDate.Date.ToString("dd MMM yyyy")+"'))\n",G+=B,this.IsAccountWise&&(G+=" select AccountID,AccountCode,AccountName,AccountTypeID"+n+",lft,Depth,ParentID from acc_accounts A with(nolock) where IsGroup=1 Order By Depth");var E=new r.a;if(E.push("dsNew",o.a.report.ReportDataSetAsync("RPT022",this.ViewModel.IsReportDB,G)),(this.ShowPrevMonthData||this.ShowPrevMonthDiffData||this.ShowPrevMonthVarPer)&&E.push("dtPrevMonth",o.a.report.ReportDataSetAsync("RPT022",this.ViewModel.IsReportDB,"DECLARE @From FLOAT,@To FLOAT\nSET @From=CONVERT(FLOAT,CONVERT(DATETIME,'"+this.ViewModel.oReportDialog.FromDate.Date.AddYears(-1).ToString("dd MMM yyyy")+"'))\nSET @To=CONVERT(FLOAT,CONVERT(DATETIME,'"+this.ViewModel.oReportDialog.ToDate.Date.AddYears(-1).ToString("dd MMM yyyy")+"'))\n"+B)),-1!=this.YTDIndex&&E.push("dvYTDTable",o.a.report.ReportDataTable("RPT022",this.ViewModel.IsReportDB,"DECLARE @From FLOAT,@To FLOAT\nSET @From=CONVERT(FLOAT,CONVERT(DATETIME,'"+this.dtYearStartMonth.ToString("dd MMM yyyy")+"'))\nSET @To=CONVERT(FLOAT,CONVERT(DATETIME,'"+this.ViewModel.oReportDialog.ToDate.Date.ToString("dd MMM yyyy")+"'))\n"+B)),-1!=this.BAL_LYIndex&&E.push("dvBAL_LYTable",o.a.report.ReportDataTable("RPT022",this.ViewModel.IsReportDB,"DECLARE @From FLOAT,@To FLOAT\nSET @From=CONVERT(FLOAT,CONVERT(DATETIME,'"+this.ViewModel.oReportDialog.FromDate.Date.AddYears(-1).ToString("dd MMM yyyy")+"'))\nSET @To=CONVERT(FLOAT,CONVERT(DATETIME,'"+this.ViewModel.oReportDialog.ToDate.Date.AddYears(-1).ToString("dd MMM yyyy")+"'))\n"+B)),-1!=this.YTD_LYIndex&&E.push("dvYTD_LYTable",o.a.report.ReportDataTable("RPT022",this.ViewModel.IsReportDB,"DECLARE @From FLOAT,@To FLOAT\nSET @From=CONVERT(FLOAT,CONVERT(DATETIME,'"+this.dtYearStartMonth.AddYears(-1).ToString("dd MMM yyyy")+"'))\nSET @To=CONVERT(FLOAT,CONVERT(DATETIME,'"+this.ViewModel.oReportDialog.ToDate.Date.AddYears(-1).ToString("dd MMM yyyy")+"'))\n"+B)),this.dsOpenCompany=null,this.dblDrOpBalDiff=0,7==t&&Object(l.j)(o.a.SessionManager.Preferences.OpenCompany)){var W="";this.YearSlots.length>0&&(W+="<XML>",this.YearSlots.keys.forEach((function(t){W+='<Row ID="'+t+'" EndDate="'+a.YearSlots[t].ToString("dd MMM yyyy")+'" />'})),W+="</XML>"),E.push("dsOpenCompany",o.a.report.GetOpenCompanyData(7,this.ViewModel.oReportDialog.FromDate.Date,this.ViewModel.oReportDialog.ToDate.Date,this.TagID,this.LocationWhere+L,!1,this.UnPostedDocsList,this.PDCInclude,this.IncludeTerminatedPDC,W.toString(),this.CurrencyType,this.ForeignCurrencyID,this.exchRate,this.ViewModel.IsReportDB))}return Promise.all(E.values).then((function(e){var s,n,r;(a.dsNew=e[0],a.dsList.push(a.dsNew),a.dv=a.dsNew.Tables[0],a.dvTable=a.dsNew.Tables[0],a.dvColumns=a.dsNew.Columns[0],a.CADimension>0&&a.RefreshCAD(a.dsNew.Tables[0]),!a.ShowSalesPercentage||5!=t&&6!=t)||(r=a.dsNew.Tables[0].filter(5==t?function(t){return 4==t.AccountTypeID||8==t.AccountTypeID}:function(t){return 4==t.AccountTypeID||8==t.AccountTypeID||11==t.AccountTypeID}),null!=(n=r.Compute("sum","Balance"))&&(a.dblTotalSales=-parseFloat(n)),a.ShowSalesPerMonthly&&a.lstTags.forEach((function(t){if(a.Show==p.QtrWise){var e=new Date(parseInt(t.substr(1,4)),parseInt(t.substr(6))-1,1),s=[e.ToString("yyyy-M"),e.AddMonths(1).ToString("yyyy-M"),e.AddMonths(2).ToString("yyyy-M")];n=r.filter((function(t){return s.Contains(t.Mn)})).Compute("sum","Balance")}else if(a.Show==p.HalfYearWise){var o=new Date(parseInt(t.substr(1,4)),parseInt(t.substr(6))-1,1),i=[o.ToString("yyyy-M"),o.AddMonths(1).ToString("yyyy-M"),o.AddMonths(2).ToString("yyyy-M"),o.AddMonths(3).ToString("yyyy-M"),o.AddMonths(4).ToString("yyyy-M"),o.AddMonths(5).ToString("yyyy-M")];n=r.filter((function(t){return i.Contains(t.Mn)})).Compute("sum","Balance")}else n=r.filter((function(e){return e.Mn==t})).Compute("sum","Balance");if(null!=n){var l=-parseFloat(n);l>0&&a.lstTagSalesTotal.push(t,l)}})));if(E.ContainsKey("dtPrevMonth")){s=E.keys.indexOf("dtPrevMonth");for(var d=e[s].Tables[0],C=function(t){var o=d[t];if(null==o.Mn)return"continue";for(var i={},l=0;l<e[s].Columns[0].length;l++)i[e[s].Columns[0][l]]=o[e[s].Columns[0][l]];var n=a.dsNew.Tables[0].filter((function(t){return t.AccountID==o.AccountID}));n.length>0?a.dsNew.Tables[0].InsertAt(i,a.dsNew.Tables[0].indexOf(n[0])):(a.dsNew.Tables[0].push(i),d.Columns.Contains("lft"))},I=0;I<d.length;I++)C(I)}if(E.ContainsKey("dvYTDTable")&&(s=E.keys.indexOf("dvYTDTable"),a.dvYTDTable=e[s].Tables[0],a.dsNew.Columns[0].push("YTD")),E.ContainsKey("dvBAL_LYTable")&&(s=E.keys.indexOf("dvBAL_LYTable"),a.dvBAL_LYTable=e[s].Tables[0],a.dsNew.Columns[0].push("LastYearBalance")),E.ContainsKey("dvYTD_LYTable")&&(s=E.keys.indexOf("dvYTD_LYTable"),a.dvYTD_LYTable=e[s].Tables[0],a.dsNew.Columns[0].push("LastYearYTD")),a.SetBudgetDataSet(x,P),7==a.ViewModel.StaticReportType){a.dblOpeningBalanceDifference=0;var D=a.dsNew.Tables[0].Compute("sum","OpDocBalance");null!=D&&(a.dblOpeningBalanceDifference=-parseFloat(D)),a.lstTagsOpeningBalance.Clear(),a.Show==p.TagWise&&a.lstTagColumns.forEach((function(t){a.dblTemp=0,null!=(D=a.dsNew.Tables[0].filter((function(e){return e.Mn==t})).Compute("sum","OpDocBalance"))&&(a.dblTemp=-parseFloat(D)),0!=a.dblTemp&&a.lstTagsOpeningBalance.push(t,a.dblTemp)}))}if(E.ContainsKey("dsOpenCompany")){s=E.keys.indexOf("dsOpenCompany"),a.dsOpenCompany=e[s],a.dsOpenCompany.Tables[0].forEach((function(t){t.Dr=-parseFloat(t.Dr),t.Cr=-parseFloat(t.Cr)})),a.dsOpenCompany.Tables[1].length>0&&(a.FirstAccountID=null!=a.dsOpenCompany.Tables[1][0].FirstAccount?parseInt(a.dsOpenCompany.Tables[1][0].FirstAccount):0,null!=a.dsOpenCompany.Tables[1][0].PreviousYearEndDate&&new Date(a.dsOpenCompany.Tables[1][0].PreviousYearEndDate)>=a.ViewModel.oReportDialog.ToDate.Date&&(a.LastAccountID=parseInt(a.dsOpenCompany.Tables[1][0].LastAccount)));if(a.ViewModel.oReportDialog.Locations.Visible&&null!=a.ViewModel.oReportDialog.LocationWhere&&(i.e.IsEmpty(a.ViewModel.oReportDialog.LocationWhere)?"-1":a.ViewModel.oReportDialog.LocationWhere),a.IncludeOpeningStock||a.IncludeClosingStock)if(a.Show==p.TagWise)a.IncludeOpeningStock&&a.SetStockBalance(!0),a.IncludeClosingStock&&a.SetStockBalance(!1);else if(0==a.dsOpenCompany.Tables[2].length);else{a.dblTemp=0,a.dsOpenCompany.Tables[2].Columns.push("OpStock"),a.dsOpenCompany.Tables[2].Columns.push("ClStock"),a.dsOpenCompany.Tables[2].Columns.push("DiffStock");for(var m=0;m<a.dsOpenCompany.Tables[2].length;m++);a.dblOpeningStock=a.dblTemp}a.dblAccountsDrOpBalDiff=0,a.dblAccountsCrOpBalDiff=0;var S=new Array;if(a.YearSlots.length>0){for(var A=a.dsOpenCompany.Tables[0].length-1;A>0;A--)a.dsOpenCompany.Tables[0][A].Dr=parseFloat(a.dsOpenCompany.Tables[0][A].Dr)-parseFloat(a.dsOpenCompany.Tables[0][A-1].Dr),a.dsOpenCompany.Tables[0][A].Cr=parseFloat(a.dsOpenCompany.Tables[0][A].Cr)-parseFloat(a.dsOpenCompany.Tables[0][A-1].Cr);for(var w=function(t){var e=a.dsOpenCompany.Tables[0][t];if(a.dv=a.dvTable.filter((function(t){return t.AccountID==e.AccountID})),a.dv.length>0){var s=0,o=null;for(s=0;s<a.dv.length;s++){if(null==a.dv[s].Mn||i.e.String(e.Mn)==i.e.String(a.dv[s].Mn)){o=a.dv[s];break}if(a.Show==p.MonthWise){var l=i.e.String(e.Mn).split("M"),n=new Date(parseInt(l[0].substr(1,4)),parseInt(l[1])-1,1);if(l=i.e.String(a.dv[s].Mn).split("M"),n<new Date(parseInt(l[0].substr(1,4)),parseInt(l[1])-1,1)){o=a.dv[s];break}}else if(a.Show==p.YearWise&&parseFloat(e.Mn.toString().substr(1,4))<parseFloat(a.dv[s].Mn.toString().substr(1,4))){o=a.dv[s];break}}if(null!=o&&i.e.String(e.Mn)==i.e.String(o.Mn));else{for(var r={},h=0;h<a.dvColumns.length;h++)r[a.dvColumns[h]]=a.dv[0][a.dvColumns[h]];if(r.Mn=i.e.String(e.Mn),r.Balance=0,null!=o){var d=a.dvTable.indexOf(o);a.dvTable.InsertAt(r,d),null==o.Mn&&a.dvTable.Remove(o)}else{var c=a.dvTable.indexOf(a.dv[a.dv.length-1]);a.dvTable.InsertAt(r,c+1)}o=r}a.dbl=i.e.Double(o.Balance),i.e.String(e.Mn)==a.oColumns[a.CellStartPos+a.ColumnSize].ID&&(a.dblAccountsDrOpBalDiff=parseFloat(e.Dr),a.dblAccountsCrOpBalDiff=parseFloat(e.Cr)),a.dbl=a.dbl+parseFloat(e.Dr)-parseFloat(e.Cr),o.Balance=a.dbl,S.Contains(o)||S.push(o)}},R=0;R<a.dsOpenCompany.Tables[0].length;R++)w(R)}else a.dsOpenCompany.Tables[0].forEach((function(t){if(a.Show==p.TagWise){if(a.dv=a.dvTable.filter((function(e){return e.AccountID==t.AccountID&&e.Mn==t.TagID})),0==a.dv.length){if(a.dv=a.dvTable.filter((function(e){return e.AccountID==t.AccountID&&Object(h.isNullOrUndefined)(e.Mn)})),a.dv.length>0)a.dv[0].Mn=t.TagID;else{a.dv=a.dvTable.filter((function(e){return e.AccountID==t.AccountID}));for(var e={},s=0;s<a.dvColumns.length;s++)e[a.dvColumns[s]]=a.dv[0][a.dvColumns[s]];e.Mn=t.TagID,e.Balance=null,a.dvTable.InsertAt(e,a.dvTable.indexOf(a.dv[0]))}a.dv=a.dvTable.filter((function(e){return e.AccountID==t.AccountID&&e.Mn==t.TagID}))}}else a.dv=a.dvTable.filter((function(e){return e.AccountID==t.AccountID}));if(a.dv.length>0){if(a.dbl=i.e.Double(a.dv[0].Balance),a.dblAccountsDrOpBalDiff+=parseFloat(t.Dr),a.dblAccountsCrOpBalDiff+=parseFloat(t.Cr),a.dbl=a.dbl+parseFloat(t.Dr)-parseFloat(t.Cr),a.IncludeClosingStock||a.IncludeOpeningStock){var o=a.dsOpenCompany.Tables[2].filter((function(e){return e.AccountID==t.AccountID})).Compute("sum","DiffStock");null!=o&&(a.dbl-=parseFloat(o))}a.dv[0].Balance=a.dbl}}));a.dblDrOpBalDiff>0&&(a.dblDrOpBalDiff=Math.abs(a.dblDrOpBalDiff-a.dblAccountsDrOpBalDiff)),a.dblCrOpBalDiff>0&&(a.dblCrOpBalDiff=Math.abs(a.dblCrOpBalDiff-a.dblAccountsCrOpBalDiff)),a.dblDrOpBalDiff=a.dblDrOpBalDiff-a.dblCrOpBalDiff,a.dv=a.dvTable,0!=a.LastAccountID&&(a.IgnoreGrossRowsForBS=!0)}for(var g=0;g<a.CountMonths;g++)a.dsNew.Columns[0].push(a.oColumns[a.ColumnSize+g].ID);a.ReportFormat!=T.Plain&&(a.dv1=a.dv1Table=a.dsNew.Tables[0],a.dv2=a.dv2Table=a.dsNew.Tables[0],a.dv1Columns=a.dsNew.Columns[0],a.dv2Columns=a.dsNew.Columns[0],a.dv1=a.dv1.filter((function(t){return c.split(",").Contains(t.AccountTypeID.toString())})),a.dv2=a.dv2.filter((function(t){return u.split(",").Contains(t.AccountTypeID.toString())})));var f=a.dsNew.Tables[0].filter((function(t){return t.AccountID==a.RetainedEarningAccount}));if(f.length>0){var B,b=0,M=a.dsNew.Tables[0].filter((function(t){return c.split(",").Contains(t.AccountTypeID.toString())})).Compute("sum","Balance");null!=M&&(b=B=i.e.Double(M)),null!=(M=a.dsNew.Tables[0].filter((function(t){return u.split(",").Contains(t.AccountTypeID.toString())})).Compute("sum","Balance"))&&(b+=B=i.e.Double(M)),b+=a.dblOpeningBalanceDifference,a.IsIncome=a.IncomeAccounts.Contains(parseInt(f[0].AccountTypeID)),B=i.e.Double(f[0].Balance),B-=b,B-=a.dblClosingStock-a.dblOpeningStock,a.dblDrOpBalDiff>0?B-=a.dblDrOpBalDiff:B+=a.dblDrOpBalDiff,f[0].Balance=B,-1!=a.YTDIndex&&(a.dvYTD=a.dvYTDTable.filter((function(t){return t.AccountID==a.RetainedEarningAccount})),a.dvYTD.length>0&&(null!=(M=a.dvYTD.filter((function(t){return c.split(",").Contains(t.AccountTypeID.toString())})).Compute("sum","Balance"))&&(B=i.e.Double(M),a.dblTemp=B),null!=(M=a.dvYTD.filter((function(t){return u.split(",").Contains(t.AccountTypeID.toString())})).Compute("sum","Balance"))&&(B=i.e.Double(M),a.dblTemp=a.dblTemp+B),B=i.e.Double(a.dvYTD[0].Balance),a.dvYTD[0].Balance=B-a.dblTemp)),7==a.ViewModel.StaticReportType&&Object(l.j)(o.a.SessionManager.Preferences.OpenCompany)&&(a.IgnoreGrossRowsForBS=!0)}if(a.IsAccountWise&&a.UpdateDataTableWithGroups(),a.Show==p.TagWise&&a.HideEmptyDimensions){var L=!1;if(a.lstTagColumns.forEach((function(t){var e=a.oColumns.find((function(e){return e.ID==t}));e&&(0==a.dsNew.Tables[0].filter((function(t){return t.Mn==e.ID})).length?a.lstTagVisibleColumns.Contains(t)||(e.HeaderAppearance.IsVisible=!1,null!=(e=a.oColumns.find((function(e){return e.ID=="Budget"+t})))&&(e.HeaderAppearance.IsVisible=!1),null!=(e=a.oColumns.find((function(e){return e.ID=="Variance"+t})))&&(e.HeaderAppearance.IsVisible=!1),null!=(e=a.oColumns.find((function(e){return e.ID=="PercentVariance"+t})))&&(e.HeaderAppearance.IsVisible=!1),L=!0):(e.HeaderAppearance.IsVisible=!0,a.lstTagVisibleColumns.push(t)))})),L){var V=new Array;a.oColumns.forEach((function(t){V.push(t)})),a.ViewModel.ReportColumns=V}}}))}},{key:"SetBudgetDataSet",value:function(t,e){var s=this;if(this.dvPrevBudget=null,this.dvCurrentBudget=null,this.dvCurrentBudgetTable=null,this.ShowBudget||this.ShowBudgetVariance||this.ShowBudgetVariancePercent||this.ShowTotalBudget){if(null==this.dsBudget){var i,l="",a="",n="",r=this.ViewModel.oReportDialog.CostCenterFilters.Where((function(t){return t.CostCenterID>5e4&&t.SelectedNodes.length>0}));if(r.length>0){var h="SELECT CostCenterID FROM COM_BudgetDefDims with(nolock) WHERE BudgetDefID="+this.CurrentBudgetID+" and CostCenterID>50000";this.PreviousBudgetID>0&&(-1!=this.BAL_LYIndex||-1!=this.YTD_LYIndex)&&(h+=" SELECT CostCenterID FROM COM_BudgetDefDims with(nolock) WHERE BudgetDefID="+this.PreviousBudgetID+" and CostCenterID>50000");var d=o.a.report.ReportDataSet("RPT022",this.ViewModel.IsReportDB,h);d.Tables[0].forEach((function(t){if(r.find((function(e){return e.CostCenterID==parseInt(t.CostCenterID)}))){var e=s.GetFilterByDimension_1(parseInt(t.CostCenterID));e.length>0&&(a+=" AND CCNID"+(parseInt(t.CostCenterID)-5e4)+" IN ("+e+")")}})),d.Tables.length>1&&d.Tables[1].forEach((function(t){if(r.find((function(e){return e.CostCenterID==parseInt(t.CostCenterID)}))){var e=s.GetFilterByDimension_1(parseInt(t.CostCenterID));e.length>0&&(n+=" AND CCNID"+(parseInt(t.CostCenterID)-5e4)+" IN ("+e+")")}}))}if(this.Show==p.TagWise){l+="SELECT AccountID,CCNID"+(this.TagID-5e4)+" TagID,SUM(AnnualAmount) AnnualAmount",i=this.dtYearStartMonth;for(var c=1;c<=12;c++)l+=",SUM(Month"+c+"Amount) "+i.ToString("MMMyyyy"),i=i.AddMonths(1);if(l+=" FROM COM_BudgetAlloc with(nolock) WHERE BudgetDefID="+this.CurrentBudgetID,l+=a.toString(),l+=" GROUP BY AccountID,CCNID"+(this.TagID-5e4),this.PreviousBudgetID>0&&(-1!=this.BAL_LYIndex||-1!=this.YTD_LYIndex)){l+=" SELECT AccountID,CCNID"+(this.TagID-5e4)+" TagID,SUM(AnnualAmount) AnnualAmount",i=this.dtYearStartMonth;for(var u=1;u<=12;u++)l+=",SUM(Month"+u+"Amount) "+i.ToString("MMMyyyy"),i=i.AddMonths(1);l+=" FROM COM_BudgetAlloc with(nolock) WHERE BudgetDefID="+this.PreviousBudgetID,l+=n.toString(),l+=" GROUP BY AccountID,CCNID"+(this.TagID-5e4)}}else{l+="SELECT AccountID,SUM(AnnualAmount) AnnualAmount",i=this.dtYearStartMonth;for(var T=1;T<=12;T++)l+=",SUM(Month"+T+"Amount) "+i.ToString("MMMyyyy"),i=i.AddMonths(1);if(l+=" FROM COM_BudgetAlloc with(nolock) WHERE BudgetDefID="+this.CurrentBudgetID,l+=a.toString(),l+=" GROUP BY AccountID",this.PreviousBudgetID>0&&(-1!=this.BAL_LYIndex||-1!=this.YTD_LYIndex)){l+=" SELECT AccountID,SUM(AnnualAmount) AnnualAmount",i=this.dtYearStartMonth;for(var C=1;C<=12;C++)l+=",SUM(Month"+C+"Amount) "+i.ToString("MMMyyyy"),i=i.AddMonths(1);l+=" FROM COM_BudgetAlloc with(nolock) WHERE BudgetDefID="+this.PreviousBudgetID,l+=n.toString(),l+=" GROUP BY AccountID"}}this.dsBudget=o.a.report.ReportDataSet("RPT022",this.ViewModel.IsReportDB,l)}this.dvCurrentBudget=this.dvCurrentBudgetTable=this.dsBudget.Tables[0],this.dsBudget.Tables.length>1&&(this.dvPrevBudget=this.dvPrevBudgetTable=this.dsBudget.Tables[1]),this.dsNew.Columns[0].push("BudgetBalance"),this.dsNew.Columns[0].push("VarianceBalance"),this.dsNew.Columns[0].push("PercentVarianceBalance"),-1!=this.YTDIndex&&(this.dsNew.Columns[0].push("BudgetYTD"),this.dsNew.Columns[0].push("VarianceYTD"),this.dsNew.Columns[0].push("PercentVarianceYTD")),-1!=this.BAL_LYIndex&&(this.dsNew.Columns[0].push("BudgetLastYearBalance"),this.dsNew.Columns[0].push("VarianceLastYearBalance"),this.dsNew.Columns[0].push("PercentVarianceLastYearBalance")),-1!=this.YTD_LYIndex&&(this.dsNew.Columns[0].push("BudgetLastYearYTD"),this.dsNew.Columns[0].push("VarianceLastYearYTD"),this.dsNew.Columns[0].push("PercentVarianceLastYearYTD"))}}},{key:"SetDataSetForPostFilters",value:function(t,e){var s=this,a="",n="";5==t?(a="4,8",n="5,9",this.IncomeAccounts.push(4),this.IncomeAccounts.push(8)):6==t?(a="4,8,11",n="5,9,12",",A.PL IsSummary",",A.PL",this.IncomeAccounts.push(4),this.IncomeAccounts.push(8),this.IncomeAccounts.push(11)):7==t?(a="13,15,1,2,7",n="14,16,6,3",",A.BS IsSummary",",A.BS",this.IncomeAccounts.push(15),this.IncomeAccounts.push(13),this.IncomeAccounts.push(1),this.IncomeAccounts.push(2),this.IncomeAccounts.push(7)):8==t&&(a="11",n="12",this.IncomeAccounts.push(11)),this.dv=this.dvTable=this.dsNew.Tables[0],this.dvColumns=this.dsNew.Columns[0],this.dsOpenCompany=null,this.dblDrOpBalDiff=0,7==t&&Object(l.j)(o.a.SessionManager.Preferences.OpenCompany)&&(this.dsOpenCompany=o.a.report.GetOpenCompanyData(7,this.ViewModel.oReportDialog.FromDate.Date,this.ViewModel.oReportDialog.ToDate.Date,0,this.LocationWhere,!1,this.UnPostedDocsList,this.PDCInclude,this.IncludeTerminatedPDC,"",this.CurrencyType,this.ForeignCurrencyID,this.exchRate,this.ViewModel.IsReportDB),this.dblAccountsDrOpBalDiff=0,this.dblAccountsCrOpBalDiff=0,this.dsOpenCompany.Tables[0].forEach((function(t){s.dv=s.dvTable.filter((function(e){return e.AccountID==t.AccountID})),s.dv.length>0&&(s.dbl=i.e.Double(s.dv[0].Balance),s.dblAccountsDrOpBalDiff+=parseFloat(t.Dr),s.dblAccountsCrOpBalDiff+=parseFloat(t.Cr),s.dbl=s.dbl+parseFloat(t.Dr)-parseFloat(t.Cr),s.dv[0].Balance=s.dbl)})),this.dblDrOpBalDiff>0&&(this.dblDrOpBalDiff=Math.abs(this.dblDrOpBalDiff-this.dblAccountsDrOpBalDiff)),this.dblCrOpBalDiff>0&&(this.dblCrOpBalDiff=Math.abs(this.dblCrOpBalDiff-this.dblAccountsCrOpBalDiff)),this.dblDrOpBalDiff=this.dblDrOpBalDiff-this.dblCrOpBalDiff,this.dv=this.dvTable),this.ReportFormat!=T.Plain?(this.dv1=this.dv1Table=this.dsNew.Tables[0],this.dv2=this.dv2Table=this.dsNew.Tables[0],this.dv1=this.dv1.filter((function(t){return a.split(",").Contains(t.AccountTypeID.toString())})),this.dv2=this.dv2.filter((function(t){return n.split(",").Contains(t.AccountTypeID.toString())})),this.dv1=c.a.FilterData(this.dv1,this.ViewModel.PostDataFetchFilterFields),this.dv2=c.a.FilterData(this.dv2,this.ViewModel.PostDataFetchFilterFields)):e.length>0&&(this.dv=c.a.FilterData(this.dv,this.ViewModel.PostDataFetchFilterFields));var r=this.dsNew.Tables[0].filter((function(t){return t.AccountID==s.RetainedEarningAccount}));if(r.length>0){var h=0,d=0,u=this.dv1Table.filter((function(t){return a.split(",").Contains(t.AccountTypeID.toString())})).Compute("sum","Balance");null!=u&&(h=d=i.e.Double(u)),null!=(u=this.dv1Table.filter((function(t){return n.split(",").Contains(t.AccountTypeID.toString())})).Compute("sum","Balance"))&&(h+=d=i.e.Double(u)),this.IsIncome=this.IncomeAccounts.Contains(parseInt(r[0].AccountTypeID)),d=i.e.Double(r[0].Balance),d-=h,this.dblDrOpBalDiff>0?d-=this.dblDrOpBalDiff:d+=this.dblDrOpBalDiff,r[0].Balance=d}}},{key:"RefreshCAD",value:function(t){for(var e=new r.c,s=t.length-1;s>=0;s--)null!=t[s].CADID&&parseInt(t[s].CADID)>1&&function(){var o=parseInt(t[s].CADID);if(!e.ContainsKey(o)){var i=t.filter((function(t){return t.CAD==o}));i.length>0&&e.push(o,i[0])}e.ContainsKey(o)&&(null!=t[s].Balance&&(e[o].Balance=null==e[o].Balance?t[s].Balance:parseFloat(e[o].Balance)+parseFloat(t[s].Balance)),null!=t[s].OpDocBalance&&(e[o].OpDocBalance=null==e[o].OpDocBalance?t[s].OpDocBalance:parseFloat(e[o].OpDocBalance)+parseFloat(t[s].OpDocBalance)),e.values.Contains(t[s])||t.RemoveAt(s))}()}},{key:"LoadReportWithPostFilters",value:function(t){this.GrdRow=-1,this.CellStartPos=0,this.ReportRowStartIndex=-1,this.FirstTypeEndIndex=0,this.ReportTotal=new Array(2).fill(0),this.lstTotal=new Array,this.GrossRows[0]=null,this.GrossRows[1]=null,this.ShowIncomeFirst="Income"==this.ViewModel.Preferences.ShowFirst,this.ViewModel.ClearRows(),this.TempData.Clear(),8!=this.ViewModel.StaticReportType?(this.dsNew=this.dsList[0],this.SetDataSetForPostFilters(this.ViewModel.StaticReportType,t),this.ReportFormat==T.Plain?this.LoadPlainReport():this.LoadHorizontalVerticalReports()):(this.OldReportTotalMonthWise=null,this.dsNew=this.dsList[0],this.SetDataSetForPostFilters(5,t),this.LoadHorizontalVerticalReports(),this.Olddbl=this.dbl,this.CellStartPos=0,this.ReportRowStartIndex=this.GrdRow,this.ReportTotal[0]=this.ReportTotal[1]=0,this.ShowIncomeFirst=!(!this.ViewModel.Preferences.ContainsKey("ShowFirst2")||"Income"!=this.ViewModel.Preferences.ShowFirst2),this.dsNew=this.dsList[1],this.SetDataSetForPostFilters(8,t),this.LoadHorizontalVerticalReports()),this.LoadReportComplete()}},{key:"GetQuarterID",value:function(t){for(var e=0;e<this.QtrSlot.keys.length;e++)if(this.QtrSlot.values[e].dtStart<=t&&this.QtrSlot.values[e].dtEnd>=t)return this.QtrSlot.keys[e];return""}},{key:"LoadHorizontalVerticalReports",value:function(){this.ReportTotalMonthWise=i.e.NumArray(2,this.CountMonths+4),this.ReportTotalYTD=i.e.NumArray(2,3),this.ReportTotalALL=i.e.NumArray(2,this.oColumns.length),this.strIncomeLabel=7==this.ViewModel.StaticReportType?o.a.GetResource("Reports_LblAssets").toUpperCase():o.a.GetResource("Reports_LblIncome").toUpperCase(),this.strExpenseLabel=7==this.ViewModel.StaticReportType?o.a.GetResource("Reports_LblLiabilities").toUpperCase():o.a.GetResource("Reports_LblExpneses").toUpperCase(),8!=this.ViewModel.StaticReportType?(this.ViewModel.Preferences.ContainsKey("Income1Label")&&(this.strIncomeLabel=this.ViewModel.Preferences.Income1Label),this.ViewModel.Preferences.ContainsKey("Expneses1Label")&&(this.strExpenseLabel=this.ViewModel.Preferences.Expneses1Label)):-1==this.ReportRowStartIndex?this.ViewModel.Preferences.ContainsKey("Income1Label")&&(this.strIncomeLabel=this.ViewModel.Preferences.Income1Label,this.strExpenseLabel=this.ViewModel.Preferences.Expneses1Label):this.ViewModel.Preferences.ContainsKey("Income2Label")&&(this.strIncomeLabel=this.ViewModel.Preferences.Income2Label,this.strExpenseLabel=this.ViewModel.Preferences.Expneses2Label),this.AddSection(this.ShowIncomeFirst,!0),this.AddSection(!this.ShowIncomeFirst,!1),this.AddOpenBalanceDifference(),7==this.ViewModel.StaticReportType?(this.AddOpenBalanceDifferenceForBS(),this.dbl=this.ReportTotal[0]+this.ReportTotal[1],this.ShowGrossInIncome=!(this.dbl>=0),Math.abs(this.ReportTotal[0])>Math.abs(this.ReportTotal[1])?this.ReportTotal[1]=this.ReportTotal[1]-this.dbl:this.ReportTotal[0]=this.ReportTotal[0]-this.dbl,this.dbl<0&&(this.dbl=-this.dbl)):(this.dbl=this.ReportTotal[0]+this.ReportTotal[1],this.ShowGrossInIncome=this.dbl>=0,this.GrossAtEnd&&-1==this.ReportRowStartIndex||this.NetAtEnd&&-1!=this.ReportRowStartIndex||(Math.abs(this.ReportTotal[0])>Math.abs(this.ReportTotal[1])?(this.ReportTotal[1]=this.ReportTotal[1]-this.dbl,this.AddGrossToVariance&&(this.ShowBudgetVariance&&(this.ReportTotalALL[1][this.BalIndex+1]=this.ReportTotalALL[1][this.BalIndex+1]+this.dbl),this.ShowBudgetVariancePercent&&(this.ReportTotalALL[1][this.BalIndex+this.VariancePercentIndex]=this.ReportTotalALL[1][this.BalIndex+this.VariancePercentIndex]+this.dbl))):(this.ReportTotal[0]=this.ReportTotal[0]-this.dbl,this.AddGrossToVariance&&(this.ShowBudgetVariance&&(this.ReportTotalALL[0][this.BalIndex+1]=this.ReportTotalALL[0][this.BalIndex+1]+this.dbl),this.ShowBudgetVariancePercent&&(this.ReportTotalALL[0][this.BalIndex+this.VariancePercentIndex]=this.ReportTotalALL[0][this.BalIndex+this.VariancePercentIndex]+this.dbl)))),this.dbl<0&&(this.dbl=-this.dbl)),this.AddReportTotal(this.ShowIncomeFirst,!0),this.AddReportTotal(!this.ShowIncomeFirst,!1)}},{key:"AddSection",value:function(t,e){var s,o,a,n=this;this.IsIncome=t,this.IsFirstCall=e,this.lstParents.Clear(),this.lstTotal.Clear(),e||(this.FirstTypeEndIndex=this.GrdRow,this.ReportFormat==T.Horizontal&&(this.GrdRow=this.ReportRowStartIndex,this.CellStartPos=this.CellStartPos+this.ColumnSize)),t?(this.dv=this.dv1,this.dvTable=this.dv1Table,this.dvColumns=this.dv1Columns,this.ReportTotalIndex=0,this.AddGroup(this.strIncomeLabel)):(this.dv=this.dv2,this.dvTable=this.dv2Table,this.dvColumns=this.dv2Columns,this.ReportTotalIndex=1,this.AddGroup(this.strExpenseLabel)),-1!=this.ReportRowStartIndex?this.AddRow_BF():t||this.AddOpeningStock();for(var r=0;r<this.dv.length;r++)if(this.drAccount=this.dv[r],t=this.IncomeAccounts.Contains(parseInt(this.drAccount.AccountTypeID)),this.strAccountID=this.drAccount.AccountID.toString(),o=!1,Object(l.j)(this.drAccount.IsGroup))this.dbl=0,this.AddRow();else{if(this.Show!=p.None){if(this.dblTemp=0,this.AccountID=parseInt(this.drAccount.AccountID),this.strTemp=i.e.String(this.drAccount.Mn),7!=this.ViewModel.StaticReportType||this.Show!=p.MonthWise&&this.Show!=p.YearWise){for(this.strTemp.length>0&&(this.Show!=p.QtrWise&&this.Show!=p.HalfYearWise||(this.strTemp=this.GetQuarterID(new Date(parseInt(this.strTemp.split("-")[0]),parseInt(this.strTemp.split("-")[1])-1,1))),this.dblTemp=this.lstPMTags.Contains(this.strTemp)?0:parseFloat(this.drAccount.Balance),o=this.Show!=p.TagWise||Math.abs(this.dblTemp)>1e-4,this.dvColumns.Contains(this.strTemp)&&(this.drAccount[this.strTemp]=this.drAccount.Balance),this.ShowSalesPerMonthly&&this.lstTagSalesTotal.ContainsKey(this.strTemp)&&(this.drAccount["SalesPercentage_"+this.strTemp]=100*this.dblTemp/this.lstTagSalesTotal[this.strTemp]));r+1<this.dv.length&&this.AccountID==parseInt(this.dv[r+1].AccountID);)this.strTemp=i.e.String(this.dv[r+1].Mn),this.strTemp.length>0&&(this.Show==p.QtrWise||this.Show==p.HalfYearWise?(this.strTemp=this.GetQuarterID(new Date(parseInt(this.strTemp.split("-")[0]),parseInt(this.strTemp.split("-")[1])-1,1)),this.lstPMTags.Contains(this.strTemp)||(this.dblTemp=this.dblTemp+parseFloat(this.dv[r+1].Balance)),this.dvColumns.Contains(this.strTemp)&&(this.drAccount[this.strTemp]=null==this.drAccount[this.strTemp]?this.dv[r+1].Balance:parseFloat(this.drAccount[this.strTemp])+parseFloat(this.dv[r+1].Balance),this.ShowSalesPerMonthly&&this.lstTagSalesTotal.ContainsKey(this.strTemp)&&null!=this.drAccount[this.strTemp]&&(this.drAccount["SalesPercentage_"+this.strTemp]=100*parseFloat(this.drAccount[this.strTemp])/this.lstTagSalesTotal[this.strTemp]))):(this.lstPMTags.Contains(this.strTemp)||(this.dblTemp=this.dblTemp+parseFloat(this.dv[r+1].Balance),o||this.Show!=p.TagWise||(o=Math.abs(parseFloat(this.dv[r+1].Balance))>1e-4)),this.dvColumns.Contains(this.strTemp)&&(this.drAccount[this.strTemp]=this.dv[r+1].Balance,this.ShowSalesPerMonthly&&this.lstTagSalesTotal.ContainsKey(this.strTemp)&&null!=this.drAccount[this.strTemp]&&(this.drAccount["SalesPercentage_"+this.strTemp]=100*parseFloat(this.drAccount[this.strTemp])/this.lstTagSalesTotal[this.strTemp])))),this.dv.Remove(this.dv[r+1]);if(this.ShowPrevMonthDiffData)for(var d=0;d<this.lstTags.length;d++)this.dvColumns.Contains(this.lstTags[d])&&this.dvColumns.Contains(this.lstPMTags[d])&&(this.drAccount["DIFF_"+this.lstTags[d]]=(null==this.drAccount[this.lstTags[d]]?0:parseFloat(this.drAccount[this.lstTags[d]]))-(null==this.drAccount[this.lstPMTags[d]]?0:parseFloat(this.drAccount[this.lstPMTags[d]])));if(this.ShowPrevMonthVarPer)for(var c=0;c<this.lstTags.length;c++)if(this.dvColumns.Contains(this.lstTags[c])&&this.dvColumns.Contains(this.lstPMTags[c])){var u=(null==this.drAccount[this.lstTags[c]]?0:parseFloat(this.drAccount[this.lstTags[c]]))-(null==this.drAccount[this.lstPMTags[c]]?0:parseFloat(this.drAccount[this.lstPMTags[c]])),C=null==this.drAccount[this.lstPMTags[c]]?0:parseFloat(this.drAccount[this.lstPMTags[c]]);0!=C&&(u=100*u/C),this.drAccount["VARPER_"+this.lstTags[c]]=u}}else if(this.strTemp.length>0)if(o=!0,this.dblTemp=parseFloat(this.drAccount.Balance),this.dvColumns.Contains(this.strTemp))for(var I=!1,D=0;D<this.CountMonths;D++)I?(r+1<this.dv.length&&this.AccountID==parseInt(this.dv[r+1].AccountID)&&(this.strTemp=i.e.String(this.dv[r+1].Mn),this.strTemp.length>0&&this.oColumns[this.CellStartPos+this.ColumnSize+D].ID==this.strTemp&&(this.dblTemp=this.dblTemp+parseFloat(this.dv[r+1].Balance),this.dvTable.Remove(this.dv[r+1]))),this.drAccount[this.oColumns[this.CellStartPos+this.ColumnSize+D].ID]=this.dblTemp):this.oColumns[this.CellStartPos+this.ColumnSize+D].ID==this.strTemp&&(I=!0,this.drAccount[this.strTemp]=this.dblTemp);else for(var m=0;m<this.CountMonths;m++)r+1<this.dv.length&&this.AccountID==parseInt(this.dv[r+1].AccountID)&&(this.strTemp=i.e.String(this.dv[r+1].Mn),this.strTemp.length>0&&this.oColumns[this.CellStartPos+this.ColumnSize+m].ID==this.strTemp&&(this.dblTemp=this.dblTemp+parseFloat(this.dv[r+1].Balance),this.dvTable.Remove(this.dv[r+1]))),this.drAccount[this.oColumns[this.CellStartPos+this.ColumnSize+m].ID]=this.dblTemp;this.drAccount.Balance=this.dblTemp}if(this.dbl=i.e.Double(this.drAccount.Balance),s=!1,null!=this.dvCurrentBudget&&(this.dvCurrentBudget=this.dvCurrentBudgetTable.filter((function(t){return t.AccountID==n.strAccountID})),this.dvCurrentBudget.length>0&&(s=!0)),a=!1,(Math.abs(this.dbl)>.01||this.ShowAllAccounts||s||o)&&(a=!0),!a&&null!=this.dvYTD){var S=this.dvYTD.filter((function(t){return t.AccountID==parseInt(n.strAccountID)}));S.length>0&&i.e.Double(S[0].Balance)>.01&&(a=!0)}if(!a&&null!=this.dvYTD_LY){var A=this.dvYTD_LY.filter((function(t){return t.AccountID==parseInt(n.strAccountID)}));A.length>0&&i.e.Double(A[0].Balance)>.01&&(a=!0)}if(!a&&null!=this.dvBAL_LY){var w=this.dvBAL_LY.filter((function(t){return t.AccountID==parseInt(n.strAccountID)}));w.length>0&&i.e.Double(w[0].Balance)>.01&&(a=!0)}if(a){if(this.Show==p.MonthWise){if(null!=this.dvCurrentBudget&&!this.HideTagWiseBudget){var R=this.ViewModel.FromDatePicker.Date;if(this.dvCurrentBudget.length>0)for(;R<=this.ViewModel.ToDatePicker.Date;)this.strTemp=R.ToString("MMMyyyy"),Object(h.isUndefined)(this.dvCurrentBudget[0][this.strTemp])||(this.dblActBudget=parseFloat(this.dvCurrentBudget[0][this.strTemp]),this.ShowBudget&&(this.drAccount["Budget"+this.strTemp]=this.dblActBudget),this.ShowBudgetVariance&&(this.dblMonBal=i.e.Double(this.drAccount["Y"+R.getFullYear()+"M"+R.iMonth()]),this.drAccount["Variance"+this.strTemp]=this.dblActBudget-Math.abs(this.dblMonBal)),this.ShowBudgetVariancePercent&&(this.dblMonBal=i.e.Double(this.drAccount["Y"+R.getFullYear()+"M"+R.iMonth()]),this.drAccount["PercentVariance"+this.strTemp]=0!=this.dblActBudget?100*(this.dblActBudget-Math.abs(this.dblMonBal))/this.dblActBudget:0)),R=R.AddMonths(1)}}else if(this.Show==p.QtrWise||this.Show==p.HalfYearWise){if(null!=this.dvCurrentBudget&&!this.HideTagWiseBudget){var g=null,x=this.ViewModel.FromDatePicker.Date;if(this.dvCurrentBudget.length>0)for(;x<=this.ViewModel.ToDatePicker.Date;)this.strTemp=x.ToString("MMMyyyy"),Object(h.isUndefined)(this.dvCurrentBudget[0][this.strTemp])||(this.dbl=parseFloat(this.dvCurrentBudget[0][this.strTemp]),this.strTemp=this.GetQuarterID(x),g!=this.strTemp?this.dblActBudget=this.dbl:this.dblActBudget+=this.dbl,g=this.strTemp,this.ShowBudget&&(this.drAccount["Budget"+this.strTemp]=this.dblActBudget),this.ShowBudgetVariance&&(this.dblMonBal=i.e.Double(this.drAccount[this.strTemp]),this.drAccount["Variance"+this.strTemp]=this.dblActBudget-Math.abs(this.dblMonBal)),this.ShowBudgetVariancePercent&&(this.dblMonBal=i.e.Double(this.drAccount[this.strTemp]),this.drAccount["PercentVariance"+this.strTemp]=0!=this.dblActBudget?100*(this.dblActBudget-Math.abs(this.dblMonBal))/this.dblActBudget:0)),x=x.AddMonths(1)}}else this.Show!=p.TagWise||null==this.dvCurrentBudget||this.HideTagWiseBudget||this.lstTags.forEach((function(t){n.dvCurrentBudget=n.dvCurrentBudgetTable.filter((function(e){return e.AccountID==n.strAccountID&&e.TagID==t})),n.dblActBudget=n.GetBudgetAmount(n.dvCurrentBudget,n.ViewModel.FromDatePicker.Date,n.ViewModel.ToDatePicker.Date),n.ShowBudget&&(n.drAccount["Budget"+t]=n.dblActBudget),n.ShowBudgetVariance&&(n.dblMonBal=i.e.Double(n.drAccount[t]),n.drAccount["Variance"+t]=n.dblActBudget-Math.abs(n.dblMonBal)),n.ShowBudgetVariancePercent&&(n.dblMonBal=i.e.Double(n.drAccount[t]),n.drAccount["PercentVariance"+t]=0!=n.dblActBudget?100*(n.dblActBudget-Math.abs(n.dblMonBal))/n.dblActBudget:0)}));this.AddRow()}}!e&&this.GrdRow+1<this.TempData.length&&(this.TempData[this.GrdRow+1].Cells[this.CellStartPos].Text="",this.TempData[this.GrdRow+1].Cells[this.CellStartPos+1].Text="",this.ViewModel.ColumnSource.length>2&&(this.TempData[this.GrdRow+1].Cells[this.CellStartPos+2].Text="")),this.UpdateTreeTotals(0),-1==this.ReportRowStartIndex&&t&&this.AddClosingStock(),this.AddNetProfitBeforeOtherIncome()}},{key:"AddRow",value:function(){var t=this;if(this.IsAddRow=0,this.oRow=this.NewReportRow(),this.oRow.LevelNo=parseInt(this.drAccount.Depth)-1,this.IsAccountWise||this.UpdateTreeTotals(this.oRow.LevelNo),this.oRow.NodeID=parseInt(this.drAccount.AccountID),this.oRow.DataRow=this.drAccount,this.oRow.LevelNo<=this.LevelNo&&(this.GrdRow++,this.ReportFormat==T.Horizontal?this.IsFirstCall||this.GrdRow>this.FirstTypeEndIndex?this.IsAddRow=1:(this.IsAddRow=2,this.oRow=this.TempData[this.GrdRow]):this.IsAddRow=1),this.ReportFormat!=T.Horizontal||this.IsFirstCall||(this.oRow.Tag=parseInt(this.drAccount.AccountID)),this.oRow.IsGroup=Object(l.j)(this.drAccount.IsGroup),this.IsAccountWise||(this.oRow.Cells[this.CellStartPos+this.AccNameIndex].level=parseInt(this.drAccount.Depth)-1),Object(l.j)(this.drAccount.IsGroup)){this.lstParents.push(this.oRow),this.lstTotal.push(new Array(this.oColumns.length).fill(0));for(var e=this.CellStartPos;e<this.oRow.Cells.length;e++)this.oRow.Cells[e].IsNormal=!1,this.oRow.Cells[e].CellAppearance=this.BalanceBFAppearance.Clone(),this.oRow.Cells[e].CellAppearance.Alignment=this.ViewModel.ReportColumns[e].DataAppearance.Alignment;this.oRow.Type=n.f.BalanceBF}else{this.ReportTotal[this.ReportTotalIndex]+=this.dbl;for(var s=this.CellStartPos;s<this.oRow.Cells.length;s++)this.oRow.Cells[s].IsNormal=!0,this.oRow.Cells[s].CellAppearance=null}if(this.TextFields.keys.forEach((function(e){var s=t.TextFields[e];t.oRow.Cells[t.CellStartPos+s].Text=t.drAccount[e].toString(),t.oRow.Cells[t.CellStartPos+s].Value=t.oRow.Cells[t.CellStartPos+s].Text})),this.oRow.Cells[this.CellStartPos+this.AccNameIndex].IsNormal=!1,!this.oRow.IsGroup){var o=0,a=0;if(this.FormatData(this.oRow.Cells[this.CellStartPos+this.BalIndex],this.dbl,this.oColumns[this.BalIndex]),this.lstTotal.length>0&&(this.lstTotal[this.lstTotal.length-1][this.BalIndex]+=this.dbl),-1!=this.YTDIndex&&(a=0,this.dvYTD=this.dvYTDTable.filter((function(e){return e.AccountID==t.strAccountID})),this.dvYTD.length>0&&(this.dblTemp=i.e.Double(this.dvYTD[0].Balance),a=this.dblTemp,this.drAccount.YTD=this.dblTemp,this.ReportTotalYTD[this.ReportTotalIndex][0]+=this.dblTemp,this.FormatData(this.oRow.Cells[this.CellStartPos+this.YTDIndex],this.dblTemp,this.oColumns[this.YTDIndex]),this.lstTotal.length>0&&(this.lstTotal[this.lstTotal.length-1][this.YTDIndex]+=this.dblTemp))),-1!=this.BAL_LYIndex&&(this.dvBAL_LY=this.dvBAL_LYTable.filter((function(e){return e.AccountID==t.strAccountID})),this.dvBAL_LY.length>0&&(this.dblTemp=i.e.Double(this.dvBAL_LY[0].Balance),this.drAccount.LastYearBalance=this.dblTemp,this.ReportTotalYTD[this.ReportTotalIndex][1]+=this.dblTemp,this.FormatData(this.oRow.Cells[this.CellStartPos+this.BAL_LYIndex],this.dblTemp,this.oColumns[this.BAL_LYIndex]),this.lstTotal.length>0&&(this.lstTotal[this.lstTotal.length-1][this.BAL_LYIndex]+=this.dblTemp),null!=this.dvPrevBudgetTable&&(this.dvPrevBudget=this.dvPrevBudgetTable.filter((function(e){return e.AccountID==t.strAccountID})),this.dblActBudget=this.GetBudgetAmount(this.dvPrevBudget,this.ViewModel.FromDatePicker.Date,this.ViewModel.ToDatePicker.Date),this.ShowBudget&&(this.ViewModel.SetCellValue(this.dblActBudget,this.oColumns[this.BAL_LYIndex-1].DataFormat,"FLOAT",this.oRow.Cells[this.BAL_LYIndex-1]),this.ReportTotalALL[this.ReportTotalIndex][this.BAL_LYIndex-1]+=this.dblActBudget,this.lstTotal.length>0&&(this.lstTotal[this.lstTotal.length-1][this.BAL_LYIndex-1]+=this.dblActBudget)),(this.ShowBudgetVariance||this.ShowBudgetVariancePercent)&&(o=this.IsIncome?-this.dblTemp-this.dblActBudget:this.dblActBudget-this.dblTemp,this.ShowBudgetVariance&&(this.ViewModel.SetCellValue(o,this.oColumns[this.BAL_LYIndex+1].DataFormat,"FLOAT",this.oRow.Cells[this.BAL_LYIndex+1]),this.ReportTotalALL[this.ReportTotalIndex][this.BAL_LYIndex+1]+=o,this.lstTotal.length>0&&(this.lstTotal[this.lstTotal.length-1][this.BAL_LYIndex+1]+=o)),this.ShowBudgetVariancePercent&&(this.dblTemp=0!=this.dblActBudget?100*o/this.dblActBudget:0,this.ViewModel.SetCellValue(this.dblTemp,this.oColumns[this.BAL_LYIndex+this.VariancePercentIndex].DataFormat,"FLOAT",this.oRow.Cells[this.BAL_LYIndex+this.VariancePercentIndex]),this.ReportTotalALL[this.ReportTotalIndex][this.BAL_LYIndex+this.VariancePercentIndex]+=o,this.lstTotal.length>0&&(this.lstTotal[this.lstTotal.length-1][this.BAL_LYIndex+this.VariancePercentIndex]+=o)))))),-1!=this.YTD_LYIndex&&(this.dvYTD_LY=this.dvYTD_LYTable.filter((function(e){return e.AccountID==t.strAccountID})),this.dvYTD_LY.length>0&&(this.dblTemp=i.e.Double(this.dvYTD_LY[0].Balance),this.drAccount.LastYearYTD=this.dblTemp,this.ReportTotalYTD[this.ReportTotalIndex][2]+=this.dblTemp,this.FormatData(this.oRow.Cells[this.CellStartPos+this.YTD_LYIndex],this.dblTemp,this.oColumns[this.YTD_LYIndex]),this.lstTotal.length>0&&(this.lstTotal[this.lstTotal.length-1][this.YTD_LYIndex]+=this.dblTemp),null!=this.dvPrevBudget&&(this.dvPrevBudget=this.dvPrevBudgetTable.filter((function(e){return e.AccountID==t.strAccountID})),this.dblActBudget=this.GetBudgetAmount(this.dvPrevBudget,this.dtYearStartMonth,this.ViewModel.ToDatePicker.Date),this.ShowBudget&&(this.ViewModel.SetCellValue(this.dblActBudget,this.oColumns[this.YTD_LYIndex-1].DataFormat,"FLOAT",this.oRow.Cells[this.YTD_LYIndex-1]),this.ReportTotalALL[this.ReportTotalIndex][this.YTD_LYIndex-1]+=this.dblActBudget,this.lstTotal.length>0&&(this.lstTotal[this.lstTotal.length-1][this.YTD_LYIndex-1]+=this.dblActBudget)),(this.ShowBudgetVariance||this.ShowBudgetVariancePercent)&&(o=this.IsIncome?-this.dblTemp-this.dblActBudget:this.dblActBudget-this.dblTemp,this.ShowBudgetVariance&&(this.ViewModel.SetCellValue(o,this.oColumns[this.YTD_LYIndex+1].DataFormat,"FLOAT",this.oRow.Cells[this.YTD_LYIndex+1]),this.ReportTotalALL[this.ReportTotalIndex][this.YTD_LYIndex+1]+=o,this.lstTotal.length>0&&(this.lstTotal[this.lstTotal.length-1][this.YTD_LYIndex+1]+=o)),this.ShowBudgetVariancePercent&&(this.dblTemp=0!=this.dblActBudget?100*o/this.dblActBudget:0,this.ViewModel.SetCellValue(this.dblTemp,this.oColumns[this.YTD_LYIndex+this.VariancePercentIndex].DataFormat,"FLOAT",this.oRow.Cells[this.YTD_LYIndex+this.VariancePercentIndex]),this.ReportTotalALL[this.ReportTotalIndex][this.YTD_LYIndex+this.VariancePercentIndex]+=o,this.lstTotal.length>0&&(this.lstTotal[this.lstTotal.length-1][this.YTD_LYIndex+this.VariancePercentIndex]+=o)))))),null!=this.dvCurrentBudget){this.dvCurrentBudget=this.dvCurrentBudget.filter((function(e){return e.AccountID==t.strAccountID}));var r=this.GetBudgetAmount(this.dvCurrentBudget,this.ViewModel.FromDatePicker.Date,this.ViewModel.ToDatePicker.Date);this.ShowBudget&&(this.ViewModel.SetCellValue(r,this.oColumns[this.BalIndex-1].DataFormat,"FLOAT",this.oRow.Cells[this.BalIndex-1]),this.ReportTotalALL[this.ReportTotalIndex][this.BalIndex-1]+=r,this.lstTotal.length>0&&(this.lstTotal[this.lstTotal.length-1][this.BalIndex-1]+=r)),this.ShowTotalBudget&&(this.dblTemp=this.GetBudgetAmount(this.dvCurrentBudget),this.ViewModel.SetCellValue(this.dblTemp,this.oColumns[this.BalIndex-this.TotalBudgetIndex].DataFormat,"FLOAT",this.oRow.Cells[this.BalIndex-this.TotalBudgetIndex]),this.ReportTotalALL[this.ReportTotalIndex][this.BalIndex-this.TotalBudgetIndex]+=this.dblTemp,this.lstTotal.length>0&&(this.lstTotal[this.lstTotal.length-1][this.BalIndex-this.TotalBudgetIndex]+=this.dblTemp)),(this.ShowBudgetVariance||this.ShowBudgetVariancePercent)&&(o=this.IsIncome?-this.dbl-r:r-this.dbl,this.ShowBudgetVariance&&(this.ViewModel.SetCellValue(o,this.oColumns[this.BalIndex+1].DataFormat,"FLOAT",this.oRow.Cells[this.BalIndex+1]),this.ReportTotalALL[this.ReportTotalIndex][this.BalIndex+1]+=o,this.lstTotal.length>0&&(this.lstTotal[this.lstTotal.length-1][this.BalIndex+1]+=o)),this.ShowBudgetVariancePercent&&(this.dblTemp=0!=r?100*o/r:0,this.ViewModel.SetCellValue(this.dblTemp,this.oColumns[this.BalIndex+this.VariancePercentIndex].DataFormat,"FLOAT",this.oRow.Cells[this.BalIndex+this.VariancePercentIndex]),this.ReportTotalALL[this.ReportTotalIndex][this.BalIndex+this.VariancePercentIndex]+=o,this.lstTotal.length>0&&(this.lstTotal[this.lstTotal.length-1][this.BalIndex+this.VariancePercentIndex]+=o))),-1!=this.YTDIndex&&(r=this.GetBudgetAmount(this.dvCurrentBudget,this.dtYearStartMonth,this.ViewModel.ToDatePicker.Date),this.ShowBudget&&(this.ViewModel.SetCellValue(r,this.oColumns[this.YTDIndex-1].DataFormat,"FLOAT",this.oRow.Cells[this.YTDIndex-1]),this.ReportTotalALL[this.ReportTotalIndex][this.YTDIndex-1]+=r,this.lstTotal.length>0&&(this.lstTotal[this.lstTotal.length-1][this.YTDIndex-1]+=r)),(this.ShowBudgetVariance||this.ShowBudgetVariancePercent)&&(o=this.IsIncome?-a-r:r-a,this.ShowBudgetVariance&&(this.ViewModel.SetCellValue(o,this.oColumns[this.YTDIndex+1].DataFormat,"FLOAT",this.oRow.Cells[this.YTDIndex+1]),this.ReportTotalALL[this.ReportTotalIndex][this.YTDIndex+1]+=o,this.lstTotal.length>0&&(this.lstTotal[this.lstTotal.length-1][this.YTDIndex+1]+=o)),this.ShowBudgetVariancePercent&&(this.dblTemp=0!=r?100*o/r:0,this.ViewModel.SetCellValue(this.dblTemp,this.oColumns[this.YTDIndex+this.VariancePercentIndex].DataFormat,"FLOAT",this.oRow.Cells[this.YTDIndex+this.VariancePercentIndex]),this.ReportTotalALL[this.ReportTotalIndex][this.YTDIndex+this.VariancePercentIndex]+=o,this.lstTotal.length>0&&(this.lstTotal[this.lstTotal.length-1][this.YTDIndex+this.VariancePercentIndex]+=o))))}this.ShowSalesPercentage&&this.dblTotalSales>0&&(this.dblTemp=this.IsIncome?100*-this.dbl/this.dblTotalSales:100*this.dbl/this.dblTotalSales,this.ViewModel.SetCellValue(this.dblTemp,this.oColumns[this.BalIndex+this.SalesPercentIndex].DataFormat,"FLOAT",this.oRow.Cells[this.BalIndex+this.SalesPercentIndex]),this.ReportTotalALL[this.ReportTotalIndex][this.BalIndex+this.SalesPercentIndex]+=this.dblTemp,this.lstTotal.length>0&&(this.lstTotal[this.lstTotal.length-1][this.BalIndex+this.SalesPercentIndex]+=this.dblTemp));for(var h=0;h<this.CountMonths;h++)this.dblTemp=i.e.Double(this.drAccount[this.oColumns[this.ColumnSize+h].ID]),this.ReportTotalMonthWise[this.ReportTotalIndex][h]+=this.dblTemp,this.oColumns[this.ColumnSize+h].ID.startsWith("Budget")||this.oColumns[this.ColumnSize+h].ID.startsWith("Variance")||this.oColumns[this.ColumnSize+h].ID.startsWith("VARPER_")?this.ViewModel.SetCellValue(this.dblTemp,this.oColumns[this.ColumnSize+h].DataFormat,"FLOAT",this.oRow.Cells[this.CellStartPos+this.ColumnSize+h]):this.FormatData(this.oRow.Cells[this.CellStartPos+this.ColumnSize+h],this.dblTemp,this.oColumns[this.ColumnSize+h]),this.lstTotal.length>0&&!this.oColumns[this.ColumnSize+h].ID.startsWith("VARPER_")&&(this.lstTotal[this.lstTotal.length-1][this.CellStartPos+this.ColumnSize+h]+=this.dblTemp);this.ViewModel.ApplyKPI(this.oRow)}if(1==this.IsAddRow){if(!(this.ShowdetailsofControlGroups||(this.oRow.IsExpanded=!Object(l.j)(this.drAccount.IsSummary),Object(l.j)(this.drAccount.IsSummary)&&(this.oRow.Type=n.f.Detail),this.oRow.IsGroup?this.lstParents.length>1&&(this.oRow.Parent=this.lstParents[this.lstParents.length-2]):this.lstParents.length>0&&(this.oRow.Parent=this.lstParents[this.lstParents.length-1]),null==this.oRow.Parent||this.oRow.Parent.IsExpanded&&this.oRow.Parent.Visible||(this.oRow.Visible=!1,this.ReportFormat!=T.Horizontal))))return void this.GrdRow--;this.TempData.push(this.oRow)}else if(2==this.IsAddRow){if(!this.ShowdetailsofControlGroups){this.oRow.IsExpanded=!Object(l.j)(this.drAccount.IsSummary),this.oRow.IsGroup?this.lstParents.length>1&&(this.oRow.Parent=this.lstParents[this.lstParents.length-2]):this.lstParents.length>0&&(this.oRow.Parent=this.lstParents[this.lstParents.length-1]);for(var d=0;d<this.lstParents.length;d++){var c=this.lstParents[d];if(null!=c&&!c.IsExpanded&&c!=this.oRow)return void this.GrdRow--}}this.TempData.Remove(this.oRow),this.TempData.InsertAt(this.oRow,this.GrdRow)}}},{key:"AddReportTotal",value:function(t,e){var s=null,i=null;this.IsIncome=t;var l=-1,a=this.GrossAtEnd&&-1==this.ReportRowStartIndex||this.NetAtEnd&&-1!=this.ReportRowStartIndex;if(this.ReportTotalIndex=t?0:1,this.ReportFormat==T.Vertical){this.GrdRow++,l=e?this.FirstTypeEndIndex+1:this.GrdRow,s=this.NewReportRow_2(n.f.ReportTotal,this.ViewModel.GrpReportTotal.SubTotalAppearance_Data),this.ViewModel.GrpReportTotal.Height>0&&(s.Height=this.ViewModel.GrpReportTotal.Height),s.LevelNo=0;for(var r=0;r<this.CountMonths;r++)this.oColumns[this.CellStartPos+this.ColumnSize+r].ID.startsWith("VARPER_")||this.oColumns[this.CellStartPos+this.ColumnSize+r].ID.startsWith("SalesPercentage_")||(s.Cells[this.CellStartPos+this.ColumnSize+r].IsNormal=!1,this.FormatData(s.Cells[this.CellStartPos+this.ColumnSize+r],this.ReportTotalMonthWise[this.ReportTotalIndex][r],this.oColumns[this.ColumnSize+r]));this.GrdRow++,(i=this.NewReportRow_2(n.f.GrossTotal,this.GrossTotalAppearance_Data)).Height=i.Height+2,i.LevelNo=0,this.GrossRows[this.ReportTotalIndex]=i,this.GrossCellIndex=this.CellStartPos}else this.ReportFormat==T.Horizontal&&(e?(this.FirstTypeEndIndex<this.GrdRow?this.FirstTypeEndIndex=this.GrdRow:this.GrdRow=this.FirstTypeEndIndex,this.GrdRow+=2,this.CellStartPos=0,l=this.FirstTypeEndIndex+1,(i=this.NewReportRow_2(n.f.GrossTotal,this.GrossTotalAppearance_Data)).Height=i.Height+2,i.LevelNo=0,s=this.NewReportRow_2(n.f.ReportTotal,this.ViewModel.GrpReportTotal.SubTotalAppearance_Data),this.ViewModel.GrpReportTotal.Height>0&&(s.Height=this.ViewModel.GrpReportTotal.Height),s.LevelNo=0):(this.CellStartPos+=this.ColumnSize,a?(i=this.TempData[this.GrdRow],s=this.TempData[this.GrdRow-1]):(i=this.TempData[this.GrdRow-1],s=this.TempData[this.GrdRow])),this.GrossRows[this.ReportTotalIndex]=i);if(!e){var h,d="";if(1==this.ShowGrossInIncome){if(h=this.GrossRows[0],this.ReportFormat==T.Horizontal&&(this.GrossCellIndex=this.ShowIncomeFirst?0:this.ColumnSize),this.ShowNetProfitBeforeAndAfter&&-1!=this.ReportRowStartIndex){var c=this.TempData.indexOf(this.GrossRows[0]);this.TempData.indexOf(this.GrossRows[1]),h=-1==c?this.GrossRows[0]:this.GrossRows[1]}a&&(h=i),this.dbl>=0?(d=8!=this.ViewModel.StaticReportType?"Reports_LblNetLossForPeriod":-1==this.ReportRowStartIndex?"Reports_LblGrossLossForPeriod":this.ShowNetProfitBeforeAndAfter?"Reports_LblNetLossAfter":"Reports_LblNetLossForPeriod",this.ViewModel.SetCellValue(this.dbl,this.oColumns[this.BalIndex].DataFormat,"FLOAT",h.Cells[this.GrossCellIndex+this.BalIndex]),this.AddGrossToVariance&&this.ShowBudgetVariance&&this.ViewModel.SetCellValue(this.dbl,this.oColumns[this.BalIndex+1].DataFormat,"FLOAT",h.Cells[this.GrossCellIndex+this.BalIndex+1])):(d=8!=this.ViewModel.StaticReportType?"Reports_LblNetProfitForPeriod":-1==this.ReportRowStartIndex?"Reports_LblGrossProfitForPeriod":this.ShowNetProfitBeforeAndAfter?"Reports_LblNetProfitAfter":"Reports_LblNetProfitForPeriod",this.ViewModel.SetCellValue(-this.dbl,this.oColumns[this.BalIndex].DataFormat,"FLOAT",h.Cells[this.GrossCellIndex+this.BalIndex]),h.Cells[this.GrossCellIndex+this.BalIndex].Text+="Dr",this.AddGrossToVariance&&this.ShowBudgetVariance&&this.ViewModel.SetCellValue(-this.dbl,this.oColumns[this.BalIndex+1].DataFormat,"FLOAT",h.Cells[this.GrossCellIndex+this.BalIndex+1])),this.ShowSalesPercentage&&this.dblTotalSales>0&&(this.dblTemp=100*this.dbl/this.dblTotalSales,this.ViewModel.SetCellValue(this.dblTemp,this.oColumns[this.BalIndex+this.SalesPercentIndex].DataFormat,"FLOAT",h.Cells[this.BalIndex+this.SalesPercentIndex]))}else{if(h=this.GrossRows[1],this.ReportFormat==T.Horizontal&&(this.GrossCellIndex=this.ShowIncomeFirst?this.ColumnSize:0,this.ShowNetProfitBeforeAndAfter&&-1!=this.ReportRowStartIndex&&(this.GrossCellIndex=this.ShowIncomeFirst?0:this.ColumnSize)),this.ShowNetProfitBeforeAndAfter&&-1!=this.ReportRowStartIndex){var u=this.TempData.indexOf(this.GrossRows[0]);this.TempData.indexOf(this.GrossRows[1]),h=-1==u?this.GrossRows[0]:this.GrossRows[1]}a&&(h=i),this.dbl>=0?(d=8!=this.ViewModel.StaticReportType?"Reports_LblNetProfitForPeriod":-1==this.ReportRowStartIndex?"Reports_LblGrossProfitForPeriod":this.ShowNetProfitBeforeAndAfter?"Reports_LblNetProfitAfter":"Reports_LblNetProfitForPeriod",this.ViewModel.SetCellValue(this.dbl,this.oColumns[this.BalIndex].DataFormat,"FLOAT",h.Cells[this.GrossCellIndex+this.BalIndex]),this.AddGrossToVariance&&this.ShowBudgetVariance&&this.ViewModel.SetCellValue(-this.dbl,this.oColumns[this.BalIndex+1].DataFormat,"FLOAT",h.Cells[this.GrossCellIndex+this.BalIndex+1])):(d=8!=this.ViewModel.StaticReportType?"Reports_LblNetLossForPeriod":-1==this.ReportRowStartIndex?"Reports_LblGrossLossForPeriod":this.ShowNetProfitBeforeAndAfter?"Reports_LblNetLossAfter":"Reports_LblNetLossForPeriod",this.ViewModel.SetCellValue(-this.dbl,this.oColumns[this.BalIndex].DataFormat,"FLOAT",h.Cells[this.GrossCellIndex+this.BalIndex]),h.Cells[this.GrossCellIndex+this.BalIndex].Text+="Cr",this.AddGrossToVariance&&this.ShowBudgetVariance&&this.ViewModel.SetCellValue(this.dbl,this.oColumns[this.BalIndex+1].DataFormat,"FLOAT",h.Cells[this.GrossCellIndex+this.BalIndex+1])),this.ShowSalesPercentage&&this.dblTotalSales>0&&(this.dblTemp=100*this.dbl/this.dblTotalSales,this.ViewModel.SetCellValue(this.dblTemp,this.oColumns[this.BalIndex+this.SalesPercentIndex].DataFormat,"FLOAT",h.Cells[this.BalIndex+this.SalesPercentIndex]))}this.SetPLText(h.Cells[this.GrossCellIndex+this.AccNameIndex],d),this.SetPLTextColor(h.Cells[this.GrossCellIndex+this.BalIndex],d),this.AddGrossToVariance&&this.ShowBudgetVariance&&this.SetPLTextColor(h.Cells[this.GrossCellIndex+this.BalIndex+1],d),this.ShowSalesPercentage&&this.dblTotalSales>0&&this.SetPLTextColor(h.Cells[this.BalIndex+this.SalesPercentIndex],d),this.Show==p.None&&(this.ReportFormat==T.Vertical?h==this.GrossRows[0]?(this.GrossRows[1].Visible=!1,(0!=this.RetainedEarningAccount||Math.abs(this.dbl)<.01)&&(this.GrossRows[0].Visible=!1)):(this.GrossRows[0].Visible=!1,(0!=this.RetainedEarningAccount||Math.abs(this.dbl)<.01)&&(this.GrossRows[1].Visible=!1)):this.ReportFormat==T.Horizontal&&(0!=this.RetainedEarningAccount||Math.abs(this.dbl)<.01)&&(h.Visible=!1))}a&&!this.ShowCarryForward&&(this.ReportFormat==T.Vertical?this.ShowGrossInIncome&&!t&&1==this.ReportTotalIndex?this.ReportTotal[1]-=this.Olddbl:!this.ShowGrossInIncome&&t&&0==this.ReportTotalIndex&&(this.ReportTotal[0]+=this.Olddbl):this.ShowGrossInIncome||0!=this.ReportTotalIndex?1==this.ReportTotalIndex&&(this.ReportTotal[1]-=this.Olddbl):this.ReportTotal[0]+=this.Olddbl);var C,I=-1;for(this.k=0;this.k<this.oColumns.length;this.k++)this.ViewModel.GrpReportTotal.TotalCols.ContainsKey(this.oColumns[this.k].ID)&&(-1==I&&(I=this.k),this.ViewModel.SetCellValue(Math.abs(this.ReportTotal[this.ReportTotalIndex]),this.oColumns[this.BalIndex].DataFormat,"FLOAT",s.Cells[this.CellStartPos+this.BalIndex]));(s.Cells[this.CellStartPos].CellAppearance=this.ViewModel.GrpReportTotal.SubTotalAppearance,s.Cells[this.CellStartPos].Text=o.a.GetResource("Reports_ReportTotal"),8==this.ViewModel.StaticReportType&&(this.GrossAtEnd||this.NetAtEnd))&&(t?(C=o.a.GetResource("Reports_LblIncome"),-1==this.ReportRowStartIndex?this.ViewModel.Preferences.ContainsKey("Income1Label")&&(C=this.ViewModel.Preferences.Income1Label):this.ViewModel.Preferences.ContainsKey("Income2Label")&&(C=this.ViewModel.Preferences.Income2Label)):(C=o.a.GetResource("Reports_LblExpneses"),-1==this.ReportRowStartIndex?this.ViewModel.Preferences.ContainsKey("Expneses1Label")&&(C=this.ViewModel.Preferences.Expneses1Label):this.ViewModel.Preferences.ContainsKey("Expneses2Label")&&(C=this.ViewModel.Preferences.Expneses2Label)),s.Cells[this.CellStartPos].Text=C+" Total");if(I>0&&(s.Cells[this.CellStartPos].ColSpan=I),-1!=this.YTDIndex&&(this.FormatData(s.Cells[this.CellStartPos+this.YTDIndex],this.ReportTotalYTD[this.ReportTotalIndex][0],this.oColumns[this.YTDIndex]),this.ShowBudget&&this.FormatData(s.Cells[this.CellStartPos+this.YTDIndex-1],this.ReportTotalALL[this.ReportTotalIndex][this.YTDIndex-1],this.oColumns[this.YTDIndex-1]),this.ShowBudgetVariance&&this.FormatData(s.Cells[this.CellStartPos+this.YTDIndex+1],this.ReportTotalALL[this.ReportTotalIndex][this.YTDIndex+1],this.oColumns[this.YTDIndex+1]),this.ShowBudgetVariancePercent)){var D=0;this.ReportTotalALL[this.ReportTotalIndex][this.YTDIndex-1]>0&&(D=100*this.ReportTotalALL[this.ReportTotalIndex][this.YTDIndex+this.VariancePercentIndex]/this.ReportTotalALL[this.ReportTotalIndex][this.YTDIndex-1]),this.FormatData(s.Cells[this.CellStartPos+this.YTDIndex+this.VariancePercentIndex],D,this.oColumns[this.YTDIndex+this.VariancePercentIndex])}if(-1!=this.BAL_LYIndex&&(this.FormatData(s.Cells[this.CellStartPos+this.BAL_LYIndex],this.ReportTotalYTD[this.ReportTotalIndex][1],this.oColumns[this.BAL_LYIndex]),this.ShowBudget&&this.FormatData(s.Cells[this.CellStartPos+this.BAL_LYIndex-1],this.ReportTotalALL[this.ReportTotalIndex][this.BAL_LYIndex-1],this.oColumns[this.BAL_LYIndex-1]),this.ShowBudgetVariance&&this.FormatData(s.Cells[this.CellStartPos+this.BAL_LYIndex+1],this.ReportTotalALL[this.ReportTotalIndex][this.BAL_LYIndex+1],this.oColumns[this.BAL_LYIndex+1]),this.ShowBudgetVariancePercent)){var m=0;this.ReportTotalALL[this.ReportTotalIndex][this.BAL_LYIndex-1]>0&&(m=100*this.ReportTotalALL[this.ReportTotalIndex][this.BAL_LYIndex+this.VariancePercentIndex]/this.ReportTotalALL[this.ReportTotalIndex][this.BAL_LYIndex-1]),this.FormatData(s.Cells[this.CellStartPos+this.BAL_LYIndex+this.VariancePercentIndex],m,this.oColumns[this.BAL_LYIndex+this.VariancePercentIndex])}if(-1!=this.YTD_LYIndex&&(this.FormatData(s.Cells[this.CellStartPos+this.YTD_LYIndex],this.ReportTotalYTD[this.ReportTotalIndex][2],this.oColumns[this.YTD_LYIndex]),this.ShowBudget&&this.FormatData(s.Cells[this.CellStartPos+this.YTD_LYIndex-1],this.ReportTotalALL[this.ReportTotalIndex][this.YTD_LYIndex-1],this.oColumns[this.YTD_LYIndex-1]),this.ShowBudgetVariance&&this.FormatData(s.Cells[this.CellStartPos+this.YTD_LYIndex+1],this.ReportTotalALL[this.ReportTotalIndex][this.YTD_LYIndex+1],this.oColumns[this.YTD_LYIndex+1]),this.ShowBudgetVariancePercent)){var S=0;this.ReportTotalALL[this.ReportTotalIndex][this.YTD_LYIndex-1]>0&&(S=100*this.ReportTotalALL[this.ReportTotalIndex][this.YTD_LYIndex+this.VariancePercentIndex]/this.ReportTotalALL[this.ReportTotalIndex][this.YTD_LYIndex-1]),this.FormatData(s.Cells[this.CellStartPos+this.YTD_LYIndex+this.VariancePercentIndex],S,this.oColumns[this.YTD_LYIndex+this.VariancePercentIndex])}if(-1!=this.BalIndex&&(this.ShowTotalBudget&&this.FormatData(s.Cells[this.CellStartPos+this.BalIndex-this.TotalBudgetIndex],this.ReportTotalALL[this.ReportTotalIndex][this.BalIndex-this.TotalBudgetIndex],this.oColumns[this.BalIndex-this.TotalBudgetIndex]),this.ShowBudget&&this.FormatData(s.Cells[this.CellStartPos+this.BalIndex-1],this.ReportTotalALL[this.ReportTotalIndex][this.BalIndex-1],this.oColumns[this.BalIndex-1]),this.ShowBudgetVariance&&this.FormatData(s.Cells[this.CellStartPos+this.BalIndex+1],this.ReportTotalALL[this.ReportTotalIndex][this.BalIndex+1],this.oColumns[this.BalIndex+1]),this.ShowBudgetVariancePercent)){var A=0;this.ReportTotalALL[this.ReportTotalIndex][this.BalIndex-1]>0&&(A=100*this.ReportTotalALL[this.ReportTotalIndex][this.BalIndex+this.VariancePercentIndex]/this.ReportTotalALL[this.ReportTotalIndex][this.BalIndex-1]),this.FormatData(s.Cells[this.CellStartPos+this.BalIndex+this.VariancePercentIndex],A,this.oColumns[this.BalIndex+this.VariancePercentIndex])}a?-1==l?(l=this.TempData.indexOf(i),this.TempData.RemoveAt(l),this.TempData.InsertAt(i,l),this.ViewModel.GrpReportTotal.GroupAppearance.IsVisible||(s.Visible=!1),l=this.TempData.indexOf(s),this.TempData.RemoveAt(l),this.TempData.InsertAt(s,l)):(this.ViewModel.GrpReportTotal.GroupAppearance.IsVisible||(s.Visible=!1),this.TempData.InsertAt(s,l),this.TempData.InsertAt(i,l+1)):-1==l?(l=this.TempData.indexOf(i),this.TempData.RemoveAt(l),this.TempData.InsertAt(i,l),this.ViewModel.GrpReportTotal.GroupAppearance.IsVisible||(s.Visible=!1),l=this.TempData.indexOf(s),this.TempData.RemoveAt(l),this.TempData.InsertAt(s,l)):(this.TempData.InsertAt(i,l),this.ViewModel.GrpReportTotal.GroupAppearance.IsVisible||(s.Visible=!1),this.TempData.InsertAt(s,l+1)),e||this.Show==p.None||this.ShowMonthWiseProfitAndLoss(),s.Cells[this.CellStartPos+this.BalIndex].CellAppearance.Alignment=i.Cells[this.CellStartPos+this.BalIndex].CellAppearance.Alignment="Right",e||(this.IgnoreGrossRowsForBS?(-1!=(l=this.TempData.indexOf(this.GrossRows[0]))&&this.TempData.RemoveAt(l),-1!=(l=this.TempData.indexOf(this.GrossRows[1]))&&this.TempData.RemoveAt(l)):(l=this.TempData.indexOf(this.GrossRows[0]),this.TempData.RemoveAt(l),this.TempData.InsertAt(this.GrossRows[0],l),l=this.TempData.indexOf(this.GrossRows[1]),this.TempData.RemoveAt(l),this.TempData.InsertAt(this.GrossRows[1],l)))}},{key:"ShowProfitAndLoss",value:function(t,e){var s,o,i,l,a=!1;i=this.TempData.indexOf(this.GrossRows[0])+1,l=this.TempData.indexOf(this.GrossRows[1])+1,this.dblTemp=this.ReportTotalYTD[0][t]+this.ReportTotalYTD[1][t],this.dblTemp>=0?(this.TempData[i].Cells[this.CellStartPos+e].Value=this.TempData[l].Cells[this.CellStartPos+e].Value,this.TempData[i].Cells[this.CellStartPos+e].Text=this.TempData[l].Cells[this.CellStartPos+e].Text,a=!0):(this.TempData[l].Cells[this.CellStartPos+e].Value=this.TempData[i].Cells[this.CellStartPos+e].Value,this.TempData[l].Cells[this.CellStartPos+e].Text=this.TempData[i].Cells[this.CellStartPos+e].Text,a=!1),this.dblTemp<0&&(this.dblTemp=-this.dblTemp);var n=null;a?(s=this.GrossRows[0].Cells[this.CellStartPos+e],o=this.GrossRows[0].Cells[this.GrossCellIndex+this.AccNameIndex],this.dblTemp>=0?(n=8!=this.ViewModel.StaticReportType?"Reports_LblNetLossForPeriod":-1==this.ReportRowStartIndex?"Reports_LblGrossLossForPeriod":"Reports_LblNetLossForPeriod",this.ViewModel.SetCellValue(this.dblTemp,this.oColumns[this.CellStartPos+e].DataFormat,"FLOAT",s)):(n=8!=this.ViewModel.StaticReportType?"Reports_LblNetProfitForPeriod":-1==this.ReportRowStartIndex?"Reports_LblGrossProfitForPeriod":"Reports_LblNetProfitForPeriod",this.ViewModel.SetCellValue(this.dblTemp,this.oColumns[this.CellStartPos+e].DataFormat,"FLOAT",s))):(s=this.GrossRows[1].Cells[this.CellStartPos+e],o=this.GrossRows[1].Cells[this.GrossCellIndex+this.AccNameIndex],this.dblTemp>=0?(n=8!=this.ViewModel.StaticReportType?"Reports_LblNetProfitForPeriod":-1==this.ReportRowStartIndex?"Reports_LblGrossProfitForPeriod":"Reports_LblNetProfitForPeriod",this.ViewModel.SetCellValue(this.dblTemp,this.oColumns[this.CellStartPos+e].DataFormat,"FLOAT",s)):(n=8!=this.ViewModel.StaticReportType?"Reports_LblNetLossForPeriod":-1==this.ReportRowStartIndex?"Reports_LblGrossLossForPeriod":"Reports_LblNetLossForPeriod",this.ViewModel.SetCellValue(this.dblTemp,this.oColumns[this.CellStartPos+e].DataFormat,"FLOAT",s))),null!=n&&(this.SetPLText(o,n),this.SetPLTextColor(s,n));var r=this.TempData[i],h=this.TempData[l];this.TempData.RemoveAt(i),this.TempData.Insert(i,r),this.TempData.RemoveAt(l),this.TempData.InsertAt(h,l)}},{key:"ShowMonthWiseProfitAndLoss",value:function(){var t,e,s,o,i=!1;s=this.TempData.indexOf(this.GrossRows[0]),o=this.TempData.indexOf(this.GrossRows[1]);for(var l=this.GrossAtEnd&&-1==this.ReportRowStartIndex||this.NetAtEnd&&-1!=this.ReportRowStartIndex,a=0;a<this.CountMonths;a++)if(!this.oColumns[this.CellStartPos+this.ColumnSize+a].ID.startsWith("DIFF_")&&!this.oColumns[this.CellStartPos+this.ColumnSize+a].ID.startsWith("VARPER_")&&(7==this.ViewModel.StaticReportType?(this.dblTemp=this.ReportTotalMonthWise[0][a]+this.ReportTotalMonthWise[1][a],this.dblTemp>=0?(this.TempData[o].Cells[this.CellStartPos+this.ColumnSize+a].Value=this.TempData[s].Cells[this.CellStartPos+this.ColumnSize+a].Value,this.TempData[o].Cells[this.CellStartPos+this.ColumnSize+a].Text=this.TempData[s].Cells[this.CellStartPos+this.ColumnSize+a].Text,i=!1):(this.TempData[s].Cells[this.CellStartPos+this.ColumnSize+a].Value=this.TempData[o].Cells[this.CellStartPos+this.ColumnSize+a].Value,this.TempData[s].Cells[this.CellStartPos+this.ColumnSize+a].Text=this.TempData[o].Cells[this.CellStartPos+this.ColumnSize+a].Text,i=!0),this.dblTemp<0&&(this.dblTemp=-this.dblTemp)):null!=this.OldReportTotalMonthWise?(this.dblTemp=this.OldReportTotalMonthWise[0][a]+this.OldReportTotalMonthWise[1][a]+this.ReportTotalMonthWise[0][a]+this.ReportTotalMonthWise[1][a],this.ShowNetProfitBeforeAndAfter?(l||(this.dblTemp>=0?(this.TempData[s].Cells[this.CellStartPos+this.ColumnSize+a].Value=this.TempData[o].Cells[this.CellStartPos+this.ColumnSize+a].Value,this.TempData[s].Cells[this.CellStartPos+this.ColumnSize+a].Text=this.TempData[o].Cells[this.CellStartPos+this.ColumnSize+a].Text):(this.TempData[o].Cells[this.CellStartPos+this.ColumnSize+a].Value=this.TempData[s].Cells[this.CellStartPos+this.ColumnSize+a].Value,this.TempData[o].Cells[this.CellStartPos+this.ColumnSize+a].Text=this.TempData[s].Cells[this.CellStartPos+this.ColumnSize+a].Text)),this.dblTemp=-this.dblTemp,i=!0):(this.dblTemp>=0?(l||(this.TempData[s].Cells[this.CellStartPos+this.ColumnSize+a].Value=this.TempData[o].Cells[this.CellStartPos+this.ColumnSize+a].Value,this.TempData[s].Cells[this.CellStartPos+this.ColumnSize+a].Text=this.TempData[o].Cells[this.CellStartPos+this.ColumnSize+a].Text),i=!0):(l||(this.TempData[o].Cells[this.CellStartPos+this.ColumnSize+a].Value=this.TempData[s].Cells[this.CellStartPos+this.ColumnSize+a].Value,this.TempData[o].Cells[this.CellStartPos+this.ColumnSize+a].Text=this.TempData[s].Cells[this.CellStartPos+this.ColumnSize+a].Text),i=!1),this.dblTemp<0&&(this.dblTemp=-this.dblTemp))):(this.dblTemp=this.ReportTotalMonthWise[0][a]+this.ReportTotalMonthWise[1][a],this.dblTemp>=0?(l||(this.TempData[s].Cells[this.CellStartPos+this.ColumnSize+a].Value=this.TempData[o].Cells[this.CellStartPos+this.ColumnSize+a].Value,this.TempData[s].Cells[this.CellStartPos+this.ColumnSize+a].Text=this.TempData[o].Cells[this.CellStartPos+this.ColumnSize+a].Text),i=!0):(l||(this.TempData[o].Cells[this.CellStartPos+this.ColumnSize+a].Value=this.TempData[s].Cells[this.CellStartPos+this.ColumnSize+a].Value,this.TempData[o].Cells[this.CellStartPos+this.ColumnSize+a].Text=this.TempData[s].Cells[this.CellStartPos+this.ColumnSize+a].Text),i=!1),this.dblTemp<0&&(this.dblTemp=-this.dblTemp)),0!=this.dblTemp))if(l)t=s>o?this.TempData[s+1].Cells[this.CellStartPos+this.ColumnSize+a]:this.TempData[o+1].Cells[this.CellStartPos+this.ColumnSize+a],this.ViewModel.SetCellValue(this.dblTemp,this.oColumns[this.CellStartPos+this.ColumnSize+a].DataFormat,"FLOAT",t);else{var n=null;i?(t=this.GrossRows[0].Cells[this.CellStartPos+this.ColumnSize+a],e=this.GrossRows[0].Cells[this.GrossCellIndex+this.AccNameIndex],this.dblTemp>=0?(n=8!=this.ViewModel.StaticReportType?"Reports_LblNetLossForPeriod":-1==this.ReportRowStartIndex?"Reports_LblGrossLossForPeriod":"Reports_LblNetLossForPeriod",this.ViewModel.SetCellValue(this.dblTemp,this.oColumns[this.CellStartPos+this.ColumnSize+a].DataFormat,"FLOAT",t)):(n=8!=this.ViewModel.StaticReportType?"Reports_LblNetProfitForPeriod":-1==this.ReportRowStartIndex?"Reports_LblGrossProfitForPeriod":"Reports_LblNetProfitForPeriod",this.ViewModel.SetCellValue(this.dblTemp,this.oColumns[this.CellStartPos+this.ColumnSize+a].DataFormat,"FLOAT",t))):(t=this.GrossRows[1].Cells[this.CellStartPos+this.ColumnSize+a],e=this.GrossRows[1].Cells[this.GrossCellIndex+this.AccNameIndex],this.dblTemp>=0?(n=8!=this.ViewModel.StaticReportType?"Reports_LblNetProfitForPeriod":-1==this.ReportRowStartIndex?"Reports_LblGrossProfitForPeriod":"Reports_LblNetProfitForPeriod",this.ViewModel.SetCellValue(this.dblTemp,this.oColumns[this.CellStartPos+this.ColumnSize+a].DataFormat,"FLOAT",t)):(n=8!=this.ViewModel.StaticReportType?"Reports_LblNetLossForPeriod":-1==this.ReportRowStartIndex?"Reports_LblGrossLossForPeriod":"Reports_LblNetLossForPeriod",this.ViewModel.SetCellValue(this.dblTemp,this.oColumns[this.CellStartPos+this.ColumnSize+a].DataFormat,"FLOAT",t))),null!=n&&(this.SetPLText(e,n),this.SetPLTextColor(t,n))}var r=this.TempData[s],h=this.TempData[o];this.TempData.RemoveAt(s),this.TempData.InsertAt(r,s),this.TempData.RemoveAt(o),this.TempData.InsertAt(h,o)}},{key:"UpdateTreeTotals",value:function(t){var e=this;if(t>this.lstTotal.length)for(var s=0;s<t-this.lstTotal.length;s++)this.lstParents.push(null),this.lstTotal.push(new Array(this.oColumns.length));for(var o=this.lstTotal.length-1;o>=t;o--){if(o>0)for(var i=0;i<this.lstTotal[o].length;i++)this.lstTotal[o-1][i]+=this.lstTotal[o][i];if(0!=this.lstParents.length)if(null!=this.lstParents[o]){if(!this.GroupTotalsAtEnd||this.DontShowSummaryGroupTotals&&!this.lstParents[o].IsExpanded){if(this.GroupTotalsSeperate)this.FormatData(this.lstParents[o].Cells[this.CellStartPos+this.BalIndex+1],this.lstTotal[o][this.BalIndex],this.oColumns[this.BalIndex]);else{if(this.FormatData(this.lstParents[o].Cells[this.CellStartPos+this.BalIndex],this.lstTotal[o][this.BalIndex],this.oColumns[this.BalIndex]),this.ShowBudget&&(this.ViewModel.SetCellValue(this.lstTotal[o][this.BalIndex-1],this.oColumns[this.BalIndex-1].DataFormat,"FLOAT",this.lstParents[o].Cells[this.CellStartPos+this.BalIndex-1]),-1!=this.YTDIndex&&this.FormatData(this.lstParents[o].Cells[this.CellStartPos+this.YTDIndex-1],this.lstTotal[o][this.YTDIndex-1],this.oColumns[this.YTDIndex-1]),-1!=this.BAL_LYIndex&&this.FormatData(this.lstParents[o].Cells[this.CellStartPos+this.BAL_LYIndex-1],this.lstTotal[o][this.BAL_LYIndex-1],this.oColumns[this.BAL_LYIndex-1]),-1!=this.YTD_LYIndex&&this.FormatData(this.lstParents[o].Cells[this.CellStartPos+this.YTD_LYIndex-1],this.lstTotal[o][this.YTD_LYIndex-1],this.oColumns[this.YTD_LYIndex-1])),this.ShowTotalBudget&&this.ViewModel.SetCellValue(this.lstTotal[o][this.BalIndex-this.TotalBudgetIndex],this.oColumns[this.BalIndex-this.TotalBudgetIndex].DataFormat,"FLOAT",this.lstParents[o].Cells[this.CellStartPos+this.BalIndex-this.TotalBudgetIndex]),this.ShowBudgetVariance&&(this.ViewModel.SetCellValue(this.lstTotal[o][this.BalIndex+1],this.oColumns[this.BalIndex+1].DataFormat,"FLOAT",this.lstParents[o].Cells[this.CellStartPos+this.BalIndex+1]),-1!=this.YTDIndex&&this.FormatData(this.lstParents[o].Cells[this.CellStartPos+this.YTDIndex+1],this.lstTotal[o][this.YTDIndex+1],this.oColumns[this.YTDIndex+1]),-1!=this.BAL_LYIndex&&this.FormatData(this.lstParents[o].Cells[this.CellStartPos+this.BAL_LYIndex+1],this.lstTotal[o][this.BAL_LYIndex+1],this.oColumns[this.BAL_LYIndex+1]),-1!=this.YTD_LYIndex&&this.FormatData(this.lstParents[o].Cells[this.CellStartPos+this.YTD_LYIndex+1],this.lstTotal[o][this.YTD_LYIndex+1],this.oColumns[this.YTD_LYIndex+1])),this.ShowBudgetVariancePercent){var l=0;this.lstTotal[o][this.BalIndex-1]>0&&(l=100*this.lstTotal[o][this.BalIndex+this.VariancePercentIndex]/this.lstTotal[o][this.BalIndex-1]),this.FormatData(this.lstParents[o].Cells[this.CellStartPos+this.BalIndex+this.VariancePercentIndex],l,this.oColumns[this.BalIndex+this.VariancePercentIndex]),-1!=this.YTDIndex&&(l=0,this.lstTotal[o][this.YTDIndex-1]>0&&(l=100*this.lstTotal[o][this.YTDIndex+this.VariancePercentIndex]/this.lstTotal[o][this.YTDIndex-1]),this.FormatData(this.lstParents[o].Cells[this.CellStartPos+this.YTDIndex+this.VariancePercentIndex],l,this.oColumns[this.YTDIndex+this.VariancePercentIndex])),-1!=this.BAL_LYIndex&&(l=0,this.lstTotal[o][this.BAL_LYIndex-1]>0&&(l=100*this.lstTotal[o][this.BAL_LYIndex+this.VariancePercentIndex]/this.lstTotal[o][this.BAL_LYIndex-1]),this.FormatData(this.lstParents[o].Cells[this.CellStartPos+this.BAL_LYIndex+this.VariancePercentIndex],l,this.oColumns[this.BAL_LYIndex+this.VariancePercentIndex])),-1!=this.YTD_LYIndex&&(l=0,this.lstTotal[o][this.YTD_LYIndex-1]>0&&(l=100*this.lstTotal[o][this.YTD_LYIndex+this.VariancePercentIndex]/this.lstTotal[o][this.YTD_LYIndex-1]),this.FormatData(this.lstParents[o].Cells[this.CellStartPos+this.YTD_LYIndex+this.VariancePercentIndex],l,this.oColumns[this.YTD_LYIndex+this.VariancePercentIndex]))}this.ShowSalesPercentage&&this.dblTotalSales>0&&this.ViewModel.SetCellValue(this.lstTotal[o][this.BalIndex+this.SalesPercentIndex],this.oColumns[this.BalIndex+this.SalesPercentIndex].DataFormat,"FLOAT",this.lstParents[o].Cells[this.CellStartPos+this.BalIndex+this.SalesPercentIndex])}-1!=this.YTDIndex&&this.FormatData(this.lstParents[o].Cells[this.CellStartPos+this.YTDIndex],this.lstTotal[o][this.YTDIndex],this.oColumns[this.YTDIndex]),-1!=this.BAL_LYIndex&&this.FormatData(this.lstParents[o].Cells[this.CellStartPos+this.BAL_LYIndex],this.lstTotal[o][this.BAL_LYIndex],this.oColumns[this.BAL_LYIndex]),-1!=this.YTD_LYIndex&&this.FormatData(this.lstParents[o].Cells[this.CellStartPos+this.YTD_LYIndex],this.lstTotal[o][this.YTD_LYIndex],this.oColumns[this.YTD_LYIndex]);for(var a=0;a<this.CountMonths;a++)this.FormatData(this.lstParents[o].Cells[this.CellStartPos+this.ColumnSize+a],this.lstTotal[o][this.ColumnSize+a],this.oColumns[this.ColumnSize+a])}var r;if(t<=this.LevelNo)!function(){var t=e.TempData.indexOf(e.lstParents[o]);if(t>=0){if(r=e.TempData.find((function(s){return s.Parent==e.TempData[t]})),e.TempData.RemoveAt(t),!e.IsValueExists(e.lstTotal[o])&&null==r)if(e.ReportFormat==T.Horizontal)if(0==e.CellStartPos)t=-1;else if(e.FirstTypeEndIndex<t)t=-1;else{for(var s=e.CellStartPos;s<e.oRow.Cells.length;s++)e.lstParents[o].Cells[s].Text="",e.lstParents[o].Cells[s].Value="";e.GrdRow--}else t=-1;if(-1!=t){if(e.TempData.InsertAt(e.lstParents[o],t),e.IsValueExists(e.lstTotal[o]))if(!e.GroupTotalsAtEnd||e.DontShowSummaryGroupTotals&&!e.lstParents[o].IsExpanded);else{if(e.GrdRow++,e.oSubTotal=e.TempData.length<=e.GrdRow?e.NewReportRow():e.TempData[e.GrdRow],e.oSubTotal.Type=n.f.BalanceBF,e.oSubTotal.Parent=e.lstParents[o].Parent,e.oSubTotal.LevelNo=e.lstParents[o].LevelNo,e.oSubTotal.IsGroup=!0,e.oSubTotal.Visible=e.lstParents[o].Visible,e.oSubTotal.Cells[e.CellStartPos].Text="",e.cell=e.oSubTotal.Cells[e.CellStartPos+e.AccNameIndex],e.cell.IsNormal=!1,e.cell.level=e.lstParents[o].LevelNo,e.cell.Text=e.lstParents[o].Cells[e.CellStartPos+e.AccNameIndex].Text+" - TOTAL",e.cell.CellAppearance=e.GrossTotalAppearance_Data.Clone(),e.cell.CellAppearance.Alignment=e.oColumns[e.AccNameIndex].DataAppearance.Alignment,e.GroupTotalsSeperate?(e.oSubTotal.Cells[e.CellStartPos+e.BalIndex+1].IsNormal=!1,e.oSubTotal.Cells[e.CellStartPos+e.BalIndex+1].CellAppearance=e.GrossTotalAppearance_Data.Clone(),e.oSubTotal.Cells[e.CellStartPos+e.BalIndex+1].CellAppearance.Alignment=e.oColumns[e.BalIndex].DataAppearance.Alignment,e.FormatData(e.oSubTotal.Cells[e.CellStartPos+e.BalIndex+1],e.lstTotal[o][e.BalIndex],e.oColumns[e.BalIndex])):(e.oSubTotal.Cells[e.CellStartPos+e.BalIndex].IsNormal=!1,e.oSubTotal.Cells[e.CellStartPos+e.BalIndex].CellAppearance=e.GrossTotalAppearance_Data.Clone(),e.oSubTotal.Cells[e.CellStartPos+e.BalIndex].CellAppearance.Alignment=e.oColumns[e.BalIndex].DataAppearance.Alignment,e.FormatData(e.oSubTotal.Cells[e.CellStartPos+e.BalIndex],e.lstTotal[o][e.BalIndex],e.oColumns[e.BalIndex])),e.ShowBudget&&(e.oSubTotal.Cells[e.CellStartPos+e.BalIndex-1].IsNormal=!1,e.oSubTotal.Cells[e.CellStartPos+e.BalIndex-1].CellAppearance=e.oSubTotal.Cells[e.CellStartPos+e.BalIndex].CellAppearance,e.FormatData(e.oSubTotal.Cells[e.CellStartPos+e.BalIndex-1],e.lstTotal[o][e.BalIndex-1],e.oColumns[e.BalIndex-1])),e.ShowTotalBudget&&(e.oSubTotal.Cells[e.CellStartPos+e.BalIndex-e.TotalBudgetIndex].IsNormal=!1,e.oSubTotal.Cells[e.CellStartPos+e.BalIndex-e.TotalBudgetIndex].CellAppearance=e.oSubTotal.Cells[e.CellStartPos+e.BalIndex].CellAppearance,e.FormatData(e.oSubTotal.Cells[e.CellStartPos+e.BalIndex-e.TotalBudgetIndex],e.lstTotal[o][e.BalIndex-e.TotalBudgetIndex],e.oColumns[e.BalIndex-e.TotalBudgetIndex])),e.ShowBudgetVariance&&(e.oSubTotal.Cells[e.CellStartPos+e.BalIndex+1].IsNormal=!1,e.oSubTotal.Cells[e.CellStartPos+e.BalIndex+1].CellAppearance=e.oSubTotal.Cells[e.CellStartPos+e.BalIndex].CellAppearance,e.FormatData(e.oSubTotal.Cells[e.CellStartPos+e.BalIndex+1],e.lstTotal[o][e.BalIndex+1],e.oColumns[e.BalIndex+1])),e.ShowBudgetVariancePercent){var i=0;e.lstTotal[o][e.BalIndex-1]>0&&(i=100*e.lstTotal[o][e.BalIndex+e.VariancePercentIndex]/e.lstTotal[o][e.BalIndex-1]),e.oSubTotal.Cells[e.CellStartPos+e.BalIndex+e.VariancePercentIndex].IsNormal=!1,e.oSubTotal.Cells[e.CellStartPos+e.BalIndex+e.VariancePercentIndex].CellAppearance=e.oSubTotal.Cells[e.CellStartPos+e.BalIndex].CellAppearance,e.FormatData(e.oSubTotal.Cells[e.CellStartPos+e.BalIndex+e.VariancePercentIndex],i,e.oColumns[e.BalIndex+e.VariancePercentIndex])}e.ShowSalesPercentage&&e.dblTotalSales>0&&(e.oSubTotal.Cells[e.CellStartPos+e.BalIndex+e.SalesPercentIndex].IsNormal=!1,e.oSubTotal.Cells[e.CellStartPos+e.BalIndex+e.SalesPercentIndex].CellAppearance=e.oSubTotal.Cells[e.CellStartPos+e.BalIndex].CellAppearance,e.FormatData(e.oSubTotal.Cells[e.CellStartPos+e.BalIndex+e.SalesPercentIndex],e.lstTotal[o][e.BalIndex+e.SalesPercentIndex],e.oColumns[e.BalIndex+e.SalesPercentIndex])),-1!=e.YTDIndex&&(e.oSubTotal.Cells[e.CellStartPos+e.YTDIndex].IsNormal=!1,e.oSubTotal.Cells[e.CellStartPos+e.YTDIndex].CellAppearance=e.GrossTotalAppearance_Data.Clone(),e.oSubTotal.Cells[e.CellStartPos+e.YTDIndex].CellAppearance.Alignment=e.oColumns[e.YTDIndex].DataAppearance.Alignment,e.FormatData(e.oSubTotal.Cells[e.CellStartPos+e.YTDIndex],e.lstTotal[o][e.YTDIndex],e.oColumns[e.YTDIndex])),-1!=e.BAL_LYIndex&&(e.oSubTotal.Cells[e.CellStartPos+e.BAL_LYIndex].IsNormal=!1,e.oSubTotal.Cells[e.CellStartPos+e.BAL_LYIndex].CellAppearance=e.GrossTotalAppearance_Data.Clone(),e.oSubTotal.Cells[e.CellStartPos+e.BAL_LYIndex].CellAppearance.Alignment=e.oColumns[e.BAL_LYIndex].DataAppearance.Alignment,e.FormatData(e.oSubTotal.Cells[e.CellStartPos+e.BAL_LYIndex],e.lstTotal[o][e.BAL_LYIndex],e.oColumns[e.BAL_LYIndex])),-1!=e.YTD_LYIndex&&(e.oSubTotal.Cells[e.CellStartPos+e.YTD_LYIndex].IsNormal=!1,e.oSubTotal.Cells[e.CellStartPos+e.YTD_LYIndex].CellAppearance=e.GrossTotalAppearance_Data.Clone(),e.oSubTotal.Cells[e.CellStartPos+e.YTD_LYIndex].CellAppearance.Alignment=e.oColumns[e.YTD_LYIndex].DataAppearance.Alignment,e.FormatData(e.oSubTotal.Cells[e.CellStartPos+e.YTD_LYIndex],e.lstTotal[o][e.YTD_LYIndex],e.oColumns[e.YTD_LYIndex]));for(var l=0;l<e.CountMonths;l++)e.oSubTotal.Cells[e.CellStartPos+e.ColumnSize+l].IsNormal=!1,e.oSubTotal.Cells[e.CellStartPos+e.ColumnSize+l].CellAppearance=e.GrossTotalAppearance_Data.Clone(),e.oSubTotal.Cells[e.CellStartPos+e.ColumnSize+l].CellAppearance.Alignment=e.oColumns[e.ColumnSize+l].DataAppearance.Alignment,e.FormatData(e.oSubTotal.Cells[e.CellStartPos+e.ColumnSize+l],e.lstTotal[o][e.ColumnSize+l],e.oColumns[e.ColumnSize+l]);e.TempData.length<=e.GrdRow?e.TempData.push(e.oSubTotal):(e.TempData.RemoveAt(e.GrdRow),e.TempData.InsertAt(e.oSubTotal,e.GrdRow))}}else e.GrdRow--}}();this.lstParents.RemoveAt(o),this.lstTotal.RemoveAt(o)}else this.lstParents.RemoveAt(o),this.lstTotal.RemoveAt(o)}}},{key:"GetBudgetAmount",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=0;if(null!=e){var l,a=e;t.forEach((function(t){for(a=e;a<=s;)l=a.ToString("MMMyyyy"),o+=i.e.Double(t[l]),a=a.AddMonths(1)}))}else t.forEach((function(t){o+=parseFloat(t.AnnualAmount)}));return o}},{key:"IsValueExists",value:function(t){return!!t.find((function(t){return 0!=t}))}},{key:"LoadPlainReport",value:function(){this.STACKROWS.Clear(),this.lstTotal.Clear(),this.AddOpeningStock();for(var t=0;t<this.dv.length;t++)this.drAccount=this.dv[t],this.IsIncome=this.IncomeAccounts.Contains(parseInt(this.drAccount.AccountTypeID)),this.ReportTotalIndex=this.IsIncome?0:1,Object(l.j)(this.drAccount.IsGroup)?(this.dbl=0,this.AddRow_Plain()):(this.dbl=i.e.Double(this.drAccount.Balance),(Math.abs(this.dbl)>.01||this.ShowAllAccounts)&&this.AddRow_Plain());this.AddClosingStock(),this.UpdateTreeTotals_Plain(999999999999,0),this.AddOpenBalanceDifference(),this.AddOpenBalanceDifferenceForBS(),7==this.ViewModel.StaticReportType?(this.dbl=this.ReportTotal[0]+this.ReportTotal[1],this.ShowGrossInIncome=!(this.dbl>=0),Math.abs(this.ReportTotal[0])>Math.abs(this.ReportTotal[1])?this.ReportTotal[1]=this.ReportTotal[1]-this.dbl:this.ReportTotal[0]=this.ReportTotal[0]-this.dbl,this.dbl<0&&(this.dbl=-this.dbl)):(this.dbl=this.ReportTotal[0]+this.ReportTotal[1],this.ReportTotal[0]=-this.ReportTotal[0],this.ReportTotal[0]>this.ReportTotal[1]?this.ReportTotal[1]=this.ReportTotal[0]>0?this.ReportTotal[0]:this.ReportTotal[0]=0:this.ReportTotal[0]=this.ReportTotal[1]>0?this.ReportTotal[1]:this.ReportTotal[1]=0,this.ShowGrossInIncome=!(Math.abs(this.ReportTotal[0])>=Math.abs(this.ReportTotal[1])&&this.dbl<0),this.dbl<0&&(this.dbl=-this.dbl)),this.AddReportTotal_Plain()}},{key:"AddRow_Plain",value:function(){var t=this;if(this.IsAddRow=0,this.oRow=this.NewReportRow(),this.oRow.IsGroup=Object(l.j)(this.drAccount.IsGroup),this.oRow.NodeID=parseInt(this.drAccount.AccountID),this.oRow.LevelNo=parseInt(this.drAccount.Depth)-1,this.oRow.DataRow=this.drAccount,this.IsAccountWise||(this.oRow.Cells[this.CellStartPos+this.BalIndex-1].IsNormal=!1,this.oRow.Cells[this.CellStartPos+this.BalIndex-1].level=this.oRow.LevelNo,this.UpdateTreeTotals_Plain(parseInt(this.drAccount.lft),this.oRow.LevelNo)),Object(l.j)(this.drAccount.IsGroup)){this.oRow.Type=n.f.BalanceBF;for(var e=this.CellStartPos;e<this.oRow.Cells.length;e++)this.oRow.Cells[e].IsNormal=!1,this.oRow.Cells[e].CellAppearance=this.BalanceBFAppearance.Clone(),this.oRow.Cells[e].CellAppearance.Alignment=this.ViewModel.ReportColumns[e].DataAppearance.Alignment}if(this.oRow.LevelNo<=this.LevelNo&&(this.GrdRow++,this.IsAddRow=1),Object(l.j)(this.drAccount.IsGroup)){var s=new u;s.Row=this.oRow,s.Lft=parseInt(this.drAccount.lft),s.Rgt=parseInt(this.drAccount.rgt),this.STACKROWS.push(s),this.lstTotal.push(new Array(this.oColumns.length+1).fill(0))}else this.ReportTotal[this.ReportTotalIndex]+=this.dbl;this.TextFields.keys.forEach((function(e){var s=t.TextFields[e];t.oRow.Cells[t.CellStartPos+s].Text=t.drAccount[e].toString(),t.oRow.Cells[t.CellStartPos+s].Value=t.oRow.Cells[t.CellStartPos+s].Text})),this.oRow.IsGroup||(this.FormatData(this.ClubIncomeExpenseInPlainReport?this.oRow.Cells[this.CellStartPos+this.BalIndex]:this.IsIncome&&!this.ShowIncomeFirst||!this.IsIncome&&this.ShowIncomeFirst?this.oRow.Cells[this.CellStartPos+this.BalIndex+1]:this.oRow.Cells[this.CellStartPos+this.BalIndex],this.dbl,this.oColumns[this.BalIndex]),this.ViewModel.ApplyKPI(this.oRow)),this.lstTotal.length>0&&(this.IsIncome?this.lstTotal[this.lstTotal.length-1][this.BalIndex]+=this.dbl:this.lstTotal[this.lstTotal.length-1][this.BalIndex+1]+=this.dbl),1==this.IsAddRow&&(this.ShowdetailsofControlGroups||(this.oRow.IsExpanded=!Object(l.j)(this.drAccount.IsSummary),Object(l.j)(this.drAccount.IsSummary)&&(this.oRow.Type=n.f.Detail),this.oRow.IsGroup?this.STACKROWS.length>1&&(this.oRow.Parent=this.STACKROWS[this.STACKROWS.length-2].Row):this.STACKROWS.length>0&&(this.oRow.Parent=this.STACKROWS[this.STACKROWS.length-1].Row),null==this.oRow.Parent||this.oRow.Parent.IsExpanded&&this.oRow.Parent.Visible||(this.oRow.Visible=!1)),this.TempData.push(this.oRow))}},{key:"UpdateTreeTotals_Plain",value:function(t,e){for(var s=this.lstTotal.length-1;s>=0&&t>this.STACKROWS[s].Rgt;s--){if(s>0)for(var o=0;o<this.lstTotal[s].length;o++)this.lstTotal[s-1][o]+=this.lstTotal[s][o];if(e<=this.LevelNo){var i=this.TempData.indexOf(this.STACKROWS[s].Row);if(i>=0)if(0==this.lstTotal[s][this.BalIndex]&&0==this.lstTotal[s][this.BalIndex+1])this.TempData.RemoveAt(i);else{if(!this.GroupTotalsAtEnd||this.DontShowSummaryGroupTotals&&!this.STACKROWS[s].Row.IsExpanded?this.oTempRow=this.STACKROWS[s].Row:(this.oSubTotal=this.NewReportRow(),this.oTempRow=this.oSubTotal,this.oSubTotal.Type=n.f.BalanceBF,this.oSubTotal.Parent=this.STACKROWS[s].Row.Parent,this.oSubTotal.LevelNo=this.STACKROWS[s].Row.LevelNo,this.oSubTotal.IsGroup=!0,this.oSubTotal.Visible=this.STACKROWS[s].Row.Visible,this.cell=this.oSubTotal.Cells[this.CellStartPos+this.BalIndex-1],this.cell.IsNormal=!1,this.cell.level=this.STACKROWS[s].Row.LevelNo,this.cell.Text=this.STACKROWS[s].Row.Cells[this.BalIndex-1].Text+" - TOTAL",this.cell.CellAppearance=this.GrossTotalAppearance_Data.Clone(),this.cell.CellAppearance.Alignment=this.oColumns[this.BalIndex-1].DataAppearance.Alignment,this.GroupTotalsSeperate?(this.oSubTotal.Cells[this.GroupTotalIndex].IsNormal=!1,this.oSubTotal.Cells[this.GroupTotalIndex].CellAppearance=this.GrossTotalAppearance_Data.Clone(),this.oSubTotal.Cells[this.GroupTotalIndex].CellAppearance.Alignment=this.oColumns[this.BalIndex].DataAppearance.Alignment):(this.oSubTotal.Cells[this.BalIndex].IsNormal=!1,this.oSubTotal.Cells[this.BalIndex].CellAppearance=this.GrossTotalAppearance_Data.Clone(),this.oSubTotal.Cells[this.BalIndex].CellAppearance.Alignment=this.oColumns[this.BalIndex].DataAppearance.Alignment,this.ClubIncomeExpenseInPlainReport||(this.oSubTotal.Cells[this.BalIndex+1].IsNormal=!1,this.oSubTotal.Cells[this.BalIndex+1].CellAppearance=this.GrossTotalAppearance_Data.Clone(),this.oSubTotal.Cells[this.BalIndex+1].CellAppearance.Alignment=this.oColumns[this.BalIndex+1].DataAppearance.Alignment))),this.GroupTotalsSeperate)7!=this.ViewModel.StaticReportType?(this.dblTemp=-(this.lstTotal[s][this.BalIndex]+this.lstTotal[s][this.BalIndex+1]),this.dblTemp=Math.abs(this.dblTemp),this.ViewModel.SetCellValue(this.dblTemp,this.oColumns[this.BalIndex].DataFormat,"FLOAT",this.oTempRow.Cells[this.GroupTotalIndex])):(this.dblTemp=this.lstTotal[s][this.BalIndex]+this.lstTotal[s][this.BalIndex+1],this.dblTemp=Math.abs(this.dblTemp),this.ViewModel.SetCellValue(this.dblTemp,this.oColumns[this.BalIndex].DataFormat,"FLOAT",this.oTempRow.Cells[this.GroupTotalIndex]));else if(this.ClubIncomeExpenseInPlainReport)7!=this.ViewModel.StaticReportType?(this.dblTemp=-(this.lstTotal[s][this.BalIndex]+this.lstTotal[s][this.BalIndex+1]),this.dblTemp=Math.abs(this.dblTemp),this.ViewModel.SetCellValue(this.dblTemp,this.oColumns[this.BalIndex].DataFormat,"FLOAT",this.oTempRow.Cells[this.CellStartPos+this.BalIndex])):(this.dblTemp=this.lstTotal[s][this.BalIndex]+this.lstTotal[s][this.BalIndex+1],this.dblTemp=Math.abs(this.dblTemp),this.ViewModel.SetCellValue(this.dblTemp,this.oColumns[this.BalIndex].DataFormat,"FLOAT",this.oTempRow.Cells[this.CellStartPos+this.BalIndex]));else{var l=void 0,a=void 0;this.ShowIncomeFirst?(l=this.oTempRow.Cells[this.CellStartPos+this.BalIndex],a=this.oTempRow.Cells[this.CellStartPos+this.BalIndex+1]):(l=this.oTempRow.Cells[this.CellStartPos+this.BalIndex+1],a=this.oTempRow.Cells[this.CellStartPos+this.BalIndex]),7!=this.ViewModel.StaticReportType?(this.lstTotal[s][this.BalIndex]<=0?this.ViewModel.SetCellValue(-this.lstTotal[s][this.BalIndex],this.oColumns[this.BalIndex].DataFormat,"FLOAT",l):(this.ViewModel.SetCellValue(this.lstTotal[s][this.BalIndex],this.oColumns[this.BalIndex].DataFormat,"FLOAT",l),l.Text+="Dr"),this.lstTotal[s][this.BalIndex+1]>=0?this.ViewModel.SetCellValue(this.lstTotal[s][this.BalIndex+1],this.oColumns[this.BalIndex].DataFormat,"FLOAT",a):(this.ViewModel.SetCellValue(-this.lstTotal[s][this.BalIndex+1],this.oColumns[this.BalIndex].DataFormat,"FLOAT",a),a.Text+="Cr")):(this.lstTotal[s][this.BalIndex]>=0?this.ViewModel.SetCellValue(this.lstTotal[s][this.BalIndex],this.oColumns[this.BalIndex].DataFormat,"FLOAT",l):(this.ViewModel.SetCellValue(-this.lstTotal[s][this.BalIndex],this.oColumns[this.BalIndex].DataFormat,"FLOAT",l),l.Text+="Cr"),this.lstTotal[s][this.BalIndex+1]<=0?this.ViewModel.SetCellValue(-this.lstTotal[s][this.BalIndex+1],this.oColumns[this.BalIndex].DataFormat,"FLOAT",a):(this.ViewModel.SetCellValue(this.lstTotal[s][this.BalIndex+1],this.oColumns[this.BalIndex].DataFormat,"FLOAT",a),a.Text+="Dr"))}!this.GroupTotalsAtEnd||this.DontShowSummaryGroupTotals&&!this.STACKROWS[s].Row.IsExpanded?(this.TempData.RemoveAt(i),this.TempData.InsertAt(this.STACKROWS[s].Row,i)):(this.GrdRow++,this.TempData.push(this.oSubTotal))}}this.STACKROWS.RemoveAt(s),this.lstTotal.RemoveAt(s)}}},{key:"AddReportTotal_Plain",value:function(){var t=null,e=null;if(this.GrdRow++,(e=this.NewReportRow_2(n.f.GrossTotal,this.GrossTotalAppearance_Data)).LevelNo=0,this.GrdRow++,t=this.NewReportRow_2(n.f.ReportTotal,this.ViewModel.GrpReportTotal.SubTotalAppearance),this.ViewModel.GrpReportTotal.Height>0&&(t.Height=this.ViewModel.GrpReportTotal.Height),t.Cells[this.CellStartPos].Text=o.a.GetResource("Reports_ReportTotal"),t.LevelNo=0,this.GrossCellIndex=this.CellStartPos+this.BalIndex,e.Cells[this.CellStartPos+this.BalIndex-1].CellAppearance=this.GrossTotalAppearance,1==this.ShowGrossInIncome?(this.ClubIncomeExpenseInPlainReport||this.ShowIncomeFirst||this.GrossCellIndex++,this.dbl>=0?this.ViewModel.SetCellValue(this.dbl,this.oColumns[this.BalIndex].DataFormat,"FLOAT",e.Cells[this.GrossCellIndex]):(this.ViewModel.SetCellValue(-this.dbl,this.oColumns[this.BalIndex].DataFormat,"FLOAT",e.Cells[this.GrossCellIndex]),e.Cells[this.GrossCellIndex].Text+="Dr"),this.SetPLText(e.Cells[this.CellStartPos+this.BalIndex-1],"Reports_LblNetLossForPeriod"),this.SetPLTextColor(e.Cells[this.GrossCellIndex],"Reports_LblNetLossForPeriod")):(!this.ClubIncomeExpenseInPlainReport&&this.ShowIncomeFirst&&this.GrossCellIndex++,this.dbl>=0?this.ViewModel.SetCellValue(this.dbl,this.oColumns[this.BalIndex].DataFormat,"FLOAT",e.Cells[this.GrossCellIndex]):(this.ViewModel.SetCellValue(-this.dbl,this.oColumns[this.BalIndex].DataFormat,"FLOAT",e.Cells[this.GrossCellIndex]),e.Cells[this.GrossCellIndex].Text+="Cr"),this.SetPLText(e.Cells[this.CellStartPos+this.BalIndex-1],"Reports_LblNetProfitForPeriod"),this.SetPLTextColor(e.Cells[this.GrossCellIndex],"Reports_LblNetProfitForPeriod")),this.ClubIncomeExpenseInPlainReport)this.ViewModel.SetCellValue(Math.abs(this.ReportTotal[0])-Math.abs(this.ReportTotal[1]),this.oColumns[this.BalIndex].DataFormat,"FLOAT",t.Cells[this.CellStartPos+this.BalIndex]),t.Cells[this.CellStartPos+this.BalIndex].CellAppearance.Alignment="Right";else{var s=t.Cells[this.CellStartPos+this.BalIndex],i=t.Cells[this.CellStartPos+this.BalIndex+1];this.ShowIncomeFirst||(s=t.Cells[this.CellStartPos+this.BalIndex+1],i=t.Cells[this.CellStartPos+this.BalIndex]),this.ViewModel.SetCellValue(Math.abs(this.ReportTotal[0]),this.oColumns[this.BalIndex].DataFormat,"FLOAT",s),this.ViewModel.SetCellValue(Math.abs(this.ReportTotal[1]),this.oColumns[this.BalIndex].DataFormat,"FLOAT",i),s.CellAppearance.Alignment=i.CellAppearance.Alignment="Right"}t.Cells[this.CellStartPos].ColSpan=this.CellStartPos+this.BalIndex,this.IgnoreGrossRowsForBS||(0==this.RetainedEarningAccount||Math.abs(this.dbl)>.01)&&this.TempData.push(e),this.ViewModel.GrpReportTotal.GroupAppearance.IsVisible&&this.TempData.push(t)}},{key:"AddNetProfitBeforeOtherIncome",value:function(){if(-1!=this.ReportRowStartIndex&&this.ShowNetProfitBeforeAndAfter&&(this.oRow=null,this.ReportFormat==T.Vertical?this.IsFirstCall&&(this.GrdRow++,this.oRow=this.NewReportRow_2(n.f.GrossTotal,this.GrossTotalAppearance_Data),this.oRow.LevelNo=0,this.TempData.push(this.oRow)):this.ReportFormat==T.Horizontal&&(this.IsFirstCall&&(this.GrdRow++,this.oRow=this.NewReportRow_2(n.f.GrossTotal,this.GrossTotalAppearance_Data),this.oRow.LevelNo=0,this.TempData.InsertAt(this.oRow,this.GrdRow)),this.IsIncome&&(this.oRow=null)),null!=this.oRow)){var t=this.Olddbl-this.ReportTotal[1];this.ShowGrossInIncome&&!this.IsIncome&&(t=-this.ReportTotal[1]),t>0?(this.oRow.Cells[this.CellStartPos+this.AccNameIndex].Text=o.a.GetResource("Reports_LblNetProfitBefore").toUpperCase(),this.ViewModel.Preferences.ContainsKey("Reports_LblNetProfitForPeriodClr")&&(this.oRow.Cells[this.CellStartPos+this.AccNameIndex].CellAppearance.ForeColor=this.ViewModel.Preferences.Reports_LblNetProfitForPeriodClr,this.oRow.Cells[this.CellStartPos+this.BalIndex].CellAppearance.ForeColor=this.ViewModel.Preferences.Reports_LblNetProfitForPeriodClr)):(t=-t,this.oRow.Cells[this.CellStartPos+this.AccNameIndex].Text=o.a.GetResource("Reports_LblNetLossBefore").toUpperCase(),this.ViewModel.Preferences.ContainsKey("Reports_LblNetLossForPeriodClr")&&(this.oRow.Cells[this.CellStartPos+this.AccNameIndex].CellAppearance.ForeColor=this.ViewModel.Preferences.Reports_LblNetLossForPeriodClr,this.oRow.Cells[this.CellStartPos+this.BalIndex].CellAppearance.ForeColor=this.ViewModel.Preferences.Reports_LblNetLossForPeriodClr)),this.oRow.Cells[this.CellStartPos+this.AccNameIndex].CellAppearance.Alignment="Left",this.ViewModel.SetCellValue(t,this.oColumns[this.BalIndex].DataFormat,"FLOAT",this.oRow.Cells[this.CellStartPos+this.BalIndex]),this.ShowSalesPercentage&&this.dblTotalSales>0&&(this.dblTemp=100*t/this.dblTotalSales,this.ViewModel.SetCellValue(this.dblTemp,this.oColumns[this.BalIndex+this.SalesPercentIndex].DataFormat,"FLOAT",this.oRow.Cells[this.BalIndex+this.SalesPercentIndex]));for(var e=0;e<this.CountMonths;e++)this.dblTemp=this.OldReportTotalMonthWise[0][e]+this.OldReportTotalMonthWise[1][e]+(this.ReportTotalMonthWise[0][e]+this.ReportTotalMonthWise[1][e]),t>0&&(this.dblTemp=-this.dblTemp),this.ViewModel.SetCellValue(this.dblTemp,this.oColumns[this.CellStartPos+this.ColumnSize+e].DataFormat,"FLOAT",this.oRow.Cells[this.CellStartPos+this.ColumnSize+e]);this.TempData.RemoveAt(this.GrdRow),this.TempData.InsertAt(this.oRow,this.GrdRow)}}},{key:"AddRow_BF",value:function(){this.oRow=this.NewReportRow_2(n.f.GrossTotal,this.GrossTotalAppearance_Data),this.oRow.LevelNo=0,this.ReportFormat==T.Vertical?this.ShowGrossInIncome&&!this.IsIncome?(this.ReportTotal[1]=this.Olddbl,this.AddGrossToVariance&&(this.ShowBudgetVariance&&(this.ReportTotalALL[1][this.BalIndex+1]=-this.Olddbl),this.ShowBudgetVariancePercent&&(this.ReportTotalALL[1][this.BalIndex+this.VariancePercentIndex]=-this.Olddbl)),this.ShowCarryForward&&(this.GrdRow++,this.oRow.Cells[this.AccNameIndex].Text=o.a.GetResource("Reports_BalanceBF"),this.ViewModel.SetCellValue(this.Olddbl,this.oColumns[this.BalIndex].DataFormat,"FLOAT",this.oRow.Cells[this.BalIndex]),this.AddGrossToVariance&&this.ShowBudgetVariance&&this.ViewModel.SetCellValue(this.ReportTotalALL[1][this.BalIndex+1],this.oColumns[this.BalIndex+1].DataFormat,"FLOAT",this.oRow.Cells[this.BalIndex+1]),this.TempData.push(this.oRow))):!this.ShowGrossInIncome&&this.IsIncome&&(this.ReportTotal[0]=-this.Olddbl,this.AddGrossToVariance&&(this.ShowBudgetVariance&&(this.ReportTotalALL[0][this.BalIndex+1]=this.Olddbl),this.ShowBudgetVariancePercent&&(this.ReportTotalALL[0][this.BalIndex+this.VariancePercentIndex]=this.Olddbl)),this.ShowCarryForward&&(this.GrdRow++,this.oRow.Cells[this.AccNameIndex].Text=o.a.GetResource("Reports_BalanceBF"),this.ViewModel.SetCellValue(this.Olddbl,this.oColumns[this.BalIndex].DataFormat,"FLOAT",this.oRow.Cells[this.BalIndex]),this.AddGrossToVariance&&this.ShowBudgetVariance&&this.ViewModel.SetCellValue(this.ReportTotalALL[0][this.BalIndex+1],this.oColumns[this.BalIndex+1].DataFormat,"FLOAT",this.oRow.Cells[this.BalIndex+1]),this.TempData.push(this.oRow))):(this.ShowCarryForward&&this.GrdRow++,this.IsFirstCall&&(this.ShowCarryForward&&(this.ShowIncomeFirst&&!this.ShowGrossInIncome||!this.ShowIncomeFirst&&this.ShowGrossInIncome?(this.oRow.Cells[this.AccNameIndex].Text=o.a.GetResource("Reports_BalanceBF"),this.ViewModel.SetCellValue(this.Olddbl,this.oColumns[this.BalIndex].DataFormat,"FLOAT",this.oRow.Cells[this.BalIndex]),this.TempData.push(this.oRow)):(this.oRow.Cells[this.ColumnSize+this.AccNameIndex].Text=o.a.GetResource("Reports_BalanceBF"),this.ViewModel.SetCellValue(this.Olddbl,this.oColumns[this.BalIndex].DataFormat,"FLOAT",this.oRow.Cells[this.ColumnSize+this.BalIndex]),this.TempData.push(this.oRow))),this.ShowGrossInIncome?this.ReportTotal[1]=this.Olddbl:this.ReportTotal[0]=-this.Olddbl))}},{key:"AddOpeningStock",value:function(){var t=this;(this.IncludeOpeningStock||0!=this.ClosingStockAccount)&&(0!=this.ClosingStockAccount&&(this.dblOpeningStock=0,this.dsNew.Tables[0].filter((function(e){return e.AccountID==t.ClosingStockAccount})).forEach((function(e){t.dblOpeningStock+=i.e.Double(e.Balance)}))),this.ReportFormat==T.Plain?(this.GrdRow++,this.oRow=this.NewReportRow_2(n.f.GrossTotal,this.GrossTotalAppearance_Data),this.oRow.Cells[this.AccNameIndex].CellAppearance=this.GrossTotalAppearance,this.oRow.Cells[this.AccNameIndex].Text=o.a.GetResource("Reports_LblOpeningStock"),this.ViewModel.SetCellValue(this.dblOpeningStock,this.oColumns[this.BalIndex].DataFormat,"FLOAT",this.ShowIncomeFirst?this.oRow.Cells[this.CellStartPos+this.BalIndex+1]:this.oRow.Cells[this.CellStartPos+this.BalIndex]),this.TempData.push(this.oRow)):this.ReportFormat==T.Vertical?(this.GrdRow++,this.oRow=this.NewReportRow_2(n.f.GrossTotal,this.GrossTotalAppearance_Data),this.oRow.Cells[this.AccNameIndex].CellAppearance=this.GrossTotalAppearance,this.oRow.Cells[this.AccNameIndex].Text=o.a.GetResource("Reports_LblOpeningStock"),this.ViewModel.SetCellValue(this.dblOpeningStock,this.oColumns[this.BalIndex].DataFormat,"FLOAT",this.oRow.Cells[this.CellStartPos+this.BalIndex]),null!=this.dsOpeningStock&&function(){for(var e,s=0;s<t.CountMonths;s++)if(i.e.IsNum(t.oColumns[t.CellStartPos+t.ColumnSize+s].ID)){e=i.e.Int(t.oColumns[t.CellStartPos+t.ColumnSize+s].ID),t.dblTemp=0;var o=t.dsOpeningStock.Tables[0].filter((function(t){return t.TagID==e}));o.length>0&&(t.dblTemp=parseFloat(o[0].BalValue)),t.ReportTotalMonthWise[1][s]=t.IsIncomeNegative?t.dblTemp:-t.dblTemp,t.ViewModel.SetCellValue(t.dblTemp,t.oColumns[t.CellStartPos+t.ColumnSize+s].DataFormat,"FLOAT",t.oRow.Cells[t.CellStartPos+t.ColumnSize+s])}}(),this.TempData.push(this.oRow)):this.ReportFormat==T.Horizontal&&(this.GrdRow++,this.IsFirstCall||this.GrdRow>this.FirstTypeEndIndex?(this.oRow=this.NewReportRow_2(n.f.GrossTotal,this.GrossTotalAppearance_Data),this.oRow.Cells[this.CellStartPos+this.AccNameIndex].CellAppearance=this.GrossTotalAppearance,this.oRow.Cells[this.CellStartPos+this.AccNameIndex].Text=o.a.GetResource("Reports_LblOpeningStock"),this.ViewModel.SetCellValue(this.dblOpeningStock,this.oColumns[this.BalIndex].DataFormat,"FLOAT",this.oRow.Cells[this.CellStartPos+this.BalIndex]),this.TempData.push(this.oRow)):(this.oRow=this.TempData[this.GrdRow],this.oRow.Cells[this.CellStartPos+this.AccNameIndex].IsNormal=!1,this.oRow.Cells[this.CellStartPos+this.AccNameIndex].CellAppearance=this.GrossTotalAppearance,this.oRow.Cells[this.CellStartPos+this.AccNameIndex].Text=o.a.GetResource("Reports_LblOpeningStock"),this.oRow.Cells[this.CellStartPos+this.BalIndex].IsNormal=!1,this.oRow.Cells[this.CellStartPos+this.BalIndex].CellAppearance=this.GrossTotalAppearance_Data,this.ViewModel.SetCellValue(this.dblOpeningStock,this.oColumns[this.BalIndex].DataFormat,"FLOAT",this.oRow.Cells[this.CellStartPos+this.BalIndex]),this.TempData.Remove(this.oRow),this.TempData.InsertAt(this.oRow,this.GrdRow))),this.ReportTotal[1]=this.IsIncomeNegative?this.dblOpeningStock:-this.dblOpeningStock)}},{key:"AddClosingStock",value:function(){var t=this;this.IncludeClosingStock&&(this.ReportFormat==T.Plain?(this.GrdRow++,this.oRow=this.NewReportRow_2(n.f.GrossTotal,this.GrossTotalAppearance_Data),this.oRow.Cells[this.AccNameIndex].CellAppearance=this.GrossTotalAppearance,this.oRow.Cells[this.AccNameIndex].Text=o.a.GetResource("Reports_LblClosingStock"),this.ViewModel.SetCellValue(this.dblClosingStock,this.oColumns[this.BalIndex].DataFormat,"FLOAT",this.ShowIncomeFirst?this.oRow.Cells[this.CellStartPos+this.BalIndex]:this.oRow.Cells[this.CellStartPos+this.BalIndex+1]),this.TempData.push(this.oRow)):this.ReportFormat==T.Vertical?(this.GrdRow++,this.oRow=this.NewReportRow_2(n.f.GrossTotal,this.GrossTotalAppearance_Data),this.oRow.Cells[this.AccNameIndex].CellAppearance=this.GrossTotalAppearance,this.oRow.Cells[this.AccNameIndex].Text=o.a.GetResource("Reports_LblClosingStock"),this.ViewModel.SetCellValue(this.dblClosingStock,this.oColumns[this.BalIndex].DataFormat,"FLOAT",this.oRow.Cells[this.CellStartPos+this.BalIndex]),null!=this.dsClosingStock&&function(){for(var e,s=0;s<t.CountMonths;s++)if(i.e.IsNum(t.oColumns[t.CellStartPos+t.ColumnSize+s].ID)){e=i.e.Int(t.oColumns[t.CellStartPos+t.ColumnSize+s].ID),t.dblTemp=0;var o=t.dsClosingStock.Tables[0].filter((function(t){return t.TagID==e}));o.length>0&&(t.dblTemp=parseFloat(o[0].BalValue)),t.ReportTotalMonthWise[0][s]=t.IsIncomeNegative?t.ReportTotalMonthWise[0][s]-t.dblTemp:t.ReportTotalMonthWise[0][s]+t.dblTemp,t.ViewModel.SetCellValue(t.dblTemp,t.oColumns[t.CellStartPos+t.ColumnSize+s].DataFormat,"FLOAT",t.oRow.Cells[t.CellStartPos+t.ColumnSize+s])}}(),this.TempData.push(this.oRow)):this.ReportFormat==T.Horizontal&&(this.GrdRow++,this.IsFirstCall||this.GrdRow>this.FirstTypeEndIndex?(this.oRow=this.NewReportRow_2(n.f.GrossTotal,this.GrossTotalAppearance_Data),this.oRow.Cells[this.CellStartPos+this.AccNameIndex].CellAppearance=this.GrossTotalAppearance,this.oRow.Cells[this.CellStartPos+this.AccNameIndex].Text=o.a.GetResource("Reports_LblClosingStock"),this.ViewModel.SetCellValue(this.dblClosingStock,this.oColumns[this.BalIndex].DataFormat,"FLOAT",this.oRow.Cells[this.CellStartPos+this.BalIndex]),this.TempData.push(this.oRow)):(this.oRow=this.TempData[this.GrdRow],this.oRow.Cells[this.CellStartPos+this.AccNameIndex].IsNormal=!1,this.oRow.Cells[this.CellStartPos+this.AccNameIndex].CellAppearance=this.GrossTotalAppearance,this.oRow.Cells[this.CellStartPos+this.AccNameIndex].Text=o.a.GetResource("Reports_LblClosingStock"),this.oRow.Cells[this.CellStartPos+this.BalIndex].IsNormal=!1,this.oRow.Cells[this.CellStartPos+this.BalIndex].CellAppearance=this.GrossTotalAppearance_Data,this.ViewModel.SetCellValue(this.dblClosingStock,this.oColumns[this.BalIndex].DataFormat,"FLOAT",this.oRow.Cells[this.CellStartPos+this.BalIndex]),this.TempData.Remove(this.oRow),this.TempData.InsertAt(this.oRow,this.GrdRow))),this.ReportTotal[0]=this.IsIncomeNegative?this.ReportTotal[0]-this.dblClosingStock:this.ReportTotal[0]+this.dblClosingStock)}},{key:"AddGroup",value:function(t){this.ReportFormat==T.Vertical?(this.GrdRow++,this.row=this.NewReportRow_2(n.f.Header,this.IncomeExpenseHeader),this.row.Height=this.row.Height+3,this.row.LevelNo=0):this.ReportFormat==T.Horizontal&&(this.GrdRow++,this.IsFirstCall?(this.row=this.NewReportRow_2(n.f.Header,this.IncomeExpenseHeader),this.row.Height=this.row.Height+2,this.row.LevelNo=0):this.row=this.TempData[this.GrdRow]),this.row.Cells[this.CellStartPos].Text=t,null!=this.row.Cells[this.CellStartPos].CellAppearance&&(this.row.Cells[this.CellStartPos].CellAppearance.Alignment="Center"),this.row.Cells[this.CellStartPos].ColSpan=this.ColumnSize,i.e.IsEmpty(t)&&(this.row.Visible=!1),-1==this.TempData.indexOf(this.row)?this.TempData.push(this.row):(this.TempData.RemoveAt(this.GrdRow),this.TempData.InsertAt(this.row,this.GrdRow))}},{key:"FormatData",value:function(t,e,s){if(4==this.NegNumber)this.IsIncomeNegative&&this.IsIncome||!this.IsIncomeNegative&&!this.IsIncome?e<=0?this.ViewModel.SetCellValue(-e,s.DataFormat,"FLOAT",t):(this.ViewModel.SetCellValue(e,s.DataFormat,"FLOAT",t),s.DataFormat.NumberFormat.length>0&&(t.Text+=" "),t.Text+="Dr"):e>=0?this.ViewModel.SetCellValue(e,s.DataFormat,"FLOAT",t):(this.ViewModel.SetCellValue(-e,s.DataFormat,"FLOAT",t),s.DataFormat.NumberFormat.length>0&&(t.Text+=" "),t.Text+="Cr");else{var o="",i="";this.IsIncomeNegative&&this.IsIncome||!this.IsIncomeNegative&&!this.IsIncome?e<=0?this.SetCellValue(-e,s.DataFormat,o,i,t):(0==s.DataFormat.NegativeNumber?o="-":i="Dr",this.SetCellValue(e,s.DataFormat,o,i,t),0==s.DataFormat.NegativeNumber&&(t.Value=-e)):e>=0?this.SetCellValue(e,s.DataFormat,o,i,t):(0==s.DataFormat.NegativeNumber?o="-":i="Cr",this.SetCellValue(-e,s.DataFormat,o,i,t),0==s.DataFormat.NegativeNumber&&(t.Value=e))}}},{key:"SetCellValue",value:function(t,e,s,o,l){l.IsNegativeRed=!1;var a,n;if(n=e.DecimalsPoints>0?"N"+e.DecimalsPoints.toString():"N0",e.RoundOff>0){var r=t%e.RoundOff;r<e.RoundOff/2?t-=r:t=t+e.RoundOff-r}l.Value=t,a=e.NumberFormat.length>0?d.ReportViewModel.NumbetFormatted(t,e):t.ToString(n),s.length>0&&(a=s+a),o.length>0&&(a+=o),i.e.IsEmpty(e.PercentageOn)||(a+="%"),l.Text=a}},{key:"AddOpenBalanceDifference",value:function(){}},{key:"AddOpenBalanceDifferenceForBS",value:function(){if(7==this.ViewModel.StaticReportType&&(this.dblTemp=this.dblOpeningBalanceDifference,parseFloat(Math.abs(this.dblTemp).ToString("N1"))>.1))if(this.row=this.NewReportRow_2(n.f.BalanceBF,this.GrossTotalAppearance_Data),this.row.LevelNo=0,this.ReportFormat==T.Plain)this.row.Cells[this.AccNameIndex].CellAppearance=this.GrossTotalAppearance,this.row.Cells[this.AccNameIndex].Text=o.a.GetResource("Reports_OpeningBalanceDifference"),this.dblTemp>0?(this.ReportTotalIndex=this.ShowIncomeFirst?0:1,this.ViewModel.SetCellValue(this.dblTemp,this.oColumns[this.BalIndex+this.ReportTotalIndex].DataFormat,"FLOAT",this.row.Cells[this.BalIndex+this.ReportTotalIndex]),this.ReportTotal[0]+=this.dblTemp):(this.ReportTotalIndex=this.ShowIncomeFirst?1:0,this.ViewModel.SetCellValue(-this.dblTemp,this.oColumns[this.BalIndex+this.ReportTotalIndex].DataFormat,"FLOAT",this.row.Cells[this.BalIndex+this.ReportTotalIndex]),this.ReportTotal[1]+=this.dblTemp),this.GrdRow++,this.TempData.push(this.row);else if(this.ReportFormat==T.Horizontal)this.dblTemp>0?(this.ReportTotalIndex=this.ShowIncomeFirst?0:this.ColumnSize,this.ViewModel.SetCellValue(this.dblTemp,this.oColumns[this.BalIndex+this.ReportTotalIndex].DataFormat,"FLOAT",this.row.Cells[this.BalIndex+this.ReportTotalIndex]),this.ReportTotal[0]+=this.dblTemp):(this.ReportTotalIndex=this.ShowIncomeFirst?this.ColumnSize:0,this.ViewModel.SetCellValue(-this.dblTemp,this.oColumns[this.BalIndex+this.ReportTotalIndex].DataFormat,"FLOAT",this.row.Cells[this.BalIndex+this.ReportTotalIndex]),this.ReportTotal[1]+=this.dblTemp),this.row.Cells[this.ReportTotalIndex+this.AccNameIndex].CellAppearance=this.GrossTotalAppearance,this.row.Cells[this.ReportTotalIndex+this.AccNameIndex].Text=o.a.GetResource("Reports_OpeningBalanceDifference"),this.FirstTypeEndIndex<this.GrdRow?this.GrdRow++:this.FirstTypeEndIndex++,this.TempData.push(this.row);else if(this.ReportFormat==T.Vertical){this.GrdRow++,this.row.Cells[this.AccNameIndex].CellAppearance=this.GrossTotalAppearance,this.row.Cells[this.AccNameIndex].Text=o.a.GetResource("Reports_OpeningBalanceDifference");var t=0;if(this.dblTemp<0&&(t=1),this.ViewModel.SetCellValue(Math.abs(this.dblTemp),this.oColumns[this.BalIndex].DataFormat,"FLOAT",this.row.Cells[this.BalIndex]),this.ReportTotal[t]+=this.dblTemp,this.Show==p.TagWise)for(var e=0;e<this.CountMonths;e++)this.lstTagsOpeningBalance.Keys.Contains(this.oColumns[this.CellStartPos+this.ColumnSize+e].ID)&&(this.dblTemp=this.lstTagsOpeningBalance[this.oColumns[this.CellStartPos+this.ColumnSize+e].ID],t=0,this.dblTemp<0&&(t=1),this.ReportTotalMonthWise[t][e]+=this.dblTemp,this.ViewModel.SetCellValue(this.dblTemp,this.oColumns[this.CellStartPos+this.ColumnSize+e].DataFormat,"FLOAT",this.row.Cells[this.CellStartPos+this.ColumnSize+e]));else for(var s=0;s<this.CountMonths;s++)this.ReportTotalMonthWise[t][s]+=this.dblTemp,this.ViewModel.SetCellValue(Math.abs(this.dblTemp),this.oColumns[this.CellStartPos+this.ColumnSize+s].DataFormat,"FLOAT",this.row.Cells[this.CellStartPos+this.ColumnSize+s]);this.dblTemp>0?this.ShowIncomeFirst?(this.FirstTypeEndIndex++,this.TempData.InsertAt(this.row,this.FirstTypeEndIndex)):this.TempData.push(this.row):this.ShowIncomeFirst?this.TempData.push(this.row):(this.FirstTypeEndIndex++,this.TempData.InsertAt(this.row,this.FirstTypeEndIndex))}}},{key:"UpdateDataTableWithGroups",value:function(){}},{key:"SetStockBalance",value:function(t){var e,s=this,l="";this.lstTagColumns.forEach((function(t){l.length>0&&(l+=","),l+=t}));var a=[];a.push(t?1:0),a.push(""),a.push(this.TagID),a.push(" inner join com_docccdata DCC with(nolock) on DCC.InvDocDetailsID=D.InvDocDetailsID");var n="",r=this.ViewModel.oReportDialog.CostCenterFilters.find((function(t){return t.CostCenterID==s.TagID}));if(null!=r){var h="";r.SelectedNodes.forEach((function(t){h+=t.Id+","})),h.length>0&&(h=h.Remove(h.length-1,1),n+=" AND DCC.DCCCNID"+(r.CostCenterID-5e4)+" IN ("+h+")")}var d=null;if(this.ViewModel.oReportDialog.Locations.Visible&&null!=this.ViewModel.oReportDialog.LocationWhere&&(d=i.e.IsEmpty(this.ViewModel.oReportDialog.LocationWhere)?"-1":this.ViewModel.oReportDialog.LocationWhere,n+=" AND DCC.DCCCNID"+(this.ViewModel.oReportDialog.Locations.DBColumnID-5e4)+" IN ("+d+")"),a.push(n),a.push(this.ViewModel.oReportDialog.FromDate.Date),a.push(this.ViewModel.oReportDialog.ToDate.Date),a.push(this.UnPostedDocsInclude),a.push(o.a.SessionManager.UserName),0!=(e=o.a.report.SetAvgRateTempTable(a,this.ViewModel.IsReportDB)).length)try{var c=i.e.Int(o.a.SessionManager.Preferences["Maintain Dimensionwise stock"]);if((a=[]).push(e),a.push(this.TagID),a.push(l),a.push(c),this.ViewModel.oReportDialog.Locations.Visible&&null!=this.ViewModel.oReportDialog.LocationWhere?i.e.IsEmpty(this.ViewModel.oReportDialog.LocationWhere)?a.push(-1):a.push(this.ViewModel.oReportDialog.LocationWhere):a.push(null),a.push(this.ViewModel.oReportDialog.ToDate.Date),a.push(0),a.push(o.a.SessionManager.LanguageID),t){if(this.dsOpeningStock=o.a.report.GetStockBalancesTagWise(a,this.ViewModel.IsReportDB),this.dsOpeningStock.Tables[0].length>0){var u=this.dsOpeningStock.Tables[0].Compute("sum","BalValue");null!=u&&(this.dblOpeningStock=parseFloat(u))}}else if(this.dsClosingStock=o.a.report.GetStockBalancesTagWise(a,this.ViewModel.IsReportDB),this.dsClosingStock.Tables[0].length>0){var T=this.dsClosingStock.Tables[0].Compute("sum","BalValue");null!=T&&(this.dblClosingStock=parseFloat(T))}}catch(p){}finally{e.length>0&&o.a.report.ReportDataSet("RPT022",this.ViewModel.IsReportDB,"USE PACT2C\n                IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].["+e+"]') AND type in (N'U'))\nDROP TABLE "+e+"\nDELETE FROM RPT_TempTables WHERE TempTableName='"+e+"'")}else this.ViewModel.DisplayMessage="Setting Temporary Table Error."}},{key:"SetPLText",value:function(t,e){this.SetPLTextColor(t,e),e=this.ViewModel.Preferences.ContainsKey(e)?this.ViewModel.Preferences[e]:o.a.GetResource(e).toUpperCase(),t.Text=e}},{key:"SetPLTextColor",value:function(t,e){this.ViewModel.Preferences.ContainsKey(e+"Clr")?t.CellAppearance.ForeColor=this.ViewModel.Preferences[e+"Clr"]:"Reports_LblNetLossAfter"==e&&this.ViewModel.Preferences.ContainsKey("Reports_LblNetLossForPeriodClr")?t.CellAppearance.ForeColor=this.ViewModel.Preferences.Reports_LblNetLossForPeriodClr:"Reports_LblNetProfitAfter"==e&&this.ViewModel.Preferences.ContainsKey("Reports_LblNetProfitForPeriodClr")&&(t.CellAppearance.ForeColor=this.ViewModel.Preferences.Reports_LblNetProfitForPeriodClr)}}]),s}(a.b)}}]);