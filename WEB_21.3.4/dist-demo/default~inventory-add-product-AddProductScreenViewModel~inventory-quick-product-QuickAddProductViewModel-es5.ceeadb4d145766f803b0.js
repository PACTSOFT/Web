function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var i,s=_getPrototypeOf(e);if(t){var n=_getPrototypeOf(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return _possibleConstructorReturn(this,i)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[66,175],{DLiw:function(e,t,i){"use strict";i.r(t),i.d(t,"AddProductScreenViewModel",(function(){return me})),i.d(t,"MultipleUOM",(function(){return ge}));var s=i("Do2H"),n=i("Lp6j"),r=i("eQJW"),a=i("ScVY"),o=i("VxiT"),l=i("EQd/"),u=i("0/4Q"),c=i("n56n"),d=i("NkMH"),h=i("THE7"),b=i("vVAv"),S=i("RJs6"),m=i("OvA8"),g=i("8B8H"),C=i("ockk"),P=i("3Pt+"),p=function(){function e(t,i){_classCallCheck(this,e),this.Module="INV",this.ClassName="ProductKitViewModel",this.Visible=!0,this.contextVisible=!0,this.IsKit=0,this.ColumnSpan="4",this.Row="0",this.PrdID="",this.form=new P.j({}),Logger.InfoLog("ProductKitViewModel::Entering ProductKitViewModel With oParent="+t+",IsKit"+i),this.IsKit=i,this.Parent=t,this.ModGrid=new g.a,this.ModGrid.Width="320",this.ModGrid.Height=100,this.ModGrid.CanUserAddRows=!0,this.ModGrid.CanUserDeleteRows=!0,this.ModGrid.CellEditEnding.Subscribe(this,"OnCellEditEnding"),this.KitGrid=new g.a,this.KitGrid.Clear(),this.KitGrid.BeginEdit.Subscribe(this,"OnBeginEdit"),this.KitGrid.CellEditEnding.Subscribe(this,"OnCellEditEnding"),this.KitGrid.CanUserAddRows=!0,this.KitGrid.CanUserDeleteRows=!0,2==i?this.BuildSpecs():this.BuildTempDataTable(),Logger.InfoLog("ProductKitViewModel::Leaving ProductKitViewModel")}return _createClass(e,[{key:"OnBeginEdit",value:function(e){var t=e.args.item,i=e.args.column.field,s=e.args.column.className,r=e.args.model;if("DataGridPactListBoxColumn"==s&&"LookVal"==i)r.TypeID="1"!=t.FldType||n.e.IsEmpty(t.LookUpID)?5e5:parseInt(t.LookUpID.toString());else if("DataGridPactListBoxColumn"==s&&"Unit"==i){var a,o=" (BaseID IN ";o+=" (SELECT     BaseID ",o=(o+=" FROM          COM_UOM AS COM_UOM_1 with(nolock) ")+" WHERE      (UOMID =(select UOMID from inv_product with(nolock) where productid="+(a=t.PRODUCT_Key.toString())+") ))) ",""==a?(r.ProductID=0,o=" (BaseID IN ",o+=" (SELECT     BaseID ",o+=" FROM          COM_UOM AS COM_UOM_1 with(nolock) ",o+=" WHERE      (UOMID =-1 ))) "):r.ProductID=parseInt(a),r.FilterCondition=o}else"PRODUCT"!=i&&"PRODUCTCODE"!=i||n.e.IsEmpty(t.PRODUCT_Key)||(this.PrdID=t.PRODUCT_Key.toString());return!1}},{key:"OnCellEditEnding",value:function(e){var t=this;if("ModifierName"==e.column.field){var i=[];(i=[]).push(u.d.ComboBoxItems_2("",""));for(var s=function(e){i.find((function(i){return i.Name==t.ModGrid.Table[e].ModifierName.toString()}))||i.push(u.d.ComboBoxItems_2(t.ModGrid.Table[e].ModifierName.toString(),t.ModGrid.Table[e].ModifierName.toString()))},n=0;n<this.ModGrid.Table.length;n++)s(n);var r=this.KitGrid.Columns.find((function(e){return"ModifierName"==e.ValueBinding}));null!=r&&(r.ComboData=i),this.KitGrid.RefreshGrid=!0}}},{key:"BuildSpecs",value:function(){var e,t;this.KitGrid.Clear(),this.KitGrid.TableColumns.push("GroupName"),this.KitGrid.TableColumns.push("FldType"),this.KitGrid.TableColumns.push("LookUpID"),this.KitGrid.TableColumns.push("LookVal_Key"),this.KitGrid.TableColumns.push("LookVal"),this.KitGrid.TableColumns.push("Val"),this.KitGrid.TableColumns.push("ShowinHeader"),this.KitGrid.TableColumns.push("DisplayOrder"),e=[],(t=new C.a).DisplayMember="GroupName",t.Header="Group",t.DataType="TextBlock",t.Width=100,t.IsVisible=!0,e.push(t),t=new C.a;var i=new Array;i.push(u.d.ComboBoxItems_2("Text","2")),i.push(u.d.ComboBoxItems_2("Lookup","1")),t.ComboData=i,t.DisplayMember="Name",t.ValueMember="Value",t.ValueBinding="FldType",t.DataType="ComboBox",t.Header="Type",t.Width=100,t.IsVisible=!0,e.push(t),(t=new C.a).Header="Lookup Type",t.ValueBinding="LookUpID",t.DataType="ComboBox",t.DisplayMember="Name",t.ValueMember="Value",t.Width=150,(i=new Array).push(u.d.ComboBoxItems_2("","0")),s.a.inventory.GetLookups().Tables[0].forEach((function(e){i.push(u.d.ComboBoxItems_2(e.LookupName.toString(),e.NodeID.toString()))})),t.ComboData=i,e.push(t),(t=new C.a).DataType="LISTBOX",t.DisplayMember="LookVal",t.ValueMember="LookVal_Key",t.CostCenterID=44,t.Header="Val",t.Width=150,e.push(t),(t=new C.a).DisplayMember="Val",t.Header="Text",t.DataType="TextBlock",t.Width=100,t.IsVisible=!0,e.push(t),t=new C.a,(i=new Array).push(u.d.ComboBoxItems_2("NO","0")),i.push(u.d.ComboBoxItems_2("YES","1")),t.ComboData=i,t.DisplayMember="Name",t.ValueMember="Value",t.ValueBinding="ShowinHeader",t.DataType="ComboBox",t.Header="Show inHeader",t.Width=100,t.IsVisible=!0,e.push(t),(t=new C.a).DisplayMember="DisplayOrder",t.Header="Order",t.DataType="FLOAT",t.Width=100,t.IsVisible=!0,e.push(t),this.KitGrid.Columns=e,this.KitGrid.AddExtraEmptyRows(10)}},{key:"BuildTempDataTable",value:function(){var e,t;this.KitGrid.Clear(),this.KitGrid.TableColumns.push("ModifierName"),this.KitGrid.TableColumns.push("PRODUCT"),this.KitGrid.TableColumns.push("PRODUCTCODE"),this.KitGrid.TableColumns.push("PRODUCT_Key"),this.KitGrid.TableColumns.push("Qty"),this.KitGrid.TableColumns.push("Rate"),this.KitGrid.TableColumns.push("Link"),this.KitGrid.TableColumns.push("Unit"),this.KitGrid.TableColumns.push("Unit_Key"),this.KitGrid.TableColumns.push("LinkedProductID"),this.KitGrid.TableColumns.push("Remarks"),e=[];var i=[];t=new C.a,i.push(u.d.ComboBoxItems_2("","")),t.ComboData=i,t.DisplayMember="Name",t.ValueMember="Value",t.ValueBinding="ModifierName",t.DataType="ComboBox",t.Header="Modifier Name",t.Width=150,t.IsVisible=!1,e.push(t),(t=new C.a).CostCenterID=3;var n=this.Parent.ScreenObject.Data.Tables[10].filter((function(e){return"KitProductCode"==e.Name}));if(t.TypeID=null!=n&&null!=n&&n.Length>0?parseInt(n[0].Value.toString()):10,t.DataType="LISTBOX",t.DisplayMember="PRODUCTCODE",t.ValueMember="PRODUCT_Key",t.Header=s.a.SessionManager.translate.instant("ProductCode"),t.Width=250,e.push(t),(t=new C.a).CostCenterID=3,n=this.Parent.ScreenObject.Data.Tables[10].filter((function(e){return"KitProductName"==e.Name})),t.TypeID=null!=n&&n.Length>0?parseInt(n[0].Value):10,t.DataType="LISTBOX",t.DisplayMember="PRODUCT",t.ValueMember="PRODUCT_Key",t.Header=s.a.SessionManager.translate.instant("Product_SelectedName"),t.Width=250,e.push(t),1==this.IsKit&&((t=new C.a).DisplayMember="Qty",t.Header=s.a.SessionManager.translate.instant("Packages_Qty"),t.DataType="TextBlock",t.Width=100,t.IsVisible=!0,e.push(t),(t=new C.a).CostCenterID=11,t.TypeID=1,t.DataType="LISTBOX",t.DisplayMember="Unit",t.ValueMember="Unit_Key",t.Header="Unit",t.Width=100,e.push(t),(t=new C.a).DisplayMember="Rate",t.Header=s.a.SessionManager.translate.instant("Inv_CCRate_Rate"),t.DataType="TextBlock",t.Width=100,t.IsVisible=!0,e.push(t),(t=new C.a).DisplayMember="Remarks",t.Header=s.a.SessionManager.translate.instant("Remarks"),t.DataType="TextBlock",t.Width=200,t.IsVisible=!0,e.push(t)),0==this.IsKit){t=new C.a;var r=[];r.push({LinkName:"Optional",Link:"1"}),r.push({LinkName:"Mandatory",Link:"2"}),t.ComboData=r,t.DisplayMember="LinkName",t.ValueMember="Link",t.ValueBinding="Link",t.DataType="ComboBox",t.Header=s.a.SessionManager.translate.instant("Link"),t.Width=100,t.IsVisible=!0,e.push(t)}this.KitGrid.Columns=e;for(var a=0;a<10;a++)this.KitGrid.addEmptyRow();this.ModGrid.Table=[],this.ModGrid.TableColumns.push("ModifierName"),this.ModGrid.TableColumns.push("MinSelect"),this.ModGrid.TableColumns.push("MaxSelect");var o=[];(t=new C.a).DisplayMember="ModifierName",t.Header="Modifier Name",t.DataType="TextBlock",t.Width=150,t.IsVisible=!0,o.push(t),(t=new C.a).DisplayMember="MinSelect",t.Header="Min. Select",t.DataType="TextBlock",t.Width=80,t.IsVisible=!0,o.push(t),(t=new C.a).DisplayMember="MaxSelect",t.Header="Max. Select",t.DataType="TextBlock",t.Width=80,t.IsVisible=!0,o.push(t),this.ModGrid.Columns=o;for(var l=0;l<3;l++)this.ModGrid.addEmptyRow()}},{key:"SpecsXML",value:function(){Logger.InfoLog("ProductKitViewModel::Entering SpecsXML");var e="";if(null!=this.KitGrid.Table&&this.KitGrid.Table.length>0)for(var t=0;t<this.KitGrid.Table.length;t++)n.e.StringIsNullOrEmpty(this.KitGrid.Table[t].FldType)||(e+="<Row   ",e+=' GroupName="'+n.e.String(this.KitGrid.Table[t].GroupName)+'"',e+=' FldType="'+n.e.String(this.KitGrid.Table[t].FldType)+'"',e+=' LookUpID="'+n.e.String(this.KitGrid.Table[t].LookUpID)+'"',"1"!=n.e.String(this.KitGrid.Table[t].FldType)||n.e.StringIsNullOrEmpty(this.KitGrid.Table[t].LookVal_Key)?e+=' Val="'+n.e.String(this.KitGrid.Table[t].Val)+'"':e+=' LookUpVal="'+this.KitGrid.Table[t].LookVal_Key.toString()+'"',e+=' ShowinHeader="'+n.e.String(this.KitGrid.Table[t].ShowinHeader)+'"',e+=' DisplayOrder="'+n.e.String(this.KitGrid.Table[t].DisplayOrder)+'"',e+="/>");return e.length>0&&(e="<XML>"+e+"</XML>"),Logger.InfoLog("ProductKitViewModel::Leaving SpecsXML Which Returns XML as"+e),e.toString()}},{key:"GetKitXML",value:function(e,t){Logger.InfoLog("ProductKitViewModel::Entering GetKitXML");var i,s="";t>0&&(s+='<Row  LinkedProductID="-1" ',s+=' CostCenterID="'+e+'"',s+=' NodeID="'+t+'"',s+="/>");var r="";if(null!=this.KitGrid.Table&&this.KitGrid.Table.length>0)for(var a=0;a<this.KitGrid.Table.length;a++)if(!n.e.StringIsNullOrEmpty(this.KitGrid.Table[a].PRODUCT_Key)){s+="<Row   ",s+=' RowNo="'+(a+1)+'"',this.ModGrid.Visible?this.KitGrid.TableColumns.Contains("ModifierName")&&null!=this.KitGrid.Table[a].ModifierName&&null!=this.KitGrid.Table[a].ModifierName&&""!=this.KitGrid.Table[a].ModifierName.toString().Trim()&&(r=this.KitGrid.Table[a].ModifierName.toString().Trim(),null!=(i=this.ModGrid.Table.filter((function(e){return e.ModifierName==r})))&&i.length>0&&(s+=' ModifierName="'+n.e.String(this.KitGrid.Table[a].ModifierName)+'"',s+=' MinSelect="'+n.e.String(i[0].MinSelect)+'"',s+=' MaxSelect="'+n.e.String(i[0].MaxSelect)+'"')):(s+=' ModifierName=""',s+=' MinSelect="0"',s+=' MaxSelect="0"'),n.e.StringIsNullOrEmpty(this.KitGrid.Table[a].LinkedProductID)?s+=' LinkedProductID="0"':s+=' LinkedProductID="'+this.KitGrid.Table[a].LinkedProductID.toString()+'"',s+=' Product="'+this.KitGrid.Table[a].PRODUCT_Key.toString()+'"',s+=' Qty="'+n.e.String(this.KitGrid.Table[a].Qty)+'"',s+=' Rate="'+n.e.String(this.KitGrid.Table[a].Rate)+'"',n.e.StringIsNullOrEmpty(this.KitGrid.Table[a].Unit_Key)||(s+=' Unit="'+this.KitGrid.Table[a].Unit_Key.toString()+'"');var o="1";n.e.StringIsNullOrEmpty(this.KitGrid.Table[a].Link)||(o=this.KitGrid.Table[a].Link.toString()),s+=' LINK="'+o+'"',s+=' Remarks="'+n.e.String(this.KitGrid.Table[a].Remarks)+'"',s+="/>"}return Logger.InfoLog("ProductKitViewModel::Leaving GetKitXML Which Returns XML as"+s),s.toString()}},{key:"LoadSpecs",value:function(e){Logger.InfoLog("LoadBundels :: Entering LoadSpecs With DataTable="+e),Logger.InfoLog("ProductKitViewModel::Entering LoadSpecs"),this.KitGrid.Clear();for(var t=0;t<e.length;t++){var i=this.KitGrid.NewRow();i.GroupName=n.e.String(e[t].GroupName),i.FldType=n.e.String(e[t].FldType),i.LookUpID=n.e.String(e[t].LookUpID),n.e.IsEmpty(e[t].LookUpVal)||"1"!=n.e.String(e[t].FldType)?(i.Val=n.e.String(e[t].Val),i.LookVal=null,i.LookVal_Key=null):(i.LookVal=n.e.String(e[t].Name),i.LookVal_Key=e[t].LookUpVal.toString(),i.Val=null),i.ShowinHeader=n.e.String(e[t].ShowinHeader),i.DisplayOrder=n.e.String(e[t].DisplayOrder),this.KitGrid.addRow(i)}for(var s=0;s<10;s++)this.KitGrid.addEmptyRow();Logger.InfoLog("ProductKitViewModel::Exiting LoadSpecs")}},{key:"LoadBundels",value:function(e){var t=this;Logger.InfoLog("LoadBundels :: Entering LoadBundels With DataTable="+e);var i=0;if(Logger.InfoLog("ProductKitViewModel::Entering LoadBundles"),this.ModGrid.Visible){var s;if(this.ModGrid.Table.Clear(),e.length>0)!function(){var i=e.ToTable(!0,"ModifierName","MinSelect","MaxSelect");if(null!=i&&i.length>0){var n,r=[];r.push(u.d.ComboBoxItems_2("",""));for(var a=function(e){(n=t.ModGrid.NewRow()).ModifierName=i[e].ModifierName,n.MinSelect=i[e].MinSelect,n.MaxSelect=i[e].MaxSelect,t.ModGrid.addRow(n),r.find((function(t){return t.Name==i[e].ModifierName.toString()}))||r.push(u.d.ComboBoxItems_2(i[e].ModifierName.toString(),i[e].ModifierName.toString()))},o=0;o<i.length;o++)a(o);null!=(s=t.KitGrid.Columns.find((function(e){return"ModifierName"==e.ValueBinding})))&&(s.ComboData=r)}}();this.ModGrid.addEmptyRow()}var r=e;for(this.KitGrid.Clear();i<r.length;i++){var a=this.KitGrid.NewRow();this.KitGrid.TableColumns.Contains("ModifierName")&&e.Columns.Contains("ModifierName")&&(a.ModifierName=r[i].ModifierName.toString()),a.PRODUCT=n.e.String(r[i].PRODUCTNAME),a.PRODUCT_Key=n.e.String(r[i].ProductID),a.PRODUCTCODE=n.e.String(r[i].ProductCode),a.Qty=n.e.StringIsNullOrEmpty(r[i].Quantity)?null:r[i].Quantity.toString(),a.Rate=r[i].Rate?r[i].Rate.toString():null,n.e.StringIsNullOrEmpty(r[i].unit)?(a.Unit_Key=null,a.Unit=null):(a.Unit_Key=r[i].unit.toString(),a.Unit=r[i].UnitName.toString()),a.Link=n.e.StringIsNullOrEmpty(r[i].LinkType)?null:r[i].LinkType.toString(),a.LinkedProductID=n.e.StringIsNullOrEmpty(r[i].LinkedProductID)?null:r[i].LinkedProductID.toString(),a.Remarks=n.e.StringIsNullOrEmpty(r[i].Remarks)?null:r[i].Remarks.toString(),this.KitGrid.addRow(a)}for(;i<10;i++)this.KitGrid.addEmptyRow();Logger.InfoLog("ProductKitViewModel::Exiting LoadBundles")}},{key:"angularGrid",get:function(){return this.KitGrid.angularGrid}},{key:"angularGridModGrid",get:function(){return this.ModGrid.angularGrid}}]),e}(),T=i("bSOb"),D=i("ybar"),f=i("MC0n"),I=function(e){_inherits(i,e);var t=_createSuper(i);function i(e){var n;return _classCallCheck(this,i),(n=t.call(this)).Module="INV",n.ClassName="AddSubstituteViewModel",n.dsetSubstitues=null,n.Dset=null,n.ButtonAdd=new d.a,n.SubstituteDelete=new d.a,n.Products=new u.b(0),n.ManageVisible=!1,n.GroupVisible=!1,n.GroupID=0,n.GroupName="",n.ProductName="",n.SProductID=0,n.NewSubstituteGroups=new c.b(0),n.SubGroupName=new l.d(0),n.IsAdded=!1,n.ProductsList=new u.b(0),n.SelectedIndex=0,n.form=new P.j({}),Logger.InfoLog("AddSubstituteViewModel:: Entering AddSubstituteViewModel With oParent"+e),n.Parent=e,s.a.SessionManager.HideUnathorizedAccess?n.ButtonAdd.Visible=s.a.SessionManager.IsActionAssigned(3,"Substitutes_Create"):n.ButtonAdd.Enable=s.a.SessionManager.IsActionAssigned(3,"Substitutes_Create"),s.a.SessionManager.HideUnathorizedAccess?n.SubstituteDelete.Visible=s.a.SessionManager.IsActionAssigned(3,"Substitutes_Delete"):n.SubstituteDelete.Enable=s.a.SessionManager.IsActionAssigned(3,"Substitutes_Delete"),n.NewSubstituteGroups.SelectionChangedCommand.Subscribe(_assertThisInitialized(n),"OnNewGroupSelectionChanged"),n.NewSubstituteGroups.CCID=23,n.NewSubstituteGroups.TypeID=1,n.Dset=s.a.inventory.GetSubstitueGroups(),null!=n.Dset&&function(){for(var e=n.Dset.Tables[1],t=function(t){0==n.Parent.ViewSubstitutes.lstSelectedGroups.filter((function(i){return i.Value.toString()==e[t][Object.keys(e[t])[0]].toString()})).length?n.ProductsList.Items.push(u.c.CheckedListBoxItem_6(e[t][Object.keys(e[t])[1]].toString(),e[t][Object.keys(e[t])[0]].toString(),!1,3)):n.ProductsList.Items.push(u.c.CheckedListBoxItem_6(e[t][Object.keys(e[t])[1]].toString(),e[t][Object.keys(e[t])[0]].toString(),!0,3))},i=0;i<e.length;i++)t(i);null!=n.Dset&&n.Dset.Tables.length>2&&n.Dset.Tables[2].length>0&&(n.dsetSubstitues=n.Dset.Tables[2])}(),n.ProductsList.Label="Group",n.NewSubstituteGroups.Label="Select",n.Products.Label=s.a.GetResource("Products"),n.Products.DBColumnName="3",Logger.InfoLog("AddSubstituteViewModel:: Exiting AddSubstituteViewModel"),_possibleConstructorReturn(n)}return _createClass(i,[{key:"OnPickerClick",value:function(e){if(Logger.InfoLog("OnPickerClick::Entering OnPickerClick With String="+e),"3"==e){var t=new D.a;t.SearchPickerViewModel(this,"PRODUCTS","","",""),s.a.page.ShowDialog(t,f.a,{HideClose:!0,ShowCenter:!0,Title:""})}}},{key:"ParentCallBack",value:function(e){var t=this;Logger.InfoLog("ParentCallBack :: Entering ParentCallBack With PickerObject="+e),e.SelectedNodes.forEach((function(e){e.IsGroup||0==t.Products.Items.filter((function(t){return t.Value==e.Id.toString()})).length&&t.Products.Items.push(u.c.CheckedListBoxItem_6(e.Text[1],e.Id.toString(),!0,3))})),Logger.InfoLog("ParentCallBack::Exiting ParentCallBack")}},{key:"CheckExisting",value:function(e,t){for(var i=0;i<t.length;i++)if(e.toString()==t[i].PRODUCTID.toString())return!1;return!0}},{key:"OnSaveSubstitute",value:function(e){var t,n=this;Logger.InfoLog("AddSubstituteViewModel::Entering OnSaveSubstitute");var r={};if(null!=e&&"Cancel"==e.toString())this.Parent.SubstituteVisibility=!1,s.a.page.HideDialog();else if(null!=e&&"Delete"==e.toString()){r.Address1=this.NewSubstituteGroups.SelectedValue;var a=s.a.inventory.DeleteSubstituteProduct(this.NewSubstituteGroups.SelectedValue);this.MessageVisibility=!0,this.DisplayMessage=a,this.Parent.ViewSubstitutes.OnShowNewSubstitute("Manage")}else if(null!=e&&"Save"==e.toString()){if(null==this.NewSubstituteGroups.SelectedValue)return;r.Address1=this.NewSubstituteGroups.SelectedValue,r.Address2=this.SubGroupName.Text;var o="";o+="<Data>",null!=this.dsetSubstitues&&(t=(t=this.dsetSubstitues).filter((function(e){return e.SubstituteGroupID==n.NewSubstituteGroups.SelectedValue}))),this.Products.Items.forEach((function(e){e.IsChecked?n.CheckExisting(parseInt(e.Value),t)&&(o+="<Row ProductID='"+e.Value+"' MapAction='Link' />"):o+="<Row ProductID='"+e.Value+"' MapAction='Delink' />"})),o+="</Data>",r.Address3=o.toString();s.a.inventory.SetSubstituteGroups(r,"SetSubstituteGroups").subscribe((function(e){n.MessageVisibility=!0,n.DisplayMessage=void 0,e.RetValue>0&&n.Parent.ViewSubstitutes.OnShowNewSubstitute("Manage")}),(function(e){console.log("SetSubstituteGroups : "+JSON.stringify(e))}))}else if(null!=e&&"Ok"==e.toString()){this.IsAdded=!0,0==this.Parent.ViewSubstitutes.Substitutes.length?(0,this.Parent.ViewSubstitutes.Clear()):this.Parent.ViewSubstitutes.Substitutes.length,this.Parent.ViewSubstitutes.SubstitutesObj.Clear(),this.Parent.ViewSubstitutes.lstSelectedGroups.Clear(),this.ProductsList.Items.forEach((function(e){if(e.IsChecked){var i=n.Parent.ViewSubstitutes.SubstitutesObj.NewRow();if(i.GroupID=parseInt(e.Value),i.GroupName=e.Name,n.Parent.ViewSubstitutes.Substitutes.push(i),n.Parent.ViewSubstitutes.lstSelectedGroups.push(u.d.ComboBoxItems_2(e.Name,e.Value)),null!=n.dsetSubstitues&&(t=(t=n.dsetSubstitues).filter((function(t){return t.SubstituteGroupID==e.Value}))),t.length>0)for(var s=0;s<t.length;s++)parseInt(t[s].PRODUCTID.toString())!=n.Parent.ProductID&&((i=n.Parent.ViewSubstitutes.SubstitutesObj.NewRow()).GroupID=parseInt(e.Value),i.SProductID=parseInt(t[s].PRODUCTID.toString()),i.ProductName=t[s].PRODUCTNAME.toString(),i.GroupName="-",i.ProductCode=t[s].ProductCode.toString(),n.Parent.ViewSubstitutes.SubstitutesObj.addRow(i))}})),this.Parent.Substitute=new i(this.Parent),Logger.InfoLog("AddSubstituteViewModel::Exiting OnSaveSubstitute")}else null!=e&&"AssignProduct"==e.toString()&&0==this.Products.Items.filter((function(e){return e.Value==n.Parent.ProductID.toString()})).length&&this.Products.Items.push(u.c.CheckedListBoxItem_5(this.Parent.ProductName.Text,this.Parent.ProductID.toString(),!0))}},{key:"OnNewGroupSelectionChanged",value:function(e){var t,i=this;if((Logger.InfoLog("OnGroupSelectionChanged:: Entering OnGroupSelectionChanged"),null!=this.NewSubstituteGroups.SelectedValue&&(this.SubGroupName.Enable=!0,this.SubGroupName.Text="",this.Products.Items.Clear(),this.NewSubstituteGroups.SelectedValue>0&&(this.SubGroupName.Enable=!1,null!=this.dsetSubstitues)))&&(t=(t=this.dsetSubstitues).filter((function(e){return e.SubstituteGroupID==i.NewSubstituteGroups.SelectedValue}))).length>0){this.SubGroupName.Text=t[0].SubstituteGroupName.toString();for(var s=0;s<t.length;s++)this.Products.Items.push(u.c.CheckedListBoxItem_6(t[s].PRODUCTNAME.toString(),t[s].PRODUCTID.toString(),!0,3))}Logger.InfoLog("OnGroupSelectionChanged:: Exiting OnGroupSelectionChanged")}}]),i}(a.b),y=i("fXoL"),V=i("ofXK"),M=i("q8k3"),O=i("sYmb");function w(e,t){if(1&e&&(y.Zb(0,"div",4),y.Wc(1,"\n\n        "),y.Zb(2,"div",5),y.Wc(3,"\n            "),y.Vb(4,6),y.Wc(5,"\n        "),y.Yb(),y.Wc(6,"\n    "),y.Yb()),2&e){var i=y.lc();y.Db(4),y.tc("obj",i.obj.ProductsList)("group",i.obj.form)}}function v(e,t){if(1&e){var i=y.ac();y.Zb(0,"div",4),y.Wc(1,"\n\n        "),y.Zb(2,"div",5),y.Wc(3,"\n            "),y.Vb(4,6),y.Wc(5,"\n        "),y.Yb(),y.Wc(6,"\n\n        "),y.Zb(7,"div",5),y.Wc(8,"\n            "),y.Vb(9,6),y.Wc(10,"\n        "),y.Yb(),y.Wc(11,"\n\n        "),y.Zb(12,"div",5),y.Wc(13,"\n            "),y.Zb(14,"div",7),y.Wc(15,"\n                "),y.Zb(16,"span",8),y.hc("click",(function(e){y.Ic(i);var t=y.lc();return e.preventDefault(),t.obj.OnPickerClick("3")})),y.Ub(17,"i",9),y.Yb(),y.Wc(18,"\n            "),y.Yb(),y.Wc(19,"\n            "),y.Vb(20,6),y.Wc(21,"\n        "),y.Yb(),y.Wc(22,"\n\n    "),y.Yb()}if(2&e){var s=y.lc();y.Db(4),y.tc("obj",s.obj.NewSubstituteGroups)("group",s.obj.form),y.Db(5),y.tc("obj",s.obj.SubGroupName)("group",s.obj.form),y.Db(11),y.tc("obj",s.obj.Products)("group",s.obj.form)}}function L(e,t){if(1&e){var i=y.ac();y.Zb(0,"div"),y.Wc(1,"\n\n            "),y.Zb(2,"button",10),y.hc("click",(function(){return y.Ic(i),y.lc().obj.OnSaveSubstitute("Ok")})),y.Wc(3),y.mc(4,"translate"),y.Yb(),y.Wc(5,"\n\n            "),y.Zb(6,"button",11),y.hc("click",(function(){return y.Ic(i),y.lc().obj.OnSaveSubstitute("Cancel")})),y.Ub(7,"i",12),y.Wc(8),y.mc(9,"translate"),y.Yb(),y.Wc(10,"\n        "),y.Yb()}2&e&&(y.Db(3),y.Xc(y.nc(4,2,"ok")),y.Db(5),y.Xc(y.nc(9,4,"Cancel")))}function R(e,t){if(1&e){var i=y.ac();y.Zb(0,"div"),y.Wc(1,"\n\n            "),y.Zb(2,"button",10),y.hc("click",(function(){return y.Ic(i),y.lc().obj.OnSaveSubstitute("Save")})),y.Ub(3,"i",13),y.Wc(4),y.mc(5,"translate"),y.Yb(),y.Wc(6,"\n\n            "),y.Zb(7,"button",10),y.hc("click",(function(){return y.Ic(i),y.lc().obj.OnSaveSubstitute("Delete")})),y.Wc(8),y.mc(9,"translate"),y.Yb(),y.Wc(10,"\n\n            "),y.Zb(11,"button",11),y.hc("click",(function(){return y.Ic(i),y.lc().obj.OnSaveSubstitute("Cancel")})),y.Ub(12,"i",12),y.Wc(13),y.mc(14,"translate"),y.Yb(),y.Wc(15,"\n        "),y.Yb()}2&e&&(y.Db(4),y.Xc(y.nc(5,3,"Save")),y.Db(4),y.Xc(y.nc(9,5,"Delete")),y.Db(5),y.Xc(y.nc(14,7,"Cancel")))}var N,B=((N=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||N)},N.\u0275cmp=y.Nb({type:N,selectors:[["app-add-substitute"]],decls:13,vars:5,consts:[[1,"master-screen",3,"formGroup"],["class","PACTHeaderFields dialogSubBody",4,"ngIf"],[1,"Pactdailogfooter"],[4,"ngIf"],[1,"PACTHeaderFields","dialogSubBody"],[1,"form-group","col-xl-12","col-md-12","col-sm-12","col-xs-12","PACTControl"],["FieldDirective","",3,"obj","group"],[2,"position","absolute","margin-left","65px","margin-top","-6px"],[1,"secondary-btn",3,"click"],[1,"fa-light","fa-file-plus"],[1,"primary-btn-wicon",3,"click"],[1,"secondary-btn-wicon",3,"click"],[1,"fa-light","fa-rectangle-xmark"],[1,"fa-light","fa-floppy-disk"]],template:function(e,t){1&e&&(y.Zb(0,"div",0),y.Wc(1,"\n    "),y.Uc(2,w,7,2,"div",1),y.Wc(3,"\n    "),y.Uc(4,v,23,6,"div",1),y.Wc(5,"\n    "),y.Zb(6,"div",2),y.Wc(7,"\n        "),y.Uc(8,L,11,6,"div",3),y.Wc(9,"\n        "),y.Uc(10,R,16,9,"div",3),y.Wc(11,"\n    "),y.Yb(),y.Wc(12,"\n"),y.Yb()),2&e&&(y.tc("formGroup",t.obj.form),y.Db(2),y.tc("ngIf",t.obj.GroupVisible),y.Db(2),y.tc("ngIf",t.obj.ManageVisible),y.Db(4),y.tc("ngIf",t.obj.GroupVisible),y.Db(2),y.tc("ngIf",t.obj.ManageVisible))},directives:[P.t,P.k,V.t,M.a],pipes:[O.d],encapsulation:2}),N),k=function(){function e(t){_classCallCheck(this,e),this.Module="INV",this.ClassName="ViewSubstituteViewModel",this.Visible=!0,this.contextVisible=!0,this.cmnItem_Click="",this.ShowType=!1,this.ColumnSpan="4",this.ShowNewSubstitute="",this.SubstitutesList=new Array,this.SubstitutesObj=new g.a,this.DeletedSubstitutesColumns=[],this.DeletedSubstitutes=[],this.lstSelectedGroups=new Array,this.SelectedRow=-100,this.ButtonAdd=new d.a,this.ButtonManage=new d.a,this.ButtonDelete=new d.a,this.Flag=!1;var i=t.ScreenObject.Data.Tables[10].filter((function(e){return"EnableSubstituteType"==e.Name}));0!=i.length&&!n.e.StringIsNullOrEmpty(i[0].Value)&&Object(r.j)(i[0].Value)&&(this.ShowType=!0),this.Parent=t,s.a.SessionManager.HideUnathorizedAccess?this.ButtonAdd.Visible=s.a.SessionManager.IsActionAssigned(t.CostCenterID,"Substitutes_Create"):this.ButtonAdd.Enable=s.a.SessionManager.IsActionAssigned(t.CostCenterID,"Substitutes_Create"),this.ButtonManage.Visible=this.ButtonAdd.Visible,this.ButtonManage.Enable=this.ButtonAdd.Enable,this.ShowType?(this.ButtonManage.Visible=!1,this.ButtonAdd.ToolTipTitle="Get Data"):this.ButtonAdd.ToolTipTitle=s.a.GetResource("Inv_Substitutes_AddTitle"),s.a.SessionManager.HideUnathorizedAccess?this.ButtonDelete.Visible=s.a.SessionManager.IsActionAssigned(t.CostCenterID,"Substitutes_Delete"):this.ButtonDelete.Enable=s.a.SessionManager.IsActionAssigned(t.CostCenterID,"Substitutes_Delete"),this.InitGrid()}return _createClass(e,[{key:"onBeginEdit",value:function(e){var t=this.Substitutes.indexOf(e.args.item);if(t=-1==t||1==this.Substitutes.length||0==this.Substitutes.length||this.Substitutes.length-t<=1?1:0,this.SubstitutesObj.CanUserAddRows)for(var i=0;i<t;i++){var s=this.SubstitutesObj.NewRow();this.SubstitutesObj.addRow(s)}}},{key:"InitGrid",value:function(){if(this.SubstitutesObj.CanUserAddRows=!0,this.ShowType){this.SubstitutesObj.Clear(),this.SubstitutesColumns.push("ProductName"),this.SubstitutesColumns.push("ProductCode"),this.SubstitutesColumns.push("Type"),this.SubstitutesColumns.push("TypeID"),this.SubstitutesColumns.push("SProductID"),this.DeletedSubstitutes=[],this.DeletedSubstitutesColumns.push("ProductName"),this.DeletedSubstitutesColumns.push("ProductCode"),this.DeletedSubstitutesColumns.push("SProductID");for(var e=0;e<10;e++)this.SubstitutesObj.addEmptyRow()}else this.SubstitutesObj.Clear(),this.SubstitutesColumns.push("GroupID"),this.SubstitutesColumns.push("GroupName"),this.SubstitutesColumns.push("ProductName"),this.SubstitutesColumns.push("ProductCode"),this.SubstitutesColumns.push("SProductID"),this.DeletedSubstitutes=[],this.DeletedSubstitutesColumns.push("GroupID"),this.DeletedSubstitutesColumns.push("GroupName"),this.DeletedSubstitutesColumns.push("ProductName"),this.DeletedSubstitutesColumns.push("SProductID");var t=[],i=new C.a;this.ShowType?((i=new C.a).CostCenterID=3,i.TypeID=13,i.DataType="LISTBOX",i.DisplayMember="ProductCode",i.ValueMember="SProductID",i.Header=s.a.GetResource("ProductCode"),i.Width=200,t.push(i),(i=new C.a).CostCenterID=3,i.TypeID=105,i.DataType="LISTBOX",i.DisplayMember="ProductName",i.ValueMember="SProductID",i.Header=s.a.GetResource("Product_SelectedName"),i.Width=250,t.push(i),(i=new C.a).CostCenterID=44,i.TypeID=66,i.DataType="LISTBOX",i.DisplayMember="Type",i.ValueMember="TypeID",i.Header="Type",i.Width=160,t.push(i)):((i=new C.a).DisplayMember="GroupName",i.Header=s.a.GetResource("GroupName"),i.DataType="TextBlock",i.Width=250,i.ReadOnly=!1,i.IsVisible=!0,t.push(i),(i=new C.a).DisplayMember="ProductCode",i.Header=s.a.GetResource("ProductCode"),i.DataType="TextBlock",i.Width=350,i.ReadOnly=!0,i.IsVisible=!0,t.push(i),(i=new C.a).DisplayMember="ProductName",i.Header=s.a.GetResource("ProductName"),i.DataType="TextBlock",i.Width=350,i.ReadOnly=!0,i.IsVisible=!0,t.push(i)),this.ColumnSource=t,this.SubstitutesObj.BeginEdit.Subscribe(this,"onBeginEdit")}},{key:"OnCmnItem_Click",value:function(e){Logger.InfoLog("ViewSubstituteViewModel::Entering OnCmnItem_Click With strCommand"+e);var t=this.angularGrid.slickGrid.getSelectedRows();if(t.length>0){switch(this.SelectedRow=t[0],e){case"DELETE":if(-100!=this.SelectedRow){if(!this.ShowType&&parseInt(this.Substitutes[this.SelectedRow].GroupID)>0){for(var i=parseInt(this.Substitutes[this.SelectedRow].GroupID),s=this.Substitutes.length,n=s-1,r=0;r<this.lstSelectedGroups.length;r++)i.toString()==this.lstSelectedGroups[r].Value&&this.lstSelectedGroups.RemoveAt(r);for(var a=s;a>0;a--,n--)i==parseInt(this.Substitutes[n].GroupID)&&this.Substitutes.RemoveAt(n)}else this.Substitutes.RemoveAt(this.SelectedRow);this.SubstitutesObj.refreshDataView()}}Logger.InfoLog("ViewSubstituteViewModel::Exiting OnCmnItem_Click")}}},{key:"ontextChangedUnit",value:function(e){}},{key:"GetXML",value:function(){var e="";if(this.ShowType)this.Substitutes.forEach((function(t){n.e.IsEmpty(t.SProductID)||0==parseInt(t.SProductID)||(e+="<TP ",e+=' SID="'+t.SProductID.toString()+'"',n.e.String(t.TypeID).length>0?e+=' TID="'+n.e.String(t.TypeID)+'"':e+=' TID="1005"',e+="/>")})),e.length>0&&(e="<SubstituteType>"+e+"</SubstituteType>");else{for(var t=0;t<this.lstSelectedGroups.length;t++)e+='<Row Action="NEW"',e+=' GroupID="'+this.lstSelectedGroups[t].Value+'"',e+=' GroupName="'+n.e.EncodeXML(this.lstSelectedGroups[t].Name)+'"',e+="/>";e.length>0&&(e="<SubstitutesXML>"+e+"</SubstitutesXML>")}return e.toString()}},{key:"OnShowNewSubstitute",value:function(e){var t=this;try{if("Add"==e.toString())if(this.ShowType){this.Parent.DisplayMessage="";var i=s.a.inventory.GetSubstituteTypeData(this.Parent.ProductID);if(0==i.Tables[0].length)return void(this.Parent.DisplayMessage="No Data Found");for(var r=this.Substitutes.length-1;r>=0&&n.e.IsEmpty(this.Substitutes[r].SProductID);r--);r++,i.Tables[0].forEach((function(e){if(0==t.Substitutes.filter((function(t){return t.SProductID==e.SProductID.toString()})).length){if(t.Substitutes.length-1<r){var i=t.SubstitutesObj.NewRow();t.SubstitutesObj.addRow(i)}t.Substitutes[r].SProductID=e.SProductID,t.Substitutes[r].ProductCode=e.ProductCode,t.Substitutes[r].ProductName=e.ProductName,t.Substitutes[r].TypeID=e.GroupID,t.Substitutes[r].Type=e.Type,t.SubstitutesObj.updateRow(t.Substitutes[r]),r++}}));for(var a=r+5-this.Substitutes.length;a>0;a--){var o=this.SubstitutesObj.NewRow();this.SubstitutesObj.addRow(o)}}else this.ButtonAdd.Enable&&this.ButtonAdd.Visible&&(this.Parent.Substitute=new I(this.Parent),this.Parent.SubstituteVisibility=!0),this.Parent.Substitute.ManageVisible=!1,this.Parent.Substitute.GroupVisible=!0;else"Manage"==e.toString()&&(this.ShowType||this.ButtonAdd.Enable&&this.ButtonAdd.Visible&&(this.Parent.Substitute=new I(this.Parent),this.Parent.SubstituteVisibility=!0,this.Parent.Substitute.GroupVisible=!1,this.Parent.Substitute.ManageVisible=!0));s.a.page.ShowDialog(this.Parent.Substitute,B,{Title:s.a.GetResource("Inv_Substitutes_AddTitle")})}catch(l){Logger.ErrorLog("AddProductViewModel:: OnShowNewSubstitute"+l.stack)}}},{key:"Clear",value:function(){if(this.Substitutes.Clear(),this.DeletedSubstitutes.Clear(),this.ShowType)for(var e=0;e<10;e++){var t=this.SubstitutesObj.NewRow();this.SubstitutesObj.addRow(t)}}},{key:"LoadSubstitutes",value:function(e){var t=this;if(this.Clear(),this.ShowType)for(var i=0;i<e.length;i++)this.SubstitutesObj.addEmptyRow(),this.Substitutes[i].SProductID=e[i].SProductID,this.Substitutes[i].ProductCode=e[i].ProductCode,this.Substitutes[i].ProductName=e[i].ProductName,this.Substitutes[i].TypeID=e[i].GroupID,this.Substitutes[i].Type=e[i].Type;else{this.lstSelectedGroups.Clear();var s=[];s=e,e.forEach((function(e){if(0==t.lstSelectedGroups.filter((function(t){return t.Value.toString()==e.SubstituteGroupID.toString()})).length){var i=t.SubstitutesObj.NewRow();if(s=s.filter((function(t){return t.SubstituteGroupID==e.SubstituteGroupID.toString()})),i.GroupID=n.e.String(e.SubstituteGroupID),i.GroupName=n.e.String(e.SubstituteGroupName),t.SubstitutesObj.addRow(i),s.length>0){t.lstSelectedGroups.push(u.d.ComboBoxItems_2(e.SubstituteGroupName.toString(),e.SubstituteGroupID.toString()));for(var r=0;r<s.length;r++)(i=t.Parent.ViewSubstitutes.SubstitutesObj.NewRow()).GroupID=n.e.String(s[r].SubstituteGroupID),i.SProductID=parseInt(s[r].ProductID.toString()),i.GroupName="-",i.ProductName=n.e.String(s[r].ProductName),i.ProductCode=n.e.String(s[r].ProductCode),t.SubstitutesObj.addRow(i)}}}))}}},{key:"angularGrid",get:function(){return this.SubstitutesObj.angularGrid}},{key:"Substitutes",get:function(){return this.SubstitutesObj.Table}},{key:"ColumnSource",get:function(){return this.SubstitutesObj.Columns},set:function(e){this.SubstitutesObj.Columns=e}},{key:"SubstitutesColumns",get:function(){return this.SubstitutesObj.TableColumns}}]),e}(),G=function(){function e(t){_classCallCheck(this,e),this.Module="INV",this.ClassName="ViewBinsViewModel",this.Visible=!0,this.contextVisible=!0,this.RefreshCostCenterGrid=!1,this.ColumnSpan="4",this.Row="1",this.iTempColumns=[],this.BinsObj=new g.a,this.SelectedRow=-100,this.ButtonAdd=new d.a,this.ButtonDelete=new d.a,this.lstSelectedGroups=new Array,this.lstData=new Array,this.BinDimension=0,this.DimCCID=0,this.SNO=1,this.res="",this.DimwiseBinsinUse=!1,this.Flag=!1,Logger.InfoLog("ViewBinsViewModel::Entering ViewBinsViewModel With Parent"+t),s.a.SessionManager.Preferences.ContainsKey("DimensionwiseBins")&&!n.e.StringIsNullOrEmpty(s.a.SessionManager.Preferences.DimensionwiseBins)&&(this.DimCCID=n.e.IntTryParse(s.a.SessionManager.Preferences.DimensionwiseBins),this.DimCCID>0&&(this.DimCCID=parseInt(s.a.SessionManager.Preferences.DimensionwiseBins))),this.Parent=t,this.AddGridColumns(),Logger.InfoLog("ViewBinsViewModel:: Exiting ViewBinsViewModel")}return _createClass(e,[{key:"OnCellEndEdit",value:function(e){var t=this;if(Logger.InfoLog("ViewBinsViewModel::Entering OnCellEndEdit With strCommand"+e),"Default"==e.OriginalSource.Column.SortMemberPath){var i=new Array;this.lstData=new Array,i.push("Name_Key"),i.push("Default");for(var r=0;r<this.Bins.length;r++)if(!n.e.StringIsNullOrEmpty(this.Bins[r].Name_Key)&&"1"==this.Bins[r].Default.toString()){var a=function(){for(var e=new x,s=0;s<i.length;s++)switch(i[s]){case"Location":e.Loc=parseInt(t.Bins[r].Location);break;case"Name_Key":e.Bin=parseInt(t.Bins[r].Name_Key);break;case"Division":e.Div=parseInt(t.Bins[r].Division);break;case"Default":e.Default=parseInt(t.Bins[r].Default)}if(t.lstData.push(new x(e.Loc,e.Div,e.Bin,e.Default)),t.lstData.filter((function(t){return t.Loc==e.Loc&&t.Div==e.Div&&t.Bin==e.Bin&&t.Default==e.Default})).length>=2)return{v:(alert("Default is already set for this combination ?"),void(t.Bins[r].Default="0"))}}();if("object"==typeof a)return a.v}}else if("Name"==e.OriginalSource.Column.SortMemberPath){var o=e.OriginalSource.RowDataItem.Row;if(null!=o.Default&&""!=o.Default.toString()||(o.Default="0"),!n.e.StringIsNullOrEmpty(o.Name_Key)&&this.DimCCID>0&&this.DimwiseBinsinUse){var l=s.a.empService.GetQueryData(0,"DimwiseBinsinUse",this.DimCCID,this.BinDimension,o.Name_Key.toString());null!=l&&null!=l&&l.Tables.length>0&&l.Tables[0].length>0&&(o.Dim_Key=l.Tables[0][0][Object.keys(l.Tables[0][0])[0]].toString())}}else if("Location"==e.OriginalSource.Column.SortMemberPath){var u=e.OriginalSource.RowDataItem.Row;u.Default="0",u.Name_Key="0",u.Name=""}this.RefreshCostCenterGrid=!this.RefreshCostCenterGrid,Logger.InfoLog("ViewBinsViewModel::Leaving OnCellEndEdit With strCommand"+e)}},{key:"OnCmnItem_Click",value:function(e){switch(Logger.InfoLog("ViewBinsViewModel::Entering OnCmnItem_Click With strCommand"+e),e){case"DELETE":this.DeleteBinRow()}this.UpdateSequence(),Logger.InfoLog("ViewBinsViewModel::Exiting OnCmnItem_Click")}},{key:"ontextChangedUnit",value:function(e){this.UpdateSequence()}},{key:"onCanCmnItem_Click",value:function(e){return!0}},{key:"GetXML",value:function(){Logger.InfoLog("ViewBinsViewModel::Entering GetXML");for(var e="",t=0;t<this.Bins.length;t++)n.e.StringIsNullOrEmpty(this.Bins[t].Name_Key)||(e+="<Row ",e+=' BinNodeID="'+this.Bins[t].Name_Key.toString()+'"',e+=' BinDimension="'+this.BinDimension+'"',this.ColumnSource.filter((function(e){return"Location"==e.Header})).length>0?e+=' Location="'+n.e.String(this.Bins[t].Location)+'"':e+=' Location="1"',this.ColumnSource.filter((function(e){return"Division"==e.Header})).length>0?e+=' Division="'+n.e.String(this.Bins[t].Division)+'"':e+=' Division="1"',this.DimCCID>0&&(e+=' DimCCID="'+this.DimCCID+'"',e+=' DimNodeID="'+n.e.String(this.Bins[t].Dim_Key)+'"'),e+=' Default="'+n.e.String(this.Bins[t].Default)+'"',e+=' Serialno="'+n.e.String(this.Bins[t].Sno)+'"',e+=' Capacity="'+n.e.String(this.Bins[t].Capacity)+'"',e+="/>");return e.length>0&&(e="<BinsXML>"+e+"</BinsXML>"),Logger.InfoLog("ViewBins::Exiting GetXML Which Returns XML ="+e),e.toString()}},{key:"BuildTempDataTable",value:function(){this.BinsObj.Clear(),this.iTempColumns.push("Sno"),this.iTempColumns.push("Name"),this.iTempColumns.push("Name_Key"),this.iTempColumns.push("Dim"),this.iTempColumns.push("Dim_Key"),this.iTempColumns.push("Location"),this.iTempColumns.push("Division"),this.iTempColumns.push("LocationText"),this.iTempColumns.push("DivisionText"),this.iTempColumns.push("Default"),this.iTempColumns.push("StyleHeightZero"),this.iTempColumns.push("Capacity"),this.iTempColumns.push("isUsed"),this.BinsObj.TableColumns.push("Sno"),this.BinsObj.TableColumns.push("Name"),this.BinsObj.TableColumns.push("Name_Key"),this.BinsObj.TableColumns.push("Dim"),this.BinsObj.TableColumns.push("Dim_Key"),this.BinsObj.TableColumns.push("Location"),this.BinsObj.TableColumns.push("Division"),this.BinsObj.TableColumns.push("LocationText"),this.BinsObj.TableColumns.push("DivisionText"),this.BinsObj.TableColumns.push("Default"),this.BinsObj.TableColumns.push("StyleHeightZero"),this.BinsObj.TableColumns.push("Capacity"),this.BinsObj.TableColumns.push("isUsed");for(var e=0;e<15;e++){var t=this.BinsObj.NewRow();t.Sno=e+1,t.Name=null,t.Name_Key=null,t.Dim=null,t.Dim_Key=null,t.Location=null,t.Division=null,t.LocationText=null,t.DivisionText=null,t.Default=null,t.StyleHeightZero=null,t.Capacity=null,t.isUsed=null,this.BinsObj.addRow(t)}}},{key:"gridUnits_TableNewRow",value:function(e,t){this.UpdateSequence(),t.Row.Sno=this.SNO}},{key:"UpdateSequence",value:function(){var e=this;this.SNO=1,this.Bins.forEach((function(t){t.Sno=e.SNO++}))}},{key:"ReturnDimension",value:function(){return s.a.inventory.GetBins(this.Parent.ProductID)}},{key:"AddGridColumns",value:function(){Logger.InfoLog("ViewBinsViewModel :: Entering AddGridColumns"),this.BuildTempDataTable();var e=[],t=this.ReturnDimension(),i=new C.a,a="Division";null!=t&&null!=t&&t.Tables.length>0&&t.Columns[0].Contains("BinDimension")&&t.Tables[0].length>0&&(n.e.StringIsNullOrEmpty(t.Tables[0][0].BinDimension)||(this.BinDimension=parseInt(t.Tables[0][0].BinDimension.toString())),n.e.StringIsNullOrEmpty(t.Tables[0][0].DimwiseBins)||(this.DimCCID=parseInt(t.Tables[0][0].DimwiseBins.toString())),a=n.e.StringIsNullOrEmpty(t.Tables[0][0].DimwiseBinName)?"":t.Tables[0][0].DimwiseBinName.toString(),n.e.StringIsNullOrEmpty(t.Tables[0][0].DimwiseBinsinUse)||(this.DimwiseBinsinUse=Object(r.j)(t.Tables[0][0].DimwiseBinsinUse.toString()))),(i=new C.a).DisplayMember="Sno",i.Header=s.a.GetResource("Sno"),i.DataType="TextBlock",i.Width=50,i.ReadOnly=!0,i.IsVisible=!0,e.push(i),this.DimCCID>0&&((i=new C.a).DisplayMember="Dim",i.ValueBinding="Dim_Key",i.DataType="LISTBOX",i.Header=a,i.CostCenterID=this.DimCCID,i.TypeID=1,i.Width=200,i.IsVisible=!0,this.DimwiseBinsinUse&&(i.ReadOnly=!0),e.push(i)),(i=new C.a).DisplayMember="Name",i.ValueMember="Name_Key",i.DataType="LISTBOX",i.CostCenterID=this.BinDimension,i.TypeID=1,i.Header="Bins",i.Width=350,i.IsVisible=!0,e.push(i),i=new C.a;var o=[];o.push(u.d.ComboBoxItems_2("Yes","1")),o.push(u.d.ComboBoxItems_2("No","0")),i.ComboData=o,i.DisplayMember="Name",i.ValueMember="Value",i.ValueBinding="Default",i.DataType="ComboBox",i.Header="Default",i.Width=80,i.IsVisible=!0,e.push(i),(i=new C.a).DisplayMember="Capacity",i.Header=s.a.GetResource("Mac_Cap"),i.DataType="TextBlock",i.Width=80,i.IsVisible=!0,e.push(i),this.ColumnSource=e,Logger.InfoLog("ViewBinsViewModel::Exiting AddGridColumns")}},{key:"LoadBins",value:function(e){var t=this;Logger.InfoLog("ViewBinsViewModel::Entering LoadBins With DataTable"+e),this.AddGridColumns();var i=1;this.BinsObj.Clear(),e.forEach((function(a){var o=t.BinsObj.NewRow();o.Sno=a.Serialno.toString(),o.Name_Key=a.BinNodeID.toString(),o.Name=n.e.IsEmpty(a.Name)?"":a.Name.toString(),s.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"True"==s.a.SessionManager.Preferences.EnableLocationWise.toString()&&t.ColumnSource.filter((function(e){return"Location"==e.Header})).length>0?(o.Location=a.Location.toString(),s.a.SessionManager.LocationWhere.split(",").Contains(a.Location.toString())||(o.StyleHeightZero="1",i--)):(o.Location=null,o.StyleHeightZero=null),o.Division=t.ColumnSource.filter((function(e){return"Division"==e.Header})).length>0?a.Division.toString():null,o.LocationText=a.LocationText.toString(),o.DivisionText=a.DivisionText.toString(),null==e.DimText||n.e.IsEmpty(a.DimNodeID)?(o.Dim_Key=null,o.Dim=null):(o.Dim_Key=a.DimNodeID.toString(),o.Dim=a.DimText.toString()),o.Default=Object(r.j)(a.IsDefault.toString())?"1":"0",o.Capacity=a.Capacity.toString(),o.isUsed=a.isUsed.toString(),t.BinsObj.addRow(o),i++}));for(var a=i;a<15;a++){var o=this.BinsObj.NewRow();o.Sno=a,o.Name=null,o.Name_Key=null,o.Dim=null,o.Dim_Key=null,o.Location=null,o.Division=null,o.LocationText=null,o.DivisionText=null,o.Default=null,o.StyleHeightZero=null,o.Capacity=null,o.isUsed=null,this.BinsObj.addRow(o)}Logger.InfoLog("ViewBinsViewModel::Exiting LoadBins")}},{key:"ValidateBins",value:function(){var e=this,t=new Array;this.lstData=new Array,t.push("Name_Key"),t.push("Default");for(var i=0;i<this.Bins.length;i++)if(!n.e.StringIsNullOrEmpty(this.Bins[i].Name_Key)&&"1"==this.Bins[i].Default.toString()){var s=function(){for(var s=new x,n=0;n<t.length;n++)switch(t[n]){case"Location":null!=e.Bins[i].Location&&""!=e.Bins[i].Location&&(s.Loc=parseInt(e.Bins[i].Location));break;case"Name_Key":null!=e.Bins[i].Name_Key&&""!=e.Bins[i].Name_Key&&(s.Bin=parseInt(e.Bins[i].Name_Key));break;case"Division":null!=e.Bins[i].Division&&""!=e.Bins[i].Division&&(s.Div=parseInt(e.Bins[i].Division));break;case"Default":null!=e.Bins[i].Default&&""!=e.Bins[i].Default&&(s.Default=parseInt(e.Bins[i].Default))}if(e.lstData.push(new x(s.Loc,s.Div,s.Bin,s.Default)),e.lstData.filter((function(e){return e.Loc==s.Loc&&e.Div==s.Div&&e.Bin==s.Bin&&e.Default==s.Default})).length>=2)return{v:(alert("Default is already set for this combination ? "),e.Bins[i].Default="0",!1)}}();if("object"==typeof s)return s.v}return!0}},{key:"ValidateBinsCapacity",value:function(){if(Object(r.j)(this.Parent.ScreenObject.Data.Tables[10].filter((function(e){return"DonotExceedCapacity"==e.Name}))[0].Value.toString()))for(var e=0;e<this.Bins.length;e++)if(!n.e.StringIsNullOrEmpty(this.Bins[e].Name_Key)&&("0"==this.Bins[e].Capacity.toString()||""==this.Bins[e].Capacity.toString()))return"Enter Capacity at Row no:"+(e+1);return""}},{key:"OnMessageCallBack",value:function(){this.res="Yes"}},{key:"DeleteBinRow",value:function(){if(-100!=this.SelectedRow){var e=this.Bins[this.SelectedRow];if(null!=e)if(""!=e.Name_Key.toString()&&""!=e.isUsed.toString()){if(parseInt(e.isUsed.toString())>0)return this.Parent.MessageVisibility=!0,void(this.Parent.DisplayMessage="Bin "+e.Name.toString()+" is Used");this.Bins.RemoveAt(this.SelectedRow)}else this.Bins.RemoveAt(this.SelectedRow)}}},{key:"angularGrid",get:function(){return this.BinsObj.angularGrid}},{key:"Bins",get:function(){return this.BinsObj.Table}},{key:"ColumnSource",get:function(){return this.BinsObj.Columns},set:function(e){this.BinsObj.Columns=e}},{key:"BinsColumns",get:function(){return this.BinsObj.TableColumns}}]),e}(),x=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;_classCallCheck(this,e),this.Loc=0,this.Div=0,this.Bin=0,this.Default=0,this.Loc=t,this.Div=i,this.Bin=s,this.Default=n},A=function(){function e(t){_classCallCheck(this,e),this.Module="INV",this.ClassName="ProductSerializationViewModel",this.Visible=!0,this.contextVisible=!1,this.Items=[],this.ColumnSpan="4",this.Row="0",this.SelectedIndex=0,this.Views=[],this.SelectedValue=0,this.Expires="",this.IsChecked=!1,this.ItemListObj=new g.a,this.form=new P.j({}),Logger.InfoLog("ProductSerializationViewModel::Entering ProductSerializationViewModel With oParent="+t),this.BindControls(),Logger.InfoLog("ProductSerializationViewModel :: Exiting ProductSerializationViewModel")}return _createClass(e,[{key:"BindControls",value:function(){Logger.InfoLog("ProductSerializationViewModel::Entering BindControls"),this.Items=[],this.Views=[],this.Items.push(u.d.ComboBoxItems_2("Days","1")),this.Items.push(u.d.ComboBoxItems_2("Month","2")),this.Items.push(u.d.ComboBoxItems_2("Years","3")),this.Views.push(u.d.ComboBoxItems_2("ALL","1")),this.Views.push(u.d.ComboBoxItems_2("Available","2")),this.Views.push(u.d.ComboBoxItems_2("Sold","3")),this.Columns=[];var e=new C.a;e.Header="SNO",e.DisplayMember="SNO",e.Width=60,this.Columns.push(e),(e=new C.a).Header="Serial Number",e.DisplayMember="SerialNumber",e.Width=100,this.Columns.push(e),(e=new C.a).Header="Status",e.DisplayMember="Status",e.Width=80,this.Columns.push(e),(e=new C.a).Header="Warranty",e.DisplayMember="Warranty",e.Width=100,this.Columns.push(e);var t=this.ItemListObj.NewRow();t.SNO="1",t.SerialNumber="1234",t.Status="SOLD",t.Warranty="Active",this.ItemListObj.addRow(t),(t=this.ItemListObj.NewRow()).SNO="2",t.SerialNumber="1234",t.Status="Available",t.Warranty="InActive",this.ItemListObj.addRow(t),(t=this.ItemListObj.NewRow()).SNO="3",t.SerialNumber="2556",t.Status="SOLD",t.Warranty="NA",this.ItemListObj.addRow(t),Logger.InfoLog("ProductSerializationViewModel::Leaving BindControls")}},{key:"LoadSerialization",value:function(e){if(Logger.InfoLog("ProductSerializationViewModel::Entering LoadSerialization With DataTable="+e),null!=e&&e.length>0&&null!=e[0].Warranty){this.IsChecked=Object(r.j)(e[0].Warranty),this.Expires=e[0].WarrantyExpires.toString(),this.SelectedValue=parseInt(e[0].WarrantyExpiryFormat);for(var t=0;t<this.Items.length;t++)if(e[0].WarrantyExpiryFormat.toString()==this.Items[t].Value.toString()){this.SelectedIndex=t;break}}Logger.InfoLog("ProductSerializationViewModel::Exiting LoadSerialization")}},{key:"GetXml",value:function(){Logger.InfoLog("ProductSerializationViewModel::Entering GetXml");var e="";return e+="<XML>",e+="<Row Warranty='"+this.IsChecked+"' WarrantyExpires='"+this.Expires+"' WarrantyExpiresTo='"+this.SelectedValue+"'  /></XML>",Logger.InfoLog("ProductSerializationViewModel::Exiting GetXml Which Returns XML as"+e),e.toString()}},{key:"angularGrid",get:function(){return this.ItemListObj.angularGrid}},{key:"ItemList",get:function(){return this.ItemListObj.Table}},{key:"Columns",get:function(){return this.ItemListObj.Columns},set:function(e){this.ItemListObj.Columns=e}},{key:"BinsColumns",get:function(){return this.ItemListObj.TableColumns}}]),e}(),E=i("4ADR"),j=function(){function e(t){_classCallCheck(this,e),this.Module="INV",this.ClassName="AddVendorViewModel",this.UomParent=null,this.VendorID=0,this.ViewVendorRowID=0,this.VendorAccount=new c.b(0),this.ETA=new l.d(0),this.IsVendor=!0,this.MinOrderQty=new l.d(0),this.Volume=new l.d(0),this.Weight=new l.d(0),this.Remarks=new l.d(0),this.Priority=new l.d(0),this.Barcode=new l.d(0),this.MessageVisibility=!1,this.DisplayMessage="",this.BarcodeGrid=new g.a,this.IsModified=!1,this.form=new P.j({}),"ProductWiseUOMViewModel"!=t.ClassName&&(this.BarcodeGrid=new g.a,this.VendorAccount.CCID=2,this.VendorAccount.TypeID=2,Logger.InfoLog("AddVendorViewModel With oParent"+t),this.Parent=t,this.ETA.Label="ETA",this.VendorAccount.Label="Vendor Name",this.Priority.Label="Priority",this.MinOrderQty.Label="Min Order Quantity",this.Barcode.Label="Barcode",this.ETA.Text="0",this.ETA.DataType="INT",this.MinOrderQty.Text="0",this.MinOrderQty.DataType="FLOAT",this.Priority.Text="0",this.Priority.DataType="INT",this.Volume.Label="Volume",this.Volume.Text="0",this.Volume.DataType="FLOAT",this.Remarks.Label="Remarks",this.Remarks.Text="",this.Remarks.DataType="String",this.Weight.Label="Weight",this.Weight.Text="0",this.Weight.DataType="FLOAT",this.MessageVisibility=!1,this.DisplayMessage="",this.onloadGrid(),Logger.InfoLog("AddVendorViewModel:: Exiting AddVendorViewModel"))}return _createClass(e,[{key:"AddVendorViewModel_1",value:function(e){this.UomParent=e,this.IsVendor=!1,this.onloadGrid();var t=this.UomParent.SelectedRow.Barcodes.toString().split(",");if(t.length>0){this.BarcodeGrid.Clear();for(var i=0;i<t.length;i++)if(!n.e.IsEmpty(t[i])){var s=this.BarcodeGrid.NewRow();s.Barcode=t[i],this.BarcodeGrid.addRow(s)}for(var r=0;r<8;r++)this.BarcodeGrid.addEmptyRow()}}},{key:"onloadGrid",value:function(){this.BarcodeGrid=new g.a,this.BarcodeGrid.CanUserDeleteRows=!0,this.BarcodeGrid.CanUserAddRows=!0,this.BarcodeGrid.Table=[],this.BarcodeGrid.Columns=[];var e=new C.a;e.Header="Barcode",e.DisplayMember="Barcode",e.DataType="TexBox",e.Width=217,this.BarcodeGrid.Columns.push(e);for(var t=0;t<8;t++)this.BarcodeGrid.addEmptyRow()}},{key:"OnSaveVendor",value:function(t){var i=this;if(Logger.InfoLog("AddVendorViewModel::Entering OnSaveVendor"),null!=t&&"Cancel"==t.toString())null!=this.UomParent||(this.Parent.VendorVisibility=!1),s.a.page.HideDialog();else if(null!=t&&"Save"==t.toString()){for(var r="",a=0;a<this.BarcodeGrid.Table.length;a++)n.e.IsEmpty(this.BarcodeGrid.Table[a].Barcode)||(r=r.length>0?r+","+this.BarcodeGrid.Table[a].Barcode.toString():this.BarcodeGrid.Table[a].Barcode.toString());if(!n.e.IsEmptySpace(this.Barcode.Text)&&this.Barcode.Text.toString().length>0&&(r=this.Barcode.Text+","+r),r=r.Trim(","),null!=this.UomParent)this.UomParent.SelectedRow.Barcodes=r,s.a.page.HideDialog();else{if(this.VendorID>0&&(this.IsModified=!0),null==this.VendorAccount.SelectedValue||0==this.VendorAccount.SelectedValue)return this.DisplayMessage="Select "+s.a.GetResource("Inv_Vendors_VendorName"),void(this.MessageVisibility=!0);if(!this.Parent.ViewVendors.VendorsList.Contains(this)&&this.Parent.ViewVendors.VendorsList.filter((function(e){return e.VendorAccount.SelectedValue==i.VendorAccount.SelectedValue})).length>0)return this.DisplayMessage="Selected "+s.a.GetResource("Inv_Vendors_VendorName")+" Already Exists",void(this.MessageVisibility=!0);if(!(this.VendorAccount.SelectedValue>0))return this.DisplayMessage="Select "+s.a.GetResource("Inv_Vendors_VendorName"),void(this.MessageVisibility=!0);if(!n.e.StringIsNullOrEmpty(this.ETA.Text)||!n.e.StringIsNullOrEmpty(this.Priority.Text)){if(!n.e.ValidateDouble(this.ETA.Text))return this.DisplayMessage="Invalid Data in ETA",void(this.MessageVisibility=!0);if(this.ETA.Text=this.ETA.Text,!n.e.ValidateDouble(this.Priority.Text))return this.DisplayMessage="Invalid Data in Priority",void(this.MessageVisibility=!0);if(this.Priority.Text=this.Priority.Text,!n.e.ValidateDouble(this.MinOrderQty.Text))return this.DisplayMessage="Invalid Data in Minimum order quantity",void(this.MessageVisibility=!0);if(this.MinOrderQty.Text=this.MinOrderQty.Text,!n.e.ValidateDouble(this.Volume.Text))return this.DisplayMessage="Invalid Volume",void(this.MessageVisibility=!0);if(!n.e.ValidateDouble(this.Weight.Text))return this.DisplayMessage="Invalid Weight",void(this.MessageVisibility=!0);for(var o="",l=0;l<this.BarcodeGrid.Table.length;l++)n.e.StringIsNullOrEmpty(this.BarcodeGrid.Table[l].Barcode)||(o=o.length>0?o+","+this.BarcodeGrid.Table[l].Barcode.toString():this.BarcodeGrid.Table[l].Barcode.toString());if(!n.e.IsEmptySpace(this.Barcode.Text)&&this.Barcode.Text.toString().length>0&&(o=this.Barcode.Text+","+o),o=o.Trim(","),this.Barcode.Text=o,this.Parent.ViewVendors.VendorsList.Contains(this)){var u=this.Parent.ViewVendors.VendorsList.indexOf(this);this.Parent.ViewVendors.VendorsList[u]=this;var c=this.Parent.ViewVendors.VendorGridObj.Table.find((function(e){return e.VendorID==i.VendorID}));c.VendorAccount=this.VendorAccount.Text,c.VendorAccountSelectedValue=this.VendorAccount.SelectedValue,c.ETA=this.ETA.Text,c.Priority=this.Priority.Text,c.MinOrderQty=this.MinOrderQty.Text,c.Volume=this.Volume.Text,c.Weight=this.Weight.Text,c.Remarks=this.Remarks.Text,c.Barcode=this.Barcode.Text,c.VendorID=this.VendorID,this.Parent.ViewVendors.angularGrid.gridService.updateItem(c)}else{this.Parent.ViewVendors.VendorsList.push(this);var d={};null==this.Parent.ViewVendors.SelectedVendor?d=this.Parent.ViewVendors.VendorGridObj.NewRow():null!=this.Parent.ViewVendors.SelectedVendor&&(d=this.Parent.ViewVendors.VendorGridObj.Table.find((function(e){return e.VendorID==i.VendorID}))),d.VendorAccount=this.VendorAccount.Text,d.VendorAccountSelectedValue=this.VendorAccount.SelectedValue,d.ETA=this.ETA.Text,d.Priority=this.Priority.Text,d.MinOrderQty=this.MinOrderQty.Text,d.Volume=this.Volume.Text,d.Weight=this.Weight.Text,d.Remarks=this.Remarks.Text,d.Barcode=this.Barcode.Text,d.VendorID=this.VendorID,null!=this.Parent.ViewVendors.SelectedVendor||this.Parent.ViewVendors.VendorsList.Contains(d)?this.Parent.ViewVendors.angularGrid.gridService.updateItem(d):this.Parent.ViewVendors.angularGrid.dataView.addItem(d)}this.Parent.Vendor=new e(this.Parent),this.MessageVisibility=!1,s.a.page.HideDialog()}Logger.InfoLog("AddVendorViewModel::Exiting OnSaveVendor")}}else for(var h=0;h<this.BarcodeGrid.Table.length;h++)if(n.e.StringIsNullOrEmpty(this.BarcodeGrid.Table[h].Barcode)){var b={};b.Barcode=this.Barcode.Text,this.BarcodeGrid.insertRowAt(b,h),this.Barcode.Text="",this.BarcodeGrid.removeRowAt(this.BarcodeGrid.Table.length-1);break}}},{key:"onCanSaveVendor",value:function(e){return!0}},{key:"Title",get:function(){return this.IsVendor?s.a.GetResource("Inv_Vendors_AddTitle"):"Barcodes"}},{key:"angularGrid",get:function(){return this.BarcodeGrid.angularGrid}}]),e}(),U=i("sT9C");function _(e,t){if(1&e){var i=y.ac();y.Zb(0,"div"),y.Wc(1,"\n        "),y.Zb(2,"div",8),y.Wc(3,"\n            "),y.Vb(4,9),y.Wc(5,"\n        "),y.Yb(),y.Wc(6,"\n        "),y.Zb(7,"div",8),y.Wc(8,"\n            "),y.Vb(9,9),y.Wc(10,"\n        "),y.Yb(),y.Wc(11,"\n        "),y.Zb(12,"div",8),y.Wc(13,"\n            "),y.Vb(14,9),y.Wc(15,"\n        "),y.Yb(),y.Wc(16,"\n        "),y.Zb(17,"div",8),y.Wc(18,"\n            "),y.Vb(19,9),y.Wc(20,"\n        "),y.Yb(),y.Wc(21,"\n        "),y.Zb(22,"div",8),y.Wc(23,"\n            "),y.Vb(24,9),y.Wc(25,"\n        "),y.Yb(),y.Wc(26,"\n        "),y.Zb(27,"div",8),y.Wc(28,"\n            "),y.Vb(29,9),y.Wc(30,"\n        "),y.Yb(),y.Wc(31,"\n        "),y.Zb(32,"div",8),y.Wc(33,"\n            "),y.Vb(34,9),y.Wc(35,"\n        "),y.Yb(),y.Wc(36,"\n        "),y.Zb(37,"div",8),y.Wc(38,"\n            "),y.Zb(39,"h6",10),y.hc("click",(function(){return y.Ic(i),y.lc().obj.OnSaveVendor(null)})),y.Wc(40,"Add"),y.Yb(),y.Wc(41,"\n            "),y.Vb(42,9),y.Wc(43,"\n        "),y.Yb(),y.Wc(44,"\n   \n      "),y.Zb(45,"div",11),y.Wc(46,"\n        "),y.Ub(47,"app-PactGridView",12),y.Wc(48,"\n        "),y.Wc(49,"\n      "),y.Yb(),y.Wc(50," \n    "),y.Yb()}if(2&e){var s=y.lc();y.Db(4),y.tc("obj",s.obj.VendorAccount)("group",s.obj.form),y.Db(5),y.tc("obj",s.obj.ETA)("group",s.obj.form),y.Db(5),y.tc("obj",s.obj.Priority)("group",s.obj.form),y.Db(5),y.tc("obj",s.obj.MinOrderQty)("group",s.obj.form),y.Db(5),y.tc("obj",s.obj.Volume)("group",s.obj.form),y.Db(5),y.tc("obj",s.obj.Weight)("group",s.obj.form),y.Db(5),y.tc("obj",s.obj.Remarks)("group",s.obj.form),y.Db(8),y.tc("obj",s.obj.Barcode)("group",s.obj.form),y.Db(5),y.tc("obj",s.obj.BarcodeGrid)}}var W,F=((W=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||W)},W.\u0275cmp=y.Nb({type:W,selectors:[["app-add-vendor"]],decls:25,vars:8,consts:[[1,"master-screen",3,"formGroup"],[1,"PACTHeaderFields","dialogSubBodyNoScroll"],[4,"ngIf"],[1,"Pactdailogfooter"],[1,"primary-btn-wicon",3,"click"],[1,"fa-light","fa-floppy-disk"],[1,"secondary-btn-wicon",3,"click"],[1,"fa-light","fa-rectangle-xmark"],[1,"form-group","col-xl-12","col-md-12","col-sm-12","col-xs-12","PACTControl"],["FieldDirective","",3,"obj","group"],[2,"float","right","font-weight","600","color","#8477f3","text-decoration","underline",3,"click"],["id","divBarcode",1,"form-group","col-xl-12","col-xs-12","PACTControl"],[2,"width","100%",3,"obj"]],template:function(e,t){1&e&&(y.Wc(0,"\n"),y.Zb(1,"div",0),y.Wc(2,"\n    "),y.Zb(3,"div",1),y.Wc(4,"\n        "),y.Uc(5,_,51,17,"div",2),y.Wc(6,"\n  \n  "),y.Zb(7,"div",3),y.Wc(8,"\n    "),y.Zb(9,"div"),y.Wc(10,"\n        "),y.Zb(11,"button",4),y.hc("click",(function(){return t.obj.OnSaveVendor("Save")})),y.Ub(12,"i",5),y.Wc(13),y.mc(14,"translate"),y.Yb(),y.Wc(15,"\n        "),y.Zb(16,"button",6),y.hc("click",(function(){return t.obj.OnSaveVendor("Cancel")})),y.Ub(17,"i",7),y.Wc(18),y.mc(19,"translate"),y.Yb(),y.Wc(20,"\n    "),y.Yb(),y.Wc(21,"      \n  "),y.Yb(),y.Wc(22,"\n"),y.Yb(),y.Wc(23,"\n"),y.Yb(),y.Wc(24,"\n")),2&e&&(y.Db(1),y.tc("formGroup",t.obj.form),y.Db(4),y.tc("ngIf",t.obj.IsVendor),y.Db(8),y.Xc(y.nc(14,4,"Save")),y.Db(5),y.Xc(y.nc(19,6,"Cancel")))},directives:[P.t,P.k,V.t,M.a,U.a],pipes:[O.d],encapsulation:2}),W),K=function(){function e(t){_classCallCheck(this,e),this.Module="INV",this.ClassName="ViewVendorViewModel",this.Visible=!0,this.contextVisible=!0,this.Data=[],this.VendorGridObj=new g.a,this.ColumnSpan="4",this.VendorsList=[],this.SelectedVendor=null,this.DeletedVendors=[],this.ButtonAdd=new d.a,this.ButtonUpdate=new d.a,this.ButtonDelete=new d.a,Logger.InfoLog("ViewVendorViewModel:: Entering ViewVendorViewModel With oParent="+t),this.Parent=t,s.a.SessionManager.HideUnathorizedAccess?this.ButtonAdd.Visible=s.a.SessionManager.IsActionAssigned(t.CostCenterID,"Vendor_Create"):this.ButtonAdd.Enable=s.a.SessionManager.IsActionAssigned(t.CostCenterID,"Vendor_Create"),s.a.SessionManager.HideUnathorizedAccess?this.ButtonUpdate.Visible=s.a.SessionManager.IsActionAssigned(t.CostCenterID,"Vendor_Update"):this.ButtonUpdate.Enable=s.a.SessionManager.IsActionAssigned(t.CostCenterID,"Vendor_Update"),s.a.SessionManager.HideUnathorizedAccess?this.ButtonDelete.Visible=s.a.SessionManager.IsActionAssigned(t.CostCenterID,"Vendor_Delete"):this.ButtonDelete.Enable=s.a.SessionManager.IsActionAssigned(t.CostCenterID,"Vendor_Delete"),this.Data=[],this.InitGrid(),Logger.InfoLog("ViewVendorViewModel:: Exiting ViewVendorViewModel")}return _createClass(e,[{key:"OnCmnItem_Click",value:function(e){this.SelectedVendor=null;var t=null,i=this.angularGrid.slickGrid.getSelectedRows();if(i.length>0){switch(this.SelectedVendor=this.VendorsList[i[0]],t=this.VendorGrid[i[0]],Logger.InfoLog("ViewVendorViewModel::Entering OnCmnItem_Click With strCommand="+e),e){case"EDIT":null!=this.SelectedVendor&&(this.Parent.Vendor=this.SelectedVendor,this.Parent.VendorVisibility=!0,null!=this.Parent.Vendor&&s.a.page.ShowDialog(this.Parent.Vendor,F,{Title:"Edit Vendor"}));break;case"DELETE":null!=this.SelectedVendor&&(this.SelectedVendor.VendorID>0&&this.DeletedVendors.push(this.SelectedVendor),this.VendorGridObj.removeRow(t),this.angularGrid.gridService.deleteItem(t))}Logger.InfoLog("ViewVendorViewModel::Exiting OnCmnItem_Click")}}},{key:"onCanCmnItem_Click",value:function(e){return!0}},{key:"GetXML",value:function(){Logger.InfoLog("ViewVendorViewModel::Entering GetXML");for(var e="",t=0;t<this.VendorsList.length;t++){if(0==this.VendorsList[t].VendorID)e+='<Row Action="NEW"';else{if(!this.VendorsList[t].IsModified)continue;e+='<Row Action="MODIFY"'}e+=' VendorID="'+this.VendorsList[t].VendorID+'"',e+=' AccountID="'+this.VendorsList[t].VendorAccount.SelectedValue+'"',e+=' Priority="'+this.VendorsList[t].Priority.Text+'"',e+=' MinOrderQty="'+this.VendorsList[t].MinOrderQty.Text+'"',e+=' LeadTime="'+this.VendorsList[t].ETA.Text+'"',e+=' Barcode="'+this.VendorsList[t].Barcode.Text+'"',e+=' Volume="'+this.VendorsList[t].Volume.Text+'"',e+=' Weight="'+this.VendorsList[t].Weight.Text+'"',e+=' Remarks="'+this.VendorsList[t].Remarks.Text+'"',e+="/>"}for(var i=0;i<this.DeletedVendors.length;i++)e+='<Row Action="DELETE"',e+=' VendorID="'+this.DeletedVendors[i].VendorID+'"/>';return e.length>0&&(e="<VendorsXML>"+e+"</VendorsXML>"),Logger.InfoLog("ViewVendorViewModel::Exiting GetXML Which Returns XML as"+e),e.toString()}},{key:"OnShowNewVendor",value:function(e){Logger.InfoLog("AddProductViewModel::Entering OnShowNewVendor");try{this.SelectedVendor=null,this.Parent.Vendor=new j(this.Parent),this.Parent.VendorVisibility=!0,s.a.page.ShowDialog(this.Parent.Vendor,F,{Title:this.Parent.Vendor.Title}),Logger.InfoLog("AddProductViewModel::Exiting OnShowNewVendor")}catch(t){Logger.ErrorLog("AddProductViewModel:: OnShowNewVendor"+t.stack.toString())}}},{key:"InitGrid",value:function(){this.VendorGridObj.Clear();var e=[],t=new C.a;(t=new C.a).CostCenterID=3,t.TypeID=13,t.DataType="LISTBOX",t.DisplayMember="VendorAccount",t.ValueMember="NodeNo",t.Header=s.a.GetResource("Inv_Vendors_VendorName"),t.ReadOnly=!0,t.Width=150,e.push(t),(t=new C.a).DisplayMember="ETA",t.Header=s.a.GetResource("Inv_Vendors_ETA"),t.DataType="TextBlock",t.Width=150,t.ReadOnly=!0,t.IsVisible=!0,e.push(t),(t=new C.a).DisplayMember="Priority",t.Header=s.a.GetResource("Inv_Vendors_Priority"),t.DataType="TextBlock",t.Width=150,t.ReadOnly=!0,t.IsVisible=!0,e.push(t),(t=new C.a).DisplayMember="MinOrderQty",t.Header=s.a.GetResource("Inv_Vendors_MinOrderQty"),t.DataType="TextBlock",t.Width=150,t.ReadOnly=!0,t.IsVisible=!0,e.push(t),(t=new C.a).DisplayMember="Remarks",t.Header=s.a.GetResource("Remarks"),t.DataType="TextBlock",t.Width=150,t.ReadOnly=!0,t.IsVisible=!0,e.push(t),(t=new C.a).DisplayMember="Barcode",t.Header=s.a.GetResource("Barcode"),t.DataType="TextBlock",t.Width=150,t.ReadOnly=!0,t.IsVisible=!0,e.push(t),this.ColumnSource=e}},{key:"LoadVendors",value:function(e){var t=this;if(Logger.InfoLog("ViewVendorViewModel::Entering LoadVendors With DataTable"+e),null!=this.Data&&null!=this.Data.Tables){var i=this.Data.Tables[this.Data.Tables.length-1];i.sort((function(e,t){return e.TabOrder-t.TabOrder}));for(var s=0;s<i.length;s++){var a=new E.b;a.Name=i[s].CCTabName.toString(),a.Header=i[s].ResourceData.toString(),Object(r.j)(i[s].IsVisible)&&this.CustomTab.Pages.push(a)}}var o,l=new Array;this.VendorsList.Clear();for(var u=function(i){if(l.Contains(parseInt(e[i].ProductVendorID)))t.VendorsList.forEach((function(t){t.VendorID==parseInt(e[i].ProductVendorID)&&(t.Barcode.Text=t.Barcode.Text+","+e[i].Barcode.toString())}));else{o=new j(t.Parent),l.push(parseInt(e[i].ProductVendorID)),o.VendorID=parseInt(e[i].ProductVendorID),o.Priority.Text=e[i].Priority.toString(),null==e[i].MinOrderQty||n.e.StringIsNullOrEmpty(e[i].MinOrderQty)||(o.MinOrderQty.Text=e[i].MinOrderQty.toString()),null==e[i].Remarks||n.e.StringIsNullOrEmpty(e[i].Remarks)||(o.Remarks.Text=e[i].Remarks.toString()),n.e.StringIsNullOrEmpty(e[i].LeadTime)||(o.ETA.Text=e[i].LeadTime.toString()),n.e.StringIsNullOrEmpty(e[i].Barcode)||(o.Barcode.Text=e[i].Barcode.toString()),n.e.StringIsNullOrEmpty(e[i].AccountID)||(o.VendorAccount.SelectedValue=parseInt(e[i].AccountID)),n.e.StringIsNullOrEmpty(e[i].AccountName)||(o.VendorAccount.Text=e[i].AccountName.toString()),null==e.Volume||n.e.StringIsNullOrEmpty(e[i].Volume)||(o.Volume.Text=e[i].Volume.toString()),null==e.Weight||n.e.StringIsNullOrEmpty(e[i].Weight)||(o.Weight.Text=e[i].Weight.toString()),t.VendorsList.push(o);var s=t.VendorGridObj.NewRow();s.VendorAccount=o.VendorAccount.Text,s.VendorAccountSelectedValue=o.VendorAccount.SelectedValue,s.ETA=o.ETA.Text,s.Priority=o.Priority.Text,s.MinOrderQty=o.MinOrderQty.Text,s.Remarks=o.Remarks.Text,s.Barcode=o.Barcode.Text,s.VendorID=o.VendorID,t.Parent.ViewVendors.VendorGridObj.addRow(s)}},c=0;c<e.length;c++)u(c);Logger.InfoLog("ViewVendorViewModel::Exiting LoadVendors")}},{key:"LoadVendorsCopy",value:function(){Logger.InfoLog("ViewVendorViewModel::Entering LoadVendorsCopy");for(var e=0;e<this.VendorsList.length;e++)this.VendorsList[e].VendorID=0;Logger.InfoLog("ViewVendorViewModel::Exiting LoadVendorsCopy")}},{key:"angularGrid",get:function(){return this.VendorGridObj.angularGrid}},{key:"VendorGrid",get:function(){return this.VendorGridObj.Table}},{key:"ColumnSource",get:function(){return this.VendorGridObj.Columns},set:function(e){this.VendorGridObj.Columns=e}},{key:"VendorGridColumns",get:function(){return this.VendorGridObj.TableColumns}}]),e}(),H=i("JIg3"),X=i("4HhE"),Q=i("m+Ff"),z=i("Lb65"),Y=function(){function e(t){_classCallCheck(this,e),this.Module="INV",this.ClassName="ProductAttributeNewViewModel",this.Visible=!0,this.contextVisible=!0,this.UpdateFooter=!1,this.PickerClick=new X.b,this.AddNew=new X.b,this.ButtonClick=new X.b,this.CellEditEnding=new X.b,this.CostCenterClick=new X.b,this.SelectionChangedCommand=new X.b,this.MatrixSelectionChangedCommand=new X.b,this.MatrixPanel=!1,this._IsMatrixItem=!1,this.IsSubItem=!1,this.AttributePanel=!1,this.LotWise=[],this.AttributesList=!1,this.SelectedValue=0,this.LSelectedValue=0,this.DisplayName="",this.BarcodeData=[],this.Items=[],this.Seperator="",this.ColumnSource=[],this.ColumnSpan="4",this.MessageVisibility=!1,this.IsMaster=!0,this.Title="",this.GridWidth="",this.DisplayMessage="",this.Profiles=new u.e(0),this.Name=new l.d(0),this.Documents=new u.e(0),this.Columns=new u.e(0),this.Price=new l.d(0),this.WEF=new H.a(0),this.GridHeight="300",this._IsExpanded=!1,this.CCList=[],this.TextList=[],this.CostCenters=new u.a(0),this.TaxChartTable=[],this.UseProductCode=!1,this.StockList=[],this.Islotwise=!1,this.Code="",this.j=0,this.ProductIndex=0,this.stkItemName="",this.stkItemCode="",this.stkCode=null,this.stkID=null,this.stkName=null,console.log(t),Logger.InfoLog("AddTaxChartViewModel::Entering AddTaxChartViewModel With Parent="+t),this.Parent=t,this.MessageVisibility=!1,this.DisplayMessage="",this.GridWidth=(window.innerWidth-300).toString(),this.ButtonClick.Subscribe(this,"OnButtonClick"),this.PickerClick.Subscribe(this,"OnPickerClick"),this.AddNew.Subscribe(this,"OnAddNew"),this.SelectionChangedCommand.Subscribe(this,"Click"),this.MatrixSelectionChangedCommand.Subscribe(this,"onMatrixSelectionChangedCommand"),this.CostCenterClick.Subscribe(this,"OnCostCenterClick"),this.InitControls(),this.GetData(),this.Click("Attribute"),Logger.InfoLog("ProductAttributeNewViewModel::Exiting ProductAttributeNewViewModel")}return _createClass(e,[{key:"ProductAttributeNewViewModel_1",value:function(e){var t=this;Logger.InfoLog("AddTaxChartViewModel::Entering AddTaxChartViewModel With Parent="+e),this.Parentdoc=e,this.IsMaster=!1,this.AttributePanel=!0,this.MessageVisibility=!1,this.DisplayMessage="",this.GridWidth=(window.innerWidth-300).toString(),this.ButtonClick.Subscribe(this,"OnButtonClick"),this.CellEditEnding.Subscribe(this,"OnCellEditEnding"),this.AddNew.Subscribe(this,"OnAddNew"),this.PickerClick.Subscribe(this,"OnPickerClick"),this.SelectionChangedCommand.Subscribe(this,"Click"),this.MatrixSelectionChangedCommand.Subscribe(this,"onMatrixSelectionChangedCommand"),this.CostCenterClick.Subscribe(this,"OnCostCenterClick"),this.CCList=[],this.TextList=[];var i=e.ScreenObject.GetMatrixInfo(e.SelectedRow.ProductID_Key.toString());if(null!=i&&i.Tables.length>0&&i.Tables[0].length>0&&i.Columns[0].Contains("AttributeID")&&("1"!=i.Tables[0][0].islotwise.toString()&&"True"!=i.Tables[0][0].islotwise.toString()||(this.Islotwise=!0),i.Tables[0].forEach((function(i){if(null==e.ScreenObject.ColumnSource.find((function(e){return e.DisplayMember.toLowerCase()=="dcccnid"+(parseInt(i.AttributeID.toString())-5e4)})))return e.DisplayMessage='Define "'+i.NAME.toString()+'" in document.',e.MessageVisibility=!0,void(t.MessageVisibility=!0);var s=new u.a(0);s.DBColumnName=i.AttributeID.toString(),s.CheckedChangedCommand.Subscribe(t,"Oncheckedchanged"),s.FeatureID=parseInt(i.AttributeID.toString()),s.Label=i.NAME.toString(),t.CCList.push(s)}))),e.ScreenObject.Preferences.ContainsKey("AttributesMap")&&""!=e.ScreenObject.Preferences.AttributesMap)for(var s=e.ScreenObject.Preferences.AttributesMap.split(","),n=function(i){if(null!=(a=e.ScreenObject.ColumnSource.find((function(e){return e.ID==s[i]})))){var n=new l.d;n.DBColumnName=a.DisplayMember,n.DataType="FLOAT",n.Label=a.Header,n.Width="100",n.Action=a.Width,t.TextList.push(n)}},r=0;r<s.length;r++){var a;n(r)}this.UpdateCCListPositions(),this.BuildTempDataTable(),this.GridHeight="450";for(var o=0;o<20;o++){var c=this.StockList.NewRow();c.Sno=this.StockList.length+1,this.StockList.push(c)}Logger.InfoLog("ProductAttributeNewViewModel::Exiting ProductAttributeNewViewModel")}},{key:"onMatrixSelectionChangedCommand",value:function(e){if(-100==this.SelectedValue){var t=[];this.CostCenters.Items.length>0&&this.CostCenters.Items.forEach((function(e){var i=new Q.ViewColumn;i.CostCenterColID=parseInt(e.Value),i.UserColumnName=e.Name.toString(),t.lstLeft.push(i)}))}else this.CheckMatrix()}},{key:"Click",value:function(e){Logger.InfoLog("Click::Entering Click"),"Matrix"==e.toString()?(this.MatrixPanel=!0,this.AttributePanel=!1,this.AttributesList=!1,this.IsMatrixItem=!0,this.IsSubItem=!1):"Attribute"==e.toString()&&(this.MatrixPanel=!1,this.AttributePanel=!0,this.AttributesList=!0,this.IsMatrixItem=!1,this.IsSubItem=!0,this.CheckMatrix()),Logger.InfoLog("Click::Exiting Click")}},{key:"CheckMatrix",value:function(){var e=this;if(this.SelectedValue>0&&!this.IsMatrixItem&&this.IsSubItem){var t=s.a.inventory.GetMatrixData(this.SelectedValue);null!=t&&null!=t&&t.Tables.length>0&&t.Tables[0].length>0&&(this.Clear(),t.Tables[0].forEach((function(t){var i=e.CostCenters.Items.find((function(e){return e.Value==t.AttributeID.toString()}));null!=i&&(i.IsChecked=!0,e.OnCostCenterClick(i))})))}}},{key:"GetData",value:function(){Logger.InfoLog("ProductAttributesViewModel::Entering GetData");var e=s.a.inventory.GetMatrixData(0),t=e.Tables[0];null!=t&&t.length>0&&(this.Items=t),e.Tables.length>1&&(this.BarcodeData=e.Tables[1]),this.LotWise=[],this.LotWise.push(u.d.ComboBoxItems_2(s.a.GetResource("Com_Yes"),"1")),this.LotWise.push(u.d.ComboBoxItems_2(s.a.GetResource("Com_No"),"0")),Logger.InfoLog("ProductAttributesViewModel::Leaving GetData")}},{key:"LoadAttributes",value:function(e,t){Logger.InfoLog("LoadAttributes:: Entering LoadAttributes With DataTable="+e+",flg="+t),this.SelectedValue=null!=e[0].AttributeGroupID&&""!=e[0].AttributeGroupID.toString()?parseInt(e[0].AttributeGroupID.toString()):0,t&&(this.LSelectedValue=null!=e[0].IsLotwise&&""!=e[0].IsLotwise.toString()?parseInt(e[0].IsLotwise):0,this.Click("Matrix")),Logger.InfoLog("LoadAttributes:: Exiting LoadAttributes")}},{key:"LoadSubItems",value:function(e){var t=this;this.CCList.Clear(),this.CostCenters.Enable=!1,this.CostCenters.Items.forEach((function(e){e.IsChecked=!1}));var i=e[0].AttributeMapXML.toString();if(i.length>0){var s=new n.f;s.LoadXml(i);for(var r=function(e){var i=s.DocumentElement.children[e];null!=(o=t.CostCenters.Items.find((function(e){return e.Value==i.attributes.CID.Value})))&&(o.IsChecked=!0,t.OnCostCenterClick(o))},a=0;a<s.DocumentElement.children.length;a++){var o;r(a)}}this.BuildTempDataTable()}},{key:"InitControls",value:function(){this.CCList=[],this.Columns.Label=s.a.GetResource("Import_Column"),this.CostCenters.Label=s.a.GetResource("CostCenter_CostCenterslist");var e=s.a.inventory.GetTaxChart(0,0,"");if(null!=e&&e.Tables.length>0){var t=e.Tables[0];if((t=t.filter((function(e){return e.ID>=5e4}))).length>0)for(var i=0;i<t.length;i++)this.CostCenters.Items.push(u.c.CheckedListBoxItem_5(t[i].NAME.toString(),t[i].ID.toString(),!1))}}},{key:"Clear",value:function(){this.CCList.Clear(),this.CostCenters.Enable=!0,this.CostCenters.Items.forEach((function(e){e.IsChecked=!1})),this.BuildTempDataTable()}},{key:"OnFreeze",value:function(e){if("DataGridPactListBoxColumn"==e.Column.Name){var t=e.Column,i=this.CCList.find((function(e){return e.FeatureID==t.CostCenterID}));null!=i&&(i.OnlyGroup=!i.OnlyGroup),e.Owner.MakeColumnNoTab(t,!i.OnlyGroup,i.OnlyGroup?"#68cbe8":""),t.DisableTab=i.OnlyGroup}else if("PactTextBoxColumnEx"==e.Column.GetType()){var s=e.Column.Binding.Path.Path,n=this.ColumnSource.find((function(e){return e.DisplayMember==s}));null!=n&&(n.IsRepeat=!n.IsRepeat),e.Owner.MakeColumnNoTab(e.Column,!n.IsRepeat,n.IsRepeat?"#68cbe8":""),e.Column.DisableTab=n.IsRepeat}}},{key:"OnCellEditEnding",value:function(e){var t=this,i=-1,s=e.OriginalSource.RowDataItem.Row;if(e.OriginalSource.Column.GetType()==typeof z.b){var n=e.OriginalSource.Column.Binding.Path.Path;""!=s[n+"_Key"].toString()&&(""==s.AttributeMap.toString()&&((i=s.Table.Rows.indexOf(s))>0&&this.ColumnSource.forEach((function(e){if("LISTBOX"==e.DataType){var n=t.CCList.find((function(t){return t.FeatureID==e.CostCenterID}));null!=n&&n.OnlyGroup&&(null!=s[e.DisplayMember]&&null!=s[e.DisplayMember]&&""!=s[e.DisplayMember].toString()||(s[e.DisplayMember]=s.Table.Rows[i-1][e.DisplayMember],s[e.ValueMember]=s.Table.Rows[i-1][e.ValueMember]))}else e.IsRepeat&&(s[e.DisplayMember]=s.Table.Rows[i-1][e.DisplayMember])}))),s.AttributeMap=s[n].toString())}else(i=s.Table.Rows.indexOf(s))>0&&this.ColumnSource.forEach((function(e){if("LISTBOX"==e.DataType){var n=t.CCList.find((function(t){return t.FeatureID==e.CostCenterID}));null!=n&&n.OnlyGroup&&(null!=s[e.DisplayMember]&&null!=s[e.DisplayMember]&&""!=s[e.DisplayMember].toString()||(s[e.DisplayMember]=s.Table.Rows[i-1][e.DisplayMember],s[e.ValueMember]=s.Table.Rows[i-1][e.ValueMember]))}else e.IsRepeat&&(null!=s[e.DisplayMember]&&null!=s[e.DisplayMember]&&""!=s[e.DisplayMember].toString()||(s[e.DisplayMember]=s.Table.Rows[i-1][e.DisplayMember]))}));s.AcceptChanges();var r=this.ColumnSource.find((function(t){return t.DisplayMember==e.OriginalSource.Column.Binding.Path.Path&&"FLOAT"==t.DataType}));null!=r&&this.Calculatetotals(r)}},{key:"Calculatetotals",value:function(e){for(var t=0,i=0;i<this.StockList.length;i++)null!=this.StockList.Rows[i][e.DisplayMember]&&null!=this.StockList.Rows[i][e.DisplayMember]&&""!=this.StockList.Rows[i][e.DisplayMember].toString().Trim()&&(t+=parseFloat(this.StockList.Rows[i][e.DisplayMember]));e.footer=t.ToString("N"+e.DecimalPoints),this.UpdateFooter=!0}},{key:"OnButtonClick",value:function(e){if("AddProducts"==e);else if("AddAccounts"==e);else if("Generate"==e)this.GenerateClick();else if("Cancel"==e);else if("OK"==e){var t=0;null!=this.Parentdoc.SelectedRow&&this.Parentdoc.SelectedRow&&(t=this.Parentdoc.ScreenObject.GridData.indexOf(this.Parentdoc.SelectedRow));for(var i=0,n=0;n<this.StockList.length;n++)if(""!=this.StockList[n].AttributeMap.toString()){var r=void 0;if(0==i)r=this.Parentdoc.SelectedRow;else{r=this.Parentdoc.ScreenObject.GridData.NewRow();for(var a=0;a<this.Parentdoc.ScreenObject.GridData.Columns.length;a++)"docseqno"!=this.Parentdoc.ScreenObject.GridData.Columns[a].ColumnName.toLowerCase()&&"LinkedFieldName"!=this.Parentdoc.ScreenObject.GridData.Columns[a].ColumnName.toLowerCase()&&"sno"!=this.Parentdoc.ScreenObject.GridData.Columns[a].ColumnName.toLowerCase()&&"LinkedInvDocDetailsID"!=this.Parentdoc.ScreenObject.GridData.Columns[a].ColumnName.toLowerCase()&&"RefNO"!=this.Parentdoc.ScreenObject.GridData.Columns[a].ColumnName.toLowerCase()&&"docdetailsid"!=this.Parentdoc.ScreenObject.GridData.Columns[a].ColumnName.toLowerCase()&&(r[a]=this.Parentdoc.SelectedRow[a]);this.Parentdoc.ScreenObject.GridData.InsertAt(r,t+i)}i++;for(var o=0;o<this.CCList.length;o++)r["dcCCNID"+(parseInt(this.CCList[o].DBColumnName)-5e4)]=this.StockList[n][this.CCList[o].Label],r["dcCCNID"+(parseInt(this.CCList[o].DBColumnName)-5e4)+"_Key"]=this.StockList[n][this.CCList[o].Label+"_Key"];for(var l=0;l<this.TextList.length;l++)""!=this.StockList[n][this.TextList[l].DBColumnName].toString()&&(r[this.TextList[l].DBColumnName]=this.StockList[n][this.TextList[l].DBColumnName]);if(this.Parentdoc.CalculateTotals(r,!1,"Quantity"),this.Islotwise&&null!=this.StockList[n].Quantity&&null!=this.StockList[n].Quantity&&""!=this.StockList[n].Quantity.toString()&&parseFloat(this.StockList[n].Quantity)>1){var u=parseInt(r.Quantity);r.Quantity=1,this.Parentdoc.CalculateTotals(r,!1,"Quantity");for(var c=0;c<u-1;c++){var d=this.Parentdoc.ScreenObject.GridData.NewRow();d.ItemArray=r.ItemArray.Clone(),this.Parentdoc.ScreenObject.GridData.Rows.InsertAt(d,t+i),this.Parentdoc.CalculateTotals(r,!1,"Quantity"),i++}}}this.Parentdoc.ScreenObject.UpdateSequence(),s.a.page.HideDialog()}else"Save"==e&&this.SaveClick();Logger.InfoLog("OnButtonClick:: Exiting OnButtonClick")}},{key:"Oncheckedchanged",value:function(e){this.CCList.find((function(t){return t.DBColumnName==e.toString()}))}},{key:"OnAddNew",value:function(e){Logger.InfoLog("OnAddNew::Entering OnAddNew With String="+e),this.CCList.find((function(t){return t.DBColumnName==e})),Logger.InfoLog("OnAddNew:: Exiting OnAddNew")}},{key:"OnPickerClick",value:function(e){Logger.InfoLog("OnPickerClick::Entering OnPickerClick With String="+e),s.a.page.ShowDialog("3"==e?(new D.a).SearchPickerViewModel_2(this,"PRODUCTS"):"2"==e?(new D.a).SearchPickerViewModel_2(this,"ACCOUNTS"):(new D.a).SearchPickerViewModel_3(this,"COSTCENTER",e),f.a),Logger.InfoLog("OnPickerClick:: Exiting OnPickerClick")}},{key:"OnCostCenterClick",value:function(e){if(Logger.InfoLog("OnCostCenterClick::Entering OnCostCenterClick With oItem="+e),e.IsChecked){var t=new u.a(0);t.DBColumnName=e.Value,t.FeatureID=parseInt(e.Value),t.Label=e.Name,this.CCList.push(t)}else for(var i=0;i<this.CCList.length;i++)if(this.CCList[i].DBColumnName==e.Value){this.CCList.RemoveAt(i);break}this.UpdateCCListPositions(),Logger.InfoLog("OnCostCenterClick:: Exiting OnCostCenterClick")}},{key:"ParentCallBack",value:function(e){if(Logger.InfoLog("ParentCallBack :: Entering ParentCallBack With PickerObject="+e),"COSTCENTER"==e.PickerType||"PRODUCTS"==e.PickerType||"ACCOUNTS"==e.PickerType){var t=this.CCList.filter((function(t){return t.DBColumnName==e.TreeCCID.toString()}));if(t.length>0){var i=t[0];e.SelectedNodes.forEach((function(e){e.IsGroup||0==i.Items.filter((function(t){return t.Value==e.Id.toString()})).length&&(i.Items.push(u.c.CheckedListBoxItem_5(e.Text[1],e.Id.toString(),!0)),i.Items[i.Items.length-1].Parent=e.Text[0])}))}}Logger.InfoLog("ParentCallBack::Exiting ParentCallBack")}},{key:"SaveClick",value:function(){if(n.e.StringIsNullOrEmpty(this.Name.Text))this.DisplayMessage="Select "+this.Name.Label;else{var e="";this.TaxChartTable.forEach((function(t){e+="<Row ",e+=' DocID="'+t.Document_Key+'"',e+=' ColID="'+t.Column_Key+'"',e+=' CC="'+t.CC+'"',e+=' ID="'+t.CCID+'"',e+=' Price="'+t.Price+'"',e+=' WEF="'+t.WEF+'"',e+="/>"})),e.length>0&&(e="<XML>"+e+"</XML>")}}},{key:"GenerateClick",value:function(){var e=this,t=this.CCList.length;this.BuildTempDataTable(),this.DisplayMessage="",this.stkCode=[t],this.stkID=[t],this.stkName=[t],this.CCList.length>0&&this.CallRecursive(0),this.RefreshSno(this.StockList),this.ColumnSource.forEach((function(t){"FLOAT"==t.DataType&&e.Calculatetotals(t)}))}},{key:"BuildTempDataTable",value:function(){if(this.IsMaster||!(this.StockList.Columns.length>0)){var e=[],t=[],i=new C.a;(i=new C.a).DisplayMember="Sno",i.Header="Sno",i.DataType="TextBlock",i.Width=38,i.ReadOnly=!0,t.push(i),this.IsMaster&&((i=new C.a).DisplayMember="ItemCode",i.Header="Item Code",i.DataType="TextBlock",i.Width=100,i.ReadOnly=!0,t.push(i),(i=new C.a).DisplayMember="ItemName",i.Header="Item Name",i.DataType="TextBlock",i.Width=120,i.ReadOnly=!0,t.push(i)),e.Columns.push("Sno"),e.Columns.push("ItemName"),e.Columns.push("ItemCode"),e.Columns.push("AttributeMap");for(var s=0;s<this.CCList.length;s++)(i=new C.a).DisplayMember=this.CCList[s].Label,i.Header=this.CCList[s].Label,this.IsMaster?(i.ReadOnly=!0,i.DataType="TextBlock"):(i.DataType="LISTBOX",i.CostCenterID=parseInt(this.CCList[s].DBColumnName),i.TypeID=1),i.Width=100,t.push(i),e.Columns.push(this.CCList[s].Label);if(!this.IsMaster){for(var n=0;n<this.CCList.length;n++)e.Columns.push(this.CCList[n].Label+"_Key");for(var r=0;r<this.TextList.length;r++)(i=new C.a).DisplayMember=this.TextList[r].DBColumnName,i.Header=this.TextList[r].Label,"FLOAT"==this.TextList[r].DataType?(i.DataType="FLOAT",i.ShowTotal=!0,i.IsCalculated=1,i.footer=(0).ToString("N"+this.TextList[r].DecimalPoints)):i.DataType="TextBlock",i.Width=this.TextList[r].Action,t.push(i),e.Columns.push(this.TextList[r].DBColumnName)}this.ColumnSource=t,this.StockList=e}}},{key:"dtStock_RowDeleted",value:function(e,t){for(var i=1,s=0;s<e.length;s++)e[s].SNO=i.toString(),i++}},{key:"RefreshSno",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"sno",i=1,s=0;s<e.length;s++)e.Rows[s][t]=i.toString(),i++}},{key:"CallRecursive",value:function(e){for(var t=0;t<this.CCList[e].Items.length;t++)if(this.CCList[e].Items[t].IsChecked)if(this.stkCode[e]=this.CCList[e].Items[t].Parent,"Name"==this.CCList[e].CodeNameCombo.SelectedValue?(this.stkName[e]=this.CCList[e].Items[t].Name,this.stkID[e]=this.CCList[e].Items[t].Value):(this.stkName[e]=this.CCList[e].Items[t].Parent,this.stkID[e]=this.CCList[e].Items[t].Value),e==this.CCList.length-1){var i=null;for(this.IsMaster?(i={},this.StockList.push(i)):i=this.StockList[this.Parentdoc.GetEmptyRowPosition(this.StockList,"AttributeMap")],this.stkItemCode="",this.j=0;this.j<this.stkCode.length;this.j++)this.j>0&&(this.stkItemCode+=this.Seperator),this.stkItemCode+=this.stkCode[this.j];for(i[0]=this.StockList.length,this.stkItemName="",this.j=0;this.j<this.stkName.length;this.j++)this.stkItemName.length>0&&(this.stkItemName+=this.Seperator),this.stkItemName+=this.stkName[this.j],i[4+this.j]=this.stkName[this.j],i[4+this.stkName.length+this.j]=this.stkID[this.j];if(this.stkItemCode=this.stkItemCode.Replace(" ",""),this.stkItemName=this.stkItemName.Replace(" ",""),this.IsMaster){var s="";for(0==this.Parent.ProductID?(this.Parent.ProductCode.PrefixVisibility&&!n.e.StringIsNullOrEmpty(this.Parent.ProductCode.PrefixCode)&&(s=this.Parent.ProductCode.PrefixCode),n.e.StringIsNullOrEmpty(this.Parent.ProductCode.Text)||(s+=this.Parent.ProductCode.Text),this.Parent.ProductCode.SuffixVisibility&&!n.e.StringIsNullOrEmpty(this.Parent.ProductCode.SuffixCode)&&(s+=this.Parent.ProductCode.SuffixCode)):s=this.Parent.ProductCode.Text,i.ItemCode=s+this.Seperator+this.stkItemCode,i.ItemName=this.UseProductCode?s+this.Seperator+this.stkItemName:this.Parent.ProductName.Text+this.Seperator+this.stkItemName,this.stkItemName="",this.j=0;this.j<this.stkName.length;this.j++)this.stkItemName+="CCNID"+(this.CCList[this.j].FeatureID-5e4)+"="+this.stkID[this.j]+",";i.AttributeMap=this.stkItemName}else{for(this.stkItemName="",this.j=0;this.j<this.stkName.length;this.j++)this.stkItemName+="CCNID"+(this.CCList[this.j].FeatureID-5e4)+"="+this.stkID[this.j]+",";i.AttributeMap=this.stkItemName;for(var r=0;r<this.TextList.length;r++)n.e.StringIsNullOrEmpty(this.TextList[r].Text)||(i[this.TextList[r].DBColumnName]=this.TextList[r].Text);if(this.Islotwise){var a=0,o=this.TextList.find((function(e){return"quantity"==e.DBColumnName.toLowerCase()}));if(null==o||null==o||n.e.StringIsNullOrEmpty(o.Text)||(a=n.e.IntTryParse(o.Text)),a>1)for(var l=0;l<a-1;l++){i.quantity="1";for(var u=this.StockList[this.Parentdoc.GetEmptyRowPosition(this.StockList,"AttributeMap")],c=0;c<this.StockList.Columns.length;c++)"Sno"!=this.StockList.Columns[c].ColumnName&&(u[c]=i[c])}}}}else this.CallRecursive(e+1)}},{key:"ValidateSelectedNodes",value:function(e){0==e.Items.filter((function(e){return e.IsChecked})).length&&(this.DisplayMessage="Select "+e.Label)}},{key:"UpdateCCListPositions",value:function(){for(var e=0;e<this.CCList.length;e++)this.CCList[e].Row=e/3,this.CCList[e].Column=e%3}},{key:"GetXml",value:function(){var e="";e+="<XML>";var t=0;for(t=0;t<this.CCList.length;t++)e+='<Row CID="'+this.CCList[t].FeatureID+'" />';return(e+="</XML>").toString()}},{key:"GetStringData",value:function(e,t){Logger.InfoLog("GetStringData:: Entering GetStringData With CCID="+e+",CCNodeID="+t);var i=this.CCList.filter((function(t){return t.DBColumnName==e}));if(i.length>0){var s=i[0].Items.filter((function(e){return e.Value==t}));if(s.length>0)return s[0].Name}return Logger.InfoLog("GetStringData::Exiting GetStringData"),""}},{key:"IsMatrixItem",get:function(){return this._IsMatrixItem},set:function(e){e!=this._IsMatrixItem&&(this.IsSubItem=!!this._IsMatrixItem,this._IsMatrixItem=e)}},{key:"IsExpanded",get:function(){return this._IsExpanded},set:function(e){e!=this._IsExpanded&&(this.GridHeight=this.IsExpanded?"450":"300",this._IsExpanded=e)}}]),e}(),Z=function(){function e(t){if(_classCallCheck(this,e),this.Module="INV",this.ClassName="AddProductTestcasesViewModel",this.Visible=!0,this.contextVisible=!0,this.ColumnSpan="4",this.TestCaseDim=new c.b(0),this.Iteration=new l.d(0),this.Sample=new l.d(0),this.DocumentsList=new u.e(0),this.Dimension=new c.b(0),this.TestcaseGrid=new g.a,this.TestCaseGridColumnsTemp=[],this.Documents=[],this.form=new P.j({}),this.ProductViewModel=t,this.TestcaseGrid=new g.a,this.TestcaseGrid.Width="",this.TestcaseGrid.CanUserAddRows=!0,this.TestcaseGrid.CanUserDeleteRows=!0,this.TestcaseGrid.CellEditEnding.Subscribe(this,"OnGridCellEditEnding"),this.Documents.push(u.d.ComboBoxItems_2("","1")),null!=t.ScreenObject.Data&&t.ScreenObject.Data.Tables.length>15)for(var i=0;i<t.ScreenObject.Data.Tables[16].length;i++)this.Documents.push(u.d.ComboBoxItems_2(t.ScreenObject.Data.Tables[16][i].DocumentName.toString(),t.ScreenObject.Data.Tables[16][i].CostCenterID.toString()));s.a.SessionManager.Preferences.ContainsKey("TestCaseDimension")&&""!=s.a.SessionManager.Preferences.TestCaseDimension&&parseInt(s.a.SessionManager.Preferences.TestCaseDimension)>0&&(this.TestCaseDim.CCID=parseInt(s.a.SessionManager.Preferences.TestCaseDimension)),s.a.SessionManager.Preferences.ContainsKey("DimensionwiseTestcase")&&""!=s.a.SessionManager.Preferences.DimensionwiseTestcase&&parseInt(s.a.SessionManager.Preferences.DimensionwiseTestcase)>5e4?(this.Dimension.CCID=parseInt(s.a.SessionManager.Preferences.DimensionwiseTestcase),this.Dimension.Visible=!0,this.Dimension.Label=t.ScreenObject.Data.Tables[12].filter((function(e){return e.FEATUREID==s.a.SessionManager.Preferences.DimensionwiseTestcase})).Compute("max","NAME").toString()):this.Dimension.Visible=!1,this.DocumentsList.Items=this.Documents,this.DocumentsList.SelectedValue="1",this.DocumentsList.Label="Document",this.TestCaseDim.Label="Test",this.Sample.Label="Sample",this.Iteration.Label="Observation",this.InitControls()}return _createClass(e,[{key:"InitControls",value:function(){Logger.InfoLog("AddProductTestcasesViewModel:: Inside InitColumns"),this.TestcaseGrid.Columns=[];var e=new C.a;e.Header=s.a.GetResource("DocumentDesigner_Sno"),e.DisplayMember="Sno",e.IsFrozen=!1,e.ReadOnly=!0,e.Width=40,this.TestcaseGrid.Columns.push(e),this.TestCaseGridColumnsTemp.push("Sno"),(e=new C.a).Header=s.a.GetResource("Doc_Document"),e.DisplayMember="Name",e.ValueMember="Value",e.ValueBinding="DocumentID",e.DataType="ComboBox",e.ComboData=this.Documents,e.Width=120,this.TestcaseGrid.Columns.push(e),this.TestCaseGridColumnsTemp.push("DocumentID"),(e=new C.a).Header=s.a.GetResource("Inv_TestCase"),e.DisplayMember="TestCaseID",e.ValueMember="TestCaseID_Key",s.a.SessionManager.Preferences.ContainsKey("TestCaseDimension")&&""!=s.a.SessionManager.Preferences.TestCaseDimension&&parseInt(s.a.SessionManager.Preferences.TestCaseDimension)>0&&(e.CostCenterID=parseInt(s.a.SessionManager.Preferences.TestCaseDimension)),e.TypeID=1,e.DataType="LISTBOX",e.Width=150,this.TestcaseGrid.Columns.push(e),this.TestCaseGridColumnsTemp.push("TestCaseID"),this.TestCaseGridColumnsTemp.push("TestCaseID_Key"),(e=new C.a).Header=s.a.GetResource("Inv_TestType"),e.DisplayMember="Name",e.ValueMember="Value",e.ValueBinding="TestType";var t,i=new Array;i.push(u.d.ComboBoxItems_2("Numeric","0")),i.push(u.d.ComboBoxItems_2("Visual","1")),e.ComboData=i,e.DataType="ComboBox",e.Width=80,this.TestcaseGrid.Columns.push(e),this.TestCaseGridColumnsTemp.push("TestType"),(e=new C.a).Header=s.a.GetResource("Inv_Min"),e.DisplayMember="Min",e.DataType="TextBlock",e.Width=60,this.TestcaseGrid.Columns.push(e),this.TestCaseGridColumnsTemp.push("Min"),(e=new C.a).Header=s.a.GetResource("Inv_Max"),e.DisplayMember="Max",e.DataType="TextBlock",e.Width=60,this.TestcaseGrid.Columns.push(e),this.TestCaseGridColumnsTemp.push("Max"),(e=new C.a).Header=s.a.GetResource("CustomizeCostCenter_ProbableValues"),e.DisplayMember="ProbableValues",e.DataType="TextBlock",e.Width=130,this.TestcaseGrid.Columns.push(e),this.TestCaseGridColumnsTemp.push("ProbableValues"),(e=new C.a).Header=s.a.GetResource("Inv_Variance"),e.DisplayMember="Variance",e.DataType="TextBlock",e.Width=80,this.TestcaseGrid.Columns.push(e),this.TestCaseGridColumnsTemp.push("Variance"),(e=new C.a).Header=s.a.GetResource("Inv_Sample"),e.DisplayMember="Sample",e.DataType="TextBlock",e.Width=80,this.TestcaseGrid.Columns.push(e),this.TestCaseGridColumnsTemp.push("Sample"),(e=new C.a).Header=s.a.GetResource("Inv_SampleType"),e.DisplayMember="Name",e.ValueMember="Value",e.ValueBinding="SampleType",(i=new Array).push(u.d.ComboBoxItems_2("Value","0")),i.push(u.d.ComboBoxItems_2("Number","1")),i.push(u.d.ComboBoxItems_2("Percentage Value","2")),i.push(u.d.ComboBoxItems_2("Percentage Number","3")),e.ComboData=i,e.DataType="ComboBox",e.Width=100,this.TestcaseGrid.Columns.push(e),this.TestCaseGridColumnsTemp.push("SampleType"),(e=new C.a).Header=s.a.GetResource("Inv_Observation"),e.DisplayMember="Iteration",e.DataType="TextBlock",e.Width=100,this.TestcaseGrid.Columns.push(e),this.TestCaseGridColumnsTemp.push("Iteration"),(e=new C.a).Header=s.a.GetResource("Inv_RetestDays"),e.DisplayMember="RetestDays",e.DataType="TextBlock",e.Width=80,this.TestcaseGrid.Columns.push(e),this.TestCaseGridColumnsTemp.push("RetestDays"),s.a.SessionManager.Preferences.ContainsKey("DimensionwiseTestcase")&&""!=s.a.SessionManager.Preferences.DimensionwiseTestcase&&parseInt(s.a.SessionManager.Preferences.DimensionwiseTestcase)>0&&((e=new C.a).Header=this.ProductViewModel.ScreenObject.Data.Tables[12].filter((function(e){return e.FEATUREID==s.a.SessionManager.Preferences.DimensionwiseTestcase})).Compute("max","NAME").toString(),e.DisplayMember="Dimension",e.ValueMember="Dimension_Key",e.CostCenterID=parseInt(s.a.SessionManager.Preferences.DimensionwiseTestcase),e.Width=150,e.DataType="LISTBOX",e.TypeID=1,this.TestcaseGrid.Columns.push(e)),this.TestCaseGridColumnsTemp.push("Dimension"),this.TestCaseGridColumnsTemp.push("Dimension_Key"),this.TestcaseGrid.Table=[];for(var n=0;n<5;n++)(t=this.TestcaseGrid.NewRow()).Sno=n+1,t.DocumentID=null,t.TestCaseID=null,t.TestCaseID_Key=null,t.TestType=null,t.Min=null,t.Max=null,t.ProbableValues=null,t.Variance=null,t.Sample=null,t.SampleType=null,t.Iteration=null,t.RetestDays=null,t.Dimension=null,t.Dimension_Key=null,this.TestcaseGrid.addRow(t);Logger.InfoLog("AddProductTestcasesViewModel:: Exiting InitColumns")}},{key:"LoadData",value:function(e){if(null!=e&&null!=e&&e.length>0){this.TestcaseGrid.Clear();for(var t=0;t<e.length;t++){var i=this.TestcaseGrid.NewRow();i.Sno=(t+1).toString(),i.DocumentID=e[t].DocumentID,i.TestCaseID_Key=e[t].TestCaseID,i.TestType=e[t].TestType,i.Min="0"==e[t].Min.toString()?"":e[t].Min,i.Max="0"==e[t].Max.toString()?"":e[t].Max,i.ProbableValues=e[t].ProbableValues,i.Variance="0"==e[t].Variance.toString()?"":e[t].Variance,i.Sample="0"==e[t].Sample.toString()?"":e[t].Sample,i.SampleType=e[t].SampleType,i.Iteration="0"==e[t].Iteration.toString()?"":e[t].Iteration,i.RetestDays="0"==e[t].RetestDays.toString()?"":e[t].RetestDays,i.Dimension_Key=e[t].CCNodeID,this.TestcaseGrid.addRow(i)}}if(this.TestcaseGrid.Table.length>0)for(var s=this.TestcaseGrid.Table.length;s<3;s++){var n=this.TestcaseGrid.NewRow();n.Sno=s+1,n.DocumentID=null,n.TestCaseID=null,n.TestCaseID_Key=null,n.TestType=null,n.Min=null,n.Max=null,n.ProbableValues=null,n.Variance=null,n.Sample=null,n.SampleType=null,n.Iteration=null,n.RetestDays=null,n.Dimension=null,n.Dimension_Key=null,this.TestcaseGrid.addRow(n)}this.TestcaseGrid.RefreshGrid=!this.TestcaseGrid.RefreshGrid}},{key:"OnAddNewTestcase",value:function(e){if("Add"==e.toString()){if(0==this.TestCaseDim.SelectedValue)return this.ProductViewModel.DisplayMessage="Select Testcase",void(this.ProductViewModel.MessageVisibility=!0);if(null==this.DocumentsList.SelectedValue||"1"==this.DocumentsList.SelectedValue)return this.ProductViewModel.DisplayMessage="Select Document",void(this.ProductViewModel.MessageVisibility=!0);if(this.TestcaseGrid.Table.length>0)for(var t=this.TestcaseGrid.Table.length-1;t>=0;t--)(n.e.StringIsNullOrEmpty(this.TestcaseGrid.Table[t].DocumentID)||n.e.StringIsNullOrEmpty(this.TestcaseGrid.Table[t].TestCaseID_Key))&&this.TestcaseGrid.Table.RemoveAt(t);var i=this.GetTestCaseDetails(this.TestCaseDim.SelectedValue);if(null!=i&&i.Tables.length>0&&i.Tables[0].length>0){for(var s=1,r=0;r<i.Tables[0].length;r++){s=this.TestcaseGrid.Table.length;var a=this.TestcaseGrid.NewRow();a.Sno=s+1,a.DocumentID=this.DocumentsList.SelectedValue,a.TestCaseID_Key=i.Tables[0][r].NodeID,a.TestCaseID=i.Tables[0][r].Name,a.TestType=n.e.StringIsNullOrEmpty(i.Tables[0][r].TestType)||"Visual"!=i.Tables[0][r].TestType.toString()?"0":"1",a.Min=i.Tables[0][r].Min,a.Max=i.Tables[0][r].Max,a.ProbableValues=i.Tables[0][r].ProbableValues,a.Variance=i.Tables[0][r].Variance,a.SampleType="0",0==r?(a.Sample=this.Sample.Text,a.Iteration=this.Iteration.Text):(a.Sample="",a.Iteration=""),a.RetestDays="",a.Dimension_Key=this.Dimension.SelectedValue,a.Dimension=this.Dimension.Text,this.TestcaseGrid.addRow(a)}for(var o=0;o<3;o++){s=this.TestcaseGrid.Table.length;var l=this.TestcaseGrid.NewRow();l.Sno=s+1,this.TestcaseGrid.addRow(l)}}this.TestCaseDim.SelectedValue=0,this.Iteration.Text="",this.Sample.Text="",this.Dimension.SelectedValue=0,this.DocumentsList.SelectedValue="1"}}},{key:"GetXml",value:function(){var e="";e+="<XML>";for(var t=0;t<this.TestcaseGrid.Table.length;t++)n.e.StringIsNullOrEmpty(this.TestcaseGrid.Table[t].DocumentID)||n.e.StringIsNullOrEmpty(this.TestcaseGrid.Table[t].TestCaseID_Key)||(e+="<Row ",e+=' DocumentID="'+this.TestcaseGrid.Table[t].DocumentID.toString()+'"',e+=' TestCaseID="'+this.TestcaseGrid.Table[t].TestCaseID_Key.toString()+'"',e+=' TestType="'+n.e.String(this.TestcaseGrid.Table[t].TestType)+'"',e+=' Min="'+n.e.String(this.TestcaseGrid.Table[t].Min)+'"',e+=' Max="'+n.e.String(this.TestcaseGrid.Table[t].Max)+'"',e+=' ProbableValues="'+n.e.String(this.TestcaseGrid.Table[t].ProbableValues)+'"',e+=' Variance="'+n.e.String(this.TestcaseGrid.Table[t].Variance)+'"',e+=' Sample="'+n.e.String(this.TestcaseGrid.Table[t].Sample)+'"',e+=' SampleType="'+n.e.String(this.TestcaseGrid.Table[t].SampleType)+'"',e+=' Iteration="'+n.e.String(this.TestcaseGrid.Table[t].Iteration)+'"',e+=' RetestDays="'+n.e.String(this.TestcaseGrid.Table[t].RetestDays)+'"',s.a.SessionManager.Preferences.ContainsKey("DimensionwiseTestcase")&&""!=s.a.SessionManager.Preferences.DimensionwiseTestcase&&parseInt(s.a.SessionManager.Preferences.DimensionwiseTestcase)>0?(e+=' CostCenterID="'+s.a.SessionManager.Preferences.DimensionwiseTestcase+'"',e+=' CCNodeID="'+this.TestcaseGrid.Table[t].Dimension_Key.toString()+'"'):(e+=' CostCenterID=""',e+=' CCNodeID="1"'),e+="/>");return(e+="</XML>").toString()}},{key:"GetTestCaseDetails",value:function(e){return s.a.empService.GetQueryData(0,"GetTestCaseDetails",s.a.SessionManager.Preferences.TestCaseDimension,e,"")}},{key:"OnGridCellEditEnding",value:function(e){var t=e.item;if("TestCaseID"==e.column.field&&!n.e.IsEmpty(t.TestCaseID_Key)){var i=this.GetTestCaseDetails(parseInt(t.TestCaseID_Key.toString()));null!=i&&i.Tables.length>0&&i.Tables[0].length>0&&!i.Columns[0].Contains("ErrorMessage")&&(t.TestType=n.e.IsEmpty(i.Tables[0][0].TestType)||"Visual"!=i.Tables[0][0].TestType.toString()?"0":"1",t.Min=i.Tables[0][0].Min,t.Max=i.Tables[0][0].Max,t.ProbableValues=i.Tables[0][0].ProbableValues,t.Variance=i.Tables[0][0].Variance)}}},{key:"angularGrid",get:function(){return this.TestcaseGrid.angularGrid}}]),e}(),q=i("mrSG"),J=i("Agar"),$=function(e){_inherits(i,e);var t=_createSuper(i);function i(e,n){var r;return _classCallCheck(this,i),(r=t.call(this)).Visible=!0,r.contextVisible=!0,r.ScreenName="",r.RetValue=0,r._ScreenID="",r.ButtonSave=new d.a,r.ShowBarcodeDimension=!1,r.lstDeletedRecords=new Array,r.lstDeletedint=new Array,r.res="",r.PID=0,r.BarcodeVisibility=!1,r.Units=new u.e(0),r.BaseTextObj=new l.d(0),r.RateTextObj=new l.d(0),r.PACTControlData=[],r._BaseVisibility=!1,r.ButtonVisible=!0,r._DetailsVisibility=!1,r.SelectedNode=0,r.GridUnitsObj=new g.a,r._ScreenData=[],r.RoleName="",r.UserID="",r.Description="",r.MessageVisibility=!1,r.DisplayMessage="",r.SelectedText="",r.form=new P.j({}),r.ClassName="ProductWiseUOMViewModel",Logger.InfoLog("AddUOMViewModel::Entering AddUOMViewModel"),r.PID=e,r.Parent=n,s.a.GetResource("UOM_ScreenName"),s.a.SessionManager.HideUnathorizedAccess?r.ButtonSave.Visible=s.a.SessionManager.IsActionAssigned(11,"Create"):r.ButtonSave.Enable=s.a.SessionManager.IsActionAssigned(11,"Create"),r.MessageVisibility=!1,r.Units1.SelectionChangedCommand.Subscribe(_assertThisInitialized(r),"onSelectionChanged"),r.RateTextObj.LostFocusCommand.Subscribe(_assertThisInitialized(r),"OnSerialNo_LostFoucs"),r.RateTextObj.Label=s.a.GetResource("UOM_ConversionRate"),r.BaseTextObj.Label="Base Name",r.BaseTextObj.LostFocusCommand.Subscribe(_assertThisInitialized(r),"OnSerialNo_LostFoucs"),r.Units1.Label="Choose Base",new J.a(0),r._ScreenID="1002",r.ScreenName="Create UOM",r.DetailsVisibility=!0,r.BindBase(),r.BindGridUnits(),Logger.InfoLog("AddUOMViewModel::Exiting AddUOMViewModel"),r}return _createClass(i,[{key:"OnCmnItem_Click",value:function(e){if(Logger.InfoLog("AddUOMViewModel::Entering OnCmnItem_Click"),this.SelectedNode<0)this.DisplayMessage="Please Select Particular cell to remove",this.MessageVisibility=!0;else if(this.SelectedNode<this.dtTable.length)switch(e){case"DELETE":this.res="",null!=this.SelectedRow&&(null!=this.Parent&&"-399"==this.Parent.UOM.SelectedValue?this.dtTable[0]==this.SelectedRow?alert("Base Unit can not be deleted"):n.e.StringIsNullOrEmpty(this.SelectedRow.PrimayColumn)?this.GridUnitsObj.removeRow(this.SelectedRow):confirm("Are you Sure You Want To Delete this Unit ? ")&&(this.lstDeletedint.push(parseInt(this.SelectedRow.PrimayColumn)),this.GridUnitsObj.removeRow(this.SelectedRow)):("1"==this.SelectedRow.UnitID.toString()?confirm("This Unit will delete Base name: Are you sure ? ")&&this.onDeleteBase(this.SelectedRow.BaseID.toString()):confirm("Are you Sure You Want To Delete this Unit ? ")&&(n.e.StringIsNullOrEmpty(this.SelectedRow.PrimayColumn)||this.lstDeletedint.push(parseInt(this.SelectedRow.PrimayColumn))),this.dtTable.length>0&&"Yes"==this.res&&(n.e.StringIsNullOrEmpty(this.SelectedRow.PrimayColumn)?this.GridUnitsObj.removeRowAt(this.SelectedNode):this.GridUnitsObj.removeRow(this.SelectedRow))))}Logger.InfoLog("AddUOMViewModel::Exiting OnCmnItem_Click")}},{key:"OnMessageCallBack",value:function(){this.res="Yes"}},{key:"onCanCmnItem_Click",value:function(e){return!0}},{key:"OnSerialNo_LostFoucs",value:function(e){var t,i;null!=this.Parent&&"-399"==this.Parent.UOM.SelectedValue&&((t=0==this.GridUnitsObj.Table.length?this.GridUnitsObj.NewRow():this.GridUnitsObj.Table[0]).PrimayColumn=null,t["Unit Name"]=this.BaseText,(i=n.e.DoubleTryParse(this.RateText))<=0&&(i=1),this.RateText=i.toString(),t["Conversion Rate"]=i,t.UnitID=null,t.BaseID=null,t.Barcode="",t.Barcode_Key=null,t.Barcodes="",0==this.GridUnitsObj.Table.length?this.GridUnitsObj.addRow(t):this.GridUnitsObj.updateRow(t))}},{key:"GetGridHeader",value:function(){var e;this.GridUnitsObj.TableColumns.push("PrimayColumn"),this.GridUnitsObj.TableColumns.push("Unit Name"),this.GridUnitsObj.TableColumns.push("Conversion Rate"),this.GridUnitsObj.TableColumns.push("UnitID"),this.GridUnitsObj.TableColumns.push("BaseID"),this.GridUnitsObj.TableColumns.push("Barcode"),this.GridUnitsObj.TableColumns.push("Barcode_Key"),this.GridUnitsObj.TableColumns.push("Barcodes");for(var t=this.dtTable.length;t<10;t++)e=this.GridUnitsObj.NewRow(),this.GridUnitsObj.addRow(e);var i=0;this.ShowBarcodeDimension=!1;var r=this.Parent.ScreenObject.Data.Tables[10].filter((function(e){return"BarcodeDimension"==e.Name}));r.length>0&&!n.e.StringIsNullOrEmpty(r[0].Value)&&parseInt(r[0].Value.toString())>0&&(i=parseInt(r[0].Value.toString()),this.ShowBarcodeDimension=!0),this.Columns=[];var a=new C.a;a.Header=s.a.GetResource("UOM_UnitName"),a.DisplayMember="Unit Name",a.Width=70,this.Columns.push(a),(a=new C.a).Header="Conv. Rate",a.DisplayMember="Conversion Rate",a.DataType="FLOAT",a.Width=80,this.Columns.push(a),(a=new C.a).Header=s.a.GetResource("Barcode"),a.Width=108,this.ShowBarcodeDimension?(a.DataType="LISTBOX",a.ValueMember="Barcode_Key",a.DisplayMember="Barcode",a.CostCenterID=i,a.FilterCondition="a.NodeID NOT IN (select Barcode_Key from INV_ProductBarcode with(nolock) Group By Barcode_Key)"):a.DisplayMember="Barcode",this.Columns.push(a)}},{key:"BindGridUnits",value:function(){return this.GridUnitsObj.Clear(),this.GetGridHeader(),this.dtTable}},{key:"onDeleteBase",value:function(e){return Object(q.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i,n,r,a,o=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==e||"Barcode"!=e.toString()){t.next=7;break}if(null!=this.SelectedRow){t.next=3;break}return t.abrupt("return",(this.DisplayMessage="Select row to add barcodes",void(this.MessageVisibility=!0)));case 3:(i=new j(this)).AddVendorViewModel_1(this),s.a.page.ShowDialog(i,F,{ShowCenter:!0,Title:i.Title}),t.next=8;break;case 7:null!=this.Units1.SelectedValue&&"0"!=this.Units1.SelectedValue.toString()&&(n=parseInt(this.Units1.SelectedValue),Logger.InfoLog("AddUOMViewModel::Entering onDeleteBase"),r=s.a.inventory.RemoveUOM(this.Units1.SelectedValue,this.PID).RetValue,n<0&&(this.Delete(n),this.SelectedText="",this.GridUnits.Clear(),this.MessageVisibility=!1,this.DisplayMessage="",this.BaseText="",this.RateText=""),r>0?(this.Units1.SelectedValue="0",this.SelectedText="",this.GridUnits.Clear(),this.BaseText="",this.RateText="",this.DisplayMessage=s.a.GetResource("UOM_Del"),this.MessageVisibility=!0,this.BaseVisibility=!1,this.Delete(n)):(this.DisplayMessage=s.a.GetResource("UOM_CntDel"),this.MessageVisibility=!0),n<0&&(this.DisplayMessage="",this.MessageVisibility=!1),Logger.InfoLog("AddUOMViewModel::Exiting onDeleteBase"),1==this.Parent.UOM.Items.length&&"New"==this.Parent.UOM.Items[0].Name&&(this.Parent.UOM.Items.Clear(),this.Parent.ScreenObject.Data.Tables[13].forEach((function(e){o.Parent.UOM.Items.push(u.d.ComboBoxItems_3(e.UnitName.toString(),e.UOMID.toString(),e.BaseID.toString()))})),this.Parent.UOM.Items.push(u.d.ComboBoxItems_2("New","-100")),this.Parent.UOM.Items.push(u.d.ComboBoxItems_2("Product-Wise","-399")),(a=this.Parent.ScreenObject.Data.Tables[10].filter((function(e){return"DefaultUOM"==e.Name}))).length>0&&""!=a[0].Value.toString()&&(this.Parent.UOM.SelectedValue=a[0].Value.toString())));case 8:case"end":return t.stop()}}),t,this)})))}},{key:"Delete",value:function(e){if(this.Parent.LstOfBase.length>0)for(var t=this.Parent.LstUOM.length,i=t-1,s=0;s<this.Parent.LstOfBase.length;s++)if(e.toString()==this.Parent.LstOfBase[s].BaseID){for(var n=t;n>0;n--,i--)e.toString()==this.Parent.LstUOM[i].BaseID&&this.Parent.LstUOM.RemoveAt(i);for(var r=0;r<this.Units.Items.length;r++)if(this.Units.Items[r].Value==this.Units1.SelectedValue.toString()){this.Units.Items.RemoveAt(r);break}this.Parent.LstOfBase.RemoveAt(s);break}var a;this.Units1.Items.Clear(),this.GridUnitsObj.Clear(),this.BaseVisibility=!0,"-399"==this.Parent.UOM.SelectedValue&&(this.ButtonVisible=!1);for(var o=this.GridUnits.length;o<10;o++)a=this.GridUnitsObj.NewRow(),this.GridUnitsObj.addRow(a);this.BindBase()}},{key:"onCanDeleteBase",value:function(e){return!0}},{key:"onSave",value:function(){var e=this;Logger.InfoLog("AddUOMViewModel::Entering onSaveUOM");try{this.MessageVisibility=!1;var t={},i="";if(n.e.IsEmpty(this.BaseText))return this.DisplayMessage=s.a.GetResource("CannotSaveBlankUOM"),void(this.MessageVisibility=!0);if(i+="<XML>",null!=this.GridUnits&&this.GridUnits.length>0){for(var r=0;r<this.GridUnits.length;r++)n.e.StringIsNullOrEmpty(this.GridUnits[r]["Unit Name"])?n.e.StringIsNullOrEmpty(this.GridUnits[r].PrimayColumn)?i+="<Row RowNo='"+(r+1)+"' PrimaryKey='0' UName=''  ConversionRate='' MapAction='DELETE' />":i+="<Row RowNo='"+(r+1)+"' PrimaryKey='"+this.GridUnits[r].PrimayColumn.toString()+"' UName='"+this.GridUnits[r]["Unit Name"]+"'  ConversionRate='"+this.GridUnits[r]["Conversion Rate"]+"' MapAction='DELETE' />":n.e.StringIsNullOrEmpty(this.GridUnits[r].PrimayColumn)?i+="<Row RowNo='"+(r+1)+"' PrimaryKey='0' UName='"+this.GridUnits[r]["Unit Name"]+"'  ConversionRate='"+this.GridUnits[r]["Conversion Rate"]+"' MapAction='NEW' />":i+="<Row RowNo='"+(r+1)+"' PrimaryKey='"+this.GridUnits[r].PrimayColumn.toString()+"' UName='"+this.GridUnits[r]["Unit Name"]+"'  ConversionRate='"+this.GridUnits[r]["Conversion Rate"]+"' MapAction='UPDATE' />";for(var a=0;a<this.lstDeletedint.length;a++)i+='<Row MapAction="DELETE"',i+=' PrimaryKey="'+this.lstDeletedint[a]+'"/>'}else i+="<Row RowNo='1' PrimaryKey='0' UName=''  ConversionRate='' MapAction='NEW' />";i+="</XML>";t.Address1=this.BaseText,t.Address2=n.e.StringIsNullOrEmpty(this.Units1.SelectedValue)?0:this.Units1.SelectedValue,t.Address3=i.toString(),t.IsGroup=!1,s.a.inventory.AddUOM(t,"AddUOM").subscribe((function(t){e.DisplayMessage=t.Message,e.RetValue=t.RetValue,e.MessageVisibility=!0,e.RetValue>0?(null!=e.dtTable&&e.GridUnitsObj.Clear(),e.BindBase(),e.DisplayMessage=s.a.GetResource("UOM_Saved"),e.MessageVisibility=!0,e.BaseVisibility=!1):(e.DisplayMessage=t.Message,e.MessageVisibility=!0)}),(function(e){alert(JSON.stringify(e)),console.log("AddUOMViewModel::Exiting OnSaveUOM"+JSON.stringify(e))})),Logger.InfoLog("AddUOMViewModel::Exiting OnSaveUOM")}catch(o){Logger.ErrorLog("AddUOMViewModel:: OnSaveUOM"+o.stack)}}},{key:"onSaveUOM",value:function(e){Logger.InfoLog("AddUOMViewModel::Entering onSaveUOM");try{"-100"==this.Parent.UOM.SelectedValue&&this.onSave()}catch(t){Logger.ErrorLog("AddUOMViewModel:: OnSaveUOM"+t.stack)}}},{key:"onCanSaveUOM",value:function(e){this.Parent.UOMVisibility=!1,s.a.page.HideDialog()}},{key:"onSelectionChanged",value:function(e){var t=null;this.DisplayMessage="",this.MessageVisibility=!1,Logger.InfoLog("AddUOMViewModel::Entering SelectionChanged event");try{if(null!=e){if("-100"==e.toString()?(this.GridUnitsObj.Clear(),this.BaseText="",this.RateText="",this.BaseVisibility=!0,this.BarcodeVisibility=!1):(this.BarcodeVisibility=!0,this.BaseVisibility=!0),this.ButtonVisible="-100"==e.toString(),"-100"==this.Parent.UOM.SelectedValue&&"-100"!=e.toString()){this.ButtonVisible=!0;var i=[];if(i.push(this.Units1.SelectedValue),i.push(s.a.SessionManager.UserID),i.push(s.a.SessionManager.LanguageID),null!=this.Units1.SelectedValue&&(t=s.a.inventory.getUOM2(this._ScreenID,i)),this.GridUnitsObj.Clear(),null!=t&&t.Tables.length>0&&t.Tables[0].length>0){this.BaseText=t.Tables[0][0].BaseName.toString(),this.RateText=t.Tables[0][0].Conversion.toString();for(var n=0;n<t.Tables[0].length;n++){var r=this.GridUnitsObj.NewRow();r.PrimayColumn=t.Tables[0][n].UOMID.toString(),r["Unit Name"]=t.Tables[0][n].UnitName.toString(),r["Conversion Rate"]=t.Tables[0][n].Conversion.toString(),r.UnitID=t.Tables[0][n].UNITID.toString(),r.BaseID=t.Tables[0][n].BaseID.toString(),r.Barcode="",r.Barcode_Key=null,r.Barcodes="",this.GridUnitsObj.addRow(r)}}for(var a=this.GridUnitsObj.Table.length;a<10;a++){var o=this.GridUnitsObj.NewRow();this.GridUnitsObj.addRow(o)}}if("-100"!=e.toString()&&"-399"==this.Parent.UOM.SelectedValue){if(this.ButtonVisible=!0,this.Parent.LstUOM.length>0){this.GridUnitsObj.Clear();for(var l=0;l<this.Parent.LstUOM.length;l++)if(this.Parent.LstUOM[l].BaseID==this.Units1.SelectedValue.toString()){var u=this.GridUnitsObj.NewRow();u.PrimayColumn=parseInt(this.Parent.LstUOM[l].MapAction),u["Unit Name"]=this.Parent.LstUOM[l].UnitName,u["Conversion Rate"]=parseFloat(this.Parent.LstUOM[l].UnitConverstion),u.UnitID=parseInt(this.Parent.LstUOM[l].UnitID),u.BaseID=parseInt(this.Units1.SelectedValue),this.GridUnitsObj.addRow(u),0==this.BaseText.length&&(this.BaseText=this.Parent.LstUOM[l].BaseName),0==this.RateText.length&&(this.RateText=this.Parent.LstUOM[l].UnitConverstion)}}for(var c=this.GridUnits.length;c<10;c++){var d=this.GridUnitsObj.NewRow();this.GridUnitsObj.addRow(d)}}else for(var h=this.GridUnits.length;h<10;h++){var b=this.GridUnitsObj.NewRow();this.GridUnitsObj.addRow(b)}}}catch(S){Logger.ErrorLog("AddUOMViewModel:: onSelectionChanged"+S.stack)}Logger.InfoLog("AddUOMViewModel::Exiting onSelectionChanged")}},{key:"onCanSelectionChanged",value:function(e){return!0}},{key:"worker_DoWork",value:function(e,t){Logger.InfoLog("AddUOMViewModel::Entering worker_DoWork"),Logger.InfoLog("AddUOMViewModel::Leaving worker_DoWork")}},{key:"BindBase",value:function(){var e=this;if(null!=this.Parent&&"-399"==this.Parent.UOM.SelectedValue){this.Units1.Items.Clear();for(var t=0;t<this.Parent.LstOfBase.length;t++)this.Units1.Items.push(u.d.ComboBoxItems_2(this.Parent.LstOfBase[t].BaseName,this.Parent.LstOfBase[t].BaseID));this.Units1.Items.push(u.d.ComboBoxItems_2("New","-100")),this.Units1.SelectedValue="-100",this.BaseText="",this.RateText="",this.BaseVisibility=!0}null!=this.Parent&&"-100"==this.Parent.UOM.SelectedValue&&(this.Units1.Items.Clear(),this._ScreenData=this.BuildControls(),this.BaseText="",this.RateText="",null!=this._ScreenData&&this._ScreenData.Tables[0].forEach((function(t){e.Units1.Items.push(u.d.ComboBoxItems_2(t[Object.keys(t)[1]].toString(),t[Object.keys(t)[0]].toString()))})),this.Units1.Items.push(u.d.ComboBoxItems_2("New","-100")))}},{key:"worker_RunWorkerCompleted",value:function(e,t){}},{key:"BuildControls",value:function(){Logger.InfoLog("AddUOMViewModel::Entering BuildControls");try{var e=[];e.push(0),e.push(s.a.SessionManager.UserID),e.push(s.a.SessionManager.LanguageID);var t=s.a.inventory.getUOM(this.PID,!0,this._ScreenID,e);return null!=t&&null!=t&&t.Tables[0].length>0&&t.Tables.length>0?t:null}catch(i){return Logger.ErrorLog("AddUOMViewModel:: BuildControls"+i.stack),null}}},{key:"BindGrid",value:function(){var e,t=[];if(t.push(this.Units1.SelectedValue),t.push(s.a.SessionManager.UserID),t.push(s.a.SessionManager.LanguageID),null!=this.Units1.SelectedValue&&(e=s.a.inventory.getUOM2(this._ScreenID,t)),this.GridUnitsObj.Clear(),null!=e&&e.Tables.length>0&&e.Tables[0].length>0){this.BaseText=e.Tables[0][0].BaseName.toString(),this.RateText=e.Tables[0][0].Conversion.toString();for(var i=0;i<e.Tables[0].length;i++){var n=this.GridUnitsObj.NewRow();n.PrimayColumn=e.Tables[0][i].UOMID.toString(),n["Unit Name"]=e.Tables[0][i].UnitName.toString(),n["Conversion Rate"]=e.Tables[0][i].Conversion.toString(),n.UnitID=e.Tables[0][i].UnitID.toString(),n.BaseID=e.Tables[0][i].BaseID.toString(),this.GridUnitsObj.addRow(n)}}for(var r=this.GridUnitsObj.Table.length;r<10;r++){var a=this.GridUnitsObj.NewRow();a.SNO=r+1,this.GridUnitsObj.addRow(a)}}},{key:"dtTable",get:function(){return this.GridUnitsObj.Table}},{key:"Units1",get:function(){return this.Units},set:function(e){e!=this.Units&&(this.Units=e)}},{key:"BaseText",get:function(){return this.BaseTextObj.Text},set:function(e){e!=this.BaseTextObj.Text&&(this.BaseTextObj.Text=e)}},{key:"RateText",get:function(){return this.RateTextObj.Text},set:function(e){e!=this.RateTextObj.Text&&(this.RateTextObj.Text=e)}},{key:"BaseVisibility",get:function(){return this._BaseVisibility},set:function(e){e!=this._BaseVisibility&&(this._BaseVisibility=e,this._BaseVisibility&&(this.DetailsVisibility=!1))}},{key:"DetailsVisibility",get:function(){return this._DetailsVisibility},set:function(e){e!=this._DetailsVisibility&&(e&&(this._BaseVisibility=!1),this._DetailsVisibility=e)}},{key:"angularGrid",get:function(){return this.GridUnitsObj.angularGrid}},{key:"GridUnits",get:function(){return this.GridUnitsObj.Table}},{key:"Columns",get:function(){return this.GridUnitsObj.Columns},set:function(e){this.GridUnitsObj.Columns=e}},{key:"GridUnitsColumns",get:function(){return this.GridUnitsObj.TableColumns}},{key:"SelectedRow",get:function(){return this.GridUnitsObj.SelectedItem},set:function(e){this.GridUnitsObj.SelectedItem=e}}]),i}(a.b),ee=i("NXvD"),te=i("wJuo"),ie=i("x68t"),se=i("4k0m"),ne=i("++IR");function re(e,t){if(1&e&&(y.Zb(0,"div",2),y.Wc(1,"\n            "),y.Vb(2,3),y.Wc(3,"\n        "),y.Yb()),2&e){var i=y.lc();y.Db(2),y.tc("obj",i.obj.BaseTextObj)("group",i.obj.form)}}function ae(e,t){if(1&e){var i=y.ac();y.Zb(0,"div",10),y.Wc(1,"\n    "),y.Zb(2,"div"),y.Wc(3,"\n        "),y.Zb(4,"button",11),y.hc("click",(function(){return y.Ic(i),y.lc().obj.onSaveUOM("Save")})),y.Wc(5),y.mc(6,"translate"),y.Yb(),y.Wc(7,"\n        "),y.Zb(8,"button",6),y.hc("click",(function(){return y.Ic(i),y.lc().obj.onCanSaveUOM("Cancel")})),y.Ub(9,"i",12),y.Wc(10),y.mc(11,"translate"),y.Yb(),y.Wc(12,"\n    "),y.Yb(),y.Wc(13,"      \n  "),y.Yb()}2&e&&(y.Db(5),y.Xc(y.nc(6,2,"Ok")),y.Db(5),y.Xc(y.nc(11,4,"Cancel")))}var oe,le=((oe=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){console.log("product wise uom"),console.log(this.obj.BaseVisibility)}}]),e}()).\u0275fac=function(e){return new(e||oe)},oe.\u0275cmp=y.Nb({type:oe,selectors:[["app-product-wise-uom"]],decls:35,vars:11,consts:[[1,"master-screen",3,"formGroup"],[1,"PACTHeaderFields","dialogSubBody"],[1,"form-group","col-xl-12","col-md-12","col-sm-12","col-xs-12","PACTControl"],["FieldDirective","",3,"obj","group"],[2,"float","right","font-weight","600","color","#8477f3","text-decoration","underline",3,"click"],["class","form-group col-xl-12  col-md-12 col-sm-12 col-xs-12 PACTControl",4,"ngIf"],[1,"secondary-btn-wicon",3,"click"],["id","divBarcode",1,"form-group","col-xl-12","col-xs-12","PACTControl"],[2,"width","100%",3,"obj"],["class","Pactdailogfooter",4,"ngIf"],[1,"Pactdailogfooter"],[1,"primary-btn-wicon",3,"click"],[1,"fa-light","fa-rectangle-xmark"]],template:function(e,t){1&e&&(y.Wc(0,"\n"),y.Zb(1,"div",0),y.Wc(2,"\n    "),y.Zb(3,"div",1),y.Wc(4,"\n        "),y.Zb(5,"div",2),y.Wc(6,"\n            "),y.Vb(7,3),y.Wc(8,"\n            "),y.Zb(9,"h6",4),y.hc("click",(function(){return t.obj.onDeleteBase(null)})),y.Wc(10,"Del"),y.Yb(),y.Wc(11,"\n        "),y.Yb(),y.Wc(12,"\n        "),y.Uc(13,re,4,2,"div",5),y.Wc(14,"\n        "),y.Zb(15,"div",2),y.Wc(16,"\n            "),y.Vb(17,3),y.Wc(18,"\n        "),y.Yb(),y.Wc(19,"\n        "),y.Zb(20,"div",2),y.Wc(21,"\n            "),y.Zb(22,"button",6),y.hc("click",(function(){return t.obj.onDeleteBase("Barcode")})),y.Wc(23),y.mc(24,"translate"),y.Yb(),y.Wc(25,"\n        "),y.Yb(),y.Wc(26," \n      "),y.Zb(27,"div",7),y.Wc(28,"\n        "),y.Ub(29,"app-PactGridView",8),y.Wc(30,"\n      "),y.Yb(),y.Wc(31," \n  "),y.Yb(),y.Wc(32,"\n  "),y.Uc(33,ae,14,6,"div",9),y.Wc(34,"\n"),y.Yb()),2&e&&(y.Db(1),y.tc("formGroup",t.obj.form),y.Db(6),y.tc("obj",t.obj.Units1)("group",t.obj.form),y.Db(6),y.tc("ngIf",t.obj.BaseVisibility),y.Db(4),y.tc("obj",t.obj.RateTextObj)("group",t.obj.form),y.Db(6),y.Xc(y.nc(24,9,"Multiple Barcodes")),y.Db(6),y.tc("obj",t.obj.GridUnitsObj),y.Db(4),y.tc("ngIf",t.obj.ButtonVisible))},directives:[P.t,P.k,M.a,V.t,U.a],pipes:[O.d],encapsulation:2}),oe),ue=i("LSMh"),ce=i("hIrt"),de=i("ddhY"),he=i("V7Sd"),be=i("pcVU"),Se=i("J5xz"),me=function(e){_inherits(i,e);var t=_createSuper(i);function i(e,n,r,a){var g;return _classCallCheck(this,i),(g=t.call(this)).FileID=0,g.IsPhotoDelete=!1,g.IsImageSaved=!1,g.ParentFeatureID=0,g.PNodeID=0,g.ScreenObject=new o.a,g.oProduct=new be.a,g.DropFile=new X.b,g.FileExtension="",g.FileDescription="",g.Counter=1,g.ImgRowSpan="",g.ImageWidth="",g.ImageHeight="",g.ImgColumn="",g.ImgColumnSpan="",g.ButtonSave=new d.a,g.ButtonQuery=new d.a,g.ButtonCopy=new d.a,g.ParentId=0,g.NextPrevProductID=0,g.LinkColumnCostcenterID=-1,g.IsPhotoChanged=!1,g.InheritImage=!1,g.InheritGrpImage=!1,g.InheritDimImageID=-1,g.PrevTab="",g.dtProductWise=null,g.TempID=0,g.DimFields=null,g.isCopy=!1,g.ButtonEnable=!1,g.NextPreviousVisibility=!1,g.PhotoTextVisibility=!1,g.UploadVisibility=!1,g.DeleteVisibility=!1,g.Enable="",g.ActualFileName="",g.ThumbnailPhoto="",g.ProductPhoto=null,g.ContactExpanded=!1,g.VendorsExpanded=!1,g.IsBaseUpdated=!1,g.SubstitutesExpanded=!1,g.CCRatesExpanded=!1,g.PartyRateExpanded=!1,g.TaxExpanded=!1,g.DiscountExpanded=!1,g.SchemesExpanded=!1,g.AttachmentExpanded=!1,g.NoteExpanded=!1,g.DetailsVisibility=!1,g._NoteVisibility=!1,g._AttachmentVisibility=!1,g.UOMVisibility=!1,g.LstUOM=new Array,g.LstOfBase=new Array,g.AttachmentVisibility=!1,g.SubstituteVisibility=!1,g.CCMapVisibility=!1,g.ViewCCMapping=null,g.VendorVisibility=!1,g.RetValue=0,g._ProductID=0,g.DialogResult=!1,g.ProductName=new l.d(262),g.ProductCode=new l.a(261),g.NameSameasCode=!1,g.AutoGenerateName=!1,g.AliasName=new l.d(263),g.ProductLength=new l.d(601),g.ProductWidth=new l.d(602),g.ProductHeight=new l.d(603),g.ProductVolume=new l.d(604),g.ProductWeight=new l.d(605),g.ProductWastage=new l.d(584),g.ProductPacking=new u.e(600),g.ProductBillOfEntry=new u.e(587),g.ReorderPolicy=new u.e(588),g.MaxInventoryLevel=new l.d(589),g.ReorderMinOrderQty=new l.d(590),g.ReorderMaxOrderQty=new l.d(591),g.ReorderOrderMultiple=new l.d(592),g.PlanningMethod=new u.e(593),g.ProcurementMethod=new u.e(594),g.LeadTime=new l.d(597),g.SafetyStock=new l.d(598),g.ProductBOM=new c.b(599),g.PurchaseBinRule=new u.e(585),g.SalesBinRule=new u.e(586),g.ProductTypes=new u.e(264),g.ProductGroups=new c.b(281),g.ProductStatuses=new u.e(266),g.ValuationMethods=new u.e(265),g.QtyAdjustment=new u.e(274),g.BinWise=new u.e(275),g.AssetGroupVisible=!1,g.AssetGroup=new c.b(146),g.UOM=new u.h(268),g.PurchaseUOM=new u.e(260),g.ManufacturerBarcode=new u.e(50392),g.BarcodeLayoutID=new u.e(27302),g.SalesAccount=new c.a(270),g.PurchaseAccount=new c.a(271),g.COGSAccount=new c.a(272),g.ClosingStockAccount=new c.a(273),g.PurchaseRate=new l.d(22820),g.PurchaseRateA=new l.d(22786),g.PurchaseRateB=new l.d(22787),g.PurchaseRateC=new l.d(22788),g.PurchaseRateD=new l.d(22789),g.PurchaseRateE=new l.d(22790),g.PurchaseRateF=new l.d(22791),g.PurchaseRateG=new l.d(22792),g.SellingRate=new l.d(22821),g.SellingRateA=new l.d(22793),g.SellingRateB=new l.d(22794),g.SellingRateC=new l.d(22795),g.SellingRateD=new l.d(22796),g.SellingRateE=new l.d(22797),g.SellingRateF=new l.d(22798),g.SellingRateG=new l.d(22799),g.ReorderLevel=new l.d(276),g.ReorderQty=new l.f(277),g.ReorderTrigger=new l.f(11496),g.LotWise=new u.e(267),g.Barcode=new l.d(280),g.Currency=new c.b(269),g.Description=new l.d(282),g.Packing=new l.d(279),g.ShelfLife=new l.d(278),g.PreExpiryDays=new l.d(53585),g.MaxTolerancePer=new l.d(53586),g.MaxToleranceVal=new l.d(53587),g.MinTolerancePer=new l.d(53726),g.MinToleranceVal=new l.d(53727),g.CreditDays=new l.d(53588),g.Category=new c.b(284),g.Department=new c.b(285),g.KitSize=new l.d(583),g.SerialNumber=new l.d(582),g.ProductWeightable=new u.e(581),g.AttributesTab=!1,g.SerialTab=!1,g.KitTab=!1,g.PriceChart=null,g.TaxChart=null,g.Linkedcc=new c.b(0),g.ds=null,g.ImgCol=0,g.ImgHeight=0,g.ImgRow=0,g.IsAttachmentMandatory=!1,g.ImageView=null,g.ClassName="AddProductScreenViewModel",g.ScreenObject.CustomTab.OnTabChange.Subscribe(_assertThisInitialized(g),"onTabSelectionChanged"),0==e?s.a.SessionManager.HideUnathorizedAccess?g.ButtonSave.Visible=s.a.SessionManager.IsActionAssigned(3,"Create"):g.ButtonSave.Enable=s.a.SessionManager.IsActionAssigned(3,"Create"):(g.ScreenObject.IsEdit=!0,s.a.SessionManager.HideUnathorizedAccess?g.ButtonSave.Visible=s.a.SessionManager.IsActionAssigned(3,"Update"):g.ButtonSave.Enable=s.a.SessionManager.IsActionAssigned(3,"Update")),s.a.SessionManager.HideUnathorizedAccess?g.ButtonCopy.Visible=s.a.SessionManager.IsActionAssigned(3,"Copy"):g.ButtonCopy.Enable=s.a.SessionManager.IsActionAssigned(3,"Copy"),s.a.SessionManager.HideUnathorizedAccess?g.ButtonQuery.Visible=s.a.SessionManager.IsActionAssigned(3,"Query"):g.ButtonQuery.Enable=s.a.SessionManager.IsActionAssigned(3,"Query"),Logger.InfoLog("AddProductViewModel::Entering AddProductViewModel With ProductID="+e+",ScreenName="+n+",PID="+r),g.DetailsVisibility=!0,g.ScreenName=n,g.CostCenterID=3,g.oProduct.ProductID=e,g.oProduct.IsGroup=a,g.RefreshTitle(),g.ParentId=r,g.ViewContacts=new h.a(_assertThisInitialized(g)),g.ViewNotes=new S.a(_assertThisInitialized(g),s.a.SessionManager,s.a.admin),g.ViewAttachments=new m.ViewAttachmentViewModel(_assertThisInitialized(g),s.a.SessionManager,s.a.admin),g.ProductAttributes=new Y(_assertThisInitialized(g)),g.ProductSerialization=new A(_assertThisInitialized(g)),g.ViewBins=new G(_assertThisInitialized(g)),g.ProductTypes.SelectionChangedCommand.Subscribe(_assertThisInitialized(g),"OnProductTypeSelectionChanged"),g.ViewVendors=new K(_assertThisInitialized(g)),g.ViewCCMapping=new b.a(_assertThisInitialized(g)),g.ViewCCMapping.ViewCCMappingViewModel_1(_assertThisInitialized(g),3,g.ProductID),g.StatusAssignGrid=new ee.a,g.ProductStatuses.LblClick=new X.b,g.ProductStatuses.LblClick.Subscribe(_assertThisInitialized(g),"OnSaveProduct","ShowStatusAssignGrid"),g.MessageVisibility=!1,g.UserID="1",g.ProductCode.TextChangedCommand.Subscribe(_assertThisInitialized(g),"OnTextChanged_string"),g.ProductName.LostFocusCommand.Subscribe(_assertThisInitialized(g),"OnNameLostFocus"),g.UOM.SelectionChangedCommand.Subscribe(_assertThisInitialized(g),"onUOMSelectedChanged"),g.AttributesTab=!1,g.SerialTab=!1,g.KitTab=!1,g.DropFile.Subscribe(_assertThisInitialized(g),"OnDropPhoto"),g.IsPhotoChanged=!1,g.PhotoTextVisibility=!0,g.ProductPhoto="",g.ActualFileName="",g.ThumbnailPhoto="",g.DetailsVisibility=!0,g.worker_DoWork(r),g.ProductCode.Enable?g.ProductCode.SetFocus=!0:g.ProductName.Enable&&(g.ProductName.SetFocus=!0),g.DisplayName=g.Title,g.ProductGroups.SelectionChangedCommand.Subscribe(_assertThisInitialized(g),"OnGroupSelectionChanged"),Logger.InfoLog("AddProductViewModel::Exiting AddProductViewModel"),g}return _createClass(i,[{key:"onUOMSelectedChanged",value:function(e){if(this.TempID!=parseInt(this.UOM.SelectedValue)){if("0"==this.UOM.SelectedValue||"-399"!=this.UOM.SelectedValue&&"-100"!=this.UOM.SelectedValue)this.UOMVisibility=!1,this.PurchaseUOM.Visible&&this.FillPurchaseUom();else{if(this.onShowUOMControlBar(e),this.AddEditUOM.GridUnitsObj.Clear(),0!=this.ProductID||this.isCopy)if(this.AddEditUOM.BindBase(),null!=this.dtProductWise&&"-399"==this.UOM.SelectedValue)this.LoadUnitsProductWise(this.dtProductWise);else for(var t=this.AddEditUOM.GridUnits.length;t<10;t++){var i=this.AddEditUOM.GridUnitsObj.NewRow();this.AddEditUOM.GridUnitsObj.addRow(i)}else{for(var n=this.AddEditUOM.GridUnits.length;n<10;n++){var r=this.AddEditUOM.GridUnitsObj.NewRow();this.AddEditUOM.GridUnitsObj.addRow(r)}this.AddEditUOM.BindBase()}this.AddEditUOM.ButtonVisible="-399"!=this.UOM.SelectedValue}this.TempID=parseInt(this.UOM.SelectedValue),this.UOMVisibility&&s.a.page.ShowDialog(this.AddEditUOM,le,{Title:s.a.GetResource("UOM_Productwise")})}}},{key:"FillPurchaseUom",value:function(){var e=this,t=this.UOM.GetselectedItem();null!=t&&(this.PurchaseUOM.Items.Clear(),s.a.empService.GetQueryData(0,"GetUOMS",t.Parent,"","").Tables[0].forEach((function(t){e.PurchaseUOM.Items.push(u.d.ComboBoxItems_2(t.UnitName.toString(),t.UOMID.toString()))})))}},{key:"onShowUOMControlBar",value:function(e){this.NoteVisibility=!1,this.ContactVisibility=!1,this.CCMapVisibility=!1,this.VendorVisibility=!1,this.SubstituteVisibility=!1,this.AttachmentVisibility=!1,this.UOMVisibility=!0}},{key:"onTabSelectionChanged",value:function(e){if(null!=this.ScreenObject.CustomTab.SelectedTab){if(this.PrevTab==this.ScreenObject.CustomTab.SelectedTab.Name)return;this.PrevTab=this.ScreenObject.CustomTab.SelectedTab.Name,"Notes"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.AttachmentVisibility=!1,this.ContactVisibility=!1,this.CCMapVisibility=!1,this.VendorVisibility=!1,this.SubstituteVisibility=!1,this.UOMVisibility=!1):"Attachments"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.NoteVisibility=!1,this.ContactVisibility=!1,this.CCMapVisibility=!1,this.VendorVisibility=!1,this.SubstituteVisibility=!1,this.UOMVisibility=!1,this.ViewAttachments=new m.ViewAttachmentViewModel(this,s.a.SessionManager,s.a.admin)):"Contacts"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.CCMapVisibility=!1,this.VendorVisibility=!1,this.SubstituteVisibility=!1,this.UOMVisibility=!1,this.ViewContacts.OnShowNewContact(null)):"Assign"==this.ScreenObject.CustomTab.SelectedTab.Name||"Production Process"==this.ScreenObject.CustomTab.SelectedTab.Name?s.a.SessionManager.IsActionAssigned(3,"Map")?(this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.ContactVisibility=!1,this.VendorVisibility=!1,this.SubstituteVisibility=!1,this.UOMVisibility=!1,this.ViewCCMapping.OnShowCC(null)):(this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.ContactVisibility=!1,this.CCMapVisibility=!1,this.SubstituteVisibility=!1,this.VendorVisibility=!1,this.UOMVisibility=!1):"General"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.ContactVisibility=!1,this.CCMapVisibility=!1,this.SubstituteVisibility=!1,this.VendorVisibility=!1,this.UOMVisibility="-399"==this.UOM.SelectedValue||"-100"==this.UOM.SelectedValue):"Substitutes"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.ContactVisibility=!1,this.VendorVisibility=!1,this.CCMapVisibility=!1,this.ViewSubstitutes.OnShowNewSubstitute("Manage")):"Vendors"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.ContactVisibility=!1,this.SubstituteVisibility=!1,this.CCMapVisibility=!1,this.ViewVendors.OnShowNewVendor(null)):"Price Chart"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.ContactVisibility=!1,this.CCMapVisibility=!1,this.SubstituteVisibility=!1,this.VendorVisibility=!1,this.UOMVisibility=!1,this.LoadPriceChart()):"Tax Chart"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.ContactVisibility=!1,this.CCMapVisibility=!1,this.SubstituteVisibility=!1,this.VendorVisibility=!1,this.UOMVisibility=!1,this.LoadTaxChart()):(this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.ContactVisibility=!1,this.CCMapVisibility=!1,this.SubstituteVisibility=!1,this.VendorVisibility=!1,this.UOMVisibility=!1)}}},{key:"LoadPriceChart",value:function(){null==this.PriceChart?0!=this.ProductID&&(this.PriceChart=new T.AddPriceChartNewViewModel("PRODUCT_SEARCH",-100,0),this.PriceChart.ColumnSpan="4",this.PriceChart.PriceGrid.MaxHeight=200,this.PriceChart.LoadProfileData(-1,0,new Date,""," AND T.ProductID="+this.ProductID,null),this.PriceChart.FilterVisibility=!1,this.PriceChart.RightPanelVisibility=!1,this.ScreenObject.CustomTab.SelectedTab.Fields.push(this.PriceChart)):0==this.ProductID?this.PriceChart.PriceGrid.Table.Clear():this.PriceChart.LoadProfileData(-1,0,new Date,""," AND T.ProductID="+this.ProductID,null)}},{key:"LoadTaxChart",value:function(){null==this.TaxChart?0!=this.ProductID&&(this.TaxChart=new Se.AddTaxChartNewViewModel,this.TaxChart.AddTaxChartNewViewModel("PRODUCT_SEARCH",-100),this.TaxChart.ColumnSpan="4",this.TaxChart.TaxGrid.MaxHeight=200,this.TaxChart.LoadProfileData(-1,0,new Date,""," AND T.ProductID="+this.ProductID),this.TaxChart.FilterVisibility=!1,this.TaxChart.RightPanelVisibility=!1,this.ScreenObject.CustomTab.SelectedTab.Fields.push(this.TaxChart)):0==this.ProductID?this.TaxChart.TaxGrid.Table.Clear():this.TaxChart.LoadProfileData(-1,0,new Date,""," AND T.ProductID="+this.ProductID)}},{key:"onTextChanged",value:function(e){var t,i,r;t=n.e.DoubleTryParse(this.ProductLength.Text),i=n.e.DoubleTryParse(this.ProductWidth.Text),r=n.e.DoubleTryParse(this.ProductHeight.Text),this.ProductVolume.Text=s.a.SessionManager.Round(t*i*r,this.ProductVolume.DecimalPoints)}},{key:"onLostFocus",value:function(e){if(alert("check-onLostFocus- AddProductScreen"),"PactTextBoxData"==e.GetType().Name){var t;(t=n.e.DoubleTryParse(e.Text))>0&&(e.Text=s.a.SessionManager.Round(t,e.DecimalPoints))}this.ScreenObject.onTextBoxLostFocus(e)}},{key:"AddProductScreenViewModel",value:function(){}},{key:"GetRecords",value:function(e){this.ButtonSave.Enable||(this.ButtonSave.Enable=!0);var t=0,i=!1;"NEXT"==e.toString().toUpperCase()?i=!0:"PREVIOUS"==e.toString().toUpperCase()&&(i=!1);var n=s.a.common.GetNextPreviousRecords(3,this.NextPrevProductID,i,0,this.oProduct.IsGroup?1:0);null!=n&&n.Tables.length>0&&n.Tables[0].length>0&&(0!=(t=parseInt(n.Tables[0][0][Object.keys(n.Tables[0][0])[0]]))&&(this.ImageHeight=(45*parseInt(this.ImgRowSpan)).toString(),this.NextPrevProductID=t,this.oProduct.ProductID=t,this.oProduct.IsGroup=Object(r.j)(n.Tables[0][0][1]),this.RefreshTitle(),this.LoadEditData(),this.PNodeID=t,this.RefreshControls(),"Price Chart"==this.ScreenObject.CustomTab.SelectedTab.Name?this.LoadPriceChart():"Tax Chart"==this.ScreenObject.CustomTab.SelectedTab.Name&&this.LoadTaxChart()))}},{key:"RefreshControls",value:function(){this.NoteVisibility?this.ViewNotes=new S.a(this,s.a.SessionManager,s.a.admin):this.AttachmentVisibility?this.ViewAttachments=new m.ViewAttachmentViewModel(this,s.a.SessionManager,s.a.admin):this.ContactVisibility?this.ViewContacts.OnShowNewContact(null):this.CCMapVisibility&&this.ViewCCMapping.OnShowCC(null)}},{key:"OnShowNote",value:function(){Logger.InfoLog("AddProductViewModel::Entering OnShowNote"),Logger.InfoLog("AddProductViewModel::Exiting OnShowNote")}},{key:"OnlinkccChanged",value:function(e){if(this.PopulateProductName(e),null!=e&&e instanceof c.b&&e.SelectedValue>1){e.CCID==this.InheritDimImageID&&this.OnLoadImage("Dimension",e.SelectedValue);var t=this.oProduct.GetLinkedProducts(e.CCID,e.SelectedValue);null!=t&&null!=t&&t.Tables.length>0&&(this.ProductLink.ModGrid.Visible=!1,this.ProductLink.LoadBundels(t.Tables[0]))}else this.ProductLink.LoadBundels([])}},{key:"worker_DoWork",value:function(e){var t=this;this.DisplayName=s.a.GetResource("Loading"),this.ScreenObject.LoadScreen_1(this,3,this.oProduct.IsGroup),this.AssetGroupVisible=this.AssetGroup.Visible,this.ViewSubstitutes=new k(this),this.AddEditUOM=new $(this.ProductID,this),this.ProductTestcases=new Z(this),this.ProductKit=new p(this,1),this.ProductSpecs=new p(this,2),this.ProductLink=new p(this,0);var i=0,a=this.ScreenObject.Data.Tables[10].filter((function(e){return"LinkedProductDimension"==e.Name}));null!=a&&a.length>0&&""!=a[0].Value.toString()&&parseInt(a[0].Value.toString())>0&&(i=parseInt(a[0].Value.toString()));var o=0;null!=(a=this.ScreenObject.Data.Tables[10].filter((function(e){return"BinsDimension"==e.Name})))&&a.length>0&&""!=a[0].Value.toString()&&parseInt(a[0].Value.toString())>0&&(o=parseInt(a[0].Value.toString())),(a=this.ScreenObject.Data.Tables[10].filter((function(e){return"PrDimWiseFields"==e.Name}))).length>0&&!n.e.IsEmpty(a[0].Value)&&(this.DimFields=a[0].Value.toString().split(";")),null!=(a=this.ScreenObject.Data.Tables[10].filter((function(e){return"DefaultProductValuation"==e.Name})))&&a.length>0&&null!=a[0].Value&&("FIFO"==a[0].Value.toString()?this.ValuationMethods.SelectedValue="1":"LIFO"==a[0].Value.toString()?this.ValuationMethods.SelectedValue="2":"Weighted Average"==a[0].Value.toString()&&(this.ValuationMethods.SelectedValue="3")),null!=(a=this.ScreenObject.Data.Tables[10].filter((function(e){return e.Name==(t.oProduct.IsGroup?"GroupNameSameasCode":"NameSameasCode")})))&&a.length>0&&Object(r.j)(a[0].Value)?(this.NameSameasCode=!0,this.ProductName.Enable=!1):(this.NameSameasCode=!1,this.ProductName.Enable=!0),null!=this.ScreenObject.Data&&this.ScreenObject.Data.Tables.length>15&&this.ScreenObject.Data.Columns[15].Contains("IsParentCodeInherited")&&this.ScreenObject.Data.Tables[15].length>0&&this.ScreenObject.InitAutoCode(this.ScreenObject.Data.Tables[15],this.oProduct.IsGroup),(a=this.ScreenObject.Data.Tables[10].filter((function(e){return"DefaultImage"==e.Name}))).length>0&&(this.InheritImage=Object(r.j)(a[0].Value)),null!=(a=this.ScreenObject.Data.Tables[10].filter((function(e){return"InheritGroupImage"==e.Name})))&&a.length>0&&(this.InheritGrpImage=Object(r.j)(a[0].Value)),this.InheritImage?(this.UploadVisibility=!0,this.DeleteVisibility=!0,this.PhotoTextVisibility=!0):(this.UploadVisibility=!1,this.DeleteVisibility=!1,this.PhotoTextVisibility=!1),null!=(a=this.ScreenObject.Data.Tables[10].filter((function(e){return"InheritDimensionImage"==e.Name})))&&a.length>0&&(this.InheritDimImageID=""!=a[0].Value.toString()?parseInt(a[0].Value):-1),null!=this.ScreenObject.Data&&null!=this.ScreenObject.Data&&this.ScreenObject.Data.Tables.length>14&&(this.ImageView=this.ScreenObject.Data.Tables[14]),this.ScreenObject.CustomTab.Pages.forEach((function(e){if("General"==e.Name)e.Fields.forEach((function(e){switch(e.DBColumnName){case"CurrencyID":t.ScreenObject.StaticFields.Contains(t.Currency)&&t.ScreenObject.StaticFields.Remove(t.Currency),t.Currency=e;break;case"ShelfLife":t.ScreenObject.StaticFields.Contains(t.ShelfLife)&&t.ScreenObject.StaticFields.Remove(t.ShelfLife),t.ShelfLife=e;break;case"PreexpiryDays":t.ScreenObject.StaticFields.Contains(t.PreExpiryDays)&&t.ScreenObject.StaticFields.Remove(t.PreExpiryDays),t.PreExpiryDays=e;break;case"MaxTolerancePer":t.ScreenObject.StaticFields.Contains(t.MaxTolerancePer)&&t.ScreenObject.StaticFields.Remove(t.MaxTolerancePer),t.MaxTolerancePer=e;break;case"MaxToleranceVal":t.ScreenObject.StaticFields.Contains(t.MaxToleranceVal)&&t.ScreenObject.StaticFields.Remove(t.MaxToleranceVal),t.MaxToleranceVal=e;break;case"MinTolerancePer":t.ScreenObject.StaticFields.Contains(t.MinTolerancePer)&&t.ScreenObject.StaticFields.Remove(t.MinTolerancePer),t.MinTolerancePer=e;break;case"MinToleranceVal":t.ScreenObject.StaticFields.Contains(t.MinToleranceVal)&&t.ScreenObject.StaticFields.Remove(t.MinToleranceVal),t.MinToleranceVal=e;break;case"CreditDays":t.ScreenObject.StaticFields.Contains(t.CreditDays)&&t.ScreenObject.StaticFields.Remove(t.CreditDays),t.CreditDays=e;break;case"Packing":t.ScreenObject.StaticFields.Contains(t.Packing)&&t.ScreenObject.StaticFields.Remove(t.Packing),t.Packing=e;break;case"BarcodeID":t.ScreenObject.StaticFields.Contains(t.Barcode)&&t.ScreenObject.StaticFields.Remove(t.Barcode),t.Barcode=e;break;case"CategoryID":t.ScreenObject.StaticFields.Contains(t.Category)&&t.ScreenObject.StaticFields.Remove(t.Category),t.Category=e,t.Category.SelectionChangedCommand.Subscribe(t,"PopulateProductName"),t.ScreenObject.StaticFields.Contains(t.Category)||t.ScreenObject.StaticFields.push(t.Category);break;case"DepartmentID":t.ScreenObject.StaticFields.Contains(t.Department)&&t.ScreenObject.StaticFields.Remove(t.Department),t.Department=e,t.Department.SelectionChangedCommand.Subscribe(t,"PopulateProductName"),t.ScreenObject.StaticFields.Contains(t.Department)||t.ScreenObject.StaticFields.push(t.Department);break;case"ManufacturerBarcode":t.ScreenObject.StaticFields.Contains(t.ManufacturerBarcode)&&t.ScreenObject.StaticFields.Remove(t.ManufacturerBarcode),t.ManufacturerBarcode=e;break;case"BarcodeLayoutID":t.ScreenObject.StaticFields.Contains(t.BarcodeLayoutID)&&t.ScreenObject.StaticFields.Remove(t.BarcodeLayoutID),t.BarcodeLayoutID=e;break;case"SerialNumber":t.ScreenObject.StaticFields.Contains(t.SerialNumber)&&t.ScreenObject.StaticFields.Remove(t.SerialNumber),t.SerialNumber=e;break;case"IsWeightable":t.ScreenObject.StaticFields.Contains(t.ProductWeightable)&&t.ScreenObject.StaticFields.Remove(t.ProductWeightable),t.ProductWeightable=e,t.ProductWeightable.Items.push(u.d.ComboBoxItems_2("No","0")),t.ProductWeightable.Items.push(u.d.ComboBoxItems_2("Yes","1")),t.ProductWeightable.SelectedValue="0"}}));else if("Accounts"==e.Name)e.Fields.forEach((function(e){if(e instanceof c.a)switch(e.DBColumnName){case"SalesAccountID":t.ScreenObject.StaticFields.Contains(t.SalesAccount)&&t.ScreenObject.StaticFields.Remove(t.SalesAccount),t.SalesAccount=e;break;case"PurchaseAccountID":t.ScreenObject.StaticFields.Contains(t.PurchaseAccount)&&t.ScreenObject.StaticFields.Remove(t.PurchaseAccount),t.PurchaseAccount=e,t.PurchaseAccount.HistoryCCID=t.PurchaseAccount.DBColumnID;break;case"COGSAccountID":t.ScreenObject.StaticFields.Contains(t.COGSAccount)&&t.ScreenObject.StaticFields.Remove(t.COGSAccount),t.COGSAccount=e;break;case"ClosingStockAccountID":t.ScreenObject.StaticFields.Contains(t.ClosingStockAccount)&&t.ScreenObject.StaticFields.Remove(t.ClosingStockAccount),t.ClosingStockAccount=e}}));else if("SellingRate"==e.Name)e.Fields.forEach((function(e){switch(e.DBColumnName){case"SellingRateA":t.ScreenObject.StaticFields.Contains(t.SellingRateA)&&t.ScreenObject.StaticFields.Remove(t.SellingRateA),t.SellingRateA=e;break;case"SellingRateB":t.ScreenObject.StaticFields.Contains(t.SellingRateB)&&t.ScreenObject.StaticFields.Remove(t.SellingRateB),t.SellingRateB=e;break;case"SellingRateC":t.ScreenObject.StaticFields.Contains(t.SellingRateC)&&t.ScreenObject.StaticFields.Remove(t.SellingRateC),t.SellingRateC=e;break;case"SellingRateD":t.ScreenObject.StaticFields.Contains(t.SellingRateD)&&t.ScreenObject.StaticFields.Remove(t.SellingRateD),t.SellingRateD=e;break;case"SellingRateE":t.ScreenObject.StaticFields.Contains(t.SellingRateE)&&t.ScreenObject.StaticFields.Remove(t.SellingRateE),t.SellingRateE=e;break;case"SellingRateF":t.ScreenObject.StaticFields.Contains(t.SellingRateF)&&t.ScreenObject.StaticFields.Remove(t.SellingRateF),t.SellingRateF=e;break;case"SellingRateG":t.ScreenObject.StaticFields.Contains(t.SellingRateG)&&t.ScreenObject.StaticFields.Remove(t.SellingRateG),t.SellingRateG=e}}));else if("PurchaseRate"==e.Name)e.Fields.forEach((function(e){switch(e.DBColumnName){case"PurchaseRateA":t.ScreenObject.StaticFields.Contains(t.PurchaseRateA)&&t.ScreenObject.StaticFields.Remove(t.PurchaseRateA),t.PurchaseRateA=e;break;case"PurchaseRateB":t.ScreenObject.StaticFields.Contains(t.PurchaseRateB)&&t.ScreenObject.StaticFields.Remove(t.PurchaseRateB),t.PurchaseRateB=e;break;case"PurchaseRateC":t.ScreenObject.StaticFields.Contains(t.PurchaseRateC)&&t.ScreenObject.StaticFields.Remove(t.PurchaseRateC),t.PurchaseRateC=e;break;case"PurchaseRateD":t.ScreenObject.StaticFields.Contains(t.PurchaseRateD)&&t.ScreenObject.StaticFields.Remove(t.PurchaseRateD),t.PurchaseRateD=e;break;case"PurchaseRateE":t.ScreenObject.StaticFields.Contains(t.PurchaseRateE)&&t.ScreenObject.StaticFields.Remove(t.PurchaseRateE),t.PurchaseRateE=e;break;case"PurchaseRateF":t.ScreenObject.StaticFields.Contains(t.PurchaseRateF)&&t.ScreenObject.StaticFields.Remove(t.PurchaseRateF),t.PurchaseRateF=e;break;case"PurchaseRateG":t.ScreenObject.StaticFields.Contains(t.PurchaseRateG)&&t.ScreenObject.StaticFields.Remove(t.PurchaseRateG),t.PurchaseRateG=e}}));else if("Packing"==e.Name){if(s.a.SessionManager.LicenseSettings.ContainsKey("Packing")&&"FALSE"==s.a.SessionManager.LicenseSettings.Packing.toUpperCase())return void(e.Visible=!1);e.Fields.forEach((function(e){var i;switch(e.DBColumnName){case"Length":t.ScreenObject.StaticFields.Contains(t.ProductLength)&&t.ScreenObject.StaticFields.Remove(t.ProductLength),t.ProductLength=e,i=n.e.IntTryParse(t.ScreenObject.Data.Tables[10].find((function(e){return"LengthDecimals"==e.Name})).Value.toString()),t.ProductLength.DecimalPoints=i.toString(),t.ProductLength.TextChangedCommand.Subscribe(t,"onTextChanged"),t.ProductLength.LostFocusCommand.Subscribe(t,"onLostFocus");break;case"Width":t.ScreenObject.StaticFields.Contains(t.ProductWidth)&&t.ScreenObject.StaticFields.Remove(t.ProductWidth),t.ProductWidth=e,i=n.e.IntTryParse(t.ScreenObject.Data.Tables[10].find((function(e){return"WidthDecimals"==e.Name})).Value.toString()),t.ProductWidth.DecimalPoints=i.toString(),t.ProductWidth.TextChangedCommand.Subscribe(t,"onTextChanged"),t.ProductWidth.LostFocusCommand.Subscribe(t,"onLostFocus");break;case"Height":t.ScreenObject.StaticFields.Contains(t.ProductHeight)&&t.ScreenObject.StaticFields.Remove(t.ProductHeight),t.ProductHeight=e,i=n.e.IntTryParse(t.ScreenObject.Data.Tables[10].find((function(e){return"HeightDecimals"==e.Name})).Value.toString()),t.ProductHeight.DecimalPoints=i.toString(),t.ProductHeight.TextChangedCommand.Subscribe(t,"onTextChanged"),t.ProductHeight.LostFocusCommand.Subscribe(t,"onLostFocus");break;case"Volume":t.ScreenObject.StaticFields.Contains(t.ProductVolume)&&t.ScreenObject.StaticFields.Remove(t.ProductVolume),t.ProductVolume=e,i=n.e.IntTryParse(t.ScreenObject.Data.Tables[10].find((function(e){return"VolumeDecimals"==e.Name})).Value.toString()),t.ProductVolume.DecimalPoints=i.toString(),t.ProductVolume.LostFocusCommand.Subscribe(t,"onLostFocus");break;case"Weight":t.ScreenObject.StaticFields.Contains(t.ProductWeight)&&t.ScreenObject.StaticFields.Remove(t.ProductWeight),t.ProductWeight=e,i=n.e.IntTryParse(t.ScreenObject.Data.Tables[10].find((function(e){return"WeightDecimals"==e.Name})).Value.toString()),t.ProductWeight.DecimalPoints=i.toString(),t.ProductWeight.LostFocusCommand.Subscribe(t,"onLostFocus");break;case"IsPacking":t.ScreenObject.StaticFields.Contains(t.ProductPacking)&&t.ScreenObject.StaticFields.Remove(t.ProductPacking),t.ProductPacking=e,t.ProductPacking.Items.push(u.d.ComboBoxItems_2("No","0")),t.ProductPacking.Items.push(u.d.ComboBoxItems_2("Yes","1")),s.a.SessionManager.Preferences.ContainsKey("PackDimension")&&""!=s.a.SessionManager.Preferences.PackDimension&&parseInt(s.a.SessionManager.Preferences.PackDimension)>0&&(t.ProductPacking.SelectedValue="1");break;case"IsBillOfEntry":t.ScreenObject.StaticFields.Contains(t.ProductBillOfEntry)&&t.ScreenObject.StaticFields.Remove(t.ProductBillOfEntry),t.ProductBillOfEntry=e,t.ProductBillOfEntry.Items.push(u.d.ComboBoxItems_2("No","0")),t.ProductBillOfEntry.Items.push(u.d.ComboBoxItems_2("Yes","1")),t.ProductBillOfEntry.Items.push(u.d.ComboBoxItems_2("FIFO","2"));break;case"Wastage":t.ScreenObject.StaticFields.Contains(t.ProductWastage)&&t.ScreenObject.StaticFields.Remove(t.ProductWastage),t.ProductWastage=e,i=n.e.IntTryParse(t.ScreenObject.Data.Tables[10].find((function(e){return"VolumeDecimals"==e.Name})).Value.toString()),t.ProductWastage.DecimalPoints=i.toString(),t.ProductWastage.LostFocusCommand.Subscribe(t,"onLostFocus")}}))}else if("ReOrder"==e.Name){if(s.a.SessionManager.LicenseSettings.ContainsKey("ReOrderManagement")&&"FALSE"==s.a.SessionManager.LicenseSettings.ReOrderManagement.toUpperCase())return void(e.Visible=!1);e.Fields.forEach((function(e){switch(e.DBColumnName){case"ReorderPolicy":t.ScreenObject.StaticFields.Contains(t.ReorderPolicy)&&t.ScreenObject.StaticFields.Remove(t.ReorderPolicy),t.ReorderPolicy=e,t.ReorderPolicy.Items.push(u.d.ComboBoxItems_2("None","0")),t.ReorderPolicy.Items.push(u.d.ComboBoxItems_2("Order","1")),t.ReorderPolicy.Items.push(u.d.ComboBoxItems_2("Max.Level","2")),t.ReorderPolicy.Items.push(u.d.ComboBoxItems_2("Reorder","3")),t.ReorderPolicy.SelectedValue="0";break;case"ReorderLevel":t.ScreenObject.StaticFields.Contains(t.ReorderLevel)&&t.ScreenObject.StaticFields.Remove(t.ReorderLevel),t.ReorderLevel=e;break;case"ReorderQty":t.ScreenObject.StaticFields.Contains(t.ReorderQty)&&t.ScreenObject.StaticFields.Remove(t.ReorderQty),t.ReorderQty=e,t.ReorderQty.Items.push(u.d.ComboBoxItems_2("Value","0")),t.ReorderQty.Items.push(u.d.ComboBoxItems_2("Percentage","1")),t.ReorderQty.SelectedValue="0";break;case"ReorderTrigger":t.ScreenObject.StaticFields.Contains(t.ReorderTrigger)&&t.ScreenObject.StaticFields.Remove(t.ReorderTrigger),t.ReorderTrigger=e,t.ReorderTrigger.Items.push(u.d.ComboBoxItems_2("Value","0")),t.ReorderTrigger.Items.push(u.d.ComboBoxItems_2("Percentage","1")),t.ReorderTrigger.SelectedValue="0";break;case"MaxInventoryLevel":t.ScreenObject.StaticFields.Contains(t.MaxInventoryLevel)&&t.ScreenObject.StaticFields.Remove(t.MaxInventoryLevel),t.MaxInventoryLevel=e;break;case"ReorderMinOrderQty":t.ScreenObject.StaticFields.Contains(t.ReorderMinOrderQty)&&t.ScreenObject.StaticFields.Remove(t.ReorderMinOrderQty),t.ReorderMinOrderQty=e;break;case"ReorderMaxOrderQty":t.ScreenObject.StaticFields.Contains(t.ReorderMaxOrderQty)&&t.ScreenObject.StaticFields.Remove(t.ReorderMaxOrderQty),t.ReorderMaxOrderQty=e;break;case"ReorderOrderMultiple":t.ScreenObject.StaticFields.Contains(t.ReorderOrderMultiple)&&t.ScreenObject.StaticFields.Remove(t.ReorderOrderMultiple),t.ReorderOrderMultiple=e;break;case"PlanningMethod":t.ScreenObject.StaticFields.Contains(t.PlanningMethod)&&t.ScreenObject.StaticFields.Remove(t.PlanningMethod),t.PlanningMethod=e,t.PlanningMethod.Items.push(u.d.ComboBoxItems_2("None","0")),t.PlanningMethod.Items.push(u.d.ComboBoxItems_2("MRP","1")),t.PlanningMethod.SelectedValue="0";break;case"ProcurementMethod":t.ScreenObject.StaticFields.Contains(t.ProcurementMethod)&&t.ScreenObject.StaticFields.Remove(t.ProcurementMethod),t.ProcurementMethod=e,t.ProcurementMethod.Items.push(u.d.ComboBoxItems_2("Purchased","0")),t.ProcurementMethod.Items.push(u.d.ComboBoxItems_2("Produced","1")),t.ProcurementMethod.SelectedValue="0";break;case"LeadTime":t.ScreenObject.StaticFields.Contains(t.LeadTime)&&t.ScreenObject.StaticFields.Remove(t.LeadTime),t.LeadTime=e;break;case"SafetyStock":t.ScreenObject.StaticFields.Contains(t.SafetyStock)&&t.ScreenObject.StaticFields.Remove(t.SafetyStock),t.SafetyStock=e;break;case"BOM":t.ScreenObject.StaticFields.Contains(t.ProductBOM)&&t.ScreenObject.StaticFields.Remove(t.ProductBOM),t.ProductBOM=e,t.ProductBOM.SearchVisible=!0,(a=t.ScreenObject.Data.Tables[10].filter((function(e){return"ProductWiseBoms"==e.Name}))).length>0&&(t.ProductBOM.SearchVisible=Object(r.j)(a[0].Value)),t.ProductBOM.SearchVisible&&(t.ProductBOM.CustomWhere="1!=1")}}))}else if("Bins"==e.Name){if(0==o||s.a.SessionManager.LicenseSettings.ContainsKey("Bins")&&"FALSE"==s.a.SessionManager.LicenseSettings.Bins.toUpperCase())return null!=t.BinWise&&(t.BinWise.Visible=!1,t.BinWise.SelectedValue="0",t.BinWise.DefaultValue="0"),void(e.Visible=!1);e.Fields.forEach((function(e){switch(e.DBColumnName){case"PurchaseBinRule":if(t.ScreenObject.StaticFields.Contains(t.PurchaseBinRule)&&t.ScreenObject.StaticFields.Remove(t.PurchaseBinRule),t.PurchaseBinRule=e,t.PurchaseBinRule.Items.push(u.d.ComboBoxItems_2("","0")),t.ScreenObject.Data.Tables.length>17&&t.ScreenObject.Data.Tables[17].length>0){var i=t.ScreenObject.Data.Tables[17].filter((function(e){return 0==e.RuleType}));if(null!=i&&i.length>0)for(var s=0;s<i.length;s++)t.PurchaseBinRule.Items.push(u.d.ComboBoxItems_2(i[s].ProfileName.toString(),i[s].ProfileID.toString()))}t.PurchaseBinRule.SelectedValue="";break;case"SalesBinRule":if(t.ScreenObject.StaticFields.Contains(t.SalesBinRule)&&t.ScreenObject.StaticFields.Remove(t.SalesBinRule),t.SalesBinRule=e,t.SalesBinRule.Items.push(u.d.ComboBoxItems_2("","0")),t.ScreenObject.Data.Tables.length>17&&t.ScreenObject.Data.Tables[17].length>0){var n=t.ScreenObject.Data.Tables[17].filter((function(e){return 1==e.RuleType}));if(null!=n&&n.length>0)for(var r=0;r<n.length;r++)t.SalesBinRule.Items.push(u.d.ComboBoxItems_2(n[r].ProfileName.toString(),n[r].ProfileID.toString()))}t.SalesBinRule.SelectedValue=""}}))}else"Kit"==e.Name&&e.Fields.forEach((function(e){switch(e.DBColumnName){case"KitSize":t.ScreenObject.StaticFields.Contains(t.KitSize)&&t.ScreenObject.StaticFields.Remove(t.KitSize),t.KitSize=e}}));50006==i?(t.Linkedcc=t.Category,null!=t.Linkedcc&&t.Linkedcc.SelectionChangedCommand.Subscribe(t,"OnlinkccChanged")):50004==i?(t.Linkedcc=t.Department,null!=t.Linkedcc&&t.Linkedcc.SelectionChangedCommand.Subscribe(t,"OnlinkccChanged")):e.Fields.forEach((function(e){null!=e&&e instanceof c.b&&(e.CCID==i||e.CCID==t.InheritDimImageID)&&(t.Linkedcc=e,null!=t.Linkedcc&&t.Linkedcc.SelectionChangedCommand.Subscribe(t,"OnlinkccChanged"))}))})),null!=this.BinWise&&0==o&&(this.BinWise.Visible=!1,this.BinWise.SelectedValue="0",this.BinWise.DefaultValue="0");for(var l=this.ScreenObject.CustomTab.Pages.length-1;l>=0;l--){var d=this.ScreenObject.CustomTab.Pages[l];switch(d.Name){case"Kit":s.a.SessionManager.LicenseSettings.ContainsKey("Kit")&&"FALSE"==s.a.SessionManager.LicenseSettings.Kit.toUpperCase()?d.Visible=!1:(this.ProductKit.Row="1",d.Fields.push(this.ProductKit),d.Enable=!1);break;case"Attributes":d.Fields.push(this.ProductAttributes),d.Enable=!1;break;case"Serial":s.a.SessionManager.LicenseSettings.ContainsKey("SerialNo")&&"FALSE"==s.a.SessionManager.LicenseSettings.SerialNo.toUpperCase()?d.Visible=!1:(this.ProductSerialization.Row="1",d.Fields.push(this.ProductSerialization),d.Enable=!1);break;case"Notes":d.Fields.push(this.ViewNotes);break;case"Contacts":d.Fields.push(this.ViewContacts);break;case"Attachments":d.Fields.push(this.ViewAttachments);break;case"Vendors":d.Fields.push(this.ViewVendors);break;case"Substitutes":s.a.SessionManager.LicenseSettings.ContainsKey("Substitutes")&&"FALSE"==s.a.SessionManager.LicenseSettings.Substitutes.toUpperCase()?d.Visible=!1:d.Fields.push(this.ViewSubstitutes);break;case"Assign":d.Fields.push(this.ViewCCMapping);break;case"TestCases":s.a.SessionManager.LicenseSettings.ContainsKey("QC")&&"FALSE"==s.a.SessionManager.LicenseSettings.QC.toUpperCase()?d.Visible=!1:(d.Fields.push(this.ProductTestcases),d.Visible=!!(s.a.SessionManager.Preferences.ContainsKey("TestCaseDimension")&&""!=s.a.SessionManager.Preferences.TestCaseDimension&&parseInt(s.a.SessionManager.Preferences.TestCaseDimension)>0));break;case"Production Process":s.a.SessionManager.IsActionAssigned(3,"Map")?d.Fields.push(this.ViewCCMapping):this.ScreenObject.CustomTab.Pages.Remove(d);break;case"Link":d.Fields.push(this.ProductLink);break;case"Specifications":d.Fields.push(this.ProductSpecs);break;case"Bins":o>0?d.Fields.push(this.ViewBins):this.ScreenObject.CustomTab.Pages.Remove(d)}}Logger.InfoLog("AddProductViewModel::BuildControls Success"),this.ScreenObject.Data.Tables[3].forEach((function(e){t.ProductStatuses.Items.push(u.d.ComboBoxItems_2(e[Object.keys(e)[1]].toString(),e[Object.keys(e)[0]].toString()))})),this.ScreenObject.Data.Tables[13].forEach((function(e){t.UOM.Items.push(u.d.ComboBoxItems_3(e.UnitName.toString(),e.UOMID.toString(),e.BaseID.toString()))})),this.ScreenObject.Data.Tables[9].forEach((function(e){t.BarcodeLayoutID.Items.push(u.d.ComboBoxItems_2(e.Name.toString(),e.BarcodeLayoutID.toString()))})),this.UOM.Items.push(u.d.ComboBoxItems_2("New","-100")),this.UOM.Items.push(u.d.ComboBoxItems_2("Product-Wise","-399")),this.UOM.SelectedValue=this.UOM.DefaultValue,this.PurchaseUOM.Visible&&this.FillPurchaseUom(),this.ManufacturerBarcode.Items.push(u.d.ComboBoxItems_2("Yes","1")),this.ManufacturerBarcode.Items.push(u.d.ComboBoxItems_2("No","0")),this.ManufacturerBarcode.SelectedValue=this.ManufacturerBarcode.DefaultValue,this.BinWise.Items.push(u.d.ComboBoxItems_2("Yes","1")),this.BinWise.Items.push(u.d.ComboBoxItems_2("No","0")),this.BinWise.SelectedValue=this.BinWise.DefaultValue,Object(r.j)(s.a.SessionManager.Preferences.EnableSerialProducts.toString()),this.ScreenObject.Data.Tables[4].forEach((function(e){"2"==e[Object.keys(e)[0]].toString()&&!Object(r.j)(s.a.SessionManager.Preferences.EnableSerialProducts.toString())||"5"==e[Object.keys(e)[0]].toString()&&!Object(r.j)(s.a.SessionManager.Preferences.EnableBatchProducts.toString())||!("8"!=e[Object.keys(e)[0]].toString()&&"3"!=e[Object.keys(e)[0]].toString()||Object(r.j)(s.a.SessionManager.Preferences.EnableDynamicProducts.toString()))||t.ProductTypes.Items.push(u.d.ComboBoxItems_2(e[Object.keys(e)[1]].toString(),e[Object.keys(e)[0]].toString()))})),this.ScreenObject.Data.Tables[4].length>0&&(this.ProductTypes.SelectedValue=this.ScreenObject.Data.Tables[4][0][Object.keys(this.ScreenObject.Data.Tables[4][0])[0]].toString()),this.ScreenObject.Data.Tables[6].forEach((function(e){t.ValuationMethods.Items.push(u.d.ComboBoxItems_2(e[Object.keys(e)[1]].toString(),e[Object.keys(e)[0]].toString()))})),this.QtyAdjustment.Items.push(u.d.ComboBoxItems_2("Not Applicable","3")),this.QtyAdjustment.Items.push(u.d.ComboBoxItems_2("Optional","2")),this.QtyAdjustment.Items.push(u.d.ComboBoxItems_2("Mandatory","1")),e>0&&(this.ProductGroups.SelectedValue=e,this.ProductGroups.DefaultValue=this.ProductGroups.SelectedValue.toString()),0!=this.oProduct.ProductID?(a=this.ScreenObject.Data.Tables[10].filter((function(e){return"ProductCodeAutoGen"==e.Name})),this.LoadEditData()):(this.NextPreviousVisibility=!1,this.oProduct.GUID="",null!=this.ScreenObject.Data.Tables[10]&&(null!=(a=this.ScreenObject.Data.Tables[10].filter((function(e){return"DefaultUOM"==e.Name})))&&a.length>0&&!n.e.StringIsNullOrEmpty(a[0].Value)&&(this.UOM.SelectedValue=a[0].Value.toString()),null!=(a=this.ScreenObject.Data.Tables[10].filter((function(e){return"DefaultProductType"==e.Name})))&&a.length>0&&!n.e.StringIsNullOrEmpty(a[0].Value)&&(this.ProductTypes.SelectedValue=a[0].Value.toString()))),this.AutoGenerateCode(),null!=this.DimFields&&this.DimFields.length>0||this.ScreenObject.SetViewByType(this.ProductTypes.SelectedValue,this.oProduct.IsGroup),Logger.InfoLog("AddProductViewModel::Exiting worker_DoWork")}},{key:"SetViewFilter",value:function(e){var t=this;return e.filter="",this.DimFields.forEach((function(i){if("3"==i){if(!(t.ProductGroups.SelectedValue>0))return!1;e.filter+=" and GroupID="+t.ProductGroups.SelectedValue}else if(!n.e.IsEmpty(i)&&parseInt(i)>5e4){var s=t.ScreenObject.GetCustomCCField_1(parseInt(i));if(!(null!=s&&s instanceof c.b&&s.SelectedValue>0))return!1;e.filter+=" and DcCCNID"+(i-5e4)+"="+s.SelectedValue}})),!0}},{key:"SetViewByType",value:function(){var e=this,t=null,i=null,s="",r=this.ScreenObject.Data.Tables[18].filter((function(e){return 1==e.IsTab})),a=this.ScreenObject.Data.Tables[18].filter((function(e){return 0==e.IsTab}));if(this.DimFields.forEach((function(t){if("3"==t&&e.ProductGroups.SelectedValue>0)s+=" and GroupID="+e.ProductGroups.SelectedValue,a=a.filter((function(t){return t.GroupID==e.ProductGroups.SelectedValue})),r=r.filter((function(t){return t.GroupID==e.ProductGroups.SelectedValue}));else if(!n.e.IsEmpty(t)&&parseInt(t)>5e4){var i=e.ScreenObject.GetCustomCCField_1(parseInt(t));null!=i&&i instanceof c.b&&i.SelectedValue>0&&(s+=" and DcCCNID"+(t-5e4)+"="+i.SelectedValue,a=a.filter((function(e){return 0==e.IsTab&&e["DcCCNID"+(t-5e4)]==i.SelectedValue})),r=r.filter((function(e){return 1==e.IsTab&&e["DcCCNID"+(t-5e4)]==i.SelectedValue})))}})),""!=s){var o=0,l=a;l.forEach((function(i){if(t=null,null!=e.ScreenObject.HeaderFields?t=e.ScreenObject.HeaderFields.find((function(e){return e instanceof X.c&&e.DBColumnID==parseInt(i.CostCenterColID)})):null!=e.ScreenObject.StaticFields&&(t=e.ScreenObject.StaticFields.find((function(e){return e instanceof X.c&&e.DBColumnID==parseInt(i.CostCenterColID)}))),null==t)for(var s=0;s<e.ScreenObject.CustomTab.Pages.length&&(null==(t=e.ScreenObject.CustomTab.Pages[s].Fields.find((function(e){return e instanceof X.c&&e.DBColumnID==parseInt(i.CostCenterColID)})))||null==t);s++);null!=t&&(1!=(o=parseInt(i.Hide))&&2!=o||(t.Visible=!1),1!=(o=parseInt(i.Mandatory))&&2!=o||(t.Mandatory=!0))})),(l=r).forEach((function(t){null!=(i=e.ScreenObject.CustomTab.Pages.find((function(e){return e.DBColumnID==parseInt(t.CostCenterColID)})))&&null!=i&&(1!=(o=parseInt(t.Hide))&&2!=o||(i.Visible=!1),1!=(o=parseInt(t.Mandatory))&&2!=o||(i.IsReadOnly=!0))}));for(var u=0;u<this.ScreenObject.CustomTab.Pages.length;u++){var d=this.ScreenObject.CustomTab.Pages[u];if(d.Visible){this.ScreenObject.CustomTab.SelectedTab=d;break}}}}},{key:"SetFieldsposition",value:function(){var e=this;if(null!=this.ScreenObject.HeaderFields){var t=this.ScreenObject.HeaderFields.filter((function(e){return e instanceof X.c&&e.Visible}));t.sort((function(e,t){return e.SectionSeqNo-t.SectionSeqNo})),this.Setposition(t)}this.ScreenObject.CustomTab.Pages.forEach((function(t){var i=t.Fields.filter((function(e){return e instanceof X.c&&e.Visible}));i.sort((function(e,t){return e.SectionSeqNo-t.SectionSeqNo})),i.length>0&&e.Setposition(i)}))}},{key:"Setposition",value:function(e){for(var t=0,i=0,s=1,r=0;r<e.length;r++){var a=e[r];s=1,(s=n.e.Int(a.ColumnSpan))<1&&(s=1),i+s>4&&(t++,i=0),a.Row=t,a.Column=i,i+=s}}},{key:"PopulateProductName",value:function(e){null!=e&&(this.ScreenObject.LinkColumnCostcenterID=this.LinkColumnCostcenterID,this.ScreenObject.PopulateProductName(e))}},{key:"LoadEditData",value:function(){var e,t=this;if(this.NextPrevProductID=this.ProductID,this.ds=this.oProduct.GetProductDetails(),this.ProductPhoto="",this.ActualFileName="",this.ThumbnailPhoto="",this.ProductCode.Text=this.oProduct.ProductCode,this.ProductCode.Code=this.oProduct.ProductCode,(this.ScreenObject.InheritParentCode||this.ScreenObject.IsAutoCode)&&(this.ProductCode.Enable=parseInt(this.ds.Tables[0][0].Depth)<=1&&!this.ScreenObject.IsRootAutoCode),this.ProductName.Text=this.oProduct.ProductName,this.AliasName.Text=this.oProduct.AliasName,this.ProductTypes.SelectedValue=this.oProduct.ProductType.toString(),this.ProductStatuses.SelectedValue=this.oProduct.ProductStatus.toString(),this.ProductGroups.SelectedValue=this.oProduct.ProductGroup,this.ProductGroups.Enable=!1,this.ProductGroups.DefaultValue=this.ProductGroups.SelectedValue.toString(),this.ValuationMethods.SelectedValue=this.oProduct.Valuation.toString(),this.QtyAdjustment.SelectedValue=this.oProduct.QtyAdjustment.toString(),this.BinWise.SelectedValue=this.oProduct.BinWise.toString(),this.AssetGroup.SelectedValue=this.oProduct.AssetGroupID,null!=this.ReorderLevel&&(this.ReorderLevel.Text=this.oProduct.ReorderLevel.toString()),null!=this.ReorderQty&&(this.ReorderQty.Text=this.oProduct.ReorderQty.toString(),this.ReorderQty.SelectedValue=this.oProduct.ReorderQtyType.toString()),null!=this.ReorderTrigger&&(this.ReorderTrigger.Text=this.oProduct.ReorderTrigger.toString(),this.ReorderTrigger.SelectedValue=this.oProduct.ReorderTriggerType.toString()),null!=this.Barcode&&null!=this.oProduct.Barcode&&(this.Barcode.Text=this.oProduct.Barcode.toString()),null!=this.Currency&&(this.Currency.SelectedValue=this.oProduct.Currency),this.Description.Text=this.oProduct.Description,null!=this.Packing&&null!=this.oProduct.Packing&&(this.Packing.Text=this.oProduct.Packing),null!=this.ShelfLife&&(this.ShelfLife.Text=this.oProduct.ShelfLife.toString()),null!=this.PreExpiryDays&&(this.PreExpiryDays.Text=this.oProduct.PreExpiryDays.toString()),null!=this.MaxTolerancePer&&(this.MaxTolerancePer.Text=this.oProduct.MaxTolerancePer.toString()),null!=this.MaxToleranceVal&&(this.MaxToleranceVal.Text=this.oProduct.MaxToleranceVal.toString()),null!=this.MinTolerancePer&&(this.MinTolerancePer.Text=this.oProduct.MinTolerancePer.toString()),null!=this.MinToleranceVal&&(this.MinToleranceVal.Text=this.oProduct.MinToleranceVal.toString()),null!=this.CreditDays&&(this.CreditDays.Text=this.oProduct.CreditDays.toString()),this.PurchaseRate.Text=this.oProduct.PurchaseRates.toString(),this.PurchaseRateA.Text=this.oProduct.PurchaseRateA.toString(),this.PurchaseRateB.Text=this.oProduct.PurchaseRateB.toString(),this.PurchaseRateC.Text=this.oProduct.PurchaseRateC.toString(),this.PurchaseRateD.Text=this.oProduct.PurchaseRateD.toString(),this.PurchaseRateE.Text=this.oProduct.PurchaseRateE.toString(),this.PurchaseRateF.Text=this.oProduct.PurchaseRateF.toString(),this.PurchaseRateG.Text=this.oProduct.PurchaseRateG.toString(),this.SellingRate.Text=this.oProduct.SellingRates.toString(),this.SellingRateA.Text=this.oProduct.SellingRateA.toString(),this.SellingRateB.Text=this.oProduct.SellingRateB.toString(),this.SellingRateC.Text=this.oProduct.SellingRateC.toString(),this.SellingRateD.Text=this.oProduct.SellingRateD.toString(),this.SellingRateE.Text=this.oProduct.SellingRateE.toString(),this.SellingRateF.Text=this.oProduct.SellingRateF.toString(),this.SellingRateG.Text=this.oProduct.SellingRateG.toString(),this.oProduct.BarcodeLayoutID>0&&(this.BarcodeLayoutID.SelectedValue=this.oProduct.BarcodeLayoutID.toString()),null!=this.UOM&&(this.UOM.SelectedValue=this.oProduct.UOM.toString()),this.ManufacturerBarcode.SelectedValue=this.oProduct.ManufacturerBarcode.toString(),(this.SalesAccount.Enable||""!=this.SalesAccount.DefaultValue&&this.oProduct.SalesAccount!=parseInt(this.SalesAccount.DefaultValue))&&(this.SalesAccount.SelectedValue=this.oProduct.SalesAccount),(this.PurchaseAccount.Enable||""!=this.PurchaseAccount.DefaultValue&&this.oProduct.PurchaseAccount!=parseInt(this.PurchaseAccount.DefaultValue))&&(this.PurchaseAccount.SelectedValue=this.oProduct.PurchaseAccount),this.COGSAccount.SelectedValue=this.oProduct.COGSAccount,this.ClosingStockAccount.SelectedValue=this.oProduct.ClosingStockAccount,this.SalesAccount.drrEdit=this.ds.Tables[19].filter((function(e){return e.CCID==t.SalesAccount.DBColumnID})),this.PurchaseAccount.drrEdit=this.ds.Tables[19].filter((function(e){return e.CCID==t.PurchaseAccount.DBColumnID})),this.COGSAccount.drrEdit=this.ds.Tables[19].filter((function(e){return e.CCID==t.COGSAccount.DBColumnID})),this.ClosingStockAccount.drrEdit=this.ds.Tables[19].filter((function(e){return e.CCID==t.ClosingStockAccount.DBColumnID})),null!=this.Category&&(this.Category.SelectedValue=this.oProduct.Category),null!=this.Department&&(this.Department.SelectedValue=this.oProduct.Department),this.ProductLength.Text=this.oProduct.ProductLength.ToString("N"+this.ProductLength.DecimalPoints),this.ProductWidth.Text=this.oProduct.ProductWidth.ToString("N"+this.ProductWidth.DecimalPoints),this.ProductHeight.Text=this.oProduct.ProductHeight.ToString("N"+this.ProductHeight.DecimalPoints),this.ProductVolume.Text=this.oProduct.ProductVolume.ToString("N"+this.ProductVolume.DecimalPoints),this.ProductWeight.Text=this.oProduct.ProductWeight.ToString("N"+this.ProductWeight.DecimalPoints),this.ProductWastage.Text=this.oProduct.ProductWastage.ToString("N"+this.ProductWastage.DecimalPoints),this.KitSize.Text=this.oProduct.KitSize.toString(),this.SerialNumber.Text=this.oProduct.SerialNumber,this.ProductWeightable.SelectedValue=this.oProduct.ProductWeightable.toString(),this.ProductPacking.SelectedValue=this.oProduct.ProductPacking.toString(),this.ProductBillOfEntry.SelectedValue=this.oProduct.ProductBillOfEntry.toString(),this.ReorderPolicy.SelectedValue=this.oProduct.ReorderPolicy.toString(),this.MaxInventoryLevel.Text=this.oProduct.MaxInventoryLevel.toString(),this.ReorderMinOrderQty.Text=this.oProduct.ReorderMinOrderQty.toString(),this.ReorderMaxOrderQty.Text=this.oProduct.ReorderMaxOrderQty.toString(),this.ReorderOrderMultiple.Text=this.oProduct.ReorderOrderMultiple.toString(),this.PlanningMethod.SelectedValue=this.oProduct.PlanningMethod.toString(),this.ProcurementMethod.SelectedValue=this.oProduct.ProcurementMethod.toString(),this.LeadTime.Text=this.oProduct.LeadTime.toString(),this.SafetyStock.Text=this.oProduct.SafetyStock.toString(),this.ProductBOM.SearchVisible&&(this.ProductBOM.CustomWhere="a.ProductID="+this.oProduct.ProductID),this.ProductBOM.SelectedValue=this.oProduct.ProductBOM,this.PurchaseBinRule.SelectedValue=this.oProduct.PurchaseBinRule.toString(),this.SalesBinRule.SelectedValue=this.oProduct.SalesBinRule.toString(),this.ScreenObject.LoadCustomFieldsData(this.ds.Tables[1]),this.ScreenObject.LoadCustomFieldsCCData(this.ds.Tables[7],this.ds.Tables[19]),(e=this.ds.Tables[4].filter((function(e){return 1==e.IsProductImage&&1==e.IsDefaultImage}))).length>0?(this.PhotoTextVisibility=!1,this.FileID=parseInt(e[0].FileID),this.ProductPhoto=n.e.GetPath(e[0].GUID.toString()+"."+e[0].FileExtension.toString()),this.ActualFileName=e[0].ActualFileName.toString()):this.InheritImage?(this.PhotoTextVisibility=!0,this.FileID=0,this.ImageHeight=(parseInt(this.ImageHeight)-20).toString()):this.InheritGrpImage?this.OnLoadImage("Group",this.ProductGroups.SelectedValue):this.OnLoadImage("Dimension",this.GetImageCCVal()),this.ViewContacts.LoadContacts(this.ds.Tables[2],this.ds.Columns[2]),this.ViewNotes.LoadNotes(this.ds.Tables[3]),this.ViewAttachments.LoadAttachments(this.ds.Tables[4]),this.ViewSubstitutes.LoadSubstitutes(this.ds.Tables[5]),this.ViewVendors.LoadVendors(this.ds.Tables[6]),this.ProductKit.LoadBundels(this.ds.Tables[8]),this.ProductLink.LoadBundels(this.ds.Tables[8]),this.ProductSpecs.LoadSpecs(this.ds.Tables[10]),this.ProductSerialization.LoadSerialization(this.ds.Tables[9]),this.oProduct.IsMatrixItem)this.ProductAttributes.LoadAttributes(this.ds.Tables[0],!0);else{var i=this.ds.Tables[0][0].AttributeMapXML;this.ProductAttributes.LoadAttributes(this.ds.Tables[0],!1),null!=i&&null!=i&&i.length>0&&this.ProductAttributes.LoadSubItems(this.ds.Tables[0])}for(var r=function(e){if(t.ScreenObject.CustomTab.Pages[e].QuickViewCCID>0)for(var i=0;i<t.ScreenObject.CustomTab.Pages[e].Fields.length;i++)"PACT.VIEWMODEL.PactGridViewModel"==t.ScreenObject.CustomTab.Pages[e].Fields[i].toString()&&function(){var r=t.ScreenObject.CustomTab.Pages[e].Fields[i],a=t.ds.Tables[11].filter((function(i){return i.CostCenterId==t.ScreenObject.CustomTab.Pages[e].QuickViewCCID})),o="";r.Table.Clear(),a.forEach((function(e){var i=r.NewRow();i.Dimension_Key=e.NodeID,i.Dimension=e.Value,r.addRow(i),o=o+e.NodeID+",",t.ds.Tables[11].Remove(e)}));for(var l=0;l<15;l++){var u=r.NewRow();r.addRow(u)}var c=null;t.ScreenObject.CustomTab.Pages[e].QuickViewID>0&&(c=s.a.common.GetCostCenterQuickViewSummary(t.ScreenObject.CustomTab.Pages[e].QuickViewCCID,o.TrimEnd(","),t.ScreenObject.CustomTab.Pages[e].QuickViewCCID,new Date,"",0,t.ScreenObject.CustomTab.Pages[e].QuickViewID));var d=1;r.Table.forEach((function(e){if(e.SNO=d++,!n.e.StringIsNullOrEmpty(e.Dimension_Key)&&null!=c&&c.Tables.length>0&&c.Tables[0].length>0&&!c.Columns[0].Contains("ErrorMessage"))for(var t=c.Tables[0].filter((function(t){return t.NodeID==e.Dimension_Key.toString()})),i=2;i<c.Columns[0].length;i++)"FileExtension"!=c.Columns[0][i]&&"FileGUID"!=c.Columns[0][i]&&(e["fld"+i]=t[0][c.Columns[0][i]].toString())}))}()},a=0;a<this.ScreenObject.CustomTab.Pages.length;a++)r(a);this.ViewCCMapping.LoadData(this.ds.Tables[11],this.ds.Columns[11]),this.ViewCCMapping.TempData=[],this.ProductTestcases.LoadData(this.ds.Tables[18]),this.StatusAssignGrid.Load(this.ds.Tables[20]),this.ScreenObject.CanApprove(this.ds.Tables[0][0],this.ds.Tables[16][0],this.ButtonSave),this.ds.Tables.length>17&&this.ViewBins.LoadBins(this.ds.Tables[17]),this.OnlinkccChanged(this.Linkedcc),this.ds.Tables.length>13&&this.ds.Tables[13].length>0?(this.dtProductWise=this.ds.Tables[13],this.LoadUnitsProductWise(this.ds.Tables[13]),n.e.IsEmpty(this.ds.Tables[0][0].PurchaseUOM)||(this.PurchaseUOM.SelectedValue=this.ds.Tables[0][0].PurchaseUOM.toString())):this.ds.Tables.length>0&&this.ds.Tables[0].length>0&&this.PurchaseUOM.Visible&&(this.FillPurchaseUom(),n.e.IsEmpty(this.ds.Tables[0][0].PurchaseUOM)||(this.PurchaseUOM.SelectedValue=this.ds.Tables[0][0].PurchaseUOM.toString())),s.a.SessionManager.IsOffline&&this.ProductID>0&&(this.ButtonSave.Visible=!1),(e=this.ScreenObject.Data.Tables[10].filter((function(e){return"ProductName"==e.Name}))).length>0&&""!=e[0].Value.toString()?(this.LinkColumnCostcenterID=parseInt(e[0].Value),this.ScreenObject.LinkColumnCostcenterID=this.LinkColumnCostcenterID,this.LinkColumnCostcenterID>0&&(this.ProductName.Enable=!1)):this.ProductName.Enable=!this.AutoGenerateName&&!this.NameSameasCode,this.OnTypeChanged()}},{key:"GetImageCCVal",value:function(){var e=this;return this.ScreenObject.StaticFields.forEach((function(t){if(t instanceof c.b&&!n.e.StringIsNullOrEmpty(t.DBColumnName)&&t.DBColumnName.toUpperCase().startsWith("CCNID")&&t.CCID==e.InheritDimImageID)return t.SelectedValue})),0}},{key:"LoadUnitsProductWise",value:function(e){var t,i=this;e.length>0&&function(){i.AddEditUOM.ButtonVisible=!1;var s=[];if((s=e).length>0){i.PurchaseUOM.Items.Clear(),i.AddEditUOM.Units1.Items.Clear(),i.isCopy||(i.AddEditUOM.Units1.Items.push(u.d.ComboBoxItems_2(s[0].BaseName.toString(),s[0].BaseID.toString())),i.AddEditUOM.Units1.SelectedValue=s[0].BaseID.toString()),i.AddEditUOM.BaseText=s[0].BaseName.toString(),i.AddEditUOM.RateText=s[0].Conversion.toString(),i.AddEditUOM.BaseVisibility=!0,i.AddEditUOM.GridUnitsObj.Clear();for(var n=function(e){if((t=i.AddEditUOM.GridUnits.filter((function(t){return t.PrimayColumn==s[e].UOMID.toString()}))).length>0)t[0].Barcodes=t[0].Barcodes.toString()+","+s[e].Barcode.toString();else{var n=i.AddEditUOM.GridUnitsObj.NewRow();i.isCopy?(n.PrimayColumn=null,n.UnitID=null,n.Barcode="",n.Barcode_Key=null):(n.PrimayColumn=s[e].UOMID.toString(),n.UnitID=s[e].UOMID.toString(),n.Barcode=s[e].Barcode.toString(),n.Barcode_Key=s[e].Barcode_Key,i.PurchaseUOM.Visible&&i.PurchaseUOM.Items.push(u.d.ComboBoxItems_2(s[e].UnitNAme.toString(),s[e].UOMID.toString()))),i.AddEditUOM.BaseText==s[e].UnitName.toString()&&(i.AddEditUOM.RateText=s[e].Conversion.toString()),n["Unit Name"]=s[e].UnitName.toString(),n["Conversion Rate"]=s[e].Conversion.toString(),n.BaseID=null,n.Barcodes="",i.AddEditUOM.GridUnitsObj.addRow(n)}},r=0;r<s.length;r++)n(r);for(var a=i.AddEditUOM.GridUnits.length;a<10;a++){var o=i.AddEditUOM.GridUnitsObj.NewRow();i.AddEditUOM.GridUnitsObj.addRow(o)}}i.UOM.SelectedValue="-399",i.UOMVisibility=!0}()}},{key:"AutoGenerateCode",value:function(){var e=this;this.AssetGroup.Visible=!!(this.oProduct.IsGroup&&"10"==this.ProductTypes.SelectedValue||this.AssetGroupVisible&&!this.oProduct.IsGroup&&"1"==this.ProductTypes.SelectedValue);var t=this.ScreenObject.Data.Tables[10].filter((function(e){return"CapsLock"==e.Name}));null!=t&&t.length>0&&Object(r.j)(t[0].Value)&&(this.ProductName.IsAllCaps=!0),null!=(t=this.ScreenObject.Data.Tables[10].filter((function(e){return"CapsToFirstLetter"==e.Name})))&&t.length>0&&Object(r.j)(t[0].Value)&&(this.ProductName.IsFirstLetterCaps=!0),null!=(t=this.ScreenObject.Data.Tables[10].filter((function(e){return"CodeCapsLock"==e.Name})))&&t.length>0&&Object(r.j)(t[0].Value)&&(this.ProductCode.IsAllCaps=!0),null!=(t=this.ScreenObject.Data.Tables[10].filter((function(e){return"CodeCapsToFirstLetter"==e.Name})))&&t.length>0&&Object(r.j)(t[0].Value)&&(this.ProductCode.IsFirstLetterCaps=!0),null!=(t=this.ScreenObject.Data.Tables[10].filter((function(e){return"CodeIgnoreSpaces"==e.Name})))&&t.length>0&&Object(r.j)(t[0].Value)&&(this.ProductCode.IgnoreSpaces=!0),null!=(t=this.ScreenObject.Data.Tables[10].filter((function(e){return"IgnoreSpaces"==e.Name})))&&t.length>0&&Object(r.j)(t[0].Value)&&(this.ProductName.IgnoreSpaces=!0),null!=(t=this.ScreenObject.Data.Tables[10].filter((function(e){return"AttachmentMandatory"==e.Name})))&&t.length>0&&Object(r.j)(t[0].Value)&&(this.IsAttachmentMandatory=!0),(t=this.ScreenObject.Data.Tables[10].filter((function(e){return"AttachementThumbnail"==e.Name}))).length>0&&Object(r.j)(t[0].Value)&&(this.ViewAttachments.GridView=!0);var i=90;if(null!=(t=this.ScreenObject.Data.Tables[10].filter((function(e){return"ProductImageDimensions"==e.Name})))&&t.length>0&&!n.e.StringIsNullOrEmpty(t[0].Value)){var s=new n.f;s.LoadXml(t[0].Value.toString()),this.ImgRowSpan=null!=s.DocumentElement.attributes.RowSpan&&""!=s.DocumentElement.attributes.RowSpan.value?s.DocumentElement.attributes.RowSpan.value:"3",this.ImgColumnSpan=null!=s.DocumentElement.attributes.ColumnSpan&&""!=s.DocumentElement.attributes.ColumnSpan.value?s.DocumentElement.attributes.ColumnSpan.value:"1",this.ImgColumn="1"==this.ImgColumnSpan?"3":"2"==this.ImgColumnSpan?"2":"3"==this.ImgColumnSpan?"1":"4"==this.ImgColumnSpan?"0":"3",i=this.ProductPhoto.length>0?45*parseInt(this.ImgRowSpan):45*parseInt(this.ImgRowSpan)-20,this.ImageHeight=i.toString()}else this.ImgRowSpan="3",this.ImgColumn="3",this.ImgColumnSpan="1",this.ImageHeight=i.toString();if(this.ImgRow=parseInt(this.ImgRowSpan),this.ImgHeight=i,this.ImgCol=parseInt(this.ImgColumnSpan),null!=(t=this.ScreenObject.Data.Tables[10].filter((function(e){return"AutoBarcode"==e.Name})))&&t.length>0&&Object(r.j)(t[0].Value)&&null!=this.Barcode&&(this.Barcode.Enable=!1,0==this.oProduct.ProductID&&(this.Barcode.Text=this.oProduct.GetAutoBarcode())),0==this.oProduct.ProductID?(null!=this.ProductGroups&&this.ProductGroups.SelectedValue>0&&(this.ParentId=parseInt(this.ProductGroups.SelectedValue.toString())),this.ScreenObject.IsName=!1,this.ScreenObject.SetAutoCode(this.ProductCode,this.oProduct.IsGroup,this.ParentId,this.ScreenObject.Data.Tables[15]),this.OnTextChanged_string("")):this.ScreenObject.GetCodeParams(this.ScreenObject.Data.Tables[15]),null!=this.ScreenObject.Data.Tables[10]){if(null!=(t=this.ScreenObject.Data.Tables[10].filter((function(e){return"ProductName"==e.Name})))&&t.length>0&&!n.e.StringIsNullOrEmpty(t[0].Value)&&(this.LinkColumnCostcenterID=parseInt(t[0].Value),this.ScreenObject.LinkColumnCostcenterID=this.LinkColumnCostcenterID,this.LinkColumnCostcenterID>0)){if(null!=this.ScreenObject.Data.Tables[12]&&this.ScreenObject.Data.Tables[12].length>0){var a=this.ScreenObject.Data.Tables[12].filter((function(t){return t.FeatureID==e.LinkColumnCostcenterID}));null!=a&&a.length>0&&!n.e.StringIsNullOrEmpty(a[0].NAME)&&0==this.ProductID&&(this.ProductName.Text=a[0].NAME.toString())}this.ProductName.Enable=!1}-1!=this.LinkColumnCostcenterID&&0!=this.LinkColumnCostcenterID||(null!=(t=this.ScreenObject.Data.Tables[10].filter((function(t){return t.Name==(e.oProduct.IsGroup?"GroupNameSameasCode":"NameSameasCode")})))&&t.length>0&&Object(r.j)(t[0].Value)?this.ProductName.Enable=!1:this.ScreenObject.IsAutoName?(this.ScreenObject.IsNameAutoGenerate=!0,this.AutoGenerateName=!0,this.ProductName.Enable=!1):(this.ScreenObject.IsNameAutoGenerate=!1,this.ProductName.Enable=!0,this.AutoGenerateName=!1))}}},{key:"OnDropPhoto",value:function(e){var t=this,i=n.e.CheckImageSize(e[0].name,e[0].size);if(""==i){var r=e[0],a=e[0].name.split("."),o=e[0].name;a.length>1&&(a=a[a.length-1]);var l=new FormData;l.append("ImageUpload",r),l.append("FileUpload",r),l.append("UserName",s.a.SessionManager.UserID);var u=new FileReader;u.onload=function(e){var i=new Image;if("pdf"==a||"txt"==a||"doc"==a||"csv"==a||"docx"==a||"doc"==a||"xls"==a||"xlsx"==a)return t.DisplayMessage=s.a.GetResource("File_NoPhoto"),void(t.MessageVisibility=!0);i.src=e.target.result,i.onload=function(i){n.e.IsEmpty(e.target.result)||setTimeout((function(){s.a.common.UploadAttachments(l).subscribe((function(e){"AddEditAccountViewModel"==t.ClassName&&(t.ProductPhoto=n.e.GetPath(e),t.ActualFileName=o,t.FileExtension=a,t.IsPhotoChanged=!0,t.PhotoTextVisibility=!1,t.DisplayMessage="",t.MessageVisibility=!1)}),(function(e){console.log("Error : "+JSON.stringify(e))}))}),100)}},u.readAsDataURL(r)}else alert(i)}},{key:"OnLoadImage",value:function(e,t){var i=this;"Group"!=e&&"Dimension"!=e||this.InheritImage?this.InheritImage&&(this.UploadVisibility=!0,this.DeleteVisibility=!0):(null!=this.ScreenObject.Data&&null!=this.ScreenObject.Data&&this.ScreenObject.Data.Tables.length>14&&(this.ImageView=this.ScreenObject.Data.Tables[14]),this.InheritGrpImage?this.ImageView=this.ImageView.filter((function(e){return 3==e.FeatureID&&e.FeaturePK==t&&1==e.IsProductImage})):this.InheritDimImageID>5e4&&(this.ImageView=this.ImageView.filter((function(e){return e.FeatureID==i.InheritDimImageID&&e.FeaturePK==t&&1==e.IsProductImage}))),this.ImageView.length>0?(this.PhotoTextVisibility=!1,this.FileID=0,this.ProductPhoto=n.e.GetPath(this.ImageView[0].GUID.toString()+"."+this.ImageView[0].FileExtension.toString()),""==this.ProductPhoto&&(this.ImageHeight=(parseInt(this.ImageHeight)+20).toString()),this.IsPhotoChanged=!0,this.PhotoTextVisibility=!1,this.DisplayMessage="",this.MessageVisibility=!1):(this.ProductPhoto="",this.ActualFileName="",this.IsPhotoChanged=!1,this.PhotoTextVisibility=!1),this.UploadVisibility=!1,this.DeleteVisibility=!1)}},{key:"OnSaveProduct",value:function(e){var t=this;if(Logger.InfoLog("OnSaveProduct:: Entering OnSaveProduct With Parameter="+e),"Contact"==e.toString())this.ContactExpanded=!this.ContactExpanded;else if("PopUp"==e.toString()){null!=this.ds&&this.ds.Tables[4].filter((function(e){return"jpg"==e.FileExtension||"png"==e.FileExtension})).forEach((function(e){n.e.GetPath(e.GUID.toString()+"."+e.FileExtension.toString())+";"}))}else if("Query"==e.toString());else if("Copy"==e.toString()){this.isCopy=!0;var i=new ue.CopyProductViewModel(this);s.a.page.ShowDialog(i,ce.CopyProductComponent,{ShowCenter:!0,Title:s.a.GetResource("Copy")})}else if("Note"==e.toString())this.NoteExpanded=!this.NoteExpanded;else if("Attachment"==e.toString())this.AttachmentExpanded=!this.AttachmentExpanded;else if("NewContact"==e.toString())this.ContactVisibility=!0;else if("Attachment"==e.toString())this.AttachmentVisibility=!0;else if("NewNote"==e.toString())this.NoteVisibility=!0;else if("PartyRate"==e.toString())this.PartyRateExpanded=!this.PartyRateExpanded;else if("CCRates"==e.toString())this.CCRatesExpanded=!this.CCRatesExpanded;else if("Substitutes"==e.toString())this.SubstitutesExpanded=!this.SubstitutesExpanded;else if("Vendors"==e.toString())this.VendorsExpanded=!this.VendorsExpanded;else if("Schemes"==e.toString())this.SchemesExpanded=!this.SchemesExpanded;else if("Discounts"==e.toString())this.DiscountExpanded=!this.DiscountExpanded;else if("Taxes"==e.toString())this.TaxExpanded=!this.TaxExpanded;else if("NewSubstitutes"==e.toString())this.SubstituteVisibility=!0;else if("NewVendors"==e.toString())this.VendorVisibility=!0;else if("DeletePhoto"==e.toString())0==this.ProductPhoto.length?this.ImageHeight=(45*parseInt(this.ImgRowSpan)).toString():confirm("Are you sure you want to delete Image?")&&(this.IsPhotoDelete=!0,this.DialogResult=!1,this.ProductPhoto="",this.ActualFileName="",this.IsPhotoChanged=!1,this.PhotoTextVisibility=!0,this.DisplayMessage="",this.ImageHeight=(parseInt(this.ImageHeight)-15).toString());else if("UploadPhoto"==e.toString()&&this.InheritImage){var a=new te.a;a.PopupAttachmentsViewModel_1(3,this.ProductID,this),s.a.page.ShowDialog(a,ie.a,{ShowCenter:!0,Title:"Add Images"})}else if("MouseDown"==e.toString()&&this.InheritImage);else if("ShowApprove"==e.toString()){var o=new se.a(3,this.oProduct.ProductID,this.ScreenObject,this);s.a.page.ShowDialog(o,ne.a,{ShowCenter:!0,Title:s.a.GetResource("ApproveReject")})}else if("ShowStatusAssignGrid"==e.toString())this.StatusAssignGrid.IsShown=!0,s.a.page.ShowDialog(this.StatusAssignGrid,de.a,{ShowCenter:!0,Title:s.a.GetResource("Assign")});else if("Save"==e.toString()||"APPROVE_CALL"==e.toString()){Logger.InfoLog("AddProductViewModel::Entering OnSaveProduct");try{if(this.IsAttachmentMandatory&&null!=this.ViewAttachments){var u=0;if(this.ViewAttachments.AttachmentsList.length>0&&this.ViewAttachments.AttachmentsList.forEach((function(e){e.IsProductImage||u++})),0==u)return this.DisplayMessage="Attachment is mandatory",void(this.MessageVisibility=!0)}if(n.e.StringIsNullOrEmpty(this.UOM.SelectedValue))return this.MessageVisibility=!0,void(this.DisplayMessage=s.a.GetResource("Select")+" "+this.UOM.Label);if("1"==this.ProcurementMethod.SelectedValue&&this.ProductBOM.SelectedValue<=1)return this.MessageVisibility=!0,void(this.DisplayMessage=s.a.GetResource("Select")+" "+this.ProductBOM.Label);if(0==this.oProduct.ProductID){this.ScreenObject.IsName=!1;var d=[];d=(d=this.ScreenObject.Data.Tables[15]).filter((function(e){return 0==e.IsName}));var h={StrCode:this.oProduct.ProductCode,CodePrefix:this.oProduct.CodePrefix,CodeNumber:this.oProduct.CodeNumber};if(this.DisplayMessage=this.ScreenObject.SetAutoCodeParams_3(this.ProductCode,this.ParentId,d,h),this.oProduct.ProductCode=h.StrCode,this.oProduct.CodePrefix=h.CodePrefix,this.oProduct.CodeNumber=h.CodeNumber,this.OnTextChanged_string(""),this.DisplayMessage.length>0)return}else if(this.oProduct.ProductID>0&&!this.ProductCode.Enable&&!this.ScreenObject.CodeSeqExist){this.ScreenObject.IsName=!1;var b=[];b=(b=this.ScreenObject.Data.Tables[15]).filter((function(e){return 0==e.IsName}));var S={StrCode:this.oProduct.ProductCode,CodePrefix:this.oProduct.CodePrefix,CodeNumber:this.oProduct.CodeNumber};if(this.DisplayMessage=this.ScreenObject.SetAutoCodeParams_3(this.ProductCode,this.ParentId,b,S),this.oProduct.ProductCode=S.StrCode,this.oProduct.CodePrefix=S.CodePrefix,this.oProduct.CodeNumber=S.CodeNumber,this.OnTextChanged_string(""),this.DisplayMessage.length>0)return}else this.oProduct.ProductCode=this.ProductCode.Text,this.ProductCode.Code=this.ProductCode.Text;if(!this.ProductName.Enable&&this.AutoGenerateName){var m=[];m=(m=this.ScreenObject.Data.Tables[15]).filter((function(e){return 1==e.IsName})),this.ScreenObject.IsName=!0,null!=m&&m.length>0&&(this.ProductName.Text=this.ScreenObject.SetAutoCodeParams_1(this.ProductName,this.ParentId,m),this.oProduct.ProductName=this.ProductName.Text)}var C=this.ScreenObject.ValidateData();if(C.length>0)return this.MessageVisibility=!0,void(this.DisplayMessage=C);if(("11"==this.ProductTypes.SelectedValue||"12"==this.ProductTypes.SelectedValue)&&(C=this.ValidateModifiers()).length>0)return this.MessageVisibility=!0,void(this.DisplayMessage=C);if(this.ProductCode.Visible||(this.oProduct.ProductCode=this.ProductName.Text),this.ProductName.Visible&&(this.oProduct.ProductName=this.ProductName.Text.trim()),this.AliasName.Enable&&(this.oProduct.AliasName=n.e.StringIsNullOrEmpty(this.AliasName.Text)?this.ProductName.Text.trim():this.AliasName.Text),this.ProductTypes.Enable&&(this.oProduct.ProductType=parseInt(this.ProductTypes.SelectedValue)),this.ValuationMethods.Enable&&(this.oProduct.Valuation=parseInt(this.ValuationMethods.SelectedValue)),this.QtyAdjustment.Enable&&(this.oProduct.QtyAdjustment=parseInt(n.e.StringIsNullOrEmpty(this.QtyAdjustment.SelectedValue)?"0":this.QtyAdjustment.SelectedValue)),this.BinWise.Enable)if(n.e.StringIsNullOrEmpty(this.ScreenObject.Data.Tables[10].filter((function(e){return"BinsDimension"==e.Name}))[0].Value)){var P=!1;null==this.BinWise.DefaultValue||"1"!==this.BinWise.DefaultValue&&1!==parseInt(this.BinWise.DefaultValue)||(P=!0),this.oProduct.BinWise=P}else{var p=!1;null==this.BinWise.SelectedValue||"1"!==this.BinWise.SelectedValue&&1!==parseInt(this.BinWise.SelectedValue)||(p=!0),this.oProduct.BinWise=p}this.oProduct.ProductStatus=parseInt(this.ProductStatuses.SelectedValue),""!=this.UOM.SelectedValue&&(this.oProduct.UOM=parseInt(this.UOM.SelectedValue));var T,D=!1;if(null==this.ManufacturerBarcode.SelectedValue||"1"!==this.ManufacturerBarcode.SelectedValue&&1!==parseInt(this.ManufacturerBarcode.SelectedValue)||(D=!0),this.oProduct.ManufacturerBarcode=D,""!=this.BarcodeLayoutID.SelectedValue)this.oProduct.BarcodeLayoutID=parseInt(this.BarcodeLayoutID.SelectedValue);else if("4"==this.ProductTypes.SelectedValue&&""==this.BarcodeLayoutID.SelectedValue)return this.DisplayMessage="Select barcode layout",void(this.MessageVisibility=!0);if(this.oProduct.SalesAccount=this.SalesAccount.SelectedValue,this.oProduct.PurchaseAccount=this.PurchaseAccount.SelectedValue,this.oProduct.COGSAccount=this.COGSAccount.SelectedValue,this.oProduct.ClosingStockAccount=this.ClosingStockAccount.SelectedValue,this.oProduct.ProductGroup=parseInt(this.ProductGroups.SelectedValue.toString()),this.Currency.Enable&&(this.oProduct.Currency=this.Currency.SelectedValue),this.PurchaseRate.Enable&&(this.oProduct.PurchaseRates=n.e.DoubleTryParse(this.PurchaseRate.Text)),this.PurchaseRateA.Enable&&(this.oProduct.PurchaseRateA=n.e.DoubleTryParse(this.PurchaseRateA.Text)),this.PurchaseRateB.Enable&&(this.oProduct.PurchaseRateB=n.e.DoubleTryParse(this.PurchaseRateB.Text)),this.PurchaseRateC.Enable&&(this.oProduct.PurchaseRateC=n.e.DoubleTryParse(this.PurchaseRateC.Text)),this.PurchaseRateD.Enable&&(this.oProduct.PurchaseRateD=n.e.DoubleTryParse(this.PurchaseRateD.Text)),this.PurchaseRateE.Enable&&(this.oProduct.PurchaseRateE=n.e.DoubleTryParse(this.PurchaseRateE.Text)),this.PurchaseRateF.Enable&&(this.oProduct.PurchaseRateF=n.e.DoubleTryParse(this.PurchaseRateF.Text)),this.PurchaseRateG.Enable&&(this.oProduct.PurchaseRateG=n.e.DoubleTryParse(this.PurchaseRateG.Text)),this.SellingRate.Enable&&(this.oProduct.SellingRates=n.e.DoubleTryParse(this.SellingRate.Text)),this.SellingRateA.Enable&&(this.oProduct.SellingRateA=n.e.DoubleTryParse(this.SellingRateA.Text)),this.SellingRateB.Enable&&(this.oProduct.SellingRateB=n.e.DoubleTryParse(this.SellingRateB.Text)),this.SellingRateC.Enable&&(this.oProduct.SellingRateC=n.e.DoubleTryParse(this.SellingRateC.Text)),this.SellingRateD.Enable&&(this.oProduct.SellingRateD=n.e.DoubleTryParse(this.SellingRateD.Text)),this.SellingRateE.Enable&&(this.oProduct.SellingRateE=n.e.DoubleTryParse(this.SellingRateE.Text)),this.SellingRateF.Enable&&(this.oProduct.SellingRateF=n.e.DoubleTryParse(this.SellingRateF.Text)),this.SellingRateG.Enable&&(this.oProduct.SellingRateG=n.e.DoubleTryParse(this.SellingRateG.Text)),null!=this.ReorderLevel&&this.ReorderLevel.Enable&&(this.oProduct.ReorderLevel=n.e.DoubleTryParse(this.ReorderLevel.Text)),null!=this.ReorderQty&&this.ReorderQty.Enable&&(this.oProduct.ReorderQty=n.e.DoubleTryParse(this.ReorderQty.Text),this.oProduct.ReorderQtyType=n.e.IntTryParse(this.ReorderQty.SelectedValue)),null!=this.ReorderTrigger&&this.ReorderTrigger.Enable&&(this.oProduct.ReorderTrigger=n.e.DoubleTryParse(this.ReorderTrigger.Text),this.oProduct.ReorderTriggerType=n.e.IntTryParse(this.ReorderTrigger.SelectedValue)),null!=this.ShelfLife&&this.ShelfLife.Enable&&(this.oProduct.ShelfLife=n.e.DoubleTryParse(this.ShelfLife.Text)),null!=this.PreExpiryDays&&this.PreExpiryDays.Enable&&(this.oProduct.PreExpiryDays=n.e.IntTryParse(this.PreExpiryDays.Text)),null!=this.MaxTolerancePer&&this.MaxTolerancePer.Enable&&(this.oProduct.MaxTolerancePer=n.e.DoubleTryParse(this.MaxTolerancePer.Text)),null!=this.MaxToleranceVal&&this.MaxToleranceVal.Enable&&(this.oProduct.MaxToleranceVal=n.e.DoubleTryParse(this.MaxToleranceVal.Text)),null!=this.MinTolerancePer&&this.MinTolerancePer.Enable&&(this.oProduct.MinTolerancePer=n.e.DoubleTryParse(this.MinTolerancePer.Text)),null!=this.MinToleranceVal&&this.MinToleranceVal.Enable&&(this.oProduct.MinToleranceVal=n.e.DoubleTryParse(this.MinToleranceVal.Text)),null!=this.CreditDays&&this.CreditDays.Enable&&(this.oProduct.CreditDays=n.e.IntTryParse(this.CreditDays.Text)),null!=this.Packing&&this.Packing.Enable&&(this.oProduct.Packing=this.Packing.Text),null!=this.Barcode&&(this.oProduct.Barcode=this.Barcode.Text),null!=this.Category&&this.Category.Enable&&(this.oProduct.Category=this.Category.SelectedValue),null!=this.Department&&this.Department.Enable&&(this.oProduct.Department=this.Department.SelectedValue),this.Description.Enable&&(this.oProduct.Description=null!=this.Description.Tag&&""!=this.Description.Tag?this.Description.Tag:this.Description.Text),this.ProductGroups.Enable&&(this.oProduct.ProductGroup=parseInt(this.ProductGroups.SelectedValue.toString())),0==this.ProductID){if(this.ProductCode.Visible||(this.oProduct.ProductCode=this.ProductCode.DefaultValue),this.ProductName.Visible&&this.ProductName.Enable||(this.oProduct.ProductName=this.ProductName.Text.trim()),this.AliasName.Visible&&this.AliasName.Enable||(this.oProduct.AliasName=this.oProduct.AliasName=this.AliasName.DefaultValue),this.ProductTypes.Visible&&this.ProductTypes.Enable||n.e.StringIsNullOrEmpty(this.ProductTypes.DefaultValue)||(this.oProduct.ProductType=parseInt(this.ProductTypes.DefaultValue)),this.ValuationMethods.Visible&&this.ValuationMethods.Enable||n.e.StringIsNullOrEmpty(this.ValuationMethods.DefaultValue)||(this.oProduct.Valuation=parseInt(this.ValuationMethods.DefaultValue)),this.QtyAdjustment.Visible&&this.QtyAdjustment.Enable||n.e.StringIsNullOrEmpty(this.QtyAdjustment.DefaultValue)||(this.oProduct.QtyAdjustment=n.e.IntTryParse(this.QtyAdjustment.DefaultValue)),!(this.BinWise.Visible&&this.BinWise.Enable||n.e.StringIsNullOrEmpty(this.BinWise.DefaultValue))){var f=!1;null!=this.BinWise.DefaultValue&&"1"===this.BinWise.DefaultValue&&(f=!0),this.oProduct.BinWise=f}0==this.oProduct.ProductID&&(this.ProductStatuses.Visible&&this.ProductStatuses.Enable||n.e.StringIsNullOrEmpty(this.ProductStatuses.DefaultValue)||(this.oProduct.ProductStatus=parseInt(this.ProductStatuses.DefaultValue))),this.UOM.Visible&&this.UOM.Enable||n.e.StringIsNullOrEmpty(this.UOM.DefaultValue)||(this.oProduct.UOM=parseInt(this.UOM.DefaultValue)),this.SalesAccount.Visible&&this.SalesAccount.Enable||n.e.StringIsNullOrEmpty(this.SalesAccount.DefaultValue)||(this.oProduct.SalesAccount=parseInt(this.SalesAccount.DefaultValue)),this.PurchaseAccount.Visible&&this.PurchaseAccount.Enable||n.e.StringIsNullOrEmpty(this.PurchaseAccount.DefaultValue)||(this.oProduct.PurchaseAccount=parseInt(this.PurchaseAccount.DefaultValue)),this.COGSAccount.Visible&&this.COGSAccount.Enable||n.e.StringIsNullOrEmpty(this.COGSAccount.DefaultValue)||(this.oProduct.COGSAccount=parseInt(this.COGSAccount.DefaultValue)),this.ClosingStockAccount.Visible&&this.ClosingStockAccount.Enable||n.e.StringIsNullOrEmpty(this.ClosingStockAccount.DefaultValue)||(this.oProduct.ClosingStockAccount=parseInt(this.ClosingStockAccount.DefaultValue)),this.Currency.Visible&&this.Currency.Enable||n.e.StringIsNullOrEmpty(this.Currency.DefaultValue)||(this.oProduct.Currency=parseInt(this.Currency.DefaultValue)),this.PurchaseRate.Visible||(this.oProduct.PurchaseRates=0),this.PurchaseRateA.Visible||(this.oProduct.PurchaseRateA=0),this.PurchaseRateB.Visible||(this.oProduct.PurchaseRateB=0),this.PurchaseRateC.Visible||(this.oProduct.PurchaseRateC=0),this.PurchaseRateD.Visible||(this.oProduct.PurchaseRateD=0),this.PurchaseRateE.Visible||(this.oProduct.PurchaseRateE=0),this.PurchaseRateF.Visible||(this.oProduct.PurchaseRateF=0),this.PurchaseRateG.Visible||(this.oProduct.PurchaseRateG=0),this.SellingRate.Visible||(this.oProduct.SellingRates=0),this.SellingRateA.Visible||(this.oProduct.SellingRateA=0),this.SellingRateB.Visible||(this.oProduct.SellingRateB=0),this.SellingRateC.Visible||(this.oProduct.SellingRateC=0),this.SellingRateD.Visible||(this.oProduct.SellingRateD=0),this.SellingRateE.Visible||(this.oProduct.SellingRateE=0),this.SellingRateF.Visible||(this.oProduct.SellingRateF=0),this.SellingRateG.Visible||(this.oProduct.SellingRateG=0),null==this.ReorderLevel||this.ReorderLevel.Visible||(this.oProduct.ReorderLevel=0),null==this.ReorderQty||this.ReorderQty.Visible||(this.oProduct.ReorderQty=0),this.ShelfLife.Visible||(this.oProduct.ShelfLife=1),this.PreExpiryDays.Visible||(this.oProduct.PreExpiryDays=0),this.MaxToleranceVal.Visible||(this.oProduct.MaxToleranceVal=0),this.MaxTolerancePer.Visible||(this.oProduct.MaxTolerancePer=0),this.CreditDays.Visible||(this.oProduct.CreditDays=0),null==this.Packing||this.Packing.Visible||(this.oProduct.Packing=""),null==this.Category||this.Category.Visible||(this.oProduct.Category=0),this.Description.Visible||(this.oProduct.Description=""),null==this.Department||this.Department.Visible||(this.oProduct.Department=0),this.ProductGroups.Visible||(this.oProduct.ProductGroup=parseInt(this.ProductGroups.DefaultValue))}if(null!=this.ProductLength&&this.ProductLength.Enable&&(this.oProduct.ProductLength=n.e.DoubleTryParse(this.ProductLength.Text)),null!=this.ProductWidth&&this.ProductWidth.Enable&&(this.oProduct.ProductWidth=n.e.DoubleTryParse(this.ProductWidth.Text)),null!=this.ProductHeight&&this.ProductHeight.Enable&&(this.oProduct.ProductHeight=n.e.DoubleTryParse(this.ProductHeight.Text)),null!=this.ProductVolume&&this.ProductVolume.Enable&&(this.oProduct.ProductVolume=n.e.DoubleTryParse(this.ProductVolume.Text)),null!=this.ProductWeight&&this.ProductWeight.Enable&&(this.oProduct.ProductWeight=n.e.DoubleTryParse(this.ProductWeight.Text)),null!=this.ProductWastage&&this.ProductWastage.Enable&&(this.oProduct.ProductWastage=n.e.DoubleTryParse(this.ProductWastage.Text)),null!=this.KitSize&&this.KitSize.Enable&&(this.oProduct.KitSize=n.e.DoubleTryParse(this.KitSize.Text)),null!=this.SerialNumber&&this.SerialNumber.Enable&&(this.oProduct.SerialNumber=this.SerialNumber.Text),null!=this.ProductWeightable&&this.ProductWeightable.Enable&&(this.oProduct.ProductWeightable=n.e.IntTryParse(this.ProductWeightable.SelectedValue)),null!=this.ProductPacking&&this.ProductPacking.Enable&&(this.oProduct.ProductPacking=n.e.IntTryParse(this.ProductPacking.SelectedValue)),this.ProductLength.Visible||(this.oProduct.ProductLength=0),this.ProductWidth.Visible||(this.oProduct.ProductWidth=0),this.ProductHeight.Visible||(this.oProduct.ProductHeight=0),this.ProductVolume.Visible||(this.oProduct.ProductVolume=0),this.ProductWeight.Visible||(this.oProduct.ProductWeight=0),this.ProductWastage.Visible||(this.oProduct.ProductWastage=0),this.KitSize.Visible||(this.oProduct.KitSize=1),this.SerialNumber.Visible||(this.oProduct.SerialNumber=""),this.ProductWeightable.Visible&&this.ProductWeightable.Enable||(this.oProduct.ProductWeightable=n.e.IntTryParse(this.ProductWeightable.DefaultValue)),this.ProductPacking.Visible&&this.ProductPacking.Enable||(this.oProduct.ProductPacking=n.e.IntTryParse(this.ProductPacking.DefaultValue)),null!=this.ProductBillOfEntry&&this.ProductBillOfEntry.Enable&&(this.oProduct.ProductBillOfEntry=n.e.IntTryParse(this.ProductBillOfEntry.SelectedValue)),null!=this.ReorderPolicy&&this.ReorderPolicy.Enable&&(this.oProduct.ReorderPolicy=n.e.IntTryParse(this.ReorderPolicy.SelectedValue)),null!=this.MaxInventoryLevel&&this.MaxInventoryLevel.Enable&&(this.oProduct.MaxInventoryLevel=n.e.DoubleTryParse(this.MaxInventoryLevel.Text)),null!=this.ReorderMinOrderQty&&this.ReorderMinOrderQty.Enable&&(this.oProduct.ReorderMinOrderQty=n.e.DoubleTryParse(this.ReorderMinOrderQty.Text)),null!=this.ReorderMaxOrderQty&&this.ReorderMaxOrderQty.Enable&&(this.oProduct.ReorderMaxOrderQty=n.e.DoubleTryParse(this.ReorderMaxOrderQty.Text)),null!=this.ReorderOrderMultiple&&this.ReorderOrderMultiple.Enable&&(this.oProduct.ReorderOrderMultiple=n.e.DoubleTryParse(this.ReorderOrderMultiple.Text)),null!=this.PlanningMethod&&this.PlanningMethod.Enable&&(this.oProduct.PlanningMethod=n.e.IntTryParse(this.PlanningMethod.SelectedValue)),null!=this.ProcurementMethod&&this.ProcurementMethod.Enable&&(this.oProduct.ProcurementMethod=n.e.IntTryParse(this.ProcurementMethod.SelectedValue)),null!=this.LeadTime&&this.LeadTime.Enable&&(this.oProduct.LeadTime=n.e.DoubleTryParse(this.LeadTime.Text)),null!=this.SafetyStock&&this.SafetyStock.Enable&&(this.oProduct.SafetyStock=n.e.DoubleTryParse(this.SafetyStock.Text)),null!=this.ProductBOM&&this.ProductBOM.Enable&&(this.oProduct.ProductBOM=this.ProductBOM.SelectedValue),null!=this.PurchaseBinRule&&this.PurchaseBinRule.Enable&&(this.oProduct.PurchaseBinRule=n.e.IntTryParse(this.PurchaseBinRule.SelectedValue)),null!=this.SalesBinRule&&this.SalesBinRule.Enable&&(this.oProduct.SalesBinRule=n.e.IntTryParse(this.SalesBinRule.SelectedValue)),this.ProductBillOfEntry.Visible&&this.ProductBillOfEntry.Enable||(this.oProduct.ProductBillOfEntry=n.e.IntTryParse(this.ProductBillOfEntry.DefaultValue)),this.ReorderPolicy.Visible&&this.ReorderPolicy.Enable||(this.oProduct.ReorderPolicy=n.e.IntTryParse(this.ReorderPolicy.DefaultValue)),this.MaxInventoryLevel.Visible||(this.oProduct.MaxInventoryLevel=0),this.ReorderMinOrderQty.Visible||(this.oProduct.ReorderMinOrderQty=0),this.ReorderMaxOrderQty.Visible||(this.oProduct.ReorderMaxOrderQty=0),this.ReorderOrderMultiple.Visible||(this.oProduct.ReorderOrderMultiple=0),this.PlanningMethod.Visible&&this.PlanningMethod.Enable||(this.oProduct.PlanningMethod=n.e.IntTryParse(this.PlanningMethod.DefaultValue)),this.ProcurementMethod.Visible&&this.ProcurementMethod.Enable||(this.oProduct.ProcurementMethod=n.e.IntTryParse(this.ProcurementMethod.DefaultValue)),this.LeadTime.Visible||(this.oProduct.LeadTime=0),this.SafetyStock.Visible||(this.oProduct.SafetyStock=0),this.ProductBOM.Visible&&this.ProductBOM.Enable||(this.oProduct.ProductBOM=parseInt(this.ProductBOM.DefaultValue)),this.oProduct.PurchaseUom=null!=this.PurchaseUOM&&this.PurchaseUOM.Visible&&!n.e.IsEmpty(this.PurchaseUOM.SelectedValue)?this.PurchaseUOM.SelectedValue:"",this.PurchaseBinRule.Visible&&this.PurchaseBinRule.Enable||(this.oProduct.PurchaseBinRule=n.e.IntTryParse(this.PurchaseBinRule.DefaultValue)),this.SalesBinRule.Visible&&this.SalesBinRule.Enable||(this.oProduct.SalesBinRule=n.e.IntTryParse(this.SalesBinRule.DefaultValue)),this.oProduct.IsSubItemProduct=!1,this.oProduct.CustomFieldsQuery=this.ScreenObject.GetCustomFieldsQuery(),this.oProduct.CustomCostCenterFieldsQuery=this.ScreenObject.GetCustomCostCenterFieldsQuery(),this.oProduct.ContactsXML=this.ViewContacts.GetXML(),this.oProduct.NotesXML=this.ViewNotes.GetXML(),this.oProduct.SubstitutesXML=this.ViewSubstitutes.GetXML(),this.oProduct.VendorsXML=this.ViewVendors.GetXML(),this.oProduct.KitXML=this.ProductKit.GetKitXML(0,0),this.oProduct.SpecsXML=this.ProductSpecs.SpecsXML(),this.oProduct.LinkXML=null!=this.Linkedcc&&this.Linkedcc.SelectedValue>0?this.ProductLink.GetKitXML(this.Linkedcc.CCID,this.Linkedcc.SelectedValue):"",this.oProduct.HistoryXML=this.ScreenObject.HistoryCCXML,this.oProduct.StatusXML=this.StatusAssignGrid.GetXML(),this.oProduct.KitXML.length>0&&(this.oProduct.KitXML="<XML>"+this.oProduct.KitXML+"</XML>"),this.oProduct.LinkXML.length>0&&(this.oProduct.LinkXML="<XML>"+this.oProduct.LinkXML+"</XML>"),""!=this.ProductSerialization.Expires&&null!=this.ProductSerialization.Expires)return this.DisplayMessage=s.a.GetResource("Invalid")+" Warranty Expires",void(this.MessageVisibility=!0);if(this.oProduct.SerializationXML=this.ProductSerialization.GetXml(),this.oProduct.IsMatrixItem=this.ProductAttributes.IsMatrixItem,this.oProduct.MatrixID=this.ProductAttributes.SelectedValue,this.oProduct.LotWise=Object(r.j)(1==this.ProductAttributes.LSelectedValue),this.oProduct.TestcasesXML=s.a.SessionManager.Preferences.ContainsKey("TestCaseDimension")&&""!=s.a.SessionManager.Preferences.TestCaseDimension&&parseInt(s.a.SessionManager.Preferences.TestCaseDimension)>0?this.ProductTestcases.GetXml():"",!this.ViewBins.ValidateBins())return;if(""!=this.ViewBins.ValidateBinsCapacity())return this.MessageVisibility=!0,void(this.DisplayMessage=this.ViewBins.ValidateBinsCapacity());if(this.oProduct.BinXml=this.ViewBins.GetXML(),this.AssetGroup.Visible){if(0==this.AssetGroup.SelectedValue&&this.oProduct.IsGroup)return void(this.DisplayMessage="Select Asset Group");this.oProduct.AssetGroupID=this.AssetGroup.SelectedValue}this.ProductAttributes.AttributePanel&&"4"==this.ProductTypes.SelectedValue?(this.oProduct.AttributesXML=this.ProductAttributes.GetXml(),this.oProduct.AttributesData="",this.oProduct.IsSubItemProduct=!0):(this.oProduct.AttributesXML="",this.oProduct.AttributesData="",this.oProduct.IsSubItemProduct=!1);var I={strXML:""};if(this.DisplayMessage=this.ViewCCMapping.GetXML(I),T=I.strXML,!n.e.StringIsNullOrEmpty(this.DisplayMessage))return;var y="";y+="<XML>",y+=T.replace("<XML>","").replace("</XML>","");for(var V=0;V<this.ScreenObject.CustomTab.Pages.length;V++)if(this.ScreenObject.CustomTab.Pages[V].QuickViewCCID>0)for(var M=0;M<this.ScreenObject.CustomTab.Pages[V].Fields.length;M++)if(this.ScreenObject.CustomTab.Pages[V].Fields[M]instanceof g.a){var O=this.groupBy(this.ScreenObject.CustomTab.Pages[V].Fields[M].Table,(function(e){return e.Dimension_Key}));O.sort((function(e,t){return e.SNO-t.SNO}));for(var w=0;w<O.length;w++)n.e.IsEmpty(O[w].Dimension_Key)||(y+="<Row ",y+=' CostCenterId="'+this.ScreenObject.CustomTab.Pages[V].QuickViewCCID.toString()+'"',y+=' NodeID="'+O[w].Dimension_Key.toString()+'"',y+="/>")}if(y+="</XML>",this.oProduct.CCCCMapDATA=y.toString(),this.ProductAttributes.AttributePanel&&"4"==this.ProductTypes.SelectedValue){var v="",L=this.ProductAttributes.StockList;if(null!=L&&null!=L&&L.length>0){var R="";this.ScreenObject.CustomTab.Pages.forEach((function(e){e.Fields.forEach((function(e){if(e instanceof c.b&&(null!=e.DBColumnName&&e.DBColumnName.toLowerCase().Contains("ccnid")||null!=e.DBColumnName&&("accountid"==e.DBColumnName.toLowerCase()||"productid"==e.DBColumnName.toLowerCase()))){var i=e;0!=i.SelectedValue&&0==t.ProductAttributes.CCList.filter((function(e){return e.FeatureID==i.CCID})).length&&(R+=i.DBColumnName+"='"+i.SelectedValue+"',")}}))})),v+="<ItemProducts>";for(var N=0;N<L.length;N++)v+="<Row RowNo='"+(N+1)+"'   ProductName='"+l.d.GetValidXml(L[N].ItemName.toString())+"' ",v+="ProductCode='"+l.d.GetValidXml(L[N].ItemCode.toString())+"'  ",v+="AliasName='"+l.d.GetValidXml(L[N].ItemName.toString())+"'  ",v+="ProductType='"+this.oProduct.ProductType+"'  ",v+="Valuation='"+this.oProduct.Valuation+"' ",v+="ProductStatus='"+this.oProduct.ProductStatus+"' ",v+="LotWise='"+this.oProduct.LotWise+"' ",v+="UOM='"+this.oProduct.UOM+"'  ",v+="Currency='"+this.oProduct.Currency+"'  ",v+="SalesAccount='"+this.oProduct.SalesAccount+"'  ",v+="PurchaseAccount='"+this.oProduct.PurchaseAccount+"'  ",v+="COGSAccount='"+this.oProduct.COGSAccount+"'   ",v+="ClosingStockAccount='"+this.oProduct.ClosingStockAccount+"' ",v+="ProductGroup='"+this.oProduct.ProductGroup+"'  ",v+="IsGroup='0'  ",v+='CustomFieldsQuery ="'+this.oProduct.CustomFieldsQuery+'"  ',v+='CustomFieldCCMapXML="'+R+L[N].AttributeMap.toString()+'"  ',v+="ContactsXML='"+this.oProduct.ContactsXML+"'  ",v+="NotesXML='"+this.oProduct.NotesXML+"'  ",v+="AttachmetsXML='"+this.oProduct.AttachmetsXML+"'  ",v+="SubstitutesXML='"+this.oProduct.SubstitutesXML+"' ",v+="VendorsXML='"+this.oProduct.VendorsXML+"'  />";v+="</ItemProducts>",this.oProduct.ItemProductData=v.toString()}}if("4"==this.ProductTypes.SelectedValue&&n.e.StringIsNullOrEmpty(this.oProduct.ItemProductData)&&!this.ProductAttributes.IsMatrixItem)return void(this.DisplayMessage="Please select sub products");if("-399"==this.UOM.SelectedValue){var B="";if(B+="<Data>",0==this.AddEditUOM.BaseText.length)return void(this.DisplayMessage="Cannot Save Empty Unit Name");if(B+="<Row",B+=" BaseID='"+this.AddEditUOM.Units1.SelectedValue+"'  ",B+=" Conversion='"+this.AddEditUOM.RateText+"' ",B+=" BaseName='"+this.AddEditUOM.BaseText+"' /> ",B+="</Data>",this.oProduct.ProductwiseUOM1=B.toString(),null!=this.AddEditUOM.GridUnits&&this.AddEditUOM.GridUnits.length>0){var k;B="",B+="<Data>";for(var G=new Array,x=0;x<this.AddEditUOM.GridUnits.length;x++)if(!n.e.StringIsNullOrEmpty(this.AddEditUOM.GridUnits[x]["Unit Name"])){if(k=this.AddEditUOM.GridUnits[x]["Unit Name"].toString().Trim(),G.Contains(k))return void(this.DisplayMessage="Duplicate Unit Name - '"+k+"'");if(n.e.IsEmpty(this.AddEditUOM.GridUnits[x]["Conversion Rate"])||""==n.e.String(this.AddEditUOM.GridUnits[x]["Conversion Rate"]).Trim())return void(this.DisplayMessage="UOM - Conversion Rate Should not be empty - '"+k+"'");if(parseFloat(this.AddEditUOM.GridUnits[x]["Conversion Rate"])<=0)return void(this.DisplayMessage="UOM - Conversion Rate Should be Greater than 0 - '"+k+"'");G.push(k),B+='<Row UnitName="'+k+'"',B+=' UnitiD="'+n.e.String(this.AddEditUOM.GridUnits[x].UnitID)+'"',n.e.StringIsNullOrEmpty(this.AddEditUOM.GridUnits[x].PrimayColumn)?B+=' Action="NEW"':B+=' Action="UPDATE"',B+=' BaseID="'+this.AddEditUOM.Units1.SelectedValue+'"',B+=' BaseName="'+this.AddEditUOM.BaseText+'"',B+=' Conversion="'+this.AddEditUOM.RateText+'"',B+=' ConversionUnit="'+n.e.String(this.AddEditUOM.GridUnits[x]["Conversion Rate"])+'"',B+=' Barcode="'+n.e.String(this.AddEditUOM.GridUnits[x].Barcode)+'"',B+=' MultiBarcode="'+n.e.String(this.AddEditUOM.GridUnits[x].Barcodes)+'"',this.AddEditUOM.ShowBarcodeDimension&&!n.e.StringIsNullOrEmpty(this.AddEditUOM.GridUnits[x].Barcode_Key)&&(B+=' BarKey="'+this.AddEditUOM.GridUnits[x].Barcode_Key.toString()+'"'),B+="/>"}for(var A=0;A<this.AddEditUOM.lstDeletedint.length;A++)B+='<Row Action="DELETE"',B+=' UnitiD="'+this.AddEditUOM.lstDeletedint[A]+'"/>';B+="</Data>",this.oProduct.ProductwiseUOM=B.toString()}}try{this.oProduct.AttachmetsXML=this.ViewAttachments.GetXML(),this.oProduct.AttachmetsXML+=this.ScreenObject.GetExtraAttachmentXML();var E="";this.IsPhotoChanged&&!n.e.StringIsNullOrEmpty(this.ProductPhoto)?(E+=0==this.FileID?'<Row Action="NEW"':'<Row Action="MODIFY"',E+=s.a.SessionManager.IsWebApplication?' ActualFileName="'+this.ProductPhoto.substring(this.ProductPhoto.lastIndexOf("\\")+1)+'"':' ActualFileName="'+this.ActualFileName+'"',E+=' AttachmentID="'+this.FileID+'"',E+=' FilePath="'+this.ProductPhoto+'"',E+=' RelativeFileName="'+this.ProductPhoto+'"',E+=' FileExtension="'+this.FileExtension+'"',E+=' FileDescription="'+l.d.GetValidXml(this.FileDescription)+'"',E+=' IsProductImage="1"',E+=' IsDefaultImage="1"',E+=' GUID="'+this.guid+'"',n.e.StringIsNullOrEmpty(this.ThumbnailPhoto)||(E+=' HasThumb="1"'),E+="/>"):this.IsPhotoDelete&&this.FileID>0&&(E+='<Row Action="DELETE"',E+=' AttachmentID="'+this.FileID+'"/>'),E.length>0&&(E="<AttachmentsXML>"+E+"</AttachmentsXML>",this.oProduct.AttachmetsXML=this.oProduct.AttachmetsXML+E.toString())}catch(_){return this.DisplayMessage=s.a.GetResource("Upload_Path_notExists"),void(this.MessageVisibility=!0)}if(!this.ScreenObject.ValidateDataonSave())return;this.oProduct.WID=this.ScreenObject.CheckWorkFlow();var j=this.ScreenObject.Data.Tables[10].filter((function(e){return"LinkDimensionBasedOn"==e.Name}));this.oProduct.IsLink=this.ScreenObject.EvaluateExpression(j[0].Value.toString(),this.oProduct.IsGroup);var U=0;this.oProduct.AddProduct("","AddProduct").subscribe((function(e){if(t.DisplayMessage=e.Message,t.RetValue=e.RetValue,t.MessageVisibility=!0,(U=t.RetValue)>0||U<-1e4){s.a.page.tabs.forEach((function(e){e.instance instanceof he.TreeViewPageComponent&&e.instance.obj&&3==e.instance.CostCenterID&&(e.instance.obj.SetFocusNodeID=e.instance.obj.SelectedNode.Id,e.instance.Refresh())})),t.oProduct.ProductID=0,t.ProductPhoto="",t.ActualFileName="",t.ImageHeight=(parseInt(t.ImageHeight)-20).toString(),t.IsPhotoDelete=!1,t.ScreenObject.Clear(),t.ViewSubstitutes.SubstitutesObj.Clear(),t.ViewContacts.ContactsListObj.Clear(),t.ViewNotes.NotesListObj.Clear(),t.ViewAttachments.AttachmentsListObj.Clear(),t.ViewSubstitutes.SubstitutesList.Clear(),t.ViewVendors.VendorsList.Clear(),t.ViewBins.BinsObj.Clear(),t.ProductKit.KitGrid.Table.Clear(),t.ProductKit.ModGrid.Table.Clear(),t.ProductSpecs.KitGrid.Table.Clear(),t.ProductLink.KitGrid.Table.Clear(),t.ProductTestcases.TestcaseGrid.Table.Clear(),t.StatusAssignGrid.Clear(),null!=t.PriceChart&&null!=t.PriceChart.PriceGrid&&null!=t.PriceChart.PriceGrid.Table&&t.PriceChart.PriceGrid.Table.length>0&&t.PriceChart.PriceGrid.Table.Clear(),t.ViewCCMapping.Clear(),t.ViewCCMapping.OnShowCC(null),t.CCMapVisibility=!1,t.ViewAttachments.OnShowNewAttachment(null),t.HideControls(),t.ProductAttributes.Clear(),t.ProductKit.KitGrid.AddExtraEmptyRows(10),t.ProductKit.ModGrid.AddExtraEmptyRows(3),t.ProductSerialization.Expires="",t.ProductSerialization.SelectedValue=0,t.ProductSerialization.IsChecked=!0,t.ProductSerialization.ItemListObj.Clear(),t.ProductBOM.SearchVisible&&(t.ProductBOM.CustomWhere="1!=1"),t.AutoGenerateCode(),t.RefreshTitle(),t.ParentId>0&&(t.ProductGroups.SelectedValue=t.ParentId,t.ProductTypes.SelectedValue=t.oProduct.ProductType.toString()),"Assign"!=t.ScreenObject.CustomTab.SelectedTab.Name&&(t.CCMapVisibility=!1),t.InheritGrpImage&&t.OnLoadImage("Group",t.ProductGroups.SelectedValue);var i=t.ScreenObject.Data.Tables[10].filter((function(e){return"ShowCurrentSavedData"==e.Name}));i.length>0&&!n.e.IsEmpty(i[0].Value)&&Object(r.j)(i[0].Value)&&(t.oProduct.ProductID=t.RetValue,t.RefreshTitle(),t.LoadEditData())}}),(function(e){console.log("Employee Master Save : "+JSON.stringify(e))})),Logger.InfoLog("AddProductViewModel::Exiting OnSaveProduct")}catch(W){this.DisplayMessage="OnSaveProduct",Logger.ErrorLog("AddProductViewModel:: OnSaveProduct"+W.stack)}}Logger.InfoLog("OnSaveProduct :: Exiting OnSaveProduct")}},{key:"groupBy",value:function(e,t){var i=new Map,s=[];return e.forEach((function(e){var r=t(e),a=i.get(r);a?a.push(e):(i.set(r,[e]),n.e.IsEmpty(e.Dimension_Key)||s.push(e))})),s}},{key:"ValidateModifiers",value:function(){if(0==this.ProductKit.ModGrid.Table.length)return"Enter atleast one Modifier";if(0==this.ProductKit.KitGrid.Table.length)return"Select atleast one Product for the Modifier";for(var e=[],t="",i=0,s=0,n=0;n<this.ProductKit.ModGrid.Table.length;n++)if(null!=this.ProductKit.ModGrid.Table[n].ModifierName&&null!=this.ProductKit.ModGrid.Table[n].ModifierName&&""!=this.ProductKit.ModGrid.Table[n].ModifierName.toString().Trim()){if(t=this.ProductKit.ModGrid.Table[n].ModifierName.toString().trim(),i=0,0,e.Contains(t))return"Can not allow same Modifiers";if(e.push(this.ProductKit.ModGrid.Table[n].ModifierName.toString().Trim()),s++,null==this.ProductKit.ModGrid.Table[n].MinSelect||null==this.ProductKit.ModGrid.Table[n].MinSelect||""==this.ProductKit.ModGrid.Table[n].MinSelect.toString().Trim())return"Enter Min. Select for the Modifier at Row No. - "+(n+1);if(i=parseInt(this.ProductKit.ModGrid.Table[n].MinSelect),null==this.ProductKit.ModGrid.Table[n].MaxSelect||null==this.ProductKit.ModGrid.Table[n].MaxSelect||""==this.ProductKit.ModGrid.Table[n].MaxSelect.toString().Trim())return"Enter Max. Select for the Modifier at Row No. - "+(n+1);if(i>parseInt(this.ProductKit.ModGrid.Table[n].MaxSelect))return"Min. Select should be less than or equal to Max. Select for the Modifier at Row No. - "+(n+1);if(0==s)return"Enter atleast one Modifier"}s=0;for(var r=0;r<this.ProductKit.KitGrid.Table.length;r++)if(""!=this.ProductKit.KitGrid.Table[r].PRODUCT_Key.toString()&&(s++,null==this.ProductKit.KitGrid.Table[r].ModifierName||null==this.ProductKit.KitGrid.Table[r].ModifierName||""==this.ProductKit.KitGrid.Table[r].ModifierName.toString().Trim()))return"Select Modifier at Row No. - "+(r+1);return 0==s?"select atleast one Product for the Modifier":""}},{key:"OnBarcodeTextChanged",value:function(e){null!=this.Barcode.Text&&(this.ManufacturerBarcode.SelectedValue=this.Barcode.Text.trim().length>0?"1":"0")}},{key:"OnProductTypeSelectionChanged",value:function(e){Logger.InfoLog("OnProductTypeSelectionChanged:: Entering OnProductTypeSelectionChanged"),this.OnTypeChanged(),Logger.InfoLog("OnProductTypeSelectionChanged:: Exiting OnProductTypeSelectionChanged")}},{key:"OnTypeChanged",value:function(){var e=this;this.AssetGroup.Visible=!!(this.oProduct.IsGroup&&"10"==this.ProductTypes.SelectedValue||this.AssetGroupVisible&&!this.oProduct.IsGroup&&"1"==this.ProductTypes.SelectedValue),this.ProductTypes.Enable&&(this.ScreenObject.CustomTab.Pages.forEach((function(t){switch(t.Name){case"Kit":if("3"==e.ProductTypes.SelectedValue||"7"==e.ProductTypes.SelectedValue||"8"==e.ProductTypes.SelectedValue||"9"==e.ProductTypes.SelectedValue)t.Enable=!0,e.KitSize.Visible=!0,e.KitSize.Enable=!0,e.ProductKit.KitGrid.Enable=!0,e.ProductKit.ModGrid.Visible=!1,null!=(i=e.ProductKit.KitGrid.Columns.find((function(e){return"ModifierName"==e.ValueBinding})))&&(i.IsVisible=!1);else if("11"==e.ProductTypes.SelectedValue||"12"==e.ProductTypes.SelectedValue)t.Enable=!0,e.KitSize.Visible=!1,e.KitSize.Enable=!1,e.ProductKit.KitGrid.Enable=!0,e.ProductKit.ModGrid.Visible=!0,null!=(i=e.ProductKit.KitGrid.Columns.find((function(e){return"ModifierName"==e.ValueBinding})))&&(i.IsVisible=!0);else{var i;t.Enable=!1,e.KitSize.Enable=!1,e.KitSize.Visible=!0,e.ProductKit.KitGrid.Enable=!1,e.ProductKit.ModGrid.Visible=!1,null!=(i=e.ProductKit.KitGrid.Columns.find((function(e){return"ModifierName"==e.ValueBinding})))&&(i.IsVisible=!1)}for(var s=[],n=0;n<e.ProductKit.KitGrid.Columns.length;n++)s.push(e.ProductKit.KitGrid.Columns[n]);e.ProductKit.KitGrid.Columns=s;break;case"Attributes":t.Enable="4"==e.ProductTypes.SelectedValue;break;case"Serial":t.Enable="2"==e.ProductTypes.SelectedValue||"7"==e.ProductTypes.SelectedValue}})),this.oProduct.IsMatrixItem=!1),this.ScreenObject.SetViewByType(this.ProductTypes.SelectedValue,this.oProduct.IsGroup)}},{key:"OnTextChanged_string",value:function(e){null!=e&&null!=e&&(!this.NameSameasCode||this.ProductCode.PrefixVisibility||this.ProductCode.SuffixVisibility?this.NameSameasCode&&this.ProductCode.PrefixVisibility&&this.ProductCode.SuffixVisibility?this.ProductName.Text=this.ProductCode.PrefixCode+this.ProductCode.SuffixCode:this.NameSameasCode&&this.ProductCode.PrefixVisibility&&!this.ProductCode.SuffixVisibility?this.ProductName.Text=this.ProductCode.PrefixCode+this.ProductCode.Text:this.NameSameasCode&&!this.ProductCode.PrefixVisibility&&this.ProductCode.SuffixVisibility&&(this.ProductName.Text=this.ProductCode.Text+this.ProductCode.SuffixCode):this.ProductName.Text=this.ProductCode.Text)}},{key:"HideControls",value:function(){this.ContactVisibility=!1,this.NoteVisibility=!1,this.AttachmentVisibility=!1,this.SubstituteVisibility=!1,this.CCMapVisibility=!1,this.VendorVisibility=!1,this.DetailsVisibility=!1,this.UOMVisibility=!1}},{key:"OnNameLostFocus",value:function(e){if(!n.e.StringIsNullOrEmpty(this.ProductName.Text)){var t=s.a.accounting.CheckDuplicateName(3,this.ProductID,this.ProductName.Text,0,this.oProduct.IsGroup);t.length>0&&(this.DisplayMessage=t)}this.ScreenObject.onTextBoxLostFocus(e)}},{key:"OnGroupSelectionChanged",value:function(e){null!=e&&null!=e&&"Group"==e.toString()&&(this.ProductGroups.SelectedValue>0&&(this.ProductGroups.DefaultValue=this.ProductGroups.SelectedValue.toString(),this.AutoGenerateCode(),this.LoadParentData()),this.InheritGrpImage&&this.OnLoadImage("Group",this.ProductGroups.SelectedValue))}},{key:"ParentCallBack",value:function(e){null!=e.SelectedNode&&e.PickerType.startsWith("PRODUCTGROUPS")&&(this.ProductGroups.SelectedValue=e.SelectedNode.Id)}},{key:"LoadParentData",value:function(){var e=this;if(0==this.ProductID&&0!=this.ParentId&&!this.oProduct.IsGroup){var t=this.ScreenObject.Data.Tables[10].filter((function(e){return"Copygroupdatatonode"==e.Name}));if(0!=t.length&&!n.e.StringIsNullOrEmpty(t[0].Value)&&Object(r.j)(t[0].Value)){var i=this.oProduct.GetCopyProductDetails(this.ParentId);if(0!=i.Tables[0].length){var s=null,a=null,o=null;i.Tables.length>0&&i.Tables[0].length>0&&(s=i.Tables[0][0]),i.Tables.length>1&&i.Tables[1].length>0&&(a=i.Tables[1][0]),i.Tables.length>7&&i.Tables[7].length>0&&(o=i.Tables[7][0]),this.ScreenObject.FillParentData(s,a,o,["ProductCode","ProductName","ProductGroup"]),i.Tables.length>13&&(this.dtProductWise=i.Tables[13],this.LoadUnitsProductWise(i.Tables[13])),null!=this.Linkedcc&&(50006==this.Linkedcc.CCID&&this.OnlinkccChanged(this.Category),50004==this.Linkedcc.CCID&&this.OnlinkccChanged(this.Department)),(t=this.ScreenObject.Data.Tables[10].filter((function(e){return"CopyGroupTabs"==e.Name}))).length>0&&""!=t[0].Value.toString()&&function(){var s=t[0].Value.toString().split(";");if(null!=s&&s.length>0)for(var r=function(r){if((t=e.ScreenObject.Data.Tables[e.ScreenObject.Data.Tables.length-1].filter((function(e){return e.CCTabID==s[r]}))).length>0&&!n.e.StringIsNullOrEmpty(t[0].CCTabName))switch(t[0].CCTabName.toString()){case"Kit":e.ProductKit.LoadBundels(i.Tables[8]);break;case"Attributes":e.oProduct.IsMatrixItem&&e.ProductAttributes.LoadAttributes(i.Tables[0],!0);break;case"Serial":e.ProductSerialization.LoadSerialization(i.Tables[9]);break;case"Notes":i.Tables[3].length>0&&(i.Tables[3].Columns.NoteID.Expression="0",e.ViewNotes.LoadNotes(i.Tables[3]));break;case"Attachments":i.Tables[4].length>0&&(i.Tables[4].Columns.FileID.Expression="0",e.ViewAttachments.LoadAttachments(i.Tables[4]));break;case"Vendors":e.ViewVendors.LoadVendors(i.Tables[6]);break;case"Substitutes":e.ViewSubstitutes.LoadSubstitutes(i.Tables[5]);break;case"Assign":break;case"TestCases":e.ProductTestcases.LoadData(i.Tables[18]);break;case"Production Process":break;case"Link":e.ProductLink.LoadBundels(i.Tables[8]);break;case"Bins":i.Tables.length>17&&e.ViewBins.LoadBins(i.Tables[17]);break;default:parseInt(t[0].QuickViewCCID.toString())>0&&(e.LoadQuickAssign(i.Tables[11],parseInt(t[0].CCTabID.toString())),i.Tables[11].filter((function(e){return e.CostCenterId==t[0].QuickViewCCID.toString()})).forEach((function(e){i.Tables[11].Remove(e)})))}},a=0;a<s.length;a++)r(a)}()}}}}},{key:"LoadQuickAssign",value:function(e,t){for(var i=this,r=function(r){if(i.ScreenObject.CustomTab.Pages[r].DBColumnID==t)for(var a=0;a<i.ScreenObject.CustomTab.Pages[r].Fields.length;a++)i.ScreenObject.CustomTab.Pages[r].Fields[a]instanceof g.a&&function(){var t=void 0,o=i.ScreenObject.CustomTab.Pages[r].Fields[a],l=e.filter((function(e){return e.CostCenterId==i.ScreenObject.CustomTab.Pages[r].QuickViewCCID})),u="";o.Table.Clear(),l.forEach((function(e){var t=o.NewRow();t.Dimension_Key=e.NodeID,t.Dimension=e.Value,o.addRow(t),u=u+e.NodeID+","}));for(var c=0;c<15;c++)t=o.NewRow(),o.addRow(t);var d=null;i.ScreenObject.CustomTab.Pages[r].QuickViewID>0&&(d=s.a.common.GetCostCenterQuickViewSummary(i.ScreenObject.CustomTab.Pages[r].QuickViewCCID,u.TrimEnd(","),i.ScreenObject.CustomTab.Pages[r].QuickViewCCID,new Date,"",0,i.ScreenObject.CustomTab.Pages[r].QuickViewID));var h=1;o.Table.forEach((function(e){if(e.SNO=h++,!n.e.IsEmpty(e.Dimension_Key)&&null!=d&&d.Tables.length>0&&d.Tables[0].length>0&&!d.Columns[0].Contains("ErrorMessage"))for(var t=d.Tables[0].filter((function(t){return t.NodeID==e.Dimension_Key.toString()})),i=2;i<d.Columns[0].length;i++)"FileExtension"!=d.Columns[0][i]&&"FileGUID"!=d.Columns[0][i]&&(e["fld"+d.Columns[0][i]]=t[0][d.Columns[0][i]].toString())}))}()},a=0;a<this.ScreenObject.CustomTab.Pages.length;a++)r(a)}},{key:"RefreshTitle",value:function(){this.oProduct.IsGroup?(this.Title=s.a.GetResource(0==this.oProduct.ProductID?"Product_CreateGroup":"Product_EditGroup"),s.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=s.a.SessionManager.IsActionAssigned(3,"Create Group"):this.ButtonSave.Enable=s.a.SessionManager.IsActionAssigned(3,"Create Group")):0==this.oProduct.ProductID?(this.Title=s.a.GetResource("Product_NewScreenName"),s.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=s.a.SessionManager.IsActionAssigned(3,"Create"):this.ButtonSave.Enable=s.a.SessionManager.IsActionAssigned(3,"Create")):(this.Title=s.a.GetResource("Product_EditScreenName"),s.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=s.a.SessionManager.IsActionAssigned(3,"Update"):this.ButtonSave.Enable=s.a.SessionManager.IsActionAssigned(3,"Update"))}},{key:"ContactVisibility",get:function(){return this._ContactVisibility},set:function(e){e!=this._ContactVisibility&&(this._ContactVisibility=e,this._ContactVisibility?(this.DetailsVisibility=!1,this.NoteVisibility=!1,this.AttachmentVisibility=!1):this.NoteVisibility||this.AttachmentVisibility||(this.DetailsVisibility=!0))}},{key:"NoteVisibility",get:function(){return this._NoteVisibility},set:function(e){e&&this.HideControls(),this._NoteVisibility=e}},{key:"ProductID",get:function(){return this.oProduct.ProductID},set:function(e){this._ProductID=e,this.oProduct.ProductID=e}},{key:"Title",get:function(){return this._ScreenName},set:function(e){e!=this._ScreenName&&(this._ScreenName=e)}},{key:"Vendor",get:function(){return this._Vendor},set:function(e){e!=this._Vendor&&(this._Vendor=e)}}]),i}(a.b),ge=function e(t,i,s,n,r,a){_classCallCheck(this,e),this.UOMID=0,this.UnitConverstion=r,this.UnitID=t,this.UnitName=i,this.BaseID=s,this.BaseName=n,this.MapAction=a}},hIrt:function(e,t,i){"use strict";i.r(t),i.d(t,"CopyProductComponent",(function(){return h}));var s=i("vfbs"),n=i("fXoL"),r=i("3Pt+"),a=i("q8k3"),o=i("ofXK"),l=i("sYmb");function u(e,t){if(1&e&&(n.Zb(0,"div",3),n.Wc(1,"\n                "),n.Vb(2,4),n.Wc(3,"\n            "),n.Yb()),2&e){var i=n.lc();n.Db(2),n.tc("obj",i.obj.Reports)("group",i.obj.form)}}function c(e,t){if(1&e&&(n.Zb(0,"div"),n.Wc(1,"\n              "),n.Vb(2,4),n.Wc(3,"\n            "),n.Yb()),2&e){var i=n.lc().$implicit,s=n.lc();n.Ib("form-group col-xl-3  col-md-",3," col-sm-",4," col-xs-3 PACTControl"),n.Db(2),n.tc("obj",i)("group",s.obj.form)}}function d(e,t){if(1&e&&(n.Xb(0),n.Wc(1,"\n            "),n.Uc(2,c,4,6,"div",10),n.Wc(3,"\n          "),n.Wb()),2&e){var i=t.$implicit;n.Db(2),n.tc("ngIf",i.Visible)}}var h=function(){var e=function(e){_inherits(i,e);var t=_createSuper(i);function i(){return _classCallCheck(this,i),t.call(this)}return _createClass(i,[{key:"ngOnInit",value:function(){}}]),i}(s.a);return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=n.Nb({type:e,selectors:[["app-copy-product"]],features:[n.Ab],decls:34,vars:11,consts:[[1,"master-screen",3,"formGroup"],[1,"PACTHeaderFields","dialogSubBody"],[1,"row","form-row"],[1,"form-group","col-xl-6","col-md-6","col-sm-6","col-xs-6","PACTControl"],["FieldDirective","",3,"obj","group"],["class","form-group col-xl-6  col-md-6 col-sm-6 col-xs-6 PACTControl",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"Pactdailogfooter"],[1,"primary-btn-wicon",3,"click"],[1,"secondary-btn-wicon",3,"click"],[3,"class",4,"ngIf"]],template:function(e,t){1&e&&(n.Zb(0,"div",0),n.Wc(1,"\n    "),n.Zb(2,"div",1),n.Wc(3,"\n        "),n.Zb(4,"div",2),n.Wc(5,"\n            "),n.Zb(6,"div",3),n.Wc(7,"\n                "),n.Vb(8,4),n.Wc(9,"\n            "),n.Yb(),n.Wc(10,"\n            "),n.Uc(11,u,4,2,"div",5),n.Wc(12,"\n        "),n.Yb(),n.Wc(13,"\n        "),n.Zb(14,"div",2),n.Wc(15,"\n        "),n.Uc(16,d,4,1,"ng-container",6),n.Wc(17,"\n        "),n.Yb(),n.Wc(18,"\n        \n      \n  "),n.Yb(),n.Wc(19,"\n  "),n.Zb(20,"div",7),n.Wc(21,"\n    "),n.Zb(22,"div"),n.Wc(23,"\n        "),n.Zb(24,"button",8),n.hc("click",(function(){return t.obj.OnSearch("OK")})),n.Wc(25),n.mc(26,"translate"),n.Yb(),n.Wc(27,"\n        "),n.Zb(28,"button",9),n.hc("click",(function(){return t.obj.OnSearch("Cancel")})),n.Wc(29),n.mc(30,"translate"),n.Yb(),n.Wc(31,"\n    "),n.Yb(),n.Wc(32,"      \n  "),n.Yb(),n.Wc(33,"\n"),n.Yb()),2&e&&(n.tc("formGroup",t.obj.form),n.Db(8),n.tc("obj",t.obj.Product)("group",t.obj.form),n.Db(3),n.tc("ngIf",t.obj.Reports.Visible),n.Db(5),n.tc("ngForOf",t.obj.Fields),n.Db(9),n.Xc(n.nc(26,7,"Ok")),n.Db(4),n.Xc(n.nc(30,9,"Close")))},directives:[r.t,r.k,a.a,o.t,o.s],pipes:[l.d],encapsulation:2}),e}()},ybar:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var s=i("Do2H"),n=i("Lp6j"),r=i("ScVY"),a=i("ZDA+"),o=i("6z9j"),l=function(e){_inherits(i,e);var t=_createSuper(i);function i(){var e;return _classCallCheck(this,i),(e=t.apply(this,arguments)).WhereString="",e.PickerType="",e.TreeVisibility=!1,e}return _createClass(i,[{key:"Refresh",value:function(){null!=this.tree&&this.tree.length>0&&(this.tree[0].RefreshData=!0)}},{key:"GetSeqNosList",value:function(){if(null==this.SelectedNodes)return"";var e="";return this.SelectedNodes.forEach((function(t){e+=t.Id+","})),e.length>0?e=e.Remove(e.length-1,1):e+=0,e.toString()}},{key:"SearchPickerViewModel_2",value:function(e,t){this.SearchPickerViewModel(e,t,"","","")}},{key:"SearchPickerViewModel_3",value:function(e,t,i){this.SearchPickerViewModel(e,t,i,"","")}},{key:"SearchPickerViewModel_4",value:function(e,t,i,s){this.SearchPickerViewModel(e,t,i,s,"")}},{key:"SearchPickerViewModel",value:function(e,t,i,r,l){if(this.PickerType=t,this.ViewModel=e,"PRODUCTS"==t)this.TreeCCID=3,this.TreeID=20;else if("ACCOUNTS"==t)this.TreeCCID=2,this.TreeID=126;else if("CUSTOMERS"==t)this.TreeCCID=51,this.TreeID=141;else if("PACKAGE"==t)this.TreeCCID=62,this.TreeID=160;else if("REPORTS"==t)this.TreeCCID=200,this.TreeID=267;else if("DOCUMENTS"==t)this.TreeCCID=300,this.TreeID=410;else if("units"==t)this.TreeCCID=93,this.TreeID=262;else if("COSTCENTER"==t){this.TreeCCID=parseInt(i),i=r;var u=s.a.common.GetCostCenterGridViewList(this.TreeCCID,!1),c=u.Tables[0];if((c=c.filter((function(e){return 0==e.IsUserDefined}))).length>0)this.TreeID=parseInt(c[0].GridViewID);else{if(!(u.Tables[0].length>0))return void s.a.page.HideDialog();this.TreeID=parseInt(u.Tables[0][0].GridViewID)}}else if(t.startsWith("PRODUCTGROUPS")){this.TreeCCID=3;var d=t.split("~");this.TreeID=parseInt(d[1]),i="A.IsGroup=1"}var h=[];if(""!=l)for(var b=l.split(","),S=0;S<b.length;S++){if(n.e.IntTryParse(b[S])){var m=new a.a;m.Id=parseInt(b[S]),h.push(m)}}this.tree=[];var g=new o.a;g.TreeViewModel_6(this.TreeCCID,this,this.TreeID,i,h,""),g.HeaderVisiblity=!1,g.ViewsVisible=!1,this.tree.push(g),this.ViewModel=this.ViewModel,this.MessageVisibility=!1}},{key:"CommandController",value:function(e){null!=e&&"MouseDoubleClick"==e.toString()&&null!=this.SelectedNode&&(this.SelectedNode.IsGroup||(null==this.SelectedNodes?this.SelectedNodes=[]:this.SelectedNodes.Clear(),this.SelectedNodes.push(this.SelectedNode),s.a.page.HideDialog(),this.ViewModel.ParentCallBack(this)))}},{key:"OnOkClick",value:function(e){s.a.page.HideDialog(),this.ViewModel.ParentCallBack(this)}},{key:"OnCancelClick",value:function(e){s.a.page.HideDialog()}}]),i}(r.b)}}]);