(window.webpackJsonp=window.webpackJsonp||[]).push([[72],{m0Sd:function(e,t,s){"use strict";s.r(t),s.d(t,"QuickAddCostCenterViewModel",(function(){return p}));var i=s("Do2H"),n=s("eQJW"),a=s("Lp6j"),o=s("ScVY"),r=s("vTM8"),h=s("VxiT"),l=s("EQd/"),c=s("n56n"),C=s("0/4Q"),u=s("4HhE"),d=s("ru5v"),b=s("sW9y"),S=s("NkMH"),m=s("2pkr"),D=s("Upsa"),g=s("4k0m"),j=s("++IR");class p extends o.b{constructor(){super(),this.PactScreenID="0",this.ht=new r.a,this.ScreenObject=new h.a,this.Code=new l.a(0),this.Name=new l.d(0),this.Alias=new l.d(0),this.CreditDays=new l.d(0),this.CreditLimit=new l.d(0),this.DebitDays=new l.d(0),this.DebitLimit=new l.d(0),this.Status=new C.e(0),this.SalesAccount=new c.b(0),this.PurchaseAccount=new c.b(0),this.CurrencyID=new c.b(0),this.Group=new c.b(0),this.SaveCostCenter=new u.b,this.objCostCenter=new d.a,this.ScreenData=[],this.DefStatusID=1,this.ButtonSave=new S.a,this.DimLength=new l.d(0),this.DimWidth=new l.d(0),this.DimHeight=new l.d(0),this.DimVolume=new l.d(0),this.DimWeight=new l.d(0),this.lstKeyWords=[],this.RetValue=0,this.QuickAssign=new b.a}get SelectedGroup(){return this._SelectedGroup}set SelectedGroup(e){this._SelectedGroup=e,this.ParentId!=e&&(this.objCostCenter.SelectedNode=e)}QuickAddCostCenterViewModel(e,t,s,n,o){Logger.InfoLog("QuickAddCostCenterViewModel::Entering QuickAddCostCenterViewModel With ID ="+e+"CostCenterID"+t+"Parent"+this.Parent+"ScreenName"+n),this.objCostCenter.CostCenterID=t,this.CostCenterID=t,this.PactScreenID=t.toString(),this.ScreenData=this.BuildControls(),this.NodeID=e,this.ParentId=s,this.SelectedGroup=s,this.IsGroup=o,this.Title=0==this.NodeID?i.a.GetResource("Add")+" "+n:i.a.GetResource("Edit")+" "+n,this.IsGroup&&(this.Title=this.Title+" Group"),this.GetColumnDefDataset(t);let r=0;if(a.e.IsEmpty(i.a.SessionManager.Preferences["Report Template Dimension"])||"0"==i.a.SessionManager.Preferences["Report Template Dimension"].toString()||(r=parseInt(i.a.SessionManager.Preferences["Report Template Dimension"].toString())),this.DetailsVisibility=r!=t&&!this.IsGroup,a.e.String(i.a.SessionManager.Preferences.OnlineLevel1Dim)==t.toString()&&(this.DetailsVisibility=!0),50052==t){this.DisplayName=n;let e=n.lastIndexOf("-");e>=0&&(this.DisplayName=n.substr(0,e),this.ScreenObject.CGParentID=parseInt(n.substr(e+1))),this.DetailsVisibility=!1}else this.DisplayName=n;this.ScreenData=this.BuildControls(),this.DisplayMessage="",this.OnLoad(e,t),this.FillControls(),this.SaveCostCenter.Subscribe(this,"onSaveCostCenter"),Logger.InfoLog("QuickAddCostCenterViewModel::BuildControls Success")}FillKeyWords(){this.lstKeyWords.push("Basic"),this.lstKeyWords.push("Gross"),this.lstKeyWords.push("ServiceDays"),this.lstKeyWords.push("WeeklyOffs"),this.lstKeyWords.push("LeavesTaken"),this.lstKeyWords.push("TotalDays"),this.lstKeyWords.push("DaysAttended"),this.lstKeyWords.push("UnpaidDays"),this.lstKeyWords.push("LOPDays"),this.lstKeyWords.push("Holidays"),this.lstKeyWords.push("AdjDays"),this.lstKeyWords.push("EmpType"),this.lstKeyWords.push("Gender"),this.lstKeyWords.push("MaritalStatus"),this.lstKeyWords.push("Nationality"),this.lstKeyWords.push("Religion"),this.lstKeyWords.push("ChildrenCount"),this.lstKeyWords.push("ChildrenDays"),this.lstKeyWords.push("VacDaysTaken"),this.lstKeyWords.push("VacDays"),this.lstKeyWords.push("VacAmount"),this.lstKeyWords.push("VacEncashDays"),this.lstKeyWords.push("VacEncashAmount"),this.lstKeyWords.push("VacExcessDays"),this.lstKeyWords.push("VacExcessAmount"),this.lstKeyWords.push("VacNetAmount"),this.lstKeyWords.push("PayrollMonthNo"),this.lstKeyWords.push("TotCheckInLateMins"),this.lstKeyWords.push("TotCheckOutEarlyMins"),this.lstKeyWords.push("TotBreak1MoreMins"),this.lstKeyWords.push("TotBreak2MoreMins"),this.lstKeyWords.push("TotBreak3MoreMins"),this.lstKeyWords.push("TotBreak4MoreMins"),this.lstKeyWords.push("TotBreak5MoreMins"),this.lstKeyWords.push("TotLateHrsToDeduct"),this.lstKeyWords.push("TotLateLeavesToDeduct")}OnLoad(e,t){this.ButtonSave=new S.a,0==e?i.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=i.a.SessionManager.IsActionAssigned(t,"Create"):this.ButtonSave.Enable=i.a.SessionManager.IsActionAssigned(t,"Create"):(this.ScreenObject.IsEdit=!0,i.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=i.a.SessionManager.IsActionAssigned(t,"Update"):this.ButtonSave.Enable=i.a.SessionManager.IsActionAssigned(t,"Update")),this.ScreenObject.LoadQuickScreen(this,t,this.IsGroup),this.QuickAssign=new b.a,this.QuickAssign.QuickAssignGrid_1(t,this.ScreenObject.Data,this.IsGroup);let s=[];if(this.ht.ContainsKey("Name")&&(this.Name=this.ScreenObject.GetQuickText(parseInt(this.ht.Name)),null!=this.Name&&this.Name.LostFocusCommand.Subscribe(this,"OnNameLostFocus")),null!=this.ScreenObject.Data&&this.ScreenObject.Data.Tables.length>7&&this.ScreenObject.Data.Columns[7].Contains("IsParentCodeInherited")&&this.ScreenObject.Data.Tables[7].length>0){this.ScreenObject.InitAutoCode(this.ScreenObject.Data.Tables[7],this.IsGroup);var o=this.ScreenObject.StaticFields.find(e=>"GroupSeqNoLength"==e.DBColumnName);null==o||this.IsGroup||(o.Visible=!1),null!=this.Name&&(s=this.ScreenObject.Data.Tables[5].filter(e=>"CapsLock"==e.Name),s.length>0&&Object(n.j)(s[0].Value)&&(this.Name.IsAllCaps=!0),s=this.ScreenObject.Data.Tables[5].filter(e=>"CapsToFirstLetter"==e.Name),s.length>0&&Object(n.j)(s[0].Value)&&(this.Name.IsFirstLetterCaps=!0))}if(this.ht.ContainsKey("Code")&&(this.Code=this.ScreenObject.GetQuickCode(parseInt(this.ht.Code))),this.ht.ContainsKey("StatusID")&&(this.Status=this.ScreenObject.GetQuickCombo(parseInt(this.ht.StatusID)),null!=this.Status?(this.ScreenObject.Data.Tables[3].forEach(e=>{this.Status.Items.push(C.d.ComboBoxItems_2(a.e.String(e.Status),a.e.String(e.StatusID)))}),a.e.IsEmpty(this.Status.DefaultValue)?this.ScreenObject.Data.Tables[3].length>0&&(this.Status.SelectedValue=this.ScreenObject.Data.Tables[3][0].StatusID.toString()):this.Status.SelectedValue=this.Status.DefaultValue,!a.e.IsEmpty(this.Status.SelectedValue)&&this.ScreenObject.Data.Tables[3].length>0&&(this.DefStatusID=parseInt(this.ScreenObject.Data.Tables[3][0].StatusID))):this.ScreenObject.Data.Tables[3].length>0&&(this.DefStatusID=parseInt(this.ScreenObject.Data.Tables[3][0].StatusID))),this.ht.ContainsKey("IsGroup")&&(this.Group=this.ScreenObject.GetQuickField(parseInt(this.ht.IsGroup)),null!=this.Group&&(0!=this.ParentId&&0==this.NodeID&&(this.Group.SelectedValue=this.ParentId,this.Group.Enable=!1),this.Group.SelectionChangedCommand.Subscribe(this,"OnGroupSelectionChanged"))),this.ht.ContainsKey("AliasName")&&(this.Alias=this.ScreenObject.GetQuickText(parseInt(this.ht.AliasName))),this.ht.ContainsKey("SalesAccount")&&(this.SalesAccount=this.ScreenObject.GetQuickField(parseInt(this.ht.SalesAccount))),this.ht.ContainsKey("CurrencyID")&&(this.CurrencyID=this.ScreenObject.GetQuickField(parseInt(this.ht.CurrencyID))),this.ht.ContainsKey("PurchaseAccount")&&(this.PurchaseAccount=this.ScreenObject.GetQuickField(parseInt(this.ht.PurchaseAccount))),this.ht.ContainsKey("CreditDays")&&(this.CreditDays=this.ScreenObject.GetQuickField(parseInt(this.ht.CreditDays))),this.ht.ContainsKey("CreditLimit")&&(this.CreditLimit=this.ScreenObject.GetQuickField(parseInt(this.ht.CreditLimit))),this.ht.ContainsKey("DebitDays")&&(this.DebitDays=this.ScreenObject.GetQuickField(parseInt(this.ht.DebitDays))),this.ht.ContainsKey("DebitLimit")&&(this.DebitLimit=this.ScreenObject.GetQuickField(parseInt(this.ht.DebitLimit))),i.a.SessionManager.Preferences.ContainsKey("Report Template Dimension")&&""!=i.a.SessionManager.Preferences["Report Template Dimension"]&&t==parseInt(i.a.SessionManager.Preferences["Report Template Dimension"])&&"TRUE"==i.a.SessionManager.Preferences.WEFINReportTemplate.toUpperCase()){if(s=this.ScreenObject.Data.Tables[0].filter(e=>"ccAlpha44"==e.SysColumnName),s.length>0){let e=this.ScreenObject.GetQuickField(parseInt(s[0].CostCenterColID));if(null!=e){var r=e.Items.find(e=>"Show Closing"==e.Value);null!=r&&e.Items.Remove(r)}}}else if(i.a.SessionManager.Preferences.ContainsKey("PackDimension")&&""!=i.a.SessionManager.Preferences.PackDimension&&t==parseInt(i.a.SessionManager.Preferences.PackDimension)){if(s=this.ScreenObject.Data.Tables[0].filter(e=>"ccalpha46"==e.SysColumnName),s.length>0&&(this.DimLength=this.ScreenObject.GetQuickText(parseInt(s[0].CostCenterColID)),null!=this.DimLength)){this.DimLength.TextChangedCommand.Subscribe(this,"onTextValueChanged");let e=0,t=this.ScreenObject.Data.Tables[5].filter(e=>"LengthDecimals"==e.Name);null!=t&&t.length>0&&(e=a.e.IntTryParse(t[0].Value.toString())),this.DimLength.DecimalPoints=e.toString(),this.DimLength.LostFocusCommand.Subscribe(this,"onLostFocus")}if(s=this.ScreenObject.Data.Tables[0].filter(e=>"ccalpha47"==e.SysColumnName),s.length>0&&(this.DimWidth=this.ScreenObject.GetQuickText(parseInt(s[0].CostCenterColID)),null!=this.DimWidth)){this.DimWidth.TextChangedCommand.Subscribe(this,"onTextValueChanged");let e=0,t=this.ScreenObject.Data.Tables[5].filter(e=>"WidthDecimals"==e.Name);null!=t&&t.length>0&&(e=a.e.IntTryParse(t[0].Value.toString())),this.DimWidth.DecimalPoints=e.toString(),this.DimWidth.LostFocusCommand.Subscribe(this,"onLostFocus")}if(s=this.ScreenObject.Data.Tables[0].filter(e=>"ccalpha48"==e.SysColumnName),s.length>0&&(this.DimHeight=this.ScreenObject.GetQuickText(parseInt(s[0].CostCenterColID)),null!=this.DimHeight)){this.DimHeight.TextChangedCommand.Subscribe(this,"onTextValueChanged");let e=0,t=this.ScreenObject.Data.Tables[5].filter(e=>"HeightDecimals"==e.Name);null!=t&&t.length>0&&(e=a.e.IntTryParse(t[0].Value.toString())),this.DimHeight.DecimalPoints=e.toString(),this.DimHeight.LostFocusCommand.Subscribe(this,"onLostFocus")}if(s=this.ScreenObject.Data.Tables[0].filter(e=>"ccalpha49"==e.SysColumnName),s.length>0&&(this.DimVolume=this.ScreenObject.GetQuickText(parseInt(s[0].CostCenterColID)),null!=this.DimVolume)){let e=0,t=this.ScreenObject.Data.Tables[5].filter(e=>"VolumeDecimals"==e.Name);null!=t&&t.length>0&&(e=a.e.IntTryParse(t[0].Value.toString())),this.DimVolume.DecimalPoints=e.toString(),this.DimVolume.LostFocusCommand.Subscribe(this,"onLostFocus")}if(s=this.ScreenObject.Data.Tables[0].filter(e=>"ccalpha50"==e.SysColumnName),s.length>0&&(this.DimWeight=this.ScreenObject.GetQuickText(parseInt(s[0].CostCenterColID)),null!=this.DimWeight)){let e=0,t=this.ScreenObject.Data.Tables[5].filter(e=>"WeightDecimals"==e.Name);null!=t&&t.length>0&&(e=a.e.IntTryParse(t[0].Value.toString())),this.DimWeight.DecimalPoints=e.toString(),this.DimWeight.LostFocusCommand.Subscribe(this,"onLostFocus")}}if(s=this.ScreenObject.Data.Tables[5].filter(e=>"BinsDimension"==e.Name),s.length>0&&s[0].Value.toString()==t.toString()){if(s=this.ScreenObject.Data.Tables[0].filter(e=>"ccalpha47"==e.SysColumnName),s.length>0&&(this.DimLength=this.ScreenObject.GetQuickText(parseInt(s[0].CostCenterColID)),null!=this.DimLength)){this.DimLength.TextChangedCommand.Subscribe(this,"onTextValueChanged");let e=0,t=this.ScreenObject.Data.Tables[5].filter(e=>"LengthDecimals"==e.Name);null!=t&&t.length>0&&(e=a.e.IntTryParse(t[0].Value.toString())),this.DimLength.DecimalPoints=e.toString(),this.DimLength.LostFocusCommand.Subscribe(this,"onLostFocus")}if(s=this.ScreenObject.Data.Tables[0].filter(e=>"ccalpha48"==e.SysColumnName),s.length>0&&(this.DimWidth=this.ScreenObject.GetQuickText(parseInt(s[0].CostCenterColID)),null!=this.DimWidth)){this.DimWidth.TextChangedCommand.Subscribe(this,"onTextValueChanged");let e=0,t=this.ScreenObject.Data.Tables[5].filter(e=>"WidthDecimals"==e.Name);null!=t&&t.length>0&&(e=a.e.IntTryParse(t[0].Value.toString())),this.DimWidth.DecimalPoints=e.toString(),this.DimWidth.LostFocusCommand.Subscribe(this,"onLostFocus")}if(s=this.ScreenObject.Data.Tables[0].filter(e=>"ccalpha49"==e.SysColumnName),s.length>0&&(this.DimHeight=this.ScreenObject.GetQuickText(parseInt(s[0].CostCenterColID)),null!=this.DimHeight)){this.DimHeight.TextChangedCommand.Subscribe(this,"onTextValueChanged");let e=0,t=this.ScreenObject.Data.Tables[5].filter(e=>"HeightDecimals"==e.Name);null!=t&&t.length>0&&(e=a.e.IntTryParse(t[0].Value.toString())),this.DimHeight.DecimalPoints=e.toString(),this.DimHeight.LostFocusCommand.Subscribe(this,"onLostFocus")}if(s=this.ScreenObject.Data.Tables[0].filter(e=>"ccalpha50"==e.SysColumnName),s.length>0&&(this.DimVolume=this.ScreenObject.GetQuickText(parseInt(s[0].CostCenterColID)),null!=this.DimVolume)){let e=0,t=this.ScreenObject.Data.Tables[5].filter(e=>"VolumeDecimals"==e.Name);null!=t&&t.length>0&&(e=a.e.IntTryParse(t[0].Value.toString())),this.DimVolume.DecimalPoints=e.toString(),this.DimVolume.LostFocusCommand.Subscribe(this,"onLostFocus")}}}onTextValueChanged(e){let t=0,s=0,i=0;null!=this.DimLength&&(t=a.e.DoubleTryParse(this.DimLength.Text)),null!=this.DimWidth&&(s=a.e.DoubleTryParse(this.DimWidth.Text)),null!=this.DimHeight&&(i=a.e.DoubleTryParse(this.DimHeight.Text)),null!=this.DimVolume&&(this.DimVolume.Text=(t*s*i).toString())}onLostFocus(e){a.e.IsNum(e.Text)&&(e.Text=(0).ToString("N"+e.DecimalPoints)),this.ScreenObject.onTextBoxLostFocus(e)}OnGroupSelectionChanged(e){this.Group.SelectedValue>0&&(this.Group.DefaultValue=this.Group.SelectedValue.toString(),this.ParentId=this.Group.SelectedValue,this.AutoGenerateCode(),this.LoadParentData())}AutoGenerateCode(){if(0==this.NodeID&&null!=this.Code&&(this.ScreenObject.SetAutoCode(this.Code,this.IsGroup,this.ParentId,this.ScreenObject.Data.Tables[7]),this.ScreenObject.IsAutoName&&null!=this.Name)){this.ScreenObject.IsNameAutoGenerate=!0,this.Name.Enable=!1;let e=this.ScreenObject.Data.Tables[7];e=e.filter(e=>1==e.IsName),this.ScreenObject.IsName=!0,e.length>0&&(this.Name.Text=this.ScreenObject.SetAutoCodeParams_1(this.Name,this.ParentId,e))}}FillControls(){if(0!=this.NodeID){this.objCostCenter.NodeID=this.NodeID;let e=i.a.common.GetCostCenterDetails(0,this.CostCenterID,this.objCostCenter.NodeID,0);Object.assign(this.objCostCenter,e.obj),this.NodeID=this.objCostCenter.NodeID,this.QuickAssign.LoadGrid(this.objCostCenter.NodeID,e.Tables[10]),null!=this.Code&&(this.Code.Text=this.objCostCenter.Code,(this.ScreenObject.InheritParentCode||this.ScreenObject.IsAutoCode)&&(this.Code.Enable=parseInt(e.Tables[0][0].Depth)<=1&&!this.ScreenObject.IsRootAutoCode)),null!=this.Name&&this.ScreenObject.IsAutoName&&(this.Name.Enable=!1),this.ScreenObject.FillControls(e.Tables[0][0],e.Tables[0][0],e.Tables[7].length>0?e.Tables[7][0]:null,null,null,e.Tables[3]),this.ScreenObject.CanApprove(e.Tables[0][0],e.Tables[11][0],this.ButtonSave),e.Tables[7].length>0&&this.ScreenObject.LoadCustomFieldsCCData(e.Tables[7],e.Tables[13]),null!=this.ScreenObject.StatusAssignGrid&&this.ScreenObject.StatusAssignGrid.Load(e.Tables[14]),null!=this.Group&&(this.Group.SelectedValue=parseInt(e.Tables[0][0].ParentID.toString()),this.Group.Enable=!1),i.a.SessionManager.IsOffline&&this.NodeID>0&&(this.ButtonSave.Visible=!1)}else this.AutoGenerateCode(),this.LoadParentData(),this.objCostCenter.GUID=""}BuildControls(){Logger.InfoLog("QuickAddCostCenterViewModel::Entering BuildControls");try{return(new h.a).GetControls(this.PactScreenID,i.a.SessionManager.CompanyIndex)}catch(e){return Logger.ErrorLog("QuickAddCostCenterViewModel:: BuildControls"+e.stack),null}}GetColumnDefDataset(e){try{let e=this.objCostCenter.GetColumnDefination(this.PactScreenID,i.a.SessionManager.CompanyIndex);if(null!=e&&e.Tables[0].length>0)for(let t=0;t<e.Tables[0].length;t++)this.ht.ContainsKey(e.Tables[0][t].SYSCOLUMNNAME.toString())||this.ht.push(e.Tables[0][t].SYSCOLUMNNAME.toString(),e.Tables[0][t].COSTCENTERCOLID.toString())}catch(t){Logger.ErrorLog("AddCostCenterViewModel:: GetColumnDefination "+t.stack)}}onSaveCostCenter(e){if(Logger.InfoLog("QuickAddCostCenterViewModel::Entering onSaveCostCenter"),"Cancel"==e)null!=this.Parent?(this.Parent.AddEditCosCenterVisibility=!1,this.Parent.SetDetailsVisibility()):i.a.page.HideDialog();else if("Save"==e)this.SaveMethod();else if("Details"==e)i.a.page.ShowLoading=!0,setTimeout(()=>{i.a.page.HideDialog();let e=new m.AddCostCenterViewModel(this.CostCenterID);e.AddCostCenterViewModel_1(this.NodeID,this.CostCenterID,this.SelectedGroup,this.Title,this.IsGroup);let t={obj:e};e.Parent=this.Parent,null!=this.Name&&(e.Name.Text=this.Name.Text),null!=this.Code&&(e.Code.Text=this.Code.Text,e.Code.PrefixCode=this.Code.PrefixCode),e.OnGroupSelectionChanged("Group"),e.ScreenObject.CopyQuickToDetail(this.ScreenObject.StaticFields,[null!=this.Code?this.Code.DBColumnID:0,null!=this.Name?this.Name.DBColumnID:0]),i.a.page.addNewTab({title:this.Title,component:D.AddEditCostcenterComponent,params:t})},50);else if("ShowApprove"==e){let e=new g.a(this.CostCenterID,this.objCostCenter.NodeID,this.ScreenObject,this);i.a.page.ShowDialog(e,j.a,{ShowCenter:!0,Title:i.a.GetResource("ApproveReject")})}}SaveMethod(){try{this.objCostCenter.NodeID=this.NodeID,this.objCostCenter.CostCenterID=this.CostCenterID;let t,s=0;if(0==this.NodeID){this.ScreenObject.IsName=!1;let e=[];if(e=this.ScreenObject.Data.Tables[7],e=e.filter(e=>0==e.IsName),this.DisplayMessage=this.ScreenObject.SetAutoCodeParams_3(this.Code,this.ParentId,e,{StrCode:this.objCostCenter.Code,CodePrefix:this.objCostCenter.CodePrefix,CodeNumber:this.objCostCenter.CodeNumber}),this.DisplayMessage.length>0)return}else if(this.NodeID>0&&!this.Code.Enable&&!this.ScreenObject.CodeSeqExist){this.ScreenObject.IsName=!1;let e=[];if(e=this.ScreenObject.Data.Tables[7],e=e.filter(e=>0==e.IsName),this.ScreenObject.SetAutoCodeParams_3(this.Code,this.ParentId,e,{StrCode:this.objCostCenter.Code,CodePrefix:this.objCostCenter.CodePrefix,CodeNumber:this.objCostCenter.CodeNumber}),this.DisplayMessage.length>0)return}else this.objCostCenter.Code=this.Code.Text,this.Code.Code=this.Code.Text;if(this.ScreenObject.IsAutoName&&null!=this.Name&&!this.Name.Enable){this.ScreenObject.IsNameAutoGenerate=!0,this.Name.Enable=!1;let e=this.ScreenObject.Data.Tables[7];e=e.filter(e=>1==e.IsName),this.ScreenObject.IsName=!0,e.length>0&&(this.Name.Text=this.ScreenObject.SetAutoCodeParams_1(this.Name,this.ParentId,e),this.objCostCenter.Name=this.Name.Text.Trim())}if(this.DisplayMessage=this.ScreenObject.ValidateData(),this.DisplayMessage.length>0)return;if(50052==this.CostCenterID){this.FillKeyWords();for(let e=0;e<=this.lstKeyWords.length-1;e++)if(this.Name.Text.toUpperCase().Trim()==this.lstKeyWords[e].toUpperCase().toString())return void(this.DisplayMessage="Cannot save the Reserve Word");2!=this.ParentId&&3!=this.ParentId&&4!=this.ParentId&&5!=this.ParentId||(this.Name.Text=this.Name.Text.Replace(" ",""))}if(0==this.objCostCenter.NodeID){if(50002==this.CostCenterID&&i.a.SessionManager.LicenseSettings.ContainsKey("MaxLocations")){let e;e=a.e.IntTryParse(i.a.SessionManager.LicenseSettings.MaxLocations);let t=i.a.common.GetDataTable("QACCVM001","");if(e>0&&e<=parseInt(t.Rows[0][0]))return void(this.DisplayMessage="Maximum "+e.toString()+" Locations Allowed")}if(null!=this.Code){let e=this.ScreenObject.Data.Tables[7];e=e.filter(e=>0==e.IsName);let t={StrCode:this.objCostCenter.Code,CodePrefix:this.objCostCenter.CodePrefix,CodeNumber:this.objCostCenter.CodeNumber};if(this.DisplayMessage=this.ScreenObject.SetAutoCodeParams_3(this.Code,this.ParentId,e,t),this.objCostCenter.Code=t.StrCode,this.objCostCenter.CodePrefix=a.e.String(t.CodePrefix),this.objCostCenter.CodeNumber=t.CodeNumber,this.DisplayMessage.length>0)return}this.objCostCenter.Name=null!=this.Name?this.Name.Text.Trim():this.objCostCenter.Code,this.objCostCenter.AliasName=null!=this.Alias?this.Alias.Text:this.objCostCenter.Name,50052==this.CostCenterID&&null!=this.Alias&&(this.Alias.Text=""!=this.Alias.Text.Trim().toString()?this.Alias.Text:this.objCostCenter.Name,this.objCostCenter.AliasName=this.Alias.Text),this.objCostCenter.SelectedGroup=null!=this.Group?this.Group.SelectedValue:this.ParentId,this.objCostCenter.Status=null!=this.Status?a.e.IsEmpty(this.Status.SelectedValue)?this.DefStatusID:parseInt(this.Status.SelectedValue):this.DefStatusID,this.objCostCenter.SalesAccount=null!=this.SalesAccount?this.SalesAccount.SelectedValue:2,this.objCostCenter.PurchaseAccount=null!=this.PurchaseAccount?this.PurchaseAccount.SelectedValue:3,this.objCostCenter.CreditDays=null!=this.CreditDays?parseInt(this.CreditDays.Text):0,this.objCostCenter.CreditLimit=50052==this.CostCenterID?parseFloat(this.ScreenObject.CGParentID.toString().replace("00","")):null!=this.CreditLimit?parseFloat(this.CreditLimit.Text):0,this.objCostCenter.DebitDays=null!=this.DebitDays?parseInt(this.DebitDays.Text):0,this.objCostCenter.DebitLimit=null!=this.DebitLimit?parseFloat(this.DebitLimit.Text):0,this.objCostCenter.IsGroup=this.IsGroup,this.objCostCenter.SelectedNode=this.ParentId,this.objCostCenter.CustomFieldsXML="",this.objCostCenter.ContactsXML="",this.objCostCenter.NotesXML="",this.objCostCenter.AttachmetsXML=this.ScreenObject.GetExtraAttachmentXML(),this.objCostCenter.CustomFieldsQuery="",null!=this.CurrencyID&&this.CurrencyID.SelectedValue>0&&(this.objCostCenter.CustomFieldsQuery="CurrencyID='"+this.CurrencyID.SelectedValue+"',"),this.objCostCenter.CustomFieldsQuery=this.objCostCenter.CustomFieldsQuery+this.ScreenObject.GetQuickExtraFieldsQuery(),this.objCostCenter.CustomCostCenterFieldsQuery="",this.objCostCenter.CustomCostCenterFieldsQuery=this.ScreenObject.GetQuickExtraCCFieldsQuery();var e=this.ScreenObject.StaticFields.find(e=>"GroupSeqNoLength"==e.DBColumnName);let n;this.objCostCenter.GroupSeqNoLength=null!=e&&this.objCostCenter.IsGroup?parseInt(e.Text):0,this.objCostCenter.HistoryXML=this.ScreenObject.HistoryCCXML,this.objCostCenter.StatusXML=null!=this.ScreenObject.StatusAssignGrid?this.ScreenObject.StatusAssignGrid.GetXML():"";let o={};if(this.DisplayMessage=this.QuickAssign.GetXML(o),n=o.strXML,!a.e.IsEmpty(this.DisplayMessage))return;if(this.objCostCenter.CCXML=n,!this.ScreenObject.ValidateDataonSave())return;this.objCostCenter.WID=this.ScreenObject.CheckWorkFlow(),i.a.common.SaveCostCenter(this.objCostCenter,"SaveCostCenter").subscribe(e=>{t=e.Message,s=e.RetValue,this.MessageVisibility=!0,this.DisplayMessage=t,this.RetValue=s,s>0||s<-1e4?this.AfterSave():(this.MessageVisibility=!0,this.DisplayMessage=t)},e=>{alert(JSON.stringify(e)),console.log("Quick Add CostCenter Save : "+JSON.stringify(e))})}else{let e,n=this.ScreenObject.GetStaticFieldsQuery();50052==this.CostCenterID&&(this.objCostCenter.AliasName=null!=this.Alias?this.Alias.Text:this.objCostCenter.Name,null!=this.Alias&&(this.Alias.Text=""!=this.Alias.Text.Trim().toString()?this.Alias.Text:this.objCostCenter.Name,this.objCostCenter.AliasName=this.Alias.Text)),null!=this.Code&&(this.objCostCenter.Code=this.Code.Text.Trim()),this.objCostCenter.Name=null!=this.Name?this.Name.Text.Trim():this.objCostCenter.Code,this.objCostCenter.StaticFieldsQuery=n,this.objCostCenter.CustomFieldsQuery=this.ScreenObject.GetQuickExtraFieldsQuery(),this.objCostCenter.CustomCostCenterFieldsQuery=this.ScreenObject.GetQuickExtraCCFieldsQuery(),this.objCostCenter.AttachmetsXML=this.ScreenObject.GetExtraAttachmentXML(),this.objCostCenter.HistoryXML=this.ScreenObject.HistoryCCXML,this.objCostCenter.StatusXML=null!=this.ScreenObject.StatusAssignGrid?this.ScreenObject.StatusAssignGrid.GetXML():"";let o={};if(this.DisplayMessage=this.QuickAssign.GetXML(o),e=o.strXML,!a.e.IsEmpty(this.DisplayMessage))return;if(this.objCostCenter.CCXML=e,!this.ScreenObject.ValidateDataonSave())return;this.objCostCenter.WID=this.ScreenObject.CheckWorkFlow(),i.a.common.SaveCostCenterQuick(this.objCostCenter,"SaveCostCenterQuick").subscribe(e=>{t=e.Message,s=e.RetValue,this.MessageVisibility=!0,this.DisplayMessage=t,this.RetValue=s,s>0||s<-1e4?this.AfterSave():(this.MessageVisibility=!0,this.DisplayMessage=t)},e=>{alert(JSON.stringify(e)),console.log("Quick Add CostCenter Save : "+JSON.stringify(e))})}Logger.InfoLog("QuickAddAccountScreenViewModel::Exiting OnSaveCostCenter")}catch(t){Logger.ErrorLog("QuickAddAccountScreenViewModel:: onSaveCostCenter"+t.stack)}}AfterSave(){this.NodeID=0,this.QuickAssign.Clear(),this.ScreenObject.Clear(),null!=this.Code&&(this.Code.Text=""),null!=this.Group&&(this.Group.SelectedValue=this.ParentId),this.objCostCenter.NodeID=0,this.Title=i.a.GetResource("Add")+" "+this.DisplayName,this.IsGroup&&(this.Title=this.Title+" Group"),this.AutoGenerateCode(),this.LoadParentData(),null!=this.Parent?(null!=this.Parent.SelectedNode&&(this.Parent.obj.SetFocusNodeID=this.Parent.SelectedNode.Id),this.Parent.Refresh(),this.Parent.SetVisibilityFalse(),this.Parent.AddEditCosCenterVisibility=!0):i.a.page.HideDialog()}OnNameLostFocus(e){a.e.IsEmpty(this.Name.Text),this.ScreenObject.onTextBoxLostFocus(e)}LoadParentData(){if(this.ScreenObject.dsParentData=null,0!=this.NodeID||0==this.ParentId||this.objCostCenter.IsGroup)return;let e=this.ScreenObject.Data.Tables[5].filter(e=>"Copygroupdatatonode"==e.Name);0!=e.length&&""!=e[0].Value.toString()&&Object(n.j)(e[0].Value)&&(this.ScreenObject.dsParentData=i.a.common.GetCopyNodeDetails(this.objCostCenter.CostCenterID,this.ParentId),0!=this.ScreenObject.dsParentData.Tables[0].length?this.ScreenObject.FillControlsWithParent(this.ScreenObject.dsParentData.Tables[0][0],this.ScreenObject.dsParentData.Columns[0],this.ScreenObject.dsParentData.Tables[0][0],this.ScreenObject.dsParentData.Columns[0],this.ScreenObject.dsParentData.Tables[7].length>0?this.ScreenObject.dsParentData.Tables[7][0]:null,this.ScreenObject.dsParentData.Tables[7].length>0?this.ScreenObject.dsParentData.Columns[7]:null,null,null,["Code","Name","IsGroup"]):this.ScreenObject.dsParentData=null)}}}}]);