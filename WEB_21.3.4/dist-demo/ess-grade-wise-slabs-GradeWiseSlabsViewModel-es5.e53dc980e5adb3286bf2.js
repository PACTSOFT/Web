function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var a,i=_getPrototypeOf(e);if(t){var n=_getPrototypeOf(this).constructor;a=Reflect.construct(i,arguments,n)}else a=i.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[165],{"An9+":function(e,t,a){"use strict";a.r(t),a.d(t,"GradeWiseSlabsViewModel",(function(){return h}));var i=a("Do2H"),n=a("Lp6j"),l=a("ScVY"),o=a("8B8H"),s=a("n56n"),r=a("JIg3"),d=a("ockk"),u=a("0/4Q"),g=a("EQd/"),h=function(e){_inherits(a,e);var t=_createSuper(a);function a(e){var n;return _classCallCheck(this,a),(n=t.call(this)).DialogResult=!1,n.plvGrade=new s.b(0),n.dtpWEF=new r.a(0),Logger.InfoLog("GradeWiseSlabsViewModel::Entering GradeWiseSlabsViewModel()"),n.DisplayMessage="",n.plvGrade.SetTimeToZero(),n.plvGrade.OnPactListBoxValueChanged.Subscribe(_assertThisInitialized(n),"plvGrade_SelectedValueChanged"),n.dtpWEF.CustomFormat="MMM/yyyy",n.dtpWEF.Date=i.a.SessionManager.PayrollMonth,n.dtpWEF.Label="With Effect From",n.plvGrade.Label="Grade",n.plvGrade.TypeID=1,n.plvGrade.CCID=50053,n.LoadGrid(),e>0&&(n.plvGrade.SelectedValue=e,n.plvGrade_SelectedValueChanged(n.plvGrade)),Logger.InfoLog("GradeWiseSlabsViewModel::Exiting GradeWiseSlabsViewModel()"),n}return _createClass(a,[{key:"plvGrade_SelectedValueChanged",value:function(e){try{if(Logger.InfoLog("GradeWiseSlabsViewModel::Entering plvGrade_SelectedValueChanged()"),this.DisplayMessage="",this.plvGrade.SelectedValue>0){var t=this.plvGrade.SelectedValue;try{var a=i.a.empService.GetQueryData(0,"EGS001",t,"","");if(this.dgv.Clear(),null!=a&&a.length>0){var n;this.dtpWEF.Date=new Date(a[0].WEF.toString());for(var l=0;l<a.length;l++)(n=this.dgv.NewRow()).ComponentName_Key=a[l].ComponentID,n.ComponentName=a[l].ComponentName,n.MinAmount=a[l].MinAmount,n.MaxAmount=a[l].MaxAmount,n.ApplicableFormula=a[l].ApplicableFormula,n.AlertType=a[l].AlertType,this.dgv.addRow(n);this.RefreshSno()}else this.dgv.addRow(this.dgv.NewRow())}catch(o){return this.DisplayMessage=o.Message,this.MessageVisibility=!0,void Logger.ErrorLog("GradeWiseSlabsViewModel::EXCEPTION plvGrade_SelectedValueChanged()"+o.Message)}}Logger.InfoLog("GradeWiseSlabsViewModel::Exiting plvGrade_SelectedValueChanged()")}catch(o){Logger.ErrorLog("GradeWiseSlabsViewModel::EXCEPTION plvGrade_SelectedValueChanged()"+o.stack)}}},{key:"LoadGrid",value:function(){Logger.InfoLog("GradeWiseSlabsViewModel::Entering LoadGrid()"),this.dgv=new o.a,this.dgv.CanUserAddRows=!0,this.dgv.CanUserSortColumns=!1,this.dgv.Columns=[],this.dgv.Width="700";var e,t=new d.a;t.Header="#",t.DisplayMember="sno",t.ID="sno",t.Width=40,t.ReadOnly=!0,t.TextAlign="Center",this.dgv.Columns.push(t),(t=new d.a).Header="Component Name",t.DisplayMember="ComponentName",t.DataType="LISTBOX",t.CostCenterID=50052,t.FilterCondition="",t.TypeID=10,t.Width=150,this.dgv.Columns.push(t),(t=new d.a).Header="Min. Amount",t.DisplayMember="MinAmount",t.ID="MinAmount",t.Width=90,t.ReadOnly=!1,t.DataType="FLOAT",t.DefaultValue="0",this.dgv.Columns.push(t),(t=new d.a).Header="Max. Amount",t.DisplayMember="MaxAmount",t.ID="MaxAmount",t.Width=90,t.ReadOnly=!1,t.DataType="FLOAT",t.DefaultValue="0",this.dgv.Columns.push(t),(t=new d.a).Header="Applicable Formula",t.DisplayMember="ApplicableFormula",t.DataType="TextBlock",t.Width=200,this.dgv.Columns.push(t),(t=new d.a).Header="Alert Type",t.ValueBinding="AlertType",t.DataType="ComboBox",t.DisplayMember="Name",t.ValueMember="Value",t.Width=100,(e=new Array).push(u.d.ComboBoxItems_2("Stop","Stop")),e.push(u.d.ComboBoxItems_2("Warn","Warn")),t.ComboData=e,t.DefaultValue="Stop",this.dgv.Columns.push(t),this.dgv.Table=[],this.dgv.TableNewRow.Subscribe(this,"dgv_RowAdded"),this.dgv.RowDeleted.Subscribe(this,"dgv_RowDeleted"),this.dgv.TableColumns.push("sno"),this.dgv.TableColumns.push("ComponentName"),this.dgv.TableColumns.push("ComponentName_Key"),this.dgv.TableColumns.push("MinAmount"),this.dgv.TableColumns.push("MaxAmount"),this.dgv.TableColumns.push("ApplicableFormula"),this.dgv.TableColumns.push("AlertType"),this.dgv.Clear(),this.dgv.addRow(this.dgv.NewRow()),this.RefreshSno(),Logger.InfoLog("GradeWiseSlabsViewModel::Exiting LoadGrid()")}},{key:"dgv_RowAdded",value:function(e){this.RefreshSno()}},{key:"dgv_RowDeleted",value:function(e){this.RefreshSno()}},{key:"RefreshSno",value:function(){var e=this;if(this.dgv.TableColumns.Contains("sno")){var t=1;this.dgv.Table.forEach((function(a){a.sno=t,t++,e.dgv.updateRow(a)}))}}},{key:"Button_Click",value:function(e){Logger.InfoLog("GradeWiseSlabsViewModel::Entering Button_Click"),"OK"==e.toString()?this.Save_Click():"Clear"==e.toString()?(this.plvGrade.SelectedValue=0,this.Clear_Click()):"Cancel"==e.toString()&&i.a.page.HideDialog(),Logger.InfoLog("GradeWiseSlabsViewModel::Exiting Button_Click")}},{key:"Clear_Click",value:function(){this.dtpWEF.Date=new Date((new Date).getFullYear(),(new Date).getMonth(),1),this.dgv.Clear(),this.dgv.addRow(this.dgv.NewRow())}},{key:"Save_Click",value:function(){if(Logger.InfoLog("GradeWiseSlabsViewModel::Entering Save_Click"),this.ValidateSave())try{this.dgv.commitEdit();for(var e="",t=0;t<this.dgv.Table.length;t++)n.e.IsEmpty(this.dgv.Table[t].ComponentName_Key)||(e+='<Row SNo="'+t+'1"',e+=' ComponentID="'+this.dgv.Table[t].ComponentName_Key.toString()+'"',e+=' MinAmount="'+n.e.String(this.dgv.Table[t].MinAmount)+'"',e+=' MaxAmount="'+n.e.String(this.dgv.Table[t].MaxAmount)+'"',e+=' AlertType="'+n.e.String(this.dgv.Table[t].AlertType)+'"',n.e.IsEmpty(this.dgv.Table[t].ApplicableFormula)?e+=' ApplicableFormula=""':e+=' ApplicableFormula="'+g.d.GetValidXml(this.dgv.Table[t].ApplicableFormula.toString())+'"',e+="/>");if(e.length>0){e="<Rows> "+e+"</Rows>";var a=[];a.push(this.plvGrade.SelectedValue),a.push(new Date(this.dtpWEF.Date.getFullYear(),this.dtpWEF.Date.getMonth(),1)),a.push(e.toString()),a.push(i.a.SessionManager.UserName);var l=i.a.empService.ExecuteQueryPost_SP(a,"spPAY_SetGradeWiseSalarySlabs");parseInt(l.Tables[0][0][Object.keys(l.Tables[0][0])[0]])>0&&(this.DisplayMessage="Record Saved Successfully.",this.MessageVisibility=!0,this.Clear_Click())}}catch(o){return Logger.ErrorLog("GradeWiseSlabsViewModel::EXCEPTION Save_Click()"+o.stack),this.DisplayMessage=o.Message,void(this.MessageVisibility=!0)}Logger.InfoLog("GradeWiseSlabsViewModel::Exiting Save_Click")}},{key:"ValidateSave",value:function(){if(0==this.plvGrade.SelectedValue)return this.DisplayMessage="Select any Grade",this.plvGrade.SetFocus=!0,this.MessageVisibility=!0,!1;var e=0;if(this.dgv.Table.length>0){for(var t=0;t<this.dgv.Table.length;t++)if(null!=this.dgv.Table[t].ComponentName_Key&&null!=this.dgv.Table[t].ComponentName_Key){if(null==this.dgv.Table[t].MinAmount||null==this.dgv.Table[t].MinAmount)return this.DisplayMessage="Enter Min. Amount at Row No : "+(t+1),this.MessageVisibility=!0,!1;if(null==this.dgv.Table[t].MaxAmount||null==this.dgv.Table[t].MaxAmount)return this.DisplayMessage="Enter Max. Amount at Row No : "+(t+1),this.MessageVisibility=!0,!1;if(null==this.dgv.Table[t].AlertType||null==this.dgv.Table[t].AlertType)return this.DisplayMessage="Select any Alert Type at Row No : "+(t+1),this.MessageVisibility=!0,!1}for(var a=0;a<this.dgv.Table.length;a++)null!=this.dgv.Table[a].ComponentName_Key&&null!=this.dgv.Table[a].ComponentName_Key&&""!=this.dgv.Table[a].ComponentName_Key.toString().Trim()&&null!=this.dgv.Table[a].MinAmount&&null!=this.dgv.Table[a].MinAmount&&""!=this.dgv.Table[a].MinAmount.toString().Trim()&&null!=this.dgv.Table[a].MaxAmount&&null!=this.dgv.Table[a].MaxAmount&&""!=this.dgv.Table[a].MaxAmount.toString().Trim()&&null!=this.dgv.Table[a].AlertType&&null!=this.dgv.Table[a].AlertType&&""!=this.dgv.Table[a].AlertType.toString().Trim()&&e++;if(0==e)return this.DisplayMessage="Enter atleast one detail",this.MessageVisibility=!0,!1}return!0}}]),a}(l.b)}}]);