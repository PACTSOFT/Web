(window.webpackJsonp=window.webpackJsonp||[]).push([[166],{oCNg:function(e,t,s){"use strict";s.r(t),s.d(t,"PayrollCommonPopUpViewModel",(function(){return n}));var a=s("Do2H"),i=s("Lp6j"),o=s("ScVY"),l=s("8B8H"),r=s("ockk");class n extends o.b{constructor(e){if(super(),this.DialogResult=!1,this.Title="",this.DocHistoryVisibility=!1,this.HistoryVisibility=!1,this.TableObj=new l.a,this.DisplayMessage="",this.Parent=e[0],"MonthlyPayrollViewModel"==this.Parent.className&&(this.Parent.Opacity=.3),"100"==e[1].toString()){this.DocHistoryVisibility=!0,this.Title="Document History";let t=e[2].toString(),s=e[3].toString();this.LoadGrid(100);let o=this.GetDocumentHistory(parseInt(t),parseInt(s));if(null!=o&&o.Tables.length>0&&o.Columns[0].Contains("ModifiedBy")){let e=0;for(let s=0;s<o.Tables[0].length;s++){let t=this.dgv.NewRow();t.ModifiedBy=o.Tables[0][s].ModifiedBy.toString(),i.e.IsEmpty(o.Tables[0][s].ModifiedDate)||(t.ModifiedDate=new Date(o.Tables[0][s].ModifiedDate.toString()).ToString(a.a.SessionManager.Preferences["Date Format"]+" hh:mm:ss tt")),i.e.IsEmpty(o.Tables[0][s].maxid)||(e<parseInt(o.Tables[0][s].maxid.toString())&&(e=parseInt(o.Tables[0][s].maxid.toString())),t.maxid=o.Tables[0][s].maxid.toString()),this.dgv.addRow(t)}let t=this.dgv.Table.filter(t=>t.maxid==e.toString());t.length>0&&(t[0].IsCurrent="YES")}}else if("101"==e[1].toString()){let t;this.HistoryVisibility=!0,this.Title="History",this.ColSource=[],t=new r.a,t.DataType="TextBlock",t.Header="User",t.DisplayMember="CreatedBy",t.Width=90,this.ColSource.push(t),t=new r.a,t.DataType="TextBlock",t.Header="FirstName",t.DisplayMember="FirstName",t.Width=90,this.ColSource.push(t),t=new r.a,t.DataType="TextBlock",t.Header="LastName",t.DisplayMember="LastName",t.Width=90,this.ColSource.push(t),t=new r.a,t.DataType="TextBlock",t.Header=a.a.GetResource("Date"),t.DisplayMember="AppDate",t.Width=128,this.ColSource.push(t),t=new r.a,t.DataType="LINK",t.Header="Level",t.DisplayMember="LevelName",t.Width=93,this.ColSource.push(t),t=new r.a,t.DataType="TextBlock",t.Header="Status",t.DisplayMember="Status",t.Width=80,this.ColSource.push(t),t=new r.a,t.DataType="Format",t.Header="Remarks",t.DisplayMember="Remarks",t.Width=190,this.ColSource.push(t);let s=e[2].toString(),o=e[3].toString(),l=this.GetDocStatusHistory(parseInt(s),parseInt(o),!0);if(null!=l&&l.Tables.length>0){this.TableObj.Table=l.Tables[0],this.TableObj.TableColumns.push("AppDate");for(let s=0;s<this.Table.length;s++)i.e.IsEmpty(this.Table[s].Date)||(this.Table[s].AppDate=new Date(this.Table[s].Date.toString()).ToString(a.a.SessionManager.Preferences["Date Format"]+" hh:mm a"));let e=0,t=0;this.Table.length>0&&(e=i.e.Int(this.Table[this.Table.length-1].WorkFlowLevel),t=i.e.Int(this.Table[this.Table.length-1].StatusID)),369!=t&&(l.Tables[1]=l.Tables[1].filter(t=>t.levelID>e),l.Tables[1].forEach(e=>{let t=this.TableObj.NewRow();t.LevelName=e.LevelName,t.Status="Pending",t.WorkFlowLevel=e.LevelID,this.TableObj.addRow(t)}));for(let s=this.Table.length;s<7;s++)this.TableObj.addEmptyRow()}}}get Table(){return this.TableObj.Table}get ColSource(){return this.TableObj.Columns}set ColSource(e){this.TableObj.Columns=e}LoadGrid(e){if(Logger.InfoLog("PayrollCommonPopUpViewModel::Entering LoadGrid()"),100==e){let e;this.dgv=new l.a,this.dgv.Columns=[],this.dgv.Width="",e=new r.a,e.Header="User",e.DisplayMember="ModifiedBy",e.ID="ModifiedBy",e.Width=120,e.ReadOnly=!0,this.dgv.Columns.push(e),e=new r.a,e.Header="Date",e.DisplayMember="ModifiedDate",e.ID="ModifiedDate",e.Width=150,e.ReadOnly=!0,this.dgv.Columns.push(e),e=new r.a,e.Header="Version",e.DisplayMember="VersionNo",e.ID="VersionNo",e.Width=100,e.IsVisible=!1,this.dgv.Columns.push(e),e=new r.a,e.Header="Reason",e.DisplayMember="ReviseReason",e.ID="ReviseReason",e.Width=100,e.IsVisible=!1,this.dgv.Columns.push(e),this.dgv.Clear(),this.dgv.TableColumns.push("ModifiedBy"),this.dgv.TableColumns.push("ModifiedDate"),this.dgv.TableColumns.push("MaxID"),this.dgv.TableColumns.push("IsCurrent"),this.dgv.TableColumns.push("VersionNo"),this.dgv.TableColumns.push("ReviseReason")}Logger.InfoLog("PayrollCommonPopUpViewModel::Exiting LoadGrid()")}GetDocumentHistory(e,t){let s=[];return s.push(e),s.push(t),s.push(a.a.SessionManager.UserID),s.push(a.a.SessionManager.RoleID),s.push(a.a.SessionManager.UserName),s.push(a.a.SessionManager.LanguageID),a.a.document.GetDocumentHistory(s)}GetDocStatusHistory(e,t,s){Logger.InfoLog("PayrollCommonPopUpViewModel:: Inside GetDocStatusHistory");let i=[];i.push(e),i.push(t),i.push(s),i.push(a.a.SessionManager.UserID),i.push(a.a.SessionManager.LanguageID);let o=a.a.document.GetDocStatusHistory(i);return Logger.InfoLog("PayrollCommonPopUpViewModel:: Exiting GetDocStatusHistory"),o}Button_Click(e){"Cancel"==e.toString()&&(null!=this.Parent&&"MonthlyPayrollViewModel"==this.Parent.className&&(this.Parent.Opacity=1,this.Parent.DialogResult=!1),this.DialogResult=!1),a.a.page.HideDialog()}}}}]);