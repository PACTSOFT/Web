function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var n,a=_getPrototypeOf(e);if(t){var s=_getPrototypeOf(this).constructor;n=Reflect.construct(a,arguments,s)}else n=a.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[10,73,214],{"/EUh":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n("Do2H"),s=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"GetEmailSMS",value:function(e,t,n){try{var s=[];return s.push(e),s.push(t),s.push(n),s.push(a.a.SessionManager.RoleID),s.push(a.a.SessionManager.UserID),s.push(a.a.SessionManager.LanguageID),a.a.report.GetEmailSMS(s)}catch(o){return Logger.ErrorLog("Notifications:: GetEmailSMS"+o),null}}},{key:"GetScheduleEvents",value:function(e){var t=[];return t.push(e),t.push(a.a.SessionManager.RoleID),t.push(a.a.SessionManager.UserID),t.push(a.a.SessionManager.LanguageID),a.a.report.GetScheduleEvents(t)}},{key:"SetNotifEventTemp",value:function(e){return e.push(a.a.SessionManager.CompanyGUID),e.push("GUID"),e.push(a.a.SessionManager.UserName),e.push(a.a.SessionManager.UserID),e.push(a.a.SessionManager.LanguageID),a.a.report.SetNotifEventTemp(e)}}]),e}()},"5FTv":function(e,t,n){"use strict";n.r(t),n.d(t,"VoucherExportExcel",(function(){return s}));var a=n("Do2H"),s=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"GetPrintLayouts",value:function(e,t){var n=[];return n.push(e),n.push(t),n.push(0),n.push(parseInt(a.a.SessionManager.RoleID)),n.push(parseInt(a.a.SessionManager.UserID)),n.push(a.a.SessionManager.LanguageID),a.a.report.GetPrintLayout(n)}},{key:"GetPrintLayouts_1",value:function(e,t,n){var s=[];return s.push(e),s.push(t),s.push(n),s.push(null),s.push(a.a.SessionManager.RoleID),s.push(a.a.SessionManager.UserID),s.push(a.a.SessionManager.LanguageID),a.a.report.GetPrintLayouts(s)}},{key:"GetLocationPrintLayouts",value:function(e,t,n){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=[];return o.push(s),o.push(e),o.push(t),o.push(a.a.SessionManager.LocationID),o.push(a.a.SessionManager.RoleID),o.push(a.a.SessionManager.UserID),o.push(n),o.push(a.a.SessionManager.LanguageID),a.a.report.GetPrintLayouts(o)}},{key:"GetLayoutTemplates",value:function(e,t,n){var s=[];return s.push(2),s.push(t),s.push(n),s.push(e),s.push(a.a.SessionManager.RoleID),s.push(a.a.SessionManager.UserID),s.push(a.a.SessionManager.LanguageID),a.a.report.GetPrintLayouts(s)}},{key:"AllowRePrint",value:function(e,t,n){var s=[];return s.push(3),s.push(e),s.push(t),s.push(n),s.push(a.a.SessionManager.RoleID),s.push(a.a.SessionManager.UserID),s.push(a.a.SessionManager.LanguageID),a.a.report.GetPrintLayouts(s)}}]),e}()},"7i9q":function(e,t,n){"use strict";n.r(t),n.d(t,"SendEmailSMSComponent",(function(){return C}));var a=n("3Pt+"),s=n("fXoL");function o(e,t){if(1&e&&(s.Zb(0,"div",12),s.Wc(1,"\n                "),s.Vb(2,13),s.Wc(3,"\n            "),s.Yb()),2&e){var n=s.lc();s.Db(2),s.tc("obj",n.obj.Template)("group",n.form)}}function i(e,t){if(1&e&&(s.Zb(0,"div",12),s.Wc(1,"\n                "),s.Vb(2,13),s.Wc(3,"\n            "),s.Yb()),2&e){var n=s.lc();s.Db(2),s.tc("obj",n.obj.Location)("group",n.form)}}function r(e,t){if(1&e&&(s.Zb(0,"div",12),s.Wc(1,"\n                "),s.Vb(2,13),s.Wc(3,"\n            "),s.Yb()),2&e){var n=s.lc();s.Db(2),s.tc("obj",n.obj.Report)("group",n.form)}}function c(e,t){if(1&e&&(s.Zb(0,"div",14),s.Wc(1,"\n                "),s.Vb(2,13),s.Wc(3,"\n            "),s.Yb()),2&e){var n=s.lc();s.Db(2),s.tc("obj",n.obj.To)("group",n.form)}}function l(e,t){if(1&e&&(s.Zb(0,"div",14),s.Wc(1,"\n                "),s.Vb(2,13),s.Wc(3,"\n            "),s.Yb()),2&e){var n=s.lc();s.Db(2),s.tc("obj",n.obj.CC)("group",n.form)}}function u(e,t){if(1&e&&(s.Zb(0,"div",14),s.Wc(1,"\n                "),s.Vb(2,13),s.Wc(3,"\n            "),s.Yb()),2&e){var n=s.lc();s.Db(2),s.tc("obj",n.obj.BCC)("group",n.form)}}function m(e,t){if(1&e&&(s.Zb(0,"div",14),s.Wc(1,"\n                "),s.Vb(2,13),s.Wc(3,"\n            "),s.Yb()),2&e){var n=s.lc();s.Db(2),s.tc("obj",n.obj.Subject)("group",n.form)}}function h(e,t){if(1&e&&(s.Zb(0,"div",12),s.Wc(1,"\n                "),s.Vb(2,13),s.Wc(3,"\n            "),s.Yb()),2&e){var n=s.lc();s.Db(2),s.tc("obj",n.obj.AttachmentType)("group",n.form)}}function p(e,t){if(1&e&&(s.Zb(0,"div",12),s.Wc(1,"\n                "),s.Vb(2,13),s.Wc(3,"\n            "),s.Yb()),2&e){var n=s.lc();s.Db(2),s.tc("obj",n.obj.SendReportAs)("group",n.form)}}function b(e,t){if(1&e&&(s.Zb(0,"div",12),s.Wc(1,"\n                "),s.Vb(2,13),s.Wc(3,"\n            "),s.Yb()),2&e){var n=s.lc();s.Db(2),s.tc("obj",n.obj.Attachments)("group",n.form)}}function d(e,t){if(1&e&&(s.Zb(0,"div"),s.Wc(1,"\n                "),s.Vb(2,13),s.Wc(3,"\n            "),s.Yb()),2&e){var n=t.$implicit,a=s.lc();s.Db(2),s.tc("obj",n)("group",a.form)}}var f=function(){return{height:"300px"}};function g(e,t){if(1&e){var n=s.ac();s.Zb(0,"div",2),s.Wc(1,"\n            "),s.Zb(2,"div",14),s.Wc(3,"\n                "),s.Zb(4,"quill-editor",15,16),s.hc("ngModelChange",(function(e){return s.Ic(n),s.lc().obj.BodyDocument=e})),s.Yb(),s.Wc(6,"\n            "),s.Yb(),s.Wc(7,"\n        "),s.Yb()}if(2&e){var a=s.lc();s.Db(4),s.tc("styles",s.xc(2,f))("ngModel",a.obj.BodyDocument)}}function S(e,t){if(1&e&&(s.Zb(0,"div",2),s.Wc(1,"\n            "),s.Zb(2,"div",14),s.Wc(3,"\n                "),s.Vb(4,13),s.Wc(5,"\n            "),s.Yb(),s.Wc(6,"\n        "),s.Yb()),2&e){var n=s.lc();s.Db(4),s.tc("obj",n.obj.SMSBody)("group",n.form)}}var C=function(){var e=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){this.form=new a.j({})}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Nb({type:e,selectors:[["app-send-email-sms"]],inputs:{obj:"obj"},decls:70,vars:21,consts:[[1,"master-screen",2,"padding-bottom","4px"],[1,"PACTHeaderFields","dialogSubBody"],[1,"row","form-row"],["class","form-group col-xl-6 col-md-6 col-sm-12 col-xs-12 PACTControl",4,"ngIf"],["class","form-group col-xl-12 col-md-12 col-sm-12 col-xs-12 PACTControl",4,"ngIf"],[4,"ngFor","ngForOf"],["class","row form-row",4,"ngIf"],[1,"Pactdailogfooter"],[1,"primary-btn-wicon",3,"click"],[1,"fa-envelope","fa-light"],[1,"secondary-btn-wicon",3,"click"],[1,"fa-light","fa-rectangle-xmark"],[1,"form-group","col-xl-6","col-md-6","col-sm-12","col-xs-12","PACTControl"],["FieldDirective","",3,"obj","group"],[1,"form-group","col-xl-12","col-md-12","col-sm-12","col-xs-12","PACTControl"],[3,"styles","ngModel","ngModelChange"],["editor",""]],template:function(e,t){1&e&&(s.Zb(0,"div",0),s.Wc(1,"\n    "),s.Zb(2,"div",1),s.Wc(3,"\n        "),s.Zb(4,"div",2),s.Wc(5,"\n            "),s.Uc(6,o,4,2,"div",3),s.Wc(7,"\n            "),s.Uc(8,i,4,2,"div",3),s.Wc(9,"\n            \n            "),s.Uc(10,r,4,2,"div",3),s.Wc(11,"\n        "),s.Yb(),s.Wc(12,"\n\n        "),s.Zb(13,"div",2),s.Wc(14,"\n            "),s.Uc(15,c,4,2,"div",4),s.Wc(16,"\n        "),s.Yb(),s.Wc(17,"\n\n        "),s.Zb(18,"div",2),s.Wc(19,"\n            "),s.Uc(20,l,4,2,"div",4),s.Wc(21,"\n        "),s.Yb(),s.Wc(22,"\n\n        "),s.Zb(23,"div",2),s.Wc(24,"\n            "),s.Uc(25,u,4,2,"div",4),s.Wc(26,"\n        "),s.Yb(),s.Wc(27,"\n\n        \n        "),s.Zb(28,"div",2),s.Wc(29,"\n            "),s.Uc(30,m,4,2,"div",4),s.Wc(31,"\n        "),s.Yb(),s.Wc(32,"\n\n        "),s.Zb(33,"div",2),s.Wc(34,"\n            "),s.Uc(35,h,4,2,"div",3),s.Wc(36,"\n            "),s.Uc(37,p,4,2,"div",3),s.Wc(38,"\n            \n            "),s.Uc(39,b,4,2,"div",3),s.Wc(40,"            \n        "),s.Yb(),s.Wc(41,"\n\n        "),s.Zb(42,"div"),s.Wc(43,"\n            "),s.Uc(44,d,4,2,"div",5),s.Wc(45,"\n        "),s.Yb(),s.Wc(46,"\n\n        "),s.Uc(47,g,8,3,"div",6),s.Wc(48,"\n        \n        "),s.Uc(49,S,7,2,"div",6),s.Wc(50,"\n    "),s.Yb(),s.Wc(51,"\n    "),s.Zb(52,"div",7),s.Wc(53,"\n      "),s.Zb(54,"div"),s.Wc(55,"\n        "),s.Wc(56,"\n        "),s.Zb(57,"button",8),s.hc("click",(function(){return t.obj.OnButtonClick("Send")})),s.Ub(58,"i",9),s.Wc(59),s.mc(60,"translate"),s.Yb(),s.Wc(61,"\n        "),s.Zb(62,"button",10),s.hc("click",(function(){return t.obj.OnButtonClick("Cancel")})),s.Ub(63,"i",11),s.Wc(64),s.mc(65,"translate"),s.Yb(),s.Wc(66,"\n      "),s.Yb(),s.Wc(67,"\n  "),s.Yb(),s.Wc(68,"\n"),s.Yb(),s.Wc(69,"\n")),2&e&&(s.Sc("width",t.obj.IsMobile?"unset":"900px"),s.Db(6),s.tc("ngIf",t.obj.Template.Visible),s.Db(2),s.tc("ngIf",t.obj.Location.Visible),s.Db(2),s.tc("ngIf",t.obj.ReportVisible),s.Db(5),s.tc("ngIf",t.obj.To.Visible),s.Db(5),s.tc("ngIf",t.obj.CC.Visible),s.Db(5),s.tc("ngIf",t.obj.BCC.Visible),s.Db(5),s.tc("ngIf",t.obj.Subject.Visible),s.Db(5),s.tc("ngIf",t.obj.AttachmentType.Visible),s.Db(2),s.tc("ngIf",t.obj.SendReportAs.Visible),s.Db(2),s.tc("ngIf",t.obj.Attachments.Visible),s.Db(5),s.tc("ngForOf",t.obj.AttachmentList.Items),s.Db(3),s.tc("ngIf",t.obj.IsEmail),s.Db(2),s.tc("ngIf",t.obj.SMSBody.Visible),s.Db(10),s.Xc(s.nc(60,17,"Send")),s.Db(5),s.Xc(s.nc(65,19,"Cancel")))},encapsulation:2}),e}()},MQtK:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n("fXoL"),s=function(){var e=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=a.Nb({type:e,selectors:[["app-email-add-attachment"]],inputs:{obj:"obj"},decls:29,vars:7,consts:[[1,"master-screen",2,"padding-bottom","4px"],[1,"PACTHeaderFields","dialogSubBody"],[1,"row","form-row"],[1,"form-group","col-xl-12","col-md-12","col-sm-12","col-xs-12","PACTControl"],["FieldDirective","",3,"obj"],[1,"Pactdailogfooter"],[1,"primary-btn-wicon",3,"click"],[1,"secondary-btn-wicon",3,"click"],[1,"fa-light","fa-rectangle-xmark"]],template:function(e,t){1&e&&(a.Zb(0,"div",0),a.Wc(1,"\n    "),a.Zb(2,"div",1),a.Wc(3,"\n        "),a.Zb(4,"div",2),a.Wc(5,"\n            "),a.Zb(6,"div",3),a.Wc(7,"\n                "),a.Vb(8,4),a.Wc(9,"\n            "),a.Yb(),a.Wc(10,"\n        "),a.Yb(),a.Wc(11,"\n    "),a.Yb(),a.Wc(12,"\n    "),a.Zb(13,"div",5),a.Wc(14,"\n      "),a.Zb(15,"div"),a.Wc(16,"\n        "),a.Zb(17,"button",6),a.hc("click",(function(){return t.obj.OnButtonClick("OK")})),a.Wc(18),a.mc(19,"translate"),a.Yb(),a.Wc(20,"\n        "),a.Zb(21,"button",7),a.hc("click",(function(){return t.obj.OnButtonClick("Cancel")})),a.Ub(22,"i",8),a.Wc(23),a.mc(24,"translate"),a.Yb(),a.Wc(25,"\n      "),a.Yb(),a.Wc(26,"\n  "),a.Yb(),a.Wc(27,"\n"),a.Yb(),a.Wc(28,"\n")),2&e&&(a.Db(8),a.tc("obj",t.obj.Attachments),a.Db(10),a.Xc(a.nc(19,3,"Com_OK")),a.Db(5),a.Xc(a.nc(24,5,"Cancel")))},encapsulation:2}),e}()},wnwj:function(e,t,n){"use strict";n.r(t),n.d(t,"SendEmailSMSViewModel",(function(){return f})),n.d(t,"EmailAddAttachmentViewModel",(function(){return g}));var a=n("mrSG"),s=n("Do2H"),o=n("Lp6j"),i=n("eQJW"),r=n("ScVY"),c=n("EQd/"),l=n("0/4Q"),u=n("c9yc"),m=n("wlFP"),h=n("5FTv"),p=n("/EUh"),b=n("4HhE"),d=n("MQtK"),f=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,a,r,d){var f;if(_classCallCheck(this,n),(f=t.call(this)).retValue=0,f.To=new c.d(0),f.CC=new c.d(0),f.BCC=new c.d(0),f.AttachmentType=new l.e(0),f.Attachments=new l.e(0),f.Subject=new c.d(0),f.SMSBody=new c.c(0),f.SendReportAs=new l.e(0),f.IsEmail=!1,f.CostCenterID=0,f.NodeID=0,f.Parent=null,f.drTemplate=null,f.drTemplateColumns=null,f.ReportVisible=!1,f.EmailDisplayName="",Logger.InfoLog("SendEmailSMSViewModel::Entering Construcor"),f.IsEmail=e,f.CostCenterID=a,f.NodeID=r,f.Parent=d,f.Attachments.Label=s.a.GetResource("Com_Attachments"),f.SendReportAs.Visible=!1,f.IsWhatsApp=new m.a,f.IsWhatsApp.Label="WhatsApp",f.Template=new l.e,f.Template.Label="Template",f.AttachmentList=new u.a,f.To.Label=s.a.GetResource("Format_To"),f.CC.Label=s.a.GetResource("Vehicle_CC"),f.BCC.Label=s.a.GetResource("Format_BCC"),f.Subject.Label=s.a.GetResource("Format_Subject"),f.To.LblWidth=f.CC.LblWidth=f.BCC.LblWidth=f.Subject.LblWidth=f.SMSBody.LblWidth="150",f.AttachmentType.LblWidth=f.SendReportAs.LblWidth=f.Attachments.LblWidth=f.Template.LblWidth="150",f.Attachments.LblClick=new b.b,f.Attachments.LblClick.Subscribe(_assertThisInitialized(f),"OnButtonClick","AddAttachment"),f.To.LblClick=new b.b,f.To.LblClick.Subscribe(_assertThisInitialized(f),"OnButtonClick","ToClick"),50==a){f.Report=d,f.Template.Visible=!0,f.Template.SelectionChangedCommand.Subscribe(_assertThisInitialized(f),"OnTemplateChange"),f.SendReportAs.SelectionChangedCommand.Subscribe(_assertThisInitialized(f),"OnSendReportAsChange"),f.SendReportAs.Visible=!0,f.SendReportAs.Label="Send Report",f.SendReportAs.Items.push(l.d.ComboBoxItems_2("Whole","0")),f.SendReportAs.Items.push(l.d.ComboBoxItems_2("Line Wise","1")),f.SendReportAs.Items.push(l.d.ComboBoxItems_2("Group Wise","2")),f.SendReportAs.Items.push(l.d.ComboBoxItems_2("Level Wise","3")),f.SendReportAs.Items.push(l.d.ComboBoxItems_2("Selected Rows","4")),f.SendReportAs.SelectedValue="0";var g=p.a.GetEmailSMS(7,a,'<XML Type="'+(e?"1":"2")+'" ReportID="'+r+'"/>');e&&f.Template.Items.push(l.d.ComboBoxItems_2("","")),g.Tables[0].forEach((function(e){f.Template.Items.push(l.d.ComboBoxItems_2(e.TemplateName.toString(),e.TemplateID.toString()))})),f.Template.Items.length>0&&(f.Template.SelectedValue=f.Template.Items[0].Value,f.OnTemplateChange(null))}else if(a>0){f.Template.Visible=!0,f.Template.SelectionChangedCommand.Subscribe(_assertThisInitialized(f),"OnTemplateChange");var S=p.a.GetEmailSMS(6,a,e?"1":"2");f.Template.Items.push(l.d.ComboBoxItems_2("","")),S.Tables[0].forEach((function(e){f.Template.Items.push(l.d.ComboBoxItems_2(e.TemplateName.toString(),e.TemplateID.toString()))}))}if(e?(f.SMSBody.Visible=!1,f.IsWhatsApp.Visible=!1):(f.CC.Visible=!1,f.BCC.Visible=!1,f.Subject.Visible=!1,f.AttachmentType.Visible=!1,f.Attachments.Visible=!1,f.SMSBody.Visible=!0,f.SMSBody.Label="Message",s.a.SessionManager.Preferences.ContainsKey("WhProvider")&&""!=s.a.SessionManager.Preferences.WhProvider||(f.IsWhatsApp.Visible=!1)),f.AttachmentType.Label=s.a.GetResource("Com_AttachmentType"),f.AttachmentType.Items.push(l.d.ComboBoxItems_2("","")),f.AttachmentType.Items.push(l.d.ComboBoxItems_2("PDF","PDF")),f.AttachmentType.Items.push(l.d.ComboBoxItems_2("Excel","Excel")),50==a&&f.AttachmentType.Items.push(l.d.ComboBoxItems_2("Excel (Open XML)","Excel(Open XML)")),f.AttachmentType.SelectedValue="PDF",95==a&&(f.To.Text=d.Obj.Email),e&&50!=a||(f.Attachments.Visible=!1),-999==a&&(f.Template.Visible=!1,f.Attachments.Visible=!1,f.AttachmentType.Visible=!1,s.a.SessionManager.Preferences.ContainsKey("ReportIssueEmail")&&(f.To.Text=s.a.SessionManager.Preferences.ReportIssueEmail),o.e.IsEmpty(s.a.SessionManager.CompanyName)||(f.Subject.Text="Issue @ "+s.a.SessionManager.CompanyName)),f.Attachments.Visible&&(f.Attachments.Items.push(l.d.ComboBoxItems_2("","0")),h.VoucherExportExcel.GetPrintLayouts_1(0,a,0).Tables[0].forEach((function(e){f.Attachments.Items.push(l.d.ComboBoxItems_2(e.Name.toString(),e.DocPrintLayoutID.toString())),Object(i.j)(e.IsDefault)&&(f.Attachments.SelectedValue=e.DocPrintLayoutID.toString())})),40054==a&&(f.Attachments.SelectedValue=d.drSelectedPrintLayout.DocPrintLayoutID.toString(),f.Attachments.Enable=!1)),f.Title=s.a.GetResource(e?"SMTP_Email":"SMTP_SMS"),f.DisplayName=f.Title,f.Location=new l.e,f.Location.Visible=!1,f.Location.LblWidth="130","TRUE"==s.a.SessionManager.Preferences.EnableLocationWise.toUpperCase()&&s.a.SessionManager.Preferences.ContainsKey("LWEmailSMS")&&"TRUE"==s.a.SessionManager.Preferences.LWEmailSMS.toUpperCase()){f.Location.Visible=!0,f.Location.Items.push(l.d.ComboBoxItems_2("","0"));var C=s.a.SessionManager.LocationWhere.split(","),T=p.a.GetEmailSMS(8,a,e?"1":"2");T.Tables[0].forEach((function(e){C.Contains(e.NodeID.toString())&&f.Location.Items.push(l.d.ComboBoxItems_2(e.Name.toString(),e.NodeID.toString()))})),s.a.SessionManager.LocationID>0&&T.Tables[0].filter((function(e){return e.NodeID==s.a.SessionManager.LocationID})).length>0&&(f.Location.SelectedValue=s.a.SessionManager.LocationID.toString())}return _possibleConstructorReturn(f)}return _createClass(n,[{key:"CallFromLandingPage",value:function(){}},{key:"OnTemplateChange",value:function(e){return Object(a.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,a,i,r,c,l,u,m,h,b,d,f,g;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.drTemplate=null,this.EmailDisplayName="",o.e.IsEmpty(this.Template.SelectedValue)){e.next=25;break}if(!((t=p.a.GetEmailSMS(2,parseInt(this.Template.SelectedValue),this.IsEmail?"1":"2")).Tables[0].length>0)){e.next=25;break}for(this.drTemplateColumns=t.Columns[0],this.drTemplate={},n=0;n<t.Columns[0].length;n++)this.drTemplate[t.Columns[0][n]]=t.Tables[0][0][t.Columns[0][n]];if(this.To.Text=this.drTemplate.To.toString(),this.CC.Text=this.drTemplate.CC.toString(),this.BCC.Text=this.drTemplate.BCC.toString(),this.Attachments.SelectedValue=this.drTemplate.AttachmentID.toString(),this.IsEmail?this.Subject.Text=this.drTemplate.Subject.toString():this.IsWhatsApp.IsChecked="WhatsApp"==this.drTemplate.Subject.toString(),this.AttachmentType.SelectedValue=this.drTemplate.AttachmentType.toString(),this.SendReportAs.SelectedValue=this.drTemplate.SendReportAs.toString(),this.EmailDisplayName=this.drTemplate.DisplayName.toString(),a=this.drTemplate.Body.toString(),!this.IsEmail){e.next=24;break}if(!a.startsWith("<FlowDocument")){e.next=16;break}try{if(a.startsWith("<FlowDocument")&&(i="",a.Contains('xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"')&&(i='xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"'),a=a.Replace('xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"',""),(r=new o.f).LoadXml(a),""!=i&&(a=a.Replace("<FlowDocument ","<FlowDocument "+i+" ")),(c=r.SelectNodes("FlowDocument/Paragraph/Floater/BlockUIContainer/Image")).length>0))for(l="","",u="","",m="",h="",b=null,d=0;d<c.length;d++)""!=(u=(u=(u=c[d].attributes.Source.value).Replace("file:///","")).Replace("{x:Null}",""))&&((b=u.split("/")).length>0&&(l=b[b.length-1].toString(),"",m=c.Item(d).attributes.Source.Value,h=o.e.GetPath(l.toString()),a=a.Replace(m,h)))}catch(S){}return e.next=12,s.a.common.ConvertXamlToHtml(a.toString());case 12:f=e.sent,this.BodyDocument=f.HtmlText,e.next=22;break;case 16:if(""==a){e.next=22;break}return a='<FlowDocument xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"><Paragraph>'+a+"</Paragraph></FlowDocument >",e.next=20,s.a.common.ConvertXamlToHtml(a.toString());case 20:g=e.sent,this.BodyDocument=g.HtmlText;case 22:e.next=25;break;case 24:this.SMSBody.Text=a;case 25:case"end":return e.stop()}}),e,this)})))}},{key:"OnSendReportAsChange",value:function(e){this.ReportVisible="4"==this.SendReportAs.SelectedValue}},{key:"OnButtonClick",value:function(e){var t=this;if(this.DisplayMessage="","Send"==e)this.Send();else if("Cancel"==e)this.HideDialg();else if("ToClick"==e){if(this.CostCenterID>4e4&&this.CostCenterID<5e4){var n=this.Parent;if(!n.IsInventoryVoucher)return;var a;if(null!=(a=n.IsPurchase?n.ScreenObject.CreditAccount:n.ScreenObject.DebitAccount)&&a.SelectedValue>0){var o=new g(this,"To");p.a.GetEmailSMS(9,a.SelectedValue,this.IsEmail?"1":"0").Tables[0].forEach((function(e){o.Attachments.Items.push(l.c.CheckedListBoxItem_2(e.ToAdd.toString(),e.ToAdd.toString()))})),s.a.page.ShowDialog(o,d.a,{ShowCenter:!0})}}}else if("AddAttachment"==e&&this.CostCenterID>4e4&&this.CostCenterID<5e4){var i=this.Parent;if(null==i.ViewAttachments)return;var r=new g(this,"Attachments");i.ViewAttachments.AttachmentsList.forEach((function(e){r.Attachments.Items.push(l.c.CheckedListBoxItem_3(e.ActualFileName,e.guid+"."+e.FileExtension)),t.AttachmentList.Items.find((function(t){return t.DBColumnName==e.guid+"."+e.FileExtension}))&&(r.Attachments.Items[r.Attachments.Items.length-1].IsChecked=!0)})),s.a.page.ShowDialog(r,d.a,{ShowCenter:!0})}}},{key:"Send",value:function(){return Object(a.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,a,i,r,c,l,u,m,h,b,d,f,g,S,C,T,I,D,v,y,x,L,W,M,A,E,w,V=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n="",!this.IsEmail){e.next=7;break}if(a=s.a.SessionManager.Preferences.ContainsKey("LWEmailSMS")&&"TRUE"==s.a.SessionManager.Preferences.LWEmailSMS.toUpperCase(),!o.e.IsEmptySpace(s.a.SessionManager.UserEmail)||a){e.next=5;break}return e.abrupt("return",void(this.DisplayMessage="Please set email address for user '"+s.a.SessionManager.UserName+"'"));case 5:if(s.a.SessionManager.UserEmail.Contains("@")||a){e.next=7;break}return e.abrupt("return",void(this.DisplayMessage="Invalid email address '"+s.a.SessionManager.UserEmail+"' for user '"+s.a.SessionManager.UserName+"'"));case 7:if(-999!=this.CostCenterID){e.next=11;break}e.next=35;break;case 11:if(!(this.CostCenterID>4e4&&this.CostCenterID<5e4)){e.next=15;break}if(this.IsEmail)for(i=0;i<this.AttachmentList.Items.length;i++)(r=this.AttachmentList.Items[i]).IsChecked&&(n+="<File>",n+="<FilePath>"+r.DBColumnName+"</FilePath>",n+="<ActualName>"+r.Label+"</ActualName>",n+="</File>");e.next=35;break;case 15:if(50!=this.CostCenterID){e.next=35;break}if(c={Type:"Email"},this.drTemplate||(this.drTemplate={},this.drTemplate.TemplateID=0),c.drTemplate=this.drTemplate,this.drTemplate.To=this.To.Text,this.drTemplate.TemplateType=this.IsEmail?"1":"2",this.drTemplate.SendReportAs=this.SendReportAs.SelectedValue,this.drTemplate.To=this.To.Text,this.drTemplate.TemplateType=this.IsEmail?"1":"2",this.drTemplate.SendReportAs=this.SendReportAs.SelectedValue,c.LocationID=0==this.Location.Visible||null==this.Location.SelectedValue?0:parseInt(this.Location.SelectedValue),this.drTemplate.Login_Email1=s.a.SessionManager.UserEmail,this.drTemplate.Login_UserName=s.a.SessionManager.UserName,!this.IsEmail){e.next=33;break}if(this.drTemplate.CC=this.CC.Text,this.drTemplate.BCC=this.BCC.Text,this.drTemplate.Subject=this.Subject.Text,this.drTemplate.AttachmentType=this.AttachmentType.SelectedValue,e.prev=19,null==this.BodyDocument){e.next=27;break}if((l="").startsWith("<FlowDocument")&&(u="",l.Contains('xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"')&&(u='xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"'),l=l.Replace('xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"',""),(m=new o.f).LoadXml(l),""!=u&&(l=l.Replace("<FlowDocument ","<FlowDocument "+u+" ")),(h=m.SelectNodes("FlowDocument/Paragraph/Floater/BlockUIContainer/Image")).length>0))for(b="","",d="","",f="",g="",S=null,C=0;C<h.length;C++)""!=(d=(d=(d=h[C].attributes.Source.value).Replace("file:///","")).Replace("{x:Null}",""))&&((S=d.split("/")).length>0&&(b=S[S.length-1].toString(),"",f=h[C].attributes.Source.value,Logger.DebugLog("SendEmailSmsVM-FlowDocument: ExistUrl"+d),g=o.e.GetPath(b.toString()),Logger.DebugLog("SendEmailSmsVM-FlowDocument: LocalUrl"+g),l=l.Replace(f,g)));return e.next=25,s.a.common.ConvertXamlToHtml(t.toString());case 25:T=e.sent,this.BodyDocument=T.HtmlText;case 27:e.next=31;break;case 29:e.prev=29,e.t0=e.catch(19);case 31:e.next=34;break;case 33:this.drTemplate.Body=this.SMSBody.Text,this.drTemplate.BCC=this.BCC.Text;case 34:return e.abrupt("return",void this.Parent.EmailSMSReport(c));case 35:if(n.length>0&&(n="<XML>"+n+"</XML>"),!this.IsEmail){e.next=44;break}if(e.t1=o.e.IsEmpty(this.BodyDocument),e.t1){e.next=41;break}return e.next=40,s.a.common.ConvertHtmlToXaml(this.BodyDocument);case 40:I=e.sent.xamlText;case 41:t=null==this.BodyDocument?t="":I,e.next=45;break;case 44:t=this.SMSBody.Text;case 45:if((D=[]).push(1),D.push(this.CostCenterID),D.push(40054==this.CostCenterID?this.Parent.sDocIDs:this.NodeID),D.push(0),D.push(0),D.push(this.IsEmail?1:2),D.push(s.a.SessionManager.UserEmail),D.push(this.EmailDisplayName),D.push(this.To.Text),this.IsEmail?(D.push(this.CC.Text),D.push(this.BCC.Text),D.push(this.AttachmentType.SelectedValue),D.push(null!=this.Attachments.SelectedValue?this.Attachments.SelectedValue:0),D.push(this.Subject.Text)):(D.push(""),D.push(this.BCC.Text),D.push(null),D.push(0),D.push(this.IsWhatsApp.IsChecked?"WhatsApp":"")),this.IsEmail)try{if(t.startsWith("<FlowDocument")&&(v="",t.Contains('xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"')&&(v='xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"'),t=t.Replace('xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"',""),(y=new o.f).LoadXml(t),""!=v&&(t=t.Replace("<FlowDocument ","<FlowDocument "+v+" ")),(x=y.SelectNodes("FlowDocument/Paragraph/Floater/BlockUIContainer/Image")).length>0))for(L="","",W="","",M="",A="",E=null,w=0;w<x.length;w++)""!=(W=(W=(W=x[w].attributes.Source.value).Replace("file:///","")).Replace("{x:Null}",""))&&((E=W.split("/")).length>0&&(L=E[E.length-1].toString(),"",M=x[w].attributes.Source.value,Logger.DebugLog("SendEmailSmsVM-FlowDocument: ExistUrl"+W),A=o.e.GetPath(L.toString()),Logger.DebugLog("SendEmailSmsVM-FlowDocument: LocalUrl"+A),t=t.Replace(M,A)))}catch(_){}D.push(t),D.push(n.toString()),o.e.IsEmpty(this.Template.SelectedValue)?D.push(null):D.push(parseInt(this.Template.SelectedValue)),this.Location.Visible&&!o.e.IsEmpty(this.Location.SelectedValue)?D.push(parseInt(this.Location.SelectedValue)):D.push(0),p.a.SetNotifEventTemp(D).subscribe((function(e){V.DisplayMessage=e.Message,V.retValue=e.RetValue,V.retValue>0&&V.HideDialg()}),(function(e){console.log(e),V.DisplayMessage="Error in sending mail."}));case 48:case"end":return e.stop()}}),e,this,[[19,29]])})))}},{key:"HideDialg",value:function(){s.a.page.HideDialog()}},{key:"OnRowDoubleClick",value:function(e,t){return!0}}],[{key:"PushDeleteEvents",value:function(e,t){var n=[];n.push(4),n.push(e),n.push(t),n.push("DELETE_EMAIL"),n.push(s.a.SessionManager.UserName),n.push(s.a.SessionManager.UserID),n.push(s.a.SessionManager.LanguageID);try{var a=s.a.report.GetDeleteNotifTemplete(n);null!=a&&a.Tables[1].length>0&&a.Tables[0].Merge(a.Tables[1]),null!=a&&a.Tables[0].length>0&&(parseInt(a.Tables[0][0].TemplateID),a.Tables[0].forEach((function(e){(void 0).SetDocument_ds(e),a.Columns[0].Contains("FilterXML")||(e.Table.Columns.push("FilterXML"),e.Table.Columns.push("Login_Email1"),e.Table.Columns.push("Login_UserName"),e.Table.Columns.push("Login_FirstName"),e.Table.Columns.push("Login_MiddleName"),e.Table.Columns.push("Login_LastName")),e.Login_Email1=s.a.SessionManager.UserEmail,e.Login_UserName=s.a.SessionManager.UserName;var t=s.a.common.GetDataSet("DOC038",s.a.SessionManager.UserID).Tables[0];t.length>0&&(e.Login_FirstName=t.Rows[0].FirstName.toString(),e.Login_MiddleName=t.Rows[0].MiddleName.toString(),e.Login_LastName=t.Rows[0].LastName.toString()),e.Table.Columns.push("OtherDocsNos"),(void 0).TemplateType=parseInt(e.TemplateType),(void 0).InitData(e)})))}catch(o){}}}]),n}(r.b),g=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,a){var s;return _classCallCheck(this,n),(s=t.call(this)).CallType=a,s.Parent=e,"Attachments"==a?s.Title="Add Attachments":"To"==a&&(s.Title="Select"),s.Attachments=new l.b,s}return _createClass(n,[{key:"OnButtonClick",value:function(e){var t=this;"OK"==e?("Attachments"==this.CallType?(this.Parent.AttachmentList.Items.Clear(),this.Attachments.Items.forEach((function(e){if(e.IsChecked){var n=new m.a;n.DBColumnName=e.Value,n.Label=e.Name,n.IsChecked=!0,t.Parent.AttachmentList.Items.push(n)}}))):"To"==this.CallType&&(null==this.Parent.To.Text&&(this.Parent.To.Text=""),this.Attachments.Items.forEach((function(e){e.IsChecked&&(t.Parent.To.Text.length>0&&(t.Parent.To.Text+="; "),t.Parent.To.Text+=e.Name)}))),s.a.page.HideDialog()):s.a.page.HideDialog()}}]),n}(r.b)}}]);