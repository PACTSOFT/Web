(window.webpackJsonp=window.webpackJsonp||[]).push([[114,141,150,160],{XnK4:function(e,t,s){"use strict";s.r(t),s.d(t,"ChequeDiscPostedDocumentViewModel",(function(){return P}));var i=s("Do2H"),o=s("Lp6j"),a=s("eQJW"),n=s("ScVY"),r=s("lUlH"),l=s("EQd/"),h=s("JIg3"),c=s("n56n"),u=s("8B8H"),D=s("0/4Q"),m=s("wlFP"),d=s("PDNK");class C{constructor(){this._Controls=[],this.CommonControls=[],this.ARAPControls=[],this.PosControls=[],this.LinkingControls=[],this.GroupCheckboxLinkingControls=[],this.Data=[],this._DocumentID=0,this._IsEdit=0,this.lstGroupBox=new Array}get CustomFieldsVisibility(){return this._Controls.length>0}get Controls(){return this._Controls}LoadScreen(e,t){Logger.InfoLog("PreferenceControlGenerator:: Inside LoadScreen"),this.Data=null,this.OnLoad(e,t)}LoadScreen_4(e,t,s,i){Logger.InfoLog("PreferenceControlGenerator:: Inside LoadScreen"),this._DocumentID=s,this._IsEdit=i,this.Data=null,this.OnLoad(e,t)}OnLoad(e,t){try{if(null==this.Data&&(this.oParent=e,this.Data=this._DocumentID>0?this.GetScreenInfo_2(t,this._DocumentID):this.GetScreenInfo(t),null!=this.Data&&this.Data.Tables.length>0&&!this.Data.Columns[0].Contains("ErrorMessage")&&(this.CheckLicense(this.Data.Tables[0]),this.CheckLicense(this.Data.Tables[1]),this.CheckLicense(this.Data.Tables[4]),null!=this.Data&&this.Data.Tables[0].length>0))){this.Data.Tables[0].filter(e=>"BodyFreezeColumn"==e.DBText),this.PosControls.Clear(),this.CommonControls.Clear(),this.ARAPControls.Clear(),this._Controls.Clear(),this.LinkingControls.Clear(),this.lstGroupBox.Clear();for(let e=0;e<this.Data.Tables[0].length;e++)this.SetProperties_Static(this.Data.Tables[0][e],this.Data.Tables[0][e].PrefValueType.toString())}}catch(s){Logger.ErrorLog("PreferenceControlGenerator:: LoadScreen : "+s.stack)}}CheckLicense(e){let t;null!=e.DBText?(t=e.filter(e=>"DuplicateProduct_Ratewise"==e.DBText),t.forEach(t=>{e.Remove(t)}),i.a.SessionManager.Preferences.ContainsKey("IsControlAccounts")&&"FALSE"==i.a.SessionManager.Preferences.IsControlAccounts.toUpperCase()&&(t=e.filter(e=>"ControlAccountFilterField"==e.DBText),t.forEach(t=>{e.Remove(t)})),i.a.SessionManager.LicenseSettings.ContainsKey("ChequeBookManagement")&&"FALSE"==i.a.SessionManager.LicenseSettings.ChequeBookManagement.toUpperCase()&&(t=e.filter(e=>"AutoChequeNo"==e.DBText),t.forEach(t=>{e.Remove(t)})),i.a.SessionManager.LicenseSettings.ContainsKey("CrossDimension")&&"FALSE"==i.a.SessionManager.LicenseSettings.CrossDimension.toUpperCase()&&(t=e.filter(e=>"UseasCrossDimension"==e.DBText||"CrossDimDocument"==e.DBText||"CrossDimField"),t.forEach(t=>{e.Remove(t)})),i.a.SessionManager.LicenseSettings.ContainsKey("LCTR")&&"FALSE"==i.a.SessionManager.LicenseSettings.LCTR.toUpperCase()&&(t=e.filter(e=>"UseAsLC"==e.DBText||"EnableLC"==e.DBText||"LcCloseDocument"),t.forEach(t=>{e.Remove(t)})),i.a.SessionManager.LicenseSettings.ContainsKey("QC")&&"FALSE"==i.a.SessionManager.LicenseSettings.QC.toUpperCase()&&(t=e.filter(e=>"EnableTestcase"==e.DBText),t.forEach(t=>{e.Remove(t)})),i.a.SessionManager.LicenseSettings.ContainsKey("Kit")&&"FALSE"==i.a.SessionManager.LicenseSettings.Kit.toUpperCase()&&(t=e.filter(e=>"dynamicsetProductwiselinking"==e.DBText||"SplitKit"==e.DBText),t.forEach(t=>{e.Remove(t)})),i.a.SessionManager.LicenseSettings.ContainsKey("Bins")&&"FALSE"==i.a.SessionManager.LicenseSettings.Bins.toUpperCase()&&(t=e.filter(e=>"AutoAdjustBinLinking"==e.DBText||"AutoAdjustBins"==e.DBText||"CopyBins"==e.DBText||"DuplicateProductClubBins"==e.DBText||"OptionalBins"==e.DBText||"ShowBins"==e.DBText),t.forEach(t=>{e.Remove(t)})),i.a.SessionManager.LicenseSettings.ContainsKey("Packing")&&"FALSE"==i.a.SessionManager.LicenseSettings.Packing.toUpperCase()&&(t=e.filter(e=>"Checkpackedqty"==e.DBText||"DefaultPack"==e.DBText||"EnablePacking"==e.DBText||"LineWisePacking"==e.DBText||"Linkallprodspacked"==e.DBText||"PackLabel"==e.DBText||"PackMandScan"==e.DBText||"PackWiseProds"==e.DBText||"ScanPack"==e.DBText||"ShowPackStat"==e.DBText),t.forEach(t=>{e.Remove(t)})),i.a.SessionManager.LicenseSettings.ContainsKey("Substitutes")&&"FALSE"==i.a.SessionManager.LicenseSettings.Substitutes.toUpperCase()&&(t=e.filter(e=>"EnableSubtitutes"==e.DBText||"EnableSubtitutesQty"==e.DBText||"ShowSubQOH"==e.DBText||"SubonProdChange"==e.DBText||"SubstituteOnQty"==e.DBText),t.forEach(t=>{e.Remove(t)})),i.a.SessionManager.LicenseSettings.ContainsKey("Barcode")&&"FALSE"==i.a.SessionManager.LicenseSettings.Barcode.toUpperCase()&&(t=e.filter(e=>"BarcodeField"==e.DBText||"UsingBarCodes"==e.DBText),t.forEach(t=>{e.Remove(t)})),i.a.SessionManager.LicenseSettings.ContainsKey("Hold_Release")&&"FALSE"==i.a.SessionManager.LicenseSettings.Hold_Release.toUpperCase()&&(t=e.filter(e=>"Enable Hold"==e.DBText||"enebleSaveonhold"==e.DBText),t.forEach(t=>{e.Remove(t)})),i.a.SessionManager.LicenseSettings.ContainsKey("Import")&&"FALSE"==i.a.SessionManager.LicenseSettings.Import.toUpperCase()&&(t=e.filter(e=>"ImpPrf"==e.DBText),t.forEach(t=>{e.Remove(t)})),i.a.SessionManager.LicenseSettings.ContainsKey("SKU")&&"FALSE"==i.a.SessionManager.LicenseSettings.SKU.toUpperCase()&&(t=e.filter(e=>"OnScan"==e.DBText||"DumpStockCodes"==e.DBText),t.forEach(t=>{e.Remove(t)})),i.a.SessionManager.LicenseSettings.ContainsKey("PaymentTerms")&&"FALSE"==i.a.SessionManager.LicenseSettings.PaymentTerms.toUpperCase()&&(t=e.filter(e=>"accountwisePaymentTerms"==e.DBText||"CopyPaymentTerms"==e.DBText||"Enable Payment Terms"==e.DBText||"Paytermids"==e.DBText||"ShowPercentPayTerms"==e.DBText||"Paymenttermsbasedon"==e.DBText),t.forEach(t=>{e.Remove(t)})),i.a.SessionManager.LicenseSettings.ContainsKey("Schemes")&&"FALSE"==i.a.SessionManager.LicenseSettings.Schemes.toUpperCase()&&(t=e.filter(e=>"EnableSchemes"==e.DBText||"SchemesNumericFields"==e.DBText||"SchemesValueField"==e.DBText||"DonotUpdateSchemeQty"==e.DBText||"GetSchemeQty"==e.DBText||"PriceScheme"==e.DBText||"ValidateSchemeBeforeSave"==e.DBText),t.forEach(t=>{e.Remove(t)})),i.a.SessionManager.LicenseSettings.ContainsKey("TemporaryProduct")&&"FALSE"==i.a.SessionManager.LicenseSettings.TemporaryProduct.toUpperCase()&&(t=e.filter(e=>"onlyTempProduct"==e.DBText||"ExcludeTemproducts"==e.DBText||"IgnoreTempProduct"==e.DBText||"MandatorytempPartinfo"==e.DBText||"TempInfo"==e.DBText),t.forEach(t=>{e.Remove(t)})),i.a.SessionManager.LicenseSettings.ContainsKey("ToleranceManagement")&&"FALSE"==i.a.SessionManager.LicenseSettings.ToleranceManagement.toUpperCase()&&(t=e.filter(e=>"Enabletolerance"==e.DBText),t.forEach(t=>{e.Remove(t)}))):null!=e.DocumentType&&(i.a.SessionManager.LicenseSettings.ContainsKey("DeliveryNoteReturn")&&"FALSE"==i.a.SessionManager.LicenseSettings.DeliveryNoteReturn.toUpperCase()&&(t=e.filter(e=>6==e.DocumentType),t.forEach(t=>{e.Remove(t)})),i.a.SessionManager.LicenseSettings.ContainsKey("PhysicalStockTaking")&&"FALSE"==i.a.SessionManager.LicenseSettings.PhysicalStockTaking.toUpperCase()&&(t=e.filter(e=>31==e.DocumentType),t.forEach(t=>{e.Remove(t)})),i.a.SessionManager.LicenseSettings.ContainsKey("PhysicalStockPosting")&&"FALSE"==i.a.SessionManager.LicenseSettings.PhysicalStockPosting.toUpperCase()&&(t=e.filter(e=>32==e.DocumentType),t.forEach(t=>{e.Remove(t)})),i.a.SessionManager.LicenseSettings.ContainsKey("PurchaseRequisition")&&"FALSE"==i.a.SessionManager.LicenseSettings.PurchaseRequisition.toUpperCase()&&(t=e.filter(e=>25==e.DocumentType),t.forEach(t=>{e.Remove(t)})),i.a.SessionManager.LicenseSettings.ContainsKey("PurchaseEnquiry")&&"FALSE"==i.a.SessionManager.LicenseSettings.PurchaseEnquiry.toUpperCase()&&(t=e.filter(e=>26==e.DocumentType),t.forEach(t=>{e.Remove(t)})),i.a.SessionManager.LicenseSettings.ContainsKey("PurchaseQuotation")&&"FALSE"==i.a.SessionManager.LicenseSettings.PurchaseQuotation.toUpperCase()&&(t=e.filter(e=>27==e.DocumentType),t.forEach(t=>{e.Remove(t)})),i.a.SessionManager.LicenseSettings.ContainsKey("GoodsReceivedReturn")&&"FALSE"==i.a.SessionManager.LicenseSettings.GoodsReceivedReturn.toUpperCase()&&(t=e.filter(e=>10==e.DocumentType),t.forEach(t=>{e.Remove(t)})))}SetProperties_Static(e,t){let s;switch(t){case"CheckBox":if("FillLocalRef"==e.DBText.toString()||"LockLinkedRows"==e.DBText.toString()||"VendorBasedBillNo"==e.DBText.toString()||"UseQtyAdjustment"==e.DBText.toString()||"DistributeCost"==e.DBText.toString()||(this.oCheckBox=m.a.PactCheckBoxData_3(e.DBText.toString(),43,e.Group.toString(),0)),this.oCheckBox.Label=e.Text.toString(),s=this.oCheckBox,this.oCheckBox.Row=e.PrefRowOrder.toString(),this.oCheckBox.DefaultValue=e.PrefDefalutValue.toString(),this.oCheckBox.Column=e.PrefColOrder.toString(),this.oCheckBox.IsChecked=!(o.e.IsEmpty(e.Value)||"TRUE"!=e.Value.toString().toUpperCase()&&"1"!=e.Value.toString())&&Object(a.j)(e.Value.toString()),"OnlyExpired"==this.oCheckBox.DBColumnName||"StaticLinkingColumns"==this.oCheckBox.DBColumnName)return;"ProductName"!=s.DBColumnName&&"AccountName"!=s.DBColumnName||(this.IsFrozenCheckBox=this.oCheckBox),"Common"==e.Group.toString()?this.CommonControls.push(this.oCheckBox):"ARAP"==e.Group.toString()?this.ARAPControls.push(this.oCheckBox):"General"==e.Group.toString()?this.Controls.push(this.oCheckBox):"POS"==e.Group.toString()?this.PosControls.push(this.oCheckBox):"Linking"==e.Group.toString()&&this.LinkingControls.push(this.oCheckBox),e.Text.toString();break;case"Textbox":case"TextBox":this.oText=l.d.PactTextBoxData_2("",43),this.oText.Label=e.Text.toString(),this.oText.DBColumnName=e.DBText.toString(),s=this.oText,this.oText.Row=e.PrefRowOrder.toString(),this.oText.Column=e.PrefColOrder.toString(),this.oText.GroupName=e.Group.toString(),this.SetProperty_DefaultValue(s),this.oText.Text=e.Value.toString(),"Common"==e.Group.toString()?(this.CommonControls.push(this.oText),this.oText.RowSpan=2):"POS"==e.Group.toString()?this.PosControls.push(this.oText):"General"==e.Group.toString()?this.Controls.push(this.oText):"Linking"==e.Group.toString()&&this.LinkingControls.push(this.oText);break;case"CustomTextBox":case"BarcodeFormat":break;case"RadioButton":this.oRadioButton=new d.a(e.DBText.toString(),43,e.Group.toString()),this.oRadioButton.Label=e.Text.toString(),s=this.oRadioButton,this.oRadioButton.Row=e.PrefRowOrder.toString(),this.oRadioButton.DefaultValue=e.PrefDefalutValue.toString(),this.oRadioButton.Column=e.PrefColOrder.toString(),this.oRadioButton.IsChecked=Object(a.j)(e.Value.toString()),"Common"==e.Group.toString()?this.CommonControls.push(this.oRadioButton):"POS"==e.Group.toString()?this.PosControls.push(this.oText):"General"==e.Group.toString()?this.Controls.push(this.oRadioButton):"Linking"==e.Group.toString()&&this.LinkingControls.push(this.oRadioButton);break;case"LISTBOX":let t,i=c.b.PactListBoxData_2(e.DBText.toString(),43,e.Group.toString());i.Label=e.Text.toString(),i.Row=e.PrefRowOrder.toString(),i.DefaultValue=e.PrefDefalutValue.toString(),o.e.IsEmpty(e.Value)||(t=o.e.IntTryParse(e.Value.toString()),t>0&&(i.SelectedValue=parseInt(e.Value.toString()))),i.Column=e.PrefColOrder.toString(),"BilllandingReport"==e.DBText.toString()&&(i.CCID=200,i.TypeID=1),"Common"==e.Group.toString()?this.CommonControls.push(i):"General"==e.Group.toString()?this.Controls.push(i):"Linking"==e.Group.toString()&&this.LinkingControls.push(i);break;case"DATE":this.oDate=h.a.PactDatePickerData_3(e.DBText.toString(),43,e.Group.toString()),this.oDate.Label=e.Text.toString(),this.oDate.Row=e.PrefRowOrder.toString(),this.oDate.DefaultValue=e.PrefDefalutValue.toString(),o.e.IsEmpty(e.Value)||"FALSE"==e.Value.toString().toUpperCase()||"TRUE"==e.Value.toString().toUpperCase()||(this.oDate.Date=new Date(e.Value.toString())),this.oDate.Column=e.PrefColOrder.toString(),"Common"==e.Group.toString()?this.CommonControls.push(this.oDate):"General"==e.Group.toString()?this.Controls.push(this.oDate):"Linking"==e.Group.toString()&&this.LinkingControls.push(this.oDate);break;case"GroupCheckBox":if(this.lstGroupBox.Contains("GroupCheckBox"))break;this.lstGroupBox.push("GroupCheckBox");break;case"ComboBox":if(this.oCombo=D.e.PactComboBoxData2(e.DBText.toString(),43,e.Group.toString()),this.oCombo.Label=e.Text.toString(),this.oCombo.Row=e.PrefRowOrder.toString(),this.oCombo.DefaultValue=e.PrefDefalutValue.toString(),this.Data.Tables.length>18&&"DefaultProfileID"==e.DBText.toString()){this.oCombo.Items.push(D.d.ComboBoxItems_2("",""));for(let e=0;e<this.Data.Tables[18].length;e++)this.oCombo.Items.push(D.d.ComboBoxItems_2(this.Data.Tables[18][e].ProfileName.toString(),this.Data.Tables[18][e].ProfileID.toString()))}else if("BillwisePosting"==e.DBText.toString())this.oCombo.Items.push(D.d.ComboBoxItems_2("","")),this.oCombo.Items.push(D.d.ComboBoxItems_2("Line-wise","1")),this.oCombo.Items.push(D.d.ComboBoxItems_2("PaymentTerm-wise","2"));else if("TabsPopup"==e.DBText.toString())this.oCombo.Items.push(D.d.ComboBoxItems_2("","")),this.oCombo.Items.push(D.d.ComboBoxItems_2("Pop up","1")),this.oCombo.Items.push(D.d.ComboBoxItems_2("Collapsable","2"));else if("DefaultRightView"==e.DBText.toString())this.oCombo.Items.push(D.d.ComboBoxItems_2("","")),this.oCombo.Items.push(D.d.ComboBoxItems_2("Import","Import")),this.oCombo.Items.push(D.d.ComboBoxItems_2("Sort","Sort")),this.oCombo.Items.push(D.d.ComboBoxItems_2("Notes","Notes")),this.oCombo.Items.push(D.d.ComboBoxItems_2("Attachments","Attachments")),this.oCombo.Items.push(D.d.ComboBoxItems_2("Search","Search")),this.oCombo.Items.push(D.d.ComboBoxItems_2("Report","Report")),this.oCombo.Items.push(D.d.ComboBoxItems_2("Documents","Documents"));else if(this._DocumentID>0&&this.Data.Tables.length>10&&("DocumentLinkDimension"==e.DBText.toString()||"DimensionWise"==e.DBText.toString()||"defprod"==e.DBText.toString()||"DimWiseAttachments"==e.DBText.toString()||"CurrencyDim"==e.DBText.toString()))this.FillDimensions(this.oCombo,this.Data.Tables[10]);else if(this.Data.Tables.length>5&&("DocumentLinkDimension"==e.DBText.toString()||"DimensionWise"==e.DBText.toString()||"DimWiseAttachments"==e.DBText.toString()||"CurrencyDim"==e.DBText.toString()))this.FillDimensions(this.oCombo,this.Data.Tables[5]);else if(this.Data.Tables.length>3&&("DueDateonBillDate"==e.DBText.toString()||"Paymenttermsbasedon"==e.DBText.toString())&&this.Data.Columns[3].Contains("UserColumnType")){let e=this.Data.Tables[3].filter(e=>3!=e.sectionid&&("DATE"==e.UserColumnType||"DATE"==e.ColumnDataType));for(let t=0;t<e.length;t++)this.oCombo.Items.push(D.d.ComboBoxItems_2(e[t].ResourceData.toString(),e[t].SysColumnName.toString()))}else if(this.Data.Tables.length>3&&("BodyFreezeColumn"==e.DBText.toString()||"Sortbasedon"==e.DBText.toString())&&this.Data.Columns[3].Contains("sectionid")){let e=this.Data.Tables[3].filter(e=>3==e.sectionid);this.oCombo.Items.push(D.d.ComboBoxItems_2("","0"));for(let t=0;t<e.length;t++)this.oCombo.Items.push(D.d.ComboBoxItems_2(e[t].ResourceData.toString(),e[t].CostCenterColID.toString()))}""!=e.Value.toString()&&"FALSE"!=e.Value.toString().toUpperCase()&&"TRUE"!=e.Value.toString().toUpperCase()&&(this.oCombo.SelectedValue=e.Value.toString()),this.oCombo.Column=e.PrefColOrder.toString(),"Common"==e.Group.toString()?this.CommonControls.push(this.oCombo):"POS"==e.Group.toString()?this.PosControls.push(this.oText):"General"==e.Group.toString()?this.Controls.push(this.oCombo):"Linking"==e.Group.toString()&&this.LinkingControls.push(this.oCombo);break;case"CheckList":let n=D.b.CheckedListBoxData_1(e.DBText.toString(),43);n.GroupName=e.Group.toString(),n.Label=e.Text.toString(),n.Row=e.PrefRowOrder.toString(),n.Column=e.PrefColOrder.toString();let r=e.Value.toString().split(",");for(let e=0;e<this.Data.Tables[10].length;e++)n.Items.push(D.c.CheckedListBoxItem_3(this.Data.Tables[10][e].NAME.toString(),this.Data.Tables[10][e].FEATUREID.toString())),r.Contains(this.Data.Tables[10][e].FEATUREID.toString())&&(n.Items[e].IsChecked=!0);"Common"==e.Group.toString()?this.CommonControls.push(n):"ARAP"==e.Group.toString()?this.ARAPControls.push(n):"General"==e.Group.toString()?this.Controls.push(n):"Linking"==e.Group.toString()&&this.LinkingControls.push(n)}}FillDimensions(e,t){if(null!=this.Data&&t.length>0){e.Items.push(D.d.ComboBoxItems_2("","0"));for(let s=0;s<t.length;s++)e.Items.push(D.d.ComboBoxItems_2(t[s].NAME.toString(),t[s].FEATUREID.toString()));("CurrencyDim"==e.DBColumnName||"DimensionWise"==e.DBColumnName&&"Linking"==e.GroupName)&&e.Items.push(D.d.ComboBoxItems_2("Product","3"))}}oCheckBox_PropertyChanged(e){}SetProperty_DefaultValue(e){if(e instanceof m.a)try{e.IsChecked=Object(a.j)(e.DefaultValue)}catch(t){}else if(e instanceof d.a)try{e.IsChecked=Object(a.j)(e.DefaultValue)}catch(s){}else if(e instanceof l.d)try{e.Text=e.DefaultValue}catch(i){}else if(e instanceof D.e)try{e.SelectedValue=o.e.IsEmpty(e.DefaultValue)?"":e.DefaultValue}catch(n){}}SetProperties_Custom(e,t){t.Label="Test",t.Mandatory=!1,t.DefaultValue="false",t.DBColumnName="Column",t instanceof l.d&&("INT"!=t.DataType&&"FLOAT"!=t.DataType||(t.Align="Right"))}GetScreenInfo(e){Logger.InfoLog("PreferenceControlGenerator:: Inside GetScreenInfo");try{let t=[];t.push(e),t.push(i.a.SessionManager.UserID),t.push(i.a.SessionManager.RoleID),t.push(i.a.SessionManager.LanguageID);let s=null;return s=i.a.document.GetScreenInfo(e),s}catch(t){return Logger.ErrorLog("PreferenceControlGenerator:: GetScreenInfo"+t.stack),null}}GetScreenInfo_2(e,t){Logger.InfoLog("PreferenceControlGenerator:: Inside GetScreenInfo");try{let s=null;return s=i.a.document.GetScreenInfo_2(e,t,this._IsEdit),s}catch(s){return Logger.ErrorLog("PreferenceControlGenerator:: GetScreenInfo"+s.stack),null}}}class S extends n.b{constructor(e){let t,s;if(super(),this.IsQuit=!0,this.IsOK=!1,this.PDCReceivableAccount=0,this.DocumentObject=new C,this.PostConversionDate=new m.a(0),this.Location=new D.b(0),this.locationIn="",this.DepositedIn=new c.b(0),this.DiscountBank=new c.b(0),this.Title="",this.FromDate=new h.a(0),this.ToDate=new h.a(0),this.FValue=0,this.TValue=0,this.parent=e,this.DocumentObject.LoadScreen(this,109),this.Amount=new D.e(0),this.Amount.Label="Amount",this.Amount.SelectionChangedCommand.Subscribe(this,"OnConditionSelectionChanged"),this.DepositedIn.Label="Deposited In",this.DepositedIn.CCID=2,this.DepositedIn.TypeID=51,this.DiscountBank.CCID=2,this.DiscountBank.TypeID=51,this.DiscountBank.Label="Discount Bank",this.Filter=new d.b("Documents"),t=new d.a("PDC",0,"Filter"),t.Group=this.Filter,null!=this.parent&&0==this.parent.Filter&&(t.IsChecked=!0),t.Label="PDC",this.Filter.Items.push(t),t=new d.a("Discounted",1,"Filter"),t.Group=this.Filter,null!=this.parent&&1==this.parent.Filter&&(t.IsChecked=!0),t.Label="Discounted",this.Filter.Items.push(t),this.Title=" Cheque Discount ",this.FromValue=new l.d(0),this.ToValue=new l.d(0),this.FromList=new c.b(0),this.ToList=new c.b(0),this.FromList.Label=this.FromValue.Label="Value",this.ToList.Label=this.ToValue.Label=i.a.GetResource("Reports_ToValue"),i.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"True"==i.a.SessionManager.Preferences.EnableLocationWise.toString()){this.Location.Items.push(D.c.CheckedListBoxItem_3("All","-1"));let e=i.a.admin.getLocationRoles([50002,i.a.SessionManager.LangID]);if(null!=e&&e.Tables.length>0&&e.Tables[0].length>0)for(let t=0;t<e.Tables[0].length;t++)i.a.SessionManager.LocationID>0&&e.Tables[0][t][e.Columns[0][0]].toString()==i.a.SessionManager.LocationID.toString()?this.Location.Items.push(D.c.CheckedListBoxItem_5(e.Tables[0][t][e.Columns[0][2]].toString(),e.Tables[0][t][e.Columns[0][0]].toString(),!0)):this.Location.Items.push(D.c.CheckedListBoxItem_3(e.Tables[0][t][e.Columns[0][2]].toString(),e.Tables[0][t][e.Columns[0][0]].toString()));if(!o.e.IsEmpty(i.a.SessionManager.LocationWhere)){let e=i.a.SessionManager.LocationWhere.split(",");if(0==i.a.SessionManager.LocationID&&e.length>1)for(let t=0;t<e.length;t++){const s=e[t];for(let e=0;e<this.Location.Items.length;e++){const t=this.Location.Items[e];if(t.Value.toString()==s.toString()){t.IsChecked=!0;break}}}}}else this.Location.Visible=!1;if(this.Documents=new D.b,this.Documents.Label=" Documents List",s=e.DocumentList.split(","),null!=this.DocumentObject.Data.Tables[1]&&this.DocumentObject.Data.Tables[1].length>0)for(let i=0;i<this.DocumentObject.Data.Tables[1].length;i++)this.Documents.Items.push(D.c.CheckedListBoxItem_3(this.DocumentObject.Data.Tables[1][i].DocumentName.toString(),this.DocumentObject.Data.Tables[1][i].CostCenterID.toString())),(s.Contains(this.DocumentObject.Data.Tables[1][i].CostCenterID.toString())||""==e.DocumentList)&&(this.Documents.Items[i].IsChecked=!0);this.FromDate.Label=i.a.GetResource("DocumentDesigner_FromDate"),this.ToDate.Label=i.a.GetResource("DocumentDesigner_ToDate"),this.PostConversionDate.Label=i.a.GetResource("PostonConversionDate"),this.Stat=new d.b("Status"),this.FromDate.Date=this.parent.FromDate,this.ToDate.Date=this.parent.toDate,i.a.SessionManager.Preferences.ContainsKey("DefaultPostConversionDate")&&""!=i.a.SessionManager.Preferences.DefaultPostConversionDate&&(this.PostConversionDate.IsChecked=Object(a.j)(i.a.SessionManager.Preferences.DefaultPostConversionDate)),this.PostConversionDate.IsChecked=this.parent.PostonconversionDate,this.LoadConditions(),this.OnConditionSelectionChanged(this.Amount.SelectedValue),e.BankID>0&&(this.DepositedIn.SelectedValue=e.BankID),e.BankCCNodeID>0&&(this.DiscountBank.SelectedValue=e.BankCCNodeID),this.FromDate.Date=e.FromDate,this.ToDate.Date=e.toDate,e.FromValue>0&&(this.FromValue.Text=e.FromValue.toString()),e.ToValue>0&&(this.ToValue.Text=e.ToValue.toString())}OnLocationCheckedChanged(e){if(this.locationIn=this.GetLocation(this.Location),"-1"==e.Value)for(let t=0;t<this.Location.Items.length;t++)this.Location.Items[t].IsChecked=e.IsChecked;else e.IsChecked||(this.Location.Items[0].IsChecked=!1)}OnBankSelectionChanged(e){Logger.InfoLog("ChequeDiscountDialogViewModel ::Entering OnBankSelectionChanged");try{if(this.DepositedIn.SelectedValue>0){let e=i.a.common.GetDataSet("CD001",this.DepositedIn.SelectedValue.toString());null!=e&&e.Tables.length>0&&e.Tables[0].length>0&&null!=e.Tables[0][0].ACCOUNTID&&""!=e.Tables[0][0].ACCOUNTID.toString()&&(null!=e.Tables[0][0].PDCReceivableAccount&&""!=e.Tables[0][0].PDCReceivableAccount.toString()&&(this.parent.PDCReceivableAccount=parseFloat(e.Tables[0][0].PDCReceivableAccount)),null!=e.Tables[0][0].InterestRate&&""!=e.Tables[0][0].InterestRate.toString()&&(this.parent.InterestRate=parseFloat(e.Tables[0][0].InterestRate)),null!=e.Tables[0][0].CommissionRate&&""!=e.Tables[0][0].CommissionRate.toString()&&(this.parent.CommissionRate=parseFloat(e.Tables[0][0].CommissionRate)),null!=e.Tables[0][0].CheckDiscountLimit&&""!=e.Tables[0][0].CheckDiscountLimit.toString()&&(this.parent.ChequeDiscountLimit=parseFloat(e.Tables[0][0].CheckDiscountLimit)),null!=e.Tables[0][0].ACCOUNTID&&""!=e.Tables[0][0].ACCOUNTID.toString()&&(this.parent.PDCDiscountAcc=parseFloat(e.Tables[0][0].ACCOUNTID)))}Logger.InfoLog("ChequeDiscountDialogViewModel ::Exiting OnBankSelectionChanged")}catch(t){Logger.ErrorLog("ChequeDiscountDialogViewModel :: OnBankSelectionChanged"+t.stack)}}OnConditionSelectionChanged(e){this.ToValue.Visible=!1,this.FromValue.Label="Value",null!=this.Amount.SelectedValue&&("Between"==this.Amount.SelectedValue||"NotBetween"==this.Amount.SelectedValue?this.FromList.CCID>0?(this.FromList.Visible=!0,this.ToList.CCID=this.FromList.CCID,this.ToList.TypeID=this.FromList.TypeID,this.ToList.CustomWhere=this.FromList.CustomWhere,this.ToList.Refresh(),this.ToList.Visible=!0,this.FromList.Label=i.a.GetResource("Reports_FromValue")):(this.FromValue.Visible=!0,this.ToValue.Visible=!0,this.FromValue.Label="From Value",this.FromValue.Label=i.a.GetResource("Reports_FromValue")):("Equal"==this.Amount.SelectedValue||"NotEqual"==this.Amount.SelectedValue)&&this.FromList.CCID>0?this.FromList.Visible=!0:this.FromValue.Visible=!0)}LoadConditions(){this.Amount.Items.Clear(),this.Amount.Items.push(D.d.ComboBoxItems_3(i.a.GetResource("Between"),"Between"," BETWEEN ")),this.Amount.Items.push(D.d.ComboBoxItems_3(i.a.GetResource("Not Between"),"NotBetween"," NOT BETWEEN ")),this.Amount.Items.push(D.d.ComboBoxItems_3(i.a.GetResource("Equal"),"Equal","=")),this.Amount.Items.push(D.d.ComboBoxItems_3(i.a.GetResource("Not Equal"),"NotEqual","<>")),this.Amount.Items.push(D.d.ComboBoxItems_3(i.a.GetResource("Lessthan"),"Lessthan","<")),this.Amount.Items.push(D.d.ComboBoxItems_3(i.a.GetResource("Lessthan Or Equal"),"LessthanOrEqual","<=")),this.Amount.Items.push(D.d.ComboBoxItems_3(i.a.GetResource("Greaterthan"),"Greaterthan",">")),this.Amount.Items.push(D.d.ComboBoxItems_3(i.a.GetResource("Greaterthan Or Equal"),"Greaterthan Or Equal",">=")),this.Amount.SelectedValue="Equal"}GetLocation(e){let t=1,s=0,i="";for(;t<e.Items.length;t++)e.Items[t].IsChecked&&(0==s&&(i=""),i+=e.Items[t].Value+",",s++);return i.length>0&&(i=i.substr(0,i.length-1)+""),i}OnButtonClick(e){if("Cancel"==e.toString())i.a.page.HideDialog();else try{this.parent.DialogResult=!0,this.parent.FromDate=this.FromDate.Date,this.parent.toDate=this.ToDate.Date,o.e.IsEmpty(this.FromValue.Text)||(this.FValue=o.e.IntTryParse(this.FromValue.Text),this.parent.FromValue=this.FValue),this.ToValue.Visible&&(o.e.IsEmpty(this.ToValue.Text)||(this.TValue=o.e.IntTryParse(this.ToValue.Text),this.parent.ToValue=this.TValue)),this.parent.strAmountQry=this.GetAmountCondition();let e="";for(let t=0;t<this.Documents.Items.length;t++)this.Documents.Items[t].IsChecked&&(e.length>0&&(e+=","),e+=this.Documents.Items[t].Value.toString());if(this.parent.DocumentList=e,this.parent.PostonconversionDate=this.PostConversionDate.IsChecked,this.parent.LocationList=this.GetLocation(this.Location),!(this.DepositedIn.SelectedValue>0))return this.DisplayMessage=" Please select Discount Bank",void(this.MessageVisibility=!0);this.parent.BankID=this.DepositedIn.SelectedValue,this.parent.Filter=this.Filter.CheckedItem.FeatureID,this.parent.BankCCNodeID=this.DiscountBank.SelectedValue>0?this.DiscountBank.SelectedValue:this.parent.BankID,this.parent.LoadData(),i.a.page.HideDialog()}catch(t){}}GetAmountCondition(){let e="";return"EQUAL"==this.Amount.SelectedValue.toUpperCase()&&null!=this.FromValue.Text&&""!=this.FromValue.Text.Trim()?e=" = "+this.FromValue.Text:"BETWEEN"==this.Amount.SelectedValue.toUpperCase()&&null!=this.FromValue.Text&&""!=this.FromValue.Text.Trim()&&null!=this.ToValue.Text&&""!=this.ToValue.Text.Trim()?e=" BETWEEN "+this.FromValue.Text+"  AND "+this.ToValue.Text:"NOTBETWEEN"==this.Amount.SelectedValue.toUpperCase()&&null!=this.FromValue.Text&&""!=this.FromValue.Text.Trim()&&null!=this.ToValue.Text&&""!=this.ToValue.Text.Trim()?e=" NOT BETWEEN "+this.FromValue.Text+"  AND "+this.ToValue.Text:"NOTEQUAL"==this.Amount.SelectedValue.toUpperCase()&&null!=this.FromValue.Text&&""!=this.FromValue.Text.Trim()?e=" <> "+this.FromValue.Text:"LESSTHAN"==this.Amount.SelectedValue.toUpperCase()&&null!=this.FromValue.Text&&""!=this.FromValue.Text.Trim()?e=" < "+this.FromValue.Text:"LESSTHANOREQUAL"==this.Amount.SelectedValue.toUpperCase()&&null!=this.FromValue.Text&&""!=this.FromValue.Text.Trim()?e=" <= "+this.FromValue.Text:"GREATERTHAN"==this.Amount.SelectedValue.toUpperCase()&&null!=this.FromValue.Text&&""!=this.FromValue.Text.Trim()?e=" > "+this.FromValue.Text:"GREATERTHAN OR EQUAL"==this.Amount.SelectedValue.toUpperCase()&&null!=this.FromValue.Text&&""!=this.FromValue.Text.Trim()&&(e=" >= "+this.FromValue.Text),e}}var p=s("KUE1"),T=s("ockk"),g=s("jDOZ"),b=s("1Cra");class P extends n.b{constructor(){super(),this.DisplayName="",this.IsPDCS=!0,this.Availed=new l.d(0),this.Limit=new l.d(0),this.SelectedValue=new l.d(0),this.Balance=new l.d(0),this.FilterDate=new h.a(0),this.Bank=new c.b(0),this.SearchText="",this.DialogResult=!1,this.FromDate=new Date,this.toDate=new Date,this.BankID=0,this.Filter=0,this.Status=0,this.FromValue=0,this.ToValue=0,this.DocList=new Array,this.Locations="",this.strAmountQry="",this.DocumentList="",this.LocationList="",this.PostonconversionDate=!1,this.PDCReceivableAccount=0,this.InterestRate=0,this.CommissionRate=0,this.ChequeDiscountLimit=0,this.Used=0,this.PDCDiscountAcc=0,this.BankCCNodeID=0,this.bankname="",this.MessageBank="",this.CheckedCnt=0,this.ScreenObject=new r.a(4e4,0),this.onLoad(),this.Bank.OnPactListBoxValueChanged.Subscribe(this,"onListSelectedChanged"),this.FilterDate.Label="Date",this.FilterDate.Date=new Date,this.Bank.Label="Bank",this.Bank.TypeID=51,this.Bank.CCID=2,this.Limit.Label="Limit",this.Availed.Label="Availed",this.SelectedValue.Label="Selected",this.Balance.Label="Balance",this.DialogResult=!1;let e=new S(this);i.a.page.ShowDialog(e,p.a,{ShowCenter:!i.a.IsMobile,NoWidth:!0}).subscribe(()=>{this.FillSearchDetails()})}FillSearchDetails(){this.Options=new D.e(0),this.SearchCols=new D.e(0),this.Options.Items.push(D.d.ComboBoxItems_2(i.a.GetResource("Com_Equals"),"1")),this.Options.Items.push(D.d.ComboBoxItems_2(i.a.GetResource("Com_NotEquals"),"2")),this.Options.Items.push(D.d.ComboBoxItems_2(i.a.GetResource("Com_BeginsWith"),"3")),this.Options.Items.push(D.d.ComboBoxItems_2(i.a.GetResource("Com_EndsWith"),"4")),this.Options.Items.push(D.d.ComboBoxItems_2(i.a.GetResource("Com_Contains"),"5")),this.Options.Items.push(D.d.ComboBoxItems_2(i.a.GetResource("Com_NotContains"),"6")),this.Options.SelectedValue="5",this.PstDocGrid.Columns.forEach(e=>{e.IsVisible&&"Sno"!=e.DisplayMember&&this.SearchCols.Items.push(D.d.ComboBoxItems_2(e.Header,e.DisplayMember))}),this.SearchCols.Items.length>0&&(this.SearchCols.SelectedValue=this.SearchCols.Items[0].Value)}onListSelectedChanged(e){if(Logger.InfoLog("ChequeDiscPostedDocumentViewModel ::Entering onListSelectedChanged"),null!=e&&this.Bank.SelectedValue>0){let e=i.a.common.GetDataSet("CD001",this.Bank.SelectedValue.toString());null!=e&&e.Tables.length>0&&e.Tables[0].length>0&&!o.e.IsEmpty(e.Tables[0][0].ACCOUNTID)&&(o.e.IsEmpty(e.Tables[0][0].InterestRate)||(this.InterestRate=parseFloat(e.Tables[0][0].InterestRate)),o.e.IsEmpty(e.Tables[0][0].CommissionRate)||(this.CommissionRate=parseFloat(e.Tables[0][0].CommissionRate)),o.e.IsEmpty(e.Tables[0][0].CheckDiscountLimit)||(this.ChequeDiscountLimit=parseFloat(e.Tables[0][0].CheckDiscountLimit)),e.Columns[0].Contains("Used")&&!o.e.IsEmpty(e.Tables[0][0].Used)&&(this.Used=parseFloat(e.Tables[0][0].Used)),this.ChequeDiscountLimit>0&&(this.Limit.Text=this.ChequeDiscountLimit.toString()))}}OnValueChange(e){null!=this.Limit.Text&&""!=this.Limit.Text||(this.Limit.Text="0"),null!=this.Availed.Text&&""!=this.Availed.Text||(this.Availed.Text="0"),null!=this.SelectedValue.Text&&""!=this.SelectedValue.Text||(this.SelectedValue.Text="0"),this.Balance.Text=(parseFloat(this.Limit.Text)-this.Used-parseFloat(this.Availed.Text)+parseFloat(this.SelectedValue.Text)).toString()}onLoad(){this.DisplayName="Cheque Discount Calculation",this.InitColumns()}oncellEditEnding(e){if("PACT.COMMON.PactTextBoxColumnEx"!=e.OriginalSource.Column.GetType().toString())return;let t=e.OriginalSource.RowDataItem.Row;if("Commission"==e.OriginalSource.Column.Binding.Path.Path||"Interest"==e.OriginalSource.Column.Binding.Path.Path){let e=0,s=0;o.e.IsEmpty(t.Interest)||(e=parseFloat(t.Interest.toString())),o.e.IsEmpty(t.Commission)||(s=parseFloat(t.Commission.toString())),t.Total=(e+s).toString(),t.AcceptChanges()}this.ShowColumnTotal()}InitColumns(){let e,t=[],s={};s.Name=i.a.GetResource("Pdc_Convert"),s.Value=1,s.Status=null,t.push(s),s={},s.Name=i.a.GetResource("Pdc_unConvert"),s.Value=2,s.Status=null,t.push(s),s={},s.Name=i.a.GetResource("DocumentDesigner_Bounce"),s.Value=0,s.Status=null,t.push(s),this.PstDocGrid=new u.a,this.PstDocGrid.CanUserSortColumns=!0,this.PstDocGrid.Columns=[],this.PstDocGrid.Width="",this.PstDocGrid.CellEditEnding.Subscribe(this,"oncellEditEnding"),e=new T.a,e.Header="CostcenterID",e.DisplayMember="CostcenterID",e.ReadOnly=!0,e.IsVisible=!1,e.Width=100,this.PstDocGrid.Columns.push(e),e=new T.a,e.Header="DocPrefix",e.DisplayMember="DocPrefix",e.ReadOnly=!0,e.IsVisible=!1,e.Width=100,this.PstDocGrid.Columns.push(e),e=new T.a,e.Header="DocNumber",e.DisplayMember="DocNumber",e.ReadOnly=!0,e.IsVisible=!1,e.Width=100,this.PstDocGrid.Columns.push(e),e=new T.a,e.Header=i.a.GetResource("DocumentDesigner_VoucherNo"),e.DisplayMember="VoucherNo",e.DataType="LINK",e.Click.Subscribe(this,"OnDocLink"),e.Width=100,this.PstDocGrid.Columns.push(e),e=new T.a,e.Header=i.a.GetResource("DocumentDesigner_VoucherDate"),e.DisplayMember="DocDateFormat",e.ReadOnly=!0,e.DataType="DATE",e.Width=80,this.PstDocGrid.Columns.push(e),e=new T.a,e.Header=i.a.GetResource("DocumentDesigner_Account"),e.DisplayMember="AccountID",e.ValueMember="AccountID_Key",e.ReadOnly=!0,e.Width=150,this.PstDocGrid.Columns.push(e),e=new T.a,e.Header=i.a.GetResource("DocumentDesigner_ChequeNo"),e.DisplayMember="ChequeNumber",e.ReadOnly=!0,e.Width=100,this.PstDocGrid.Columns.push(e),e=new T.a,e.Header="Maturity date",e.DisplayMember="ChequeDateFormat",e.ReadOnly=!0,e.DataType="DATE",e.Width=100,this.PstDocGrid.Columns.push(e),e=new T.a,e.Header=i.a.GetResource("DocumentDesigner_Amount"),e.DisplayMember="Amount",e.ReadOnly=!0,e.DataType="FLOAT",e.IsCalculated=1,e.Width=100,i.a.SessionManager.Preferences.ContainsKey("DecimalsinRate")&&""!=i.a.SessionManager.Preferences.DecimalsinRate&&(e.DecimalPoints=i.a.SessionManager.Preferences.DecimalsinRate),this.PstDocGrid.Columns.push(e),e=new T.a,e.Header=i.a.GetResource("Pref_Select"),e.DisplayMember="Action",e.DataType="CheckBox",e.Width=50,e.CheckedChanged.Subscribe(this,"OnCheckedChanged"),this.PstDocGrid.Columns.push(e),e=new T.a,e.Header="No Of Days",e.DisplayMember="NoOfDays",e.ReadOnly=!0,e.DataType="FLOAT",e.Width=100,this.PstDocGrid.Columns.push(e),e=new T.a,e.Header="Selected Amount",e.DisplayMember="SelectedAmount",e.ReadOnly=!0,e.DataType="FLOAT",e.ShowTotal=!0,e.Width=100,i.a.SessionManager.Preferences.ContainsKey("DecimalsinRate")&&""!=i.a.SessionManager.Preferences.DecimalsinRate&&(e.DecimalPoints=i.a.SessionManager.Preferences.DecimalsinRate),this.PstDocGrid.Columns.push(e),e=new T.a,e.Header="Interest",e.DisplayMember="Interest",e.DataType="FLOAT",e.ShowTotal=!0,e.Width=100,i.a.SessionManager.Preferences.ContainsKey("DecimalsinExtraFields")&&""!=i.a.SessionManager.Preferences.DecimalsinExtraFields&&(e.DecimalPoints=i.a.SessionManager.Preferences.DecimalsinExtraFields),this.PstDocGrid.Columns.push(e),e=new T.a,e.Header="Commission",e.DisplayMember="Commission",e.DataType="FLOAT",e.ShowTotal=!0,e.Width=100,i.a.SessionManager.Preferences.ContainsKey("DecimalsinExtraFields")&&""!=i.a.SessionManager.Preferences.DecimalsinExtraFields&&(e.DecimalPoints=i.a.SessionManager.Preferences.DecimalsinExtraFields),this.PstDocGrid.Columns.push(e),e=new T.a,e.Header="Total",e.DisplayMember="Total",e.ReadOnly=!0,e.DataType="FLOAT",e.ShowTotal=!0,e.Width=100,this.PstDocGrid.Columns.push(e),e=new T.a,e.Header=i.a.GetResource("DocumentDesigner_Bank"),e.DisplayMember="BankAccountID",e.ValueMember="BankAccountID_Key",e.DataType="LISTBOX",e.CostCenterID=2,e.TypeID=51,e.Width=150,e.ReadOnly=!0,this.PstDocGrid.Columns.push(e),e=new T.a,e.Header="Discounted",e.DisplayMember="ConvertedVoucherNO",e.DataType="LINK",e.Click.Subscribe(this,"OnConvertedDocLink"),e.Width=100,this.PstDocGrid.Columns.push(e)}OnCheckedChanged(e,t){if(0==this.Filter){let s=e.Row;if(t){o.e.IsEmpty(this.SelectedValue.Text)&&(this.SelectedValue.Text="0"),o.e.IsEmpty(this.Limit.Text)&&(this.Limit.Text="0"),o.e.IsEmpty(this.Availed.Text)&&(this.Availed.Text="0");let e=0;this.SelectedValue.Text=(parseFloat(this.SelectedValue.Text)+parseFloat(s.Amount)).toString(),e=parseFloat(this.Limit.Text)-this.Used-parseFloat(this.Availed.Text)-parseFloat(this.SelectedValue.Text),e>parseFloat(this.Limit.Text)?(alert("Balance exceeds Limit "),this.SelectedValue.Text=(parseFloat(this.SelectedValue.Text)-parseFloat(s.Amount)).toString(),s.Action=!1):(this.Balance.Text=e.toString(),s.SelectedAmount=parseFloat(s.Amount).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount),s.NoOfDays=o.e.IsEmpty(s.ChequeMaturityDate)?"0":this.FilterDate.Date.Subtract(new Date(s.ChequeMaturityDate)).Days,s.Interest=(parseFloat(s.SelectedAmount)*this.InterestRate/100/365*parseInt(s.NoOfDays.toString())*-1).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount),s.Commission=(parseFloat(s.SelectedAmount)*this.CommissionRate/100/365*parseInt(s.NoOfDays.toString())*-1).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount),s.Total=(parseFloat(s.Interest)+parseFloat(s.Commission)).toString(),s.Action=!0)}else s.Action=!1,s.SelectedAmount="0",s.NoOfDays="0",s.Interest="0",s.Commission="0",s.Total="0";this.ShowColumnTotal()}}ShowColumnTotal(){let e=0,t=0,s=0,n=0;for(let i=0;i<this.PstDocGrid.Table.length;i++)Object(a.j)(this.PstDocGrid.Table[i].Action)&&(null!=this.PstDocGrid.Table[i].Amount&&(e+=parseFloat(this.PstDocGrid.Table[i].Amount)),null!=this.PstDocGrid.Table[i].Interest&&(t+=parseFloat(this.PstDocGrid.Table[i].Interest)),null!=this.PstDocGrid.Table[i].Commission&&(s+=parseFloat(this.PstDocGrid.Table[i].Commission)),null!=this.PstDocGrid.Table[i].Total&&(n+=parseFloat(this.PstDocGrid.Table[i].Total)));this.SelectedValue.Text=e.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount),o.e.IsEmpty(this.Availed.Text)&&(this.Availed.Text="0"),o.e.IsEmpty(this.Limit.Text)&&(this.Limit.Text="0"),this.Balance.Text=(parseFloat(this.Limit.Text)-this.Used-parseFloat(this.Availed.Text)-parseFloat(this.SelectedValue.Text)).toString(),this.PstDocGrid.Columns[11].footer=e.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount),this.PstDocGrid.Columns[12].footer=t.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount),this.PstDocGrid.Columns[13].footer=s.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount),this.PstDocGrid.Columns[14].footer=n.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount),this.PstDocGrid.UpdateFooter()}OnDocLink(e){}OnConvertedDocLink(e){if(null!=this.PstDocGrid.SelectedItem&&!o.e.IsEmpty(this.PstDocGrid.SelectedItem.ConvertedDocNo))try{this.ScreenObject.GetDocDetailsByAccID(parseInt(this.PstDocGrid.SelectedItem.ConvertedAccDocID.toString()))}catch(t){Logger.ErrorLog("PostedDocumentViewModel","OnLinkClickEvent",t.Message)}}LoadData(){let e,t=[];t.push(this.FromDate.ToString("dd/MMM/yyyy")),t.push(this.toDate.ToString("dd/MMM/yyyy")),t.push(this.strAmountQry),t.push(this.DocumentList),t.push(this.BankID),t.push(this.BankCCNodeID),t.push(this.Filter),t.push(this.LocationList),g.a.GetPDRChequeDiscount(t).subscribe(t=>{e=t,this.ScreenObject.DocID=t.RetValue,null!=e&&e.Tables.length>1&&e.Tables[1].length>0&&(this.bankname=e.Tables[1][0].AccountName.toString()),this.LoadDashData(e.Tables[0]),null!=e&&e.Tables.length>1&&e.Tables[1].length>0&&(this.bankname=e.Tables[1][0].AccountName.toString(),this.InterestRate=parseFloat(e.Tables[1][0].INTERESTRATE),this.CommissionRate=parseFloat(e.Tables[1][0].COMMISSIONRATE),this.ChequeDiscountLimit=parseFloat(e.Tables[1][0].CHECKDISCOUNTLIMIT),e.Columns[1].Contains("Used")&&!o.e.IsEmpty(e.Tables[1][0].Used)&&(this.Used=parseFloat(e.Tables[1][0].Used.toString()))),this.Bank.SelectedValue=this.BankCCNodeID,this.ChequeDiscountLimit>0&&(this.Limit.Text=this.ChequeDiscountLimit.toString()),0==this.Filter?(this.IsPDCS=!0,this.PstDocGrid.Columns[10].IsVisible=!0,this.PstDocGrid.Columns[11].IsVisible=!0,this.PstDocGrid.Columns[12].IsVisible=!0,this.PstDocGrid.Columns[13].IsVisible=!0,this.PstDocGrid.Columns[14].IsVisible=!0,this.PstDocGrid.Columns[16].IsVisible=!1):(this.IsPDCS=!1,this.PstDocGrid.Columns[10].IsVisible=!1,this.PstDocGrid.Columns[11].IsVisible=!1,this.PstDocGrid.Columns[12].IsVisible=!1,this.PstDocGrid.Columns[13].IsVisible=!1,this.PstDocGrid.Columns[14].IsVisible=!1,this.PstDocGrid.Columns[16].IsVisible=!0),this.ShowColumnTotal()},e=>{console.log(e),this.DisplayMessage="Error loading Data..."})}LoadDashData(e){e.length>0&&null==e[0].Sno?(this.PstDocGrid.TableColumns.push("Sno"),this.PstDocGrid.TableColumns.push("DocDateFormat"),this.PstDocGrid.TableColumns.push("ChequeDateFormat"),this.PstDocGrid.TableColumns.push("CostcenterID"),this.PstDocGrid.TableColumns.push("clrDate"),this.PstDocGrid.TableColumns.push("clrDate_Key"),this.PstDocGrid.TableColumns.push("Action"),this.PstDocGrid.TableColumns.push("StatusForDisplay"),this.PstDocGrid.TableColumns.push("ConvertedDocNo"),this.PstDocGrid.TableColumns.push("ConvertedAccDocID"),this.PstDocGrid.TableColumns.push("NoOfDays"),this.PstDocGrid.TableColumns.push("SelectedAmount"),this.PstDocGrid.TableColumns.push("Commission"),this.PstDocGrid.TableColumns.push("Interest"),this.PstDocGrid.TableColumns.push("Total")):this.PstDocGrid.TableColumns.Contains("Sno")||(this.PstDocGrid.TableColumns.push("Sno"),this.PstDocGrid.TableColumns.push("DocDateFormat"),this.PstDocGrid.TableColumns.push("ChequeDateFormat"),this.PstDocGrid.TableColumns.push("CostcenterID"),this.PstDocGrid.TableColumns.push("clrDate"),this.PstDocGrid.TableColumns.push("clrDate_Key"),this.PstDocGrid.TableColumns.push("Action"),this.PstDocGrid.TableColumns.push("StatusForDisplay"),this.PstDocGrid.TableColumns.push("ConvertedDocNo"),this.PstDocGrid.TableColumns.push("ConvertedAccDocID"),this.PstDocGrid.TableColumns.push("NoOfDays"),this.PstDocGrid.TableColumns.push("SelectedAmount"),this.PstDocGrid.TableColumns.push("Commission"),this.PstDocGrid.TableColumns.push("Interest"),this.PstDocGrid.TableColumns.push("Total"));for(let t=0;t<=e.length-1;t++)o.e.IsEmpty(e[t].DocDate)||(e[t].DocDateFormat=!i.a.SessionManager.Preferences.ContainsKey("Date Format")||o.e.IsEmpty(i.a.SessionManager.Preferences["Date Format"])||o.e.IsEmpty(e[t].DocDate)?new Date(e[t].DocDate.toString()).ToString("dd/MMM/yyyy"):new Date(e[t].DocDate.toString()).ToString(i.a.SessionManager.Preferences["Date Format"])),e[t].BankAccountID_Key=this.BankCCNodeID,e[t].BankAccountID=this.bankname,o.e.IsEmpty(e[t].Amount)||(e[t].Amount=!i.a.SessionManager.Preferences.ContainsKey("DecimalsinAmount")||o.e.IsEmpty(i.a.SessionManager.Preferences.DecimalsinAmount)||o.e.IsEmpty(e[t].Amount)?parseFloat(e[t].Amount.toString()).ToString("N2"):parseFloat(e[t].Amount).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount)),o.e.IsEmpty(e[t].ConvertedVoucherNO)||(e[t].ConvertedDocNo=e[t].ConvertedVoucherNO),o.e.IsEmpty(e[t].ConvertedDocID)||(e[t].ConvertedAccDocID=e[t].ConvertedDocID),o.e.IsEmpty(e[t].ChequeMaturityDate)||(e[t].ChequeDateFormat=!i.a.SessionManager.Preferences.ContainsKey("Date Format")||o.e.IsEmpty(i.a.SessionManager.Preferences["Date Format"])||o.e.IsEmpty(e[t].DocDate)?new Date(e[t].ChequeMaturityDate.toString()).ToString("dd/MMM/yyyy"):new Date(e[t].ChequeMaturityDate.toString()).ToString(i.a.SessionManager.Preferences["Date Format"])),e[t].Action=!1,this.PstDocGrid.updateRow(e[t])}ButtonSave(e){if(this.DisplayMessage="","Save"==e.toString()||"unpost"==e.toString()){this.DisplayMessage="";let e=this.GetPDReceiptXML();if(""!=this.DisplayMessage)return void(this.MessageVisibility=!0);if(0==this.CheckedCnt)this.DisplayMessage=" Please select a record ",this.MessageVisibility=!0;else if(e.length>0){let t=0;g.a.SetChequeDiscDocuments(e,this.FilterDate.Date).subscribe(e=>{this.DisplayMessage=e.Message,t=e.RetValue,t>0?(this.LoadData(),this.MessageVisibility=!0,this.ShowColumnTotal(),this.Limit.Text="",this.Availed.Text="",this.SelectedValue.Text="",this.Balance.Text=""):this.MessageVisibility=!0},e=>{console.log(e),this.DisplayMessage="Error in save"})}else this.DisplayMessage=" PDC Account Not Set For "+this.MessageBank,this.MessageVisibility=!0}else if("Search"==e)this.SearchGrid();else if("Refresh"==e){let e=new S(this);i.a.page.ShowDialog(e,p.a,{ShowCenter:!i.a.IsMobile,NoWidth:!0})}else if("Calculate"==e)for(let t=0;t<this.PstDocGrid.Table.length;t++)Object(a.j)(this.PstDocGrid.Table[t].Action)?(this.PstDocGrid.Table[t].Interest=(parseFloat(this.PstDocGrid.Table[t].SelectedAmount)*this.InterestRate/100/365*parseInt(this.PstDocGrid.Table[t].NoOfDays)).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount),this.PstDocGrid.Table[t].Commission=(parseFloat(this.PstDocGrid.Table[t].SelectedAmount)*this.CommissionRate/100/365*parseInt(this.PstDocGrid.Table[t].NoOfDays)).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount),this.PstDocGrid.Table[t].Total=(parseFloat(this.PstDocGrid.Table[t].Interest)+parseFloat(this.PstDocGrid.Table[t].Commission)).toString(),this.PstDocGrid.Table[t].Action=!0):(this.PstDocGrid.Table[t].Action=!1,this.PstDocGrid.Table[t].SelectedAmount="0",this.PstDocGrid.Table[t].NoOfDays="0",this.PstDocGrid.Table[t].Interest="0",this.PstDocGrid.Table[t].Commission="0",this.PstDocGrid.Table[t].Total="0"),this.ShowColumnTotal()}SearchGrid(){if(o.e.IsEmpty(this.SearchText))return;let e="";if(""!=this.SearchCols.SelectedValue)e=this.SearchCols.SelectedValue;else{if(!(this.SearchCols.Items.length>0))return;e=this.SearchCols.Items[0].Value}if(!this.PstDocGrid.TableColumns.Contains(e))return;let t=this.PstDocGrid.SelectedIndex;-1==t&&(t=0);for(let s=0;s<this.PstDocGrid.Table.length;s++)if(t<this.PstDocGrid.Table.length-1?t++:t=0,!o.e.IsEmpty(this.PstDocGrid.Table[t][e]))switch(this.Options.SelectedValue){case"1":if(this.PstDocGrid.Table[t][e].toString().toLowerCase()==this.SearchText.toLowerCase())return void this.Setselectedrow(t);break;case"2":if(this.PstDocGrid.Table[t][e].toString().toLowerCase()!=this.SearchText.toLowerCase())return void this.Setselectedrow(t);break;case"3":if(this.PstDocGrid.Table[t][e].toString().toLowerCase().startsWith(this.SearchText.toLowerCase()))return void this.Setselectedrow(t);break;case"4":if(this.PstDocGrid.Table[t][e].toString().toLowerCase().endsWith(this.SearchText.toLowerCase()))return void this.Setselectedrow(t);break;case"5":if(this.PstDocGrid.Table[t][e].toString().toLowerCase().Contains(this.SearchText.toLowerCase()))return void this.Setselectedrow(t);break;case"6":if(!this.PstDocGrid.Table[t][e].toString().toLowerCase().Contains(this.SearchText.toLowerCase()))return void this.Setselectedrow(t)}}Setselectedrow(e){this.PstDocGrid.SelectedItem=this.PstDocGrid.Table[e]}GetPDReceiptXML(){Logger.InfoLog("ChequeDiscPostedDocumentViewModel ::Entering GetPDReceiptXML");let e="",t="",s=null;if(this.CheckedCnt=0,0==this.Filter){for(let s=0;s<this.PstDocGrid.Table.length;s++)if(null!=this.PstDocGrid.Table[s].Action&&!o.e.IsEmpty(this.PstDocGrid.Table[s].Action)&&Object(a.j)(this.PstDocGrid.Table[s].Action)){if(""!=e&&(e+=",",t+=","),e+=this.PstDocGrid.Table[s].CostCenterID.toString(),o.e.IsEmpty(this.PstDocGrid.Table[s].BankAccountID_Key))return this.DisplayMessage="Select Bank at Row No:"+(s+1).toString(),this.MessageVisibility=!0,"";t+=this.PstDocGrid.Table[s].BankAccountID_Key.toString()}""!=e&&(s=g.a.GetDiscountfields(e,t))}let i="";i+="<PDR>";let n=0;for(let u=0;u<this.PstDocGrid.Table.length;u++)if(null!=this.PstDocGrid.Table[u].Action&&!o.e.IsEmpty(this.PstDocGrid.Table[u].Action)&&Object(a.j)(this.PstDocGrid.Table[u].Action)){if(0==this.Filter){let e=null,t=s.Tables[0].filter(e=>e.CostCenterID==this.PstDocGrid.Table[u].CostCenterID.toString());if(t.length>0){let a=null;if(""==t[0].OnDiscount.toString()||!o.e.IsEmpty(t[0].OnDiscount)&&parseInt(t[0].OnDiscount.toString())<4e4)return this.DisplayMessage="Define Discount Document ",this.MessageVisibility=!0,"";if(o.e.IsEmpty(t[0].OnDiscount)||(n=parseInt(t[0].OnDiscount.toString()),a=new b.AddEditDocumentViewModel(n,"",!1)),null!=a){if(e=s.Tables[2].find(e=>e.AccountID==this.PstDocGrid.Table[u].BankAccountID_Key.toString()),0==e.length||""==e[0].PDCDiscountAccount.toString()||"0"==e[0].PDCDiscountAccount.toString())return this.DisplayMessage="Define PDC Discount Account for "+this.PstDocGrid.Table[u].BankAccountID.toString(),this.MessageVisibility=!0,"";let n=a.ScreenObject.GridDataObj.NewRow();a.ScreenObject.GridDataColumns.Contains("CreditAccount_Key")&&(n.CreditAccount_Key=e[0].PDCDiscountAccount.toString()),null==a.ScreenObject.DebitAccount||o.e.IsEmpty(this.PstDocGrid.Table[u].BankAccountID_Key)?a.ScreenObject.GridDataColumns.Contains("DebitAccount_Key")&&(n.DebitAccount_Key=this.PstDocGrid.Table[u].BankAccountID_Key.toString()):a.ScreenObject.DebitAccount.SelectedValue=parseInt(this.PstDocGrid.Table[u].BankAccountID_Key.toString()),a.ScreenObject.GridDataColumns.Contains("Amount")&&!o.e.IsEmpty(this.PstDocGrid.Table[u].Amount)&&(n.Amount=this.PstDocGrid.Table[u].Amount.toString()),a.ScreenObject.GridDataColumns.Contains("CommonNarration")?n.CommonNarration=this.PstDocGrid.Table[u].CommonNarration.toString():null!=(r=a.ScreenObject._StaticFields.find(e=>"commonnarration"==e.DBColumnName.toLowerCase()))&&r instanceof l.d&&!o.e.IsEmpty(this.PstDocGrid.Table[u].CommonNarration)&&(r.Text=this.PstDocGrid.Table[u].CommonNarration.toString()),a.ScreenObject.GridDataColumns.Contains("LineNarration")&&(n.LineNarration=this.PstDocGrid.Table[u].LineNarration.toString()),a.ScreenObject.GridDataColumns.Contains("ChequeNumber")?n.ChequeNumber=this.PstDocGrid.Table[u].ChequeNumber.toString():null!=(r=a.ScreenObject._StaticFields.find(e=>"chequenumber"==e.DBColumnName.toLowerCase()))&&r instanceof l.d&&!o.e.IsEmpty(this.PstDocGrid.Table[u].chequenumber)&&(r.Text=this.PstDocGrid.Table[u].chequenumber.toString()),a.ScreenObject.GridDataColumns.Contains("ChequeMaturityDate")?n.ChequeMaturityDate=this.PstDocGrid.Table[u].ChequeMaturityDate.toString():null!=(r=a.ScreenObject._StaticFields.find(e=>"chequematuritydate"==e.DBColumnName.toLowerCase()))&&r instanceof h.c&&!o.e.IsEmpty(this.PstDocGrid.Table[u].ChequeMaturityDate)&&(r.Date=new Date(this.PstDocGrid.Table[u].ChequeMaturityDate.toString())),a.ScreenObject.GridDataColumns.Contains("ChequeDate")&&(n.ChequeDate=this.PstDocGrid.Table[u].ChequeDate.toString()),s.Tables[1].find(e=>e.CostCenterID==t[0].OnDiscount.toString()&&e.SysColumnName==t[0].DiscountCommisionFld.toString()).length>0&&(this.PstDocGrid.Table[u].Commission.toString().Replace(",",""),a.ScreenObject.GridDataColumns.Contains(t[0].DiscountCommisionFld.toString())&&!o.e.IsEmpty(this.PstDocGrid.Table[u].Commission)&&(n[t[0].DiscountCommisionFld.toString()]=this.PstDocGrid.Table[u].Commission.toString().Replace(",","")),a.ScreenObject.GridDataColumns.Contains(t[0].DiscountInterestFld.toString())&&""!=this.PstDocGrid.Table[u].Interest.toString().Replace(",","")&&(n[t[0].DiscountInterestFld.toString()]=this.PstDocGrid.Table[u].Interest.toString().Replace(",","")));for(let e=0;e<this.PstDocGrid.TableColumns.length;e++)if(this.PstDocGrid.TableColumns[e].toLowerCase().Contains("alpha")&&!o.e.IsEmpty(this.PstDocGrid.Table[u][this.PstDocGrid.TableColumns[e]]))a.ScreenObject.GridDataColumns.Contains(this.PstDocGrid.TableColumns[e])?n[this.PstDocGrid.TableColumns[e]]=this.PstDocGrid.Table[u][this.PstDocGrid.TableColumns[e]].toString():null!=(r=a.ScreenObject._TextFields.find(t=>t.DBColumnName.toLowerCase()==this.PstDocGrid.TableColumns[e].toLowerCase()))&&a.ScreenObject.fillcontrolValue(r,this.PstDocGrid.Table[u][this.PstDocGrid.TableColumns[e]].toString());else if(this.PstDocGrid.TableColumns[e].toLowerCase().Contains("dcccnid")&&""!=this.PstDocGrid.Table[u][this.PstDocGrid.TableColumns[e]].toString()&&parseInt(this.PstDocGrid.Table[u][this.PstDocGrid.TableColumns[e]].toString())>1){var r;a.ScreenObject.GridDataColumns.Contains(this.PstDocGrid.TableColumns[e])?n[this.PstDocGrid.TableColumns[e]+"_Key"]=this.PstDocGrid.Table[u][this.PstDocGrid.TableColumns[e]].toString():null!=(r=a.ScreenObject._CCFields.find(t=>t.DBColumnName.toLowerCase()==this.PstDocGrid.TableColumns[e].toLowerCase()))&&r instanceof c.b&&""!=this.PstDocGrid.Table[u].ChequeMaturityDate.toString()&&(r.SelectedValue=parseInt(this.PstDocGrid.Table[u][this.PstDocGrid.TableColumns[e]].toString()))}if(a.ScreenObject.GridData.InsertAt(n,0),a.CalculateTotals(n,!1),a.IsAutoPost=!0,a.DisplayMessage="",a.SaveAccountingDocument("Save"),""!=a.DisplayMessage)return this.DisplayMessage=a.DisplayMessage,this.MessageVisibility=!0,"";i+='<ROWS><Documents  Action="'+this.Filter+'" AccID="'+this.PstDocGrid.Table[u].AccDocDetailsID.toString()+'" DocID="'+this.PstDocGrid.Table[u].DocID.toString()+'" CostcenterID="'+this.PstDocGrid.Table[u].CostCenterID.toString()+'"></Documents>'+a.AutoPOstXML+"</ROWS>"}}}else i+='<ROWS><Documents  Action="'+this.Filter+'" AccID="'+this.PstDocGrid.Table[u].AccDocDetailsID.toString()+'" DocID="'+this.PstDocGrid.Table[u].DocID.toString()+'" CostcenterID="'+this.PstDocGrid.Table[u].CostCenterID.toString()+'"></Documents></ROWS>';this.CheckedCnt++}return i+="</PDR>",Logger.InfoLog("ChequeDiscPostedDocumentViewModel ::Exiting GetPDReceiptXML"),i.toString()}}},ouML:function(e,t,s){"use strict";s.r(t),s.d(t,"DocumentDraftsViewModel",(function(){return u}));var i=s("mrSG"),o=s("Do2H"),a=s("Lp6j"),n=s("ScVY"),r=s("8B8H"),l=s("ockk"),h=s("rJVx"),c=s("CUWK");class u extends n.b{constructor(e,t,s=0){if(super(),this.Grid=new r.a,this.IsFromDocs=!1,this.PopupWidth=0,this.ReportType=0,this.Parent=null,this.CCID=0,this.WID=0,this.LevelID=0,this.PactGridVisible=!1,this.CCID=s,this.Parent=e,this.ReportType=t,this.Parent instanceof h.GeneralDashboardViewModel||"DashAddOnsViewModel"==this.Parent.ClassName)1==t&&(this.ColSource=h.GeneralDashboardViewModel.InitColumns("Document Drafts_DashBoardCustomize"));else{let e;1==t?this.DisplayName="Drafts":2==t?this.DisplayName="Hold Documents":3==t?this.DisplayName="Approval History":4==t&&(this.DisplayName="Level Info",this.PactGrid=new r.a),this.Title=this.DisplayName,this.IsFromDocs=!0,this.FillGrid(),this.Grid.OnLinkClick.Subscribe(this,"GridLinkClick"),this.ColSource=[],1==t?(this.ColSource=h.GeneralDashboardViewModel.InitColumns("Document Drafts_DashBoardCustomize"),this.PopupWidth=22,this.ColSource.forEach(e=>{this.PopupWidth=this.PopupWidth+e.Width})):2==t?(e=new l.a,e.DataType="TextBlock",e.Header="Hold Date",e.DisplayMember="HoldDate_Key",e.Width=100,this.ColSource.push(e),e=new l.a,e.DataType="LINK",e.Header=o.a.GetResource("DocName"),e.DisplayMember="DocName",e.Width=135,this.ColSource.push(e),e=new l.a,e.DataType="TextBlock",e.Header="NetValue",e.DisplayMember="NetValue",e.Width=100,this.ColSource.push(e),e=new l.a,e.DataType="TextBlock",e.Header="NoOfProducts",e.DisplayMember="NoOfProducts",e.Width=50,this.ColSource.push(e),e=new l.a,e.DataType="LINK",e.Header=o.a.GetResource("Delete"),e.DisplayMember="Delete",e.Width=100,this.ColSource.push(e),this.PopupWidth=450):3==t?(e=new l.a,e.DataType="TextBlock",e.Header="User",e.DisplayMember="CreatedBy",e.Width=90,this.ColSource.push(e),e=new l.a,e.DataType="TextBlock",e.Header="FirstName",e.DisplayMember="FirstName",e.Width=90,this.ColSource.push(e),e=new l.a,e.DataType="TextBlock",e.Header="LastName",e.DisplayMember="LastName",e.Width=90,this.ColSource.push(e),e=new l.a,e.DataType="TextBlock",e.Header="Email",e.DisplayMember="Email1",e.Width=150,this.ColSource.push(e),e=new l.a,e.DataType="TextBlock",e.Header=o.a.GetResource("Date"),e.DisplayMember="AppDate",e.Width=128,this.ColSource.push(e),e=new l.a,e.DataType="LINK",e.Header="Level",e.DisplayMember="LevelName",e.Width=93,this.ColSource.push(e),e=new l.a,e.DataType="TextBlock",e.Header="Status",e.DisplayMember="Status",e.Width=80,this.ColSource.push(e),e=new l.a,e.DataType="Format",e.Header="Remarks",e.DisplayMember="Remarks",e.Width=190,this.ColSource.push(e),this.PopupWidth=950,"AddEditDocumentViewModel"==this.Parent.ClassName&&(e=new l.a,e.Header="WorkFlowName",e.DisplayMember="WorkFlowName",e.Width=200,this.ColSource.push(e)),this.PopupWidth=950):4==t&&(e=new l.a,e.DataType="TextBlock",e.ReadOnly=!0,e.Header="User Name",e.DisplayMember="UserName",e.Width=120,this.ColSource.push(e),e=new l.a,e.DataType="TextBlock",e.ReadOnly=!0,e.Header="First Name",e.DisplayMember="FirstName",e.Width=120,this.ColSource.push(e),e=new l.a,e.DataType="TextBlock",e.ReadOnly=!0,e.Header="Last Name",e.DisplayMember="LastName",e.Width=120,this.ColSource.push(e),this.PactGrid.Columns=this.ColSource,this.PopupWidth=400)}}get Table(){return this.Grid.Table}set Table(e){this.Grid.Table=e}get TableColumns(){return this.Grid.TableColumns}set TableColumns(e){this.Grid.TableColumns=e}get ColSource(){return this.Grid.Columns}set ColSource(e){this.Grid.Columns=e}get SelectedRow(){return this.Grid.SelectedItem}set SelectedRow(e){this.Grid.SelectedItem=e}onClick(e){event.preventDefault(),null!=this.SelectedRow&&this.LoadDraft(this.SelectedRow)}FillGrid(){let e=0,t=null;if(a.e.IsType(this.Parent,"AddEditDocumentViewModel")?(t=this.Parent,e=0==this.CCID?t.CostCenterID:this.CCID):a.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName||(e=this.CCID),1==this.ReportType||2==this.ReportType){let s;s=a.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName?null==t||38!=t.ScreenObject.DocumentType&&39!=t.ScreenObject.DocumentType?o.a.document.GetDocumentDrafts(0,e,this.ReportType,!1):o.a.document.GetDocumentDrafts(t.ScreenObject.RegisterNodeID,e,this.ReportType,!1,!0):o.a.document.GetDocumentDrafts(0,this.Parent.CostCenterID,this.ReportType,!1),s.subscribe(e=>{this.Table=e.Tables[0],this.Grid.TableColumns.Contains("Date_Text")||(this.Grid.TableColumns.push("Date_Text"),this.Grid.TableColumns.push("Delete")),this.Grid.TableColumns.Contains("HoldDate_Key")||this.Grid.TableColumns.push("HoldDate_Key"),this.Table.forEach(e=>{e.Delete="Delete",e.id=o.a.slick.rowid,e.Date_Text=new Date(e.Date).ToString(o.a.SessionManager.Preferences["Date Format"]+" hh:mm a"),null!=e.HoldDate&&(e.HoldDate_Key=new Date(e.HoldDate).ToString(o.a.SessionManager.Preferences["Date Format"]))})})}else if(3==this.ReportType){let t=null;if(a.e.IsType(this.Parent,"AddEditDocumentViewModel")?(t=this.Parent.ScreenObject.GetDocStatusHistory(),t.Tables.length>1&&t.Tables[1].length>0&&t.Columns[1].Contains("WID")&&(this.WID=parseInt(t.Tables[1][0].WID))):a.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName?a.e.IsEmpty(this.Parent.ClassName)||"AddEditCasesViewModel"!=this.Parent.ClassName||(t=this.GetDocStatusHistory(73,this.Parent.CaseID,!1)):t=o.a.rental.GetHistory(e,this.Parent.ContractID),null!=t&&t.Tables.length>0){this.Table=t.Tables[0],this.Grid.TableColumns.push("AppDate");for(let t=0;t<this.Table.length;t++)""!=this.Table[t].Date.toString()&&(this.Table[t].AppDate=new Date(this.Table[t].Date.toString()).ToString(o.a.SessionManager.Preferences["Date Format"]+" hh:mm a"));let e=0,s=0;this.Table.length>0&&(e=a.e.IntTryParse(this.Table[this.Table.length-1].WorkFlowLevel.toString()),s=a.e.IntTryParse(this.Table[this.Table.length-1].StatusID.toString())),369!=s&&(t.Tables[1]=t.Tables[1].filter(t=>t.levelID>e),t.Tables[1].forEach(e=>{let t=this.Grid.NewRow();t.LevelName=e.LevelName,t.Status="Pending",t.WorkFlowLevel=e.LevelID,this.Grid.addRow(t)}));for(let t=this.Table.length;t<7;t++)this.Grid.addEmptyRow()}}else if(4==this.ReportType){let e=null;if("WFLevelDoc"==this.Parent.ClassName?e=o.a.SessionManager.Preferences.ContainsKey("CanApproveFunction")&&"True"==o.a.SessionManager.Preferences.CanApproveFunction?o.a.report.GetExtWFDet(this.Parent.WID,this.Parent.LevelID,this.Parent.ccid,this.Parent.DOcId):o.a.report.GetWorkFlowLevelDetails(this.Parent.WID,this.Parent.LevelID,this.Parent.ccDate):this.Parent instanceof u&&(o.a.SessionManager.Preferences.ContainsKey("CanApproveFunction")&&"True"==o.a.SessionManager.Preferences.CanApproveFunction?"AddEditDocumentViewModel"==this.Parent.Parent.ClassName?e=o.a.report.GetExtWFDet(this.Parent.WID,this.Parent.LevelID,this.Parent.Parent.CostCenterID,this.Parent.Parent.ScreenObject.DocID):"ReportViewModel"==this.Parent.Parent.ClassName&&"INV_ComparisonReport"==this.Parent.Parent.StaticReportObject&&(e=o.a.report.GetExtWFDet(this.Parent.WID,this.Parent.LevelID,this.Parent.Parent.StaticReportObject.QuotationDocument,this.Parent.Parent.StatusDocID)):e=o.a.report.GetWorkFlowLevelDetails(this.Parent.WID,this.Parent.LevelID,"AddEditDocumentViewModel"==this.Parent.Parent.ClassName?this.Parent.Parent.ScreenObject.DocDate.Date:Date.Today())),null!=e){for(let t=e.Tables[0].length;t<8;t++)e.Tables[0].push();this.PactGrid.Table=e.Tables[0]}this.PactGrid.Width="",this.PactGrid.SearchVisible=!0,this.PactGrid.SearchCols.Width="85",this.PactGrid.SearchOptions.Width="90",this.PactGrid.SearchText.Width="110",this.PactGridVisible=!0}}GetDocStatusHistory(e,t,s){Logger.InfoLog("DocumentDraftsViewModel:: Inside GetDocStatusHistory");let i=[];i.push(e),i.push(t),i.push(s),i.push(o.a.SessionManager.UserID),i.push(o.a.SessionManager.LanguageID);let a=o.a.document.GetDocStatusHistory(i);return Logger.InfoLog("DocumentDraftsViewModel:: Exiting GetDocStatusHistory"),a}OnButtonClick(e){"Cancel"==e.toString()&&(a.e.IsType(this.Parent,"AddEditDocumentViewModel")&&this.CCID>0&&(this.Parent.res="No"),o.a.page.HideDialog())}DeleteDraft(e){let t;t=a.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName?o.a.document.DeleteDocumentDraft(parseInt(e.DraftID)):o.a.rental.DeleteQuotation(parseInt(e.CostCenterID),parseInt(e.DraftID)),t.RetValue>0&&this.Grid.removeRow(e)}LoadDraft(e){return Object(i.b)(this,void 0,void 0,(function*(){if(a.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName){const{AddEditDocumentViewModel:t}=yield Promise.all([s.e(2),s.e(1),s.e(3),s.e(5),s.e(4),s.e(6),s.e(7),s.e(10),s.e(9),s.e(12),s.e(11),s.e(13),s.e(19),s.e(15),s.e(21),s.e(20),s.e(16),s.e(14),s.e(18),s.e(17),s.e(22),s.e(89)]).then(s.bind(null,"1Cra")),{AddEditDocumentComponent:i}=yield Promise.all([s.e(4),s.e(6)]).then(s.bind(null,"MCKn"));let a,n;n=o.a.document.GetDocumentDrafts(parseInt(e.DraftID),0,1,!1),n.subscribe(s=>{if(a=s.Tables[0],null!=a&&a.length>0)if("AddEditDocumentViewModel"==this.Parent.ClassName||"POSDocumentViewModel"==this.Parent.ClassName)this.CCID>0||(this.Parent.clear(1),this.Parent.LoadDraftXML(a[0]),o.a.page.HideDialog(),this.Parent.ScreenObject.GridDataObj.RefreshGridView());else{let s=1==this.ReportType,n=new t(parseInt(e.CostCenterID),e.Type.toString(),s);o.a.page.addNewTab({component:i,params:{obj:n}}),n.LoadDraftXML(a[0],s)}})}else c.RibbonExtViewModel.LoadDraftRentalContract(this.Parent,parseInt(e.DraftID)),o.a.page.HideDialog()}))}GridLinkClick(e,t,s){event.preventDefault(),"Delete"==t?this.DeleteDraft(e):"Date_Text"!=t&&"DocName"!=t||this.LoadDraft(e)}}},rJVx:function(e,t,s){"use strict";s.r(t),s.d(t,"GeneralDashboardViewModel",(function(){return c}));var i=s("mrSG"),o=s("Do2H"),a=s("Lp6j"),n=s("ScVY"),r=s("NkMH"),l=s("ockk"),h=s("JIg3");class c extends n.b{constructor(){super(),this.ButtonPDC=new r.a,this.timerdashboard=new a.d,this.Date=new h.a(0),this.tdMaximize=new Array(4).fill(!1),Logger.InfoLog("DashboardViewModel::Entering DashboardViewModel"),this.timerdashboard.Enabled=!0,this.timerdashboard.Interval=6e4,o.a.SessionManager.IsWebApplication||this.timerdashboard.Elapsed(this,"timerdashboard_Elapsed"),this.DisplayName=o.a.GetResource("Dashboard_Maindashboard"),this.loadDrafts(),Logger.InfoLog("DashboardViewModel::Exiting DashboardViewModel")}loadDrafts(){return Object(i.b)(this,void 0,void 0,(function*(){const{DocumentDraftsViewModel:e}=yield s.e(150).then(s.bind(null,"ouML"));this.DocumentDrafts=new e(this,1),setTimeout(()=>{this.DocumentDrafts.FillGrid()},500);const{UnAppDocumentsViewModel:t}=yield s.e(0).then(s.bind(null,"AyOk"));this.UnApprovedDocuments=new t;const{DashBoardNotifViewModel:i}=yield Promise.all([s.e(2),s.e(1),s.e(5),s.e(26),s.e(42),s.e(0),s.e(73)]).then(s.bind(null,"Wh9R"));this.NotifEvents=new i(2),this.PDCDocuments=new i(4)}))}timerdashboard_Elapsed(e,t){o.a.page.isActiveTab(this)&&(this.OnButtonClick("RefreshPDC"),this.OnButtonClick("RefreshEvents"),this.NotifEvents.RefreshData(),this.UnApprovedDocuments.OnLoad())}OnButtonClick(e){"PostPDC"==e||("RefreshPDC"==e?(this.PDCDocuments.EventsType=4,this.PDCDocuments.InitColumns()):"PostEvents"==e||("RefreshEvents"==e?this.NotifEvents.RefreshData():"UnApproved"==e?this.UnApprovedDocuments.OnLoad():"Drafts"==e&&this.DocumentDrafts.FillGrid()))}OnMessageCallBack(){this.res="Yes"}static InitColumns(e){let t,s="",i=[];if(o.a.SessionManager.Preferences.ContainsKey(e)&&(s=o.a.SessionManager.Preferences[e]),s.length>0){let n=new a.f;n.LoadXml(s);for(let s=0;s<n.DocumentElement.children.length;s++){let a=n.DocumentElement.children[s];t=new l.a,t.Header=o.a.GetResource(a.attributes.Header.value),t.DisplayMember=a.attributes.ID.value,t.ReadOnly=!0,t.Width=parseInt(a.attributes.Width.value),i.push(t),"Un Approved Documents_DashBoardCustomize"==e?"VoucherNo"==t.DisplayMember?t.DataType="LINK":"Amount"==t.DisplayMember&&(t.DataType="FLOAT",t.DecimalPoints=o.a.SessionManager.Preferences.DecimalsinAmount.toString()):"Document Drafts_DashBoardCustomize"==e?"Date_Text"!=t.DisplayMember&&"Delete"!=t.DisplayMember||(t.DataType="LINK"):"Post Dated Documents_DashBoardCustomize"==e?"VoucherNo"==t.DisplayMember?t.DataType="LINK":"Amount"==t.DisplayMember&&(t.DataType="FLOAT",t.DecimalPoints=o.a.SessionManager.Preferences.DecimalsinAmount.toString()):"Notification Events_DashBoardCustomize"==e&&"VoucherNo"==t.DisplayMember&&(t.DataType="LINK")}}return i}static IsActionAssigned(e,t){return o.a.SessionManager.IsActionAssigned(e,t)}}}}]);