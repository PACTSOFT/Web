function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var r,o=_getPrototypeOf(e);if(t){var n=_getPrototypeOf(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[199],{MPrf:function(e,t,r){"use strict";r.r(t),r.d(t,"QuickAddPropertyViewModel",(function(){return d}));var o=r("Do2H"),n=r("Lp6j"),i=r("eQJW"),s=r("ScVY"),a=r("EQd/"),l=r("0/4Q"),u=r("VxiT"),c=r("Q0PM"),p=r("k08F"),d=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,i,s,c,p){var d;if(_classCallCheck(this,r),(d=t.call(this)).PRT={},d.propertyid=0,d.parentid=0,d.selectedNode=0,d.group=!1,d.ds=null,d.ScreenName="",d.Title="",d.Name=new a.d(25543),d.Code=new a.d(25542),d.Status=new l.e(25544),d.Group=new l.e(26394),d.RetValue=0,d.oScreen=new u.a,d.parent=e,d.propertyid=i,d.parentid=s,d.selectedNode=p,d.group=c,d.oScreen.LoadScreen_2(_assertThisInitialized(d),92),d.ds=o.a.rental.GetProperty(d.propertyid,0),d.ds.Tables[3].forEach((function(e){d.Status.Items.push(l.d.ComboBoxItems_2(e.Status.toString(),e.StatusID.toString())),d.Status.SelectedValue="422"})),d.ds.Tables.length>1&&d.ds.Tables[0].length>0)for(var f=0;f<d.ds.Tables[0].length;f++)d.Group.Items.push(l.d.ComboBoxItems_2(d.ds.Tables[0][f].Name.toString(),d.ds.Tables[0][f].NodeID.toString()));return d.Group.SelectedValue=s.toString(),d.MessageVisibility=!1,0==d.group?0==d.propertyid?(d.Title=o.a.GetResource("RENTALSProperty_AddProperty"),d.AutoGenerateCode(),d.PRT.GUID="GUID"):(d.Title=o.a.GetResource("RENTALSProperty_EditProperty"),d.PRT.GUID=d.ds.Tables[2][0].GUID.toString(),d.ds.Tables.length>0&&d.ds.Tables[1].length>0&&(d.Code.Text=n.e.String(d.ds.Tables[2][0].Code),d.Name.Text=n.e.String(d.ds.Tables[2][0].Name),d.Status.SelectedValue=n.e.String(d.ds.Tables[2][0].StatusID),d.Group.SelectedValue=n.e.String(d.ds.Tables[2][0].ParentID))):(d.Title=o.a.GetResource("CRMLead_AddGroup"),d.AutoGenerateCode(),d.PRT.GUID="GUID"),null!=d.parent&&d.parent.Refresh(),_possibleConstructorReturn(d)}return _createClass(r,[{key:"AutoGenerateCode",value:function(){var e=o.a.common.GetAutoSequence(92,"",92,o.a.SessionManager.CompanyIndex.toString()),t=this.ds.Tables[1].filter((function(e){return"CodeAutoGen"==e.Name}));t.length>0&&(Object(i.j)(t[0].Value)?(this.Code.Enable=!1,this.Code.Mandatory=!1,0==this.PRT.PropertyID&&(this.Code.Text=e)):this.Code.Enable=!0),(t=this.ds.Tables[1].filter((function(e){return"CapsLock"==e.Name}))).length>0&&Object(i.j)(t[0].Value)&&(this.Name.IsAllCaps=!0),(t=this.ds.Tables[1].filter((function(e){return"CapsToFirstLetter"==e.Name}))).length>0&&Object(i.j)(t[0].Value)&&(this.Name.IsFirstLetterCaps=!0)}},{key:"OnSave",value:function(e){var t=this;if("Cancel"==e)this.parent.DetailsVisibility=!0,o.a.page.HideDialog();else if("Save"==e){Logger.InfoLog("SavePropertyViewModel:: OnSave");try{if(this.PRT.PropertyID=this.propertyid,null==this.Code.Text||""==this.Code.Text)return this.MessageVisibility=!0,void(this.DisplayMessage="Enter Code");if(this.PRT.Code=this.Code.Text,null==this.Name.Text||""==this.Name.Text)return this.MessageVisibility=!0,void(this.DisplayMessage="Enter Name");this.PRT.Name=this.Name.Text,this.PRT.StatusID=parseInt(this.Status.SelectedValue),this.PRT.SelectedNodeID=this.selectedNode,this.PRT.DetailsXML="<Row />",this.PRT.IsGroup=this.group,o.a.rental.SaveProperty(this.PRT,"SaveProperty").subscribe((function(e){t.DisplayMessage=e.Message,t.MessageVisibility=!0,t.RetValue=e.RetValue,t.RetValue>0&&(t.Name.Text="",t.Status.SelectedValue="1",null!=t.parent&&t.parent.Refresh(),t.AutoGenerateCode(),Logger.InfoLog("SavePropertyViewModel:: OnSave"))}),(function(e){console.log(" Unit Save : "+JSON.stringify(e))}))}catch(n){Logger.ErrorLog("SavePropertyViewModel:: OnSave"+n.stack)}}else{o.a.page.HideDialog();var r=new c.AddEditPropertyViewModel(this.propertyid,this.parentid,this.group);o.a.page.addNewTab({title:r.Title,component:p.AddEditPropertyComponent,params:{obj:r}})}}}]),r}(s.b)}}]);