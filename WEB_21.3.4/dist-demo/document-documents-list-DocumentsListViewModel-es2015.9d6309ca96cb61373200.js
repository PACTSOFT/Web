(window.webpackJsonp=window.webpackJsonp||[]).push([[155,75,77,89,113,121,141,148,150,160,210,212],{EggS:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var i=s("Do2H"),a=s("Lp6j"),o=s("eQJW");class n{constructor(){this.CustomerID=0,this.CustomerTypeID=0,this.StatusID=0,this.AccountID=0,this.ParentID=0,this.SelectedNodeID=0,this.CodeNumber=0,this.IsGroup=!1,this.CreditDays=0,this.CreditLimit=0,this.DebitDays=0,this.Debitlimit=0,this.IsCode=!1,this.ActivityXml="",this.CCXML=""}SaveCustomerQuick(){try{let e=[];return e.push(this.CustomerID),e.push(null!=this.CustomerCode?this.CustomerCode:""),e.push(null!=this.CustomerName?this.CustomerName:""),e.push(this.StatusID),e.push(this.CodePrefix),e.push(this.CodeNumber),e.push(this.StaticFieldsQuery),e.push(this.CustomFieldsQuery),e.push(this.CustomCostCenterFieldsQuery),e.push(i.a.SessionManager.CompanyGUID),e.push(this.GUID),e.push(""),e.push(i.a.SessionManager.UserName),e.push(i.a.SessionManager.RoleID),e.push(i.a.SessionManager.LanguageID),i.a.crmService.SetCustomerQuick(e)}catch(e){return Logger.ErrorLog("Account:: SaveAccountQuick"+e.stack),""}}SaveCustomer(){Logger.InfoLog("Customer:: Inside SaveCustomer");try{0==this.CustomerID&&(this.GUID=a.e.NewGuid());let e=[];return e.push(this.CustomerID),e.push(null!=this.CustomerCode?this.CustomerCode:""),e.push(null!=this.CustomerName?this.CustomerName:""),e.push(null!=this.AliasName?this.AliasName:""),e.push(this.CustomerTypeID),e.push(this.StatusID),e.push(this.AccountID),e.push(this.SelectedNodeID),e.push(this.IsGroup),e.push(this.CreditDays),e.push(this.CreditLimit),e.push(null!=this.UserName?this.UserName:""),e.push(null!=this.Password?this.Password:""),e.push(null!=this.OnlineCustType?this.OnlineCustType:""),e.push(i.a.SessionManager.CompanyGUID),e.push(null!=this.GUID?this.GUID:"GUID"),e.push(""),e.push(i.a.SessionManager.UserName),e.push(this.CustomFieldsQuery),e.push(this.CustomCostCenterFieldsQuery),e.push(this.ContactsXML),e.push(this.AttachmetsXML),e.push(this.NotesXML),e.push(this.AddressXML),e.push(this.ActivityXml),e.push(this.CCXML),e.push(!1),e.push(null==this.PrimaryContactQuery?"":this.PrimaryContactQuery),e.push(i.a.SessionManager.RoleID),e.push(i.a.SessionManager.LanguageID),e.push(null!=this.CodePrefix?this.CodePrefix:""),e.push(this.CodeNumber),e.push(this.IsCode),i.a.crmService.SaveCustomer(e)}catch(e){return Logger.ErrorLog("Customer:: SaveCustomer"+e.stack),""}}GetCustomerDetails(){let e=i.a.crmService.GetCustomerInfo("?UserID="+i.a.SessionManager.UserID+"&RoleID="+i.a.SessionManager.RoleID+"&LangID="+i.a.SessionManager.LangID+"&CustomerID="+this.CustomerID);return!e.Columns[0].Contains("ErrorMessage")&&e.Tables.length>0&&e.Tables[0].length>0&&(this.CustomerID=parseInt(e.Tables[0][0].CustomerID),this.CustomerCode=a.e.String(e.Tables[0][0].CustomerCode),this.CustomerName=a.e.String(e.Tables[0][0].CustomerName),this.AliasName=a.e.String(e.Tables[0][0].AliasName),a.e.IsEmpty(e.Tables[0][0].CustomerTypeID)||(this.CustomerTypeID=parseInt(e.Tables[0][0].CustomerTypeID)),this.StatusID=parseInt(e.Tables[0][0].StatusID),a.e.IsEmpty(e.Tables[0][0].AccountID)||(this.AccountID=parseInt(e.Tables[0][0].AccountID)),this.IsGroup=Object(o.j)(e.Tables[0][0].IsGroup),a.e.IsEmpty(e.Tables[0][0].CreditDays)||(this.CreditDays=parseInt(e.Tables[0][0].CreditDays)),a.e.IsEmpty(e.Tables[0][0].CreditLimit)||(this.CreditLimit=parseFloat(e.Tables[0][0].CreditLimit)),this.ParentID=parseInt(e.Tables[0][0].ParentID),this.GUID=a.e.String(e.Tables[0][0].GUID),this.Description=a.e.String(e.Tables[0][0].Description),this.CodePrefix=a.e.String(e.Tables[0][0].CodePrefix),this.UserName=a.e.String(e.Tables[0][0].UserName),this.OnlineCustType=a.e.String(e.Tables[0][0].OnlineCustType),this.Password=a.e.String(e.Tables[0][0].Password),a.e.IsEmpty(e.Tables[0][0].CodeNumber)||(this.CodeNumber=parseInt(e.Tables[0][0].CodeNumber))),e}DeleteCustomer(e,t){try{let s=[];return s.push(e),s.push(t),s.push(i.a.SessionManager.RoleID),s.push(i.a.SessionManager.LanguageID),Logger.InfoLog("Customer:: Success: DBH.DeleteCustomer "+e.toString()),i.a.crmService.RemoveCustomer(s)}catch(s){return Logger.ErrorLog("LEAD::DeleteLead"+s.stack),""}}}},NM0h:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var i=s("Do2H"),a=s("Lp6j");class o{constructor(){this.ChangeValueXML=null,this.DetailsXML=null,this.AMCode=null,this.AMName=null,this.AMPurchaseValue=null,this.HistoryXML=null,this.DocNo=null,this.XML=null,this.DocSave=null,this.CodePrefix=null,this.Sno=null,this.AssetClassID=0,this.DeprBookID=0,this.AcqnCostACCID=0,this.AccumDeprACCID=0,this.AcqnCostDispACCID=0,this.AccumDeprDispACCID=0,this.GainsDispACCID=0,this.LossDispACCID=0,this.MaintExpenseACCID=0,this.DeprExpenseACCID=0,this.PostingGroupID=0,this.AMStatusID=0,this.CodeNumber=0,this.AMAssetID=0,this.AMParentAssetID=0,this.IsGroup=!1,this.Post=!1,this.StatusID=0,this.DeprBookMethod=0,this.DeprBookMethodBasedOn=0,this.AveragingMethodID=0,this.DeprScheduleID=0,this.DeprTypeID=0,this.AssetClassCode=null,this.AssetClassName=null,this.GUID=null,this.DeprBookCode=null,this.DeprBookName=null,this.PostGroupCode=null,this.PostGroupName=null,this.AMGUID=null,this.RecordType=null,this.AMGroup=!1,this.IsIncreaseAssetValue=!1,this.EmpName=null,this.EmpCode=null,this.EmpID=0,this.SelectedNodeID=0,this.PostCCID=0,this.PostAssetID=0,this.ScheduleID=0,this.LocationID=0,this.AddressXML=null,this.NotesXML=null,this.ContactsXML=null,this.CustomCostCenterFieldsQuery=null,this.CustomFieldsQuery=null,this.PrimaryContactQuery=null,this.AttachmetsXML=null,this.DepreciationXML=null,this.JVXML=null,this.Description=null,this.DeprStartValue=0,this.ChangeVal=0,this.AssetNetValueChange=0,this.DeprBookMethodBasedOnValue=0,this.TotalYears=0}static GetAssetClassDetails(e){let t=[];return t.push(e),t.push(i.a.SessionManager.UserID),t.push(i.a.SessionManager.LanguageID),i.a.accounting.GetAssetClassDetails(t)}static GetPostingGroupDetails(e){let t=[];return t.push(e),t.push(i.a.SessionManager.UserID),t.push(i.a.SessionManager.LanguageID),i.a.accounting.GetPostingGroupDetails(t)}SaveAssetClass(){0==this.AssetClassID&&(this.GUID=a.e.NewGuid());let e=[];return e.push(this.AssetClassID),e.push(null!=this.AssetClassCode?this.AssetClassCode:""),e.push(null!=this.AssetClassName?this.AssetClassName:""),e.push(this.PostingGroupID),e.push(this.DeprBookID),e.push(this.DeprTypeID),e.push(this.TotalYears),e.push(this.StatusID),e.push(i.a.SessionManager.CompanyGUID),e.push(this.GUID),e.push(""),e.push(i.a.SessionManager.UserName),e.push(i.a.SessionManager.UserID),e.push(i.a.SessionManager.LanguageID),i.a.accounting.SetAssetClass(e)}static GetDeprBookDetails(e){let t=[];return t.push(e),t.push(i.a.SessionManager.UserID),t.push(i.a.SessionManager.LanguageID),i.a.accounting.GetDeprBookDetails(t)}PostJVvoucher(){this.GUID=a.e.NewGuid();let e=[];return e.push(this.PostAssetID),e.push(this.PostCCID),e.push(this.JVXML),e.push(this.Post),e.push(this.DeprTypeID),e.push(this.DocXML),e.push(this.DocSave),e.push(this.DepreciationXML),e.push(this.RecordType),e.push(i.a.SessionManager.CompanyGUID),e.push(this.GUID),e.push(i.a.SessionManager.UserName),e.push(i.a.SessionManager.UserID),e.push(i.a.SessionManager.LanguageID),i.a.accounting.GetPostJvVoucher(e)}SetAssetDispose(e){this.GUID=a.e.NewGuid();let t=[];return t.push(this.PostAssetID),t.push(e.ToString("dd/MMM/yyyy")),t.push(this.PostCCID),t.push(this.JVXML),t.push(this.Post),t.push(this.DeprTypeID),t.push(this.DocXML),t.push(this.DocSave),t.push(this.DepreciationXML),t.push(this.RecordType),t.push(i.a.SessionManager.CompanyGUID),t.push(this.GUID),t.push(i.a.SessionManager.UserName),t.push(i.a.SessionManager.UserID),t.push(i.a.SessionManager.LanguageID),i.a.accounting.SetAssetDispose(t)}SaveDeprBook(e,t,s){0==this.DeprBookID&&(this.GUID=a.e.NewGuid());let o=[];return o.push(this.DeprBookID),o.push(this.DeprBookCode),o.push(this.DeprBookName),o.push(this.DeprBookMethod),o.push(this.DeprBookMethodBasedOn),o.push(this.DeprBookMethodBasedOnValue),o.push(this.StatusID),o.push(this.AveragingMethodID),o.push(e),o.push(t),o.push(s),o.push(i.a.SessionManager.CompanyGUID),o.push(this.GUID),o.push(""),o.push(i.a.SessionManager.UserName),o.push(i.a.SessionManager.UserID),o.push(i.a.SessionManager.LanguageID),i.a.accounting.SetDeprBook(o)}SaveFAPostingGroup(){0==this.PostingGroupID&&(this.GUID=a.e.NewGuid());let e=[];return e.push(this.PostingGroupID),e.push(this.PostGroupCode),e.push(this.PostGroupName),e.push(this.AcqnCostACCID),e.push(this.AccumDeprACCID),e.push(this.AcqnCostDispACCID),e.push(this.AccumDeprDispACCID),e.push(this.GainsDispACCID),e.push(this.LossDispACCID),e.push(this.MaintExpenseACCID),e.push(this.DeprExpenseACCID),e.push(this.StatusID),e.push(0),e.push(this.IsGroup),e.push(i.a.SessionManager.CompanyGUID),e.push(this.GUID),e.push(i.a.SessionManager.UserName),e.push(i.a.SessionManager.UserID),e.push(i.a.SessionManager.LanguageID),i.a.accounting.SetPostingGroup(e)}static GetAssetManagementDetails(e){let t=[];return t.push(e),t.push(i.a.SessionManager.UserID),t.push(i.a.SessionManager.LanguageID),i.a.accounting.GetAssetManagementDetails(t)}static GetAssetDeprSchDetails(e){let t=[];return t.push(e),t.push(i.a.SessionManager.UserID),t.push(i.a.SessionManager.LanguageID),i.a.accounting.GetAssetDeprSchDetails(t)}SetAssetManagementDetails(){let e=[];return e.push(this.AMAssetID),e.push(this.AMCode),e.push(this.AMName),e.push(this.AMStatusID),e.push(this.AMPurchaseValue),e.push(this.AMParentAssetID),e.push(this.AMGroup),e.push(this.CodePrefix),e.push(this.CodeNumber),e.push(this.Sno),e.push(this.DetailsXML),e.push(this.ChangeValueXML),e.push(this.CustomFieldsQuery),e.push(this.CustomCostCenterFieldsQuery),e.push(this.DepreciationXML),e.push(this.HistoryXML),e.push(this.NotesXML),e.push(this.AttachmetsXML),e.push(i.a.SessionManager.CompanyGUID),e.push(this.AMGUID),e.push(i.a.SessionManager.UserName),e.push(i.a.SessionManager.UserID),e.push(i.a.SessionManager.LanguageID),i.a.accounting.SetAssetManagementDetails(e).toPromise()}static DeleteAsset(e){let t=[];return t.push(e),t.push(i.a.SessionManager.UserID),t.push(i.a.SessionManager.RoleID),i.a.accounting.DeleteAsset(t)}static DeleteAssetDeprSchedule(e){let t=[];return t.push(e),t.push(i.a.SessionManager.RoleID),t.push(i.a.SessionManager.LanguageID),i.a.accounting.DeleteAssetDeprSchedule(t)}static DeleteAssetRefDoc(e,t){let s=[];return s.push(e),s.push(t),s.push(i.a.SessionManager.UserID),i.a.accounting.DeleteAssetRefDoc(s)}PostDeprJV(){this.GUID=a.e.NewGuid();let e=[];return e.push(this.PostCCID),e.push(this.JVXML),e.push(this.Post),e.push(i.a.SessionManager.CompanyGUID),e.push(this.GUID),e.push(i.a.SessionManager.UserName),e.push(i.a.SessionManager.UserID),e.push(i.a.SessionManager.LanguageID),e.push(i.a.SessionManager.RoleID),i.a.accounting.PostDeprJV(e)}PostDeprJVSummary(e,t,s,o,n){this.GUID=a.e.NewGuid();let r=[];return r.push(e),r.push(t),r.push(s),r.push(o),r.push(n),r.push(i.a.SessionManager.CompanyGUID),r.push(i.a.SessionManager.UserName),r.push(i.a.SessionManager.UserID),r.push(i.a.SessionManager.LanguageID),i.a.accounting.SetDeprPostingJVSummary(r).toPromise()}static SetsPostDeprReverseJV(e,t,s){let a=[];return a.push(e),a.push(t),a.push(s),a.push(i.a.SessionManager.CompanyGUID),a.push(i.a.SessionManager.UserName),a.push(i.a.SessionManager.UserID),a.push(i.a.SessionManager.LanguageID),i.a.accounting.SetsPostDeprReverseJV(a)}ChangeValue(e,t){this.GUID=a.e.NewGuid();let s=[];return s.push(this.PostAssetID),s.push(e),s.push(this.ChangeVal),s.push(this.AssetNetValueChange),s.push(t.ToString("dd/MMM/yyyy")),s.push(this.Description),s.push(this.DepreciationXML),s.push(this.ChangeValueXML),s.push(this.HistoryXML),s.push(this.LocationID),s.push(this.IsIncreaseAssetValue),s.push(this.JVXML),s.push(this.ChangeValueTypeID),s.push(i.a.SessionManager.CompanyGUID),s.push(this.GUID),s.push(i.a.SessionManager.UserName),s.push(i.a.SessionManager.UserID),s.push(i.a.SessionManager.LanguageID),i.a.accounting.SetAssetChangeValue(s)}DisposeReverse(e){let t=[];return t.push(e),t.push(i.a.SessionManager.UserName),t.push(i.a.SessionManager.UserID),t.push(i.a.SessionManager.LanguageID),i.a.accounting.DisposeReverse(t)}}},ouML:function(e,t,s){"use strict";s.r(t),s.d(t,"DocumentDraftsViewModel",(function(){return D}));var i=s("mrSG"),a=s("Do2H"),o=s("Lp6j"),n=s("ScVY"),r=s("8B8H"),h=s("ockk"),l=s("rJVx"),u=s("CUWK");class D extends n.b{constructor(e,t,s=0){if(super(),this.Grid=new r.a,this.IsFromDocs=!1,this.PopupWidth=0,this.ReportType=0,this.Parent=null,this.CCID=0,this.WID=0,this.LevelID=0,this.PactGridVisible=!1,this.CCID=s,this.Parent=e,this.ReportType=t,this.Parent instanceof l.GeneralDashboardViewModel||"DashAddOnsViewModel"==this.Parent.ClassName)1==t&&(this.ColSource=l.GeneralDashboardViewModel.InitColumns("Document Drafts_DashBoardCustomize"));else{let e;1==t?this.DisplayName="Drafts":2==t?this.DisplayName="Hold Documents":3==t?this.DisplayName="Approval History":4==t&&(this.DisplayName="Level Info",this.PactGrid=new r.a),this.Title=this.DisplayName,this.IsFromDocs=!0,this.FillGrid(),this.Grid.OnLinkClick.Subscribe(this,"GridLinkClick"),this.ColSource=[],1==t?(this.ColSource=l.GeneralDashboardViewModel.InitColumns("Document Drafts_DashBoardCustomize"),this.PopupWidth=22,this.ColSource.forEach(e=>{this.PopupWidth=this.PopupWidth+e.Width})):2==t?(e=new h.a,e.DataType="TextBlock",e.Header="Hold Date",e.DisplayMember="HoldDate_Key",e.Width=100,this.ColSource.push(e),e=new h.a,e.DataType="LINK",e.Header=a.a.GetResource("DocName"),e.DisplayMember="DocName",e.Width=135,this.ColSource.push(e),e=new h.a,e.DataType="TextBlock",e.Header="NetValue",e.DisplayMember="NetValue",e.Width=100,this.ColSource.push(e),e=new h.a,e.DataType="TextBlock",e.Header="NoOfProducts",e.DisplayMember="NoOfProducts",e.Width=50,this.ColSource.push(e),e=new h.a,e.DataType="LINK",e.Header=a.a.GetResource("Delete"),e.DisplayMember="Delete",e.Width=100,this.ColSource.push(e),this.PopupWidth=450):3==t?(e=new h.a,e.DataType="TextBlock",e.Header="User",e.DisplayMember="CreatedBy",e.Width=90,this.ColSource.push(e),e=new h.a,e.DataType="TextBlock",e.Header="FirstName",e.DisplayMember="FirstName",e.Width=90,this.ColSource.push(e),e=new h.a,e.DataType="TextBlock",e.Header="LastName",e.DisplayMember="LastName",e.Width=90,this.ColSource.push(e),e=new h.a,e.DataType="TextBlock",e.Header="Email",e.DisplayMember="Email1",e.Width=150,this.ColSource.push(e),e=new h.a,e.DataType="TextBlock",e.Header=a.a.GetResource("Date"),e.DisplayMember="AppDate",e.Width=128,this.ColSource.push(e),e=new h.a,e.DataType="LINK",e.Header="Level",e.DisplayMember="LevelName",e.Width=93,this.ColSource.push(e),e=new h.a,e.DataType="TextBlock",e.Header="Status",e.DisplayMember="Status",e.Width=80,this.ColSource.push(e),e=new h.a,e.DataType="Format",e.Header="Remarks",e.DisplayMember="Remarks",e.Width=190,this.ColSource.push(e),this.PopupWidth=950,"AddEditDocumentViewModel"==this.Parent.ClassName&&(e=new h.a,e.Header="WorkFlowName",e.DisplayMember="WorkFlowName",e.Width=200,this.ColSource.push(e)),this.PopupWidth=950):4==t&&(e=new h.a,e.DataType="TextBlock",e.ReadOnly=!0,e.Header="User Name",e.DisplayMember="UserName",e.Width=120,this.ColSource.push(e),e=new h.a,e.DataType="TextBlock",e.ReadOnly=!0,e.Header="First Name",e.DisplayMember="FirstName",e.Width=120,this.ColSource.push(e),e=new h.a,e.DataType="TextBlock",e.ReadOnly=!0,e.Header="Last Name",e.DisplayMember="LastName",e.Width=120,this.ColSource.push(e),this.PactGrid.Columns=this.ColSource,this.PopupWidth=400)}}get Table(){return this.Grid.Table}set Table(e){this.Grid.Table=e}get TableColumns(){return this.Grid.TableColumns}set TableColumns(e){this.Grid.TableColumns=e}get ColSource(){return this.Grid.Columns}set ColSource(e){this.Grid.Columns=e}get SelectedRow(){return this.Grid.SelectedItem}set SelectedRow(e){this.Grid.SelectedItem=e}onClick(e){event.preventDefault(),null!=this.SelectedRow&&this.LoadDraft(this.SelectedRow)}FillGrid(){let e=0,t=null;if(o.e.IsType(this.Parent,"AddEditDocumentViewModel")?(t=this.Parent,e=0==this.CCID?t.CostCenterID:this.CCID):o.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName||(e=this.CCID),1==this.ReportType||2==this.ReportType){let s;s=o.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName?null==t||38!=t.ScreenObject.DocumentType&&39!=t.ScreenObject.DocumentType?a.a.document.GetDocumentDrafts(0,e,this.ReportType,!1):a.a.document.GetDocumentDrafts(t.ScreenObject.RegisterNodeID,e,this.ReportType,!1,!0):a.a.document.GetDocumentDrafts(0,this.Parent.CostCenterID,this.ReportType,!1),s.subscribe(e=>{this.Table=e.Tables[0],this.Grid.TableColumns.Contains("Date_Text")||(this.Grid.TableColumns.push("Date_Text"),this.Grid.TableColumns.push("Delete")),this.Grid.TableColumns.Contains("HoldDate_Key")||this.Grid.TableColumns.push("HoldDate_Key"),this.Table.forEach(e=>{e.Delete="Delete",e.id=a.a.slick.rowid,e.Date_Text=new Date(e.Date).ToString(a.a.SessionManager.Preferences["Date Format"]+" hh:mm a"),null!=e.HoldDate&&(e.HoldDate_Key=new Date(e.HoldDate).ToString(a.a.SessionManager.Preferences["Date Format"]))})})}else if(3==this.ReportType){let t=null;if(o.e.IsType(this.Parent,"AddEditDocumentViewModel")?(t=this.Parent.ScreenObject.GetDocStatusHistory(),t.Tables.length>1&&t.Tables[1].length>0&&t.Columns[1].Contains("WID")&&(this.WID=parseInt(t.Tables[1][0].WID))):o.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName?o.e.IsEmpty(this.Parent.ClassName)||"AddEditCasesViewModel"!=this.Parent.ClassName||(t=this.GetDocStatusHistory(73,this.Parent.CaseID,!1)):t=a.a.rental.GetHistory(e,this.Parent.ContractID),null!=t&&t.Tables.length>0){this.Table=t.Tables[0],this.Grid.TableColumns.push("AppDate");for(let t=0;t<this.Table.length;t++)""!=this.Table[t].Date.toString()&&(this.Table[t].AppDate=new Date(this.Table[t].Date.toString()).ToString(a.a.SessionManager.Preferences["Date Format"]+" hh:mm a"));let e=0,s=0;this.Table.length>0&&(e=o.e.IntTryParse(this.Table[this.Table.length-1].WorkFlowLevel.toString()),s=o.e.IntTryParse(this.Table[this.Table.length-1].StatusID.toString())),369!=s&&(t.Tables[1]=t.Tables[1].filter(t=>t.levelID>e),t.Tables[1].forEach(e=>{let t=this.Grid.NewRow();t.LevelName=e.LevelName,t.Status="Pending",t.WorkFlowLevel=e.LevelID,this.Grid.addRow(t)}));for(let t=this.Table.length;t<7;t++)this.Grid.addEmptyRow()}}else if(4==this.ReportType){let e=null;if("WFLevelDoc"==this.Parent.ClassName?e=a.a.SessionManager.Preferences.ContainsKey("CanApproveFunction")&&"True"==a.a.SessionManager.Preferences.CanApproveFunction?a.a.report.GetExtWFDet(this.Parent.WID,this.Parent.LevelID,this.Parent.ccid,this.Parent.DOcId):a.a.report.GetWorkFlowLevelDetails(this.Parent.WID,this.Parent.LevelID,this.Parent.ccDate):this.Parent instanceof D&&(a.a.SessionManager.Preferences.ContainsKey("CanApproveFunction")&&"True"==a.a.SessionManager.Preferences.CanApproveFunction?"AddEditDocumentViewModel"==this.Parent.Parent.ClassName?e=a.a.report.GetExtWFDet(this.Parent.WID,this.Parent.LevelID,this.Parent.Parent.CostCenterID,this.Parent.Parent.ScreenObject.DocID):"ReportViewModel"==this.Parent.Parent.ClassName&&"INV_ComparisonReport"==this.Parent.Parent.StaticReportObject&&(e=a.a.report.GetExtWFDet(this.Parent.WID,this.Parent.LevelID,this.Parent.Parent.StaticReportObject.QuotationDocument,this.Parent.Parent.StatusDocID)):e=a.a.report.GetWorkFlowLevelDetails(this.Parent.WID,this.Parent.LevelID,"AddEditDocumentViewModel"==this.Parent.Parent.ClassName?this.Parent.Parent.ScreenObject.DocDate.Date:Date.Today())),null!=e){for(let t=e.Tables[0].length;t<8;t++)e.Tables[0].push();this.PactGrid.Table=e.Tables[0]}this.PactGrid.Width="",this.PactGrid.SearchVisible=!0,this.PactGrid.SearchCols.Width="85",this.PactGrid.SearchOptions.Width="90",this.PactGrid.SearchText.Width="110",this.PactGridVisible=!0}}GetDocStatusHistory(e,t,s){Logger.InfoLog("DocumentDraftsViewModel:: Inside GetDocStatusHistory");let i=[];i.push(e),i.push(t),i.push(s),i.push(a.a.SessionManager.UserID),i.push(a.a.SessionManager.LanguageID);let o=a.a.document.GetDocStatusHistory(i);return Logger.InfoLog("DocumentDraftsViewModel:: Exiting GetDocStatusHistory"),o}OnButtonClick(e){"Cancel"==e.toString()&&(o.e.IsType(this.Parent,"AddEditDocumentViewModel")&&this.CCID>0&&(this.Parent.res="No"),a.a.page.HideDialog())}DeleteDraft(e){let t;t=o.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName?a.a.document.DeleteDocumentDraft(parseInt(e.DraftID)):a.a.rental.DeleteQuotation(parseInt(e.CostCenterID),parseInt(e.DraftID)),t.RetValue>0&&this.Grid.removeRow(e)}LoadDraft(e){return Object(i.b)(this,void 0,void 0,(function*(){if(o.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName){const{AddEditDocumentViewModel:t}=yield Promise.all([s.e(2),s.e(1),s.e(3),s.e(5),s.e(4),s.e(6),s.e(7),s.e(10),s.e(9),s.e(12),s.e(11),s.e(13),s.e(19),s.e(15),s.e(21),s.e(20),s.e(16),s.e(14),s.e(18),s.e(17),s.e(22),s.e(89)]).then(s.bind(null,"1Cra")),{AddEditDocumentComponent:i}=yield Promise.all([s.e(4),s.e(6)]).then(s.bind(null,"MCKn"));let o,n;n=a.a.document.GetDocumentDrafts(parseInt(e.DraftID),0,1,!1),n.subscribe(s=>{if(o=s.Tables[0],null!=o&&o.length>0)if("AddEditDocumentViewModel"==this.Parent.ClassName||"POSDocumentViewModel"==this.Parent.ClassName)this.CCID>0||(this.Parent.clear(1),this.Parent.LoadDraftXML(o[0]),a.a.page.HideDialog(),this.Parent.ScreenObject.GridDataObj.RefreshGridView());else{let s=1==this.ReportType,n=new t(parseInt(e.CostCenterID),e.Type.toString(),s);a.a.page.addNewTab({component:i,params:{obj:n}}),n.LoadDraftXML(o[0],s)}})}else u.RibbonExtViewModel.LoadDraftRentalContract(this.Parent,parseInt(e.DraftID)),a.a.page.HideDialog()}))}GridLinkClick(e,t,s){event.preventDefault(),"Delete"==t?this.DeleteDraft(e):"Date_Text"!=t&&"DocName"!=t||this.LoadDraft(e)}}},rJVx:function(e,t,s){"use strict";s.r(t),s.d(t,"GeneralDashboardViewModel",(function(){return u}));var i=s("mrSG"),a=s("Do2H"),o=s("Lp6j"),n=s("ScVY"),r=s("NkMH"),h=s("ockk"),l=s("JIg3");class u extends n.b{constructor(){super(),this.ButtonPDC=new r.a,this.timerdashboard=new o.d,this.Date=new l.a(0),this.tdMaximize=new Array(4).fill(!1),Logger.InfoLog("DashboardViewModel::Entering DashboardViewModel"),this.timerdashboard.Enabled=!0,this.timerdashboard.Interval=6e4,a.a.SessionManager.IsWebApplication||this.timerdashboard.Elapsed(this,"timerdashboard_Elapsed"),this.DisplayName=a.a.GetResource("Dashboard_Maindashboard"),this.loadDrafts(),Logger.InfoLog("DashboardViewModel::Exiting DashboardViewModel")}loadDrafts(){return Object(i.b)(this,void 0,void 0,(function*(){const{DocumentDraftsViewModel:e}=yield s.e(150).then(s.bind(null,"ouML"));this.DocumentDrafts=new e(this,1),setTimeout(()=>{this.DocumentDrafts.FillGrid()},500);const{UnAppDocumentsViewModel:t}=yield s.e(0).then(s.bind(null,"AyOk"));this.UnApprovedDocuments=new t;const{DashBoardNotifViewModel:i}=yield Promise.all([s.e(2),s.e(1),s.e(5),s.e(26),s.e(42),s.e(0),s.e(73)]).then(s.bind(null,"Wh9R"));this.NotifEvents=new i(2),this.PDCDocuments=new i(4)}))}timerdashboard_Elapsed(e,t){a.a.page.isActiveTab(this)&&(this.OnButtonClick("RefreshPDC"),this.OnButtonClick("RefreshEvents"),this.NotifEvents.RefreshData(),this.UnApprovedDocuments.OnLoad())}OnButtonClick(e){"PostPDC"==e||("RefreshPDC"==e?(this.PDCDocuments.EventsType=4,this.PDCDocuments.InitColumns()):"PostEvents"==e||("RefreshEvents"==e?this.NotifEvents.RefreshData():"UnApproved"==e?this.UnApprovedDocuments.OnLoad():"Drafts"==e&&this.DocumentDrafts.FillGrid()))}OnMessageCallBack(){this.res="Yes"}static InitColumns(e){let t,s="",i=[];if(a.a.SessionManager.Preferences.ContainsKey(e)&&(s=a.a.SessionManager.Preferences[e]),s.length>0){let n=new o.f;n.LoadXml(s);for(let s=0;s<n.DocumentElement.children.length;s++){let o=n.DocumentElement.children[s];t=new h.a,t.Header=a.a.GetResource(o.attributes.Header.value),t.DisplayMember=o.attributes.ID.value,t.ReadOnly=!0,t.Width=parseInt(o.attributes.Width.value),i.push(t),"Un Approved Documents_DashBoardCustomize"==e?"VoucherNo"==t.DisplayMember?t.DataType="LINK":"Amount"==t.DisplayMember&&(t.DataType="FLOAT",t.DecimalPoints=a.a.SessionManager.Preferences.DecimalsinAmount.toString()):"Document Drafts_DashBoardCustomize"==e?"Date_Text"!=t.DisplayMember&&"Delete"!=t.DisplayMember||(t.DataType="LINK"):"Post Dated Documents_DashBoardCustomize"==e?"VoucherNo"==t.DisplayMember?t.DataType="LINK":"Amount"==t.DisplayMember&&(t.DataType="FLOAT",t.DecimalPoints=a.a.SessionManager.Preferences.DecimalsinAmount.toString()):"Notification Events_DashBoardCustomize"==e&&"VoucherNo"==t.DisplayMember&&(t.DataType="LINK")}}return i}static IsActionAssigned(e,t){return a.a.SessionManager.IsActionAssigned(e,t)}}},xeC8:function(e,t,s){"use strict";s.r(t),s.d(t,"DocumentsListViewModel",(function(){return g}));var i=s("mrSG"),a=s("ScVY"),o=s("Do2H"),n=s("ThYU"),r=s("dH+5"),h=s("8B8H"),l=s("ockk"),u=s("Lp6j"),D=s("CUWK"),c=s("NkMH"),d=s("eQJW"),p=s("0/4Q"),m=s("1Cra"),C=s("IOQr");class I extends a.b{constructor(e,t){super(),this.GridObj=new h.a,this.IsSelective=!1,this.Parent=e,this.item=t,this.InitGrid()}InitGrid(){if(this.GridObj=new h.a,this.GridObj.MaxHeight=280,this.GridObj.SelectAll.Visible=!1,this.GridObj.SelectAll.DBColumnName="select",this.GridObj.Width="",this.GridObj.Table=[],this.GridObj.Columns=[],this.GridObj.Visible=!1,this.lstDateCols=[],this.Parent.IsInventory){let e;"True"==this.Parent.GetPrefValue("Selective")&&(this.IsSelective=!0,this.GridObj.SelectAll.Visible=!0,e=new l.a,e.DisplayMember="select",e.Header="Select",e.Width=50,e.IsFrozen=!0,e.ReadOnly=!0,e.TextAlign="Center",e.DataType="CheckBox",this.GridObj.Columns.push(e),this.GridObj.TableColumns.push(e.DisplayMember)),e=new l.a,e.DisplayMember="DocSeqNo",e.Header="#",e.Width=45,e.ReadOnly=!0,e.IsFrozen=!0,this.GridObj.Columns.push(e),this.GridObj.TableColumns.push(e.DisplayMember),e=new l.a,e.DisplayMember="ProductCode",e.Header="Product Code",e.Width=110,e.ReadOnly=!0,this.GridObj.Columns.push(e),this.GridObj.TableColumns.push(e.DisplayMember),e=new l.a,e.DisplayMember="ProductName",e.Header="Product Name",e.Width=180,e.ReadOnly=!0,this.GridObj.Columns.push(e),this.GridObj.TableColumns.push(e.DisplayMember),e=new l.a,e.DisplayMember="Quantity",e.Header="Qty",e.Width=80,e.ReadOnly=!0,e.DecimalPoints=o.a.SessionManager.Preferences.DecimalsinQty,e.DataType="FLOAT",this.GridObj.Columns.push(e),this.GridObj.TableColumns.push(e.DisplayMember),e=new l.a,e.DisplayMember="Rate",e.Header="Rate",e.Width=80,e.ReadOnly=!0,e.DecimalPoints=o.a.SessionManager.Preferences.DecimalsinRate,e.DataType="FLOAT",this.GridObj.Columns.push(e),this.GridObj.TableColumns.push(e.DisplayMember),e=new l.a,e.DisplayMember="Gross",e.Header="Gross",e.Width=100,e.ReadOnly=!0,e.DecimalPoints=o.a.SessionManager.Preferences.DecimalsinAmount,e.DataType="FLOAT",this.GridObj.Columns.push(e),this.GridObj.TableColumns.push(e.DisplayMember)}else{let e=new l.a;e.DisplayMember="DocSeqNo",e.Header="#",e.Width=45,e.ReadOnly=!0,e.IsFrozen=!0,this.GridObj.Columns.push(e),this.GridObj.TableColumns.push(e.DisplayMember),e=new l.a,e.DisplayMember="DrName",e.Header="Debit Account",e.Width=180,e.ReadOnly=!0,this.GridObj.Columns.push(e),this.GridObj.TableColumns.push(e.DisplayMember),e=new l.a,e.DisplayMember="CrName",e.Header="Credit Account",e.Width=180,e.ReadOnly=!0,this.GridObj.Columns.push(e),this.GridObj.TableColumns.push(e.DisplayMember),e=new l.a,e.DisplayMember="Amount",e.Header="Amount",e.Width=100,e.DecimalPoints=o.a.SessionManager.Preferences.DecimalsinAmount,e.DataType="FLOAT",e.ReadOnly=!0,this.GridObj.Columns.push(e),this.GridObj.TableColumns.push(e.DisplayMember)}this.LoadData()}LoadData(){let e;e=this.Parent.IsInventory?"select INV.InvDocDetailsID,INV.DocSeqNo,P.ProductCode,P.ProductName,INV.Quantity,INV.Rate,INV.Gross\n    from INV_DocDetails INV with(nolock)\n    join INV_Product P with(nolock) on P.ProductID=INV.ProductID\n    where INV.VoucherNo='"+this.item.DocNo+"' and INV.DynamicInvDocDetailsID is null\n    order by INV.DocSeqNo\n":"select ACC.AccDocDetailsID,ACC.DocSeqNo,A1.AccountName DrName,A2.AccountName CrName,ACC.Amount\n      from ACC_DocDetails ACC with(nolock)\n      join ACC_Accounts A1 with(nolock) on A1.AccountID=ACC.DebitAccount\n      join ACC_Accounts A2 with(nolock) on A2.AccountID=ACC.CreditAccount\n      where ACC.VoucherNo='"+this.item.DocNo+"'\n      order by ACC.DocSeqNo\n",this.GridObj.Visible=!1,o.a.report.DataSetAsyn("RPT022",e).then(e=>{e.Tables[0].length>0&&(e.Tables[0][0].AccDocDetailsID||e.Tables[0][0].InvDocDetailsID)&&this.GridObj.addRows(e.Tables[0])}).finally(()=>{this.GridObj.Visible=!0})}RefreshData(e){e.forEach(e=>{this.GridObj.Columns.forEach(e=>{})})}OnButtonClick(e){if("Cancel"==e)o.a.page.HideDialog();else{let e=[];this.IsSelective&&(this.GridObj.Table.forEach(t=>{t.select&&e.push({InvDocDetailsID:t.InvDocDetailsID})}),e.length>0?(this.item._LinkedIDs=e,this.item.select=!0,this.Parent.SelectedLinkedDocs.Contains(this.item)||this.Parent.SelectedLinkedDocs.push(this.item)):(this.item._LinkedIDs=[],this.item.select=!1,this.Parent.SelectedLinkedDocs.Contains(this.item)&&this.Parent.SelectedLinkedDocs.Remove(this.item)),this.Parent.GridObj.updateRow(this.item)),o.a.page.HideDialog()}}}var S=s("4lLs");class g extends a.b{constructor(e,t,s="",i="",a=null){var r,l;if(super(),this.Documents=new p.e,this.lstDateCols=[],this.Buttons=[],this.CreateNew=[],this.colVoucherID="",this.colStatusID="",this.colAccStatusID="",this.PageNo=1,this.PageSize=20,this.CurrentRecords="",this.TotalRows=0,this.OverallTotalRows="",this.TotalPages=0,this.ExtWhere="",this.ExtWhereLinkStatus=!1,this.ExecutedQty="",this.ExecutedQuery="",this.ExecutedQueryJoin="",this.StatusList=[],this.LinkStatusList=[],this.DocJV=[],this.DocJVDr=[],this.DocJVCr=[],this.DocInfo=[],this.VoucherNo="",this.IsInventory=!1,this.DocumentType=0,this.ProfileLID=0,this.HideGrid=!0,this.IsFirstCall=!0,this.SelectedLinkedDocs=[],this.ShowPostFilter=!1,this.SelectedStatus=null,this.CostCenterID=e,this.ExtWhere=s,this.objParams=a,(null===(r=this.objParams)||void 0===r?void 0:r.DocsList)?(this.dsRpt=o.a.common.GetDataSet3("DOC062",this.objParams.DocsList,""),this.CostCenterID=e=this.dsRpt.Tables[0][0].CostCenterID,t=this.dsRpt.Tables[0][0].DocumentName,"-1"!=this.ExtWhere&&"-2"!=this.ExtWhere&&"-3"!=this.ExtWhere||(this.ExtWhereLinkStatus=!0)):this.dsRpt=o.a.common.GetDataSet3("DOC062",this.CostCenterID.toString(),i),this.Title=t,this.ReportID=S.a.GetLandingReport(e),this.IsInventory=this.dsRpt.Tables[0][0].IsInventory,this.DocumentType=this.dsRpt.Tables[0][0].DocumentType,this.Documents.Items.push(p.d.ComboBoxItems_4(t,e.toString(),this.ReportID.toString(),this.dsRpt.Tables[0][0].IsInventory.toString())),0==this.ReportID&&(this.ReportID=Object(d.j)(this.dsRpt.Tables[0][0].IsInventory)?this.DocumentType>=51&&this.DocumentType<=199&&64!=this.DocumentType?219:217:218),this.Documents.LblWidth="0",this.Documents.SelectedValue=e.toString(),this.Documents.SelectionChangedCommand.Subscribe(this,"OnDocumentChanged"),null===(l=this.objParams)||void 0===l?void 0:l.DocsList)for(let o=1;o<this.dsRpt.Tables[0].length;o++)this.Documents.Items.push(p.d.ComboBoxItems_4(this.dsRpt.Tables[0][o].DocumentName,this.dsRpt.Tables[0][o].CostCenterID.toString(),S.a.GetLandingReport(this.dsRpt.Tables[0][o].CostCenterID),this.dsRpt.Tables[0][o].IsInventory.toString()));i&&this.IsInventory&&this.dsRpt.Tables[1].forEach(e=>{this.Documents.Items.push(p.d.ComboBoxItems_4(e.DocumentName,e.CostCenterID.toString(),S.a.GetLandingReport(e.CostCenterID),this.dsRpt.Tables[0][0].IsInventory.toString()))}),1==this.Documents.Items.length&&(this.Documents.Visible=!1),this.rpt=new n.ReportViewModel,this.rpt.DocsLanding=this,this.GridObj=new h.a,this.GridObj.Height=0,this.GridObj.Width="",this.GridObj.Table=[],this.GridObj.Columns=[],this.GridObj.OnLinkClick.Subscribe(this,"OnLinkClickEvent"),this.InitButtons(),this.GridObj.OnRowSelection.Subscribe(this,"OnRowChange")}get RoleType(){return o.a.SessionManager.RoleType}OnDocumentChanged(){let e=this.Documents.GetselectedItem(),t=u.e.Int(e.Parent);if(this.CreateNew.Clear(),this.SelectedLinkedDocs.Clear(),this.DocsList&&(this.DisplayName=e.Name,this.Title=e.Name),this.dsRpt.Tables[2].length>0&&this.dsRpt.Tables[2].filter(t=>t.CCID==parseInt(e.Value)).forEach(e=>{this.CreateNew.push(e)}),"0"==e.Parent&&(t=Object(d.j)(e.Aliasname)?this.DocumentType>=51&&this.DocumentType<=199&&64!=this.DocumentType?219:217:218),t!=this.ReportID||this.IsFirstCall)this.IsFirstCall=!1,this.ReportID=t,this.OnReportChange();else{this.SetExecutedQtyQuery();let e=this.GetQuery(1);this.LoadData(e)}}OnReportChange(){var e;this.SetExecutedQtyQuery(),this.rpt.ReportViewModel_2(this.ReportID,r.e.LandingPage,null,null,(null===(e=this.objParams)||void 0===e?void 0:e.ReportFilterXML)?this.objParams.ReportFilterXML:""),this.rpt.ShowFilter=!1,this.rpt.PostDataFetchFilterFields.forEach(e=>{let t=this.rpt.BaseReportColumns.find(t=>t.ID==e.ColumnName);(null==t?void 0:t.CDGDO.IsForeignKey)&&(e.FromList.CCID=t.CDGDO.ColumnCostCenterID,e.FromList.TypeID=2==e.FromList.CCID?100:3==e.FromList.CCID?10:1)}),this.InitGrid(),this.HideGrid=!1,this.SelectedLinkedDocs.Clear(),this.rpt.SetQueryXMLTags();let t=this.GetQuery(1);this.LoadData(t)}SetExecutedQtyQuery(){this.ExecutedQty="",this.ExecutedQuery="",this.ExecutedQueryJoin="",this.ProfileLID=0,o.a.page.QuickDocumentData.Profiles.values.forEach(e=>{e.DocData.forEach(e=>{e.Docs.forEach(t=>{t.CCID!=this.Documents.SelectedValue||(this.ProfileLID=e.LID)})})}),this.IsInventory&&(this.ExtWhereLinkStatus||70!=this.ProfileLID&&80!=this.ProfileLID&&270!=this.ProfileLID&&280!=this.ProfileLID)&&(this.ExecutedQty=o.a.report.GetExecutedQtyQuery(0,this.Documents.SelectedValue,null,null,!1,!1),this.ExecutedQty.length<=120?this.ExecutedQty="":this.ExecutedQty.Contains("NUM")&&(this.ExecutedQueryJoin=" join COM_DocNumData NUM with(nolock) on NUM.InvDocdetailsID=INV.InvDocdetailsID"))}InitGrid(){this.GridObj.Table.Clear(),this.GridObj.Columns.Clear(),this.GridObj.TableColumns.Clear(),this.lstDateCols=[];let e=new l.a;e.DisplayMember="select",e.Header="Select",e.Width=50,e.ReadOnly=!0,e.DataType="CheckBox",e.IsFrozen=!0,e.TextAlign="Center",e.CheckedChanged.Subscribe(this,"dgColSelect_CheckedChanged"),this.GridObj.Columns.push(e),this.GridObj.TableColumns.push(e.DisplayMember),e=new l.a,e.DisplayMember="_DocView",e.Header="View",e.Width=42,e.ReadOnly=!0,e.DataType="",e.DataType="LINK",e.TextAlign="Center",e.ValueBinding="fa-light fa-list",e.IsFrozen=!0,this.GridObj.Columns.push(e),this.GridObj.TableColumns.push(e.DisplayMember),this.colVoucherID="",this.colStatusID="",this.rpt.ReportColumns.forEach(t=>{let s=this.rpt.BaseReportColumns.find(e=>e.ID==t.ID);e=new l.a,e.DisplayMember=t.ID,e.Header=t.HeaderText,e.Width=t.width,e.ReadOnly=!0,e.DataType=t.DataAppearance.ColumnType,e.TextAlign=t.DataAppearance.Alignment,"FLOAT"==e.DataType?e.DecimalPoints="2":"DATE"==e.DataType?this.lstDateCols.push(t):s&&"VoucherNo"==s.CDGDO.Column?(e.DataType="LINK",0==this.colVoucherID.length&&(this.colVoucherID=t.ID)):113==s.CDGDO.ColumnCostCenterID&&(this.colStatusID=t.ID),this.GridObj.Columns.push(e),this.GridObj.TableColumns.push(e.DisplayMember)}),this.LinkStatusCol=this.GridObj.Columns.find(e=>"_LinkStatus"==e.DisplayMember),this.LinkStatusCol&&0==this.ExecutedQty.length&&this.GridObj.Columns.Remove(this.LinkStatusCol),this.colAccStatusID="";let t=this.GridObj.Columns.find(e=>"_AccStatus"==e.DisplayMember);t&&("True"==this.GetPrefValue("DonotupdateAccounts")?this.GridObj.Columns.Remove(t):this.colAccStatusID="_AccStatus"),this.GridObj.RefreshColumns()}InitButtons(){let e=new c.a;e.Expression="fa-light fa-file",e.Label=o.a.GetResource("New"),e.DBColumnName="New",this.Buttons.push(e),e=new c.a,e.Expression="fa-light fa-file-edit",e.Label=o.a.GetResource("Edit"),e.DBColumnName="Edit",this.Buttons.push(e),e=new c.a,e.Expression="fa-light fa-arrows-rotate",e.Label=o.a.GetResource("Refresh"),e.DBColumnName="Refresh",this.Buttons.push(e),e=new c.a,e.Expression="fa-light fa-gears",e.Label=o.a.GetResource("Regenerate"),e.DBColumnName="Regenerate",this.Buttons.push(e)}OnRowChange(e){this.colVoucherID&&(this.DocJVDr.Clear(),this.DocJVCr.Clear(),this.DocInfo.Clear(),this.VoucherNo="",e&&e[this.colVoucherID]&&(this.colAccStatusID&&(this.DocInfo.push({Name:"Bill Amount",Value:u.e.Int(e._BillAmt).Commas(o.a.SessionManager.Preferences.DecimalsinAmount)}),this.DocInfo.push({Name:"Ajusted Amount",Value:u.e.Int(e._AdjAmt).Commas(o.a.SessionManager.Preferences.DecimalsinAmount)})),this.LinkStatusCol&&this.ExecutedQty.length>0&&(this.DocInfo.push({Name:"Total Quantity",Value:u.e.Int(e.DQty).Commas(o.a.SessionManager.Preferences.DecimalsinQty)}),this.DocInfo.push({Name:"Executed Qty",Value:u.e.Int(e.DExQty).Commas(o.a.SessionManager.Preferences.DecimalsinQty)})),this.VoucherNo=e[this.colVoucherID],o.a.report.DataSetAsyn("RPT052",this.IsInventory?"1":"0",this.VoucherNo).then(e=>{e.Tables[2].forEach(e=>{0!=u.e.Int(e.Dr)&&(e.DrText=e.Dr.Commas("N2"),this.DocJVDr.push(e)),0!=u.e.Int(e.Cr)&&(e.CrText=e.Cr.Commas("N2"),this.DocJVCr.push(e))}),this.DocJV=e.Tables[2]})))}OnLinkClickEvent(e,t){"_DocView"==t?(e._DetailsObj||(e._DetailsObj=new I(this,e)),o.a.page.ShowDialog(e._DetailsObj,C.a,{ShowCenter:!0,Title:"Details",VarWidth:!0})):u.e.IsEmpty(e[t])||D.RibbonExtViewModel.LoadDocument_VoucherNo(e[t].toString())}dgColSelect_CheckedChanged(e,t){t?this.SelectedLinkedDocs.Contains(e.item)||(this.SelectedLinkedDocs.push(e.item),e.item._LinkedIDs=null):this.SelectedLinkedDocs.Contains(e.item)&&(this.SelectedLinkedDocs.Remove(e.item),e.item._LinkedIDs=null)}OnButtonClick(e){return Object(i.b)(this,void 0,void 0,(function*(){if(this.DisplayMessage="","NEXT"==e){if(this.PageNo>=this.TotalPages)return void(this.DisplayMessage="No more records.");let e=this.GetQuery(this.PageNo+1);this.LoadData(e)}else if("PREVIOUS"==e){if(this.PageNo<=1)return void(this.DisplayMessage="No more records.");let e=this.GetQuery(this.PageNo-1);this.LoadData(e)}else if("FIRST"==e){if(1!=this.PageNo){let e=this.GetQuery(1);this.LoadData(e)}}else if("LAST"==e){if(this.PageNo!=this.TotalPages&&this.TotalPages>0){let e=this.GetQuery(this.TotalPages);this.LoadData(e)}}else if("New"==e)this.NewDocument(this.Documents.SelectedValue,this.Documents.GetText());else if("Edit"==e)this.GridObj.SelectedItem&&this.colVoucherID&&!u.e.IsEmpty(this.GridObj.SelectedItem[this.colVoucherID])&&D.RibbonExtViewModel.LoadDocument_VoucherNo(this.GridObj.SelectedItem[this.colVoucherID].toString());else if("Refresh"==e){this.SelectedStatus=null,this.SelectedLinkedDocs.Clear();let e=this.GetQuery(1);this.LoadData(e)}else"RemoveExtWhere"==e?(this.ExtWhere="",this.ExtWhereLinkStatus=!1,this.OnButtonClick("Refresh")):"Regenerate"==e&&(this.rpt.Filter.Title="Filter",this.rpt.OnButtonClick("Regenerate"))}))}OnCreateNew(e){this.NewDocument(e.CCID,e.Title)}OnGenerate(e){return Object(i.b)(this,void 0,void 0,(function*(){if(0==this.SelectedLinkedDocs.length)return void(this.DisplayMessage="Please Select Documents.");let t={};const{AddEditDocumentComponent:i}=yield Promise.resolve().then(s.bind(null,"MCKn")),{AddEditDocumentViewModel:a}=yield Promise.resolve().then(s.bind(null,"1Cra"));let n="";this.SelectedLinkedDocs.forEach(e=>{e._LinkedIDs&&e._LinkedIDs.forEach(e=>{n.length>0&&(n+=","),n+=e.InvDocDetailsID.toString()})});let r=null;n.length>0?(r=o.a.report.ReportDataTable("RPT022",!1,"select top 1 D.DebitAccount,D.CreditAccount,dcc.* from INV_DocDetails D with(Nolock) join com_docccdata dcc with(nolock) on D.invdocdetailsid=dcc.invdocdetailsid where D.invdocdetailsid in ("+n+")"),0==r.length&&(r=null)):(this.SelectedLinkedDocs.forEach(e=>{n.length>0&&(n+=","),n+="'"+e[this.colVoucherID].toString()+"'"}),r=o.a.report.ReportDataTable("RPT022",!1,"select top 1 D.DebitAccount,D.CreditAccount,dcc.* from INV_DocDetails D with(Nolock) join com_docccdata dcc with(nolock) on D.invdocdetailsid=dcc.invdocdetailsid where D.VoucherNo in ("+n+")"));let h=new a(parseInt(e.CostCenterID),e.DocumentName,null==r,r);Object.assign(t,{component:i,params:{obj:h}}),r.length>0&&("True"==h.ScreenObject.Preferences["Debit Account"]?h.ScreenObject.DebitAccount.SelectedValue=r[0].DebitAccount:"True"==h.ScreenObject.Preferences["Credit Account"]&&(h.ScreenObject.DebitAccount.SelectedValue=r[0].CreditAccount)),this.SelectedLinkedDocs.forEach(t=>{h.FillLink(t[this.colVoucherID],e.DocumentLinkDefID,t._LinkedIDs,new Array)}),o.a.page.addNewTab(t)}))}NewDocument(e,t){return Object(i.b)(this,void 0,void 0,(function*(){let i={};const{AddEditDocumentComponent:a}=yield Promise.resolve().then(s.bind(null,"MCKn")),{AddEditDocumentViewModel:n}=yield Promise.resolve().then(s.bind(null,"1Cra"));let r=new n(parseInt(e),t,!1);Object.assign(i,{component:a,params:{obj:r}}),o.a.page.addNewTab(i)}))}OnStatusClick(e){this.ExtWhereLinkStatus&&(this.ExtWhere="",this.ExtWhereLinkStatus=!1),this.SelectedLinkedDocs.Clear(),this.StatusList.map(e=>e.IsSelected=!1),this.LinkStatusList.map(e=>e.IsSelected=!1),e.IsSelected=!0,this.SelectedStatus=e;let t=this.GetQuery(1);this.LoadData(t)}LoadData(e){this.DisplayName="Loading...",this.OnRowChange(null),o.a.report.DataSetAsyn("RPT022",e).then(e=>{let t,s,i,a,o=this.SelectedStatus?this.SelectedStatus.StatusID:0,n=e;if(this.GridObj.Clear(),n.Tables[0].forEach(e=>{e.id=this.GridObj.rowid,e.select=!1,this.colStatusID.length>0&&(e[this.colStatusID+"_CLR"]=m.AddEditDocumentViewModel.getStatusColor(e._StatusID)),t=this.SelectedLinkedDocs.find(t=>t[this.colVoucherID]==e[this.colVoucherID]),t&&(s=this.SelectedLinkedDocs.indexOf(t),-1!=s&&(e._LinkedIDs=t._LinkedIDs,e.select=!0,this.SelectedLinkedDocs[s]=e)),this.lstDateCols.forEach(t=>{e[t.ID+"_Key"]=new Date(e[t.ID]),e[t.ID]=e[t.ID+"_Key"].ToString(t.DataFormat.DateType)}),this.colAccStatusID.length>0&&(i=u.e.Int(e._BillAmt),a=u.e.Int(e._AdjAmt),0!=i&&(0==a?(e._AccStatus="Unpaid",e._AccStatus_CLR="#017EFA"):i-a==0?(e._AccStatus="Paid",e._AccStatus_CLR="#21bf74"):(e._AccStatus="Partially-Paid",e._AccStatus_CLR="#FF9700")))}),this.ExecutedQty.length>0){let e,t;n.Tables[0].forEach(s=>{e=u.e.Int(s.DQty),t=u.e.Int(s.DExQty),0==t?(s._LinkStatus="Pending",s._LinkStatus_CLR="#017EFA"):0!=t&&e-t>0?(s._LinkStatus="Partially-Executed",s._LinkStatus_CLR="#FF9700"):(s._LinkStatus="Executed",s._LinkStatus_CLR="#21bf74")})}this.GridObj.addRows(n.Tables[0]),n.Tables.length>1?(o<0?(this.TotalRows=n.Tables[2].filter(e=>e.StatusID==o).Compute("sum","CNT"),this.TotalPages=Math.floor(this.TotalRows/this.PageSize),this.TotalRows%this.PageSize>0&&this.TotalPages++):(this.TotalRows=n.Tables[1].Compute("sum","CNT"),this.TotalPages=Math.floor(this.TotalRows/this.PageSize),this.TotalRows%this.PageSize>0&&this.TotalPages++),0==o&&(this.OverallTotalRows=this.TotalRows.Commas("N0"),this.StatusList.Clear(),n.Tables[1].forEach(e=>{e.Clr=m.AddEditDocumentViewModel.getStatusColor(e.StatusID),e.CNTText=u.e.Int(e.CNT).Commas("N0"),e.Per=this.TotalRows>0?100*u.e.Int(e.CNT)/this.TotalRows:u.e.Int(e.CNT)>0?100:0,e.PerText=e.Per-Math.floor(e.Per)!=0?e.Per.Commas("N1")+"%":e.Per.Commas("N0")+"%",e.SOrder=371==e.StatusID?1:441==e.StatusID?2:372==e.StatusID?3:369==e.StatusID?4:376==e.StatusID?5:443==e.StatusID?6:445==e.StatusID?7:1e3}),n.Tables[1].SortBy(["SOrder"]),this.StatusList=n.Tables[1]),this.LoadDocLinkStatus()):null!=this.SelectedStatus&&this.CalculatePages(this.SelectedStatus.CNT);let r=(this.PageNo-1)*this.PageSize;this.CurrentRecords=(r+1).toString()+" - "+(r+n.Tables[0].length).toString()}).finally(()=>{this.DisplayName=this.Title})}LoadDocLinkStatus(){this.LinkStatusList.Clear(),0!=this.ExecutedQuery.length&&o.a.report.DataSetAsyn("RPT022",this.ExecutedQuery).then(e=>{if(0!=e.Tables.length){if(e.Tables[0].forEach(e=>{-2==e.StatusID?(e.Clr="#21bf74",e.Status="Excuted"):-3==e.StatusID?(e.Clr="#FF9700",e.Status="Partially-Excuted"):(e.Clr="#017EFA",e.Status="Open"),e.CNTText=u.e.Int(e.CNT).Commas("N0"),e.Per=this.TotalRows>0?100*u.e.Int(e.CNT)/this.TotalRows:u.e.Int(e.CNT)>0?100:0,e.PerText=e.Per-Math.floor(e.Per)!=0?e.Per.Commas("N1")+"%":e.Per.Commas("N0")+"%"}),this.ExtWhereLinkStatus){let t=e.Tables[0].find(e=>e.StatusID==parseInt(this.ExtWhere));t&&this.CalculatePages(t.CNT)}this.LinkStatusList=e.Tables[0]}})}CalculatePages(e){this.TotalRows=e,this.TotalPages=Math.floor(this.TotalRows/this.PageSize),this.TotalRows%this.PageSize>0&&this.TotalPages++}GetQuery(e){let t,s=this.SelectedStatus?this.SelectedStatus.StatusID:0,i="",a="",n="",r="",h=!1;return t=this.rpt.FromTag.Contains("INV")?"INV":"ACC",this.ExtWhereLinkStatus&&(s=parseInt(this.ExtWhere)),this.rpt.BaseReportColumns.forEach(e=>{e.CDGDO.ActualColumn&&(e.CDGDO.ActualColumn.Contains("(SELECT")||("FLOAT"==e.CDGDO.DataType?a+=",sum("+e.CDGDO.ActualColumn+") "+e.ID:e.CDGDO.ActualColumn.startsWith("stuff(")||e.CDGDO.ActualColumn.startsWith("STUFF(")?(h=!0,a+=","+e.CDGDO.ActualColumn+" "+e.ID):(a+=",max("+e.CDGDO.ActualColumn+") "+e.ID,this.colStatusID==e.ID&&(a+=",max("+e.CDGDO.ActualColumn+"ID) _StatusID"))))}),this.colAccStatusID.length>0&&(a+=",(SELECT ISNULL(SUM(abs(AdjAmount)),0) FROM COM_Billwise CB WITH(NOLOCK) WHERE CB.DocNo=INV.VoucherNo) _BillAmt\n            ,(SELECT ISNULL(SUM(abs(AdjAmount)),0) FROM COM_Billwise CB WITH(NOLOCK) WHERE IsNewReference=0 AND (CB.RefDocNo=INV.VoucherNo OR CB.DocNo=INV.VoucherNo)) _AdjAmt"),this.LinkStatusCol&&this.ExecutedQty.length>0||s<0?(i="with rows as ( SELECT row_number() over (order by DDocID desc) rowno,* from (SELECT ",i+="(select sum(DExQty) from (select  ("+this.ExecutedQty.split("INV.").join("D.")+") DExQty\nfrom INV_DocDetails D with(nolock)"+this.ExecutedQueryJoin.replace("INV.","D.")+" where D.DocID=INV.DocID\n) AS T)\nDExQty\n, sum(INV.Quantity) DQty\n,INV.DocID DDocID\n",i+=a):i="with rows as ( SELECT row_number() over (order by "+t+".DocID desc) rowno"+a,i+="\nFROM "+this.rpt.FromTag,this.ExecutedQueryJoin.length>0&&-1!=i.indexOf("sum(DExQty)")&&(i+=this.ExecutedQueryJoin),n=this.rpt.WhereTag,""==this.rpt.WhereTag?n=t+".CostCenterID="+this.Documents.SelectedValue:n+=" and "+t+".CostCenterID="+this.Documents.SelectedValue,2!=o.a.SessionManager.RoleType&&3!=o.a.SessionManager.RoleType||(n+=" and ("+t+".DebitAccount="+o.a.SessionManager.ESSID+" or "+t+".CreditAccount="+o.a.SessionManager.ESSID+")"),this.ExtWhereLinkStatus||(n+=this.ExtWhere),s>0&&(n+=" and "+t+".StatusID="+s),i+="\nWHERE "+n,r=t+".DocID,"+t+".VoucherNo",h&&(r=t+".CostCenterID,"+r),i+="\nGROUP BY "+r,this.LinkStatusCol&&this.ExecutedQty.length>0||s<0?(i+=") AS T",s<0&&(i+=-2==s?" where DQty-DExQty<=0":-3==s?" where DExQty!=0 and  DQty-DExQty>0":" where DExQty=0"),i+=") select * from rows WHERE rowno>"+(e-1)*this.PageSize+" and rowno<="+e*this.PageSize+" order by rowno"):i+=") select * from rows WHERE rowno>"+(e-1)*this.PageSize+" and rowno<="+e*this.PageSize+" order by rowno",1!=e||0!=s&&!this.ExtWhereLinkStatus||(i+="\nselect S.StatusID,S.Status,count(*) CNT from (\nSELECT "+t+".StatusID,"+t+".DocID\nFROM "+this.rpt.FromTag+"\nWHERE "+n+"\nGROUP BY "+t+".StatusID,"+r+") AS T\njoin COM_Status S with(nolock) on S.StatusID=T.StatusID\ngroup by S.StatusID,S.Status",this.ExecutedQty.length>0&&(this.ExecutedQuery="\n        select StatusID,count(*) CNT from(\n        select DocID,case when sum(DExQty)=0 then -1 when sum(Quantity)>sum(DExQty) then -3 else -2 end StatusID from (\n        SELECT "+t+".DocID,"+t+".Quantity,"+this.ExecutedQty+" DExQty\n        FROM "+this.rpt.FromTag+this.ExecutedQueryJoin+"\n        WHERE "+n+"\n        ) AS T GROUP BY DocID) AS T group by StatusID order by StatusID desc")),this.PageNo=e,i}GetPrefValue(e){let t=this.dsRpt.Tables[3].find(t=>t.PrefName==e&&t.CostCenterID==parseInt(this.Documents.SelectedValue));return t?u.e.String(t.PrefValue):""}}}}]);