function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,o){return t&&_defineProperties(e.prototype,t),o&&_defineProperties(e,o),e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var o,r=_getPrototypeOf(e);if(t){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[170],{X43T:function(e,t,o){"use strict";o.r(t),o.d(t,"AddBatchGroupViewModel",(function(){return s}));var r=o("Do2H"),a=o("ScVY"),n=o("VxiT"),c=o("EQd/"),i=o("0/4Q"),s=function(e){_inherits(o,e);var t=_createSuper(o);function o(e,r,a){var s;return _classCallCheck(this,o),(s=t.call(this)).objBatch={},s._ScreenData=[],s.ScreenObject=new n.a,s.BatchCode=new c.a(27184),s.BatchNumber=new c.d(1558),s.Status=new i.e(1552),s.NodeID=0,s.Group=new i.e(1557),s._ParentID=0,Logger.InfoLog("AddBatchGroupViewModel::Entering AddBatchGroupViewModel With ID"+e+",_Parent"+r+",ScreenName"+a),s.BatchCode.Label="Batch Code",s.BatchNumber.Label="Batch Number",s.BatchNumber.Mandatory=!0,s.Status.Label="Status",s.Group.Label="Group",s.Group.Mandatory=!0,s.objBatch.BatchID=0,s._ParentID=r,s._ScreenData=s.BuildControls(),s.ScreenObject.LoadScreen_2(_assertThisInitialized(s),16),null!=s._ScreenData&&s.ScreenObject.Data.Tables[3].forEach((function(e){s.Status.Items.push(i.d.ComboBoxItems_2(e[Object.keys(e)[1]].toString(),e[Object.keys(e)[0]].toString()))})),s.ScreenObject.Data.Tables[3].length>0&&(s.Status.SelectedValue=s.ScreenObject.Data.Tables[3][0][Object.keys(s.ScreenObject.Data.Tables[3][0])[0]].toString()),s.ScreenObject.Data.Tables[4].forEach((function(e){s.Group.Items.push(i.d.ComboBoxItems_2(e[Object.keys(e)[1]].toString(),e[Object.keys(e)[0]].toString()))})),0!=r&&(s.Group.SelectedValue=r.toString()),s.objBatch.GUID="",s.objBatch.IsGroup=!0,null!=s.ScreenObject.Data&&s.ScreenObject.Data.Tables.length>9&&s.ScreenObject.Data.Columns[9].Contains("IsParentCodeInherited")&&s.ScreenObject.Data.Tables[9].length>0&&s.ScreenObject.InitAutoCode(s.ScreenObject.Data.Tables[9],s.objBatch.IsGroup),e>0&&(s.NodeID=e,s.objBatch.BatchID=s.NodeID,s.FillControls()),0==e&&s.AutoGenerateCode(),Logger.InfoLog("AddBatchGroupViewModel::Exiting AddBatchGroupViewModel"),s}return _createClass(o,[{key:"BuildControls",value:function(){Logger.InfoLog("QuickAddBatchViewModel::Entering BuildControls");try{var e=new n.a;return this.PactScreenID="16",e.GetControls(this.PactScreenID,r.a.SessionManager.CompanyIndex)}catch(t){return Logger.ErrorLog("QuickAddBatchViewModel:: BuildControls"+t.stack),null}}},{key:"FillControls",value:function(){if(this.NodeID>0){this.objBatch.BatchID=this.NodeID;var e=r.a.inventory.GetBatchDetails(this.NodeID);Object.assign(this.objBatch,e.obj),""!=this.objBatch.BatchCode&&(this.BatchCode.Text=this.objBatch.BatchCode),(this.ScreenObject.InheritParentCode||this.ScreenObject.IsAutoCode)&&(this.BatchCode.Enable=!1),this.BatchNumber.Enable&&(this.BatchNumber.Text=this.objBatch.BatchNumber),this.Status.Enable&&(this.Status.SelectedValue=this.objBatch.BatchStatus.toString()),this.Group.Enable&&(this.Group.SelectedValue=this.objBatch.BatchGroup.toString())}else this.objBatch.GUID=""}},{key:"OnSaveGroup",value:function(e){var t=this;Logger.InfoLog("AddBatchGroupViewModel::Entering OnSaveGroup");try{if("Save"==e.toString()){var o=this.ScreenObject.ValidateData();if(o.length>0)return this.MessageVisibility=!0,void(this.DisplayMessage=o);var a=[];if(0==this.objBatch.BatchID){var n={StrCode:this.objBatch.BatchCode,CodePrefix:this.objBatch.CodePrefix,CodeNumber:this.objBatch.CodeNumber};if(this.DisplayMessage=this.ScreenObject.SetAutoCodeParams_3(this.BatchCode,this.objBatch.BatchGroup,this.ScreenObject.Data.Tables[9],n),this.objBatch.BatchCode=n.StrCode,this.objBatch.CodePrefix=n.CodePrefix,this.objBatch.CodeNumber=n.CodeNumber,this.DisplayMessage.length>0)return}else this.objBatch.BatchCode=this.BatchCode.Text;a.push(this.BatchNumber.Text),a.push(null),a.push(null),a.push(""),a.push(null),a.push(parseInt(this.Status.SelectedValue)),a.push(0),a.push(null),a.push(0),a.push(0),a.push(null),a.push(0),a.push(0),a.push(null),a.push(0),a.push(null),a.push(0),a.push(0),a.push(0),a.push(parseInt(this.Group.SelectedValue)),a.push(null);r.a.inventory.AddBatchQuickAndGroup(this.objBatch,"AddBatchQuickAndGroup",JSON.stringify(a)).subscribe((function(e){t.MessageVisibility=!0,t.DisplayMessage=e.Message,e.RetValue>0&&(t.ScreenObject.Clear(),t.Parent.Refresh(),t.objBatch.BatchID>0&&(t.BatchCode.Text="")),Logger.InfoLog("AddEditBatchViewModel::Exiting OnSaveBatch")}),(function(e){console.log("AddEditBatchViewModel Save : "+JSON.stringify(e))}))}else"Cancel"==e.toString()&&r.a.page.HideDialog();Logger.InfoLog("AddBatchGroupViewModel::Exiting OnSaveGroup")}catch(c){Logger.ErrorLog("AddBatchGroupViewModel:: OnSaveGroup"+c.stack)}}},{key:"onCanGroup",value:function(e){return!0}},{key:"AutoGenerateCode",value:function(){0==this.objBatch.BatchID&&(this.objBatch.BatchGroup=""!=this.Group.SelectedValue?parseInt(this.Group.SelectedValue)>0?parseInt(this.Group.SelectedValue):0:1,this.ScreenObject.SetAutoCode(this.BatchCode,this.objBatch.IsGroup,this.objBatch.BatchGroup,this.ScreenObject.Data.Tables[9]))}}]),o}(a.b)}}]);