function _toArray(t){return _arrayWithHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}function _iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,a){return e&&_defineProperties(t.prototype,e),a&&_defineProperties(t,a),t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var a,n=_getPrototypeOf(t);if(e){var i=_getPrototypeOf(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function _possibleConstructorReturn(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{P6ee:function(t,e,a){"use strict";a.r(e),a.d(e,"AddEditRenContractViewModel",(function(){return Z})),a.d(e,"PromptIsOpening",(function(){return $}));var n=a("mrSG"),i=a("Do2H"),s=a("Lp6j"),r=a("eQJW"),o=a("4HhE"),l=a("n56n"),c=a("0/4Q"),u=a("8B8H"),D=a("ockk"),h=a("VxiT"),C=a("Jnyl"),m=a("EQd/"),b=a("NkMH"),S=a("JIg3"),d=a("sDFv"),T=a("vTM8"),y=a("xnJf"),g=a("RJs6"),I=a("c6C+"),p=a("OvA8"),A=a("ScVY"),f=a("DKUf"),P=a("CQvG"),N=a("MCLT"),V=a("CUWK"),R=function(t){_inherits(a,t);var e=_createSuper(a);function a(t){var n;if(_classCallCheck(this,a),(n=e.call(this)).DisplayName="",n.Width="600",n.MessageVisibility=!1,n.PostingDate=new S.a(0),n.CheqStartDate=new S.a(0),n.Amount=new m.d(0),n.AmountinGenChq=new m.d(0),n.ChequeBankName=new m.d(0),n.NoofCheques=new m.d(0),n.FirstChequeNo=new m.d(0),n.InstallmentPeriod=new m.d(0),n.PayeeBank=new c.e(0),n.InstallmentYear=new c.e(0),n.Particulars=new c.b(0),n.SelectedValueChanged=!1,n.DebitAcc=new l.b(0),n.PrevVal="",n.oparent=t,n.ChequeBankName.Visible=!1,n.Amount.Visible=!1,n.DebitAcc.Label="Bank Account",n.DebitAcc.CCID=2,n.DebitAcc.TypeID=100,n.DebitAcc.IsPartiralData=!0,n.InstallmentPeriod.Text="0",n.Particulars.Visible=!1,n.Particulars.LblWidth="2",n.AmountinGenChq.Visible=!1,"AddEditRenContractViewModel"==t.ClassName){var o=t.ContractPayTerms.find((function(t){return"DebitAccountID"==t.DisplayMember}));if(null!=o&&null!=o&&(n.DebitAcc.TypeID=o.TypeID),null!=t.ScreenObject.Data&&t.ScreenObject.Data.Tables.length>8)for(var u=0;u<t.ScreenObject.Data.Tables[8].length;u++)n.PayeeBank.Items.push(c.d.ComboBoxItems_2(t.ScreenObject.Data.Tables[8][u].PayNodeID.toString(),t.ScreenObject.Data.Tables[8][u].PayeeBank.toString()));if(null!=t.ScreenObject.Data&&t.ScreenObject.Data.Tables.length>5){var D=t.ScreenObject.Data.Tables[5].filter((function(t){return"ShowInstallmentPeriod"==t.Name}));D.length>0&&(n.InstallmentPeriod.Visible=Object(r.j)(D[0].Value))}if("AddEditRenContractViewModel"==t.ClassName&&n.oparent.ShowAmountinGenChq&&(n.AmountinGenChq.Visible=!0,n.AmountinGenChq.Label="Amount"),n.InstallmentYear.Visible=!1,n.InstallmentYear.SelectionChangedCommand.Subscribe(_assertThisInitialized(n),"onselection"),n.FillValues(),t.GenChqOthPart){n.Particulars.Visible=!0,n.Width="760";for(var h=function(t){var e="";if(s.e.IsEmpty(n.oparent.DataTable[t].Particulars)&&!s.e.IsEmpty(n.oparent.DataTable[t].NodeID)){if(null!=(b=n.oparent.ContractParticular.find((function(t){return!s.e.IsEmpty(t.ValueBinding)&&"NodeID"==t.ValueBinding})))&&null!=b){var a=b.ComboData.filter((function(e){return e.NodeID==n.oparent.DataTable[t].NodeID.toString()}));a.length>0&&(e=a[0].Particulars.toString())}}else e=s.e.String(n.oparent.DataTable[t].Particulars);0==t?(n.Particulars.Items.push(c.c.CheckedListBoxItem_4(e,n.oparent.DataTable[t].NodeID.toString(),s.e.String(n.DebitAcc.SelectedValue))),"Inclusive"!=s.e.String(n.oparent.DataTable[t].VatType)&&!s.e.IsEmpty(n.oparent.DataTable[t].VatAmount)&&parseFloat(n.oparent.DataTable[t].VatAmount)>0&&n.Particulars.Items.push(c.c.CheckedListBoxItem_3(e+" vat","-"+n.oparent.DataTable[t].NodeID.toString()))):(""!=e&&""==s.e.String(n.oparent.DataTable[t].DebitAccountID_Key)||"0"==s.e.String(n.oparent.DataTable[t].DebitAccountID_Key))&&(null!=n.oparent.DataTable[t].Amount&&""!=n.oparent.DataTable[t].Amount.toString()&&parseFloat(n.oparent.DataTable[t].Amount)>0&&n.Particulars.Items.push(c.c.CheckedListBoxItem_4(e,n.oparent.DataTable[t].NodeID.toString(),s.e.String(n.oparent.DataTable[t].BankAccountID))),"Inclusive"!=s.e.String(n.oparent.DataTable[t].VatType)&&null!=n.oparent.DataTable[t].VatAmount&&""!=n.oparent.DataTable[t].VatAmount.toString()&&parseFloat(n.oparent.DataTable[t].VatAmount)>0&&n.Particulars.Items.push(c.c.CheckedListBoxItem_3(e+" vat","-"+n.oparent.DataTable[t].NodeID.toString())))},C=0;C<n.oparent.DataTable.length;C++){var b;h(C)}}n.FillInstallments(),n.NoofCheques.Label=i.a.GetResource("Ren_CntrctNoCheque"),n.FirstChequeNo.Label=i.a.GetResource("Ren_CntrctFirstChequeNo"),n.CheqStartDate.Label=i.a.GetResource("Ren_CntrctCheStartD"),n.PayeeBank.Label=i.a.GetResource("Ren_CntrctPayee"),n.ChequeBankName.Label="Bank Name",n.InstallmentPeriod.Label=i.a.GetResource("Ren_CntrctInstallmentPeriod"),n.Amount.Label="Amount",n.PostingDate.Label="Posting Date",n.DisplayName=i.a.GetResource("Ren_CntrctCheqNo")}else"AddEditDocumentViewModel"==n.oparent.ClassName&&(n.PayeeBank.Visible=!1,n.ChequeBankName.Visible=!0,n.Amount.Visible=!0,n.Amount.DataType="FLOAT",n.NoofCheques.DataType="FLOAT",n.InstallmentPeriod.Visible=!1,n.DebitAcc.Label="Account Name",n.DisplayName=i.a.GetResource("Ren_CntrctCheqNo"));return _possibleConstructorReturn(n)}return _createClass(a,[{key:"onselection",value:function(t){this.InstallmentYear.SelectedValue!=this.PrevVal&&(this.PrevVal=this.InstallmentYear.SelectedValue,this.InstallmentYear.Expression=this.oparent.GenChqOthPart?this.GetTotAmount().ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()):this.InstallmentYear.SelectedItem.Aliasname)}},{key:"oncheckedchanged",value:function(t){this.InstallmentYear.Expression=this.GetTotAmount().ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),this.AmountinGenChq.Text=this.InstallmentYear.Expression=this.GetTotAmount().ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),this.ValidateParticulars()?this.AmountinGenChq.Text=this.InstallmentYear.Expression=this.GetTotAmount().ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()):t instanceof c.c&&(t.IsChecked=!1,this.DisplayMessage="Can not select different banks.",this.MessageVisibility=!0)}},{key:"ValidateParticulars",value:function(){var t=0;return this.Particulars.Items.forEach((function(e){if(e.IsChecked&&!s.e.IsEmpty(e.Parent)&&parseInt(e.Parent)>0){if(t>0&&t!=parseInt(e.Parent))return!1;t=parseInt(e.Parent)}})),t>0&&(this.DebitAcc.SelectedValue=t),!0}},{key:"FillInstallments",value:function(){var t=this;if(!s.e.IsEmpty(this.oparent.DataTable[0].Xml)){var e=new s.f;e.LoadXml(this.oparent.DataTable[0].Xml.toString());var a=-1;if(e.DocumentElement.children.length>0&&!s.e.IsEmpty(e.DocumentElement.children[0].attributes)&&!s.e.IsEmpty(e.DocumentElement.children[0].attributes.Filter)&&!s.e.IsEmpty(e.DocumentElement.children[0].attributes.Filter.value)&&(a=parseInt(e.DocumentElement.children[0].attributes.Filter.value)),2==a||-1==a){this.InstallmentYear.Visible=!0,this.InstallmentYear.Enable=!1;new Date,new Date;e.DocumentElement.children[0].childNodes.forEach((function(t){s.e.isValidDate(t.attributes.FromDate.value)&&new Date(t.attributes.FromDate.value),s.e.isValidDate(t.attributes.ToDate.value)&&new Date(t.attributes.ToDate.value)}))}else if(0==a){this.InstallmentYear.Visible=!0,this.InstallmentYear.Enable=!1;var n=e.SelectNodes("XML/UnitsRow/Row"),r=new Date,o=new Date;n.forEach((function(e){s.e.isValidDate(e.attributes.FromDate.value)&&(r=new Date(e.attributes.FromDate.value)),s.e.isValidDate(e.attributes.ToDate.value)&&(o=new Date(e.attributes.ToDate.value));var a=t.InstallmentYear.Items.find((function(t){return!s.e.IsEmpty(t.Value)&&!s.e.IsEmpty(t.Parent)&&new Date(t.Value)==r&&new Date(t.Parent)==o}));null!=a&&(a.Aliasname=(parseFloat(a.Aliasname)+t.GetVatInclAmt(0,e.attributes.Amount.Value)).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()))}))}for(var l=function(r){if(((null==s.e.String(t.oparent.DataTable[r].DebitAccountID_Key)||""==s.e.String(t.oparent.DataTable[r].DebitAccountID_Key)||"0"==s.e.String(t.oparent.DataTable[r].DebitAccountID_Key))&&!t.oparent.CheckNumbersForRent||"0"!=s.e.String(t.oparent.DataTable[r].InclChkGen))&&!s.e.IsEmpty(t.oparent.DataTable[r].Amount)&&parseFloat(t.oparent.DataTable[r].Amount)>0)if(s.e.IsEmpty(t.oparent.DataTable[r].Xml))null!=(u=t.InstallmentYear.Items.find((function(t){return new Date(t.Value)})))&&null!=u&&(u.Aliasname=(parseFloat(u.Aliasname)+t.GetVatInclAmt(r,t.oparent.DataTable[r].Amount.toString())).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()));else if(e.LoadXml(t.oparent.DataTable[r].Xml.toString()),a=-1,e.DocumentElement.children.length>0&&!s.e.IsEmpty(e.DocumentElement.children[0].attributes)&&!s.e.IsEmpty(e.DocumentElement.children[0].attributes.Filter)&&!s.e.IsEmpty(e.DocumentElement.children[0].attributes.Filter.value)&&(a=parseInt(e.DocumentElement.children[0].attributes.Filter.value)),2==a||-1==a){t.InstallmentYear.Visible=!0,t.InstallmentYear.Enable=!1;var o=new Date,l=new Date;e.DocumentElement.children[0].childNodes.forEach((function(e){s.e.isValidDate(e.attributes.FromDate.value)&&(o=new Date(e.attributes.FromDate.value)),s.e.isValidDate(e.attributes.ToDate.value)&&(l=new Date(e.attributes.ToDate.value));var a=t.InstallmentYear.Items.find((function(t){return!s.e.IsEmpty(t.Value)&&!s.e.IsEmpty(t.Parent)&&new Date(t.Value)==o&&new Date(t.Parent)==l}));null!=a&&null!=a&&(a.Aliasname=(parseFloat(a.Aliasname)+t.GetVatInclAmt(r,e.attributes.Amount.value)).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()))}))}else if(0==a){t.InstallmentYear.Visible=!0,t.InstallmentYear.Enable=!1,n=e.SelectNodes("XML/UnitsRow/Row");var c=new Date,D=new Date;n.forEach((function(e){s.e.isValidDate(e.attributes.FromDate.value)&&(c=new Date(e.attributes.FromDate.value)),s.e.isValidDate(e.attributes.ToDate.value)&&(D=new Date(e.attributes.ToDate.value));var a=t.InstallmentYear.Items.find((function(t){return!s.e.IsEmpty(t.Value)&&!s.e.IsEmpty(t.Parent)&&new Date(t.Value)==c&&new Date(t.Parent)==D}));null!=a&&null!=a&&(a.Aliasname=(parseFloat(a.Aliasname)+t.GetVatInclAmt(r,e.attributes.Amount.value)).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()))}))}},c=1;c<this.oparent.DataTable.length;c++){var u;l(c)}}}},{key:"GetVatInclAmt",value:function(t,e){if("2"==this.oparent.DataTable[t].InclChkGen.toString()){if("Inclusive"!=s.e.String(this.oparent.DataTable[t].VatType)&&!s.e.IsEmpty(this.oparent.DataTable[t].VatPer))return parseFloat(e)+parseFloat(e)*parseFloat(this.oparent.DataTable[t].VatPer)/100}else if("1"==s.e.String(this.oparent.DataTable[t].InclChkGen)&&"Inclusive"==s.e.String(this.oparent.DataTable[t].VatType)&&!s.e.IsEmpty(this.oparent.DataTable[t].VatPer))return 100*parseFloat(e)/(parseFloat(this.oparent.DataTable[t].VatPer)+100);return parseFloat(e)}},{key:"FillValues",value:function(){"AddEditRenContractViewModel"==this.oparent.ClassName&&(this.PostingDate.Visible=this.oparent.InclPostingDate,null!=this.oparent.stDate&&(this.CheqStartDate.Date=this.oparent.stDate),null!=this.oparent.PayeeBnk&&(this.PayeeBank.SelectedValue=this.oparent.PayeeBnk),this.NoofCheques.Text=this.oparent.NoofCheques.toString(),null!=this.oparent.FirstNumber&&(this.FirstChequeNo.Text=this.oparent.FirstNumber.toString()),this.DebitAcc.SelectedValue=0!=this.oparent.DebitAcc?this.oparent.DebitAcc:this.oparent.GenDebitAcc,this.InstallmentPeriod.Text=this.InstallmentPeriod.Visible?this.oparent.InstPeriod.toString():"0")}},{key:"GetTotAmount",value:function(){for(var t=this,e=0,a=new s.f,n=0,i=function(i){var r=t.Particulars.Items[i];if(!r.Value.startsWith("-")&&(o=t.Particulars.Items.find((function(t){return t.Value=="-"+r.Value})),(l=t.oparent.DataTable.filter((function(t){return t.NodeID==r.Value.replace("-","")}))).length>0))if(t.InstallmentYear.Visible&&t.InstallmentYear.Enable){if(!s.e.IsEmpty(t.InstallmentYear.SelectedValue))if(""!=l[0].Xml.toString()){if(a.LoadXml(l[0].Xml.toString()),n=-1,a.DocumentElement.children.length>0&&!s.e.IsEmpty(a.DocumentElement.children[0].attributes)&&!s.e.IsEmpty(a.DocumentElement.children[0].attributes.Filter)&&!s.e.IsEmpty(a.DocumentElement.children[0].attributes.Filter.value)&&(n=parseInt(a.DocumentElement.children[0].attributes.Filter.value)),2==n||-1==n){var u=new Date,D=new Date;a.DocumentElement.children[0].childNodes.forEach((function(a){s.e.isValidDate(a.attributes.FromDate.value)&&(u=new Date(a.attributes.FromDate.value)),s.e.isValidDate(a.attributes.ToDate.value)&&(D=new Date(a.attributes.ToDate.value)),new Date(t.InstallmentYear.SelectedItem.Value)==u&&new Date(t.InstallmentYear.SelectedItem.Parent)==D&&(r.IsChecked&&(e+=parseFloat(a.attributes.Amount.value)),null!=o&&o.IsChecked&&""!=l[0].VatPer.toString()&&(e+=parseFloat(a.attributes.Amount.value)*parseFloat(l[0].VatPer)/100))}))}else if(0==n){c=a.SelectNodes("XML/UnitsRow/Row");var h=new Date,C=new Date;c.forEach((function(a){s.e.isValidDate(a.attributes.FromDate.value)&&(h=new Date(a.attributes.FromDate.value)),s.e.isValidDate(a.attributes.ToDate.value)&&(C=new Date(a.attributes.ToDate.value)),new Date(t.InstallmentYear.SelectedItem.Value)==h&&new Date(t.InstallmentYear.SelectedItem.Parent)==C&&(r.IsChecked&&(e+=parseFloat(a.attributes.Amount.value)),null!=o&&o.IsChecked&&""!=l[0].VatPer.toString()&&(e+=parseFloat(a.attributes.Amount.value)*parseFloat(l[0].VatPer)/100))}))}}else 0==t.InstallmentYear.SelectedIndex&&(r.IsChecked&&null!=l[0].Amount&&""!=l[0].Amount.toString()&&parseFloat(l[0].Amount)>0&&(e+=parseFloat(l[0].Amount)),null!=o&&o.IsChecked&&""!=l[0].VatPer.toString()&&null!=l[0].Amount&&""!=l[0].Amount.toString()&&parseFloat(l[0].Amount)>0&&(e+=parseFloat(l[0].Amount)*parseFloat(l[0].VatPer)/100))}else r.IsChecked&&null!=l[0].Amount&&""!=l[0].Amount.toString()&&parseFloat(l[0].Amount)>0&&(e+=parseFloat(l[0].Amount)),null!=o&&o.IsChecked&&""!=l[0].VatPer.toString()&&null!=l[0].Amount&&""!=l[0].Amount.toString()&&parseFloat(l[0].Amount)>0&&(e+=parseFloat(l[0].Amount)*parseFloat(l[0].VatPer)/100)},r=0;r<this.Particulars.Items.length;r++){var o,l,c;i(r)}return e}},{key:"OnSave",value:function(t){if("Cancel"==t)i.a.page.HideDialog();else if("OK"==t){if(null==this.NoofCheques.Text||""==this.NoofCheques.Text.Trim())return this.DisplayMessage="Please enter No of Cheques",void(this.MessageVisibility=!0);if(!s.e.ValidateInt(this.NoofCheques.Text))return this.DisplayMessage="Invalid No of Cheques",void(this.MessageVisibility=!0);if(null!=this.NoofCheques.Text&&parseInt(this.NoofCheques.Text)<=0)return this.DisplayMessage="Please enter No of Cheques greater than zero",void(this.MessageVisibility=!0);if(null!=this.InstallmentPeriod.Text&&""!=this.InstallmentPeriod.Text.Trim()||(this.InstallmentPeriod.Text="0"),!s.e.ValidateInt(this.InstallmentPeriod.Text))return this.DisplayMessage="Invalid No of Instalments",void(this.MessageVisibility=!0);if(null==this.FirstChequeNo.Text||""==this.FirstChequeNo.Text.Trim())return this.DisplayMessage="Please enter First Cheque No",void(this.MessageVisibility=!0);if(!s.e.ValidateInt(this.FirstChequeNo.Text))return this.DisplayMessage="Invalid First Cheque No",void(this.MessageVisibility=!0);if(null!=this.FirstChequeNo.Text&&parseInt(this.FirstChequeNo.Text)<=0)return this.DisplayMessage="Please enter First Cheque No greater than zero",void(this.MessageVisibility=!0);if(!this.ValidateCheque()&&"AddEditDocumentViewModel"!=this.oparent.ClassName)return this.DisplayMessage="No of Cheques exceeds Total Days",void(this.MessageVisibility=!0);if(this.InstallmentYear.Visible&&this.InstallmentYear.Enable&&s.e.IsEmpty(this.InstallmentYear.SelectedValue))return this.DisplayMessage="Select InstallmentYear",void(this.MessageVisibility=!0);if(this.Particulars.Visible){this.Particulars.Enable=!1;for(var e=0;e<this.Particulars.Items.length;e++)if(this.Particulars.Items[e].IsChecked){this.Particulars.Enable=!0;break}if(!this.Particulars.Enable)return this.DisplayMessage="Select any particular to generate cheques.",void(this.MessageVisibility=!0)}if("AddEditRenContractViewModel"==this.oparent.ClassName){var a="";if(this.PostingDate.Visible&&(a=this.PostingDate.Date.ToString("dd/MMM/yyyy")),this.Particulars.Visible){var n,r=0,o="";this.Particulars.Items.forEach((function(t){t.IsChecked&&(o=o+t.Name+",",parseInt(t.Value)>0?r=parseInt(t.Value):parseInt(t.Value)<0&&(r=parseInt(t.Value.Replace("-",""))))})),n=this.AmountinGenChq.Visible&&!s.e.IsEmpty(this.AmountinGenChq.Text)&&s.e.DoubleTryParse(this.AmountinGenChq.Text)?s.e.DoubleTryParse(this.AmountinGenChq.Text):this.GetTotAmount(),this.InstallmentYear.Visible&&this.InstallmentYear.Enable?this.oparent.GenerateChequeNos(parseInt(this.NoofCheques.Text),this.FirstChequeNo.Text,this.CheqStartDate.Date,this.PayeeBank.SelectedValue,this.DebitAcc.SelectedValue,this.DebitAcc.Text,parseInt(this.InstallmentPeriod.Text),this.InstallmentYear.GetselectedItem().Value,this.InstallmentYear.GetselectedItem().Parent,n.toString(),a,this.InstallmentYear.GetselectedItem().CurrID,o.TrimEnd(","),r):this.oparent.GenerateChequeNos(parseInt(this.NoofCheques.Text),this.FirstChequeNo.Text,this.CheqStartDate.Date,this.PayeeBank.SelectedValue,this.DebitAcc.SelectedValue,this.DebitAcc.Text,parseInt(this.InstallmentPeriod.Text),"","",n.toString(),a,0,o.TrimEnd(","),r)}else this.InstallmentYear.Visible&&this.InstallmentYear.Enable?this.oparent.GenerateChequeNos(parseInt(this.NoofCheques.Text),this.FirstChequeNo.Text,this.CheqStartDate.Date,this.PayeeBank.SelectedValue,this.DebitAcc.SelectedValue,this.DebitAcc.Text,parseInt(this.InstallmentPeriod.Text),this.InstallmentYear.GetselectedItem().Value,this.InstallmentYear.GetselectedItem().Parent,this.InstallmentYear.GetselectedItem().Aliasname,a,this.InstallmentYear.GetselectedItem().CurrID,"",0):this.oparent.GenerateChequeNos(parseInt(this.NoofCheques.Text),this.FirstChequeNo.Text,this.CheqStartDate.Date,this.PayeeBank.SelectedValue,this.DebitAcc.SelectedValue,this.DebitAcc.Text,parseInt(this.InstallmentPeriod.Text),"","","",a,0,"",0)}i.a.page.HideDialog()}}},{key:"ValidateCheque",value:function(){var t=0,e=0;null!=this.NoofCheques.Text&&""!=this.NoofCheques.Text&&(t=parseInt(this.NoofCheques.Text)),"AddEditRenContractViewModel"==this.oparent.ClassName&&null!=this.oparent.TotalDays.Text&&""!=this.oparent.TotalDays.Text&&(e=parseInt(this.oparent.TotalDays.Text)/30);return t>e&&"AddEditRenContractViewModel"==this.oparent.ClassName?(parseInt(this.oparent.TotalDays.Text)/t,this.oparent.IsMonth=!1,!0):0!=e/t&&("AddEditRenContractViewModel"==this.oparent.ClassName&&(this.oparent.IsMonth=!0),!0)}},{key:"SelectedValue",get:function(){return this._selectedvalue},set:function(t){this._selectedvalue!=t&&(this._selectedvalue=t,this.SelectedValueChanged=!this.SelectedValueChanged)}}]),a}(A.b),M=a("G3ee"),E=function(t){_inherits(a,t);var e=_createSuper(a);function a(t,n,s,r){var o;return _classCallCheck(this,a),(o=e.call(this)).objContract={},o.ContractID=0,o.TerminationDate=new S.c(0),o.TerminationPostDate=new S.c(0),o.PaymentVisible=!0,o.PaymentOption=new c.e(0),o.BankAccount=new l.b(0),o.ChequeNo=new m.d(0),o.ChequeDate=new S.a(0),o.Remarks=new m.d(0),o.Title="",o.ContractNumber="",o.ContractNumberText=new m.d(0),o.DeleteVisible=!1,o.Reason=new l.b(0),o.Action=0,o.parent=t,o.Action=r,o.ContractID=n,o.ContractNumber=s,o.ContractNumberText.Label=i.a.GetResource("Ren_SelContract"),o.ContractNumberText.Text=s,o.MessageVisibility=!1,o.DeleteVisible=!0,o.Reason.Label="Reason",o.BankAccount.Label="Payment Mode",o.BankAccount.CCID=2,o.BankAccount.TypeID=100,o.ChequeDate.Label="Cheque Date",o.Remarks.Label="Remarks",o.ChequeNo.Label="Cheque No",o.PaymentOption.Visible=!1,o.PaymentVisible=!0,o.TerminationPostDate.Visible=!1,1==r?(o.TerminationDate.Label=i.a.GetResource("Ren_CntrctTerDate"),o.parent.TermPosting&&(o.TerminationPostDate.Visible=!0),o.TerminationPostDate.Label="Posting Date",o.Title=i.a.GetResource("REN_CntrctTerminatePref"),o.Validation()):2==r?(o.TerminationDate.Label="Vacancy Date",o.parent.TermPosting&&(o.TerminationPostDate.Visible=!0),o.Title="Close Contract",o.Reason.Visible=!1):3==r||5==r?(o.TerminationDate.Label="Refund Date*",o.TerminationDate.Date=null,o.Title="Refund",o.Reason.Visible=!1,5==r?o.PaymentOption.Visible=o.PaymentVisible=!1:o.parent.TermPosting&&(o.TerminationPostDate.Visible=!0)):4==r&&(o.TerminationDate.Label="Date*",o.TerminationDate.Date=null,o.Title="Suspend",o.Reason.Visible=!1,o.TerminationDate.Date=new Date,o.PaymentOption.Label="Payment",o.PaymentOption.Items.push(c.d.ComboBoxItems_2("None","0")),o.PaymentOption.Items.push(c.d.ComboBoxItems_2("Cancel Payment","1")),o.PaymentOption.Items.push(c.d.ComboBoxItems_2("Return Payment","2")),o.PaymentOption.SelectedValue="0",o.PaymentOption.SelectionChangedCommand.Subscribe(_assertThisInitialized(o),"OnSelectionChanged"),o.PaymentOption.Visible=!0,o.PaymentVisible=!1),o}return _createClass(a,[{key:"OnSelectionChanged",value:function(t){this.PaymentVisible=!s.e.IsEmpty(this.PaymentOption.SelectedValue)&&"2"==this.PaymentOption.SelectedValue}},{key:"Validation",value:function(){i.a.SessionManager.Preferences.ContainsKey("TerminationReason")&&""!=i.a.SessionManager.Preferences.TerminationReason?(this.Reason.CCID=parseInt(i.a.SessionManager.Preferences.TerminationReason),this.Reason.TypeID=1):(this.DisplayMessage="Please set Reason Dimension",this.MessageVisibility=!0)}},{key:"OnDelete",value:function(t){if(this.MessageVisibility=!1,"Cancel"==t)this.parent.DeleteVisibility=!1,i.a.page.HideDialog();else try{if(4==this.Action)return this.TerminationDate.Date?void this.parent.OnCustomizeExtraFields("SuspendReservation"):(this.DisplayMessage="select date.",void(this.MessageVisibility=!0));if(5==this.Action)return this.TerminationDate.Date?void this.parent.ProcessFullRefund(this.TerminationDate.Date):(this.DisplayMessage="select date.",void(this.MessageVisibility=!0));if(1==this.Action){if(null!=this.parent.StartDate&&this.parent.StartDate.Date&&this.TerminationDate.Date<this.parent.StartDate.Date)return this.DisplayMessage="Termination date should be higher than contract start date",void(this.MessageVisibility=!0);if(null!=this.parent.EndDate&&this.parent.EndDate.Date&&this.TerminationDate.Date>=this.parent.EndDate.Date)return this.DisplayMessage="Termination date should be lower than contract end date",void(this.MessageVisibility=!0);if(this.parent.TermPosting){if(!this.TerminationPostDate.Date)return this.DisplayMessage="Select Posting date",void(this.MessageVisibility=!0);if(this.TerminationPostDate.Date<this.TerminationDate.Date)return this.DisplayMessage="Termination date should be lower than Posting date",void(this.MessageVisibility=!0)}}else if(2==this.Action){if(null!=this.parent.EndDate&&this.parent.EndDate.Date&&this.TerminationDate.Date<this.parent.EndDate.Date)return this.DisplayMessage="VacancyDate should be higher than contract end date",void(this.MessageVisibility=!0)}else if(3==this.Action){if(null==this.TerminationDate.Date)return this.DisplayMessage="Select RefundDate",void(this.MessageVisibility=!0);if(null!=this.parent.EndDate&&this.parent.EndDate.Date&&this.TerminationDate.Date<=this.parent.EndDate.Date)return this.DisplayMessage="RefundDate should be higher than contract end date",void(this.MessageVisibility=!0);if(this.parent.TermPosting){if(!this.TerminationPostDate.Date)return this.DisplayMessage="Select Posting date",void(this.MessageVisibility=!0);if(this.TerminationPostDate.Date<this.TerminationDate.Date)return this.DisplayMessage="RefundDate should be lower than Posting date",void(this.MessageVisibility=!0)}}this.parent.TerminateContract(this.ContractID,this.Reason.SelectedValue,this.TerminationDate.Date,this.Action,!1)}catch(e){Logger.ErrorLog("TerminateRenContractViewModel:: OnDelete"+e.stack)}}}]),a}(A.b),v=a("QVxu"),O=function(t){_inherits(a,t);var e=_createSuper(a);function a(t,n,r,o,l,c,h,C,m,b){var S,d;_classCallCheck(this,a),(S=e.call(this)).DisplayName="",S.OTherExpVisi=!1,S.RefreshGrid=!1,S.Header=[],S.UpdateFooter=!1,S.DtExpensesObj=new u.a,S.PaymentDetails=[],S.DtChequesObj=new u.a,S.result=!1,S.BalanceAmt=0,S.Totpen=0,S.pdcAndBounced=0,S.tot=0,S.oParent=null,S.oParent=t,S.BalanceAmt=l,S.tot=n+r-o-c,S.Header=[],S.PaymentDetails=[],S.OTherExpVisi=!1,S.ColmnSrc=[],(d=new D.a).Header="Type",d.DisplayMember="Type",d.Width=50,S.ColmnSrc.push(d),(d=new D.a).Header="Cheque No",d.DisplayMember="ChequeNo",d.Width=100,S.ColmnSrc.push(d),(d=new D.a).Header="Cheque Date",d.DisplayMember="ChequeDate",d.Width=100,S.ColmnSrc.push(d),(d=new D.a).Header="Amount",d.DisplayMember="Amount",d.DataType="FLOAT",d.Width=80,d.DecimalPoints=i.a.SessionManager.Preferences.DecimalsinAmount.toString(),S.ColmnSrc.push(d),(d=new D.a).Header="Pending",d.DisplayMember="PendingAmount",d.DataType="FLOAT",d.Width=80,d.DecimalPoints=i.a.SessionManager.Preferences.DecimalsinAmount.toString(),S.ColmnSrc.push(d),1==C?S.DisplayName="Contract Termination ":2==C?S.DisplayName="Contract Close":3==C&&(S.DisplayName="Contract Refund"),S.DtChequesObj.Clear(),S.DtChequesObj.TableColumns.push("Type"),S.DtChequesObj.TableColumns.push("ChequeNo"),S.DtChequesObj.TableColumns.push("ChequeDate"),S.DtChequesObj.TableColumns.push("Amount"),S.DtChequesObj.TableColumns.push("PendingAmount"),S.ExpColmnSrc=[];for(var T=["ChequeNo","CntrlDate","PayNodeID","Sqft","Rate","ActAmount","Discount","TasjeelAmount","InclChkGen","RecurInvoice","Status","DocumentNo","TempCCID"],y=0;y<t.ContractParticular.length;y++)if(!T.Contains(t.ContractParticular[y].DisplayMember)){if(!s.e.IsEmpty(t.ContractParticular[y].ValueBinding)&&T.Contains(t.ContractParticular[y].ValueBinding))continue;"Amount"==t.ContractParticular[y].DisplayMember?((d=t.ContractParticular[y].Clone()).Header="Amount",null!=d.footer&&""!=d.footer&&(d.ShowTotal=!0),d.footer="",S.ExpColmnSrc.push(d)):(S.ExpColmnSrc.push(t.ContractParticular[y]),null!=S.ExpColmnSrc[S.ExpColmnSrc.length-1].footer&&""!=S.ExpColmnSrc[S.ExpColmnSrc.length-1].footer&&(S.ExpColmnSrc[S.ExpColmnSrc.length-1].ShowTotal=!0),S.ExpColmnSrc[S.ExpColmnSrc.length-1].footer="")}if(S.DtExpensesObj.Table=[],S.Header.push(S.GetTextBox(t.SlNO.Label,t.SlNO.Text)),""!=t.ContractDate.Text||s.e.IsEmpty(t.ContractDate.Date)||(t.ContractDate.Text=t.ContractDate.Date.ToString(t.ContractDate.CustomFormat)),S.Header.push(S.GetTextBox(t.ContractDate.Label,t.ContractDate.Text.toString())),""!=t.StartDate.Text||s.e.IsEmpty(t.StartDate.Date)||(t.StartDate.Text=t.StartDate.Date.ToString(t.StartDate.CustomFormat)),S.Header.push(S.GetTextBox("Start Date",t.StartDate.Text.toString())),""!=t.EndDate.Text||s.e.IsEmpty(t.EndDate.Date)||(t.EndDate.Text=t.EndDate.Date.ToString(t.EndDate.CustomFormat)),S.Header.push(S.GetTextBox("End Date",t.EndDate.Text.toString())),S.Header.push(S.GetTextBox(t.Property.Label,t.Property.Text.toString())),S.Header.push(S.GetTextBox(t.Unit.Label,null==t.Unit.Text?"":t.Unit.Text.toString())),S.Header.push(S.GetTextBox(t.Tenant.Label,null==t.Tenant.Text?"":t.Tenant.Text.toString())),S.Header.push(S.GetTextBox("Termination Date",t.TerminateContracts.TerminationDate.Date.ToString(t.TerminateContracts.TerminationDate.CustomFormat))),S.Header.push(S.GetTextBox(t.Purpose.Label,t.Purpose.Text.toString())),S.Header.push(S.GetTextBox("Total Days",(s.e.GetDateDifference(t.EndDate.Date,t.StartDate.Date)+1).toString(),!0)),1!=C&&2!=C||S.Header.push(S.GetTextBox("Occupied Days",(s.e.GetDateDifference(t.TerminateContracts.TerminationDate.Date.OnlyDate(),t.StartDate.Date)+1).toString(),!0)),1==C?S.Header.push(S.GetTextBox("Unoccupied Days",s.e.GetDateDifference(t.EndDate.Date,t.TerminateContracts.TerminationDate.Date).toString(),!0)):2==C&&S.Header.push(S.GetTextBox("Extra Days",t.TerminateContracts.TerminationDate.Date.Date>m.Date?s.e.GetDateDifference(t.TerminateContracts.TerminationDate.Date.OnlyDate(),m).toString():"0",!0)),t.DataTable.length>0&&!s.e.IsEmpty(t.DataTable[0].Amount)&&(S.PaymentDetails.push(S.GetTextBox("Total Amount",parseFloat(t.DataTable[0].Amount.toString()).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),!0)),S.PaymentDetails.push(S.GetTextBox("Occupied Rent",(parseFloat(t.DataTable[0].Amount.toString())-n).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),!0))),S.PaymentDetails.push(S.GetTextBox("UnOccupied Rent",n.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),!0)),t.dtTerm.length>0)for(var g=function(e){if(s.e.IsEmpty(t.dtTerm[e].IsAdv)||"1"!=t.dtTerm[e].IsAdv.toString()){var a=t.ScreenObject.Data.Tables[10].filter((function(a){return a.NodeID==t.dtTerm[e].NodeID.toString()}));a.length>0&&S.PaymentDetails.push(S.GetTextBox(a[0].Particulars.toString(),parseFloat(t.dtTerm[e].Amt).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),!0))}else l-=parseFloat(t.dtTerm[e].Amt.toString()),S.BalanceAmt-=parseFloat(t.dtTerm[e].Amt.toString()),S.tot-=parseFloat(t.dtTerm[e].Amt.toString())},I=0;I<t.dtTerm.length;I++)g(I);else S.PaymentDetails.push(S.GetTextBox("Security Deposit",r.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),!0));(b.Tables.length>3&&b.Tables[3].length>0||b.Tables.length>4&&b.Tables[4].length>0)&&(S.OTherExpVisi=!0,S.FillTermParticulars(b.Tables.length>3&&b.Tables[3].length>0?b.Tables[3]:b.Tables[4],t,C)),S.PaymentDetails.push(S.GetTextBox("Penalty & Others",S.Totpen.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),!0));var p=0;if(b.Tables.length>5&&b.Tables[5].length>0){for(var A=0;A<b.Tables[5].length;A++)if(!s.e.IsEmpty(b.Tables[5][A].PendingAmount)&&parseFloat(b.Tables[5][A].PendingAmount.toString())>0){p+=parseFloat(b.Tables[5][A].PendingAmount.toString());var f=S.DtChequesObj.NewRow();f.Type="Bounced",f.ChequeNo=b.Tables[5][A].ChequeNumber.toString(),s.e.IsEmpty(b.Tables[5][A].ChequeDate)||(f.ChequeDate=new Date(b.Tables[5][A].ChequeDate.toString()).ToString(i.a.SessionManager.Preferences["Date Format"])),f.Amount=b.Tables[5][A].Amount.toString(),f.PendingAmount=b.Tables[5][A].PendingAmount.toString(),S.DtChequesObj.addRow(f)}if(b.Tables.length>6&&b.Tables[6].length>0)for(var P=0;P<b.Tables[6].length;P++)if(!s.e.IsEmpty(b.Tables[6][P].Amount)&&parseFloat(b.Tables[6][P].Amount.toString())>0){p+=parseFloat(b.Tables[6][P].Amount.toString());var N=S.DtChequesObj.NewRow();N.Type="PDC",N.ChequeNo=b.Tables[6][P].ChequeNumber.toString(),s.e.IsEmpty(b.Tables[6][P].ChequeDate)||(N.ChequeDate=new Date(b.Tables[6][P].ChequeDate.toString()).ToString(i.a.SessionManager.Preferences["Date Format"])),N.Amount=b.Tables[6][P].Amount.toString(),S.DtChequesObj.addRow(N)}S.tot-=p,l-=p,S.BalanceAmt-=p}S.pdcAndBounced=o+p,S.PaymentDetails.push(S.GetTextBox("Total Refundable",(S.BalanceAmt+S.pdcAndBounced).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),!0)),S.PaymentDetails.push(S.GetTextBox("Pending PDC's + Bounced Cheques",S.pdcAndBounced.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),!0)),2==C&&S.PaymentDetails.push(S.GetTextBox("Extra Rent",c.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),!0)),S.PaymentDetails.push(S.GetTextBox("Net Balance",l.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),!0)),i.a.SessionManager.Preferences.ContainsKey("VATVersion")&&(S.PaymentDetails.push(S.GetTextBox("VAT Amount",h.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),!0)),S.PaymentDetails.push(S.GetTextBox("Net Total",(l+h).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),!0))),S.GetTotal();for(var V=0;V<S.PaymentDetails.length;V++)S.PaymentDetails[V].Row=V/4,S.PaymentDetails[V].Column=V%4;for(var R=0;R<S.Header.length;R++)S.Header[R].Row=R/4,S.Header[R].Column=R%4;for(var M=0;M<t.PayTermsDataTableObj.Table.length;M++)if(!s.e.IsEmpty(t.PayTermsDataTableObj.Table[M].DebitAccountID_Key)&&(t.BankAccounts.ContainsKey(t.PayTermsDataTableObj.Table[M].DebitAccountID_Key.toString())||t.PDPAccounts.ContainsKey(t.PayTermsDataTableObj.Table[M].DebitAccountID_Key.toString()))&&"370"==t.PayTermsDataTableObj.Table[M].DocStatusID.toString()){var E=S.DtChequesObj.NewRow();E.Type="PDC",E.ChequeNo=t.PayTermsDataTableObj.Table[M].ChequeNo.toString(),s.e.IsEmpty(t.PayTermsDataTableObj.Table[M].CntrlDate_Key)||(E.ChequeDate=new Date(t.PayTermsDataTableObj.Table[M].CntrlDate_Key.toString()).ToString(i.a.SessionManager.Preferences["Date Format"])),E.Amount=t.PayTermsDataTableObj.Table[M].Amount.toString(),S.DtChequesObj.addRow(E)}return 0==S.DtCheques.length&&S.DtChequesObj.addEmptyRow(),S.CalculateFooter(),S.DtChequesObj.Height=150,S.DtExpensesObj.Height=150,S}return _createClass(a,[{key:"FillTermParticulars",value:function(t,e,a){var n=0,r=0;e.DataTable.length>0&&null!=e.DataTable[0].Amount&&null!=e.DataTable[0].Amount&&(r=parseFloat(e.DataTable[0].Amount));var o,l=e.CalculateMonths();o=l>1?s.e.Round(r/l,e.Mdeci):r;for(var c=0;c<t.length;c++)if(!(1==a&&"6"==t[c].TypeID.toString()||1!=a&&"5"==t[c].TypeID.toString())){var u=this.DtExpensesObj.NewRow();if(u.SNO=c+1,u.NodeID=t[c].ParticularID.toString(),n=0,!s.e.IsEmpty(t[c].DiscountAmount)&&parseFloat(t[c].DiscountAmount)>0?n=parseFloat(t[c].DiscountAmount):!s.e.IsEmpty(t[c].DiscountPercentage)&&parseFloat(t[c].DiscountPercentage)>0?n="2"==t[c].PercType.toString()?parseFloat(t[c].DiscountPercentage)*e.SRTAmount/100:parseFloat(t[c].DiscountPercentage)*r/100:!s.e.IsEmpty(t[c].Months)&&parseFloat(t[c].Months)>0&&(n=parseFloat(o)*parseFloat(t[c].Months)),u.Amount=n,s.e.IsEmpty(t[c].CreditAccountID)||(u.CreditAccountID_Key=t[c].CreditAccountID.toString(),u.CreditAccountID=s.e.String(t[c].CrAccName)),s.e.IsEmpty(t[c].CreditAccountID)||(u.DebitAccountID_Key=t[c].DebitAccountID.toString(),u.DebitAccountID=s.e.StringValue(t[c].DrAccName)),t.Contains("VAT")&&""!=t[c].VAT.toString()&&parseFloat(t[c].VAT.toString())>0&&(u.VatPer=parseFloat(t[c].VAT.toString())),t.Contains("TaxCategoryID")&&""!=t[c].TaxCategoryID.toString()&&(u.TaxCategory_Key=t[c].TaxCategoryID.toString(),u.TaxCategory=t[c].TaxCategory.toString()),this.DtExpensesObj.TableColumns.Contains("SPType_Key")&&t.Contains("SPType")&&""!=t[c].SPType.toString()&&(u.SPType_Key=t[c].SPType.toString(),u.SPType=t[c].SPTypeName.toString()),this.DtExpensesObj.TableColumns.Contains("Dim_Key")&&t.Contains("Dimname")&&""!=t[c].Dimname.toString()&&(u.Dim_Key=t[c].DimNodeID.toString(),u.Dim=t[c].Dimname.toString()),this.DtExpensesObj.TableColumns.Contains("Location_Key")&&e.LocationContract.SelectedValue>0&&(u.Location_Key=e.LocationContract.SelectedValue),u.VatType=s.e.String(t[c].VatType),""==s.e.String(u.VatType)){var D=0,h=e.ScreenObject.Data.Tables[5].filter((function(t){return"PenaltyVATType"==t.Name}));h.length>0?(D=s.e.IntTryParse(h[0].Value),u.VatType=1==D?"Exclusive":"Inclusive"):u.VatType="Exclusive"}s.e.IsEmpty(u.VatPer)||("Inclusive"==t[c].VatType.toString()?(u.TaxableAmt=(100*n/(parseFloat(u.VatPer)+100)).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),u.VatAmount=(n-parseFloat(u.TaxableAmt)).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())):(u.TaxableAmt=n,u.VatAmount=(n*parseFloat(u.VatPer)/100).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())));for(var C=0;C<this.ExpColmnSrc.length;C++)this.ExpColmnSrc[C].DisplayMember.startsWith("CCNID")&&t.Contains(this.ExpColmnSrc[C].DisplayMember)&&this.DtExpensesObj.TableColumns.Contains(this.ExpColmnSrc[C].ValueMember)&&""!=t[c][this.ExpColmnSrc[C].DisplayMember].toString()&&(u[this.ExpColmnSrc[C].ValueMember]=t[c][this.ExpColmnSrc[C].DisplayMember].toString());this.DtExpensesObj.addRow(u)}}},{key:"GetTextBox",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=new m.d(0);return n.Label=t,n.Text=e,a&&(n.Align="Right"),n.IsReadOnly=!0,n}},{key:"CalculateFooter",value:function(){var t=this.DtExpenses.Compute("sum","Amount");null!=t&&null!=t||(t=0);var e=this.ExpColmnSrc.find((function(t){return"Amount"==t.DisplayMember}));null!=e&&(e.footer=parseFloat(t).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())),95==this.oParent.CostCenterID||104==this.oParent.CostCenterID?(e=this.ExpColmnSrc.find((function(t){return"Amount"==t.DisplayMember})),null!=(t=this.DtExpenses.Compute("sum","Amount"))&&null!=t||(t=0),null!=e&&(e.footer=parseFloat(t).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()))):(e=this.ExpColmnSrc.find((function(t){return"ActAmount"==t.DisplayMember})),null!=(t=this.DtExpenses.Compute("sum","ActAmount"))&&null!=t||(t=0),null!=e&&(e.footer=parseFloat(t).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()))),e=this.ExpColmnSrc.find((function(t){return"TaxableAmt"==t.DisplayMember})),null!=(t=this.DtExpenses.Compute("sum","TaxableAmt"))&&null!=t||(t=0),null!=e&&(e.footer=parseFloat(t).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())),e=this.ExpColmnSrc.find((function(t){return"VatAmount"==t.DisplayMember})),null!=(t=this.DtExpenses.Compute("sum","VatAmount"))&&null!=t||(t=0),null!=e&&(e.footer=parseFloat(t).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())),this.UpdateFooter=!0}},{key:"GetTotal",value:function(){var t=this.DtExpenses.filter((function(t){return t.NodeID>0})).Compute("sum","Amount");null!=t&&null!=t||(t=0),this.BalanceAmt=this.tot-parseFloat(t);var e=this.PaymentDetails.find((function(t){return!s.e.IsEmpty(t.Label)&&"Net Balance"==t.Label}));null!=e&&e instanceof m.d&&(e.Text=this.BalanceAmt.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount)),null!=(e=this.PaymentDetails.find((function(t){return!s.e.IsEmpty(t.Label)&&"Total Refundable"==t.Label})))&&e instanceof m.d&&(e.Text=(this.BalanceAmt+this.pdcAndBounced).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount)),this.Totpen=parseFloat(t),null!=(e=this.PaymentDetails.find((function(t){return!s.e.IsEmpty(t.Label)&&"Penalty & Others"==t.Label})))&&e instanceof m.d&&(e.Text=this.Totpen.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount))}},{key:"OnSave",value:function(t){if("Cancel"==t)this.result=!1,i.a.page.HideDialog();else if("EditEnd"!=t&&s.e.IsEmpty(t.column))"OK"==t&&(this.GetTotal(),this.result=!0,i.a.page.HideDialog());else{if(null!=this.SelectedRow&&""!=this.SelectedRow.VatPer.toString()){var e=parseFloat(this.SelectedRow.Amount);"Inclusive"==this.SelectedRow.VatType.toString()?(this.SelectedRow.TaxableAmt=(100*e/(parseFloat(this.SelectedRow.VatPer)+100)).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),this.SelectedRow.VatAmount=(e-parseFloat(this.SelectedRow.TaxableAmt)).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())):(this.SelectedRow.TaxableAmt=e,this.SelectedRow.VatAmount=(parseFloat(this.SelectedRow.TaxableAmt)*parseFloat(this.SelectedRow.VatPer)/100).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()))}this.CalculateFooter(),this.GetTotal(),this.result=!0}}},{key:"angularGrid",get:function(){return this.DtExpensesObj.angularGrid}},{key:"DtExpenses",get:function(){return this.DtExpensesObj.Table}},{key:"ExpColmnSrc",get:function(){return this.DtExpensesObj.Columns},set:function(t){this.DtExpensesObj.Columns=t}},{key:"DtExpensesColumns",get:function(){return this.DtExpensesObj.TableColumns}},{key:"angularGrid1",get:function(){return this.DtChequesObj.angularGrid}},{key:"DtCheques",get:function(){return this.DtChequesObj.Table}},{key:"ColmnSrc",get:function(){return this.DtChequesObj.Columns},set:function(t){this.DtChequesObj.Columns=t}},{key:"DtChequesColumns",get:function(){return this.DtChequesObj.TableColumns}}]),a}(A.b),w=a("OOpy"),L=a("qgom"),x=a("1UMc"),j=a("jgdN"),F=a("dQvv"),B=a("lvkM"),_=a("7i9q"),k=a("wnwj"),U=a("GEJP"),K=a("OQq8"),G=a("QanX"),q=a("8Gov"),X=a("Huqd"),W=a("bwbx"),Q=a("ybar"),H=a("MC0n"),Y=a("uMy8"),z=a("pcVU"),J=a("lUlH"),Z=function(t){_inherits(A,t);var e=_createSuper(A);function A(){var t;return _classCallCheck(this,A),(t=e.call(this)).TotAmt=new m.d(0),t.VatAmount=new m.d(0),t._AttachmentVisibility=!1,t.DocumentsGrid=new u.a,t.PayTermsDataTableObj=new u.a,t.DocumentContGrid=new u.a,t.DataTableObj=new u.a,t._CntStatus="",t._ReportInfoVisibility=!0,t.ReportsList=[],t._UnitStatus=new c.e(0),t._RefundVisiblity=!1,t._IsRecurPosted=!1,t.PropertyID=0,t.SelectedNodeID=0,t.strRenew="Save",t.PropID=0,t.UnitTempID=0,t.draftid=0,t.TenantTempID=0,t.cntrct={},t._RefreshGrid=!1,t._DeleteVisibility=!1,t.CurrCostCenterID=0,t._RightRegionVisibility=!0,t.ContractPayTerms=[],t.ScreenObject=new h.a,t.ContractNumber=new C.a(0),t.TermsConditions=new m.c(0),t.ButtonTerminate=new b.a,t.ButtonCancelTerminate=new b.a,t.ButtonRenew=new b.a,t.BtnApprove=new b.a,t._SaveapproveVisiblity=!1,t._RejectVisiblity=!1,t.ShowOnlyAvailable=!1,t.JVRecieptonPaymentDate=!1,t.DontpostSIV=!1,t.DontsavenoPayment=!0,t.SingleInvoice=!1,t.SinglePDC=!1,t.DistribtueInvoice=!1,t.GenChqOthPart=!1,t.allowafterenddate=!0,t.DontAllowmorePayment=!0,t.VatAccountID=0,t.InvCCID=0,t.DummyCCID=0,t.FilterTenantBasedOnUnit=!1,t.CalculateRentAmountInDays=!1,t.LineWiseSalesman=!1,t.PickRRfromTenant=!1,t.PromptOpening=!1,t.IsOpening=!1,t.SelectedUnits="",t.MultiNode=null,t.ContractDate=new S.a(0),t.IsExtended=new c.e(54208),t.BasedOn=new c.e(0),t.RentAmt=new m.d(0),t.NoOfUnits=new m.d(0),t.StatusID=new c.e(0),t.Property=new l.b(0),t.Unit=new l.b(0),t.Tenant=new l.b(0),t.RentRecAc=new l.b(0),t.IncomeAc=new l.b(0),t.SlNO=new m.d(0),t.LocationContract=new l.b(0),t.DivisionContract=new l.b(0),t.CurrencyContract=new l.b(0),t.Salesman=new l.b(0),t.Accountant=new l.b(0),t.Landlord=new l.b(0),t.Months=new m.d(0),t.RefNo=new m.d(0),t.RecurDuration=new m.d(0),t.TotalDays=new m.d(0),t.TotalYears=new m.d(0),t.Purpose=new m.d(0),t.Narration=new m.d(0),t.TotalAmount=new m.d(0),t.NonRecAmount=new m.d(0),t.AgeOfRenewal=new m.d(0),t.StartDate=new S.c(0),t.EndDate=new S.c(0),t.VacancyDate=new S.c(0),t.VacantVisiblity=!1,t.StatusVisiblity=!1,t.ExtndTill=new S.c(0),t.ExpectedEndDate=new S.c(0),t.GracePeriod=new m.d(0),t.TerminateDate=new S.c(0),t.ContractParticular=[],t.ParticularsBodyReadOnly=!1,t.ParticularsBodyVisible=!0,t.PayTermsBodyReadOnly=!1,t.PayTermsBodyVisible=!0,t.IncomeOnContDate=!1,t.RenewRefID=0,t.LinkedQuotationID=0,t.ParentContractID=0,t.ContractExists=!1,t.dtParticulars=null,t.WFDocLevelList=[],t.ButtonsLeft=[],t.ButtonsPopup=[],t.IsPropLandBased=!1,t.LocAccountant=!1,t.LocLandLord=!1,t.DiscountPosting=!1,t.LocSalesman=!1,t.EnableParticular=!0,t.DonotpostDocs=!1,t.DonotCopyPayterms=!1,t.MandatoryLinking=!1,t.PickCC=1,t.PickACC=1,t.dDeci=0,t.Mdeci=0,t.ValidTill=0,t.QuotLink=0,t.DimCCID=0,t.DimWiseFields=0,t.RentBasedContract=!1,t.InclStartDate=!1,t.InclEndDate=!1,t.CancelOnTerminate=!1,t.VATExtraRent=!1,t.nomonthlyincome=!1,t.PostBankRct=!1,t.EnableGracePeriod=!1,t.TaxCatFromUnit=!1,t.CancelIncomeonTerminate=!1,t.TempCCID=0,t.DocStNodeID=0,t.VatNode=0,t.Vattype=0,t.DocStName="",t.DaysCount="",t.NegateIncomeFld="",t.PDCAccounts=new T.a,t.CashAccounts=new T.a,t.PDPAccounts=new T.a,t.BankAccounts=new T.a,t.CheckNumbersForRent=!1,t.InclPostingDate=!1,t.ShowAmountinGenChq=!1,t.TermPosting=!1,t.isFrmBlkEdit=!1,t.vatwef=new Date(2018,0,1),t.id2=0,t.NoofCheques=0,t.FirstNoLen=0,t.InstPeriod=0,t.FirstNumber="",t.stDate=new Date,t.DebitAcc=0,t.DebitName="",t.UnitCheckStatus=new K.a(0),t.MultiUnits=new K.a(0),t.ErrorMessage="Missing Report Parameter ' ",t.FlagPrefixChange=!1,t.GenDebitAcc=0,t.GenAdvanceRentAcc=0,t.GenAdvanceRentAccName="",t.OriginalRent=0,t.iSGenerate=!1,t.yr=!0,t.mn=!0,t.Obj={},t.SaveAndPrintContactID=0,t.SaveAndPrintStatusID=0,t.CheVal=0,t.ZeroValue="",t.months=0,t.IsMonth=!1,t.strCount=0,t.IsSavePrintClick=!1,t.dtTerm=null,t.DonotUpdateAccounts=!1,t.PropertyCCID=0,t.UnitCCID=0,t.TenantCCID=0,t.UnitNodeID=0,t.dsprof=null,t.costDims=null,t.UnitStatusVal="",t.strContractNo="",t.VType="",t.ProductID=0,t.SNO=1,t.PSNO=1,t.objProduct=new z.a,t.strType=!0,t.ValueUsed=0,t.Invoiced=0,t.strCCQry="",t.TotalMonths=0,t.DiscReturn=0,t.SRTAmount=0,t.RefundAmt=0,t.PDCRefund=0,t.VatAmt=0,t.ActVisibility=!1,t.SuspendVisiblity=!1,t.CloseVisiblity=!1,t.Mode=new c.e(26637),t.CopiedRow=null,t.IsRef=!1,t.ClassName="AddEditRenContractViewModel",t}return _createClass(A,[{key:"AddEditRenContractViewModel_1",value:function(t,e,u,D,h){var C=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",d=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,T=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return Object(n.b)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var y,I,A,f,P,N,R,M,E,v,O,w,L,x,j,F,B,_=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:this.DialogResult=!0,Logger.InfoLog("AddEditRenContractViewModel ::Entering AddEditRenContractViewModel"),this.CurrCostCenterID=t,this.CostCenterID=t,this.ContractID=e,this.parentid=D,this.selectedNode=h,this.group=u,this.strRenew="Save",this.Property.CCID=92,this.Property.TypeID=2,this.Unit.CCID=93,this.Unit.Label="UnitID",this.Unit.DBColumnName="UnitID",this.Unit.DBColumnID=0,this.Unit.TypeID=2,this.Tenant.CCID=94,this.Tenant.TypeID=3,this.RentRecAc.CCID=2,this.RentRecAc.TypeID=2,this.IncomeAc.CCID=2,this.IncomeAc.TypeID=5,this.isFrmBlkEdit=T,this.CntStatus="[New]",this.Title=C,this.GracePeriod.Text="0",i.a.SessionManager.Preferences.ContainsKey("DepositLinkDimension")&&""!=i.a.SessionManager.Preferences.DepositLinkDimension&&parseInt(i.a.SessionManager.Preferences.DepositLinkDimension)>0&&(this.id2=i.a.rental.GetCostCenterNodeID("Rent",i.a.SessionManager.Preferences.DepositLinkDimension,this.id2)),this.ScreenObject.Data=this.ScreenObject.GetScreenInfo(t),null!=this.ScreenObject.Data&&this.ScreenObject.Data.Tables.length>0&&this.onFieldsLoad(t),null==this.ScreenObject.StaticFields&&(this.ScreenObject.StaticFields=[]),this.ScreenObject.oParent=this,n.t0=regeneratorRuntime.keys(this.ScreenObject.oParent);case 2:if((n.t1=n.t0()).done){n.next=14;break}if(y=n.t1.value,!((I=this.ScreenObject.oParent[y])instanceof o.c||I instanceof l.b||I instanceof S.a)){n.next=12;break}if(!((A=I)instanceof b.a||A==this.UnitStatus||A==this.Mode)){n.next=9;break}return n.abrupt("continue",2);case 9:if(null!=A){n.next=11;break}return n.abrupt("continue",2);case 11:null!=A&&(this.ScreenObject.StaticFields.push(A),this.ScreenObject.SetProperties_Static(A));case 12:n.next=2;break;case 14:if(this.ScreenObject.StaticFields.sort((function(t,e){return t.Row>e.Row||t.Row==e.Row&&t.Column>e.Column?1:-1})),this.ScreenObject.BuiltControls(t),this.TotalAmount=new m.d(0),this.TotalAmount.DBColumnName=i.a.GetResource("Ren_CntrctTAmnt"),this.TotalAmount.Label=i.a.GetResource("Ren_CntrctTAmnt"),this.TotalAmount.Text="",this.TotalAmount.IsReadOnly=!0,this.NonRecAmount=new m.d(0),this.NonRecAmount.DBColumnName=i.a.GetResource("Ren_CntrctNRAmt"),this.NonRecAmount.Label=i.a.GetResource("Ren_CntrctNRAmt"),this.NonRecAmount.Text="",this.NonRecAmount.IsReadOnly=!0,this.RecAmount=new m.d(0),this.RecAmount.DBColumnName=i.a.GetResource("Ren_CntrctRAmt"),this.RecAmount.Label=i.a.GetResource("Ren_CntrctRAmt"),this.RecAmount.Text="",this.RecAmount.IsReadOnly=!0,this.AddUnit(),this.ScreenObject.HeaderFields.sort((function(t,e){return t.Row>e.Row||t.Row==e.Row&&t.Column>e.Column?1:-1})),this.ScreenObject.CustomTab.OnTabChange.Subscribe(this,"OnTabSelectionChanged"),this.RefundDate=new S.a(0),this.ScreenObject.Data.Tables.length>6&&this.ScreenObject.Data.Tables[6].length>0&&!this.ScreenObject.Data.Columns[6].Contains("ErrorMessage")&&(this.SlNO.Enable=!1,this.DocStName=this.ScreenObject.Data.Tables[6][0].Name.toString()),f=i.a.rental.GetNextContractNo(t,this.ParentContractID),this.SlNO.Text=f,this.ButtonApprove=new b.a,this.ButtonConvert=new b.a,this.ButtonSave=new b.a,this.ButtonSaveAndPrint=new b.a,this.ButtonSuspend=new b.a,this.ButtonRefund=new b.a,this.BtnFullRefund=new b.a,this.ButtonVacant=new b.a,this.ButtonGenChq=new b.a,this.LoadPreferences(),this.LoadButtons(),this.ButtonCancelTerminate.Visible=!1,this.ButtonVacant.Visible=!1,this.ButtonSuspend.Visible=!1,this.ButtonRefund.Visible=!1,this.SetButtonVisibility("CancelTerminate",!1),this.SetButtonVisibility("VacantVisiblity",!1),this.SetButtonVisibility("Suspend",!1),this.SetButtonVisibility("RejectVisiblity",!1),this.SetButtonVisibility("Fullrefund",!1),this.cntrct.ContractID=this.ContractID,0==this.ContractID?i.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=i.a.SessionManager.IsActionAssigned(this.CurrCostCenterID,"Create"):this.ButtonSave.Enable=i.a.SessionManager.IsActionAssigned(this.CurrCostCenterID,"Create"):(this.ScreenObject.IsEdit=!0,i.a.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=i.a.SessionManager.IsActionAssigned(this.CurrCostCenterID,"Update"):this.ButtonSave.Enable=i.a.SessionManager.IsActionAssigned(this.CurrCostCenterID,"Update"),i.a.SessionManager.HideUnathorizedAccess?this.ButtonApprove.Visible=i.a.SessionManager.IsActionAssigned(this.CurrCostCenterID,"Approved"):this.ButtonApprove.Enable=i.a.SessionManager.IsActionAssigned(this.CurrCostCenterID,"Approved"),i.a.SessionManager.HideUnathorizedAccess?this.ButtonTerminate.Visible=i.a.SessionManager.IsActionAssigned(this.CurrCostCenterID,"Terminate"):this.ButtonTerminate.Enable=i.a.SessionManager.IsActionAssigned(this.CurrCostCenterID,"Terminate"),i.a.SessionManager.HideUnathorizedAccess?this.ButtonConvert.Visible=i.a.SessionManager.IsActionAssigned(this.CurrCostCenterID,"Convert"):this.ButtonConvert.Enable=i.a.SessionManager.IsActionAssigned(this.CurrCostCenterID,"Convert")),this.ButtonSaveAndPrint.Enable=this.ButtonSave.Enable,this.ButtonSaveAndPrint.Visible=this.ButtonSave.Visible,this.SetButtonVisibility("SaveAndPrint",this.ButtonSave.Visible),this.SetButtonEnable("SaveAndPrint",this.ButtonSave.Enable),!this.PromptOpening||95!=t||0!=this.ContractID){n.next=20;break}if((P=new $).PromptIsOpening(this),i.a.page.ShowDialog(P,q.a,{HideClose:!0,ShowCenter:!0,Title:"IsOpening"}),"1"==P.IsOpening.SelectedValue&&(this.IsOpening=!0),this.DialogResult){n.next=20;break}return n.abrupt("return");case 20:if(this.ScreenObject.Data.Tables.length>7&&this.ScreenObject.Data.Tables[7].length>0&&this.ScreenObject.Data.Columns[7].Contains("isdefault")){for(N=0;N<this.ScreenObject.Data.Tables[7].length;N++)this.UnitStatus.Items.push(c.d.ComboBoxItems_2(this.ScreenObject.Data.Tables[7][N].Name.toString(),this.ScreenObject.Data.Tables[7][N].NodeID.toString())),this.ScreenObject.Data.Columns[7].Contains("isdefault")&&Object(r.j)(this.ScreenObject.Data.Tables[7][N].isdefault.toString())&&(this.UnitStatus.SelectedValue=this.ScreenObject.Data.Tables[7][N].NodeID.toString());this.UnitStatus.Label="Unit status",this.UnitStatus.Visible=!0,this.UnitStatus.Enable=!0}for(this.IsPropLandBased&&this.Landlord.OnPactListBoxValueChanged.Subscribe(this,"onListSelectedChanged"),this.LocationContract.OnPactListBoxValueChanged.Subscribe(this,"onListSelectedChanged"),this.ViewNotes=new g.a(this,i.a.SessionManager,i.a.admin),this.TotAmt.Label=i.a.GetResource("Ren_CntrctTAmnt"),this.VatAmount.Label=i.a.GetResource("VatAmount"),this.TotalAmount.Label=i.a.GetResource("NetAmount"),this.EndDate.SelectedDateChanged.Subscribe(this,"OnselectionChange"),this.StartDate.SelectedDateChanged.Subscribe(this,"OnselectionChange"),this.ExpectedEndDate.SelectedDateChanged.Subscribe(this,"OnselectionChange"),this.UnitCheckStatus.ClickCommand.Subscribe(this,"CheckUnits"),this.MultiUnits.ClickCommand.Subscribe(this,"OnCustomizeExtraFields"),129==t&&this.ValidTill>0&&(this.ContractDate.SelectedDateChanged.Subscribe(this,"OnContractDateChanged"),0==e&&(this.ExtndTill.Date=(new Date).AddDays(this.ValidTill))),this.Months.LostFocusCommand.Subscribe(this,"OnMonthChange"),this.GracePeriod.LostFocusCommand.Subscribe(this,"OnGracePeriodChange"),this.TotalYears.LostFocusCommand.Subscribe(this,"OnYearChange"),this.Property.OnPactListBoxValueChanged.Subscribe(this,"onListSelectedChanged"),this.Unit.OnPactListBoxValueChanged.Subscribe(this,"onListSelectedChanged"),this.Tenant.OnPactListBoxValueChanged.Subscribe(this,"onListSelectedChanged"),this.ContractNumber.ComboBox.SelectionChangedCommand.Subscribe(this,"OnContractPrefixChanged"),this.DataTableObj.CellEditEnding.Subscribe(this,"OnCellEditEnding"),this.DataTableObj.BeginEdit.Subscribe(this,"OnBeginEdit"),this.DataTableObj.OnPreviewKeyDown.Subscribe(this,"OnKeyDown"),this.PayTermsDataTableObj.CellEditEnding.Subscribe(this,"OnCellEditEnding"),this.PayTermsDataTableObj.OnPreviewKeyDown.Subscribe(this,"OnKeyDown_Payment"),this.PayTermsDataTableObj.BeginEdit.Subscribe(this,"PaytermBeforeRowDeletingEvent"),this.ContractNumber.onGetData.Subscribe(this,"GetData"),this.ViewAttachments=new p.ViewAttachmentViewModel(this),null!=(R=this.ScreenObject.GetExtrFieldByName("ccnid70"))&&R instanceof l.b&&R.OnPactListBoxValueChanged.Subscribe(this,"OnVatTypeChanged"),this.OnLoad(this.ContractID),this.LoadTabs(),this.BuildGridData(),this.BuildPayTermsGridData(),this.DataTableObj.TableNewRow.Subscribe(this,"onAddRow"),this.ButtonRenew.Enable=!1,this.ButtonTerminate.Enable=!1,this.BtnApprove.Visible=!1,this.SetButtonVisibility("Renew",!1),this.SetButtonVisibility("Terminate",!1),this.SetButtonVisibility("RejectVisiblity",!1),this.PayTermsDataTableObj.TableNewRow.Subscribe(this,"onAddRowPay"),M=0;M<6;M++)(E=this.DataTableObj.NewRow()).Recurr=!1,this.DataTableObj.addRow(E),v=this.PayTermsDataTableObj.NewRow(),this.PayTermsDataTableObj.addRow(v);if(this.PayTermsDataTableObj.UpdateTotals(),this.DataTableObj.UpdateTotals(),this.UpdateSequencePay(),this.BtnApprove.Label=i.a.GetResource("Approve"),this.LocationContract.SelectedValue=i.a.SessionManager.LocationID,this.DivisionContract.SelectedValue=i.a.SessionManager.DivisionID,0==this.ContractID?(this.cntrct.GUID="GUID",this.Property.SelectedValue>0&&this.onListSelectedChanged(this.Property),this.Unit.SelectedValue>0&&this.onListSelectedChanged(this.Unit)):this.ContractID>0&&(this.LoadEditData(d),this.CalculateFooter(),this.PropID=this.Property.SelectedValue,this.UnitTempID=this.Unit.SelectedValue),this.RefershTitle(),!(this.DimWiseFields>0)){n.next=40;break}if(O=this.ScreenObject.GetCustomField("CCNID"+(this.DimWiseFields-5e4).toString()),0!=this.ContractID){n.next=38;break}return n.next=30,Promise.resolve().then(a.bind(null,"lvkM"));case 30:return w=n.sent,L=w.DocumentNumberComponent,n.next=34,Promise.resolve().then(a.bind(null,"dQvv"));case 34:return x=n.sent,j=x.DocumentNumberViewModel,F=new j(this,this.ScreenObject.Data.Tables[8],!0,null),n.abrupt("return",(F.DocumentNumberViewModel_1(this),void i.a.page.ShowDialog(F,L,{HideClose:!0,ShowCenter:!0,Title:i.a.GetResource("DocumentNumberTitle")}).subscribe((function(){_.DialogResult&&(null!=O?(O.SelectedValue=_.DimWiseFieldsID,s.e.StringIsNullOrEmpty(O.LocalRefXML)||_.ScreenObject.FillLocalReferenceData(O)):null!=O&&O instanceof l.b&&(_.DimWiseFieldsID=O.SelectedValue),null!=O&&(O.Enable=!1),_.AddEditRenContractViewModel_Complete())}))));case 38:n.next=41;break;case 40:i.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"true"==i.a.SessionManager.Preferences.EnableLocationWise.toString().toLowerCase()&&i.a.SessionManager.Preferences.ContainsKey("LW Contracts")&&"true"==i.a.SessionManager.Preferences["LW Contracts"].toString().toLowerCase()&&(null!=(B=this.GetButton("ChangeLocation"))&&(B.Visible=!1),this.SetButtonVisibility("ChangeLocation",!1),this.LocationContract.Enable=!1,0==e&&(this.LocationContract.SelectedValue>0?this.ChangeLocation(i.a.SessionManager.LocationID):0==this.ContractID&&V.RibbonExtViewModel.ShowDocumentNumberViewModelRental(this)),i.a.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&"true"==i.a.SessionManager.Preferences.EnableDivisionWise.toString().toLowerCase()&&i.a.SessionManager.Preferences.ContainsKey("DW Contracts")&&"true"==i.a.SessionManager.Preferences["DW Contracts"].toString().toLowerCase()&&(this.DivisionContract.Enable=!1,0==this.DivisionContract.SelectedValue&&0==this.ContractID&&V.RibbonExtViewModel.ShowDocumentNumberViewModelRental(this)));case 41:this.AddEditRenContractViewModel_Complete();case 42:case"end":return n.stop()}}),n,this)})))}},{key:"AddEditRenContractViewModel_Complete",value:function(){if(95!=this.CurrCostCenterID){104!=this.CurrCostCenterID&&(this.ButtonRenew.Visible=!1,this.ButtonTerminate.Visible=!1,this.ButtonCancelTerminate.Visible=!1,this.ButtonVacant.Visible=!1,this.SetButtonVisibility("Renew",!1),this.SetButtonVisibility("Terminate",!1),this.SetButtonVisibility("CancelTerminate",!1),this.SetButtonVisibility("VacantVisiblity",!1)),this.ButtonRefund.Visible=!1,this.SetButtonVisibility("RefundVisiblity",!1),this.ContractID>0&&129==this.CurrCostCenterID&&(this.ContractExists||"467"!=this.StatusID.SelectedValue?"471"==this.StatusID.SelectedValue&&(i.a.SessionManager.HideUnathorizedAccess?this.ButtonCancelTerminate.Visible=i.a.SessionManager.IsActionAssigned(this.CurrCostCenterID,"Close"):this.ButtonCancelTerminate.Enable=i.a.SessionManager.IsActionAssigned(this.CurrCostCenterID,"Close")):i.a.SessionManager.HideUnathorizedAccess?this.ButtonVacant.Visible=i.a.SessionManager.IsActionAssigned(this.CurrCostCenterID,"Close"):this.ButtonVacant.Enable=i.a.SessionManager.IsActionAssigned(this.CurrCostCenterID,"Close"));var t=this.GetButton("Generate");(this.ContractExists||"471"==this.StatusID.SelectedValue)&&(null!=t&&(t.Visible=!1),this.ButtonSuspend.Visible=!1,this.SetButtonVisibility("Suspend",!1),this.SetButtonVisibility("GenerateLink",!1)),"469"==this.StatusID.SelectedValue&&(null!=t&&(t.Visible=!1),this.ButtonSuspend.Visible=!1,this.SetButtonVisibility("Suspend",!1),i.a.SessionManager.IsActionAssigned(129,"Resave cancelled Reservation")||(this.SetButtonVisibility("Save",!1),this.SetButtonVisibility("SaveAndPrint",!1)))}this.CheckViewForUser(this.cntrct.ContractID),this.ReportView(),this.DataTable.length>0&&(this.DataTableObj.Height=252),this.PayTermsDataTable.length>0&&(this.PayTermsDataTableObj.Height=252),Logger.InfoLog("AddEditRenContractViewModel ::Exiting AddEditRenContractViewModel")}},{key:"AddUnit",value:function(){this.ScreenObject.HeaderFields.Remove(this.Unit);var t=new l.f;t.SectionSeqNo=this.Unit.SectionSeqNo,t.Row=this.Unit.Row,t.Column=this.Unit.Column,t.ColumnSpan=this.Unit.ColumnSpan,t.Unit=this.Unit,t.UnitCheckStatus=this.UnitCheckStatus,t.MultiUnits=this.MultiUnits,t.MultipleUnits.Text=this.StrMultiple,t.MultipleUnits.DBColumnName="MultipleUnits",t.IsMultiunit=this.IsMultiunit,t.multiVisi=this.multiVisi,this.ScreenObject.HeaderFields.push(t),this.TerminateDate.Visible=!1,95==this.CurrCostCenterID&&(this.VacancyDate.Visible=!1)}},{key:"OnVatTypeChanged",value:function(t){if(t instanceof l.b){var e=t;50070==e.CCID&&(this.Vattype=e.SelectedValue,this.VatCalcOnRenew(!1))}}},{key:"LoadPreferences",value:function(){if(this.ScreenObject.Data.Tables.length>4&&this.ScreenObject.Data.Tables[4].length>0){var t,e=(_toArray(t=this.ScreenObject.Data.Tables[4].filter((function(t){return"Salesman"==t.Name}))),t);e.length>0&&parseInt(e[0].Value)>0&&(this.Salesman.CCID=parseInt(e[0].Value)),(e=this.ScreenObject.Data.Tables[4].filter((function(t){return"Accountant"==t.Name}))).length>0&&parseInt(e[0].Value)>0&&(this.Accountant.CCID=parseInt(e[0].Value)),(e=this.ScreenObject.Data.Tables[4].filter((function(t){return"Landlord"==t.Name}))).length>0&&parseInt(e[0].Value)>0&&(this.Landlord.CCID=parseInt(e[0].Value)),(e=this.ScreenObject.Data.Tables[4].filter((function(t){return"LocAccountant"==t.Name}))).length>0&&(this.LocAccountant=Object(r.j)(e[0].Value)),(e=this.ScreenObject.Data.Tables[4].filter((function(t){return"LocLandLord"==t.Name}))).length>0&&(this.LocLandLord=Object(r.j)(e[0].Value)),(e=this.ScreenObject.Data.Tables[4].filter((function(t){return"LocSalesman"==t.Name}))).length>0&&(this.LocSalesman=Object(r.j)(e[0].Value)),(e=this.ScreenObject.Data.Tables[4].filter((function(t){return"ValidTill"==t.Name}))).length>0&&!s.e.IsEmpty(e[0].Value)&&(this.ValidTill=parseInt(e[0].Value)),(e=this.ScreenObject.Data.Tables[4].filter((function(t){return"DonotpostDocs"==t.Name}))).length>0&&!s.e.IsEmpty(e[0].Value)&&(this.DonotpostDocs=Object(r.j)(e[0].Value)),this.Accountant.TypeID=1,this.Landlord.TypeID=1,this.Salesman.TypeID=1}if(this.ScreenObject.Data.Tables.length>5&&this.ScreenObject.Data.Tables[5].length>0){var a,n=(_toArray(a=this.ScreenObject.Data.Tables[5].filter((function(t){return"LandLordPref"==t.Name}))),a);if(n.length>0&&(this.IsPropLandBased=Object(r.j)(n[0].Value)),(n=this.ScreenObject.Data.Tables[5].filter((function(t){return"EnableParticulars"==t.Name}))).length>0&&(this.EnableParticular=Object(r.j)(n[0].Value)),(n=this.ScreenObject.Data.Tables[5].filter((function(t){return"PickCC"==t.Name}))).length>0&&(this.PickCC=parseInt(n[0].Value)),(n=this.ScreenObject.Data.Tables[5].filter((function(t){return"PickACC"==t.Name}))).length>0&&(this.PickACC=parseInt(n[0].Value)),(n=this.ScreenObject.Data.Tables[5].filter((function(t){return"QuotLink"==t.Name}))).length>0&&(this.QuotLink=parseInt(n[0].Value)),(n=this.ScreenObject.Data.Tables[5].filter((function(t){return"PostDocStatus"==t.Name}))).length>0&&parseInt(n[0].Value)>0&&(this.TempCCID=parseInt(n[0].Value)),(n=this.ScreenObject.Data.Tables[5].filter((function(t){return"VatNode"==t.Name}))).length>0&&parseInt(n[0].Value)>0&&(this.VatNode=parseInt(n[0].Value)),(n=this.ScreenObject.Data.Tables[5].filter((function(t){return"VATExtraRent"==t.Name}))).length>0&&(this.VATExtraRent=Object(r.j)(n[0].Value)),(n=this.ScreenObject.Data.Tables[5].filter((function(t){return"ShowAmountinGenChq"==t.Name}))).length>0&&Object(r.j)(n[0].Value.toString())&&(this.ShowAmountinGenChq=Object(r.j)(n[0].Value)),(n=this.ScreenObject.Data.Tables[5].filter((function(t){return"nomonthlyincome"==t.Name}))).length>0&&(this.nomonthlyincome=Object(r.j)(n[0].Value)),(n=this.ScreenObject.Data.Tables[5].filter((function(t){return"TaxCatFromUnit"==t.Name}))).length>0&&(this.TaxCatFromUnit=Object(r.j)(n[0].Value)),(n=this.ScreenObject.Data.Tables[5].filter((function(t){return"EnableGracePeriod"==t.Name}))).length>0&&(this.EnableGracePeriod=Object(r.j)(n[0].Value)),(n=this.ScreenObject.Data.Tables[5].filter((function(t){return"PostBankReciept"==t.Name}))).length>0&&95==this.CostCenterID&&(this.PostBankRct=Object(r.j)(n[0].Value)),(n=this.ScreenObject.Data.Tables[5].filter((function(t){return"VatWEF"==t.Name}))).length>0&&s.e.isValidDate(n[0].Value.toString())&&(this.vatwef=n[0].Value.toString()),(n=this.ScreenObject.Data.Tables[5].filter((function(t){return"VatonRent"==t.Name}))).length>0&&parseFloat(n[0].Value)>0&&(this.VatonRent=parseFloat(n[0].Value)),n=this.ScreenObject.Data.Tables[5].filter((function(t){return"Allowmultiunits"==t.Name})),this.IsMultiunit=n.length>0&&Object(r.j)(n[0].Value),n=this.ScreenObject.Data.Tables[5].filter((function(t){return"InclPostingDate"==t.Name})),this.InclPostingDate=n.length>0&&Object(r.j)(n[0].Value),n=this.ScreenObject.Data.Tables[5].filter((function(t){return"DiscountPosting"==t.Name})),this.DiscountPosting=n.length>0&&Object(r.j)(n[0].Value),(n=this.ScreenObject.Data.Tables[5].filter((function(t){return"DiscountAccount"==t.Name}))).length>0&&(this.DiscountAccount=parseInt(n[0].Value)),(n=this.ScreenObject.Data.Tables[5].filter((function(t){return"Discountfield"==t.Name}))).length>0&&""!=n[0].Value.toString()&&(this.Discountfield=n[0].Value.toString()),n=this.ScreenObject.Data.Tables[5].filter((function(t){return"TermPosting"==t.Name})),this.TermPosting=n.length>0&&Object(r.j)(n[0].Value),n=this.ScreenObject.Data.Tables[5].filter((function(t){return"ShowOnlyAvailable"==t.Name})),this.ShowOnlyAvailable=n.length>0&&Object(r.j)(n[0].Value),n=this.ScreenObject.Data.Tables[5].filter((function(t){return"GenChqOthPart"==t.Name})),this.GenChqOthPart=n.length>0&&Object(r.j)(n[0].Value),n=this.ScreenObject.Data.Tables[5].filter((function(t){return"JVRecieptonPaymentDate"==t.Name})),this.JVRecieptonPaymentDate=n.length>0&&Object(r.j)(n[0].Value),n=this.ScreenObject.Data.Tables[5].filter((function(t){return"DontAllowmorePayment"==t.Name})),this.DontAllowmorePayment=!(n.Length>0)||Object(r.j)(n[0].Value),n=this.ScreenObject.Data.Tables[5].filter((function(t){return"DontsavenoPayment"==t.Name})),this.DontsavenoPayment=!(n.length>0)||Object(r.j)(n[0].Value),n=this.ScreenObject.Data.Tables[5].filter((function(t){return"SingleInvoice"==t.Name})),this.SingleInvoice=n.length>0&&Object(r.j)(n[0].Value),n=this.ScreenObject.Data.Tables[5].filter((function(t){return"DistributeonRent"==t.Name})),this.DistributePopuponRent=!!(n.length>0&&Object(r.j)(n[0].Value.toString()))&&Object(r.j)(n[0].Value),n=this.ScreenObject.Data.Tables[5].filter((function(t){return"SinglePDC"==t.Name})),this.SinglePDC=n.length>0&&Object(r.j)(n[0].Value),n=this.ScreenObject.Data.Tables[5].filter((function(t){return"DistributeInvoice"==t.Name})),this.DistribtueInvoice=n.length>0&&Object(r.j)(n[0].Value),n=this.ScreenObject.Data.Tables[5].filter((function(t){return"ShowMonthAmountInDistribute"==t.Name})),this.ShowMonthAmountInDistribute=n.length>0&&Object(r.j)(n[0].Value),n=this.ScreenObject.Data.Tables[5].filter((function(t){return"allowafterenddate"==t.Name})),this.allowafterenddate=!(n.length>0)||Object(r.j)(n[0].Value),104==this.CostCenterID?(n=this.ScreenObject.Data.Tables[5].filter((function(t){return"PurchasePInvoice"==t.Name})),this.InvCCID=n.length>0?parseInt(n[0].Value):0,n=this.ScreenObject.Data.Tables[5].filter((function(t){return"ContractDummyPurchase"==t.Name})),this.DummyCCID=n.length>0?parseInt(n[0].Value):0,n=this.ScreenObject.Data.Tables[5].filter((function(t){return"PurchaseVatAccountID"==t.Name})),this.VatAccountID=n.length>0?parseInt(n[0].Value):0):(n=this.ScreenObject.Data.Tables[5].filter((function(t){return"VatAccountID"==t.Name})),this.VatAccountID=n.length>0?parseInt(n[0].Value):0,n=this.ScreenObject.Data.Tables[5].filter((function(t){return"ContractSalesInvoice"==t.Name})),this.InvCCID=n.length>0?parseInt(n[0].Value):0,n=this.ScreenObject.Data.Tables[5].filter((function(t){return"ContractDummySales"==t.Name})),this.DummyCCID=n.length>0?parseInt(n[0].Value):0,n=this.ScreenObject.Data.Tables[5].filter((function(t){return"DontpostSIV"==t.Name})),this.DontpostSIV=n.length>0&&Object(r.j)(n[0].Value)),(n=this.ScreenObject.Data.Tables[5].filter((function(t){return"DefaultContractDocStatus"==t.Name}))).length>0&&!s.e.IsEmpty(n[0].Value)&&parseInt(n[0].Value)>0&&(this.DocStNodeID=parseInt(n[0].Value)),n=this.ScreenObject.Data.Tables[5].filter((function(t){return"CancelonTermiate"==t.Name})),this.CancelOnTerminate=n.length>0&&!s.e.IsEmpty(n[0].Value)&&Object(r.j)(n[0].Value),n=this.ScreenObject.Data.Tables[5].filter((function(t){return"CancelIncomeonTerminate"==t.Name})),this.CancelIncomeonTerminate=!!(n.length>0&&!s.e.IsEmpty(n[0].Value)&&Object(r.j)(n[0].Value))&&Object(r.j)(n[0].Value),n=this.ScreenObject.Data.Tables[5].filter((function(t){return"NormalDays"==t.Name})),this.DaysCount=n.length>0&&!s.e.IsEmpty(n[0].Value)&&Object(r.j)(n[0].Value)?"":"30",(n=this.ScreenObject.Data.Tables[5].filter((function(t){return"CheckNumbersForRent"==t.Name}))).length>0&&!s.e.IsEmpty(n[0].Value)&&(this.CheckNumbersForRent=Object(r.j)(n[0].Value)),(n=this.ScreenObject.Data.Tables[5].filter((function(t){return"LineWiseSalesman"==t.Name}))).length>0&&""!=n[0].Value.toString()&&(this.LineWiseSalesman=Object(r.j)(n[0].Value)),(n=this.ScreenObject.Data.Tables[5].filter((function(t){return"IncomeOnContDate"==t.Name}))).length>0&&""!=n[0].Value.toString()&&(this.IncomeOnContDate=Object(r.j)(n[0].Value)),(n=this.ScreenObject.Data.Tables[5].filter((function(t){return"PickRRfromTenant"==t.Name}))).length>0&&""!=n[0].Value.toString()&&(this.PickRRfromTenant=Object(r.j)(n[0].Value)),(n=this.ScreenObject.Data.Tables[5].filter((function(t){return"PromptOpening"==t.Name}))).length>0&&""!=n[0].Value.toString()&&(this.PromptOpening=Object(r.j)(n[0].Value)),(n=this.ScreenObject.Data.Tables[5].filter((function(t){return"RentBasedContract"==t.Name}))).length>0&&!s.e.IsEmpty(n[0].Value)&&(this.RentBasedContract=Object(r.j)(n[0].Value)),(n=this.ScreenObject.Data.Tables[5].filter((function(t){return"InclStartDate"==t.Name}))).length>0&&!s.e.IsEmpty(n[0].Value)&&(this.InclStartDate=Object(r.j)(n[0].Value)),n=this.ScreenObject.Data.Tables[5].filter((function(t){return"FilterTenantBasedOnUnit"==t.Name})),this.FilterTenantBasedOnUnit=n.length>0&&Object(r.j)(n[0].Value),(n=this.ScreenObject.Data.Tables[5].filter((function(t){return"InclEndDate"==t.Name}))).length>0&&!s.e.IsEmpty(n[0].Value)&&(this.InclEndDate=Object(r.j)(n[0].Value)),(n=this.ScreenObject.Data.Tables[5].filter((function(t){return"DailyRentDecimals"==t.Name}))).length>0&&!s.e.IsEmpty(n[0].Value)&&(this.dDeci=parseInt(n[0].Value)),(n=this.ScreenObject.Data.Tables[5].filter((function(t){return"MonthlyRentDecimals"==t.Name}))).length>0&&!s.e.IsEmpty(n[0].Value)&&(this.Mdeci=parseInt(n[0].Value)),(n=this.ScreenObject.Data.Tables[5].filter((function(t){return"NegateIncome"==t.Name}))).length>0&&!s.e.IsEmpty(n[0].Value)&&(this.NegateIncomeFld=n[0].Value.toString()),(n=this.ScreenObject.Data.Tables[5].filter((function(t){return"PDCAccounts"==t.Name}))).length>0&&!s.e.IsEmpty(n[0].Value))for(var i,o=(_toArray(i=n[0].Value.split(",")),i),l=0;l<o.length;l++)this.PDCAccounts.push(o[l],o[l].toString());if((n=this.ScreenObject.Data.Tables[5].filter((function(t){return"PDPAccounts"==t.Name}))).length>0&&!s.e.IsEmpty(n[0].Value))for(var c=n[0].Value.toString().split(","),u=0;u<c.length;u++)this.PDPAccounts.push(c[u],c[u].toString());(n=this.ScreenObject.Data.Tables[5].filter((function(t){return"EnableActivities"==t.Name}))).length>0&&!s.e.IsEmpty(n[0].Value)&&Object(r.j)(n[0].Value.toString())&&(this.Activities=new f.a(this,!1),this.ViewActivities=new P.b(this),this.ViewActivities.Activities=this.Activities),n=this.ScreenObject.Data.Tables[5].filter((function(t){return"CalculateRentAmountInDays"==t.Name})),this.CalculateRentAmountInDays=n.length>0&&Object(r.j)(n[0].Value),(n=this.ScreenObject.Data.Tables[5].filter((function(t){return"DoNotCopyPayTermsonReservation"==t.Name}))).length>0&&!s.e.IsEmpty(n[0].Value)&&(this.DonotCopyPayterms=Object(r.j)(n[0].Value)),(n=this.ScreenObject.Data.Tables[5].filter((function(t){return"MandatoryLinking"==t.Name}))).length>0&&!s.e.IsEmpty(n[0].Value)&&(this.MandatoryLinking=Object(r.j)(n[0].Value))}}},{key:"LoadButtons",value:function(){var t,e="",a="";e="Quotation,Subcontract,Draft,LoadDraft,UnitStatus,GeneralLedger,Generate,Email,Save,SaveAndPrint,Print,PrintPreview,Renew,Terminate,CancelTerminate,Reject,Approve",a="ViewHistory,Export,Refund,Vacant,Suspend,ChangeLocation,Customize,Report,Fullrefund,History";var n=(_toArray(t=this.ScreenObject.Data.Tables[5].filter((function(t){return"RightButtons"==t.Name}))),t);n.length>0&&!s.e.IsEmpty(n[0].Value)&&(a=n[0].Value.toString()),(n=this.ScreenObject.Data.Tables[5].filter((function(t){return"LeftButtons"==t.Name}))).length>0&&!s.e.IsEmpty(n[0].Value)&&(e=n[0].Value.toString()),this.ButtonsLeft.Clear(),this.ButtonsPopup.Clear();for(var i=[],r=["Customize"],o=e.split(","),l=0;l<o.length;l++)i.Contains(o[l])||this.AddButton(o[l],this.ButtonsLeft,40,40);o=a.split(",");for(var c=0;c<o.length;c++)r.Contains(o[c])||this.AddButton(o[c],this.ButtonsPopup,40,40);this.ButtonsPopup.sort((function(t,e){return t.Label>e.Label?1:-1}))}},{key:"AddButton",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,s=new b.a;switch(s.DBColumnName=t,t){case"":return;case"Quotation":s.ImgData="btn_Quotation",s.Label="Quotation",s.ComParam="ViewQuotation",s.Visible=!1;break;case"Subcontract":s.ImgData="btn_Subcontract",s.Label=i.a.GetResource("Subcontract"),s.ComParam="AddContract",s.Icon="fa-light fa-file-chart-pie",s.Visible=!1;break;case"History":s.ImgData="btn_history",s.Icon="fa-light fa-history",s.Label="Contract History",s.ComParam="History";break;case"Draft":s.ImgData="btn_saveasDraft",s.Icon="fa-light fa-clipboard",s.Label=i.a.GetResource("Com_SaveAsDraft"),s.ComParam="SaveDraft";break;case"LoadDraft":s.ImgData="btn_loaddrafts",s.Icon="fa-light fa-file-upload",s.Label=i.a.GetResource("Com_LoadDraft"),s.ComParam="LoadDraft";break;case"UnitStatus":if(95!=this.CurrCostCenterID||!i.a.SessionManager.IsActionAssigned(this.CurrCostCenterID,"Change Unit Status"))return;s.ImgData="btn_UnitStatus",s.Icon="fa-light fa-file-medical-alt",s.Label=i.a.GetResource("Rentals_UnitsStatus"),s.ComParam="UnitStatus";break;case"GeneralLedger":if(95!=this.CurrCostCenterID&&104!=this.CurrCostCenterID&&129!=this.CurrCostCenterID||!i.a.SessionManager.IsActionAssigned(this.CurrCostCenterID,"Ledger"))return;s.ImgData="btn_GeneraLledger",s.Icon="fa-light fa-file-chart-line",s.Label=i.a.GetResource("Ren_CntrLedger"),s.ComParam="GeneralLedger";break;case"Generate":s.ImgData="btn_GenerateLink",s.ImgData="btn_Generate",s.Icon="fa-light fa-link",s.Label="Generate",s.ComParam="GenerateLink",s.Visible=!1;break;case"Email":if(!i.a.SessionManager.IsActionAssigned(this.CurrCostCenterID,"Email"))return;s.ImgData="btn_email",s.Icon="fa-light fa-envelope",s.Label=i.a.GetResource("SMTP_Email"),s.ComParam="Email";break;case"Save":this.ButtonSave=s,s.ImgData="btn_save",s.Icon="fa-light fa-save",s.Label=i.a.GetResource("Save"),s.ComParam="Save";break;case"SaveAndPrint":this.ButtonSaveAndPrint=s,s.ImgData="btn_saveprint",s.Icon="fas fa-print",s.Label=i.a.GetResource("SaveAndPrint"),s.ComParam="SaveAndPrint";break;case"Print":s.ImgData="btn_print",s.Icon="fa-light fa-print",s.Label=i.a.GetResource("Print"),s.ComParam="Print";break;case"PrintPreview":s.ImgData="btn_printpreview",s.Icon="fa-light fa-eye",s.Label=i.a.GetResource("VPDesigner_PrintPreview"),s.ComParam="PrintPreview";break;case"Export":s.ImgData="M18.217578,23.672803 L15.928203,25.875225 19.586218,29.677662 21.9492,27.404427 z M31.943426,14.111772 L22.376395,14.422588 24.927307,17.217916 19.793628,22.156612 23.52525,25.888237 28.639176,20.968543 31.31366,23.748616 z M15.055823,9.4929999 L28.683851,9.4929999 C28.683851,9.493 34.933001,15.898838 34.933001,15.898838 L34.933001,33.38019 C34.933001,33.677767 34.691761,33.919001 34.394176,33.919001 L15.055823,33.919001 C14.75824,33.919001 14.517,33.677767 14.517001,33.38019 L14.517001,10.031809 C14.517,9.7342329 14.75824,9.493 15.055823,9.4929999 z M24,2.9882507 C12.40202,2.9882507 3,12.353446 3,23.906 3,35.458553 12.40202,44.82375 24,44.82375 35.59798,44.82375 45,35.458553 45,23.906 45,12.353446 35.59798,2.9882507 24,2.9882507 z M24,0 C37.254833,9.5367432E-07 48.000002,10.70308 48.000002,23.906 48.000002,37.108917 37.254833,47.812 24,47.812 10.745166,47.812 0,37.108917 0,23.906 0,10.70308 10.745166,9.5367432E-07 24,0 z",s.Icon="fa-light fa-file-export",s.Label=i.a.GetResource("Export"),s.ComParam="Export",i.a.SessionManager.IsActionAssigned(this.CurrCostCenterID,"Export")||(s.Visible=!1);break;case"Renew":this.ButtonRenew=s,s.ImgData="btn_Renew",s.Icon="fa-light fa-file-alt",s.Label=i.a.GetResource("REN_CntrlRenew"),s.ComParam="Renew";break;case"Clone":this.ButtonRenew=s,s.ImgData="btn_Renew",s.Icon="fa-light fa-file-alt",s.Label="Clone",s.ComParam="Clone";break;case"Terminate":this.ButtonTerminate=s,s.ImgData="btn_Terminate",s.Icon="fa-light fa-file-times",s.Label=i.a.GetResource("REN_CntrctTerminate"),s.ComParam="Terminate";break;case"CancelTerminate":this.ButtonCancelTerminate=s,s.ImgData="btn_CancelTerminate",s.Icon="fa-light fa-file-check",s.Label="CancelTerminate",s.ComParam="CancelTerminate",s.Visible=!1;break;case"Reject":return;case"Approve":this.BtnApprove=s,s.ImgData="M12.245309,14.964942 L12.245309,17.617507 13.129513,17.617507 13.129513,14.964942 z M10.034798,14.511355 L10.034798,17.617507 11.803206,17.617507 11.803206,14.522849 13.571616,14.522849 13.571616,17.617507 13.828919,17.617507 14.95849,17.617507 15.340024,17.617507 15.340024,14.511355 z M12.815179,11.434381 L8.926029,14.52285 9.8751993,14.52285 15.523056,14.52285 16.430559,14.52285 z M14.036604,4.9942643 C14.460727,4.9853422 14.789422,5.2053321 14.789422,5.2053322 14.789422,5.2053321 14.811798,7.8219571 14.904227,8.1933987 14.997631,8.5638661 17.010658,12.479566 17.010658,12.479566 17.010658,12.686678 18.257969,12.893793 18.256999,13.101876 18.243375,14.902691 18.256999,16.44291 18.256999,18.307898 16.919199,17.958822 16.204084,19.008 13.345568,19.008 12.412514,19.008 11.244978,18.855338 10.262306,18.692954 L7.6898389,18.431391 C7.2442299,18.385689 6.9299684,17.883949 6.9873728,17.310259 7.0331005,16.86783 7.2899575,16.517784 7.6100566,16.400127 L7.2860667,16.367066 C6.7762434,16.314558 6.4094426,15.808932 6.4687919,15.235239 6.5193845,14.743223 6.8696451,14.382476 7.2880112,14.315384 L7.1566638,14.302744 C6.5826265,14.243429 6.1642606,13.730996 6.2236097,13.157302 6.2819864,12.584582 6.7937559,12.166466 7.3677931,12.224808 L8.9225607,12.383303 8.9283984,12.337602 7.6956764,12.212166 C7.1936352,12.161605 6.8336461,11.655003 6.892997,11.08131 6.9513738,10.507619 7.4047645,10.084642 7.9068058,10.136178 L12.034036,10.556237 12.619752,10.564988 C12.619752,10.564988 11.772316,10.180906 12.423219,7.1179664 12.788253,5.3956107 13.491306,5.0057365 14.036604,4.9942643 z M12.5,1.5624998 C6.4593853,1.5625002 1.562499,6.4593856 1.562499,12.5 1.562499,18.540611 6.4593853,23.4375 12.5,23.4375 18.540612,23.4375 23.437498,18.540611 23.437498,12.5 23.437498,6.4593856 18.540612,1.5625002 12.5,1.5624998 z M12.5,0 C19.403557,0 25,5.5964406 25,12.5 25,19.403559 19.403557,25 12.5,25 5.5964398,25 0,19.403559 0,12.5 0,5.5964406 5.5964398,0 12.5,0 z",s.Label="Approve",s.Icon="fa-light fa-user-check",s.ComParam="RejectVisiblity";break;case"ViewHistory":s.ImgData="M12.185519,12.386564 C12.193278,12.386564 12.201297,12.386965 12.20951,12.387747 12.217725,12.388529 12.226134,12.389692 12.234677,12.391215 12.24322,12.392739 12.251897,12.394622 12.260643,12.396845 12.269391,12.399069 12.278208,12.401632 12.287034,12.404515 12.295859,12.407397 12.304693,12.410599 12.313472,12.4141 12.322251,12.417602 12.330975,12.421402 12.339582,12.42548 12.348189,12.429558 12.356679,12.433916 12.364989,12.43853 12.373299,12.443145 12.381429,12.44801812.389317,12.453129 12.397204,12.45824 12.40485,12.463587 12.412189,12.469152 12.419529,12.474718 12.426565,12.4805 12.433232,12.486479 12.439899,12.492457 12.446198,12.498633 12.452067,12.504985 12.455002,12.508161 12.457829,12.511381 12.460541,12.514642 12.463252,12.517904 12.465848,12.521206 12.468321,12.524549 12.470794,12.52789 12.473144,12.531271 12.475362,12.534688 12.477581,12.538105 12.479668,12.541558 12.481617,12.545045 12.483565,12.54853212.485375,12.552054 12.487038,12.555606 12.488701,12.559158 12.490217,12.562742 12.491579,12.566354 12.492941,12.569966 12.494148,12.573608 12.495192,12.577274 12.496237,12.580942 12.49712,12.584635 12.497831,12.588352 12.498544,12.592069 12.499086,12.595809 12.49945,12.59957 12.499814,12.603332 12.499999,12.607114 12.499999,12.610915 L12.499999,13.7604 13.462979,13.7604 C13.467548,13.7604 13.472087,13.760566 13.476593,13.760892 13.481099,13.761219 13.485572,13.761706 13.490011,13.762346 13.494449,13.762988 13.498852,13.763783 13.503217,13.764726 13.507582,13.76567 13.511909,13.766762 13.516195,13.767996 13.520482,13.769231 13.524728,13.770608 13.528931,13.772122 13.533135,13.773635 13.537294,13.775285 13.541409,13.777066 13.545524,13.778847 13.549592,13.780758 13.553613,13.782794 13.557634,13.784831 13.561606,13.78699113.565528,13.789271 13.573371,13.79383 13.581011,13.798864 13.588428,13.804326 13.595844,13.809788 13.603037,13.815678 13.609986,13.821948 13.616934,13.828218 13.623638,13.834868 13.630077,13.841852 13.636517,13.848835 13.642691,13.856151 13.64858,13.863753 13.654468,13.871354 13.660071,13.879242 13.665368,13.887368 13.670665,13.895493 13.675656,13.903857 13.68032,13.912411 13.684984,13.920966 13.689321,13.929711 13.69331,13.9386 13.6973,13.94748813.700942,13.956521 13.704216,13.965649 13.707491,13.974777 13.710397,13.984001 13.712914,13.993273 13.715432,14.002546 13.71756,14.011867 13.71928,14.02119 13.721,14.030512 13.722311,14.039836 13.72319,14.049113 13.724071,14.058391 13.724522,14.067622 13.724522,14.076761 13.724522,14.085781 13.724071,14.094898 13.72319,14.104068 13.722311,14.113237 13.721,14.122457 13.71928,14.13168 13.71756,14.140903 13.715432,14.150131 13.712914,14.15931413.710397,14.168496 13.707491,14.177635 13.704216,14.186682 13.700942,14.195728 13.6973,14.204683 13.69331,14.213499 13.689321,14.222315 13.684984,14.230991 13.68032,14.239481 13.675656,14.247972 13.670665,14.256274 13.665368,14.264343 13.660071,14.272411 13.654468,14.280246 13.64858,14.287799 13.642691,14.295351 13.636517,14.302622 13.630077,14.309563 13.623638,14.316504 13.616934,14.323116 13.609986,14.329351 13.603037,14.335587 13.595844,14.34144413.588428,14.346877 13.581011,14.352311 13.573371,14.35732 13.565528,14.361856 13.561606,14.364125 13.557634,14.366276 13.553613,14.368302 13.549592,14.370329 13.545524,14.372231 13.541409,14.374004 13.537294,14.375776 13.533135,14.377419 13.528931,14.378926 13.524728,14.380433 13.520482,14.381804 13.516195,14.383034 13.511909,14.384263 13.507582,14.38535 13.503217,14.386291 13.498852,14.387231 13.494449,14.388022 13.490011,14.38866 13.485572,14.38929913.481099,14.389784 13.476593,14.390109 13.472087,14.390434 13.467548,14.390599 13.462979,14.390599 L12.36072,14.390599 C12.358357,14.390599 12.355709,14.390801 12.352807,14.39118 12.349904,14.391559 12.346749,14.392114 12.343375,14.39282 12.339999,14.393527 12.336404,14.394384 12.332621,14.395369 12.328838,14.396353 12.324867,14.397463 12.320741,14.398674 12.316615,14.399885 12.312334,14.401197 12.30793,14.402586 12.303527,14.403974 12.299,14.405437 12.294384,14.406951 12.285152,14.409979 12.275561,14.413208 12.265872,14.416438 12.256183,14.419668 12.246394,14.42289712.236769,14.425925 12.227143,14.428953 12.21768,14.43178 12.20864,14.434202 12.204121,14.435413 12.199706,14.436523 12.195431,14.437508 12.191155,14.438492 12.187018,14.43935 12.183052,14.440056 12.179086,14.440763 12.175292,14.441318 12.1717,14.441696 12.168109,14.442075 12.164721,14.442277 12.16157,14.442277 12.146051,14.442277 12.129852,14.440839 12.113387,14.438081 12.105154,14.436701 12.096854,14.434993 12.08854,14.432967 12.080224,14.43094312.071894,14.428602 12.063601,14.425961 12.055306,14.423319 12.047049,14.420377 12.038879,14.417148 12.03071,14.413919 12.022628,14.410404 12.014685,14.406618 12.006743,14.402831 11.99894,14.398772 11.991328,14.394456 11.983716,14.390141 11.976295,14.385569 11.969116,14.380754 11.961937,14.375938 11.955001,14.370881 11.948359,14.365595 11.941717,14.36031 11.935369,14.354796 11.929367,14.34907 11.923364,14.343343 11.917707,14.337403 11.912447,14.33126411.907187,14.325127 11.902325,14.318789 11.897911,14.312268 11.895704,14.309008 11.893609,14.305701 11.891633,14.30235 11.889657,14.298999 11.887799,14.295605 11.886067,14.292168 11.884334,14.288731 11.882726,14.285251 11.88125,14.281731 11.879775,14.278211 11.87843,14.27465 11.877223,14.27105 11.876016,14.26745 11.874948,14.263813 11.874023,14.260139 11.873099,14.256463 11.872319,14.252751 11.871691,14.249004 11.871061,14.245258 11.870583,14.24147611.870262,14.23766 11.869941,14.233846 11.869777,14.229998 11.869777,14.226118 L11.869777,12.610915 C11.869777,12.607114 11.869965,12.603332 11.870331,12.59957 11.870697,12.595809 11.871243,12.592069 11.871959,12.588352 11.872676,12.584635 11.873564,12.580942 11.874615,12.577274 11.875667,12.573608 11.876882,12.569966 11.878252,12.566354 11.879622,12.562742 11.881148,12.559158 11.882822,12.555606 11.884495,12.552054 11.886316,12.548532 11.888277,12.545045 11.890237,12.541558 11.892337,12.538105 11.894569,12.534688 11.896801,12.531271 11.899166,12.5278911.901653,12.524549 11.904141,12.521206 11.906752,12.517904 11.90948,12.514642 11.912207,12.511381 11.915051,12.508161 11.918002,12.504985 11.923905,12.498633 11.93024,12.492457 11.936944,12.486479 11.943648,12.4805 11.950722,12.474718 11.9581,12.469152 11.965479,12.463587 11.973163,12.45824 11.98109,12.453129 11.989017,12.448018 11.997187,12.443145 12.005536,12.43853 12.013885,12.433916 12.022413,12.429558 12.031056,12.42548 12.039701,12.42140212.04846,12.417602 12.057273,12.4141 12.066086,12.410599 12.074952,12.407397 12.083807,12.404515 12.092662,12.401632 12.101507,12.399069 12.110278,12.396845 12.119049,12.394622 12.127746,12.392739 12.136306,12.391215 12.144866,12.389692 12.15329,12.388529 12.161513,12.387747 12.169736,12.386965 12.177759,12.386564 12.185519,12.386564 z M12.304631,12.023569 C11.271066,12.023569 10.43098,12.863626 10.43098,13.898413 10.43098,13.930672 10.431801,13.962743 10.433422,13.994606 10.435043,14.026469 10.437464,14.058125 10.440667,14.089553 10.44387,14.120981 10.447853,14.152183 10.452598,14.183137 10.462088,14.245046 10.474622,14.305966 10.490043,14.36574 10.497754,14.395627 10.506186,14.425227 10.515321,14.454521 10.524455,14.483816 10.534292,14.512803 10.544811,14.541466 10.576366,14.627451 10.614063,14.71050110.657366,14.790082 10.70067,14.869663 10.749582,14.945776 10.803568,15.017887 10.857554,15.089997 10.916615,15.158105 10.980219,15.221676 11.00142,15.242867 11.023126,15.263553 11.045316,15.283715 11.089697,15.32404 11.136019,15.36227 11.184122,15.398248 11.232225,15.434224 11.28211,15.467948 11.333619,15.499259 11.385128,15.530571 11.438261,15.559471 11.492859,15.585801 11.547459,15.612131 11.603524,15.635892 11.660897,15.656925 11.746958,15.68847511.835961,15.713886 11.927376,15.732625 12.018792,15.751366 12.112617,15.763433 12.208321,15.768296 12.240222,15.769917 12.272332,15.770738 12.304631,15.770738 12.33691,15.770738 12.369001,15.769917 12.400884,15.768296 12.496532,15.763433 12.590308,15.751366 12.681678,15.732625 12.712134,15.726378 12.742323,15.719391 12.772225,15.711681 12.832029,15.696262 12.890685,15.677958 12.948035,15.656925 12.97671,15.646409 13.005058,15.63521 13.03306,15.6233513.061061,15.611489 13.088717,15.598967 13.116006,15.585801 13.143296,15.572637 13.170218,15.558828 13.196756,15.544398 13.223293,15.529967 13.249445,15.514915 13.275191,15.499259 13.300937,15.483603 13.326278,15.467344 13.351192,15.450502 13.376108,15.433661 13.400597,15.416236 13.424642,15.398248 13.448686,15.38026 13.472286,15.361708 13.49542,15.342612 13.518555,15.323517 13.541224,15.303878 13.56341,15.283715 13.585595,15.263553 13.607296,15.24286713.628491,15.221676 13.649688,15.200485 13.670379,15.178791 13.690547,15.156612 13.730882,15.112255 13.769121,15.06596 13.805106,15.017887 13.823098,14.99385 13.840526,14.969369 13.857372,14.944462 13.891062,14.89465 13.922419,14.843137 13.951284,14.790082 13.965717,14.763555 13.979527,14.736643 13.992694,14.709364 14.032196,14.627529 14.065914,14.542404 14.093315,14.454521 14.148118,14.278757 14.177652,14.091964 14.177652,13.898413 14.177652,13.8337414.17437,13.769826 14.167965,13.706831 14.164762,13.675333 14.160779,13.644065 14.156034,13.613046 14.151289,13.582026 14.145783,13.551257 14.139536,13.520757 14.127042,13.459755 14.111582,13.399829 14.093315,13.341137 14.084181,13.311791 14.074346,13.282753 14.063828,13.254044 14.05331,13.225333 14.04211,13.196951 14.030248,13.168918 14.006524,13.11285 13.98015,13.058172 13.951284,13.005044 13.936852,12.978479 13.921796,12.952302 13.906137,12.92653113.890479,12.900761 13.874217,12.875397 13.857372,12.85046 13.823681,12.800585 13.787658,12.752417 13.749458,12.706112 13.730359,12.68296 13.710715,12.660274 13.690547,12.638072 13.650212,12.59367 13.60778,12.55121 13.56341,12.51085 13.541224,12.49067 13.518555,12.471015 13.49542,12.451905 13.449151,12.413684 13.401022,12.377643 13.351192,12.343936 13.301363,12.310231 13.249831,12.278862 13.196756,12.249986 13.143682,12.221109 13.089063,12.19472613.03306,12.170996 12.977056,12.147265 12.919667,12.126185 12.861051,12.107914 12.773126,12.080508 12.68244,12.059422 12.589525,12.045187 12.496611,12.030952 12.401468,12.023569 12.304631,12.023569 z M12.304631,11.497982 C12.842546,11.497982 13.339167,11.675211 13.73927,11.974613 13.770047,11.997644 13.800253,12.021398 13.829863,12.045849 13.859472,12.070301 13.888486,12.095451 13.916878,12.121273 13.94527,12.147095 13.973041,12.173591 14.000165,12.200734 14.027289,12.227876 14.053767,12.255667 14.079573,12.284081 14.105379,12.312494 14.130513,12.341529 14.154951,12.371163 14.179388,12.400797 14.203129,12.431028 14.226148,12.461832 14.249166,12.492636 14.271463,12.52401214.293013,12.555936 14.314563,12.58786 14.335365,12.620332 14.355396,12.653325 14.375426,12.686319 14.394684,12.719835 14.413145,12.753849 14.431606,12.787863 14.449269,12.822373 14.46611,12.857357 14.482952,12.89234 14.49897,12.927796 14.514141,12.963699 14.529312,12.999602 14.543635,13.035953 14.557086,13.072725 14.570536,13.109497 14.583114,13.146691 14.594793,13.184283 14.606473,13.221875 14.617255,13.259864 14.627114,13.298225 14.636972,13.33658614.645909,13.375319 14.653896,13.414399 14.661884,13.453479 14.668923,13.492907 14.674989,13.532655 14.681056,13.572404 14.686148,13.612475 14.690243,13.652844 14.698431,13.73358 14.702626,13.815503 14.702626,13.898413 14.702626,14.1051 14.676408,14.305693 14.627114,14.497051 14.617255,14.535323 14.606473,14.573225 14.594793,14.610732 14.571434,14.685748 14.544482,14.759186 14.514141,14.830844 14.49897,14.866673 14.482952,14.902058 14.46611,14.93697214.449269,14.971887 14.431606,15.00633 14.413145,15.040279 14.394684,15.074229 14.375426,15.107683 14.355396,15.140617 14.335365,15.173552 14.314563,15.205965 14.293013,15.237834 14.271463,15.269703 14.249166,15.301025 14.226148,15.331779 14.203129,15.362531 14.179388,15.392713 14.154951,15.422299 14.130513,15.451886 14.105379,15.480877 14.079573,15.509247 14.053767,15.537617 14.027289,15.565367 14.000165,15.59247 13.973041,15.619574 13.94527,15.64603113.916878,15.671818 13.888486,15.697604 13.859472,15.72272 13.829863,15.74714 13.444936,16.064592 12.959241,16.264392 12.428007,16.291315 12.387143,16.293386 12.346009,16.294435 12.304631,16.294435 12.263253,16.294435 12.222119,16.293386 12.181255,16.291315 11.609156,16.262321 11.089873,16.03283 10.692384,15.671818 10.663992,15.646031 10.636221,15.619574 10.609097,15.59247 10.581973,15.565367 10.555495,15.537617 10.529689,15.509247 10.503883,15.48087710.478749,15.451886 10.454311,15.422299 10.429874,15.392713 10.406133,15.362531 10.383114,15.331779 10.337077,15.270272 10.293927,15.206486 10.253866,15.140617 10.213805,15.074749 10.176834,15.006801 10.143152,14.936972 10.109469,14.867143 10.079077,14.795435 10.052176,14.722047 10.038726,14.685354 10.026148,14.648241 10.014468,14.610732 9.9911087,14.535717 9.9713407,14.459124 9.9553657,14.381153 9.9473777,14.342168 9.9403386,14.302838 9.9342723,14.2631899.9282062,14.22354 9.9231133,14.183573 9.919019,14.143311 9.9149244,14.103049 9.9118288,14.062494 9.9097564,14.021669 9.9076841,13.980844 9.9066353,13.939751 9.9066355,13.898413 9.9066353,12.571843 10.980534,11.497982 12.304631,11.497982 z M14.390666,7.9833566 L14.390666,9.9791999 16.191841,9.9791999 z M8.0884445,7.4583998 L8.0884445,17.5416 16.911555,17.5416 16.911555,10.6094 13.760444,10.6094 13.760444,7.4583998 z M6.8279999,6.1979999 L14.561457,6.1979999 18.172,9.711365 18.172,18.802 6.8279999,18.802 z M12.5,1.5625005 C6.4593852,1.5625005 1.5624995,6.4593857 1.5624995,12.499999 1.5624995,18.540612 6.4593852,23.4375 12.5,23.4375 18.540613,23.4375 23.437501,18.540612 23.437501,12.499999 23.437501,6.4593857 18.540613,1.5625005 12.5,1.5625005 z M12.5,0 C19.403559,0 25.000001,5.5964408 25.000001,12.499999 25.000001,19.403556 19.403559,25 12.5,25 5.5964397,25 0,19.403556 0,12.499999 0,5.5964408 5.5964397,0 12.5,0 z",s.Icon="fa-light fa-history",s.Label=i.a.GetResource("History"),s.ComParam="ViewHistory",s.Visible=!1;break;case"Refund":this.ButtonRefund=s,s.ImgData="btn_Refund",s.Icon="fa-light fa-undo",s.Label="Refund",s.ComParam="RefundVisiblity";break;case"Fullrefund":this.BtnFullRefund=s,s.ImgData="btn_Fullrefund",s.Icon="fa fa-undo",s.Label="Full refund",s.ComParam="Fullrefund";break;case"Vacant":this.ButtonVacant=s,s.ImgData="",s.Icon="fa-light fa-times-circle",s.Label="Close",s.ComParam="VacantVisiblity";break;case"Suspend":this.ButtonSuspend=s,s.ImgData="btn_Suspend",s.Icon="fa-light fa-ban",s.Label="Suspend",s.ComParam="Suspend";break;case"ChangeLocation":s.ImgData="btn_ChangeLocation",s.Icon="fa-light fa-map-marker",s.Label=i.a.GetResource("DocChangeLocation"),s.ComParam="ChangeLocation";break;case"Customize":if(!i.a.SessionManager.IsActionAssigned(this.CurrCostCenterID,"Customize"))return;s.ImgData="M19.110601,18.563202 L18.265291,18.738087 17.987889,19.499944 18.564974,20.21662 19.416821,19.991161 19.640322,19.248151 z M11.293121,8.0873224 C11.392489,8.0890351 11.492839,8.0962141 11.593825,8.1091189 13.030063,8.2926578 14.050814,9.564903 13.873734,10.950758 13.840532,11.210605 13.767576,11.455998 13.661474,11.682009 L13.651067,11.702786 15.0279,13.228183 18.824523,9.3943181 C18.824523,9.394318 19.140872,9.2239439 19.470628,9.4361365 19.470628,9.4361366 20.359267,9.7847023 20.807165,10.825176 20.807165,10.825177 20.942139,10.88601 20.678352,11.320988 20.665603,11.342013 20.65192,11.363912 20.637248,11.386719 20.353802,11.827299 17.500436,14.61448 16.879653,15.218904 L16.850421,15.247358 18.77279,17.377155 18.853621,17.376846 C18.918926,17.378299 18.984755,17.383181 19.05092,17.391635 20.109579,17.526922 20.854148,18.525988 20.713963,19.623109 20.573775,20.720232 19.60192,21.499954 18.543262,21.364665 17.484603,21.229379 16.740033,20.230313 16.880219,19.13319 16.897742,18.996051 16.928261,18.86387 16.970319,18.737816 L17.003294,18.646406 15.074982,16.506892 15.06202,16.525836 C15.003895,16.617702 14.963834,16.711501 14.948184,16.805911 14.948184,16.805911 14.932747,17.339283 14.533682,17.313454 14.533682,17.313454 14.347342,17.244139 13.801846,16.827139 13.801846,16.827139 10.852632,19.565254 10.744088,19.768157 10.744088,19.768157 10.555843,20.023161 10.401911,20.337636 L9.3724868,21.206152 8.8539903,20.666849 9.7250609,19.663158 C9.7250612,19.663158 9.9756771,19.474508 10.329479,19.255787 L13.40929,16.405718 C13.40929,16.405718 12.865702,15.664404 12.865702,15.664404 12.865702,15.664404 12.8296,15.337628 13.228665,15.363457 13.228665,15.363457 13.445908,15.294698 13.724107,15.096941 L13.772371,15.061612 11.972145,13.06421 11.866173,13.089745 C11.574775,13.15262 11.266742,13.167893 10.952565,13.127744 9.5612088,12.949941 8.559778,11.750412 8.6595386,10.415667 8.6627567,10.372611 8.6671208,10.329414 8.6726546,10.286106 8.6975562,10.091219 8.7448197,9.9044652 8.811657,9.7279192 L8.8126342,9.725435 10.075197,11.113952 11.614002,10.744784 12.058911,9.3259526 10.976887,8.1005636 10.998316,8.0983235 C11.095369,8.0893632 11.193753,8.0856096 11.293121,8.0873224 z M15,1.875 C7.7512631,1.875 1.8750005,7.7512622 1.8750005,15 1.8750005,22.248737 7.7512631,28.124999 15,28.124999 22.248737,28.124999 28.125,22.248737 28.125,15 28.125,7.7512622 22.248737,1.875 15,1.875 z M15,0 C23.28427,0 30,6.7157291 30,15 30,23.284271 23.28427,29.999999 15,29.999999 6.7157292,29.999999 0,23.284271 0,15 0,6.7157291 6.7157292,0 15,0 z",s.Label=i.a.GetResource("Customize"),s.ComParam="Customize";break;case"Report":if(!i.a.SessionManager.IsActionAssigned(this.CurrCostCenterID,"Query"))return;s.ImgData="M9.6875,15.1455 L11.1625,15.1455 11.1625,16.620501 9.6875,16.620501 z M11.9,13.6705 L13.375,13.6705 13.375,16.620501 11.9,16.620501 z M14.1125,11.4455 L15.5875,11.4455 15.5875,16.620501 14.1125,16.620501 z M14.85,7.2476875 L14.85,9.2205 16.796262,9.2205 z M8.2124999,7.0080001 L8.2124999,17.358 17.0625,17.358 17.0625,9.9580002 14.1125,9.9580002 14.1125,7.0080001 z M7.4749997,5.5330001 L14.547625,5.5330001 17.8,8.8488002 17.8,18.833 7.4749997,18.833 z M12.499999,1.5625 C6.4593848,1.5625005 1.562499,6.4593862 1.562499,12.5 1.562499,18.540611 6.4593848,23.437499 12.499999,23.437499 18.540611,23.437499 23.4375,18.540611 23.4375,12.5 23.4375,6.4593862 18.540611,1.5625005 12.499999,1.5625 z M12.499999,0 C19.403557,0 25,5.596441 25,12.5 25,19.403559 19.403557,24.999999 12.499999,24.999999 5.5964394,24.999999 0,19.403559 0,12.5 0,5.596441 5.5964394,0 12.499999,0 z",s.Icon="fa-light fa-file-chart-line",s.Label=i.a.GetResource("Report"),s.ComParam="Report"}s.Width=a.toString(),s.SectionID=n.toString(),e.push(s)}},{key:"GetButton",value:function(t){var e=this.ButtonsLeft.filter((function(e){return e.DBColumnName.toUpperCase()==t.toUpperCase()}));return null==e&&(e=this.ButtonsPopup.filter((function(e){return e.DBColumnName.toUpperCase()==t.toUpperCase()}))),e}},{key:"SetButtonVisibility",value:function(t,e){var a=this.ButtonsLeft.filter((function(e){return e.ComParam.toUpperCase()==t.toUpperCase()}));!s.e.IsEmpty(a)&&a.length>0?a[0].Visible=e:(a=this.ButtonsPopup.filter((function(e){return e.ComParam.toUpperCase()==t.toUpperCase()})),!s.e.IsEmpty(a)&&a.length>0&&(a[0].Visible=e))}},{key:"CheckViewForUser",value:function(t){var e=this;if(this.ScreenObject.CheckViewForUser(t>0),this.ContractParticular.forEach((function(a){null!=a.ID&&e.ScreenObject.SetView(a,t>0)})),this.ContractPayTerms.forEach((function(a){null!=a.ID&&e.ScreenObject.SetView(a,t>0)})),null!=this.ScreenObject.Data&&this.ScreenObject.Data.Tables.length>3&&this.ScreenObject.Data.Tables[this.ScreenObject.Data.Tables.length-2].length>0){var a=[];(a=this.ScreenObject.Data.Tables[this.ScreenObject.Data.Tables.length-2].filter(0==t?function(t){return-1==t.CostCenterColID&&(1==t.Mode||3==t.Mode)}:function(t){return-1==t.CostCenterColID&&(2==t.Mode||3==t.Mode)})).length>0?(this.ParticularsBodyVisible=Object(r.j)(a[0].IsVisible.toString()),this.ParticularsBodyReadOnly=!Object(r.j)(a[0].IsEditable.toString())):(this.ParticularsBodyVisible=!0,this.ParticularsBodyReadOnly=!1),t>0&&this.IsRecurPosted&&(this.ParticularsBodyReadOnly=!0),(a=this.ScreenObject.Data.Tables[this.ScreenObject.Data.Tables.length-2].filter(0==t?function(t){return-2==t.CostCenterColID&&(1==t.Mode||3==t.Mode)}:function(t){return-2==t.CostCenterColID&&(2==t.Mode||3==t.Mode)})).length>0?(this.PayTermsBodyVisible=Object(r.j)(a[0].IsVisible.toString()),this.PayTermsBodyReadOnly=!Object(r.j)(a[0].IsEditable.toString())):(this.PayTermsBodyVisible=!0,this.PayTermsBodyReadOnly=!1),(a=this.ScreenObject.Data.Tables[this.ScreenObject.Data.Tables.length-2].filter(0==t?function(t){return-3==t.CostCenterColID&&(1==t.Mode||3==t.Mode)}:function(t){return t.CostCenterColID=1==t.Mode||3==t.Mode})).length>0?(this.ButtonGenChq.Visible=Object(r.j)(a[0].IsVisible.toString()),this.ButtonGenChq.Enable=Object(r.j)(a[0].IsEditable.toString())):(this.ButtonGenChq.Visible=!0,this.ButtonGenChq.Enable=!0)}this.TotalDays.Enable=!1,this.StatusID.Enable=!1,this.CheckTabViewForUser(""),104!=this.CostCenterID&&this.DimWiseFields>5e4&&(this.SetViewByType(),this.SetFieldsposition())}},{key:"SetViewByType",value:function(){for(var t,e=this,a=null,n=null,i=this.ScreenObject.Data.Tables[16].filter((function(t){return 0==t.IsTab&&t.TypeID==e.DimWiseFieldsID})),s=function(n){var s=i[n];if(null!=e.ScreenObject.HeaderFields&&(a=e.ScreenObject.HeaderFields.find((function(t){return t instanceof o.c&&t.DBColumnID==parseInt(s.CostCenterColID)}))),null==a)for(var r=0;r<e.ScreenObject.CustomTab.Pages.length&&null==(a=e.ScreenObject.CustomTab.Pages[r].Fields.find((function(t){return t instanceof o.c&&t.DBColumnID==parseInt(s.CostCenterColID)})));r++);null!=a?(1!=(t=parseInt(s.Hide))&&2!=t||(a.Visible=!1),1!=(t=parseInt(s.Mandatory))&&2!=t||(a.Mandatory=!0)):(null==(c=e.ContractParticular.find((function(t){return t.ID==s.CostCenterColID.toString()})))&&(c=e.ContractPayTerms.find((function(t){return t.ID==s.CostCenterColID.toString()}))),null!=a&&(1!=(t=parseInt(s.Hide))&&2!=t||(c.IsVisible=!1)))},l=0;l<i.length;l++){var c;s(l)}i=this.ScreenObject.Data.Tables[16].filter((function(t){return 1==t.IsTab&&t.TypeID==e.DimWiseFieldsID}));for(var u=function(a){var s=i[a];null!=(n=e.ScreenObject.CustomTab.Pages.find((function(t){return t.DBColumnID==parseInt(s.CostCenterColID)})))&&(1!=(t=parseInt(s.Hide))&&2!=t||(n.Visible=!1),1!=(t=parseInt(s.Mandatory))&&2!=t||(n.IsReadOnly=!0))},D=0;D<i.length;D++)u(D);for(var h=function(a){var n=e.ScreenObject.CustomTab.Pages[a];(i=e.ScreenObject.Data.Tables[16].filter((function(t){return 1==t.IsTab&&t.TypeID==e.DimWiseFieldsID&&t.CostCenterColID==n.DBColumnID}))).length>0?(1!=(t=parseInt(i[0].Hide))&&2!=t||(n.Visible=!1),1!=(t=parseInt(i[0].Mandatory))&&2!=t||(n.IsReadOnly=!0)):(i=e.ScreenObject.Data.Tables[e.ScreenObject.Data.Tables.length-1].filter((function(t){return t.CCTabID==n.DBColumnID}))).length>0&&(n.IsReadOnly=!1,n.Visible=Object(r.j)(i[0].IsVisible))},C=0;C<this.ScreenObject.CustomTab.Pages.length;C++)h(C);for(var m=0;m<this.ScreenObject.CustomTab.Pages.length;m++){var b=this.ScreenObject.CustomTab.Pages[m];if(b.Visible){this.ScreenObject.CustomTab.SelectedTab=b;break}}}},{key:"CheckTabViewForUser",value:function(t){var e=this.ScreenObject.Data.Tables[this.ScreenObject.Data.Tables.length-2];this.ScreenObject.CustomTab.Pages.forEach((function(a){null!=e&&e.length>0&&e.some((function(t){return t.hasOwnProperty("CostCenterColID")}))&&(e=e.filter((function(e){return 0==e.CostCenterColID&&e.Tabid>0+t}))),null!=e&&e.length>0&&e.some((function(t){return t.hasOwnProperty("CostCenterColID")}))&&((e=e.filter((function(t){return t.Tabid==a.DBColumnID}))).length>0&&(a.IsReadOnly=!(s.e.IsEmpty(e[0].IsReadOnly)||!Object(r.j)(e[0].IsReadOnly)),a.Visible=!(s.e.IsEmpty(e[0].IsVisible)||!Object(r.j)(e[0].IsVisible))))}))}},{key:"SetFieldsposition",value:function(){var t,e=this,a=(_toArray(t=this.ScreenObject.HeaderFields.filter((function(t){return t instanceof o.c&&1==t.Visible}))),t);a.sort((function(t,e){return t.SectionSeqNo-e.SectionSeqNo})),this.Setposition(a),this.ScreenObject.CustomTab.Pages.forEach((function(t){var a=t.Fields.filter((function(t){return t instanceof o.c&&1==t.Visible}));a.sort((function(t,e){return t.SectionSeqNo-e.SectionSeqNo})),a.length>0&&e.Setposition(a)}))}},{key:"Setposition",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=0,a=0,n=1,i=0;i<t.length;i++){var r=t[i];null!=r&&r.Visible&&(n=1,(n=s.e.IntTryParse(r.ColumnSpan))<1&&(n=1),a+n>4&&(e++,a=0),r.Row=e,r.Column=a,a+=n)}}},{key:"RefershTitle",value:function(){this.DisplayName=0==this.ContractID?i.a.GetResource("Add")+" ":i.a.GetResource("Edit")+" ",""!=this.Title?this.DisplayName=this.DisplayName+s.e.StringValue(this.Title):95==this.CurrCostCenterID?this.DisplayName=this.DisplayName+"Contract":103==this.CurrCostCenterID?this.DisplayName=this.DisplayName+"Quotation":104==this.CurrCostCenterID?this.DisplayName=this.DisplayName+"Purchase Contract":129==this.CurrCostCenterID&&(this.DisplayName=this.DisplayName+"Reservation")}},{key:"ReportView",value:function(){var t=this;this.ReportDimension=new l.b(0),this.ReportDimension.CCID=this.CostCenterID,this.ReportDimension.TypeID=1,this.ReportDimension.SelectedValue=this.cntrct.ContractID,this.ReportDimension.OnPactListBoxValueChanged.Subscribe(this,"OnReportsLinkClick");var e=[];null!=this.ScreenObject.Data&&this.ScreenObject.Data.Tables.length>15&&this.ScreenObject.Data.Tables[15].forEach((function(a){var n=new b.a;n.DBColumnID=parseInt(a.ReportID),n.Label=a.ReportName.toString(),t.ScreenObject.Data.Columns[15].Contains("Shortcut")&&(n.KeyTip=a.Shortcut.toString()),t.ScreenObject.Data.Columns[15].Contains("DisplayAsPopup")&&""!=a.DisplayAsPopup.toString()&&(n.Dependantinuse=Object(r.j)(a.DisplayAsPopup.toString())),t.ScreenObject.Data.Columns[15].Contains("Width")&&""!=a.Width.toString()&&(n.Width=a.Width.toString()),t.ScreenObject.Data.Columns[15].Contains("Height")&&""!=a.Height.toString()&&(n.Length=a.Height.toString()),t.ScreenObject.Data.Columns[15].Contains("DocumentField")&&""!=a.DocumentField.toString()&&(n.Formula=a.DocumentField.toString()),t.ScreenObject.Data.Columns[15].Contains("mapxml")&&""!=a.mapxml.toString()&&(n.ToolTipDescription=a.mapxml.toString()),e.Contains(parseInt(a.ReportID))||(e.push(parseInt(a.ReportID)),t.ReportsList.push(n))}))}},{key:"OnReportsLinkClick",value:function(t){return Object(n.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,o,l,c,u,D,h,C;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([a.e(2),a.e(1),a.e(3),a.e(5),a.e(4),a.e(6),a.e(7),a.e(10),a.e(9),a.e(8),a.e(12),a.e(11),a.e(13),a.e(19),a.e(15),a.e(21),a.e(20),a.e(16),a.e(14),a.e(18),a.e(17),a.e(22),a.e(23),a.e(24),a.e(25),a.e(28),a.e(30),a.e(29),a.e(32),a.e(31),a.e(27),a.e(26),a.e(35),a.e(37),a.e(38),a.e(36),a.e(33),a.e(34),a.e(39),a.e(40),a.e(41),a.e(212)]).then(a.bind(null,"ThYU"));case 2:return n=e.sent,r=n.ReportViewModel,e.next=6,Promise.all([a.e(32),a.e(37)]).then(a.bind(null,"YU11"));case 6:o=e.sent,l=o.ReportViewComponent,u=new r,this.ReportDimension.SelectedValue=this.cntrct.ContractID,D={strXML:""},this.DisplayMessage=this.GetReportFilterXML(t,D),c=D.strXML,0==this.DisplayMessage.length&&(null!=(h=this.ReportsList.find((function(e){return e.DBColumnID==parseInt(t)})))&&h.Dependantinuse?(u.ReportViewModel_Document(this.CostCenterID,c,parseInt(t),!0,null,null),!s.e.IsEmpty(h.Width)&&parseFloat(h.Width)>0&&(u.RptWidth=parseFloat(h.Width)),!s.e.IsEmpty(h.length)&&parseFloat(h.length)>0&&(u.RptHeight=parseFloat(h.length)),u.DocumentObject=this,i.a.page.HideDialog(),i.a.page.ShowDialog(u,l,{Title:"",HideClose:!0,ShowCenter:!0})):((C=new r).ReportViewModel_Document(this.CostCenterID,c,parseInt(t),!1,null,null),C.DocumentObject=this,i.a.page.HideDialog(),i.a.page.addNewTab({component:l,params:{obj:C}})));case 12:case"end":return e.stop()}}),e,this)})))}},{key:"GetReportFilterXML",value:function(t,e){var a=this,n="";e.strXML="";var i=this.ScreenObject.Data.Tables[15];i.filter((function(e){return e.ReportID==t}));var s,o=!1;i.forEach((function(t){Object(r.j)(t.GroupLevel)&&(o=!0)})),n+="<XML",o&&(n+=' GroupLevel="1"'),n+=" >";for(var c=function(t){s=i[t].ReportField.toString(),n+="<Row ",n+='ColID ="'+s+'" ';for(var e=0;e<a.ScreenObject.StaticFields.length;e++)if(a.ScreenObject.StaticFields[e].DBColumnID==parseInt(i[t].DocumentField.toString()))if(a.ScreenObject.StaticFields[e]instanceof m.d){if(""==a.ScreenObject.StaticFields[e].Text)return{v:(alert(a.ErrorMessage+a.ScreenObject.StaticFields[e].Label+" '"),"Empty Value")};"SNO"==i[t].SysColumnName.toString()?n+='Value ="'+a.ReportDimension.SelectedValue+'" ':n+='Value ="'+a.ScreenObject.StaticFields[e].Text+'" '}else if(a.ScreenObject.StaticFields[e]instanceof C.a){if(""==a.ScreenObject.StaticFields[e].TextBox.Text||""==a.ScreenObject.StaticFields[e].ComboBox.SelectedValue)return{v:(alert(a.ErrorMessage+a.ScreenObject.StaticFields[e].Label+" '"),"Empty Value")};n+='Value ="'+a.ScreenObject.StaticFields[e].ComboBox.SelectedValue+'" '}else if(a.ScreenObject.StaticFields[e]instanceof m.c){if(""==a.ScreenObject.StaticFields[e].Text)return{v:(alert(a.ErrorMessage+a.ScreenObject.StaticFields[e].Label+" '"),"Empty Value")};n+='Value ="'+a.ScreenObject.StaticFields[e].Text+'" '}else if(a.ScreenObject.StaticFields[e]instanceof S.a||a.ScreenObject.StaticFields[e]instanceof S.d||a.ScreenObject.StaticFields[e]instanceof S.c){if(a.ScreenObject.StaticFields[e]instanceof S.a||a.ScreenObject.StaticFields[e]instanceof S.d){if(""==a.ScreenObject.StaticFields[e].Text)return{v:(alert(a.ErrorMessage+a.ScreenObject.StaticFields[e].Label+" '"),"Empty Value")};n+='Value ="'+a.ScreenObject.StaticFields[e].Date.ToString("dd/MMM/yyyy")+'" '}else if(a.ScreenObject.StaticFields[e]instanceof S.c){if(!a.ScreenObject.StaticFields[e].Date)return{v:(alert(a.ErrorMessage+a.ScreenObject.StaticFields[e].Label+" '"),"Empty Value")};n+='Value ="'+a.ScreenObject.StaticFields[e].Date.ToString("dd/MMM/yyyy")+'" '}}else if(a.ScreenObject.StaticFields[e]instanceof l.b){if(""==a.ScreenObject.StaticFields[e].Text)return{v:(alert(a.ErrorMessage+a.ScreenObject.StaticFields[e].Label+" '"),"Empty Value")};n+='Value ="'+a.ScreenObject.StaticFields[e].SelectedValue+'" '}else if(a.ScreenObject.StaticFields[e]instanceof X.a){if(""==a.ScreenObject.StaticFields[e].Text)return{v:(alert(a.ErrorMessage+a.ScreenObject.StaticFields[e].Label+" '"),"Empty Value")};n+='Value ="'+a.ScreenObject.StaticFields[e].SelectedValue+'" '}a.ScreenObject.CustomTab.Pages.forEach((function(e){e.Fields.forEach((function(e){if(null!=e&&(e instanceof m.d||e instanceof C.a||e instanceof m.c||e instanceof S.a||e instanceof S.d||e instanceof S.c||e instanceof l.b||e instanceof X.a)&&e.DBColumnID==parseInt(i[t].DocumentField.toString()))if(e instanceof m.d){if(""==e.Text)return alert(a.ErrorMessage+e.Label+" '"),"Empty Value";n+='Value ="'+e.Text+'" '}else if(e instanceof C.a){if(""==e.TextBox.Text||""==e.ComboBox.SelectedValue)return alert(a.ErrorMessage+e.Label+" '"),"Empty Value";n+='Value ="'+e.TextBox.Text+'" '}else if(e instanceof m.c){if(""==e.Text)return alert(a.ErrorMessage+e.Label+" '"),"Empty Value";n+='Value ="'+e.Text+'" '}else if(e instanceof S.a||e instanceof S.d||e instanceof S.c){if(e||e){if(""==e.Text)return alert(a.ErrorMessage+e.Label+" '"),"Empty Value";n+='Value ="'+e.Date.ToString("dd/MMM/yyyy")+'" '}else if(e instanceof S.c){if(!e.Date)return alert(a.ErrorMessage+e.Label+" '"),"Empty Value";n+='Value ="'+e.Date.ToString("dd/MMM/yyyy")+'" '}}else if(e instanceof l.b){if(""==e.Text&&0==e.SelectedValue)return alert(a.ErrorMessage+e.Label+" '"),"Empty Value";n+='Value ="'+e.SelectedValue+'" '}else if(e instanceof X.a){if(""==e.Text)return alert(a.ErrorMessage+e.Label+" '"),"Empty Value";n+='Value ="'+e.SelectedValue+'" '}}))})),n+=" />"},u=0;u<i.length;u++){var D=c(u);if("object"==typeof D)return D.v}return n+="</XML>",e.strXML=n.toString(),""}},{key:"BeforeRowDeletingEvent",value:function(t){!i.a.SessionManager.Preferences.ContainsKey("VATVersion")&&this.VatNode>0&&null!=this.SelectedRow&&Object.keys(this.SelectedRow).Contains("NodeID")&&this.SelectedRow.NodeID.toString()==this.VatNode.toString()&&(alert("Can't Delete Vat row."),t.CanExecute=!1)}},{key:"ChangeLocation",value:function(t){this.LocationContract.SelectedValue=t,this.Property.CustomWhere="a.LocationID = "+t,this.AddUnitWhere(3),this.Landlord.LocationID=t,this.Accountant.LocationID=t,this.DataTableObj.Clear();for(var e=0;e<this.PayTermsDataTable.length;e++)"1"!=s.e.StringValue(this.PayTermsDataTable[e].IsFromRes)&&(this.PayTermsDataTableObj.removeRow(this.PayTermsDataTable[e]),e--);this.CalculateFooter();for(var a=0;a<6;a++){var n=this.DataTableObj.NewRow();n.Recurr=!1,this.DataTableObj.addRow(n);var i=this.PayTermsDataTableObj.NewRow();this.PayTermsDataTableObj.addRow(i)}this.TotalAmount.Text="0.00",this.NonRecAmount.Text="0.00",this.RecAmount.Text="0.00",this.Unit.SelectedValue=0,this.Property.SelectedValue=0,this.Property.Enable=!0,this.multiVisi=!1,this.StrMultiple="",this.SelectedUnits=""}},{key:"onTabSelectionChanged",value:function(t){null!=this.ScreenObject.CustomTab.SelectedTab&&("Attachments"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.ViewAttachments.OnShowNewAttachment(null),this.SetVisibilityFalse(),this.AttachmentVisibility=!0):"Activities"==this.ScreenObject.CustomTab.SelectedTab.Name&&null!=this.Activities?(this.ScreenObject.CustomTab.ColumnSpan=4,this.Activities.CRMCustomer.Text=this.Tenant.Text,this.Activities.Location.Text=i.a.SessionManager.LocationName,this.Activities.Location.Enable=!1,this.Activities.CRMCustomer.Enable=!1,this.SetVisibilityFalse(),this.ActVisibility=!0):"Notes"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.ViewNotes.OnShowNewNotes(null),this.SetVisibilityFalse(),this.NoteVisibility=!0):(this.AttachmentVisibility=!1,this.NoteVisibility=!1,this.ActVisibility=!1))}},{key:"onFieldsLoad",value:function(t){var e=[];95==t||104==t?((e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Contract"==t.SysTableName&&"PropertyID"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.Property.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Contract"==t.SysTableName&&"UnitID"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.Unit.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Contract"==t.SysTableName&&"TenantID"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.Tenant.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Contract"==t.SysTableName&&"RentAccID"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.RentRecAc.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Contract"==t.SysTableName&&"IncomeAccID"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.IncomeAc.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Contract"==t.SysTableName&&"RefNo"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.RefNo.DBColumnID=parseInt(e[0].CostCenterColID),this.RefNo.Visible=!1),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Contract"==t.SysTableName&&"SNO"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.SlNO.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Contract"==t.SysTableName&&"LocationID"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.LocationContract.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Contract"==t.SysTableName&&"DivisionID"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.DivisionContract.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Contract"==t.SysTableName&&"CurrencyID"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.CurrencyContract.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Contract"==t.SysTableName&&"SalesmanID"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.Salesman.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Contract"==t.SysTableName&&"AccountantID"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.Accountant.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Contract"==t.SysTableName&&"LandlordID"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.Landlord.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Contract"==t.SysTableName&&"Months"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.Months.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Contract"==t.SysTableName&&"TotalDays"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.TotalDays.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Contract"==t.SysTableName&&"RecurDuration"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.RecurDuration.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Contract"==t.SysTableName&&"TotalYears"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.TotalYears.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Contract"==t.SysTableName&&"Purpose"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.Purpose.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Contract"==t.SysTableName&&"Narration"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.Narration.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Contract"==t.SysTableName&&"StartDate"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.StartDate.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Contract"==t.SysTableName&&"EndDate"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.EndDate.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Contract"==t.SysTableName&&"VacancyDate"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.VacancyDate.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].find((function(t){return"REN_Contract"==t.SysTableName&&"ExtendTill"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.ExtndTill.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Contract"==t.SysTableName&&"TerminationDate"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.TerminateDate.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Contract"==t.SysTableName&&"ContractDate"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.ContractDate.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Contract"==t.SysTableName&&"StatusID"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.StatusID.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Contract"==t.SysTableName&&"ContractNumber"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.ContractNumber.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Contract"==t.SysTableName&&"TermsConditions"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.TermsConditions.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Contract"==t.SysTableName&&"BasedOn"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.BasedOn.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Contract"==t.SysTableName&&"RentAmt"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.RentAmt.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Contract"==t.SysTableName&&"NoOfUnits"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.NoOfUnits.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Contract"==t.SysTableName&&"AgeOfRenewal"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.AgeOfRenewal.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Contract"==t.SysTableName&&"ExpectedEndDate"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.ExpectedEndDate.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Contract"==t.SysTableName&&"GracePeriod"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.GracePeriod.DBColumnID=parseInt(e[0].CostCenterColID))):((e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Quotation"==t.SysTableName&&"PropertyID"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.Property.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Quotation"==t.SysTableName&&"UnitID"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.Unit.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Quotation"==t.SysTableName&&"TenantID"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.Tenant.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Quotation"==t.SysTableName&&"Narration"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.Narration.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Quotation"==t.SysTableName&&"StatusID"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.StatusID.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Quotation"==t.SysTableName&&"Date"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.ContractDate.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Quotation"==t.SysTableName&&"RentAccID"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.RentRecAc.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Quotation"==t.SysTableName&&"IncomeAccID"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.IncomeAc.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Quotation"==t.SysTableName&&"Purpose"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.Purpose.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Quotation"==t.SysTableName&&"StartDate"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.StartDate.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Quotation"==t.SysTableName&&"EndDate"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.EndDate.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Quotation"==t.SysTableName&&"SNO"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.SlNO.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Quotation"==t.SysTableName&&"LocationID"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.LocationContract.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Quotation"==t.SysTableName&&"DivisionID"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.DivisionContract.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Quotation"==t.SysTableName&&"CurrencyID"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.CurrencyContract.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Quotation"==t.SysTableName&&"SalesmanID"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.Salesman.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Quotation"==t.SysTableName&&"AccountantID"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.Accountant.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Quotation"==t.SysTableName&&"LandlordID"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.Landlord.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Quotation"==t.SysTableName&&"Months"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.Months.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Quotation"==t.SysTableName&&"TotalDays"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.TotalDays.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Quotation"==t.SysTableName&&"RecurDuration"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.RecurDuration.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Quotation"==t.SysTableName&&"TotalYears"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.TotalYears.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Quotation"==t.SysTableName&&"Number"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.ContractNumber.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Quotation"==t.SysTableName&&"TermsConditions"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.TermsConditions.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Quotation"==t.SysTableName&&"ExtendTill"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.ExtndTill.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Quotation"==t.SysTableName&&"NoOfUnits"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.NoOfUnits.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Quotation"==t.SysTableName&&"ExpectedEndDate"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.ExpectedEndDate.DBColumnID=parseInt(e[0].CostCenterColID)),(e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Quotation"==t.SysTableName&&"GracePeriod"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.GracePeriod.DBColumnID=parseInt(e[0].CostCenterColID)),129==t&&((e=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Quotation"==t.SysTableName&&"VacancyDate"==t.SysColumnName}))).length>0&&parseInt(e[0].CostCenterColID)>0&&(this.VacancyDate.DBColumnID=parseInt(e[0].CostCenterColID)),this.IsExtended.Visible=!1,this.BasedOn.Visible=!1,this.RentAmt.Visible=!1,this.RefNo.Visible=!1,this.RecurDuration.Visible=!1,this.TerminateDate.Visible=!1),this.ExpectedEndDate.Visible=!1,this.GracePeriod.Visible=!1)}},{key:"ContractPrefix",value:function(t){if(Logger.InfoLog("AddEditRenContractViewModel ::Entering ContractPrefix"),null!=t&&"lostFocus"==t.toString()){if(this.cntrct.ContractPrefix=this.ContractNumber.ComboBox.SelectedValue,""!=this.ContractNumber.TextBox.Text&&(this.cntrct.ContractNumber=parseInt(this.ContractNumber.TextBox.Text)),this.ContractID=0,95!=this.CurrCostCenterID&&104!=this.CurrCostCenterID){var e=i.a.rental.GetQuotationID(this.cntrct.ContractPrefix,this.cntrct.ContractNumber);if(null!=e&&e.Tables.length>0&&e.Tables[0].length>0&&e.Columns[0].Contains("QuotationID")&&!s.e.IsEmpty(e.Tables[0][0].QuotationID)&&(this.ContractID=parseInt(e.Tables[0][0].QuotationID.toString())),this.ContractID>0)this.LoadEditData(null),this.CheckViewForUser(this.cntrct.ContractID);else{this.SaveAndPrintContactID=0,this.RenewRefID=0,this.DataTableObj.Clear(),this.PayTermsDataTableObj.Clear(),this.CalculateFooter(),this.TotalYears.Text="",this.Months.Text="",this.NonRecAmount.Text="0.00",this.RecAmount.Text="0.00",this.TotalAmount.Text="0.00",this.StartDate.Date=null,this.EndDate.Date=null,this.ViewNotes.NotesListObj.Clear(),this.ViewNotes.DeletedNotes.Clear(),this.ViewAttachments.AttachmentsListObj.Clear(),this.ViewAttachments.OnShowNewAttachment(null),this.ViewAttachments.DeletedAttachments.Clear(),null!=this.ViewActivities&&this.ViewActivities.ActivityGridData.Clear(),this.ClearData();for(var a=0;a<6;a++){var n=this.DataTableObj.NewRow();n.Recurr=!1,this.DataTableObj.addRow(n);var r=this.PayTermsDataTableObj.NewRow();this.PayTermsDataTableObj.addRow(r)}this.PayTermsDataTableObj.UpdateTotals(),this.DataTableObj.UpdateTotals(),Logger.InfoLog("AddEditRenContractViewModel :: Exiting OnSaveContract")}}else this.LoadEditData(null),this.CheckViewForUser(this.cntrct.ContractID);this.PropID=this.Property.SelectedValue,this.UnitTempID=this.Unit.SelectedValue,this.FlagPrefixChange=!0}Logger.InfoLog("AddEditRenContractViewModel ::Exiting ContractPrefix")}},{key:"OnContractPrefixChanged",value:function(t){var e=this;if(Logger.InfoLog("AddEditRenContractViewModel ::Entering OnContractPrefixChanged"),!this.FlagPrefixChange)if(this.ScreenObject.Data.Tables.length>13&&this.ScreenObject.Data.Tables[13].length>0){var a;0!=this.Property.SelectedValue?a=this.ScreenObject.Data.Tables[13].find((function(t){return t.CONTRACTPREFIX==e.Property.SelectedValue.toString()})):null==t||s.e.IsEmpty(t)||"lostFocus"==t.toString()||(a=this.ScreenObject.Data.Tables[13].find((function(e){return e.CONTRACTPREFIX==t.ComboBox.GetselectedItem().Value}))),null!=t&&(this.ContractNumber.TextBox.Text=Object(N.isNullOrUndefined)(a)||null==a.ContractNumber||s.e.IsEmpty(a.ContractNumber)?"1":a.ContractNumber.toString())}else null!=t&&(this.ContractNumber.TextBox.Text="1");Logger.InfoLog("AddEditRenContractViewModel ::Exiting OnContractPrefixChanged")}},{key:"GetData",value:function(t){if(Logger.InfoLog("AddEditRenContractViewModel ::Entering GetData"),""!=this.ContractNumber.TextBox.Text){var e=0;if(null!=this.ContractNumber.ComboBox.SelectedItem&&""!=this.ContractNumber.ComboBox.SelectedItem.Aliasname&&(e=parseInt(this.ContractNumber.ComboBox.SelectedItem.Aliasname)),"NEXT"==t.toString().toUpperCase()){for(var a=(parseInt(this.ContractNumber.TextBox.Text)+1).toString();a.length<e;)a="0"+a;this.ContractNumber.TextBox.Text=a,this.ContractPrefix("lostFocus")}else if(parseInt(this.ContractNumber.TextBox.Text)>1){for(var n=(parseInt(this.ContractNumber.TextBox.Text)-1).toString();n.length<e;)n="0"+n;this.ContractNumber.TextBox.Text=n,this.ContractPrefix("lostFocus")}}Logger.InfoLog("AddEditRenContractViewModel ::Extiing GetData")}},{key:"OnBeginEdit",value:function(t){try{var e=t.args.item;if(s.e.IsEmpty(t.args.item.IsFreezed)||"1"!=e.IsFreezed.toString()&&"True"!=e.IsFreezed.toString()||(t.Cancel=!0),22==t.args.cell)s.e.IsEmpty(t.args.item.DocumentType)||"369"!=e.DocStatusID.toString()&&"429"!=e.DocStatusID.toString()||(104==this.CurrCostCenterID&&"14"==e.DocumentType.toString()?t.Cancel=!0:"19"!=e.DocumentType.toString()&&"16"!=e.DocumentType.toString()||(t.Cancel=!0));else if(!s.e.IsEmpty(t.args.item.Amount)&&104!=this.CurrCostCenterID&&0==this.Unit.SelectedValue&&""==this.SelectedUnits)return void alert(i.a.GetResource("PleaseselectUnit"))}catch(a){Logger.ErrorLog("AddEditRenContractViewModel::OnBeginEdit Error message"+a)}}},{key:"ClearData",value:function(){var t=this;this.Vattype=0;var e=this.GetButton("ViewHistory");null!=e&&(e.Visible=!1),this.SetButtonVisibility("ViewHistory",!1),this.WFDocLevelList.Clear(),this.cntrct.Wid=0,this.cntrct.ContractID=0,this.Property.SelectedValue=0,this.Property.SelectedValueText="",this.Unit.SelectedValue=0,this.AddUnitWhere(4),this.Tenant.SelectedValue=0,this.FilterTenantBasedOnUnit&&(this.Tenant.CustomWhere=""),this.NoofCheques=0,this.FirstNumber="0",this.InstPeriod=0,this.PayeeBnk="",this.DebitAcc=0,this.TotalDays.Text="",this.TotalAmount.Text="",this.NonRecAmount.Text="",this.GracePeriod.Text="",this.RecAmount.Text="",this.Property.Enable=!0,this.multiVisi=!1,this.StrMultiple="",this.SelectedUnits="",this.cntrct.multiName="",this.cntrct.MultiIDS="",this.ScreenObject.CustomTab.Pages.forEach((function(e){e.Fields.forEach((function(e){e instanceof o.c&&t.ScreenObject.SetProperty_DefaultValue(e)}))})),this.IncomeAc.SelectedValue=0,this.IncomeAc.SelectedValueText="",this.RentRecAc.SelectedValue=0,this.RentRecAc.SelectedValueText="",this.Landlord.SelectedValueText="",this.Landlord.SelectedValue=0,this.Salesman.SelectedValueText="",this.Salesman.SelectedValue=0,this.Unit.SelectedValueText="",this.Unit.SelectedValue=0,this.Accountant.SelectedValueText="",this.Accountant.SelectedValue=0,this.CntStatus="[New]",this.RefershTitle(),this.CheckViewForUser(this.cntrct.ContractID),this.DataTableObj.Clear(),this.PayTermsDataTableObj.Clear(),this.DataTableObj.UpdateTotals(),this.PayTermsDataTableObj.UpdateTotals()}},{key:"DraftVisible",value:function(t){var e=this.GetButton("Draft");null!=e&&(e.Visible=t),this.SetButtonVisibility("SaveDraft",t),null!=(e=this.GetButton("LoadDraft"))&&(e.Visible=t),this.SetButtonVisibility("LoadDraft",t)}},{key:"LoadEditData",value:function(t){var e=this;Logger.InfoLog("AddEditRenContractViewModel ::Entering GetData");try{!function(){var a=!1;e.draftid=0,e.ClearData(),e.DraftVisible(!1),e.strRenew="Edit";var n=t;if(null==n&&(n=95==e.CurrCostCenterID||104==e.CurrCostCenterID?i.a.rental.GetContractDetails(e.ContractID,e.CurrCostCenterID,s.e.StringValue(e.cntrct.ContractPrefix),e.cntrct.ContractNumber):i.a.rental.GetQuotationDetails(e.ContractID)),n.Tables.length>0&&n.Tables[0].length>0){n.Columns[0].Contains("Status")&&(e.CntStatus=s.e.StringValue(n.Tables[0][0].Status)),n.Columns[0].Contains("RenewRefID")&&!s.e.IsEmpty(n.Tables[0][0].RenewRefID)&&parseInt(n.Tables[0][0].RenewRefID.toString())>0&&(e.RenewRefID=parseInt(n.Tables[0][0].RenewRefID.toString())),n.Columns[0].Contains("IsOpening")&&!s.e.IsEmpty(n.Tables[0][0].IsOpening)&&(e.IsOpening=Object(r.j)(n.Tables[0][0].IsOpening.toString())),n.Columns[0].Contains("ParentContractID")&&!s.e.IsEmpty(n.Tables[0][0].ParentContractID)&&parseInt(n.Tables[0][0].ParentContractID.toString())>0?e.ParentContractID=parseInt(n.Tables[0][0].ParentContractID.toString()):(e.ParentContractID=0,e.RefNo.Visible=!1),n.Columns[0].Contains("Refno")&&!s.e.IsEmpty(n.Tables[0][0].Refno)&&(e.RefNo.Text=n.Tables[0][0].Refno.toString()),e.RefNo.Enable=!1;var o=e.GetButton("Subcontract");if(null!=o&&(o.Visible=!(e.ParentContractID>0)&&i.a.SessionManager.IsActionAssigned(e.CurrCostCenterID,"SubContract"),e.SetButtonVisibility("AddContract",o.Visible)),n.Columns[0].Contains("isContractRenewed")&&!s.e.IsEmpty(n.Tables[0][0].isContractRenewed)&&Object(r.j)(n.Tables[0][0].isContractRenewed.toString())&&(a=Object(r.j)(n.Tables[0][0].isContractRenewed.toString())),n.Columns[0].Contains("IsRecurPosted")&&!s.e.IsEmpty(n.Tables[0][0].IsRecurPosted)&&Object(r.j)(n.Tables[0][0].IsRecurPosted.toString())&&(e.IsRecurPosted=Object(r.j)(n.Tables[0][0].IsRecurPosted.toString())),e.IsRecurPosted&&(e.ParticularsBodyReadOnly=e.IsRecurPosted),n.Columns[0].Contains("QuotationID")&&!s.e.IsEmpty(n.Tables[0][0].QuotationID)?(e.LinkedQuotationID=parseInt(n.Tables[0][0].QuotationID.toString()),e.LinkedQuotationID>0&&(null!=(o=e.GetButton("Quotation"))&&(n.Columns[0].Contains("QuotationCCID")&&!s.e.IsEmpty(n.Tables[0][0].QuotationCCID.toString())&&("103"==n.Tables[0][0].QuotationCCID.toString()?o.Label="Quotation":"129"==n.Tables[0][0].QuotationCCID.toString()&&(o.Label="Reservation")),o.Visible=!0,e.SetButtonVisibility("ViewQuotation",!0)))):e.LinkedQuotationID=0,e.ContractExists=!(129!=e.CurrCostCenterID&&103!=e.CurrCostCenterID||!n.Columns[0].Contains("ContractExists")||s.e.IsEmpty(n.Tables[0][0].ContractExists))&&Object(r.j)(n.Tables[0][0].ContractExists.toString()),e.cntrct.GUID=s.e.StringValue(n.Tables[0][0].GUID),s.e.IsEmpty(n.Tables[0][0].ContractID)?(e.cntrct.ContractID=0,e.ContractID=0):(e.cntrct.ContractID=parseInt(n.Tables[0][0].ContractID),e.ContractID=parseInt(n.Tables[0][0].ContractID)),null!=(o=e.GetButton("Generate"))&&e.ContractID>0&&(103==e.CurrCostCenterID||129==e.CurrCostCenterID)&&!e.ContractExists&&(o.Visible=!0),e.SetButtonVisibility("GenerateLink",o.Visible),e.ContractNumber.ComboBox.SelectedValue=s.e.StringValue(n.Tables[0][0].ContractPrefix),e.ContractNumber.TextBox.Text=s.e.StringValue(n.Tables[0][0].ContractNumber),e.ContractDate.Date=new Date(n.Tables[0][0].ContractDate),e.ContractNumber.ComboBox.Enable=!1,e.ContractNumber.TextBox.Enable=!1,e.ContractNumber.Enable=!1,e.ContractNumber.Enable=!1,e.StatusID.SelectedValue=s.e.StringValue(n.Tables[0][0].StatusID),e.BasedOn.SelectedValue=s.e.StringValue(n.Tables[0][0].BasedOn),n.Columns[0].Contains("RentAmt")&&(e.RentAmt.Text=s.e.StringValue(n.Tables[0][0].RentAmt)),n.Columns[0].Contains("RecurDuration")&&!s.e.IsEmpty(n.Tables[0][0].RecurDuration)&&(e.RecurDuration.Text=n.Tables[0][0].RecurDuration.toString()),n.Columns[0].Contains("SNO")&&(e.SlNO.Text=s.e.StringValue(n.Tables[0][0].SNO)),e.RefershTitle(),e.ContractID>0&&(e.ButtonRenew.Enable=!0,e.ButtonTerminate.Enable=!0,e.SetButtonVisibility("Renew",!0),e.SetButtonVisibility("Terminat",!0),"428"==e.StatusID.SelectedValue||"465"==e.StatusID.SelectedValue||"477"==e.StatusID.SelectedValue||"478"==e.StatusID.SelectedValue||"479"==e.StatusID.SelectedValue||"481"==e.StatusID.SelectedValue?(e.ButtonSave.Enable=!1,e.ButtonSaveAndPrint.Enable=!1,e.ButtonRenew.Enable=!1,e.ButtonTerminate.Enable=!1,e.BtnApprove.Visible=!1,e.ButtonCancelTerminate.Visible=!0,e.ButtonRefund.Visible=!1,e.ButtonVacant.Visible=!1,e.ButtonSuspend.Visible=!0,e.BtnFullRefund.Visible=!1,e.SetButtonEnable("Save",!1),e.SetButtonEnable("SaveAndPrint",!1),e.SetButtonEnable("Renew",!1),e.SetButtonEnable("Terminat",!1),e.SetButtonVisibility("RejectVisiblity",!1),e.SetButtonVisibility("Terminat",!0),e.SetButtonVisibility("CancelTerminate",!0),e.SetButtonVisibility("RefundVisiblity",!1),e.SetButtonVisibility("Vacant",!1),e.SetButtonVisibility("Suspend",!0),e.SetButtonVisibility("Fullrefund",!1),i.a.SessionManager.HideUnathorizedAccess?e.ButtonSuspend.Visible=i.a.SessionManager.IsActionAssigned(e.CurrCostCenterID,"Suspend"):e.ButtonSuspend.Enable=i.a.SessionManager.IsActionAssigned(e.CurrCostCenterID,"Suspend"),i.a.SessionManager.HideUnathorizedAccess?e.ButtonCancelTerminate.Visible=i.a.SessionManager.IsActionAssigned(e.CurrCostCenterID,"CancelTerminate"):(e.ButtonCancelTerminate.Enable=i.a.SessionManager.IsActionAssigned(e.CurrCostCenterID,"CancelTerminate"),e.TerminateDate.Visible=!0),"465"!=e.StatusID.SelectedValue||""!=n.Tables[0][0].WorkFlowID.toString()&&parseInt(n.Tables[0][0].WorkFlowID.toString())>0&&"1"==n.Tables[0][0].wfaction.toString()||(e.BtnApprove.Visible=!i.a.SessionManager.IsActionAssigned(e.CurrCostCenterID,"UnApproveOnTerminate"),e.BtnApprove.Label="Approve Termination"),e.ButtonCancelTerminate.Label="477"==e.StatusID.SelectedValue?"Cancel Full Refund":"CancelTerminate"):"451"==e.StatusID.SelectedValue?(i.a.SessionManager.IsActionAssigned(e.CurrCostCenterID,"Resave cancelled contract")?(e.ButtonSave.Visible=e.ButtonSave.Enable=!0,e.ButtonSave.Visible=e.ButtonSaveAndPrint.Enable=!0,e.SetButtonVisibility("Save",!0),e.SetButtonVisibility("SaveAndPrint",!0)):(e.ButtonSave.Enable=!1,e.ButtonSaveAndPrint.Enable=!1,e.SetButtonEnable("Save",!1),e.SetButtonEnable("SaveAndPrint",!1)),e.ButtonRenew.Enable=!1,e.ButtonTerminate.Enable=!1,e.BtnApprove.Visible=!1,e.ButtonCancelTerminate.Visible=!1,e.ButtonRefund.Visible=!1,e.BtnFullRefund.Visible=!1,e.ButtonVacant.Visible=!1,e.ButtonSuspend.Visible=!1,e.SetButtonVisibility("Renew",!1),e.SetButtonVisibility("Terminate",!1),e.SetButtonVisibility("RejectVisiblity",!1),e.SetButtonVisibility("CancelTerminate",!1),e.SetButtonVisibility("RefundVisiblity",!1),e.SetButtonVisibility("Vacant",!1),e.SetButtonVisibility("Suspend",!1),e.SetButtonVisibility("Fullrefund",!1)):"450"==e.StatusID.SelectedValue||"480"==e.StatusID.SelectedValue?(e.ButtonSave.Enable=!1,e.ButtonSaveAndPrint.Enable=!1,e.ButtonRenew.Enable=!1,e.ButtonTerminate.Enable=!1,e.BtnApprove.Visible=!1,e.ButtonRefund.Visible=!1,e.ButtonVacant.Visible=!1,e.ButtonSuspend.Visible=!1,e.ButtonCancelTerminate.Visible=!0,e.ButtonCancelTerminate.Label="480"==e.StatusID.SelectedValue?"Cancel Close":"Cancel Refund",e.VacancyDate.Visible=!0,e.BtnFullRefund.Visible=!1,e.SetButtonVisibility("RejectVisiblity",!1),e.SetButtonVisibility("RefundVisiblity",!1),e.SetButtonVisibility("Terminate",!1),e.SetButtonVisibility("Vacant",!1),e.SetButtonVisibility("Suspend.",!1),e.SetButtonVisibility("CancelTerminate",!0),e.SetButtonVisibility("Fullrefund.",!1)):"471"==e.StatusID.SelectedValue?(e.ButtonSave.Enable=!1,e.ButtonSaveAndPrint.Enable=!1,e.BtnApprove.Visible=!1,e.ButtonVacant.Visible=!1,e.ButtonSuspend.Visible=!1,e.ButtonCancelTerminate.Visible=!0,e.ButtonCancelTerminate.Label="Cancel Close",e.SetButtonVisibility("RejectVisiblity",!1),e.SetButtonVisibility("Vacant",!1),e.SetButtonVisibility("Suspend.",!1),e.SetButtonVisibility("CancelTerminate",!0)):(e.ButtonSave.Enable=!0,e.ButtonSaveAndPrint.Enable=!0,e.ButtonTerminate.Enable=!0,e.BtnApprove.Visible=!1,e.BtnFullRefund.Visible=!0,e.ButtonRefund.Visible=!0,e.ButtonVacant.Visible=!0,e.ButtonSuspend.Visible=!0,e.SetButtonVisibility("RejectVisiblity",!1),e.SetButtonVisibility("Terminate",!0),e.SetButtonVisibility("RefundVisiblity",!0),e.SetButtonVisibility("Vacant",!0),e.SetButtonVisibility("Suspend.",!0),i.a.SessionManager.HideUnathorizedAccess?e.ButtonRenew.Visible=i.a.SessionManager.IsActionAssigned(e.CurrCostCenterID,"Renew"):e.ButtonRenew.Enable=i.a.SessionManager.IsActionAssigned(e.CurrCostCenterID,"Renew"),i.a.SessionManager.HideUnathorizedAccess?e.ButtonRefund.Visible=i.a.SessionManager.IsActionAssigned(e.CurrCostCenterID,"Refund"):e.ButtonRefund.Enable=i.a.SessionManager.IsActionAssigned(e.CurrCostCenterID,"Refund"),i.a.SessionManager.HideUnathorizedAccess?e.BtnFullRefund.Visible=i.a.SessionManager.IsActionAssigned(e.CurrCostCenterID,"Full Refund"):e.BtnFullRefund.Enable=i.a.SessionManager.IsActionAssigned(e.CurrCostCenterID,"Full Refund"),i.a.SessionManager.HideUnathorizedAccess?e.ButtonVacant.Visible=i.a.SessionManager.IsActionAssigned(e.CurrCostCenterID,"Close"):e.ButtonVacant.Enable=i.a.SessionManager.IsActionAssigned(e.CurrCostCenterID,"Close"),i.a.SessionManager.HideUnathorizedAccess?e.ButtonSuspend.Visible=i.a.SessionManager.IsActionAssigned(e.CurrCostCenterID,"Suspend"):e.ButtonSuspend.Enable=i.a.SessionManager.IsActionAssigned(e.CurrCostCenterID,"Suspend")),a&&(e.ButtonSuspend.Enable=!1,e.ButtonRefund.Enable=!1,e.ButtonVacant.Enable=!1,e.ButtonRenew.Enable=!1,e.ButtonTerminate.Enable=!1,e.BtnFullRefund.Enable=!1,e.SetButtonVisibility("Terminate",!1),e.SetButtonVisibility("Renew",!1),e.SetButtonVisibility("RefundVisiblity",!1),e.SetButtonVisibility("Vacant",!1),e.SetButtonVisibility("Suspend.",!1),e.SetButtonVisibility("Fullrefund.",!1))),e.IsExtended.Enable&&95==e.CurrCostCenterID&&"427"==e.StatusID.SelectedValue&&n.Columns[0].Contains("IsExtended")?(e.IsExtended.Visible=!0,e.IsExtended.SelectedValue=!s.e.IsEmpty(n.Tables[0][0].IsExtended)&&"true"==n.Tables[0][0].IsExtended.toString().toLowerCase()||"1"==n.Tables[0][0].IsExtended.toString()?"True":"false"):e.IsExtended.Visible=!1,e.LocationContract.SelectedValue=n.Columns[0].Contains("LocationID")&&!s.e.IsEmpty(n.Tables[0][0].LocationID)&&null!=n.Tables[0][0].LocationID?parseInt(n.Tables[0][0].LocationID):0,e.DivisionContract.SelectedValue=n.Columns[0].Contains("DivisionID")&&!s.e.IsEmpty(n.Tables[0][0].DivisionID)&&null!=n.Tables[0][0].DivisionID?parseInt(n.Tables[0][0].DivisionID):0,e.CurrencyContract.SelectedValue=n.Columns[0].Contains("CurrencyID")&&!s.e.IsEmpty(n.Tables[0][0].CurrencyID)&&null!=n.Tables[0][0].CurrencyID?parseInt(n.Tables[0][0].CurrencyID):0,e.Property.SelectedValue=e.Property.PreviousSelectedValue=e.PropID=s.e.IsEmpty(n.Tables[0][0].PropertyID)||null==n.Tables[0][0].PropertyID?0:parseInt(n.Tables[0][0].PropertyID),e.Unit.SelectedValue=e.Unit.PreviousSelectedValue=e.UnitTempID=s.e.IsEmpty(n.Tables[0][0].UnitID)||null==n.Tables[0][0].UnitID?0:parseInt(n.Tables[0][0].UnitID),e.AddUnitWhere(5),e.Tenant.SelectedValue=e.Tenant.PreviousSelectedValue=e.TenantTempID=s.e.IsEmpty(n.Tables[0][0].TenantID)||null==n.Tables[0][0].TenantID?0:parseInt(n.Tables[0][0].TenantID),e.RentRecAc.SelectedValue=s.e.IsEmpty(n.Tables[0][0].RentAccID)||null==n.Tables[0][0].RentAccID?0:parseInt(n.Tables[0][0].RentAccID),e.IncomeAc.SelectedValue=s.e.IsEmpty(n.Tables[0][0].IncomeAccID)||null==n.Tables[0][0].IncomeAccID?0:parseInt(n.Tables[0][0].IncomeAccID),s.e.IsEmpty(n.Tables[0][0].StartDate)||(e.StartDate.Date=new Date(n.Tables[0][0].StartDate)),s.e.IsEmpty(n.Tables[0][0].EndDate)||(e.EndDate.Date=new Date(n.Tables[0][0].EndDate)),n.Columns[0].Contains("VacancyDate")&&!s.e.IsEmpty(n.Tables[0][0].VacancyDate)&&(e.VacancyDate.Date=new Date(n.Tables[0][0].VacancyDate)),!n.Columns[0].Contains("ExtndTill")||s.e.IsEmpty(n.Tables[0][0].ExtndTill)||s.e.IsEmpty(n.Tables[0][0].ExtndTill)||(e.ExtndTill.Date=new Date(n.Tables[0][0].ExtndTill)),n.Columns[0].Contains("TerminationDate")&&""!=s.e.StringValue(n.Tables[0][0].TerminationDate)&&(e.TerminateDate.Date=new Date(n.Tables[0][0].TerminationDate)),n.Columns[0].Contains("ExpectedEndDate")&&""!=s.e.StringValue(n.Tables[0][0].ExpectedEndDate)&&(e.EnableGracePeriod?(e.EndDate.Date=new Date(n.Tables[0][0].ExpectedEndDate),e.ExpectedEndDate.Date=new Date(n.Tables[0][0].EndDate)):e.ExpectedEndDate.Date=new Date(n.Tables[0][0].ExpectedEndDate)),e.Purpose.Text=s.e.StringValue(n.Tables[0][0].Purpose),e.Narration.Text=s.e.StringValue(n.Tables[0][0].Narration),e.TotalAmount.Text=s.e.IsEmpty(n.Tables[0][0].TotalAmount)||s.e.IsEmpty(n.Tables[0][0].TotalAmount)?"0.00":parseFloat(n.Tables[0][0].TotalAmount).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),e.GracePeriod.Text=n.Columns[0].Contains("GracePeriod")?s.e.StringValue(n.Tables[0][0].GracePeriod):"0",e.NonRecAmount.Text=null==n.Tables[0][0].NonRecurAmount||s.e.IsEmpty(n.Tables[0][0].NonRecurAmount)?"0.00":parseFloat(n.Tables[0][0].NonRecurAmount).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),e.RecAmount.Text=null==n.Tables[0][0].RecurAmount||s.e.IsEmpty(n.Tables[0][0].RecurAmount)?"0.00":parseFloat(n.Tables[0][0].RecurAmount).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),e.TotalDays.Text=e.StartDate.Date?(e.EndDate.Date.Subtract(e.StartDate.Date).Days+1).toString():(e.EndDate.Date.Subtract(new Date).Days+1).toString(),""!=e.TotalDays.Text&&e.CalcMonthandYear(),null==n.Tables[0][0].TermsConditions||s.e.IsEmpty(n.Tables[0][0].TermsConditions)||(e.TermsConditions.Text=n.Tables[0][0].TermsConditions.toString()),!n.Columns[0].Contains("SalesmanID")||s.e.IsEmpty(n.Tables[0][0].SalesmanID)||s.e.IsEmpty(n.Tables[0][0].SalesmanID)||(e.Salesman.SelectedValue=parseInt(n.Tables[0][0].SalesmanID)),n.Columns[0].Contains("AccountantID")&&!s.e.IsEmpty(n.Tables[0][0].AccountantID)&&null!=n.Tables[0][0].AccountantID&&(e.Accountant.SelectedValue=parseInt(n.Tables[0][0].AccountantID)),n.Columns[0].Contains("LandlordID")&&!s.e.IsEmpty(n.Tables[0][0].LandlordID)&&null!=n.Tables[0][0].LandlordID&&(e.Landlord.SelectedValue=parseInt(n.Tables[0][0].LandlordID)),n.Columns[0].Contains("NoOfUnits")&&!s.e.IsEmpty(n.Tables[0][0].NoOfUnits)&&null!=n.Tables[0][0].NoOfUnits&&(e.NoOfUnits.Text=n.Tables[0][0].NoOfUnits.toString()),n.Columns[0].Contains("AgeOfRenewal")&&!s.e.IsEmpty(n.Tables[0][0].AgeOfRenewal)&&null!=n.Tables[0][0].AgeOfRenewal&&(e.AgeOfRenewal.Text=n.Tables[0][0].AgeOfRenewal.toString()),n.Tables.length>1&&n.Tables[1].length>0){n.Columns[4].Contains("ccnid70")&&!s.e.IsEmpty(n.Tables[4][0].ccnid70)&&parseInt(n.Tables[4][0].ccnid70.toString())&&(e.Vattype=parseInt(n.Tables[4][0].ccnid70.toString()));for(var c=!1,u=function(t){var a,o=e.DataTableObj.NewRow();o.Recurr=!1,n.Tables[1][t].CCNodeID.toString()==e.id2.toString()&&t>0&&!c?e.DataTableObj.insertRowAt(o,0):e.DataTableObj.updateRow(o),n.Tables[1][t].CCNodeID.toString()==e.id2.toString()&&(c=!0),o.Recurr=!(!n.Columns[1].Contains("IsRecurr")||s.e.IsEmpty(n.Tables[1][t].IsRecurr))&&Object(r.j)(n.Tables[1][t].IsRecurr),o.NodeID=s.e.StringValue(n.Tables[1][t].CCNodeID);var l=(_toArray(a=e.ScreenObject.Data.Tables[10].filter((function(e){return e.NodeID==n.Tables[1][t].CCNodeID.toString()}))),a);l.length>0&&(o.Particulars=s.e.StringValue(l[0].Particulars)),o.CreditAccountID=s.e.StringValue(n.Tables[1][t].CREDITNAME);var u=0;(u=parseInt(s.e.StringValue(n.Tables[1][t].PayeeBank)))>=0&&(o.PayeeBank=u.toString()),s.e.IsEmpty(n.Tables[1][t].CreditAccID)||(o.CreditAccountID_Key=n.Tables[1][t].CreditAccID.toString()),o.DebitAccountID=s.e.StringValue(n.Tables[1][t].DEBITNAME),s.e.IsEmpty(n.Tables[1][t].DebitAccID)||(o.DebitAccountID_Key=s.e.StringValue(n.Tables[1][t].DebitAccID)),n.Columns[1].Contains("AdvanceAccountID")&&!s.e.IsEmpty(n.Tables[1][t].AdvanceAccountID)&&parseInt(n.Tables[1][t].AdvanceAccountID.toString())>0&&(o.AdvanceAcc=s.e.StringValue(n.Tables[1][t].AdvanceAccountID)),n.Columns[1].Contains("BankAccountID")&&!s.e.IsEmpty(n.Tables[1][t].BankAccountID)&&parseInt(n.Tables[1][t].BankAccountID.toString())>0&&(o.BankAccountID=n.Tables[1][t].BankAccountID.toString()),n.Columns[1].Contains("VatPer")&&!s.e.IsEmpty(n.Tables[1][t].VatPer)&&parseFloat(n.Tables[1][t].VatPer.toString())>0&&(o.VatPer=s.e.StringValue(n.Tables[1][t].VatPer)),n.Columns[1].Contains("VatAmount")&&!s.e.IsEmpty(n.Tables[1][t].VatAmount)&&parseFloat(n.Tables[1][t].VatAmount.toString())>0&&(o.VatAmount=s.e.StringValue(n.Tables[1][t].VatAmount)),n.Columns[1].Contains("TaxCategoryID")&&!s.e.IsEmpty(n.Tables[1][t].TaxCategoryID)&&(o.TaxCategory_Key=s.e.StringValue(n.Tables[1][t].TaxCategoryID),n.Columns[1].Contains("TaxCategory")&&(o.TaxCategory=s.e.StringValue(n.Tables[1][t].TaxCategory))),e.DataTableColumns.Contains("SPType_Key")&&n.Columns[1].Contains("SPType")&&!s.e.IsEmpty(n.Tables[1][t].SPType)&&(o.SPType_Key=s.e.StringValue(n.Tables[1][t].SPType),n.Columns[1].Contains("SPTypeName")&&(o.SPType=s.e.StringValue(n.Tables[1][t].SPTypeName))),e.DataTableColumns.Contains("Dim_Key")&&n.Columns[1].Contains("Dimname")&&!s.e.IsEmpty(n.Tables[1][t].DimNodeID)&&(o.Dim_Key=s.e.StringValue(n.Tables[1][t].DimNodeID),o.Dim=s.e.StringValue(n.Tables[1][t].Dimname)),e.DataTableColumns.Contains("SalesMan_Key")&&n.Columns[1].Contains("SalesManname")&&!s.e.IsEmpty(n.Tables[1][t].SalesManID)&&(o.SalesMan_Key=n.Tables[1][t].SalesManID.toString(),o.SalesMan=n.Tables[1][t].SalesManname.toString()),n.Columns[1].Contains("LocationID")&&!s.e.IsEmpty(n.Tables[1][t].LocationID)&&e.DataTableColumns.Contains("Location")&&(o.Location_Key=s.e.StringValue(n.Tables[1][t].LocationID),o.Location=s.e.StringValue(n.Tables[1][t].locname)),o.VatType=s.e.StringValue(n.Tables[1][t].VatType),n.Columns[1].Contains("TaxableAmt")&&!s.e.IsEmpty(n.Tables[1][t].TaxableAmt)&&parseFloat(n.Tables[1][t].TaxableAmt.toString())>0&&(o.TaxableAmt=s.e.StringValue(n.Tables[1][t].TaxableAmt)),n.Columns[1].Contains("RecurInvoice")&&(o.RecurInvoice=s.e.StringValue(n.Tables[1][t].RecurInvoice)),n.Columns[1].Contains("PostDebit")&&(o.PostDebit=s.e.StringValue(n.Tables[1][t].PostDebit)),n.Columns[1].Contains("TasjeelAmount")&&!s.e.IsEmpty(n.Tables[1][t].TasjeelAmount)&&(o.TasjeelAmount=s.e.StringValue(n.Tables[1][t].TasjeelAmount)),n.Columns[1].Contains("InclChkGen")&&!s.e.IsEmpty(n.Tables[1][t].InclChkGen)&&(o.InclChkGen=s.e.StringValue(n.Tables[1][t].InclChkGen)),n.Columns[1].Contains("Detailsxml")&&!s.e.IsEmpty(n.Tables[1][t].Detailsxml)&&(o.Xml=n.Tables[1][t].Detailsxml.toString()),o.Narration=s.e.StringValue(n.Tables[1][t].Narration),o.Refund=n.Columns[1].Contains("Refund")&&!s.e.IsEmpty(n.Tables[1][t].Refund)&&"0"!=n.Tables[1][t].Refund.toString()?n.Tables[1][t].Refund.toString():n.Columns[1].Contains("UnitRefund")&&!s.e.IsEmpty(n.Tables[1][t].UnitRefund)?n.Tables[1][t].UnitRefund.toString():"0",o.Display=n.Columns[1].Contains("unitDisplay")&&!s.e.IsEmpty(n.Tables[1][t].unitDisplay)?n.Tables[1][t].unitDisplay.toString():n.Columns[1].Contains("Display")&&!s.e.IsEmpty(n.Tables[1][t].Display)?n.Tables[1][t].Display.toString():"1","0"==o.Display.toString()&&(o.StyleHeightZero=1);for(var D=0;D<e.ContractParticular.length;D++)e.ContractParticular[D].DisplayMember.startsWith("CCNID")&&n.Columns[1].Contains(e.ContractParticular[D].DisplayMember)&&!s.e.IsEmpty(n.Tables[1][t][e.ContractParticular[D].DisplayMember])&&(o[e.ContractParticular[D].ValueMember]=n.Tables[1][t][e.ContractParticular[D].DisplayMember].toString());if(n.Columns[1].Contains("DocID")&&(95==e.CurrCostCenterID||104==e.CurrCostCenterID)){if(o.Status=s.e.StringValue(n.Tables[1][t].StatusID),o.DocPrefix=s.e.StringValue(n.Tables[1][t].DocPrefix),o.DocNumber=s.e.StringValue(n.Tables[1][t].DocNumber),o.CostCenterID=s.e.StringValue(n.Tables[1][t].CostCenterID),o.DocumentNo=s.e.String(n.Tables[1][t].VoucherNo),o.DocID=s.e.StringValue(n.Tables[1][t].DocID),n.Tables.length>9&&n.Columns[9].Contains("DOCID")&&""!=s.e.StringValue(n.Tables[1][t].DocID)){var h,C=(_toArray(h=n.Tables[9].filter((function(e){return e.DOCID==n.Tables[1][t].DocID.toString()}))),h);C.length>0&&(o.TempCCID_Key=s.e.StringValue(C[0].ID),o.TempCCID=s.e.StringValue(C[0].Name))}else o.TempCCID_Key=s.e.StringValue(e.DocStNodeID),o.TempCCID=e.DocStName;n.Columns[1].Contains("DocumentName")&&(o.DocumentName=s.e.StringValue(n.Tables[1][t].DocumentName))}n.Tables[1][t].CCNodeID.toString()==e.id2.toString()?(s.e.IsEmpty(n.Tables[1][0].Sqft)||null==n.Tables[1][0].Sqft||(o.Sqft=parseFloat(n.Tables[1][0].Sqft).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())),s.e.IsEmpty(n.Tables[1][0].Rate)||null==n.Tables[1][0].Rate||(o.Rate=parseFloat(n.Tables[1][0].Rate).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())),s.e.IsEmpty(n.Tables[1][0].RentAmount)||null==n.Tables[1][0].RentAmount||(o.ActAmount=parseFloat(n.Tables[1][0].RentAmount).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())),s.e.IsEmpty(n.Tables[1][0].DiscountAmount)||null==n.Tables[1][0].DiscountAmount||(o.Discount=parseFloat(n.Tables[1][0].DiscountAmount).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()))):(!s.e.IsEmpty(n.Tables[1][t].ChequeNo)&&!s.e.IsEmpty(n.Tables[1][t].ChequeNo)&&parseInt(n.Tables[1][t].ChequeNo)>0&&(o.ChequeNo=n.Tables[1][t].ChequeNo.toString()),s.e.IsEmpty(n.Tables[1][t].ChequeDate)||null==n.Tables[1][t].ChequeDate||new Date(n.Tables[1][t].ChequeDate).toString().Contains("1900")||(o.CntrlDate=new Date(n.Tables[1][t].ChequeDate).ToString(i.a.SessionManager.Preferences["Date Format"]),o.CntrlDate_Key=s.e.StringValue(n.Tables[1][t].ChequeDate))),s.e.IsEmpty(n.Tables[1][t].Amount)||(o.Amount=parseFloat(n.Tables[1][t].Amount).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())),null==n.Tables[1][0].RentAmount||s.e.IsEmpty(n.Tables[1][t].RentAmount)||(o.ActAmount=parseFloat(n.Tables[1][t].RentAmount).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())),s.e.IsEmpty(n.Tables[1][t].DiscountAmount)||(o.Discount=parseFloat(n.Tables[1][t].DiscountAmount).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())),n.Columns[1].Contains("UnitMonths")&&!s.e.IsEmpty(n.Tables[1][t].UnitMonths)?o.Months=n.Tables[1][t].UnitMonths.toString():n.Columns[1].Contains("Months")&&!s.e.IsEmpty(n.Tables[1][t].Months)&&(o.Months=n.Tables[1][t].Months.toString()),n.Columns[1].Contains("UnitDiscountPercentage")&&!s.e.IsEmpty(n.Tables[1][t].UnitDiscountPercentage)?o.DiscountPercentage=n.Tables[1][t].UnitDiscountPercentage.toString():n.Columns[1].Contains("DiscountPercentage")&&!s.e.IsEmpty(n.Tables[1][t].DiscountPercentage)&&(o.DiscountPercentage=n.Tables[1][t].DiscountPercentage.toString()),n.Tables[1][t].CCNodeID.toString()==e.id2.toString()&&null!=n.Tables[1][t].Amount&&null!=n.Tables[1][t].Amount&&(e.OriginalRent=parseFloat(n.Tables[1][t].Amount)),e.DataTableObj.addRow(o)},D=0;D<n.Tables[1].length;D++)u(D)}if(n.Tables.length>2&&n.Tables[2].length>0){e.LinkedQuotationID>0&&n.Columns[2].Contains("IsRes")&&"1"==n.Tables[2][0].IsRes.toString()&&n.Tables[2].length>1?(e.NoofCheques=n.Tables[2].length-1,""!=s.e.StringValue(n.Tables[2][1].ChequeNo)&&(e.FirstNumber=n.Tables[2][1].ChequeNo.toString()),""!=s.e.StringValue(n.Tables[2][1].ChequeDate)&&(e.stDate=new Date(n.Tables[2][1].ChequeDate.toString())),e.PayeeBnk=n.Tables[2][1].CustomerBank.toString(),""!=s.e.StringValue(n.Tables[2][1].DebitAccID)&&(e.DebitAcc=parseInt(n.Tables[2][1].DebitAccID)),e.InstPeriod=n.Tables[2].length>2?s.e.GetDateDifference(new Date(n.Tables[2][2].ChequeDate),new Date(n.Tables[2][1].ChequeDate)):0):(e.NoofCheques=n.Tables[2].length,""!=s.e.StringValue(n.Tables[2][0].ChequeNo)&&(e.FirstNumber=n.Tables[2][0].ChequeNo.toString()),""!=s.e.StringValue(n.Tables[2][0].ChequeDate)&&(e.stDate=new Date(n.Tables[2][0].ChequeDate)),e.PayeeBnk=n.Tables[2][0].CustomerBank.toString(),""!=s.e.StringValue(n.Tables[2][0].DebitAccID)&&(e.DebitAcc=parseInt(n.Tables[2][0].DebitAccID)),e.InstPeriod=n.Tables[2].length>1?s.e.GetDateDifference(new Date(n.Tables[2][1].ChequeDate),new Date(n.Tables[2][0].ChequeDate)):0),e.PayTermsDataTableObj.Clear();for(var h=function(t){var a=e.PayTermsDataTableObj.NewRow();a.ChequeNo=s.e.StringValue(n.Tables[2][t].ChequeNo),e.InclPostingDate&&n.Columns[2].Contains("PostingDate")&&!s.e.IsEmpty(n.Tables[2][t].PostingDate)&&""!=s.e.StringValue(n.Tables[2][t].PostingDate)&&(a.PostingDate=new Date(n.Tables[2][t].PostingDate).ToString(i.a.SessionManager.Preferences["Date Format"]),a.PostingDate_Key=new Date(n.Tables[2][t].PostingDate)),n.Columns[2].Contains("TillDate")&&""!=s.e.StringValue(n.Tables[2][t].TillDate)&&(a.TillDate=new Date(n.Tables[2][t].TillDate).ToString(i.a.SessionManager.Preferences["Date Format"]),a.TillDate_Key=new Date(n.Tables[2][t].TillDate)),n.Columns[2].Contains("AccDocDetailsid")&&(e.PayTermsDataTableColumns.Contains("AccDocDetailsid")||e.PayTermsDataTableColumns.push("AccDocDetailsid"),e.PayTermsDataTable[t].AccDocDetailsid=n.Tables[2][t].AccDocDetailsid.toString()),n.Columns[2].Contains("IsFreezed")&&(e.PayTermsDataTableColumns.Contains("IsFreezed")||e.PayTermsDataTableColumns.push("IsFreezed"),e.PayTermsDataTable[t].IsFreezed=n.Tables[2][t].IsFreezed.toString()),s.e.IsEmpty(n.Tables[2][t].ChequeDate)||(a.CntrlDate=new Date(n.Tables[2][t].ChequeDate).ToString(i.a.SessionManager.Preferences["Date Format"])),a.CntrlDate_Key=n.Tables[2][t].ChequeDate.toString();var r=0;if((r=parseInt(s.e.StringValue(n.Tables[2][t].CustomerBank)))>=0&&(a.PayeeBank=r.toString()),a.Narration="",a.DebitAccountID_Key=s.e.StringValue(n.Tables[2][t].DebitAccID),a.Narration=s.e.StringValue(n.Tables[2][t].Narration),a.DebitAccountID=s.e.StringValue(n.Tables[2][t].DebitAccName),a.DocID=s.e.StringValue(n.Tables[2][t].DocID),a.Period=s.e.StringValue(n.Tables[2][t].Period),s.e.IsEmpty(n.Tables[2][t].Amount)||null==n.Tables[2][t].Amount||(a.Amount=parseFloat(n.Tables[2][t].Amount).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())),n.Columns[2].Contains("RentAmount")&&""!=s.e.StringValue(n.Tables[2][t].RentAmount)&&(a.RentAmount=parseFloat(n.Tables[2][t].RentAmount).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())),n.Columns[2].Contains("LocationID")&&""!=s.e.StringValue(n.Tables[2][t].LocationID)&&e.PayTermsDataTableColumns.Contains("Location")&&(a.Location_Key=s.e.StringValue(n.Tables[2][t].LocationID),a.Location=s.e.StringValue(n.Tables[2][t].locname)),e.PayTermsDataTableColumns.Contains("Dim_Key")&&n.Columns[2].Contains("DimNodeID")&&""!=s.e.StringValue(n.Tables[2][t].DimNodeID)){a.Dim_Key=s.e.StringValue(n.Tables[2][t].DimNodeID);var o=n.Tables[10].filter((function(e){return e.DimNodeID==s.e.StringValue(n.Tables[2][t].DimNodeID)}));o.length>0&&(a.Dim=s.e.StringValue(o[0].Dimname))}if(e.PayTermsDataTableColumns.Contains("SalesMan_Key")&&n.Columns[2].Contains("SalesManID")&&""!=n.Tables[2][t].SalesManID.toString()){e.PayTermsDataTable[t].SalesMan_Key=n.Tables[2][t].SalesManID.toString();var l=n.Tables[10].filter((function(e){return e.SalesManID==n.Tables[2][t].SalesManID.toString()}));l.length>0&&(e.PayTermsDataTable[t].SalesMan=l[0].SalesManname.toString())}if(n.Columns[2].Contains("Particular")&&!s.e.IsEmpty(n.Tables[2][t].Particular)&&e.PayTermsDataTableColumns.Contains("Particulars_Key")){var c;a.Particulars_Key=s.e.StringValue(n.Tables[2][t].Particular);var u=(_toArray(c=e.ScreenObject.Data.Tables[10].filter((function(e){return e.NodeID==n.Tables[2][t].Particular.toString()}))),c);u.length>0&&(a.Particulars=s.e.StringValue(u[0].Particulars))}for(var D=0;D<e.ContractPayTerms.length;D++)e.ContractPayTerms[D].DisplayMember.startsWith("CCNID")&&n.Columns[2].Contains(e.ContractPayTerms[D].DisplayMember)&&""!=n.Tables[2][t][e.ContractPayTerms[D].DisplayMember].toString()&&(e.PayTermsDataTable[t][e.ContractPayTerms[D].ValueMember]=n.Tables[2][t][e.ContractPayTerms[D].DisplayMember].toString());if(103!=e.CurrCostCenterID&&n.Columns[2].Contains("DocStatusID")){if(a.Status=s.e.StringValue(n.Tables[2][t].StatusID),a.DocPrefix=s.e.StringValue(n.Tables[2][t].DocPrefix),a.DocNumber=s.e.StringValue(n.Tables[2][t].DocNumber),a.CostCenterID=s.e.StringValue(n.Tables[2][t].CostCenterID),a.DocumentNo=s.e.StringValue(n.Tables[2][t].VoucherNo),a.DocStatusID=s.e.StringValue(n.Tables[2][t].DocStatusID),a.DocumentType=s.e.StringValue(n.Tables[2][t].DocumentType),n.Columns[2].Contains("OpPdcStatus")&&!s.e.IsEmpty(n.Tables[2][t].OpPdcStatus)&&(e.PayTermsDataTable[t].OpPdcStatus=s.e.StringValue(n.Tables[2][t].OpPdcStatus)),a.OpPdcStatus=s.e.StringValue(n.Tables[2][t].OpPdcStatus),n.Tables.length>9&&n.Columns[9].Contains("DOCID")&&!s.e.IsEmpty(n.Tables[2][t].DocID)){var h,C=(_toArray(h=n.Tables[9].filter((function(e){return e.DOCID==s.e.StringValue(n.Tables[2][t].DocID)}))),h);C.length>0&&(a.TempCCID_Key=s.e.StringValue(C[0].ID),a.TempCCID=s.e.StringValue(C[0].Name))}else a.TempCCID_Key=s.e.StringValue(e.DocStNodeID),a.TempCCID=e.DocStName;"429"==s.e.StringValue(n.Tables[2][t].DocStatusID)&&("1"==s.e.StringValue(n.Tables[2][t].BillNo)?a.Status=i.a.GetResource("Replaced"):"2"==s.e.StringValue(n.Tables[2][t].BillNo)&&(a.Status=i.a.GetResource("ReplacedPartial")))}n.Columns[2].Contains("DocumentName")&&(a.DocumentName=s.e.StringValue(n.Tables[2][t].DocumentName)),e.PayTermsDataTableObj.addRow(a)},C=0;C<n.Tables[2].length;C++)h(C)}e.onListSelectedChanged("LandLord")}for(var m=0;m<2;m++){var b=e.DataTableObj.NewRow();b.Recurr=!1,e.DataTableObj.addRow(b);var S=e.PayTermsDataTableObj.NewRow();e.PayTermsDataTableObj.addRow(S)}if(e.DataTableObj.UpdateTotals(),e.PayTermsDataTableObj.UpdateTotals(),e.UpdateSequencePay(),null!=n&&n.Tables.length>3&&e.ScreenObject.LoadCustomFieldsData(n.Tables[3]),null!=n&&n.Tables.length>4&&e.ScreenObject.LoadCustomFieldsCCData(n.Tables[4]),null!=n&&n.Tables.length>5&&e.ViewAttachments.LoadAttachments(n.Tables[5]),n.Columns[0].Contains("WorkFlowID")&&n.Tables[0].length>0&&""!=n.Tables[0][0].WorkFlowID.toString()&&parseInt(n.Tables[0][0].WorkFlowID.toString())>0){var T=e.GetButton("ViewHistory");if(null!=T&&(T.Visible=!0),e.SetButtonVisibility("ViewHistory",!0),""!=n.Tables[0][0].canApprove.toString()&&Object(r.j)(n.Tables[0][0].canApprove.toString())?(null!=(T=e.GetButton("Reject"))&&(T.Visible=!0),e.SetButtonVisibility("RejectVisiblity",T.Visible),e.BtnApprove.Visible=!0,e.SetButtonVisibility("RejectVisiblity",!0),e.ButtonSave.Enable=!1,e.ButtonSaveAndPrint.Enable=!1):""==n.Tables[0][0].canEdit.toString()||Object(r.j)(n.Tables[0][0].canEdit.toString())?("466"==e.StatusID.SelectedValue||"440"==e.StatusID.SelectedValue&&n.Tables[0][0].WorkFlowLevel.toString()!=n.Tables[0][0].userlevel.toString())&&(e.ButtonSave.Enable=!1,e.ButtonSaveAndPrint.Enable=!1,e.BtnApprove.Visible=!1,e.SetButtonVisibility("RejectVisiblity",!1)):e.ButtonSave.Enable=e.ButtonSaveAndPrint.Enable=!!i.a.SessionManager.IsActionAssigned(e.CostCenterID,"Edit Approved Contracts"),"466"!=e.StatusID.SelectedValue&&"440"!=e.StatusID.SelectedValue&&"470"!=e.StatusID.SelectedValue||(null!=(T=e.GetButton("Generate"))&&(T.Visible=!1),e.SetButtonVisibility("GenerateLink",!1),e.ButtonRenew.Enable=!1,e.ButtonTerminate.Enable=!1,e.ButtonRefund.Visible=!1,e.ButtonVacant.Visible=!1,e.SetButtonVisibility("RefundVisiblity",!1),e.SetButtonVisibility("VacantVisiblity",!1)),95==e.CostCenterID&&n.Tables.length>11&&n.Columns[11].Contains("WorkFlowLevel")||(103==e.CostCenterID||129==e.CostCenterID)&&n.Tables.length>10&&n.Columns[10].Contains("WorkFlowLevel")){var y=n.Tables[12],g=n.Tables[11];103==e.CostCenterID||129==e.CostCenterID?(y=n.Tables[11],g=n.Tables[10]):(y=n.Tables[12],g=n.Tables[11]);var I=0;s.e.IsEmpty(n.Tables[0][0].WorkFlowLevel)||(I=parseInt(n.Tables[0][0].WorkFlowLevel.toString())),g.length>0&&parseInt(g[g.length-1].StatusID);for(var p=g.length>0?parseInt(g[0].WorkFlowLevel)-1:0,A=0;A<y.length;A++){var f=new d.a(parseInt(y[0].WID),parseInt(y[A].LevelID),y[A].LevelName.toString(),e.CostCenterID,e.CostCenterID,e.ContractDate.Date);A==p&&(f.IsPending=!0,f.Label="C"),0==A&&(f.LeftLineBrush="#FFFFFFFF"),A==y.length-1&&(f.RightLineBrush="#FFFFFFFF"),e.WFDocLevelList.push(f)}for(var P=g.length-1;P>=0;P--){var N=parseInt(g[P].WorkFlowLevel);if(N<=I&&N<=e.WFDocLevelList.length&&!e.WFDocLevelList[N-1].IsSet){e.WFDocLevelList[N-1].IsSet=!0,e.WFDocLevelList[N-1].ModifiedBy=g[P].Status.toString()+" By "+g[P].CreatedBy.toString(),g[P].FirstName.toString().length>0&&(e.WFDocLevelList[N-1].ModifiedBy+="("+g[P].FirstName.toString()+")");var V=new Date(g[P].Date);e.WFDocLevelList[N-1].ModifiedBy+=" On "+V.ToString(i.a.SessionManager.Preferences["Date Format"]);var R=parseInt(g[P].StatusID);470==R?e.WFDocLevelList[N-1].IsRejected=!0:466==R?e.WFDocLevelList[N-1].IsApproved=!0:426!=R&&427!=R||(e.WFDocLevelList[N-1].IsPending=!0,e.WFDocLevelList[N-1].Label=" P")}}}}else n.Columns[0].Contains("IsApprove")&&n.Tables[0].length>0&&""!=n.Tables[0][0].IsApprove.toString()&&("465"!=e.StatusID.SelectedValue||""!=n.Tables[0][0].WorkFlowID.toString()&&parseInt(n.Tables[0][0].WorkFlowID.toString())>0&&"1"==n.Tables[0][0].wfaction.toString())&&(e.BtnApprove.Visible=Object(r.j)(n.Tables[0][0].IsApprove.toString()));if(null!=n&&n.Tables.length>7&&n.Tables[7].length>0&&null!=e.ViewActivities&&e.ViewActivities.LoadActivityData(n.Tables[7]),null!=n&&n.Tables.length>6&&e.ViewNotes.LoadNotes(n.Tables[6]),null!=n&&n.Tables.length>8&&n.Tables[8].length>0){e.StrMultiple="",e.SelectedUnits="";for(var M=0;M<n.Tables[8].length;M++)e.SelectedUnits+=n.Tables[8][M].UnitID.toString()+",";e.StrMultiple=n.Tables[8][0].uname.toString(),e.SelectedUnits.length>1&&(e.SelectedUnits=e.SelectedUnits.slice(0,-1)),e.ScreenObject.HeaderFields.forEach((function(t){t instanceof l.f&&(t.MultipleUnits.Text=e.StrMultiple),t.multiVisi=!0})),e.Property.Enable=!1,e.multiVisi=!0}e.CalculateFooter(),e.IsRecurPosted&&(e.TotalYears.IsReadOnly=e.Months.IsReadOnly=e.RecurDuration.IsReadOnly=e.ContractDate.IsReadOnly=e.StartDate.IsReadOnly=e.EndDate.IsReadOnly=!0),Logger.InfoLog("AddEditRenContractViewModel ::Exiting LoadEditData")}()}catch(u){Logger.ErrorLog("AddEditRenContractViewModel :: LoadEditData"+u.stack)}if(this.ButtonsPopup.length>0)for(var a=0;a<this.ButtonsPopup.length;a++){var n=this.ButtonsPopup[a];n.Visible&&(n.Enable||(n.Visible=!1))}if(this.ButtonsLeft.length>0)for(var o=0;o<this.ButtonsLeft.length;o++){var c=this.ButtonsLeft[o];c.Visible&&(c.Enable||(c.Visible=!1))}}},{key:"FillNullValue_to_Row",value:function(t,e){for(var a=0;a<t.length;a++)e[t[a]]=null;return e}},{key:"AddUnitWhere",value:function(t){var e,a=" ISGROUP = 0 ",n=(_toArray(e=this.ScreenObject.Data.Tables[5].filter((function(t){return"ServiceUnitTypes"==t.Name}))),e);n.length>0&&""==n[0].Value.toString().Trim()&&(a+=this.ParentContractID>0?" and Unittype <>999":" and Unittype =999"),a+=" and (UnitStatus = "+this.UnitStatusVal+" or UnitStatus is null or   UnitStatus =  0 or a.UnitID = "+this.Unit.SelectedValue+")";var s="";i.a.SessionManager.Preferences["Dimension List"].split(",").Contains("92")&&null!=this.ScreenObject.Data&&this.ScreenObject.Data.Tables.length>6&&this.ScreenObject.Data.Columns[6].Contains("Properties")&&this.ScreenObject.Data.Tables[6].length>0&&""!=this.ScreenObject.Data.Tables[6][0].Properties.toString()&&parseInt(i.a.SessionManager.UserID)>1&&((s=this.ScreenObject.Data.Tables[6][0].Properties.toString()).length>0&&(s=s.substr(0,s.length-1))),this.Property.SelectedValue>0?a+=" and PropertyID = "+this.Property.SelectedValue:s.length>0&&(a+=" and PropertyID in ( "+s+" )"),this.ShowOnlyAvailable&&(a+="  and a.UnitID not in (select unitid from ren_contract with(nolock) where unitid is not null and (statusid=426 or statusid=427)",a+="   AND ContractID NOT IN (SELECT DISTINCT RenewRefID FROM ren_contract WITH(NOLOCK) WHERE RenewRefID IS NOT NULL AND RenewRefID >0 ) ",a+="   AND RefContractID NOT IN (SELECT DISTINCT RenewRefID FROM ren_contract WITH(NOLOCK) WHERE RenewRefID IS NOT NULL AND RenewRefID >0 ))"),3==t&&(a+=" and a.LocationID ="+this.LocationContract.SelectedValue),this.Unit.CustomWhere=a}},{key:"OnMouseClick",value:function(){Logger.InfoLog("AddEditRenContractViewModel ::Entering OnMouseDoubleClick"),null!=this.SelectedVoucher&&(event.preventDefault(),V.RibbonExtViewModel.LoadDocument(this.SelectedVoucher)),Logger.InfoLog("AddEditRenContractViewModel ::Exiting OnMouseDoubleClick")}},{key:"OnMouseClickContract",value:function(){Logger.InfoLog("AddEditRenContractViewModel ::Entering OnMouseDoubleClick"),null!=this.SelectedRow&&(event.preventDefault(),V.RibbonExtViewModel.LoadDocument(this.SelectedRow)),Logger.InfoLog("AddEditRenContractViewModel ::Exiting OnMouseDoubleClick")}},{key:"PaytermBeforeRowDeletingEvent",value:function(t){!this.PayTermsDataTableColumns.Contains("IsFreezed")||null==this.SelectedVoucher||"1"!=this.SelectedVoucher.IsFreezed.toString()&&"True"!=this.SelectedVoucher.IsFreezed.toString()||(this.DisplayMessage="Voucher Freezed.",t.CanExecute=!1)}},{key:"OnCellEditEnding",value:function(t){return Object(n.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,o,l,c,u,D,h,C,m,b,S,d,T,y,g,I=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Logger.InfoLog("AddEditRenContractViewModel ::Entering OnCellEditEnding"),e.prev=1,n=t.item,"DataGridPactComboBoxColumn"!=t.column.className){e.next=12;break}if("NodeID"!=t.column.field||s.e.IsEmpty(n.NodeID)){e.next=10;break}if(null!=this.dtParticulars&&this.dtParticulars.some((function(t){return t.hasOwnProperty("NodeID")}))||(this.dsPart=this.StartDate.Date&&this.EndDate.Date?i.a.rental.GetParticularsDetails(this.RenewRefID,this.Unit.SelectedValue,0,this.StartDate.Date,this.EndDate.Date,1,this.ContractID,this.SelectedUnits):this.StartDate.Date?i.a.rental.GetParticularsDetails(this.RenewRefID,this.Unit.SelectedValue,0,this.StartDate.Date,new Date,1,this.ContractID,this.SelectedUnits):i.a.rental.GetParticularsDetails(this.RenewRefID,this.Unit.SelectedValue,0,new Date,this.EndDate.Date?this.EndDate.Date:new Date,1,this.ContractID,this.SelectedUnits),null!=this.dsPart&&this.dsPart.Tables.length>0&&this.dsPart.Tables[0].length>0?this.dtParticulars=this.dsPart.Tables[0].filter((function(t){return 1==t.Type||3==t.Type})):null!=this.dsPart&&this.dsPart.Tables.length>1&&this.dsPart.Tables[1].length>0&&(r=this.dsPart.Tables[1],r=this.dsPart.Tables[1].filter((function(t){return 1==t.Type||3==t.Type})),this.dsPart.Columns[1].Contains("UnitID")&&(r=this.dsPart.Tables[1].filter((function(t){return 1==t.Type||3==t.Type&&(0==t.UnitID||t.UnitID==I.Unit.SelectedValue)}))),this.dtParticulars=r)),0==this.DataTable.find((function(t){return t.NodeID==n.NodeID.toString()})).length||this.DataTable.filter((function(t){return t.NodeID==n.NodeID.toString()}))[0]==n){e.next=8;break}return e.abrupt("return",(this.DisplayMessage="Particular Already Selected",void(this.MessageVisibility=!0)));case 8:if(null!=this.dtParticulars&&this.dtParticulars.some((function(t){return t.hasOwnProperty("NodeID")})))if((o=this.dtParticulars.filter((function(t){return t.NodeID==n.NodeID.toString()}))).length>0){if(l=0,0,c=this.OriginalRent,D=this.CalculateMonths(),u=D>1?s.e.Round(s.e.Double(c)/D,this.Mdeci):s.e.DoubleTryParse(c),n.Recurr=!1,n.Particulars=o[0].Particulars.toString(),s.e.IsEmpty(o[0].CreditID)||(n.CreditAccountID_Key=o[0].CreditID.toString()),s.e.IsEmpty(o[0].DebitID)||(n.DebitAccountID_Key=o[0].DebitID.toString()),this.dtParticulars.some((function(t){return t.hasOwnProperty("AdvanceAcc")}))&&!s.e.IsEmpty(o[0].AdvanceAcc)&&parseInt(o[0].AdvanceAcc.toString())>0&&(n.AdvanceAcc=o[0].AdvanceAcc.toString()),""!=this.SelectedUnits){for(h=0;h<o.length;h++)!s.e.IsEmpty(o[h].DiscountAmount)&&parseFloat(o[h].DiscountAmount)>0?l+=parseFloat(o[h].DiscountAmount):!s.e.IsEmpty(o[h].DiscountPercentage)&&parseFloat(o[h].DiscountPercentage)>0?l+=parseFloat(o[h].DiscountPercentage)*c/100:!s.e.IsEmpty(o[h].Months)&&parseFloat(o[h].Months)>0&&(l+=parseFloat(o[h].Months)*parseFloat(u.toString())),this.dtParticulars.some((function(t){return t.hasOwnProperty("VAT")}))&&!s.e.IsEmpty(o[h].VAT)&&parseFloat(o[h].VAT.toString())>0&&(n.VatPer=parseFloat(o[h].VAT.toString()));n.Amount=l}else!s.e.IsEmpty(o[0].DiscountAmount)&&parseFloat(o[0].DiscountAmount)>0?l=parseFloat(o[0].DiscountAmount):!s.e.IsEmpty(o[0].DiscountPercentage)&&parseFloat(o[0].DiscountPercentage)>0?l=parseFloat(o[0].DiscountPercentage)*c/100:!s.e.IsEmpty(o[0].Months)&&parseFloat(o[0].Months)>0&&(l=parseFloat(o[0].Months)*parseFloat(u.toString())),n.Amount=l,this.dtParticulars.Contains("VAT")&&!s.e.IsEmpty(o[0].VAT)&&parseFloat(o[0].VAT.toString())>0&&(n.VatPer=parseFloat(o[0].VAT.toString()));s.e.IsEmpty(o[0].CreditName)||(n.CreditAccountID=o[0].CreditName.toString()),s.e.IsEmpty(o[0].DebitName)||(n.DebitAccountID=o[0].DebitName.toString()),s.e.IsEmpty(o[0].DiscountPercentage)||(n.DiscountPercentage=o[0].DiscountPercentage.toString()),s.e.IsEmpty(o[0].Months)||(n.Months=o[0].Months.toString()),this.DataTableColumns.Contains("Dim_Key")&&Object.keys(o[0]).Contains("Dimname")&&!s.e.IsEmpty(o[0].Dimname)&&(n.Dim_Key=o[0].DimNodeID.toString(),n.Dim=o[0].Dimname.toString()),this.DataTableColumns.Contains("SalesManID")&&Object.keys(o[0]).Contains("SalesManIDname")&&!s.e.IsEmpty(o[0].SalesManname)&&(n.SalesMan_Key=o[0].SalesManID.toString(),n.SalesMan=o[0].SalesManname.toString()),this.DataTableColumns.Contains("Location_Key")&&this.LocationContract.SelectedValue>0&&(n.Location_Key=this.LocationContract.SelectedValue),n.VatType=s.e.String(o[0].VatType),n.RecurInvoice=s.e.String(o[0].RecurInvoice).toLowerCase(),n.PostDebit=s.e.String(o[0].PostDebit),this.DataTableObj.updateRow(n),this.CalculateNRec()}else null!=(C=this.ContractParticular.filter((function(t){return!s.e.IsEmpty(t.ValueBinding)&&"NodeID"==t.ValueBinding})))&&(m=C.ComboData.filter((function(t){return t.NodeID==n.NodeID.toString()}))).length>0&&(n.Particulars=m[0].Particulars.toString()),n.InclChkGen="0",this.DataTableObj.updateRow(n);else n.InclChkGen="0",this.DataTableObj.updateRow(n);!s.e.IsEmpty(t.item.Location_Key)&&this.LocationContract.SelectedValue>0&&(n.Location_Key=this.LocationContract.SelectedValue,this.DataTableObj.updateRow(n));case 10:e.next=27;break;case 12:if("ChequeNo"!=t.column.field||s.e.IsEmpty(n.ChequeNo)||""!=s.e.String(n.TempCCID_Key)||(n.TempCCID_Key=this.DocStNodeID.toString(),n.TempCCID=this.DocStName),this.PayTermsDataTableColumns.Contains("Period")&&this.PayTermsDataTableColumns.Contains("Dim_Key")&&this.DefaultDiminPayterms>0&&""==s.e.String(n.Dim_Key)&&(n.Dim_Key=this.DefaultDiminPayterms,(b=this.DataTable.filter((function(t){return t.Dim_Key==I.DefaultDiminPayterms}))).length>0&&!s.e.IsEmpty(b[0].Dim)&&(n.Dim=b[0].Dim)),!(""!=this.SelectedUnits&&s.e.isValidDate(this.StartDate.Date)&&s.e.isValidDate(this.EndDate.Date)&&this.DataTable[0]==n&&this.DistributePopuponRent)||"Amount"!=t.column.field&&"ActAmount"!=t.column.field){e.next=24;break}return e.next=16,a.e(68).then(a.bind(null,"Rr92"));case 16:return S=e.sent,d=S.UpdatePayTermsViewModel,e.next=20,a.e(0).then(a.bind(null,"++ql"));case 20:T=e.sent,y=T.UpdatepaytermsComponent,(g=new d("AddEditRenContractViewModel")).UpdatePayTermsViewModel_1(this,n,null),i.a.page.ShowDialog(g,y,{Title:"Distribute",HideClose:!0,ShowCenter:!0});case 24:if("ActAmount"!=t.column.field&&"Discount"!=t.column.field&&"Sqft"!=t.column.field&&"Rate"!=t.column.field||((this.DataTable[0]==n&&"Sqft"==t.column.field||"Rate"==t.column.field)&&(s.e.IsEmpty(this.DataTable[0].Sqft)||s.e.IsEmpty(this.DataTable[0].Rate)||(this.DataTable[0].ActAmount=s.e.DoubleTryParse(this.DataTable[0].Sqft)*s.e.DoubleTryParse(this.DataTable[0].Rate))),s.e.IsEmpty(n.ActAmount)||s.e.IsEmpty(n.Discount)?null==n.Discount||s.e.IsEmpty(n.Discount)?s.e.IsEmpty(n.ActAmount)||(n.Amount=s.e.DoubleTryParse(n.ActAmount)):n.Amount=0:n.Amount=s.e.DoubleTryParse(n.ActAmount)-s.e.DoubleTryParse(n.Discount),this.RefreshGrid=!this.RefreshGrid),0!=this.Unit.SelectedValue||""!=this.SelectedUnits||104==this.CurrCostCenterID){e.next=26;break}return e.abrupt("return",void(n.Amount=null));case 26:"DebitAccountID"==t.column.field&&""==s.e.String(n.DebitAccountID)&&(n.DebitAccountID_Key="0"),t.grid.getData().getItems()!=this.DataTable||!this.DataTableColumns.Contains("Amount")||"Amount"!=t.column.field&&s.e.IsEmpty(n.Amount)||0==this.SelectedGridRowIndex&&(this.Reevaluate(),s.e.IsEmpty(n.Discount)?(n.ActAmount=n.Amount,n.Discount=0):n.ActAmount=s.e.DoubleTryParse(n.Amount)+s.e.DoubleTryParse(n.Discount));case 27:Logger.InfoLog("AddEditRenContractViewModel ::Exiting OnCellEditEnding"),this.CalculateNRec(),this.CalculateFooter(),this.DataTableObj.UpdateTotals(),this.DataTableObj.updateRow(n),this.PayTermsDataTableObj.updateRow(n),this.PayTermsDataTableObj.UpdateTotals(),e.next=33;break;case 30:e.prev=30,e.t0=e.catch(1),Logger.ErrorLog("AddEditRenContractViewModel :: OnCellEditEnding"+e.t0.stack);case 33:case"end":return e.stop()}}),e,this,[[1,30]])})))}},{key:"Reevaluate",value:function(){var t=0;s.e.IsEmpty(this.DataTable[0].Amount)||(t=parseFloat(this.DataTable[0].Amount));var e,a=this.CalculateMonths();e=a>1?s.e.Round(parseFloat(t.toString())/a,this.Mdeci):parseFloat(t.toString());for(var n=1;n<this.DataTable.length;n++)!s.e.IsEmpty(this.DataTable[n].DiscountPercentage)&&s.e.DoubleTryParse(this.DataTable[n].DiscountPercentage)>0?this.DataTable[n].Amount=s.e.DoubleTryParse(this.DataTable[n].DiscountPercentage)*t/100:s.e.IsEmpty(this.DataTable[n].Months)&&s.e.DoubleTryParse(this.DataTable[n].Months)>0&&(this.DataTable[n].Amount=s.e.DoubleTryParse(this.DataTable[n].Months)*s.e.DoubleTryParse(e)),this.DataTable[n].ActAmount=this.DataTable[n].Amount,this.DataTable[n].Discount=0}},{key:"CalculateFooter",value:function(){var t=this.PayTermsDataTable.Compute("sum","Amount");null!=t&&null!=t||(t=0);var e=this.ContractPayTerms.find((function(t){return"Amount"==t.DisplayMember}));null!=e?e.footer=parseFloat(t).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()):this.ContractPayTerms[5].footer=parseFloat(t).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),95==this.CurrCostCenterID||104==this.CurrCostCenterID?(e=this.ContractParticular.find((function(t){return"Amount"==t.DisplayMember})),null!=(t=this.DataTable.filter((function(t){return null==t.Display||0!=t.Display})).Compute("sum","Amount"))&&null!=t||(t=0),null!=e?e.footer=parseFloat(t).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()):this.ContractParticular[11].footer=parseFloat(t).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())):(e=this.ContractParticular.find((function(t){return"ActAmount"==t.DisplayMember})),null!=(t=this.DataTable.Compute("sum","ActAmount"))&&null!=t||(t=0),null!=e?e.footer=parseFloat(t).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()):this.ContractParticular[9].footer=parseFloat(t).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())),e=this.ContractParticular.find((function(t){return"TaxableAmt"==t.DisplayMember})),null!=(t=this.DataTable.filter((function(t){return null==t.Display||0!=t.Display})).Compute("sum","TaxableAmt"))&&null!=t||(t=0),null!=e&&(e.footer=parseFloat(t).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())),this.TotAmt.Text=parseFloat(t).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),e=this.ContractParticular.find((function(t){return"VatAmount"==t.DisplayMember})),null!=(t=this.DataTable.filter((function(t){return null==t.Display||0!=t.Display})).Compute("sum","VatAmount"))&&null!=t||(t=0),this.VatAmount.Text=parseFloat(t).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),null!=e&&(e.footer=parseFloat(t).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())),this.UpdateFooter=!0}},{key:"GetDays",value:function(){return this.EndDate.Date.Subtract(this.StartDate.Date).Days+1}},{key:"GetDays_1",value:function(t,e){return e.Subtract(t).Days+1}},{key:"CalculateRent",value:function(){if(this.StartDate.Date&&this.EndDate.Date){var t,e=0;t=this.EndDate.Date.Subtract(this.StartDate.Date).Days-1,this.RentBasedContract&&(e=t,this.InclStartDate&&(e+=1),this.InclEndDate&&(e+=1),this.CalculateRentBaedOnDays(e,!1))}}},{key:"FillPropDetails",value:function(t){var e=i.a.rental.GetProperty(parseInt(this.Property.SelectedValue.toString()),1);if(null!=e&&e.Tables.length>2&&e.Tables[2].length>0&&(null!=e.Tables[2][0].TermsConditions.toString()&&""!=e.Tables[2][0].TermsConditions.toString()&&(this.TermsConditions.Text=e.Tables[2][0].TermsConditions.toString()),null!=e.Tables[2][0].BankAccount&&""!=e.Tables[2][0].BankAccount.toString()&&(this.GenDebitAcc=parseInt(e.Tables[2][0].BankAccount)),104==this.CurrCostCenterID?null!=e.Tables[2][0].RentalAccount&&""!=e.Tables[2][0].RentalAccount.toString()&&(this.IncomeAc.SelectedValue=parseInt(e.Tables[2][0].RentalAccount)):1==this.PickACC&&(this.ParentContractID>0?null!=e.Tables[2][0].ParkingIncomeAccountID&&""!=e.Tables[2][0].ParkingIncomeAccountID.toString()&&(this.IncomeAc.SelectedValue=parseInt(e.Tables[2][0].ParkingIncomeAccountID)):null!=e.Tables[2][0].RentalIncomeAccountID&&""!=e.Tables[2][0].RentalIncomeAccountID.toString()&&(this.IncomeAc.SelectedValue=parseInt(e.Tables[2][0].RentalIncomeAccountID))),129==this.CurrCostCenterID?e.Columns[2].Contains("AdvanceReceivableAccountID")&&null!=e.Tables[2][0].AdvanceReceivableAccountID&&""!=e.Tables[2][0].AdvanceReceivableAccountID.toString()&&(this.RentRecAc.SelectedValue=parseInt(e.Tables[2][0].AdvanceReceivableAccountID)):104==this.CurrCostCenterID?null!=e.Tables[2][0].RentPayableAccount&&""!=e.Tables[2][0].RentPayableAccount.toString()&&(this.RentRecAc.SelectedValue=parseInt(e.Tables[2][0].RentPayableAccount)):1!=this.PickACC||this.PickRRfromTenant||null!=e.Tables[2][0].RentalReceivableAccountID&&""!=e.Tables[2][0].RentalReceivableAccountID.toString()&&(this.RentRecAc.SelectedValue=parseInt(e.Tables[2][0].RentalReceivableAccountID)),104==this.CurrCostCenterID?null!=e.Tables[2][0].AdvanceRentPaid&&""!=e.Tables[2][0].AdvanceRentPaid.toString()&&(this.GenAdvanceRentAcc=parseInt(e.Tables[2][0].AdvanceRentPaid)):1==this.PickACC&&(this.ParentContractID>0?null!=e.Tables[2][0].ParkingAdvanceRentAccountID&&""!=e.Tables[2][0].ParkingAdvanceRentAccountID.toString()&&(this.IncomeAc.SelectedValue=parseInt(e.Tables[2][0].ParkingAdvanceRentAccountID)):null!=e.Tables[2][0].AdvanceRentAccountID&&""!=e.Tables[2][0].AdvanceRentAccountID.toString()&&(this.GenAdvanceRentAcc=parseInt(e.Tables[2][0].AdvanceRentAccountID))),1==this.PickCC&&(null!=e.Tables[2][0].SalesmanID&&""!=e.Tables[2][0].SalesmanID.toString()&&(this.Salesman.SelectedValue=parseInt(e.Tables[2][0].SalesmanID.toString())),null!=e.Tables[2][0].AccountantID&&""!=e.Tables[2][0].AccountantID.toString()&&(this.Accountant.SelectedValue=parseInt(e.Tables[2][0].AccountantID.toString())),null!=e.Tables[2][0].LandlordID&&""!=e.Tables[2][0].LandlordID.toString()&&(this.Landlord.SelectedValue=parseInt(e.Tables[2][0].LandlordID.toString())),null!=e.Tables[2][0].LocationID&&""!=e.Tables[2][0].LocationID.toString()&&(this.LocationContract.SelectedValue=parseInt(e.Tables[2][0].LocationID.toString())))),this.ContractNumber.ComboBox.SelectedValue=this.Property.SelectedValue.toString(),this.OnContractPrefixChanged(this.ContractNumber.ComboBox.SelectedValue),t||this.DataTableObj.Clear(),104==this.CurrCostCenterID){var a,n,s,r,o=this.DataTableObj.NewRow();if(o.Recurr=!1,this.DataTableObj.addRow(o),this.DataTable[0].Recurr=!0,this.GenAdvanceRentAcc>0){var c=i.a.rental.GetAccountName(this.GenAdvanceRentAcc);null!=c&&c.Tables.length>0&&c.Tables[0].length>0&&null!=c.Tables[0][0].ACCOUNTNAME&&""!=c.Tables[0][0].ACCOUNTNAME.toString()&&(this.GenAdvanceRentAccName=c.Tables[0][0].ACCOUNTNAME.toString()),this.DataTable[0].CreditAccountID_Key=this.GenAdvanceRentAcc,this.DataTable[0].CreditAccountID=this.GenAdvanceRentAccName}if(this.DataTableObj.updateRow(this.DataTable[0]),this.dsPart=this.StartDate.Date&&this.EndDate.Date?i.a.rental.GetParticularsDetails(this.RenewRefID,0,this.Property.SelectedValue,this.StartDate.Date,this.EndDate.Date,2,this.ContractID,""):this.StartDate.Date?i.a.rental.GetParticularsDetails(this.RenewRefID,0,this.Property.SelectedValue,this.StartDate.Date,new Date,2,this.ContractID,""):i.a.rental.GetParticularsDetails(this.RenewRefID,0,this.Property.SelectedValue,new Date,this.EndDate.Date?this.EndDate.Date:new Date,2,this.ContractID,""),null!=(s=null!=this.dsPart&&this.dsPart.Tables.length>3&&this.dsPart.Tables[3].length>0?this.dsPart.Tables[3][0][0].toString():"0")&&""!=s&&parseInt(s)>0&&i.a.rental.GetCostCenterNodeID("Rent",s,this.id2),this.DataTable[0].Particulars="Rent",this.DataTable[0].NodeID=this.id2.toString(),this.DataTableObj.updateRow(this.DataTable[0]),null!=this.dsPart&&this.dsPart.Tables.length>0&&this.dsPart.Tables[0].length>0)a=this.dsPart.Tables[0].filter((function(t){return 1==t.Type||3==t.Type}));else if(null!=this.dsPart&&this.dsPart.Tables.length>1&&this.dsPart.Tables[1].length>0){var u=this.dsPart.Tables[1];a=u.ToTable(),a=u.filter((function(t){return 1==t.Type||3==t.Type}))}null!=(n=this.dsPart.Tables[6])&&n.length>0&&(n.Columns.Contains("BasedOn")&&""!=n[0].BasedOn.toString()&&(this.BasedOn.SelectedValue=n[0].BasedOn.toString()),0==this.PickCC&&(null!=n[0].SalesmanID&&""!=n[0].SalesmanID.toString()&&(this.Salesman.SelectedValue=parseInt(n[0].SalesmanID.toString())),null!=n[0].AccountantID&&""!=n[0].AccountantID.toString()&&(this.Accountant.SelectedValue=parseInt(n[0].AccountantID.toString())),null!=n[0].LandlordID&&""!=n[0].LandlordID.toString()&&(this.Landlord.SelectedValue=parseInt(n[0].LandlordID.toString())),null!=n[0].LocationID&&""!=n[0].LocationID.toString()&&(this.LocationContract.SelectedValue=parseInt(n[0].LocationID.toString())))),e.Tables.length>15&&e.Columns[15].Contains("ccnid70")&&parseInt(e.Tables[15][0].ccnid70.toString())&&(this.Vattype=parseInt(e.Tables[15][0].ccnid70.toString())),null!=e.Tables[15][0].ccnid58&&""!=e.Tables[15][0].ccnid58.toString()&&null!=(r=this.ScreenObject.GetExtrFieldByName("ccnid58"))&&r instanceof l.b&&(r.SelectedValue=parseInt(e.Tables[15][0].ccnid58.toString())),null!=e.Tables[15][0].ccnid70&&""!=e.Tables[15][0].ccnid70.toString()&&null!=(r=this.ScreenObject.GetExtrFieldByName("ccnid70"))&&r instanceof l.b&&(r.SelectedValue=parseInt(e.Tables[15][0].ccnid70.toString())),null!=e.Tables[15][0].ccnid59&&""!=e.Tables[15][0].ccnid59.toString()&&null!=(r=this.ScreenObject.GetExtrFieldByName("ccnid59"))&&r instanceof l.b&&(r.SelectedValue=parseInt(e.Tables[15][0].ccnid59.toString())),null!=e.Tables[15][0].ccnid61&&""!=e.Tables[15][0].ccnid61.toString()&&null!=(r=this.ScreenObject.GetExtrFieldByName("ccnid61"))&&r instanceof l.b&&(r.SelectedValue=parseInt(e.Tables[15][0].ccnid61.toString())),null!=e.Tables[15][0].ccnid62&&""!=e.Tables[15][0].ccnid62.toString()&&null!=(r=this.ScreenObject.GetExtrFieldByName("ccnid62"))&&r instanceof l.b&&(r.SelectedValue=parseInt(e.Tables[15][0].ccnid62.toString())),o=this.FillUnitDetails(o,a,this.dsPart),this.CalculateRent()}else if(!t){this.AddUnitWhere(1);for(var D=0;D<6;D++){var h=this.DataTableObj.NewRow();h.Recurr=!1,this.DataTableObj.addRow(h)}}}},{key:"onListSelectedChanged",value:function(t){var e=this;if(1!=this.iSGenerate){var a;Logger.InfoLog("AddEditRenContractViewModel ::Entering onListSelectedChanged");try{if(null!=t){if(("Property"==t.toString()||t instanceof l.b&&92==t.CCID)&&this.PropID!=this.Property.SelectedValue)this.PropID=this.Property.SelectedValue,this.Property.SelectedValue>0&&(this.Unit.SelectedValue>0&&(this.Unit.SelectedValue=0),this.FillPropDetails(!1));else if(("Unit"==t.toString()||t instanceof l.b&&93==t.CCID)&&"Save"==this.strRenew&&this.UnitTempID!=this.Unit.SelectedValue){if(this.UnitTempID=this.Unit.SelectedValue,this.NoOfUnits.Text="0",this.Unit.SelectedValue>0){this.NoOfUnits.Text="1",this.FilterTenantBasedOnUnit&&0==this.ParentContractID&&(this.Tenant.CustomWhere=" a.TenantID IN (SELECT CC.NodeID FROM REN_Units U with(nolock)  LEFT JOIN COM_CCCCData CC with(nolock) ON CC.CCNID10=U.CCNodeID  WHERE CC.CostCenterID=94 AND U.UnitID="+this.Unit.SelectedValue+")"),this.DataTableObj.Clear();var n,r,o=this.DataTableObj.NewRow();if(o.Recurr=!1,this.DataTableObj.addRow(o),this.DataTable[0].Recurr=!0,0==this.PickACC&&(a=i.a.rental.GetUnitDetails(this.Unit.SelectedValue),s.e.IsEmpty(a.Tables[0][0].RentalIncomeAccountID)||""==a.Tables[0][0].RentalIncomeAccountID.toString()||(this.IncomeAc.SelectedValue=parseInt(a.Tables[0][0].RentalIncomeAccountID)),129==this.CurrCostCenterID?s.e.IsEmpty(a.Tables[0][0].AdvanceReceivableAccountID)||(this.RentRecAc.SelectedValue=parseInt(a.Tables[0][0].AdvanceReceivableAccountID)):this.PickRRfromTenant||s.e.IsEmpty(a.Tables[0][0].RentalReceivableAccountID)||""==a.Tables[0][0].RentalReceivableAccountID.toString()||(this.RentRecAc.SelectedValue=parseInt(a.Tables[0][0].RentalReceivableAccountID)),s.e.IsEmpty(a.Tables[0][0].AdvanceRentAccountID)||""==a.Tables[0][0].AdvanceRentAccountID.toString()||(this.GenAdvanceRentAcc=parseInt(a.Tables[0][0].AdvanceRentAccountID))),this.GenAdvanceRentAcc>0){var c=i.a.rental.GetAccountName(this.GenAdvanceRentAcc);null!=c&&c.Tables.length>0&&c.Tables[0].length>0&&null!=c.Tables[0][0].ACCOUNTNAME&&""!=c.Tables[0][0].ACCOUNTNAME.toString()&&(this.GenAdvanceRentAccName=c.Tables[0][0].ACCOUNTNAME.toString()),this.DataTable[0].CreditAccountID_Key=this.GenAdvanceRentAcc,this.DataTable[0].CreditAccountID=this.GenAdvanceRentAccName}if(this.DataTableObj.updateRow(this.DataTable[0]),this.dsPart=this.StartDate.Date&&this.EndDate.Date?i.a.rental.GetParticularsDetails(this.RenewRefID,this.Unit.SelectedValue,0,this.StartDate.Date,this.EndDate.Date,1,this.ContractID,this.SelectedUnits):this.StartDate.Date?i.a.rental.GetParticularsDetails(this.RenewRefID,this.Unit.SelectedValue,0,this.StartDate.Date,new Date,1,this.ContractID,this.SelectedUnits):i.a.rental.GetParticularsDetails(this.RenewRefID,this.Unit.SelectedValue,0,new Date,this.EndDate.Date?this.EndDate.Date:new Date,1,this.ContractID,this.SelectedUnits),this.DataTable[0].Particulars="Rent",this.DataTable[0].NodeID=this.id2.toString(),null!=this.dsPart&&this.dsPart.Tables.length>5&&this.dsPart.Tables[5].length>0&&(this.DataTable[0].Sqft=this.dsPart.Tables[5][0].RentableArea),this.DataTableObj.updateRow(this.DataTable[0]),null!=this.dsPart&&this.dsPart.Tables.length>0&&this.dsPart.Tables[0].length>0){var u=this.dsPart.Tables[0];u.RowFilter=" Type in (1,3) ",n=u.filter((function(t){return 1==t.Type||3==t.Type}))}else if(null!=this.dsPart&&this.dsPart.Tables.length>1&&this.dsPart.Tables[1].length>0){var D=this.dsPart.Tables[1];D=D.filter((function(t){return 1==t.Type||3==t.Type})),this.dsPart.Tables[1].Contains("UnitID")&&(D=D.filter((function(t){return 1==t.Type||3==t.Type&&(0==t.UnitID||t.UnitID==e.Unit.SelectedValue)}))),n=D}if(null!=(r=this.dsPart.Tables[6])&&r.length>0){if(r.Contains("BasedOn")&&!s.e.IsEmpty(r[0].BasedOn)&&(this.BasedOn.SelectedValue=r[0].BasedOn.toString()),s.e.IsEmpty(r.some((function(t){return t.hasOwnProperty("ccnid70")})))||s.e.IsEmpty(r[0].ccnid70.toString())||(this.Vattype=parseInt(r[0].ccnid70.toString())),0==this.PickCC&&(s.e.IsEmpty(r[0].SalesmanID)||""==r[0].SalesmanID.toString()||(this.Salesman.SelectedValue=parseInt(r[0].SalesmanID.toString())),s.e.IsEmpty(r[0].AccountantID)||""==r[0].AccountantID.toString()||(this.Accountant.SelectedValue=parseInt(r[0].AccountantID.toString())),s.e.IsEmpty(r[0].LandlordID)||""==r[0].LandlordID.toString()||(this.Landlord.SelectedValue=parseInt(r[0].LandlordID.toString())),s.e.IsEmpty(r[0].LocationID)||""==r[0].LocationID.toString()||(this.LocationContract.SelectedValue=parseInt(r[0].LocationID.toString()))),!s.e.IsEmpty(r[0].ccnid58)&&""!=r[0].ccnid58.toString()){var h=this.ScreenObject.GetExtrFieldByName("ccnid58");null!=h&&h instanceof l.b&&(h.SelectedValue=parseInt(r[0].ccnid58.toString()))}if(!s.e.IsEmpty(r[0].ccnid70)&&""!=r[0].ccnid70.toString()){var C=this.ScreenObject.GetExtrFieldByName("ccnid70");null!=C&&C instanceof l.b&&(C.SelectedValue=parseInt(r[0].ccnid70.toString()))}if(!s.e.IsEmpty(r[0].ccnid59)&&""!=r[0].ccnid59.toString()){var m=this.ScreenObject.GetExtrFieldByName("ccnid59");null!=m&&m instanceof l.b&&(m.SelectedValue=parseInt(r[0].ccnid59.toString()))}if(!s.e.IsEmpty(r[0].ccnid61)&&""!=r[0].ccnid61.toString()){var b=this.ScreenObject.GetExtrFieldByName("ccnid61");null!=b&&b instanceof l.b&&(b.SelectedValue=parseInt(r[0].ccnid61.toString()))}if(!s.e.IsEmpty(r[0].ccnid62)&&""!=r[0].ccnid62.toString()){var S=this.ScreenObject.GetExtrFieldByName("ccnid62");null!=S&&S instanceof l.b&&(S.SelectedValue=parseInt(r[0].ccnid62.toString()))}}o=this.FillUnitDetails(o,n,this.dsPart),this.CalculateRent()}}else("Tenant"==t.toString()||t instanceof l.b&&94==t.CCID&&this.TenantTempID!=this.Tenant.SelectedValue)&&(this.TenantTempID=this.Tenant.SelectedValue,this.PickRRfromTenant&&this.Tenant.SelectedValue>0&&(this.RentRecAc.SelectedValue=i.a.rental.GetTenantAccount(this.Tenant.SelectedValue)));t instanceof l.b&&(92==t.CCID||93==t.CCID||94==t.CCID)&&this.ScreenObject.OnGetReference(t)}this.RefreshGrid=!this.RefreshGrid,Logger.InfoLog("AddEditRenContractViewModel ::Exiting onListSelectedChanged")}catch(d){console.log("property change"),console.log(d.StackTrace)}}}},{key:"FillUnitDetails",value:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=n.Tables[5],o=0,l=0;if(this.dtParticulars=a,null!=a){if(0==this.Property.SelectedValue&&a.length>0&&(null!=a[0].ActualPropertyID&&""!=a[0].ActualPropertyID.toString()&&(this.Property.PreviousSelectedValue=parseInt(a[0].ActualPropertyID),this.Property.SelectedValue=parseInt(a[0].ActualPropertyID)),this.FillPropDetails(!0),this.GenAdvanceRentAcc>0)){var c=i.a.rental.GetAccountName(this.GenAdvanceRentAcc);null!=c&&c.Tables.length>0&&c.Tables[0].length>0&&null!=c.Tables[0][0].ACCOUNTNAME&&""!=c.Tables[0][0].ACCOUNTNAME.toString()&&(this.GenAdvanceRentAccName=c.Tables[0][0].ACCOUNTNAME.toString()),this.DataTable[0].CreditAccountID_Key=this.GenAdvanceRentAcc,this.DataTable[0].CreditAccountID=this.GenAdvanceRentAccName}if(r.length>0)if(""!=this.SelectedUnits){for(var u=0,D=0,h=this.SelectedUnits.split(","),C=0;C<h.length;C++)if(!s.e.StringIsNullOrEmpty(h[C])){var m=this.GetRent(h[C],this.dsPart,o,l);u+=o=m.Rent,D+=l=m.Disc}this.DataTable[0].Amount=u.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),this.DataTable[0].ActAmount=(u+D).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),this.DataTable[0].Discount=D.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())}else{var b=this.GetRent("",n,o,l);o=b.Rent,l=b.Disc,this.DataTable[0].Amount=o.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),this.DataTable[0].Discount=l.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),this.DataTable[0].ActAmount=(o+l).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())}this.DataTable[0].InclChkGen="1",3==this.Vattype&&this.VatonRent>0?(this.DataTable[0].VatPer=this.VatonRent,this.ScreenObject.Data.Tables.length>6&&this.ScreenObject.Data.Columns[6].Contains("TCVat")&&this.ScreenObject.Data.Tables[6].length>0&&""!=this.ScreenObject.Data.Tables[6][0].TCVat.toString()&&(this.DataTable[0].TaxCategory=this.ScreenObject.Data.Tables[6][0].TCVat.toString()),this.DataTable[0].TaxCategory_Key=3,this.DataTable[0].VatType="Exclusive"):this.ScreenObject.Data.Tables.length>6&&this.ScreenObject.Data.Columns[6].Contains("TcExcemt")&&this.ScreenObject.Data.Tables[6].length>0&&""!=this.ScreenObject.Data.Tables[6][0].TcExcemt.toString()&&(this.DataTable[0].TaxCategory=this.ScreenObject.Data.Tables[6][0].TcExcemt.toString(),this.DataTable[0].TaxCategory_Key=1),this.TaxCatFromUnit&&null!=n&&n.Columns[6].Contains("TcExcemt")&&n.Tables[6].length>0&&""!=n.Tables[6][0].ccnid60.toString()&&(this.DataTable[0].TaxCategory_Key=n.Tables[6][0].ccnid60.toString(),this.DataTable[0].TaxCategory=n.Tables[6][0].TcExcemt.toString()),this.DataTableColumns.Contains("SPType_Key")&&null!=n&&n.Columns[6].Contains("SPTypeName")&&n.Tables[6].length>0&&""!=n.Tables[6][0].ccnid61.toString()&&(this.DataTable[0].SPType_Key=n.Tables[6][0].ccnid61.toString(),this.DataTable[0].SPType=n.Tables[6][0].SPTypeName.toString()),this.DataTableColumns.Contains("Dim_Key")&&null!=n&&n.Columns[6].Contains("Dimname")&&n.Tables[6].length>0&&"0"!=n.Tables[6][0].DimNodeID.toString()&&(this.DataTable[0].Dim_Key=n.Tables[6][0].DimNodeID.toString(),this.DataTable[0].Dim=n.Tables[6][0].Dimname.toString()),50002==this.DimCCID&&this.DataTableColumns.Contains("Dim_Key")&&this.LocationContract.SelectedValue>0&&(this.DataTable[0].Dim_Key=this.LocationContract.SelectedValue,this.DataTable[0].Dim=this.LocationContract.Text),this.DataTableColumns.Contains("Location_Key")&&this.LocationContract.SelectedValue>0&&(this.DataTable[0].Location_Key=this.LocationContract.SelectedValue),this.DistribtueInvoice&&(this.DataTable[0].RecurInvoice="true");var S,d,T=0,y=0;null!=this.DataTable[0].Amount&&null!=this.DataTable[0].Amount&&(y=parseFloat(this.DataTable[0].Amount),this.OriginalRent=y),S=this.CalculateMonths(),d=S>1?s.e.Round(parseFloat(y.toString())/S,this.Mdeci):parseFloat(y.toString()),a.length>0&&null!=a[0].TermsConditions.toString()&&""!=a[0].TermsConditions.toString()&&(this.TermsConditions.Text=a[0].TermsConditions.toString());for(var g=function(t){T=0;var n=e.DataTableObj.NewRow();if(n.Recurr=!1,n.NodeID=a[t-1].NodeID.toString(),n.Particulars=a[t-1].Particulars.toString(),s.e.IsEmpty(a[t-1].CreditID)||(n.CreditAccountID_Key=a[t-1].CreditID.toString()),s.e.IsEmpty(a[t-1].DebitID)||(n.DebitAccountID_Key=a[t-1].DebitID.toString()),s.e.IsEmpty(a[t-1].BankAccountID)||(n.BankAccountID=a[t-1].BankAccountID.toString()),null!=a[t-1].AdvanceAcc&&!s.e.IsEmpty(a[t-1].AdvanceAcc)&&parseInt(a[t-1].AdvanceAcc.toString())>0&&(n.AdvanceAcc=a[t-1].AdvanceAcc.toString()),e.DataTableObj.addRow(n),""!=e.SelectedUnits){if(1!=e.DataTable.filter((function(e){return e.NodeID==a[t-1].NodeID.toString()})).length)return"continue";for(var i,r=(_toArray(i=a.filter((function(e){return e.NodeID==a[t-1].NodeID.toString()}))),i),o=0;o<r.length;o++)!s.e.IsEmpty(r[o].DiscountAmount)&&parseFloat(r[o].DiscountAmount)>0?T+=parseFloat(r[o].DiscountAmount):!s.e.IsEmpty(r[o].DiscountPercentage)&&parseFloat(r[o].DiscountPercentage)>0?T+=parseFloat(r[o].DiscountPercentage)*y/100:!s.e.IsEmpty(r[o].Months)&&parseFloat(r[o].Months)>0&&(T+=d*parseFloat(r[o].Months));n.Amount=T,!s.e.IsEmpty(a[t-1].VAT)&&parseFloat(a[t-1].VAT.toString())>0&&(n.VatPer=parseFloat(a[t-1].VAT.toString()))}else!s.e.IsEmpty(a[t-1].DiscountAmount)&&parseFloat(a[t-1].DiscountAmount)>0?T=parseFloat(a[t-1].DiscountAmount):!s.e.IsEmpty(a[t-1].DiscountPercentage)&&parseFloat(a[t-1].DiscountPercentage)>0?T=parseFloat(a[t-1].DiscountPercentage)*y/100:!s.e.IsEmpty(a[t-1].Months)&&parseFloat(a[t-1].Months)>0&&(T=d*parseFloat(a[t-1].Months)),n.Amount=T;n.Discount=0,n.ActAmount=n.Amount,!s.e.IsEmpty(a[t-1].VAT)&&""!=s.e.StringValue(a[t-1].VAT)&&parseFloat(a[t-1].VAT.toString())>0&&(n.VatPer=parseFloat(a[t-1].VAT.toString())),""!=s.e.StringValue(a[t-1].InclChkGen)&&(n.InclChkGen=a[t-1].InclChkGen.toString()),s.e.IsEmpty(a[t-1].TaxCategoryID)||""==s.e.StringValue(a[t-1].TaxCategoryID)||(n.TaxCategory_Key=a[t-1].TaxCategoryID.toString(),n.TaxCategory=a[t-1].TaxCategory.toString()),s.e.IsEmpty(a[t-1].Display)||""==a[t-1].Display.toString()||(n.Display=a[t-1].Display.toString(),"0"==n.Display.toString()&&(n.StyleHeightZero=1)),e.DataTableColumns.Contains("SPType_Key")&&!s.e.IsEmpty(a[t-1].SPType)&&""!=s.e.StringValue(a[t-1].SPType)&&(n.SPType_Key=a[t-1].SPType.toString(),n.SPType=a[t-1].SPTypeName.toString()),e.DataTableColumns.Contains("Dim_Key")&&!s.e.IsEmpty(a[t-1].Dimname)&&""!=s.e.StringValue(a[t-1].Dimname)&&(n.Dim_Key=a[t-1].DimNodeID.toString(),n.Dim=a[t-1].Dimname.toString()),e.DataTableColumns.Contains("Location_Key")&&e.LocationContract.SelectedValue>0&&(n.Location_Key=e.LocationContract.SelectedValue),n.VatType=s.e.StringValue(a[t-1].VatType),n.RecurInvoice=s.e.StringValue(a[t-1].RecurInvoice).toLowerCase(),n.PostDebit=s.e.StringValue(a[t-1].PostDebit),""!=s.e.StringValue(a[t-1].CreditName)&&(n.CreditAccountID=a[t-1].CreditName.toString()),""!=s.e.StringValue(a[t-1].DebitName)&&(n.DebitAccountID=s.e.StringValue(a[t-1].DebitName)),""!=s.e.StringValue(a[t-1].DiscountPercentage)&&(n.DiscountPercentage=s.e.StringValue(a[t-1].DiscountPercentage)),""!=s.e.StringValue(a[t-1].Months)&&(n.Months=s.e.StringValue(a[t-1].Months));for(var l=0;l<e.ContractParticular.length;l++)e.ContractParticular[l].DisplayMember.startsWith("CCNID")&&a.Columns.Contains(e.ContractParticular[l].DisplayMember)&&a.Columns.Contains(e.ContractParticular[l].ValueMember)&&""!=a[t-1][e.ContractParticular[l].DisplayMember].toString()&&(n[e.ContractParticular[l].ValueMember]=a[t-1][e.ContractParticular[l].DisplayMember].toString());e.DataTableObj.updateRow(n)},I=1;I<=a.length;I++)g(I);this.CalculateNRec()}else{if(this.DataTableObj.Clear(),this.NonRecAmount.Text="0.00",this.TotalAmount.Text="0.00",this.RecAmount.Text="0.00",0==this.DataTableObj.Table.length)for(var p=0;p<6;p++){var A=this.DataTableObj.NewRow();A.Recurr=!1,this.DataTableObj.addRow(A)}if(this.DataTable[0].Particulars="Rent",this.DataTable[0].NodeID=this.id2.toString(),this.GenAdvanceRentAcc>0&&(this.DataTable[0].CreditAccountID=this.GenAdvanceRentAccName,this.DataTable[0].CreditAccountID_Key=this.GenAdvanceRentAcc),n.Tables.length>2&&n.Tables[2].length>0){null!=n.Tables[2][0].PropertyID&&""!=n.Tables[2][0].PropertyID.toString()&&(this.Property.PreviousSelectedValue=parseInt(n.Tables[2][0].PropertyID),this.Property.SelectedValue=parseInt(n.Tables[2][0].PropertyID));var f=this.GetRent("",n,o,l);o=f.Rent,l=f.Disc,this.DataTable[0].Amount=o.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),this.DataTable[0].Discount=l.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),this.DataTable[0].ActAmount=(o+l).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())}this.DataTableObj.updateRow(this.DataTable[0])}this.OriginalRent=parseFloat(this.DataTable[0].Amount),this.RentAmt.Text=s.e.StringValue(this.DataTable[0].Amount);for(var P=0;P<6;P++){var N=this.DataTableObj.NewRow();N.Recurr=!1,this.DataTableObj.addRow(N)}return this.UpdateSequence(),t}},{key:"GetRent",value:function(t,e,a,n){var i=this;a=0,n=0;var r=null;return this.StartDate.Date&&(r=s.e.StringIsNullOrEmpty(t)?e.Tables[7].filter((function(t){return t.WEF<=i.StartDate.Date}),"WEF desc"):e.Tables[7].filter((function(e){return e.UNITID==t&&e.WEF<=i.StartDate.Date}),"WEF desc")),null!=r&&r.length>0?(s.e.IsEmpty(r[0].RENT)||(a=parseFloat(r[0].RENT.toString())),s.e.IsEmpty(r[0].DICOUNT)||(n=parseFloat(r[0].DICOUNT.toString()))):e.Tables[5].length>0&&(s.e.StringIsNullOrEmpty(t)?(s.e.IsEmpty(e.Tables[5][0].RENT)||(a=parseFloat(e.Tables[5][0].RENT)),s.e.IsEmpty(e.Tables[5][0].DICOUNT)||(n=parseFloat(e.Tables[5][0].DICOUNT))):(r=e.Tables[5].filter((function(e){return e.UnitID==t}))).length>0&&(s.e.IsEmpty(r[0].RENT)||(a=parseFloat(r[0].RENT.toString())),s.e.IsEmpty(r[0].DICOUNT)||(n=parseFloat(r[0].DICOUNT.toString())))),{Rent:a,Disc:n}}},{key:"CalculateNRec",value:function(){for(var t=this,e=0,a=0,n=0,r=0,o=0;o<this.DataTable.length;o++)if(""!=s.e.StringValue(this.DataTable[o].Amount)&&"0"!=s.e.StringValue(this.DataTable[o].Display))if(""!=s.e.StringValue(this.DataTable[o].DebitAccountID_Key)&&parseInt(this.DataTable[o].DebitAccountID_Key)>0?a+=parseFloat(this.DataTable[o].Amount):e+=parseFloat(this.DataTable[o].Amount),""!=s.e.StringValue(this.DataTable[o].VatPer)){var l=0;if(""!=s.e.StringValue(this.DataTable[o].Xml)&&this.StartDate.Date&&this.StartDate.Date<this.vatwef){var c=new s.f;if(c.LoadXml(this.DataTable[o].Xml.toString()),c.DocumentElement.children.length>0){(null!=c.DocumentElement.children[0].attributes.Filter&&0==parseInt(c.DocumentElement.children[0].attributes.Filter.value)?c.SelectNodes("XML/UnitsRow/Row"):c.SelectNodes("XML/Row")).forEach((function(e){s.e.isValidDate(e.attributes.FromDate.value)>=t.vatwef&&(l+=parseFloat(e.attributes.Amount.value))}))}}else l=parseFloat(this.DataTable[o].Amount);"Inclusive"==s.e.StringValue(this.DataTable[o].VatType)?(this.DataTable[o].TaxableAmt=(100*l/(parseFloat(this.DataTable[o].VatPer)+100)).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),this.DataTable[o].VatAmount=(l-parseFloat(this.DataTable[o].TaxableAmt)).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())):(this.DataTable[o].TaxableAmt=l,this.DataTable[o].VatAmount=(parseFloat(this.DataTable[o].TaxableAmt)*parseFloat(this.DataTable[o].VatPer)/100).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())),this.DataTable[o].VatAmount=(parseFloat(this.DataTable[o].TaxableAmt)*parseFloat(this.DataTable[o].VatPer)/100).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),n+=parseFloat(this.DataTable[o].VatAmount),"Inclusive"!=s.e.StringValue(this.DataTable[o].VatType)&&(!s.e.StringIsNullOrEmpty(this.DataTable[o].DebitAccountID_Key)&&""!=s.e.StringValue(this.DataTable[o].DebitAccountID_Key)&&parseInt(this.DataTable[o].DebitAccountID_Key)>0?a+=parseFloat(this.DataTable[o].VatAmount):e+=parseFloat(this.DataTable[o].VatAmount))}else this.DataTable[o].TaxableAmt=this.DataTable[o].Amount,this.DataTable[o].VatAmount="0";else 0==r&&(r=o);if(n>0&&!i.a.SessionManager.Preferences.ContainsKey("VATVersion"))if(this.VatNode>0){var u,D=this.DataTable.filter((function(e){return e.NodeID==t.VatNode}));D.length>0?u=D[0]:((u=this.DataTableObj.NewRow()).NodeID=this.VatNode,u.Particulars="vat",0==r?this.DataTableObj.addRow(u):this.DataTableObj.insertRowAt(u,r)),u.Amount=n,this.DataTableObj.addRow(u)}else this.DisplayMessage="Define Vat Node.",this.MessageVisibility=!0;this.RecAmount.Text=e.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),this.NonRecAmount.Text=a.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),this.TotalAmount.Text=(a+e).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())}},{key:"OnYearChange",value:function(t){this.yr&&(this.mn=!1,""!=this.TotalYears.Text&&s.e.ValidateInt(this.TotalYears.Text)?(parseInt(this.TotalYears.Text)>0&&(this.EndDate.Date="30"==this.DaysCount&&this.StartDate.Date?this.StartDate.Date.AddYears(parseInt(this.TotalYears.Text)):"30"==this.DaysCount?(new Date).AddYears(s.e.IntTryParse(this.TotalYears.Text)):"30"!=this.DaysCount&&this.StartDate.Date?this.StartDate.Date.AddYears(s.e.IntTryParse(this.TotalYears.Text)).AddDays(-1):(new Date).AddYears(s.e.IntTryParse(this.TotalYears.Text)).AddDays(-1)),this.MessageVisibility=!1):s.e.StringIsNullOrEmpty(this.TotalYears.Text)||(this.DisplayMessage=i.a.GetResource("InvalidFormat"),this.MessageVisibility=!0),this.mn=!0)}},{key:"OnGracePeriodChange",value:function(t){var e;e=parseInt(this.GracePeriod.Text),this.EndDate.Date&&(this.ExpectedEndDate.Date=this.EndDate.Date.AddDays(e))}},{key:"OnMonthChange",value:function(t){this.mn&&(this.yr=!1,""!=this.Months.Text&&s.e.ValidateInt(this.Months.Text)&&this.StartDate.Date?parseInt(this.Months.Text)>0&&(this.EndDate.Date=this.StartDate.Date.AddMonths(parseInt(this.Months.Text)).AddDays(-1)):""!=this.Months.Text&&s.e.ValidateInt(this.Months.Text)?parseInt(this.Months.Text)>0&&(this.EndDate.Date=(new Date).AddMonths(s.e.IntTryParse(this.Months.Text)).AddDays(-1)):(this.DisplayMessage=i.a.GetResource("InvalidFormat"),this.MessageVisibility=!0),this.yr=!0),this.CalculateRent()}},{key:"OnContractDateChanged",value:function(t){this.ExtndTill.Date=this.ContractDate.Date.AddDays(this.ValidTill)}},{key:"OnselectionChange",value:function(t){if(Logger.InfoLog("AddEditRenContractViewModel ::Entering OnselectionChange"),this.StartDate.Date){if(null!=this.EndDate.Date&&this.StartDate.Date>this.EndDate.Date)return this.DisplayMessage="End Date cannot be less than Start Date",this.TotalDays.Text="",void(this.MessageVisibility=!0);null!=this.EndDate.Date&&this.StartDate.Date<=this.EndDate.Date?(this.MessageVisibility=!1,""==this.DaysCount||""==this.Months.Text||"0"==this.Months.Text?this.StartDate.Date&&(this.TotalDays.Text=Math.round(this.EndDate.Date.Subtract(this.StartDate.Date).Days+1).toString(),this.CalcMonthandYear()):""!=this.Months.Text&&(this.TotalDays.Text=Math.round(30*parseInt(this.Months.Text)).toString()),this.CalculateRentBaedOnDays(0,!this.CalculateRentAmountInDays)):(this.CalculateRentBaedOnDays(0,!0),this.TotalDays.Text="0",this.Months.Text="0",this.TotalYears.Text="0")}else if(0==this.SaveAndPrintContactID)return this.DisplayMessage=i.a.GetResource("PleaseSelectStartDate"),this.TotalDays.Text="",void(this.MessageVisibility=!0);""==s.e.StringValue(this.GracePeriod.Text)&&(this.GracePeriod.Text="0");var e=0;t==this.EndDate&&this.EndDate.Date?(e=parseInt(this.GracePeriod.Text),this.ExpectedEndDate.Date=this.EndDate.Date.AddDays(e)):t==this.ExpectedEndDate&&this.EndDate.Date&&this.ExpectedEndDate.Date&&(this.GracePeriod.Text=this.ExpectedEndDate.Date.Subtract(this.EndDate.Date).Days.toString()),this.CalculateRent(),Logger.InfoLog("AddEditRenContractViewModel ::Exiting OnselectionChange")}},{key:"CalcMonthandYear",value:function(){var t=new T.a,e=new Y.c;e.setFieldDetails("StartDate",1,1,"",1,!1,!1),t.push("StartDate",e),(e=new Y.c).setFieldDetails("EndDate",4,1,"",1,!1,!1),t.push("EndDate",e),t.StartDate.setFieldValue(this.StartDate.Date.Date()),t.EndDate.setFieldValue(this.EndDate.Date.Date());var a=t;this.Months.Text=i.a.eval.EvaluateExpression('DATEDIFF("m",EndDate,StartDate)',a).toString(),this.TotalYears.Text=i.a.eval.EvaluateExpression('DATEDIFF("y",EndDate,StartDate)',a).toString()}},{key:"CalculateRentBaedOnDays",value:function(t,e){if((this.CalculateRentAmountInDays||e&&null!=this.dsPart&&this.dsPart.Tables.length>5&&this.dsPart.Tables[5].length>0)&&null!=this.dsPart&&this.dsPart.Tables.length>4&&this.dsPart.Tables[5].length>0){0==t&&(t=parseFloat(this.TotalDays.Text));var a=0,n=0;if(""!=this.SelectedUnits){for(var r=0,o=0,l=this.SelectedUnits.split(","),c=0;c<l.length;c++)if(!s.e.StringIsNullOrEmpty(l[c])){var u=this.GetRent(l[c],this.dsPart,a,n);r+=a=u.Rent,o+=n=u.Disc}e||(r=r/365*t,o=o/365*t),this.DataTable[0].Amount=r.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),this.DataTable[0].ActAmount=(r+o).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),this.DataTable[0].Discount=o.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())}else{var D=this.GetRent("",this.dsPart,a,n);a=D.Rent,n=D.Disc,e||(a=a/365*t,n=n/365*t),this.DataTable[0].Amount=a.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),this.DataTable[0].Discount=n.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),this.DataTable[0].ActAmount=(a+n).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())}this.OriginalRent=parseFloat(this.DataTable[0].Amount),this.RentAmt.Text=this.DataTable[0].Amount.toString(),this.CalculateNRec(),this.CalculateFooter()}}},{key:"FilterXML",value:function(){var t="",e=new Date;return t+="<XML>",t+="<Row ",t+=' ColID="FROMDATE"',t+=this.StartDate.Date>this.ContractDate.Date?' Value="'+this.ContractDate.Date.ToString("dd MMM yyyy")+'"':this.StartDate.Date?' Value="'+this.StartDate.Date.ToString("dd MMM yyyy")+'"':' Value="'+e.ToString("dd MMM yyyy")+'"',t+=" />",t+="<Row ",t+=' ColID="TODATE"',t+=this.EndDate.Date?' Value="'+this.EndDate.Date.ToString("dd MMM yyyy")+'"':' Value="'+e.ToString("dd MMM yyyy")+'"',t+=" />","True"==i.a.SessionManager.Preferences.EnableLocationWise.toString()&&"True"==i.a.SessionManager.Preferences["LW Reports"]&&"True"==i.a.SessionManager.Preferences.LWAccPeriod&&this.LocationContract.SelectedValue>0&&(t+="<Row ",t+=' ColID="50002"',t+=' Value="'+this.LocationContract.SelectedValue.toString()+'"',t+=" />"),t+="<Row ",t+=' ColID="CONTRACTNODEID"',t+=' Value="'+this.ContractID+'"',t+=" />",t+="<Row ",t+=' ColID="CONTRACTRefCCID"',t+=' Value="'+this.CurrCostCenterID+'"',t+=" />",(t+="</XML>").toString()}},{key:"OnSave",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Object(n.b)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var o,l,u,D,h,C,m,b,S,d,T,y,g,I,p,A,f,P,N,V,E,v,O,w,L,x,j,F,B,U,K=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(Logger.InfoLog("AddEditRenContractViewModel ::Entering OnSave"),o=0,this.ButtonsPopUp=!1,"GeneralLedger"!=t){n.next=14;break}return n.next=5,Promise.all([a.e(2),a.e(1),a.e(3),a.e(5),a.e(4),a.e(6),a.e(7),a.e(10),a.e(9),a.e(8),a.e(12),a.e(11),a.e(13),a.e(19),a.e(15),a.e(21),a.e(20),a.e(16),a.e(14),a.e(18),a.e(17),a.e(22),a.e(23),a.e(24),a.e(25),a.e(28),a.e(30),a.e(29),a.e(32),a.e(31),a.e(27),a.e(26),a.e(35),a.e(37),a.e(38),a.e(36),a.e(33),a.e(34),a.e(39),a.e(40),a.e(41),a.e(212)]).then(a.bind(null,"ThYU"));case 5:return u=n.sent,D=u.ReportViewModel,n.next=9,Promise.all([a.e(32),a.e(37)]).then(a.bind(null,"YU11"));case 9:h=n.sent,C=h.ReportViewComponent,i.a.page.ShowLoading=!0,l=this.FilterXML(),setTimeout((function(){if(i.a.page.ShowLoading=!1,104==K.CurrCostCenterID){var t=new D;t.ReportViewModel_Document(104,l,2,!1,null,null),t.DocumentObject=K,t.TransferData=K,i.a.page.addNewTab({component:C,params:{obj:t}})}else{var e,a=K.ScreenObject.Data.Tables[5].filter((function(t){return"RenGeneralLedger"==t.Name}));if(a.length>0)if((e=s.e.IntTryParse(a[0].Value.toString()))>0){var n=new D;n.ReportViewModel_Document(95,l,e,!1,null,null),i.a.page.addNewTab({component:C,params:{obj:n}})}}}),1e3),n.next=194;break;case 14:if("GenerateLink"!=t){n.next=34;break}if(m=new Array,this.DataTable.length>0&&!s.e.IsEmpty(this.DataTable[0].Xml)&&((b=new s.f).LoadXml(this.DataTable[0].Xml.toString()),S=-1,b.ChildNodes.length>0&&null!=b.ChildNodes[0].Attributes&&null!=b.ChildNodes[0].attributes.Filter&&!s.e.StringIsNullOrEmpty(b.ChildNodes[0].attributes.Filter.value)&&(S=parseInt(b.ChildNodes[0].attributes.Filter.value)),2==S||-1==S?(d=new Date,T=new Date,b.ChildNodes[0].ChildNodes.forEach((function(t){s.e.isValidDate(t.attributes.FromDate.value)&&(d=new Date(t.attributes.FromDate.value)),s.e.isValidDate(t.attributes.ToDate.value)&&(T=new Date(t.attributes.ToDate.value)),null==t.attributes.Period||s.e.StringIsNullOrEmpty(t.attributes.Period.value)?m.push(c.d.ComboBoxItems_4(d.ToString(i.a.SessionManager.Preferences["Date Format"])+" - "+T.ToString(i.a.SessionManager.Preferences["Date Format"]),d.ToString("dd/MMM/yyyy"),T.ToString("dd/MMM/yyyy"),t.attributes.Amount.value)):m.push(c.d.ComboBoxItems_7(d.ToString(i.a.SessionManager.Preferences["Date Format"])+" - "+T.ToString(i.a.SessionManager.Preferences["Date Format"]),d.ToString("dd/MMM/yyyy"),T.ToString("dd/MMM/yyyy"),t.attributes.Amount.value,parseInt(t.attributes.Period.value)))}))):0==S&&(y=b.SelectNodes("XML/UnitsRow/Row"),g=new Date,I=new Date,y.forEach((function(t){s.e.isValidDate(t.attributes.FromDate.value)&&(g=new Date(t.attributes.FromDate.value)),s.e.isValidDate(t.attributes.ToDate.value)&&(I=new Date(t.attributes.ToDate.value));var e=m.find((function(t){return!s.e.StringIsNullOrEmpty(t.Value)&&!s.e.StringIsNullOrEmpty(t.Parent)&&new Date(t.Value)==g&&new Date(t.Parent)==I}));null!=e&&null!=e?e.Aliasname=(parseFloat(e.Aliasname)+parseFloat(t.attributes.Amount.value)).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()):null==t.attributes.Period||s.e.StringIsNullOrEmpty(t.attributes.Period.value)?m.push(c.d.ComboBoxItems_4(g.ToString(i.a.SessionManager.Preferences["Date Format"])+" - "+I.ToString(i.a.SessionManager.Preferences["Date Format"]),g.ToString("dd/MMM/yyyy"),I.ToString("dd/MMM/yyyy"),t.attributes.Amount.value)):m.push(c.d.ComboBoxItems_7(g.ToString(i.a.SessionManager.Preferences["Date Format"])+" - "+I.ToString(i.a.SessionManager.Preferences["Date Format"]),g.ToString("dd/MMM/yyyy"),I.ToString("dd/MMM/yyyy"),t.attributes.Amount.value,parseInt(t.attributes.Period.value)))})))),!(m.length>0)||103==this.CurrCostCenterID&&2==this.QuotLink){n.next=30;break}return n.next=20,a.e(68).then(a.bind(null,"Rr92"));case 20:return p=n.sent,A=p.UpdatePayTermsViewModel,n.next=24,a.e(0).then(a.bind(null,"++ql"));case 24:f=n.sent,P=f.UpdatepaytermsComponent,(N=new A("AddEditRenContractViewModel")).UpdatePayTermsViewModel_1(this,null,m),i.a.page.ShowDialog(N,P,{Title:"Distribute",HideClose:!0,ShowCenter:!0}),n.next=31;break;case 30:this.GenerateContract();case 31:setTimeout((function(){K.iSGenerate=!1}),500),n.next=194;break;case 34:if("Email"!=t){n.next=39;break}null!=(V=i.a.common.GetDataTable("AERC001",this.Tenant.SelectedValue.toString()))&&V.length>0&&(this.Email=s.e.StringValue(V[0].Email)),this.ContractID>0&&i.a.page.ShowDialog(new k.SendEmailSMSViewModel(!0,this.CostCenterID,this.ContractID,this),_.SendEmailSMSComponent),n.next=194;break;case 39:if("Cheque"!=t){n.next=50;break}if(event.preventDefault(),0!=this.Unit.SelectedValue||this.IsMultiunit&&""!=this.SelectedUnits||104==this.CurrCostCenterID){n.next=42;break}return n.abrupt("return",(this.DisplayMessage=i.a.GetResource("PleaseselectUnit"),void(this.MessageVisibility=!0)));case 42:if(null!=this.DataTable[0].Amount&&(null==this.DataTable[0].Amount||""==this.DataTable[0].Amount.toString()||0!=parseInt(this.DataTable[0].Amount))){n.next=44;break}return n.abrupt("return",(this.DisplayMessage="Please enter Amount",void(this.MessageVisibility=!0)));case 44:if(""!=this.TotalDays.Text&&(""==this.TotalDays.Text||0!=parseInt(this.TotalDays.Text))){n.next=46;break}return n.abrupt("return",(this.DisplayMessage="Total Days should be greater than 0",void(this.MessageVisibility=!0)));case 46:(E=new R(this)).oparent=this,i.a.page.ShowDialog(E,M.a,{HideClose:!0,ShowCenter:!0,Title:E.DisplayName}),n.next=194;break;case 50:if("LoadDraft"!=t){n.next=54;break}this.DocumentDraftsPopup(1),n.next=194;break;case 54:if("Save"!=t&&"AutoSave"!=t&&"SaveDraft"!=t){n.next=183;break}if(i.a.page.ShowLoading=!0,setTimeout((function(){i.a.page.ShowLoading=!1}),500),103==this.CurrCostCenterID&&this.ContractID>0&&null!=(v=i.a.rental.GetQuotationDetails(this.ContractID))&&v.Tables.length>0&&v.Tables[0].length>0&&(this.ContractExists=Object(r.j)(v.Tables[0][0].ContractExists.toString())),n.prev=56,!this.ContractExists||129!=this.CurrCostCenterID&&103!=this.CurrCostCenterID){n.next=59;break}return n.abrupt("return",(this.DisplayMessage=129==this.CurrCostCenterID?"Contract prepared for this reservation,Can not update data":"Reservation prepared for this quotation,Can not update data",void(this.MessageVisibility=!0)));case 59:if(95!=this.CostCenterID||0!=this.ContractID||!this.MandatoryLinking||"426"!=this.StatusID.SelectedValue||0!=this.LinkedQuotationID){n.next=61;break}return n.abrupt("return",(this.DisplayMessage="Mandatory Linking,Can not create contract directly",void(this.MessageVisibility=!0)));case 61:if(this.SaveAndPrintContactID=0,this.SaveAndPrintStatusID=0,"AutoSave"!=t&&this.validate(t)){n.next=176;break}if(this.cntrct.ContractID=this.ContractID,this.cntrct.ContractPrefix=this.ContractNumber.ComboBox.SelectedValue,null!=this.ContractNumber.TextBox.Text){n.next=64;break}return n.abrupt("return",(this.DisplayMessage="Please enter Contract Number",void(this.MessageVisibility=!0)));case 64:if(this.cntrct.ContractNumber=parseInt(this.ContractNumber.TextBox.Text),this.cntrct.ContractDate=new Date(this.ContractDate.Date).ToString("dd-MMM-yyyy"),"451"==this.StatusID.SelectedValue&&(this.StatusID.SelectedValue=this.RenewRefID>0?"427":"426"),this.cntrct.StatusID=""!=this.StatusID.SelectedValue?parseInt(this.StatusID.SelectedValue):426,this.SaveAndPrintStatusID=this.cntrct.StatusID,this.cntrct.BasedOn=s.e.StringIsNullOrEmpty(this.BasedOn.SelectedValue)?"Monthly":this.BasedOn.SelectedValue,this.cntrct.RentAmt=this.RentAmt.Visible&&!s.e.StringIsNullOrEmpty(this.RentAmt.Text)?parseFloat(this.RentAmt.Text):0,this.cntrct.IsExtended=!(!this.IsExtended.Visible||s.e.StringIsNullOrEmpty(this.IsExtended.SelectedValue))&&Object(r.j)(this.IsExtended.SelectedValue),this.Property.SelectedValue>0){n.next=66;break}return n.abrupt("return",(this.DisplayMessage="Please select property",void(this.MessageVisibility=!0)));case 66:if(this.cntrct.PropertyID=this.Property.SelectedValue,104==this.CurrCostCenterID){n.next=74;break}if(!this.IsMultiunit||""==this.SelectedUnits){n.next=71;break}this.cntrct.MultiIDS=this.SelectedUnits,this.cntrct.multiName=this.StrMultiple,n.next=74;break;case 71:if(this.Unit.SelectedValue>0){n.next=73;break}return n.abrupt("return",(this.DisplayMessage=i.a.GetResource("PleaseselectUnit"),void(this.MessageVisibility=!0)));case 73:this.cntrct.UnitID=this.Unit.SelectedValue;case 74:if(this.Tenant.SelectedValue>0){n.next=76;break}return n.abrupt("return",(this.DisplayMessage="Please select Tenant",void(this.MessageVisibility=!0)));case 76:if(this.cntrct.TenantID=this.Tenant.SelectedValue,!(this.RentRecAc.SelectedValue>0)){n.next=80;break}this.cntrct.RentRecID=this.RentRecAc.SelectedValue,n.next=82;break;case 80:if(95!=this.CurrCostCenterID&&104!=this.CurrCostCenterID){n.next=82;break}return n.abrupt("return",(95==this.CurrCostCenterID?this.DisplayMessage="Please select Rent Recievable A/c":104==this.CurrCostCenterID&&(this.DisplayMessage="Please select Rent Payable A/c"),void(this.MessageVisibility=!0)));case 82:if(!(this.IncomeAc.SelectedValue>0)){n.next=86;break}this.cntrct.IncomeID=this.IncomeAc.SelectedValue,n.next=88;break;case 86:if(95!=this.CurrCostCenterID&&104!=this.CurrCostCenterID){n.next=88;break}return n.abrupt("return",(95==this.CurrCostCenterID?this.DisplayMessage="Please select Income A/c":104==this.CurrCostCenterID&&(this.DisplayMessage="Please select Expense A/c"),void(this.MessageVisibility=!0)));case 88:if(!(this.Salesman.SelectedValue>0)){n.next=92;break}this.cntrct.SalesmanID=this.Salesman.SelectedValue,n.next=94;break;case 92:if(95!=this.CurrCostCenterID&&104!=this.CurrCostCenterID){n.next=94;break}return n.abrupt("return",(this.DisplayMessage="Please select Salesman",void(this.MessageVisibility=!0)));case 94:if(!(this.Accountant.SelectedValue>0)){n.next=98;break}this.cntrct.AccountantID=this.Accountant.SelectedValue,n.next=100;break;case 98:if(95!=this.CurrCostCenterID&&104!=this.CurrCostCenterID){n.next=100;break}return n.abrupt("return",(this.DisplayMessage="Please select Accountant",void(this.MessageVisibility=!0)));case 100:if(!(this.Landlord.SelectedValue>0)){n.next=104;break}this.cntrct.LandlordID=this.Landlord.SelectedValue,n.next=106;break;case 104:if(95!=this.CurrCostCenterID&&104!=this.CurrCostCenterID){n.next=106;break}return n.abrupt("return",(this.DisplayMessage="Please select Landlord",void(this.MessageVisibility=!0)));case 106:if(!s.e.StringIsNullOrEmpty(this.TotalDays.Text)&&(s.e.StringIsNullOrEmpty(this.TotalDays.Text)||0!=parseInt(this.TotalDays.Text))){n.next=108;break}return n.abrupt("return",(this.DisplayMessage="Please select dates",void(this.MessageVisibility=!0)));case 108:if(this.cntrct.Purpose=this.Purpose.Text,this.cntrct.Narration=this.Narration.Text,!(this.LocationContract.SelectedValue>0)){n.next=112;break}this.cntrct.LocationID=this.LocationContract.SelectedValue,n.next=118;break;case 112:if(!this.LocationContract.Visible){n.next=117;break}if(95!=this.CurrCostCenterID&&104!=this.CurrCostCenterID){n.next=115;break}return n.abrupt("return",(this.DisplayMessage="Please select Location ",void(this.MessageVisibility=!0)));case 115:n.next=118;break;case 117:this.cntrct.LocationID=1;case 118:if(!(this.DivisionContract.SelectedValue>0&&this.DivisionContract.Visible)){n.next=122;break}this.cntrct.DivisionID=this.DivisionContract.SelectedValue,n.next=128;break;case 122:if(!this.DivisionContract.Visible){n.next=127;break}if(95!=this.CurrCostCenterID&&104!=this.CurrCostCenterID){n.next=125;break}return n.abrupt("return",(this.DisplayMessage="Please select Division ",void(this.MessageVisibility=!0)));case 125:n.next=128;break;case 127:this.cntrct.DivisionID=1;case 128:if(!(this.CurrencyContract.SelectedValue>0&&this.CurrencyContract.Visible)){n.next=132;break}this.cntrct.CurrencyID=this.CurrencyContract.SelectedValue,n.next=138;break;case 132:if(!this.CurrencyContract.Visible){n.next=137;break}if(95!=this.CurrCostCenterID&&104!=this.CurrCostCenterID){n.next=135;break}return n.abrupt("return",(this.DisplayMessage="Please select Currency ",void(this.MessageVisibility=!0)));case 135:n.next=138;break;case 137:this.cntrct.CurrencyID=1;case 138:if(null==this.TotalAmount.Text||""==this.TotalAmount.Text){n.next=142;break}this.cntrct.TotalAmount=parseFloat(this.TotalAmount.Text),n.next=144;break;case 142:if(95!=this.CurrCostCenterID&&104!=this.CurrCostCenterID){n.next=144;break}return n.abrupt("return",(this.DisplayMessage="Please enter Amount",void(this.MessageVisibility=!0)));case 144:if(this.cntrct.NonRecurAmount=null!=this.NonRecAmount.Text&&""!=this.NonRecAmount.Text?parseFloat(this.NonRecAmount.Text):0,this.cntrct.RecurAmount=null!=this.RecAmount.Text&&""!=this.RecAmount.Text?parseFloat(this.RecAmount.Text):0,this.cntrct.TermsConditions=null!=this.TermsConditions.Text&&""!=this.TermsConditions.Text?this.TermsConditions.Text:"",this.cntrct.ContractXMLQuery=this.GetContractDetailsXML(),this.cntrct.PayTermXMLQuery=this.GetPayTermsXML(),this.cntrct.GracePeriod=this.EnableGracePeriod&&!s.e.StringIsNullOrEmpty(this.GracePeriod.Text)&&parseInt(this.GracePeriod.Text)>0?parseInt(this.GracePeriod.Text):0,this.cntrct.StartDate=this.StartDate.Date?new Date(this.StartDate.Date).ToString("dd-MMM-yyyy"):new Date,this.EnableGracePeriod&&this.ExpectedEndDate.Date?(this.EndDate.Date&&(this.cntrct.ExpectedEndDate=new Date(this.EndDate.Date).ToString("dd-MMM-yyyy")),this.cntrct.EndDate=new Date(this.ExpectedEndDate.Date).ToString("dd-MMM-yyyy")):(this.cntrct.ExpectedEndDate=new Date("1/JAN/1900"),this.EndDate.Date&&(this.cntrct.EndDate=new Date(this.EndDate.Date).ToString("dd-MMM-yyyy"))),this.cntrct.ExtndTill=this.ExtndTill.Date?new Date(this.ExtndTill.Date).ToString("dd-MMM-yyyy"):new Date(this.EndDate.Date).ToString("dd-MMM-yyyy"),this.cntrct.SelectedNodeID=0==this.SelectedNodeID?1:this.SelectedNodeID,104==this.CurrCostCenterID&&s.e.StringValue(""==this.cntrct.UnitID)&&(this.cntrct.UnitID=0),"SaveDraft"!=t&&(95==this.CurrCostCenterID||104==this.CurrCostCenterID)){n.next=154;break}if(129==this.CurrCostCenterID&&!this.DonotpostDocs){n.next=149;break}this.cntrct.PostPDRecieptXML="",n.next=152;break;case 149:if(w=this.GetReceipts(0,O),this.cntrct.PostPDRecieptXML=w.sbIssue,!((O=w.Count)>1)){n.next=152;break}return n.abrupt("return",(this.DisplayMessage="Payment terms can not be more than one in reservation.",void(this.MessageVisibility=!0)));case 152:n.next=157;break;case 154:null!=(L=i.a.rental.GetPostingDetails(this.cntrct,0,this.CurrCostCenterID,0,0,0,this.cntrct.PropertyID,this.cntrct.UnitID,this.cntrct.TenantID,this.cntrct.RentRecID))&&L.Tables.length>0&&(this.ProductID=parseInt(L.Tables[0][0].PRODUCTID.toString()),this.GetCCData(L.Tables[0]),x=!1,s.e.IsEmpty(L.Tables[0][0].IsBillwise)||(x=Object(r.j)(L.Tables[0][0].IsBillwise.toString())),this.IsOpening?(this.cntrct.PostSalesInvXML=this.GetOpeningSales(),this.cntrct.PostPDRecieptXML=this.GetOpeningPayXML()):(this.dsprof=null,this.cntrct.PostSalesInvXML=this.GetSalesInvXML(x,L.Tables[0]),this.cntrct.PostRecieptXML=104==this.CurrCostCenterID?"":this.GetReceiptXML(x),this.cntrct.PostPDRecieptXML=this.GetPDReceiptXML(x),this.cntrct.PostPartRecXML=this.GetPartReceiptXML(x)),this.cntrct.PostRentRecXML=!this.nomonthlyincome||!L.Columns[0].Contains("PostIncome")||s.e.IsEmpty(L.Tables[0][0].PostIncome)||"false"!=L.Tables[0][0].PostIncome.toString().toLowerCase()&&"0"!=L.Tables[0][0].PostIncome.toString().toLowerCase()?this.GetRentReceiptXML(!0):this.GetRentReceiptXML(!1)),104==this.CurrCostCenterID&&(this.cntrct.UnitID=-1),this.cntrct.WONO=this.strContractNo,this.cntrct.ActivityXML=null!=this.ViewActivities?this.ViewActivities.ActivitiesXML():"";case 157:if(j="","SaveDraft"!=t&&(j=this.ScreenObject.ValidateData()),!(j.length>0)){n.next=160;break}return n.abrupt("return",(this.MessageVisibility=!0,void(this.DisplayMessage=j)));case 160:if(this.cntrct.CustomFieldsQuery=this.ScreenObject.GetCustomFieldsQuery(),"SaveDraft"==t||103!=this.CurrCostCenterID&&129!=this.CurrCostCenterID||null!=(F=i.a.rental.GetPostingDetails(this.cntrct,0,this.CurrCostCenterID,0,0,0,this.cntrct.PropertyID,this.cntrct.UnitID,this.cntrct.TenantID,this.cntrct.RentRecID))&&F.Tables.length>0&&this.GetCCData(F.Tables[0]),"",this.LocationContract.Visible&&this.LocationContract.SelectedValue>0&&" CCNID2="+this.LocationContract.SelectedValue+",",this.cntrct.CustomCostCenterFieldsQuery=this.strCCQry.toString().split("dcCCNID").join("CCNID"),this.cntrct.CostCenterID=this.CurrCostCenterID,n.prev=163,B=this.ScreenObject.Data.Tables[5].filter((function(t){return"MandatoryAttachments"==t.Name})),_toArray(B),!((U=B).length>0&&!s.e.IsEmpty(U[0].Value)&&Object(r.j)(U[0].Value))||null!=this.ViewAttachments&&0!=this.ViewAttachments.AttachmentsList.length){n.next=167;break}return n.abrupt("return",(this.DisplayMessage="No Attachments added.",void(this.MessageVisibility=!0)));case 167:this.cntrct.AttachmetsXML=this.ViewAttachments.GetXML(),n.next=173;break;case 170:return n.prev=170,n.t0=n.catch(163),n.abrupt("return",(this.DisplayMessage=i.a.GetResource("Upload_Path_notExists"),void(this.MessageVisibility=!0)));case 173:if(this.cntrct.NotesXML=this.ViewNotes.GetXML(),this.cntrct.Wid=129!=this.CurrCostCenterID&&103!=this.CurrCostCenterID||!this.ContractExists?this.ScreenObject.CheckWorkFlow():0,this.cntrct.RecurDuration=this.DistribtueInvoice&&!s.e.StringIsNullOrEmpty(this.RecurDuration.Text)&&parseInt(this.RecurDuration.Text.toString())>0?parseInt(this.RecurDuration.Text):0,this.ParentContractID>0?(this.cntrct.parContractID=this.ParentContractID,s.e.StringIsNullOrEmpty(this.RefNo.Text)||(this.cntrct.Refno=parseInt(this.RefNo.Text))):this.cntrct.Refno=this.cntrct.parContractID=0,this.ScreenObject.ValidateDataonSave()){n.next=175;break}return n.abrupt("return");case 175:this.cntrct.IsOpening=this.IsOpening,"SaveDraft"==t||95!=this.CurrCostCenterID&&104!=this.CurrCostCenterID?("SaveDraft"==t?(this.cntrct.StatusID=430,this.cntrct.ContractID=this.draftid):103!=this.CurrCostCenterID&&129!=this.CurrCostCenterID||430!=this.cntrct.StatusID?"469"==this.StatusID.SelectedValue&&(this.cntrct.StatusID=426):(this.cntrct.StatusID=426,this.cntrct.ContractID=this.draftid),i.a.rental.SaveQuotation(this.cntrct,this.cntrct.ExtndTill,this.LinkedQuotationID).subscribe((function(e){K.DisplayMessage=e.Message,(o=e.RetValue)>0&&K.ClearCallBack(o,t)}),(function(t){alert(JSON.stringify(t)),console.log("SaveQuotation : "+JSON.stringify(t))}))):(430==this.cntrct.StatusID&&(this.cntrct.StatusID=426),i.a.rental.SaveContract(this.cntrct,this.RenewRefID,this.LinkedQuotationID).subscribe((function(a){K.DisplayMessage=a.Message,o=a.RetValue,e.RetValue=o,o>0&&K.ClearCallBack(o,t)}),(function(t){alert(JSON.stringify(t)),console.log("SaveContract : "+JSON.stringify(t))}))),this.MessageVisibility=!0,Logger.InfoLog("AddEditRenContractViewModel :: Entering OnSaveContract ");case 176:n.next=181;break;case 178:n.prev=178,n.t1=n.catch(56),Logger.ErrorLog("AddEditRenContractViewModel :: OnSaveContract"+n.t1.stack);case 181:n.next=194;break;case 183:if("SaveAndPrint"!=t){n.next=187;break}this.IsSavePrintClick=!0,this.OnSave("Save",""),n.next=194;break;case 187:if("PrintPreview"!=t&&"Print"!=t&&"Export"!=t){n.next=193;break}if(!("466"==this.StatusID.SelectedValue&&!i.a.SessionManager.IsActionAssigned(this.CostCenterID,"Print/Export Approved")||"440"==this.StatusID.SelectedValue&&!i.a.SessionManager.IsActionAssigned(this.CostCenterID,"Print/Export Un-Approved")||"470"==this.StatusID.SelectedValue&&!i.a.SessionManager.IsActionAssigned(this.CostCenterID,"Print/Export Rejected"))){n.next=190;break}return n.abrupt("return",(this.DisplayMessage="print restricted.",void(this.MessageVisibility=!0)));case 190:"Export"==t?this.Export("Export"):"Print"!=t&&"PrintPreview"!=t||this.Export("Print"),n.next=194;break;case 193:this.OnCustomizeExtraFields(t);case 194:case"end":return n.stop()}}),n,this,[[56,178],[163,170]])})))}},{key:"RenewSubContracts",value:function(t,e){return Object(n.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,s,r,o,l,c,u,h,C;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return 1==t?t=4:2==t?t=6:3==t?t=5:10==t&&(t=3),e.next=3,a.e(68).then(a.bind(null,"Rr92"));case 3:return n=e.sent,s=n.UpdatePayTermsViewModel,e.next=7,a.e(0).then(a.bind(null,"++ql"));case 7:if(r=e.sent,o=r.UpdatepaytermsComponent,null!=(l=i.a.rental.GetSubContracts(this.RenewRefID))&&l.Tables.length>0&&l.Tables[0].length>0){for((c=new s("AddEditRenContractViewModel")).UpdatePayTermsViewModel_1(this,null,null,t),c.PstDocGrid.Columns=[],c.PstDocGrid.SelectAll.Visible=!0,(u=new D.a).Header="select",u.DisplayMember="Select",u.DataType="CheckBox",u.ReadOnly=!0,u.Width=80,c.PstDocGrid.Columns.push(u),(u=new D.a).Header="Tracking No.",u.DisplayMember="Sno",u.ReadOnly=!0,u.DisableTab=!0,u.Width=120,c.PstDocGrid.Columns.push(u),(u=new D.a).Header="Unit",u.DisplayMember="Unit",u.ReadOnly=!0,u.DisableTab=!0,u.Width=120,c.PstDocGrid.Columns.push(u),c.PstDocGrid.Width="450",c.PstDocGrid.Table=[],c.PstDocGrid.TableColumns.push("Select"),c.PstDocGrid.TableColumns.push("Sno"),c.PstDocGrid.TableColumns.push("Unit"),c.PstDocGrid.TableColumns.push("ContractID"),h=0;h<l.Tables[0].length;h++)(C=c.PstDocGrid.NewRow()).ContractID=l.Tables[0][h].ContractID.toString(),C.sno=l.Tables[0][h].sno.toString(),C.Unit=l.Tables[0][h].Name.toString(),C.Select=!1,c.PstDocGrid.addRow(C);i.a.page.ShowDialog(c,o,{Title:c.DisplayName,HideClose:!0,ShowCenter:!0})}case 11:case"end":return e.stop()}}),e,this)})))}},{key:"GenerateContract",value:function(){var t,e=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=new A;t=o.AddEditRenContractViewModel_1(103==this.CurrCostCenterID&&2==this.QuotLink?129:95,0,!1,0,0,""),(t=o).PropID=this.Property.SelectedValue,t.Property.SelectedValue=this.Property.SelectedValue,t.ContractNumber.ComboBox.SelectedValue=this.Property.SelectedValue.toString(),t.OnContractPrefixChanged(t.ContractNumber.ComboBox.SelectedValue),this.multiVisi&&""!=this.SelectedUnits?(t.StrMultiple=this.StrMultiple,t.SelectedUnits=this.SelectedUnits,t.Property.Enable=!1,t.multiVisi=!0):(t.UnitTempID=this.Unit.SelectedValue,t.Unit.SelectedValue=this.Unit.SelectedValue),t.Vattype=this.Vattype,t.iSGenerate=!0,t.RentRecAc.SelectedValue=this.RentRecAc.SelectedValue,t.Tenant.SelectedValue=this.Tenant.SelectedValue,t.IncomeAc.SelectedValue=this.IncomeAc.SelectedValue,t.LocationContract.SelectedValue=this.LocationContract.SelectedValue,t.DivisionContract.SelectedValue=this.DivisionContract.SelectedValue,t.Salesman.SelectedValue=this.Salesman.SelectedValue,t.Landlord.SelectedValue=this.Landlord.SelectedValue,t.Accountant.SelectedValue=this.Accountant.SelectedValue,t.TermsConditions.Text=this.TermsConditions.Text,t.Purpose.Text=this.Purpose.Text,t.Narration.Text=this.Narration.Text,t.TotalAmount.Text=this.TotalAmount.Text,t.NonRecAmount.Text=this.NonRecAmount.Text,t.RecAmount.Text=this.RecAmount.Text,t.TotalYears.Text=this.TotalYears.Text,t.Months.Text=this.Months.Text,t.TotalDays.Text=this.TotalDays.Text,t.RecurDuration.Text=this.RecurDuration.Text,t.StartDate.Date=null!=a&&a?a:this.StartDate.Date,null!=n&&n?(t.EndDate.Date=n,t.OnselectionChange(null)):t.EndDate.Date=this.EndDate.Date,t.BasedOn.SelectedValue=this.BasedOn.SelectedValue,t.LinkedQuotationID=this.ContractID,t.DataTableObj.Clear();for(var l=function(r){if(!s.e.IsEmpty(e.DataTable[r].NodeID)){var o=t.DataTableObj.NewRow();if(o.NodeID=e.DataTable[r].NodeID.toString(),s.e.IsEmpty(e.DataTable[r].Recurr)||(o.Recurr=e.DataTable[r].Recurr),s.e.IsEmpty(e.DataTable[r].Particulars)||(o.Particulars=e.DataTable[r].Particulars.toString()),s.e.IsEmpty(e.DataTable[r].CreditAccountID)||(o.CreditAccountID=e.DataTable[r].CreditAccountID.toString()),s.e.IsEmpty(e.DataTable[r].CreditAccountID_Key)||(o.CreditAccountID_Key=e.DataTable[r].CreditAccountID_Key),s.e.IsEmpty(e.DataTable[r].PayeeBank)||(o.PayeeBank=e.DataTable[r].PayeeBank.toString()),s.e.IsEmpty(e.DataTable[r].DebitAccountID)||(o.DebitAccountID=e.DataTable[r].DebitAccountID.toString()),s.e.IsEmpty(e.DataTable[r].DebitAccountID_Key)||(o.DebitAccountID_Key=e.DataTable[r].DebitAccountID_Key),s.e.IsEmpty(e.DataTable[r].TaxCategory_Key)||(o.TaxCategory_Key=e.DataTable[r].TaxCategory_Key,o.TaxCategory=e.DataTable[r].TaxCategory),e.DataTableColumns.Contains("SPType_Key")&&!s.e.IsEmpty(e.DataTable[r].SPType_Key)&&(o.SPType_Key=e.DataTable[r].SPType_Key,o.SPType=e.DataTable[r].SPType),t.DataTableColumns.Contains("Location_Key")&&(e.DataTableColumns.Contains("Location_Key")&&!s.e.IsEmpty(e.DataTable[r].Location_Key)?(o.Location_Key=e.DataTable[r].Location_Key.toString(),o.Location=e.DataTable[r].Location.toString()):e.LocationContract.SelectedValue>0&&(o.Location_Key=e.LocationContract.SelectedValue,o.Location=e.LocationContract.Text)),e.DataTableColumns.Contains("Dim_Key")&&!s.e.IsEmpty(e.DataTable[r].Dim_Key)&&(o.Dim_Key=e.DataTable[r].Dim_Key,o.Dim=e.DataTable[r].Dim),e.DataTableColumns.Contains("VatType")&&!s.e.IsEmpty(e.DataTable[r].VatType)&&(o.VatType=e.DataTable[r].VatType),s.e.IsEmpty(e.DataTable[r].Refund)||(o.Refund=e.DataTable[r].Refund.toString()),o.TempCCID_Key=e.DocStNodeID.toString(),o.TempCCID=e.DocStName,s.e.IsEmpty(e.DataTable[r].RecurInvoice)||(o.RecurInvoice=e.DataTable[r].RecurInvoice.toString().toLowerCase()),s.e.IsEmpty(e.DataTable[r].PostDebit)||(o.PostDebit=e.DataTable[r].PostDebit.toString()),s.e.IsEmpty(e.DataTable[r].ChequeNo)||(o.ChequeNo=e.DataTable[r].ChequeNo.toString()),s.e.IsEmpty(e.DataTable[r].CntrlDate)||(o.CntrlDate=e.DataTable[r].CntrlDate),s.e.IsEmpty(e.DataTable[r].CntrlDate_Key)||(o.CntrlDate_Key=e.DataTable[r].CntrlDate_Key),s.e.IsEmpty(e.DataTable[r].VatPer)||(o.VatPer=e.DataTable[r].VatPer),s.e.IsEmpty(e.DataTable[r].Sqft)||(o.Sqft=e.DataTable[r].Sqft),s.e.IsEmpty(e.DataTable[r].Rate)||(o.Rate=e.DataTable[r].Rate),s.e.IsEmpty(e.DataTable[r].ActAmount)||(o.ActAmount=e.DataTable[r].ActAmount.toString()),s.e.IsEmpty(e.DataTable[r].Discount)||(o.Discount=e.DataTable[r].Discount),s.e.IsEmpty(e.DataTable[r].Amount)||(o.Amount=e.DataTable[r].Amount),!s.e.IsEmpty(e.DataTable[r].Xml))if(null!=n&&n&&null!=a&&a){var l=new Date,c=new s.f;if(c.LoadXml(e.DataTable[r].Xml.toString()),null!=c)if(e.multiVisi&&!s.e.IsEmpty(e.SelectedUnits)&&c.ChildNodes.length>0&&null!=c.ChildNodes[0].Attributes&&null!=c.ChildNodes[0].attributes.Filter&&!s.e.StringIsNullOrEmpty(c.ChildNodes[0].attributes.Filter.value)&&"0"==c.ChildNodes[0].attributes.Filter.value){u=c.SelectNodes("XML/UnitsRow/Row");var D=0,h=0,C="";C+='<XML Filter="1" >',u.forEach((function(t){s.e.isValidDate(t.attributes.FromDate.value)&&(l=new Date(t.attributes.FromDate.value)),null==t.attributes.FromDate||s.e.StringIsNullOrEmpty(t.attributes.FromDate.value)||l!=a||(D+=parseFloat(t.attributes.Amount.value),null==t.attributes.Discount||s.e.StringIsNullOrEmpty(t.attributes.Discount.value)||(h+=parseFloat(t.attributes.Discount.value)),C+="<Row ",C+='Unit="'+t.attributes.Unit.value+'" ',null==t.attributes.Period||s.e.StringIsNullOrEmpty(t.attributes.Period.value)||(C+='Period="'+t.attributes.Period.value+'" '),null==t.attributes.Rate||s.e.StringIsNullOrEmpty(t.attributes.Rate.value)||(C+='Rate="'+t.attributes.Rate.value+'" '),null==t.attributes.Distribute||s.e.StringIsNullOrEmpty(t.attributes.Distribute.value)||(C+='Distribute="'+t.attributes.Distribute.value+'" '),null==t.attributes.Discount||s.e.StringIsNullOrEmpty(t.attributes.Discount.value)||(C+='Discount="'+t.attributes.Discount.value+'" '),null==t.attributes.ActAmount||s.e.StringIsNullOrEmpty(t.attributes.ActAmount.value)||(C+='ActAmount="'+t.attributes.ActAmount.value+'" '),C+='Amount="'+t.attributes.Amount.value+'"/>')})),C+="</XML>",o.Amount=D.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),e.DataTable[r].NodeID.toString()==e.id2.toString()&&(o.Discount=h.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),o.ActAmount=(D+h).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())),o.Xml=C.toString()}else(u=c.SelectNodes("XML/Row")).forEach((function(t){s.e.isValidDate(t.attributes.FromDate.value)&&(l=new Date(t.attributes.FromDate.value)),s.e.StringIsNullOrEmpty(t.attributes.FromDate.value)||l!=a||(o.Amount=parseFloat(t.attributes.Amount.value),e.DataTable[r].NodeID.toString()==e.id2.toString()&&(s.e.StringIsNullOrEmpty(t.attributes.Discount.value)?(o.Discount=0,o.ActAmount=parseFloat(t.attributes.Amount.value)):(o.Discount=t.attributes.Discount.value,o.ActAmount=parseFloat(o.Discount)+parseFloat(o.Amount))))}))}else o.Xml=e.DataTable[r].Xml;t.DataTableObj.addRow(o)}},c=0;c<this.DataTable.length;c++){var u;l(c)}var D=i.a.rental.GetParticularsDetails(this.RenewRefID,this.Unit.SelectedValue,0,this.StartDate.Date,this.EndDate.Date,1,0,"");null!=D&&D.Tables.length>2&&D.Tables[2].length>0&&(0==this.PickACC&&D.Columns[2].Contains("RentalReceivableAccountID")&&!s.e.IsEmpty(D.Tables[2][0].RentalReceivableAccountID)?t.RentRecAc.SelectedValue=parseInt(D.Tables[2][0].RentalReceivableAccountID.toString()):1==this.PickACC&&D.Columns[2].Contains("PropRentRecAccID")&&!s.e.IsEmpty(D.Tables[2][0].PropRentRecAccID)&&(t.RentRecAc.SelectedValue=parseInt(D.Tables[2][0].PropRentRecAccID.toString())));var h=0,C=0;t.DataTable.length>0&&!s.e.IsEmpty(t.DataTable[0].Amount)&&(C=parseFloat(t.DataTable[0].Amount),this.OriginalRent=C);var m,b=null;if(null!=D&&D.Tables.length>0&&D.Tables[0].length>0?b=D.Tables[0].filter((function(t){return 1==t.Type||3==t.Type})):null!=D&&D.Tables.length>1&&D.Tables[1].length>0&&(b=D.Tables[1].filter((function(t){return 1==t.Type||3==t.Type}))),null!=b&&b.length>0){s.e.IsEmpty(b[0].DebitAccID)||(t.GenDebitAcc=parseInt(b[0].DebitAccID));for(var S=function(a){if(0==t.DataTable.filter((function(t){return t.NodeID==b[a].NodeID.toString()})).length){h=0;var n=t.DataTableObj.NewRow();n.Recurr=!1,s.e.IsEmpty(b[a].NodeID)||(n.NodeID=b[a].NodeID.toString()),s.e.IsEmpty(b[a].Particulars)||(n.Particulars=b[a].Particulars.toString()),s.e.IsEmpty(b[a].CreditID)||(n.CreditAccountID_Key=b[a].CreditID.toString()),s.e.IsEmpty(b[a].DebitID)||(n.DebitAccountID_Key=b[a].DebitID.toString()),!s.e.IsEmpty(b[a].DiscountAmount)&&parseFloat(b[a].DiscountAmount)>0?h=parseFloat(b[a].DiscountAmount):!s.e.IsEmpty(b[a].DiscountPercentage)&&parseFloat(b[a].DiscountPercentage)>0&&(h=parseFloat(b[a].DiscountPercentage)*C/100),n.Amount=h,s.e.IsEmpty(b[a].CreditName)||(n.CreditAccountID=b[a].CreditName.toString()),s.e.IsEmpty(b[a].DebitName)||(n.DebitAccountID=b[a].DebitName.toString()),s.e.IsEmpty(b[a].DiscountPercentage)||(n.DiscountPercentage=b[a].DiscountPercentage.toString()),""!=b[a].InclChkGen.toString()&&(n.InclChkGen=b[a].InclChkGen.toString()),s.e.IsEmpty(b[a].TaxCategoryID)||(n.TaxCategory_Key=b[a].TaxCategoryID.toString(),n.TaxCategory=b[a].TaxCategory.toString()),s.e.IsEmpty(b[a].Display)||(n.Display=b[a].Display.toString(),"0"==n.Display.toString()&&(n.StyleHeightZero=1)),e.DataTableColumns.Contains("SPType_Key")&&!s.e.IsEmpty(b[a].SPType)&&(n.SPType_Key=b[a].SPType.toString(),n.SPType=b[a].SPTypeName.toString()),e.DataTableColumns.Contains("Dim_Key")&&!s.e.IsEmpty(b[a].Dimname)&&(n.Dim_Key=b[a].DimNodeID.toString(),n.Dim=b[a].Dimname.toString()),e.DataTableColumns.Contains("Location_Key")&&e.LocationContract.SelectedValue>0&&(n.Location_Key=e.LocationContract.SelectedValue),n.VatType=s.e.StringValue(b[a].VatType),n.RecurInvoice=s.e.StringValue(b[a].RecurInvoice.toLowerCase()),n.PostDebit=s.e.StringValue(b[a].PostDebit),""!=s.e.StringValue(b[a].CreditName)&&(n.CreditAccountID=s.e.StringValue(b[a].CreditName)),""!=s.e.StringValue(b[a].DebitName)&&(n.DebitAccountID=s.e.StringValue(b[a].DebitName)),""!=s.e.StringValue(b[a].DiscountPercentage)&&(n.DiscountPercentage=s.e.StringValue(b[a].DiscountPercentage)),""!=s.e.StringValue(b[a].Months)&&(n.Months=s.e.StringValue(b[a].Months)),t.DataTableObj.addRow(n)}},d=0;d<b.length;d++)S(d)}if(s.e.IsEmpty(t.DataTable[0].Amount)||(t.RentAmt.Text=t.DataTable[0].Amount.toString()),t.CalculateNRec(),(129!=t.CurrCostCenterID||!this.DonotCopyPayterms)&&this.PayTermsDataTable.length>0){t.stDate=t.StartDate.Date,t.PayTermsDataTableObj.Clear();for(var T=0;T<this.PayTermsDataTable.length;T++)if(!s.e.IsEmpty(this.PayTermsDataTable[T].DebitAccountID_Key)){if(r>0&&!s.e.IsEmpty(this.PayTermsDataTable[T].Period)&&parseInt(this.PayTermsDataTable[T].Period.toString())!=r)continue;if(null!=n&&n&&null!=a&&a&&!s.e.IsEmpty(this.PayTermsDataTable[T].CntrlDate_Key)&&(new Date(this.PayTermsDataTable[T].CntrlDate_Key.toString())>n||new Date(this.PayTermsDataTable[T].CntrlDate_Key.toString())<a))continue;var y=t.PayTermsDataTableObj.NewRow();y.ChequeNo=this.PayTermsDataTable[T].ChequeNo.toString(),s.e.IsEmpty(this.PayTermsDataTable[T].CntrlDate_Key)||(y.CntrlDate=this.PayTermsDataTable[T].CntrlDate,y.CntrlDate_Key=this.PayTermsDataTable[T].CntrlDate_Key),s.e.IsEmpty(this.PayTermsDataTable[T].PayeeBank)||(y.PayeeBank=this.PayTermsDataTable[T].PayeeBank.toString()),103==this.CostCenterID?(y.DebitAccountID_Key=this.PayTermsDataTable[T].DebitAccountID_Key,y.DebitAccountID=this.PayTermsDataTable[T].DebitAccountID):(y.DebitAccountID_Key=this.RentRecAc.SelectedValue,y.DebitAccountID=this.RentRecAc.Text),s.e.IsEmpty(this.PayTermsDataTable[T].Period)||(y.Period=this.PayTermsDataTable[T].Period.toString()),s.e.IsEmpty(this.PayTermsDataTable[T].Narration)||(y.Narration=this.PayTermsDataTable[T].Narration.toString()),t.PayTermsDataTableColumns.Contains("Location_Key")&&(this.PayTermsDataTableColumns.Contains("Location_Key")&&!s.e.IsEmpty(this.PayTermsDataTable[T].Location_Key)?(y.Location_Key=this.PayTermsDataTable[T].Location_Key.toString(),y.Location=this.PayTermsDataTable[T].Location.toString()):this.LocationContract.SelectedValue>0&&(y.Location_Key=this.LocationContract.SelectedValue,y.Location=this.LocationContract.Text)),s.e.IsEmpty(this.PayTermsDataTable[T].Amount)||(y.Amount=this.PayTermsDataTable[T].Amount),y.TempCCID_Key=this.DocStNodeID.toString(),y.TempCCID=this.DocStName,129!=this.CurrCostCenterID||this.DonotpostDocs||(y.IsFromRes="1"),t.PayTermsDataTableObj.addRow(y)}}this.CalculateFooter();for(var g=0;g<6;g++){var I=t.DataTableObj.NewRow();I.Recurr=!1,t.DataTableObj.addRow(I);var p=t.PayTermsDataTableObj.NewRow();t.PayTermsDataTableObj.addRow(p)}this.FillExtraFields(t),m={obj:t},i.a.page.addNewTab({title:this.ScreenName,component:U.AddEditRentalContractComponent,params:m})}},{key:"validateUnit",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.dsPart=this.StartDate.Date&&this.EndDate.Date?i.a.rental.GetParticularsDetails(this.RenewRefID,this.Unit.SelectedValue,0,this.StartDate.Date,this.EndDate.Date,1,this.ContractID,this.SelectedUnits):this.StartDate.Date?i.a.rental.GetParticularsDetails(this.RenewRefID,this.Unit.SelectedValue,0,this.StartDate.Date,new Date,1,this.ContractID,this.SelectedUnits):i.a.rental.GetParticularsDetails(this.RenewRefID,this.Unit.SelectedValue,0,new Date,this.EndDate.Date?this.EndDate.Date:new Date,1,this.ContractID,this.SelectedUnits),t&&null!=this.dsPart&&this.dsPart.Tables.length>4&&this.dsPart.Tables[4].length>0)return this.DisplayMessage="This Unit is already in use from "+new Date(this.dsPart.Tables[4][0].StartDate).ToString("dd-MMM-yyyy")+", To "+new Date(this.dsPart.Tables[4][0].EndDate).ToString("dd-MMM-yyyy"),this.MessageVisibility=!0,!0;var e=i.a.common.GetDataSet3("AER001",this.Unit.SelectedValue.toString(),this.StartDate.Date.ToString("dd/MMM/yyyy"),this.EndDate.Date.ToString("dd/MMM/yyyy"));return null!=e&&e.Tables.length>0&&e.Tables[0].length>0&&(this.DisplayMessage="This Unit is Reserved from "+new Date(e.Tables[0][0].StartDate).ToString("dd-MMM-yyyy")+", To "+new Date(e.Tables[0][0].EndDate).ToString("dd-MMM-yyyy"),this.MessageVisibility=!0,!0)}},{key:"validate",value:function(t){var e=this;if("SaveDraft"==t)return!1;Logger.InfoLog("AddEditRenContractViewModel ::Entering validate");var a=0;if(103==this.CurrCostCenterID||129==this.CurrCostCenterID){for(var n=0;n<this.DataTable.length;n++)!s.e.IsEmpty(this.DataTable[n].Particulars)&&!s.e.IsEmpty(this.DataTable[n].CreditAccountID)&&!s.e.IsEmpty(this.DataTable[n].Amount)&&parseFloat(this.DataTable[n].Amount)>0&&a++;return 0==a&&(this.DisplayMessage="Enter atleast one particular",this.MessageVisibility=!0,!0)}if(this.DistribtueInvoice&&(this.DisplayMessage=this.RecurDuration.ValidateData(),""!=this.DisplayMessage))return this.MessageVisibility=!0,!0;if(!this.allowafterenddate&&this.EndDate.Date<this.ContractDate.Date)return this.DisplayMessage="EndDate should be higher than ContractDate",this.MessageVisibility=!0,!0;var o=0,l=0;if(this.DataTable.length>0){var c,u=this.ScreenObject.Data.Tables[5].find((function(t){return"SaveZeroValue"==t.Name}));c=!!(u.length>0&&Object(r.j)(u[0].Value.toString()))&&Object(r.j)(u[0].Value);for(var D=0;D<this.DataTable.length;D++){if(s.e.IsEmpty(this.DataTable[D].Particulars)||""==this.DataTable[D].Particulars.toString()||s.e.IsEmpty(this.DataTable[D].CreditAccountID)||!(c||!s.e.IsEmpty(this.DataTable[D].Amount)&&parseFloat(this.DataTable[D].Amount)>0)||a++,!s.e.IsEmpty(this.DataTable[D].Amount)&&""!=this.DataTable[D].Amount.toString()&&parseFloat(this.DataTable[D].Amount)>0&&(s.e.IsEmpty(this.DataTable[D].NodeID)||""==this.DataTable[D].NodeID.toString()))return this.DisplayMessage="Enter Particulars at row no : "+(D+1).toString(),this.MessageVisibility=!0,!0;if(this.DataTableColumns.Contains("Dim_Key")&&!s.e.IsEmpty(this.DataTable[D].Particulars)&&!s.e.IsEmpty(this.DataTable[D].Amount)&&(s.e.IsEmpty(this.DataTable[D].Dim_Key)||parseInt(this.DataTable[D].Dim_Key.toString())<1)){var h=this.ContractParticular.find((function(t){return!s.e.StringIsNullOrEmpty(t.ValueMember)&&"Dim_Key"==t.ValueMember}));return this.DisplayMessage="select "+h.Header+" at row no : "+(D+1).toString(),this.MessageVisibility=!0,!0}if(!s.e.IsEmpty(this.DataTable[D].VatAmount)&&parseFloat(this.DataTable[D].VatAmount.toString())>0&&this.VatAccountID<1)return this.DisplayMessage="Define Vat posting account.",this.MessageVisibility=!0,!0;if(0==D){if(s.e.IsEmpty(this.DataTable[D].Particulars)&&""==s.e.StringValue(this.DataTable[D].Particulars))return this.DisplayMessage="Enter Particulars at Row : 1",this.MessageVisibility=!0,!0;if((s.e.IsEmpty(this.DataTable[D].CreditAccountID_Key)||""==s.e.StringValue(this.DataTable[D].CreditAccountID_Key))&&0==this.ParentContractID)return this.DisplayMessage=104==this.CurrCostCenterID?"Enter Debit A/c at row no :  1":"Enter Credit A/c at row no :  1",this.MessageVisibility=!0,!0;if(!c&&(s.e.IsEmpty(this.DataTable[D].Amount)||""==s.e.StringValue(this.DataTable[D].Amount)||parseFloat(s.e.StringValue(this.DataTable[D].Amount))<1)&&0==this.ParentContractID)return this.DisplayMessage="Enter Amount at Row : 1",this.MessageVisibility=!0,!0}else if(!s.e.IsEmpty(this.DataTable[D].Particulars)&&""!=s.e.StringValue(this.DataTable[D].Particulars)){if(s.e.IsEmpty(this.DataTable[D].CreditAccountID)||""==s.e.StringValue(this.DataTable[D].CreditAccountID))return this.DisplayMessage=104==this.CurrCostCenterID?"Enter Debit A/c at row no :  "+(D+1).toString():"Enter Credit A/c at row no : "+(D+1).toString(),this.MessageVisibility=!0,!0;if(!s.e.IsEmpty(this.DataTable[D].NodeID)&&""!=s.e.StringValue(this.DataTable[D].NodeID)&&!s.e.IsEmpty(this.DataTable[D].DebitAccountID_Key)&&""!=s.e.StringValue(this.DataTable[D].DebitAccountID_Key)&&parseInt(this.DataTable[D].DebitAccountID_Key.toString())>0){if(this.BankAccounts.ContainsKey(this.DataTable[D].DebitAccountID_Key.toString())&&(null==this.DataTable[D].CntrlDate_Key||null==this.DataTable[D].CntrlDate_Key||""==this.DataTable[D].CntrlDate_Key.toString()))return this.DisplayMessage="please enter date at Row No :"+(D+1).toString(),this.MessageVisibility=!0,!0;if(this.BankAccounts.ContainsKey(s.e.StringValue(this.DataTable[D].DebitAccountID_Key))&&(s.e.IsEmpty(this.DataTable[D].ChequeNo)||s.e.IsEmpty(this.DataTable[D].ChequeNo)||""==s.e.StringValue(this.DataTable[D].ChequeNo)||"0"==s.e.StringValue(this.DataTable[D].ChequeNo)))return this.DisplayMessage="please enter Cheque No at Row No :"+(D+1).toString(),this.MessageVisibility=!0,!0}}if(null!=this.DataTable[D].Particulars&&""!=this.DataTable[D].Particulars.toString())for(var C=0;C<this.ContractParticular.length;C++)if(this.ContractParticular[C].Mandatory&&this.ContractParticular[C].DisplayMember.startsWith("CCNID")&&this.DataTableColumns.Contains(this.ContractParticular[C].ValueMember)&&""==this.DataTable[D][this.ContractParticular[C].ValueMember].toString())return this.DisplayMessage=s.e.Format(i.a.GetResource("Doc_Select"),this.ContractParticular[C].Header)+" "+(D+1).toString(),this.MessageVisibility=!0,!0;if(o=0,""!=s.e.StringValue(this.DataTable[D].Xml)){var m=function(){var t=new s.f;t.LoadXml(e.DataTable[D].Xml.toString());var a=-1;t.DocumentElement.children.length>0&&null!=t.DocumentElement.children[0].attributes&&null!=t.DocumentElement.children[0].attributes.Filter&&!s.e.StringIsNullOrEmpty(t.DocumentElement.children[0].attributes.Filter.value)&&(a=parseInt(t.DocumentElement.children[0].attributes.Filter.value));var n=null,i=null,r=[];if(-1==a||2==a){for(var l=0;l<t.DocumentElement.children.length;l++){var c=t.DocumentElement.children[l];null==n&&null!=c.attributes.FromDate&&!s.e.StringIsNullOrEmpty(c.attributes.FromDate.value)&&s.e.isValidDate(c.attributes.FromDate.value)&&(n=new Date(c.attributes.FromDate.value)),c.attributes.FromDate,null!=c.attributes.ToDate&&!s.e.StringIsNullOrEmpty(c.attributes.ToDate.value)&&s.e.isValidDate(c.attributes.ToDate.value)&&(i=new Date(c.attributes.ToDate.value)),c.attributes.ToDate,null==c.attributes.Amount||s.e.StringIsNullOrEmpty(c.attributes.Amount.value)||(o+=parseFloat(c.attributes.Amount.value))}if(null==n||n.toDateString()!=e.StartDate.Date.toDateString())return{v:(e.DisplayMessage="Contract start date and first date does not match at row no:"+(D+1),e.MessageVisibility=!0,!0)};if(null==i||i.toDateString()!=e.EndDate.Date.toDateString())return{v:(e.DisplayMessage="Contract end date and last date does not match at row no:"+(D+1),e.MessageVisibility=!0,!0)}}else if(1==a){for(var u=0;u<t.DocumentElement.children.length;u++){var h=t.DocumentElement.children[u];null==h.attributes.Unit||s.e.StringIsNullOrEmpty(h.attributes.Unit.value)||r.push(parseInt(h.attributes.Unit.value)),null==h.attributes.Amount||s.e.StringIsNullOrEmpty(h.attributes.Amount.value)||(o+=parseFloat(h.attributes.Amount.value))}if(r.length!=e.SelectedUnits.split(",").length)return{v:(e.DisplayMessage="Distribution not defined for some units.",e.MessageVisibility=!0,!0)}}else if(0==a&&(t.DocumentElement.childNodes.forEach((function(t){n=null,i=null;for(var a=0;a<t.childNodes.length;a++){var l=t.childNodes.item[a];null==n&&null!=l.attributes.FromDate&&!s.e.StringIsNullOrEmpty(l.attributes.FromDate.Value)&&s.e.isValidDate(l.attributes.FromDate.value)&&(n=new Date(l.attributes.FromDate.value)),null!=l.attributes.ToDate&&!s.e.StringIsNullOrEmpty(l.attributes.ToDate.value)&&s.e.isValidDate(l.attributes.ToDate.value)&&(i=new Date(l.attributes.ToDate.value)),null==l.attributes.Amount||s.e.StringIsNullOrEmpty(l.attributes.Amount.value)||(o+=parseFloat(l.attributes.Amount.value)),null==l.attributes.Unit||s.e.StringIsNullOrEmpty(l.attributes.Unit.value)||r.Contains(parseInt(l.attributes.Unit.value))||r.push(parseInt(l.attributes.Unit.value))}return null==n||n!=e.StartDate.Date?(e.DisplayMessage="Contract start date and first date does not match for some units.",e.MessageVisibility=!0,!0):null==i||i!=e.EndDate.Date?(e.DisplayMessage="Contract end date and last date does not match for some units.",e.MessageVisibility=!0,!0):void 0})),r.length!=e.SelectedUnits.split(",").length))return{v:(e.DisplayMessage="Distribution not defined for some units.",e.MessageVisibility=!0,!0)};if(parseFloat(e.DataTable[D].Amount.toString()).ToString("N"+e.Mdeci)!=o.ToString("N"+e.Mdeci))return{v:(e.DisplayMessage="Amount does not match at row no:"+(D+1),e.MessageVisibility=!0,!0)}}();if("object"==typeof m)return m.v}}}else if(0==this.ParentContractID)return this.DisplayMessage="Enter atleast one detail",this.MessageVisibility=!0,!0;if(0==a&&0==this.ParentContractID)return this.DisplayMessage="Enter atleast one particular",this.MessageVisibility=!0,!0;if(a=0,this.PayTermsDataTable.length>0){var b,S=0,d=(_toArray(b=this.ScreenObject.Data.Tables[5].filter((function(t){return"ValidateChequeBasedOnEnddate"==t.Name}))),b);d.length>0&&(S=parseInt(d[0].Value.toString()));for(var T=this.ContractPayTerms.find((function(t){return"Particulars"==t.DisplayMember})),y=0;y<this.PayTermsDataTable.length;y++){if(s.e.IsEmpty(this.PayTermsDataTable[y].ChequeNo)||""==this.PayTermsDataTable[y].ChequeNo.toString()||s.e.IsEmpty(this.PayTermsDataTable[y].CntrlDate_Key)||""==this.PayTermsDataTable[y].CntrlDate_Key.toString()||s.e.IsEmpty(this.PayTermsDataTable[y].DebitAccountID)||""==this.PayTermsDataTable[y].DebitAccountID.toString()||s.e.IsEmpty(this.PayTermsDataTable[y].Amount)||""==this.PayTermsDataTable[y].Amount.toString()||!(parseFloat(this.PayTermsDataTable[y].Amount)>0)||a++,!s.e.IsEmpty(this.PayTermsDataTable[y].Amount)&&""!=this.PayTermsDataTable[y].Amount.toString()){if(s.e.IsEmpty(this.PayTermsDataTable[y].CntrlDate_Key)||null==this.PayTermsDataTable[y].CntrlDate_Key||""==this.PayTermsDataTable[y].CntrlDate_Key.toString())return this.DisplayMessage="Enter Cheque Date at row no : "+(y+1).toString(),this.MessageVisibility=!0,!0;if(s.e.IsEmpty(this.PayTermsDataTable[y].DebitAccountID)||""==this.PayTermsDataTable[y].DebitAccountID.toString())return this.DisplayMessage=104==this.CurrCostCenterID?"Enter Credit A/c at row no : "+(y+1).toString():"Enter Debit A/c at row no : "+(y+1).toString(),this.MessageVisibility=!0,!0;if(s.e.IsEmpty(this.PayTermsDataTable[y].PayeeBank)||""==this.PayTermsDataTable[y].PayeeBank.toString())return this.DisplayMessage="Enter Payee Bank row no : "+(y+1).toString(),this.MessageVisibility=!0,!0;if(null!=T&&T.Mandatory&&""==this.PayTermsDataTable[y].Particulars_Key.toString())return this.DisplayMessage="select  "+T.Header+"row no : "+(y+1).toString(),this.MessageVisibility=!0,!0;for(var g=0;g<this.ContractPayTerms.length;g++)if(("Dim"==this.ContractPayTerms[g].DisplayMember||this.ContractPayTerms[g].DisplayMember.startsWith("CCNID"))&&this.ContractPayTerms[g].Mandatory&&this.PayTermsDataTableColumns.Contains(this.ContractPayTerms[g].ValueMember)&&""==this.PayTermsDataTable[y][this.ContractPayTerms[g].ValueMember].toString())return this.DisplayMessage=s.e.Format(i.a.GetResource("Doc_Select"),this.ContractPayTerms[g].Header)+" "+(y+1).toString(),this.MessageVisibility=!0,!0}if(S>0&&!s.e.IsEmpty(this.PayTermsDataTable[y].CntrlDate_Key)&&new Date(this.PayTermsDataTable[y].CntrlDate_Key).AddDays(S)>this.EndDate.Date)return this.DisplayMessage="Cheque date should be ["+S+"] Days prior to Contract End date at row no : "+(y+1).toString(),this.MessageVisibility=!0,!0}if(0==a&&0==this.ParentContractID){if(this.DontsavenoPayment)return this.DisplayMessage="Enter atleast one Payment Terms",this.MessageVisibility=!0,!0;if(this.PayTermsBodyVisible&&!this.isFrmBlkEdit&&!confirm(i.a.GetResource("PaymentTermsnotdefined")))return!0}}o=l=0;var I=this.PayTermsDataTable.filter((function(t){return t.DebitAccountID_Key>0})).Compute("sum","Amount");if(l=parseFloat(I.toString()),!s.e.IsEmpty(this.DataTable[0].Amount)&&""!=this.DataTable[0].Amount.toString().Trim()){o=parseFloat(this.DataTable[0].Amount.toString()),"Inclusive"!=s.e.StringValue(this.DataTable[0].VatType)&&!s.e.IsEmpty(this.DataTable[0].VatAmount)&&parseFloat(this.DataTable[0].VatAmount.toString())>0&&(o+=parseFloat(this.DataTable[0].VatAmount));for(var p=1;p<this.DataTable.length;p++)(s.e.IsEmpty(this.DataTable[p].DebitAccountID_Key)||""==this.DataTable[p].DebitAccountID_Key.toString()||"0"==this.DataTable[p].DebitAccountID_Key.toString())&&(!s.e.IsEmpty(this.DataTable[p].Amount)&&""!=this.DataTable[p].Amount.toString()&&parseFloat(this.DataTable[p].Amount)>0&&(o+=parseFloat(this.DataTable[p].Amount.toString())),"Inclusive"!=s.e.StringValue(this.DataTable[p].VatType)&&""!=s.e.StringValue(this.DataTable[p].VatAmount)&&parseFloat(this.DataTable[p].VatAmount.toString())>0&&(o+=parseFloat(this.DataTable[p].VatAmount)))}if(o=parseFloat(o.toString()),l.ToString("N2")!=o.ToString("N2")){if(this.DontAllowmorePayment&&l>o)return this.DisplayMessage="Payment is more than Total Amount, difference : "+Math.abs(o-l).toString(),this.MessageVisibility=!0,!0;if(this.DontsavenoPayment&&0==this.ParentContractID)return this.DisplayMessage=" Total Amount and Payment terms does not match, difference : "+Math.abs(o-l).toString(),this.MessageVisibility=!0,!0;if(a>0&&this.PayTermsBodyVisible&&!this.isFrmBlkEdit&&!confirm("Total Amount and Payment terms does not match:.\nDo you want to proceed?"))return!0}return Logger.InfoLog("AddEditRenContractViewModel ::EXITING validate"),this.MessageVisibility=!1,!1}},{key:"LoadTabs",value:function(){var t=this;this.ScreenObject.CustomTab.Pages.forEach((function(e){switch(e.Name){case"Attachments":e.Fields.push(t.ViewAttachments);break;case"Activities":null!=t.ViewActivities&&e.Fields.push(t.ViewActivities);break;case"Notes":e.Fields.push(t.ViewNotes)}e.Fields.forEach((function(e){e instanceof m.c&&"TermsConditions"==e.DBColumnName&&(t.TermsConditions=e)}))}))}},{key:"GenerateChequeNos",value:function(t,e,a,n,r,o,l,c,u,D,h,C,m,b){var S=0,d=0;if(this.NoofCheques=t,this.FirstNumber=e,this.InstPeriod=l,this.FirstNoLen=e.length,this.stDate=a,this.PayeeBnk=n,this.DebitAcc=r,this.DebitName=o,""!=c&&""!=u&&""!=D){var T=new Date,y=new Date;if(S=s.e.DoubleTryParse(D),s.e.isValidDate(c)&&(T=new Date(c)),s.e.isValidDate(u)&&(y=new Date(u)),d=s.e.GetDateDifference(y,T)+1,this.GenChqOthPart)for(var g=0;g<this.PayTermsDataTable.length;g++)(!this.PayTermsDataTableColumns.Contains("IsFreezed")||"1"!=this.PayTermsDataTable[g].IsFreezed.toString()&&"True"!=this.PayTermsDataTable[g].IsFreezed.toString())&&s.e.IsEmpty(this.PayTermsDataTable[g].Amount)&&s.e.IsEmpty(this.PayTermsDataTable[g].DebitAccountID_Key)&&(this.PayTermsDataTable.Remove(this.PayTermsDataTable[g]),g--);else for(var I=0;I<this.PayTermsDataTable.length;I++)(!this.PayTermsDataTableColumns.Contains("IsFreezed")||"1"!=this.PayTermsDataTable[I].IsFreezed.toString()&&"True"!=this.PayTermsDataTable[I].IsFreezed.toString())&&(s.e.IsEmpty(this.PayTermsDataTable[I].CntrlDate_Key)||new Date(this.PayTermsDataTable[I].CntrlDate_Key.toString())>=T&&new Date(this.PayTermsDataTable[I].CntrlDate_Key.toString())<=y)&&(this.PayTermsDataTable.Remove(this.PayTermsDataTable[I]),I--)}else if(null!=this.TotalDays.Text&&""!=this.TotalDays.Text&&(d=parseInt(this.TotalDays.Text)),this.GenChqOthPart){S=s.e.DoubleTryParse(D);for(var p=0;p<this.PayTermsDataTable.length;p++)(!this.PayTermsDataTableColumns.Contains("IsFreezed")||"1"!=this.PayTermsDataTable[p].IsFreezed.toString()&&"True"!=this.PayTermsDataTable[p].IsFreezed.toString())&&s.e.IsEmpty(this.PayTermsDataTable[p].Amount)&&s.e.IsEmpty(this.PayTermsDataTable[p].DebitAccountID_Key)&&(this.PayTermsDataTable.Remove(this.PayTermsDataTable[p]),p--)}else{if(null!=this.DataTable[0].Amount&&""!=this.DataTable[0].Amount.toString().Trim()){i.a.SessionManager.Preferences.ContainsKey("VATVersion")&&""!=this.DataTable[0].VatPer.toString()&&"0"!=this.DataTable[0].VatPer.toString()?"2"==this.DataTable[0].InclChkGen.toString()?(S=parseFloat(this.DataTable[0].Amount),"Inclusive"==this.DataTable[0].VatType.toString()||s.e.IsEmpty(this.DataTable[0].VatAmount)||(S+=parseFloat(this.DataTable[0].VatAmount))):null!=this.DataTable[0].TaxableAmt&&""!=this.DataTable[0].TaxableAmt.toString()&&parseFloat(this.DataTable[0].TaxableAmt)>0&&(S+=parseFloat(this.DataTable[0].TaxableAmt)):S+=parseFloat(this.DataTable[0].Amount);for(var A=1;A<this.DataTable.length;A++)(null!=this.DataTable[A].DebitAccountID_Key.toString()&&""!=this.DataTable[A].DebitAccountID_Key.toString()&&"0"!=this.DataTable[A].DebitAccountID_Key.toString()||this.CheckNumbersForRent)&&"0"==this.DataTable[A].InclChkGen.toString()||(null!=this.DataTable[A].Amount&&""!=this.DataTable[A].Amount.toString()&&parseFloat(this.DataTable[A].Amount)>0&&(!i.a.SessionManager.Preferences.ContainsKey("VATVersion")||""==this.DataTable[A].VatPer.toString()||"0"==this.DataTable[A].VatPer.toString())?S+=parseFloat(this.DataTable[A].Amount):"1"==this.DataTable[A].InclChkGen.toString()?null!=this.DataTable[A].TaxableAmt&&""!=this.DataTable[A].TaxableAmt.toString()&&parseFloat(this.DataTable[A].TaxableAmt)>0&&(S+=parseFloat(this.DataTable[A].TaxableAmt)):(null!=this.DataTable[A].Amount&&""!=this.DataTable[A].Amount.toString()&&parseFloat(this.DataTable[A].Amount)>0&&(S+=parseFloat(this.DataTable[A].Amount)),"Inclusive"!=this.DataTable[A].VatType.toString()&&""!=this.DataTable[A].VatAmount.toString()&&(S+=parseFloat(this.DataTable[A].VatAmount))))}for(var f=0;f<this.PayTermsDataTable.length;f++)(!this.PayTermsDataTableColumns.Contains("IsFreezed")||"1"!=this.PayTermsDataTable[f].IsFreezed.toString()&&"True"!=this.PayTermsDataTable[f].IsFreezed.toString())&&("1"!=this.PayTermsDataTable[f].IsFromRes.toString()||""==this.PayTermsDataTable[f].Amount.toString()&&""==this.PayTermsDataTable[f].DebitAccountID_Key.toString())&&(this.PayTermsDataTable.Remove(this.PayTermsDataTable[f]),f--)}this.FillGridValues(S,d,h,C,c,m,b);for(var P=0;P<10;P++){var N=this.PayTermsDataTableObj.NewRow();this.PayTermsDataTableObj.addRow(N)}this.UpdateSequencePay(),this.CalculateFooter(),this.PayTermsDataTableObj.UpdateTotals()}},{key:"FillGridValues",value:function(t,e,a,n,r,o,l){var c=this;Logger.InfoLog("AddEditRenContractViewModel ::Entering FillGridValues");var u=new Date;s.e.isValidDate(a)&&(u=new Date(a));var D=new Date,h=0;D=""!=r&&s.e.isValidDate(r)?new Date(r):this.stDate,this.months=e/30;var C=t/this.NoofCheques;this.IsMonth?this.NoofCheques>0&&(h=this.months/this.NoofCheques):this.NoofCheques>0&&(h=e/this.NoofCheques),this.InstPeriod>0&&(h=this.IsMonth?this.InstPeriod/30:this.InstPeriod),this.CheVal=0;for(var m="",b=(this.PayTermsDataTable.length,0);b<this.PayTermsDataTable.length;b++)s.e.IsEmpty(this.PayTermsDataTable[b].Amount)&&s.e.IsEmpty(this.PayTermsDataTable[b].DebitAccountID_Key)&&b;for(var S=0;S<this.NoofCheques;S++){var d=this.PayTermsDataTableObj.NewRow();if(this.InclPostingDate&&(d.PostingDate=u.ToString(i.a.SessionManager.Preferences["Date Format"]),d.PostingDate_Key=u),d.Period=n,d.CntrlDate=D.ToString(i.a.SessionManager.Preferences["Date Format"]),d.CntrlDate_Key=D,d.TempCCID_Key=this.DocStNodeID.toString(),d.TempCCID=this.DocStName,h=Math.round(h),console.log(h),console.log("ChequeDuration"),D=this.IsMonth?new Date(d.CntrlDate_Key.ToString("dd/MMM/yyyy")).AddMonths(h):new Date(d.CntrlDate_Key.ToString("dd/MMM/yyyy")).AddDays(h),S==this.NoofCheques-1){var T=0;null!=i.a.SessionManager.Preferences.DecimalsinAmount&&i.a.SessionManager.Preferences.DecimalsinAmount.toString(),T=s.e.DoubleTryParse(t-this.CheVal),this.CheVal+=s.e.DoubleTryParse(d.Amount=T.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()))}else this.CheVal+=s.e.DoubleTryParse(d.Amount=C.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()));if(m=(parseInt(this.FirstNumber)+S).toString(),this.FirstNoLen-m.length>0){for(var y=this.FirstNoLen-m.length,g="",I=0;I<y;I++)g+="0";m=g+m}if(d.ChequeNo=m,s.e.StringIsNullOrEmpty(this.PayeeBnk)||(d.PayeeBank=this.PayeeBnk),this.DebitAcc>0&&(d.DebitAccountID_Key=this.DebitAcc,d.DebitAccountID=this.DebitName),this.ShowAmountinGenChq&&this.PayTermsDataTableColumns.Contains("RentAmount")&&(d.RentAmount=d.Amount),s.e.StringIsNullOrEmpty(o)||(d.Narration=o,"RENT"==o.toUpperCase()&&(d.Narration=0==S?o+" - 1st Installment":1==S?o+" - 2nd Installment":2==S?o+" - 3rd Installment":o+" - "+(S+1)+"th Installment")),l>0){if(d.Particulars_Key=l,d.Particulars=o,null!=d.Location&&null!=this.DataTable[0].Location){var p=this.DataTable.filter((function(t){return t.NodeID==l}));p.length>0&&!s.e.IsEmpty(p[0].Location_Key)&&(d.Location_Key=p[0].Location_Key,d.Location=p[0].Location)}if(null!=d.Dim_Key&&null!=this.DataTable[0].Dim_Key)if(this.DefaultDiminPayterms>0){d.Dim_Key=this.DefaultDiminPayterms;var A=this.DataTable.filter((function(t){return t.Dim_Key==c.DefaultDiminPayterms}));A.length>0&&!s.e.IsEmpty(A[0].Dim)&&(d.Dim=A[0].Dim)}else{var f=this.DataTable.filter((function(t){return t.NodeID==l}));f.length>0&&!s.e.IsEmpty(f[0].Dim_Key)&&(d.Dim_Key=f[0].Dim_Key,d.Dim=f[0].Dim)}}this.PayTermsDataTableObj.addRow(d)}Logger.InfoLog("AddEditRenContractViewModel ::Exiting FillGridValues")}},{key:"GetChequValue",value:function(t){Logger.InfoLog("AddEditRenContractViewModel ::Entering GetChequValue");var e=t.length,a="";this.strCount=t.length;for(var n=0;n<this.strCount;n++){if("0"!=t[n].toString()){a+=t[n].toString();for(var i=n+1;i<this.strCount;i++)a+=t[i].toString();n++;break}e--}return this.ZeroValue=t.substr(0,t.length-e).toString(),t=t.substr(0,t.length-e)+a,Logger.InfoLog("AddEditRenContractViewModel ::Exiting GetChequValue"),t}},{key:"GetINvXML",value:function(t,e,a,n,r,o,l,c,u,D){var h=arguments.length>10&&void 0!==arguments[10]?arguments[10]:null,C="";C+="<RowHead/><Row><Transactions  ",C+='DocDetailsID="0"  BillDate="'+this.ContractDate.Date.ToString("dd/MMM/yyyy")+'"  DocSeqNo="1"  LinkedInvDocDetailsID= ""  LinkedFieldName= "" ProductID="'+this.ProductID+'" ',C+=this.CurrencyContract.SelectedValue>0?'CurrencyID="'+this.CurrencyContract.SelectedValue+'" ':'CurrencyID="1" ',C+='ExchangeRate="1" Unit="1" UOMConversion="1" ',C+='CreditAccount="'+n+'" DebitAccount="'+a+'" ',C+=' Quantity="1" CommonNarration="'+m.d.GetValidXml(u)+'"  ',C+=' Rate="'+r.replace(",","")+'"  Gross="'+r.replace(",","")+'" ',!s.e.IsEmpty(t)&&Object.keys(t).Contains("Narration")&&""!=s.e.String(t.Narration)?C+=' LineNarration="'+m.d.GetValidXml(t.Narration.toString())+'" ':C+=' LineNarration="'+m.d.GetValidXml(this.Narration.Text)+'" ',C+="></Transactions> ";var b="";null!=t?(b=this.AddRowCC(t,null,0,0,h),b+=this.GetSalemanXml(t)):this.LocationContract.Visible&&this.LocationContract.SelectedValue>0&&(b+=" dcCCNID2="+this.LocationContract.SelectedValue+","),C+=' <Numeric Query="';var S="";return s.e.StringIsNullOrEmpty(o)||"0"==o?C+='" /> <Alpha />':(C+=" dcNum51="+(S="Inclusive"==c?(100*parseFloat(r)/(parseFloat(l)+100)).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()):r).replace(",","")+",dcCalcNum51="+S.replace(",",""),C+=",dcNum52="+l.replace(",","")+",dcCalcNum52="+l.replace(",",""),C+=",dcNum60="+l.replace(",","")+",dcCalcNum60="+l.replace(",",""),C+=",dcNum53="+o.replace(",","")+",dcCalcNum53="+o.replace(",",""),C+=",dcNum61="+o.replace(",","")+",dcCalcNum61="+o.replace(",","")+",",C+='" /> <Alpha  Query="',C+="dcAlpha153='"+c+"',",C+="dcAlpha152='Service',",C+='" />'),C+=' <CostCenters   Query="'+this.strCCQry.toString()+b+'"  /> <EXTRAXML/> ',D||(C+="<AccountsXML><Accounts ",r.Contains("-")?(C+='CreditAccount="'+a+'"  DebitAccount="'+n+'" ',C+='Amount="'+r.replace(",","").replace("-","")+'" AmtFc="'+r.replace(",","").replace("-","")+'"  '):(C+='CreditAccount="'+n+'"  DebitAccount="'+a+'" ',C+='Amount="'+r.replace(",","")+'" AmtFc="'+r.replace(",","")+'"  '),C+=this.CurrencyContract.SelectedValue>0?'CurrencyID="'+this.CurrencyContract.SelectedValue+'" ':'CurrencyID="1" ',C+='ExchangeRate="1"  ></Accounts>',s.e.StringIsNullOrEmpty(o)||"0"==o||(C+="<Accounts ",C+='CreditAccount="'+this.VatAccountID+'"  DebitAccount="'+a+'" ',C+='Amount="'+o.replace(",","")+'" AmtFc="'+o.replace(",","")+'"  ',C+=this.CurrencyContract.SelectedValue>0?'CurrencyID="'+this.CurrencyContract.SelectedValue+'" ':'CurrencyID="1" ',C+='ExchangeRate="1"  ></Accounts>'),C+="</AccountsXML>"),(C+=" </Row>").toString()}},{key:"GetPenaltyXML",value:function(t,e,a){if(null==e&&(e=""),null==a&&(a=""),0==t.length)return"";var n=!1,r={_DonotUpdateAccounts:n},o=i.a.rental.GetVacancyDocumentType(this.CurrCostCenterID,"TerminatePenaltyJV",r);n=r._DonotUpdateAccounts;for(var l="",c="",u=0;u<t.length;u++){var D=1;if(!s.e.IsEmpty(t[u].Amount)&&0!=parseFloat(t[u].Amount.toString())&&95==this.CurrCostCenterID&&!s.e.IsEmpty(t[u].Vatper)&&parseFloat(t[u].Vatper.toString())>0&&new Date(this.cntrct.TerminationDate)>=new Date(2018,0,1)){var h;if(0==(h=s.e.IntTryParse(e))&&0==this.VatAccountID)return this.DisplayMessage="Define Vat Account",this.MessageVisibility=!0,"";if(0==h&&(e=this.VatAccountID.toString()),!t.Columns.Contains("VatType")||""==t[u].VatType.toString()){var C=this.ScreenObject.Data.Tables[5].filter((function(t){return"PenaltyVATType"==t.Name}));if(C.length>0)if(1==(D=s.e.IntTryParse(C[0].Value))){var m=parseFloat(t[u].Amount.toString())*parseFloat(t[u].Vatper.toString())/100;t[u].VatAmount=m.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount).replace(",","")}else{var b=parseFloat(t[u].Amount.toString())*parseFloat(t[u].Vatper.toString())/(100+parseFloat(t[u].Vatper.toString()));t[u].VatAmount=b.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount).replace(",",""),t[u].Amount=parseFloat(t[u].Amount.toString())-parseFloat(t[u].VatAmount.toString())}}var S,d="";if(S=!s.e.IsEmpty(t[u].DebitAccountID_Key)&&parseInt(t[u].DebitAccountID_Key.toString())>0?t[u].DebitAccountID_Key.toString():this.RentRecAc.SelectedValue.toString(),!s.e.IsEmpty(t[u].CreditAccountID_Key)&&parseInt(t[u].CreditAccountID_Key.toString())>0)d=t[u].CreditAccountID_Key.toString();else{if("0"==a)return this.DisplayMessage="Define Penalty Account.",this.MessageVisibility=!0,"";d=a}11==o?l+=this.GetINvXML(t[u],e,S,d,t[u].Amount.toString(),t[u].VatAmount.toString(),t[u].Vatper.toString(),1==D?"Exclusive":"Inclusive","",n,t):(l+='<Row><Transactions  CONTRACTSNO="1"  ',l+=' DocDetailsID="0"  DocSeqNo="1"   CreditAccount="'+d,l+='" DebitAccount="-99" Amount="'+t[u].Amount.toString()+'" AmtFc="'+t[u].Amount.toString()+'"',l+="></Transactions> ",c=this.AddRowCC(t[u],null,0,0,t),c+=this.GetSalemanXml(t[u]),l+=' <Numeric /> <Alpha /> <CostCenters   Query="'+this.strCCQry.toString()+c+'"  />  ',l+="<EXTRAXML> ",l+="</EXTRAXML> ",l+=" </Row>",l+='<Row><Transactions  CONTRACTSNO="1"  ',l+=' DocDetailsID="0"  DocSeqNo="2"   CreditAccount="-99" DebitAccount="'+S,l+='" Amount="'+t[u].Amount.toString()+'" AmtFc="'+t[u].Amount.toString()+'"',l+="></Transactions> ",l+=' <Numeric /> <Alpha /> <CostCenters   Query="'+this.strCCQry.toString()+c+'"  />  ',l+="<EXTRAXML> ",l+="</EXTRAXML> ",l+=" </Row>",!s.e.IsEmpty(t[u].VatAmount)&&parseFloat(t[u].VatAmount.toString())>0&&(l+='<Row><Transactions  CONTRACTSNO="1" ',l+='DocDetailsID="0"  DocSeqNo="3" ',l+='CreditAccount="-99" DebitAccount="'+this.RentRecAc.SelectedValue.toString()+'" ',l+='Amount="'+t[u].VatAmount.toString()+'" AmtFc="'+t[u].VatAmount.toString()+'"',l+="></Transactions> ",l+=' <Numeric /> <Alpha /> <CostCenters   Query="'+this.strCCQry.toString()+c+'"  />  ',l+="<EXTRAXML> </EXTRAXML> </Row>",l+='<Row><Transactions  CONTRACTSNO="1" ',l+='DocDetailsID="0"  DocSeqNo="4" ',l+='CreditAccount="'+e+'" DebitAccount="-99" ',l+='Amount="'+t[u].VatAmount.toString()+'" AmtFc="'+t[u].VatAmount.toString()+'"',l+="></Transactions> ",l+=' <Numeric /> <Alpha /> <CostCenters   Query="'+this.strCCQry.toString()+c+'"  />  ',l+="<EXTRAXML> ",l+="</EXTRAXML> ",l+=" </Row>"))}return l.length>0&&(l="<DocumentXML>"+l,l+="</DocumentXML>"),l.toString()}}},{key:"GetPenaltyParticulars",value:function(t,e){if(null==e&&(e=""),0==t.length)return"";for(var a="",n=0;n<t.length;n++)s.e.IsEmpty(t[n].Amount)||0==parseFloat(t[n].Amount.toString())||(a+='<Row CreditAccID="',!s.e.IsEmpty(t[n].CreditAccountID_Key)&&parseInt(t[n].CreditAccountID_Key.toString())>0?a+=t[n].CreditAccountID_Key.toString():"0"!=e&&(a+=e),a+='"  DebitAccID="',!s.e.IsEmpty(t[n].DebitAccountID_Key)&&parseInt(t[n].DebitAccountID_Key.toString())>0?a+=t[n].DebitAccountID_Key.toString():a+=this.RentRecAc.SelectedValue.toString(),s.e.IsEmpty(t[n].Vatper)||(a+='" VatPer="'+t[n].Vatper.toString()),s.e.IsEmpty(t[n].VatAmount)||(a+='" VatAmount="'+t[n].VatAmount.toString()),a+='" Amount="'+t[n].Amount.toString()+'" CCNodeID="'+t[n].NodeID.toString()+'" />');return a.length>0&&(a="<XML>"+a,a+="</XML>"),a.toString()}},{key:"GetVacancyXml",value:function(t,e,a,n,o){var l=!1,c=i.a.rental.IsBillWiseAccount(this.RentRecAc.SelectedValue);null!=c&&c.Tables.length>0&&c.Tables[0].length>0&&!s.e.IsEmpty(c.Tables[0][0].IsBillwise)&&(l=Object(r.j)(c.Tables[0][0].IsBillwise));var u="";o.ActualRentofmnt=0;var D=0;if(this.TotalMonths=this.getTotalMonths(),"Daily"==this.BasedOn.SelectedValue||this.TotalMonths<1){var h=s.e.Round(parseFloat(this.DataTable[0].Amount)/this.GetDays(),this.dDeci);o.ActualRentofmnt=s.e.Round(h*s.e.GetDateDifference(this.TerminateContracts.TerminationDate.Date,a),this.Mdeci)}else this.DataTable.length>0&&null!=this.DataTable[0].Amount&&""!=this.DataTable[0].Amount.toString()&&(D=parseFloat(this.DataTable[0].Amount)/this.TotalMonths),o.ActualRentofmnt=D/this.TerminateContracts.TerminationDate.Date.DaysInMonth()*s.e.GetDateDifference(this.TerminateContracts.TerminationDate.Date,a);if(o.ActualRentofmnt>0){var C="";if(3==this.Vattype&&this.VATExtraRent&&95==this.CurrCostCenterID&&this.VatonRent>0){var m;if(0==(m=s.e.IntTryParse(e))&&0==this.VatAccountID)return this.DisplayMessage="Define Vat Account",this.MessageVisibility=!0,"";0==m&&(e=this.VatAccountID.toString()),C=(parseFloat(o.ActualRentofmnt)*(this.VatonRent/100)).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount).replace(",","")}if(u+=" <DocumentXML>",2==t)u+=this.GetINvXML(null,e,this.RentRecAc.SelectedValue.toString(),this.IncomeAc.SelectedValue.toString(),o.ActualRentofmnt.toString(),C,this.VatonRent.toString(),"Exclusive","",n);else if(0==t){u+='<Row><Transactions  CONTRACTSNO="1" ',u+='DocDetailsID="0"  DocSeqNo="1" ',u+=104==this.CurrCostCenterID?'CreditAccount="'+this.RentRecAc.SelectedValue.toString()+'" DebitAccount="'+this.IncomeAc.SelectedValue+'" ':'CreditAccount="'+this.IncomeAc.SelectedValue+'" DebitAccount="'+this.RentRecAc.SelectedValue.toString()+'" ',u+='Amount="'+o.ActualRentofmnt.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount).replace(",","")+'" AmtFc="'+o.ActualRentofmnt.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount).replace(",","")+'"',u+="></Transactions> ";var b=this.AddRowCC(this.DataTable[0],null,0,0,this.DataTable);if(b+=this.GetSalemanXml(this.DataTable[0]),u+=' <Numeric /> <Alpha /> <CostCenters   Query="'+this.strCCQry.toString()+b+'"  /> ',u+="<EXTRAXML> ",i.a.SessionManager.Preferences.ContainsKey("On")&&"True"==i.a.SessionManager.Preferences.On&&l&&(u+="<BillWise> ",u+=' <Row DocSeqNo="1" AccountID="'+this.RentRecAc.SelectedValue.toString(),u+=104==this.CurrCostCenterID?'" AmountFC="-'+o.ActualRentofmnt.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount).replace(",","")+'" AdjAmount="-'+o.ActualRentofmnt.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount).replace(",","")+'"':'" AmountFC="'+o.ActualRentofmnt.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount).replace(",","")+'" AdjAmount="'+o.ActualRentofmnt.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount).replace(",","")+'"',u+=' AdjCurrID="1" ',u+='AdjExchRT="1" ',u+='IsNewReference="1" ',u+='Narration="" ',u+='IsDocPDC="0" ',u+=" ></Row>",u+=" </BillWise>"),u+="</EXTRAXML> ",u+=" </Row>",3==this.Vattype&&this.VATExtraRent&&95==this.CurrCostCenterID&&this.VatonRent>0){if(0==s.e.IntTryParse(e))return this.DisplayMessage="Define Vat Account",this.MessageVisibility=!0,"";u+='<Row><Transactions  CONTRACTSNO="1" ',u+='DocDetailsID="0"  DocSeqNo="2" ',u+='CreditAccount="'+e+'" DebitAccount="'+this.RentRecAc.SelectedValue.toString()+'" ',u+='Amount="'+(parseFloat(o.ActualRentofmnt)*(this.VatonRent/100)).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount).replace(",","")+'" AmtFc="'+(parseFloat(o.ActualRentofmnt)*(this.VatonRent/100)).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount).replace(",","")+'"',u+="></Transactions> ",u+=' <Numeric /> <Alpha /> <CostCenters   Query="'+this.strCCQry.toString()+b+'"  /> ',u+="<EXTRAXML> ",u+="</EXTRAXML> ",u+=" </Row>"}}else{u+='<Row><Transactions  CONTRACTSNO="1" ',u+='DocDetailsID="0"  DocSeqNo="1" ',u+=104==this.CurrCostCenterID?'CreditAccount="-99" DebitAccount="'+this.IncomeAc.SelectedValue+'" ':'CreditAccount="'+this.IncomeAc.SelectedValue+'" DebitAccount="-99" ',u+='Amount="'+o.ActualRentofmnt.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount).replace(",","")+'" AmtFc="'+o.ActualRentofmnt.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount).replace(",","")+'"',u+="></Transactions> ";var S=this.AddRowCC(this.DataTable[0],null,0,0,this.DataTable);if(S+=this.GetSalemanXml(this.DataTable[0]),u+=' <Numeric /> <Alpha /> <CostCenters   Query="'+this.strCCQry.toString()+S+'"  />  ',u+="<EXTRAXML> ",i.a.SessionManager.Preferences.ContainsKey("On")&&"True"==i.a.SessionManager.Preferences.On){var d=!1;null!=(c=i.a.rental.IsBillWiseAccount(this.IncomeAc.SelectedValue))&&c.Tables.length>0&&c.Tables[0].length>0&&!s.e.IsEmpty(c.Tables[0][0].IsBillwise)&&(d=Object(r.j)(c.Tables[0][0].IsBillwise)),d&&(u+="<BillWise> ",u+=' <Row DocSeqNo="1" AccountID="'+this.IncomeAc.SelectedValue,u+=104==this.CurrCostCenterID?'" AmountFC="'+o.ActualRentofmnt.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount).replace(",","")+'" AdjAmount="'+o.ActualRentofmnt.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount).replace(",","")+'"':'" AmountFC="-'+o.ActualRentofmnt.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount).replace(",","")+'" AdjAmount="-'+o.ActualRentofmnt.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount).replace(",","")+'"',u+=' AdjCurrID="1" ',u+='AdjExchRT="1" ',u+='IsNewReference="1" ',u+='Narration="" ',u+='IsDocPDC="0" ',u+=" ></Row>",u+=" </BillWise>")}if(u+="</EXTRAXML> ",u+=" </Row>",u+='<Row><Transactions  CONTRACTSNO="1" ',u+='DocDetailsID="0"  DocSeqNo="2" ',u+=104==this.CurrCostCenterID?'CreditAccount="'+this.RentRecAc.SelectedValue.toString()+'" DebitAccount="-99" ':'CreditAccount="-99" DebitAccount="'+this.RentRecAc.SelectedValue.toString()+'" ',u+='Amount="'+o.ActualRentofmnt.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount).replace(",","")+'" AmtFc="'+o.ActualRentofmnt.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount).replace(",","")+'"',u+="></Transactions> ",u+=' <Numeric /> <Alpha /> <CostCenters   Query="'+this.strCCQry.toString()+S+'"  />  ',u+="<EXTRAXML> ",i.a.SessionManager.Preferences.ContainsKey("On")&&"True"==i.a.SessionManager.Preferences.On&&l&&(u+="<BillWise> ",u+=' <Row DocSeqNo="2" AccountID="'+this.RentRecAc.SelectedValue.toString(),u+=104==this.CurrCostCenterID?'" AmountFC="-'+o.ActualRentofmnt.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount).replace(",","")+'" AdjAmount="-'+o.ActualRentofmnt.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount).replace(",","")+'"':'" AmountFC="'+o.ActualRentofmnt.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount).replace(",","")+'" AdjAmount="'+o.ActualRentofmnt.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount).replace(",","")+'"',u+=' AdjCurrID="1" ',u+='AdjExchRT="1" ',u+='IsNewReference="1" ',u+='Narration="" ',u+='IsDocPDC="0" ',u+=" ></Row>",u+=" </BillWise>"),u+="</EXTRAXML> ",u+=" </Row>",3==this.Vattype&&this.VATExtraRent&&95==this.CurrCostCenterID&&this.VatonRent>0){if(0==s.e.IntTryParse(e))return this.DisplayMessage="Define Vat Account",this.MessageVisibility=!0,"";u+='<Row><Transactions  CONTRACTSNO="1" ',u+='DocDetailsID="0"  DocSeqNo="3" ',u+='CreditAccount="-99" DebitAccount="'+this.RentRecAc.SelectedValue.toString()+'" ',u+='Amount="'+(parseFloat(o.ActualRentofmnt)*(this.VatonRent/100)).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount).replace(",","")+'" AmtFc="'+(parseFloat(o.ActualRentofmnt)*(this.VatonRent/100)).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount).replace(",","")+'"',u+="></Transactions> ",u+=' <Numeric /> <Alpha /> <CostCenters   Query="'+this.strCCQry.toString()+S+'"  />  ',u+="<EXTRAXML> ",i.a.SessionManager.Preferences.ContainsKey("On")&&"True"==i.a.SessionManager.Preferences.On&&l&&(u+="<BillWise> ",u+=' <Row DocSeqNo="3" AccountID="'+this.RentRecAc.SelectedValue.toString(),u+='" AmountFC="'+(parseFloat(o.ActualRentofmnt)*(this.VatonRent/100)).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount).replace(",","")+'" AdjAmount="'+o.ActualRentofmnt.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount).replace(",","")+'"',u+=' AdjCurrID="1" ',u+='AdjExchRT="1" ',u+='IsNewReference="1" ',u+='Narration="" ',u+='IsDocPDC="0" ',u+=" ></Row>",u+=" </BillWise>"),u+="</EXTRAXML> ",u+=" </Row>",u+='<Row><Transactions  CONTRACTSNO="1" ',u+='DocDetailsID="0"  DocSeqNo="4" ',u+='CreditAccount="'+e+'" DebitAccount="-99" ',u+='Amount="'+(parseFloat(o.ActualRentofmnt)*(this.VatonRent/100)).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount).replace(",","")+'" AmtFc="'+(parseFloat(o.ActualRentofmnt)*(this.VatonRent/100)).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount).replace(",","")+'"',u+="></Transactions> ",u+=' <Numeric /> <Alpha /> <CostCenters   Query="'+this.strCCQry.toString()+S+'"  />  ',u+="<EXTRAXML> ",u+="</EXTRAXML> ",u+=" </Row>"}}u+="</DocumentXML>"}return u.toString()}},{key:"ParentCallBack",value:function(t){var e=this;this.StrMultiple="",this.SelectedUnits="",this.NoOfUnits.Text=t.SelectedNodes.length.toString(),t.SelectedNodes.length>1?(t.SelectedNodes.forEach((function(t){t.IsGroup||(e.StrMultiple+=t.Text[1]+",",e.SelectedUnits+=t.Id+",")})),this.StrMultiple.length>1&&(this.StrMultiple=this.StrMultiple.substring(0,this.StrMultiple.length-1)),s.e.StringIsNullOrEmpty(this.SlNO.Text)||(this.StrMultiple=this.StrMultiple+" :"+this.SlNO.Text),this.SelectedUnits.length>1&&(this.SelectedUnits=this.SelectedUnits.slice(0,-1)),this.ScreenObject.HeaderFields.forEach((function(t){t instanceof l.f&&(t.MultipleUnits.Text=e.StrMultiple),t.multiVisi=!0})),this.Property.Enable=!1,this.multiVisi=!0,this.FillUnitDetails_1()):1==t.SelectedNodes.length?(this.Property.Enable=!0,this.multiVisi=!1,this.Unit.SelectedValue=t.SelectedNodes[0].Id):(this.Property.Enable=!0,this.multiVisi=!1),this.FilterTenantBasedOnUnit&&0==this.ParentContractID&&(this.Tenant.CustomWhere=" a.TenantID IN (SELECT CC.NodeID FROM REN_Units U with(nolock) LEFT JOIN COM_CCCCData CC with(nolock) ON CC.CCNID10=U.CCNodeID  WHERE CC.CostCenterID=94 AND U.UnitID IN("+this.SelectedUnits+") )")}},{key:"FillUnitDetails_1",value:function(){var t=this;this.DataTableObj.Clear();var e,a,n,r=this.DataTableObj.NewRow();if(this.DataTableObj.addRow(r),r.Recurr=!1,this.DataTable[0].Recurr=!0,r.Recurr=!1,this.dsPart=this.StartDate.Date&&this.EndDate.Date?i.a.rental.GetParticularsDetails(this.RenewRefID,this.Unit.SelectedValue,0,this.StartDate.Date,this.EndDate.Date,1,this.ContractID,this.SelectedUnits):this.StartDate.Date?i.a.rental.GetParticularsDetails(this.RenewRefID,this.Unit.SelectedValue,0,this.StartDate.Date,new Date,1,this.ContractID,this.SelectedUnits):i.a.rental.GetParticularsDetails(this.RenewRefID,this.Unit.SelectedValue,0,new Date,this.EndDate.Date?this.EndDate.Date:new Date,1,this.ContractID,this.SelectedUnits),this.DataTable[0].Particulars="Rent",this.DataTable[0].NodeID=this.id2.toString(),null!=this.dsPart&&this.dsPart.Tables.length>5&&this.dsPart.Tables[5].length>0&&this.dsPart.Columns[5].Contains("RentableArea")&&(this.DataTable[0].Sqft=this.dsPart.Tables[5].Compute("sum","RentableArea")),null!=this.dsPart&&this.dsPart.Tables.length>0&&this.dsPart.Tables[0].length>0?e=this.dsPart.Tables[0].filter((function(t){return 1==t.Type||3==t.Type})):null!=this.dsPart&&this.dsPart.Tables.length>1&&this.dsPart.Tables[1].length>0&&(e=this.dsPart.Tables[1].filter((function(t){return 1==t.Type||3==t.Type})),this.dsPart.Columns[1].Contains("UnitID")&&(e=e.filter((function(e){return 0==e.UnitID||e.UnitID in t.SelectedUnits})))),null!=(a=this.dsPart.Tables[6])&&a.length>0&&(this.DataTableColumns.Contains("BasedOn")&&!s.e.IsEmpty(a[0].BasedOn)&&(this.BasedOn.SelectedValue=a[0].BasedOn.toString()),this.DataTableColumns.Contains("ccnid70")&&parseInt(a[0].ccnid70.toString())&&(this.Vattype=parseInt(a[0].ccnid70.toString())),0==this.PickCC&&(null==a[0].SalesmanID||s.e.IsEmpty(a[0].SalesmanID)||(this.Salesman.SelectedValue=parseInt(a[0].SalesmanID.toString())),null==a[0].AccountantID||s.e.IsEmpty(a[0].AccountantID)||(this.Accountant.SelectedValue=parseInt(a[0].AccountantID.toString())),null==a[0].LandlordID||s.e.IsEmpty(a[0].LandlordID)||(this.Landlord.SelectedValue=parseInt(a[0].LandlordID.toString())),null==a[0].LocationID||s.e.IsEmpty(a[0].LocationID)||(this.LocationContract.SelectedValue=parseInt(a[0].LocationID.toString()))),null==a[0].ccnid58||s.e.IsEmpty(a[0].ccnid58)||null!=(n=this.ScreenObject.GetExtrFieldByName("ccnid58"))&&n instanceof l.b&&(n.SelectedValue=parseInt(a[0].ccnid58.toString())),null==a[0].ccnid70||s.e.IsEmpty(a[0].ccnid70)||null!=(n=this.ScreenObject.GetExtrFieldByName("ccnid70"))&&n instanceof l.b&&(n.SelectedValue=parseInt(a[0].ccnid70.toString())),null==a[0].ccnid59||s.e.IsEmpty(a[0].ccnid59)||null!=(n=this.ScreenObject.GetExtrFieldByName("ccnid59"))&&n instanceof l.b&&(n.SelectedValue=parseInt(a[0].ccnid59.toString())),null==a[0].ccnid61||s.e.IsEmpty(a[0].ccnid61)||null!=(n=this.ScreenObject.GetExtrFieldByName("ccnid61"))&&n instanceof l.b&&(n.SelectedValue=parseInt(a[0].ccnid61.toString())),null==a[0].ccnid62||s.e.IsEmpty(a[0].ccnid62)||null!=(n=this.ScreenObject.GetExtrFieldByName("ccnid62"))&&n instanceof l.b&&(n.SelectedValue=parseInt(a[0].ccnid62.toString()))),0==this.PickACC&&this.dsPart.Tables.length>2&&(null==this.dsPart.Tables[2][0].RentalIncomeAccountID||s.e.IsEmpty(this.dsPart.Tables[2][0].RentalIncomeAccountID)||(this.IncomeAc.SelectedValue=parseInt(this.dsPart.Tables[2][0].RentalIncomeAccountID)),null==this.dsPart.Tables[2][0].RentalReceivableAccountID||s.e.IsEmpty(this.dsPart.Tables[2][0].RentalReceivableAccountID)||(this.RentRecAc.SelectedValue=parseInt(this.dsPart.Tables[2][0].RentalReceivableAccountID)),null==this.dsPart.Tables[2][0].AdvanceRentAccountID||s.e.IsEmpty(this.dsPart.Tables[2][0].AdvanceRentAccountID)||(this.GenAdvanceRentAcc=parseInt(this.dsPart.Tables[2][0].AdvanceRentAccountID))),this.GenAdvanceRentAcc>0){var o=i.a.rental.GetAccountName(this.GenAdvanceRentAcc);null!=o&&o.Tables.Count>0&&o.Tables[0].length>0&&!s.e.IsEmpty(o.Tables[0][0].ACCOUNTNAME)&&""!=o.Tables[0][0].ACCOUNTNAME.toString()&&(this.GenAdvanceRentAccName=o.Tables[0][0].ACCOUNTNAME.toString()),this.DataTable[0].CreditAccountID_Key=this.GenAdvanceRentAcc,this.DataTable[0].CreditAccountID=this.GenAdvanceRentAccName}r=this.FillUnitDetails(r,e,this.dsPart),this.CalculateRent()}},{key:"VatCalcOnRenew",value:function(t){this.DataTable.length>0&&(t&&(this.DataTable[0].InclChkGen="1"),3==this.Vattype&&this.VatonRent>0?(this.DataTable[0].VatPer=this.VatonRent,this.ScreenObject.Data.Tables.length>6&&this.ScreenObject.Data.Columns[6].Contains("TCVat")&&this.ScreenObject.Data.Tables[6].length>0&&""!=this.ScreenObject.Data.Tables[6][0].TCVat.toString()&&(this.DataTable[0].TaxCategory=this.ScreenObject.Data.Tables[6][0].TCVat.toString()),this.DataTable[0].TaxCategory_Key=3,t&&(this.DataTable[0].VatType="Exclusive")):4==this.Vattype&&this.VatonRent>0&&(this.DataTable[0].VatPer=0,this.ScreenObject.Data.Tables.length>6&&this.ScreenObject.Data.Columns[6].Contains("TcExcemt")&&this.ScreenObject.Data.Tables[6].length>0&&""!=this.ScreenObject.Data.Tables[6][0].TcExcemt.toString()&&(this.DataTable[0].TaxCategory=this.ScreenObject.Data.Tables[6][0].TcExcemt.toString()),this.DataTable[0].TaxCategory_Key=1),this.DistribtueInvoice&&t&&(this.DataTable[0].RecurInvoice="true"),this.CalculateNRec())}},{key:"ProcessFullRefund",value:function(t){var e=this;this.cntrct.TerminationPostDate=this.cntrct.TerminationDate=t,this.cntrct.TerminationPostDate=this.TerminateContracts.TerminationPostDate.Date,this.cntrct.UnitID=this.Unit.SelectedValue,this.cntrct.TenantID=this.Tenant.SelectedValue,this.cntrct.PropertyID=this.Property.SelectedValue,this.cntrct.ContractID=this.ContractID,this.cntrct.RentRecID=this.RentRecAc.SelectedValue,this.cntrct.WONO=this.strContractNo;var a=i.a.rental.GetPostingDetails(this.cntrct,this.ContractID,this.CurrCostCenterID,5,this.VatNode,this.InvCCID,this.cntrct.PropertyID,this.cntrct.UnitID,this.cntrct.TenantID,this.cntrct.RentRecID);if(null!=a&&a.Tables.length>0){this.ProductID=parseInt(a.Tables[0][0].PRODUCTID.toString()),this.GetCCData(a.Tables[0]),this.RefundAmt=0,this.SRTAmount=0,this.PDCRefund=0,this.VatAmt=0,this.DiscReturn=0,this.cntrct.Wid=this.ScreenObject.CheckWorkFlow_1(8);var n=!1;""!=a.Tables[0][0].IsBillwise.toString()&&(n=Object(r.j)(a.Tables[0][0].IsBillwise.toString())),this.IncomeAc.SelectedValue>0&&(this.cntrct.IncomeID=this.IncomeAc.SelectedValue),this.cntrct.StatusID=477,this.cntrct.PostPaymentXML=this.GetPaymentXML(n),this.cntrct.PostPDPaymentXML=this.GetPDPaymentXML(n,a),this.cntrct.PostRentPayXML=this.GetRefundPaymentXML(a.Tables[2],t),this.cntrct.PostSalesRtnXML=this.GetSRTXML(a.Tables[1],a.Tables[7],a.Tables[2],5,!0,a.Tables[0]);i.a.rental.TerminateContract(this.cntrct,this.CurrCostCenterID,this.SRTAmount,this.RefundAmt,this.PDCRefund,0,0,this.TerminateContracts.BankAccount.SelectedValue,this.TerminateContracts.ChequeNo.Text,this.TerminateContracts.ChequeDate.Date,this.TerminateContracts.Remarks.Text).subscribe((function(t){e.DisplayMessage=t.Message,t.RetValue>0&&e.ClearData()}))}}},{key:"GetRefundPaymentXML",value:function(t,e){var a="";a+="<RENTRCT>";for(var n=0;n<t.length;n++){a+='<ROWS><ChequeDocDate DD="'+new Date(t[n].docdate).ToString("dd/MMM/yyyy")+'"',new Date(t[n].docdate)>e&&(a+=' CancelDOCID="'+t[n].DocID.toString()+'"'),a+="></ChequeDocDate><DocumentXML>",a+='<Row><Transactions CONTRACTSNO="'+(n+1).toString()+'" ',a+='DocDetailsID="0" DocSeqNo="1" ',a+='CreditAccount="'+t[n].DebitAccount.toString()+'" DebitAccount="'+t[n].CreditAccount.toString()+'" ',a+='Amount="'+t[n].amount.toString()+'" AmtFc="'+t[n].amount.toString()+'" ',a+=this.CurrencyContract.SelectedValue>0?'CurrencyID="'+this.CurrencyContract.SelectedValue+'" ':'CurrencyID="1" ',a+='ExchangeRate="1"  CommonNarration="'+m.d.GetValidXml(this.Narration.Text)+'"  LineNarration="  RENT SETTLEMENT " ChequeBankName="" ChequeNumber="" ',a+="></Transactions> ";var s="";this.DataTableColumns.Contains("Location_Key")&&""!=this.DataTable[0].Location_Key.toString()?s+=" dcCCNID2="+this.DataTable[0].Location_Key.toString()+",":this.LocationContract.Visible&&this.LocationContract.SelectedValue>0&&(s+=" dcCCNID2="+this.LocationContract.SelectedValue+","),this.DataTableColumns.Contains("Dim_Key")&&""!=this.DataTable[0].Dim_Key.toString()&&(s+=" dcCCNID"+(this.DimCCID-5e4).toString()+"="+this.DataTable[0].Dim_Key.toString()+","),s+=this.GetSalemanXml(this.DataTable[0]),i.a.SessionManager.Preferences.ContainsKey("DepositLinkDimension")&&""!=i.a.SessionManager.Preferences.DepositLinkDimension&&parseInt(i.a.SessionManager.Preferences.DepositLinkDimension)>0&&(s+=" dcCCNID"+(parseInt(i.a.SessionManager.Preferences.DepositLinkDimension)-5e4).toString()+"="+this.DataTable[0].NodeID.toString()+","),a+=' <Numeric /> <Alpha /> <CostCenters   Query="'+this.strCCQry.toString()+s+'"  /> <EXTRAXML/>',a+=" </Row>",a+="</DocumentXML></ROWS>"}return(a+="</RENTRCT>").toString()}},{key:"OnCustomizeExtraFields",value:function(t){return Object(n.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,l,c,u,h,C,m,b,d,T,y,g,I,p,f,P,N,V,R,M,O,w,j,_,k,K,q,X,Y,z,J,Z,$,tt,et,at,nt,it,st,rt,ot,lt,ct,ut,Dt,ht,Ct,mt,bt,St,dt,Tt,yt,gt,It,pt,At,ft,Pt,Nt,Vt,Rt,Mt,Et,vt,Ot,wt,Lt,xt,jt,Ft,Bt=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Logger.InfoLog("AddEditRenContractViewModel ::Entering OnCustomizeExtraFields"),n="","Customize"!=t.toString()){e.next=6;break}e.next=236;break;case 6:if("MultiUnits"!=t.toString()){e.next=15;break}if(0!=this.Property.SelectedValue){e.next=9;break}return e.abrupt("return",(this.DisplayMessage="Please select property",void(this.MessageVisibility=!0)));case 9:l=" propertyID="+this.Property.SelectedValue.toString(),this.ShowOnlyAvailable?(l=l+" and (UnitStatus = "+this.UnitStatusVal+" or UnitStatus is null or   UnitStatus =  0) and a.UnitID not in (select unitid from ren_contract with(nolock) where unitid is not null and (statusid=426 or statusid=427) ",l+=" AND ContractID NOT IN (SELECT DISTINCT RenewRefID FROM ren_contract WITH(NOLOCK) WHERE RenewRefID IS NOT NULL AND RenewRefID >0 )",l+=" AND RefContractID NOT IN (SELECT DISTINCT RenewRefID FROM ren_contract WITH(NOLOCK) WHERE RenewRefID IS NOT NULL AND RenewRefID >0 ))"):l=l+" and (UnitStatus = "+this.UnitStatusVal+" or UnitStatus is null or   UnitStatus =  0) ",(c=new Q.a).SearchPickerViewModel(this,"units",l,"",this.SelectedUnits),i.a.page.ShowDialog(c,H.a,{HideClose:!0,ShowCenter:!0,Title:i.a.GetResource("Multi Unit")}),e.next=236;break;case 15:if("AddContract"!=t.toString()){e.next=24;break}for((u=new A).AddEditRenContractViewModel_1(95,0,!1,0,0,this.Title),u.Property.SelectedValue=this.Property.SelectedValue,u.ContractNumber.ComboBox.SelectedValue=this.Property.SelectedValue.toString(),u.OnContractPrefixChanged(u.ContractNumber.ComboBox.SelectedValue),u.onListSelectedChanged(u.Property),u.Tenant.SelectedValue=this.Tenant.SelectedValue,u.LocationContract.SelectedValue=this.LocationContract.SelectedValue,u.DivisionContract.SelectedValue=this.DivisionContract.SelectedValue,u.Salesman.SelectedValue=this.Salesman.SelectedValue,u.Landlord.SelectedValue=this.Landlord.SelectedValue,u.Accountant.SelectedValue=this.Accountant.SelectedValue,u.TermsConditions.Text=this.TermsConditions.Text,u.Purpose.Text=this.Purpose.Text,u.Narration.Text=this.Narration.Text,u.TotalYears.Text=this.TotalYears.Text,u.Months.Text=this.Months.Text,u.TotalDays.Text=this.TotalDays.Text,u.StartDate.Date=this.StartDate.Date,u.EndDate.Date=this.EndDate.Date,u.BasedOn.SelectedValue=this.BasedOn.SelectedValue,u.ParentContractID=this.ContractID,C=i.a.rental.GetNextContractNo(95,this.ContractID),u.SlNO.Text=C.toString(),u.RefNo.Visible=!0,u.RefNo.Enable=!1,u.RefNo.Text=this.SlNO.Text,u.AddUnitWhere(2),m=0;m<6;m++)(b=this.DataTableObj.NewRow()).Recurr=!1,this.DataTableObj.addRow(b),d=u.PayTermsDataTableObj.NewRow(),this.PayTermsDataTableObj.addRow(d);this.DataTableObj.UpdateTotals(),this.PayTermsDataTableObj.UpdateTotals(),this.FillExtraFields(u),h={obj:u},i.a.page.addNewTab({title:null,component:U.AddEditRentalContractComponent,params:h}),e.next=236;break;case 24:if("SuspendReservation"!=t.toString()){e.next=29;break}0,this.cntrct.RemaingPaymentXML=null!=this.TerminateContracts&&null!=this.TerminateContracts.BankAccount&&this.TerminateContracts.BankAccount.SelectedValue>0?this.GetRemaingPaymentXML(!1):"",103==this.CurrCostCenterID?i.a.rental.CancelReservation(this.cntrct,this.ContractID,this.RefundDate.Date,"0").subscribe((function(t){Bt.DisplayMessage=t.Message,t.RetValue>0&&(Bt.ClearData(),Bt.RefershPage(),Bt.DeleteVisibility=!1,Logger.InfoLog("AddEditRenContractViewModel :: Exiting SuspendReservation")),Bt.MessageVisibility=!0,Logger.InfoLog("AddEditRenContractViewModel :: Entering SuspendReservation ")}),(function(t){alert(JSON.stringify(t)),console.log("SaveContract : "+JSON.stringify(t))})):i.a.rental.CancelReservation(this.cntrct,this.ContractID,this.TerminateContracts.TerminationDate.Date,this.TerminateContracts.PaymentOption.SelectedValue).subscribe((function(t){Bt.DisplayMessage=t.Message,t.RetValue>0&&(Bt.ClearData(),Bt.RefershPage(),Bt.DeleteVisibility=!1,Logger.InfoLog("AddEditRenContractViewModel :: Exiting SuspendReservation")),Bt.MessageVisibility=!0,Logger.InfoLog("AddEditRenContractViewModel :: Entering SuspendReservation ")}),(function(t){alert(JSON.stringify(t)),console.log("SaveContract : "+JSON.stringify(t))})),e.next=236;break;case 29:if("ViewQuotation"!=t.toString()){e.next=34;break}null!=(T=i.a.rental.GetQuotationDetails(this.LinkedQuotationID))&&T.Tables.length>0&&T.Tables[0].length>0&&T.Columns[0].Contains("CostCenterID")&&((g=new A).AddEditRenContractViewModel_1(parseInt(T.Tables[0][0].CostCenterID.toString()),this.LinkedQuotationID,!1,0,0,"",T),y={obj:g},i.a.page.addNewTab({title:this.ScreenName,component:U.AddEditRentalContractComponent,params:y})),e.next=236;break;case 34:if("CloseReservation"!=t.toString()){e.next=60;break}if(I=0,p=0,null!=this.VacancyDate.Date){e.next=38;break}return e.abrupt("return",(this.DisplayMessage="Select Close Date",void(this.MessageVisibility=!0)));case 38:if(null!=this.ExtndTill&&this.ExtndTill.Date){e.next=40;break}return e.abrupt("return",(this.DisplayMessage="Select Valid/Extended date",void(this.MessageVisibility=!0)));case 40:if(!(null!=this.ExtndTill&&this.ExtndTill.Date&&this.VacancyDate.Date<=this.ExtndTill.Date)){e.next=42;break}return e.abrupt("return",(this.DisplayMessage="CloseDate should be higher than Reservation Valid/Extended date",void(this.MessageVisibility=!0)));case 42:if(this.Property.SelectedValue>0){e.next=44;break}return e.abrupt("return",(this.DisplayMessage="Please select property",void(this.MessageVisibility=!0)));case 44:if(this.cntrct.PropertyID=this.Property.SelectedValue,!this.IsMultiunit||""==this.SelectedUnits){e.next=48;break}this.cntrct.MultiIDS=this.SelectedUnits,this.cntrct.multiName=this.StrMultiple,e.next=51;break;case 48:if(this.Unit.SelectedValue>0){e.next=50;break}return e.abrupt("return",(this.DisplayMessage=i.a.GetResource("PleaseselectUnit"),void(this.MessageVisibility=!0)));case 50:this.cntrct.UnitID=this.Unit.SelectedValue;case 51:if(this.Tenant.SelectedValue>0){e.next=53;break}return e.abrupt("return",(this.DisplayMessage="Please select Tenant",void(this.MessageVisibility=!0)));case 53:if(this.cntrct.TenantID=this.Tenant.SelectedValue,this.RentRecAc.SelectedValue>0&&(this.cntrct.RentRecID=this.RentRecAc.SelectedValue),this.LocationContract.SelectedValue>0&&this.LocationContract.Visible?this.cntrct.LocationID=this.LocationContract.SelectedValue:this.LocationContract.Visible||(this.cntrct.LocationID=1),this.DivisionContract.SelectedValue>0&&this.DivisionContract.Visible?this.cntrct.DivisionID=this.DivisionContract.SelectedValue:this.DivisionContract.Visible||(this.cntrct.DivisionID=1),f=this.GetReceipts(0,p),this.cntrct.PostPDRecieptXML=f.sbIssue,!((p=f.Count)>1)){e.next=57;break}return e.abrupt("return",(this.DisplayMessage="Payment terms can not be more than one in reservation.",void(this.MessageVisibility=!0)));case 57:i.a.rental.CloseReservation(this.cntrct,this.ContractID,this.VacancyDate.Date).subscribe((function(t){Bt.DisplayMessage=t.Message,I=t.RetValue,Bt.MessageVisibility=!0,I>0&&(Bt.ClearData(),Bt.RefershPage(),Bt.VacancyDate.Date=null,Logger.InfoLog("AddEditRenContractViewModel :: Exiting SuspendReservation")),Bt.MessageVisibility=!0,Logger.InfoLog("AddEditRenContractViewModel :: Entering SuspendReservation ")}),(function(t){alert(JSON.stringify(t)),console.log("SaveContract : "+JSON.stringify(t))})),e.next=236;break;case 60:if("ViewHistory"!=t.toString()){e.next=64;break}this.DocumentDraftsPopup(3),e.next=236;break;case 64:if(!("History"==t.toString()&&this.ContractID>0)){e.next=96;break}return e.next=67,a.e(68).then(a.bind(null,"Rr92"));case 67:return P=e.sent,N=P.UpdatePayTermsViewModel,e.next=71,a.e(0).then(a.bind(null,"++ql"));case 71:if(V=e.sent,R=V.UpdatepaytermsComponent,!(null!=(M=i.a.rental.GetHistoryDS(this.ContractID,this.CurrCostCenterID))&&M.Tables.length>0&&M.Columns[0].Contains("ModifiedBy"))){e.next=94;break}(O=new N("AddEditRenContractViewModel")).UpdatePayTermsViewModel_1(this,null,null,2),O.PstDocGrid.Columns=[],(w=new D.a).Header="User",w.DisplayMember="ModifiedBy",w.ReadOnly=!0,w.Width=150,O.PstDocGrid.Columns.push(w),(w=new D.a).Header="Date",w.DisplayMember="ModifiedDate",w.ReadOnly=!0,w.DisableTab=!0,w.Width=120,O.PstDocGrid.Columns.push(w),(w=new D.a).Header="Status",w.DisplayMember="Status",w.ReadOnly=!0,w.DisableTab=!0,w.Width=120,O.PstDocGrid.Columns.push(w),O.PstDocGrid.Width="450",O.PstDocGrid.Table=[],O.PstDocGrid.TableColumns.push("ModifiedBy"),O.PstDocGrid.TableColumns.push("ModifiedDate"),O.PstDocGrid.TableColumns.push("Status"),j=0;case 80:if(!(j<M.Tables[0].length)){e.next=93;break}if((_=O.PstDocGrid.NewRow()).ModifiedBy=M.Tables[0][j].ModifiedBy.toString(),!s.e.IsEmpty(M.Tables[0][j].ModifiedDate)){e.next=88;break}if(!s.e.IsEmpty(M.Tables[0][j].CreatedDate)){e.next=85;break}return e.abrupt("continue",90);case 85:_.ModifiedDate=new Date(M.Tables[0][j].CreatedDate.toString()).ToString(i.a.SessionManager.Preferences["Date Format"]+" hh:mm:ss tt"),e.next=89;break;case 88:_.ModifiedDate=new Date(M.Tables[0][j].ModifiedDate.toString()).ToString(i.a.SessionManager.Preferences["Date Format"]+" hh:mm:ss tt");case 89:_.Status=M.Tables[0][j].Status.toString(),O.PstDocGrid.addRow(_);case 90:j++,e.next=80;break;case 93:i.a.page.ShowDialog(O,R,{Title:O.DisplayName,HideClose:!0,ShowCenter:!0});case 94:e.next=236;break;case 96:if("Suspend"!=t.toString()){e.next=100;break}this.resTerm="NO",95==this.CurrCostCenterID?confirm(" Are you sure you want to Cancel Contract ? ")&&(0,i.a.rental.CancelContract(this.ContractID).subscribe((function(t){Bt.DisplayMessage=t.Message,t.RetValue>0&&(Bt.ClearData(),Bt.RefershPage(),Logger.InfoLog("AddEditRenContractViewModel :: Exiting OnSaveContract")),Bt.MessageVisibility=!0,Logger.InfoLog("AddEditRenContractViewModel :: Entering OnSaveContract ")}),(function(t){alert(JSON.stringify(t)),console.log("SaveContract : "+JSON.stringify(t))}))):103==this.CurrCostCenterID?confirm(" Are you sure you want to Cancel Quotation ? ")&&(this.RefundDate=new S.a,this.RefundDate.Label=i.a.GetResource("Date"),this.RefundDate.DBColumnName="RefundDate",this.RefundDate.Date=new Date,this.RefundDate.Row=0,this.RefundDate.Column=0,this.SuspendVisiblity=!0,this.CloseVisiblity=!1,i.a.page.ShowDialog(this,G.a,{Title:"Suspend"})):confirm(" Are you sure you want to Cancel Reservation ? ")&&(null==this.ContractNumber.ComboBox.SelectedItem&&(this.ContractNumber.ComboBox.SelectedItem=this.ContractNumber.ComboBox.Items.find((function(t){return t.Value==Bt.ContractNumber.ComboBox.SelectedValue}))),this.strContractNo=this.ContractNumber.ComboBox.SelectedItem.Name+"~"+this.ContractNumber.TextBox.Text.Trim(),this.TerminateContracts=new E(this,this.ContractID,this.strContractNo,4),this.DeleteVisibility=!0,this.resTerm="",this.TerminateContracts.parent=this,i.a.page.ShowDialog(this.TerminateContracts,v.a,{Title:this.TerminateContracts.Title})),e.next=236;break;case 100:if("RefundVisiblity"!=t.toString()){e.next=104;break}null==this.ContractNumber.ComboBox.SelectedItem&&(this.ContractNumber.ComboBox.SelectedItem=this.ContractNumber.ComboBox.Items.find((function(t){return t.Value==Bt.ContractNumber.ComboBox.SelectedValue}))),this.strContractNo=this.ContractNumber.ComboBox.SelectedItem.Name+"~"+this.ContractNumber.TextBox.Text.Trim(),this.TerminateContracts=new E(this,this.ContractID,this.strContractNo,3),this.DeleteVisibility=!0,this.TerminateContracts.parent=this,i.a.page.ShowDialog(this.TerminateContracts,v.a,{Title:this.TerminateContracts.Title}),e.next=236;break;case 104:if("Fullrefund"!=t.toString()){e.next=108;break}this.resTerm="",confirm(" Are you sure you want Full Refund? ")&&(this.strContractNo=this.ContractNumber.ComboBox.SelectedItem.Name+"~"+this.ContractNumber.TextBox.Text.Trim(),this.TerminateContracts=new E(this,this.ContractID,this.strContractNo,5),this.DeleteVisibility=!0,i.a.page.ShowDialog(this.TerminateContracts,v.a,{Title:this.TerminateContracts.Title})),e.next=236;break;case 108:if("VacantVisiblity"!=t.toString()){e.next=112;break}129==this.CurrCostCenterID?(this.resTerm="NO",confirm(" Are you sure you want to Close Reservation ? ")&&(this.SuspendVisiblity=!1,this.CloseVisiblity=!0,this.VacancyDate=new S.a,this.VacancyDate.Label=i.a.GetResource("Close Date"),this.VacancyDate.DBColumnName="CloseDate",this.VacancyDate.Date=new Date,i.a.page.ShowDialog(this,G.a,{Title:"Close Reservation"}))):(null==this.ContractNumber.ComboBox.SelectedItem&&(this.ContractNumber.ComboBox.SelectedItem=this.ContractNumber.ComboBox.Items.find((function(t){return t.Value==Bt.ContractNumber.ComboBox.SelectedValue}))),this.strContractNo=this.ContractNumber.ComboBox.SelectedItem.Name+"~"+this.ContractNumber.TextBox.Text.Trim(),this.TerminateContracts=new E(this,this.ContractID,this.strContractNo,2),this.DeleteVisibility=!0,this.TerminateContracts.parent=this,i.a.page.ShowDialog(this.TerminateContracts,v.a,{Title:this.TerminateContracts.Title})),e.next=236;break;case 112:if("Report"!=t.toString()){e.next=116;break}this.SetVisibilityFalse(),this.ReportInfoVisibility=!0,i.a.page.ShowDialog(this,W.a,{Title:"Reports"}),e.next=236;break;case 116:if("UnitStatus"!=t.toString()){e.next=120;break}i.a.page.ShowDialog(this,L.a,{Title:"Change Unit Status"}),this.SetVisibilityFalse(),this.StatusVisiblity=!0,e.next=236;break;case 120:if("RejectVisiblity"!=t.toString()){e.next=124;break}"465"==this.StatusID.SelectedValue?(this.cntrct.ContractID=this.ContractID,0,i.a.rental.ApproveContractDocs(this.CostCenterID,!0,"",this.cntrct.ContractID).subscribe((function(t){Bt.DisplayMessage=t.Message,Bt.MessageVisibility=!0,t.RetValue>0&&(Bt.BtnApprove.Visible=!1,Bt.RejectVisiblity=!1,Bt.ClearData(),Bt.RefershPage(),Logger.InfoLog("AddEditRenContractViewModel :: Exiting terminate approval")),Bt.SetVisibilityFalse(),Bt.RejectVisiblity=!0,Bt.SaveapproveVisiblity=!!i.a.SessionManager.IsActionAssigned(Bt.CostCenterID,"Save Contracts on approve"),Bt.RejectRemarks="",Logger.InfoLog("AddEditRenContractViewModel :: terminate approval ")}),(function(t){alert(JSON.stringify(t)),console.log("SaveContract : "+JSON.stringify(t))}))):(this.SetVisibilityFalse(),this.RejectVisiblity=!0,this.RejectRemarks="",i.a.page.ShowDialog(this,x.a,{Title:i.a.GetResource("ApproveReject"),ShowCenter:!0})),e.next=236;break;case 124:if("Cancel"!=t.toString()){e.next=128;break}i.a.page.HideDialog(),this.SetVisibilityFalse(),e.next=236;break;case 128:if("ChangeStatus"!=t.toString()){e.next=132;break}s.e.StringIsNullOrEmpty(this.UnitStatus.SelectedValue)||(""!=this.SelectedUnits?this.DisplayMessage=i.a.rental.ChangeStatus(this.UnitStatus.SelectedValue,this.SelectedUnits):this.Unit.SelectedValue>0&&(this.DisplayMessage=i.a.rental.ChangeStatus(this.UnitStatus.SelectedValue,this.Unit.SelectedValue.toString())),this.MessageVisibility=!0),e.next=236;break;case 132:if("Clone"!=t.toString()){e.next=136;break}this.Clone(),e.next=236;break;case 136:if("Renew"!=t.toString()&&"AutoRenew"!=t.toString()){e.next=191;break}if(k=0,95!=this.CostCenterID||"AutoRenew"==t.toString()){e.next=144;break}if(q=!1,K=this.ScreenObject.Data.Tables[5].filter((function(t){return"DonotRenewOnDue"==t.Name})),_toArray(K),(X=K).length>0&&(q=Object(r.j)(X[0].Value.toString())),Y=i.a.rental.GetContractBalance(this.CostCenterID,this.ContractID),!s.e.IsEmpty(Y)&&Y.length>0&&(k=s.e.DoubleTryParse(Y[0].Balance.toString())),!(q&&k>0)){e.next=144;break}return e.abrupt("return",(this.DisplayMessage="Cannot Renew Contract, Amount Due : "+k,void(this.MessageVisibility=!0)));case 144:if(z="",J="","AutoRenew"==t.toString()?J="Yes":z=k>0?"  Amount Due : "+k+".  Do you really want to Renew this Contract? ":"  Do you really want to Renew this Contract?",!confirm(z)&&"Yes"!=J){e.next=189;break}if(this.IsRecurPosted=!1,this.TotalYears.IsReadOnly=this.Months.IsReadOnly=this.RecurDuration.IsReadOnly=this.ContractDate.IsReadOnly=this.StartDate.IsReadOnly=this.EndDate.IsReadOnly=!1,this.RenewRefID=this.ContractID,this.ContractID=0,this.ParticularsBodyReadOnly=!1,this.CheckViewForUser(this.ContractID),Z=this.NoofCheques,$=this.InstPeriod,tt=this.FirstNumber,et=this.PayeeBnk,at=this.DebitAcc,nt=this.DebitName,this.Property.Enable=!1,this.Unit.Enable=!1,this.Tenant.Enable=!1,n=this.StartDate.Date?this.EndDate.Date.Subtract(this.StartDate.Date).Days+1:this.EndDate.Date.Subtract(this.EndDate.Date).Days+1,s.e.IsLeapYear(this.EndDate.Date.getFullYear())?(it=new Date(this.EndDate.Date.getFullYear(),1,29))>this.StartDate.Date&&it<this.EndDate.Date&&(n=(parseInt(n)-1).toString()):s.e.IsLeapYear(this.StartDate.Date.getFullYear())&&(st=new Date(this.StartDate.Date.getFullYear(),1,29))>this.StartDate.Date&&st<this.EndDate.Date&&(n=(parseInt(n)-1).toString()),rt=i.a.rental.GetNextContractNo(this.CurrCostCenterID,this.ParentContractID),this.SlNO.Text=rt,this.ContractNumber.TextBox.Text=(parseInt(this.ContractNumber.TextBox.Text)+1).toString(),this.StartDate.Date=this.EnableGracePeriod&&this.ExpectedEndDate.Date?this.ExpectedEndDate.Date.AddDays(1):this.EndDate.Date.AddDays(1),""!=n&&this.StartDate.Date?this.EndDate.Date=this.StartDate.Date.AddDays(parseInt(n)-1):""!=n&&(this.EndDate.Date=(new Date).AddDays(parseInt(n)-1)),this.ContractDate.Date=new Date,this.stDate=this.StartDate.Date?this.StartDate.Date:new Date,this.strRenew="Renew",this.NoofCheques=Z,this.InstPeriod=$,this.FirstNumber=tt,this.PayeeBnk=et,this.DebitAcc=at,this.DebitName=nt,this.StatusID.SelectedValue="427",this.ViewAttachments.AttachmentsList.length>0)if((ot=this.ScreenObject.Data.Tables[5].find((function(t){return"CopyAttachRenew"==t.Name}))).length>0&&""!=ot[0].Value.toString()&&Object(r.j)(ot[0].Value.toString()))for(lt=0;lt<this.ViewAttachments.AttachmentsList.length;lt++)this.ViewAttachments.AttachmentsList[lt].AttachmentID=0;else this.ViewAttachments.AttachmentsList.Clear();for(95==this.CostCenterID&&this.IsExtended.Enable?(this.IsExtended.Visible=!0,this.IsExtended.SelectedValue="false"):this.IsExtended.Visible&&(this.IsExtended.Visible=!1),this.dsPart=104==this.CurrCostCenterID?this.StartDate.Date&&this.EndDate.Date?i.a.rental.GetParticularsDetails(this.RenewRefID,0,this.Property.SelectedValue,this.StartDate.Date,this.EndDate.Date,2,this.ContractID,""):this.StartDate.Date?i.a.rental.GetParticularsDetails(this.RenewRefID,0,this.Property.SelectedValue,this.StartDate.Date,new Date,2,this.ContractID,""):i.a.rental.GetParticularsDetails(this.RenewRefID,0,this.Property.SelectedValue,new Date,this.EndDate.Date?this.EndDate.Date:new Date,2,this.ContractID,""):this.StartDate.Date&&this.EndDate.Date?i.a.rental.GetParticularsDetails(this.RenewRefID,this.Unit.SelectedValue,0,this.StartDate.Date,this.EndDate.Date,1,this.ContractID,this.SelectedUnits):this.StartDate.Date?i.a.rental.GetParticularsDetails(this.RenewRefID,this.Unit.SelectedValue,0,this.StartDate.Date,new Date,1,this.ContractID,this.SelectedUnits):i.a.rental.GetParticularsDetails(this.RenewRefID,this.Unit.SelectedValue,0,new Date,this.EndDate.Date?this.EndDate.Date:new Date,1,this.ContractID,this.SelectedUnits),""!=this.SelectedUnits&&this.multiVisi&&(this.SelectedUnits.Contains(",")?s.e.StringIsNullOrEmpty(this.SlNO.Text)||(this.StrMultiple.Contains(":")&&(this.StrMultiple=this.StrMultiple.Replace(this.StrMultiple.lastIndexOf(":"),"")),this.StrMultiple=this.StrMultiple+" :"+this.SlNO.Text):(this.multiVisi=!1,this.Unit.SelectedValue=parseInt(this.SelectedUnits),this.StrMultiple="",this.SelectedUnits="")),ct=1;ct<this.DataTable.length;ct++)this.DataTableObj.removeRowAt(ct),ct--;if(null!=this.dsPart&&this.dsPart.Tables.length>0&&null!=(ut=this.dsPart.Tables[6])&&ut.length>0&&null!=ut[0].ccnid70&&(this.Vattype=s.e.IntTryParse(ut[0].ccnid70.toString())),null!=this.dsPart&&this.dsPart.Tables.length>0&&this.dsPart.Tables[0].length>0?(Dt=(Dt=this.dsPart.Tables[0]).filter((function(t){return 2==t.Type||3==t.Type})),ht=this.DataTableObj.NewRow(),ht=this.FillUnitDetails(ht,Dt,this.dsPart)):null!=this.dsPart&&this.dsPart.Tables.length>1&&this.dsPart.Tables[1].length>0?(Ct=this.dsPart.Tables[1],(Ct=this.dsPart.Columns[1].Contains("UnitID")?Ct.filter((function(t){return 2==t.Type||3==t.Type&&0==t.UnitID||t.UnitID==Bt.Unit.SelectedValue})):Ct.filter((function(t){return 2==t.Type||3==t.Type}))).length>0?(mt=this.DataTableObj.NewRow(),mt=this.FillUnitDetails(mt,Ct,this.dsPart)):this.VatCalcOnRenew(!0)):this.VatCalcOnRenew(!0),this.DataTable.length>0&&(this.DataTable[0].Status=null,this.DataTable[0].DocPrefix=null,this.DataTable[0].DocNumber=null,this.DataTable[0].CostCenterID=null,this.DataTable[0].DocumentNo=null,this.DataTable[0].DocID=null,this.DataTable[0].TempCCID_Key=null,this.DataTable[0].TempCCID=null,this.DataTable[0].DocumentName=null,this.DataTable[0].Xml=null,(50002==this.DimCCID&&this.DataTableColumns.Contains("Dim_Key")&&null!=this.dsPart&&this.dsPart.Columns[6].Contains("Dimname")&&this.dsPart.Tables[6].length>0&&"0"!=this.dsPart.Tables[6][0].DimNodeID.toString()||this.DataTableColumns.Contains("Dim_Key")&&null!=this.dsPart&&this.dsPart.Columns[6].Contains("Dimname")&&this.dsPart.Tables[6].length>0&&"0"!=this.dsPart.Tables[6][0].DimNodeID.toString())&&(this.DataTable[0].Dim_Key=this.dsPart.Tables[6][0].DimNodeID.toString(),this.DataTable[0].Dim=this.dsPart.Tables[6][0].Dimname.toString())),this.PayTermsDataTableObj.Table.Clear(),this.PayTermsDataTableObj.refreshDataView(),this.CalculateRentBaedOnDays(0,!1),bt=i.a.rental.GetRenewDetails(this.RenewRefID),!s.e.IsEmpty(bt)&&bt.Tables.length>2&&bt.Tables[2].length>0&&bt.Columns[2].Contains("ParentRefID")&&!s.e.IsEmpty(bt.Tables[2][0].ParentRefID)&&parseInt(bt.Tables[2][0].ParentRefID.toString())>0&&(this.ParentContractID=parseInt(bt.Tables[2][0].ParentRefID.toString()),this.RefNo.Text=bt.Tables[2][0].ParentSno.toString()),!(!s.e.IsEmpty(bt)&&bt.Tables.length>0&&bt.Tables[0].length>0&&bt.Columns[0].Contains("NodeID"))){e.next=181;break}St=0,dt=function(t){var e;if(!s.e.IsEmpty(Bt.DataTable[t].NodeID))return"continue";var a=(_toArray(e=bt.Tables[0].filter((function(e){return e.CCNodeID==Bt.DataTable[t].NodeID.toString()}))),e);if(a.length>0&&!s.e.IsEmpty(a[0].Detailsxml)){var n,r=new s.f;if(r.LoadXml(a[0].Detailsxml.toString()),null!=r)if(Bt.multiVisi&&""!=Bt.SelectedUnits&&r.DocumentElement.children.length>0&&null!=r.DocumentElement.children[0].attributes&&null!=r.DocumentElement.children[0].attributes.Filter&&!s.e.StringIsNullOrEmpty(r.DocumentElement.children[0].attributes.Filter)&&"0"==r.DocumentElement.children[0].attributes.Filter){yt=r.SelectNodes("XML/UnitsRow/Row");var o=0,l=0,c="";c+='<XML Filter="1" >';for(var u=0;u<yt.length;u++){var D=yt[u];null!=D.attributes.FromDate&&!s.e.StringIsNullOrEmpty(D.attributes.FromDate)&&s.e.isValidDate(D.attributes.FromDate)&&n==Bt.StartDate.Date&&(n=D.attributes.FromDate,null==D.attributes.Period||s.e.StringIsNullOrEmpty(D.attributes.Period)||(St=parseInt(D.attributes.Period)),o+=parseFloat(D.attributes.Amount),null==D.attributes.Discount||s.e.StringIsNullOrEmpty(D.attributes.Discount)||(l+=parseFloat(D.attributes.Discount)),c+="<Row ",c+='Unit="'+D.attributes.Unit+'" ',null==D.attributes.Period||s.e.StringIsNullOrEmpty(D.attributes.Period)||(c+='Period="'+D.attributes.Period+'" '),c+='Amount="'+D.attributes.Amount+'"/>')}c+="</XML>",Bt.DataTable[t].Amount=Bt.RentAmt,Bt.DataTable[t].NodeID.toString()==Bt.id2.toString()&&(Bt.DataTable[t].Discount=l.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),Bt.DataTable[t].ActAmount=(o+l).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())),Bt.DataTable[t].Xml=c.toString()}else{yt=r.SelectNodes("XML/Row");for(var h=0;h<yt.length;h++){var C=yt[h];null!=C.attributes.FromDate&&!s.e.StringIsNullOrEmpty(C.attributes.FromDate)&&s.e.isValidDate(C.attributes.FromDate)&&n==Bt.StartDate.Date&&(n=C.attributes.FromDate,null==C.attributes.Period||s.e.StringIsNullOrEmpty(C.attributes.Period)||(St=parseInt(C.attributes.Period)),Bt.DataTable[t].Amount=parseFloat(C.attributes.Amount),Bt.DataTable[t].NodeID.toString()==Bt.id2.toString()&&(null==C.attributes.Discount||s.e.StringIsNullOrEmpty(C.attributes.Discount)?(Bt.DataTable[t].Discount=0,Bt.DataTable[t].ActAmount=parseFloat(C.attributes.Amount)):(Bt.DataTable[t].Discount=C.attributes.Discount,Bt.DataTable[t].ActAmount=parseFloat(Bt.DataTable[t].Discount)+parseFloat(Bt.DataTable[t].Amount))))}}}},Tt=0;case 161:if(!(Tt<this.DataTable.length)){e.next=168;break}if("continue"!==dt(Tt)){e.next=165;break}return e.abrupt("continue",165);case 165:Tt++,e.next=161;break;case 168:gt=0;case 169:if(!(gt<bt.Tables[1].length)){e.next=181;break}if(!(St>0)||s.e.IsEmpty(bt.Tables[1][gt].Period)||parseInt(bt.Tables[1][gt].Period.toString())==St){e.next=172;break}return e.abrupt("continue",178);case 172:if(!this.EndDate.Date||!this.StartDate.Date||s.e.IsEmpty(bt.Tables[1][gt].ChequeDate)||!(new Date(bt.Tables[1][gt].ChequeDate.toString())>this.EndDate.Date||new Date(bt.Tables[1][gt].ChequeDate.toString())<this.StartDate.Date)){e.next=174;break}return e.abrupt("continue",178);case 174:(It=this.PayTermsDataTableObj.NewRow()).ChequeNo=bt.Tables[1][gt].ChequeNo.toString(),this.InclPostingDate&&bt.Columns[1].Contains("PostingDate")&&!s.e.IsEmpty(bt.Tables[1][gt].PostingDate)&&(It.PostingDate=new Date(bt.Tables[1][gt].PostingDate).ToString(i.a.SessionManager.Preferences["Date Format"]),It.PostingDate_Key=new Date(bt.Tables[1][gt].PostingDate)),s.e.IsEmpty(bt.Tables[1][gt].ChequeDate)||(It.CntrlDate=new Date(bt.Tables[1][gt].ChequeDate).ToString(i.a.SessionManager.Preferences["Date Format"])),It.CntrlDate_Key=bt.Tables[1][gt].ChequeDate.toString(),pt=0,(pt=s.e.IntTryParse(bt.Tables[1][gt].CustomerBank.toString()))>=0&&(It.PayeeBank=pt.toString()),It.Narration="",It.DebitAccountID_Key=bt.Tables[1][gt].DebitAccID.toString(),It.Narration=bt.Tables[1][gt].Narration.toString(),It.DebitAccountID=bt.Tables[1][gt].DebitAccName.toString(),It.Period=bt.Tables[1][gt].Period.toString(),null!=bt.Tables[1][gt].Amount&&null!=bt.Tables[1][gt].Amount&&(It.Amount=parseFloat(bt.Tables[1][gt].Amount).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())),this.PayTermsDataTable.push(It);case 178:gt++,e.next=169;break;case 181:for(this.RefreshGrid=!this.RefreshGrid,this.CalculateFooter(),At=0;At<6;At++)(ft=this.DataTableObj.NewRow()).Recurr=!1,this.DataTableObj.addRow(ft),Pt=this.PayTermsDataTableObj.NewRow(),this.PayTermsDataTableObj.addRow(Pt);this.ButtonSaveAndPrint.Enable=this.ButtonSave.Enable=!0,i.a.SessionManager.HideUnathorizedAccess?this.ButtonSaveAndPrint.Visible=this.ButtonSave.Visible=i.a.SessionManager.IsActionAssigned(this.CurrCostCenterID,"Create"):this.ButtonSaveAndPrint.Enable=this.ButtonSave.Enable=i.a.SessionManager.IsActionAssigned(this.CurrCostCenterID,"Create"),this.ButtonRenew.Enable=!1,this.ButtonTerminate.Enable=!1,this.BtnApprove.Visible=!1,null!=(Nt=this.GetButton("Reject"))&&(Nt.Visible=!1),this.ButtonSuspend.Visible=!1,this.ButtonRefund.Visible=!1,this.BtnFullRefund.Visible=!1,this.ButtonVacant.Visible=!1,this.SetButtonVisibility("Suspend",!1),this.SetButtonVisibility("RefundVisiblity",!1),this.SetButtonVisibility("Vacant",!1),this.SetButtonVisibility("Fullrefund",!1),Vt=[],(Rt=this.ScreenObject.Data.Tables[5].filter((function(t){return"RenewFields"==t.Name}))).length>0&&Rt[0].Value.toString().length>0&&(Vt=Rt[0].Value.toString().split(",")),null!=Vt&&Vt.length>0&&this.ScreenObject.CustomTab.Pages.forEach((function(t){t.Fields.forEach((function(t){t instanceof o.c&&Vt.Contains(t.DBColumnName)&&Bt.ScreenObject.SetProperty_DefaultValue(t)}))}));case 189:e.next=236;break;case 191:if("Terminate"!=t.toString()){e.next=195;break}this.resTerm="NO",confirm(" Do you really want to Terminate this Contract.? ")&&(null==this.ContractNumber.ComboBox.SelectedItem&&(this.ContractNumber.ComboBox.SelectedItem=this.ContractNumber.ComboBox.Items.find((function(t){return t.Value==Bt.ContractNumber.ComboBox.SelectedValue}))),this.strContractNo=this.ContractNumber.ComboBox.SelectedItem.Name+"~"+this.ContractNumber.TextBox.Text.Trim(),this.TerminateContracts=new E(this,this.ContractID,this.strContractNo,1),this.DeleteVisibility=!0,this.resTerm="",this.TerminateContracts.parent=this,i.a.page.ShowDialog(this.TerminateContracts,v.a,{Title:this.TerminateContracts.Title})),e.next=236;break;case 195:if("CancelTerminate"!=t.toString()){e.next=199;break}this.resTerm="NO",129==this.CurrCostCenterID?confirm(" Do you really want to Cancel the Closed Reservation?")&&(0,i.a.rental.CancelClosedReservation(this.ContractID).subscribe((function(t){Bt.DisplayMessage=t.Message,t.RetValue>0&&(Bt.ClearData(),Logger.InfoLog("AddEditRenContractViewModel :: Exiting OnSaveContract")),Bt.MessageVisibility=!0,Logger.InfoLog("AddEditRenContractViewModel :: Entering OnSaveContract ")}),(function(t){alert(JSON.stringify(t)),console.log("SaveContract : "+JSON.stringify(t))}))):(Mt=" Do you really want to Cancel ",Mt+="450"==this.StatusID.SelectedValue||"477"==this.StatusID.SelectedValue?"Refund?":"480"==this.StatusID.SelectedValue||"481"==this.StatusID.SelectedValue?"Close?":"Termination?",confirm(Mt)&&(0,i.a.rental.CancelTermination(this.CurrCostCenterID,this.ContractID).subscribe((function(t){Bt.DisplayMessage=t.Message,t.RetValue>0&&(Bt.ClearData(),Bt.RefershPage(),Logger.InfoLog("AddEditRenContractViewModel :: Exiting OnSaveContract")),Bt.MessageVisibility=!0,Logger.InfoLog("AddEditRenContractViewModel :: Entering OnSaveContract ")}),(function(t){alert(JSON.stringify(t)),console.log("SaveContract : "+JSON.stringify(t))})))),e.next=236;break;case 199:if("Approve"!=t.toString()){e.next=209;break}if(Et=!0,(vt=this.ScreenObject.Data.Tables[5].filter((function(t){return"CommentsMandatoryforApprove"==t.Name}))).length>0&&(Et=Object(r.j)(vt[0].Value.toString())),!Et||!s.e.IsEmpty(this.RejectRemarks)){e.next=203;break}return e.abrupt("return",(this.DisplayMessage="Enter Remarks",void(this.MessageVisibility=!0)));case 203:Ot=this.ContractID,"465"!=this.StatusID.SelectedValue&&"481"!=this.StatusID.SelectedValue&&"479"!=this.StatusID.SelectedValue&&"478"!=this.StatusID.SelectedValue&&i.a.SessionManager.IsActionAssigned(this.CostCenterID,"Save Contracts on approve")&&this.OnSave("Save"),this.cntrct.ContractID=Ot,0,i.a.rental.ApproveContractDocs(this.CostCenterID,!0,this.RejectRemarks,this.cntrct.ContractID).subscribe((function(t){if(Bt.DisplayMessage=t.Message,Bt.MessageVisibility=!0,t.RetValue>0){Bt.BtnApprove.Visible=!1;var e=Bt.GetButton("Reject");null!=e&&(e.Visible=!1),Bt.BtnApprove.Visible=!1,Bt.RejectVisiblity=!1,Bt.ClearData(),Bt.RefershPage(),Logger.InfoLog("AddEditRenContractViewModel :: Exiting Approve")}Bt.SetVisibilityFalse(),Bt.RejectVisiblity=!0,Bt.RejectRemarks="",Logger.InfoLog("AddEditRenContractViewModel :: terminate Approve ")}),(function(t){alert(JSON.stringify(t)),console.log("SaveContract : "+JSON.stringify(t))})),e.next=236;break;case 209:if("Reject"!=t.toString()){e.next=223;break}if(wt=!0,(Lt=this.ScreenObject.Data.Tables[5].filter((function(t){return"CommentsMandatoryforReject"==t.Name}))).length>0&&(wt=Object(r.j)(Lt[0].Value.toString())),!wt||!s.e.IsEmpty(this.RejectRemarks)){e.next=213;break}return e.abrupt("return",(this.DisplayMessage="Enter Remarks",void(this.MessageVisibility=!0)));case 213:if(xt=this.ContractID,"465"==this.StatusID.SelectedValue||!i.a.SessionManager.IsActionAssigned(this.CostCenterID,"Save Contracts on approve")){e.next=218;break}if(jt={RetValue:void 0},this.OnSave("Save",jt),0!=jt.RetValue){e.next=218;break}return e.abrupt("return");case 218:this.cntrct.ContractID=xt,0,i.a.rental.ApproveContractDocs(this.CostCenterID,!1,this.RejectRemarks,this.cntrct.ContractID).subscribe((function(t){if(Bt.DisplayMessage=t.Message,Bt.MessageVisibility=!0,t.RetValue>0){Bt.BtnApprove.Visible=!1;var e=Bt.GetButton("Reject");null!=e&&(e.Visible=!1),Bt.BtnApprove.Visible=!1,Bt.RejectVisiblity=!1,Bt.ClearData(),Bt.RefershPage(),Logger.InfoLog("AddEditRenContractViewModel :: Exiting Reject")}Bt.SetVisibilityFalse(),Bt.RejectVisiblity=!0,Bt.RejectRemarks="",Logger.InfoLog("AddEditRenContractViewModel :: terminate Reject ")}),(function(t){alert(JSON.stringify(t)),console.log("SaveContract : "+JSON.stringify(t))})),e.next=236;break;case 223:if("ChangeLocation"!=t.toString()){e.next=228;break}(Ft=new F.DocumentNumberViewModel(this,this.ScreenObject.Data.Tables[8],!0,null)).DocumentNumberViewModel_1(this),i.a.page.ShowDialog(Ft,B.DocumentNumberComponent,{HideClose:!0,ShowCenter:!0,Title:i.a.GetResource("DocumentNumberTitle")}),e.next=236;break;case 228:if("CheckUnits"!=t.toString()){e.next=236;break}if(0!=this.Property.SelectedValue){e.next=231;break}return e.abrupt("return",(this.DisplayMessage="Please select property",void(this.MessageVisibility=!0)));case 231:if(0!=this.Unit.SelectedValue){e.next=233;break}return e.abrupt("return",(this.DisplayMessage=i.a.GetResource("PleaseselectUnit"),void(this.MessageVisibility=!0)));case 233:if(null!=this.TotalDays.Text&&""!=this.TotalDays.Text&&(null==this.TotalDays.Text||""==this.TotalDays.Text||0!=parseInt(this.TotalDays.Text))){e.next=235;break}return e.abrupt("return",(this.DisplayMessage="Please select dates",void(this.MessageVisibility=!0)));case 235:this.validateUnit()||(this.DisplayMessage="Unit available",this.MessageVisibility=!0);case 236:Logger.InfoLog("AddEditRenContractViewModel ::Exiting OnCustomizeExtraFields");case 237:case"end":return e.stop()}}),e,this)})))}},{key:"Clone",value:function(){if(confirm(" Do you want to Clone this Contract? ")){this.IsRecurPosted=!1,this.TotalYears.IsReadOnly=this.Months.IsReadOnly=this.RecurDuration.IsReadOnly=this.ContractDate.IsReadOnly=this.StartDate.IsReadOnly=this.EndDate.IsReadOnly=!1,this.RenewRefID=0,this.ContractID=0,this.ParticularsBodyReadOnly=!1,this.CheckViewForUser(this.ContractID);var t=this.NoofCheques,e=this.InstPeriod,a=this.FirstNumber,n=this.PayeeBnk,r=this.DebitAcc,o=this.DebitName;this.SlNO.Text=this.cntrct.GetNextContractNo(this.CostCenterID,this.ParentContractID),this.ContractNumber.TextBox.Text=(parseInt(this.ContractNumber.TextBox.Text)+1).toString(),this.ContractDate.Date=new Date,this.stDate=this.StartDate.Date?this.StartDate.Date:new Date,this.strRenew="Save",this.CntStatus="[New]",this.NoofCheques=t,this.InstPeriod=e,this.FirstNumber=a,this.PayeeBnk=n,this.DebitAcc=r,this.DebitName=o,this.StatusID.SelectedValue="427",this.IsExtended.Visible&&(this.IsExtended.Visible=!1),""!=this.SelectedUnits&&this.multiVisi&&(this.SelectedUnits.Contains(",")?s.e.IsEmpty(this.SlNO.Text)||(this.StrMultiple.Contains(":")&&(this.StrMultiple=this.StrMultiple.Replace(this.StrMultiple.lastIndexOf(":"),"")),this.StrMultiple=this.StrMultiple+" :"+this.SlNO.Text):(this.multiVisi=!1,this.Unit.SelectedValue=parseInt(this.SelectedUnits),this.StrMultiple="",this.SelectedUnits=""));for(var l=0;l<this.DataTable.length;l++)this.DataTable[l].Status=null,this.DataTable[l].DocPrefix=null,this.DataTable[l].DocNumber=null,this.DataTable[l].CostCenterID=null,this.DataTable[l].DocumentNo=null,this.DataTable[l].DocID=null,this.DataTable[l].TempCCID_Key=null,this.DataTable[l].TempCCID=null,this.DataTable[l].DocumentName=null,this.DataTable[l].Xml=null,this.DataTableColumns.Contains("Dim_Key")&&null!=this.dsPart&&this.dsPart.Columns[6].Contains("Dimname")&&this.dsPart.Tables[6].length>0&&"0"!=this.dsPart.Tables[6][0].DimNodeID.toString()&&(this.DataTable[l].Dim_Key=this.dsPart.Tables[6][0].DimNodeID.toString(),this.DataTable[l].Dim=this.dsPart.Tables[6][0].Dimname.toString());this.PayTermsDataTableObj.Clear(),this.CalculateFooter();for(var c=0;c<6;c++){var u=this.DataTableObj.NewRow();u.Recurr=!1,this.DataTableObj.addRows(u);var D=this.PayTermsDataTableObj.NewRow();this.PayTermsDataTableObj.addRows(D)}this.ButtonSaveAndPrint.Enable=this.ButtonSave.Enable=!0,i.a.SessionManager.HideUnathorizedAccess?this.ButtonSaveAndPrint.Visible=this.ButtonSave.Visible=i.a.SessionManager.IsActionAssigned(this.CurrCostCenterID,"Create"):this.ButtonSaveAndPrint.Enable=this.ButtonSave.Enable=i.a.SessionManager.IsActionAssigned(this.CurrCostCenterID,"Create"),this.ContractExists=!1,this.ButtonRenew.Enable=!1,this.ButtonTerminate.Enable=!1,this.BtnApprove.Visible=!1;var h=this.GetButton("Reject");null!=h&&(h.Visible=!1),this.ButtonSuspend.Visible=!1,this.BtnFullRefund.Visible=this.ButtonRefund.Visible=!1,this.ButtonVacant.Visible=!1}}},{key:"SetVisibilityFalse",value:function(){this.ActVisibility=!1,this.NoteVisibility=!1,this.DeleteVisibility=!1,this.AttachmentVisibility=!1,this.RefundVisiblity=!1,this.VacantVisiblity=!1,this.RejectVisiblity=!1,this.StatusVisiblity=!1,this.ReportInfoVisibility=!1,this.SuspendVisiblity=!1,this.CloseVisiblity=!1}},{key:"FillExtraFields",value:function(t){for(var e=this,a=t.ScreenObject.GetCustomField("CCNID"+(t.DimWiseFields-5e4).toString()),n=0;n<t.ScreenObject.CustomTab.Pages.length;n++)for(var i=t.ScreenObject.CustomTab.Pages[n],r=function(t){var n=i.Fields[t];if(a!=n&&n instanceof o.c&&!s.e.StringIsNullOrEmpty(n.DBColumnName))if(n.DBColumnName.toLowerCase().Contains("alpha")){for(var r=0;r<e.ScreenObject.CustomTab.Pages.length;r++)if(null!=(D=e.ScreenObject.CustomTab.Pages[r].Fields.find((function(t){return t instanceof o.c&&t.Label.toLowerCase()==n.Label.toLowerCase()})))&&null!=D){D instanceof l.b&&n instanceof l.b?n.SelectedValue=D.SelectedValue:D instanceof S.c&&n instanceof S.c?D.Date&&(n.Date=D.Date):n instanceof m.d||n instanceof m.c?D instanceof m.d||D instanceof m.c?n.Text=D.Text:D instanceof c.e?n.Text=D.SelectedValue:D instanceof j.a&&(n.Text=D.Text):(n instanceof c.e||n instanceof j.a)&&(D instanceof c.e?n.Text=D.SelectedValue:D instanceof j.a&&(n.Text=D.Text));break}}else if(n.DBColumnName.toLowerCase().Contains("ccnid")){if(null==(D=e.ScreenObject.HeaderFields.find((function(t){return t instanceof l.b&&t.DBColumnName==n.DBColumnName}))))for(var u=0;u<e.ScreenObject.CustomTab.Pages.length&&(null==(D=e.ScreenObject.CustomTab.Pages[u].Fields.find((function(t){return t instanceof l.b&&t.DBColumnName==n.DBColumnName})))||null==D);u++);null!=D&&null!=D&&D instanceof l.b&&n instanceof l.b&&(n.SelectedValue=D.SelectedValue)}},u=0;u<i.Fields.length;u++){var D;r(u)}}},{key:"Export",value:function(t){return Object(n.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=0,n=0,"Print"==t&&"428"==this.StatusID.SelectedValue&&(a=1),"SaveAndPrint"==t&&428==this.SaveAndPrintStatusID&&(a=1),"Export"==t&&"428"==this.StatusID.SelectedValue&&(a=1),"Print"!=t||!this.DoNotPrintUnApprovedContracts||"440"!=this.StatusID.SelectedValue&&"465"!=this.StatusID.SelectedValue&&!this.IsUnapproveDocument(this.ContractID)?"SaveAndPrint"!=t||!this.DoNotPrintUnApprovedContracts||440!=this.SaveAndPrintStatusID&&465!=this.SaveAndPrintStatusID&&!this.IsUnapproveDocument(this.SaveAndPrintContactID)?"Export"!=t||!this.DoNotPrintUnApprovedContracts||"440"!=this.StatusID.SelectedValue&&"465"!=this.StatusID.SelectedValue&&!this.IsUnapproveDocument(this.ContractID)?("Export"==t?n=this.ContractID:"SaveAndPrint"==t?n=this.SaveAndPrintContactID:"Print"==t&&(n=this.ContractID),V.RibbonExtViewModel.PrintMaster(this,t,this.CostCenterID,n,a)):this.DisplayMessage="Un-Approved documents not allowed to export":this.DisplayMessage="Un-Approved documents not allowed to print":this.DisplayMessage="Un-Approved Documents not allowed to print";case 2:case"end":return e.stop()}}),e,this)})))}},{key:"IsUnapproveDocument",value:function(t){var e=i.a.empService.GetQueryData(t,"IsUnapproveDocument","","","");return 1==parseInt(e.Tables[0][0].IVAR)}},{key:"TerminateContract",value:function(t,e,a,n,o){var l=this;Logger.InfoLog("AddEditRenContractViewModel ::Entering TerminateContract");this.cntrct.TerminationDate=new Date(a).ToString("dd/MMM/yyyy"),this.cntrct.UnitID=this.Unit.SelectedValue,this.cntrct.TenantID=this.Tenant.SelectedValue,this.cntrct.PropertyID=this.Property.SelectedValue,this.cntrct.ContractID=t,this.cntrct.RentRecID=this.RentRecAc.SelectedValue,this.TerminationDate=a,1!=n&&2!=n&&3!=n||(this.cntrct.TerminationPostDate=this.TermPosting?this.TerminateContracts.TerminationPostDate.Date:this.cntrct.TerminationDate);var c=i.a.rental.GetPostingDetails(this.cntrct,t,this.CurrCostCenterID,n,this.VatNode,this.InvCCID,this.cntrct.PropertyID,this.cntrct.UnitID,this.cntrct.TenantID,this.cntrct.RentRecID);if(null!=c&&c.Tables.length>0){this.ProductID=parseInt(c.Tables[0][0].PRODUCTID.toString()),this.GetCCData(c.Tables[0]),this.RefundAmt=0,null==this.dtTerm?this.dtTerm=[]:this.dtTerm.Clear(),this.SRTAmount=0,this.PDCRefund=0,this.VatAmt=0;var u=0,D=0;this.DiscReturn=0;var h=!1;s.e.IsEmpty(c.Tables[0][0].IsBillwise)||(h=Object(r.j)(c.Tables[0][0].IsBillwise.toString()));var C=this.EndDate.Date;if(this.IncomeAc.SelectedValue>0&&(this.cntrct.IncomeID=this.IncomeAc.SelectedValue),1==n)this.cntrct.StatusID=i.a.SessionManager.IsActionAssigned(this.CurrCostCenterID,"UnApproveOnTerminate")?465:428,this.cntrct.Reason=e,this.cntrct.PostPaymentXML=104==this.CurrCostCenterID?"":this.GetPaymentXML(h),this.cntrct.PostPDPaymentXML=this.GetPDPaymentXML(h,c),this.cntrct.PostPartPayXML=this.GetPartPaymentXML(h),this.cntrct.PostRentPayXML=!this.nomonthlyincome||!c.Columns[0].Contains("PostIncome")||s.e.IsEmpty(c.Tables[0][0].PostIncome)||"false"!=c.Tables[0][0].PostIncome.toString().toLowerCase()&&"0"!=c.Tables[0][0].PostIncome.toString().toLowerCase()?this.GetRentPaymentXML(c.Tables[2],!0,c.Columns[2]):this.GetRentPaymentXML(c.Tables[2],!1,c.Columns[2]);else if(2==n){var m,b={DonotUpdateAccounts:m},S=i.a.rental.GetVacancyDocumentType(this.CurrCostCenterID,"ContractVacantDocument",b);if(m=b.DonotUpdateAccounts,this.EnableGracePeriod&&this.ExpectedEndDate.Date&&(C=this.ExpectedEndDate.Date),0==S&&this.TerminateContracts.TerminationDate.Date!=C)return this.DisplayMessage="Define Vacancy Document",void(this.MessageVisibility=!0);var d=0;if(17==S?d=1:11==S&&(d=2),s.e.isValidDate(this.TerminateContracts.TerminationDate.Date)&&this.TerminateContracts.TerminationDate.Date.Date>C.Date){this.DisplayMessage="";var T={ActualRentofmnt:D};if(this.cntrct.PostRentPayXML=this.GetVacancyXml(d,c.Tables[0][0].VatAccID.toString(),C,m,T),(D=T.ActualRentofmnt)>0&&""!=this.DisplayMessage)return}else this.cntrct.PostRentPayXML=""}else 3==n&&(this.cntrct.PostRentPayXML="");if(2==n||3==n)for(var y=0;y<this.PayTermsDataTable.length;y++)null==this.PayTermsDataTable[y].DocStatusID||s.e.IsEmpty(this.PayTermsDataTable[y].DocStatusID)||"370"!=this.PayTermsDataTable[y].DocStatusID.toString()||s.e.IsEmpty(this.PayTermsDataTable[y].Amount)||(this.PDCRefund+=parseFloat(this.PayTermsDataTable[y].Amount.toString()));if(this.MessageVisibility=!1,this.cntrct.PostSalesRtnXML=!this.nomonthlyincome||!c.Columns[0].Contains("PostIncome")||s.e.IsEmpty(c.Tables[0][0].PostIncome)||"false"!=c.Tables[0][0].PostIncome.toString().toLowerCase()&&"0"!=c.Tables[0][0].PostIncome.toString().toLowerCase()?this.GetSRTXML(c.Tables[1],c.Tables[7],c.Tables[2],n,!0,c.Tables[0]):this.GetSRTXML(c.Tables[1],c.Tables[7],c.Tables[2],n,!1,c.Tables[0]),this.MessageVisibility)return;var g=this.SRTAmount+this.RefundAmt-this.PDCRefund-D;if(this.cntrct.RemaingPaymentXML=this.TerminateContracts.BankAccount.SelectedValue>0?this.GetRemaingPaymentXML(h):"",this.cntrct.WONO=this.strContractNo,!o){var I=new O(this,this.SRTAmount,this.RefundAmt,this.PDCRefund,g,D,this.VatAmt,n,C,c);i.a.page.ShowDialog(I,w.a,{ShowCenter:!0,NoWidth:!0,Title:I.DisplayName}).subscribe((function(){I.result&&(l.DisplayMessage="",l.cntrct.PenaltyXml=l.GetPenaltyXML(I.DtExpensesObj.Table,c.Tables[0][0].VatAccID.toString(),c.Tables[0][0].PenAccID),""==l.cntrct.PenaltyXml&&""!=l.DisplayMessage||(l.cntrct.PenaltyParticulars=l.GetPenaltyParticulars(I.DtExpensesObj.Table,c.Tables[0][0].PenAccID),I.BalanceAmt>0?(l.VatAmt>0&&(I.BalanceAmt+=l.VatAmt),l.cntrct.RemaingPaymentXML=l.cntrct.RemaingPaymentXML.replace("##Balance##",I.BalanceAmt.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount).replace(",",""))):l.cntrct.RemaingPaymentXML="",u=I.Totpen,g=I.BalanceAmt,l.cntrct.GUID="GUID",l.cntrct.Wid=l.ScreenObject.CheckWorkFlow_1(1==n?7:9),o||1!=n&&2!=n&&3!=n||l.RenewSubContracts(n,t),1==n?i.a.rental.TerminateContract(l.cntrct,l.CurrCostCenterID,l.SRTAmount,l.RefundAmt,l.PDCRefund,u,g,l.TerminateContracts.BankAccount.SelectedValue,l.TerminateContracts.ChequeNo.Text,l.TerminateContracts.ChequeDate.Date,l.TerminateContracts.Remarks.Text).subscribe((function(t){l.DisplayMessage=t.Message,t.RetValue>0&&(l.ClearData(),l.RefershPage(),Logger.InfoLog("AddEditRenContractViewModel :: Exiting OnSaveContract")),l.MessageVisibility=!0,Logger.InfoLog("AddEditRenContractViewModel :: Entering OnSaveContract ")}),(function(t){alert(JSON.stringify(t)),console.log("SaveContract : "+JSON.stringify(t))})):i.a.rental.VacanctContract(l.cntrct,n,l.SRTAmount,l.RefundAmt,l.PDCRefund,u,g,l.TerminateContracts.BankAccount.SelectedValue,l.TerminateContracts.ChequeNo.Text,l.TerminateContracts.ChequeDate.Date,l.TerminateContracts.Remarks.Text,D).subscribe((function(t){l.DisplayMessage=t.Message,t.RetValue>0&&(l.ClearData(),l.RefershPage(),Logger.InfoLog("AddEditRenContractViewModel :: Exiting OnSaveContract")),l.MessageVisibility=!0,Logger.InfoLog("AddEditRenContractViewModel :: Entering OnSaveContract ")}),(function(t){alert(JSON.stringify(t)),console.log("SaveContract : "+JSON.stringify(t))}))))}))}}}},{key:"BuildPayTermsGridData",value:function(){return Object(n.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,a,n,o,l,h,C,m,b,S=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Logger.InfoLog("AddEditRenContractViewModel ::Entering BuildPayTermsGridData"),this.ContractPayTerms=[],a=null,n=[],this.DocumentsGrid=new u.a,this.DocumentsGrid.Width="",this.DocumentsGrid.Columns=[],this.PayTermsDataTableObj.CanUserAddRows=!0,this.PayTermsDataTableObj.CanUserDeleteRows=!0,this.PayTermsDataTableObj.Clear(),this.PayTermsDataTableObj.ContextMenu.Items=[],(o=new D.b).Header="Copy",o.Tag="Copy",o.Click.Subscribe(this,"CmenuItem_Click"),this.PayTermsDataTableObj.ContextMenu.Items.push(o),(o=new D.b).Header="Paste",o.Tag="Paste",o.Click.Subscribe(this,"CmenuItem_Click"),this.PayTermsDataTableObj.ContextMenu.Items.push(o),(e=new D.a).Header="SNO",e.DisplayMember="SNO",e.DataType="TextBlock",e.ReadOnly=!0,e.Width=50,e.IsVisible=!0,n.push(e),this.InclPostingDate&&((e=new D.a).Header="PostingDate",e.DisplayMember="PostingDate",e.ValueMember="PostingDate_Key",e.DataType="DATE",e.Width=100,e.ReadOnly=!1,n.push(e)),(e=new D.a).Header="Cheque No",e.DisplayMember="ChequeNo",e.DataType="TextBlock",(a=this.ScreenObject.Data.Tables[0].filter(95==this.CurrCostCenterID||104==this.CurrCostCenterID?function(t){return"REN_ContractPayTerms"==t.SysTableName&&"ChequeNO"==t.SysColumnName}:function(t){return"REN_QuotationPayTerms"==t.SysTableName&&"ChequeNO"==t.SysColumnName})).length>0&&(e.Header=s.e.StringIsNullOrEmpty(a[0].ResourceData.toString())?a[0].UserColumnName.toString():a[0].ResourceData.toString(),e.Width=s.e.StringIsNullOrEmpty(""!=a[0].UIWidth)?parseInt(a[0].UIWidth):150,e.IsVisible=""==a[0].IsVisible.toString()||Object(r.j)(a[0].IsVisible),e.ID=a[0].CostCenterColID.toString(),e.DisplayIndex=s.e.StringIsNullOrEmpty(a[0].SectionSeqNumber.toString())?-1:parseInt(a[0].SectionSeqNumber)),e.ReadOnly=!1,n.push(e),(e=new D.a).Header="Date",e.DisplayMember="CntrlDate",e.ValueMember="CntrlDate_Key",e.DataType="DATE",e.ReadOnly=!1,(a=this.ScreenObject.Data.Tables[0].filter(95==this.CurrCostCenterID||104==this.CurrCostCenterID?function(t){return"REN_ContractPayTerms"==t.SysTableName&&"ChequeDate"==t.SysColumnName}:function(t){return"REN_QuotationPayTerms"==t.SysTableName&&"ChequeDate"==t.SysColumnName})).length>0&&(e.Header=s.e.StringIsNullOrEmpty(a[0].ResourceData.toString())?a[0].UserColumnName.toString():a[0].ResourceData.toString(),e.Width=s.e.StringIsNullOrEmpty(""!=a[0].UIWidth)?parseInt(a[0].UIWidth):150,e.IsVisible=!!s.e.IsEmpty(a[0].IsVisible)||Object(r.j)(a[0].IsVisible),e.ID=a[0].CostCenterColID.toString(),e.DisplayIndex=s.e.StringIsNullOrEmpty(a[0].SectionSeqNumber.toString())?-1:parseInt(a[0].SectionSeqNumber)),n.push(e),(e=new D.a).ComboData=this.ScreenObject.Data.Tables[8],e.DisplayMember="PayNodeID",e.ValueMember="PayeeBank",e.ValueBinding="PayeeBank",e.DataType="ComboBox",e.Header="Payee Bank",(a=this.ScreenObject.Data.Tables[0].filter(95==this.CurrCostCenterID||104==this.CurrCostCenterID?function(t){return"REN_ContractPayTerms"==t.SysTableName&&"PayeeBank"==t.SysColumnName}:function(t){return"REN_QuotationPayTerms"==t.SysTableName&&"PayeeBank"==t.SysColumnName})).length>0&&(e.Header=s.e.StringIsNullOrEmpty(a[0].ResourceData.toString())?a[0].UserColumnName.toString():a[0].ResourceData.toString(),e.Width=s.e.StringIsNullOrEmpty(""!=a[0].UIWidth)?parseInt(a[0].UIWidth):150,e.IsVisible=!!s.e.IsEmpty(a[0].IsVisible)||Object(r.j)(a[0].IsVisible),e.ID=a[0].CostCenterColID.toString(),e.DisplayIndex=s.e.StringIsNullOrEmpty(a[0].SectionSeqNumber.toString())?-1:parseInt(a[0].SectionSeqNumber)),n.push(e),(e=new D.a).Header=104==this.CurrCostCenterID?"Credit A/c":"Debit A/c",e.DisplayMember="DebitAccountID",e.DataType="LISTBOX",e.CostCenterID=2,e.TypeID=100,(a=this.ScreenObject.Data.Tables[0].filter(95==this.CurrCostCenterID||104==this.CurrCostCenterID?function(t){return"REN_ContractPayTerms"==t.SysTableName&&"DebitAccID"==t.SysColumnName}:function(t){return"REN_QuotationPayTerms"==t.SysTableName&&"DebitAccID"==t.SysColumnName})).length>0&&(e.TypeID=s.e.StringIsNullOrEmpty(a[0].ColumnCCListViewTypeID)?100:parseFloat(a[0].ColumnCCListViewTypeID),e.Header=s.e.StringIsNullOrEmpty(a[0].ResourceData)?a[0].UserColumnName.toString():a[0].ResourceData.toString(),e.Width=s.e.StringIsNullOrEmpty(""!=a[0].UIWidth)?parseInt(a[0].UIWidth):150,e.IsVisible=!!s.e.IsEmpty(a[0].IsVisible)||Object(r.j)(a[0].IsVisible),e.ID=a[0].CostCenterColID.toString(),e.DisplayIndex=s.e.StringIsNullOrEmpty(a[0].SectionSeqNumber)?-1:parseInt(a[0].SectionSeqNumber)),n.push(e),(e=new D.a).Header="Amount",e.DisplayMember="Amount",e.DataType="FLOAT",e.ShowTotal=!0,e.IsCalculated=1,(a=this.ScreenObject.Data.Tables[0].filter(95==this.CurrCostCenterID||104==this.CurrCostCenterID?function(t){return"REN_ContractPayTerms"==t.SysTableName&&"Amount"==t.SysColumnName}:function(t){return"REN_QuotationPayTerms"==t.SysTableName&&"Amount"==t.SysColumnName})).length>0&&(e.Header=s.e.StringIsNullOrEmpty(a[0].ResourceData.toString())?a[0].UserColumnName.toString():a[0].ResourceData.toString(),e.Width=s.e.StringIsNullOrEmpty(""!=a[0].UIWidth)?parseInt(a[0].UIWidth):150,e.IsVisible=!!s.e.IsEmpty(a[0].IsVisible)||Object(r.j)(a[0].IsVisible),e.ID=a[0].CostCenterColID.toString(),e.DisplayIndex=s.e.StringIsNullOrEmpty(a[0].SectionSeqNumber.toString())?-1:parseInt(a[0].SectionSeqNumber)),e.DecimalPoints=i.a.SessionManager.Preferences.DecimalsinAmount.toString(),n.push(e),(e=new D.a).Header="RentAmount",e.DisplayMember="RentAmount",e.DataType="FLOAT",(a=this.ScreenObject.Data.Tables[0].filter(95==this.CurrCostCenterID||104==this.CurrCostCenterID?function(t){return"REN_ContractPayTerms"==t.SysTableName&&"RentAmount"==t.SysColumnName}:function(t){return"REN_QuotationPayTerms"==t.SysTableName&&"RentAmount"==t.SysColumnName})).length>0?(e.Header=s.e.StringIsNullOrEmpty(a[0].ResourceData.toString())?a[0].UserColumnName.toString():a[0].ResourceData.toString(),e.Width=s.e.StringIsNullOrEmpty(""!=a[0].UIWidth)?parseInt(a[0].UIWidth):150,e.IsVisible=!!s.e.IsEmpty(a[0].IsVisible)||Object(r.j)(a[0].IsVisible),e.ID=a[0].CostCenterColID.toString(),e.DisplayIndex=s.e.StringIsNullOrEmpty(a[0].SectionSeqNumber.toString())?-1:parseInt(a[0].SectionSeqNumber)):e.IsVisible=!1,e.DecimalPoints=i.a.SessionManager.Preferences.DecimalsinAmount.toString(),n.push(e),(e=new D.a).Header="Narration",e.DisplayMember="Narration",e.DataType="TextBlock",(a=this.ScreenObject.Data.Tables[0].filter(95==this.CurrCostCenterID||104==this.CurrCostCenterID?function(t){return"REN_ContractPayTerms"==t.SysTableName&&"Narration"==t.SysColumnName}:function(t){return"REN_QuotationPayTerms"==t.SysTableName&&"Narration"==t.SysColumnName})).length>0&&(e.Header=s.e.StringIsNullOrEmpty(a[0].ResourceData.toString())?a[0].UserColumnName.toString():a[0].ResourceData.toString(),e.Width=s.e.StringIsNullOrEmpty(""!=a[0].UIWidth)?parseInt(a[0].UIWidth):150,e.IsVisible=!!s.e.IsEmpty(a[0].IsVisible)||Object(r.j)(a[0].IsVisible),e.ID=a[0].CostCenterColID.toString(),e.DisplayIndex=s.e.StringIsNullOrEmpty(a[0].SectionSeqNumber.toString())?-1:parseInt(a[0].SectionSeqNumber)),n.push(e),(e=new D.a).Header="Period",e.ValueBinding="Period",e.DataType="ComboBox",e.DisplayMember="Name",e.ValueMember="Value",e.Width=100,null!=(l=J.a.GetLookupData(31))){for(h=[],C=0;C<l.length;C++)h.push(c.d.ComboBoxItems_2(l[C].Name.toString(),l[C].NodeID.toString()));e.ComboData=h}if((a=this.ScreenObject.Data.Tables[0].filter(95==this.CurrCostCenterID||104==this.CurrCostCenterID?function(t){return"REN_ContractPayTerms"==t.SysTableName&&"Period"==t.SysColumnName}:function(t){return"REN_QuotationPayTerms"==t.SysTableName&&"Period"==t.SysColumnName})).length>0&&(e.Header=s.e.StringIsNullOrEmpty(a[0].ResourceData.toString())?a[0].UserColumnName.toString():a[0].ResourceData.toString(),e.Width=s.e.StringIsNullOrEmpty(""!=a[0].UIWidth)?parseInt(a[0].UIWidth):100,e.IsVisible=!!s.e.IsEmpty(a[0].IsVisible)||Object(r.j)(a[0].IsVisible),e.ID=a[0].CostCenterColID.toString(),e.DisplayIndex=s.e.StringIsNullOrEmpty(a[0].SectionSeqNumber.toString())?-1:parseInt(a[0].SectionSeqNumber)),n.push(e),(e=new D.a).Header="Status",e.DisplayMember="Status",e.DataType="TextBlock",(a=this.ScreenObject.Data.Tables[0].filter(95==this.CurrCostCenterID||104==this.CurrCostCenterID?function(t){return"REN_ContractPayTerms"==t.SysTableName&&"StatusID"==t.SysColumnName}:function(t){return"REN_QuotationPayTerms"==t.SysTableName&&"StatusID"==t.SysColumnName})).length>0&&(e.Header=s.e.StringIsNullOrEmpty(a[0].ResourceData.toString())?a[0].UserColumnName.toString():a[0].ResourceData.toString(),e.Width=s.e.StringIsNullOrEmpty(""!=a[0].UIWidth)?parseInt(a[0].UIWidth):150,e.IsVisible=!!s.e.IsEmpty(a[0].IsVisible)||Object(r.j)(a[0].IsVisible),e.ID=a[0].CostCenterColID.toString(),e.DisplayIndex=s.e.StringIsNullOrEmpty(a[0].SectionSeqNumber.toString())?-1:parseInt(a[0].SectionSeqNumber)),e.ReadOnly=!0,n.push(e),(e=new D.a).Click.Subscribe(this,"OnMouseClick"),e.Header="Document No",e.DisplayMember="DocumentNo",e.DataType="LINK",(a=this.ScreenObject.Data.Tables[0].filter(95==this.CurrCostCenterID||104==this.CurrCostCenterID?function(t){return"REN_ContractPayTerms"==t.SysTableName&&"DocID"==t.SysColumnName}:function(t){return"REN_QuotationPayTerms"==t.SysTableName&&"DocID"==t.SysColumnName})).length>0&&(e.Header=s.e.StringIsNullOrEmpty(a[0].ResourceData.toString())?a[0].UserColumnName.toString():a[0].ResourceData.toString(),e.Width=s.e.StringIsNullOrEmpty(""!=a[0].UIWidth)?parseInt(a[0].UIWidth):150,e.IsVisible=""==a[0].IsVisible.toString()||Object(r.j)(a[0].IsVisible),e.ID=a[0].CostCenterColID.toString(),e.DisplayIndex=s.e.StringIsNullOrEmpty(a[0].SectionSeqNumber.toString())?-1:parseInt(a[0].SectionSeqNumber)),n.push(e),(e=new D.a).Header="TillDate",e.DisplayMember="TillDate",e.ValueMember="TillDate_Key",e.DataType="DATE",e.ReadOnly=!1,(a=this.ScreenObject.Data.Tables[0].filter(95==this.CurrCostCenterID||104==this.CurrCostCenterID?function(t){return"REN_ContractPayTerms"==t.SysTableName&&"TillDate"==t.SysColumnName}:function(t){return"REN_QuotationPayTerms"==t.SysTableName&&"TillDate"==t.SysColumnName})).length>0?(e.Header=s.e.StringIsNullOrEmpty(a[0].ResourceData.toString())?a[0].UserColumnName.toString():a[0].ResourceData.toString(),e.Width=s.e.StringIsNullOrEmpty(""!=a[0].UIWidth)?parseInt(a[0].UIWidth):150,e.IsVisible=""==a[0].IsVisible.toString()||Object(r.j)(a[0].IsVisible),e.ID=a[0].CostCenterColID.toString(),e.DisplayIndex=s.e.StringIsNullOrEmpty(a[0].SectionSeqNumber.toString())?-1:parseInt(a[0].SectionSeqNumber)):e.IsVisible=!1,n.push(e),(e=new D.a).Click.Subscribe(this,"OnMouseClick"),e.Header="Particular",e.DisplayMember="Particulars",e.ValueMember="Particulars_Key",e.DataType="LISTBOX",e.CostCenterID=parseInt(i.a.SessionManager.Preferences.DepositLinkDimension),e.TypeID=1,(a=this.ScreenObject.Data.Tables[0].filter(95==this.CurrCostCenterID?function(t){return"REN_ContractPayTerms"==t.SysTableName&&"Particular"==t.SysColumnName}:function(t){return"REN_QuotationPayTerms"==t.SysTableName&&"Particular"==t.SysColumnName})).length>0?(e.Header=s.e.StringIsNullOrEmpty(a[0].ResourceData.toString())?a[0].UserColumnName.toString():a[0].ResourceData.toString(),e.Width=""!=a[0].UIWidth?parseInt(a[0].UIWidth):150,e.IsVisible=""==a[0].IsVisible.toString()||Object(r.j)(a[0].IsVisible),e.ID=a[0].CostCenterColID.toString(),e.DisplayIndex=s.e.StringIsNullOrEmpty(a[0].SectionSeqNumber.toString())?-1:parseInt(a[0].SectionSeqNumber)):e.IsVisible=!1,n.push(e),95!=this.CurrCostCenterID&&104!=this.CurrCostCenterID||((e=new D.a).Header="Temporary Status",e.DisplayMember="TempCCID",e.DataType="LISTBOX",e.CostCenterID=this.TempCCID,e.TypeID=1,(a=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_ContractPayTerms"==t.SysTableName&&"TemporaryStatus"==t.SysColumnName}))).length>0&&(e.Header=s.e.StringIsNullOrEmpty(a[0].ResourceData.toString())?a[0].UserColumnName.toString():a[0].ResourceData.toString(),e.Width=s.e.StringIsNullOrEmpty(""!=a[0].UIWidth)?parseInt(a[0].UIWidth):150,e.IsVisible=""==a[0].IsVisible.toString()||Object(r.j)(a[0].IsVisible),e.ID=a[0].CostCenterColID.toString(),e.DisplayIndex=s.e.StringIsNullOrEmpty(a[0].SectionSeqNumber.toString())?-1:parseInt(a[0].SectionSeqNumber)),n.push(e)),(a=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_ContractPayTerms"==t.SysTableName&&"LocationID"==t.SysColumnName}))).length>0&&""!=a[0].IsVisible.toString()&&Object(r.j)(a[0].IsVisible)&&((e=new D.a).Header=a[0].ResourceData.toString(),e.DisplayMember="Location",e.ValueMember="Location_Key",e.Mandatory=""!=a[0].IsMandatory.toString()&&Object(r.j)(a[0].IsMandatory),e.DataType="LISTBOX",e.CostCenterID=this.LocationContract.CCID,e.TypeID=this.LocationContract.TypeID,e.Header=s.e.StringIsNullOrEmpty(a[0].ResourceData.toString())?a[0].UserColumnName.toString():a[0].ResourceData.toString(),e.Width=s.e.StringIsNullOrEmpty(""!=a[0].UIWidth)?parseInt(a[0].UIWidth):150,e.ID=a[0].CostCenterColID.toString(),e.DisplayIndex=s.e.StringIsNullOrEmpty(a[0].SectionSeqNumber.toString())?-1:parseInt(a[0].SectionSeqNumber),n.push(e),this.PayTermsDataTableColumns.push("Location"),this.PayTermsDataTableColumns.push("Location_Key")),this.DimCCID>5e4&&(a=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_ContractPayTerms"==t.SysTableName&&t.SysColumnName.startsWith(t.ColumnCostCenterID==S.DimCCID)})),(e=new D.a).DisplayMember="Dim",e.ValueMember="Dim_Key",e.DataType="LISTBOX",e.CostCenterID=this.DimCCID,a.length>0?(e.TypeID=parseInt(a[0].ColumnCCListViewTypeID.toString()),e.Mandatory=""!=a[0].IsMandatory.toString()&&Object(r.j)(a[0].IsMandatory),e.Header=a[0].ResourceData.toString(),e.Width=""!=a[0].UIWidth.toString()?parseInt(a[0].UIWidth):150,e.ID=a[0].CostCenterColID.toString(),e.DisplayIndex=s.e.IsEmpty(a[0].SectionSeqNumber.toString())?-1:parseInt(a[0].SectionSeqNumber)):(m=i.a.rental.GetCCName(this.DimCCID),e.TypeID=1,e.Header=m.Message,e.Width=150,e.ID="0",e.DisplayIndex=n.length),n.push(e),this.PayTermsDataTableColumns.push("Dim"),this.PayTermsDataTableColumns.push("Dim_Key")),this.LineWiseSalesman&&(a=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_ContractPayTerms"==t.SysTableName&&t.SysColumnName.startsWith("ccnid")&&t.ColumnCostCenterID==S.Salesman.CCID})),(e=new D.a).DisplayMember="SalesMan",e.ValueMember="SalesMan_Key",e.DataType="LISTBOX",e.CostCenterID=this.Salesman.CCID,a.length>0?(e.TypeID=parseInt(a[0].ColumnCCListViewTypeID.toString()),e.Header=a[0].ResourceData.toString(),e.Width=""!=a[0].UIWidth.toString()?parseInt(a[0].UIWidth):150,e.ID=a[0].CostCenterColID.toString(),e.DisplayIndex=s.e.IsEmpty(a[0].SectionSeqNumber.toString())?-1:parseInt(a[0].SectionSeqNumber),e.Mandatory=""!=a[0].IsMandatory.toString()&&Object(r.j)(a[0].IsMandatory)):(e.TypeID=this.Salesman.TypeID,e.Header=this.Salesman.Label,e.Width=120,e.ID="0",e.DisplayIndex=n.length),n.push(e),this.PayTermsDataTableColumns.push("SalesMan"),this.PayTermsDataTableColumns.push("SalesMan_Key")),(a=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_ContractPayTerms"==t.SysTableName&&t.SysColumnName.startsWith("ccnid")}))).length>0)for(b=0;b<a.length;b++)this.DimCCID!=parseInt(a[b].ColumnCostCenterID.toString())&&((e=new D.a).DisplayMember=a[b].SysColumnName.toString(),e.ValueMember=a[b].SysColumnName.toString()+"_Key",e.DataType="LISTBOX",e.Mandatory=""!=a[b].IsMandatory.toString()&&Object(r.j)(a[b].IsMandatory),e.CostCenterID=parseInt(a[b].ColumnCostCenterID.toString()),e.TypeID=parseInt(a[b].ColumnCCListViewTypeID.toString()),e.Header=a[b].ResourceData.toString(),e.Width=""!=a[b].UIWidth.toString()?parseInt(a[b].UIWidth):150,e.ID=a[b].CostCenterColID.toString(),e.DisplayIndex=s.e.IsEmpty(a[b].SectionSeqNumber.toString())?-1:parseInt(a[b].SectionSeqNumber),e.IsVisible=""==a[b].IsVisible.toString()||Object(r.j)(a[b].IsVisible),n.push(e),this.PayTermsDataTableColumns.push(e.DisplayMember),this.PayTermsDataTableColumns.push(e.ValueMember));this.PayTermsDataTableObj.Clear(),n.sort((function(t,e){return t.DisplayIndex-e.DisplayIndex})).forEach((function(t){S.ContractPayTerms.push(t)})),this.PayTermsDataTableObj.OnLinkClick.Subscribe(this,"OnLinkClickEvent"),this.PayTermsDataTableObj.Columns=this.ContractPayTerms,this.PayTermsDataTableColumns.push("SNO"),this.PayTermsDataTableColumns.push("ChequeNo"),this.PayTermsDataTableColumns.push("CntrlDate"),this.PayTermsDataTableColumns.push("CntrlDate_Key"),this.PayTermsDataTableColumns.push("PostingDate"),this.PayTermsDataTableColumns.push("PostingDate_Key"),this.PayTermsDataTableColumns.push("TillDate"),this.PayTermsDataTableColumns.push("TillDate_Key"),this.PayTermsDataTableColumns.push("PayNodeID"),this.PayTermsDataTableColumns.push("PayeeBank"),this.PayTermsDataTableColumns.push("Narration"),this.PayTermsDataTableColumns.push("DebitAccountID_Key"),this.PayTermsDataTableColumns.push("DebitAccountID"),this.PayTermsDataTableColumns.push("Amount"),this.PayTermsDataTableObj.DataTypes.Double.push("Amount"),this.PayTermsDataTableColumns.push("RentAmount"),this.PayTermsDataTableObj.DataTypes.Double.push("RentAmount"),this.PayTermsDataTableColumns.push("Status"),this.PayTermsDataTableColumns.push("DocumentNo"),this.PayTermsDataTableColumns.push("Period"),this.PayTermsDataTableColumns.push("CostCenterID"),this.PayTermsDataTableColumns.push("DocumentName"),this.PayTermsDataTableColumns.push("DocPrefix"),this.PayTermsDataTableColumns.push("DocNumber"),this.PayTermsDataTableColumns.push("TempCCID_Key"),this.PayTermsDataTableObj.DataTypes.Int.push("TempCCID_Key"),this.PayTermsDataTableColumns.push("TempCCID"),this.PayTermsDataTableColumns.push("Particulars_Key"),this.PayTermsDataTableObj.DataTypes.Int.push("Particulars_Key"),this.PayTermsDataTableColumns.push("Particulars"),this.PayTermsDataTableColumns.push("DocID"),this.PayTermsDataTableColumns.push("DocStatusID"),this.PayTermsDataTableColumns.push("DocumentType"),this.PayTermsDataTableColumns.push("IsFromRes"),this.PayTermsDataTableColumns.push("OpPdcStatus"),Logger.InfoLog("AddEditRenContractViewModel ::Exiting BuildPayTermsGridData");case 10:case"end":return t.stop()}}),t,this)})))}},{key:"OnLinkClickEvent",value:function(t,e,a){try{V.RibbonExtViewModel.LoadDocument(t)}catch(n){Logger.ErrorLog("UnAppDocumentsViewModel","OnLinkClickEvent",n.Message)}}},{key:"BuildGridData",value:function(){var t,e=this,a=[];Logger.InfoLog("AddEditRenContractViewModel ::Entering BuildGridData");var n=null;if(this.DocumentContGrid=new u.a,this.DocumentContGrid.Width="",this.DocumentContGrid.Columns=[],this.DataTableObj.Clear(),this.DataTableObj.CanUserAddRows=!0,this.DataTableObj.CanUserDeleteRows=!0,(t=new D.a).Header="SNO",t.DisplayMember="SNO",t.DataType="TextBlock",t.ReadOnly=!0,t.Width=50,t.IsVisible=!0,a.push(t),(t=new D.a).ComboData=this.ScreenObject.Data.Tables[10],t.DisplayMember="Particulars",t.ValueMember="NodeID",t.ValueBinding="NodeID",t.DataType="ComboBox",t.Header="Particulars",(n=this.ScreenObject.Data.Tables[0].filter(95==this.CurrCostCenterID||104==this.CurrCostCenterID?function(t){return"REN_ContractParticulars"==t.SysTableName&&"CCNodeID"==t.SysColumnName}:function(t){return"REN_QuotationParticulars"==t.SysTableName&&"CCNodeID"==t.SysColumnName})).length>0&&(t.Header=s.e.StringIsNullOrEmpty(n[0].ResourceData.toString())?n[0].UserColumnName.toString():n[0].ResourceData.toString(),t.Width=s.e.StringIsNullOrEmpty(""!=n[0].UIWidth)?parseInt(n[0].UIWidth):150,t.IsVisible=""==n[0].IsVisible.toString()||Object(r.j)(n[0].IsVisible),t.ID=n[0].CostCenterColID.toString(),t.Mandatory=!0,t.DisplayIndex=s.e.StringIsNullOrEmpty(n[0].SectionSeqNumber.toString())?-1:parseInt(n[0].SectionSeqNumber)),t.ReadOnly=!this.EnableParticular,a.push(t),(t=new D.a).Header=104==this.CurrCostCenterID?"Debit A/c":"Credit A/c",t.DisplayMember="CreditAccountID",t.ValueMember="CreditAccountID_Key",t.DataType="LISTBOX",t.ReadOnly=!this.EnableParticular,t.CostCenterID=2,t.TypeID=100,(n=this.ScreenObject.Data.Tables[0].filter(95==this.CurrCostCenterID||104==this.CurrCostCenterID?function(t){return"REN_ContractParticulars"==t.SysTableName&&"CreditAccID"==t.SysColumnName}:function(t){return"REN_QuotationParticulars"==t.SysTableName&&"CreditAccID"==t.SysColumnName})).length>0&&(t.Header=s.e.StringIsNullOrEmpty(n[0].ResourceData.toString())?n[0].UserColumnName.toString():n[0].ResourceData.toString(),t.Width=s.e.StringIsNullOrEmpty(""!=n[0].UIWidth)?parseInt(n[0].UIWidth):150,t.IsVisible=""==n[0].IsVisible.toString()||Object(r.j)(n[0].IsVisible),t.ID=n[0].CostCenterColID.toString(),t.DisplayIndex=s.e.StringIsNullOrEmpty(n[0].SectionSeqNumber.toString())?-1:parseInt(n[0].SectionSeqNumber),""!=n[0].ColumnCCListViewTypeID.toString()&&parseInt(n[0].ColumnCCListViewTypeID.toString())>0&&(t.TypeID=parseInt(n[0].ColumnCCListViewTypeID.toString()))),a.push(t),(t=new D.a).Header=104==this.CurrCostCenterID?"Credit A/c":"Debit A/c",t.DisplayMember="DebitAccountID",t.ValueMember="DebitAccountID_Key",t.DataType="LISTBOX",t.CostCenterID=2,t.TypeID=15,(n=this.ScreenObject.Data.Tables[0].filter(95==this.CurrCostCenterID||104==this.CurrCostCenterID?function(t){return"REN_ContractParticulars"==t.SysTableName&&"DebitAccID"==t.SysColumnName}:function(t){return"REN_QuotationParticulars"==t.SysTableName&&"DebitAccID"==t.SysColumnName})).length>0&&(t.Header=s.e.StringIsNullOrEmpty(n[0].ResourceData.toString())?n[0].UserColumnName.toString():n[0].ResourceData.toString(),t.Width=""!=n[0].UIWidth?parseInt(n[0].UIWidth):150,t.IsVisible=!!s.e.StringIsNullOrEmpty(""!=n[0].IsVisible.toString())&&Object(r.j)(n[0].IsVisible),t.ID=n[0].CostCenterColID.toString(),t.DisplayIndex=s.e.StringIsNullOrEmpty(n[0].SectionSeqNumber.toString())?-1:parseInt(n[0].SectionSeqNumber),""!=n[0].ColumnCCListViewTypeID.toString()&&parseInt(n[0].ColumnCCListViewTypeID.toString())>0&&(t.TypeID=parseInt(n[0].ColumnCCListViewTypeID.toString()))),a.push(t),(t=new D.a).Header="Cheque No",t.DisplayMember="ChequeNo",t.DataType="TextBlock",(n=this.ScreenObject.Data.Tables[0].filter(95==this.CurrCostCenterID||104==this.CurrCostCenterID?function(t){return"REN_ContractParticulars"==t.SysTableName&&"ChequeNO"==t.SysColumnName}:function(t){return"REN_QuotationParticulars"==t.SysTableName&&"ChequeNO"==t.SysColumnName})).length>0&&(t.Header=s.e.StringIsNullOrEmpty(n[0].ResourceData.toString())?n[0].UserColumnName.toString():n[0].ResourceData.toString(),t.Width=s.e.StringIsNullOrEmpty(""!=n[0].UIWidth)?parseInt(n[0].UIWidth):150,t.IsVisible=""==n[0].IsVisible.toString()||Object(r.j)(n[0].IsVisible),t.ID=n[0].CostCenterColID.toString(),t.DisplayIndex=s.e.StringIsNullOrEmpty(n[0].SectionSeqNumber.toString())?-1:parseInt(n[0].SectionSeqNumber)),t.ReadOnly=!this.EnableParticular,a.push(t),(t=new D.a).Header="Date",t.DisplayMember="CntrlDate",t.ValueMember="CntrlDate_Key",t.DataType="DATE",t.ReadOnly=!1,(n=this.ScreenObject.Data.Tables[0].filter(95==this.CurrCostCenterID||104==this.CurrCostCenterID?function(t){return"REN_ContractParticulars"==t.SysTableName&&"ChequeDate"==t.SysColumnName}:function(t){return"REN_QuotationParticulars"==t.SysTableName&&"ChequeDate"==t.SysColumnName})).length>0&&(t.Header=s.e.StringIsNullOrEmpty(n[0].ResourceData.toString())?n[0].UserColumnName.toString():n[0].ResourceData.toString(),t.Width=s.e.StringIsNullOrEmpty(""!=n[0].UIWidth)?parseInt(n[0].UIWidth):150,t.IsVisible=""==n[0].IsVisible.toString()||Object(r.j)(n[0].IsVisible),t.ID=n[0].CostCenterColID.toString(),t.DisplayIndex=s.e.StringIsNullOrEmpty(n[0].SectionSeqNumber.toString())?-1:parseInt(n[0].SectionSeqNumber)),t.ReadOnly=!this.EnableParticular,a.push(t),(t=new D.a).ComboData=this.ScreenObject.Data.Tables[8],t.DisplayMember="PayNodeID",t.ValueMember="PayeeBank",t.ValueBinding="PayeeBank",t.DataType="ComboBox",t.Header="PayeeBank",(n=this.ScreenObject.Data.Tables[0].filter(95==this.CurrCostCenterID||104==this.CurrCostCenterID?function(t){return"REN_ContractParticulars"==t.SysTableName&&"PayeeBank"==t.SysColumnName}:function(t){return"REN_QuotationParticulars"==t.SysTableName&&"PayeeBank"==t.SysColumnName})).length>0&&(t.Header=s.e.StringIsNullOrEmpty(n[0].ResourceData.toString())?n[0].UserColumnName.toString():n[0].ResourceData.toString(),t.Width=s.e.StringIsNullOrEmpty(""!=n[0].UIWidth)?parseInt(n[0].UIWidth):150,t.IsVisible=""==n[0].IsVisible.toString()||Object(r.j)(n[0].IsVisible),t.ID=n[0].CostCenterColID.toString(),t.DisplayIndex=s.e.StringIsNullOrEmpty(n[0].SectionSeqNumber.toString())?-1:parseInt(n[0].SectionSeqNumber)),t.ReadOnly=!this.EnableParticular,a.push(t),(t=new D.a).Header="Sq.ft",t.DisplayMember="Sqft",t.DataType="FLOAT",(n=this.ScreenObject.Data.Tables[0].filter(95==this.CurrCostCenterID||104==this.CurrCostCenterID?function(t){return"REN_ContractParticulars"==t.SysTableName&&"Sqft"==t.SysColumnName}:function(t){return"REN_QuotationParticulars"==t.SysTableName&&"Sqft"==t.SysColumnName})).length>0&&(t.Header=s.e.StringIsNullOrEmpty(n[0].ResourceData.toString())?n[0].UserColumnName.toString():n[0].ResourceData.toString(),t.Width=s.e.StringIsNullOrEmpty(""!=n[0].UIWidth)?parseInt(n[0].UIWidth):100,t.IsVisible=""==n[0].IsVisible.toString()||Object(r.j)(n[0].IsVisible),t.ID=n[0].CostCenterColID.toString(),t.DisplayIndex=s.e.StringIsNullOrEmpty(n[0].SectionSeqNumber.toString())?-1:parseInt(n[0].SectionSeqNumber)),t.ReadOnly=!this.EnableParticular,t.DecimalPoints=i.a.SessionManager.Preferences.DecimalsinAmount.toString(),a.push(t),(t=new D.a).Header="Rate",t.DisplayMember="Rate",t.DataType="FLOAT",(n=this.ScreenObject.Data.Tables[0].filter(95==this.CurrCostCenterID||104==this.CurrCostCenterID?function(t){return"REN_ContractParticulars"==t.SysTableName&&"Rate"==t.SysColumnName}:function(t){return"REN_QuotationParticulars"==t.SysTableName&&"Rate"==t.SysColumnName})).length>0&&(t.Header=s.e.StringIsNullOrEmpty(n[0].ResourceData.toString())?n[0].UserColumnName.toString():n[0].ResourceData.toString(),t.Width=s.e.StringIsNullOrEmpty(""!=n[0].UIWidth)?parseInt(n[0].UIWidth):100,t.IsVisible=""==n[0].IsVisible.toString()||Object(r.j)(n[0].IsVisible),t.ID=n[0].CostCenterColID.toString(),t.DisplayIndex=s.e.StringIsNullOrEmpty(n[0].SectionSeqNumber.toString())?-1:parseInt(n[0].SectionSeqNumber)),t.ReadOnly=!this.EnableParticular,t.DecimalPoints=i.a.SessionManager.Preferences.DecimalsinAmount.toString(),a.push(t),(t=new D.a).Header="Rent Amount",t.DisplayMember="ActAmount",t.DataType="FLOAT",(n=this.ScreenObject.Data.Tables[0].filter(95==this.CurrCostCenterID||104==this.CurrCostCenterID?function(t){return"REN_ContractParticulars"==t.SysTableName&&"RentAmount"==t.SysColumnName}:function(t){return"REN_QuotationParticulars"==t.SysTableName&&"RentAmount"==t.SysColumnName})).length>0&&(t.Header=s.e.StringIsNullOrEmpty(n[0].ResourceData.toString())?n[0].UserColumnName.toString():n[0].ResourceData.toString(),t.Width=s.e.StringIsNullOrEmpty(""!=n[0].UIWidth)?parseInt(n[0].UIWidth):150,t.IsVisible=""==n[0].IsVisible.toString()||Object(r.j)(n[0].IsVisible),t.ID=n[0].CostCenterColID.toString(),t.DisplayIndex=s.e.StringIsNullOrEmpty(n[0].SectionSeqNumber.toString())?-1:parseInt(n[0].SectionSeqNumber)),t.ReadOnly=!this.EnableParticular,t.IsCalculated=1,t.DecimalPoints=i.a.SessionManager.Preferences.DecimalsinAmount.toString(),a.push(t),(t=new D.a).Header="Discount Amount",t.DisplayMember="Discount",t.DataType="FLOAT",(n=this.ScreenObject.Data.Tables[0].filter(95==this.CurrCostCenterID||104==this.CurrCostCenterID?function(t){return"REN_ContractParticulars"==t.SysTableName&&"Discount"==t.SysColumnName}:function(t){return"REN_QuotationParticulars"==t.SysTableName&&"Discount"==t.SysColumnName})).length>0&&(t.Header=s.e.StringIsNullOrEmpty(n[0].ResourceData.toString())?n[0].UserColumnName.toString():n[0].ResourceData.toString(),t.Width=s.e.StringIsNullOrEmpty(""!=n[0].UIWidth)?parseInt(n[0].UIWidth):150,t.IsVisible=""==n[0].IsVisible.toString()||Object(r.j)(n[0].IsVisible),t.ID=n[0].CostCenterColID.toString(),t.DisplayIndex=s.e.StringIsNullOrEmpty(n[0].SectionSeqNumber.toString())?-1:parseInt(n[0].SectionSeqNumber)),t.ReadOnly=!this.EnableParticular,t.DecimalPoints=i.a.SessionManager.Preferences.DecimalsinAmount.toString(),a.push(t),(t=new D.a).Header="After Discount Amount",t.DisplayMember="Amount",t.DataType="FLOAT",t.ShowTotal=!0,t.IsCalculated=1,(n=this.ScreenObject.Data.Tables[0].filter(95==this.CurrCostCenterID||104==this.CurrCostCenterID?function(t){return"REN_ContractParticulars"==t.SysTableName&&"Amount"==t.SysColumnName}:function(t){return"REN_QuotationParticulars"==t.SysTableName&&"Amount"==t.SysColumnName})).length>0&&(t.Header=s.e.StringIsNullOrEmpty(n[0].ResourceData.toString())?n[0].UserColumnName.toString():n[0].ResourceData.toString(),t.Width=s.e.StringIsNullOrEmpty(""!=n[0].UIWidth)?parseInt(n[0].UIWidth):150,t.IsVisible=""==n[0].IsVisible.toString()||Object(r.j)(n[0].IsVisible),t.ID=n[0].CostCenterColID.toString(),t.DisplayIndex=s.e.StringIsNullOrEmpty(n[0].SectionSeqNumber.toString())?-1:parseInt(n[0].SectionSeqNumber)),t.ReadOnly=!this.EnableParticular,t.DecimalPoints=i.a.SessionManager.Preferences.DecimalsinAmount.toString(),a.push(t),i.a.SessionManager.Preferences.ContainsKey("VATVersion")){(t=new D.a).Header="Vat %",t.DisplayMember="VatPer",t.DataType="FLOAT",(n=this.ScreenObject.Data.Tables[0].filter(95==this.CurrCostCenterID||104==this.CurrCostCenterID?function(t){return"REN_ContractParticulars"==t.SysTableName&&"VATPer"==t.SysColumnName}:function(t){return"REN_QuotationParticulars"==t.SysTableName&&"VATPer"==t.SysColumnName})).length>0&&(t.Header=s.e.StringIsNullOrEmpty(n[0].ResourceData.toString())?n[0].UserColumnName.toString():n[0].ResourceData.toString(),t.Width=s.e.StringIsNullOrEmpty(""!=n[0].UIWidth)?parseInt(n[0].UIWidth):60,t.IsVisible=""==n[0].IsVisible.toString()||Object(r.j)(n[0].IsVisible),t.Header=n[0].ResourceData.toString(),t.ID=n[0].CostCenterColID.toString(),t.DisplayIndex=s.e.StringIsNullOrEmpty(n[0].SectionSeqNumber.toString())?-1:parseInt(n[0].SectionSeqNumber)),95==this.CurrCostCenterID&&(t.ReadOnly=!i.a.SessionManager.IsActionAssigned(this.CurrCostCenterID,"EnableVat")),t.DecimalPoints=i.a.SessionManager.Preferences.DecimalsinAmount.toString(),a.push(t),(t=new D.a).Header="Vat Amount",t.DisplayMember="VatAmount",t.DataType="FLOAT",(n=this.ScreenObject.Data.Tables[0].filter(95==this.CurrCostCenterID||104==this.CurrCostCenterID?function(t){return"REN_ContractParticulars"==t.SysTableName&&"VATAmount"==t.SysColumnName}:function(t){return"REN_QuotationParticulars"==t.SysTableName&&"VATAmount"==t.SysColumnName})).length>0&&(t.Header=s.e.StringIsNullOrEmpty(n[0].ResourceData.toString())?n[0].UserColumnName.toString():n[0].ResourceData.toString(),t.Width=s.e.StringIsNullOrEmpty(""!=n[0].UIWidth)?parseInt(n[0].UIWidth):100,t.IsVisible=""==n[0].IsVisible.toString()||Object(r.j)(n[0].IsVisible),t.Header=n[0].ResourceData.toString(),t.ID=n[0].CostCenterColID.toString(),t.DisplayIndex=s.e.StringIsNullOrEmpty(n[0].SectionSeqNumber.toString())?-1:parseInt(n[0].SectionSeqNumber)),t.ReadOnly=!0,t.ShowTotal=!0,t.IsCalculated=1,t.DecimalPoints=i.a.SessionManager.Preferences.DecimalsinAmount.toString(),a.push(t),(t=new D.a).Header="Taxable Amount",t.DisplayMember="TaxableAmt",t.DataType="FLOAT",(n=this.ScreenObject.Data.Tables[0].filter(95==this.CurrCostCenterID||104==this.CurrCostCenterID?function(t){return"REN_ContractParticulars"==t.SysTableName&&"TaxableAmt"==t.SysColumnName}:function(t){return"REN_QuotationParticulars"==t.SysTableName&&"TaxableAmt"==t.SysColumnName})).length>0&&(t.Header=s.e.StringIsNullOrEmpty(n[0].ResourceData.toString())?n[0].UserColumnName.toString():n[0].ResourceData.toString(),t.Width=s.e.StringIsNullOrEmpty(""!=n[0].UIWidth)?parseInt(n[0].UIWidth):100,t.IsVisible=""==n[0].IsVisible.toString()||Object(r.j)(n[0].IsVisible),t.Header=n[0].ResourceData.toString(),t.ID=n[0].CostCenterColID.toString(),t.DisplayIndex=s.e.StringIsNullOrEmpty(n[0].SectionSeqNumber.toString())?-1:parseInt(n[0].SectionSeqNumber)),t.ReadOnly=!0,t.ShowTotal=!0,t.IsCalculated=1,t.DecimalPoints=i.a.SessionManager.Preferences.DecimalsinAmount.toString(),a.push(t),(t=new D.a).CostCenterID=50060,t.TypeID=1,t.DisplayMember="TaxCategory",t.ValueMember="TaxCategory_Key",t.Header="TaxCategory",t.DataType="LISTBOX",(n=this.ScreenObject.Data.Tables[0].filter(95==this.CurrCostCenterID||104==this.CurrCostCenterID?function(t){return"REN_ContractParticulars"==t.SysTableName&&"TaxCategory"==t.SysColumnName}:function(t){return"REN_QuotationParticulars"==t.SysTableName&&"TaxCategory"==t.SysColumnName})).length>0&&(t.Header=s.e.StringIsNullOrEmpty(n[0].ResourceData.toString())?n[0].UserColumnName.toString():n[0].ResourceData.toString(),t.Width=s.e.StringIsNullOrEmpty(""!=n[0].UIWidth)?parseInt(n[0].UIWidth):120,t.IsVisible=""==n[0].IsVisible.toString()||Object(r.j)(n[0].IsVisible),t.Header=n[0].ResourceData.toString(),t.ID=n[0].CostCenterColID.toString(),t.DisplayIndex=s.e.StringIsNullOrEmpty(n[0].SectionSeqNumber.toString())?-1:parseInt(n[0].SectionSeqNumber),""!=n[0].ColumnCCListViewTypeID.toString()&&parseInt(n[0].ColumnCCListViewTypeID.toString())>0&&(t.TypeID=parseInt(n[0].ColumnCCListViewTypeID.toString()))),a.push(t),(t=new D.a).CostCenterID=50061,t.TypeID=1,t.DisplayMember="SPType",t.ValueMember="SPType_Key",t.Header="SPType",t.DataType="LISTBOX",(n=this.ScreenObject.Data.Tables[0].filter(95==this.CurrCostCenterID||104==this.CurrCostCenterID?function(t){return"REN_ContractParticulars"==t.SysTableName&&"SPType"==t.SysColumnName}:function(t){return"REN_QuotationParticulars"==t.SysTableName&&"SPType"==t.SysColumnName})).length>0?(t.Header=s.e.StringIsNullOrEmpty(n[0].ResourceData.toString())?n[0].UserColumnName.toString():n[0].ResourceData.toString(),t.Width=s.e.StringIsNullOrEmpty(""!=n[0].UIWidth)?parseInt(n[0].UIWidth):120,t.IsVisible=""==n[0].IsVisible.toString()||Object(r.j)(n[0].IsVisible),t.Header=n[0].ResourceData.toString(),t.ID=n[0].CostCenterColID.toString(),t.DisplayIndex=s.e.StringIsNullOrEmpty(n[0].SectionSeqNumber.toString())?-1:parseInt(n[0].SectionSeqNumber),""!=n[0].ColumnCCListViewTypeID.toString()&&parseInt(n[0].ColumnCCListViewTypeID.toString())>0&&(t.TypeID=parseInt(n[0].ColumnCCListViewTypeID.toString()))):t.IsVisible=!1,a.push(t),t.IsVisible&&(this.DataTableColumns.push("SPType"),this.DataTableColumns.push("SPType_Key")),(t=new D.a).Header="Vat Type",t.ValueBinding="VatType",t.DataType="ComboBox",t.DisplayMember="Name",t.ValueMember="Value";var o=[];o.push(c.d.ComboBoxItems_2("Exclusive","Exclusive")),o.push(c.d.ComboBoxItems_2("Inclusive","Inclusive")),t.ComboData=o,t.IsVisible=!0,(n=this.ScreenObject.Data.Tables[0].filter(95==this.CurrCostCenterID||104==this.CurrCostCenterID?function(t){return"REN_ContractParticulars"==t.SysTableName&&"VatType"==t.SysColumnName}:function(t){return"REN_QuotationParticulars"==t.SysTableName&&"VatType"==t.SysColumnName})).length>0&&(t.Header=s.e.StringIsNullOrEmpty(n[0].ResourceData.toString())?n[0].UserColumnName.toString():n[0].ResourceData.toString(),t.Width=s.e.StringIsNullOrEmpty(""!=n[0].UIWidth)?parseInt(n[0].UIWidth):100,t.IsVisible=""==n[0].IsVisible.toString()||Object(r.j)(n[0].IsVisible),t.Header=n[0].ResourceData.toString(),t.ID=n[0].CostCenterColID.toString(),t.DisplayIndex=s.e.StringIsNullOrEmpty(n[0].SectionSeqNumber.toString())?-1:parseInt(n[0].SectionSeqNumber)),a.push(t)}(t=new D.a).Header="Narration",t.DisplayMember="Narration",t.DataType="TextBlock",(n=this.ScreenObject.Data.Tables[0].filter(95==this.CurrCostCenterID||104==this.CurrCostCenterID?function(t){return"REN_ContractParticulars"==t.SysTableName&&"Narration"==t.SysColumnName}:function(t){return"REN_QuotationParticulars"==t.SysTableName&&"Narration"==t.SysColumnName})).length>0?(t.Header=s.e.StringIsNullOrEmpty(n[0].ResourceData.toString())?n[0].UserColumnName.toString():n[0].ResourceData.toString(),t.Width=s.e.StringIsNullOrEmpty(""!=n[0].UIWidth)?parseInt(n[0].UIWidth):150,t.IsVisible=""==n[0].IsVisible.toString()||Object(r.j)(n[0].IsVisible),t.ID=n[0].CostCenterColID.toString(),t.DisplayIndex=s.e.StringIsNullOrEmpty(n[0].SectionSeqNumber.toString())?-1:parseInt(n[0].SectionSeqNumber)):t.Width=150,a.push(t),95==this.CurrCostCenterID&&((t=new D.a).Header="Tasjeel Amount",t.DisplayMember="TasjeelAmount",t.DataType="FLOAT",(n=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_ContractParticulars"==t.SysTableName&&"TasjeelAmount"==t.SysColumnName}))).length>0&&(t.Header=s.e.StringIsNullOrEmpty(n[0].ResourceData.toString())?n[0].UserColumnName.toString():n[0].ResourceData.toString(),t.Width=s.e.StringIsNullOrEmpty(""!=n[0].UIWidth)?parseInt(n[0].UIWidth):150,t.IsVisible=""==n[0].IsVisible.toString()||Object(r.j)(n[0].IsVisible),t.ID=n[0].CostCenterColID.toString(),t.DisplayIndex=s.e.StringIsNullOrEmpty(n[0].SectionSeqNumber.toString())?-1:parseInt(n[0].SectionSeqNumber)),t.ReadOnly=!this.EnableParticular,t.DecimalPoints=i.a.SessionManager.Preferences.DecimalsinAmount.toString(),a.push(t)),(t=new D.a).Header="Generate Cheque",t.ValueBinding="InclChkGen",t.DataType="ComboBox",t.DisplayMember="Name",t.ValueMember="Value",t.Width=120;var l=[];l.push(c.d.ComboBoxItems_2("Yes","1")),l.push(c.d.ComboBoxItems_2("No","0")),l.push(c.d.ComboBoxItems_2("Incl Vat","2")),t.ComboData=l,(n=this.ScreenObject.Data.Tables[0].filter(95==this.CurrCostCenterID||104==this.CurrCostCenterID?function(t){return"REN_ContractParticulars"==t.SysTableName&&"InclChequeGen"==t.SysColumnName}:function(t){return"REN_QuotationParticulars"==t.SysTableName&&"InclChequeGen"==t.SysColumnName})).length>0&&(t.Header=s.e.StringIsNullOrEmpty(n[0].ResourceData.toString())?n[0].UserColumnName.toString():n[0].ResourceData.toString(),t.Width=s.e.StringIsNullOrEmpty(""!=n[0].UIWidth)?parseInt(n[0].UIWidth):120,t.IsVisible=""==n[0].IsVisible.toString()||Object(r.j)(n[0].IsVisible),t.ID=n[0].CostCenterColID.toString(),t.DisplayIndex=s.e.StringIsNullOrEmpty(n[0].SectionSeqNumber.toString())?-1:parseInt(n[0].SectionSeqNumber)),a.push(t),(t=new D.a).Header="Recur",t.ValueBinding="RecurInvoice",t.DataType="ComboBox",t.DisplayMember="Name",t.ValueMember="Value",t.Width=120;var h=[];if(h.push(c.d.ComboBoxItems_2("Yes","true")),h.push(c.d.ComboBoxItems_2("No","false")),t.ComboData=h,(n=this.ScreenObject.Data.Tables[0].filter(95==this.CurrCostCenterID||104==this.CurrCostCenterID?function(t){return"REN_ContractParticulars"==t.SysTableName&&"Recur"==t.SysColumnName}:function(t){return"REN_QuotationParticulars"==t.SysTableName&&"Recur"==t.SysColumnName})).length>0&&(t.Header=s.e.StringIsNullOrEmpty(n[0].ResourceData.toString())?n[0].UserColumnName.toString():n[0].ResourceData.toString(),t.Width=s.e.StringIsNullOrEmpty(""!=n[0].UIWidth)?parseInt(n[0].UIWidth):120,t.IsVisible=""==n[0].IsVisible.toString()||Object(r.j)(n[0].IsVisible),t.ID=n[0].CostCenterColID.toString(),t.DisplayIndex=s.e.StringIsNullOrEmpty(n[0].SectionSeqNumber.toString())?-1:parseInt(n[0].SectionSeqNumber)),this.DistribtueInvoice||(t.IsVisible=!1),a.push(t),95!=this.CurrCostCenterID&&104!=this.CurrCostCenterID||((t=new D.a).Header="Status",t.DisplayMember="Status",t.DataType="TextBlock",(n=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_ContractParticulars"==t.SysTableName&&"Status"==t.SysColumnName}))).length>0&&(t.Width=s.e.StringIsNullOrEmpty(""!=n[0].UIWidth)?parseInt(n[0].UIWidth):150,t.IsVisible=""==n[0].IsVisible.toString()||Object(r.j)(n[0].IsVisible),t.ID=n[0].CostCenterColID.toString(),t.DisplayIndex=s.e.StringIsNullOrEmpty(n[0].SectionSeqNumber.toString())?-1:parseInt(n[0].SectionSeqNumber)),t.ReadOnly=!0,a.push(t),(t=new D.a).Click.Subscribe(this,"OnMouseClickContract"),t.Header="Document No",t.DisplayMember="DocumentNo",t.DataType="LINK",(n=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_ContractParticulars"==t.SysTableName&&"DocumentNo"==t.SysColumnName}))).length>0&&(t.Header=s.e.StringIsNullOrEmpty(n[0].ResourceData.toString())?n[0].UserColumnName.toString():n[0].ResourceData.toString(),t.Width=s.e.StringIsNullOrEmpty(""!=n[0].UIWidth)?parseInt(n[0].UIWidth):150,t.IsVisible=""==n[0].IsVisible.toString()||Object(r.j)(n[0].IsVisible),t.ID=n[0].CostCenterColID.toString(),t.DisplayIndex=s.e.StringIsNullOrEmpty(n[0].SectionSeqNumber.toString())?-1:parseInt(n[0].SectionSeqNumber)),a.push(t),(t=new D.a).Header="Temporary Status",t.DisplayMember="TempCCID",t.DataType="LISTBOX",t.CostCenterID=this.TempCCID,t.TypeID=1,(n=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_ContractParticulars"==t.SysTableName&&"TemporaryStatus"==t.SysColumnName}))).length>0&&(t.Header=s.e.StringIsNullOrEmpty(n[0].ResourceData.toString())?n[0].UserColumnName.toString():n[0].ResourceData.toString(),t.Width=s.e.StringIsNullOrEmpty(""!=n[0].UIWidth)?parseInt(n[0].UIWidth):150,t.IsVisible=""==n[0].IsVisible.toString()||Object(r.j)(n[0].IsVisible),t.ID=n[0].CostCenterColID.toString(),t.DisplayIndex=s.e.StringIsNullOrEmpty(n[0].SectionSeqNumber.toString())?-1:parseInt(n[0].SectionSeqNumber),""!=n[0].ColumnCCListViewTypeID.toString()&&parseInt(n[0].ColumnCCListViewTypeID.toString())>0&&(t.TypeID=parseInt(n[0].ColumnCCListViewTypeID.toString()))),t.ReadOnly=!this.EnableParticular,a.push(t)),(n=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_ContractParticulars"==t.SysTableName&&"LocationID"==t.SysColumnName}))).length>0&&""!=n[0].IsVisible.toString()&&Object(r.j)(n[0].IsVisible)&&((t=new D.a).Header="Location",t.DisplayMember="Location",t.ValueMember="Location_Key",t.DataType="LISTBOX",t.CostCenterID=this.LocationContract.CCID,t.TypeID=this.LocationContract.TypeID,t.Header=s.e.StringIsNullOrEmpty(n[0].ResourceData.toString())?n[0].UserColumnName.toString():n[0].ResourceData.toString(),t.Width=s.e.StringIsNullOrEmpty(""!=n[0].UIWidth)?parseInt(n[0].UIWidth):150,t.ID=n[0].CostCenterColID.toString(),t.DisplayIndex=s.e.StringIsNullOrEmpty(n[0].SectionSeqNumber.toString())?-1:parseInt(n[0].SectionSeqNumber),a.push(t),this.DataTableColumns.push("Location"),this.DataTableColumns.push("Location_Key")),this.DimCCID>5e4){if(n=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_ContractParticulars"==t.SysTableName&&t.SysColumnName.startsWith("ccnid")&&t.ColumnCostCenterID==e.DimCCID})),(t=new D.a).DisplayMember="Dim",t.ValueMember="Dim_Key",t.DataType="LISTBOX",t.CostCenterID=this.DimCCID,n.length>0)t.TypeID=parseInt(n[0].ColumnCCListViewTypeID.toString()),t.Mandatory=""!=n[0].IsMandatory.toString()&&Object(r.j)(n[0].IsMandatory),t.Header=n[0].ResourceData.toString(),t.Width=""!=n[0].UIWidth.toString()?parseInt(n[0].UIWidth):150,t.ID=n[0].CostCenterColID.toString(),t.DisplayIndex=s.e.IsEmpty(n[0].SectionSeqNumber.toString())?-1:parseInt(n[0].SectionSeqNumber);else{var C=i.a.rental.GetCCName(this.DimCCID);t.TypeID=1,t.Header=C.Message,t.Width=150,t.ID="0",t.DisplayIndex=a.length}a.push(t),this.DataTableColumns.push("Dim"),this.DataTableColumns.push("Dim_Key")}if(this.LineWiseSalesman&&(n=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_ContractParticulars"==t.SysTableName&&t.SysColumnName.startsWith("ccnid")&&t.ColumnCostCenterID==e.Salesman.CCID})),(t=new D.a).DisplayMember="SalesMan",t.ValueMember="SalesMan_Key",t.DataType="LISTBOX",t.CostCenterID=this.Salesman.CCID,n.length>0?(t.TypeID=parseInt(n[0].ColumnCCListViewTypeID.toString()),t.Mandatory=""!=n[0].IsMandatory.toString()&&Object(r.j)(n[0].IsMandatory),t.Header=n[0].ResourceData.toString(),t.Width=""!=n[0].UIWidth.toString()?parseInt(n[0].UIWidth):150,t.ID=n[0].CostCenterColID.toString(),t.DisplayIndex=s.e.IsEmpty(n[0].SectionSeqNumber.toString())?-1:parseInt(n[0].SectionSeqNumber)):(t.TypeID=this.Salesman.TypeID,t.Header=this.Salesman.Label,t.Width=120,t.ID="0",t.DisplayIndex=a.length),a.push(t),this.DataTableColumns.push("SalesMan"),this.DataTableColumns.push("SalesMan_Key")),(n=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_ContractParticulars"==t.SysTableName&&t.SysColumnName.toLowerCase().startsWith("ccnid")}))).length>0)for(var m=0;m<n.length;m++)this.DimCCID==parseInt(n[m].ColumnCostCenterID.toString())||this.LineWiseSalesman&&this.Salesman.CCID==parseInt(n[m].ColumnCostCenterID.toString())||((t=new D.a).DisplayMember=n[m].SysColumnName.toString(),t.ValueMember=n[m].SysColumnName.toString()+"_Key",t.DataType="LISTBOX",t.CostCenterID=parseInt(n[m].ColumnCostCenterID.toString()),t.TypeID=parseInt(n[m].ColumnCCListViewTypeID.toString()),t.Header=n[m].ResourceData.toString(),t.Width=""!=n[m].UIWidth.toString()?parseInt(n[m].UIWidth):150,t.Mandatory=""!=n[m].IsMandatory.toString()&&Object(r.j)(n[m].IsMandatory),t.ID=n[m].CostCenterColID.toString(),t.DisplayIndex=s.e.IsEmpty(n[m].SectionSeqNumber.toString())?-1:parseInt(n[m].SectionSeqNumber),t.IsVisible=""==n[m].IsVisible.toString()||Object(r.j)(n[m].IsVisible),a.push(t),this.DataTableColumns.push(t.DisplayMember),this.DataTableColumns.push(t.ValueMember));this.ContractParticular=[],a.sort((function(t,e){return t.DisplayIndex-e.DisplayIndex})).forEach((function(t){e.ContractParticular.push(t)})),this.DataTableObj.Columns=this.ContractParticular,this.DataTableObj.OnLinkClick.Subscribe(this,"OnLinkClickEvent"),this.DataTableColumns.push("SNO"),this.DataTableColumns.push("Recurr"),this.DataTableColumns.push("Particulars"),this.DataTableColumns.push("NodeID"),this.DataTableColumns.push("Xml"),this.DataTableColumns.push("CreditAccountID"),this.DataTableColumns.push("CreditAccountID_Key"),this.DataTableColumns.push("AdvanceAcc"),this.DataTableColumns.push("ChequeNo"),this.DataTableColumns.push("CntrlDate"),this.DataTableColumns.push("CntrlDate_Key"),this.DataTableObj.DataTypes.Date.push("CntrlDate_Key"),this.DataTableColumns.push("PayeeBank"),this.DataTableColumns.push("PayNodeID"),this.DataTableColumns.push("DebitAccountID"),this.DataTableColumns.push("DebitAccountID_Key"),this.DataTableObj.DataTypes.Int.push("DebitAccountID_Key"),this.DataTableColumns.push("Amount"),this.DataTableObj.DataTypes.Double.push("Amount"),this.DataTableColumns.push("ActAmount"),this.DataTableObj.DataTypes.Double.push("ActAmount"),this.DataTableColumns.push("TasjeelAmount"),this.DataTableColumns.push("Discount"),this.DataTableColumns.push("DiscountPercentage"),this.DataTableColumns.push("Months"),this.DataTableColumns.push("Refund"),this.DataTableColumns.push("Narration"),this.DataTableColumns.push("Status"),this.DataTableColumns.push("DocumentNo"),this.DataTableColumns.push("CostCenterID"),this.DataTableColumns.push("DocumentName"),this.DataTableColumns.push("DocPrefix"),this.DataTableColumns.push("DocNumber"),this.DataTableColumns.push("TempCCID_Key"),this.DataTableColumns.push("TempCCID"),this.DataTableColumns.push("DocID"),this.DataTableColumns.push("VatPer"),this.DataTableObj.DataTypes.Double.push("VatPer"),this.DataTableColumns.push("VatAmount"),this.DataTableObj.DataTypes.Double.push("VatAmount"),this.DataTableColumns.push("TaxableAmt"),this.DataTableObj.DataTypes.Double.push("TaxableAmt"),this.DataTableColumns.push("InclChkGen"),this.DataTableColumns.push("VatType"),this.DataTableColumns.push("RecurInvoice"),this.DataTableColumns.push("PostDebit"),this.DataTableColumns.push("TaxCategory"),this.DataTableColumns.push("TaxCategory_Key"),this.DataTableColumns.push("Display"),this.DataTableObj.DataTypes.Int.push("Display"),this.DataTableColumns.push("StyleHeightZero"),this.DataTableColumns.push("BankAccountID"),this.DataTableColumns.push("Sqft"),this.DataTableColumns.push("Rate"),Logger.InfoLog("AddEditRenContractViewModel ::Exiting BuildGridData")}},{key:"onAddRow",value:function(t,e){this.UpdateSequence(),s.e.IsEmpty(e)||(e.Row.SNO=this.SNO,e.Row.Recurr=!1)}},{key:"onDeleteRow",value:function(t,e){this.UpdateSequence()}},{key:"OnLoad",value:function(t){if(Logger.InfoLog("AddEditRenContractViewModel ::Entering OnLoad"),null!=this.ScreenObject.Data&&this.ScreenObject.Data.Tables.length>3&&this.ScreenObject.Data.Tables[3].length>0){for(var e=0;e<this.ScreenObject.Data.Tables[3].length;e++)this.StatusID.Items.push(c.d.ComboBoxItems_2(this.ScreenObject.Data.Tables[3][e].ActualStatus.toString(),this.ScreenObject.Data.Tables[3][e].StatusID.toString()));95==this.CurrCostCenterID||104==this.CurrCostCenterID||103==this.CurrCostCenterID?this.StatusID.SelectedValue="426":129==this.CurrCostCenterID&&(this.StatusID.SelectedValue="467")}if(null!=this.ScreenObject.Data&&this.ScreenObject.Data.Tables.length>0&&this.ScreenObject.Data.Tables[0].length>0){var a,n=(_toArray(a=this.ScreenObject.Data.Tables[0].filter((function(t){return"REN_Contract"==t.SysTableName&&"BasedOn"==t.SysColumnName}))),a);if(n.length>0){for(var i,s=(_toArray(i=n[0].UserProbableValues.toString().Trim().split(";")),i),o=0;o<s.length;o++)this.BasedOn.Items.push(c.d.ComboBoxItems_2(s[o].replace("''","'"),s[o].replace("''","'")));this.BasedOn.SelectedValue=n[0].UserDefaultValue.toString()}}if(this.IsExtended.Items.push(c.d.ComboBoxItems_2("NO","false")),this.IsExtended.Items.push(c.d.ComboBoxItems_2("YES","True")),this.IsExtended.Visible?(this.IsExtended.Enable=!0,this.IsExtended.Visible=!1):this.IsExtended.Enable=!1,null!=this.ScreenObject.Data&&this.ScreenObject.Data.Tables.length>5&&this.ScreenObject.Data.Tables[5].length>0){var l,u=(_toArray(l=this.ScreenObject.Data.Tables[5].filter((function(t){return"ContractLocation"==t.Name}))),l);u.length>0&&(this.LocationContract.Visible=""==u[0].Value.toString()||"0"!=u[0].Value.toString()&&"1"!=u[0].Value.toString()?Object(r.j)(u[0].Value):Object(r.j)(parseInt(u[0].Value))),(u=this.ScreenObject.Data.Tables[5].filter((function(t){return"ContractDivision"==t.Name}))).length>0&&(this.DivisionContract.Visible=""==u[0].Value.toString()||"0"!=u[0].Value.toString()&&"1"!=u[0].Value.toString()?Object(r.j)(u[0].Value):Object(r.j)(parseInt(u[0].Value))),(u=this.ScreenObject.Data.Tables[5].filter((function(t){return"ContractCurrency"==t.Name}))).length>0&&(this.CurrencyContract.Visible=""==u[0].Value.toString()||"0"!=u[0].Value.toString()&&"1"!=u[0].Value.toString()?Object(r.j)(u[0].Value):Object(r.j)(parseInt(u[0].Value))),(u=this.ScreenObject.Data.Tables[5].filter((function(t){return"DimensionWiseContract"==t.Name}))).length>0&&""!=u[0].Value.toString()&&parseInt(u[0].Value.toString())>5e4&&(this.DimCCID=parseInt(u[0].Value.toString())),u=this.ScreenObject.Data.Tables[5].filter((function(t){return"DefaultDiminPayterms"==t.Name})),this.DimCCID>0&&u.length>0&&""!=u[0].Value.toString()&&(this.DefaultDiminPayterms=parseInt(u[0].Value.toString())),(u=this.ScreenObject.Data.Tables[5].filter((function(t){return"DimensionWiseFields"==t.Name}))).length>0&&""!=u[0].Value.toString()&&104!=this.CostCenterID&&parseInt(u[0].Value.toString())>5e4&&(this.DimWiseFields=parseInt(u[0].Value.toString()))}if(null!=this.ScreenObject.Data&&this.ScreenObject.Data.Tables.length>12&&this.ScreenObject.Data.Tables[12].length>0)for(var D=0;D<this.ScreenObject.Data.Tables[12].length;D++)this.ContractNumber.ComboBox.Items.push(c.d.ComboBoxItems_2(this.ScreenObject.Data.Tables[12][D].Code.toString(),this.ScreenObject.Data.Tables[12][D].NodeID.toString()));if(null!=this.ScreenObject.Data&&this.ScreenObject.Data.Tables.length>6&&this.ScreenObject.Data.Tables[6].length>0&&this.ScreenObject.Data.Columns[6].Contains("NormalUnit")&&""!=this.ScreenObject.Data.Tables[6][0].NormalUnit.toString()&&(this.UnitStatusVal=this.ScreenObject.Data.Tables[6][0].NormalUnit.toString()),this.AddUnitWhere(2),null!=this.ScreenObject.Data&&this.ScreenObject.Data.Tables.length>9&&this.ScreenObject.Data.Columns[9].Contains("ACCOUNTTYPEID")){for(var h,C=(_toArray(h=this.ScreenObject.Data.Tables[9].filter((function(t){return 1==t.ACCOUNTTYPEID}))),h),m=0;m<C.length;m++)this.CashAccounts.push(C[m].ACCOUNTID.toString(),C[m].ACCOUNTID.toString());C=this.ScreenObject.Data.Tables[9].filter((function(t){return 1!=t.ACCOUNTTYPEID}));for(var b=0;b<C.length;b++)this.BankAccounts.push(C[b].ACCOUNTID.toString(),C[b].ACCOUNTID.toString())}if(null!=this.ScreenObject.Data&&this.ScreenObject.Data.Tables.length>5&&this.ScreenObject.Data.Tables[5].length>0){var S=this.ScreenObject.Data.Tables[5].filter((function(t){return 92==t.CostCenterID}));S.length>0&&""!=S[0].Value.toString()&&(this.PropertyCCID=parseInt(S[0].Value.toString())),(S=this.ScreenObject.Data.Tables[5].filter((function(t){return 93==t.CostCenterID}))).length>0&&""!=S[0].Value.toString()&&(this.UnitCCID=parseInt(S[0].Value.toString())),(S=this.ScreenObject.Data.Tables[5].filter((function(t){return 94==t.CostCenterID}))).length>0&&""!=S[0].Value.toString()&&(this.TenantCCID=parseInt(S[0].Value.toString()))}Logger.InfoLog("AddEditRenContractViewModel ::Exiting OnLoad")}},{key:"onAddRowPay",value:function(t,e){this.UpdateSequencePay(),s.e.IsEmpty(e)||(e.Row.SNO=this.PSNO)}},{key:"onDeleteRowPay",value:function(t,e){this.UpdateSequencePay()}},{key:"UpdateSequence",value:function(){var t=this;this.SNO=1,this.DataTable.forEach((function(e){"0"!=s.e.StringValue(e.Display)&&(e.SNO=t.SNO++),t.DataTableObj.updateRow(e)}))}},{key:"UpdateSequencePay",value:function(){var t=this;this.PSNO=1,this.PayTermsDataTable.forEach((function(e){e.SNO=t.PSNO++}))}},{key:"GenerateXMLs",value:function(){var t=this;Logger.InfoLog("AddEditRenContractViewModel ::Entering GenerateXMLs"),this.strContractNo=this.ContractNumber.ComboBox.GetselectedItem().Name+"~"+this.ContractNumber.TextBox.Text.Trim();var e=this.cntrct.GetProductID("CONTRACT");return null!=e&&e.Tables.length>0&&e.Tables[0].length>0&&(this.ProductID=parseInt(e.Tables[0][0][0])),0==this.ProductID&&(this.objProduct.ProductCode="CONTRACT",this.objProduct.ProductName="CONTRACT",this.objProduct.AliasName="CONTRACT",this.objProduct.ProductType=1,this.objProduct.ProductStatus=31,this.objProduct.Valuation=1,this.objProduct.LotWise=!1,this.objProduct.UOM=1,this.objProduct.SalesAccount=3,this.objProduct.PurchaseAccount=2,this.objProduct.COGSAccount=4,this.objProduct.ClosingStockAccount=5,this.objProduct.PurchaseRates=0,this.objProduct.SellingRates=0,this.objProduct.ReorderLevel=0,this.objProduct.ReorderQty=0,this.objProduct.ShelfLife=0,this.objProduct.Packing="",this.objProduct.Barcode="",this.objProduct.Category=0,this.objProduct.Department=0,this.objProduct.Description="",this.objProduct.ProductGroup=1,this.objProduct.CustomFieldsQuery="",this.objProduct.CustomCostCenterFieldsQuery="",this.objProduct.ContactsXML="",this.objProduct.NotesXML="",this.objProduct.AttachmetsXML="",this.objProduct.GUID="GUID",this.objProduct.AddProduct("","AddProduct").subscribe((function(e){t.DisplayMessage=e.Message,t.ProductID=e.RetValue}))),Logger.InfoLog("AddEditRenContractViewModel ::Exiting GenerateXMLs"),this.ProductID>0}},{key:"GetContractDetailsXML",value:function(){Logger.InfoLog("AddEditRenContractViewModel ::Entering GetContractDetailsXML");var t="";try{var e=0;t+='<ContractXML UpdateQuery="';for(var a=0;a<this.ContractParticular.length;a++)this.ContractParticular[a].DisplayMember.startsWith("CCNID")&&this.DataTableColumns.Contains(this.ContractParticular[a].ValueMember)&&(t+=this.ContractParticular[a].DisplayMember+"=X.value('@"+this.ContractParticular[a].DisplayMember+"','BIGINT'), ");t+='" ><Rows>';for(var n=0;n<this.DataTable.length;n++)if(!s.e.IsEmpty(this.DataTable[n].NodeID)){e++,t+='<Row  CCID="',i.a.SessionManager.Preferences.ContainsKey("DepositLinkDimension")&&""!=i.a.SessionManager.Preferences.DepositLinkDimension?t+=i.a.SessionManager.Preferences.DepositLinkDimension:t+="0",t+='" CCNodeID="'+this.DataTable[n].NodeID.toString(),t+='" CreditAccID="'+this.DataTable[n].CreditAccountID_Key.toString(),""!=s.e.StringValue(this.DataTable[n].AdvanceAcc)&&(t+='" AdvanceAccountID="'+this.DataTable[n].AdvanceAcc.toString()),""!=s.e.StringValue(this.DataTable[n].VatPer)&&(t+='" VatPer="'+this.DataTable[n].VatPer.toString()),""!=s.e.StringValue(this.DataTable[n].VatAmount)&&(t+='" VatAmount="'+this.DataTable[n].VatAmount.toString()),""!=s.e.StringValue(this.DataTable[n].InclChkGen)&&(t+='" InclChkGen="'+this.DataTable[n].InclChkGen.toString()),""!=s.e.StringValue(this.DataTable[n].VatType)&&(t+='" VatType="'+this.DataTable[n].VatType.toString()),""!=s.e.StringValue(this.DataTable[n].TaxCategory_Key)&&(t+='" TaxCategoryID="'+this.DataTable[n].TaxCategory_Key.toString()),this.DataTableColumns.Contains("SPType_Key")&&""!=s.e.StringValue(this.DataTable[n].SPType_Key)&&(t+='" SPType="'+this.DataTable[n].SPType_Key.toString()),""!=s.e.StringValue(this.DataTable[n].RecurInvoice)&&(t+='" Recur="'+this.DataTable[n].RecurInvoice.toString().toLowerCase()),""!=s.e.StringValue(this.DataTable[n].PostDebit)&&(t+='" PostDebit="'+this.DataTable[n].PostDebit.toString()),""!=s.e.StringValue(this.DataTable[n].TaxableAmt)&&(t+='" TaxableAmt="'+this.DataTable[n].TaxableAmt.toString()),t+='" SNO="'+e.toString(),""!=s.e.StringValue(this.DataTable[n].Sqft)&&(t+='" Sqft="'+this.DataTable[n].Sqft.toString()),""!=s.e.StringValue(this.DataTable[n].Rate)&&(t+='" Rate="'+this.DataTable[n].Rate.toString()),t+='" RentAmount="'+s.e.StringValue(this.DataTable[n].ActAmount),t+='" Discount="'+s.e.StringValue(this.DataTable[n].Discount),!s.e.IsEmpty(this.DataTable[n].Amount)&&s.e.DoubleTryParse(this.DataTable[n].Amount.toString())>0?t+='" Amount="'+this.DataTable[n].Amount.toString():t+='" Amount="0',t+='" Narration="'+m.d.GetValidXml(s.e.StringValue(this.DataTable[n].Narration)),this.DataTableColumns.Contains("Location")&&""!=s.e.StringValue(this.DataTable[n].Location_Key)&&(t+='" LocationID="'+this.DataTable[n].Location_Key.toString()),this.DataTableColumns.Contains("Dim_Key")&&""!=s.e.StringValue(this.DataTable[n].Dim_Key)&&(t+='" DimNodeID="'+this.DataTable[n].Dim_Key.toString()),this.DataTableColumns.Contains("SalesMan_Key")&&!s.e.IsEmpty(this.DataTable[n].SalesMan_Key)&&(t+='" SalesManID="'+this.DataTable[n].SalesMan_Key.toString()),null!=this.DataTable[n].ChequeNo&&""!=s.e.StringValue(this.DataTable[n].ChequeNo)&&null!=this.DataTable[n].CntrlDate_Key&&""!=s.e.StringValue(this.DataTable[n].CntrlDate_Key)?(null!=this.DataTable[n].CntrlDate_Key&&""!=s.e.StringValue(this.DataTable[n].CntrlDate_Key)?t+='" ChequeDate="'+new Date(this.DataTable[n].CntrlDate_Key).ToString("dd/MMM/yyyy"):t+='" ChequeDate="',""!=s.e.StringValue(this.DataTable[n].TasjeelAmount)&&(t+='" TasjeelAmount="'+this.DataTable[n].TasjeelAmount.toString()),t+='" ChequeNo="'+s.e.StringValue(this.DataTable[n].ChequeNo),t+='" PayeeBank="'+s.e.StringValue(this.DataTable[n].PayeeBank),t+='" DebitAccID="'+s.e.StringValue(this.DataTable[n].DebitAccountID_Key),t+='" IsRecurr="0'):(n>0&&(null!=this.DataTable[n].CntrlDate_Key&&""!=s.e.StringValue(this.DataTable[n].CntrlDate_Key)?t+='" ChequeDate="'+new Date(this.DataTable[n].CntrlDate_Key).ToString("dd/MMM/yyyy"):t+='" ChequeDate="'),""!=s.e.StringValue(this.DataTable[n].TasjeelAmount)&&(t+='" TasjeelAmount="'+this.DataTable[n].TasjeelAmount.toString()),t+='" ChequeNo="',t+='" PayeeBank="',null!=this.DataTable[n].DebitAccountID_Key&&""!=s.e.StringValue(this.DataTable[n].DebitAccountID_Key)?t+='" DebitAccID="'+this.DataTable[n].DebitAccountID_Key+'" IsRecurr="0':t+='" DebitAccID="" IsRecurr="1'),t+='" ';for(var r=0;r<this.ContractParticular.length;r++)this.ContractParticular[r].DisplayMember.startsWith("CCNID")&&this.DataTableColumns.Contains(this.ContractParticular[r].ValueMember)&&""!=this.DataTable[n][this.ContractParticular[r].ValueMember].toString()&&(t+=this.ContractParticular[r].DisplayMember+'="'+this.DataTable[n][this.ContractParticular[r].ValueMember].toString()+'" ');t+=" >",""!=s.e.StringValue(this.DataTable[n].Xml)&&(t+=this.DataTable[n].Xml.toString()),t+="</Row>"}t+="</Rows></ContractXML>"}catch(o){Logger.ErrorLog("AddEditRenContractViewModel :: GetContractDetailsXML"+o.stack)}return Logger.InfoLog("AddEditRenContractViewModel ::Exiting GetContractDetailsXML"),t.toString()}},{key:"GetPayTermsXML",value:function(){Logger.InfoLog("AddEditRenContractViewModel ::Entering GetPayTermsXML");var t="";try{var e=0;t+='<PayTermXML UpdateQuery="';for(var a=0;a<this.ContractPayTerms.length;a++)this.ContractPayTerms[a].DisplayMember.startsWith("CCNID")&&this.PayTermsDataTableColumns.Contains(this.ContractPayTerms[a].ValueMember)&&(t+=this.ContractPayTerms[a].DisplayMember+"=X.value('@"+this.ContractPayTerms[a].DisplayMember+"','BIGINT'), ");t+='" ><Rows>';for(var n=0;n<this.PayTermsDataTable.length;n++)if(!s.e.IsEmpty(this.PayTermsDataTable[n].CntrlDate_Key)&&!s.e.IsEmpty(this.PayTermsDataTable[n].Amount)&&""!=s.e.StringValue(this.PayTermsDataTable[n].Amount)&&parseFloat(this.PayTermsDataTable[n].Amount.toString())>0){e++;var i=new Date(this.PayTermsDataTable[n].CntrlDate_Key);s.e.IsEmpty(this.PayTermsDataTable[n].ChequeNo)&&(this.PayTermsDataTable[n].ChequeNo=""),s.e.IsEmpty(this.PayTermsDataTable[n].PayeeBank)&&(this.PayTermsDataTable[n].PayeeBank=""),t+='<Row ChequeNo="'+s.e.StringValue(this.PayTermsDataTable[n].ChequeNo),t+='" ChequeDate="'+i.ToString("dd/MMM/yyyy"),t+='" CustomerBank="'+s.e.StringValue(this.PayTermsDataTable[n].PayeeBank),t+='" Narration="'+s.e.EncodeXML(s.e.StringValue(this.PayTermsDataTable[n].Narration)),t+='" Period="'+s.e.StringValue(this.PayTermsDataTable[n].Period),t+='" SNO="'+e.toString(),t+='" DebitAccID="'+s.e.StringValue(this.PayTermsDataTable[n].DebitAccountID_Key),this.InclPostingDate&&""!=s.e.StringValue(this.PayTermsDataTable[n].PostingDate_Key)&&(t+='" PostingDate="'+new Date(this.PayTermsDataTable[n].PostingDate_Key.toString()).ToString("dd/MMM/yyy")),""!=s.e.StringValue(this.PayTermsDataTable[n].TillDate_Key)&&(t+='" TillDate="'+new Date(this.PayTermsDataTable[n].TillDate_Key.toString()).ToString("dd/MMM/yyyy")),this.PayTermsDataTableColumns.Contains("Location")&&""!=s.e.StringValue(this.PayTermsDataTable[n].Location_Key)&&(t+='" LocationID="'+this.PayTermsDataTable[n].Location_Key.toString()),this.PayTermsDataTableColumns.Contains("Dim_Key")&&""!=s.e.StringValue(this.PayTermsDataTable[n].Dim_Key)&&(t+='" DimNodeID="'+this.PayTermsDataTable[n].Dim_Key.toString()),this.PayTermsDataTableColumns.Contains("SalesMan_Key")&&!s.e.IsEmpty(this.PayTermsDataTable[n].SalesMan_Key)&&(t+='" SalesManID="'+this.PayTermsDataTable[n].SalesMan_Key.toString()),this.PayTermsDataTableColumns.Contains("Particulars_Key")&&""!=s.e.StringValue(this.PayTermsDataTable[n].Particulars_Key)&&(t+='" Particular="'+this.PayTermsDataTable[n].Particulars_Key.toString()),""!=s.e.StringValue(this.PayTermsDataTable[n].RentAmount)?t+='" RentAmount="'+this.PayTermsDataTable[n].RentAmount.toString():t+='" RentAmount="0',s.e.IsEmpty(this.PayTermsDataTable[n].Amount)||""==s.e.StringValue(this.PayTermsDataTable[n].Amount)?t+='" Amount="'+parseFloat(s.e.StringValue(this.PayTermsDataTable[n].Amount)).toString():t+='" Amount="'+this.PayTermsDataTable[n].Amount.toString(),t+='" ';for(var r=0;r<this.ContractPayTerms.length;r++)this.ContractPayTerms[r].DisplayMember.startsWith("CCNID")&&this.PayTermsDataTableColumns.Contains(this.ContractPayTerms[r].ValueMember)&&""!=this.PayTermsDataTable[n][this.ContractPayTerms[r].ValueMember].toString()&&(t+=this.ContractPayTerms[r].DisplayMember+'="'+this.PayTermsDataTable[n][this.ContractPayTerms[r].ValueMember].toString()+'" ');t+=" />"}t+="</Rows></PayTermXML>"}catch(o){Logger.ErrorLog("AddEditRenContractViewModel :: GetPayTermsXML"+o.stack)}return Logger.InfoLog("AddEditRenContractViewModel ::Exiting GetPayTermsXML"),t.toString()}},{key:"GetSalemanXml",value:function(t){return s.e.IsEmpty(t.SalesMan_Key)?"":" dcCCNID"+(this.Salesman.CCID-5e4).toString()+"="+t.SalesMan_Key.toString()+","}},{key:"GetReceiptXML",value:function(t){var e=this;if(0==this.PayTermsDataTable.length||95==this.CostCenterID&&this.SinglePDC)return"";Logger.InfoLog("AddEditRenContractViewModel ::Entering GetReceiptXML");var a=0,n="",o=this.ContractDate.Date;if(s.e.IsEmpty(this.PayTermsDataTable[0].CntrlDate_Key)||(o=new Date(this.PayTermsDataTable[0].CntrlDate_Key)),this.BankAccounts.ContainsKey(s.e.String(this.PayTermsDataTable[0].DebitAccountID_Key))||this.PDCAccounts.ContainsKey(s.e.StringValue(this.PayTermsDataTable[0].DebitAccountID_Key))?(this.PostBankRct&&"cash"==this.GetPayBank(this.PayTermsDataTable[0].PayeeBank.toString()).toLowerCase()?n+='<ReceiptXML><ROWS><AccountType  DD="Rct"></AccountType><Documents DDate="':n+='<ReceiptXML><ROWS><AccountType  DD="BANK"></AccountType><Documents DDate="',this.InclPostingDate&&!s.e.IsEmpty(this.PayTermsDataTable[0].PostingDate_Key)?n+=new Date(this.PayTermsDataTable[0].PostingDate_Key.toString()).ToString("dd/MMM/yyyy"):n+=this.ContractDate.Date.ToString("dd/MMM/yyyy"),n+='"  DocID="'+s.e.String(this.PayTermsDataTable[0].DocID)+'"></Documents><DocumentXML>',this.strType=!0):this.CashAccounts.ContainsKey(s.e.String(this.PayTermsDataTable[0].DebitAccountID_Key))?(n+='<ReceiptXML><ROWS><AccountType  DD="CASH"></AccountType><Documents DDate="',this.InclPostingDate&&!s.e.IsEmpty(this.PayTermsDataTable[0].PostingDate_Key)?n+=new Date(this.PayTermsDataTable[0].PostingDate_Key.toString()).ToString("dd/MMM/yyyy"):n+=this.JVRecieptonPaymentDate?o.ToString("dd/MMM/yyyy"):this.ContractDate.Date.ToString("dd/MMM/yyyy"),n+='"  DocID="'+s.e.String(this.PayTermsDataTable[0].DocID)+'"></Documents><DocumentXML>',this.strType=!0):(n+='<ReceiptXML><ROWS><AccountType  DD="JV"></AccountType><Documents DDate="',this.InclPostingDate&&!s.e.IsEmpty(this.PayTermsDataTable[0].PostingDate_Key)?n+=new Date(this.PayTermsDataTable[0].PostingDate_Key.toString()).ToString("dd/MMM/yyyy"):n+=this.JVRecieptonPaymentDate?o.ToString("dd/MMM/yyyy"):this.ContractDate.Date.ToString("dd/MMM/yyyy"),n+='"  DocID="'+s.e.String(this.PayTermsDataTable[0].DocID)+'"></Documents><DocumentXML>',this.strType=!1),!s.e.IsEmpty(this.PayTermsDataTable[0].Amount)&&parseFloat(this.PayTermsDataTable[0].Amount.toString())>0){var l=0,c=parseFloat(this.PayTermsDataTable[0].Amount.toString()),u=1;null!=this.dsprof&&this.dsprof.Tables.length>0&&this.dsprof.Columns[0].Contains("ProfileID")&&this.dsprof.Tables[0].length>0&&(u=this.dsprof.Tables[0].length);for(var D=0,h=i.a.SessionManager.Preferences.DistributeCostDims.split(","),C=function(C){if(u>1?(C+1==e.dsprof.Tables[0].length?l=parseFloat((c-D).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())):!s.e.IsEmpty(e.dsprof.Tables[0][C].Percent)&&parseFloat(e.dsprof.Tables[0][C].Percent.toString())>0?l=parseFloat((c*parseFloat(e.dsprof.Tables[0][C].Percent.toString())/100).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())):!s.e.IsEmpty(e.dsprof.Tables[0][C].Amount)&&parseFloat(e.dsprof.Tables[0][C].Amount.toString())>0&&(l=parseFloat(e.dsprof.Tables[0][C].Amount.toString())),D+=l):l=c,e.strType){n+='<Row><Transactions  CONTRACTSNO="1"  ',n+=' DocDetailsID="0"  DocSeqNo="'+C+'1"   DebitAccount="'+s.e.String(e.PayTermsDataTable[0].DebitAccountID_Key)+'" CreditAccount="'+s.e.String(e.RentRecAc.SelectedValue)+'" Amount="'+l+'" AmtFc="'+l+'"',n+=e.CurrencyContract.SelectedValue>0?' ChequeDate = "'+o.ToString("dd/MMM/yyyy")+'"  ChequeMaturityDate = "'+o.ToString("dd/MMM/yyyy")+'"  CurrencyID="'+e.CurrencyContract.SelectedValue+'" ExchangeRate="1" CommonNarration="'+m.d.GetValidXml(s.e.String(e.PayTermsDataTable[0].Narration))+'" LineNarration="'+m.d.GetValidXml(s.e.String(e.PayTermsDataTable[0].Narration))+'" ChequeBankName="'+m.d.GetValidXml(e.GetPayBank(s.e.String(e.PayTermsDataTable[0].PayeeBank)))+'" ChequeNumber="'+s.e.String(e.PayTermsDataTable[0].ChequeNo)+'"':' ChequeDate = "'+o.ToString("dd/MMM/yyyy")+'"  ChequeMaturityDate = "'+o.ToString("dd/MMM/yyyy")+'"  CurrencyID="1" ExchangeRate="1" CommonNarration="'+m.d.GetValidXml(s.e.String(e.PayTermsDataTable[0].Narration))+'" LineNarration="'+m.d.GetValidXml(s.e.String(e.PayTermsDataTable[0].Narration))+'" ChequeBankName="'+m.d.GetValidXml(e.GetPayBank(s.e.String(e.PayTermsDataTable[0].PayeeBank)))+'" ChequeNumber="'+s.e.String(e.PayTermsDataTable[0].ChequeNo)+'"',n+="></Transactions> ";var b=e.AddRowCC(e.PayTermsDataTable[0],null,0,0,e.PayTermsDataTable);if(b+=e.GetSalemanXml(e.PayTermsDataTable[0]),u>1?h.forEach((function(t){parseInt(t)>5e4&&e.dsprof.Columns[0].Contains("DCCCNID"+(parseInt(t)-5e4))&&!s.e.IsEmpty(e.dsprof.Tables[0][C]["DCCCNID"+(parseInt(t)-5e4)])&&(b+="DCCCNID"+(parseInt(t)-5e4)+"="+e.dsprof.Tables[0][C]["DCCCNID"+(parseInt(t)-5e4)].toString()+",")})):null!=e.dsprof&&e.dsprof.Tables.length>0&&e.dsprof.Columns[0].Contains("ProfileID")&&1==e.dsprof.Tables[0].length&&h.forEach((function(t){parseInt(t)>5e4&&e.dsprof.Columns[0].Contains("DCCCNID"+(parseInt(t)-5e4))&&""!=e.dsprof.Tables[0][0]["DCCCNID"+(parseInt(t)-5e4)].toString()&&(b+="DCCCNID"+(parseInt(t)-5e4)+"="+e.dsprof.Tables[0][0]["DCCCNID"+(parseInt(t)-5e4)].toString()+",")})),n+=' <Numeric /> <Alpha /> <CostCenters   Query="'+e.strCCQry.toString()+b+'"  /> ',n+="<EXTRAXML> ",i.a.SessionManager.Preferences.ContainsKey("On")&&"True"==i.a.SessionManager.Preferences.On&&t&&l>0){n+="<BillWise> ";for(var S=l,d=0;d<e.DataTable.length;d++)if(!s.e.IsEmpty(e.DataTable[d].Amount)){var T=0;if(e.SingleInvoice&&e.DistribtueInvoice&&e.Invoiced>0){var y=e.Invoiced-a;S>y?(S-=y,T=y):(T=S,S=0)}else S>parseFloat(s.e.String(e.DataTable[d].Amount))?(S-=parseFloat(e.DataTable[d].Amount.toString()),T=parseFloat(e.DataTable[d].Amount.toString())):(T=S,S=0);if(T>0&&(n+=' <Row DocSeqNo="'+C+'1" AccountID="'+s.e.String(e.RentRecAc.SelectedValue),n+='" AmountFC="-'+T+'" AdjAmount="-'+T+'"',n+=' AdjCurrID="1" ',n+='AdjExchRT="1" ',n+='IsNewReference="0" ',n+='Narration="" ',n+='IsDocPDC="0" ',n+='RefDocNo="'+(d+1).toString()+'" ',n+=" ></Row>",a+=T),e.SingleInvoice&&e.DistribtueInvoice&&e.Invoiced>0&&S>0&&(n+=' <Row DocSeqNo="'+C+'1" AccountID="'+s.e.String(e.RentRecAc.SelectedValue),n+='" AmountFC="-'+S+'" AdjAmount="-'+S+'"',n+=' AdjCurrID="1" ',n+='AdjExchRT="1" ',n+='IsNewReference="1" ',n+='Narration="" ',n+='IsDocPDC="0" ',n+=" ></Row>",S=0),S<=0)break}n+=" </BillWise>"}n+="</EXTRAXML> ",n+=" </Row>"}else{n+='<Row><Transactions  CONTRACTSNO="1"  ',n+=' DocDetailsID="0"  DocSeqNo="'+2*C+'1"   DebitAccount="'+s.e.String(e.PayTermsDataTable[0].DebitAccountID_Key)+'" CreditAccount="-99" Amount="'+l+'" AmtFc="'+l+'"',n+=e.CurrencyContract.SelectedValue>0?' ChequeDate = "'+o.ToString("dd/MMM/yyyy")+'"  ChequeMaturityDate = "'+o.ToString("dd/MMM/yyyy")+'"  CurrencyID="'+e.CurrencyContract.SelectedValue+'" ExchangeRate="1" CommonNarration="'+m.d.GetValidXml(s.e.String(e.PayTermsDataTable[0].Narration))+'" LineNarration="'+m.d.GetValidXml(s.e.String(e.PayTermsDataTable[0].Narration))+'" ChequeBankName="'+m.d.GetValidXml(e.GetPayBank(s.e.String(e.PayTermsDataTable[0].PayeeBank)))+'" ChequeNumber="'+s.e.String(e.PayTermsDataTable[0].ChequeNo)+'"':' ChequeDate = "'+o.ToString("dd/MMM/yyyy")+'"  ChequeMaturityDate = "'+o.ToString("dd/MMM/yyyy")+'"  CurrencyID="1" ExchangeRate="1" CommonNarration="'+m.d.GetValidXml(s.e.String(e.PayTermsDataTable[0].Narration))+'" LineNarration="'+m.d.GetValidXml(s.e.String(e.PayTermsDataTable[0].Narration))+'" ChequeBankName="'+m.d.GetValidXml(e.GetPayBank(s.e.String(e.PayTermsDataTable[0].PayeeBank)))+'" ChequeNumber="'+s.e.String(e.PayTermsDataTable[0].ChequeNo)+'"',n+="></Transactions> ";var g="";if(e.TempCCID>5e4&&!e.strCCQry.toString().Contains("dcCCNID"+(e.TempCCID-5e4).toString()+"=")&&(g=s.e.IsEmpty(e.PayTermsDataTable[0].TempCCID_Key)?" dcCCNID"+(e.TempCCID-5e4).toString()+"=1,":" dcCCNID"+(e.TempCCID-5e4).toString()+"="+s.e.String(e.PayTermsDataTable[0].TempCCID_Key)+","),e.PayTermsDataTableColumns.Contains("Location_Key")&&!s.e.IsEmpty(e.PayTermsDataTable[0].Location_Key)?g+=" dcCCNID2="+s.e.String(e.PayTermsDataTable[0].Location_Key)+",":e.LocationContract.Visible&&e.LocationContract.SelectedValue>0&&(g+=" dcCCNID2="+e.LocationContract.SelectedValue+","),e.PayTermsDataTableColumns.Contains("Dim_Key")&&!s.e.IsEmpty(e.PayTermsDataTable[0].Dim_Key)&&(g+=" dcCCNID"+(e.DimCCID-5e4).toString()+"="+s.e.String(e.PayTermsDataTable[0].Dim_Key)+","),g+=e.GetSalemanXml(e.PayTermsDataTable[0]),e.PayTermsDataTableColumns.Contains("Particulars_Key")&&!s.e.IsEmpty(e.PayTermsDataTable[0].Particulars_Key)&&(g+=" dcCCNID"+(parseInt(i.a.SessionManager.Preferences.DepositLinkDimension)-5e4).toString()+"="+s.e.String(e.PayTermsDataTable[0].Particulars_Key)+","),e.multiVisi&&!e.strCCQry.toString().Contains("dcCCNID"+(e.UnitCCID-5e4).toString()+"=")&&(g+=" dcCCNID"+(e.UnitCCID-5e4).toString()+"="+e.UnitNodeID+","),n+=' <Numeric /> <Alpha /> <CostCenters   Query="'+e.strCCQry.toString()+g+'"  /> ',n+="<EXTRAXML> ",i.a.SessionManager.Preferences.ContainsKey("On")&&"True"==i.a.SessionManager.Preferences.On&&l>0&&!s.e.IsEmpty(e.PayTermsDataTable[0].DebitAccountID_Key)){var I=!1,p=i.a.rental.IsBillWiseAccount(parseInt(s.e.String(e.PayTermsDataTable[0].DebitAccountID_Key)));if(null!=p&&p.Tables.length>0&&p.Tables[0].length>0&&!s.e.IsEmpty(p.Tables[0][0].IsBillwise)&&(I=Object(r.j)(p.Tables[0][0].IsBillwise)),I){n+="<BillWise> ";var A=l;n+=' <Row DocSeqNo="'+2*C+'1" AccountID="'+s.e.String(e.PayTermsDataTable[0].DebitAccountID_Key),n+='" AmountFC="'+A+'" AdjAmount="'+A+'"',n+=' AdjCurrID="1" ',n+='AdjExchRT="1" ',n+='IsNewReference="1" ',n+='Narration="" ',n+='IsDocPDC="0" ',n+=" ></Row>",n+=" </BillWise>"}}if(n+="</EXTRAXML> ",n+=" </Row>",n+='<Row><Transactions  CONTRACTSNO="1"  ',n+=' DocDetailsID="0"  DocSeqNo="'+2*C+'2"   DebitAccount="-99" CreditAccount="'+s.e.String(e.RentRecAc.SelectedValue)+'" Amount="'+l+'" AmtFc="'+l+'"',n+=e.CurrencyContract.SelectedValue>0?' ChequeDate = "'+o.ToString("dd/MMM/yyyy")+'"  ChequeMaturityDate = "'+o.ToString("dd/MMM/yyyy")+'"  CurrencyID="'+e.CurrencyContract.SelectedValue+'" ExchangeRate="1" CommonNarration="'+m.d.GetValidXml(s.e.String(e.PayTermsDataTable[0].Narration))+'" LineNarration="'+m.d.GetValidXml(s.e.String(e.PayTermsDataTable[0].Narration))+'" ChequeBankName="'+m.d.GetValidXml(e.GetPayBank(s.e.String(e.PayTermsDataTable[0].PayeeBank)))+'" ChequeNumber="'+s.e.String(e.PayTermsDataTable[0].ChequeNo)+'"':' ChequeDate = "'+o.ToString("dd/MMM/yyyy")+'"  ChequeMaturityDate = "'+o.ToString("dd/MMM/yyyy")+'"  CurrencyID="1" ExchangeRate="1" CommonNarration="'+m.d.GetValidXml(s.e.String(e.PayTermsDataTable[0].Narration))+'" LineNarration="'+m.d.GetValidXml(s.e.String(e.PayTermsDataTable[0].Narration))+'" ChequeBankName="'+m.d.GetValidXml(e.GetPayBank(s.e.String(e.PayTermsDataTable[0].PayeeBank)))+'" ChequeNumber="'+s.e.String(e.PayTermsDataTable[0].ChequeNo)+'"',n+="></Transactions> ",g="",e.TempCCID>5e4&&!e.strCCQry.toString().Contains("dcCCNID"+(e.TempCCID-5e4).toString()+"=")&&(g=s.e.IsEmpty(e.PayTermsDataTable[0].TempCCID_Key)?" dcCCNID"+(e.TempCCID-5e4).toString()+"=1,":" dcCCNID"+(e.TempCCID-5e4).toString()+"="+e.PayTermsDataTable[0].TempCCID_Key.toString()+","),e.PayTermsDataTableColumns.Contains("Location_Key")&&!s.e.IsEmpty(e.PayTermsDataTable[0].Location_Key)?g+=" dcCCNID2="+e.PayTermsDataTable[0].Location_Key.toString()+",":e.LocationContract.Visible&&e.LocationContract.SelectedValue>0&&(g+=" dcCCNID2="+e.LocationContract.SelectedValue+","),e.PayTermsDataTableColumns.Contains("Dim_Key")&&!s.e.IsEmpty(e.PayTermsDataTable[0].Dim_Key)&&(g+=" dcCCNID"+(e.DimCCID-5e4).toString()+"="+s.e.String(e.PayTermsDataTable[0].Dim_Key)+","),g+=e.GetSalemanXml(e.PayTermsDataTable[0]),e.PayTermsDataTableColumns.Contains("Particulars_Key")&&!s.e.IsEmpty(e.PayTermsDataTable[0].Particulars_Key)&&(g+=" dcCCNID"+(parseInt(i.a.SessionManager.Preferences.DepositLinkDimension)-5e4).toString()+"="+s.e.String(e.PayTermsDataTable[0].Particulars_Key)+","),e.multiVisi&&!e.strCCQry.toString().Contains("dcCCNID"+(e.UnitCCID-5e4).toString()+"=")&&(g+=" dcCCNID"+(e.UnitCCID-5e4).toString()+"="+e.UnitNodeID+","),n+=' <Numeric /> <Alpha /> <CostCenters   Query="'+e.strCCQry.toString()+g+'"  /> ',n+="<EXTRAXML> ",i.a.SessionManager.Preferences.ContainsKey("On")&&"True"==i.a.SessionManager.Preferences.On&&t&&l>0){n+="<BillWise> ";for(var f=l,P=0;P<e.DataTable.length;P++)if((s.e.IsEmpty(e.DataTable[P].DebitAccountID_Key)||!(parseInt(s.e.String(e.DataTable[P].DebitAccountID_Key))>0))&&!s.e.IsEmpty(e.DataTable[P].Amount)){var N=0;if(e.SingleInvoice&&e.DistribtueInvoice&&e.Invoiced>0?f>e.Invoiced?(f-=e.Invoiced,N=e.Invoiced):(N=f,f=0):f>parseFloat(s.e.String(e.DataTable[P].Amount))?(f-=parseFloat(s.e.String(e.DataTable[P].Amount)),N=parseFloat(s.e.String(e.DataTable[P].Amount))):(N=f,f=0),n+=' <Row DocSeqNo="'+2*C+'2" AccountID="'+s.e.String(e.RentRecAc.SelectedValue),n+='" AmountFC="-'+N+'" AdjAmount="-'+N+'"',n+=' AdjCurrID="1" ',n+='AdjExchRT="1" ',n+='IsNewReference="0" ',n+='Narration="" ',n+='IsDocPDC="0" ',n+='RefDocNo="'+(P+1).toString()+'" ',n+=" ></Row>",e.ValueUsed+=N,e.SingleInvoice&&e.DistribtueInvoice&&e.Invoiced>0&&f>0&&(n+=' <Row DocSeqNo="'+2*C+'2" AccountID="'+s.e.String(e.RentRecAc.SelectedValue),n+='" AmountFC="-'+f+'" AdjAmount="-'+f+'"',n+=' AdjCurrID="1" ',n+='AdjExchRT="1" ',n+='IsNewReference="1" ',n+='Narration="" ',n+='IsDocPDC="0" ',n+=" ></Row>",e.ValueUsed+=f,f=0),f<=0)break}n+=" </BillWise>"}n+="</EXTRAXML> ",n+=" </Row>"}},b=0;b<u;b++)C(b)}return n+="</DocumentXML></ROWS></ReceiptXML>",Logger.InfoLog("AddEditRenContractViewModel ::Exiting GetReceiptXML"),n.toString()}},{key:"GetReceipts",value:function(t,e){Logger.InfoLog("AddEditRenContractViewModel ::Entering GetPDReceiptXML");var a="",n=null;e=0;for(var o=!1,l=0,c=0;c<this.PayTermsDataTable.length;c++)if(!s.e.IsEmpty(this.PayTermsDataTable[c].DebitAccountID_Key)&&""!=s.e.StringValue(this.PayTermsDataTable[c].DebitAccountID_Key)&&parseInt(this.PayTermsDataTable[c].DebitAccountID_Key)>0&&!s.e.IsEmpty(this.PayTermsDataTable[c].Amount)&&""!=s.e.StringValue(this.PayTermsDataTable[c].Amount)&&parseFloat(this.PayTermsDataTable[c].Amount.toString())>0){if(e++,0==t&&this.BankAccounts.ContainsKey(this.PayTermsDataTable[c].DebitAccountID_Key.toString())||this.PDCAccounts.ContainsKey(this.PayTermsDataTable[c].DebitAccountID_Key.toString())?(a+='<ROWS><Documents DD="BANK" ></Documents><DocumentXML>',this.strType=!0):0==t&&this.CashAccounts.ContainsKey(this.PayTermsDataTable[c].DebitAccountID_Key.toString())?(a+='<ROWS><Documents DD="CASH" ></Documents><DocumentXML>',this.strType=!0):(a+='<ROWS><Documents DD="JV" ></Documents><DocumentXML>',this.strType=!1),null==n&&(n=i.a.rental.GetPostingDetails(this.cntrct,0,this.CurrCostCenterID,0,0,0,this.cntrct.PropertyID,this.cntrct.UnitID,this.cntrct.TenantID,this.cntrct.RentRecID)),null!=n&&n.Tables.length>0&&(this.ProductID=parseInt(n.Tables[0][0].PRODUCTID.toString()),this.GetCCData(n.Tables[0]),s.e.IsEmpty(n.Tables[0][0].IsBillwise)||(o=Object(r.j)(n.Tables[0][0].IsBillwise.toString())),471==t&&(s.e.IsEmpty(n.Tables[0][0].AdvReceivableCloseAccID)||(l=parseInt(n.Tables[0][0].AdvReceivableCloseAccID.toString())),s.e.IsEmpty(n.Tables[0][0].AdvReceivableBillwise)||(o=Object(r.j)(n.Tables[0][0].AdvReceivableBillwise.toString())))),this.strType){a+='<Row><Transactions   CONTRACTSNO="'+(c+1).toString()+'" ',a+=' DocDetailsID="0"  DocSeqNo="1" ',a+=471==t?' DebitAccount="'+this.RentRecAc.SelectedValue.toString()+'" CreditAccount="'+l.toString():' DebitAccount="'+this.PayTermsDataTable[c].DebitAccountID_Key.toString()+'" CreditAccount="'+this.RentRecAc.SelectedValue.toString(),a+='" Amount="'+parseFloat(this.PayTermsDataTable[c].Amount)+'"  AmtFc="'+parseFloat(this.PayTermsDataTable[c].Amount)+'" ',s.e.IsEmpty(this.PayTermsDataTable[c].CntrlDate_Key)||(a+=' ChequeDate = "'+new Date(this.PayTermsDataTable[c].CntrlDate_Key.toString()).ToString("dd/MMM/yyyy")+'" ChequeMaturityDate = "'+new Date(this.PayTermsDataTable[c].CntrlDate_Key).ToString("dd/MMM/yyyy")+'" '),a+=' CurrencyID="1" ExchangeRate="1" CommonNarration="'+m.d.GetValidXml(this.PayTermsDataTable[c].Narration.toString())+'" LineNarration="'+m.d.GetValidXml(this.PayTermsDataTable[c].Narration.toString())+'"  ChequeBankName="'+m.d.GetValidXml(this.GetPayBank(this.PayTermsDataTable[c].PayeeBank.toString()))+'" ChequeNumber="'+this.PayTermsDataTable[c].ChequeNo.toString()+'"',a+="></Transactions> ";var u="";this.PayTermsDataTableColumns.Contains("Location_Key")&&""!=s.e.StringValue(this.PayTermsDataTable[c].Location_Key)?u+=" dcCCNID2="+this.PayTermsDataTable[c].Location_Key.toString()+",":this.LocationContract.Visible&&this.LocationContract.SelectedValue>0&&(u+=" dcCCNID2="+this.LocationContract.SelectedValue+","),this.PayTermsDataTableColumns.Contains("Dim_Key")&&""!=s.e.StringValue(this.PayTermsDataTable[c].Dim_Key)&&(u+=" dcCCNID"+(this.DimCCID-5e4).toString()+"="+this.PayTermsDataTable[c].Dim_Key.toString()+","),u+=this.GetSalemanXml(this.PayTermsDataTable[c]),this.TempCCID>5e4&&!this.strCCQry.toString().Contains("dcCCNID"+(this.TempCCID-5e4).toString()+"=")&&(""!=s.e.StringValue(this.PayTermsDataTable[c].TempCCID_Key)?u+=" dcCCNID"+(this.TempCCID-5e4).toString()+"="+this.PayTermsDataTable[c].TempCCID_Key.toString()+",":u+=" dcCCNID"+(this.TempCCID-5e4).toString()+"=1,"),a+=' <Numeric /> <Alpha /> <CostCenters   Query="'+this.strCCQry.toString()+u+'"  />   ',a+="<EXTRAXML> ",i.a.SessionManager.Preferences.ContainsKey("On")&&"True"==i.a.SessionManager.Preferences.On&&o&&(a+="<BillWise> ",a+=' <Row DocSeqNo="1" AccountID="',a+=471==t?l.toString():this.RentRecAc.SelectedValue.toString(),a+='" AmountFC="-'+this.PayTermsDataTable[c].Amount.toString()+'" AdjAmount="-'+this.PayTermsDataTable[c].Amount.toString()+'"',a+=' AdjCurrID="1" ',a+='AdjExchRT="1" ',a+='IsNewReference="1" ',a+='Narration="" ',a+='IsDocPDC="0" ',a+=" ></Row>",a+=" </BillWise>"),a+="</EXTRAXML> ",a+=" </Row>"}else{a+='<Row><Transactions   CONTRACTSNO="'+(c+1).toString()+'" ',a+=' DocDetailsID="0"  DocSeqNo="1" ',a+=471==t?' DebitAccount="'+this.RentRecAc.SelectedValue.toString()+'" ':' DebitAccount="'+this.PayTermsDataTable[c].DebitAccountID_Key.toString()+'" ',a+=' CreditAccount="-99" Amount="'+parseFloat(this.PayTermsDataTable[c].Amount)+'"  AmtFc="'+parseFloat(this.PayTermsDataTable[c].Amount)+'" ',a+=' CurrencyID="1" ExchangeRate="1" CommonNarration="'+m.d.GetValidXml(this.PayTermsDataTable[c].Narration.toString())+'" LineNarration="'+m.d.GetValidXml(this.PayTermsDataTable[c].Narration.toString())+'"  ChequeBankName="'+m.d.GetValidXml(this.GetPayBank(this.PayTermsDataTable[c].PayeeBank.toString()))+'" ChequeNumber="'+this.PayTermsDataTable[c].ChequeNo.toString()+'"',a+="></Transactions> ";var D="";if(this.TempCCID>5e4&&!this.strCCQry.toString().Contains("dcCCNID"+(this.TempCCID-5e4).toString()+"=")&&(D=""!=s.e.StringValue(this.PayTermsDataTable[c].TempCCID_Key)?" dcCCNID"+(this.TempCCID-5e4).toString()+"="+this.PayTermsDataTable[c].TempCCID_Key.toString()+",":" dcCCNID"+(this.TempCCID-5e4).toString()+"=1,"),this.PayTermsDataTableColumns.Contains("Location_Key")&&""!=s.e.StringValue(this.PayTermsDataTable[c].Location_Key)?D+=" dcCCNID2="+this.PayTermsDataTable[c].Location_Key.toString()+",":this.LocationContract.Visible&&this.LocationContract.SelectedValue>0&&(D+=" dcCCNID2="+this.LocationContract.SelectedValue+","),this.PayTermsDataTableColumns.Contains("Dim_Key")&&""!=s.e.StringValue(this.PayTermsDataTable[c].Dim_Key)&&(D+=" dcCCNID"+(this.DimCCID-5e4).toString()+"="+this.PayTermsDataTable[c].Dim_Key.toString()+","),D+=this.GetSalemanXml(this.PayTermsDataTable[c]),a+=' <Numeric /> <Alpha /> <CostCenters   Query="'+this.strCCQry.toString()+D+'"  /> ',a+="<EXTRAXML> ",i.a.SessionManager.Preferences.ContainsKey("On")&&"True"==i.a.SessionManager.Preferences.On){var h=!1,C=i.a.rental.IsBillWiseAccount(parseInt(this.PayTermsDataTable[c].DebitAccountID_Key.toString()));null!=C&&C.Tables.length>0&&C.Tables[0].length>0&&!s.e.IsEmpty(C.Tables[0][0].IsBillwise)&&(h=Object(r.j)(C.Tables[0][0].IsBillwise)),h&&(a+="<BillWise> ",a+=' <Row DocSeqNo="1" AccountID="',a+=471==t?this.RentRecAc.SelectedValue.toString():this.PayTermsDataTable[c].DebitAccountID_Key.toString(),a+='" AmountFC="'+this.PayTermsDataTable[c].Amount.toString()+'" AdjAmount="'+this.PayTermsDataTable[c].Amount.toString()+'"',a+=' AdjCurrID="1" ',a+='AdjExchRT="1" ',a+='IsNewReference="1" ',a+='Narration="" ',a+='IsDocPDC="0" ',a+=" ></Row>",a+=" </BillWise>")}a+="</EXTRAXML> ",a+=" </Row>",a+='<Row><Transactions   CONTRACTSNO="'+(c+1).toString()+'" ',a+=' DocDetailsID="0"  DocSeqNo="2"   DebitAccount="-99" ',a+=471==t?' CreditAccount="'+l.toString()+'" ':' CreditAccount="'+this.RentRecAc.SelectedValue.toString()+'" ',a+=' Amount="'+parseFloat(this.PayTermsDataTable[c].Amount)+'"  AmtFc="'+parseFloat(this.PayTermsDataTable[c].Amount)+'" ',a+=' CurrencyID="1" ExchangeRate="1" CommonNarration="'+m.d.GetValidXml(this.PayTermsDataTable[c].Narration.toString())+'" LineNarration="'+m.d.GetValidXml(this.PayTermsDataTable[c].Narration.toString())+'"  ChequeBankName="'+m.d.GetValidXml(this.GetPayBank(this.PayTermsDataTable[c].PayeeBank.toString()))+'" ChequeNumber="'+this.PayTermsDataTable[c].ChequeNo.toString()+'"',a+="></Transactions> ",D="",this.TempCCID>5e4&&!this.strCCQry.toString().Contains("dcCCNID"+(this.TempCCID-5e4).toString()+"=")&&(D=""!=s.e.StringValue(this.PayTermsDataTable[c].TempCCID_Key)?" dcCCNID"+(this.TempCCID-5e4).toString()+"="+this.PayTermsDataTable[c].TempCCID_Key.toString()+",":" dcCCNID"+(this.TempCCID-5e4).toString()+"=1,"),this.PayTermsDataTableColumns.Contains("Location_Key")&&""!=s.e.StringValue(this.PayTermsDataTable[c].Location_Key)?D+=" dcCCNID2="+this.PayTermsDataTable[c].Location_Key.toString()+",":this.LocationContract.Visible&&this.LocationContract.SelectedValue>0&&(D+=" dcCCNID2="+this.LocationContract.SelectedValue+","),this.PayTermsDataTableColumns.Contains("Dim_Key")&&""!=s.e.StringValue(this.PayTermsDataTable[c].Dim_Key)&&(D+=" dcCCNID"+(this.DimCCID-5e4).toString()+"="+this.PayTermsDataTable[c].Dim_Key.toString()+","),D+=this.GetSalemanXml(this.PayTermsDataTable[c]),a+=' <Numeric /> <Alpha /> <CostCenters   Query="'+this.strCCQry.toString()+D+'"  /> ',a+="<EXTRAXML> ",i.a.SessionManager.Preferences.ContainsKey("On")&&"True"==i.a.SessionManager.Preferences.On&&o&&(a+="<BillWise> ",a+=' <Row DocSeqNo="2" AccountID="',a+=471==t?l.toString():this.RentRecAc.SelectedValue.toString(),a+='" AmountFC="-'+this.PayTermsDataTable[c].Amount.toString()+'" AdjAmount="-'+this.PayTermsDataTable[c].Amount.toString()+'"',a+=' AdjCurrID="1" ',a+='AdjExchRT="1" ',a+='IsNewReference="0" ',a+='Narration="" ',a+='IsDocPDC="0" ',a+=" ></Row>",a+=" </BillWise>"),a+="</EXTRAXML> ",a+=" </Row>"}a+="</DocumentXML></ROWS>"}return a.length>0&&(a="<PDR>"+a,a+="</PDR>"),Logger.InfoLog("AddEditRenContractViewModel ::Exiting GetPDReceiptXML"),{sbIssue:a,Count:e}}},{key:"GetJVPayXML",value:function(t,e,a){var n=this,o="",l=0,c=parseFloat(s.e.String(this.PayTermsDataTable[e].Amount)),u=1;null!=this.dsprof&&this.dsprof.Tables.length>0&&this.dsprof.Columns[0].Contains("ProfileID")&&this.dsprof.Tables[0].length>0&&(u=this.dsprof.Tables[0].length);for(var D=0,h=i.a.SessionManager.Preferences.DistributeCostDims.split(","),C=function(C){u>1?(C+1==n.dsprof.Tables[0].length?l=parseFloat((c-D).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())):!s.e.IsEmpty(n.dsprof.Tables[0][C].Percent)&&parseFloat(n.dsprof.Tables[0][C].Percent.toString())>0?l=parseFloat((c*parseFloat(n.dsprof.Tables[0][C].Percent.toString())/100).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())):!s.e.IsEmpty(n.dsprof.Tables[0][C].Amount)&&parseFloat(n.dsprof.Tables[0][C].Amount.toString())>0&&(l=parseFloat(n.dsprof.Tables[0][C].Amount.toString())),D+=l):l=c,o+='<Row><Transactions CONTRACTSNO="'+(e+1).toString()+'" ',o+='DocDetailsID="0" DocSeqNo="'+2*C+'1" ',o+=104==n.CurrCostCenterID?'CreditAccount="'+s.e.String(n.PayTermsDataTable[e].DebitAccountID_Key)+'" DebitAccount="-99" ':'DebitAccount="'+s.e.String(n.PayTermsDataTable[e].DebitAccountID_Key)+'" CreditAccount="-99" ',o+='Amount="'+l+'" AmtFc="'+l+'" ',o+=' ChequeDate = "'+a.ToString("dd/MMM/yyyy")+'" ChequeMaturityDate = "'+a.ToString("dd/MMM/yyyy")+'" ',o+=n.CurrencyContract.SelectedValue>0?'CurrencyID="'+n.CurrencyContract.SelectedValue+'" ':'CurrencyID="1" ',o+='ExchangeRate="1" CommonNarration="'+m.d.GetValidXml(s.e.String(n.PayTermsDataTable[e].Narration))+'" LineNarration="'+m.d.GetValidXml(s.e.String(n.PayTermsDataTable[e].Narration))+'"  ChequeBankName="'+m.d.GetValidXml(n.GetPayBank(s.e.String(n.PayTermsDataTable[e].PayeeBank)))+'" ChequeNumber="'+s.e.String(n.PayTermsDataTable[e].ChequeNo)+'" ',o+="></Transactions> ";var b=n.AddRowCC(n.PayTermsDataTable[e],null,0,0,n.PayTermsDataTable);if(b+=n.GetSalemanXml(n.PayTermsDataTable[e]),u>1?h.forEach((function(t){parseInt(t)>5e4&&n.dsprof.Columns[0].Contains("DCCCNID"+(parseInt(t)-5e4))&&!s.e.IsEmpty(n.dsprof.Tables[0][C]["DCCCNID"+(parseInt(t)-5e4)])&&(b+="DCCCNID"+(parseInt(t)-5e4)+"="+n.dsprof.Tables[0][C]["DCCCNID"+(parseInt(t)-5e4)].toString()+",")})):null!=n.dsprof&&n.dsprof.Tables.length>0&&n.dsprof.Columns[0].Contains("ProfileID")&&1==n.dsprof.Tables[0].length&&h.forEach((function(t){parseInt(t)>5e4&&n.dsprof.Columns[0].Contains("DCCCNID"+(parseInt(t)-5e4))&&""!=n.dsprof.Tables[0][0]["DCCCNID"+(parseInt(t)-5e4)].toString()&&(b+="DCCCNID"+(parseInt(t)-5e4)+"="+n.dsprof.Tables[0][0]["DCCCNID"+(parseInt(t)-5e4)].toString()+",")})),o+="<EXTRAXML> ",i.a.SessionManager.Preferences.ContainsKey("On")&&"True"==i.a.SessionManager.Preferences.On&&l>0&&!s.e.IsEmpty(n.PayTermsDataTable[e].DebitAccountID_Key)){var S=!1,d=i.a.rental.IsBillWiseAccount(parseInt(s.e.String(n.PayTermsDataTable[e].DebitAccountID_Key)));if(null!=d&&d.Tables.length>0&&d.Tables[0].length>0&&!s.e.IsEmpty(d.Tables[0][0].IsBillwise)&&(S=Object(r.j)(d.Tables[0][0].IsBillwise)),S){o+="<BillWise> ";var T=l;o+=' <Row DocSeqNo="'+2*C+'1" AccountID="'+s.e.String(n.PayTermsDataTable[e].DebitAccountID_Key),o+=104==n.CurrCostCenterID?'" AmountFC="-'+T+'" AdjAmount="-'+T+'"':'" AmountFC="'+T+'" AdjAmount="'+T+'"',o+=' AdjCurrID="1" ',o+='AdjExchRT="1" ',o+='IsNewReference="1" ',o+='Narration="" ',o+='IsDocPDC="0" ',o+=" ></Row>",o+=" </BillWise>"}}if(o+="</EXTRAXML> ",o+=" </Row>",o+='<Row><Transactions CONTRACTSNO="'+(e+1).toString()+'" ',o+='DocDetailsID="0" DocSeqNo="'+2*(C+1)+'" ',o+=104==n.CurrCostCenterID?'CreditAccount="-99" DebitAccount="'+s.e.String(n.RentRecAc.SelectedValue)+'" ':'DebitAccount="-99" CreditAccount="'+s.e.String(n.RentRecAc.SelectedValue)+'" ',o+='Amount="'+l+'" AmtFc="'+l+'" ',o+='ChequeDate = "'+a.ToString("dd/MMM/yyyy")+'" ChequeMaturityDate = "'+a.ToString("dd/MMM/yyyy")+'" ',o+=n.CurrencyContract.SelectedValue>0?'CurrencyID="'+n.CurrencyContract.SelectedValue+'" ':'CurrencyID="1" ',o+='ExchangeRate="1" CommonNarration="'+m.d.GetValidXml(s.e.String(n.PayTermsDataTable[e].Narration))+'" LineNarration="'+m.d.GetValidXml(s.e.String(n.PayTermsDataTable[e].Narration))+'"  ChequeBankName="'+m.d.GetValidXml(n.GetPayBank(s.e.String(n.PayTermsDataTable[e].PayeeBank)))+'" ChequeNumber="'+s.e.String(n.PayTermsDataTable[e].ChequeNo)+'" ',o+="></Transactions> ",u>1?h.forEach((function(t){parseInt(t)>5e4&&n.dsprof.Columns[0].Contains("DCCCNID"+(parseInt(t)-5e4))&&!s.e.IsEmpty(n.dsprof.Tables[0][C]["DCCCNID"+(parseInt(t)-5e4)])&&(b+="DCCCNID"+(parseInt(t)-5e4)+"="+n.dsprof.Tables[0][C]["DCCCNID"+(parseInt(t)-5e4)].toString()+",")})):null!=n.dsprof&&n.dsprof.Tables.length>0&&n.dsprof.Columns[0].Contains("ProfileID")&&1==n.dsprof.Tables[0].length&&h.forEach((function(t){parseInt(t)>5e4&&n.dsprof.Columns[0].Contains("DCCCNID"+(parseInt(t)-5e4))&&""!=n.dsprof.Tables[0][0]["DCCCNID"+(parseInt(t)-5e4)].toString()&&(b+="DCCCNID"+(parseInt(t)-5e4)+"="+n.dsprof.Tables[0][0]["DCCCNID"+(parseInt(t)-5e4)].toString()+",")})),o+=' <Numeric /> <Alpha /> <CostCenters   Query="'+n.strCCQry.toString()+b+'"  /> ',o+="<EXTRAXML> ",i.a.SessionManager.Preferences.ContainsKey("On")&&"True"==i.a.SessionManager.Preferences.On&&t&&l>0){o+="<BillWise> ";for(var y=l,g=0,I=0;I<n.DataTable.length;I++)if((s.e.IsEmpty(n.DataTable[I].DebitAccountID_Key)||!(parseInt(s.e.String(n.DataTable[I].DebitAccountID_Key))>0))&&!s.e.IsEmpty(n.DataTable[I].Amount)){var p=0;if(n.SingleInvoice&&n.DistribtueInvoice&&n.Invoiced>0){var A=n.Invoiced-n.ValueUsed;A>0&&(y>A?(y-=A,p=A):(p=y,y=0))}else{if((g+=parseFloat(s.e.String(n.DataTable[I].Amount)))<n.ValueUsed)continue;var f=g-n.ValueUsed;y>f?(y-=f,p=f):(p=y,y=0)}if(p>0&&(o+=' <Row DocSeqNo="'+2*(C+1)+'" AccountID="'+s.e.String(n.RentRecAc.SelectedValue),o+=104==n.CurrCostCenterID?'" AmountFC="'+y+'" AdjAmount="'+y+'"':'" AmountFC="-'+p+'" AdjAmount="-'+p+'"',o+=' AdjCurrID="1" ',o+='AdjExchRT="1" ',o+='IsNewReference="0" ',o+='Narration="" ',o+='IsDocPDC="0" ',o+='RefDocNo="'+(I+1).toString()+'" ',o+=" ></Row>",n.ValueUsed+=p),n.SingleInvoice&&n.DistribtueInvoice&&n.Invoiced>0&&y>0&&(o+=' <Row DocSeqNo="'+2*(C+1)+'" AccountID="'+s.e.String(n.RentRecAc.SelectedValue),o+=104==n.CurrCostCenterID?'" AmountFC="'+y+'" AdjAmount="'+y+'"':'" AmountFC="-'+y+'" AdjAmount="-'+y+'"',o+=' AdjCurrID="1" ',o+='AdjExchRT="1" ',o+='IsNewReference="1" ',o+='Narration="" ',o+='IsDocPDC="0" ',o+=" ></Row>",n.ValueUsed+=p,y=0),y<=0)break}o+=" </BillWise>"}o+="</EXTRAXML> ",o+=" </Row>"},b=0;b<u;b++)C(b);return o.toString()}},{key:"GetOpeningPayXML",value:function(){for(var t,e=0,a="",n=0;n<this.PayTermsDataTable.length;n++)if(!s.e.IsEmpty(this.PayTermsDataTable[n].DebitAccountID_Key)&&parseInt(this.PayTermsDataTable[n].DebitAccountID_Key)>0&&!s.e.IsEmpty(this.PayTermsDataTable[n].Amount)&&parseFloat(this.PayTermsDataTable[n].Amount.toString())>0){e++,t=new Date(this.PayTermsDataTable[n].CntrlDate_Key),a+='<ROWS><AccountType DD="OPB"></AccountType><Documents  DocID="'+s.e.StringValue(this.PayTermsDataTable[n].DocID)+'" DDate="'+this.ContractDate.Date.ToString("dd/MMM/yyyy")+'" /><DocumentXML>',a+='<Row><Transactions   CONTRACTSNO="'+(n+1).toString()+'" ',a+='DocDetailsID="0"  DocSeqNo="'+e+'" ',a+=104==this.CurrCostCenterID?'CreditAccount="'+s.e.StringValue(this.PayTermsDataTable[n].DebitAccountID_Key)+'" DebitAccount="-100" ':'DebitAccount="'+s.e.StringValue(this.PayTermsDataTable[n].DebitAccountID_Key)+'" CreditAccount="-100" ',(this.BankAccounts.Contains(s.e.StringValue(this.PayTermsDataTable[n].DebitAccountID_Key))||this.PDCAccounts.ContainsKey(s.e.StringValue(this.PayTermsDataTable[n].DebitAccountID_Key)))&&(""!=s.e.StringValue(this.PayTermsDataTable[n].OpPdcStatus)?a+=' OpPdcStatus="'+this.PayTermsDataTable[n].OpPdcStatus.toString()+'" ':a+=' OpPdcStatus="370" ',a+='Description="'+this.RentRecAc.SelectedValue+'" PostPDC="1" '),a+='Amount="'+parseFloat(this.PayTermsDataTable[n].Amount)+'"  AmtFc="'+parseFloat(this.PayTermsDataTable[n].Amount)+'" ',a+=' ChequeDate = "'+t.ToString("dd/MMM/yyyy")+'" ChequeMaturityDate = "'+t.ToString("dd/MMM/yyyy")+'" ',a+=this.CurrencyContract.SelectedValue>0?'CurrencyID="'+this.CurrencyContract.SelectedValue+'" ':'CurrencyID="1" ',a+='ExchangeRate="1" CommonNarration="'+m.d.GetValidXml(s.e.StringValue(this.PayTermsDataTable[n].Narration))+'" LineNarration="'+m.d.GetValidXml(this.PayTermsDataTable[n].Narration.toString())+'"  ChequeBankName="'+m.d.GetValidXml(this.GetPayBank(s.e.StringValue(this.PayTermsDataTable[n].PayeeBank)))+'" ChequeNumber="'+s.e.StringValue(this.PayTermsDataTable[n].ChequeNo)+'" ',a+="></Transactions> ";var r="";this.TempCCID>5e4&&!this.strCCQry.toString().Contains("dcCCNID"+(this.TempCCID-5e4).toString()+"=")&&(r=s.e.IsEmpty(this.PayTermsDataTable[n].TempCCID_Key)?" dcCCNID"+(this.TempCCID-5e4).toString()+"=1,":" dcCCNID"+(this.TempCCID-5e4).toString()+"="+this.PayTermsDataTable[n].TempCCID_Key.toString()+","),this.PayTermsDataTableColumns.Contains("Location_Key")&&!s.e.IsEmpty(this.PayTermsDataTable[n].Location_Key)?r+=" dcCCNID2="+this.PayTermsDataTable[n].Location_Key.toString()+",":this.LocationContract.Visible&&this.LocationContract.SelectedValue>0&&(r+=" dcCCNID2="+this.LocationContract.SelectedValue+","),this.PayTermsDataTableColumns.Contains("Dim_Key")&&!s.e.IsEmpty(this.PayTermsDataTable[n].Dim_Key)&&(r+=" dcCCNID"+(this.DimCCID-5e4).toString()+"="+this.PayTermsDataTable[n].Dim_Key.toString()+","),r+=this.GetSalemanXml(this.PayTermsDataTable[n]),this.multiVisi&&!this.strCCQry.toString().Contains("dcCCNID"+(this.UnitCCID-5e4).toString()+"=")&&(r+=" dcCCNID"+(this.UnitCCID-5e4).toString()+"="+this.UnitNodeID+","),this.PayTermsDataTableColumns.Contains("Particulars_Key")&&!s.e.IsEmpty(this.PayTermsDataTable[n].Particulars_Key)&&(r+=" dcCCNID"+(parseInt(i.a.SessionManager.Preferences.DepositLinkDimension)-5e4).toString()+"="+this.PayTermsDataTable[n].Particulars_Key.toString()+","),a+=' <Numeric /> <Alpha /> <CostCenters   Query="'+this.strCCQry.toString()+r+'"  /> ',a+="<EXTRAXML> ",a+="</EXTRAXML> ",a+=" </Row></DocumentXML></ROWS>"}return a.length>0&&(a="<PDR>"+a,a+="</PDR>"),a.toString()}},{key:"GetRecPayXML",value:function(t,e,a,n,r){var o=this,l="",c=0,u=parseFloat(s.e.String(this.PayTermsDataTable[e].Amount)),D=1;null!=this.dsprof&&this.dsprof.Tables.length>0&&this.dsprof.Columns[0].Contains("ProfileID")&&this.dsprof.Tables[0].length>0&&(D=this.dsprof.Tables[0].length);for(var h=0,C=i.a.SessionManager.Preferences.DistributeCostDims.split(","),b=function(b){D>1?(b+1==o.dsprof.Tables[0].length?c=parseFloat((u-h).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())):!s.e.IsEmpty(o.dsprof.Tables[0][b].Percent)&&parseFloat(o.dsprof.Tables[0][b].Percent.toString())>0?c=parseFloat((u*parseFloat(o.dsprof.Tables[0][b].Percent.toString())/100).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())):!s.e.IsEmpty(o.dsprof.Tables[0][b].Amount)&&parseFloat(o.dsprof.Tables[0][b].Amount.toString())>0&&(c=parseFloat(o.dsprof.Tables[0][b].Amount.toString())),h+=c):c=u,l+='<Row><Transactions   CONTRACTSNO="'+e+'1" ',n&&o.PayTermsDataTableColumns.Contains("AccDocDetailsid")&&""!=o.PayTermsDataTable[e].AccDocDetailsid.toString()&&o.PayTermsDataTableColumns.Contains("DocumentType")&&("19"==o.PayTermsDataTable[e].DocumentType.toString()||"369"==o.PayTermsDataTable[e].DocStatusID.toString()||"429"==o.PayTermsDataTable[e].DocStatusID.toString())?l+=' IgnoreEdit="1" DocDetailsID="'+o.PayTermsDataTable[e].AccDocDetailsid.toString()+'" ':l+=' DocDetailsID="0"',l+=o.SinglePDC&&n&&1==D?' DocSeqNo="'+r+'1" ':' DocSeqNo="'+b+'1" ',l+=104==o.CurrCostCenterID?'CreditAccount="'+s.e.String(o.PayTermsDataTable[e].DebitAccountID_Key)+'" DebitAccount="'+s.e.String(o.RentRecAc.SelectedValue)+'" ':'DebitAccount="'+s.e.String(o.PayTermsDataTable[e].DebitAccountID_Key)+'" CreditAccount="'+s.e.String(o.RentRecAc.SelectedValue)+'" ',l+='Amount="'+c+'"  AmtFc="'+c+'" ',l+=' ChequeDate = "'+a.ToString("dd/MMM/yyyy")+'" ChequeMaturityDate = "'+a.ToString("dd/MMM/yyyy")+'" ',l+=o.CurrencyContract.SelectedValue>0?'CurrencyID="'+o.CurrencyContract.SelectedValue+'" ':'CurrencyID="1" ',l+='ExchangeRate="1" CommonNarration="'+m.d.GetValidXml(s.e.String(o.PayTermsDataTable[e].Narration))+'" LineNarration="'+m.d.GetValidXml(s.e.String(o.PayTermsDataTable[e].Narration))+'"  ChequeBankName="'+m.d.GetValidXml(o.GetPayBank(s.e.String(o.PayTermsDataTable[e].PayeeBank)))+'" ChequeNumber="'+s.e.String(o.PayTermsDataTable[e].ChequeNo)+'" ',l+="></Transactions> ";var S=o.AddRowCC(o.PayTermsDataTable[e],null,0,0,o.PayTermsDataTable);if(S+=o.GetSalemanXml(o.PayTermsDataTable[e]),D>1?C.forEach((function(t){parseInt(t)>5e4&&o.dsprof.Columns[0].Contains("DCCCNID"+(parseInt(t)-5e4))&&!s.e.IsEmpty(o.dsprof.Tables[0][b]["DCCCNID"+(parseInt(t)-5e4)])&&(S+="DCCCNID"+(parseInt(t)-5e4)+"="+o.dsprof.Tables[0][b]["DCCCNID"+(parseInt(t)-5e4)].toString()+",")})):null!=o.dsprof&&o.dsprof.Tables.length>0&&o.dsprof.Columns[0].Contains("ProfileID")&&1==o.dsprof.Tables[0].length&&C.forEach((function(t){parseInt(t)>5e4&&o.dsprof.Columns[0].Contains("DCCCNID"+(parseInt(t)-5e4))&&""!=o.dsprof.Tables[0][0]["DCCCNID"+(parseInt(t)-5e4)].toString()&&(S+="DCCCNID"+(parseInt(t)-5e4)+"="+o.dsprof.Tables[0][0]["DCCCNID"+(parseInt(t)-5e4)].toString()+",")})),l+=' <Numeric /> <Alpha /> <CostCenters   Query="'+o.strCCQry.toString()+S+'"  /> ',l+="<EXTRAXML> ",i.a.SessionManager.Preferences.ContainsKey("On")&&"True"==i.a.SessionManager.Preferences.On&&t&&c>0){l+="<BillWise> ";for(var d=c,T=0,y=0;y<o.DataTable.length;y++)if((s.e.IsEmpty(o.DataTable[y].DebitAccountID_Key)||!(parseInt(o.DataTable[y].DebitAccountID_Key.toString())>0))&&!s.e.IsEmpty(o.DataTable[y].Amount)){var g=0;if(o.SingleInvoice&&o.DistribtueInvoice&&o.Invoiced>0){var I=o.Invoiced-o.ValueUsed;I>0&&(d>I?(d-=I,g=I):(g=d,d=0))}else{if((T+=parseFloat(s.e.String(o.DataTable[y].Amount)))<=o.ValueUsed)continue;var p=T-o.ValueUsed;d>p?(d-=p,g=p):(g=d,d=0)}if(g>0&&(l+=' <Row DocSeqNo="'+b+'1"  AccountID="'+s.e.String(o.RentRecAc.SelectedValue),l+=104==o.CurrCostCenterID?'" AmountFC="'+g+'" AdjAmount="'+g+'"':'" AmountFC="-'+g+'" AdjAmount="-'+g+'"',l+=' AdjCurrID="1" ',l+='AdjExchRT="1" ',l+='IsNewReference="0" ',l+='Narration="" ',l+='IsDocPDC="0" ',l+='RefDocNo="'+(y+1).toString()+'" ',l+=" ></Row>",o.ValueUsed+=g),o.SingleInvoice&&o.DistribtueInvoice&&o.Invoiced>0&&d>0&&(l+=' <Row DocSeqNo="'+b+'1" AccountID="'+s.e.String(o.RentRecAc.SelectedValue),l+=104==o.CurrCostCenterID?'" AmountFC="'+d+'" AdjAmount="'+d+'"':'" AmountFC="-'+d+'" AdjAmount="-'+d+'"',l+=' AdjCurrID="1" ',l+='AdjExchRT="1" ',l+='IsNewReference="1" ',l+='Narration="" ',l+='IsDocPDC="0" ',l+=" ></Row>",o.ValueUsed+=g,d=0),d<=0)break}l+=" </BillWise>"}l+="</EXTRAXML> ",l+=" </Row>"},S=0;S<D;S++)b(S);return l.toString()}},{key:"GetPDReceiptXML",value:function(t){Logger.InfoLog("AddEditRenContractViewModel ::Entering GetPDReceiptXML");var e,a,n,i="";104==this.CurrCostCenterID?(i+="<PDPayment>",n=0):(i+="<PDR>",n=95==this.CostCenterID&&(this.SinglePDC||this.IsOpening)?0:1);for(var r=new T.a,o=new T.a,l=new T.a,c=new T.a,u=new T.a;n<this.PayTermsDataTable.length;n++)!s.e.IsEmpty(this.PayTermsDataTable[n].DebitAccountID_Key)&&""!=s.e.StringValue(this.PayTermsDataTable[n].DebitAccountID_Key)&&parseInt(this.PayTermsDataTable[n].DebitAccountID_Key)>0&&!s.e.IsEmpty(this.PayTermsDataTable[n].Amount)&&""!=s.e.StringValue(this.PayTermsDataTable[n].Amount)&&parseFloat(this.PayTermsDataTable[n].Amount.toString())>0&&(e=new Date(this.PayTermsDataTable[n].CntrlDate_Key),a=95==this.CurrCostCenterID&&this.InclPostingDate&&""!=s.e.StringValue(this.PayTermsDataTable[n].PostingDate_Key)?new Date(this.PayTermsDataTable[n].PostingDate_Key.toString()):this.JVRecieptonPaymentDate?e:this.ContractDate.Date,this.BankAccounts.ContainsKey(this.PayTermsDataTable[n].DebitAccountID_Key.toString())||this.PDCAccounts.ContainsKey(this.PayTermsDataTable[n].DebitAccountID_Key.toString())?(this.PostBankRct&&"cash"==this.GetPayBank(this.PayTermsDataTable[n].PayeeBank.toString()).toLowerCase()?i+='<ROWS><AccountType DD="Rct"></AccountType><Documents  DDate="':i+='<ROWS><AccountType DD="BANK"></AccountType><Documents  DDate="',95==this.CurrCostCenterID&&this.InclPostingDate&&""!=s.e.StringValue(this.PayTermsDataTable[n].PostingDate_Key)?i+=new Date(this.PayTermsDataTable[n].PostingDate_Key.toString()).ToString("dd/MMM/yyyy"):i+=this.ContractDate.Date.ToString("dd/MMM/yyyy"),i+='"  DocID="'+s.e.StringValue(this.PayTermsDataTable[n].DocID)+'"></Documents><DocumentXML>',this.strType=!0,95==this.CostCenterID&&this.SinglePDC&&(this.PostBankRct&&"cash"==this.GetPayBank(this.PayTermsDataTable[n].PayeeBank.toString()).toLowerCase()?(c.ContainsKey(a)||c.push(a,""),c[a]+=this.GetRecPayXML(t,n,e,!1,1)):(o.ContainsKey(a)||(o.push(a,""),u.push(a,0)),o[a]+=this.GetRecPayXML(t,n,e,!0,u[a]),u[a]++))):this.CashAccounts.ContainsKey(this.PayTermsDataTable[n].DebitAccountID_Key.toString())?(i+='<ROWS><AccountType DD="CASH"></AccountType><Documents  DDate="',95==this.CurrCostCenterID&&this.InclPostingDate&&""!=s.e.StringValue(this.PayTermsDataTable[n].PostingDate_Key)?i+=new Date(this.PayTermsDataTable[n].PostingDate_Key.toString()).ToString("dd/MMM/yyyy"):i+=this.JVRecieptonPaymentDate?e.ToString("dd/MMM/yyyy"):this.ContractDate.Date.ToString("dd/MMM/yyyy"),i+='"  DocID="'+s.e.StringValue(this.PayTermsDataTable[n].DocID)+'"></Documents><DocumentXML>',this.strType=!0,95==this.CostCenterID&&this.SinglePDC&&(l.ContainsKey(a)||l.push(a,""),l[a]+=this.GetRecPayXML(t,n,e,!1,1))):(i+='<ROWS><AccountType DD="JV"></AccountType><Documents  DDate="',95==this.CurrCostCenterID&&this.InclPostingDate&&""!=s.e.StringValue(this.PayTermsDataTable[n].PostingDate_Key)?i+=new Date(this.PayTermsDataTable[n].PostingDate_Key.toString()).ToString("dd/MMM/yyyy"):i+=this.JVRecieptonPaymentDate?e.ToString("dd/MMM/yyyy"):this.ContractDate.Date.ToString("dd/MMM/yyyy"),i+='"  DocID="'+s.e.StringValue(this.PayTermsDataTable[n].DocID)+'"></Documents><DocumentXML>',this.strType=!1,95==this.CostCenterID&&this.SinglePDC&&(r.ContainsKey(a)||r.push(a,""),r[a]+=this.GetJVPayXML(t,n,e))),95==this.CostCenterID&&this.SinglePDC||(i+=this.strType?this.GetRecPayXML(t,n,e,!1,1):this.GetJVPayXML(t,n,e)),i+='</DocumentXML><ChequeDocDate DD="'+e.ToString("dd/MMM/yyyy")+'"></ChequeDocDate></ROWS>');if(95==this.CostCenterID&&this.SinglePDC){i="",i+="<PDR>";for(var D=0;D<o.length;D++)console.log(o),i+='<ROWS><AccountType DD="BANK"></AccountType><Documents  DDate="',i+=o.ElementAt(D).Key.ToString("dd/MMM/yyyy"),i+='"  DocID="0"></Documents>',i+='<DocumentXML IgnoreConvertedPDC="1" >',i+=o.ElementAt(D).Value.toString(),i+="</DocumentXML>",i+='<ChequeDocDate DD="'+o.ElementAt(D).Key.ToString("dd/MMM/yyyy")+'"></ChequeDocDate></ROWS>';if(this.PostBankRct)for(var h=0;h<c.length;h++)console.log(c),i+='<ROWS><AccountType DD="Rct"></AccountType><Documents  DDate="',i+=c.ElementAt(h).Key.ToString("dd/MMM/yyyy"),i+='"  DocID="0"></Documents>',i+="<DocumentXML >",i+=c.ElementAt(h).Value.toString(),i+="</DocumentXML>",i+='<ChequeDocDate DD="'+c.ElementAt(h).Key.ToString("dd/MMM/yyyy")+'"></ChequeDocDate></ROWS>';for(var C=0;C<l.length;C++)console.log(l),i+='<ROWS><AccountType DD="CASH"></AccountType><Documents  DDate="',i+=l.ElementAt(C).Key.ToString("dd/MMM/yyyy"),i+='"  DocID="0"></Documents>',i+="<DocumentXML>",i+=l.ElementAt(C).Value.toString(),i+="</DocumentXML>",i+='<ChequeDocDate DD="'+l.ElementAt(C).Key.ToString("dd/MMM/yyyy")+'"></ChequeDocDate></ROWS>';for(var m=0;m<r.length;m++)console.log(r),i+='<ROWS><AccountType DD="JV"></AccountType><Documents  DDate="',i+=r.ElementAt(m).Key.ToString("dd/MMM/yyyy"),i+='"  DocID="0"></Documents>',i+="<DocumentXML>",i+=r.ElementAt(m).Value.toString(),i+="</DocumentXML>",i+='<ChequeDocDate DD="'+r.ElementAt(m).Key.ToString("dd/MMM/yyyy")+'"></ChequeDocDate></ROWS>';i+="</PDR>"}else i+=104==this.CurrCostCenterID?"</PDPayment>":"</PDR>";return Logger.InfoLog("AddEditRenContractViewModel ::Exiting GetPDReceiptXML"),i.toString()}},{key:"GetPayBank",value:function(t){if(!s.e.IsEmpty(t)){var e=this.ContractPayTerms.find((function(t){return"PayNodeID"==t.DisplayMember}));if(null!=e&&e.ComboData instanceof DataView){var a=e.ComboData.filter((function(e){return e.PayeeBank==t}));if(a.length>0)return a[0].PayNodeID.toString()}return t}}},{key:"GetPartReceiptXML",value:function(t){var e=this,a="",n=null;Logger.InfoLog("AddEditRenContractViewModel ::Entering GetPartReceiptXML"),a+="<PARTICULARS>";for(var r=1;r<this.DataTable.length;r++){if(!s.e.IsEmpty(this.DataTable[r].DebitAccountID_Key)&&""!=s.e.StringValue(this.DataTable[r].DebitAccountID_Key)&&parseInt(this.DataTable[r].DebitAccountID_Key.toString())>0&&!s.e.IsEmpty(this.DataTable[r].Amount)&&""!=s.e.StringValue(this.DataTable[r].Amount)&&parseFloat(this.DataTable[r].Amount.toString())>0)if("continue"===function(){if("True"==s.e.StringValue(e.DataTable[r].PostDebit))return"continue";s.e.IsEmpty(e.DataTable[r].CntrlDate_Key)||""==e.DataTable[r].CntrlDate_Key.toString()||(n=new Date(e.DataTable[r].CntrlDate_Key)),e.BankAccounts.ContainsKey(s.e.StringValue(e.DataTable[r].DebitAccountID_Key))?a+='<ROWS><AccountType DD="BANK"></AccountType><Documents DocID="'+s.e.StringValue(e.DataTable[r].DocID)+'"></Documents><DocumentXML>':a+='<ROWS><AccountType DD="CASH"></AccountType><Documents DocID="'+s.e.StringValue(e.DataTable[r].DocID)+'"></Documents><DocumentXML>';var o=1,l=null;if(""!=s.e.StringValue(e.DataTable[r].Xml)&&e.multiVisi){var c=new s.f;c.LoadXml(e.DataTable[r].Xml.toString()),c.DocumentElement.children.length>0&&null!=c.DocumentElement.children[0].attributes&&null!=c.DocumentElement.children[0].attributes.Filter&&!s.e.StringIsNullOrEmpty(c.DocumentElement.children[0].attributes.Filter.value)&&(0!=parseInt(c.DocumentElement.children[0].attributes.Filter.value)&&1!=parseInt(c.DocumentElement.children[0].attributes.Filter.value)||(o=e.SelectedUnits.split(",").length,l=0==parseInt(c.DocumentElement.children[0].attributes.Filter.value)?c.SelectNodes("XML/UnitsRow"):c.SelectNodes("XML/Row"),null==e.MultiNode&&(e.MultiNode=i.a.rental.GetUnitNodeIDs(e.SelectedUnits))))}for(var u=function(c){a+='<Row><Transactions  CONTRACTSNO="'+(r+1).toString()+'" ',a+=' DocDetailsID="0"  DocSeqNo="1" ',a+=104==e.CurrCostCenterID?'CreditAccount="'+s.e.StringValue(e.DataTable[r].DebitAccountID_Key)+'" DebitAccount="'+e.RentRecAc.SelectedValue+'" ':e.DontpostSIV?'DebitAccount="'+s.e.StringValue(e.DataTable[r].DebitAccountID_Key)+'" CreditAccount="'+s.e.StringValue(e.DataTable[r].CreditAccountID_Key)+'" ':'DebitAccount="'+s.e.StringValue(e.DataTable[r].DebitAccountID_Key)+'" CreditAccount="'+e.RentRecAc.SelectedValue+'" ',null!=l&&o>1&&l.length>c&&null!=l[c].attributes.Amount&&!s.e.StringIsNullOrEmpty(l[c].attributes.Amount.value)?a+='Amount="'+parseFloat(l[c].attributes.Amount.value)+'" AmtFc="'+parseFloat(l[c].attributes.Amount.value)+'" ':a+='Amount="'+parseFloat(e.DataTable[r].Amount)+'" AmtFc="'+parseFloat(e.DataTable[r].Amount)+'" ',s.e.IsEmpty(n)||s.e.IsEmpty(e.DataTable[r].ChequeNo)||!s.e.StringValue(e.DataTable[r].ChequeNo)||s.e.IsEmpty(e.DataTable[r].PayeeBank)||""==s.e.StringValue(e.DataTable[r].PayeeBank)?(!s.e.IsEmpty(n)&&e.CurrencyContract.SelectedValue>0?a+='ChequeDate = "'+n.Value.ToString("dd/MMM/yyyy")+'" ChequeMaturityDate = "'+n.Value.ToString("dd/MMM/yyyy")+'" ':a+='ChequeDate = "" ChequeMaturityDate = "" ',e.CurrencyContract.SelectedValue>0?a+='CurrencyID="'+e.CurrencyContract.SelectedValue+'" ':s.e.IsEmpty(n)||(a+='CurrencyID="1" '),a+='ExchangeRate="1"  ChequeBankName="" ChequeNumber="" '):(a+='ChequeDate = "'+n.Value.ToString("dd/MMM/yyyy")+'" ChequeMaturityDate = "'+n.Value.ToString("dd/MMM/yyyy")+'" ',a+=e.CurrencyContract.SelectedValue>0?'CurrencyID="'+e.CurrencyContract.SelectedValue+'" ':'CurrencyID="1" ',a+='ExchangeRate="1"  ChequeBankName="'+m.d.GetValidXml(e.GetPayBank(e.DataTable[r].PayeeBank.toString()))+'" ChequeNumber="'+s.e.StringValue(e.DataTable[r].ChequeNo)+'" '),a+=' CommonNarration="'+m.d.GetValidXml(s.e.StringValue(e.DataTable[r].Narration))+'" LineNarration="'+m.d.GetValidXml(s.e.StringValue(e.DataTable[r].Narration))+'" ',a+="></Transactions> ";var u="";if(e.TempCCID>5e4&&!e.strCCQry.toString().Contains("dcCCNID"+(e.TempCCID-5e4).toString()+"=")&&(u=""!=s.e.StringValue(e.DataTable[r].TempCCID_Key)?" dcCCNID"+(e.TempCCID-5e4).toString()+"="+e.DataTable[r].TempCCID_Key.toString()+",":" dcCCNID"+(e.TempCCID-5e4).toString()+"=1,"),e.DataTableColumns.Contains("Location_Key")&&""!=s.e.StringValue(e.DataTable[r].Location_Key)?u+=" dcCCNID2="+e.DataTable[r].Location_Key.toString()+",":e.LocationContract.Visible&&e.LocationContract.SelectedValue>0&&(u+=" dcCCNID2="+e.LocationContract.SelectedValue+","),e.DataTableColumns.Contains("Dim_Key")&&""!=s.e.StringValue(e.DataTable[r].Dim_Key)&&(u+=" dcCCNID"+(e.DimCCID-5e4).toString()+"="+e.DataTable[r].Dim_Key.toString()+","),u+=e.GetSalemanXml(e.DataTable[r]),e.multiVisi&&!e.strCCQry.toString().Contains("dcCCNID"+(e.UnitCCID-5e4).toString()+"="))if(null!=l&&o>1&&l.length>c&&null!=l[c].attributes.Unit&&!s.e.StringIsNullOrEmpty(l[c].attributes.Unit.value)){var D=e.MultiNode.filter((function(t){return t.UnitID==l[c].attributes.Unit.value}));D.length>0&&(u+=" dcCCNID"+(e.UnitCCID-5e4).toString()+"="+D[0].nodeid.toString()+",")}else u+=" dcCCNID"+(e.UnitCCID-5e4).toString()+"="+e.UnitNodeID+",";a+=' <Numeric /> <Alpha /> <CostCenters   Query="'+e.strCCQry.toString()+u+'"  /> ',a+="<EXTRAXML> ",i.a.SessionManager.Preferences.ContainsKey("On")&&"True"==i.a.SessionManager.Preferences.On&&t&&""!=s.e.StringValue(e.DataTable[r].Amount)&&(a+='<BillWise> <Row DocSeqNo="1" AccountID="'+e.RentRecAc.SelectedValue.toString(),a+=104==e.CurrCostCenterID?'" AmountFC="'+e.DataTable[r].Amount.toString()+'" AdjAmount="'+e.DataTable[r].Amount.toString()+'"':'" AmountFC="-'+e.DataTable[r].Amount.toString()+'" AdjAmount="-'+e.DataTable[r].Amount.toString()+'"',a+=' AdjCurrID="1" ',a+='AdjExchRT="1" ',a+='IsNewReference="0" ',a+='Narration="" ',a+='IsDocPDC="0" ',a+='RefDocNo="'+(r+1).toString()+'" ',a+=" ></Row></BillWise>"),a+="</EXTRAXML> ",a+=" </Row>"},D=0;D<o;D++)u(D);var h=new Date;s.e.IsEmpty(n)?a+='</DocumentXML><ChequeDocDate DD="'+h.ToString("dd/MMM/yyyy")+'"></ChequeDocDate></ROWS>':a+='</DocumentXML><ChequeDocDate DD="'+n.Value.ToString("dd/MMM/yyyy")+'"></ChequeDocDate></ROWS>'}())continue}return a+="</PARTICULARS>",Logger.InfoLog("AddEditRenContractViewModel ::Exiting GetPartReceiptXML"),a.toString()}},{key:"GetOpeningSales",value:function(){var t="",e=0;Logger.InfoLog("AddEditRenContractViewModel ::Entering GetOpeningSales"),t+="<DocumentXML >";for(var a=0;a<this.DataTable.length;a++)if(!s.e.IsEmpty(this.DataTable[a].Amount)&&parseFloat(this.DataTable[a].Amount.toString())>0){t+='<Row><Transactions   CONTRACTSNO="'+ ++e+'" ',t+='DocDetailsID="0"  BillDate="'+this.ContractDate.Date.ToString("dd/MMM/yyyy")+'"  DocSeqNo="'+e+'"  ',t+=this.CurrencyContract.SelectedValue>0?'CurrencyID="'+this.CurrencyContract.SelectedValue+'" ':'CurrencyID="1" ',t+='ExchangeRate="1" ',104==this.CurrCostCenterID?t+=' CreditAccount="-100" DebitAccount ="'+s.e.StringValue(this.DataTable[a].CreditAccountID_Key)+'" ':(t+=' CreditAccount="'+s.e.StringValue(this.DataTable[a].CreditAccountID_Key)+'" ',t+=' DebitAccount ="-100" '),t+='  CommonNarration="'+m.d.GetValidXml(s.e.StringValue(this.DataTable[a].Narration))+'"  ',t+=' Amount="'+this.DataTable[a].Amount.toString().Replace(",",""),t+='" LineNarration="'+m.d.GetValidXml(s.e.String(this.Narration.Text))+'" ',t+="></Transactions> ";var n="";this.TempCCID>5e4&&!this.strCCQry.toString().Contains("dcCCNID"+(this.TempCCID-5e4).toString()+"=")&&(s.e.IsEmpty(this.DataTable[a].TempCCID_Key)?n+=" dcCCNID"+(this.TempCCID-5e4).toString()+"=1,":n+=" dcCCNID"+(this.TempCCID-5e4).toString()+"="+s.e.StringValue(this.DataTable[a].TempCCID_Key)+","),this.DataTableColumns.Contains("Location_Key")&&!s.e.IsEmpty(this.DataTable[a].Location_Key)?n+=" dcCCNID2="+this.DataTable[a].Location_Key.toString()+",":this.LocationContract.Visible&&this.LocationContract.SelectedValue>0&&(n+=" dcCCNID2="+this.LocationContract.SelectedValue+","),i.a.SessionManager.Preferences.ContainsKey("DepositLinkDimension")&&""!=i.a.SessionManager.Preferences.DepositLinkDimension&&parseInt(i.a.SessionManager.Preferences.DepositLinkDimension)>0&&(n+=" dcCCNID"+(parseInt(i.a.SessionManager.Preferences.DepositLinkDimension)-5e4).toString()+"="+this.DataTable[a].NodeID.toString()+","),s.e.IsEmpty(this.DataTable[a].TaxCategory_Key)||(n+=" dcCCNID60="+this.DataTable[a].TaxCategory_Key.toString()+","),this.DataTableColumns.Contains("SPType_Key")&&!s.e.IsEmpty(this.DataTable[a].SPType_Key)&&(n+=" dcCCNID61="+this.DataTable[a].SPType_Key.toString()+","),this.DataTableColumns.Contains("Dim_Key")&&!s.e.IsEmpty(this.DataTable[a].Dim_Key)&&(n+=" dcCCNID"+(this.DimCCID-5e4).toString()+"="+this.DataTable[a].Dim_Key.toString()+","),n+=this.GetSalemanXml(this.DataTable[a]),t+=' <Numeric Query="',t+='" /> <Alpha />',t+=' <CostCenters   Query="'+this.strCCQry.toString()+n+'"  /> <EXTRAXML/> ',t+=" </Row>"}return t+="</DocumentXML >",Logger.InfoLog("AddEditRenContractViewModel ::Exiting GetOpeningSales"),t.toString()}},{key:"GetWhere",value:function(t,e){if(this.TenantCCID==t)return" and DCCCNID"+(t-5e4)+"="+e[0].TenantID.toString();if(this.UnitCCID==t)return" and DCCCNID"+(t-5e4)+"="+e[0].UnitID.toString();if(this.PropertyCCID==t)return" and DCCCNID"+(t-5e4)+"="+e[0].PropertyID.toString();if(this.Landlord.CCID==t)return" and DCCCNID"+(t-5e4)+"="+this.Landlord.SelectedValue.toString();if(this.Salesman.CCID==t)return" and DCCCNID"+(t-5e4)+"="+this.Salesman.SelectedValue.toString();if(this.Accountant.CCID==t)return" and DCCCNID"+(t-5e4)+"="+this.Accountant.SelectedValue.toString();var a=this.ScreenObject.GetCustomCCField_1(t);return null!=a?" and DCCCNID"+(t-5e4)+"="+a.SelectedValue.toString():""}},{key:"FillCostPosting",value:function(t,e,a,n,r,o,l,c,u,D,h){var C=this,b=arguments.length>11&&void 0!==arguments[11]?arguments[11]:null;if(h.CostXML1="",!(i.a.SessionManager.Preferences.ContainsKey("DistributeCost")&&"True"==i.a.SessionManager.Preferences.DistributeCost&&i.a.SessionManager.Preferences.ContainsKey("CostBasedON")&&"True"==i.a.SessionManager.Preferences.CostBasedON&&i.a.SessionManager.Preferences.ContainsKey("CostBasedONDims")&&""!=i.a.SessionManager.Preferences.CostBasedONDims))return!1;if(this.dsprof=this.GetCostingds(t,e,a,o),null!=this.dsprof&&this.dsprof.Tables.length>0&&this.dsprof.Columns[0].Contains("ProfileID")&&this.dsprof.Tables[0].length>0){for(var S="",d=0,T=i.a.SessionManager.Preferences.DistributeCostDims.split(","),y=!1,g=function(t){var i=0;!s.e.IsEmpty(C.dsprof.Tables[0][t].Percent)&&parseFloat(C.dsprof.Tables[0][t].Percent.toString())>0?(i=parseFloat((n*parseFloat(C.dsprof.Tables[0][t].Percent.toString())/100).ToString("N"+l)),y=!0):!s.e.IsEmpty(C.dsprof.Tables[0][t].Amount)&&parseFloat(C.dsprof.Tables[0][t].Amount.toString())>0&&(i=parseFloat(C.dsprof.Tables[0][t].Amount.toString())),i>0&&(y&&t+1==C.dsprof.Tables[0].length&&(i=parseFloat((n-d).ToString("N"+l))),d+=i,S+="<RowHead/>",S+='<Row><Transactions DocDetailsID="0" IsQtyIgnored="1" DocSeqNo="50" ',S+='Quantity="" UOMConversion="1" UOMConvertedQty="1" Unit="1" Rate="'+i+'" ',S+=' CurrencyID="1" ExchangeRate="1" ',S+='Gross="'+i+'" StockValue="'+i.ToString("N"+l).Replace(",","")+'" ',S+=' StockValueFC="'+i+'" ',S+=' DynamicInvDocDetailsID="-1" ProductID="'+C.ProductID+'" CommonNarration="'+m.d.GetValidXml(s.e.StringValue(["Narration"]))+'"  ',S+=null!=c&&u>1&&c.length>D&&null!=c[D].attributes.Narration?' LineNarration="'+m.d.GetValidXml(c[D].attributes.Narration.value)+'" ':' LineNarration="'+m.d.GetValidXml(s.e.StringValue(r.Narration))+'" ',S+='  CreditAccount="'+a+'" ',S+='  DebitAccount="'+e.toString()+'" ',S+=" ></Transactions>",S+="<AccountsXML><Accounts ",S+=' CreditAccount="'+a+'" ',S+='  DebitAccount="'+e.toString()+'" ',S+=' CurrencyID="1" ExchangeRate="1" ',S+='Amount="'+i.ToString("N"+l).Replace(",","")+'" AmtFc="'+i+'" ></Accounts></AccountsXML>',S+="<EXTRAXML></EXTRAXML>",S+="<Numeric /><Alpha />",S+='<CostCenters Query="'+C.strCCQry.toString(),T.forEach((function(e){parseInt(e)>5e4&&C.dsprof.Columns[0].Contains("DCCCNID"+(parseInt(e)-5e4))&&!s.e.IsEmpty(C.dsprof.Tables[0][t]["DCCCNID"+(parseInt(e)-5e4)])&&(S+="DCCCNID"+(parseInt(e)-5e4)+"="+C.dsprof.Tables[0][t]["DCCCNID"+(parseInt(e)-5e4)].toString()+",")})),S+='" ></CostCenters>',S+="</Row>")},I=0;I<this.dsprof.Tables[0].length;I++)g(I);if((d=n-d)>.01){S+="<RowHead/>",S+='<Row><Transactions DocDetailsID="0" IsQtyIgnored="1" DocSeqNo="50" ',S+='Quantity="" UOMConversion="1" UOMConvertedQty="1" Unit="1" Rate="'+d+'" ',S+=' CurrencyID="1" ExchangeRate="1" ',S+='Gross="'+d+'" StockValue="'+d.ToString("N"+l).Replace(",","")+'" ',S+=' StockValueFC="'+d+'" ',S+=' DynamicInvDocDetailsID="-1" ProductID="'+this.ProductID+'"  CommonNarration="'+m.d.GetValidXml(r.Narration.toString())+'"  ',S+=null!=c&&u>1&&c.length>D&&null!=c[D].attributes.Narration?' LineNarration="'+m.d.GetValidXml(c[D].attributes.Narration.value)+'" ':' LineNarration="'+m.d.GetValidXml(r.Narration.toString())+'" ',S+='  CreditAccount="'+a+'" ',S+='  DebitAccount="'+e.toString()+'" ',S+=" ></Transactions>",S+="<AccountsXML><Accounts ",S+=' CreditAccount="'+a+'" ',S+='  DebitAccount="'+e.toString()+'" ',S+=' CurrencyID="1" ExchangeRate="1" ',S+='Amount="'+d.ToString("N"+l).Replace(",","")+'" AmtFc="'+d+'" ></Accounts></AccountsXML>',S+="<EXTRAXML></EXTRAXML>",S+="<Numeric /><Alpha />";this.AddRowCC(r,c,u,D,b);this.GetSalemanXml(r),S+='<CostCenters Query="'+this.strCCQry.toString(),S+='" ></CostCenters>',S+="</Row>"}return h.CostXML1=S.toString(),!0}return!1}},{key:"AddRowCC",value:function(t,e,a,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o="";if(this.TempCCID>5e4&&!this.strCCQry.toString().Contains("dcCCNID"+(this.TempCCID-5e4).toString()+"=")&&(Object.keys(t).Contains("dcCCNID"+(this.TempCCID-5e4).toString())&&""!=t["dcCCNID"+(this.TempCCID-5e4)].toString()?o+=" dcCCNID"+(this.TempCCID-5e4).toString()+"="+t["dcCCNID"+(this.TempCCID-5e4)].toString()+",":Object.keys(t).Contains("TempCCID_Key")&&!s.e.IsEmpty(t.TempCCID_Key)?o+=" dcCCNID"+(this.TempCCID-5e4).toString()+"="+t.TempCCID_Key.toString()+",":o+=" dcCCNID"+(this.TempCCID-5e4).toString()+"=1,"),this.DimCCID>0&&50002==this.DimCCID||(Object.keys(t).Contains("dcCCNID2")&&!s.e.IsEmpty(t.dcCCNID2)?o+=" dcCCNID2="+t.dcCCNID2.toString()+",":Object.keys(t).Contains("Location_Key")&&!s.e.IsEmpty(t.Location_Key)?o+=" dcCCNID2="+t.Location_Key.toString()+",":this.LocationContract.Visible&&this.LocationContract.SelectedValue>0&&(o+=" dcCCNID2="+this.LocationContract.SelectedValue+",")),this.PayTermsDataTable.filter((function(e){return e==t}))?this.PayTermsDataTableColumns.Contains("Particulars_Key")&&""!=s.e.String(t.Particulars_Key)&&(o+=" dcCCNID"+(parseInt(i.a.SessionManager.Preferences.DepositLinkDimension)-5e4).toString()+"="+t.Particulars_Key.toString()+","):i.a.SessionManager.Preferences.ContainsKey("DepositLinkDimension")&&""!=i.a.SessionManager.Preferences.DepositLinkDimension&&parseInt(i.a.SessionManager.Preferences.DepositLinkDimension)>0&&Object.keys(t).Contains("NodeID")&&(o+=" dcCCNID"+(parseInt(i.a.SessionManager.Preferences.DepositLinkDimension)-5e4).toString()+"="+t.NodeID.toString()+","),Object.keys(t).Contains("TaxCategory_Key")&&!s.e.IsEmpty(t.TaxCategory_Key)&&(o+=" dcCCNID60="+t.TaxCategory_Key.toString()+","),Object.keys(t).Contains("dcCCNID61")&&!s.e.IsEmpty(t.dcCCNID61)?o+=" dcCCNID61="+t.dcCCNID61.toString()+",":Object.keys(t).Contains("SPType_Key")&&!s.e.IsEmpty(t.SPType_Key)&&(o+=" dcCCNID61="+t.SPType_Key.toString()+","),Object.keys(t).Contains("Dim_Key")&&!s.e.IsEmpty(t.Dim_Key)?o+=" dcCCNID"+(this.DimCCID-5e4).toString()+"="+t.Dim_Key.toString()+",":this.DimCCID>5e4&&Object.keys(t).Contains("dcCCNID"+(this.DimCCID-5e4).toString())&&""!=t[" dcCCNID"+(this.DimCCID-5e4).toString()].toString()&&(o+=" dcCCNID"+(this.DimCCID-5e4).toString()+"="+t[" dcCCNID"+(this.DimCCID-5e4).toString()].toString()+","),this.multiVisi&&!this.strCCQry.toString().Contains("dcCCNID"+(this.UnitCCID-5e4).toString()+"="))if(null!=e&&a>1&&e.length>n&&null!=e[n].attributes.Unit&&!s.e.IsEmpty(e[n].attributes.Unit.value)){var l=this.MultiNode.filter((function(t){return t.UnitID==e[n].attributes.Unit.value}));l.length>0&&(o+=" dcCCNID"+(this.UnitCCID-5e4).toString()+"="+l[0].nodeid.toString()+",")}else o+=" dcCCNID"+(this.UnitCCID-5e4).toString()+"="+this.UnitNodeID+",";if(r==this.DataTable)for(var c=0;c<this.ContractParticular.length;c++)this.ContractParticular[c].DisplayMember.startsWith("CCNID")&&this.DataTableColumns.Contains(this.ContractParticular[c].ValueMember)&&""!=t[this.ContractParticular[c].ValueMember].toString()&&(o+=" dc"+this.ContractParticular[c].DisplayMember+"="+t[this.ContractParticular[c].ValueMember].toString()+",");else if(r==this.PayTermsDataTable)for(var u=0;u<this.ContractPayTerms.length;u++)this.ContractPayTerms[u].DisplayMember.startsWith("CCNID")&&this.PayTermsDataTableColumns.Contains(this.ContractPayTerms[u].ValueMember)&&""!=t[this.ContractPayTerms[u].ValueMember].toString()&&(o+=" dc"+this.ContractPayTerms[u].DisplayMember+"="+t[this.ContractPayTerms[u].ValueMember].toString()+",");return o}},{key:"GetSalesInvXML",value:function(t,e){if(this.IsRecurPosted){if(i.a.SessionManager.Preferences.ContainsKey("DistributeCost")&&"True"==i.a.SessionManager.Preferences.DistributeCost&&i.a.SessionManager.Preferences.ContainsKey("CostBasedON")&&"True"==i.a.SessionManager.Preferences.CostBasedON&&i.a.SessionManager.Preferences.ContainsKey("CostBasedONDims")&&""!=i.a.SessionManager.Preferences.CostBasedONDims&&(this.dsprof=this.GetCostingds(e,"0","0",this.costDims)),this.SingleInvoice&&this.DistribtueInvoice&&this.DataTable.length>0&&!s.e.IsEmpty(this.DataTable[0].DocumentNo)){var a=i.a.rental.GetAmtByVoucherNo(s.e.String(this.DataTable[0].DocumentNo));this.Invoiced=s.e.IntTryParse(a)}return""}var n="",o="",l=1,c=0;this.Invoiced=0,Logger.InfoLog("AddEditRenContractViewModel ::Entering GetSalesInvXML"),o+=104==this.CurrCostCenterID?"<PIV>":"<SIV>";var u,D=!1,h=new s.f,C=1,b=0,S=null,d=this.ScreenObject.Data.Tables[5].find((function(t){return"DistStartDate"==t.Name}));u=!!(d.length>0&&Object(r.j)(d[0].Value.toString()))&&Object(r.j)(d[0].Value),this.DistribtueInvoice&&this.DataTable.length>0&&!s.e.IsEmpty(this.DataTable[0].Xml)&&"true"==s.e.String(this.DataTable[0].RecurInvoice.toLowerCase())&&(h.LoadXml(this.DataTable[0].Xml.toString()),h.DocumentElement.children.length>0&&null!=h.DocumentElement.children[0].attributes&&null!=h.DocumentElement.children[0].attributes.Filter&&!s.e.StringIsNullOrEmpty(h.DocumentElement.children[0].attributes.Filter.value)&&(b=parseInt(h.DocumentElement.children[0].attributes.Filter.value)),1!=b&&(this.multiVisi&&0==b?(C=h.DocumentElement.children[0].children[0].children.length,S=h.DocumentElement.children[0].children[0].children):(C=h.DocumentElement.children[0].children.length,S=h.DocumentElement.children[0].children)));var T=0;s.e.IsEmpty(this.RecurDuration.Text)||(T=parseInt(this.RecurDuration.Text));for(var y=0;y<C;y++){var g=void 0,I=new Date,p=new Date;C>1?(s.e.isValidDate(S[y].attributes.FromDate.value)&&(I=new Date(S[y].attributes.FromDate.value)),s.e.isValidDate(S[y].attributes.ToDate.value)&&(p=new Date(S[y].attributes.ToDate.value)),null==S[y].attributes.Distribute||s.e.IsEmpty(S[y].attributes.Distribute.value)||(T=parseInt(S[y].attributes.Distribute.value))):I=u&&this.StartDate.Date?this.StartDate.Date:this.ContractDate.Date,g=this.DimCCID>5e4?this.DataTable.filter((function(t){return t.Amount>0}),"Dim_Key desc,SNO"):this.DataTable;var A="";c=0;for(var f=0;f<g.length;f++)if(!s.e.IsEmpty(g[f].Amount)&&parseFloat(g[f].Amount.toString())>0){if(f>0&&"True"!=s.e.String(g[f].PostDebit)&&this.DontpostSIV&&!s.e.IsEmpty(g[f].DebitAccountID_Key)&&parseInt(g[f].DebitAccountID_Key.toString())>0)continue;if(c++,this.DimCCID>5e4){if(A!=s.e.String(g[f].Dim_Key)||0==f){if(c>1){if(o+="</DocumentXML>",D){var P=void 0;P=C>1?this.CalculateMonths_1(I,p):s.e.IntTryParse(Math.floor(this.CalculateMonths())),(P/=T)<1&&(P=1),o+="<recurXML>";var N=1;for(y>0&&(N=0);N<T;N++)o+='<Row Date="'+I.AddMonths(P*N).ToString("dd/MMM/yyyy")+'" Seq="'+N+'" />';o+="</recurXML>"}o+="</ROWS>",D=!1}o+='<ROWS DimID="'+s.e.String(g[f].Dim_Key)+'" ><Documents DocID="'+s.e.String(g[f].DocID),o+=0==y?'" CostCenterid="'+this.InvCCID:'" CostCenterid="'+this.DummyCCID,o+='" CONTRACTSNO="'+(l++).toString()+'" ></Documents><DocumentXML>'}A=s.e.String(g[f].Dim_Key)}else this.SingleInvoice&&1!=c||(o+='<ROWS><Documents DocID="'+s.e.String(g[f].DocID),o+=0==y?'" CostCenterid="'+this.InvCCID:'" CostCenterid="'+this.DummyCCID,o+='" CONTRACTSNO="'+(l++).toString()+'" ></Documents><DocumentXML>');var V=1,R=null;if(s.e.IsEmpty(g[f].Xml)){if(this.DistribtueInvoice&&!s.e.IsEmpty(g[f].RecurInvoice)&&"true"!=s.e.String(g[f].RecurInvoice.toLowerCase())&&this.SingleInvoice&&y>0)continue}else if(h.LoadXml(g[f].Xml.toString()),h.DocumentElement.children.length>0&&null!=h.DocumentElement.children[0].attributes&&null!=h.DocumentElement.children[0].attributes.Filter&&!s.e.StringIsNullOrEmpty(h.DocumentElement.children[0].attributes.Filter.value)&&(0==parseInt(h.DocumentElement.children[0].attributes.Filter.value)||1==parseInt(h.DocumentElement.children[0].attributes.Filter.value))?(V=this.SelectedUnits.split(",").length,R=0==parseInt(h.DocumentElement.children[0].attributes.Filter.value)?h.SelectNodes(C>1?"XML/UnitsRow/Row[@FromDate='"+I.ToString("dd/MMM/yyyy")+"']":"XML/UnitsRow"):h.SelectNodes("XML/Row"),null==this.MultiNode&&(this.MultiNode=i.a.rental.GetUnitNodeIDs(this.SelectedUnits))):R=h.SelectNodes("XML/Row"),1==C&&this.DistribtueInvoice&&!s.e.IsEmpty(g[f].RecurInvoice)&&"true"!=s.e.String(g[f].RecurInvoice.toLowerCase())&&this.SingleInvoice&&y>0)continue;for(var M=0;M<V;M++){o+="<RowHead/><Row><Transactions  ",o+='DocDetailsID="0"  BillDate="'+this.ContractDate.Date.ToString("dd/MMM/yyyy")+'"  DocSeqNo="1"  LinkedInvDocDetailsID= ""  LinkedFieldName= "" ProductID="'+this.ProductID+'" ',o+=this.CurrencyContract.SelectedValue>0?'CurrencyID="'+this.CurrencyContract.SelectedValue+'" ':'CurrencyID="1" ',o+='ExchangeRate="1" Unit="1" UOMConversion="1" ',104==this.CurrCostCenterID?o+='CreditAccount="'+s.e.String(this.RentRecAc.SelectedValue)+'" DebitAccount ="'+s.e.String(g[f].CreditAccountID_Key)+'" ':(s.e.IsEmpty(g[f].AdvanceAcc)?o+='CreditAccount="'+s.e.String(g[f].CreditAccountID_Key)+'"':o+='CreditAccount="'+s.e.String(g[f].AdvanceAcc)+'"',"True"!=s.e.String(g[f].PostDebit)||s.e.IsEmpty(g[f].DebitAccountID_Key)?o+=' DebitAccount ="'+s.e.String(this.RentRecAc.SelectedValue)+'" ':o+=' DebitAccount ="'+g[f].DebitAccountID_Key.toString()+'" '),o+=' Quantity="1" CommonNarration="'+m.d.GetValidXml(s.e.String(g[f].Narration))+'"  ';var E="",v="",O="",w="";C>1&&null!=R?V>1&&R.length>M&&null!=R[M].attributes.Amount&&!s.e.IsEmpty(R[M].attributes.Amount.value)?(E=R[M].attributes.Amount.value,this.DiscountPosting&&null!=R[M].attributes.Discount&&!s.e.IsEmpty(R[M].attributes.Discount.value)&&parseFloat(R[M].attributes.Discount.value)>0&&(w=R[M].attributes.Discount.value,E=(parseFloat(R[M].attributes.Discount.value)+parseFloat(E)).toString()),O=m.d.GetValidXml(null!=R[M].attributes.Narration?R[M].attributes.Narration.value:s.e.String(g[f].Narration))):(E=R[y].attributes.Amount.value,this.DiscountPosting&&null!=R[y].attributes.Discount&&!s.e.IsEmpty(R[y].attributes.Discount.value)&&parseFloat(R[y].attributes.Discount.value)>0&&(w=R[y].attributes.Discount.value,E=(parseFloat(R[M].attributes.Discount.value)+parseFloat(E)).toString()),O=m.d.GetValidXml(null!=R[y].attributes.Narration?R[y].attributes.Narration.value:s.e.String(g[f].Narration))):null!=R&&V>1&&R.length>M&&null!=R[M].attributes.Amount&&!s.e.IsEmpty(R[M].attributes.Amount.value)?(E=R[M].attributes.Amount.value,this.DiscountPosting&&null!=R[M].attributes.Discount&&!s.e.IsEmpty(R[M].attributes.Discount.value)&&parseFloat(R[M].attributes.Discount.value)>0&&(w=R[M].attributes.Discount.value,E=(parseFloat(R[M].attributes.Discount.value)+parseFloat(E)).toString()),O=m.d.GetValidXml(null!=R[M].attributes.Narration?R[M].attributes.Narration.value:s.e.String(g[f].Narration))):(E=s.e.String(g[f].Amount),this.DiscountPosting&&!s.e.IsEmpty(g[f].Discount.toString())&&parseFloat(g[f].Discount.toString())>0&&(w=g[f].Discount.toString(),E=(parseFloat(g[f].Discount.toString())+parseFloat(E)).toString()),O=m.d.GetValidXml(s.e.String(g[f].Narration))),this.DistribtueInvoice&&!s.e.IsEmpty(g[f].RecurInvoice)&&"true"==s.e.String(g[f].RecurInvoice.toLowerCase())&&T>0?(E=(parseFloat(E)/T).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()),s.e.IsEmpty(w)||(w=(parseFloat(w)/T).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())),o+=' CanRecur="1" ',(T>1||y>0)&&(D=!0)):o+=' CanRecur="0" ',o+=' Rate="'+E.Replace(",","")+'"  Gross="'+E.Replace(",","")+'" ',o+=' LineNarration="'+O+'" ',o+="></Transactions> ";var L=this.AddRowCC(g[f],R,V,M,g);L+=this.GetSalemanXml(g[f]),o+=' <Numeric Query="',""!=w&&""!=this.Discountfield&&(o+=this.Discountfield+"=-"+w.Replace(",","")+","+this.Discountfield.Replace("dcNum","dcCalcNum")+"=-"+w.Replace(",","")+","),i.a.SessionManager.Preferences.ContainsKey("VATVersion")?(s.e.IsEmpty(g[f].VatPer)||"Inclusive"!=s.e.StringValue(g[f].VatType)||(E=(100*parseFloat(E)/(parseFloat(g[f].VatPer)+100)).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())),v=!s.e.IsEmpty(g[f].VatPer)&&parseFloat(g[f].VatPer.toString())>0?(parseFloat(E)*parseFloat(g[f].VatPer)/100).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()):"0",o+=" dcNum51="+E.Replace(",","")+",dcCalcNum51="+E.Replace(",",""),i.a.SessionManager.Preferences.ContainsKey("Use Foreign Currency")&&Object(r.j)(i.a.SessionManager.Preferences["Use Foreign Currency"])&&(o+=",dcCalcNumFC51="+E.Replace(",","")),!s.e.IsEmpty(g[f].VatPer)&&parseFloat(g[f].VatPer.toString())>0?(o+=",dcNum52="+g[f].VatPer.toString().Replace(",","")+",dcCalcNum52="+g[f].VatPer.toString().Replace(",",""),o+=",dcNum60="+g[f].VatPer.toString().Replace(",","")+",dcCalcNum60="+g[f].VatPer.toString().Replace(",",""),i.a.SessionManager.Preferences.ContainsKey("Use Foreign Currency")&&Object(r.j)(i.a.SessionManager.Preferences["Use Foreign Currency"])&&(o+=",dcCalcNumFC52="+g[f].VatPer.toString().Replace(",",""),o+=",dcCalcNumFC60="+g[f].VatPer.toString().Replace(",",""))):(i.a.SessionManager.Preferences.ContainsKey("Use Foreign Currency")&&Object(r.j)(i.a.SessionManager.Preferences["Use Foreign Currency"])&&(o+=",dcCalcNumFC60=0,dcCalcNumFC52=0"),o+=",dcCalcNum52=0,dcNum52=0,dcNum60=0,dcCalcNum60=0"),o+=",dcNum53="+v.Replace(",","")+",dcCalcNum53="+v.Replace(",",""),o+=",dcNum61="+v.Replace(",","")+",dcCalcNum61="+v.Replace(",",""),i.a.SessionManager.Preferences.ContainsKey("Use Foreign Currency")&&Object(r.j)(i.a.SessionManager.Preferences["Use Foreign Currency"])&&(o+=",dcCalcNumFC53="+v.Replace(",",""),o+=",dcCalcNumFC61="+v.Replace(",","")),o+=",",s.e.IsEmpty(g[f].VatPer)||"Inclusive"!=s.e.StringValue(g[f].VatType)||(o+="dcNum62=-"+v.Replace(",","")+",dcCalcNum62=-"+v.Replace(",",""),i.a.SessionManager.Preferences.ContainsKey("Use Foreign Currency")&&Object(r.j)(i.a.SessionManager.Preferences["Use Foreign Currency"])&&(o+=",dcCalcNumFC62=-"+v.Replace(",","")),o+=","),o+='" /> <Alpha  Query="',o+="dcAlpha153='"+s.e.StringValue(g[f].VatType)+"',",o+="dcAlpha152='Service',",o+='" />'):o+='" /> <Alpha />',o+=' <CostCenters   Query="'+this.strCCQry.toString()+L+'"  /> <EXTRAXML/> ';var x="",j="";if(104==this.CurrCostCenterID?(x=s.e.String(g[f].CreditAccountID_Key),j=s.e.String(this.RentRecAc.SelectedValue)):(j=s.e.IsEmpty(g[f].AdvanceAcc)?s.e.String(g[f].CreditAccountID_Key):s.e.String(g[f].AdvanceAcc),x="True"!=s.e.String(g[f].PostDebit)||s.e.IsEmpty(g[f].DebitAccountID_Key)?s.e.String(this.RentRecAc.SelectedValue):g[f].DebitAccountID_Key.toString()),!(this.DonotUpdateAccounts||this.SingleInvoice&&0!=y)){this.DistribtueInvoice&&this.SingleInvoice&&(this.Invoiced+=parseFloat(E)),o+="<AccountsXML>";var F={CostXML1:""};if(this.FillCostPosting(e,x,j,parseFloat(E),g[f],this.costDims,i.a.SessionManager.Preferences.DecimalsinAmount.toString(),R,V,M,F,g)?n+=F.CostXML1:(o+="<Accounts ",o+='CreditAccount="'+j+'"  DebitAccount="'+x+'" ',o+='Amount="'+E.Replace(",","")+'" AmtFc="'+E.Replace(",","")+'"  ',o+=this.CurrencyContract.SelectedValue>0?'CurrencyID="'+this.CurrencyContract.SelectedValue+'" ':'CurrencyID="1" ',o+='ExchangeRate="1"  ></Accounts>'),!s.e.IsEmpty(v)&&"0"!=v){this.DistribtueInvoice&&this.SingleInvoice&&(this.Invoiced+=parseFloat(v)),104==this.CurrCostCenterID?(j=s.e.String(this.RentRecAc.SelectedValue),x=s.e.String(this.VatAccountID)):(j=s.e.String(this.VatAccountID),x="True"!=s.e.String(g[f].PostDebit)||s.e.IsEmpty(g[f].DebitAccountID_Key)?s.e.String(this.RentRecAc.SelectedValue):s.e.String(g[f].DebitAccountID_Key));var B={CostXML1:""};this.FillCostPosting(e,x,j,parseFloat(v),g[f],this.costDims,i.a.SessionManager.Preferences.DecimalsinAmount.toString(),R,V,M,B,g)?n+=B.CostXML1:(o+="<Accounts ",o+='CreditAccount="'+j+'"  DebitAccount="'+x+'" ',o+='Amount="'+v.Replace(",","")+'" AmtFc="'+v.Replace(",","")+'"  ',o+=this.CurrencyContract.SelectedValue>0?'CurrencyID="'+this.CurrencyContract.SelectedValue+'" ':'CurrencyID="1" ',o+='ExchangeRate="1"  ></Accounts>')}s.e.IsEmpty(w)||"0"==w||(this.DistribtueInvoice&&this.SingleInvoice&&(this.Invoiced-=parseFloat(w)),104==this.CurrCostCenterID?(x=this.RentRecAc.SelectedValue.toString(),j=this.DiscountAccount.toString()):(x=this.DiscountAccount.toString(),j="True"==g[f].PostDebit.toString()&&""!=g[f].DebitAccountID_Key.toString()?g[f].DebitAccountID_Key.toString():this.RentRecAc.SelectedValue.toString()),this.FillCostPosting(e,x,j,-parseFloat(w),g[f],this.costDims,i.a.SessionManager.Preferences.DecimalsinAmount.toString(),R,V,M,F,g)?n+=F.CostXML1:(o+="<Accounts ",o+='CreditAccount="'+j+'"  DebitAccount="'+x+'" ',o+='Amount="'+w.Replace(",","")+'" AmtFc="'+w.Replace(",","")+'"  ',o+=this.CurrencyContract.SelectedValue>0?'CurrencyID="'+this.CurrencyContract.SelectedValue+'" ':'CurrencyID="1" ',o+='ExchangeRate="1"  ></Accounts>')),o+="</AccountsXML>"}o+=" </Row>"}this.SingleInvoice||0!=this.DimCCID||(s.e.IsEmpty(n)||(o+=n),n="",o+="</DocumentXML></ROWS>")}if((this.SingleInvoice||this.DimCCID>5e4)&&c>0){if(s.e.IsEmpty(n)||(o+=n),n="",o+="</DocumentXML>",D){var _=void 0;_=C>1?this.CalculateMonths_1(I,p):s.e.IntTryParse(Math.floor(this.CalculateMonths())),_/=T,o+="<recurXML>";var k=1;for(y>0&&(k=0);k<T;k++)o+='<Row Date="'+I.AddMonths(_*k).ToString("dd/MMM/yyyy")+'" Seq="'+k+'" />';o+="</recurXML>"}o+="</ROWS>"}}return o+=104==this.CurrCostCenterID?"</PIV>":"</SIV>",Logger.InfoLog("AddEditRenContractViewModel ::Exiting GetSalesInvXML"),o.toString()}},{key:"onCopy",value:function(t){return Object(n.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,s,r,o,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.e(68).then(a.bind(null,"Rr92"));case 2:return n=e.sent,s=n.UpdatePayTermsViewModel,e.next=6,a.e(0).then(a.bind(null,"++ql"));case 6:r=e.sent,o=r.UpdatepaytermsComponent,(l=new s("AddEditRenContractViewModel")).UpdatePayTermsViewModel_1(this,t.item,null,1),i.a.page.ShowDialog(l,o,{Title:"Distribute",HideClose:!0,ShowCenter:!0});case 10:case"end":return e.stop()}}),e,this)})))}},{key:"onDistribute",value:function(t){return Object(n.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,o,l,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.StartDate.Date){e.next=2;break}return e.abrupt("return",(this.DisplayMessage="Select Start Date",void(this.MessageVisibility=!0)));case 2:if(this.EndDate.Date){e.next=4;break}return e.abrupt("return",(this.DisplayMessage="Select End Date",void(this.MessageVisibility=!0)));case 4:if(!(this.StartDate.Date>this.EndDate.Date)){e.next=6;break}return e.abrupt("return",(this.DisplayMessage="End Date cannot be less than Start Date",this.TotalDays.Text="",void(this.MessageVisibility=!0)));case 6:if(s.e.IsEmpty(t.column.field)||"ActAmount"!=t.column.field){e.next=17;break}return e.next=9,a.e(68).then(a.bind(null,"Rr92"));case 9:return n=e.sent,r=n.UpdatePayTermsViewModel,e.next=13,a.e(0).then(a.bind(null,"++ql"));case 13:o=e.sent,l=o.UpdatepaytermsComponent,(c=new r("AddEditRenContractViewModel")).UpdatePayTermsViewModel_1(this,t.item,null),i.a.page.ShowDialog(c,l,{Title:"Distribute",HideClose:!0,ShowCenter:!0});case 17:case"end":return e.stop()}}),e,this)})))}},{key:"GetRentReceiptXML",value:function(t){var e,a,n,r=this,o="";o+="<RENTRCT>";for(var l=!1,c=0;c<this.DataTable.length;c++){var u,D;if(!s.e.IsEmpty(this.DataTable[c].NodeID)&&null!=this.DataTable[c].Amount&&""!=this.DataTable[c].Amount.toString().Trim()&&parseFloat(this.DataTable[c].Amount.toString())>0&&(0==c&&t||!s.e.IsEmpty(this.DataTable[c].AdvanceAcc)))!function(){var t=null;0==c&&!s.e.IsEmpty(r.SelectedUnits)&&r.nomonthlyincome&&(t=i.a.rental.getPOstIntCome(r.SelectedUnits));var h=r.DataTable[c].CreditAccountID_Key.toString(),C=r.IncomeAc.SelectedValue.toString();c>0&&(C=s.e.String(r.DataTable[c].CreditAccountID_Key),h=s.e.String(r.DataTable[c].AdvanceAcc));var b=new s.f,S=-1,d=-1,T=1,y=r.UnitNodeID,g=null;s.e.IsEmpty(r.DataTable[c].Xml)||(b.LoadXml(r.DataTable[c].Xml.toString()),b.DocumentElement.children.length>0&&null!=b.DocumentElement.children[0].attributes&&null!=b.DocumentElement.children[0].attributes.Filter&&!s.e.StringIsNullOrEmpty(b.DocumentElement.children[0].attributes.Filter.value)&&(d=parseInt(b.DocumentElement.children[0].attributes.Filter.value)),1!=d&&(S=0),!r.multiVisi||0!=d&&1!=d||(T=r.SelectedUnits.split(",").length,null==r.MultiNode&&(r.MultiNode=i.a.rental.GetUnitNodeIDs(r.SelectedUnits))));for(var I=function(d){r.IncomeOnContDate&&r.ContractDate.Date>r.StartDate.Date&&r.ContractDate.Date.getMonth()!=r.StartDate.Date.getMonth()&&(r.ContractDate.Date.getFullYear()>r.StartDate.Date.getFullYear()||r.ContractDate.Date.getMonth()>r.StartDate.Date.getMonth()&&r.ContractDate.Date.getFullYear()==r.StartDate.Date.getFullYear())&&(l=!0);var I=void 0,p=void 0,A=void 0,f=void 0,P=0,N=0,V=0,R=0,M=0,E=0,v=0,O=0,w=s.e.DoubleTryParse(r.DataTable[c].Amount),L=0,x=r.CalculateMonths();if(r.DiscountPosting&&""!=r.DataTable[c].Discount.toString()&&parseFloat(r.DataTable[c].Discount.toString())>0&&(w+=P=s.e.DoubleTryParse(r.DataTable[c].Discount),N=x>1?s.e.Round(P/x,r.Mdeci):P,V=s.e.Round(P/r.GetDays(),r.dDeci)),f=x>1?s.e.Round(w/x,r.Mdeci):w,A=s.e.Round(w/r.GetDays(),r.dDeci),e=r.StartDate.Date,S>=0&&(S=0),1==T&&0==S)g=b.DocumentElement.children;else if(T>1){if(null!=b.DocumentElement.children[0].children[d].attributes.Unit&&!s.e.StringIsNullOrEmpty(b.DocumentElement.children[0].children[d].attributes.Unit.value)&&((u=r.MultiNode.filter((function(t){return t.UnitID==b.DocumentElement.children[0].children[d].attributes.Unit.value}))).length>0&&(y=parseInt(s.e.String(u[0].nodeid))),null!=t&&(u=t.filter((function(t){return t.UnitID==b.DocumentElement.children[0].children[d].attributes.Unit.value}))).length>0&&("false"==u[0].PostIncome.toString().toLowerCase()||"0"==u[0].PostIncome.toString().toLowerCase())))return"continue";null==b.DocumentElement.children[0].children[d].attributes.Amount||s.e.StringIsNullOrEmpty(b.DocumentElement.children[0].children[d].attributes.Amount.value)||(w=s.e.DoubleTryParse(b.DocumentElement.children[0].children[d].attributes.Amount.value),r.DiscountPosting&&null!=b.ChildNodes[0].ChildNodes[d].Attributes.Discount&&!s.e.StringIsNullOrEmpty(b.ChildNodes[0].ChildNodes[d].Attributes.Discount.value)&&s.e.DoubleTryParse(b.ChildNodes[0].ChildNodes[d].Attributes.Discount.value)>0&&(w+=P=s.e.DoubleTryParse(b.ChildNodes[0].ChildNodes[d].Attributes.Discount),N=x>1?s.e.Round(P/x,r.Mdeci):P,V=s.e.Round(P/r.GetDays(),r.dDeci)),f=x>1?s.e.Round(w/x,r.Mdeci):w,A=s.e.Round(w/r.GetDays(),r.dDeci)),g=b.DocumentElement.children[0].children[d].children}for(0==c&&i.a.SessionManager.Preferences.ContainsKey("VATVersion")&&""!=s.e.String(r.DataTable[c].VatPer)&&"Inclusive"==s.e.String(r.DataTable[c].VatType)&&(w=s.e.DoubleTryParse((100*parseFloat(w.toString())/(parseFloat(r.DataTable[c].VatPer)+100)).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())),A=s.e.DoubleTryParse((100*parseFloat(A.toString())/(parseFloat(r.DataTable[c].VatPer)+100)).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())),f=s.e.DoubleTryParse((100*parseFloat(f.toString())/(parseFloat(r.DataTable[c].VatPer)+100)).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())),P>0&&(P=s.e.DoubleTryParse((100*parseFloat(P.toString())/(parseFloat(r.DataTable[c].VatPer)+100)).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())),V=s.e.DoubleTryParse((100*parseFloat(V.toString())/(parseFloat(r.DataTable[c].VatPer)+100)).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())),N=s.e.DoubleTryParse((100*parseFloat(N.toString())/(parseFloat(r.DataTable[c].VatPer)+100)).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()))));e<=r.EndDate.Date;){var j=!1;S>=0&&(s.e.isValidDate(g[S].attributes.FromDate.value)&&(a=new Date(g[S].attributes.FromDate.value)),s.e.isValidDate(g[S].attributes.ToDate.value)&&(n=new Date(g[S].attributes.ToDate.value)),0==L?j=!0:n<e.AddDays(e.DaysInMonth()-1)&&e.AddMonths(1)<r.EndDate.Date&&(S++,s.e.isValidDate(g[S].attributes.FromDate.value)&&(a=new Date(g[S].attributes.FromDate.value)),s.e.isValidDate(g[S].attributes.ToDate.value)&&(n=new Date(g[S].attributes.ToDate.value)),j=!0),O=0,0,j&&(v>0&&w-v>0&&(O=w-v),R>0&&P-R>0&&P-R,w=s.e.DoubleTryParse(g[S].attributes.Amount.value),r.DiscountPosting&&null!=g[S].attributes.Discount&&!s.e.IsEmpty(g[S].attributes.Discount.value)&&parseFloat(g[S].attributes.Discount.value)>0&&(w+=P=s.e.DoubleTryParse(g[S].attributes.Discount),N=x>1?s.e.Round(P/x,r.Mdeci):P,V=s.e.Round(P/r.GetDays(),r.dDeci)),f=(x=r.CalculateMonthsbetweenDates(a,n))>1?s.e.Round(w/x,r.Mdeci):w,A=s.e.Round(w/r.GetDays_1(a,n),r.dDeci),v=0,R=0)),0==L?e.getMonth()==r.EndDate.Date.getMonth()&&e.getFullYear()==r.EndDate.Date.getFullYear()?(p=w,I=P):1==e.getDate()?"Daily"==r.BasedOn.SelectedValue?(p=s.e.Round(A*e.DaysInMonth(),r.Mdeci),I=s.e.Round(V*e.DaysInMonth(),r.Mdeci)):(p=f,I=N):("Daily"!=r.BasedOn.SelectedValue&&(A=f/e.DaysInMonth(),V=N/e.DaysInMonth()),p=s.e.Round(A*(e.DaysInMonth()-e.getDate()+1),r.Mdeci),I=s.e.Round(V*(e.DaysInMonth()-e.getDate()+1),r.Mdeci)):e.AddMonths(1)>r.EndDate.Date?(p=w-v,I=P-R):((j||O)>0&&S>0?(s.e.isValidDate(g[S].attributes.FromDate.value)&&(a=new Date(g[S].attributes.FromDate.value)),1!=a.Day||"Daily"==r.BasedOn.SelectedValue?(p=s.e.Round(A*(a.DaysInMonth()-a.getDate()+1),r.Mdeci),I=s.e.Round(V*(a.DaysInMonth()-a.getDate()+1),r.Mdeci)):(p=f,I=N)):"Daily"==r.BasedOn.SelectedValue?p=s.e.Round(A*e.DaysInMonth(),r.Mdeci):(p=f,I=N),S>=0&&g.length>S&&(s.e.isValidDate(g[S].attributes.ToDate.value)&&(n=new Date(g[S].attributes.ToDate.value)),n==e.AddDays(e.DaysInMonth()-1)&&(p=w-v,I=P-R))),v+=p,R+=I,O>0&&S>0&&(p+=O);var F=0,B=!1,_=!1;if(l&&e<=r.ContractDate.Date&&(M+=p,E+=I,e.Month.getMonth()==r.ContractDate.Date.getMonth()&&e.Year.getFullYear()==r.ContractDate.Date.getFullYear()?(F=M,I=E,l=!1,_=!0):B=!0),!B){o+="<ROWS><DocumentXML>";var k=1;null!=r.dsprof&&r.dsprof.Tables.length>0&&r.dsprof.Columns[0].Contains("ProfileID")&&r.dsprof.Tables[0].length>0&&(k=r.dsprof.Tables[0].length);var U=0;D=i.a.SessionManager.Preferences.DistributeCostDims.split(",");for(var K=function(t){k>1?(t+1==r.dsprof.Tables[0].length?F=parseFloat((p-U).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())):!s.e.IsEmpty(r.dsprof.Tables[0][t].Percent)&&parseFloat(r.dsprof.Tables[0][t].Percent.toString())>0?F=parseFloat((p*parseFloat(r.dsprof.Tables[0][t].Percent.toString())/100).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString())):!s.e.IsEmpty(r.dsprof.Tables[0][t].Amount)&&parseFloat(r.dsprof.Tables[0][t].Amount.toString())>0&&(F=parseFloat(r.dsprof.Tables[0][t].Amount.toString())),U+=F):0==F&&(F=p),o+='<Row><Transactions NodeID="'+r.DataTable[c].NodeID.toString()+'"  CONTRACTSNO="'+(L+1).toString()+'" ',o+='DocDetailsID="0"  DocSeqNo="1" ',o+=104==r.CurrCostCenterID?'CreditAccount="'+h+'" DebitAccount="'+C+'" ':'DebitAccount="'+h+'" CreditAccount="'+C+'" ',o+='Amount="'+F.toString()+'" AmtFc="'+F.toString()+'" ',o+=r.CurrencyContract.SelectedValue>0?'CurrencyID="'+r.CurrencyContract.SelectedValue+'" ':'CurrencyID="1" ',o+=' ChequeDate = "'+e.ToString("dd/MMM/yyyy")+'" ExchangeRate="1"  CommonNarration="'+m.d.GetValidXml(r.Narration.Text)+'"  LineNarration=" ADVANCE RENT ADJUSTMENT " ChequeBankName="" ChequeNumber=""',o+="></Transactions> ";var a="";r.TempCCID>5e4&&!r.strCCQry.toString().Contains("dcCCNID"+(r.TempCCID-5e4).toString()+"=")&&(a=s.e.IsEmpty(r.DataTable[c].TempCCID_Key)?" dcCCNID"+(r.TempCCID-5e4).toString()+"=1,":" dcCCNID"+(r.TempCCID-5e4).toString()+"="+r.DataTable[c].TempCCID_Key.toString()+","),r.DataTableColumns.Contains("Location_Key")&&!s.e.IsEmpty(r.DataTable[c].Location_Key)?a+=" dcCCNID2="+r.DataTable[c].Location_Key.toString()+",":r.LocationContract.Visible&&r.LocationContract.SelectedValue>0&&(a+=" dcCCNID2="+r.LocationContract.SelectedValue+","),r.DataTableColumns.Contains("Dim_Key")&&!s.e.IsEmpty(r.DataTable[c].Dim_Key)&&(a+=" dcCCNID"+(r.DimCCID-5e4).toString()+"="+r.DataTable[c].Dim_Key.toString()+","),a+=r.GetSalemanXml(r.DataTable[c]),r.multiVisi&&!r.strCCQry.toString().Contains("dcCCNID"+(r.UnitCCID-5e4).toString()+"=")&&(a+=" dcCCNID"+(r.UnitCCID-5e4).toString()+"="+y+","),k>1?D.forEach((function(e){parseInt(e)>5e4&&r.dsprof.Columns[0].Contains("DCCCNID"+(parseInt(e)-5e4))&&""!=r.dsprof.Tables[0][t]["DCCCNID"+(parseInt(e)-5e4)].toString()&&(a+="DCCCNID"+(parseInt(e)-5e4)+"="+r.dsprof.Tables[0][t]["DCCCNID"+(parseInt(e)-5e4)].toString()+",")})):null!=r.dsprof&&r.dsprof.Tables.length>0&&r.dsprof.Columns[0].Contains("ProfileID")&&1==r.dsprof.Tables[0].length&&D.forEach((function(t){parseInt(t)>5e4&&r.dsprof.Columns[0].Contains("DCCCNID"+(parseInt(t)-5e4))&&""!=r.dsprof.Tables[0][0]["DCCCNID"+(parseInt(t)-5e4)].toString()&&(a+="DCCCNID"+(parseInt(t)-5e4)+"="+r.dsprof.Tables[0][0]["DCCCNID"+(parseInt(t)-5e4)].toString()+",")})),i.a.SessionManager.Preferences.ContainsKey("DepositLinkDimension")&&""!=i.a.SessionManager.Preferences.DepositLinkDimension&&parseInt(i.a.SessionManager.Preferences.DepositLinkDimension)>0&&(a+=" dcCCNID"+(parseInt(i.a.SessionManager.Preferences.DepositLinkDimension)-5e4).toString()+"="+r.DataTable[c].NodeID.toString()+","),o+=' <Numeric Query="',r.NegateIncomeFld.toLowerCase().Contains("dcnum")&&(o+=r.NegateIncomeFld+"=-"+p+","+r.NegateIncomeFld.toLowerCase().Replace("dcnum","dcCalcNum")+"=-"+p+","),""!=r.Discountfield&&I>0&&(o+=r.Discountfield+"=-"+I+","+r.Discountfield.Replace("dcNum","dcCalcNum")+"=-"+I+","),o+='"  /> <Alpha /> <CostCenters   Query="'+r.strCCQry.toString()+a+'"  /> <EXTRAXML/> ',o+="<AccountsXML>",r.NegateIncomeFld.toLowerCase().Contains("dcnum")&&(o+="<Accounts ",104==r.CurrCostCenterID?(o+='CreditAccount="'+C+'" ',o+='DebitAccount="'+h+'" '):(o+='DebitAccount="'+C+'" ',o+='CreditAccount="'+h+'" '),o+='Amount="'+F.toString()+'" ',o+='AmtFc="'+F.toString()+'" ',o+='CurrencyID="1" ',o+='ExchangeRate="1" ',o+='IsNegative="1" ',o+="></Accounts>"),""!=r.Discountfield&&I>0&&(o+="<Accounts ",104==r.CurrCostCenterID?(o+='CreditAccount="'+C+'" ',o+='DebitAccount="'+r.DiscountAccount+'" '):(o+='DebitAccount="'+C+'" ',o+='CreditAccount="'+r.DiscountAccount+'" '),o+='Amount="'+I.toString()+'" ',o+='AmtFc="'+I.toString()+'" ',o+='CurrencyID="1" ',o+='ExchangeRate="1" ',o+='IsNegative="1" ',o+="></Accounts>"),o+=" </AccountsXML></Row>"},G=0;G<k;G++)K(G);o+='</DocumentXML><ChequeDocDate DD="',o+=_?r.ContractDate.Date.ToString("dd/MMM/yyyy"):e.ToString("dd/MMM/yyyy"),o+='"></ChequeDocDate></ROWS>'}e=0==L?e.AddDays(e.DaysInMonth()-e.getDate()+1):e.AddMonths(1),L++}},p=0;p<T;p++)I(p)}()}return(o+="</RENTRCT>").toString()}},{key:"getTotalMonths",value:function(){var t=new Date;return""!=this.Months.Text&&null!=this.Months.Text||!this.StartDate.Date?""!=this.Months.Text&&null!=this.Months.Text||(this.Months.Text=((this.EndDate.Date.Subtract(t).Days+1)/30).toString()):this.Months.Text=((this.EndDate.Date.Subtract(this.StartDate.Date).Days+1)/30).toString(),parseInt(this.Months.Text)}},{key:"CalculateMonths_1",value:function(t,e){try{for(var a=0,n=t;e>n;)a++,n=n.AddMonths(1);return(t.DaysInMonth()!=t.Day||e.DaysInMonth()!=e.Day)&&t.Day>=e.Day&&(a+=1),a}catch(i){return 0}}},{key:"CalculateMonthsbetweenDates",value:function(t,e){try{for(var a=0,n=0,i=t;e>i;)0==a&&0==n?1==i.getDate()?(a++,i=i.AddMonths(1)):(n=i.DaysInMonth()-i.getDate()+1,i=i.AddDays(parseFloat(n))):(i=i.AddMonths(1))>e?s.e.DaysInMonth(i.AddMonths(-1).getFullYear(),i.AddMonths(-1).getMonth())==e.getDate()?a++:n+=e.getDate():a++;return e==i&&(n+=1),n>0&&(t.Month==e.Date.Month||t.getDate()==e.getDate()+1?n==t.DaysInMonth()||n==e.DaysInMonth()?a++:a+=n/e.DaysInMonth():1==t.Day?n==e.DaysInMonth()?a++:a+=n/e.DaysInMonth():e.Day==e.DaysInMonth()?a+=n/e.DaysInMonth():a+=n/30),a}catch(r){return 0}}},{key:"CalculateMonths",value:function(){try{for(var t=0,e=0,a=this.StartDate.Date;this.EndDate.Date>a;)0==t&&0==e?1==a.getDate()?(t++,a=a.AddMonths(1)):(e=a.DaysInMonth()-a.getDate()+1,a=a.AddDays(e)):(a=a.AddMonths(1))>this.EndDate.Date?s.e.DaysInMonth(a.AddMonths(-1).getFullYear(),a.AddMonths(-1).getMonth())==this.EndDate.Date.getDate()?t++:e+=this.EndDate.Date.getDate():t++;return s.e.isValidDate(this.EndDate.Date)&&this.EndDate.Date==a&&(e+=1),e>0&&(this.StartDate.Date.getMonth()==this.EndDate.Date.getMonth()||this.StartDate.Date.getDate()==this.EndDate.Date.getDate()+1?e==this.StartDate.Date.DaysInMonth()||e==this.EndDate.Date.DaysInMonth()?t++:t+=e/this.EndDate.Date.DaysInMonth():1==this.StartDate.Date.getDate()?e==this.EndDate.Date.DaysInMonth()?t++:t+=e/this.EndDate.Date.DaysInMonth():this.EndDate.Date.getDate()==this.EndDate.Date.DaysInMonth()?t+=e/this.StartDate.Date.DaysInMonth():t+=e/30),t}catch(n){return 0}}},{key:"getTotalMonthsTerm",value:function(){return this.Months.Text=((this.EndDate.Date.Subtract(this.TerminationDate.Date()).Days+1)/30).toString(),(this.EndDate.Date.Subtract(this.TerminationDate).Days+1)%30>0?parseInt(this.Months.Text)+1:parseInt(this.Months.Text)}},{key:"GetCCData",value:function(t){var e=this;i.a.SessionManager.Preferences.ContainsKey("DistributeCost")&&"True"==i.a.SessionManager.Preferences.DistributeCost&&i.a.SessionManager.Preferences.ContainsKey("CostBasedON")&&"True"==i.a.SessionManager.Preferences.CostBasedON&&i.a.SessionManager.Preferences.ContainsKey("CostBasedONDims")&&""!=i.a.SessionManager.Preferences.CostBasedONDims&&(this.costDims=i.a.SessionManager.Preferences.CostBasedONDims.split(",")),this.strCCQry="";var a=new Array;a.push(this.TenantCCID),a.push(this.UnitCCID),a.push(this.PropertyCCID),a.push(this.Landlord.CCID),a.push(this.Accountant.CCID),a.push(this.Salesman.CCID),a.push(50060),a.push(parseInt(i.a.SessionManager.Preferences.DepositLinkDimension));var n=this.ContractParticular.find((function(t){return null!=t.ValueMember&&"SPType_Key"==t.ValueMember}));null!=n&&null!=n&&n.IsVisible&&a.push(50061),null!=(n=this.ContractParticular.find((function(t){return null!=t.ValueMember&&"Dim_Key"==t.ValueMember})))&&null!=n&&n.CostCenterID>0&&a.push(n.CostCenterID);for(var r=0;r<this.ContractParticular.length;r++)this.ContractParticular[r].DisplayMember.startsWith("CCNID")&&this.DataTableColumns.Contains(this.ContractParticular[r].ValueMember)&&a.push(this.ContractParticular[r].CostCenterID);for(var o=0;o<this.ContractPayTerms.length;o++)this.ContractPayTerms[o].DisplayMember.startsWith("CCNID")&&this.DataTableColumns.Contains(this.ContractPayTerms[o].ValueMember)&&a.push(this.ContractPayTerms[o].CostCenterID);this.ScreenObject.CustomTab.Pages.forEach((function(t){t.Fields.forEach((function(t){t instanceof l.b&&(null!=t.DBColumnName&&t.DBColumnName.toLowerCase().Contains("ccnid")||null!=t.DBColumnName&&("accountid"==t.DBColumnName.toLowerCase()||"productid"==t.DBColumnName.toLowerCase()))&&!a.Contains(t.CCID)&&(s.e.IsEmpty(t.SelectedValue)||0==t.SelectedValue||(e.strCCQry+=t.DBColumnName.replace("CCNID","dcCCNID")+"="+t.SelectedValue+","))}))})),this.ScreenObject.HeaderFields.forEach((function(t){t instanceof l.b&&(null!=t.DBColumnName&&t.DBColumnName.toLowerCase().Contains("ccnid")||null!=t.DBColumnName&&("accountid"==t.DBColumnName.toLowerCase()||"productid"==t.DBColumnName.toLowerCase()))&&!a.Contains(t.CCID)&&(s.e.IsEmpty(t.SelectedValue)||0==t.SelectedValue||(e.strCCQry+=t.DBColumnName.replace("CCNID","dcCCNID")+"="+t.SelectedValue+","))})),this.LineWiseSalesman||this.strCCQry.toString().Contains("dcCCNID"+(this.Salesman.CCID-5e4).toString()+"=")||this.Salesman.CCID>5e4&&this.Salesman.SelectedValue>0&&(this.strCCQry+=" dcCCNID"+(this.Salesman.CCID-5e4)+"="+this.Salesman.SelectedValue+","),this.strCCQry.toString().Contains("dcCCNID"+(this.Accountant.CCID-5e4).toString()+"=")||this.Accountant.CCID>5e4&&this.Accountant.SelectedValue>0&&(this.strCCQry+=" dcCCNID"+(this.Accountant.CCID-5e4)+"="+this.Accountant.SelectedValue+","),this.strCCQry.toString().Contains("dcCCNID"+(this.Landlord.CCID-5e4).toString()+"=")||this.Landlord.CCID>5e4&&this.Landlord.SelectedValue>0&&(this.strCCQry+=" dcCCNID"+(this.Landlord.CCID-5e4)+"="+this.Landlord.SelectedValue+","),this.strCCQry.toString().Contains("dcCCNID1=")||this.DivisionContract.Visible&&this.DivisionContract.SelectedValue>0&&(this.strCCQry+=" dcCCNID1="+this.DivisionContract.SelectedValue+","),this.strCCQry.toString().Contains("dcCCNID"+(this.PropertyCCID-5e4).toString()+"=")||this.PropertyCCID>5e4&&(this.strCCQry+=" dcCCNID"+(this.PropertyCCID-5e4)+"="+t[0].PropertyID.toString()+","),this.strCCQry.toString().Contains("dcCCNID"+(this.UnitCCID-5e4).toString()+"=")||this.UnitCCID>5e4&&(this.multiVisi&&!s.e.IsEmpty(t[0].UnitID)?this.UnitNodeID=parseInt(t[0].UnitID.toString()):this.strCCQry+=" dcCCNID"+(this.UnitCCID-5e4)+"="+t[0].UnitID.toString()+","),this.strCCQry.toString().Contains("dcCCNID"+(this.TenantCCID-5e4).toString()+"=")||this.TenantCCID>5e4&&(this.strCCQry+=" dcCCNID"+(this.TenantCCID-5e4)+"="+t[0].TenantID.toString()+",")}},{key:"GetRemaingPaymentXML",value:function(t){var e,a,n="";if(Logger.InfoLog("AddEditRenContractViewModel ::Entering GetRemaingPaymentXML"),e=this.TerminateContracts.ChequeDate.Date,n+='<ReceiptXML><ROWS><AccountType DD="'+(a=this.BankAccounts.ContainsKey(this.TerminateContracts.BankAccount.SelectedValue.toString())||!s.e.IsEmpty(this.PayTermsDataTable[0].DebitAccountID_Key)&&this.PDPAccounts.ContainsKey(this.PayTermsDataTable[0].DebitAccountID_Key.toString())?"BANK":"JV")+'"></AccountType><Documents DocID="0"></Documents><DocumentXML>',this.strType="JV"!=a,this.strType)n+='<Row><Transactions  CONTRACTSNO="1"  ',n+=' DocDetailsID="0"  DocSeqNo="1"   CreditAccount="'+this.TerminateContracts.BankAccount.SelectedValue.toString()+'" DebitAccount="'+this.RentRecAc.SelectedValue.toString()+'" Amount="##Balance##" AmtFc="##Balance##"',n+=' ChequeDate = "'+e.ToString("dd/MMM/yyyy")+'"  ChequeMaturityDate = "'+e.ToString("dd/MMM/yyyy")+'"  CurrencyID="1" ExchangeRate="1" CommonNarration="'+m.d.GetValidXml(this.TerminateContracts.Remarks.Text)+'" LineNarration="'+m.d.GetValidXml(this.TerminateContracts.Remarks.Text)+'" ChequeBankName="" ChequeNumber="'+this.TerminateContracts.ChequeNo.Text+'"',n+="></Transactions> ",n+=' <Numeric /> <Alpha /> <CostCenters   Query="'+this.strCCQry.toString()+'"  /> ',n+="<EXTRAXML> ",i.a.SessionManager.Preferences.ContainsKey("On")&&"True"==i.a.SessionManager.Preferences.On&&t&&(n+="<BillWise> ",n+=' <Row DocSeqNo="1" AccountID="'+this.RentRecAc.SelectedValue.toString(),n+='" AmountFC="##Balance##" AdjAmount="##Balance##"',n+=' AdjCurrID="1" ',n+='AdjExchRT="1" ',n+='IsNewReference="1" ',n+='Narration="" ',n+='IsDocPDC="0" ',n+=" ></Row>",n+=" </BillWise>"),n+="</EXTRAXML> ",n+=" </Row>";else{if(n+='<Row><Transactions  CONTRACTSNO="1"  ',n+=' DocDetailsID="0"  DocSeqNo="1"   CreditAccount="'+this.TerminateContracts.BankAccount.SelectedValue.toString()+'" DebitAccount="-99" Amount="##Balance##" AmtFc="##Balance##"',n+=' ChequeDate = "'+e.ToString("dd/MMM/yyyy")+'"  ChequeMaturityDate = "'+e.ToString("dd/MMM/yyyy")+'"  CurrencyID="1" ExchangeRate="1" CommonNarration="'+m.d.GetValidXml(this.TerminateContracts.Remarks.Text)+'" LineNarration="'+m.d.GetValidXml(this.TerminateContracts.Remarks.Text)+'" ChequeBankName="" ChequeNumber="'+this.TerminateContracts.ChequeNo.Text+'"',n+="></Transactions> ",n+=' <Numeric /> <Alpha /> <CostCenters   Query="'+this.strCCQry.toString()+'"  />  ',n+="<EXTRAXML> ",i.a.SessionManager.Preferences.ContainsKey("On")&&"True"==i.a.SessionManager.Preferences.On&&!s.e.IsEmpty(this.PayTermsDataTable[0].Amount)&&!s.e.IsEmpty(this.PayTermsDataTable[0].DebitAccountID_Key)){var o=!1,l=i.a.rental.IsBillWiseAccount(this.TerminateContracts.BankAccount.SelectedValue);null!=l&&l.Tables.length>0&&l.Tables[0].length>0&&!s.e.IsEmpty(l.Tables[0][0].IsBillwise)&&(o=Object(r.j)(l.Tables[0][0].IsBillwise)),o&&(n+="<BillWise> ",n+=' <Row DocSeqNo="1" AccountID="'+this.PayTermsDataTable[0].DebitAccountID_Key.toString(),n+='" AmountFC="-##Balance##" AdjAmount="-##Balance##"',n+=' AdjCurrID="1" ',n+='AdjExchRT="1" ',n+='IsNewReference="1" ',n+='Narration="" ',n+='IsDocPDC="0" ',n+=" ></Row>",n+=" </BillWise>")}n+="</EXTRAXML> ",n+=" </Row>",n+='<Row><Transactions  CONTRACTSNO="1"  ',n+=' DocDetailsID="0"  DocSeqNo="2"   CreditAccount="-99" DebitAccount="'+this.RentRecAc.SelectedValue.toString()+'" Amount="##Balance##" AmtFc="##Balance##"',n+=' ChequeDate = "'+e.ToString("dd/MMM/yyyy")+'"  ChequeMaturityDate = "'+e.ToString("dd/MMM/yyyy")+'"  CurrencyID="1" ExchangeRate="1" CommonNarration="'+m.d.GetValidXml(this.TerminateContracts.Remarks.Text)+'" LineNarration="'+m.d.GetValidXml(this.TerminateContracts.Remarks.Text)+'" ',n+="></Transactions> ",n+=' <Numeric /> <Alpha /> <CostCenters   Query="'+this.strCCQry.toString()+'"  />  ',n+="<EXTRAXML> ",i.a.SessionManager.Preferences.ContainsKey("On")&&"True"==i.a.SessionManager.Preferences.On&&t&&!s.e.IsEmpty(this.PayTermsDataTable[0].Amount)&&(n+="<BillWise> ",n+=' <Row DocSeqNo="2" AccountID="'+this.RentRecAc.SelectedValue.toString(),n+='" AmountFC="##Balance##" AdjAmount="##Balance##"',n+=' AdjCurrID="1" ',n+='AdjExchRT="1" ',n+='IsNewReference="1" ',n+='Narration="" ',n+='IsDocPDC="0" ',n+=" ></Row>",n+=" </BillWise>"),n+="</EXTRAXML> ",n+=" </Row>"}return n+="</DocumentXML></ROWS></ReceiptXML>",Logger.InfoLog("AddEditRenContractViewModel ::Exiting GetRemaingPaymentXML"),n.toString()}},{key:"GetPaymentXML",value:function(t){if(95==this.CostCenterID&&this.SinglePDC)return"";if(this.PayTermsDataTable.length>0&&null!=this.PayTermsDataTable[0].DebitAccountID_Key&&""!=this.PayTermsDataTable[0].DebitAccountID_Key.toString()&&parseInt(this.PayTermsDataTable[0].DebitAccountID_Key)>0&&null!=this.PayTermsDataTable[0].Amount&&""!=this.PayTermsDataTable[0].Amount.toString()&&parseFloat(this.PayTermsDataTable[0].Amount.toString())>0){var e,a="",n=(new Date,new Date);if(Logger.InfoLog("AddEditRenContractViewModel ::Entering GetPaymentXML"),n=new Date(this.PayTermsDataTable[0].CntrlDate_Key),e=this.BankAccounts.ContainsKey(this.PayTermsDataTable[0].DebitAccountID_Key.toString())||this.PDPAccounts.ContainsKey(this.PayTermsDataTable[0].DebitAccountID_Key.toString())?"BANK":this.CashAccounts.ContainsKey(this.PayTermsDataTable[0].DebitAccountID_Key.toString())?"CASH":"JV","370"==this.PayTermsDataTable[0].DocStatusID.toString()&&"BANK"==e){if(a+='<ReceiptXML><ROWS><AccountType DD="'+e+'"></AccountType><Documents DocID="0"></Documents><DocumentXML>',this.strType="JV"!=e,null!=this.PayTermsDataTable[0].CntrlDate&&""!=this.PayTermsDataTable[0].CntrlDate.toString()&&null!=this.PayTermsDataTable[0].Amount&&""!=this.PayTermsDataTable[0].Amount.toString()&&parseFloat(this.PayTermsDataTable[0].Amount.toString())>0)if(this.PDCRefund+=parseFloat(this.PayTermsDataTable[0].Amount.toString()),this.strType){a+='<Row><Transactions  CONTRACTSNO="1"  ',null!=this.PayTermsDataTable[0].Amount&&""!=this.PayTermsDataTable[0].Amount.toString()?a+=' DocDetailsID="0"  DocSeqNo="1"   CreditAccount="'+this.PayTermsDataTable[0].DebitAccountID_Key.toString()+'" DebitAccount="'+this.RentRecAc.SelectedValue.toString()+'" Amount="'+parseFloat(this.PayTermsDataTable[0].Amount)+'" AmtFc="'+parseFloat(this.PayTermsDataTable[0].Amount)+'"':a+=' DocDetailsID="0"  DocSeqNo="1"   CreditAccount="'+this.PayTermsDataTable[0].DebitAccountID_Key.toString()+'" DebitAccount="'+this.RentRecAc.SelectedValue.toString()+'" Amount="0" AmtFc="0" ',a+=this.CurrencyContract.SelectedValue>0?' ChequeDate = "'+n.ToString("dd/MMM/yyyy")+'"  ChequeMaturityDate = "'+n.ToString("dd/MMM/yyyy")+'"  CurrencyID="'+this.CurrencyContract.SelectedValue+'" ExchangeRate="1" CommonNarration="'+m.d.GetValidXml(this.PayTermsDataTable[0].Narration.toString())+'" LineNarration="'+m.d.GetValidXml(this.PayTermsDataTable[0].Narration.toString())+'" ChequeBankName="'+m.d.GetValidXml(this.GetPayBank(this.PayTermsDataTable[0].PayeeBank.toString()))+'" ChequeNumber="'+this.PayTermsDataTable[0].ChequeNo.toString()+'"':' ChequeDate = "'+n.ToString("dd/MMM/yyyy")+'"  ChequeMaturityDate = "'+n.ToString("dd/MMM/yyyy")+'"  CurrencyID="1" ExchangeRate="1" CommonNarration="'+m.d.GetValidXml(this.PayTermsDataTable[0].Narration.toString())+'" LineNarration="'+m.d.GetValidXml(this.PayTermsDataTable[0].Narration.toString())+'" ChequeBankName="'+m.d.GetValidXml(this.GetPayBank(this.PayTermsDataTable[0].PayeeBank.toString()))+'" ChequeNumber="'+this.PayTermsDataTable[0].ChequeNo.toString()+'"',a+="></Transactions> ";var o="";if(this.TempCCID>5e4&&!this.strCCQry.toString().Contains("dcCCNID"+(this.TempCCID-5e4).toString()+"=")&&(o=""!=this.PayTermsDataTable[0].TempCCID_Key.toString()?" dcCCNID"+(this.TempCCID-5e4).toString()+"="+this.PayTermsDataTable[0].TempCCID_Key.toString()+",":" dcCCNID"+(this.TempCCID-5e4).toString()+"=1,"),this.PayTermsDataTableColumns.Contains("Location_Key")&&""!=this.PayTermsDataTable[0].Location_Key.toString()?o+=" dcCCNID2="+this.PayTermsDataTable[0].Location_Key.toString()+",":this.LocationContract.Visible&&this.LocationContract.SelectedValue>0&&(o+=" dcCCNID2="+this.LocationContract.SelectedValue+","),this.PayTermsDataTableColumns.Contains("Dim_Key")&&!s.e.IsEmpty(this.PayTermsDataTable[0].Dim_Key)&&(o+=" dcCCNID"+(this.DimCCID-5e4).toString()+"="+this.PayTermsDataTable[0].Dim_Key.toString()+","),o+=this.GetSalemanXml(this.PayTermsDataTable[0]),this.multiVisi&&!this.strCCQry.toString().Contains("dcCCNID"+(this.UnitCCID-5e4).toString()+"=")&&(o+=" dcCCNID"+(this.UnitCCID-5e4).toString()+"="+this.UnitNodeID+","),a+=' <Numeric /> <Alpha /> <CostCenters   Query="'+this.strCCQry.toString()+o+'"  /> ',a+="<EXTRAXML> ",i.a.SessionManager.Preferences.ContainsKey("On")&&"True"==i.a.SessionManager.Preferences.On&&t&&""!=this.PayTermsDataTable[0].Amount.toString()){a+="<BillWise> ";for(var l=parseFloat(this.PayTermsDataTable[0].Amount.toString()),c=0;c<this.DataTable.length;c++)if(!s.e.IsEmpty(this.DataTable[c].Amount)){var u=0;if(l>parseFloat(this.DataTable[c].Amount.toString())?(l-=parseFloat(this.DataTable[c].Amount.toString()),u=parseFloat(this.DataTable[c].Amount.toString())):(u=l,l=0),a+=' <Row DocSeqNo="1" AccountID="'+this.RentRecAc.SelectedValue.toString(),a+='" AmountFC="'+u+'" AdjAmount="'+u+'"',a+=' AdjCurrID="1" ',a+='AdjExchRT="1" ',a+='IsNewReference="0" ',a+='Narration="" ',a+='IsDocPDC="0" ',a+='RefDocNo="'+(c+1).toString()+'" ',a+=" ></Row>",this.ValueUsed+=u,l<=0)break}a+=" </BillWise>"}a+="</EXTRAXML> ",a+=" </Row>"}else{a+='<Row><Transactions  CONTRACTSNO="1"  ',null!=this.PayTermsDataTable[0].Amount&&""!=this.PayTermsDataTable[0].Amount.toString()?a+=' DocDetailsID="0"  DocSeqNo="1"   CreditAccount="'+this.PayTermsDataTable[0].DebitAccountID_Key.toString()+'" DebitAccount="-99" Amount="'+parseFloat(this.PayTermsDataTable[0].Amount)+'" AmtFc="'+parseFloat(this.PayTermsDataTable[0].Amount)+'"':a+=' DocDetailsID="0"  DocSeqNo="1"   CreditAccount="'+this.PayTermsDataTable[0].DebitAccountID_Key.toString()+'" DebitAccount="-99" Amount="0" AmtFc="0" ',a+=this.CurrencyContract.SelectedValue>0?' ChequeDate = "'+n.ToString("dd/MMM/yyyy")+'"  ChequeMaturityDate = "'+n.ToString("dd/MMM/yyyy")+'"  CurrencyID="'+this.CurrencyContract.SelectedValue+'" ExchangeRate="1" CommonNarration="'+m.d.GetValidXml(this.PayTermsDataTable[0].Narration.toString())+'" LineNarration="'+m.d.GetValidXml(this.PayTermsDataTable[0].Narration.toString())+'" ChequeBankName="'+m.d.GetValidXml(this.GetPayBank(this.PayTermsDataTable[0].PayeeBank.toString()))+'" ChequeNumber="'+this.PayTermsDataTable[0].ChequeNo.toString()+'"':' ChequeDate = "'+n.ToString("dd/MMM/yyyy")+'"  ChequeMaturityDate = "'+n.ToString("dd/MMM/yyyy")+'"  CurrencyID="1" ExchangeRate="1" CommonNarration="'+m.d.GetValidXml(this.PayTermsDataTable[0].Narration.toString())+'" LineNarration="'+m.d.GetValidXml(this.PayTermsDataTable[0].Narration.toString())+'" ChequeBankName="'+m.d.GetValidXml(this.GetPayBank(this.PayTermsDataTable[0].PayeeBank.toString()))+'" ChequeNumber="'+this.PayTermsDataTable[0].ChequeNo.toString()+'"',a+="></Transactions> ";var D="";if(this.TempCCID>5e4&&!this.strCCQry.toString().Contains("dcCCNID"+(this.TempCCID-5e4).toString()+"=")&&(D=""!=this.PayTermsDataTable[0].TempCCID_Key.toString()?" dcCCNID"+(this.TempCCID-5e4).toString()+"="+this.PayTermsDataTable[0].TempCCID_Key.toString()+",":" dcCCNID"+(this.TempCCID-5e4).toString()+"=1,"),this.PayTermsDataTableColumns.Contains("Location_Key")&&!s.e.IsEmpty(this.PayTermsDataTable[0].Location_Key)?D+=" dcCCNID2="+this.PayTermsDataTable[0].Location_Key.toString()+",":this.LocationContract.Visible&&this.LocationContract.SelectedValue>0&&(D+=" dcCCNID2="+this.LocationContract.SelectedValue+","),this.PayTermsDataTableColumns.Contains("Dim_Key")&&!s.e.IsEmpty(this.PayTermsDataTable[0].Dim_Key)&&(D+=" dcCCNID"+(this.DimCCID-5e4).toString()+"="+this.PayTermsDataTable[0].Dim_Key.toString()+","),D+=this.GetSalemanXml(this.PayTermsDataTable[0]),this.multiVisi&&!this.strCCQry.toString().Contains("dcCCNID"+(this.UnitCCID-5e4).toString()+"=")&&(D+=" dcCCNID"+(this.UnitCCID-5e4).toString()+"="+this.UnitNodeID+","),a+=' <Numeric /> <Alpha /> <CostCenters   Query="'+this.strCCQry.toString()+D+'"  /> ',a+="<EXTRAXML> ",i.a.SessionManager.Preferences.ContainsKey("On")&&"True"==i.a.SessionManager.Preferences.On&&!s.e.IsEmpty(this.PayTermsDataTable[0].Amount)&&!s.e.IsEmpty(this.PayTermsDataTable[0].DebitAccountID_Key)){var h=!1,C=i.a.rental.IsBillWiseAccount(parseInt(this.PayTermsDataTable[0].DebitAccountID_Key.toString()));if(null!=C&&C.Tables.length>0&&C.Tables[0].length>0&&!s.e.IsEmpty(C.Tables[0][0].IsBillwise)&&(h=Object(r.j)(C.Tables[0][0].IsBillwise)),h){a+="<BillWise> ";var b=parseFloat(this.PayTermsDataTable[0].Amount.toString());a+=' <Row DocSeqNo="1" AccountID="'+this.PayTermsDataTable[0].DebitAccountID_Key.toString(),a+='" AmountFC="-'+b+'" AdjAmount="-'+b+'"',a+=' AdjCurrID="1" ',a+='AdjExchRT="1" ',a+='IsNewReference="1" ',a+='Narration="" ',a+='IsDocPDC="0" ',a+=" ></Row>",a+=" </BillWise>"}}if(a+="</EXTRAXML> ",a+=" </Row>",a+='<Row><Transactions  CONTRACTSNO="1"  ',s.e.IsEmpty(this.PayTermsDataTable[0].Amount)?a+=' DocDetailsID="0"  DocSeqNo="2"   CreditAccount="-99" DebitAccount="'+this.RentRecAc.SelectedValue.toString()+'" Amount="0" AmtFc="0" ':a+=' DocDetailsID="0"  DocSeqNo="2"   CreditAccount="-99" DebitAccount="'+this.RentRecAc.SelectedValue.toString()+'" Amount="'+parseFloat(this.PayTermsDataTable[0].Amount)+'" AmtFc="'+parseFloat(this.PayTermsDataTable[0].Amount)+'"',a+=this.CurrencyContract.SelectedValue>0?' ChequeDate = "'+n.ToString("dd/MMM/yyyy")+'"  ChequeMaturityDate = "'+n.ToString("dd/MMM/yyyy")+'"  CurrencyID="'+this.CurrencyContract.SelectedValue+'" ExchangeRate="1" CommonNarration="'+m.d.GetValidXml(this.PayTermsDataTable[0].Narration.toString())+'" LineNarration="'+m.d.GetValidXml(this.PayTermsDataTable[0].Narration.toString())+'" ChequeBankName="'+m.d.GetValidXml(this.GetPayBank(this.PayTermsDataTable[0].PayeeBank.toString()))+'" ChequeNumber="'+this.PayTermsDataTable[0].ChequeNo.toString()+'"':' ChequeDate = "'+n.ToString("dd/MMM/yyyy")+'"  ChequeMaturityDate = "'+n.ToString("dd/MMM/yyyy")+'"  CurrencyID="1" ExchangeRate="1" CommonNarration="'+m.d.GetValidXml(this.PayTermsDataTable[0].Narration.toString())+'" LineNarration="'+m.d.GetValidXml(this.PayTermsDataTable[0].Narration.toString())+'" ChequeBankName="'+m.d.GetValidXml(this.GetPayBank(this.PayTermsDataTable[0].PayeeBank.toString()))+'" ChequeNumber="'+this.PayTermsDataTable[0].ChequeNo.toString()+'"',a+="></Transactions> ",D="",this.TempCCID>5e4&&!this.strCCQry.toString().Contains("dcCCNID"+(this.TempCCID-5e4).toString()+"=")&&(D=s.e.IsEmpty(this.PayTermsDataTable[0].TempCCID_Key)?" dcCCNID"+(this.TempCCID-5e4).toString()+"=1,":" dcCCNID"+(this.TempCCID-5e4).toString()+"="+this.PayTermsDataTable[0].TempCCID_Key.toString()+","),this.PayTermsDataTableColumns.Contains("Location_Key")&&!s.e.IsEmpty(this.PayTermsDataTable[0].Location_Key)?D+=" dcCCNID2="+this.PayTermsDataTable[0].Location_Key.toString()+",":this.LocationContract.Visible&&this.LocationContract.SelectedValue>0&&(D+=" dcCCNID2="+this.LocationContract.SelectedValue+","),this.multiVisi&&!this.strCCQry.toString().Contains("dcCCNID"+(this.UnitCCID-5e4).toString()+"=")&&(D+=" dcCCNID"+(this.UnitCCID-5e4).toString()+"="+this.UnitNodeID+","),this.PayTermsDataTableColumns.Contains("Dim_Key")&&!s.e.IsEmpty(this.PayTermsDataTable[0].Dim_Key)&&(D+=" dcCCNID"+(this.DimCCID-5e4).toString()+"="+this.PayTermsDataTable[0].Dim_Key.toString()+","),D+=this.GetSalemanXml(this.PayTermsDataTable[0]),a+=' <Numeric /> <Alpha /> <CostCenters   Query="'+this.strCCQry.toString()+D+'"  /> ',a+="<EXTRAXML> ",i.a.SessionManager.Preferences.ContainsKey("On")&&"True"==i.a.SessionManager.Preferences.On&&t&&""!=this.PayTermsDataTable[0].Amount.toString()){a+="<BillWise> ";for(var S=parseFloat(this.PayTermsDataTable[0].Amount.toString()),d=0;d<this.DataTable.length;d++)if((s.e.IsEmpty(this.DataTable[d].DebitAccountID_Key)||!(parseInt(this.DataTable[d].DebitAccountID_Key.toString())>0))&&""!=this.DataTable[d].Amount.toString()){var T=0;if(S>parseFloat(this.DataTable[d].Amount.toString())?(S-=parseFloat(this.DataTable[d].Amount.toString()),T=parseFloat(this.DataTable[d].Amount.toString())):(T=S,S=0),a+=' <Row DocSeqNo="2" AccountID="'+this.RentRecAc.SelectedValue.toString(),a+='" AmountFC="'+T+'" AdjAmount="'+T+'"',a+=' AdjCurrID="1" ',a+='AdjExchRT="1" ',a+='IsNewReference="0" ',a+='Narration="" ',a+='IsDocPDC="0" ',a+='RefDocNo="'+(d+1).toString()+'" ',a+=" ></Row>",this.ValueUsed+=T,S<=0)break}a+=" </BillWise>"}a+="</EXTRAXML> ",a+=" </Row>"}return a+="</DocumentXML></ROWS></ReceiptXML>",Logger.InfoLog("AddEditRenContractViewModel ::Exiting GetReceiptXML"),a.toString()}}return""}},{key:"GetPDPaymentXML",value:function(t,e){var a,n="",o=new Date;Logger.InfoLog("AddEditRenContractViewModel ::Entering GetPDPaymentXML"),104==this.CurrCostCenterID?(a=0,n+="<PDPayment>"):(a=95==this.CostCenterID&&this.SinglePDC?0:1,n+="<PDR>");for(var l=0,c="";a<this.PayTermsDataTable.length;a++)if(null!=this.PayTermsDataTable[a].DebitAccountID_Key&&""!=this.PayTermsDataTable[a].DebitAccountID_Key.toString()&&parseInt(this.PayTermsDataTable[a].DebitAccountID_Key)>0&&null!=this.PayTermsDataTable[a].Amount&&""!=this.PayTermsDataTable[a].Amount.toString()&&parseFloat(this.PayTermsDataTable[a].Amount.toString())>0&&(o=new Date(this.PayTermsDataTable[a].CntrlDate_Key),c=this.BankAccounts.ContainsKey(this.PayTermsDataTable[a].DebitAccountID_Key.toString())||this.PDPAccounts.ContainsKey(this.PayTermsDataTable[a].DebitAccountID_Key.toString())?"BANK":this.CashAccounts.ContainsKey(this.PayTermsDataTable[a].DebitAccountID_Key.toString())?"CASH":"JV","370"==this.PayTermsDataTable[a].DocStatusID.toString()&&"BANK"==c)){if(++l>1&&95==this.CostCenterID&&this.SinglePDC||(n+='<ROWS><AccountType DD="'+c+'"',"370"==this.PayTermsDataTable[a].DocStatusID.toString()&&"BANK"==c&&this.CancelOnTerminate&&(n+=' CancelDOCID="'+this.PayTermsDataTable[a].DocID.toString()+'"'),n+=' ></AccountType><Documents DocID="0"></Documents><DocumentXML>'),this.strType="JV"!=c,""!=this.PayTermsDataTable[a].Amount.toString()&&(this.PDCRefund+=parseFloat(this.PayTermsDataTable[a].Amount.toString())),this.strType){n+='<Row><Transactions CONTRACTSNO="'+(a+1).toString()+'" ',n+='DocDetailsID="0" DocSeqNo="1" ',n+=104==this.CurrCostCenterID?'DebitAccount="'+this.PayTermsDataTable[a].DebitAccountID_Key.toString()+'" CreditAccount="'+this.RentRecAc.SelectedValue.toString()+'" ':'CreditAccount="'+this.PayTermsDataTable[a].DebitAccountID_Key.toString()+'" DebitAccount="'+this.RentRecAc.SelectedValue.toString()+'" ',null!=this.PayTermsDataTable[a].Amount&&""!=this.PayTermsDataTable[a].Amount.toString()?n+='Amount="'+parseFloat(this.PayTermsDataTable[a].Amount)+'"  AmtFc="'+parseFloat(this.PayTermsDataTable[a].Amount)+'" ':n+='Amount="0"  AmtFc="0" ',n+='ChequeDate = "'+o.ToString("dd/MMM/yyyy")+'" ChequeMaturityDate = "'+o.ToString("dd/MMM/yyyy")+'" ',n+=this.CurrencyContract.SelectedValue>0?'CurrencyID="'+this.CurrencyContract.SelectedValue+'" ':'CurrencyID="1" ',n+='ExchangeRate="1" CommonNarration="'+m.d.GetValidXml(this.PayTermsDataTable[a].Narration.toString())+'" LineNarration="'+m.d.GetValidXml(this.PayTermsDataTable[a].Narration.toString())+'"  ChequeBankName="'+m.d.GetValidXml(this.GetPayBank(this.PayTermsDataTable[a].PayeeBank.toString()))+'" ChequeNumber="'+this.PayTermsDataTable[a].ChequeNo.toString()+'" ',n+="></Transactions> ";var u="";if(this.TempCCID>5e4&&!this.strCCQry.toString().Contains("dcCCNID"+(this.TempCCID-5e4).toString()+"=")&&(u=""!=this.PayTermsDataTable[a].TempCCID_Key.toString()?" dcCCNID"+(this.TempCCID-5e4).toString()+"="+this.PayTermsDataTable[a].TempCCID_Key.toString()+",":" dcCCNID"+(this.TempCCID-5e4).toString()+"=1,"),this.PayTermsDataTableColumns.Contains("Location_Key")&&!s.e.IsEmpty(this.PayTermsDataTable[a].Location_Key)?u+=" dcCCNID2="+this.PayTermsDataTable[a].Location_Key.toString()+",":this.LocationContract.Visible&&this.LocationContract.SelectedValue>0&&(u+=" dcCCNID2="+this.LocationContract.SelectedValue+","),this.PayTermsDataTableColumns.Contains("Dim_Key")&&!s.e.IsEmpty(this.PayTermsDataTable[a].Dim_Key)&&(u+=" dcCCNID"+(this.DimCCID-5e4).toString()+"="+this.PayTermsDataTable[a].Dim_Key.toString()+","),u+=this.GetSalemanXml(this.PayTermsDataTable[a]),this.multiVisi&&!this.strCCQry.toString().Contains("dcCCNID"+(this.UnitCCID-5e4).toString()+"=")&&(u+=" dcCCNID"+(this.UnitCCID-5e4).toString()+"="+this.UnitNodeID+","),n+=' <Numeric /> <Alpha /> <CostCenters   Query="'+this.strCCQry.toString()+u+'"  /> ',n+="<EXTRAXML> ",i.a.SessionManager.Preferences.ContainsKey("On")&&"True"==i.a.SessionManager.Preferences.On&&t&&!s.e.IsEmpty(this.PayTermsDataTable[a].Amount)){n+="<BillWise> ";for(var D=parseFloat(this.PayTermsDataTable[a].Amount.toString()),h=0,C=0;C<this.DataTable.length;C++)if((s.e.IsEmpty(this.DataTable[C].DebitAccountID_Key)||!(parseInt(this.DataTable[C].DebitAccountID_Key.toString())>0))&&!s.e.IsEmpty(this.DataTable[C].Amount)){if((h+=parseFloat(this.DataTable[C].Amount.toString()))<=this.ValueUsed)continue;var b=0,S=h-this.ValueUsed;if(D>S?(D-=S,b=S):(b=D,D=0),n+=' <Row DocSeqNo="1" AccountID="'+this.RentRecAc.SelectedValue.toString(),n+='" AmountFC="'+b+'" AdjAmount="'+b+'"',n+=' AdjCurrID="1" ',n+='AdjExchRT="1" ',n+='IsNewReference="0" ',n+='Narration="" ',n+='IsDocPDC="0" ',n+='RefDocNo="'+(C+1).toString()+'" ',n+=" ></Row>",this.ValueUsed+=b,D<=0)break}n+=" </BillWise>"}n+="</EXTRAXML> ",n+=" </Row>"}else{n+='<Row><Transactions   CONTRACTSNO="'+(a+1).toString()+'" ',n+='DocDetailsID="0"  DocSeqNo="1"   CreditAccount="'+this.PayTermsDataTable[a].DebitAccountID_Key.toString()+'" DebitAccount="-99" ',null!=this.PayTermsDataTable[a].Amount&&""!=this.PayTermsDataTable[a].Amount.toString()?n+='Amount="'+parseFloat(this.PayTermsDataTable[a].Amount)+'" AmtFc="'+parseFloat(this.PayTermsDataTable[a].Amount)+'" ':n+='Amount="0" AmtFc="0" ',n+=' ChequeDate = "'+o.ToString("dd/MMM/yyyy")+'" ChequeMaturityDate = "'+o.ToString("dd/MMM/yyyy")+'" ',n+=this.CurrencyContract.SelectedValue>0?'CurrencyID="'+this.CurrencyContract.SelectedValue+'" ':'CurrencyID="1" ',n+='ExchangeRate="1" CommonNarration="'+m.d.GetValidXml(this.PayTermsDataTable[a].Narration.toString())+'" LineNarration="'+m.d.GetValidXml(this.PayTermsDataTable[a].Narration.toString())+'"  ChequeBankName="'+m.d.GetValidXml(this.GetPayBank(this.PayTermsDataTable[a].PayeeBank.toString()))+'" ChequeNumber="'+this.PayTermsDataTable[a].ChequeNo.toString()+'" ',n+="></Transactions> ";var d="";if(this.TempCCID>5e4&&!this.strCCQry.toString().Contains("dcCCNID"+(this.TempCCID-5e4).toString()+"=")&&(d=s.e.IsEmpty(this.PayTermsDataTable[a].TempCCID_Key)?" dcCCNID"+(this.TempCCID-5e4).toString()+"=1,":" dcCCNID"+(this.TempCCID-5e4).toString()+"="+this.PayTermsDataTable[a].TempCCID_Key.toString()+","),this.PayTermsDataTableColumns.Contains("Location_Key")&&!s.e.IsEmpty(this.PayTermsDataTable[a].Location_Key)?d+=" dcCCNID2="+this.PayTermsDataTable[a].Location_Key.toString()+",":this.LocationContract.Visible&&this.LocationContract.SelectedValue>0&&(d+=" dcCCNID2="+this.LocationContract.SelectedValue+","),this.PayTermsDataTableColumns.Contains("Dim_Key")&&!s.e.IsEmpty(this.PayTermsDataTable[a].Dim_Key)&&(d+=" dcCCNID"+(this.DimCCID-5e4).toString()+"="+this.PayTermsDataTable[a].Dim_Key.toString()+","),d+=this.GetSalemanXml(this.PayTermsDataTable[a]),this.multiVisi&&!this.strCCQry.toString().Contains("dcCCNID"+(this.UnitCCID-5e4).toString()+"=")&&(d+=" dcCCNID"+(this.UnitCCID-5e4).toString()+"="+this.UnitNodeID+","),n+=' <Numeric /> <Alpha /> <CostCenters   Query="'+this.strCCQry.toString()+d+'"  /> ',n+="<EXTRAXML> ",i.a.SessionManager.Preferences.ContainsKey("On")&&"True"==i.a.SessionManager.Preferences.On&&!s.e.IsEmpty(this.PayTermsDataTable[a].Amount)&&!s.e.IsEmpty(this.PayTermsDataTable[a].DebitAccountID_Key)){var T=!1,y=i.a.rental.IsBillWiseAccount(parseInt(this.PayTermsDataTable[a].DebitAccountID_Key.toString()));if(null!=y&&y.Tables.length>0&&y.Tables[0].length>0&&!s.e.IsEmpty(y.Tables[0][0].IsBillwise)&&(T=Object(r.j)(y.Tables[0][0].IsBillwise)),T){n+="<BillWise> ";var g=parseFloat(this.PayTermsDataTable[a].Amount.toString());n+=' <Row DocSeqNo="1" AccountID="'+this.PayTermsDataTable[a].DebitAccountID_Key.toString(),n+='" AmountFC="-'+g+'" AdjAmount="-'+g+'"',n+=' AdjCurrID="1" ',n+='AdjExchRT="1" ',n+='IsNewReference="1" ',n+='Narration="" ',n+='IsDocPDC="0" ',n+=" ></Row>",n+=" </BillWise>"}}if(n+="</EXTRAXML> ",n+=" </Row>",n+='<Row><Transactions CONTRACTSNO="'+(a+1).toString()+'" ',n+=' DocDetailsID="0" DocSeqNo="2" CreditAccount="-99" DebitAccount="'+this.RentRecAc.SelectedValue.toString()+'" ',null!=this.PayTermsDataTable[0].Amount&&""!=this.PayTermsDataTable[0].Amount.toString()?n+='Amount="'+parseFloat(this.PayTermsDataTable[a].Amount)+'"  AmtFc="'+parseFloat(this.PayTermsDataTable[a].Amount)+'" ':n+='Amount="0"  AmtFc="0" ',n+=' ChequeDate = "'+o.ToString("dd/MMM/yyyy")+'" ChequeMaturityDate = "'+o.ToString("dd/MMM/yyyy")+'" ',n+=this.CurrencyContract.SelectedValue>0?'CurrencyID="'+this.CurrencyContract.SelectedValue+'" ':'CurrencyID="1" ',n+='ExchangeRate="1" CommonNarration="'+m.d.GetValidXml(this.PayTermsDataTable[a].Narration.toString())+'" LineNarration="'+m.d.GetValidXml(this.PayTermsDataTable[a].Narration.toString())+'"  ChequeBankName="'+m.d.GetValidXml(this.GetPayBank(this.PayTermsDataTable[a].PayeeBank.toString()))+'" ChequeNumber="'+this.PayTermsDataTable[a].ChequeNo.toString()+'" ',n+="></Transactions> ",d="",this.TempCCID>5e4&&!this.strCCQry.toString().Contains("dcCCNID"+(this.TempCCID-5e4).toString()+"=")&&(d=""!=this.PayTermsDataTable[a].TempCCID_Key.toString()?" dcCCNID"+(this.TempCCID-5e4).toString()+"="+this.PayTermsDataTable[a].TempCCID_Key.toString()+",":" dcCCNID"+(this.TempCCID-5e4).toString()+"=1,"),this.PayTermsDataTableColumns.Contains("Location_Key")&&!s.e.IsEmpty(this.PayTermsDataTable[a].Location_Key)?d+=" dcCCNID2="+this.PayTermsDataTable[a].Location_Key.toString()+",":this.LocationContract.Visible&&this.LocationContract.SelectedValue>0&&(d+=" dcCCNID2="+this.LocationContract.SelectedValue+","),this.PayTermsDataTableColumns.Contains("Dim_Key")&&!s.e.IsEmpty(this.PayTermsDataTable[a].Dim_Key)&&(d+=" dcCCNID"+(this.DimCCID-5e4).toString()+"="+this.PayTermsDataTable[a].Dim_Key.toString()+","),d+=this.GetSalemanXml(this.PayTermsDataTable[a]),this.multiVisi&&!this.strCCQry.toString().Contains("dcCCNID"+(this.UnitCCID-5e4).toString()+"=")&&(d+=" dcCCNID"+(this.UnitCCID-5e4).toString()+"="+this.UnitNodeID+","),n+=' <Numeric /> <Alpha /> <CostCenters   Query="'+this.strCCQry.toString()+d+'"  /> ',n+="<EXTRAXML> ",i.a.SessionManager.Preferences.ContainsKey("On")&&"True"==i.a.SessionManager.Preferences.On&&t&&!s.e.IsEmpty(this.PayTermsDataTable[a].Amount)){n+="<BillWise> ";for(var I=parseFloat(this.PayTermsDataTable[a].Amount.toString()),p=0,A=0;A<this.DataTable.length;A++)if((s.e.IsEmpty(this.DataTable[A].DebitAccountID_Key)||!(parseInt(this.DataTable[A].DebitAccountID_Key.toString())>0))&&!s.e.IsEmpty(this.DataTable[A].Amount)){if((p+=parseFloat(this.DataTable[A].Amount.toString()))<this.ValueUsed)continue;var f=0,P=p-this.ValueUsed;if(I>P?(I-=P,f=P):(f=I,I=0),n+=' <Row DocSeqNo="2" AccountID="'+this.RentRecAc.SelectedValue.toString(),n+='" AmountFC="'+f+'" AdjAmount="'+f+'"',n+=' AdjCurrID="1" ',n+='AdjExchRT="1" ',n+='IsNewReference="0" ',n+='Narration="" ',n+='IsDocPDC="0" ',n+='RefDocNo="'+(A+1).toString()+'" ',n+=" ></Row>",this.ValueUsed+=f,I<=0)break}n+=" </BillWise>"}n+="</EXTRAXML> ",n+=" </Row>"}95==this.CostCenterID&&this.SinglePDC||(n+='</DocumentXML><ChequeDocDate DD="'+o.ToString("dd/MMM/yyyy")+'"></ChequeDocDate></ROWS>')}if(null!=e&&e.Tables.length>6&&e.Tables[6].length>0)for(a=0;a<e.Tables[6].length;a++)if(""!=e.Tables[6][a].Amount.toString()&&parseFloat(e.Tables[6][a].Amount.toString())>0){95==this.CostCenterID&&this.SinglePDC||(n+='<ROWS><AccountType DD="BANK"',this.CancelOnTerminate&&(n+=' CancelDOCID="'+e.Tables[6][a].DocID.toString()+'"'),n+=' ></AccountType><Documents DocID="0"></Documents><DocumentXML>'),n+='<Row><Transactions CONTRACTSNO="'+(a+1).toString()+'" DocDetailsID="0" DocSeqNo="1" ',n+='CreditAccount="'+e.Tables[6][a].DebitAccount.toString()+'" DebitAccount="'+e.Tables[6][a].CreditAccount.toString()+'" ',n+=' CurrencyID="1" ExchangeRate="1"  Amount="'+parseFloat(e.Tables[6][a].Amount)+'"  AmtFc="'+parseFloat(e.Tables[6][a].Amount)+'" ',""!=e.Tables[6][a].ChequeDate.toString()&&(n+='ChequeDate = "'+new Date(e.Tables[6][a].ChequeDate.toString()).ToString("dd/MMM/yyyy")+'" '),""!=e.Tables[6][a].ChequeMaturityDate.toString()&&(n+='ChequeMaturityDate = "'+new Date(e.Tables[6][a].ChequeMaturityDate.toString()).ToString("dd/MMM/yyyy")+'" '),n+='CommonNarration="'+e.Tables[6][a].Narration.toString()+'" LineNarration="'+e.Tables[6][a].Narration.toString()+'"  ChequeBankName="'+e.Tables[6][a].ChequeBankName.toString()+'" ChequeNumber="'+e.Tables[6][a].ChequeNumber.toString()+'" ',n+="></Transactions> ";var N=this.AddRowCC(e.Tables[6][a],null,0,0,e.Tables[6]);n+=' <Numeric /> <Alpha /> <CostCenters   Query="'+this.strCCQry.toString()+N+'"  />   ',n+="<EXTRAXML> </EXTRAXML>  </Row>",95==this.CostCenterID&&this.SinglePDC||(n+=" </DocumentXML></ROWS>")}return 104==this.CurrCostCenterID?n+="</PDPayment>":(95==this.CostCenterID&&this.SinglePDC&&n.length>10&&(n+=" </DocumentXML></ROWS>"),n+="</PDR>"),Logger.InfoLog("AddEditRenContractViewModel ::Exiting GetPDReceiptXML"),n.toString()}},{key:"GetMonthlyTerminatedValue",value:function(t,e){for(var a=s.e.Round(t/e,this.Mdeci),n=0,i=this.TerminationDate.Date(),r=0;i<=this.EndDate.Date;)1==++r&&1!=i.getDate()?n+=s.e.Round(a/i.DaysInMonth()*(i.DaysInMonth()-i.getDate()),this.Mdeci):i.AddMonths(1)>this.EndDate.Date&&this.EndDate.Date.getDate()!=i.DaysInMonth()?n+=s.e.Round(a/i.DaysInMonth()*this.EndDate.Date.getDate(),this.Mdeci):n+=a,i=1==r?i.AddDays(i.DaysInMonth()-i.getDate()+1):i.AddMonths(1);return t-a*e!=0&&(n+=t-a*e),s.e.Round(n,this.Mdeci)}},{key:"GetPartPaymentXML",value:function(t){var e=this,a="",n=new Date;Logger.InfoLog("AddEditRenContractViewModel ::Entering GetPartPaymentXML"),a+="<PARTICULARS>";for(var r=1;r<this.DataTable.length;r++){if(null!=this.DataTable[r].DebitAccountID_Key&&""!=this.DataTable[r].DebitAccountID_Key.toString()&&parseInt(this.DataTable[r].DebitAccountID_Key.toString())>0&&null!=this.DataTable[r].Amount&&""!=this.DataTable[r].Amount.toString()&&parseFloat(this.DataTable[r].Amount.toString())>0&&"0"!=this.DataTable[r].Refund.toString())if("continue"===function(){var o=parseFloat(e.DataTable[r].Amount.toString());if("True"==e.DataTable[r].PostDebit.toString())return"continue";if("2"==e.DataTable[r].Refund.toString()){var l=e.CalculateMonths();l>1&&"Daily"!=e.BasedOn.SelectedValue?o=e.GetMonthlyTerminatedValue(o,l):(o-=o/e.GetDays()*(e.TerminationDate.Date.Subtract(e.StartDate.Date).Days+1),o=s.e.Round(o,e.Mdeci))}s.e.IsEmpty(e.DataTable[r].CntrlDate_Key)||""==s.e.StringValue(e.DataTable[r].CntrlDate_Key)||(n=new Date(e.DataTable[r].CntrlDate_Key)),e.BankAccounts.ContainsKey(s.e.StringValue(e.DataTable[r].DebitAccountID_Key))?a+='<ROWS><AccountType DD="BANK"></AccountType><Documents DocID="0"></Documents><DocumentXML>':a+='<ROWS><AccountType DD="CASH"></AccountType><Documents DocID="0"></Documents><DocumentXML>';var c=1,u=null;if(!s.e.IsEmpty(e.DataTable[r].Xml)&&e.multiVisi){var D=new s.f;D.LoadXml(e.DataTable[r].Xml.toString()),D.ChildNodes.length>0&&null!=D.ChildNodes[0].Attributes&&null!=D.ChildNodes[0].attributes.Filter&&!s.e.StringIsNullOrEmpty(D.ChildNodes[0].attributes.Filter.value)&&(0!=parseInt(D.ChildNodes[0].attributes.Filter.value)&&1!=parseInt(D.ChildNodes[0].attributes.Filter.value)||(c=e.SelectedUnits.split(",").length,u=0==parseInt(D.ChildNodes[0].attributes.Filter.value)?D.SelectNodes("XML/UnitsRow"):D.SelectNodes("XML/Row"),null==e.MultiNode&&(e.MultiNode=i.a.rental.GetUnitNodeIDs(e.SelectedUnits))))}for(var h=function(l){null!=u&&c>1&&u.length>l&&null!=u[l].attributes.Amount&&!s.e.StringIsNullOrEmpty(u[l].attributes.Amount.value)&&(o=parseFloat(u[l].attributes.Amount.value),"2"==e.DataTable[r].Refund.toString())&&(o-=o/e.GetDays()*(e.TerminationDate.Date.Subtract(e.StartDate.Date).Days+1),o=s.e.Round(o,e.Mdeci)),a+='<Row><Transactions  CONTRACTSNO="'+(r+1).toString()+'" ',a+='DocDetailsID="0"  DocSeqNo="1" ',a+=104==e.CurrCostCenterID?'DebitAccount="'+e.DataTable[r].DebitAccountID_Key.toString()+'" CreditAccount="'+e.RentRecAc.SelectedValue+'" ':e.DontpostSIV?'CreditAccount="'+e.DataTable[r].DebitAccountID_Key.toString()+'" DebitAccount="'+e.DataTable[r].CreditAccountID_Key.toString()+'" ':'CreditAccount="'+e.DataTable[r].DebitAccountID_Key.toString()+'" DebitAccount="'+e.RentRecAc.SelectedValue+'" ',a+='Amount="'+o+'" AmtFc="'+o+'" ',n&&null!=e.DataTable[r].ChequeNo&&""!=e.DataTable[r].ChequeNo.toString()&&null!=e.DataTable[r].PayeeBank&&""!=e.DataTable[r].PayeeBank.toString()?(a+='ChequeDate = "'+n.ToString("dd/MMM/yyyy")+'" ChequeMaturityDate = "'+n.ToString("dd/MMM/yyyy")+'" ',a+=e.CurrencyContract.SelectedValue>0?'CurrencyID="'+e.CurrencyContract.SelectedValue+'" ':'CurrencyID="1" ',a+='ExchangeRate="1"  ChequeBankName="'+m.d.GetValidXml(e.GetPayBank(e.DataTable[r].PayeeBank.toString()))+'" ChequeNumber="'+e.DataTable[r].ChequeNo.toString()+'" '):(a+=n?' ChequeDate = "'+n.ToString("dd/MMM/yyyy")+'" ChequeMaturityDate = "'+n.ToString("dd/MMM/yyyy")+'" ':' ChequeDate = "" ChequeMaturityDate = "" ',a+=e.CurrencyContract.SelectedValue>0?'CurrencyID="'+e.CurrencyContract.SelectedValue+'" ':'CurrencyID="1" ',a+='ExchangeRate="1" ChequeBankName="" ChequeNumber="" '),a+='CommonNarration="'+m.d.GetValidXml(e.DataTable[r].Narration.toString())+'" LineNarration="'+m.d.GetValidXml(e.DataTable[r].Narration.toString())+'" ',a+="></Transactions> ";var D="";if(e.TempCCID>5e4&&!e.strCCQry.toString().Contains("dcCCNID"+(e.TempCCID-5e4).toString()+"=")&&(D=s.e.IsEmpty(e.DataTable[r].TempCCID_Key)?" dcCCNID"+(e.TempCCID-5e4).toString()+"=1,":" dcCCNID"+(e.TempCCID-5e4).toString()+"="+e.DataTable[r].TempCCID_Key.toString()+","),e.DataTableColumns.Contains("Location_Key")&&!s.e.IsEmpty(e.DataTable[r].Location_Key)?D+=" dcCCNID2="+e.DataTable[r].Location_Key.toString()+",":e.LocationContract.Visible&&e.LocationContract.SelectedValue>0&&(D+=" dcCCNID2="+e.LocationContract.SelectedValue+","),e.DataTableColumns.Contains("Dim_Key")&&!s.e.IsEmpty(e.DataTable[r].Dim_Key)&&(D+=" dcCCNID"+(e.DimCCID-5e4).toString()+"="+e.DataTable[r].Dim_Key.toString()+","),D+=e.GetSalemanXml(e.DataTable[r]),e.multiVisi&&!e.strCCQry.toString().Contains("dcCCNID"+(e.UnitCCID-5e4).toString()+"="))if(null!=u&&c>1&&u.length>l&&null!=u[l].attributes.Unit&&!s.e.StringIsNullOrEmpty(u[l].attributes.Unit.Value)){var h=e.MultiNode.filter((function(t){return t.UnitID==u[l].attributes.Unit.value}));h.length>0&&(D+=" dcCCNID"+(e.UnitCCID-5e4).toString()+"="+h[0].nodeid.toString()+",")}else D+=" dcCCNID"+(e.UnitCCID-5e4).toString()+"="+e.UnitNodeID+",";a+=' <Numeric /> <Alpha /> <CostCenters   Query="'+e.strCCQry.toString()+D+'"  /> ',a+="<EXTRAXML> ",i.a.SessionManager.Preferences.ContainsKey("On")&&"True"==i.a.SessionManager.Preferences.On&&t&&!e.DontpostSIV&&(a+='<BillWise> <Row DocSeqNo="1" AccountID="'+e.RentRecAc.SelectedValue.toString(),a+=104==e.CurrCostCenterID?'" AmountFC="'+o+'" AdjAmount="'+o+'"':'" AmountFC="-'+o+'" AdjAmount="-'+o+'"',a+=' AdjCurrID="1" ',a+='AdjExchRT="1" ',a+='IsNewReference="0" ',a+='Narration="" ',a+='IsDocPDC="0" ',a+='RefDocNo="'+(r+1).toString()+'" ',a+=" ></Row></BillWise>"),a+="</EXTRAXML> ",a+=" </Row>"},C=0;C<c;C++)h(C);a+=n?'</DocumentXML><ChequeDocDate DD="'+n.ToString("dd/MMM/yyyy")+'"></ChequeDocDate></ROWS>':'</DocumentXML><ChequeDocDate DD="'+(new Date).ToString("dd/MMM/yyyy")+'"></ChequeDocDate></ROWS>'}())continue}return a+="</PARTICULARS>",Logger.InfoLog("AddEditRenContractViewModel ::Exiting GetPartPaymentXML"),a.toString()}},{key:"GetSRTXML",value:function(t,e,a,n,r,o){var l=this;Logger.InfoLog("AddEditRenContractViewModel ::Entering GetSRTXML");var c="",u=1,D="";c+=104==this.CurrCostCenterID?"<PIV>":"<SIV>",this.DimCCID<5e4&&this.SingleInvoice&&(c+='<ROWS><Documents DocID="0" CONTRACTSNO="'+(u++).toString()+'"></Documents><DocumentXML>');var h,C=0;this.DataTable.length>0&&""!=this.DataTable[0].Amount.toString()&&(C=s.e.Round(s.e.Double(this.DataTable[0].Amount.toString())/this.GetDays(),this.dDeci)),h=this.DimCCID>5e4?this.DataTable.filter((function(t){return t.Amount>0}),"Dim_Key desc"):this.DataTable;for(var b=0,S="",d=0,T=function(t){var T=0,y=0,I=0;if(l.DistribtueInvoice&&l.SingleInvoice&&95==l.CostCenterID&&(2==n||3==n)&&!s.e.IsEmpty(h[t].Amount)&&s.e.Double(h[t].Amount)>0){y=s.e.Double(h[t].Amount.toString());var p=e.filter((function(e){return e.PartID==h[t].NodeID.toString()})).Compute("sum","TotInv");if(s.e.IsEmpty(p)||(T=s.e.Double(h[t].Amount.toString())-s.e.Double(p)),T>.01)return{v:(l.DisplayMessage="Pending recur invoice.",l.MessageVisibility=!0,"")}}if(!s.e.IsEmpty(h[t].Amount)&&s.e.Double(h[t].Amount)>0&&(h[t].NodeID.toString()==l.id2.toString()||5==n||"1"==s.e.String(h[t].Refund)||1==n&&""!=s.e.String(h[t].AdvanceAcc)&&"2"==s.e.String(h[t].Refund))){if(h[t].NodeID.toString()!=l.id2.toString()&&l.DontpostSIV&&!s.e.IsEmpty(h[t].DebitAccountID_Key)&&parseInt(h[t].DebitAccountID_Key.toString())>0)return"continue";if(y=0,I=0,5==n){var A=e.filter((function(e){return e.PartID==h[t].NodeID.toString()})).Compute("sum","TotInv");null!=A&&null!=A&&(y=s.e.Double(A))}else h[t].NodeID.toString()==l.id2.toString()?(r||1!=n||l.GetSalesReturnAmount(a),y=l.SRTAmount):y=s.e.Double(h[t].Amount.toString());if(y>0){var f=function(){l.DimCCID>5e4?(S!=h[t].Dim_Key.toString()&&(b>0&&(c+="</DocumentXML></ROWS>"),c+='<ROWS><Documents DocID="0" CONTRACTSNO="'+(u++).toString()+'"></Documents><DocumentXML>'),b++,S=h[t].Dim_Key.toString()):l.SingleInvoice||(c+='<ROWS><Documents DocID="0" CONTRACTSNO="'+(u++).toString()+'"></Documents><DocumentXML>');var a=1,r=null;if(5!=n&&!s.e.IsEmpty(h[t].Xml)&&l.multiVisi){var p=new s.f;p.LoadXml(h[t].Xml.toString()),p.ChildNodes.length>0&&null!=p.ChildNodes[0].Attributes&&null!=p.ChildNodes[0].attributes.Filter&&!s.e.StringIsNullOrEmpty(p.ChildNodes[0].attributes.Filter.value)&&(0!=parseInt(p.ChildNodes[0].attributes.Filter.value)&&1!=parseInt(p.ChildNodes[0].attributes.Filter.value)||(a=l.SelectedUnits.split(",").length,r=0==parseInt(p.ChildNodes[0].attributes.Filter.value)?p.SelectNodes("XML/UnitsRow"):p.SelectNodes("XML/Row"),null==l.MultiNode&&(l.MultiNode=i.a.rental.GetUnitNodeIDs(l.SelectedUnits))))}for(var A=function(u){var b=null;if(null!=r&&a>1&&r.length>u&&null!=r[u].attributes.Unit&&!s.e.StringIsNullOrEmpty(r[u].attributes.Unit.value)&&(g=l.MultiNode.filter((function(t){return t.UnitID==r[u].attributes.Unit.value}))).length>0&&(b=g[0]),T=0,l.DistribtueInvoice&&l.SingleInvoice&&e.length>0)if(null!=r&&null!=b&&a>1&&r.length>u&&null!=r[u].attributes.Amount&&!s.e.StringIsNullOrEmpty(r[u].attributes.Amount.value)){var S=e.filter((function(e){return e.PartID==h[t].NodeID.toString()&&e.UnitID==b.nodeid.toString()})).Compute("sum","TotInv");null!=S&&null!=S&&(T=s.e.Double(r[u].attributes.Amount.value)-s.e.Double(S))}else{var p=e.filter((function(e){return e.PartID==h[t].NodeID.toString()})).Compute("sum","TotInv");null!=p&&null!=p&&(T=s.e.Double(h[t].Amount.toString())-s.e.Double(p))}if(5!=n){if(h[t].NodeID.toString()!=l.id2.toString()&&1==a&&"2"==h[t].Refund.toString()&&l.DataTableColumns.Contains("srtAmt")&&!s.e.IsEmpty(h[t].srtAmt)?(y=s.e.Double(h[t].srtAmt.toString()),l.DataTableColumns.Contains("DiscReturn")&&""!=h[t].DiscReturn.toString()&&(I=parseFloat(h[t].DiscReturn.toString()))):null!=b&&b.Table.Columns.Contains(h[t].NodeID.toString())&&""!=b[h[t].NodeID.toString()].toString()?(y=s.e.Double(b[h[t].NodeID.toString()].toString()),b.Table.Columns.Contains(h[t].NodeID.toString()+"Disc")&&""!=b[h[t].NodeID.toString()+"Disc"].toString()&&(I=parseFloat(b[h[t].NodeID.toString()+"Disc"].toString()))):null!=r&&a>1&&r.length>u&&null!=r[u].attributes.Amount&&!s.e.IsEmpty(r[u].attributes.Amount.value)&&(y=s.e.Double(r[u].attributes.Amount.value)),C<1&&y-T<-.01)return{v:{v:{v:(l.DisplayMessage="Pending recur invoice.",l.MessageVisibility=!0,"")}}};if(y-T<-1)return{v:{v:{v:(l.DisplayMessage="Pending recur invoice.",l.MessageVisibility=!0,"")}}};if(1==n&&(y-=T),h[t].NodeID.toString()!=l.id2.toString())if(l.RefundAmt+=y,(P=l.dtTerm.filter((function(e){return e.NodeID==h[t].NodeID.toString()}))).length>0)P[0].Amt=parseFloat(P[0].Amt.toString())+y;else{var A={};A.NodeID=h[t].NodeID.toString(),A.Amt=y,!s.e.IsEmpty(h[t].AdvanceAcc)&&parseInt(h[t].AdvanceAcc.toString())>0&&(A.IsAdv=1),l.dtTerm.push(A)}}if(0==y)return l.DimCCID<5e4&&!l.SingleInvoice&&(c+="</DocumentXML></ROWS>"),"continue";c+="<RowHead/><Row><Transactions ",c+='DocDetailsID="0" BillDate="'+l.ContractDate.Date.ToString("dd/MMM/yyyy")+'" DocSeqNo="1" LinkedInvDocDetailsID= "" LinkedFieldName= "" ProductID="'+l.ProductID+'" ',c+=l.CurrencyContract.SelectedValue>0?'CurrencyID="'+l.CurrencyContract.SelectedValue+'" ':'CurrencyID="1" ',c+='ExchangeRate="1" Unit="1" UOMConversion="1" ',104==l.CurrCostCenterID?c+='CreditAccount="'+h[t].CreditAccountID_Key.toString()+'" DebitAccount="'+l.RentRecAc.SelectedValue.toString()+'" ':(s.e.IsEmpty(h[t].AdvanceAcc)?c+='DebitAccount="'+h[t].CreditAccountID_Key.toString():c+='DebitAccount="'+h[t].AdvanceAcc.toString(),"True"!=h[t].PostDebit.toString()||s.e.IsEmpty(h[t].DebitAccountID_Key)?c+='" CreditAccount="'+l.RentRecAc.SelectedValue.toString()+'" ':c+='" CreditAccount="'+h[t].DebitAccountID_Key.toString()+'" '),c+=' Quantity="1" Rate="'+y.toString()+'" Gross="'+y.toString()+'" CommonNarration="'+m.d.GetValidXml(l.Narration.Text)+'" LineNarration="'+m.d.GetValidXml(h[t].Narration.toString())+'" ',c+="></Transactions> ";var f="";l.TempCCID>5e4&&!l.strCCQry.toString().Contains("dcCCNID"+(l.TempCCID-5e4).toString()+"=")&&(f=s.e.IsEmpty(h[t].TempCCID_Key)?" dcCCNID"+(l.TempCCID-5e4).toString()+"=1,":" dcCCNID"+(l.TempCCID-5e4).toString()+"="+h[t].TempCCID_Key.toString()+","),l.DataTableColumns.Contains("Location_Key")&&!s.e.IsEmpty(h[t].Location_Key)?f+=" dcCCNID2="+h[t].Location_Key.toString()+",":l.LocationContract.Visible&&l.LocationContract.SelectedValue>0&&(f+=" dcCCNID2="+l.LocationContract.SelectedValue+","),l.DataTableColumns.Contains("Dim_Key")&&!s.e.IsEmpty(h[t].Dim_Key)&&(f+=" dcCCNID"+(l.DimCCID-5e4).toString()+"="+h[t].Dim_Key.toString()+","),f+=l.GetSalemanXml(h[t]),i.a.SessionManager.Preferences.ContainsKey("DepositLinkDimension")&&""!=i.a.SessionManager.Preferences.DepositLinkDimension&&parseInt(i.a.SessionManager.Preferences.DepositLinkDimension)>0&&(f+=" dcCCNID"+(parseInt(i.a.SessionManager.Preferences.DepositLinkDimension)-5e4).toString()+"="+h[t].NodeID.toString()+","),s.e.IsEmpty(h[t].TaxCategory_Key)||(f+=" dcCCNID60="+h[t].TaxCategory_Key.toString()+","),l.DataTableColumns.Contains("SPType_Key")&&!s.e.IsEmpty(h[t].SPType_Key)&&(f+=" dcCCNID61="+h[t].SPType_Key.toString()+","),l.multiVisi&&!l.strCCQry.toString().Contains("dcCCNID"+(l.UnitCCID-5e4).toString()+"=")&&(f+=null!=b?" dcCCNID"+(l.UnitCCID-5e4).toString()+"="+b.nodeid.toString()+",":" dcCCNID"+(l.UnitCCID-5e4).toString()+"="+l.UnitNodeID+","),c+=' <Numeric Query="',I>0&&""!=l.Discountfield&&(c+=l.Discountfield+"=-"+I.toString().Replace(",","")+","+l.Discountfield.Replace("dcNum","dcCalcNum")+"=-"+I.toString().Replace(",","")+",");var N="";if(i.a.SessionManager.Preferences.ContainsKey("VATVersion")?("Inclusive"==h[t].VatType.toString()&&!s.e.IsEmpty(h[t].VatPer)&&s.e.Double(h[t].VatPer.toString())>0&&(y=100*y/(s.e.Double(h[t].VatPer)+100)),N=!s.e.IsEmpty(h[t].VatPer)&&s.e.Double(h[t].VatPer.toString())>0?(y*s.e.Double(h[t].VatPer)/100).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()):"0",c+=" dcNum51="+y.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()).replace(",","")+",dcCalcNum51="+y.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount.toString()).replace(",",""),!s.e.IsEmpty(h[t].VatPer)&&s.e.Double(h[t].VatPer.toString())>0?(c+=",dcNum52="+h[t].VatPer.toString().replace(",","")+",dcCalcNum52="+h[t].VatPer.toString().replace(",",""),c+=",dcNum60="+h[t].VatPer.toString().replace(",","")+",dcCalcNum60="+h[t].VatPer.toString().replace(",","")):c+=",dcCalcNum52=0,dcNum52=0,dcNum60=0,dcCalcNum60=0",c+=",dcNum53="+N.replace(",","")+",dcCalcNum53="+N.replace(",",""),c+=",dcNum61="+N.replace(",","")+",dcCalcNum61="+N.replace(",","")+",",l.VatAmt=l.VatAmt+s.e.Double(N.replace(",","")),c+='" /> <Alpha  Query="',c+="dcAlpha153='"+h[t].VatType.toString()+"',",c+="dcAlpha152='Service',",c+='" />'):c+='" /> <Alpha />',c+=' <CostCenters   Query="'+l.strCCQry.toString()+f+'"  /> <EXTRAXML/> ',!l.DonotUpdateAccounts){var V,R;c+="<AccountsXML>",104==l.CurrCostCenterID?(R=h[t].CreditAccountID_Key.toString(),V=l.RentRecAc.SelectedValue.toString()):(V=s.e.IsEmpty(h[t].AdvanceAcc)?s.e.StringValue(h[t].CreditAccountID_Key):h[t].AdvanceAcc.toString(),R=s.e.IsEmpty(h[t].DebitAccountID_Key)||"True"!=h[t].PostDebit.toString()?l.RentRecAc.SelectedValue.toString():s.e.StringValue(h[t].DebitAccountID_Key));var M={CostXML1:""};if(l.FillCostPosting(o,V,R,parseFloat(y.toString()),h[t],l.costDims,i.a.SessionManager.Preferences.DecimalsinAmount.toString(),r,a,u,M,h)?D+=M.CostXML1:(c+="<Accounts  ",c+='CreditAccount="'+R+'"  DebitAccount="'+V+'" ',c+='Amount="'+y.toString()+'" AmtFc="'+y.toString()+'" ',c+=l.CurrencyContract.SelectedValue>0?'CurrencyID="'+l.CurrencyContract.SelectedValue+'" ':'CurrencyID="1" ',c+='ExchangeRate="1"  ></Accounts>'),!s.e.IsEmpty(N)&&"0"!=N){104==l.CurrCostCenterID?(R=l.VatAccountID.toString(),V=l.RentRecAc.SelectedValue.toString()):(V=l.VatAccountID.toString(),R=l.RentRecAc.SelectedValue.toString());var E={CostXML1:""};l.FillCostPosting(o,V,R,parseFloat(N),h[t],l.costDims,i.a.SessionManager.Preferences.DecimalsinAmount.toString(),r,a,u,E,h)?D+=E.CostXML1:(c+="<Accounts ",c+='CreditAccount="'+R+'"  DebitAccount="'+V+'" ',c+='Amount="'+N.toString().Replace(",","")+'" AmtFc="'+N.toString().Replace(",","")+'" ',c+=l.CurrencyContract.SelectedValue>0?'CurrencyID="'+l.CurrencyContract.SelectedValue+'" ':'CurrencyID="1" ',c+='ExchangeRate="1"  ></Accounts>')}I>0&&(104==l.CurrCostCenterID?(R=l.RentRecAc.SelectedValue.toString(),V=l.DiscountAccount.toString()):(R=l.DiscountAccount.toString(),V="True"==h[t].PostDebit.toString()&&""!=h[t].DebitAccountID_Key.toString()?h[t].DebitAccountID_Key.toString():l.RentRecAc.SelectedValue.toString()),l.FillCostPosting(o,V,R,-I,h[t],l.costDims,i.a.SessionManager.Preferences.DecimalsinAmount.toString(),r,a,u,M,h)?D+=M.CostXML1:(c+="<Accounts ",c+='CreditAccount="'+R+'"  DebitAccount="'+V+'" ',c+='Amount="'+I.toString().Replace(",","")+'" AmtFc="'+I.toString().Replace(",","")+'"  ',c+=l.CurrencyContract.SelectedValue>0?'CurrencyID="'+l.CurrencyContract.SelectedValue+'" ':'CurrencyID="1" ',c+='ExchangeRate="1"  ></Accounts>')),c+="</AccountsXML>"}c+=" </Row>",s.e.IsEmpty(h[t].VatPer)||(d+=y*s.e.Double(h[t].VatPer)/100)},f=0;f<a;f++){var N=A(f);if("continue"!==N&&"object"==typeof N)return N.v}l.DimCCID<5e4&&!l.SingleInvoice&&(s.e.IsEmpty(D)||(c+=D),D="",c+="</DocumentXML></ROWS>")}();if("object"==typeof f)return f.v}}},y=0;y<h.length;y++){var g,I=T(y);if("continue"!==I&&"object"==typeof I)return I.v}if(!i.a.SessionManager.Preferences.ContainsKey("VATVersion")&&1==n&&d>0&&this.VatNode>0&&95==this.CurrCostCenterID){var p=h.filter((function(t){return t.NodeID==l.VatNode}));p.length>0&&"2"==s.e.StringValue(p[0].Refund)&&(c+='<ROWS><Documents DocID="0" CONTRACTSNO="'+(u++).toString()+'"></Documents><DocumentXML>',c+="<RowHead/><Row><Transactions  ",c+='DocDetailsID="0" BillDate="'+this.ContractDate.Date.ToString("dd/MMM/yyyy")+'"  DocSeqNo="1"  LinkedInvDocDetailsID= ""  LinkedFieldName= "" ProductID="'+this.ProductID+'" CurrencyID="1" ExchangeRate="1" Unit="1" UOMConversion="1" ',c+='DebitAccount="'+p[0].CreditAccountID_Key.toString()+'" CreditAccount="'+this.RentRecAc.SelectedValue.toString()+'" ',c+=' Quantity="1"  Rate="'+d.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount)+'"  Gross="'+d.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount)+'"   CommonNarration="'+m.d.GetValidXml(this.Narration.Text)+'" ',c+="></Transactions> ",c+=' <Numeric /> <Alpha /> <CostCenters   Query="'+this.strCCQry.toString()+'"   /> <EXTRAXML/>',this.DonotUpdateAccounts||(c+="<AccountsXML><Accounts ",c+='DebitAccount="'+p[0].CreditAccountID_Key.toString()+'"  CreditAccount="'+this.RentRecAc.SelectedValue.toString()+'" ',c+='Amount="'+d.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount).replace(",","")+'" AmtFc="'+d.ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount).replace(",","")+'" ',c+=this.CurrencyContract.SelectedValue>0?'CurrencyID="'+this.CurrencyContract.SelectedValue+'" ':'CurrencyID="1" ',c+='ExchangeRate="1"  ></Accounts></AccountsXML>'),c+=" </Row>",this.SingleInvoice||(c+="</DocumentXML></ROWS>"))}if(t.length>0)for(var A=function(e){if(!s.e.IsEmpty(t[e].Amount)&&s.e.Double(t[e]["Amount".toString()])>0){if(l.RefundAmt+=parseFloat(t[e].Amount.toString()),(P=l.dtTerm.filter((function(a){return a.NodeID==t[e].CCNodeID.toString()}))).length>0)P[0].Amt=parseFloat(P[0].Amt.toString())+parseFloat(t[e].Amount.toString());else{var a={};a.NodeID=t[e].CCNodeID.toString(),a.Amt=parseFloat(t[e].Amount.toString()),l.dtTerm.push(a)}l.SingleInvoice||(c+='<ROWS><Documents DocID="0" CONTRACTSNO="'+(u++).toString()+'"></Documents><DocumentXML>'),c+="<RowHead/><Row><Transactions  ",c+='DocDetailsID="0" BillDate="'+l.ContractDate.Date.ToString("dd/MMM/yyyy")+'"  DocSeqNo="1"  LinkedInvDocDetailsID= ""  LinkedFieldName= "" ProductID="'+l.ProductID+'" CurrencyID="1" ExchangeRate="1" Unit="1" UOMConversion="1" ',c+=104==l.CurrCostCenterID?'CreditAccount="'+t[e].CreditAccID.toString()+'" DebitAccount="'+l.RentRecAc.SelectedValue.toString()+'" ':'DebitAccount="'+t[e].CreditAccID.toString()+'" CreditAccount="'+l.RentRecAc.SelectedValue.toString()+'" ',c+=' Quantity="1"  Rate="'+t[e].Amount.toString()+'"  Gross="'+t[e].Amount.toString()+'"   CommonNarration="'+m.d.GetValidXml(l.Narration.Text)+'" ',c+="></Transactions> ";var n="";i.a.SessionManager.Preferences.ContainsKey("DepositLinkDimension")&&""!=i.a.SessionManager.Preferences.DepositLinkDimension&&parseInt(i.a.SessionManager.Preferences.DepositLinkDimension)>0&&(n+=" dcCCNID"+(parseInt(i.a.SessionManager.Preferences.DepositLinkDimension)-5e4).toString()+"="+t[e].CCNodeID.toString()+","),s.e.IsEmpty(t[e].TaxCategoryID)||(n+=" dcCCNID60="+t[e].TaxCategoryID.toString()+","),l.DimCCID>0&&50002==l.DimCCID||(Object.keys(t[e]).Contains("LocationID")&&!s.e.IsEmpty(t[e].LocationID)?n+=" dcCCNID2="+t[e].LocationID.toString()+",":l.LocationContract.Visible&&l.LocationContract.SelectedValue>0&&(n+=" dcCCNID2="+l.LocationContract.SelectedValue+",")),Object.keys(t[e]).Contains("SPType")&&!s.e.IsEmpty(t[e].SPType)&&(n+=" dcCCNID61="+t[e].SPType.toString()+","),Object.keys(t[e]).Contains("DimNodeID")&&!s.e.IsEmpty(t[e].DimNodeID)&&(n+=" dcCCNID"+(l.DimCCID-5e4).toString()+"="+t[e].DimNodeID.toString()+",");for(var r=0;r<l.ContractParticular.length;r++)l.ContractParticular[r].DisplayMember.startsWith("CCNID")&&t.Contains(l.ContractParticular[r].DisplayMember)&&""!=t[e][l.ContractParticular[r].DisplayMember].toString()&&(n+=" dc"+l.ContractParticular[r].DisplayMember+"="+t[e][l.ContractParticular[r].DisplayMember].toString()+",");c+=' <Numeric Query="',i.a.SessionManager.Preferences.ContainsKey("VATVersion")&&(s.e.IsEmpty(t[e].TaxableAmt)?c+=" dcNum51="+t[e].Amount.toString()+",dcCalcNum51="+t[e].Amount.toString():c+=" dcNum51="+t[e].TaxableAmt.toString()+",dcCalcNum51="+t[e].TaxableAmt.toString(),!s.e.IsEmpty(t[e].VatPer)&&s.e.Double(t[e].VatPer.toString())>0?(c+=",dcNum52="+t[e].VatPer.toString().replace(",","")+",dcCalcNum52="+t[e].VatPer.toString().replace(",",""),c+=",dcNum60="+t[e].VatPer.toString().replace(",","")+",dcCalcNum60="+t[e].VatPer.toString().replace(",","")):c+=",dcCalcNum52=0,dcNum52=0,dcNum60=0,dcCalcNum60=0",s.e.IsEmpty(t[e].VatAmount)?c+=",dcCalcNum53=0,dcNum53=0,dcNum61=0,dcCalcNum61=0":(c+=",dcNum53="+t[e].VatAmount.toString().replace(",","")+",dcCalcNum53="+t[e].VatAmount.toString().replace(",",""),c+=",dcNum61="+t[e].VatAmount.toString().replace(",","")+",dcCalcNum61="+t[e].VatAmount.toString().replace(",","")+",",l.VatAmt=l.VatAmt+s.e.Double(t[e].VatAmount.toString().replace(",","")))),c+='" /> <Alpha  Query="',i.a.SessionManager.Preferences.ContainsKey("VATVersion")&&(c+="dcAlpha153='"+t[e].VatType.toString()+"',",c+="dcAlpha152='Service',"),c+='" />',c+=' <CostCenters   Query="'+l.strCCQry.toString()+n+' "   /> <EXTRAXML/>',l.DonotUpdateAccounts||(c+="<AccountsXML><Accounts ",c+=104==l.CurrCostCenterID?'CreditAccount="'+t[e].CreditAccID.toString()+'" DebitAccount="'+l.RentRecAc.SelectedValue.toString()+'" ':'DebitAccount="'+t[e].CreditAccID.toString()+'"  CreditAccount="'+l.RentRecAc.SelectedValue.toString()+'" ',c+='Amount="'+t[e].Amount.toString()+'" AmtFc="'+t[e].Amount.toString()+'" ',c+=l.CurrencyContract.SelectedValue>0?'CurrencyID="'+l.CurrencyContract.SelectedValue+'" ':'CurrencyID="1" ',c+='ExchangeRate="1"  ></Accounts>',!s.e.IsEmpty(t[e].VatPer)&&s.e.Double(t[e].VatPer.toString())>0&&!s.e.IsEmpty(t[e].VatAmount)&&s.e.Double(t[e].VatAmount.toString())>0&&(c+="<Accounts ",104==l.CurrCostCenterID?c+='CreditAccount="'+l.VatAccountID+'"  DebitAccount="'+l.RentRecAc.SelectedValue.toString()+'" ':(c+='DebitAccount="'+l.VatAccountID,c+='"  CreditAccount="'+l.RentRecAc.SelectedValue.toString()+'" '),c+='Amount="'+t[e].VatAmount.toString().replace(",","")+'" AmtFc="'+t[e].VatAmount.toString().replace(",","")+'" ',c+=l.CurrencyContract.SelectedValue>0?'CurrencyID="'+l.CurrencyContract.SelectedValue+'" ':'CurrencyID="1" ',c+='ExchangeRate="1"  ></Accounts>'),c+="</AccountsXML>"),c+=" </Row>",l.SingleInvoice||(c+="</DocumentXML></ROWS>")}},f=0;f<t.length;f++){var P;A(f)}return this.SingleInvoice&&"<SIV>"!=c.toString()&&(c+="</DocumentXML></ROWS>"),c+=104==this.CurrCostCenterID?"</PIV>":"</SIV>",Logger.InfoLog("AddEditRenContractViewModel ::Exiting GetSRTXML"),c.toString()}},{key:"GetRentPaymentXML",value:function(t,e){var a=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];Logger.InfoLog("AddEditRenContractViewModel ::Entering GetRentPaymentXML");var r,o,l="",c=new Date,u=new Date,D=new Date,h=0,C=0;l+="<RENTRCT>";for(var b=t.map((function(t){return t.Type})).filter((function(t,e,a){return a.indexOf(t)==e})).length,S=function(S){null!=a.DataTable[S].NodeID&&!s.e.IsEmpty(a.DataTable[S].NodeID)&&null!=a.DataTable[S].Amount&&""!=a.DataTable[S].Amount.toString().Trim()&&s.e.Double(a.DataTable[S].Amount.toString())>0&&(0==S&&e||!s.e.IsEmpty(a.DataTable[S].AdvanceAcc)&&"2"==a.DataTable[S].Refund.toString())&&function(){var e=0,d=0,T=a.DataTable[S].CreditAccountID_Key.toString(),y=a.IncomeAc.SelectedValue.toString();S>0&&(T=a.DataTable[S].AdvanceAcc.toString(),y=a.DataTable[S].CreditAccountID_Key.toString());var g=new s.f,I=-1,p=-1,A=1,f=a.UnitNodeID,P=null;s.e.IsEmpty(a.DataTable[S].Xml)||(g.LoadXml(a.DataTable[S].Xml.toString()),g.ChildNodes.length>0&&null!=g.ChildNodes[0].Attributes&&null!=g.ChildNodes[0].attributes.Filter&&!s.e.StringIsNullOrEmpty(g.ChildNodes[0].attributes.Filter.value)&&(p=parseInt(g.ChildNodes[0].attributes.Filter.value)),1!=p&&(I=0),!a.multiVisi||0!=p&&1!=p||(A=a.SelectedUnits.split(",").length,null==a.MultiNode&&(a.MultiNode=i.a.rental.GetUnitNodeIDs(a.SelectedUnits)),A>1&&!a.MultiNode.Columns.Contains(a.DataTable[S].NodeID.toString())&&a.MultiNode.Columns.push(a.DataTable[S].NodeID.toString())));for(var N=function(p){var N=0,V=null;d=e=0,h=s.e.Round(parseFloat(a.DataTable[0].Amount.toString())/a.GetDays(),a.dDeci);var R,M=a.CalculateMonths();if(R=a.TotalMonths>1?s.e.Round(parseFloat(a.DataTable[S].Amount.toString())/M,a.Mdeci):parseFloat(a.DataTable[S].Amount.toString()),1==A&&0==I)P=g.ChildNodes[0].ChildNodes;else if(A>1){if(null!=g.ChildNodes[0].ChildNodes[p].attributes.Unit&&!s.e.StringIsNullOrEmpty(g.ChildNodes[0].ChildNodes[p].attributes.Unit.value)){var E=a.MultiNode.filter((function(t){return t.UnitID==g.ChildNodes[0].ChildNodes[p].attributes.Unit.value}));E.length>0&&(f=parseInt(E[0].nodeid.toString()),V=E[0])}null==g.ChildNodes[0].ChildNodes[p].attributes.Amount||s.e.StringIsNullOrEmpty(g.ChildNodes[0].ChildNodes[p].attributes.Amount.value)||(h=s.e.Round(parseFloat(g.ChildNodes[0].ChildNodes[p].attributes.Amount.value)/a.GetDays(),a.dDeci)),P=g.ChildNodes[0].ChildNodes[p].ChildNodes}var v=function(){o=r=0;var g=null,p=new Date(c.getFullYear(),c.getMonth(),1,0,0,0);if(g=t.filter((function(t){return new Date(t.docdate)>=p})),"DocDate>='"+p.toString(),p=new Date(c.getFullYear(),c.getMonth(),c.DaysInMonth(),23,59,59),g=g.filter((function(t){return new Date(t.docdate)<=p})),"' and DocDate<='"+p.toString()+"'",N>0){A>1&&null!=t[0].unitNodeID&&(" and unitNodeID="+f,g=g.filter((function(t){return t.unitNodeID==f}))),b>1&&(g=g.filter((function(t){return t.Type==a.DataTable[S].NodeID.toString()}))," and Type="+a.DataTable[S].NodeID.toString());var V=g;V.length>0&&!s.e.IsEmpty(V[0].amount)?(C=parseFloat(V[0].amount.toString()),n.Contains("Disc")&&""!=V[0].Disc.toString()&&(r=parseFloat(V[0].Disc.toString().Replace("-","")))):c.AddMonths(1)>a.EndDate.Date?("Daily"!=a.BasedOn.SelectedValue&&(h=R/c.DaysInMonth()),C=s.e.Round(h*a.EndDate.Date.getDate(),a.Mdeci)):C="Daily"==a.BasedOn.SelectedValue?s.e.Round(h*c.DaysInMonth(),a.Mdeci):R}else{A>1&&null!=t[0].unitNodeID&&(" and unitNodeID="+f,g=g.filter((function(t){return t.unitNodeID==f}))),b>1&&(g=g.filter((function(t){return t.Type==a.DataTable[S].NodeID.toString()}))," and Type="+a.DataTable[S].NodeID.toString());var M=g;if(M.length>0&&!s.e.IsEmpty(M[0].amount))c.getFullYear()==a.StartDate.Date.getFullYear()&&c.getMonth()==a.StartDate.Date.getMonth()&&(h=s.e.Round(parseFloat(M[0].amount.toString())/a.EndDate.Date.getDay(),a.dDeci)),n.Contains("Disc")&&""!=M[0].Disc.toString()?o=s.e.Round(parseFloat(M[0].Disc.toString().Replace("-",""))/a.EndDate.Date.getDay(),a.dDeci):c.getFullYear()==a.EndDate.Date.getFullYear()&&c.getMonth()==a.EndDate.Date.getMonth()&&(h=s.e.Round(parseFloat(M[0].amount.toString())/(c.DaysInMonth()-a.StartDate.Date.getDate()+1),a.dDeci)),n.Contains("Disc")&&""!=M[0].Disc.toString()?o=s.e.Round(parseFloat(M[0].Disc.toString().Replace("-",""))/(c.DaysInMonth()-a.StartDate.Date.getDate()+1),a.dDeci):h=s.e.Round(parseFloat(M[0].amount.toString())/c.DaysInMonth(),a.dDeci),n.Contains("Disc")&&""!=M[0].Disc.toString()&&(o=s.e.Round(parseFloat(M[0].Disc.toString().Replace("-",""))/c.DaysInMonth(),a.dDeci));else if(0==I)for(var E=0;E<P.length;E++)if(s.e.isValidDate(P[E].attributes.FromDate.value)&&(u=new Date(P[E].attributes.FromDate.value)),s.e.isValidDate(P[E].attributes.ToDate.value)&&(D=new Date(P[E].attributes.ToDate.value)),c>u&&c<D){h=s.e.Round(parseFloat(P[E].attributes.Amount.value)/a.GetDays_1(u,D),a.dDeci);break}c.getMonth()==a.EndDate.Date.getMonth()&&c.getFullYear()==a.EndDate.Date.getFullYear()?(C=s.e.Round(h*s.e.GetDateDifference(a.EndDate.Date,c),a.Mdeci),o>0&&(r=s.e.Round(o*s.e.GetDateDifference(a.EndDate.Date,c),a.Mdeci))):C=s.e.Round(h*((new Date).DaysInMonth()-c.getDate()),a.Mdeci),o>0&&(r=s.e.Round(o*((new Date).DaysInMonth()-c.getDate()),a.Mdeci))}if(C>0&&(0==N||!a.CancelIncomeonTerminate)){l+='<ROWS><ChequeDocDate DD="'+c.ToString("dd/MMM/yyyy")+'"></ChequeDocDate><DocumentXML>',l+='<Row><Transactions CONTRACTSNO="'+(N+1).toString()+'" ',l+='DocDetailsID="0" DocSeqNo="1" ',l+=104==a.CurrCostCenterID?'CreditAccount="'+y+'" DebitAccount="'+T+'" ':'CreditAccount="'+T+'" DebitAccount="'+y+'" ',l+='Amount="'+C.toString()+'" AmtFc="'+C.toString()+'" ',l+='ChequeDate = "'+c.ToString("dd/MMM/yyyy")+'" ',l+=a.CurrencyContract.SelectedValue>0?'CurrencyID="'+a.CurrencyContract.SelectedValue+'" ':'CurrencyID="1" ',l+='ExchangeRate="1"  CommonNarration="'+m.d.GetValidXml(a.Narration.Text)+'"  LineNarration="  RENT SETTLEMENT " ChequeBankName="" ChequeNumber="" ',l+="></Transactions> ";var v="";a.multiVisi&&!a.strCCQry.toString().Contains("dcCCNID"+(a.UnitCCID-5e4).toString()+"=")&&(v+=" dcCCNID"+(a.UnitCCID-5e4).toString()+"="+f+","),a.DataTableColumns.Contains("Location_Key")&&!s.e.IsEmpty(a.DataTable[S].Location_Key)?v+=" dcCCNID2="+a.DataTable[S].Location_Key.toString()+",":a.LocationContract.Visible&&a.LocationContract.SelectedValue>0&&(v+=" dcCCNID2="+a.LocationContract.SelectedValue+","),a.DataTableColumns.Contains("Dim_Key")&&!s.e.IsEmpty(a.DataTable[S].Dim_Key)&&(v+=" dcCCNID"+(a.DimCCID-5e4).toString()+"="+a.DataTable[S].Dim_Key.toString()+","),v+=a.GetSalemanXml(a.DataTable[S]),i.a.SessionManager.Preferences.ContainsKey("DepositLinkDimension")&&""!=i.a.SessionManager.Preferences.DepositLinkDimension&&parseInt(i.a.SessionManager.Preferences.DepositLinkDimension)>0&&(v+=" dcCCNID"+(parseInt(i.a.SessionManager.Preferences.DepositLinkDimension)-5e4).toString()+"="+a.DataTable[S].NodeID.toString()+","),l+=' <Numeric Query="',""!=a.Discountfield&&r>0&&(l+=a.Discountfield+"=-"+r+","+a.Discountfield.Replace("dcNum","dcCalcNum")+"=-"+r+","),l+='" /> <Alpha /> <CostCenters   Query="'+a.strCCQry.toString()+v+'"  /> <EXTRAXML/>',l+="<AccountsXML>",""!=a.Discountfield&&r>0&&(l+="<Accounts ",104==a.CurrCostCenterID?(l+='CreditAccount="'+a.DiscountAccount+'" ',l+='DebitAccount="'+y+'" '):(l+='DebitAccount="'+a.DiscountAccount+'" ',l+='CreditAccount="'+y+'" '),l+='Amount="'+r.toString()+'" ',l+='AmtFc="'+r.toString()+'" ',l+='CurrencyID="1" ',l+='ExchangeRate="1" ',l+='IsNegative="1" ',l+="></Accounts>"),l+=" </AccountsXML></Row>",l+="</DocumentXML></ROWS>"}c=0==N?c.AddDays((new Date).DaysInMonth()-c.getDate()+1):c.AddMonths(1),N++,0==S&&(a.SRTAmount=a.SRTAmount+C,a.DiscReturn=a.DiscReturn+s.e.DoubleTryParse(r)),e+=C,d+=s.e.DoubleTryParse(r)};for(c=a.TerminationDate.Date();c<=a.EndDate.Date;)v();null!=V&&(V[a.DataTable[S].NodeID.toString()]=e,d>0?(a.MultiNode.Columns.Contains(a.DataTable[S].NodeID.toString()+"Disc")||a.MultiNode.Columns.push(a.DataTable[S].NodeID.toString()+"Disc"),V[a.DataTable[S].NodeID.toString()+"Disc"]=d):a.MultiNode.Columns.Contains(a.DataTable[S].NodeID.toString()+"Disc")&&(V[a.DataTable[S].NodeID.toString()+"Disc"]=0))},V=0;V<A;V++)N(V);S>0&&1==A&&(a.DataTableColumns.Contains("srtAmt")||a.DataTableColumns.push("srtAmt"),a.DataTable[S].srtAmt=e),d>0&&(a.DataTableColumns.Contains("DiscReturn")||a.DataTableColumns.push("DiscReturn"),a.DataTable[S].DiscReturn=d)}()},d=0;d<this.DataTable.length;d++)S(d);return l+="</RENTRCT>",Logger.InfoLog("AddEditRenContractViewModel ::Exiting GetRentPaymentXML"),l.toString()}},{key:"GetSalesReturnAmount",value:function(t){var e=this;Logger.InfoLog("AddEditRenContractViewModel ::Entering GetSalesReturnAmount");for(var a=new Date,n=new Date,r=new Date,o=0,l=0,c=0;c<this.DataTable.length;c++)null!=this.DataTable[c].NodeID&&!s.e.IsEmpty(this.DataTable[c].NodeID)&&null!=this.DataTable[c].Amount&&""!=this.DataTable[c].Amount.toString().Trim()&&parseFloat(this.DataTable[c].Amount.toString())>0&&(0==c||!s.e.IsEmpty(this.DataTable[c].AdvanceAcc)&&"2"==this.DataTable[c].Refund.toString())&&function(){var u=0,D=new s.f,h=-1,C=-1,m=1,b=e.UnitNodeID,S=null;s.e.IsEmpty(e.DataTable[c].Xml)||(D.LoadXml(e.DataTable[c].Xml.toString()),D.ChildNodes.length>0&&null!=D.ChildNodes[0].Attributes&&null!=D.ChildNodes[0].attributes.Filter&&!s.e.StringIsNullOrEmpty(D.ChildNodes[0].attributes.Filter.Value)&&(C=parseInt(D.ChildNodes[0].attributes.Filter.value)),1!=C&&(h=0),!e.multiVisi||0!=C&&1!=C||(m=e.SelectedUnits.split(",").length,null==e.MultiNode&&(e.MultiNode=i.a.rental.GetUnitNodeIDs(e.SelectedUnits)),m>1&&!e.MultiNode.Columns.Contains(e.DataTable[c].NodeID.toString())&&e.MultiNode.Columns.push(e.DataTable[c].NodeID.toString())));for(var d=function(i){var C=void 0,d=0,T=null;u=0,o=s.e.Round(parseFloat(e.DataTable[c].Amount.toString())/e.GetDays(),e.dDeci);var y=e.CalculateMonths();if(C=y>1?s.e.Round(parseFloat(e.DataTable[c].Amount.toString())/y,e.Mdeci):parseFloat(e.DataTable[c].Amount.toString()),1==m&&0==h)S=D.ChildNodes[0].ChildNodes;else if(m>1){if(null!=D.ChildNodes[0].ChildNodes[i].attributes.Unit&&!s.e.StringIsNullOrEmpty(D.ChildNodes[0].ChildNodes[i].attributes.Unit.value)){var g=e.MultiNode.filter((function(t){return t.UnitID==D.ChildNodes[0].ChildNodes[i].attributes.Unit.value}));g.length>0&&(b=parseInt(g[0].nodeid.toString()),T=g[0])}null==D.ChildNodes[0].ChildNodes[i].attributes.Amount||s.e.StringIsNullOrEmpty(D.ChildNodes[0].ChildNodes[i].attributes.Amount.value)||(o=s.e.Round(parseFloat(D.ChildNodes[0].ChildNodes[i].attributes.Amount.value)/e.GetDays(),e.dDeci)),S=D.ChildNodes[0].ChildNodes[i].ChildNodes}for(a=e.TerminationDate.Date();a<=e.EndDate.Date;){if(d>0){var I=new Date(a.getFullYear(),a.getMonth(),1,0,0,0).ToString("dd/MMM/yyyy"),p="x=>x.DocDate>='"+I.toString();p+="' && x.DocDate<='"+(I=new Date(a.getFullYear(),a.getMonth(),a.DaysInMonth(),23,59,59).ToString("dd/MMM/yyyy")).toString()+"'",m>1&&t.Columns.Contains("unitNodeID")&&(p+=" && x.unitNodeID=="+b),p+=" && x.Type=="+e.DataTable[c].NodeID.toString();var A=[];!s.e.IsEmpty(t)&&t.length>0&&(A=t.filter(p)),!s.e.IsEmpty(A)&&A.length>0&&""!=A[0].Amount.toString()?l=parseFloat(A[0].Amount.toString()):a.AddMonths(1)>e.EndDate.Date?l="Daily"!=e.BasedOn.SelectedValue&&e.EndDate.Date.getDate()==a.DaysInMonth()?C:s.e.Round(o*e.EndDate.Date.getDate(),e.Mdeci):h>=0?(r<a.AddDays(a.DaysInMonth()-1)&&a.AddMonths(1)<e.EndDate.Date&&(h++,s.e.isValidDate(S[h].attributes.FromDate.value)&&(n=S[h].attributes.FromDate.value),s.e.isValidDate(S[h].attributes.ToDate.value)&&(r=S[h].attributes.ToDate.value),C=(y=e.CalculateMonthsbetweenDates(n,r))>1?s.e.Round(s.e.DoubleTryParse(S[h].attributes.Amount.value)/y,e.Mdeci):s.e.DoubleTryParse(S[h].attributes.Amount.value),o=s.e.Round(s.e.DoubleTryParse(S[h].attributes.Amount.value)/e.GetDays_1(n,r),e.dDeci)),s.e.isValidDate(S[h].attributes.FromDate.value)&&(n=S[h].attributes.FromDate.value),l=1!=n.getDate()||"Daily"==e.BasedOn.SelectedValue?s.e.Round(o*(n.DaysInMonth()-n.getDate()+1),e.Mdeci):C):l="Daily"==e.BasedOn.SelectedValue?s.e.Round(o*a.DaysInMonth(),e.Mdeci):C}else{if(0==h){for(var f=0;f<S.length;f++)if(s.e.isValidDate(S[f].attributes.FromDate.value)&&(n=new Date(S[f].attributes.FromDate.value)),s.e.isValidDate(S[f].attributes.ToDate.value)&&(r=new Date(S[f].attributes.ToDate.value)),a>=n&&a<=r){C=(y=e.CalculateMonthsbetweenDates(n,r))>1?s.e.Round(s.e.DoubleTryParse(S[f].attributes.Amount.value)/y,e.Mdeci):s.e.DoubleTryParse(S[f].attributes.Amount.value),o=s.e.Round(s.e.DoubleTryParse(S[f].attributes.Amount.value)/e.GetDays_1(n,r),e.dDeci),h=f;break}}else"Monthly"==e.BasedOn.SelectedValue&&(o=C/a.DaysInMonth());l=a.getMonth()==e.EndDate.Date.getMonth()&&a.getFullYear()==e.EndDate.Date.getFullYear()?s.e.Round(o*s.e.GetDateDifference(e.EndDate.Date,a),e.Mdeci):s.e.Round(o*(a.DaysInMonth()-a.getDate()),e.Mdeci)}a=0==d?a.AddDays(a.DaysInMonth()-a.getDate()+1):a.AddMonths(1),d++,0==c&&(e.SRTAmount=e.SRTAmount+l),u+=l}null!=T&&(T[e.DataTable[c].NodeID.toString()]=u)},T=0;T<m;T++)d(T);c>0&&1==m&&(e.DataTableColumns.Contains("srtAmt")||e.DataTableColumns.push("srtAmt"),e.DataTableObj.Table[c].srtAmt=u)}();Logger.InfoLog("AddEditRenContractViewModel ::Exiting GetSalesReturnAmount")}},{key:"OnMessageCallBack",value:function(){this.res="Yes",this.resTerm="Yes"}},{key:"OnShowAttachment",value:function(){}},{key:"OnAddNote",value:function(){this.Note=new I.AddNoteViewModel,this.Note.AddNoteViewModel_2(this)}},{key:"OnAddAttachment",value:function(){this.Attachment=new y.AddAttachmentViewModel,this.Attachment.AddAttachmentViewModel_2(this)}},{key:"OnShowNote",value:function(){}},{key:"OnShowContact",value:function(){}},{key:"OnAddContact",value:function(){}},{key:"ClearCallBack",value:function(t,e){if(t>0){"AutoSave"!=e&&0==this.ContractID&&this.RenewRefID>0&&this.RenewSubContracts(10,this.RenewRefID),this.SaveAndPrintContactID=t,this.draftid>0&&"SaveDraft"!=e&&(95==this.CurrCostCenterID||104==this.CurrCostCenterID)&&i.a.rental.DeleteQuotation(95,this.draftid),this.RenewRefID=0,this.DataTableObj.Clear(),this.PayTermsDataTableObj.Clear(),this.CalculateFooter(),this.TotalYears.Text="",this.Months.Text="",this.NonRecAmount.Text="0.00",this.RecAmount.Text="0.00",this.TotalAmount.Text="0.00";var a=i.a.rental.GetNextContractNo(this.CurrCostCenterID,this.ParentContractID);this.SlNO.Text=a,this.StartDate.Date=null,this.EndDate.Date=null,this.ViewNotes.NotesListObj.Clear(),this.ViewNotes.DeletedNotes.Clear(),this.ViewAttachments.AttachmentsListObj.Clear(),this.ViewAttachments.OnShowNewAttachment(null),this.ViewAttachments.DeletedAttachments.Clear(),null!=this.ViewActivities&&this.ViewActivities.ActivityGridData.Clear(),this.IsSavePrintClick&&(this.IsSavePrintClick=!1,this.Export("Print")),this.ClearData();for(var n=0;n<6;n++){var s=this.DataTableObj.NewRow();s.Recurr=!1,this.DataTableObj.addRow(s);var r=this.PayTermsDataTableObj.NewRow();this.PayTermsDataTableObj.addRow(r)}Logger.InfoLog("AddEditRenContractViewModel :: Exiting OnSaveContract")}}},{key:"SetButtonEnable",value:function(t,e){var a=this.ButtonsLeft.find((function(e){return e.ComParam.toUpperCase()==t.toUpperCase()}));!s.e.IsEmpty(a)&&a.length>0&&(a[0].Enable=e)}},{key:"CheckUnits",value:function(t){s.e.IsEmpty(t)||this.OnSave("CheckUnits")}},{key:"DocumentDraftsPopup",value:function(t){return Object(n.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,s,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve().then(a.bind(null,"ouML"));case 2:return n=e.sent,s=n.DocumentDraftsViewModel,e.next=6,Promise.resolve().then(a.bind(null,"vgHJ"));case 6:r=e.sent,o=r.DocumentDraftsComponent,i.a.page.ShowDialog(new s(this,t,this.CurrCostCenterID),o,{HideClose:!0,ShowCenter:!0});case 9:case"end":return e.stop()}}),e,this)})))}},{key:"GetCostingds",value:function(t,e,a,n){var s=this,r="",o=!1;return n.forEach((function(n){parseInt(n)>5e4?r+=s.GetWhere(parseInt(n),t):2==parseInt(n)?r+=" and AccountID in("+e+","+a+")":502==parseInt(n)&&(o=!0,r+=" and (db.AccountID is not null or Cr.AccountID is not null)")})),i.a.rental.getProfileBasedon(e,a,o,r)}},{key:"RefershPage",value:function(){if(0==this.DataTableObj.Table.length)for(var t=0;t<6;t++){var e=this.DataTableObj.NewRow();e.Recurr=!1,this.DataTableObj.addRow(e);var a=this.PayTermsDataTableObj.NewRow();this.PayTermsDataTableObj.addRow(a)}this.RentAmt.Text="",this.ContractID=0,this.Months.Text="",this.TotalYears.Text="",this.Narration.Text="",this.RefershTitle()}},{key:"OnKeyDown_Payment",value:function(t,e){if(9==e.which){var a=this.PayTermsDataTableObj.Table.indexOf(t.grid.getDataItem(t.row));if(-1==a)a=1;else if(a+=1,this.PayTermsDataTableObj.Table.length-a<3&&this.PayTermsDataTableObj.CanUserAddRows){var n=this.PayTermsDataTableObj.NewRow();this.UpdateSequencePay(),n.SNO=this.PSNO,n.Recurr=!1,this.PayTermsDataTableObj.addRow(n)}}}},{key:"OnKeyDown",value:function(t,e){if("F6"==e.key)e.preventDefault(),this.onCopy(this.DataTableObj.getArgsObj(t));else if(9==e.which){var a=this.DataTableObj.Table.indexOf(t.grid.getDataItem(t.row));if(-1==a)a=1;else if(a+=1,this.DataTableObj.Table.length-a<3&&this.DataTableObj.CanUserAddRows){var n=this.DataTableObj.NewRow();this.UpdateSequence(),n.SNO=this.SNO,n.Recurr=!1,this.DataTableObj.addRow(n)}}else if(9==e.which){var i=this.PayTermsDataTableObj.Table.indexOf(t.grid.getDataItem(t.row));if(-1==i)i=1;else if(i+=1,this.PayTermsDataTableObj.Table.length-i<3&&this.PayTermsDataTableObj.CanUserAddRows){var s=this.PayTermsDataTableObj.NewRow();this.UpdateSequence(),s.SNO=this.SNO,s.Recurr=!1,this.PayTermsDataTableObj.addRow(s)}}else("F5"==e.key||e.ctrlKey&&"F5"==e.key)&&(e.preventDefault(),this.onDistribute(this.DataTableObj.getArgsObj(t)))}},{key:"CmenuItem_Click",value:function(t,e){if(console.log("CmenuItem_Click"),null!=this.PayTermsDataTableObj.SelectedItem&&null!=this.PayTermsDataTableObj.angularGrid.dataView.getItems()&&this.PayTermsDataTableObj.angularGrid.dataView.getItems()&&null!=t&&t instanceof D.b){var a=t.Tag.toString();if("Copy"==a||"CopyRef"==a)this.PayTermsDataTableObj.SelectedItem&&(this.CopiedRow=this.PayTermsDataTableObj.SelectedItem),this.IsRef="CopyRef"==a;else if("Paste"==a&&null!=this.CopiedRow&&this.PayTermsDataTableObj.Table.Contains(this.CopiedRow)&&this.PayTermsDataTableObj.SelectedItem){if(!this.PayTermsDataTableObj.CanUserAddRows)return;for(var n=0;n<this.PayTermsDataTableObj.TableColumns.length;n++)"cntrldate"!=this.PayTermsDataTableObj.TableColumns[n].toString().toLowerCase()&&"cntrldate_key"!=this.PayTermsDataTableObj.TableColumns[n].toString().toLowerCase()&&"postingdate"!=this.PayTermsDataTableObj.TableColumns[n].toString().toLowerCase()&&"postingdate_key"!=this.PayTermsDataTableObj.TableColumns[n].toString().toLowerCase()&&"paynodeid"!=this.PayTermsDataTableObj.TableColumns[n].toString().toLowerCase()&&"payeebank"!=this.PayTermsDataTableObj.TableColumns[n].toString().toLowerCase()&&"narration"!=this.PayTermsDataTableObj.TableColumns[n].toString().toLowerCase()&&"debitaccountid"!=this.PayTermsDataTableObj.TableColumns[n].toString().toLowerCase()&&"debitaccountid_key"!=this.PayTermsDataTableObj.TableColumns[n].toString().toLowerCase()&&"amount"!=this.PayTermsDataTableObj.TableColumns[n].toString().toLowerCase()&&"chequeno"!=this.PayTermsDataTableObj.TableColumns[n].toString().toLowerCase()||(this.PayTermsDataTableObj.SelectedItem[this.PayTermsDataTableObj.TableColumns[n]]=this.CopiedRow[this.PayTermsDataTableObj.TableColumns[n]]);this.CalculateFooter(),this.PayTermsDataTableObj.updateRow(this.PayTermsDataTableObj.SelectedItem)}else i.a.toastr.warning("Not Implemented "+t)}}},{key:"AttachmentVisibility",get:function(){return this._AttachmentVisibility},set:function(t){t!=this._AttachmentVisibility&&(this._AttachmentVisibility=t)}},{key:"PayTermsDataTable",get:function(){return this.PayTermsDataTableObj.Table}},{key:"PayTermsDataTableColumns",get:function(){return this.PayTermsDataTableObj.TableColumns}},{key:"DataTable",get:function(){return this.DataTableObj.Table}},{key:"DataTableColumns",get:function(){return this.DataTableObj.TableColumns}},{key:"CntStatus",get:function(){return this._CntStatus},set:function(t){t!=this._CntStatus&&(this._CntStatus=t)}},{key:"ReportInfoVisibility",get:function(){return this._ReportInfoVisibility},set:function(t){t!=this._ReportInfoVisibility&&(this._ReportInfoVisibility=t)}},{key:"UnitStatus",get:function(){return this._UnitStatus},set:function(t){t!=this._UnitStatus&&(this._UnitStatus=t)}},{key:"RefundVisiblity",get:function(){return this._RefundVisiblity},set:function(t){t!=this._RefundVisiblity&&(this._RefundVisiblity=t)}},{key:"RefundDate",get:function(){return this._RefundDate},set:function(t){t!=this._RefundDate&&(this._RefundDate=t)}},{key:"IsRecurPosted",get:function(){return this._IsRecurPosted},set:function(t){t!=this._IsRecurPosted&&(this._IsRecurPosted=t)}},{key:"RefreshGrid",get:function(){return this._RefreshGrid},set:function(t){t!=this._RefreshGrid&&(this._RefreshGrid=t)}},{key:"DeleteVisibility",get:function(){return this._DeleteVisibility},set:function(t){this._DeleteVisibility!=t&&(this._DeleteVisibility=t)}},{key:"RightRegionVisibility",get:function(){return this._RightRegionVisibility},set:function(t){t!=this._RightRegionVisibility&&(this._RightRegionVisibility=t)}},{key:"SelectedVoucher",get:function(){return this._SelectedVoucher},set:function(t){t!=this._SelectedVoucher&&(this._SelectedVoucher=t)}},{key:"SelectedRow",get:function(){return this._SelectedRow},set:function(t){t!=this._SelectedRow&&(this._SelectedRow=t)}},{key:"SaveapproveVisiblity",get:function(){return this._SaveapproveVisiblity},set:function(t){t!=this._SaveapproveVisiblity&&(this._SaveapproveVisiblity=t)}},{key:"RejectVisiblity",get:function(){return this._RejectVisiblity},set:function(t){t!=this._RejectVisiblity&&(this._RejectVisiblity=t)}},{key:"RejectRemarks",get:function(){return this._RejectRemarks},set:function(t){t!=this._RejectRemarks&&(this._RejectRemarks=t)}},{key:"DisplayName",get:function(){return this._DisplayName},set:function(t){t!=this._DisplayName&&(this._DisplayName=t)}},{key:"Title",get:function(){return this._Title},set:function(t){t!=this._Title&&(this._Title=t)}},{key:"DoNotPrintUnApprovedContracts",get:function(){var t=this.ScreenObject.Data.Tables[5].find((function(t){return"DoNotPrintUnApprovedContracts"==t.Name}));return t.length>0&&"True"==t[0].Value.toString()}},{key:"SelectedGridRowIndex",get:function(){return this.DataTableObj.SelectedIndex}},{key:"NoteVisibility",get:function(){return this._NoteVisibility},set:function(t){this._NoteVisibility=t}}]),A}(A.b),$=function(t){_inherits(a,t);var e=_createSuper(a);function a(){var t;return _classCallCheck(this,a),(t=e.apply(this,arguments)).IsOpening=new c.e,t}return _createClass(a,[{key:"PromptIsOpening",value:function(t){this.Parent=t,this.IsOpening.Label="Is Opening",this.IsOpening.Items.push(c.d.ComboBoxItems_2("YES","1")),this.IsOpening.Items.push(c.d.ComboBoxItems_2("NO","0")),this.IsOpening.SelectedValue="1",this.IsOpening.Width="200"}},{key:"OnCLick",value:function(t){this.Parent.DialogResult="OK"==t,i.a.page.HideDialog()}}]),a}(A.b)}}]);