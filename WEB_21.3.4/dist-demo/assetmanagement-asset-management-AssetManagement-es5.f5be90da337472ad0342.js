function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,s){return t&&_defineProperties(e.prototype,t),s&&_defineProperties(e,s),e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var s,i=_getPrototypeOf(e);if(t){var a=_getPrototypeOf(this).constructor;s=Reflect.construct(i,arguments,a)}else s=i.apply(this,arguments);return _possibleConstructorReturn(this,s)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[99],{"7fVR":function(e,t,s){"use strict";s.d(t,"a",(function(){return d}));var i=s("Do2H"),a=s("Lp6j"),n=s("eQJW"),o=s("ScVY"),r=s("8B8H"),l=s("ockk"),c=s("CUWK"),u=s("NM0h"),h=s("MCLT"),d=function(e){_inherits(s,e);var t=_createSuper(s);function s(){var e;return _classCallCheck(this,s),(e=t.call(this)).DeprMessage="",e.oparent=null,e.PostVisible=!1,e.DeleteVisible=!1,e.JVCCID=0,e.AssetID=0,e.CreditAcc=0,e.DebitAcc=0,e.IsDeprSummary=!1,e.iFailure=0,e.IsPostingOnScheduleDate=!1,e.AllowEditPostingDate=!1,e.SystemDate=Date.Today(),e.CV=null,e.oNotif=null,e.iLoop=0,e.iStart=0,e.strTo=null,e.strDrAcc=null,e.strCrAcc=null,e.strDeprIDs="",e.strDtColumn="",e.JVOK=!1,e.JVUNOK=!1,e.objAsset=new u.a,e.Title=i.a.GetResource("ASM_ScheduleDepreciation"),e}return _createClass(s,[{key:"DepreciationScheduleViewModel_1",value:function(e){"AssetManagement"==(null==e?void 0:e.ClassName)?(this.oparent=e,this.AssetID=this.oparent.AssetID,this.PostVisible=!0,this.DeleteVisible=!!i.a.SessionManager.IsActionAssigned(72,"Delete Depreciatin Schedule"),1!=this.oparent.IsFullDispose&&3!=this.oparent.IsFullDispose||(this.PostVisible=!1,this.DeleteVisible=!1)):"ChangeValue"==(null==e?void 0:e.ClassName)&&(this.CV=e,this.PostVisible=!1,this.DeleteVisible=!1),this.InitGrid()}},{key:"DepreciationScheduleViewModel_2",value:function(e,t){this.oNotif=t;var s=e.Tables[1].filter((function(e){return"DepreciationJV"==e.Name}));s.length>0&&parseInt(s[0].Value)>0&&(this.JVCCID=parseInt(s[0].Value)),(s=e.Tables[1].filter((function(e){return"ClubDeprPosting"==e.Name}))).length>0&&"TRUE"==s[0].Value.toString().toUpperCase()&&(this.IsDeprSummary=!0),this.worker_DoWork()}},{key:"worker_RunWorkerCompleted",value:function(){this.oNotif.Enable=!0,this.oNotif.DisplayMessage=this.DeprMessage,this.oNotif.DeprDataFilling()}},{key:"worker_DoWork",value:function(){this.oNotif.Enable=!1;var e=this.oNotif.DepreciationGrid.Table;this.drrPost=e.length>0?e.filter((function(e){return e.select&&Object(h.isNullOrUndefined)(e.DocID)})):[],0!=this.drrPost.length?(this.oNotif.DisplayMessage="Posting 0 of "+this.drrPost.length,this.iFailure=0,this.IsDeprSummary?(this.iStart=0,this.strDeprIDs="",this.strDtColumn=this.oNotif.AllowEditPostingDate?"PostDate_Key":"ToDate",this.drrPost=e.filter((function(e){return e.select&&Object(h.isNullOrUndefined)(e.DocID)})),this.drrPost.SortBy([this.strDtColumn,"DebitAccount","CreditAccount"]),this.iLoop=0,this.PostDeprJV_CallBack()):(this.iLoop=0,this.PostDeprJVDetail_CallBack())):this.oNotif.DisplayMessage=i.a.GetResource("PleaseSelectDepreciation")}},{key:"PostDeprJV_CallBack",value:function(){var e=this;if(this.iLoop>=this.drrPost.length)this.strDeprIDs.length>0?(this.oNotif.DisplayMessage="Posting ("+(this.iStart+1)+"-"+this.drrPost.length+") of "+this.drrPost.length,this.PostDeprJV_Summary(this.strDeprIDs,this.strTo,this.strDrAcc,this.strCrAcc,this.iStart,this.drrPost.length).then((function(t){e.worker_RunWorkerCompleted()}))):this.worker_RunWorkerCompleted();else{for(;this.iLoop<this.drrPost.length;this.iLoop++){if(this.strTo!=this.drrPost[this.iLoop][this.strDtColumn].toString()||this.strDrAcc!=this.drrPost[this.iLoop].DebitAccount.toString()||this.strCrAcc!=this.drrPost[this.iLoop].CreditAccount.toString()){if(this.strDeprIDs.length>0)return this.oNotif.DisplayMessage="Posting ("+(this.iStart+1)+"-"+this.iLoop+") of "+this.drrPost.length,this.PostDeprJV_Summary(this.strDeprIDs,this.strTo,this.strDrAcc,this.strCrAcc,this.iStart,this.iLoop).then((function(t){e.PostDeprJV_CallBack()})),this.strDeprIDs="",this.strTo=this.drrPost[this.iLoop][this.strDtColumn].toString(),this.strDrAcc=this.drrPost[this.iLoop].DebitAccount.toString(),this.strCrAcc=this.drrPost[this.iLoop].CreditAccount.toString(),void(this.iStart=this.iLoop);this.strDeprIDs="",this.strTo=this.drrPost[this.iLoop][this.strDtColumn].toString(),this.strDrAcc=this.drrPost[this.iLoop].DebitAccount.toString(),this.strCrAcc=this.drrPost[this.iLoop].CreditAccount.toString(),this.iStart=this.iLoop}this.strDeprIDs.length>0&&(this.strDeprIDs+=","),this.strDeprIDs+=this.drrPost[this.iLoop].ScheduleID.toString()}this.strDeprIDs.length>0&&this.PostDeprJV_CallBack()}}},{key:"PostDeprJVDetail_CallBack",value:function(){var e=this;if(this.iLoop>=this.drrPost.length)this.worker_RunWorkerCompleted();else{var t="";t="",t+="<JVXML>",t+="<ROWS>",t+='<DepreciationID DepID="'+this.drrPost[this.iLoop].ScheduleID.toString()+'" AssetID="'+this.drrPost[this.iLoop].AssetID.toString()+'"',a.e.IsEmpty(this.drrPost[this.iLoop].PostDate_Key)||(t+=' Dt="'+new Date(this.drrPost[this.iLoop].PostDate_Key).ToString("dd MMM yyyy")+'"'),t+="/>",t+="</ROWS>",t+="</JVXML>",this.oNotif.DisplayMessage="Posting "+(this.iLoop+1)+" of "+this.drrPost.length;this.objAsset.PostAssetID=this.AssetID,this.objAsset.PostCCID=this.JVCCID,this.objAsset.JVXML=t.toString(),this.objAsset.Post=!0,this.objAsset.PostDeprJV().subscribe((function(t){e.DisplayMessage=t.Message,t.RetValue<=0&&e.iFailure++,e.DeprMessage=e.DisplayMessage,e.iLoop++,e.PostDeprJVDetail_CallBack()}))}}},{key:"PostDeprJV_Summary",value:function(e,t,s,i,a,n){var o=this,r=new Date(t);return this.oNotif.AllowEditPostingDate||this.oNotif.IsPostingOnScheduleDate||(r=this.oNotif.SystemDate),this.objAsset.PostDeprJVSummary(this.JVCCID,r,s,i,e).then((function(e){o.DisplayMessage=e.Message,e.RetValue<=0&&(o.iFailure+=n-a),o.DeprMessage=o.DisplayMessage}))}},{key:"InitGrid",value:function(){this.Schedules=new r.a,this.Schedules.Width="",this.Schedules.Height=400,this.Schedules.TableColumns.push("ID"),this.Schedules.TableColumns.push("period"),this.Schedules.TableColumns.push("From"),this.Schedules.TableColumns.push("FromText"),this.Schedules.TableColumns.push("To"),this.Schedules.TableColumns.push("ToText"),this.Schedules.TableColumns.push("DepAmt"),this.Schedules.TableColumns.push("AccDep"),this.Schedules.TableColumns.push("AccDepWithPrev"),this.Schedules.TableColumns.push("NetValue"),this.Schedules.TableColumns.push("Status"),this.Schedules.TableColumns.push("DocID"),this.Schedules.TableColumns.push("DocNo"),this.Schedules.TableColumns.push("select"),this.Schedules.TableColumns.push("PostingDate"),this.Schedules.TableColumns.push("CostCenterID"),this.Schedules.TableColumns.push("PostingDate_Key"),this.Schedules.TableColumns.push("DocumentName"),this.Schedules.TableColumns.push("DocPrefix"),this.Schedules.TableColumns.push("DocNumber"),this.oColumns=new Array;var e=new l.a;e.Header="#",e.DisplayMember="period",e.ReadOnly=!0,e.Width=45,e.IsFrozen=!0,this.oColumns.push(e),(e=new l.a).Header=i.a.GetResource("From"),e.DisplayMember="FromText",e.ReadOnly=!0,e.Width=90,e.IsFrozen=!0,this.oColumns.push(e),(e=new l.a).Header=i.a.GetResource("To"),e.DisplayMember="ToText",e.ReadOnly=!0,e.Width=90,e.IsFrozen=!0,this.oColumns.push(e),(e=new l.a).Header="Depr. Amount",e.DisplayMember="DepAmt",e.IsCalculated=1,e.Width=95,e.ReadOnly=!0,e.DataType="FLOAT",this.oColumns.push(e),(e=new l.a).Header="Acc. Depr",e.DisplayMember="AccDepWithPrev",e.IsCalculated=1,e.Width=100,e.ReadOnly=!0,e.DataType="FLOAT",this.oColumns.push(e),(e=new l.a).Header="Net Value",e.DisplayMember="NetValue",e.IsCalculated=1,e.Width=100,e.ReadOnly=!0,e.DataType="FLOAT",this.oColumns.push(e),(e=new l.a).Header=i.a.GetResource("Status"),e.DisplayMember="Status",e.ReadOnly=!0,e.Width=80,this.oColumns.push(e),null!=this.CV&&((e=new l.a).Header="Actual Depr",e.DisplayMember="ActualDeprAmt",e.IsCalculated=1,e.Width=100,e.ReadOnly=!0,e.DataType="FLOAT",this.oColumns.push(e)),null!=this.oparent&&((e=new l.a).Header=i.a.GetResource("DocumentDesigner_VoucherNo"),e.DisplayMember="DocNo",e.DataType="LINK",e.ReadOnly=!0,e.Width=140,this.oColumns.push(e),(e=new l.a).Header=i.a.GetResource("select"),e.DisplayMember="select",e.DataType="CheckBox",e.Width=60,this.oColumns.push(e)),this.AllowEditPostingDate=i.a.SessionManager.IsActionAssigned(72,"Allow editing of depreciation posting date"),this.AllowEditPostingDate&&null!=this.oparent&&(this.Schedules.TableColumns.push("PostDate_Key"),this.Schedules.TableColumns.push("PostDate"),(e=new l.a).Header="Post Date",e.DisplayMember="PostDate",e.DataType="DATE",e.Width=110,e.ReadOnly=!1,this.oColumns.push(e)),(e=new l.a).Header=i.a.GetResource("DocID"),e.DisplayMember="CostCenterID",e.IsVisible=!1,e.Width=80,this.oColumns.push(e),this.Schedules.OnLinkClick.Subscribe(this,"OnLinkClickEvent"),this.Schedules.Table=[],this.Schedules.addEmptyRow(),this.Schedules.addEmptyRow(),this.Schedules.addEmptyRow(),this.Schedules.addEmptyRow(),this.Schedules.addEmptyRow(),this.Schedules.addEmptyRow(),this.Schedules.addEmptyRow(),this.Schedules.Columns=this.oColumns}},{key:"OnLinkClickEvent",value:function(e,t,s){c.RibbonExtViewModel.LoadDocument(e),i.a.page.HideDialog()}},{key:"LoadData",value:function(e,t,s){var n=this;this.Schedules.Clear();var o=this.oparent.ScreenObject.Data.Tables[4].filter((function(e){return"DepreciationJV"==e.Name}));o.length>0&&parseInt(o[0].Value)>0&&(this.JVCCID=parseInt(o[0].Value)),a.e.IsEmpty(e.Tables[4][0].AccumDeprACCID)||(this.CreditAcc=parseInt(e.Tables[4][0].AccumDeprACCID.toString())),a.e.IsEmpty(e.Tables[4][0].DeprExpenseACCID)||(this.DebitAcc=parseInt(e.Tables[4][0].DeprExpenseACCID.toString()));var r=a.e.Double(e.Tables[4][0].PreviousDepreciation);if((o=this.oparent.ScreenObject.Data.Tables[4].filter((function(e){return"AssetDeprPostDate"==e.Name}))).length>0&&"ScheduleDate"==o[0].Value.toString()&&(this.IsPostingOnScheduleDate=!0),e.Tables.length>10){var l=1;e.Tables[10].filter((function(e){return new Date(e.FromDate)>=t&&new Date(e.ToDate)<=s})).forEach((function(e){var t=n.Schedules.NewRow();t.period=(l++).toString(),t.From=e.FromDate,t.ID=e.ScheduleID,t.FromText=new Date(e.FromDate).ToString(i.a.SessionManager.Preferences["Date Format"]),t.To=e.ToDate,t.ToText=new Date(e.ToDate).ToString(i.a.SessionManager.Preferences["Date Format"]),t.DocID=e.DocID,t.DocNo=e.VoucherNo,t.Status=e.StatusID,t.CostCenterID=e.CostCenterID,t.DocPrefix=e.DocPrefix,t.DocNumber=e.DocNumber,t.DocumentName=e.DocumentName,t.DepAmt=parseFloat(e.DeprAmt).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount),t.AccDep=parseFloat(e.accmDepr).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount),t.NetValue=parseFloat(e.NetValue).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount),t.AccDepWithPrev=(parseFloat(e.accmDepr)+r).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount),t.select=!1,n.AllowEditPostingDate&&a.e.IsEmpty(t.DocNo)&&(n.IsPostingOnScheduleDate?(t.PostDate_Key=e.ToDate,t.PostDate=new Date(e.ToDate).ToString(i.a.SessionManager.Preferences["Date Format"])):(t.PostDate_Key=n.SystemDate,t.PostDate=n.SystemDate.ToString(i.a.SessionManager.Preferences["Date Format"]))),n.Schedules.addRow(t)}))}}},{key:"GetJVXML",value:function(){var e=this,t="",s=0;return t+="<JVXML>",this.oTable.forEach((function(i){!a.e.IsEmpty(i.select)&&Object(n.j)(i.select)&&a.e.IsEmpty(i.DocID)&&(s++,t+='<ROWS><DepreciationID DepID="'+i.ID.toString()+'" AssetID="'+e.AssetID+'"',e.Schedules.TableColumns.Contains("PostDate_Key")&&(t+=' Dt="'+new Date(i.PostDate_Key).ToString("dd MMM yyyy")+'"'),t+="/>",t+="</ROWS>")})),s>0&&(this.JVOK=!0),(t+="</JVXML>").toString()}},{key:"GetUnPostJVXML",value:function(){var e="",t=0;e+="<JVXML>";for(var s=this.oTable.length-1;s>=0;s--)a.e.IsEmpty(this.oTable[s].select)||!Object(n.j)(this.oTable[s].select)||a.e.IsEmpty(this.oTable[s].DocID)||(t++,e+='<DepreciationID DepID="'+this.oTable[s].ID.toString()+'" AssetID="'+this.AssetID+'"></DepreciationID>');return e+="</JVXML>",t>0&&(this.JVUNOK=!0),e.toString()}},{key:"OnButtonClick",value:function(e){var t=this;if(this.DisplayMessage="","Cancel"==e)i.a.page.HideDialog();else if("Delete"==e){if(!confirm("Do you want to delete depreciation schedule?"))return;var s=u.a.DeleteAssetDeprSchedule(this.AssetID);this.DisplayMessage=s.Message,a.e.Int(s.RetValue)>0&&(this.oparent.ds.Tables[10].Clear(),this.Schedules.Clear())}else if("Post"==e){var o=0;this.objAsset.PostAssetID=this.AssetID,this.objAsset.PostCCID=this.JVCCID,this.objAsset.JVXML=this.GetJVXML(),this.objAsset.Post=!0,this.JVOK?this.objAsset.PostDeprJV().subscribe((function(e){if(o=e.RetValue,t.DisplayMessage=e.Message,o>0){for(var s=0,i=0;i<t.oTable.length;i++)if(!a.e.IsEmpty(t.oTable[i].select)&&Object(n.j)(t.oTable[i].select)&&a.e.IsEmpty(t.oTable[i].DocID)){t.oparent.ViewTransactionHistory.TransactionHisInfoObj.addEmptyRow();var r=t.oparent.ViewTransactionHistory.TransactionHisInfo.length-1;0==r?s=t.oparent.GetDeprStartValue():r>0&&(s=0==i?t.oparent.GetDeprStartValue():parseFloat(t.oTable[i-1].NetValue.toString())),t.oparent.ViewTransactionHistory.TransactionHisInfo[r].Type="Depreciation Schedule Post",t.oparent.ViewTransactionHistory.TransactionHisInfo[r].Date=Date.Today().ToString("dd/MMM/yyyy"),t.oparent.ViewTransactionHistory.TransactionHisInfo[r].OldValue=s,t.oparent.ViewTransactionHistory.TransactionHisInfo[r].ChangeType="6",t.oparent.ViewTransactionHistory.TransactionHisInfo[r].Percentage=t.oTable[i].DepAmt.toString(),t.oparent.ViewTransactionHistory.TransactionHisInfo[r].NewValue=s-parseFloat(t.oTable[i].DepAmt.toString()),null!=t.oTable[i].DepAmt&&""!=t.oTable[i].DepAmt&&t.oparent.CurrentValueCallBack(s-parseFloat(t.oTable[i].DepAmt.toString())),t.oparent.ViewTransactionHistory.TransactionHisInfoObj.updateRow(t.oparent.ViewTransactionHistory.TransactionHisInfo[r])}return t.LoadData(u.a.GetAssetManagementDetails(t.AssetID),t.oparent.DeprFromDate,t.oparent.DeprToDate),t.MessageVisibility=!0,void(t.JVOK=!1)}})):this.DisplayMessage="Please select record to post"}else if("UnPost"==e){var r=0;this.objAsset.PostAssetID=this.AssetID,this.objAsset.PostCCID=this.JVCCID,this.objAsset.JVXML=this.GetUnPostJVXML(),this.objAsset.Post=!1,this.JVUNOK?this.objAsset.PostDeprJV().subscribe((function(e){if(r=e.RetValue,t.DisplayMessage=e.Message,r>0){for(var s=0,i=t.oTable.length-1;i>=0;i--)if(!a.e.IsEmpty(t.oTable[i].select)&&Object(n.j)(t.oTable[i].select)&&!a.e.IsEmpty(t.oTable[i].DocID)){t.oparent.ViewTransactionHistory.TransactionHisInfoObj.addEmptyRow();var o=t.oparent.ViewTransactionHistory.TransactionHisInfo.length-1;0==o?s=t.oparent.GetDeprStartValue():o>0&&(s=0==i?t.oparent.GetDeprStartValue():parseFloat(t.oTable[i-1].NetValue.toString())),t.oparent.ViewTransactionHistory.TransactionHisInfo[o].Type="Depreciation Schedule UnPost",t.oparent.ViewTransactionHistory.TransactionHisInfo[o].Date=Date.Today().ToString("dd/MMM/yyyy"),t.oparent.ViewTransactionHistory.TransactionHisInfo[o].OldValue=s-parseFloat(t.oTable[i].DepAmt.toString()),t.oparent.ViewTransactionHistory.TransactionHisInfo[o].ChangeType="6",t.oparent.ViewTransactionHistory.TransactionHisInfo[o].Percentage=t.oTable[i].DepAmt.toString(),t.oparent.ViewTransactionHistory.TransactionHisInfo[o].NewValue=s,null!=t.oTable[i].DepAmt&&""!=t.oTable[i].DepAmt&&t.oparent.CurrentValueCallBack(s),t.oparent.ViewTransactionHistory.TransactionHisInfoObj.updateRow(t.oparent.ViewTransactionHistory.TransactionHisInfo[o])}return t.LoadData(u.a.GetAssetManagementDetails(t.AssetID),t.oparent.DeprFromDate,t.oparent.DeprToDate),t.MessageVisibility=!0,void(t.JVUNOK=!1)}})):this.DisplayMessage="Please select record to Un post"}}},{key:"oTable",get:function(){return this.Schedules.Table}}]),s}(o.b)},"a2Y+":function(e,t,s){"use strict";s.r(t),s.d(t,"AssetManagement",(function(){return Ge})),s.d(t,"AssetDeprTabViewModel",(function(){return Ne}));var i=s("mrSG"),a=s("Do2H"),n=s("Lp6j"),o=s("eQJW"),r=s("ScVY"),l=s("Jnyl"),c=s("0/4Q"),u=s("JIg3"),h=s("EQd/"),d=s("NkMH"),D=s("8B8H"),b=s("ockk"),p=s("n56n"),m=s("VxiT"),C=s("c6C+"),S=s("RJs6"),g=s("xnJf"),T=s("OvA8"),A=s("MCLT"),y=s("4HhE"),I=s("jgdN"),V=s("CUWK"),f=s("hAwP"),v=s("OljK"),M=s("NM0h"),P=function(e){_inherits(s,e);var t=_createSuper(s);function s(e,i){var n;_classCallCheck(this,s),(n=t.call(this)).Value=0,n.values=0,n.DocID="",n.JVCCID=0,n.objAsset=new M.a,n.Date=new u.a(0),n.Amount=new h.d(0),n.ChangedValue=new h.d(0),n.CurrentValue=new h.d(0),n.Remarks=new h.c(0),n.DebitAccount=new p.b(0),n.CreditAccount=new p.b(0),n.GainAccount=new p.b(0),n.LossAccount=new p.b(0),n.DisposeClearingAccount=new p.b(0),n.PostJV=new c.e(0),n.Type=new c.e(0),n.dtDepr=null,n.oFormula=null,n.PartialDisposeOnNBV=!1,n.CurrentMonthScheduleID=0,n.dblAssetValue=0,n.dblPrevDeprValue=0,n.dblDeprValue=0,n.dblDisposeValue=0,n.dblCurrentMonthDepr=0,n.currentvalue=0,n.NBVDisposeValue=0,n.JVOK=!1,n.SaleProfit="",n.Title=a.a.GetResource("AssetManagement_InActive"),n.Date.Label=a.a.GetResource("AssetManagement_Date"),n.Type.Label=a.a.GetResource("AssetManagement_Type"),n.CurrentValue.Label=a.a.GetResource("AssetManagement_CurrentValue"),n.Amount.Label=a.a.GetResource("AssetManagement_Amount"),n.ChangedValue.Label=a.a.GetResource("AssetManagement_ChangedValue"),n.Remarks.Label=a.a.GetResource("AssetManagement_Remarks"),n.DebitAccount.Label=a.a.GetResource("AssetManagement_DebitAccount"),n.CreditAccount.Label=a.a.GetResource("AssetManagement_CreditAccount"),n.GainAccount.Label=a.a.GetResource("AssetManagement_GainAccount"),n.LossAccount.Label=a.a.GetResource("AssetManagement_LossAccount"),n.DisposeClearingAccount.Label=a.a.GetResource("AssetManagement_DispClrAcc"),n.PostJV.Label=a.a.GetResource("AssetDepr_PostJV"),n.CurrentValue.Enable=!1,n.ChangedValue.Enable=!1,n.Parent=e,n.CurrentValue.Text=i,n.PostJV.Items.push(c.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_Yes"),"1")),n.PostJV.Items.push(c.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_No"),"2")),n.Type.Items.push(c.d.ComboBoxItems_2("Dispose Partial","0")),n.Type.Items.push(c.d.ComboBoxItems_2("Dispose Full","1")),n.Type.Items.push(c.d.ComboBoxItems_2("Sale Full","3")),n.Type.SelectedValue="0",n.Type.SelectionChangedCommand.Subscribe(_assertThisInitialized(n),"OnTypeChanged"),n.OnTypeChanged(null);var o=n.Parent.ScreenObject.Data.Tables[4].filter((function(e){return"DisposeJV"==e.Name}));return o.length>0&&parseInt(o[0].Value)>0&&(n.JVCCID=parseInt(o[0].Value)),(o=n.Parent.ScreenObject.Data.Tables[4].filter((function(e){return"PartialDisposeBasedOnNBV"==e.Name}))).length>0&&"TRUE"==o[0].Value.toString().toUpperCase()&&(n.PartialDisposeOnNBV=!0),e.RefreshAssetDataSet(),n.dtDepr=n.Parent.ds.Tables[10],n.CreditAccount.CCID=2,n.CreditAccount.TypeID=13,n.DebitAccount.CCID=2,n.DebitAccount.TypeID=14,n.GainAccount.CCID=2,n.GainAccount.TypeID=18,n.LossAccount.CCID=2,n.LossAccount.TypeID=19,n.DisposeClearingAccount.CCID=2,n.DisposeClearingAccount.TypeID=17,n.ClearFields(n.Parent.AssetID),n.Amount.TextChangedCommand.Subscribe(_assertThisInitialized(n),"OnLostFocus"),n.Date.SelectedDateChanged.Subscribe(_assertThisInitialized(n),"OnDateChanged"),n.CalculateCurrentValue("Value"),n}return _createClass(s,[{key:"OnTypeChanged",value:function(e){if(this.CalcCurrentMonthDepr(),"1"==this.Type.SelectedValue||"3"==this.Type.SelectedValue){if("1"==this.Type.SelectedValue?(this.LossAccount.Visible=!0,this.GainAccount.Visible=!1,this.DisposeClearingAccount.Visible=!1,this.Amount.Enable=!1,this.Amount.Text="",this.ChangedValue.Text=""):"3"==this.Type.SelectedValue&&(this.LossAccount.Visible=!0,this.GainAccount.Visible=!0,this.DisposeClearingAccount.Visible=!0,this.Amount.Enable=!0,this.ChangedValue.Text=""),this.CalcCurrentMonthDepr(),this.dblDeprValue=0,this.dblPrevDeprValue=this.Parent.GetPrevDeprValue(),this.dtDepr.length>0){var t=this.dtDepr.filter((function(e){return!Object(A.isNullOrUndefined)(e.DocID)})).Compute("sum","DeprAmt");null!=t&&(this.dblDeprValue=parseFloat(parseFloat(t).ToString("N"+a.a.SessionManager.Preferences.DecimalsinAmount))),this.dblAssetValue=0;var s=0;for(s=0;s<this.dtDepr.length&&null!=this.dtDepr[s].DocID;s++);s--,this.dblAssetValue=s>=0?parseFloat(this.dtDepr[s].NetValue):parseFloat(this.dtDepr[0].NetValue)+parseFloat(this.dtDepr[0].DeprAmt),this.dblAssetValue=parseFloat(this.dblAssetValue.ToString("N"+a.a.SessionManager.Preferences.DecimalsinAmount)),this.dblAssetValue+=this.dblDeprValue,this.dblDisposeValue=this.dblAssetValue-this.dblDeprValue}else this.dblAssetValue=this.Parent.GetDeprStartValue(),this.dblDisposeValue=this.dblAssetValue-this.dblDeprValue;"1"==this.Type.SelectedValue&&(this.Amount.Text=parseFloat((this.dblDisposeValue-this.dblCurrentMonthDepr).ToString("N"+a.a.SessionManager.Preferences.DecimalsinAmount)).toString())}else this.GainAccount.Visible=!1,this.DisposeClearingAccount.Visible=!1,this.Amount.Enable=!0,this.Amount.Text=""}},{key:"OnLostFocus",value:function(e){if(!n.e.IsNum(this.Amount.Text))return this.DisplayMessage="Enter Valid Amount",void(this.ChangedValue.Text=this.CurrentValue.Text);this.DisplayMessage="",this.CalculateCurrentValue("Date")}},{key:"OnDateChanged",value:function(e){this.CalculateCurrentValue("Date")}},{key:"CalculateCurrentValue",value:function(e){if(null!=e&&("Value"==e.toString()||"Date"==e.toString())){var t;if(this.currentvalue=0,this.NBVDisposeValue=0,this.dblCurrentMonthDepr=0,this.CurrentMonthScheduleID=0,this.dtDepr.length>0){var s=this.dtDepr.filter((function(e){return Object(A.isNullOrUndefined)(e.DocID)}));s.SortBy(["FromDate"]),this.currentvalue=s.length>0?parseFloat(s[0].NetValue)+parseFloat(s[0].DeprAmt):0,this.CalcCurrentMonthDepr(),this.currentvalue-=this.dblCurrentMonthDepr}else this.currentvalue=this.Parent.GetDeprStartValue();if(this.CurrentValue.Text=this.currentvalue.toString(),"1"==this.Type.SelectedValue||"2"==this.Type.SelectedValue||"3"==this.Type.SelectedValue)return"1"==this.Type.SelectedValue&&(this.Amount.Text=this.CurrentValue.Text),void(this.ChangedValue.Text="0");if(t=n.e.Double(this.Amount.Text),null!=this.Amount.Text&&""!=this.Amount.Text)if("0"==this.Type.SelectedValue&&this.PartialDisposeOnNBV){var i=0;0==(i=n.e.Double(this.Parent.PurchaseValue.Text))&&(i=n.e.Double(this.Parent.DeprStartValue.Text)),this.NBVDisposeValue=this.currentvalue*t/i,this.ChangedValue.Text=(this.currentvalue-this.NBVDisposeValue).ToString("N"+a.a.SessionManager.Preferences.DecimalsinAmount)}else this.ChangedValue.Text=(this.currentvalue-t).ToString("N"+a.a.SessionManager.Preferences.DecimalsinAmount);else this.ChangedValue.Text=""}}},{key:"CalcCurrentMonthDepr",value:function(){if(this.CurrentMonthScheduleID=0,this.dblCurrentMonthDepr=0,null!=this.dtDepr){for(var e=null,t=0;t<this.dtDepr.length;t++){var s=this.dtDepr[t];if(null==s.DocID){e=s;break}}if(null!=e){var i=new Date(e.FromDate),n=new Date(e.ToDate);if(i<this.Date.Date&&n>=this.Date.Date){var o=this.Date.Date.getDate()-i.getDate();o>0&&(this.CurrentMonthScheduleID=parseInt(e.ScheduleID),this.dblCurrentMonthDepr=parseFloat((parseFloat(e.DeprAmt)*o/(n.getDate()+1-i.getDate())).ToString("N"+a.a.SessionManager.Preferences.DecimalsinAmount)))}}}}},{key:"OnButtonClick",value:function(e){var t=this,s=null;if(this.DisplayMessage="","Cancel"==e)this.Parent.AddDisposalVisibility=!1,this.Parent.DetailsVisibility=!0,a.a.page.HideDialog();else if("Ok"==e){var i=0;if(!n.e.Double(this.Amount.Text))return void(this.DisplayMessage="Enter Valid Amount");if(null==this.Amount.Text||""==this.Amount.Text)return void(this.DisplayMessage="Enter Amount");if(n.e.Double(this.ChangedValue.Text)<0&&"3"!=this.Type.SelectedValue&&!("0"==this.Type.SelectedValue&&parseFloat(this.CurrentValue.Text)<=0))return void(this.DisplayMessage="Enter Amount Less than or equal current value.");if(null==this.Amount.Text||""==this.Amount.Text)return void(this.DisplayMessage="Enter Amount");if("1"==this.PostJV.SelectedValue){if(this.DebitAccount.Visible&&0==this.DebitAccount.SelectedValue)return void(this.DisplayMessage="Select Debit Account");if(this.CreditAccount.Visible&&0==this.CreditAccount.SelectedValue)return void(this.DisplayMessage="Select Credit Account");if(this.DisposeClearingAccount.Visible&&0==this.DisposeClearingAccount.SelectedValue)return void(this.DisplayMessage="Select Dispose Clearing Account");if(this.LossAccount.Visible&&0==this.LossAccount.SelectedValue&&"0"==this.Type.SelectedValue)return void(this.DisplayMessage="Select Dispose Clearing Account")}if("0"==this.Type.SelectedValue){var o=parseFloat(this.Amount.Text);"0"==this.Type.SelectedValue&&this.PartialDisposeOnNBV&&(this.CalculateCurrentValue("Value"),o=this.NBVDisposeValue);var r=new f.a;if(r.Date=this.Date.Date,r.Value=o,r.IsDispose=!0,this.oFormula=new f.b(this.Parent.AssetID),this.oFormula.GetScheduleData(this.Parent.GetDeprStartValue(),0,0,0,null,0,0,"SLN","Y",0,"FP",this.Parent.CDeprStartDate.Date,this.Parent.CDeprEndDate.Date,r,this.Parent.DeprBook.SelectedValue.toString()),this.oFormula.ErrorMessage.length>0)return void(this.DisplayMessage=this.oFormula.ErrorMessage);this.objAsset.DepreciationXML=this.oFormula.GetXML()}else{var l=this.dtDepr.filter((function(e){return!Object(A.isNullOrUndefined)(e.DocID)&&(new Date(e.FromDate)>=t.Date.Date||new Date(e.FromDate)<=t.Date.Date.OnlyDate()&&new Date(e.ToDate)>t.Date.Date.OnlyDate())}));if(l.length>0)return void(this.DisplayMessage="Depreciation posting exists for selected date.");var c=new Date(this.Date.Date.getFullYear(),this.Date.Date.getMonth(),1);if((l=this.dtDepr.filter((function(e){return Object(A.isNullOrUndefined)(e.DocID)&&new Date(e.ToDate)<c.OnlyDate()}))).length>0)return void(this.DisplayMessage="Clear Pending Depreciation Postings.")}if(1==this.Parent.DEditClick&&0==this.Parent.DAddClick){this.PostJV.Enable=!1;var u=parseInt(this.Edr.ItemArray[0].toString())-1;this.Parent.DisposeGrid.Table[u].Date=this.Date.Date.ToString("dd/MMM/yyyy"),this.Parent.DisposeGrid.Table[u].Amount=this.Amount.Text,this.Parent.DisposeGrid.Table[u].CurrentValue=this.CurrentValue.Text,this.Parent.DisposeGrid.Table[u].Remarks=this.Remarks.Text,this.Parent.DisposeGrid.Table[u].DebitAccount=this.DebitAccount.SelectedValue,this.Parent.DisposeGrid.Table[u].CreditAccount=this.CreditAccount.SelectedValue,this.Parent.DisposeGrid.Table[u].GainAccount=this.GainAccount.SelectedValue,this.Parent.DisposeGrid.Table[u].LossAccount=this.LossAccount.SelectedValue,this.Parent.DisposeGrid.Table[u].DisposeClearingAccount=this.DisposeClearingAccount.SelectedValue,this.Parent.DisposeGrid.Table[u].DisposeType_Name="1"==this.Type.SelectedValue||"2"==this.Type.SelectedValue||"3"==this.Type.SelectedValue?this.Type.GetselectedItem().Name:"Dispose",this.objAsset.PostAssetID=this.Parent.AssetID,this.objAsset.PostCCID=this.JVCCID,this.objAsset.JVXML=this.GetJVXML(),this.objAsset.RecordType="EDIT",this.objAsset.DeprTypeID=2,"1"==this.PostJV.SelectedValue?(this.objAsset.DocXML=this.DocXML("DocumentEdit"),this.objAsset.DocSave="",this.objAsset.Post=!0):"2"==this.PostJV.SelectedValue&&(this.objAsset.DocXML="",this.objAsset.DocSave=this.DocXML("NewInsertDoc"),this.objAsset.Post=!1),this.objAsset.SetAssetDispose(this.Date.Date).subscribe((function(e){s=e.ds,(i=n.e.Int(e.obj))>0&&(t.Parent.IsFullDispose=parseInt(t.Type.SelectedValue),t.Parent.AddDisposalVisibility=!1,t.Parent.DetailsVisibility=!0,null!=t.ChangedValue.Text&&t.Parent.CurrentValueCallBack(parseFloat(t.ChangedValue.Text)),t.ClearFields(t.Parent.AssetID))}))}else{if(this.objAsset.PostAssetID=this.Parent.AssetID,this.objAsset.PostCCID=this.JVCCID,this.objAsset.JVXML=this.GetJVXML(),"3"==this.Type.SelectedValue){if(this.GainAccount.Visible&&0==this.GainAccount.SelectedValue&&"GAIN"==this.SaleProfit)return void(this.DisplayMessage="Select Gain Account");if(this.LossAccount.Visible&&0==this.LossAccount.SelectedValue&&"LOSS"==this.SaleProfit)return void(this.DisplayMessage="Select Loss Account")}this.objAsset.DocXML="",this.objAsset.DocSave=this.DocXML("NewInsertDoc"),this.objAsset.DeprTypeID=2,this.objAsset.RecordType="NEW",this.objAsset.Post="1"==this.PostJV.SelectedValue,this.objAsset.SetAssetDispose(this.Date.Date).subscribe((function(e){if(s=e.ds,(i=n.e.Int(e.obj))>0){t.Parent.IsFullDispose=parseInt(t.Type.SelectedValue);for(var a,o=-1,r=0;r<t.Parent.DisposeGrid.Table.length;r++)if(n.e.IsEmpty(t.Parent.DisposeGrid.Table[r].Edit)){o=r;break}if((a=o>-1?t.Parent.DisposeGrid.Table[o]:t.Parent.DisposeGrid.NewRow()).Date=t.Date.Date.ToString("dd/MMM/yyyy"),a.Amount=t.Amount.Text,a.CurrentValue=t.CurrentValue.Text,a.Remarks=t.Remarks.Text,a.DebitAccount=t.DebitAccount.SelectedValue,a.CreditAccount=t.CreditAccount.SelectedValue,a.GainAccount=t.GainAccount.SelectedValue,a.LossAccount=t.LossAccount.SelectedValue,a.DisposeClearingAccount=t.DisposeClearingAccount.SelectedValue,a.DisposeType_Name="1"==t.Type.SelectedValue||"2"==t.Type.SelectedValue||"3"==t.Type.SelectedValue?t.Type.GetselectedItem().Name:"Dispose",a.HistoryID=i,null!=s){for(var l=null,c=0;c<s.Tables.length;c++){var u=s.Tables[c];if(u.Columns.Contains("VOUCHERNO")&&u.Columns.Contains("DOcID")){u.length>0&&(l=u);break}}null!=l&&(a.DocID=l[0].DOcID.toString(),a.DocNo=l[0].VoucherNo.toString(),a.CostCenterID=l[0].CostCenterID.toString(),a.DocumentName=l[0].DocumentName.toString(),a.DocPrefix=l[0].DocPrefix.toString(),a.DocNumber=l[0].DocNumber.toString())}a.PostJV=t.PostJV.SelectedValue,a.Edit="Edit",a.Delete="Delete",-1==o?t.Parent.DisposeGrid.addRow(a):t.Parent.DisposeGrid.updateRow(a),t.values=n.e.Double(t.Amount.Text),t.Parent.ViewTransactionHistory.TransactionHisInfoObj.addEmptyRow();var h=t.Parent.ViewTransactionHistory.TransactionHisInfo.length-1;0==h?t.Value=0:h>0&&(t.Value=parseFloat(t.CurrentValue.Text)),t.Parent.ViewTransactionHistory.TransactionHisInfo[h].Type="Dispose",t.Parent.ViewTransactionHistory.TransactionHisInfo[h].Date=t.Date.Date.ToString("dd/MMM/yyyy"),t.Parent.ViewTransactionHistory.TransactionHisInfo[h].OldValue=t.Value,t.Parent.ViewTransactionHistory.TransactionHisInfo[h].ChangeType="5",t.Parent.ViewTransactionHistory.TransactionHisInfo[h].Percentage=t.values,t.Parent.ViewTransactionHistory.TransactionHisInfo[h].NewValue=t.Value-t.values,t.Parent.ViewTransactionHistory.TransactionHisInfoObj.updateRow(t.Parent.ViewTransactionHistory.TransactionHisInfo[h]),t.Parent.AddDisposalVisibility=!1,t.Parent.DetailsVisibility=!0,n.e.IsEmpty(t.ChangedValue.Text)?t.Parent.CurrentValueCallBack(0):t.Parent.CurrentValueCallBack(parseFloat(t.ChangedValue.Text)),t.ClearFields(t.Parent.AssetID)}else t.DisplayMessage="Error in saving"}))}}}},{key:"ClearFields",value:function(e){var t=null;this.Date.Date=Date.Today(),this.Amount.Text="",this.CurrentValue.Text="",this.Remarks.Text="",this.ChangedValue.Text="",this.DebitAccount.SelectedValue=this.Parent.AccumDeprACCID.SelectedValue,this.CreditAccount.SelectedValue=this.Parent.AcqnCostACCID.SelectedValue,this.GainAccount.SelectedValue=this.Parent.DisposalGainAcc.SelectedValue,this.LossAccount.SelectedValue=this.Parent.DisposalLossAcc.SelectedValue,this.DisposeClearingAccount.SelectedValue=this.Parent.DisposalClearingAcc.SelectedValue,(t=this.Parent.ScreenObject.Data.Tables[4].filter((function(e){return"DDefaultPostJV"==e.Name}))).length>0&&parseInt(t[0].Value)>0&&(this.PostJV.SelectedValue=t[0].Value.toString()),t=this.Parent.ScreenObject.Data.Tables[4].filter((function(e){return"DPostJVMand"==e.Name})),this.PostJV.Enable=!(t.length>0&&1==parseInt(t[0].Value))}},{key:"OnLoad",value:function(e){this.Edr=e,null!=e&&(this.Type.SelectedValue=e.PolicyType.toString(),this.OnTypeChanged(null),this.Date.Date=new Date(e.Date.toString()),this.CurrentValue.Text=e.CurrentValue.toString(),this.Amount.Text=e.Amount.toString(),this.Remarks.Text=e.Remarks.toString(),this.DebitAccount.SelectedValue=parseInt(e.DebitAccount.toString()),this.CreditAccount.SelectedValue=parseInt(e.CreditAccount.toString()),this.GainAccount.SelectedValue=parseInt(e.GainAccount.toString()),this.LossAccount.SelectedValue=parseInt(e.LossAccount.toString()),this.PostJV.SelectedValue=e.PostJV.toString(),this.DocID=e.DocID.toString(),History=e.HistoryID.toString())}},{key:"GetJVXML",value:function(){var e="",t=n.e.IsEmpty(this.Remarks.Text)?"":n.e.EncodeXML(this.Remarks.Text),s=" <Numeric /> <Alpha />"+this.Parent.GetCCXML()+" <EXTRAXML/>";e+="<JVXML>";var i=this.dblDeprValue+this.dblCurrentMonthDepr,o=this.dblDisposeValue-this.dblCurrentMonthDepr;if(1!=this.Date.Date.getDate()&&("1"==this.Type.SelectedValue||"3"==this.Type.SelectedValue)&&this.dblCurrentMonthDepr>0){var r=0,l=0;""!=this.Parent.ds.Tables[4][0].AccumDeprACCID.toString()&&(r=parseInt(this.Parent.ds.Tables[4][0].AccumDeprACCID.toString())),""!=this.Parent.ds.Tables[4][0].DeprExpenseACCID.toString()&&(l=parseInt(this.Parent.ds.Tables[4][0].DeprExpenseACCID.toString()));var c=this.dblCurrentMonthDepr.ToString("N"+a.a.SessionManager.Preferences.DecimalsinAmount).Replace(",","");e+='<ROWS ScheduleID="'+this.CurrentMonthScheduleID.toString()+'" Amount="'+c+'" AccDepr="'+i+'" Net="'+o+'"><DocumentXML>',e+='<Row><Transactions DocSeqNo="1"  DocDetailsID="0" LinkedInvDocDetailsID="" LinkedFieldName="" DebitAccount="'+l.toString()+'" CreditAccount="-99" Amount="'+c+'" AmtFc="'+c+'" CurrencyID="1" ExchangeRate="1" LineNarration="'+t+'" CommonNarration="Depreciation Posting"  >',e+="</Transactions>",e+=s,e+=' </Row><Row><Transactions DocSeqNo="2"  DocDetailsID="0" LinkedInvDocDetailsID="" LinkedFieldName="" DebitAccount="-99" CreditAccount="'+r.toString()+'" Amount="'+c+'" AmtFc="'+c+'" CurrencyID="1" ExchangeRate="1" LineNarration="'+t+'" CommonNarration="Depreciation Posting"  >',e+="</Transactions>",e+=s,e+=" </Row>",e+="</DocumentXML></ROWS>"}if(e+="<ROWS><DocumentXML>","1"==this.Type.SelectedValue)e+='<Row> <Transactions DocSeqNo="1"  DocDetailsID="0" LinkedInvDocDetailsID="" LinkedFieldName="" CreditAccount="'+this.CreditAccount.SelectedValue.toString()+'" DebitAccount="-99" Amount="'+(this.dblAssetValue+this.dblPrevDeprValue)+'" AmtFc="'+(this.dblAssetValue+this.dblPrevDeprValue)+'" CurrencyID="1" ExchangeRate="1" LineNarration="'+t+'" CommonNarration="Asset Dispose Posting"  >',e+="</Transactions>",e+=s,e+=' </Row><Row> <Transactions DocSeqNo="2"  DocDetailsID="0" LinkedInvDocDetailsID="" LinkedFieldName="" CreditAccount="-99" DebitAccount="'+this.DebitAccount.SelectedValue.toString()+'" Amount="'+(i+this.dblPrevDeprValue)+'" AmtFc="'+(i+this.dblPrevDeprValue)+'" CurrencyID="1" ExchangeRate="1" LineNarration="'+t+'" CommonNarration="Asset Dispose Posting"  >',e+="</Transactions>",e+=s,e+=" </Row>",o>0&&(e+='<Row> <Transactions DocSeqNo="3"  DocDetailsID="0" LinkedInvDocDetailsID="" LinkedFieldName="" CreditAccount="-99" DebitAccount="'+this.LossAccount.SelectedValue.toString()+'" Amount="'+o+'" AmtFc="'+o+'" CurrencyID="1" ExchangeRate="1" LineNarration="'+t+'" CommonNarration="'+t+'"  >',e+="</Transactions>",e+=s,e+=" </Row>");else if("3"==this.Type.SelectedValue){this.SaleProfit="";var u=parseFloat(this.Amount.Text);e+='<Row> <Transactions DocSeqNo="1"  DocDetailsID="0" LinkedInvDocDetailsID="" LinkedFieldName="" CreditAccount="'+this.CreditAccount.SelectedValue.toString()+'" DebitAccount="-99" Amount="'+(this.dblAssetValue+this.dblPrevDeprValue)+'" AmtFc="'+(this.dblAssetValue+this.dblPrevDeprValue)+'" CurrencyID="1" ExchangeRate="1" LineNarration="'+t+'" CommonNarration="Asset Dispose Posting"  >',e+="</Transactions>",e+=s,e+=' </Row><Row> <Transactions DocSeqNo="2"  DocDetailsID="0" LinkedInvDocDetailsID="" LinkedFieldName="" CreditAccount="-99" DebitAccount="'+this.DebitAccount.SelectedValue.toString()+'" Amount="'+(i+this.dblPrevDeprValue)+'" AmtFc="'+(i+this.dblPrevDeprValue)+'" CurrencyID="1" ExchangeRate="1" LineNarration="'+t+'" CommonNarration="Asset Dispose Posting"  >',e+="</Transactions>",e+=s,e+=" </Row>",u>0&&(e+='<Row> <Transactions DocSeqNo="3"  DocDetailsID="0" LinkedInvDocDetailsID="" LinkedFieldName="" CreditAccount="-99" DebitAccount="'+this.DisposeClearingAccount.SelectedValue.toString()+'" Amount="'+u+'" AmtFc="'+u+'" CurrencyID="1" ExchangeRate="1" LineNarration="'+t+'" CommonNarration="Asset Dispose Posting"  >',e+="</Transactions>",e+=s,e+=" </Row>"),u!=o&&(u>o?(this.SaleProfit="GAIN",e+='<Row> <Transactions DocSeqNo="4"  DocDetailsID="0" LinkedInvDocDetailsID="" LinkedFieldName="" CreditAccount="'+this.GainAccount.SelectedValue.toString()+'" DebitAccount="-99" Amount="'+(u-o).toString()+'" AmtFc="'+(u-o).toString()+'" CurrencyID="1" ExchangeRate="1" LineNarration="'+t+'" CommonNarration="Asset Dispose Posting"  >'):(this.SaleProfit="LOSS",e+='<Row> <Transactions DocSeqNo="4"  DocDetailsID="0" LinkedInvDocDetailsID="" LinkedFieldName="" CreditAccount="-99" DebitAccount="'+this.LossAccount.SelectedValue.toString()+'" Amount="'+(o-u).toString()+'" AmtFc="'+(o-u).toString()+'" CurrencyID="1" ExchangeRate="1" LineNarration="'+t+'" CommonNarration="Asset Dispose Posting"  >'),e+="</Transactions>",e+=s,e+=" </Row>")}else{var h=0,d=0;this.PartialDisposeOnNBV?(h=parseFloat(this.Amount.Text)-this.NBVDisposeValue,d=this.NBVDisposeValue):h=parseFloat(this.Amount.Text),e+='<Row><Transactions DocSeqNo="1"  DocDetailsID="0" LinkedInvDocDetailsID="" LinkedFieldName="" CreditAccount="'+this.CreditAccount.SelectedValue.toString()+'" DebitAccount="-99" Amount="'+this.Amount.Text+'" AmtFc="'+this.Amount.Text+'" CurrencyID="1" ExchangeRate="1" LineNarration="'+t+'" CommonNarration="Asset Dispose Posting">',e+="</Transactions>",e+=s,e+="</Row>",h>0&&(e+='<Row><Transactions DocSeqNo="2"  DocDetailsID="0" LinkedInvDocDetailsID="" LinkedFieldName="" CreditAccount="-99" DebitAccount="'+this.DebitAccount.SelectedValue.toString()+'" Amount="'+h.toString()+'" AmtFc="'+h.toString()+'" CurrencyID="1" ExchangeRate="1" LineNarration="'+t+'" CommonNarration="Asset Dispose Posting">',e+="</Transactions>",e+=s,e+="</Row>"),0!=d&&(e+='<Row><Transactions DocSeqNo="2"  DocDetailsID="0" LinkedInvDocDetailsID="" LinkedFieldName="" CreditAccount="-99" DebitAccount="'+this.LossAccount.SelectedValue.toString()+'" Amount="'+d.toString()+'" AmtFc="'+d.toString()+'" CurrencyID="1" ExchangeRate="1" LineNarration="'+t+'" CommonNarration="Asset Dispose Posting">',e+="</Transactions>",e+=s,e+="</Row>")}return e+="</DocumentXML></ROWS>",e+="</JVXML>",this.JVOK=!0,e.toString()}},{key:"DocXML",value:function(e){var t="";return t+="<XML ",t+='History="'+this.Type.GetselectedItem().Name+'" ',t+='HistoryType="3" ',t+='Type="'+this.Type.SelectedValue+'" ',t+='Date="'+this.Date.Date.ToString("dd/MMM/yyyy")+'" ',t+='Amount="'+this.Amount.Text.Replace(",","")+'" ',t+='CurrentValue="'+this.CurrentValue.Text.Replace(",","")+'" ',t+='PurchaseValue="'+this.Parent.GetDeprStartValue()+'" ',t+='Remarks="'+this.Remarks.Text+'" ',t+='DebitAccount="'+this.DebitAccount.SelectedValue+'" ',t+='CreditAccount="'+this.CreditAccount.SelectedValue+'" ',t+='GainAccount="'+this.GainAccount.SelectedValue+'" ',t+='LossAccount="'+this.LossAccount.SelectedValue+'" ',t+='PostJV="'+this.PostJV.SelectedValue+'" ',t+='HistoryID="'+History+'" ',"DocumentEdit"==e?t+='DocID="'+this.DocID+'" ':"NewInsertDoc"==e&&(t+='AssetID="'+this.Parent.AssetID+'" '),(t+="/>").toString()}}]),s}(r.b),w=s("7fVR"),E=s("fXoL"),G=s("ofXK"),N=s("sT9C"),k=s("sYmb");function O(e,t){if(1&e){var s=E.ac();E.Zb(0,"span",6),E.hc("click",(function(){return E.Ic(s),E.lc().obj.OnButtonClick("Post")})),E.Ub(1,"i",7),E.Wc(2),E.mc(3,"translate"),E.Yb()}2&e&&(E.Db(2),E.Xc(E.nc(3,1,"Post")))}function j(e,t){if(1&e){var s=E.ac();E.Zb(0,"span",6),E.hc("click",(function(){return E.Ic(s),E.lc().obj.OnButtonClick("UnPost")})),E.Ub(1,"i",8),E.Wc(2),E.mc(3,"translate"),E.Yb()}2&e&&(E.Db(2),E.Xc(E.nc(3,1,"UnPost")))}function L(e,t){if(1&e){var s=E.ac();E.Zb(0,"span",6),E.hc("click",(function(){return E.Ic(s),E.lc().obj.OnButtonClick("Delete")})),E.Ub(1,"i",9),E.Wc(2),E.mc(3,"translate"),E.Yb()}2&e&&(E.Db(2),E.Xc(E.nc(3,1,"Delete")))}var x,R,F=((x=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||x)},x.\u0275cmp=E.Nb({type:x,selectors:[["app-depreciation-schedule"]],decls:20,vars:4,consts:[[1,"master-screen",2,"padding-bottom","4px","width","955px"],[1,"dialogSubBody"],[1,"btnMetroDiv","secondary-btn-group",2,"padding-top","0px","margin-top","-8px"],["class","secondary-btn-wicon",3,"click",4,"ngIf"],[1,"documentgrid","row","form-row",2,"width","100%"],[2,"width","100%",3,"obj"],[1,"secondary-btn-wicon",3,"click"],[1,"fa-light","fa-floppy-disk-circle-arrow-right"],[1,"fa-light","fa-file-times"],[1,"fa-light","fa-trash-alt"]],template:function(e,t){1&e&&(E.Zb(0,"div",0),E.Wc(1,"\n    "),E.Zb(2,"div",1),E.Wc(3,"\n        "),E.Zb(4,"div",2),E.Wc(5,"\n            "),E.Uc(6,O,4,3,"span",3),E.Wc(7,"\n            "),E.Uc(8,j,4,3,"span",3),E.Wc(9,"\n            "),E.Uc(10,L,4,3,"span",3),E.Wc(11,"\n        "),E.Yb(),E.Wc(12,"\n      "),E.Zb(13,"div",4),E.Wc(14,"\n        "),E.Ub(15,"app-PactGridView",5),E.Wc(16,"  \n      "),E.Yb(),E.Wc(17,"\n    "),E.Yb(),E.Wc(18,"    \n"),E.Yb(),E.Wc(19,"\n")),2&e&&(E.Db(6),E.tc("ngIf",t.obj.PostVisible),E.Db(2),E.tc("ngIf",t.obj.PostVisible),E.Db(2),E.tc("ngIf",t.obj.DeleteVisible),E.Db(5),E.tc("obj",t.obj.Schedules))},directives:[G.t,N.a],pipes:[k.d],encapsulation:2}),x),B=function(e){_inherits(s,e);var t=_createSuper(s);function s(e){var i;_classCallCheck(this,s),(i=t.call(this)).currentvalue=0,i.Parent=null,i.PeriodField="",i.SalValue="",i.PurValue="",i.DepreciationMethod="",i.AveragingMethod="",i.objAsset=new M.a,i.ChangeID=0,i.Type=new c.e(0),i.PostJV=new c.e(0),i.Date=new u.a(0),i.Location=new p.b(0),i.DebitAccount=new p.b(0),i.CreditAccount=new p.b(0),i.Value=new h.d(0),i.NewEsitmateLife=new h.d(0),i.NewEsitmateEndDate=new u.a(0),i.RemiainingLifeObj=new h.d(0),i.Remarks=new h.d(0),i.UpdatedValueObj=new h.d(0),i.OldValueObj=new h.d(0),i.IsModified=!1,i.value=0,i.JVOK=!1,i.NetAssetValue="",i.dtDepr=[],i.ClassName="ChangeValue",i.Parent=e,i.Title=i.DisplayName=a.a.GetResource("AssetManagement_ChangeValue"),i.Date.Label=a.a.GetResource("AssetManagement_Date"),i.Type.Label=a.a.GetResource("AssetManagement_Type"),i.OldValueObj.Label="Old Value",i.Value.Label=a.a.GetResource("AssetManagement_Amount"),i.UpdatedValueObj.Label="New Value",i.RemiainingLifeObj.Label="Remaining Life",i.Remarks.Label=a.a.GetResource("BillWise_Remarks"),i.DebitAccount.Label=a.a.GetResource("AssetManagement_DebitAccount"),i.CreditAccount.Label=a.a.GetResource("AssetManagement_CreditAccount"),i.PostJV.Label=a.a.GetResource("AssetDepr_PostJV"),i.DebitAccount.CCID=2,i.DebitAccount.TypeID=100,i.CreditAccount.CCID=2,i.CreditAccount.TypeID=100,i.UpdatedValue="",i.UpdatedValueObj.Enable=!1,i.OldValue="",i.OldValueObj.Enable=!1,i.RemiainingLife="",i.RemiainingLifeObj.Enable=!1,i.NewEsitmateEndDate.Enable=!1,i.Date.SelectedDateChanged.Subscribe(_assertThisInitialized(i),"OnDateChanged"),i.Value.TextChangedCommand.Subscribe(_assertThisInitialized(i),"OnTextChange","Value"),i.NewEsitmateLife.TextChangedCommand.Subscribe(_assertThisInitialized(i),"OnEsitmateLifeChange"),i.Type.Items.push(c.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_IncreasebyValue"),"0")),i.Type.Items.push(c.d.ComboBoxItems_2("Change Estimate Life","25")),i.Type.SelectedValue="0",i.Type.SelectionChangedCommand.Subscribe(_assertThisInitialized(i),"OnTypeChanged"),i.PostJV.Items.push(c.d.ComboBoxItems_2(a.a.GetResource("Com_No"),"2")),i.PostJV.Items.push(c.d.ComboBoxItems_2(a.a.GetResource("Com_Yes"),"1"));var n=i.Parent.ScreenObject.Data.Tables[4].filter((function(e){return"DIncreaseDefaultPostJV"==e.Name}));return i.PostJV.SelectedValue=n.length>0&&parseInt(n[0].Value)>0?n[0].Value.toString():"1",n=i.Parent.ScreenObject.Data.Tables[4].filter((function(e){return"DIncreasePostJVMand"==e.Name})),i.PostJV.Enable=!(n.length>0&&1==parseInt(n[0].Value)),i.DebitAccount.TypeID=i.Parent.AcqnCostACCID.TypeID,i.DebitAccount.SelectedValue=i.Parent.AcqnCostACCID.SelectedValue,i.CreditAccount.TypeID=i.Parent.AcquisitionClearingAcc.TypeID,i.CreditAccount.SelectedValue=i.Parent.AcquisitionClearingAcc.SelectedValue,i.Location.SelectedValue=i.Parent.Location.SelectedValue,e.RefreshAssetDataSet(),i.dtDepr=e.ds.Tables[10],i.OnTypeChanged(null),i}return _createClass(s,[{key:"OnSaveValue",value:function(e){var t=this;if(this.DisplayMessage="","Cancel"==e)this.Parent.ChangeValueVisibility=!1,this.Parent.DetailsVisibility=!0,a.a.page.HideDialog();else if("Schedule"==e){var s=this.CalculateAssetSchedule();if(this.DisplayMessage.length>0)return;var i=new w.a;i.DepreciationScheduleViewModel_1(this),i.Schedules.Table.Clear(),i.Schedules.TableColumns.push("ActualDeprAmt"),s.ScheduleTable.forEach((function(e){var t=i.Schedules.NewRow();t.period=e.Period,t.FromText=new Date(e.From).ToString(a.a.SessionManager.Preferences["Date Format"]),t.ToText=new Date(e.To).ToString(a.a.SessionManager.Preferences["Date Format"]),t.DepAmt=e["Depr Amt"],t.AccDepWithPrev=(s.PrevDeprValue+parseFloat(e["Accm Depr"])).ToString(a.a.SessionManager.Preferences.DecimalsinAmount),t.NetValue=e["Net Value"],null!=e.DocID&&(t.Status="Posted"),t.ActualDeprAmt=e.ActualDeprAmt,i.Schedules.addRow(t)})),a.a.page.ShowDialog(i,F,{ShowCenter:!0})}else{var o=this.CalculateAssetSchedule();if(this.DisplayMessage.length>0)return;if("25"==this.Type.SelectedValue)for(var r=o.ScheduleTable.filter((function(e){return!Object(A.isNullOrUndefined)(e.DocID)})),l=r.length-1;l>=0;l--)o.ScheduleTable.Remove(r[l]);this.objAsset.DepreciationXML=o.GetXML(),this.objAsset.ChangeValueXML="<ChangeValueXML><Row ",this.objAsset.ChangeValueXML+=' AssetID="'+this.Parent.AssetID+'"',this.objAsset.ChangeValueXML+=' ChangeType="'+this.Type.SelectedValue+'"',this.objAsset.ChangeValueXML+=' ChangeName="'+this.Type.Text+'"',this.objAsset.ChangeValueXML+=' StatusID="'+this.Parent.Status.SelectedValue+'"',this.objAsset.ChangeValueXML+=' ChangeDate="'+this.Date.Date.ToString("dd/MMM/yyyy")+'"',this.objAsset.ChangeValueXML+=' AssetOldValue="'+this.currentvalue+'"',this.objAsset.ChangeValueXML+=' ChangeValue="'+this.value+'"',this.objAsset.ChangeValueXML+=' AssetNewValue="'+(this.currentvalue+this.value)+'"',"25"==this.Type.SelectedValue&&(this.objAsset.ChangeValueXML+=' NewEsitmateLife="'+this.NewEsitmateLife.Text+'"',this.objAsset.ChangeValueXML+=' NewEsitmateEndDate="'+this.NewEsitmateEndDate.Date.ToString("dd/MMM/yyyy")+'"'),this.objAsset.ChangeValueXML+="/>",this.objAsset.ChangeValueXML+="</ChangeValueXML>",this.objAsset.HistoryXML="",this.objAsset.LocationID=this.Location.SelectedValue,this.objAsset.JVXML="1"==this.PostJV.SelectedValue&&"4"!=this.Type.SelectedValue&&"25"!=this.Type.SelectedValue?this.GetJVXML():"",this.objAsset.ChangeValue(parseInt(this.Type.SelectedValue),this.Date.Date).subscribe((function(e){if(t.DisplayMessage=e.Message,n.e.Int(e.RetValue)>0){"25"==t.Type.SelectedValue&&(t.Parent.EstLife=t.Parent.EstimateLife.Text=t.NewEsitmateLife.Text,null!=t.Parent.CDeprEndDate&&(t.Parent.CDeprEndDate.Date=t.NewEsitmateEndDate.Date)),t.Parent.ViewTransactionHistory.ExchList.push(t),t.Parent.ViewTransactionHistory.TransactionHisInfoObj.addEmptyRow();var s=t.Parent.ViewTransactionHistory.TransactionHisInfo.length-1;return t.Parent.ViewTransactionHistory.TransactionHisInfo[s].Type=t.Type.Text,t.Parent.ViewTransactionHistory.TransactionHisInfo[s].Date=t.Date.Date.ToString("dd/MMM/yyyy"),t.Parent.ViewTransactionHistory.TransactionHisInfo[s].OldValue=t.currentvalue,t.Parent.ViewTransactionHistory.TransactionHisInfo[s].ChangeType=t.Type.SelectedValue,t.Parent.ViewTransactionHistory.TransactionHisInfo[s].Percentage="2"==t.Type.SelectedValue||"3"==t.Type.SelectedValue?t.value.toString()+"%":t.value,t.Parent.ViewTransactionHistory.TransactionHisInfo[s].NewValue="0"==t.Type.SelectedValue?t.currentvalue+t.value:"1"==t.Type.SelectedValue?t.currentvalue-t.value:"2"==t.Type.SelectedValue?t.currentvalue<0?t.currentvalue-t.currentvalue*(t.value/100):t.currentvalue+t.currentvalue*(t.value/100):"3"==t.Type.SelectedValue?t.currentvalue<0?t.currentvalue+t.currentvalue*(t.value/100):t.currentvalue-t.currentvalue*(t.value/100):t.currentvalue,n.e.IsEmpty(t.UpdatedValue)?t.Parent.CurrentValueCallBack(t.currentvalue):t.Parent.CurrentValueCallBack(parseFloat(t.UpdatedValue)),t.Date.Date=Date.Today(),t.Location.SelectedValue=0,t.Type.SelectedValue="0",t.Value.Text="",t.UpdatedValue="",void(t.Remarks.Text="")}}))}}},{key:"CalculateAssetSchedule",value:function(){if(this.Value.Visible){if(0==n.e.IsNum(this.Value.Text))return this.DisplayMessage="Only Numeric Characters allowed in Value",null;if(null==this.Value.Text||""==this.Value.Text||""==this.Value.Text.Trim())return this.DisplayMessage="Enter Value",null}if(this.Date.Date<this.Parent.CDeprStartDate.Date)return this.DisplayMessage="Date should not be less than "+this.Parent.CDeprStartDate.Label,null;if("1"==this.PostJV.SelectedValue){if(this.DebitAccount.Visible&&0==this.DebitAccount.SelectedValue)return this.DisplayMessage="Select Debit Account",null;if(this.CreditAccount.Visible&&0==this.CreditAccount.SelectedValue)return this.DisplayMessage="Select Credit Account",null}this.ChangeID>0&&(this.IsModified=!0),this.value=n.e.Double(this.Value.Text);var e=this.Parent.GetDeprStartValue();this.SalValue="2"==this.Parent.DeprSalvage.Currency.SelectedValue?n.e.IsEmptySpace(this.Parent.DeprSalvage.ExchangeRate.Text)||"0"==this.Parent.DeprSalvage.ExchangeRate.Text?"0":(parseFloat(this.Parent.DeprSalvage.ExchangeRate.Text)*e/100).toString():this.Parent.DeprSalvage.ExchangeRate.Text,this.PeriodField=this.Parent.DeprPeriod.SelectedValue,this.DepreciationMethod=this.Parent.DeprMethod.SelectedValue,this.AveragingMethod=this.Parent.DeprAvgMethod.SelectedValue,this.NetAssetValue=this.currentvalue.toString(),this.objAsset.IsIncreaseAssetValue=!1,"1"==this.Type.SelectedValue?this.value=-this.value:"2"==this.Type.SelectedValue?this.value=this.currentvalue*(this.value/100):"3"==this.Type.SelectedValue?this.value=this.value/100*-this.currentvalue:"0"==this.Type.SelectedValue&&(this.objAsset.IsIncreaseAssetValue=!0),this.objAsset.PostAssetID=this.Parent.AssetID,this.objAsset.ChangeValueTypeID=parseInt(this.Type.SelectedValue),this.objAsset.ChangeVal=this.value,this.objAsset.AssetNetValueChange=this.currentvalue,this.objAsset.Description=this.Remarks.Text;var t=new f.a;t.Date=this.Date.Date,t.Value=this.value;var s=new f.b(this.Parent.AssetID);return"25"==this.Type.SelectedValue&&(s.NewEsitmateLife=this.RemiainingLife,s.NewEsitmateEndDate=this.NewEsitmateEndDate.Date),s.GetScheduleData(e,0,0,0,null,0,parseFloat(this.SalValue),this.DepreciationMethod,this.PeriodField,0,this.AveragingMethod,this.Parent.CDeprStartDate.Date,this.Parent.CDeprEndDate.Date,t,this.Parent.DeprBook.SelectedValue.toString()),this.dtDepr=s.dtDepr,s.ErrorMessage.length>0?(this.DisplayMessage=s.ErrorMessage,null):s}},{key:"GetJVXML",value:function(){var e="",t=this.Parent.GetCCXML();return e+="<JVXML>",e+="<ROWS><DocumentXML>",e+='<Row> <Transactions DocSeqNo="1"  DocDetailsID="0" LinkedInvDocDetailsID="" LinkedFieldName="" DebitAccount="'+this.DebitAccount.SelectedValue.toString()+'" CreditAccount="-99" Amount="'+this.value.toString()+'" AmtFc="'+this.value.toString()+'" CurrencyID="1" ExchangeRate="1" LineNarration="Depreciation Change Value Posting" CommonNarration="Depreciation Change Value Posting"  >',e+="</Transactions>",e+=" <Numeric /> <Alpha />"+t+"<EXTRAXML/>",e+=' </Row><Row> <Transactions DocSeqNo="2"  DocDetailsID="0" LinkedInvDocDetailsID="" LinkedFieldName="" DebitAccount="-99" CreditAccount="'+this.CreditAccount.SelectedValue.toString()+'" Amount="'+this.value.toString()+'" AmtFc="'+this.value.toString()+'" CurrencyID="1" ExchangeRate="1" LineNarration="Depreciation Change Value  Posting" CommonNarration="Depreciation Change Value Posting"  >',e+="</Transactions>",e+=" <Numeric /> <Alpha />"+t+"<EXTRAXML/>",e+=" </Row>",e+="</DocumentXML></ROWS>",this.JVOK=!0,e+="</JVXML>",Logger.InfoLog("DepreciattionScheduleViewModel ::Exiting GetReceiptXML"),e.toString()}},{key:"OnTypeChanged",value:function(e){"25"==this.Type.SelectedValue?(this.NewEsitmateLife.Label=this.Parent.EstimateLife.Label,this.NewEsitmateLife.Text=this.Parent.EstimateLife.Text,this.NewEsitmateEndDate.Label=this.Parent.CDeprEndDate.Label,this.NewEsitmateEndDate.Date=this.Parent.CDeprEndDate.Date,this.Value.Visible=!1,this.DebitAccount.Visible=!1,this.CreditAccount.Visible=!1,this.PostJV.Visible=!1,this.NewEsitmateLife.Visible=!0,this.NewEsitmateEndDate.Visible=!0):(this.Value.Visible=!0,this.DebitAccount.Visible=!0,this.CreditAccount.Visible=!0,this.PostJV.Visible=!0,this.NewEsitmateLife.Visible=!1,this.NewEsitmateEndDate.Visible=!1),this.OnDateChanged(null)}},{key:"OnDateChanged",value:function(e){this.CalculateCurrentValue("Date"),"25"==this.Type.SelectedValue&&this.OnEsitmateLifeChange(null)}},{key:"OnTextChange",value:function(e){this.CalculateCurrentValue(e)}},{key:"CalculateCurrentValue",value:function(e){var t=this;if(null!=e&&("Value"==e.toString()||"Date"==e.toString())){var s,i=this.dtDepr.filter((function(e){return new Date(e.ToDate)<t.Date.Date.OnlyDate()}));i.SortBy(["FromDate"]),this.dtDepr.length>0?i.length>0?this.currentvalue=parseFloat(i[i.length-1].NetValue):((i=this.dtDepr.filter((function(e){return new Date(e.FromDate)>=t.Date.Date.OnlyDate()}))).SortBy(["FromDate"]),i.length>0&&(this.currentvalue=parseFloat(i[0].PurchaseValue))):this.currentvalue=this.Parent.GetDeprStartValue(),s=n.e.Double(this.Value.Text),this.UpdatedValue="0"==this.Type.SelectedValue?null!=this.Value.Text&&""!=this.Value.Text?(this.currentvalue+s).toString():this.currentvalue.toString():"1"==this.Type.SelectedValue?null!=this.Value.Text&&""!=this.Value.Text?(this.currentvalue-s).toString():this.currentvalue.toString():"2"==this.Type.SelectedValue?null!=this.Value.Text&&""!=this.Value.Text?this.currentvalue<0?(this.currentvalue-this.currentvalue*(s/100)).toString():(this.currentvalue+this.currentvalue*(s/100)).toString():this.currentvalue.toString():"3"==this.Type.SelectedValue&&null!=this.Value.Text&&""!=this.Value.Text?this.currentvalue<0?(this.currentvalue+this.currentvalue*(s/100)).toString():(this.currentvalue-this.currentvalue*(s/100)).toString():this.currentvalue.toString(),this.UpdatedValue=parseFloat(this.UpdatedValue).ToString("N"+a.a.SessionManager.Preferences.DecimalsinAmount),this.OldValue=this.currentvalue.toString()}}},{key:"OnEsitmateLifeChange",value:function(e){if(!n.e.IsEmpty(this.NewEsitmateLife.Text)){var t=Date.Today(),s=Date.Today(),i=0,a=0,o=this.NewEsitmateLife.Text.split(".");s=n.e.Int(o[0]),o.length>1&&(i=n.e.Int(o[1])),o.length>2&&(a=n.e.Int(o[2])),this.NewEsitmateEndDate.Date=this.Parent.CDeprStartDate.Date.AddYears(s),this.NewEsitmateEndDate.Text=this.NewEsitmateEndDate.Date.AddYears(s).toString(),i>0&&(this.NewEsitmateEndDate.Date=this.NewEsitmateEndDate.Date.AddMonths(i)),a>0&&(this.NewEsitmateEndDate.Date=this.NewEsitmateEndDate.Date.AddDays(a));var r,l=0,c=0;for(t=this.Date.Date;t.AddYears(1)<=this.NewEsitmateEndDate.Date;)t=t.AddYears(1),l++;for(var u=11;u>=1;u--)if(t.AddMonths(u)<=this.NewEsitmateEndDate.Date){c=u,t=t.AddMonths(u);break}r=this.NewEsitmateEndDate.Date.Subtract(t).Days,this.RemiainingLife=l.toString(),(c>0||r>0)&&(this.RemiainingLife+="."+c,r>0&&(this.RemiainingLife+="."+r))}}},{key:"RemiainingLife",get:function(){return this.RemiainingLifeObj.Text},set:function(e){this.RemiainingLifeObj.Text=e}},{key:"UpdatedValue",get:function(){return this.UpdatedValueObj.Text},set:function(e){this.UpdatedValueObj.Text=e}},{key:"OldValue",get:function(){return this.OldValueObj.Text},set:function(e){this.OldValueObj.Text=e}}]),s}(r.b),_=function(e){_inherits(s,e);var t=_createSuper(s);function s(e){var i;return _classCallCheck(this,s),(i=t.call(this)).currentvalue=0,i.Parent=null,i.EstLife="",i.PeriodField="",i.SalValue="",i.PurValue="",i.DepreciationMethod="",i.AvgMethod="",i.DeprStartDate=Date.Today(),i.objAsset={},i.ChangeID=0,i.DeprMethod=new c.e(0),i.AveragingMethod=new c.e(0),i.DeprType=new c.e(0),i.Date=new u.a(0),i.EndDate=new u.a(0),i.CurrentValue=new h.d(0),i.Salvage=new h.d(0),i.Estimatedlife=new h.d(0),i.IsModified=!1,i.value=0,i.NetAssetValue="",i.dtDepr=[],i.Parent=e,"1"==i.Parent.DeprSchedule.SelectedValue&&(i.MessageVisibility=!0,i.DisplayMessage="Schedule already exists"),i.CurrentValue.Text=i.Parent.NetValue.Text,i.Estimatedlife.Text=e.EstLife,i.Salvage.Text=e.SalValue,i.AveragingMethod.Items.push(c.d.ComboBoxItems_2(a.a.GetResource("DeprBook_CalendarDays"),"1")),i.AveragingMethod.Items.push(c.d.ComboBoxItems_2(a.a.GetResource("DeprBook_FullMonth"),"2")),i.AveragingMethod.SelectedValue=e.DeprAvgMethod.SelectedValue,i.DeprMethod.Items.push(c.d.ComboBoxItems_2("Straight Line","1")),i.DeprMethod.Items.push(c.d.ComboBoxItems_2("Written Down Value","0")),i.DeprMethod.SelectedValue=e.DeprMethod.SelectedValue,i.DeprType.Items.push(c.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_Monthly"),"1")),i.DeprType.Items.push(c.d.ComboBoxItems_2(a.a.GetResource("Budget_Quarterly"),"3")),i.DeprType.Items.push(c.d.ComboBoxItems_2(a.a.GetResource("Budget_Halfyearely"),"4")),i.DeprType.Items.push(c.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_Yearly"),"2")),i.DeprType.SelectedValue=e.DeprPeriod.SelectedValue,i.Date.Date=new Date(e.DepSDate),i.EndDate.Date=new Date(e.DepEDate),i}return _createClass(s,[{key:"OnSaveValue",value:function(e){if("Cancel"==e)this.Parent.AssetScheduleDeprVisibility=!1,this.Parent.DetailsVisibility=!0;else{if("1"==this.Parent.DeprSchedule.SelectedValue)return this.MessageVisibility=!0,void(this.DisplayMessage="Schedule already exists");this.objAsset.AMAssetID=this.Parent.AssetID,this.objAsset.AMCode=this.Parent.Code.Text,this.objAsset.AMName=this.Parent.Name.Text,this.objAsset.AMStatusID=parseInt(this.Parent.Status.SelectedValue),this.objAsset.AMParentAssetID=this.Parent.ParentAsset.SelectedValue,this.objAsset.DetailsXML="",this.objAsset.CustomFieldsQuery="",this.objAsset.CustomCostCenterFieldsQuery="",this.objAsset.ChangeValueXML="",this.objAsset.HistoryXML="",this.objAsset.AMPurchaseValue=this.CurrentValue.Text,this.objAsset.DepreciationXML=this.GetDepreciationXML(this.Estimatedlife.Text,this.Salvage.Text,this.DeprType.SelectedValue,this.Date.Date,this.DeprMethod.SelectedValue,this.AveragingMethod.SelectedValue),this.objAsset.NotesXML="",this.objAsset.AttachmetsXML="",this.objAsset.AMGUID=this.Parent.GUID,0}}},{key:"GetDepreciationXML",value:function(e,t,s,i,a,n){var o=0,r=0,l=this.objAsset.GetAssetManagementDetails(this.Parent.AssetID);null!=l&&l.Tables.length>10&&(this.dtDepr=l.Tables[10]);try{""!=this.CurrentValue.Text&&(r=parseFloat(this.CurrentValue.Text))}catch(u){}try{o=parseFloat(e)}catch(h){}if(r<=0)return this.DisplayMessage="Enter PurchaseValue in PurchaseDetail Tab","";if(o<=0)return this.DisplayMessage="Enter EstimatedLife in PurchaseDetail Tab","";var c;this.Parent.AssetID>0&&(null!=this.dtDepr&&this.dtDepr.length>0&&((c=this.dtDepr.filter((function(e){return Object(A.isNullOrUndefined)(e.DocID)}))).length>0&&new Date(c[0].FromDate)));return""}}]),s}(r.b),W=s("Q01V"),H=function(e){_inherits(s,e);var t=_createSuper(s);function s(e){var i;return _classCallCheck(this,s),(i=t.call(this)).ColumnSpan=4,i.TransactionHisInfoObj=new D.a,i.TColumnSource=new Array,i.ExchList=new Array,i.Module="ASS",i.ClassName="ViewTransactionHistory",i.Parent=e,i.TransactionHisInfoObj.Height=200,i.TransactionHisInfoObj.Table=[],i.TransactionHisInfoObj.TableColumns.push("Type"),i.TransactionHisInfoObj.TableColumns.push("Date"),i.TransactionHisInfoObj.TableColumns.push("OldValue"),i.TransactionHisInfoObj.TableColumns.push("Percentage"),i.TransactionHisInfoObj.TableColumns.push("NewValue"),i.TransactionHisInfoObj.TableColumns.push("ChangeType"),i.TransactionHisInfoObj.TableColumns.push("CreatedDate"),i.AddHistoryGridColumns(),i}return _createClass(s,[{key:"OnChangeValue",value:function(e){this.Parent.OnAddValue()}},{key:"AddHistoryGridColumns",value:function(){var e;(e=new b.a).DisplayMember="Type",e.Header=a.a.GetResource("Type"),e.Width=250,e.ReadOnly=!0,this.TColumnSource.push(e),(e=new b.a).DisplayMember="Date",e.Header=a.a.GetResource("Date"),e.Width=150,e.ReadOnly=!0,this.TColumnSource.push(e),(e=new b.a).DisplayMember="OldValue",e.Header=a.a.GetResource("Old Value"),e.Width=150,e.ReadOnly=!0,this.TColumnSource.push(e),(e=new b.a).DisplayMember="Percentage",e.Header=a.a.GetResource("+/-"),e.Width=100,e.ReadOnly=!0,this.TColumnSource.push(e),(e=new b.a).DisplayMember="NewValue",e.Header=a.a.GetResource("New Value"),e.Width=150,e.ReadOnly=!0,this.TColumnSource.push(e),(e=new b.a).DisplayMember="CreatedDate",e.Header=a.a.GetResource("CreatedDate"),e.Width=150,e.ReadOnly=!0,this.TColumnSource.push(e),this.TransactionHisInfoObj.Columns=this.TColumnSource}},{key:"LoadValueInfo",value:function(e,t){if(e.length>0){for(var s=0;s<e.length;s++)this.TransactionHisInfoObj.addEmptyRow(),this.TransactionHisInfo[s].Type=e[s].ChangeName.toString(),this.TransactionHisInfo[s].Date=new Date(e[s].Date.toString()).ToString("dd/MMM/yyyy"),this.TransactionHisInfo[s].OldValue=e[s].AssetOldValue.toString(),this.TransactionHisInfo[s].Percentage=e[s].ChangeValue.toString(),this.TransactionHisInfo[s].NewValue=e[s].AssetNewValue.toString(),this.TransactionHisInfo[s].ChangeType=e[s].ChangeType.toString(),t.Contains("CreatedDt")&&(this.TransactionHisInfo[s].CreatedDate=new Date(e[s].CreatedDt.toString()).ToString("dd/MMM/yyyy"));this.TransactionHisInfoObj.refreshDataView()}}},{key:"TransactionHisInfo",get:function(){return this.TransactionHisInfoObj.Table}},{key:"angularGrid",get:function(){return this.TransactionHisInfoObj.angularGrid}}]),s}(y.c),X=function(e){_inherits(s,e);var t=_createSuper(s);function s(e){var i;return _classCallCheck(this,s),(i=t.call(this)).ColumnSpan="4",i.InsuranceCovered=new c.e(26411),i.Vendor=new p.b(26412),i.PolicyNo=new h.d(26416),i.Type=new h.d(26415),i.Effectivedate=new u.a(26413),i.ExpiryDate=new u.a(26414),i.InsurancePremium=new h.d(26417),i.PolicyCoverage=new h.d(26418),i.parent=e,i.InsuranceCovered.Items.push(c.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_Yes"),"1")),i.InsuranceCovered.Items.push(c.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_No"),"0")),i.InsuranceCovered.SelectedValue="1",i}return s}(r.b),J=function(e){_inherits(s,e);var t=_createSuper(s);function s(e){var i;return _classCallCheck(this,s),(i=t.call(this)).ColumnSpan="4",i.MaintenanceCovered=new c.e(26406),i.Vendor=new p.b(26409),i.NextServiceDate=new u.a(26410),i.StartDate=new u.a(26407),i.ExpiryDate=new u.a(26408),i.parent=e,i.MaintenanceCovered.Items.push(c.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_Yes"),"1")),i.MaintenanceCovered.Items.push(c.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_No"),"0")),i.MaintenanceCovered.SelectedValue="1",i}return s}(r.b),U=s("3Pt+"),Y=s("q8k3"),Z=((R=function(){function e(){_classCallCheck(this,e),this.form=new U.j({})}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||R)},R.\u0275cmp=E.Nb({type:R,selectors:[["app-depreciation-filter"]],decls:30,vars:10,consts:[[1,"dialogSubBody",2,"width","360px"],[1,"row","form-row"],[1,"col","PACTControl",2,"margin-right","30px"],["FieldDirective","",3,"obj","group"],[1,"col","PACTControl"],[1,"Pactdailogfooter",2,"border-top-width","0px"],[1,"primary-btn-wicon",3,"click"],[1,"secondary-btn-wicon",3,"click"],[1,"fa-light","fa-rectangle-xmark"]],template:function(e,t){1&e&&(E.Zb(0,"div",0),E.Wc(1,"\n    "),E.Zb(2,"div",1),E.Wc(3,"\n        "),E.Zb(4,"div",2),E.Wc(5,"\n            "),E.Vb(6,3),E.Wc(7,"\n        "),E.Yb(),E.Wc(8,"\n        "),E.Zb(9,"div",4),E.Wc(10,"\n            "),E.Vb(11,3),E.Wc(12,"\n        "),E.Yb(),E.Wc(13,"\n    "),E.Yb(),E.Wc(14,"\n    "),E.Zb(15,"div",5),E.Wc(16,"\n        "),E.Zb(17,"div"),E.Wc(18,"\n            "),E.Zb(19,"button",6),E.hc("click",(function(){return t.obj.OnClick("OK")})),E.Wc(20),E.mc(21,"translate"),E.Yb(),E.Wc(22,"\n            "),E.Zb(23,"button",7),E.hc("click",(function(){return t.obj.OnClick("Cancel")})),E.Ub(24,"i",8),E.Wc(25),E.mc(26,"translate"),E.Yb(),E.Wc(27,"\n        "),E.Yb(),E.Wc(28,"\n    "),E.Yb(),E.Wc(29," \n"),E.Yb()),2&e&&(E.Db(6),E.tc("obj",t.obj.FromDate)("group",t.form),E.Db(5),E.tc("obj",t.obj.ToDate)("group",t.form),E.Db(9),E.Xc(E.nc(21,6,"Com_OK")),E.Db(5),E.Xc(E.nc(26,8,"Cancel")))},directives:[Y.a],pipes:[k.d],encapsulation:2}),R),Q=function(e){_inherits(s,e);var t=_createSuper(s);function s(e,i){var n,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return _classCallCheck(this,s),(n=t.call(this)).oparent=null,n.FromDate=new u.a(0),n.ToDate=new u.a(0),n.IsEstimateLif=!1,n.IsEstimateLif=o,n.FromDate.Label=a.a.GetResource("DocumentDesigner_FromDate"),n.ToDate.Label=a.a.GetResource("DocumentDesigner_ToDate"),n.oparent=e,n.FromDate.Width=n.ToDate.Width="140",o?(n.Title=n.oparent.EstimateLife.Label,n.FromDate.Date=n.oparent.CDeprStartDate.Date?n.oparent.CDeprStartDate.Date:Date.Today(),n.ToDate.Date=n.oparent.CDeprEndDate.Date?n.oparent.CDeprEndDate.Date:Date.Today().AddYears(1)):(n.Title=a.a.GetResource("DepreciationFilter"),n.FromDate.Date=i.OnlyDate()),n}return _createClass(s,[{key:"OnClick",value:function(e){"OK"==e?this.IsEstimateLif?(this.oparent.CDeprStartDate.Date=this.FromDate.Date,this.oparent.CDeprEndDate.Date=this.ToDate.Date,this.oparent.EstLife=f.b.CalculateEstimateLife(this.oparent.CDeprStartDate.Date,this.oparent.CDeprEndDate.Date),this.oparent.EstimateLife.Text=this.oparent.EstLife):(this.oparent.DeprFilterCheck=0,this.oparent.DeprFromDate=this.FromDate.Date,this.oparent.DeprToDate=this.ToDate.Date):this.oparent.DeprFilterCheck=1,a.a.page.HideDialog()}}]),s}(r.b),K=function(e){_inherits(s,e);var t=_createSuper(s);function s(e){var i;return _classCallCheck(this,s),(i=t.call(this)).Module="ASS",i.ClassName="AssetTabGrid",i.IsColumnUserDefined=!1,i.Height=180,i.Parent=e,i}return s}(D.a);function q(e,t){if(1&e&&(E.Zb(0,"div",10),E.Wc(1,"\n            "),E.Vb(2,4),E.Wc(3,"\n        "),E.Yb()),2&e){var s=E.lc();E.Db(2),E.tc("obj",s.obj.Type)("group",s.group)}}function z(e,t){if(1&e&&(E.Zb(0,"div",10),E.Wc(1,"\n            "),E.Vb(2,4),E.Wc(3,"\n        "),E.Yb()),2&e){var s=E.lc();E.Db(2),E.tc("obj",s.obj.OldValueObj)("group",s.group)}}function $(e,t){if(1&e&&(E.Zb(0,"div",10),E.Wc(1,"\n            "),E.Vb(2,4),E.Wc(3,"\n        "),E.Yb()),2&e){var s=E.lc();E.Db(2),E.tc("obj",s.obj.Value)("group",s.group)}}function ee(e,t){if(1&e&&(E.Zb(0,"div",10),E.Wc(1,"\n            "),E.Vb(2,4),E.Wc(3,"\n        "),E.Yb()),2&e){var s=E.lc();E.Db(2),E.tc("obj",s.obj.UpdatedValueObj)("group",s.group)}}function te(e,t){if(1&e&&(E.Zb(0,"div",10),E.Wc(1,"\n            "),E.Vb(2,4),E.Wc(3,"\n        "),E.Yb()),2&e){var s=E.lc();E.Db(2),E.tc("obj",s.obj.NewEsitmateLife)("group",s.group)}}function se(e,t){if(1&e&&(E.Zb(0,"div",10),E.Wc(1,"\n            "),E.Vb(2,4),E.Wc(3,"\n        "),E.Yb()),2&e){var s=E.lc();E.Db(2),E.tc("obj",s.obj.NewEsitmateEndDate)("group",s.group)}}function ie(e,t){if(1&e&&(E.Zb(0,"div",10),E.Wc(1,"\n            "),E.Vb(2,4),E.Wc(3,"\n        "),E.Yb()),2&e){var s=E.lc();E.Db(2),E.tc("obj",s.obj.RemiainingLifeObj)("group",s.group)}}function ae(e,t){if(1&e&&(E.Zb(0,"div",10),E.Wc(1,"\n            "),E.Vb(2,4),E.Wc(3,"\n        "),E.Yb()),2&e){var s=E.lc();E.Db(2),E.tc("obj",s.obj.Remarks)("group",s.group)}}function ne(e,t){if(1&e&&(E.Zb(0,"div",10),E.Wc(1,"\n            "),E.Vb(2,4),E.Wc(3,"\n        "),E.Yb()),2&e){var s=E.lc();E.Db(2),E.tc("obj",s.obj.DebitAccount)("group",s.group)}}function oe(e,t){if(1&e&&(E.Zb(0,"div",10),E.Wc(1,"\n            "),E.Vb(2,4),E.Wc(3,"\n        "),E.Yb()),2&e){var s=E.lc();E.Db(2),E.tc("obj",s.obj.CreditAccount)("group",s.group)}}function re(e,t){if(1&e&&(E.Zb(0,"div",10),E.Wc(1,"\n            "),E.Vb(2,4),E.Wc(3,"\n        "),E.Yb()),2&e){var s=E.lc();E.Db(2),E.tc("obj",s.obj.PostJV)("group",s.group)}}var le,ce=((le=function(){function e(){_classCallCheck(this,e),this.group=new U.j({})}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||le)},le.\u0275cmp=E.Nb({type:le,selectors:[["app-change-value"]],decls:52,vars:19,consts:[[1,"master-screen"],[1,"PACTHeaderFields","dialogSubBody"],[1,"form-group","col","PACTControl",2,"display","flex"],[2,"display","block","width","180px"],["FieldDirective","",3,"obj","group"],[1,"quicklink",2,"position","absolute","bottom","10px","left","200px",3,"click"],["class","form-group col PACTControl",4,"ngIf"],[1,"Pactdailogfooter"],[1,"primary-btn-wicon",3,"click"],[1,"secondary-btn-wicon",3,"click"],[1,"form-group","col","PACTControl"]],template:function(e,t){1&e&&(E.Zb(0,"div",0),E.Wc(1,"\n    "),E.Zb(2,"div",1),E.Wc(3,"\n        "),E.Zb(4,"div",2),E.Wc(5,"\n            "),E.Zb(6,"div",3),E.Wc(7,"\n                "),E.Vb(8,4),E.Wc(9,"\n            "),E.Yb(),E.Wc(10,"\n            "),E.Zb(11,"span",5),E.hc("click",(function(){return t.obj.OnSaveValue("Schedule")})),E.Wc(12,"Show Schedule"),E.Yb(),E.Wc(13,"\n        "),E.Yb(),E.Wc(14,"\n        "),E.Uc(15,q,4,2,"div",6),E.Wc(16,"\n        "),E.Uc(17,z,4,2,"div",6),E.Wc(18,"\n        "),E.Uc(19,$,4,2,"div",6),E.Wc(20,"\n        "),E.Uc(21,ee,4,2,"div",6),E.Wc(22,"\n        "),E.Uc(23,te,4,2,"div",6),E.Wc(24,"\n        "),E.Uc(25,se,4,2,"div",6),E.Wc(26,"\n        "),E.Uc(27,ie,4,2,"div",6),E.Wc(28,"\n        "),E.Uc(29,ae,4,2,"div",6),E.Wc(30,"\n        "),E.Uc(31,ne,4,2,"div",6),E.Wc(32,"\n        "),E.Uc(33,oe,4,2,"div",6),E.Wc(34,"\n        "),E.Uc(35,re,4,2,"div",6),E.Wc(36,"\n  "),E.Yb(),E.Wc(37,"\n  "),E.Zb(38,"div",7),E.Wc(39,"\n    "),E.Zb(40,"div"),E.Wc(41,"\n        "),E.Zb(42,"button",8),E.hc("click",(function(){return t.obj.OnSaveValue("Ok")})),E.Wc(43),E.mc(44,"translate"),E.Yb(),E.Wc(45,"\n        "),E.Zb(46,"button",9),E.hc("click",(function(){return t.obj.OnSaveValue("Cancel")})),E.Wc(47),E.mc(48,"translate"),E.Yb(),E.Wc(49,"\n    "),E.Yb(),E.Wc(50,"      \n  "),E.Yb(),E.Wc(51,"\n"),E.Yb()),2&e&&(E.Db(8),E.tc("obj",t.obj.Date)("group",t.group),E.Db(7),E.tc("ngIf",t.obj.Type.Visible),E.Db(2),E.tc("ngIf",t.obj.Value.Visible),E.Db(2),E.tc("ngIf",t.obj.Value.Visible),E.Db(2),E.tc("ngIf",t.obj.Value.Visible),E.Db(2),E.tc("ngIf",t.obj.NewEsitmateLife.Visible),E.Db(2),E.tc("ngIf",t.obj.NewEsitmateEndDate.Visible),E.Db(2),E.tc("ngIf",t.obj.NewEsitmateLife.Visible),E.Db(2),E.tc("ngIf",t.obj.Remarks.Visible),E.Db(2),E.tc("ngIf",t.obj.DebitAccount.Visible),E.Db(2),E.tc("ngIf",t.obj.CreditAccount.Visible),E.Db(2),E.tc("ngIf",t.obj.PostJV.Visible),E.Db(8),E.Xc(E.nc(44,15,"Ok")),E.Db(4),E.Xc(E.nc(48,17,"Cancel")))},directives:[Y.a,G.t],pipes:[k.d],encapsulation:2}),le);function ue(e,t){if(1&e&&(E.Zb(0,"div",9),E.Wc(1,"\n            "),E.Vb(2,3),E.Wc(3,"\n        "),E.Yb()),2&e){var s=E.lc();E.Db(2),E.tc("obj",s.obj.Type)("group",s.group)}}function he(e,t){if(1&e&&(E.Zb(0,"div",9),E.Wc(1,"\n            "),E.Vb(2,3),E.Wc(3,"\n        "),E.Yb()),2&e){var s=E.lc();E.Db(2),E.tc("obj",s.obj.CurrentValue)("group",s.group)}}function de(e,t){if(1&e&&(E.Zb(0,"div",9),E.Wc(1,"\n            "),E.Vb(2,3),E.Wc(3,"\n        "),E.Yb()),2&e){var s=E.lc();E.Db(2),E.tc("obj",s.obj.Amount)("group",s.group)}}function De(e,t){if(1&e&&(E.Zb(0,"div",9),E.Wc(1,"\n            "),E.Vb(2,3),E.Wc(3,"\n        "),E.Yb()),2&e){var s=E.lc();E.Db(2),E.tc("obj",s.obj.ChangedValue)("group",s.group)}}function be(e,t){if(1&e&&(E.Zb(0,"div",9),E.Wc(1,"\n            "),E.Vb(2,3),E.Wc(3,"\n        "),E.Yb()),2&e){var s=E.lc();E.Db(2),E.tc("obj",s.obj.Remarks)("group",s.group)}}function pe(e,t){if(1&e&&(E.Zb(0,"div",9),E.Wc(1,"\n            "),E.Vb(2,3),E.Wc(3,"\n        "),E.Yb()),2&e){var s=E.lc();E.Db(2),E.tc("obj",s.obj.DebitAccount)("group",s.group)}}function me(e,t){if(1&e&&(E.Zb(0,"div",9),E.Wc(1,"\n            "),E.Vb(2,3),E.Wc(3,"\n        "),E.Yb()),2&e){var s=E.lc();E.Db(2),E.tc("obj",s.obj.CreditAccount)("group",s.group)}}function Ce(e,t){if(1&e&&(E.Zb(0,"div",9),E.Wc(1,"\n            "),E.Vb(2,3),E.Wc(3,"\n        "),E.Yb()),2&e){var s=E.lc();E.Db(2),E.tc("obj",s.obj.GainAccount)("group",s.group)}}function Se(e,t){if(1&e&&(E.Zb(0,"div",9),E.Wc(1,"\n            "),E.Vb(2,3),E.Wc(3,"\n        "),E.Yb()),2&e){var s=E.lc();E.Db(2),E.tc("obj",s.obj.LossAccount)("group",s.group)}}function ge(e,t){if(1&e&&(E.Zb(0,"div",9),E.Wc(1,"\n            "),E.Vb(2,3),E.Wc(3,"\n        "),E.Yb()),2&e){var s=E.lc();E.Db(2),E.tc("obj",s.obj.DisposeClearingAccount)("group",s.group)}}function Te(e,t){if(1&e&&(E.Zb(0,"div",9),E.Wc(1,"\n            "),E.Vb(2,3),E.Wc(3,"\n        "),E.Yb()),2&e){var s=E.lc();E.Db(2),E.tc("obj",s.obj.PostJV)("group",s.group)}}var Ae,ye=((Ae=function(){function e(){_classCallCheck(this,e),this.group=new U.j({})}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Ae)},Ae.\u0275cmp=E.Nb({type:Ae,selectors:[["app-add-disposal-grid-data"]],decls:47,vars:19,consts:[[1,"master-screen"],[1,"PACTHeaderFields","dialogSubBody"],[1,"form-group","col","PACTControl",2,"width","150px"],["FieldDirective","",3,"obj","group"],["class","form-group col PACTControl",4,"ngIf"],[1,"Pactdailogfooter"],[1,"primary-btn-wicon",3,"click"],[1,"secondary-btn-wicon",3,"click"],[1,"fa-light","fa-rectangle-xmark"],[1,"form-group","col","PACTControl"]],template:function(e,t){1&e&&(E.Zb(0,"div",0),E.Wc(1,"\n    "),E.Zb(2,"div",1),E.Wc(3,"\n        "),E.Zb(4,"div",2),E.Wc(5,"\n          "),E.Vb(6,3),E.Wc(7,"\n        "),E.Yb(),E.Wc(8,"\n        "),E.Uc(9,ue,4,2,"div",4),E.Wc(10,"\n        "),E.Uc(11,he,4,2,"div",4),E.Wc(12,"\n        "),E.Uc(13,de,4,2,"div",4),E.Wc(14,"\n        "),E.Uc(15,De,4,2,"div",4),E.Wc(16,"\n        "),E.Uc(17,be,4,2,"div",4),E.Wc(18,"\n        "),E.Uc(19,pe,4,2,"div",4),E.Wc(20,"\n        "),E.Uc(21,me,4,2,"div",4),E.Wc(22,"\n        "),E.Uc(23,Ce,4,2,"div",4),E.Wc(24,"\n        "),E.Uc(25,Se,4,2,"div",4),E.Wc(26,"\n        "),E.Uc(27,ge,4,2,"div",4),E.Wc(28,"\n        "),E.Uc(29,Te,4,2,"div",4),E.Wc(30,"\n  "),E.Yb(),E.Wc(31,"\n  "),E.Zb(32,"div",5),E.Wc(33,"\n    "),E.Zb(34,"div"),E.Wc(35,"\n        "),E.Zb(36,"button",6),E.hc("click",(function(){return t.obj.OnButtonClick("Ok")})),E.Wc(37),E.mc(38,"translate"),E.Yb(),E.Wc(39,"\n        "),E.Zb(40,"button",7),E.hc("click",(function(){return t.obj.OnButtonClick("Cancel")})),E.Ub(41,"i",8),E.Wc(42),E.mc(43,"translate"),E.Yb(),E.Wc(44,"\n    "),E.Yb(),E.Wc(45,"      \n  "),E.Yb(),E.Wc(46,"\n"),E.Yb()),2&e&&(E.Db(6),E.tc("obj",t.obj.Date)("group",t.group),E.Db(3),E.tc("ngIf",t.obj.Type.Visible),E.Db(2),E.tc("ngIf",t.obj.CurrentValue.Visible),E.Db(2),E.tc("ngIf",t.obj.Amount.Visible),E.Db(2),E.tc("ngIf",t.obj.ChangedValue.Visible),E.Db(2),E.tc("ngIf",t.obj.Remarks.Visible),E.Db(2),E.tc("ngIf",t.obj.DebitAccount.Visible),E.Db(2),E.tc("ngIf",t.obj.CreditAccount.Visible),E.Db(2),E.tc("ngIf",t.obj.GainAccount.Visible),E.Db(2),E.tc("ngIf",t.obj.LossAccount.Visible),E.Db(2),E.tc("ngIf",t.obj.DisposeClearingAccount.Visible),E.Db(2),E.tc("ngIf",t.obj.PostJV.Visible),E.Db(8),E.Xc(E.nc(38,15,"Ok")),E.Db(5),E.Xc(E.nc(43,17,"Cancel")))},directives:[Y.a,G.t],pipes:[k.d],encapsulation:2}),Ae),Ie=s("wlFP");function Ve(e,t){if(1&e){var s=E.ac();E.Zb(0,"span",16),E.hc("click",(function(){return E.Ic(s),E.lc().obj.OnSave("Add")})),E.Ub(1,"i",17),E.Yb()}}function fe(e,t){if(1&e){var s=E.ac();E.Zb(0,"span",16),E.hc("click",(function(){return E.Ic(s),E.lc().obj.OnSave("Import")})),E.Ub(1,"i",18),E.Yb()}}function ve(e,t){if(1&e){var s=E.ac();E.Zb(0,"span",16),E.hc("click",(function(){return E.Ic(s),E.lc().obj.OnRemove("Remove")})),E.Ub(1,"i",19),E.Yb()}}var Me,Pe,we=((Pe=function(){function e(){_classCallCheck(this,e),this.form=new U.j({})}return _createClass(e,[{key:"ngOnInit",value:function(){console.log(this.obj.GridDataObj)}}]),e}()).\u0275fac=function(e){return new(e||Pe)},Pe.\u0275cmp=E.Nb({type:Pe,selectors:[["app-asset-serial-no"]],decls:59,vars:14,consts:[[1,"master-screen",2,"padding-bottom","4px","width","450px"],[1,"PACTHeaderFields","dialogSubBody","dialogCtrlPadding"],[1,"row","form-row"],[1,"form-group","col","PACTctrl"],["FieldDirective","",3,"obj"],[1,"form-group","col","col-xs-12"],[2,"display","flex"],[1,"btnMetroDiv","secondary-btn-group",2,"float","unset","margin","auto"],["class","secondary-btn-wicon","style","margin: 3px;",3,"click",4,"ngIf"],[1,"row","form-row",2,"width","100%"],[2,"width","100%",3,"obj"],[2,"font-weight","bold"],[1,"Pactdailogfooter"],[1,"primary-btn-wicon",3,"click"],[1,"fa-light","fa-floppy-disk"],[1,"secondary-btn-wicon",3,"click"],[1,"secondary-btn-wicon",2,"margin","3px",3,"click"],[1,"fa-light","fa-plus"],[1,"fa-light","fa-file-import"],[1,"fa-light","fa-trash-alt"]],template:function(e,t){1&e&&(E.Zb(0,"div",0),E.Wc(1,"\n    "),E.Zb(2,"div",1),E.Wc(3,"\n        "),E.Zb(4,"div",2),E.Wc(5,"\n            "),E.Zb(6,"div",3),E.Wc(7,"\n                "),E.Vb(8,4),E.Wc(9,"\n            "),E.Yb(),E.Wc(10,"\n            "),E.Zb(11,"div",3),E.Wc(12,"\n                "),E.Vb(13,4),E.Wc(14,"\n            "),E.Yb(),E.Wc(15,"\n            \n            "),E.Zb(16,"div",5),E.Wc(17,"\n                "),E.Vb(18,4),E.Wc(19,"\n            "),E.Yb(),E.Wc(20,"\n        "),E.Yb(),E.Wc(21,"\n        "),E.Zb(22,"div",6),E.Wc(23,"\n            "),E.Zb(24,"div",7),E.Wc(25,"\n                "),E.Uc(26,Ve,2,0,"span",8),E.Wc(27,"\n                "),E.Uc(28,fe,2,0,"span",8),E.Wc(29,"\n                "),E.Uc(30,ve,2,0,"span",8),E.Wc(31,"\n            "),E.Yb(),E.Wc(32,"\n        "),E.Yb(),E.Wc(33,"\n      \n      "),E.Zb(34,"div",9),E.Wc(35,"\n        "),E.Ub(36,"app-PactGridView",10),E.Wc(37,"  \n      "),E.Yb(),E.Wc(38,"\n      "),E.Zb(39,"div",11),E.Wc(40),E.Yb(),E.Wc(41,"\n    "),E.Yb(),E.Wc(42,"\n    "),E.Zb(43,"div",12),E.Wc(44,"\n      "),E.Zb(45,"div"),E.Wc(46,"\n        "),E.Zb(47,"button",13),E.hc("click",(function(){return t.obj.OnSave("Save")})),E.Ub(48,"i",14),E.Wc(49),E.mc(50,"translate"),E.Yb(),E.Wc(51,"\n        "),E.Zb(52,"button",15),E.hc("click",(function(){return t.obj.OnSave("Cancel")})),E.Wc(53),E.mc(54,"translate"),E.Yb(),E.Wc(55,"\n      "),E.Yb(),E.Wc(56,"\n  "),E.Yb(),E.Wc(57,"\n"),E.Yb(),E.Wc(58,"\n")),2&e&&(E.Db(8),E.tc("obj",t.obj.SerialNumber),E.Db(5),E.tc("obj",t.obj.Qty),E.Db(5),E.tc("obj",t.obj.Separator),E.Db(8),E.tc("ngIf",t.obj.AddVisiblility),E.Db(2),E.tc("ngIf",t.obj.AddVisiblility),E.Db(2),E.tc("ngIf",t.obj.AddVisiblility),E.Db(6),E.tc("obj",t.obj.GridDataObj),E.Db(4),E.Xc(t.obj.QtyAddMessage),E.Db(9),E.Xc(E.nc(50,10,"Save")),E.Db(4),E.Xc(E.nc(54,12,"Close")))},directives:[Y.a,G.t,N.a],pipes:[k.d],encapsulation:2}),Pe),Ee=((Me=function(e){_inherits(s,e);var t=_createSuper(s);function s(e,i){var n,r;return _classCallCheck(this,s),(n=t.call(this)).AvailableStatusID=0,n.SoldStatusID=0,n.dtSerials=[],n.dtProdSerial=[],n.AssetCode="",n.AssetQty=0,n.DialogResult=!1,n.SerialNumber=new h.d(0),n.Qty=new h.d(0),n.Separator=new h.d(0),n.AddVisiblility=!1,n.ColumnSource=new Array,n.GridDataObj=new D.a,n.GridDataObj.Table=[],n.Qty.DataType="INT",n.Qty.Text="1",n.AssetQty=e,n.AssetCode=i,n.SerialNumber.Label=a.a.GetResource("SerialNo"),n.Qty.Label=a.a.GetResource("SerialNo_Qty"),n.Separator.Label="Separator",n.Qty.Visible=!0,n.AddVisiblility=!0,s.SearchVisibility=!1,n.Title=a.a.GetResource("SerialNo_Title"),a.a.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&Object(o.j)(a.a.SessionManager.Preferences.EnableDivisionWise)&&a.a.SessionManager.Preferences.ContainsKey("DW SNOS")&&Object(o.j)(a.a.SessionManager.Preferences["DW SNOS"]),a.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&Object(o.j)(a.a.SessionManager.Preferences.EnableLocationWise)&&a.a.SessionManager.Preferences.ContainsKey("LW SNOS")&&Object(o.j)(a.a.SessionManager.Preferences["LW SNOS"]),(r=new b.a).Header=a.a.GetResource("UOM_Sno"),r.DisplayMember="Sno",r.DataType="TextBlock",r.ReadOnly=!0,r.Width=50,r.DisableTab=!0,n.ColumnSource.push(r),n.GridDataObj.TableColumns.push("Sno"),(r=new b.a).Header=a.a.GetResource("Document_SerialNumber"),r.DisplayMember="SerialNumber",r.ReadOnly=!0,r.DataType="TextBlock",r.Width=250,n.ColumnSource.push(r),n.GridDataObj.TableColumns.push("SerialNumber"),(r=new b.a).Header="SerialGUID",r.DisplayMember="SerialGUID",r.DataType="TextBlock",r.Width=0,r.IsVisible=!1,r.ReadOnly=!0,r.DisableTab=!0,n.ColumnSource.push(r),n.GridDataObj.TableColumns.push("SerialGUID"),n.GridDataObj.Columns=n.ColumnSource,n}return _createClass(s,[{key:"GridData_RowDeleted",value:function(e,t){var s=1;this.GridData.forEach((function(e){"DELETED"!=e.RowState.toString().toUpperCase()&&(e.Sno=s++)})),this.QtyAddMessage=n.e.Format(a.a.GetResource("SerialNo_AddMessage"),(s-1).toString(),this.AssetQty.toString(),this.AssetCode)}},{key:"OnCheckedChanged",value:function(e,t){}},{key:"OnCellEditEnding",value:function(e){if("Microsoft.Windows.Controls.DataGridCheckBoxColumn"==e.OriginalSource.Column.GetType().toString()&&"Select"==e.OriginalSource.Column.Binding.Path.Path){var t=0;this.GridData.forEach((function(e){Object(o.j)(e.Select.toString())&&t++})),this.QtyAddMessage=n.e.Format(a.a.GetResource("SerialNo_SelectMessage"),t.toString(),this.AssetQty.toString(),this.AssetCode)}}},{key:"OnRemove",value:function(e){null!=this.SelectedRow&&this.GridDataObj.removeRow(this.SelectedRow)}},{key:"Setselectedrow",value:function(e){this.GridDataObj.SelectedItem=this.GridData[e]}},{key:"OnSave",value:function(e){var t=this;if("Search"==e.toString()){if(""!=this.SerialNumber.Text){var s=0,i=1;for(null!=this.SelectedRow&&(i=this.GridData.indexOf(this.SelectedRow)+1);s<this.GridData.length;s++,i++)if(i>=this.GridData.length&&(i=1),this.GridData[i].SerialNumber.toString().Contains(this.SerialNumber.Text))return void this.Setselectedrow(i)}}else if("Save"==e.toString()){for(var r=0,l=0;l<this.GridData.length;l++)if(!this.GridDataObj.TableColumns.Contains("Select")||Object(o.j)(this.GridData[l].Select.toString())){for(var c=1;c<this.ColumnSource.length;c++)"ComboBox"==this.ColumnSource[c].DataType?(this.ColumnSource[c].ValueMember,this.GridData[l][this.GridDataObj.TableColumns[c]].toString()):(this.ColumnSource[c].DisplayMember,this.GridData[l][this.GridDataObj.TableColumns[c]].toString());++r,this.GridData[l].SerialNumber.toString()}if(this.AssetQty!=r)return this.DisplayMessage=a.a.GetResource("SerialNo_QtyMisMatch"),void(this.MessageVisibility=!0);this.DialogResult=!0,a.a.page.HideDialog()}else if("Import"==e.toString()){if(this.DisplayMessage="",this.MessageVisibility=!1,null==this.Separator.Text||""==this.Separator.Text)return this.DisplayMessage="Enter Separator",void(this.MessageVisibility=!0)}else if("Add"==e.toString()){var u=function(){if(null==t.SerialNumber.Text||""==t.SerialNumber.Text||""!=t.Qty.ValidateData())return{v:void 0};if(t.AssetQty>0&&t.GridData.length>=t.AssetQty)return{v:(t.DisplayMessage="Qty already adjusted",void(t.MessageVisibility=!0))};if(null==t.Qty.Text||""==t.Qty.Text.Trim()){if(t.dtSerials.length>0&&t.dtSerials.filter((function(e){return e.SerialNumber==t.SerialNumber.Text})).length>0||t.GridData.filter((function(e){return e.SerialNumber==t.SerialNumber.Text})).length>0)return{v:(t.DisplayMessage=a.a.GetResource("SerialNo_Duplicate"),void(t.MessageVisibility=!0))};t.MessageVisibility=!1;var e=t.GridDataObj.NewRow();return{v:(e.Sno=(t.GridData.length+1).toString(),e.SerialNumber=t.SerialNumber.Text,e.SerialGUID=n.e.NewGuid(),t.SerialNumber.Text="",void t.GridDataObj.addRow(e))}}var s,i=t.SerialNumber.Text,o=1,r=!1;if(null!=i&&""!=i.Trim())for(var l=0;l<i.length;l++)if(!n.e.IsDigit(i[i.length-l-1])){if(l<=15&&(r=!0,l>0)){s=i.substr(i.length-l);for(var c=0;c<s.length&&"0"==s[c];c++)l--;o=parseInt(i.substr(i.length-l)),i=i.substr(0,i.length-l)}break}if(!r&&null!=i&&""!=i.Trim()){var u=i.length;u>15?(u=15,s=i.substr(i.length-u)):s=i;for(var h=0;h<s.length&&"0"==s[h];h++)u--;o=parseInt(i.substr(i.length-u)),i=i.substr(0,i.length-u)}null!=i&&""!=i.Trim()||(i="");for(var d=0;d<parseInt(t.Qty.Text);d++,o++){var D=t.GridDataObj.NewRow();if(t.dtSerials.length>0&&t.dtSerials.filter((function(e){return e.SerialNumber==i+o.toString()})).length>0||t.GridData.filter((function(e){return e.SerialNumber==i+o.toString()})).length>0)return{v:(t.DisplayMessage=a.a.GetResource("SerialNo_Duplicate"),void(t.MessageVisibility=!0))};t.MessageVisibility=!1,D.Sno=(t.GridData.length+1).toString(),D.SerialNumber=i+o.toString(),D.SerialGUID=n.e.NewGuid(),t.GridDataObj.addRow(D)}t.SerialNumber.Text="",t.Qty.Text=""}();if("object"==typeof u)return u.v}else"Cancel"==e.toString()&&(this.DialogResult=!1,a.a.page.HideDialog());this.QtyAddMessage=n.e.Format(a.a.GetResource("SerialNo_AddMessage"),this.GridData.length.toString(),this.AssetQty.toString(),this.AssetCode)}},{key:"SelectedRow",get:function(){return this.GridDataObj.SelectedItem}},{key:"QtyAddMessage",get:function(){return n.e.IsEmpty(this._QtyAddMessage)?"asdfasdf":this._QtyAddMessage},set:function(e){e!=this._QtyAddMessage&&(this._QtyAddMessage=e)}},{key:"GridData",get:function(){return this.GridDataObj.Table}}]),s}(r.b)).SearchVisibility=!1,Me),Ge=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,s,i,l){var u;if(_classCallCheck(this,r),(u=t.call(this)).DialogResult=!1,u.DeprFromDate=Date.Today(),u.DeprToDate=Date.Today(),u.DeprFilterCheck=0,u.RetValue=0,u.MAddClick=!1,u.IAddClick=!1,u.DAddClick=!1,u.MEditClick=!1,u.IEditClick=!1,u.DEditClick=!1,u.EstLife="",u.SalValue="",u.DeprStartDate=Date.Today(),u.DepSDate="",u.DepEDate="",u.ds=null,u.dtDepr=[],u.MaintainGrid=null,u.InsuranceGrid=null,u.DisposeGrid=null,u.CostCenterID=0,u.deprBooks="",u.NoteVisibility=!1,u.GeneralTabVisible=!1,u.ScheduleVisibility=!1,u.DepreciationVisibility=!1,u.AttachmentVisibility=!1,u.ChgVisibility=!1,u.AddButtonVisibility=!1,u.ChangeValueVisibility=!1,u.AssetScheduleDeprVisibility=!1,u.AddMaintenanceVisibility=!1,u.AddInsuranceVisibility=!1,u.AddDisposalVisibility=!1,u.TranHistoryGridDataObj=new D.a,u.Code=new h.a(23954),u.Name=new h.d(23955),u.Sno=new h.d(25464),u.DepreciationBooks=new c.b(25465),u.Class=new c.e(25466),u.Location=new p.a(25472),u.Employee=new p.a(25467),u.NetValue=new h.d(151),u.Description=new h.c(25477),u.Status=new c.e(25476),u.ParentAsset=new p.b(25470),u.DeprBook=new c.e(136),u.FAGroup=new p.b(25474),u.TotalQtyPurchase=new h.d(144),u.TotalQtyPurchaseIgnoreSpaces=new Ie.a(144),u.ScreenObject=new m.a,u.DetailsVisibility=!0,u.BooksIn="",u.GridName="",u.DepreciationStartDate="",u.objAsset=new M.a,u.res=null,u.RES=null,u.AllowChangeOfFAAccounts=!1,u.IsDeprScheduleExists=!1,u._IsFullDispose=0,u.ParentID=0,u.isFromEdit=!1,u.GUID="",u.SNO=1,u.IgnoreClassLoad=!1,u.IgnoreDeprBookChange=!1,u.IgnoreFAGroupChange=!1,u.Schedules=null,u.iCntLoop=0,u.strMessageLoop="",u.iTotalQtyPurchaseLoop=0,u.SNo=0,u.oLocationHistory=null,u.oOwnerHistory=null,u.ClassName="AssetManagement",u.DepreciationBooks.Height=80,u.objAsset.AMGroup=l,u.ParentID=i,u.Parent=e,u.ScreenObject.LoadScreen_1(_assertThisInitialized(u),72,l),u.NetValue.Enable=!1,u.TotalQtyPurchaseIgnoreSpaces.Label=a.a.GetResource("Createassetsbasedonquantity"),u.LoadTabGrids(),u.CostCenterID=72,u.ParentAsset.CCID=72,u.ParentAsset.TypeID=2,u.ParentAsset.SelectionChangedCommand.Subscribe(_assertThisInitialized(u),"OnGroupChanged"),u.Location.HistoryCCID=1,u.Employee.HistoryCCID=2,u.ButtonSave=new d.a,u.ButtonCustomize=new d.a,0==s?l?a.a.SessionManager.HideUnathorizedAccess?u.ButtonSave.Visible=a.a.SessionManager.IsActionAssigned(72,"Create Group"):u.ButtonSave.Enable=a.a.SessionManager.IsActionAssigned(72,"Create Group"):a.a.SessionManager.HideUnathorizedAccess?u.ButtonSave.Visible=a.a.SessionManager.IsActionAssigned(72,"Create"):u.ButtonSave.Enable=a.a.SessionManager.IsActionAssigned(72,"Create"):l?a.a.SessionManager.HideUnathorizedAccess?u.ButtonSave.Visible=a.a.SessionManager.IsActionAssigned(72,"Create Group"):u.ButtonSave.Enable=a.a.SessionManager.IsActionAssigned(72,"Create Group"):a.a.SessionManager.HideUnathorizedAccess?u.ButtonSave.Visible=a.a.SessionManager.IsActionAssigned(72,"Update"):u.ButtonSave.Enable=a.a.SessionManager.IsActionAssigned(72,"Update"),a.a.SessionManager.HideUnathorizedAccess?u.ButtonCustomize.Visible=a.a.SessionManager.IsActionAssigned(72,"Customize"):u.ButtonCustomize.Enable=a.a.SessionManager.IsActionAssigned(72,"Customize"),u.objAsset.AMAssetID=s,u.RefreshAssetDataSet(),u.ViewNotes=new S.a(_assertThisInitialized(u)),u.ViewAttachments=new T.ViewAttachmentViewModel(_assertThisInitialized(u)),u.ViewMaintenance=new J(_assertThisInitialized(u)),u.ViewInsurance=new X(_assertThisInitialized(u)),u.ViewTransactionHistory=new H(_assertThisInitialized(u)),u.GeneralTabVisible=!0,u.LoadData(),u.Status.Items.push(c.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_Active"),"1")),u.Status.Items.push(c.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_InActive"),"0")),u.Status.SelectedValue="1",u.DepreciationBooks.CheckedChangedCommand.Subscribe(_assertThisInitialized(u),"OnLocationCheckedChanged"),u.Class.Items.push(c.d.ComboBoxItems_2("","0")),u.Class.DefaultValue=u.Class.SelectedValue="0",u.ds.Tables.length>0&&u.ds.Tables[0].length>0)for(var b=0;b<u.ds.Tables[0].length;b++)u.Class.Items.push(c.d.ComboBoxItems_2(u.ds.Tables[0][b].AssetClassName.toString(),u.ds.Tables[0][b].AssetClassID.toString()));if(u.ds.Tables.length>2&&u.ds.Tables[2].length>0)for(var C=0;C<u.ds.Tables[2].length;C++)u.DepreciationBooks.Items.push(c.c.CheckedListBoxItem_3(u.ds.Tables[2][C].DeprBookName.toString(),u.ds.Tables[2][C].DeprBookID.toString()));u.DefaultSelection(),u.ScreenObject.InitAutoCode(u.ScreenObject.Data.Tables[6],u.objAsset.AMGroup);var g=u.ScreenObject.Data.Tables[4].filter((function(e){return"CapsLock"==e.Name}));if(g.length>0&&Object(o.j)(g[0].Value)&&(u.Name.IsAllCaps=!0),(g=u.ScreenObject.Data.Tables[4].filter((function(e){return"CapsToFirstLetter"==e.Name}))).length>0&&Object(o.j)(g[0].Value)&&(u.Name.IsFirstLetterCaps=!0),(g=u.ScreenObject.Data.Tables[4].filter(u.objAsset.AMGroup?function(e){return"ChangeOfFAAccountsGroup"==e.Name}:function(e){return"ChangeOfFAAccountsNode"==e.Name})).length>0&&Object(o.j)(g[0].Value)&&(u.AllowChangeOfFAAccounts=!0),s>0)u.DepreciationVisibility=!0,u.AddButtonVisibility=!0,u.LoadEditData(),u.DisplayName=l?"Edit Asset Group":a.a.GetResource("AssetManagement_EditAsset"),u.objAsset.AMGUID=u.ds.Tables[4][0].GUID.toString(),u.GUID=u.ds.Tables[4][0].GUID.toString(),u.IsDeprScheduleExists=u.ds.Tables[10].length>0,u.ScheduleVisibility=!1,u.IsDeprScheduleExists&&(u.CDeprStartDate.Enable=!1,null!=u.DeprStartValue&&(u.DeprStartValue.Enable=!1),null!=u.PurchaseValue&&(u.PurchaseValue.Enable=!1),null!=u.PreviousDepreciation&&(u.PreviousDepreciation.Enable=!1),null!=u.DeprSchedule&&(u.DeprSchedule.Enable=!1),null!=u.EstimateLife&&(u.EstimateLife.Enable=!1),null!=u.DeprMethod&&(u.DeprMethod.Enable=!1),null!=u.DeprSalvageInCalc&&(u.DeprSalvageInCalc.Enable=!1),null!=u.DeprAvgMethod&&(u.DeprAvgMethod.Enable=!1),null!=u.DeprSalvage&&(u.DeprSalvage.Enable=!1),null!=u.DeprPeriod&&(u.DeprPeriod.Enable=!1)),null!=u.ds&&u.ds.Tables.length>8&&u.ds.Tables[8].length>0&&(n.e.IsEmpty(u.ds.Tables[8][0].DepStartDate)||(u.DepreciationStartDate=new Date(u.ds.Tables[8][0].DepStartDate.toString()).ToString(a.a.SessionManager.Preferences["Date Format"]))),u.SetVisibility(),u.ChgVisibility=!0,u.DetailsVisibility=!0,u.ParentAsset.Enable=!1;else{u.ScheduleVisibility=!1,u.DepreciationVisibility=!1,u.ParentAsset.SelectedValue=i,u.ParentAsset.DefaultValue=i.toString(),u.ParentAsset.Enable=!0,u.AddButtonVisibility=!1,l?u.DisplayName="Add Asset Group":(u.CDeprStartDate.Mandatory=!0,u.DisplayName=a.a.GetResource("AssetManagement_AddAsset")),u.objAsset.AMGUID="GUID",u.ScreenObject.CustomTab.Pages.Remove(u.Trans),u.SetVisibility(),u.OnGroupChanged(null);for(var A=u.ScreenObject.CustomTab.Pages.find((function(e){return"Purchase Details"==e.Name})),y=0;y<A.Fields.length;y++)if(A.Fields[y]instanceof h.d&&24064==A.Fields[y].DBColumnID){A.Fields[y].Enable=!0;break}}return _possibleConstructorReturn(u)}return _createClass(r,[{key:"OnAddNote",value:function(){Logger.InfoLog("AddEditAssetManagement::Entering AddNote"),this.Note=new C.AddNoteViewModel,this.Note.AddNoteViewModel_2(this),Logger.InfoLog("AddEditAssetManagement::Entering AddNote")}},{key:"OnAddAttachment",value:function(){Logger.InfoLog("AddEditAssetManagement::Entering AddAttachment"),this.Attachment=new g.AddAttachmentViewModel,this.Attachment.AddAttachmentViewModel_2(this),Logger.InfoLog("AddEditAssetManagement::Entering AddAttachment")}},{key:"LoadEditData",value:function(){if(this.ds.Tables.length>3&&this.ds.Tables[4].length>0){if(n.e.IsEmpty(this.ds.Tables[4][0].AssetCode)||(this.Code.Text=this.ds.Tables[4][0].AssetCode.toString()),(this.ScreenObject.InheritParentCode||this.ScreenObject.IsAutoCode)&&(this.Code.Enable=parseInt(this.ds.Tables[4][0].Depth)<=1&&!this.ScreenObject.IsRootAutoCode),this.ScreenObject.IsAutoName&&(this.Name.Enable=!1),this.objAsset.CodePrefix=n.e.String(this.ds.Tables[4][0].CodePrefix),this.objAsset.CodeNumber=n.e.Int(this.ds.Tables[4][0].CodeNumber),n.e.IsEmpty(this.ds.Tables[4][0].AssetName)||(this.Name.Text=this.ds.Tables[4][0].AssetName.toString()),n.e.IsEmpty(this.ds.Tables[4][0].StatusID)||(this.Status.SelectedValue=this.ds.Tables[4][0].StatusID.toString()),n.e.IsEmpty(this.ds.Tables[4][0].Description)||(this.Description.Text=this.ds.Tables[4][0].Description.toString(),this.Description.Text.startsWith("<FlowDocument")&&(this.Description.Tag=this.Description.Text)),n.e.IsEmpty(this.ds.Tables[4][0].SerialNo)||(this.Sno.Text=this.ds.Tables[4][0].SerialNo.toString()),n.e.IsEmpty(this.ds.Tables[4][0].ParentAssetID)||(this.ParentAsset.SelectedValue=parseInt(this.ds.Tables[4][0].ParentAssetID),this.ParentAsset.DefaultValue=this.ParentAsset.SelectedValue.toString()),this.TotalQtyPurchase.Text=n.e.String(this.ds.Tables[4][0].TotalQtyPurchase),n.e.IsEmpty(this.ds.Tables[4][0].DeprStartDate)||(this.DepSDate=new Date(this.ds.Tables[4][0].DeprStartDate).ToString("dd/MMM/yyyy")),n.e.IsEmpty(this.ds.Tables[4][0].DeprEndDate)||(this.DepEDate=new Date(this.ds.Tables[4][0].DeprEndDate).ToString("dd/MMM/yyyy")),this.SalValue=null==this.ds.Tables[4][0].SalvageValue?"0":"2"==this.ds.Tables[4][0].SalvageValueType.toString()?(parseFloat(this.ds.Tables[4][0].SalvageValue)*parseFloat(this.ds.Tables[4][0].DeprStartValue)/100).toString():parseFloat(this.ds.Tables[4][0].SalvageValue).toString(),this.EstLife=this.ds.Tables[4][0].EstimateLife.toString(),!n.e.IsEmpty(this.ds.Tables[4][0].DeprBookGroupID))for(var e=this.ds.Tables[4][0].DeprBookGroupID.toString().split(","),t=0;t<e.length;t++)for(var s=0;s<this.DepreciationBooks.Items.length;s++)if(this.DepreciationBooks.Items[s].Value==e[t]){this.DepreciationBooks.Items[s].IsChecked=!0;break}n.e.IsEmpty(this.ds.Tables[4][0].LocationID)?this.Location.Text="":this.Location.SetValue_2(parseInt(this.ds.Tables[4][0].LocationID),this.ds.Tables[5].length>0?n.e.String(this.ds.Tables[5][0].AssetLocation):""),n.e.IsEmpty(this.ds.Tables[4][0].EmployeeID)?this.Employee.Text="":this.Employee.SetValue_2(parseInt(this.ds.Tables[4][0].EmployeeID),this.ds.Tables[5].length>0?n.e.String(this.ds.Tables[5][0].AssetOwner):""),this.NetValue.Text=n.e.IsEmpty(this.ds.Tables[4][0].AssetNetValue)?this.ds.Tables[4][0].DeprStartValue.ToString(a.a.SessionManager.Preferences.DecimalsinAmount):this.ds.Tables[4][0].AssetNetValue.ToString(a.a.SessionManager.Preferences.DecimalsinAmount),this.IgnoreClassLoad=!0,n.e.IsEmpty(this.ds.Tables[4][0].ClassID)||(this.Class.SelectedValue=this.ds.Tables[4][0].ClassID.toString()),"0"!=this.Class.SelectedValue&&(this.EnableControls(!1,1),this.EnableControls(!1,2),this.EnableControls(!1,3)),this.IgnoreClassLoad=!1,this.IgnoreFAGroupChange=!0,this.FAGroup.SelectedValue=null!=this.ds.Tables[4][0].PostingGroupID?parseInt(this.ds.Tables[4][0].PostingGroupID):0,this.AcqnCostACCID.SelectedValue=parseInt(this.ds.Tables[4][0].AcqnCostACCID.toString()),this.AccumDeprACCID.SelectedValue=parseInt(this.ds.Tables[4][0].AccumDeprACCID.toString()),this.DeprExpenseACCID.SelectedValue=parseInt(this.ds.Tables[4][0].DeprExpenseACCID.toString()),this.AcquisitionClearingAcc.SelectedValue=parseInt(this.ds.Tables[4][0].AcqnCostDispACCID.toString()),this.DisposalClearingAcc.SelectedValue=parseInt(this.ds.Tables[4][0].AccumDeprDispACCID.toString()),this.DisposalGainAcc.SelectedValue=parseInt(this.ds.Tables[4][0].GainsDispACCID.toString()),this.DisposalLossAcc.SelectedValue=parseInt(this.ds.Tables[4][0].LossDispACCID.toString()),this.MinorAssetExpenseAcc.SelectedValue=parseInt(this.ds.Tables[4][0].MaintExpenseACCID.ToString()),this.EnableControls(!(this.FAGroup.SelectedValue>0),2),this.isFromEdit=!0,this.IgnoreFAGroupChange=!1,this.IgnoreDeprBookChange=!0,this.DeprBook.SelectedValue=n.e.String(this.ds.Tables[4][0].DeprBookID),n.e.IsEmpty(this.DeprBook.SelectedValue)||"0"==this.DeprBook.SelectedValue?this.EnableControls(!0,3):this.EnableControls(!1,3),this.IgnoreDeprBookChange=!1,this.LoadTabFields(this.ds.Tables[4])}this.ViewNotes.LoadNotes(this.ds.Tables[14]),this.ViewAttachments.LoadAttachments(this.ds.Tables[15]),this.ScreenObject.LoadCustomFieldsData(this.ds.Tables[16]),this.ScreenObject.LoadCustomFieldsCCData(this.ds.Tables[17],this.ds.Tables[11]),this.ds.Tables.length>6&&this.ViewTransactionHistory.LoadValueInfo(this.ds.Tables[6],this.ds.Columns[6]);var i=this.ds.Tables[13].filter((function(e){return 3==e.HistoryTypeID&&(1==e.PolicyType||3==e.PolicyType)}));this.IsFullDispose=i.length>0?parseInt(i[0].PolicyType):0,this.OnTabGridDataLoad(this.ds.Tables[13])}},{key:"DefaultSelection",value:function(){var e=this;this.Location.ClickCommand.Subscribe(this,"OnLocationClick"),this.Employee.ClickCommand.Subscribe(this,"OnOwnerClick"),this.Class.SelectionChangedCommand.Subscribe(this,"OnClassSelectionChanged"),this.DeprBook.SelectionChangedCommand.Subscribe(this,"OnDeprBookChange"),this.DeprBook.Items.push(c.d.ComboBoxItems_2("","0")),this.DeprBook.DefaultValue=this.DeprBook.SelectedValue="0",this.ds.Tables[2].forEach((function(t){e.DeprBook.Items.push(c.d.ComboBoxItems_2(t.DeprBookName.toString(),t.DeprBookID.toString()))})),this.FAGroup.OnPactListBoxValueChanged.Subscribe(this,"OnFAGroupSelectionChanged"),this.FAGroup.SetTimeToZero();for(var t=0;t<this.ScreenObject.CustomTab.Pages.length;t++)if("1033"==this.ScreenObject.CustomTab.Pages[t].DBColumnID.toString())for(var s=0;s<this.ScreenObject.CustomTab.Pages[t].Fields.length;s++){var i=this.ScreenObject.CustomTab.Pages[t].Fields[s];if(i instanceof c.e){var n=i;if(26401==n.DBColumnID)this.DeprPeriod=n,n.Items.push(c.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_Monthly"),"1")),n.Items.push(c.d.ComboBoxItems_2(a.a.GetResource("Budget_Quarterly"),"3")),n.Items.push(c.d.ComboBoxItems_2(a.a.GetResource("Budget_Halfyearely"),"4")),n.Items.push(c.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_Yearly"),"2")),n.SelectedValue="1";else if(26402==n.DBColumnID)this.DeprAvgMethod=n,n.Items.push(c.d.ComboBoxItems_2(a.a.GetResource("DeprBook_CalendarDays"),"1")),n.Items.push(c.d.ComboBoxItems_2(a.a.GetResource("DeprBook_FullMonth"),"2")),n.Items.push(c.d.ComboBoxItems_2(a.a.GetResource("DeprBook_MidMonth"),"3")),n.SelectedValue="1";else if(26399==n.DBColumnID){if(this.DeprMethod=n,this.ds.Tables.length>12&&this.ds.Tables[12].length>0){for(var o=0;o<this.ds.Tables[12].length;o++)n.Items.push(c.d.ComboBoxItems_2(this.ds.Tables[12][o].Name.toString(),this.ds.Tables[12][o].DepreciationMethodID.toString()));n.SelectedValue=n.Items[0].Value}}else 26432==i.DBColumnID?(this.DeprSchedule=n,n.Items.push(c.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_Yes"),"1")),n.Items.push(c.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_No"),"0")),n.SelectedValue="1"):147==i.DBColumnID&&(this.DeprSalvageInCalc=n,n.Items.push(c.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_Yes"),"1")),n.Items.push(c.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_No"),"0")),n.SelectedValue="0")}else i instanceof h.e?25471==i.DBColumnID&&(this.EstimateLife=i,this.EstimateLife.TextChangedCommand.Subscribe(this,"OnDateChanged"),this.EstimateLife.LblClick=new y.b,this.EstimateLife.LblClick.Subscribe(this,"OnLabelClick")):i instanceof l.b?"SalvageValue"==i.DBColumnName&&(this.DeprSalvage=i):i instanceof y.c&&(24063==i.DBColumnID?(this.CDeprStartDate=i,this.CDeprStartDate.SelectedDateChanged.Subscribe(this,"OnDateChanged")):26400==i.DBColumnID&&(this.CDeprEndDate=i))}else if("623"==this.ScreenObject.CustomTab.Pages[t].DBColumnID.toString())for(var r=0;r<this.ScreenObject.CustomTab.Pages[t].Fields.length;r++){var d=this.ScreenObject.CustomTab.Pages[t].Fields[r];if(d instanceof h.d){var D=d;26398==D.DBColumnID?this.DeprStartValue=D:24064==D.DBColumnID?this.PurchaseValue=D:50394==D.DBColumnID&&(this.PreviousDepreciation=D)}else if(d instanceof c.e){var b=d;25479==b.DBColumnID?(b.Items.push(c.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_Value"),"1")),b.Items.push(c.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_Percentage"),"2")),b.SelectedValue="1"):26403==b.DBColumnID&&(b.Items.push(c.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_Yes"),"1")),b.Items.push(c.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_No"),"2")),b.SelectedValue="1")}else d instanceof p.b?145==d.DBColumnID&&(d.CustomWhere="1=1"):d instanceof u.c&&183==d.DBColumnID&&(this.OriginalDeprStartDate=d)}else if("624"==this.ScreenObject.CustomTab.Pages[t].DBColumnID.toString())for(var m=0;m<this.ScreenObject.CustomTab.Pages[t].Fields.length;m++)this.ScreenObject.CustomTab.Pages[t].Fields[m]instanceof c.e&&26406==this.ScreenObject.CustomTab.Pages[t].Fields[m].DBColumnID&&(this.ScreenObject.CustomTab.Pages[t].Fields[m].Items.push(c.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_Yes"),"1")),this.ScreenObject.CustomTab.Pages[t].Fields[m].Items.push(c.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_No"),"2")),this.ScreenObject.CustomTab.Pages[t].Fields[m].SelectedValue="1");else if("625"==this.ScreenObject.CustomTab.Pages[t].DBColumnID.toString())for(var C=0;C<this.ScreenObject.CustomTab.Pages[t].Fields.length;C++){var S=this.ScreenObject.CustomTab.Pages[t].Fields[C];S instanceof c.e&&(26411==S.DBColumnID?(S.Items.push(c.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_Yes"),"1")),S.Items.push(c.d.ComboBoxItems_2(a.a.GetResource("AssetManagement_No"),"2")),S.SelectedValue="1"):26415==S.DBColumnID&&(S.Items.push(c.d.ComboBoxItems_2("Quarterly","1")),S.Items.push(c.d.ComboBoxItems_2("Half-Yearly","2")),S.Items.push(c.d.ComboBoxItems_2("Anually","3")),S.SelectedValue="1"))}else if(1049==this.ScreenObject.CustomTab.Pages[t].DBColumnID)for(var g=0;g<this.ScreenObject.CustomTab.Pages[t].Fields.length;g++){var T=this.ScreenObject.CustomTab.Pages[t].Fields[g];if(T instanceof p.b){var A=T;27403==A.DBColumnID?this.AcqnCostACCID=A:27404==A.DBColumnID?this.DeprExpenseACCID=A:27405==A.DBColumnID?this.AccumDeprACCID=A:27406==A.DBColumnID?this.DisposalClearingAcc=A:27407==A.DBColumnID?this.AcquisitionClearingAcc=A:27408==A.DBColumnID?this.DisposalGainAcc=A:27409==A.DBColumnID?this.DisposalLossAcc=A:27410==A.DBColumnID&&(this.MinorAssetExpenseAcc=A)}}}},{key:"OnDateChanged",value:function(e){Date.Today(),Date.Today();var t,s=0,i=0,a=null!=this.EstimateLife?this.EstimateLife.Text.split("."):this.EstLife.split(".");t=n.e.Int(a[0]),a.length>1&&(s=n.e.Int(a[1])),a.length>2&&(i=n.e.Int(a[2])),null!=this.CDeprStartDate&&null!=this.CDeprEndDate&&this.CDeprStartDate.Date&&(this.CDeprEndDate.Date=this.CDeprStartDate.Date.AddYears(t),this.CDeprEndDate.Text=this.CDeprStartDate.Date.AddYears(t).toString(),s>0&&(this.CDeprEndDate.Date=this.CDeprEndDate.Date.AddMonths(s)),i>0&&(this.CDeprEndDate.Date=this.CDeprEndDate.Date.AddDays(i)))}},{key:"Table_TableNewRow",value:function(e){this.UpdateSequence(this.MaintainGrid.Table),e.Sno=this.SNO}},{key:"LoadTabGrids",value:function(){this.MaintainGrid=new K(this),this.InsuranceGrid=new K(this),this.DisposeGrid=new K(this),this.MaintainGrid.GroupName="Maintenance",this.InsuranceGrid.GroupName="Insurance",this.DisposeGrid.GroupName="Dispose",this.MaintainGrid.Table=[],this.MaintainGrid.TableColumns.push("Sno"),this.MaintainGrid.TableColumns.push("Vendor"),this.MaintainGrid.TableColumns.push("VendorID"),this.MaintainGrid.TableColumns.push("ServiceDate"),this.MaintainGrid.TableColumns.push("DocNo"),this.MaintainGrid.TableColumns.push("DocID"),this.MaintainGrid.TableColumns.push("Edit"),this.MaintainGrid.TableColumns.push("Delete"),this.MaintainGrid.TableColumns.push("Date"),this.MaintainGrid.TableColumns.push("Remarks"),this.MaintainGrid.TableColumns.push("Amount"),this.MaintainGrid.TableColumns.push("DebitAccount"),this.MaintainGrid.TableColumns.push("CreditAccount"),this.MaintainGrid.TableColumns.push("PostJV"),this.MaintainGrid.TableColumns.push("CostCenterID"),this.MaintainGrid.TableColumns.push("DocumentName"),this.MaintainGrid.TableColumns.push("DocPrefix"),this.MaintainGrid.TableColumns.push("DocNumber"),this.MaintainGrid.TableColumns.push("HistoryID"),this.MaintainGrid.Columns=new Array;var e=new b.a;e.Header=a.a.GetResource("Sno"),e.DisplayMember="Sno",e.ReadOnly=!0,e.Width=50,this.MaintainGrid.Columns.push(e),(e=new b.a).Header=a.a.GetResource("AssetManagement_Vendor"),e.DisplayMember="Vendor",e.DataType="TEXTBOX",e.ReadOnly=!0,e.Width=150,this.MaintainGrid.Columns.push(e),(e=new b.a).Header=a.a.GetResource("Service")+a.a.GetResource("Date"),e.DisplayMember="ServiceDate",e.DataType="TEXTBOX",e.ReadOnly=!0,e.Width=150,this.MaintainGrid.Columns.push(e),(e=new b.a).Header=a.a.GetResource("DocumentDesigner_VoucherNo"),e.DisplayMember="DocNo",e.ReadOnly=!0,e.Width=150,e.DataType="LINK",e.Click.Subscribe(this,"OnMaintainDocLink"),this.MaintainGrid.Columns.push(e),(e=new b.a).Header=a.a.GetResource("Edit"),e.DisplayMember="Edit",e.ReadOnly=!0,e.Width=50,e.DataType="LINK",e.Click.Subscribe(this,"OnMaintenanceEditClick"),this.MaintainGrid.Columns.push(e),(e=new b.a).Header=a.a.GetResource("Delete"),e.DisplayMember="Delete",e.ReadOnly=!0,e.Width=70,e.DataType="LINK",this.MaintainGrid.Columns.push(e),this.MaintainGrid.TableNewRow.Subscribe(this,"Table_TableNewRow"),this.MaintainGrid.OnLinkClick.Subscribe(this,"OnMaintenanceDeleteClick"),this.MaintainGrid.Column=0,this.MaintainGrid.Row=3,this.MaintainGrid.ColumnSpan=4,this.InsuranceGrid.Table=[],this.InsuranceGrid.TableColumns.push("Sno"),this.InsuranceGrid.TableColumns.push("Vendor"),this.InsuranceGrid.TableColumns.push("VendorID"),this.InsuranceGrid.TableColumns.push("PolicyNumber"),this.InsuranceGrid.TableColumns.push("Coverage"),this.InsuranceGrid.TableColumns.push("Edit"),this.InsuranceGrid.TableColumns.push("Delete"),this.InsuranceGrid.TableColumns.push("StartDate"),this.InsuranceGrid.TableColumns.push("EndDate"),this.InsuranceGrid.TableColumns.push("PolicyType"),this.InsuranceGrid.TableColumns.push("Premium"),this.InsuranceGrid.TableColumns.push("HistoryID"),this.InsuranceGrid.Columns=new Array,(e=new b.a).Header=a.a.GetResource("Sno"),e.DisplayMember="Sno",e.ReadOnly=!0,e.Width=50,this.InsuranceGrid.Columns.push(e),(e=new b.a).Header=a.a.GetResource("AssetManagement_Vendor"),e.DisplayMember="Vendor",e.DataType="TEXTBOX",e.ReadOnly=!0,e.Width=150,this.InsuranceGrid.Columns.push(e),(e=new b.a).Header=a.a.GetResource("AssetManagement_PolicyNo"),e.DisplayMember="PolicyNumber",e.DataType="TEXTBOX",e.ReadOnly=!0,e.Width=150,this.InsuranceGrid.Columns.push(e),(e=new b.a).Header=a.a.GetResource("AssetManagement_Coverage"),e.DisplayMember="Coverage",e.ReadOnly=!0,e.Width=150,this.InsuranceGrid.Columns.push(e),(e=new b.a).Header=a.a.GetResource("Edit"),e.DisplayMember="Edit",e.ReadOnly=!0,e.Width=50,e.DataType="LINK",e.Click.Subscribe(this,"OnInsuranceEditClick"),this.InsuranceGrid.Columns.push(e),(e=new b.a).Header=a.a.GetResource("Delete"),e.DisplayMember="Delete",e.ReadOnly=!0,e.Width=70,e.DataType="LINK",this.InsuranceGrid.Columns.push(e),this.InsuranceGrid.TableNewRow.Subscribe(this,"Table_TableNewRow"),this.InsuranceGrid.OnLinkClick.Subscribe(this,"OnInsuranceDeleteClick"),this.InsuranceGrid.Column=0,this.InsuranceGrid.Row=3,this.InsuranceGrid.ColumnSpan=4,this.DisposeGrid.Table=[],this.DisposeGrid.TableColumns.push("Sno"),this.DisposeGrid.TableColumns.push("Date"),this.DisposeGrid.TableColumns.push("Amount"),this.DisposeGrid.TableColumns.push("DocNo"),this.DisposeGrid.TableColumns.push("DocID"),this.DisposeGrid.TableColumns.push("Edit"),this.DisposeGrid.TableColumns.push("Delete"),this.DisposeGrid.TableColumns.push("Remarks"),this.DisposeGrid.TableColumns.push("CurrentValue"),this.DisposeGrid.TableColumns.push("DebitAccount"),this.DisposeGrid.TableColumns.push("CreditAccount"),this.DisposeGrid.TableColumns.push("GainAccount"),this.DisposeGrid.TableColumns.push("LossAccount"),this.DisposeGrid.TableColumns.push("DisposeClearingAccount"),this.DisposeGrid.TableColumns.push("PostJV"),this.DisposeGrid.TableColumns.push("CostCenterID"),this.DisposeGrid.TableColumns.push("DocumentName"),this.DisposeGrid.TableColumns.push("DocPrefix"),this.DisposeGrid.TableColumns.push("DocNumber"),this.DisposeGrid.TableColumns.push("HistoryID"),this.DisposeGrid.TableColumns.push("PolicyType"),this.DisposeGrid.TableColumns.push("DisposeType_Name"),this.DisposeGrid.Columns=new Array,(e=new b.a).Header=a.a.GetResource("Sno"),e.DisplayMember="Sno",e.ReadOnly=!0,e.Width=50,this.DisposeGrid.Columns.push(e),(e=new b.a).Header=a.a.GetResource("Date"),e.DisplayMember="Date",e.DataType="TEXTBOX",e.ReadOnly=!0,e.Width=120,this.DisposeGrid.Columns.push(e),(e=new b.a).Header="Type",e.DisplayMember="DisposeType_Name",e.ReadOnly=!0,e.Width=140,this.DisposeGrid.Columns.push(e),(e=new b.a).Header=a.a.GetResource("Amount"),e.DisplayMember="Amount",e.DataType="TEXTBOX",e.ReadOnly=!0,e.Width=140,this.DisposeGrid.Columns.push(e),(e=new b.a).Header=a.a.GetResource("DocumentDesigner_VoucherNo"),e.DisplayMember="DocNo",e.ReadOnly=!0,e.Width=160,e.DataType="LINK",e.Click.Subscribe(this,"OnDisposeDocLink"),this.DisposeGrid.Columns.push(e),this.AddingRowsToTabGrid(),this.DisposeGrid.Column=0,this.DisposeGrid.Row=1,this.DisposeGrid.ColumnSpan=4;for(var t=0;t<this.ScreenObject.CustomTab.Pages.length;t++)624==this.ScreenObject.CustomTab.Pages[t].DBColumnID&&this.ScreenObject.CustomTab.Pages[t].Fields.push(this.MaintainGrid),625==this.ScreenObject.CustomTab.Pages[t].DBColumnID&&this.ScreenObject.CustomTab.Pages[t].Fields.push(this.InsuranceGrid),986==this.ScreenObject.CustomTab.Pages[t].DBColumnID&&this.ScreenObject.CustomTab.Pages[t].Fields.push(this.DisposeGrid)}},{key:"OnDisposeDocLink",value:function(e){this.OnLinkClickEvent(this.DisposeGrid.SelectedItem)}},{key:"OnMaintainDocLink",value:function(e){this.OnLinkClickEvent(this.MaintainGrid.SelectedItem)}},{key:"OnLinkClickEvent",value:function(e){n.e.IsEmpty(e.DocNo)||V.RibbonExtViewModel.LoadDocument(e)}},{key:"AddingRowsToTabGrid",value:function(){for(var e=0;e<6;e++)this.MaintainGrid.addEmptyRow(),this.MaintainGrid.Table[e].Sno=e+1;for(var t=0;t<6;t++)this.InsuranceGrid.addEmptyRow(),this.InsuranceGrid.Table[t].Sno=t+1;for(var s=0;s<6;s++)this.DisposeGrid.addEmptyRow(),this.DisposeGrid.Table[s].Sno=s+1}},{key:"OnMaintenanceDeleteClick",value:function(e,t,s){if("Delete"==t&&!n.e.IsEmpty(e.Delete)){if(!(null!=e.DocNo.toString()?confirm("Do you want to Delete Maintainance's Document '"+e.DocNo.toString()+"'"):confirm("Do you want to Delete Vender '"+e.Vender.toString()+"'")))return;this.DeletingDocument(e,1),this.MaintainGrid.Table.Remove(e),this.UpdateSequence(this.MaintainGrid.Table)}}},{key:"OnInsuranceDeleteClick",value:function(e,t,s){if("Delete"==t&&!n.e.IsEmpty(e.Delete)){var i=!1;if(null!=e.PolicyNumber.toString()&&(i=confirm("Do you want to Delete Insurance's of  Vender '"+e.Vendor.toString()+"'  PolicyNo '"+e.PolicyNumber.toString()+"'")),!i)return;i&&(this.DeletingDocument(e,2),this.InsuranceGrid.Table.Remove(e)),this.UpdateSequence(this.InsuranceGrid.Table)}}},{key:"OnDisposeDeleteClick",value:function(e,t,s){if("Delete"==t&&!n.e.IsEmpty(e.Delete)){if(!(null!=e.DocNo.toString()?confirm("Do you want to Delete Maintainance's Document '"+e.DocNo.toString()+"'"):confirm("Do you want to Delete Vender '"+e.Vender.toString()+"'")))return;this.DeletingDocument(e,1),this.DisposeGrid.Table.Remove(e),this.UpdateSequence(this.DisposeGrid.Table)}}},{key:"DeletingDocument",value:function(e,t){try{M.a.DeleteAssetRefDoc(parseInt(e.HistoryID.toString()),t)}catch(s){Logger.ErrorLog("DeleteAssetViewModel:: OnDelete",s)}}},{key:"InsuranceCheck",value:function(){var e="";return e+="<Row ",e+=' Vendor"'+this.InsuranceGrid.SelectedItem.VendorID.toString()+'"',e+=' PolicyNo"'+this.InsuranceGrid.SelectedItem.PolicyNumber.toString()+'"',(e+=" />").toString()}},{key:"OnMaintenanceEditClick",value:function(e){null==this.MaintainGrid.SelectedItem||n.e.IsEmpty(this.MaintainGrid.SelectedItem.Edit)||(this.MAddClick=!1,this.MEditClick=!0,this.SetVisibility(),this.Maintenance.PostJV.Enable=!1,this.AddMaintenanceVisibility=!0,this.Maintenance.OnLoad(this.MaintainGrid.SelectedItem))}},{key:"OnInsuranceEditClick",value:function(e){null==this.InsuranceGrid.SelectedItem||n.e.IsEmpty(this.InsuranceGrid.SelectedItem.Edit)||(this.IAddClick=!1,this.IEditClick=!0,this.SetVisibility(),this.AddInsuranceVisibility=!0,this.Insurance.OnLoad(this.InsuranceGrid.SelectedItem))}},{key:"OnDisposeEditClick",value:function(e){this.Dispose=new P(this,this.NetValue.Text),null==this.DisposeGrid.SelectedItem||n.e.IsEmpty(this.DisposeGrid.SelectedItem.Edit)||(this.DAddClick=!1,this.DEditClick=!0,this.SetVisibility(),this.Dispose.PostJV.Enable=!1,this.AddDisposalVisibility=!0,this.Dispose.OnLoad(this.DisposeGrid.SelectedItem))}},{key:"OnTabGridDataLoad",value:function(e){for(var t=e.filter((function(e){return 1==e.HistoryTypeID})),s=e.filter((function(e){return 2==e.HistoryTypeID})),i=e.filter((function(e){return 3==e.HistoryTypeID})),o=0;o<t.length;o++)this.MaintainGrid.Table[o].Date=n.e.IsEmpty(t[o].Datee)?null:new Date(t[o].Datee).ToString("dd/MMM/yyyy"),this.MaintainGrid.Table[o].Vendor=t[o].Vender,this.MaintainGrid.Table[o].VendorID=t[o].VendorID,this.MaintainGrid.Table[o].ServiceDate=n.e.IsEmpty(t[o].MaintenanceNextServiceDate)?null:new Date(t[o].MaintenanceNextServiceDate).ToString("dd/MMM/yyyy"),this.MaintainGrid.Table[o].Remarks=t[o].Remarks,this.MaintainGrid.Table[o].Amount=t[o].Amount,this.MaintainGrid.Table[o].DocID=t[o].DOCID,this.MaintainGrid.Table[o].DocNo=t[o].VoucherNo,this.MaintainGrid.Table[o].DebitAccount=t[o].DebitAccount,this.MaintainGrid.Table[o].CreditAccount=t[o].CreditAccount,this.MaintainGrid.Table[o].PostJV=t[o].PostJV,this.MaintainGrid.Table[o].CostCenterID=t[o].CostCenterID,this.MaintainGrid.Table[o].DocumentName=t[o].DocumentName,this.MaintainGrid.Table[o].DocPrefix=t[o].DocPrefix,this.MaintainGrid.Table[o].DocNumber=t[o].DocNumber,this.MaintainGrid.Table[o].HistoryID=t[o].HistoryID,this.MaintainGrid.Table[o].Edit="Edit",this.MaintainGrid.Table[o].Delete="Delete";for(var r=0;r<s.length;r++)this.InsuranceGrid.Table[r].Vendor=s[r].Vender,this.InsuranceGrid.Table[r].VendorID=s[r].VendorID,this.InsuranceGrid.Table[r].PolicyType=s[r].PolicyType,this.InsuranceGrid.Table[r].PolicyNumber=s[r].PolicyNumber,n.e.IsEmpty(s[r].InsuranceStartDate)?this.InsuranceGrid.Table[r].ServiceDate=null:this.InsuranceGrid.Table[r].StartDate=new Date(s[r].InsuranceStartDate).ToString("dd/MMM/yyyy"),this.InsuranceGrid.Table[r].EndDate=n.e.IsEmpty(s[r].InsuranceEndDate)?null:new Date(s[r].InsuranceEndDate).ToString("dd/MMM/yyyy"),this.InsuranceGrid.Table[r].Coverage=s[r].Coverage,this.InsuranceGrid.Table[r].Premium=s[r].Premium,this.InsuranceGrid.Table[r].HistoryID=s[r].HistoryID,this.InsuranceGrid.Table[r].Edit="Edit",this.InsuranceGrid.Table[r].Delete="Delete";for(var l=0;l<i.length;l++)this.DisposeGrid.Table[l].Date=n.e.IsEmpty(i[l].Datee)?null:new Date(i[l].Datee).ToString("dd/MMM/yyyy"),this.DisposeGrid.Table[l].Amount=i[l].Amount,this.DisposeGrid.Table[l].CurrentValue=i[l].CurrentValue,this.DisposeGrid.Table[l].Remarks=i[l].Remarks,this.DisposeGrid.Table[l].DebitAccount=i[l].DebitAccount,this.DisposeGrid.Table[l].CreditAccount=i[l].CreditAccount,this.DisposeGrid.Table[l].GainAccount=i[l].GainAccount,this.DisposeGrid.Table[l].LossAccount=i[l].LossAccount,this.DisposeGrid.Table[l].DisposeClearingAccount=i[l].DisposeClearingAccount,this.DisposeGrid.Table[l].PostJV=i[l].PostJV,this.DisposeGrid.Table[l].DocID=i[l].DOCID,this.DisposeGrid.Table[l].DocNo=i[l].VoucherNo,this.DisposeGrid.Table[l].HistoryID=i[l].HistoryID,this.DisposeGrid.Table[l].Edit="Edit",this.DisposeGrid.Table[l].Delete="Delete",this.DisposeGrid.Table[l].CostCenterID=i[l].CostCenterID,this.DisposeGrid.Table[l].DocumentName=i[l].DocumentName,this.DisposeGrid.Table[l].DocPrefix=i[l].DocPrefix,this.DisposeGrid.Table[l].DocNumber=i[l].DocNumber,this.DisposeGrid.Table[l].PolicyType=i[l].PolicyType,this.DisposeGrid.Table[l].DisposeType_Name="1"==i[l].PolicyType.toString()?"Dispose Full":"2"==i[l].PolicyType.toString()?"Sale Partial":"3"==i[l].PolicyType.toString()?"Sale Full":"Dispose Partial";t.SortBy([{name:"HistoryID",parser:parseInt,desc:!0}]),s.SortBy([{name:"HistoryID",parser:parseInt,desc:!0}]);for(var d=0;d<this.ScreenObject.CustomTab.Pages.length;d++){if("624"==this.ScreenObject.CustomTab.Pages[d].DBColumnID.toString())for(var D=0;D<this.ScreenObject.CustomTab.Pages[d].Fields.length;D++)null!=t&&t.length>0&&(this.ScreenObject.CustomTab.Pages[d].Fields[D]instanceof u.a?26407==this.ScreenObject.CustomTab.Pages[d].Fields[D].DBColumnID?n.e.IsEmpty(t[0].StartDate)||(this.ScreenObject.CustomTab.Pages[d].Fields[D].Text=new Date(t[0].InsuranceStartDate.toString()).ToString(a.a.SessionManager.Preferences["Date Format"]),this.ScreenObject.CustomTab.Pages[d].Fields[D].Date=new Date(t[0].InsuranceStartDate)):26408==this.ScreenObject.CustomTab.Pages[d].Fields[D].DBColumnID?n.e.IsEmpty(t[0].EndDate)||(this.ScreenObject.CustomTab.Pages[d].Fields[D].Text=new Date(t[0].InsuranceEndDate.toString()).ToString(a.a.SessionManager.Preferences["Date Format"]),this.ScreenObject.CustomTab.Pages[d].Fields[D].Date=new Date(t[0].InsuranceEndDate.toString())):26410==this.ScreenObject.CustomTab.Pages[d].Fields[D].DBColumnID&&(n.e.IsEmpty(t[0].NextServiceDate)||(this.ScreenObject.CustomTab.Pages[d].Fields[D].Text=new Date(t[0].MaintenanceNextServiceDate).ToString(a.a.SessionManager.Preferences["Date Format"]),this.ScreenObject.CustomTab.Pages[d].Fields[D].Date=new Date(t[0].MaintenanceNextServiceDate.toString()))):this.ScreenObject.CustomTab.Pages[d].Fields[D]instanceof p.b&&26412==this.ScreenObject.CustomTab.Pages[d].Fields[D].DBColumnID&&(n.e.IsEmpty(t[0].VendorID)||(this.ScreenObject.CustomTab.Pages[d].Fields[D].SelectedValue=parseInt(t[0].VendorID.toString()))));if("625"==this.ScreenObject.CustomTab.Pages[d].DBColumnID.toString()&&null!=s&&s.length>0)for(var b=0;b<this.ScreenObject.CustomTab.Pages[d].Fields.length;b++)this.ScreenObject.CustomTab.Pages[d].Fields[b]instanceof p.b?26409==this.ScreenObject.CustomTab.Pages[d].Fields[b].DBColumnID&&(n.e.IsEmpty(s[0].VendorID)||(this.ScreenObject.CustomTab.Pages[d].Fields[b].SelectedValue=parseInt(s[0].VendorID.toString()))):this.ScreenObject.CustomTab.Pages[d].Fields[b]instanceof u.c?26413==this.ScreenObject.CustomTab.Pages[d].Fields[b].DBColumnID?n.e.IsEmpty(s[0].StartDate)||(this.ScreenObject.CustomTab.Pages[d].Fields[b].Text=new Date(s[0].InsuranceStartDate).ToString(a.a.SessionManager.Preferences["Date Format"]),this.ScreenObject.CustomTab.Pages[d].Fields[b].Date=new Date(s[0].InsuranceStartDate.toString())):26414==this.ScreenObject.CustomTab.Pages[d].Fields[b].DBColumnID&&(n.e.IsEmpty(s[0].EndDate)||(this.ScreenObject.CustomTab.Pages[d].Fields[b].Text=new Date(s[0].InsuranceEndDate).ToString(a.a.SessionManager.Preferences["Date Format"]),this.ScreenObject.CustomTab.Pages[d].Fields[b].Date=new Date(s[0].InsuranceEndDate.toString()))):this.ScreenObject.CustomTab.Pages[d].Fields[b]instanceof c.e?26415==this.ScreenObject.CustomTab.Pages[d].Fields[b].DBColumnID&&(n.e.IsEmpty(s[0].PolicyType)||(this.ScreenObject.CustomTab.Pages[d].Fields[b].SelectedValue=s[0].PolicyType.toString())):this.ScreenObject.CustomTab.Pages[d].Fields[b]instanceof h.d&&(26416==this.ScreenObject.CustomTab.Pages[d].Fields[b].DBColumnID?n.e.IsEmpty(s[0].PolicyNumber)||(this.ScreenObject.CustomTab.Pages[d].Fields[b].Text=s[0].PolicyNumber.toString()):26417==this.ScreenObject.CustomTab.Pages[d].Fields[b].DBColumnID?n.e.IsEmpty(s[0].Premium)||(this.ScreenObject.CustomTab.Pages[d].Fields[b].Text=s[0].Premium.toString()):26418==this.ScreenObject.CustomTab.Pages[d].Fields[b].DBColumnID&&(n.e.IsEmpty(s[0].Coverage)||(this.ScreenObject.CustomTab.Pages[d].Fields[b].Text=s[0].Coverage.toString())))}}},{key:"GetTabGridDataXML",value:function(){return""}},{key:"OnMessageCallBack",value:function(){this.res="Yes",this.RES="Yes"}},{key:"onTabSelectionChanged",value:function(e){null!=this.ScreenObject.CustomTab.SelectedTab&&("Notes"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.SetVisibility(),this.NoteVisibility=!0,this.ViewNotes.OnShowNewNotes(null)):"Attachments"==this.ScreenObject.CustomTab.SelectedTab.Name?(this.SetVisibility(),this.AttachmentVisibility=!0,this.ViewAttachments.OnShowNewAttachment(null)):"Purchase Details"!=this.ScreenObject.CustomTab.SelectedTab.Name&&"Maintenance"!=this.ScreenObject.CustomTab.SelectedTab.Name&&"Transaction History"!=this.ScreenObject.CustomTab.SelectedTab.Name&&"Dispose"!=this.ScreenObject.CustomTab.SelectedTab.Name&&"Insurance"!=this.ScreenObject.CustomTab.SelectedTab.Name||(this.SetVisibility(),this.DetailsVisibility=!0))}},{key:"SetVisibility",value:function(){}},{key:"OnAddValue",value:function(){1!=this.IsFullDispose?3!=this.IsFullDispose?(this.ChangeValue=new B(this),this.SetVisibility(),this.ChangeValueVisibility=!0,a.a.page.ShowDialog(this.ChangeValue,ce)):this.DisplayMessage="Already Sale Full Done":this.DisplayMessage="Already Dispose Full Done"}},{key:"CallBack",value:function(e,t){var s=new n.f;if(s.LoadXml(e),"Maintain"==t){var i=this.ScreenObject.CustomTab.Pages.find((function(e){return"Maintain"==e.Name}));if(i)for(var a=0;a<i.Fields.length;a++)i.Fields[a]instanceof u.a&&26410==i.Fields[a].DBColumnID&&(i.Fields[a].Text=s.SelectSingleNode("XML").attributes.NextStartDate.value,i.Fields[a].Date=new Date(s.SelectSingleNode("XML").attributes.NextStartDate.value))}else if("Insurance"==t){var o=this.ScreenObject.CustomTab.Pages.find((function(e){return"Insurance"==e.Name}));if(null!=o)for(var r=0;r<o.Fields.length;r++)o.Fields[r]instanceof u.a?26413==o.Fields[r].DBColumnID?(o.Fields[r].Text=s.SelectSingleNode("Row").attributes.StartDate.value,o.Fields[r].Date=new Date(s.SelectSingleNode("Row").attributes.StartDate.value)):26414==o.Fields[r].DBColumnID&&(o.Fields[r].Text=s.SelectSingleNode("Row").attributes.EndDate.value,o.Fields[r].Date=new Date(s.SelectSingleNode("Row").attributes.EndDate.value)):o.Fields[r]instanceof p.b?26409==o.Fields[r].DBColumnID&&(o.Fields[r].SelectedValue=parseInt(s.SelectSingleNode("Row").attributes.VendorID.value)):o.Fields[r]instanceof c.e?26415==o.Fields[r].DBColumnID&&(o.Fields[r].SelectedValue=s.SelectSingleNode("Row").attributes.PolicyType.value):o.Fields[r]instanceof h.d&&(26417==o.Fields[r].DBColumnID?o.Fields[r].Text=s.SelectSingleNode("Row").attributes.Premium.value:26418==o.Fields[r].DBColumnID?o.Fields[r].Text=s.SelectSingleNode("Row").attributes.Coverage.value:26416==o.Fields[r].DBColumnID&&(o.Fields[r].Text=s.SelectSingleNode("Row").attributes.PolicyNo.value))}}},{key:"OnTextChanged",value:function(e){}},{key:"OnGroupChanged",value:function(e){if(0==this.objAsset.AMAssetID){if(this.ParentAsset.SelectedValue>0&&this.ParentAsset.SelectedValue!=this.ParentAsset.PreviousSelectedValue){this.ParentAsset.DefaultValue=this.ParentAsset.SelectedValue.toString();var t=a.a.common.GetDataTable("ASS001",this.ParentAsset.SelectedValue.toString());t.length>0&&(this.IgnoreClassLoad=!0,n.e.IsEmpty(t[0].ClassID)||(this.Class.SelectedValue=t[0].ClassID.toString()),"0"!=this.Class.SelectedValue&&(this.EnableControls(!1,1),this.EnableControls(!1,2),this.EnableControls(!1,3)),this.IgnoreClassLoad=!1,this.IgnoreFAGroupChange=!0,this.FAGroup.SelectedValue=null!=t[0].PostingGroupID?parseInt(t[0].PostingGroupID):0,this.EnableControls(!(this.FAGroup.SelectedValue>0),2),this.IgnoreFAGroupChange=!1,this.IgnoreDeprBookChange=!0,this.DeprBook.SelectedValue=n.e.String(t[0].DeprBookID),n.e.IsEmpty(this.DeprBook.SelectedValue)||"0"==this.DeprBook.SelectedValue?this.EnableControls(!0,3):this.EnableControls(!1,3),this.IgnoreDeprBookChange=!1),this.LoadTabFields(t),this.AutoGenerateCode()}this.ParentAsset.PreviousSelectedValue=this.ParentAsset.SelectedValue}}},{key:"OnClassSelectionChanged",value:function(e){if(!this.IgnoreClassLoad){if(this.IgnoreClassLoad=!0,n.e.IsEmpty(this.Class.SelectedValue)||"0"==this.Class.SelectedValue)this.EnableControls(!0,1);else{var t=M.a.GetAssetClassDetails(parseInt(this.Class.SelectedValue));this.FAGroup.SelectedValue=null!=t.Tables[0][0].FAAccountsID?parseInt(t.Tables[0][0].FAAccountsID):0,a.a.SessionManager.IsWebApplication&&this.OnFAGroupSelectionChanged(this.FAGroup),this.DeprBook.SelectedValue=n.e.String(t.Tables[0][0].DeprBookID),a.a.SessionManager.IsWebApplication&&this.OnDeprBookChange(""),this.DeprPeriod.SelectedValue=n.e.String(t.Tables[0][0].DeprPosting),this.EstimateLife.Text=n.e.String(t.Tables[0][0].TotalYears),this.EnableControls(!1,1)}this.IgnoreClassLoad=!1}}},{key:"OnFAGroupSelectionChanged",value:function(e){if(!this.IgnoreFAGroupChange&&!this.isFromEdit){if(this.FAGroup.SelectedValue>0){var t=M.a.GetPostingGroupDetails(this.FAGroup.SelectedValue);null!=t&&t.Tables.length>0&&t.Tables[0].length>0?(this.AcqnCostACCID.SelectedValue=parseInt(t.Tables[0][0].AcqnCostACCID.toString()),this.AccumDeprACCID.SelectedValue=parseInt(t.Tables[0][0].AccumDeprACCID.toString()),this.DeprExpenseACCID.SelectedValue=parseInt(t.Tables[0][0].DeprExpenseACCID.toString()),this.AcquisitionClearingAcc.SelectedValue=parseInt(t.Tables[0][0].AcqnCostDispACCID.toString()),this.DisposalClearingAcc.SelectedValue=parseInt(t.Tables[0][0].AccumDeprDispACCID.toString()),this.DisposalGainAcc.SelectedValue=parseInt(t.Tables[0][0].GainsDispACCID.toString()),this.DisposalLossAcc.SelectedValue=parseInt(t.Tables[0][0].LossDispACCID.toString()),this.MinorAssetExpenseAcc.SelectedValue=parseInt(t.Tables[0][0].MaintExpenseACCID.toString()),this.EnableControls(!1,2)):this.EnableControls(!0,2)}else this.EnableControls(!0,2);this.isFromEdit=!1}}},{key:"OnDeprBookChange",value:function(e){if(!this.IgnoreDeprBookChange)if(n.e.IsEmpty(this.DeprBook.SelectedValue)||"0"==this.DeprBook.SelectedValue)this.EnableControls(!0,3);else{var t=M.a.GetDeprBookDetails(parseInt(this.DeprBook.SelectedValue));null!=t&&t.Tables.length>0&&t.Tables[0].length>0?(this.DeprMethod.SelectedValue=t.Tables[0][0].DeprBookMethod.toString(),this.DeprAvgMethod.SelectedValue=t.Tables[0][0].AveragingMethod.toString(),this.DeprSalvage.Currency.SelectedValue=t.Tables[0][0].SalvageValueType.toString(),this.DeprSalvage.ExchangeRate.Text=t.Tables[0][0].SalvageValue.toString(),this.DeprSalvageInCalc.SelectedValue=Object(o.j)(t.Tables[0][0].IncludeSalvageInDepr)?"1":"0",this.EnableControls(!1,3)):this.EnableControls(!0,3)}}},{key:"EnableControls",value:function(e,t){this.AllowChangeOfFAAccounts||e&&0!=this.objAsset.AMAssetID||(1==t?(this.DeprPeriod.Enable=e,this.FAGroup.Enable=e,this.DeprBook.Enable=e):2==t?(null!=this.AcqnCostACCID&&(this.AcqnCostACCID.Enable=e),null!=this.AccumDeprACCID&&(this.AccumDeprACCID.Enable=e),null!=this.AcquisitionClearingAcc&&(this.AcquisitionClearingAcc.Enable=e),null!=this.DisposalClearingAcc&&(this.DisposalClearingAcc.Enable=e),null!=this.DisposalGainAcc&&(this.DisposalGainAcc.Enable=e),null!=this.DisposalLossAcc&&(this.DisposalLossAcc.Enable=e),null!=this.MinorAssetExpenseAcc&&(this.MinorAssetExpenseAcc.Enable=e),null!=this.DeprExpenseACCID&&(this.DeprExpenseACCID.Enable=e)):3==t&&(this.DeprMethod.Enable=e,this.EstimateLife.Enable=e,this.DeprAvgMethod.Enable=e,this.DeprSalvage.Enable=e))}},{key:"CurrentValueCallBack",value:function(e){this.NetValue.Text=e.ToString(a.a.SessionManager.Preferences.DecimalsinAmount)}},{key:"OnLocationCheckedChanged",value:function(e){this.BooksIn=this.GetBooks(this.DepreciationBooks)}},{key:"GetBooks",value:function(e){for(var t=1,s=0,i="";t<e.Items.length;t++)e.Items[t].IsChecked&&(0==s&&(i=""),i+=e.Items[t].Value+",",s++);return i.length>0&&(i=i.substr(0,i.length-1)+""),this.deprBooks=i,i}},{key:"OnGridAddClick",value:function(e){if("Maintenance"==e.toString())this.MAddClick=!0,this.MEditClick=!1,this.SetVisibility(),this.Maintenance.ClearFields(this.AssetID),this.Maintenance.PostJV.Enable=!0,this.AddMaintenanceVisibility=!0;else if("Insurance"==e.toString())this.IAddClick=!0,this.IEditClick=!1,this.SetVisibility(),this.Insurance.ClearFields(),this.AddInsuranceVisibility=!0;else if("Dispose"==e.toString()){if(1==this.IsFullDispose)return void(this.DisplayMessage="Already Dispose Full Done");if(3==this.IsFullDispose)return void(this.DisplayMessage="Already Sale Full Done");this.DAddClick=!0,this.DEditClick=!1,this.SetVisibility(),this.Dispose=new P(this,this.NetValue.Text),this.AddDisposalVisibility=!0,a.a.page.ShowDialog(this.Dispose,ye)}else if("Dispose_Reversal"==e.toString()){if(!confirm("Do you really want to reverse dispose/sale."))return;this.objAsset.DisposeReverse(this.objAsset.AMAssetID).obj>0?(alert("Dispose Reversal Done."),this.ClearAfterSave()):this.DisplayMessage="Error in Dispose Reversal."}}},{key:"OnSave",value:function(e){return Object(i.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i,r,l,c,u,h,d,D,b,m,C,S,g,T,A,y,I,V,f,v,M,P,E,G,N,k,O,j,L,x,R,W,H,X=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("ChangeValue"!=e){t.next=4;break}this.ChangeValue=new B(this),this.SetVisibility(),this.ChangeValueVisibility=!0,t.next=141;break;case 4:if("Copy"!=e.toString()){t.next=17;break}return t.next=7,s.e(51).then(s.bind(null,"LSMh"));case 7:return i=t.sent,r=i.CopyProductViewModel,l=new r(this),t.next=12,s.e(175).then(s.bind(null,"hIrt"));case 12:c=t.sent,u=c.CopyProductComponent,a.a.page.ShowDialog(l,u,{ShowCenter:!0,Title:a.a.GetResource("Copy")}),t.next=141;break;case 17:if("AssetSchedule"!=e){t.next=23;break}if(this.AssetID>0){t.next=20;break}return t.abrupt("return",void(this.DisplayMessage="Cannot Schedule Un saved Assets"));case 20:this.AssetScheduleDepr=new _(this),this.SetVisibility(),this.AssetScheduleDeprVisibility=!0,t.next=141;break;case 23:if("ScheduleDepreciation"!=e){t.next=28;break}h=Date.Today(),this.CDeprStartDate.Date&&(h=null!=this.DeprAvgMethod&&"3"==this.DeprAvgMethod.SelectedValue?this.CDeprStartDate.Date.AddDays(1-this.CDeprStartDate.Date.getDate()):this.CDeprStartDate.Date),a.a.page.ShowDialog(new Q(this,h),Z,{ShowCenter:!a.a.IsMobile,HideClose:!0,NoWidth:!0}).subscribe((function(e){1!=X.DeprFilterCheck&&(null==X.Schedules&&(X.Schedules=new w.a,X.Schedules.DepreciationScheduleViewModel_1(X)),X.RefreshAssetDataSet(),X.Schedules.LoadData(X.ds,X.DeprFromDate,X.DeprToDate),setTimeout((function(){a.a.page.ShowDialog(X.Schedules,F,{ShowCenter:!0})}),50))})),t.next=141;break;case 28:if("Save"!=e){t.next=141;break}if(!(a.a.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&"True"==a.a.SessionManager.Preferences.EnableDivisionWise.toString()&&a.a.SessionManager.Preferences.ContainsKey("DW Assets")&&""!=a.a.SessionManager.Preferences["DW Assets"]&&Object(o.j)(a.a.SessionManager.Preferences["DW Assets"]))){t.next=53;break}d=!1,D=null,b=!1,m=0;case 32:if(!(m<this.ScreenObject.CustomTab.Pages.length)){t.next=49;break}if(!((C=this.ScreenObject.CustomTab.Pages[m]).Fields.length>0)){t.next=44;break}S=0;case 36:if(!(S<C.Fields.length)){t.next=44;break}if(!((g=C.Fields[S])instanceof p.b&&null!=g.DBColumnName&&g.DBColumnName.toLowerCase().Contains("ccnid")&&"ccnid1"==g.DBColumnName.toLowerCase()&&(b=!0,D=g,0==D.SelectedValue||null==D.SelectedValue))){t.next=41;break}return d=!0,t.abrupt("break",44);case 41:S++,t.next=36;break;case 44:if(!d){t.next=46;break}return t.abrupt("break",49);case 46:m++,t.next=32;break;case 49:if(!b||!d){t.next=51;break}return t.abrupt("return",void(this.DisplayMessage="Division wise Assets exist, Select Division"));case 51:if(b){t.next=53;break}return t.abrupt("return",void(this.DisplayMessage="Division wise Assets exist, Add Field"));case 53:if(!(a.a.SessionManager.Preferences.ContainsKey("DimensionwiseAssets")&&""!=a.a.SessionManager.Preferences.DimensionwiseAssets&&parseInt(a.a.SessionManager.Preferences.DimensionwiseAssets)>0)){t.next=76;break}T=0,A=!1,T=parseInt(a.a.SessionManager.Preferences.DimensionwiseAssets),y=0;case 57:if(!(y<this.ScreenObject.CustomTab.Pages.length)){t.next=74;break}if(!((I=this.ScreenObject.CustomTab.Pages[y]).Fields.length>0)){t.next=71;break}V=0;case 61:if(!(V<I.Fields.length)){t.next=71;break}if(!((f=I.Fields[V])instanceof p.b&&null!=f.DBColumnName&&f.DBColumnName.toLowerCase().Contains("ccnid")&&f.CCID==T)){t.next=68;break}if(A=!0,0!=(v=f).SelectedValue&&null!=v.SelectedValue){t.next=68;break}return t.abrupt("return",void(this.DisplayMessage="Dimension wise Assets exist, Select "+v.Label));case 68:V++,t.next=61;break;case 71:y++,t.next=57;break;case 74:if(A){t.next=76;break}return t.abrupt("return",void(this.DisplayMessage="Dimension wise Assets exists"));case 76:if(!(a.a.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"True"==a.a.SessionManager.Preferences.EnableLocationWise.toString()&&a.a.SessionManager.Preferences.ContainsKey("LW Assets")&&""!=a.a.SessionManager.Preferences["LW Assets"]&&Object(o.j)(a.a.SessionManager.Preferences["LW Assets"])&&50002==this.Location.CCID)||0!=this.Location.SelectedValue&&null!=this.Location.SelectedValue){t.next=78;break}return t.abrupt("return",void(this.DisplayMessage="Location wise Assets exist, Select Location"));case 78:if(t.prev=78,M=this.ScreenObject.ValidateData(),n.e.IsEmpty(M)){t.next=82;break}return t.abrupt("return",void(this.DisplayMessage=M));case 82:if(this.EstLife="",this.SalValue="",this.DeprStartDate=Date.Today(),this.CDeprStartDate.Date&&(this.DeprStartDate=this.CDeprStartDate.Date),P=0,0!=this.objAsset.AMAssetID){t.next=90;break}if(E={StrCode:this.objAsset.AMCode,CodePrefix:this.objAsset.CodePrefix,CodeNumber:this.objAsset.CodeNumber},this.DisplayMessage=this.ScreenObject.SetAutoCodeParams_3(this.Code,this.objAsset.SelectedNodeID,this.ScreenObject.Data.Tables[6],E),this.objAsset.AMCode=E.StrCode,this.objAsset.CodePrefix=E.CodePrefix,this.objAsset.CodeNumber=E.CodeNumber,!(this.DisplayMessage.length>0)){t.next=88;break}return t.abrupt("return");case 88:t.next=91;break;case 90:this.objAsset.AMCode=this.Code.Text;case 91:if(0==this.objAsset.AMAssetID&&this.ScreenObject.IsAutoName&&(this.Name.Enable=!1,G=this.ScreenObject.Data.Tables[6].filter((function(e){return 1==e.IsName})),this.ScreenObject.IsName=!0,G.length>0&&(this.Name.Text=this.ScreenObject.SetAutoCodeParams_1(this.Name,this.objAsset.SelectedNodeID,G))),null!=this.Name.Text&&""!=this.Name.Text){t.next=94;break}return t.abrupt("return",void(this.DisplayMessage="Enter Name"));case 94:if(this.objAsset.AMName=this.Name.Text,""!=this.Status.SelectedValue){t.next=96;break}return t.abrupt("return",void(this.DisplayMessage="Select Status"));case 96:if(this.objAsset.AMStatusID=parseInt(this.Status.SelectedValue),N=0,null==this.PreviousDepreciation){t.next=103;break}if(n.e.IsEmptySpace(this.PreviousDepreciation.Text)&&(this.PreviousDepreciation.Text="0"),n.e.IsNum(this.PreviousDepreciation.Text)){t.next=101;break}return t.abrupt("return",void(this.DisplayMessage="Only Numeric Characters allowed in Previous Depreciation"));case 101:if(!((N=parseFloat(this.PreviousDepreciation.Text))>0)||this.OriginalDeprStartDate.Date){t.next=103;break}return t.abrupt("return",void(this.DisplayMessage="Please Select "+this.OriginalDeprStartDate.Label));case 103:if(null==this.PurchaseValue){t.next=107;break}if(n.e.IsEmptySpace(this.PurchaseValue.Text)&&(this.PurchaseValue.Text="0"),n.e.IsNum(this.PurchaseValue.Text)){t.next=106;break}return t.abrupt("return",void(this.DisplayMessage="Only Numeric Characters allowed in PurchaseValue"));case 106:this.objAsset.AMPurchaseValue=this.PurchaseValue.Text;case 107:if(null==this.DeprStartValue||(n.e.IsEmptySpace(this.DeprStartValue.Text)&&(this.DeprStartValue.Text="0"),n.e.IsNum(this.DeprStartValue.Text))){t.next=109;break}return t.abrupt("return",void(this.DisplayMessage="Only Numeric Characters allowed in CurrentValue"));case 109:if(this.objAsset.DeprStartValue=this.GetDeprStartValue(),!(this.objAsset.DeprStartValue<0)){t.next=111;break}return t.abrupt("return",void(this.DisplayMessage="Negative Depreciation Start Value"));case 111:if(!(Math.abs(N+this.objAsset.DeprStartValue-parseFloat(this.objAsset.AMPurchaseValue))>=1)){t.next=113;break}return t.abrupt("return",void(this.DisplayMessage="Purchase value should be equal with (Previous Depreciation + Depreciation Start Value)"));case 113:if(this.EstLife=this.EstimateLife.Text,!n.e.IsEmptySpace(this.EstimateLife.Text)){t.next=115;break}return t.abrupt("return",void(this.DisplayMessage="Enter EstimatedLife in Depreciation Tab"));case 115:if(k=this.EstLife.split("."),O=0,j=0,L=0,(O=n.e.Int(k[0]))<0&&(O=0),k.length>1&&((j=n.e.Int(k[1]))<0&&(j=0)),k.length>2&&(L=n.e.Int(k[2])),this.EstLife=L>0?O+"."+j.toString()+"."+L.toString():j>0?O+"."+j.toString():O.toString(),this.EstimateLife.Text=this.EstLife,"2"!=this.DeprSalvage.Currency.SelectedValue){t.next=122;break}if(!n.e.IsEmptySpace(this.DeprSalvage.ExchangeRate.Text)&&"0"!=this.DeprSalvage.ExchangeRate.Text){t.next=119;break}return t.abrupt("return",void(this.DisplayMessage="Select Salvage percentage in Depreciation Tab"));case 119:this.SalValue=(parseFloat(this.DeprSalvage.ExchangeRate.Text)*(this.objAsset.DeprStartValue+N)/100).toString(),t.next=123;break;case 122:this.SalValue=this.DeprSalvage.ExchangeRate.Text;case 123:if(0!=this.ParentAsset.SelectedValue){t.next=125;break}return t.abrupt("return",void(this.DisplayMessage="Select Group"));case 125:if(this.objAsset.AMParentAssetID=this.ParentAsset.SelectedValue,this.iTotalQtyPurchaseLoop=0,0,this.iTotalQtyPurchaseLoop=n.e.Int(this.TotalQtyPurchase.Text),x=this.iTotalQtyPurchaseLoop,0==this.objAsset.AMAssetID&&this.iTotalQtyPurchaseLoop>1&&this.TotalQtyPurchaseIgnoreSpaces.IsChecked&&(this.iTotalQtyPurchaseLoop=1),this.objAsset.DetailsXML=this.GetDetailXML(x),this.objAsset.CustomFieldsQuery=this.ScreenObject.GetCustomFieldsQuery(),this.objAsset.CustomCostCenterFieldsQuery=this.ScreenObject.GetCustomCostCenterFieldsQuery(),this.objAsset.HistoryXML=this.ScreenObject.HistoryCCXML,this.objAsset.AMGroup){t.next=135;break}if(!(n.e.Double(this.PurchaseValue.Text)<=0)){t.next=130;break}return t.abrupt("return",void(this.DisplayMessage="Enter PurchaseValue in PurchaseDetail Tab"));case 130:if(R=this.SalValue,null!=this.DeprSalvageInCalc&&"1"==this.DeprSalvageInCalc.SelectedValue&&(R="0"),W={ErrorMessage:""},"1"==this.DeprSchedule.SelectedValue?(0==this.objAsset.AMAssetID||0==this.ds.Tables[10].length&&1!=this.IsFullDispose&&3!=this.IsFullDispose)&&(this.objAsset.DepreciationXML=this.GetDepreciationXML(this.objAsset.DeprStartValue,this.EstLife,this.OriginalDeprStartDate.Date,N,R,this.DeprPeriod.SelectedValue,this.DeprStartDate,this.DeprMethod.SelectedValue,this.DeprAvgMethod.SelectedValue,W)):this.objAsset.DepreciationXML="",!(W.ErrorMessage.length>0)){t.next=135;break}return t.abrupt("return",void(this.DisplayMessage=W.ErrorMessage));case 135:this.objAsset.NotesXML=this.ViewNotes.GetXML(),this.objAsset.AttachmetsXML=this.ViewAttachments.GetXML(),this.objAsset.AttachmetsXML+=this.ScreenObject.GetExtraAttachmentXML(),0==this.objAsset.AMAssetID&&this.iTotalQtyPurchaseLoop>1&&this.TotalQtyPurchaseIgnoreSpaces.IsChecked?(H=new Ee(this.iTotalQtyPurchaseLoop,this.Code.Text),a.a.page.ShowDialog(H,we).subscribe((function(e){H.DialogResult?(X.iCntLoop=0,X.strMessageLoop="",X.SnoSave_CallBack(H)):X.DisplayMessage="Please enter serial nos"}))):(this.objAsset.Sno=this.Sno.Text,this.objAsset.SetAssetManagementDetails().then((function(e){X.DisplayMessage=e.Message,P=e.RetValue,X.RetValue=P,P>0&&X.ClearAfterSave()}))),t.next=141;break;case 138:t.prev=138,t.t0=t.catch(78),Logger.ErrorLog("AddEditAssetViewModel:: OnSAVE",t.t0);case 141:case"end":return t.stop()}}),t,this,[[78,138]])})))}},{key:"SnoSave_CallBack",value:function(e){var t=this;if(this.iCntLoop>=this.iTotalQtyPurchaseLoop)this.SnoSave_CallBackComplete();else{this.objAsset.Sno=e.GridData[this.iCntLoop].SerialNumber.toString(),this.iCntLoop>0&&(this.Code.Enable=!1);var s={StrCode:this.objAsset.AMCode,CodePrefix:this.objAsset.CodePrefix,CodeNumber:this.objAsset.CodeNumber};this.strMessageLoop=this.ScreenObject.SetAutoCodeParams_3(this.Code,this.objAsset.SelectedNodeID,this.ScreenObject.Data.Tables[6],s),this.objAsset.AMCode=s.StrCode,this.objAsset.CodePrefix=s.CodePrefix,this.objAsset.CodeNumber=s.CodeNumber,this.strMessageLoop.length>0||this.objAsset.SetAssetManagementDetails().then((function(s){t.strMessageLoop=s.Message,t.RetValue=s.RetValue,t.RetValue<0?t.SnoSave_CallBackComplete():(t.iCntLoop++,t.SnoSave_CallBack(e))}))}}},{key:"SnoSave_CallBackComplete",value:function(){this.iCntLoop>0&&(this.iCntLoop<this.iTotalQtyPurchaseLoop&&(null!=this.strMessageLoop?this.strMessageLoop+="\r\n"+this.iCntLoop+" Assets Saved":this.strMessageLoop="\r\n"+this.iCntLoop+" Assets Saved"),this.ClearAfterSave()),this.DisplayMessage=this.strMessageLoop}},{key:"ClearAfterSave",value:function(){this.IsFullDispose=0,this.IsDeprScheduleExists=!1,this.objAsset.AMAssetID=0,this.ClearingFields(),this.ParentAsset.PreviousSelectedValue=0,this.ParentAsset.Enable=!0,this.ScreenObject.Clear(),this.OnGroupChanged(null),null!=this.Parent&&this.Parent.Refresh(),this.MaintainGrid.Clear(),this.InsuranceGrid.Clear(),this.DisposeGrid.Clear(),this.ViewNotes.NotesListObj.Clear(),this.ViewAttachments.AttachmentsList.Clear(),this.AddingRowsToTabGrid(),this.objAsset.AMAssetID=0,this.DisplayName=this.objAsset.AMGroup?"Add Asset Group":a.a.GetResource("AssetManagement_AddAsset")}},{key:"GetDepreciationXML",value:function(e,t,s,i,a,o,r,l,c,u){u.ErrorMessage="";var h,d=0,D=0,b=0;try{var p=t.split(".");d=n.e.Int(p[0]),p.length>1&&(D=n.e.Int(p[1])),p.length>2&&(b=n.e.Int(p[2]))}catch(S){}if(d<=0&&D<=0&&b<=0)return e>0&&(u.ErrorMessage="Enter EstimatedLife in Depreciation Tab"),"";if(b>0&&"3"==c)return u.ErrorMessage="Mid-Month method can not be applied if estimated life provided with days.","";var m=r;h=(h=(h=(h=m.AddYears(d)).AddMonths(D)).AddDays(b)).AddDays(-1);var C=new f.b(this.AssetID);return C.CallFromAssetSave=!0,C.GetScheduleData(e,d,D,b,s,i,parseFloat(a),l,o,0,c,m,h,null,this.DeprBook.SelectedValue),u.ErrorMessage=C.ErrorMessage,C.GetXML()}},{key:"GetXML",value:function(e){var t,s="";s+="<Row ",n.e.IsEmpty(this.Description.Tag)?s+=' Description="'+h.d.GetValidXml(this.Description.Text)+'"':s+=' Description="'+h.d.GetValidXml(this.Description.Tag)+'"',s+=' Sno="'+this.Sno.Text+'"',s+=' deprBooks="'+this.deprBooks+'"',s+=""!=this.Class.SelectedValue?' Class="'+parseInt(this.Class.SelectedValue)+'"':' Class="0"',s+=' PostingGroupID="'+this.FAGroup.SelectedValue+'"',n.e.IsEmpty(this.DeprBook.SelectedValue)?s+=' DeprBookID="0"':s+=' DeprBookID="'+parseInt(this.DeprBook.SelectedValue)+'"',s+=0!=this.Location.SelectedValue?' Location="'+this.Location.SelectedValue+'"':' Location="1"',s+=0!=this.Employee.SelectedValue?' Employee="'+this.Employee.SelectedValue+'"':' Employee="0"',s+=' TotalQtyPurchase="'+e+'" ';for(var i=0;i<this.ScreenObject.CustomTab.Pages.length;i++)for(var a=this.ScreenObject.CustomTab.Pages[i],o=0;o<a.Fields.length;o++){var r=a.Fields[o];if(["Purchase Details","Depreciation","FA Accounts","Maintenance","Insurance"].Contains(a.Name)&&r instanceof y.c&&null!=r.DBColumnName)if(r instanceof h.d)if(t=r.Text,n.e.IsEmpty(t)&&(t="",null),24064==r.DBColumnID&&t,26398!=r.DBColumnID||""!=r.Text&&0!=parseFloat(r.Text))s+=r.DBColumnName+'="'+t.Replace("'","''")+'" ';else{var l=0,d=0;null!=this.PurchaseValue&&(l=n.e.Double(this.PurchaseValue.Text)),null!=this.PreviousDepreciation&&(d=n.e.Double(this.PreviousDepreciation.Text)),s+=r.DBColumnName+'="'+(l-d)+'" '}else r instanceof c.e?(t=r.SelectedValue,n.e.IsEmpty(t)&&(t=""),s+=r.DBColumnName+'="'+t+'" ',25479==r.DBColumnID&&null!=r.SelectedItem&&(s+='SalvageValueName="'+r.SelectedItem.Name+'" ')):r instanceof u.c||r instanceof u.a?(t=n.e.IsEmpty(r.Date)?"":r.Date.ToString("dd/MMM/yyyy"),s+=r.DBColumnName+'="'+t+'" '):r instanceof p.b&&(this.oPactCombo=r,s+=this.oPactCombo.DBColumnName+'="'+this.oPactCombo.SelectedValue+'" ')}return s+='SalvageValueType="'+this.DeprSalvage.Currency.SelectedValue+'" ',s+='SalvageValueName="'+this.DeprSalvage.Currency.Text+'" ',s+='SalvageValue="'+this.DeprSalvage.ExchangeRate.Text+'" ',(s+=" />").toString()}},{key:"GetDetailXML",value:function(e){var t,s=this,i="";return n.e.IsEmpty(this.Description.Tag)?i+=" Description=N'"+h.d.GetValidXml(this.Description.Text)+"',":i+=" Description=N'"+h.d.GetValidXml(this.Description.Tag)+"',",i+=" SerialNo=N'"+this.Sno.Text+"',",i+=" DeprBookGroupID=N'"+this.deprBooks+"',",i+=""!=this.Class.SelectedValue?" ClassID="+parseInt(this.Class.SelectedValue)+",":" ClassID=0,",i+=" PostingGroupID="+this.FAGroup.SelectedValue+",",n.e.IsEmpty(this.DeprBook.SelectedValue)?i+=" DeprBookID=0,":i+=" DeprBookID="+parseInt(this.DeprBook.SelectedValue)+",",i+=0!=this.Location.SelectedValue?" LocationID="+this.Location.SelectedValue+",":" LocationID=1,",i+=0!=this.Employee.SelectedValue?" EmployeeID="+this.Employee.SelectedValue+",":" EmployeeID=0,",i+=" TotalQtyPurchase="+e+",",this.ScreenObject.CustomTab.Pages.forEach((function(e){e.Fields.forEach((function(a){if(["Purchase Details","Depreciation","FA Accounts","Maintenance","Insurance"].Contains(e.Name)&&a instanceof y.c&&null!=a.DBColumnName)if(a instanceof h.d)if(t=a.Text,n.e.IsEmpty(t)&&(t="",null),24064==a.DBColumnID&&t,26398!=a.DBColumnID||""!=a.Text&&0!=parseFloat(a.Text))i+=a.DBColumnName+"=N'"+t+"',";else{var o=0,r=0;null!=s.PurchaseValue&&(o=n.e.Double(s.PurchaseValue.Text)),null!=s.PreviousDepreciation&&(r=n.e.Double(s.PreviousDepreciation.Text)),i+=a.DBColumnName+"=N'"+(o-r)+"',"}else a instanceof c.e?(t=a.SelectedValue,n.e.IsEmpty(t)&&(t=""),i+=a.DBColumnName+"=N'"+t+"',",25479==a.DBColumnID&&null!=a.SelectedItem&&(i+="SalvageValueName=N'"+a.SelectedItem.Name+"',")):a instanceof u.c?(t=a.Date.toString(),n.e.IsEmpty(t)&&(t=""),""!=t&&(t=" convert(float,convert(datetime,'"+(t=new Date(t).ToString("dd/MMM/yyyy"))+"'))",i+=a.DBColumnName+"="+t+",")):a instanceof u.a?(t=a.Date.ToString("dd/MMM/yyyy"),n.e.IsEmpty(t)&&(t=""),""!=t&&(t=" convert(float,convert(datetime,'"+(t=new Date(t).ToString("dd/MMM/yyyy"))+"'))",i+=a.DBColumnName+"="+t+",")):a instanceof p.b&&(s.oPactCombo=a,s.oPactCombo.CCID<5e4&&(i+=s.oPactCombo.DBColumnName+"="+s.oPactCombo.SelectedValue+","))}))})),i+="SalvageValueType=N'"+this.DeprSalvage.Currency.SelectedValue+"',",i+="SalvageValueName=N'"+this.DeprSalvage.Currency.Text+"',",(i+="SalvageValue=N'"+this.DeprSalvage.ExchangeRate.Text+"',").toString()}},{key:"ClearingFields",value:function(){this.isFromEdit=!1,this.ChgVisibility=!1,this.DepreciationVisibility=!1,this.ScheduleVisibility=!1,null!=this.CDeprStartDate&&(this.CDeprStartDate.Enable=!0),this.Code.Text="",this.Name.Text="",this.Description.Text="",this.Sno.Text="",this.NetValue.Text="0";for(var e=0;e<this.DepreciationBooks.Items.length;e++)this.DepreciationBooks.Items[e].IsChecked=!1;this.Location.Clear(0),this.oLocationHistory=null,this.Employee.Clear(0),this.oOwnerHistory=null,this.ViewTransactionHistory.TransactionHisInfoObj.Clear(),null!=this.DeprStartValue&&(this.DeprStartValue.Enable=!0),null!=this.PurchaseValue&&(this.PurchaseValue.Enable=!0),null!=this.PreviousDepreciation&&(this.PreviousDepreciation.Enable=!0),null!=this.EstimateLife&&(this.EstimateLife.Enable=!0),null!=this.DeprSchedule&&(this.DeprSchedule.Enable=!0),null!=this.EstimateLife&&(this.EstimateLife.Enable=!0),null!=this.DeprMethod&&(this.DeprMethod.Enable=!0),null!=this.DeprSalvageInCalc&&(this.DeprSalvageInCalc.Enable=!0),null!=this.DeprAvgMethod&&(this.DeprAvgMethod.Enable=!0),null!=this.DeprSalvage&&(this.DeprSalvage.Enable=!0),null!=this.DeprPeriod&&(this.DeprPeriod.Enable=!0)}},{key:"OnCustomizeExtraFields",value:function(e){"Customize"==e.toString()&&(Logger.InfoLog("AddEditAssetViewModel::Entering OnCustomize"),Logger.InfoLog("AddEditAssetViewModel::Exiting OnCustomize"))}},{key:"LoadData",value:function(){var e=new Array;e.push(c.d.ComboBoxItems_2("Add by Value","0")),e.push(c.d.ComboBoxItems_2("Add by %","1")),this.TranColumnSource=new Array;var t=new b.a;(t=new b.a).Header=a.a.GetResource("Sno"),t.DisplayMember="Sno",t.DataType="TextBlock",t.Width=40,t.ReadOnly=!0,t.IsFrozen=!0,this.TranColumnSource.push(t),(t=new b.a).Header=a.a.GetResource("AssetManagement_Type"),t.ValueBinding="Type",t.DisplayMember="Name",t.ValueMember="Value",t.DataType="Combobox",t.Width=150,t.ComboData=e,this.TranColumnSource.push(t),(t=new b.a).Header="Date",t.DisplayMember="Date",t.DataType="DATE",t.Width=180,this.TranColumnSource.push(t),(t=new b.a).Header="OldValue",t.DisplayMember="OldValue",t.DataType="TextBlock",t.Width=180,this.TranColumnSource.push(t),(t=new b.a).Header="+/-",t.DisplayMember="Difference",t.DataType="TextBlock",t.Width=180,this.TranColumnSource.push(t),(t=new b.a).Header="NewValue",t.DisplayMember="NewValue",t.DataType="TextBlock",t.Width=180,this.TranColumnSource.push(t),(t=new b.a).Header="Location",t.DisplayMember="Location",t.ValueMember="Location_Key",t.DataType="LISTBOX",t.Width=180,t.TypeID=1,t.CostCenterID=50002,this.TranColumnSource.push(t),this.TranHistoryGridData=[],this.TranHistoryGridDataObj.TableColumns.push("Sno"),this.TranHistoryGridDataObj.TableColumns.push("Type"),this.TranHistoryGridDataObj.TableColumns.push("Date"),this.TranHistoryGridDataObj.TableColumns.push("OldValue"),this.TranHistoryGridDataObj.TableColumns.push("+/-"),this.TranHistoryGridDataObj.TableColumns.push("NewValue"),this.TranHistoryGridDataObj.TableColumns.push("Location"),this.TranHistoryGridDataObj.TableColumns.push("Location_Key");for(var s=0;s<5;s++)this.TranHistoryGridDataObj.addEmptyRow(),this.UpdateSequence(this.TranHistoryGridData);for(var i=this.ScreenObject.CustomTab.Pages.length-1;i>=0;i--){var n=this.ScreenObject.CustomTab.Pages[i];switch(n.Name){case"Notes":n.Fields.push(this.ViewNotes);break;case"Attachments":n.Fields.push(this.ViewAttachments);break;case"Maintenance":n.Fields.push(this.ViewMaintenance);break;case"Insurance":n.Fields.push(this.ViewInsurance);break;case"Transaction History":n.Fields.push(this.ViewTransactionHistory),this.Trans=n}}}},{key:"UpdateSequence",value:function(e){var t=this;this.SNo=1,e.forEach((function(e){e.Sno=t.SNo++}))}},{key:"AutoGenerateCode",value:function(){if(this.objAsset.SelectedNodeID=this.ParentAsset.SelectedValue>0?this.ParentAsset.SelectedValue:this.ParentID,this.ScreenObject.SetAutoCode(this.Code,this.objAsset.AMGroup,this.objAsset.SelectedNodeID,this.ScreenObject.Data.Tables[6]),this.ScreenObject.IsAutoName){this.ScreenObject.IsNameAutoGenerate=!0,this.Name.Enable=!1;var e=this.ScreenObject.Data.Tables[6].filter((function(e){return 1==e.IsName}));this.ScreenObject.IsName=!0,e.length>0&&(this.Name.Text=this.ScreenObject.SetAutoCodeParams_1(this.Name,this.objAsset.SelectedNodeID,e))}}},{key:"LoadTabFields",value:function(e){if(null!=e&&e.length>0)try{for(var t=0;t<this.ScreenObject.CustomTab.Pages.length;t++)for(var s=this.ScreenObject.CustomTab.Pages[t],i=0;i<s.Fields.length;i++){var a=s.Fields[i];a instanceof y.c&&null!=a.DBColumnName&&!Object(A.isUndefined)(e[0][a.DBColumnName])&&(a instanceof h.d?a.Text=n.e.String(e[0][a.DBColumnName]):a instanceof c.e?a.SelectedValue=147==a.DBColumnID?Object(o.j)(e[0][a.DBColumnName])?"1":"0":n.e.String(e[0][a.DBColumnName]):a instanceof h.c?a.Text=n.e.String(e[0][a.DBColumnName]):a instanceof u.c||a instanceof u.a?n.e.isValidDate(e[0][a.DBColumnName])&&(a.Date=new Date(e[0][a.DBColumnName])):a instanceof I.a?a.Text=n.e.String(e[0][a.DBColumnName]):a instanceof p.b?n.e.IsNum(e[0][a.DBColumnName])&&(a.SelectedValue=parseInt(e[0][a.DBColumnName])):a instanceof l.b&&(a.ExchangeRate.Text=n.e.String(e[0].SalvageValue),a.Currency.SelectedValue=n.e.String(e[0].SalvageValueType)))}}catch(r){Logger.ErrorLog("AssetManagement:: LoadTabFields : ",r)}}},{key:"GetDeprStartValue",value:function(){var e;if(0==(e=n.e.Double(this.DeprStartValue.Text))&&(e=n.e.Double(this.PurchaseValue.Text),null!=this.PreviousDepreciation)){e-=n.e.Double(this.PreviousDepreciation.Text)}return e}},{key:"GetPrevDeprValue",value:function(){var e,t,s=0;return null!=this.PreviousDepreciation?s=n.e.Double(this.PreviousDepreciation.Text):(0!=(e=n.e.Double(this.DeprStartValue.Text))&&(0!=(t=n.e.Double(this.PurchaseValue.Text))&&(s=t-e)),s)}},{key:"OnLocationClick",value:function(e){if(this.DisplayMessage="",null==this.oLocationHistory){this.oLocationHistory=new v.a(e);for(var t=0;t<this.ScreenObject.CustomTab.Pages.length&&(this.oLocationHistory.lstExtraField=this.ScreenObject.CustomTab.Pages[t].Fields.find((function(t){return t instanceof p.b&&t.CCID==e.CCID})),!this.oLocationHistory.lstExtraField);t++);this.AssetID>0&&this.oLocationHistory.LoadEditData(this.ds.Tables[7],this.ds.Columns[7])}a.a.page.ShowDialog(this.oLocationHistory,W.a,{ShowCenter:!a.a.IsMobile,Title:a.a.GetResource("History"),NoWidth:!0})}},{key:"OnOwnerClick",value:function(e){this.DisplayMessage="",0!=e.CCID?(null==this.oOwnerHistory&&(this.oOwnerHistory=new v.a(e),this.AssetID>0&&this.oOwnerHistory.LoadEditData(this.ds.Tables[3],this.ds.Columns[3])),a.a.page.ShowDialog(this.oOwnerHistory,W.a,{ShowCenter:!a.a.IsMobile,Title:a.a.GetResource("History"),NoWidth:!0})):this.DisplayMessage="Please Set Asset Owner Dimension At Asset Preferences"}},{key:"OnLabelClick",value:function(e){"EstimateLife"==e.DBColumnName&&this.EstimateLife.Enable&&a.a.page.ShowDialog(new Q(this,this.DeprFromDate,!0),Z,{ShowCenter:!a.a.IsMobile,HideClose:!0,NoWidth:!0})}},{key:"RefreshAssetDataSet",value:function(){this.ds=M.a.GetAssetManagementDetails(this.AssetID),null!=this.ds&&this.ds.Tables.length>10&&(this.dtDepr=this.ds.Tables[10])}},{key:"GetCCXML",value:function(){var e=1,t=null!=Location&&this.Location.CCID>5e4?this.Location.CCID-5e4:2;null!=Location&&0!=this.Location.SelectedValue&&(e=this.Location.SelectedValue);var s=0,i=1;n.e.IsEmpty(this.ds.Tables[4][0].AssetDimNodeID)||(s=parseInt(this.ds.Tables[4][0].AssetDimID),0==(i=parseInt(this.ds.Tables[4][0].AssetDimNodeID))&&(i=1),s>5e4&&(s-=5e4));var a="";if(this.ds.Tables[17].length>0)for(var o=this.ScreenObject.Data.Tables[0].filter((function(e){return e.SysColumnName.startsWith("CCNID")&&e.ColumnCostCenterID>5e4})),r=0;r<o.length;r++){var l,c=o[r].SysColumnName.toString();(l=n.e.Int(c.replace("CCNID","")))!=t&&l!=s&&l>0&&(a+=",dcCCNID"+l+"="+this.ds.Tables[17][0]["CCNID"+l].toString())}var u='<CostCenters  Query="dcCCNID'+t+"="+e;return s>0&&(u+=",dcCCNID"+s+"="+i),u+=a,u+=',"  />'}},{key:"AssetID",get:function(){return this.objAsset.AMAssetID}},{key:"IsFullDispose",get:function(){return this._IsFullDispose},set:function(e){this._IsFullDispose!=e&&(this._IsFullDispose=e,this.DisposeGrid.IsColumnUserDefined=1==e||3==e)}}]),r}(r.b),Ne=function(){function e(t){var s=this;_classCallCheck(this,e),this.Parent=t,this.Book=new c.e(0),this.WEF=new u.a(0),this.Book.SelectionChangedCommand.Subscribe(this,"OnBookChange"),this.ColumnSpan="4",this.Row="2",this.Column="0",t.ds.Tables[2].forEach((function(e){s.Book.Items.push(c.d.ComboBoxItems_2(e.DeprBookName.toString(),e.DeprBookID.toString()))})),this.BooksGrid=new D.a,this.BooksGrid.Table=[],this.BooksGrid.Width="",this.BooksGrid.TableColumns.push("Sno"),this.BooksGrid.TableColumns.push("DeprBookID"),this.BooksGrid.TableColumns.push("DeprBook"),this.BooksGrid.TableColumns.push("WEF_Key"),this.BooksGrid.TableColumns.push("WEF"),this.BooksGrid.Columns=new Array;var i=new b.a;i.Header=a.a.GetResource("Sno"),i.DisplayMember="Sno",i.ReadOnly=!0,i.Width=50,this.BooksGrid.Columns.push(i),(i=new b.a).Header="Depreciation Book",i.DisplayMember="DeprBook",i.DataType="TEXTBOX",i.ReadOnly=!0,i.Width=180,this.BooksGrid.Columns.push(i),(i=new b.a).Header="WEF",i.DisplayMember="WEF",i.DataType="TEXTBOX",i.ReadOnly=!0,i.Width=110,this.BooksGrid.Columns.push(i);for(var n=0;n<6;n++)this.BooksGrid.addEmptyRow()}return _createClass(e,[{key:"OnButtonClick",value:function(e){if(!n.e.IsEmpty(this.Book.SelectedValue)){var t=0;for(t=0;t<this.BooksGrid.Table.length&&!Object(A.isNullOrUndefined)(this.BooksGrid.Table[t].DeprBookID);t++);t==this.BooksGrid.Table.length&&this.BooksGrid.addEmptyRow();var s=this.BooksGrid.Table[t];s.Sno=t+1,s.DeprBookID=this.Book.SelectedValue,s.DeprBook=this.Book.SelectedItem.Name,s.WEF_Key=this.WEF.Date,s.WEF=this.WEF.Date.ToString(a.a.SessionManager.Preferences["Date Format"])}}},{key:"OnBookChange",value:function(e){if(!n.e.IsEmpty(this.Book.SelectedValue)&&null!=this.Book.SelectedItem){var t=M.a.GetDeprBookDetails(parseInt(this.Book.SelectedValue));null!=t&&t.Tables.length>0&&t.Tables[0].length>0?(this.Parent.DeprMethod.SelectedValue=t.Tables[0][0].DeprBookMethod.toString(),this.Parent.EstimateLife.Text=t.Tables[0][0].BasedOnValue.toString(),this.Parent.DeprAvgMethod.SelectedValue=t.Tables[0][0].AveragingMethod.toString(),this.EnableControls(!1)):this.EnableControls(!0)}}},{key:"EnableControls",value:function(e){this.Parent.DeprMethod.Enable=e,this.Parent.EstimateLife.Enable=e,this.Parent.DeprAvgMethod.Enable=e}}]),e}()}}]);