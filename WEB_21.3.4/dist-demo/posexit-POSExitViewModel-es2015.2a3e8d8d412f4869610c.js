(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{FNqn:function(e,t,i){"use strict";i.r(t),i.d(t,"POSExitViewModel",(function(){return p}));var s=i("mrSG"),n=i("ScVY"),o=i("4HhE"),a=i("wlFP"),r=i("n56n"),l=i("JIg3"),h=i("8B8H"),S=i("/GLD"),g=i("Do2H"),c=i("ockk"),u=i("mvPR"),D=i("eQJW"),m=i("Lp6j"),d=i("3L/X"),C=i("lUlH"),b=i("ThYU");class p extends n.b{constructor(){super(),this.ButtonClick=new o.b,this.DayClose=new a.a(0),this.HoldVisibility=!1,this.DraftVisibility=!1,this.ExitVisible=!1,this.OptionsVisible=!1,this.GridVisible=!1,this.PrintVisibility=!1,this.Shift=new r.b,this.PrintDate=new l.c(0),this.CancelVisible=!0,this.BackVisible=!1,this.ShowDenomHelp=!1,this.NumericPADView=null,this.TouchVisibility=!1,this.LoginVisi=!1,this.ReportVisibility=!1,this.DtExit=[],this.IsPayMode=!1,this.IsShiftClose=!1,this.IsDiff=!1,this.ManagerLoggedin=!1,this.oReport=null,this.Denom=null,this.DenomXML="",this.RegName="",this.CloseType=0,this.DtDiffPosting=new m.f,this.ClassName="POSExitViewModel"}get Parent(){return this._parent}get DTPayModes(){return this.DTPayModesObj.Table}get DtReport(){return this.DtReportObj.Table}POSExitViewModel_1(e,t,i,s){this.DayClose.Visible=!1,this._parent=e,this.OptionsVisible=t,this.HoldVisibility=i,this.DraftVisibility=s,this.DayClose.Label="Day Close",t||i||s||(this.ExitVisible=!0),this.OptionsVisible?(this.Title="Options",this.Options_CashIN=g.a.SessionManager.IsActionAssigned(this._parent.CostCenterID,"Options - Cash In"),this.Options_CashOut=g.a.SessionManager.IsActionAssigned(this._parent.CostCenterID,"Options - Cash Out"),this.Options_CashRegister=g.a.SessionManager.IsActionAssigned(this._parent.CostCenterID,"Options - Cash Register"),g.a.SessionManager.Preferences.ContainsKey("PosShifts")&&""!=g.a.SessionManager.Preferences.PosShifts.toString()&&parseInt(g.a.SessionManager.Preferences.PosShifts.toString())>5e4&&(this.Options_ShiftClose=!0),this.Options_ShiftClose&&(this.Shift.CCID=parseInt(g.a.SessionManager.Preferences.PosShifts.toString()),this.Shift.TypeID=1),this.Options_DayClose=!0):this.Title=this.HoldVisibility?g.a.GetResource("Com_SaveAsHold"):s?g.a.GetResource("Remarks"):"Exit",this.ButtonClick.Subscribe(this,"OnButtonClick"),this.ExitVisible&&this.InitGrid()}InitGrid(){this.Exit_UserExit=g.a.SessionManager.IsActionAssigned(this._parent.CostCenterID,"User Exit"),this.Exit_UserClose=g.a.SessionManager.IsActionAssigned(this._parent.CostCenterID,"User Close"),this.Exit_ShiftClose=g.a.SessionManager.IsActionAssigned(this._parent.CostCenterID,"Shift Close"),this.Exit_DayClose=g.a.SessionManager.IsActionAssigned(this._parent.CostCenterID,"Day Close"),this.DTPayModesObj=new h.a,this.DTPayModesObj.Columns=[],this.DTPayModesObj.Table=[],this.DTPayModesObj.TableColumns.push("Name"),this.DTPayModesObj.TableColumns.push("NameWithKey"),this.DTPayModesObj.TableColumns.push("Amount"),this.DTPayModesObj.DataTypes.Double.push("Amount"),this.DTPayModesObj.TableColumns.push("Type"),this.DTPayModesObj.TableColumns.push("SysColumnName"),this.DTPayModesObj.TableColumns.push("DenomXML"),this.DtReportObj=new h.a,this.DtReportObj.Columns=[],this.DtReportObj.Table=[],this.DtReportObj.TableColumns.push("NameWithKey"),this.DtReportObj.TableColumns.push("Amount"),this.DtReportObj.TableColumns.push("AmountActual"),this.DtReportObj.DataTypes.Double.push("AmountActual"),this.DtReportObj.TableColumns.push("SysColumnName"),this.DtReportObj.TableColumns.push("Type"),this.DtReportObj.TableColumns.push("StyleIsBold"),this.DtReportObj.TableColumns.push("Row_Background"),this.Parent.ScreenObject.Preferences.ContainsKey("PosPostings")&&"true"==this.Parent.ScreenObject.Preferences.PosPostings.toLowerCase()&&this.DtReportObj.TableColumns.push("PostJV"),this.ExitGrid=new h.a,this.ExitGrid.Columns=[],this.ExitGrid.Table=[],this.ExitGrid.Width="",this.ExitGrid.Height=250,this.ExitGrid.RowHeight=this.Parent.GridRowHeight,this.ExitGrid.BeginEdit.Subscribe(this,"OnExitGridBeginEdit");let e=[],t=new c.a;t.Header="Name",t.DisplayMember="NameWithKey",t.DisableTab=!0,t.Width=220,t.ReadOnly=!0,t.DisableTab=!0,e.push(t),t=new c.a,t.Header="Value",t.DisplayMember="Amount",t.DataType="FLOAT",t.DecimalPoints=g.a.SessionManager.Preferences.DecimalsinAmount,t.Width=180,e.push(t),this.ExitGrid.Columns=e}OnButtonClick(e){return Object(s.b)(this,void 0,void 0,(function*(){if(null!=e){!m.e.IsEmpty(this.ExitGrid)&&this.ExitGrid.gridObj&&null!=this.ExitGrid.gridObj.getActiveCellNode()&&this.ExitGrid.gridObj.getEditorLock().commitCurrentEdit();const{LoginViewModel:t}=yield Promise.resolve().then(i.bind(null,"GhW8")),{LoginScreenComponent:s}=yield Promise.resolve().then(i.bind(null,"kJpQ"));switch(e.toString()){case"Login":let e=yield new t(this.router);e.IsPosMangr=!0,e.ShowRememberMe=!1,e.ShowDefaultCompany=!1,yield Promise.all([i.e(2),i.e(1),i.e(3),i.e(5),i.e(4),i.e(6),i.e(7),i.e(10),i.e(9),i.e(8),i.e(12),i.e(11),i.e(13),i.e(19),i.e(15),i.e(21),i.e(20),i.e(16),i.e(14),i.e(18),i.e(17),i.e(22),i.e(23),i.e(24),i.e(25),i.e(28),i.e(30),i.e(29),i.e(32),i.e(31),i.e(27),i.e(26),i.e(35),i.e(37),i.e(38),i.e(36),i.e(33),i.e(34),i.e(39),i.e(40),i.e(41),i.e(212)]).then(i.bind(null,"ThYU")),g.a.page.ShowDialog(e,s).subscribe(()=>{if(e.IsLoggedIn){this.BackVisible=!0,this.LoginVisi=!1;let e=new b.ReportViewModel;e.ReportViewModel_1(18),e.ShowHeaderButtons=!1,e.SearchVisibility=!1,this.Report=e,this.ReportVisibility=!0}});break;case"Cancel":g.a.page.HideDialog();break;case"DayClose":if(g.a.SessionManager.Preferences.PosShifts.length>0&&parseInt(g.a.SessionManager.Preferences.PosShifts)>5e4&&this.Parent.ScreenObject.ShiftNodeID>0){let e;if(e=g.a.admin.POSLogin(this.Parent.ScreenObject.RegisterNodeID,this.Parent.ScreenObject.ShiftNodeID,this.Parent.DocumentDate,104,"","","").obj,e<0)return this.DisplayMessage="Close all shifts before DayClose",void(this.MessageVisibility=!0)}if(this.CloseType=1,g.a.SessionManager.Preferences.ContainsKey("DontShowPaymodeWhileDayClose")&&""!=g.a.SessionManager.Preferences.DontShowPaymodeWhileDayClose&&Object(D.j)(g.a.SessionManager.Preferences.DontShowPaymodeWhileDayClose)){let e,t={RetVal:0};C.a.POSLogin(this.Parent.ScreenObject.RegisterNodeID,this.Parent.ScreenObject.ShiftNodeID,this.Parent.DocumentDate,this.CloseType,"","","",t),e=t.RetVal,g.a.page.HideDialog(),g.a.page.removeActiveTab()}else this.ExitVisible=!1,this.GridVisible=!0,this.IsShiftClose=!1,this.Paymodes(null);break;case"ShiftClose":if(this.CloseType=2,g.a.SessionManager.Preferences.ContainsKey("DontShowPaymodeWhileShiftClose")&&""!=g.a.SessionManager.Preferences.DontShowPaymodeWhileShiftClose&&Object(D.j)(g.a.SessionManager.Preferences.DontShowPaymodeWhileShiftClose)){let e,t={RetVal:0};C.a.POSLogin(this.Parent.ScreenObject.RegisterNodeID,this.Parent.ScreenObject.ShiftNodeID,this.Parent.DocumentDate,this.CloseType,"","","",t),e=t.RetVal,g.a.page.HideDialog(),g.a.page.removeActiveTab()}else this.ExitVisible=!1,this.GridVisible=!0,this.IsShiftClose=!0,this.Paymodes(null);break;case"UserClose":if(this.CloseType=3,g.a.SessionManager.Preferences.ContainsKey("DontShowPaymodeWhileUserClose")&&""!=g.a.SessionManager.Preferences.DontShowPaymodeWhileUserClose&&Object(D.j)(g.a.SessionManager.Preferences.DontShowPaymodeWhileUserClose)){let e;e=g.a.admin.POSLogin(this.Parent.ScreenObject.RegisterNodeID,this.Parent.ScreenObject.ShiftNodeID,this.Parent.DocumentDate,this.CloseType,"","","").obj,g.a.page.HideDialog(),g.a.page.removeActiveTab()}else this.ExitVisible=!1,this.GridVisible=!0,this.IsShiftClose=!1,this.Paymodes(null);break;case"UserExit":(confirm("Do you really want to exit?")||g.a.SessionManager.IsWebApplication)&&(this.CloseType=0,this.CloseSession());break;case"LockScreen":if(confirm("Do you really want to lock?")){let e=yield new t(this.router);e.IsUserLock=!0,e.CancelVisiblity=!1,e.ShowRememberMe=!1,e.ShowDefaultCompany=!1,e.Title="Un Lock",g.a.page.HideDialog(),g.a.page.ShowDialog(e,s)}break;case"CashOut":if(g.a.SessionManager.Preferences.ContainsKey("CashOut")&&""!=g.a.SessionManager.Preferences.CashOut&&"0"!=g.a.SessionManager.Preferences.CashOut){g.a.page.HideDialog();const{PostVoucherSaveViewModel:e}=yield Promise.resolve().then(i.bind(null,"9UOb")),{PostVoucherSaveComponent:t}=yield Promise.resolve().then(i.bind(null,"xbaw"));let s=new e(this.Parent,parseInt(g.a.SessionManager.Preferences.CashOut),0,0,1,1,!1,!1);g.a.page.ShowDialog(s,t,{ShowCenter:!0,NoWidth:!1})}break;case"CashIN":if(g.a.SessionManager.Preferences.ContainsKey("CashIn")&&""!=g.a.SessionManager.Preferences.CashIn&&"0"!=g.a.SessionManager.Preferences.CashIn){g.a.page.HideDialog();const{PostVoucherSaveViewModel:e}=yield Promise.resolve().then(i.bind(null,"9UOb")),{PostVoucherSaveComponent:t}=yield Promise.resolve().then(i.bind(null,"xbaw"));let s=new e(this.Parent,parseInt(g.a.SessionManager.Preferences.CashIn),0,0,1,1,!1,!1);g.a.page.ShowDialog(s,t,{ShowCenter:!0,NoWidth:!1})}break;case"CashRegister":g.a.page.HideDialog();const{POSCashRegisterViewModel:n}=yield i.e(197).then(i.bind(null,"j1+j")),{POSCashRegisterComponent:o}=yield i.e(0).then(i.bind(null,"oFEv"));let a=new n(this.Parent);g.a.page.ShowDialog(a,o,{ShowCenter:!0,NoWidth:!1});break;case"HoldDoc":if(0!=this.Parent.DocID)return this.DisplayMessage=g.a.GetResource("Documentalreadysaved"),void(this.MessageVisibility=!0);if(null==this.Parent.HoldDocName||""==this.Parent.HoldDocName.Text.trim())return this.DisplayMessage="Enter Name",void(this.MessageVisibility=!0);this.Parent.SaveDraft(!1,!1),g.a.page.HideDialog();break;case"OK":if(this.IsPayMode)2==this.CloseType&&(this.DayClose.IsChecked=!1,this.DayClose.Visible=!0),this.TouchVisibility=!1,this.FillGrid(!1),this.BackVisible=g.a.SessionManager.IsActionAssigned(this.Parent.CostCenterID,"CanEditPayMode"),this.IsDiff&&(this.LoginVisi=!0);else{if("1"!=g.a.SessionManager.UserID&&this.IsDiff&&g.a.SessionManager.IsActionAssigned(this.Parent.CostCenterID,"DonotcloseifDiffinPayMode"))return this.DisplayMessage="Difference in PayModes",void(this.MessageVisibility=!0);4==this.CloseType?(this.CallPrint(this.Parent.ScreenObject.ShiftNodeID),g.a.page.HideDialog()):this.CloseSession()}break;case"Previous":this.BackVisible=!1,this.CancelVisible=!0,this.ShowDenomHelp=!0,this.LoginVisi=!1,this.ReportVisibility=!1,this.IsPayMode=!0,this.IsDiff=!1,this.ExitGrid.Columns[1].ReadOnly=!1,this.ExitGrid.Height=250,this.ExitGrid.RefreshColumns(),this.ExitGrid.Table=this.DtExit,this.DtReport.Clear(),this.TouchVisibility=this.Parent.FooterTouchVisible,this.DayClose.Visible&&(this.DayClose.Visible=!1);break;case"Back":g.a.page.HideDialog();break;case"PrintDayClose":this.PrintVisibility=!0,this.OptionsVisible=!1,this.Shift.Visible=!1,this.PrintDate.Label=g.a.GetResource("Doc_Date");break;case"PrintShiftClose":this.PrintVisibility=!0,this.OptionsVisible=!1,this.Shift.Visible=!0,this.Shift.Label="Shift",this.PrintDate.Label=g.a.GetResource("Doc_Date");break;case"PrintOK":if(!this.PrintDate.Date)return this.DisplayMessage="select Date",void(this.MessageVisibility=!0);if(this.Shift.Visible&&0==this.Shift.SelectedValue)return this.DisplayMessage="select shift",void(this.MessageVisibility=!0);this.CloseType=this.Shift.Visible?5:4,this.InitGrid(),this.GridVisible=!0,this.PrintVisibility=!1,this.FillGrid(!0)}}}))}OnExitGridBeginEdit(e,t,i){return!(!this.IsPayMode||"Amount"!=t||"5"!=e.Type.toString()||0==e.DenomXML.toString().length)||(this.IsPayMode&&"Amount"==t&&null!=this.NumericPADView&&""!=e[t].toString()&&(this.NumericPADView.txt.Text=e[t].toString()),!1)}Paymodes(e){null==e?(this.ShowDenomHelp=!0,this.IsPayMode=!0):e.Tables.length>10&&e.Columns[10].Contains("DetailsXML")&&e.Tables[10].length>0&&""!=e.Tables[10][0].DetailsXML.toString()&&null.ReadXml(e.Tables[10][0].DetailsXML.toString()),this.DTPayModesObj.Clear();let t=this.Parent.ScreenObject.Data.Tables[0].filter(e=>e.SectionID>4&&11!=e.SectionID,"SectionID");if(t.length>0){let e=2;for(let s=0;s<t.length;s++){const n=t[s];if(n.SysColumnName.toString().toLowerCase().Contains("currid")||n.SysColumnName.toString().toLowerCase().Contains("exchrt"))continue;let o={};if(o.Name=n.ResourceData.toString(),o.NameWithKey=e<=10?n.ResourceData.toString()+" (F"+e+")":n.ResourceData.toString(),o.SysColumnName=n.SysColumnName.toString(),o.Type=n.SectionID.toString(),!m.e.IsEmpty(null)&&null.Tables.length>0&&null.Columns[0].Contains("SysColName")){var i=null.Tables[0].filter(e=>e.SysColName==n.SysColumnName.toString());i.length>0&&!m.e.IsEmpty(i[0].Amount)&&(o.Amount=i[0].Amount.toString())}this.DTPayModes.push(o),e++}}null==e&&(this.ExitGrid.Table=this.DTPayModes),this.ExitGrid.ColumnNo=1,this.ExitGrid.LineNo=0,this.ExitGrid.SetFocusongrid=!0,this.TouchVisibility=this.Parent.FooterTouchVisible}FillGrid(e){!e&&this.Parent.ScreenObject.Preferences.ContainsKey("POSDiffJVFields")&&""!=this.Parent.ScreenObject.Preferences.POSDiffJVFields&&this.DtDiffPosting.ReadXml(this.Parent.ScreenObject.Preferences.POSDiffJVFields);let t,i=window.innerHeight-320;i<400&&(i=400),this.ExitGrid.Columns[1].ReadOnly=!0,this.ExitGrid.Height=i,this.ExitGrid.RefreshColumns(),this.CancelVisible=!!(e||this.Parent.ScreenObject.Preferences.ContainsKey("Cancelinclose")&&"true"==this.Parent.ScreenObject.Preferences.Cancelinclose.toLowerCase()),this.ShowDenomHelp=!1,this.IsPayMode=!1;let s=0;if(e)t=this.PrintDate.Date,this.Shift.Visible&&(s=this.Shift.SelectedValue);else{this.IsShiftClose&&(s=this.Parent.ScreenObject.ShiftNodeID);let e=this.Parent.ScreenObject.HeaderFields.find(e=>e instanceof l.a&&"docdate"==e.DBColumnName.toLowerCase());t=null!=e&&""!=e.DefaultValue?new Date(e.DefaultValue):this.Parent.DocumentDate}let n=C.a.GetPOSDetails(this.Parent.PosSessionID,t,this.CloseType,this.Parent.ScreenObject.RegisterNodeID,s,"");if(n.Tables.length>1&&n.Columns[1].Contains("Prefix")&&e){if(n.Tables.length>10&&n.Columns[10].Contains("Isclose")&&n.Tables[10].length>0&&"Not close"==n.Tables[10][0].Isclose.toString())return this.DisplayMessage=4==this.CloseType?"Day not closed":"Shift not closed",this.MessageVisibility=!0,this.GridVisible=!1,void(this.PrintVisibility=!0);this.Paymodes(n)}this.DtExit=JSON.parse(JSON.stringify(this.ExitGrid.Table)),this.CloseData(n)}CloseData(e){return Object(s.b)(this,void 0,void 0,(function*(){if(null==this.oReport){const{ReportViewModel:e}=yield Promise.all([i.e(2),i.e(1),i.e(3),i.e(5),i.e(4),i.e(6),i.e(7),i.e(10),i.e(9),i.e(8),i.e(12),i.e(11),i.e(13),i.e(19),i.e(15),i.e(21),i.e(20),i.e(16),i.e(14),i.e(18),i.e(17),i.e(22),i.e(23),i.e(24),i.e(25),i.e(28),i.e(30),i.e(29),i.e(32),i.e(31),i.e(27),i.e(26),i.e(35),i.e(37),i.e(38),i.e(36),i.e(33),i.e(34),i.e(39),i.e(40),i.e(41),i.e(212)]).then(i.bind(null,"ThYU"));this.oReport=new e,this.oReport.ReportViewModel_1(190)}else this.oReport.Data.Clear();if(e.Tables.length>1&&e.Columns[1].Contains("Prefix")){e.Columns[e.Tables.length-1].Contains("Name")&&e.Tables[e.Tables.length-1].length>0&&(this.RegName=e.Tables[e.Tables.length-1][0].Name.toString());let i,s=this.Parent.ScreenObject.Preferences.POSFields.toString().split(","),n=null;this.Parent.ScreenObject.Preferences.ContainsKey("POSJVFields")&&(n=this.Parent.ScreenObject.Preferences.POSJVFields.toString().split(","));let o=0,a=null,r=null;e.Tables[1].length>0&&""!=e.Tables[1][0].orders.toString()&&(a=e.Tables[1][0].orders.toString().split(",")),e.Tables[1].length>0&&""!=e.Tables[1][0].GiftVSale.toString()&&(r=e.Tables[1][0].GiftVSale.toString().split(",")),i=this.AddRow("Sales(vouchers)","",!1,!0);let l=e.Tables[1].filter(e=>38==e.documenttype);for(let e=0;e<l.length;e++)null!=a&&a.Contains(l[e].costcenterid.toString())||null!=r&&r.Contains(l[e].costcenterid.toString())||(this.AddRow(l[e].DocumentName.toString()+"-Starting No",l[e].Prefix.toString()+l[e].MinNumber.toString(),!1,!1),this.AddRow(l[e].DocumentName.toString()+"-Ending No",l[e].Prefix.toString()+l[e].MAXNumber.toString(),!1,!1),""!=l[e].cnt.toString()&&(o+=parseInt(l[e].cnt.toString())));i.Amount=o;for(let t=0;t<s.length;t++){let o=this.Parent.ScreenObject.ColumnSource.find(e=>e.DisplayMember.toLowerCase()==s[t].toLowerCase());null!=o&&(i=this.AddRow(o.Header,e.Tables[0].length>0?e.Tables[0][0][t].toString():"FLOAT"==o.DataType?"0":"","FLOAT"==o.DataType,!1),this.DtReportObj.TableColumns.Contains("PostJV")&&null!=n&&n.Contains(s[t])&&(i.SysColumnName=s[t],i.PostJV=1))}if(null!=a&&a.length>0){this.AddRow("","",!1,!0),o=0,i=this.AddRow("Orders(vouchers)","",!1,!0);for(let e=0;e<l.length;e++)a.Contains(l[e].costcenterid.toString())&&(this.AddRow(l[e].DocumentName.toString()+"-Starting No",l[e].Prefix.toString()+l[e].MinNumber.toString(),!1,!1),this.AddRow(l[e].DocumentName.toString()+"-Ending No",l[e].Prefix.toString()+l[e].MAXNumber.toString(),!1,!1),""!=l[e].cnt.toString()&&(o+=parseInt(l[e].cnt.toString())));if(i.Amount=o,e.Tables.length>8&&e.Tables[8].length>0)for(let t=0;t<s.length;t++){let n=this.Parent.ScreenObject.ColumnSource.find(e=>e.DisplayMember.toLowerCase()==s[t].toLowerCase());null!=n&&(i=this.AddRow(n.Header,e.Tables[8][0][t].toString(),"FLOAT"==n.DataType,!1))}}if(null!=r&&r.length>0){this.AddRow("","",!1,!0),o=0,i=this.AddRow("Gift (vouchers)","",!1,!0);for(let e=0;e<l.length;e++)r.Contains(l[e].costcenterid.toString())&&(this.AddRow(l[e].DocumentName.toString()+"-Starting No",l[e].Prefix.toString()+l[e].MinNumber.toString(),!1,!1),this.AddRow(l[e].DocumentName.toString()+"-Ending No",l[e].Prefix.toString()+l[e].MAXNumber.toString(),!1,!1),""!=l[e].cnt.toString()&&(o+=parseInt(l[e].cnt.toString())));if(i.Amount=o,e.Tables.length>9&&e.Tables[9].length>0)for(let t=0;t<s.length;t++){let n=this.Parent.ScreenObject.ColumnSource.filter(e=>e.DisplayMember.toLowerCase()==s[t].toLowerCase());null!=n&&(i=this.AddRow(n.Header,e.Tables[9][0][t].toString(),"FLOAT"==n.DataType,!1))}}this.AddRow("","",!1,!1),o=0,i=this.AddRow("Return(vouchers)","",!1,!0),l=e.Tables[1].filter(e=>39==e.documenttype);for(let e=0;e<l.length;e++)this.AddRow(l[e].DocumentName.toString()+"-Starting No",l[e].Prefix.toString()+l[e].MinNumber.toString(),!1,!1),this.AddRow(l[e].DocumentName.toString()+"-Ending No",l[e].Prefix.toString()+l[e].MAXNumber.toString(),!1,!1),""!=l[e].cnt.toString()&&(o+=parseInt(l[e].cnt.toString()));if(i.Amount=o,e.Tables.length>4&&e.Tables[4].length>0)for(let t=0;t<s.length;t++){let n=this.Parent.ScreenObject.ColumnSource.find(e=>e.DisplayMember.toLowerCase()==s[t].toLowerCase());null!=n&&(i=this.AddRow(n.Header,e.Tables[4][0][t].toString(),"FLOAT"==n.DataType,!1))}if(this.AddRow("","",!1,!1),this.Parent.ScreenObject.Preferences.ContainsKey("POSFields")&&""!=this.Parent.ScreenObject.Preferences.POSFields)for(let h=0;h<s.length;h++)if(null==this.Parent.ScreenObject.ColumnSource.find(e=>e.DisplayMember.toLowerCase()==s[h].toLowerCase())){let o=this.DTPayModes.filter(e=>e.SysColumnName.toLowerCase()==s[h].toLowerCase());if(o.length>0){this.AddRow(o[0].Name.toString(),"",!1,!0),o[0].Name="  "+o[0].Name;let a,r=0;if("5"==o[0].Type.toString()){if(e.Tables.length>2&&e.Tables[2].length>0&&e.Columns[2].Contains("Amount"))for(let t=0;t<e.Tables[2].length;t++)i="300"==e.Tables[2][t].RefCCID.toString()?this.AddRow("  Opening "+o[0].Name.toString(),e.Tables[2][t].Amount.toString(),!0,!1):this.AddRow(o[0].Name.toString()+" IN",e.Tables[2][t].Amount.toString(),!0,!1),i.SysColumnName=o[0].SysColumnName.toString(),i.Type=o[0].Type.toString(),""==e.Tables[2][t].Amount.toString()||this.Parent.ScreenObject.Preferences.ContainsKey("DonotConsiderOpeningInPaymode")&&""!=this.Parent.ScreenObject.Preferences.DonotConsiderOpeningInPaymode&&Object(D.j)(this.Parent.ScreenObject.Preferences.DonotConsiderOpeningInPaymode)&&"300"==e.Tables[2][t].RefCCID.toString()||(r+=parseFloat(e.Tables[2][t].Amount.toString()));e.Tables.length>3&&e.Tables[3].length>0&&e.Columns[3].Contains("Amount")&&""!=e.Tables[3][0].Amount.toString()&&(i=this.AddRow(o[0].Name.toString()+" OUT",e.Tables[3][0].Amount.toString(),!0,!1),i.SysColumnName=o[0].SysColumnName.toString(),i.Type=o[0].Type.toString(),""!=e.Tables[3][0].Amount.toString()&&(r-=parseFloat(e.Tables[3][0].Amount.toString())))}if("5"==o[0].Type.toString()?(a=0,e.Tables[0].length>0&&""!=e.Tables[0][0][e.Columns[0][h]].toString()&&(a+=parseFloat(e.Tables[0][0][e.Columns[0][h]].toString())),e.Tables.length>5&&e.Tables[5].length>0&&""!=e.Tables[5][0][e.Columns[0][0]].toString()&&(a-=parseFloat(e.Tables[5][0][e.Columns[0][0]].toString())),r+=a,i=this.AddRow(o[0].Name.toString()+" Sales",a.toString(),!0,!1),this.DtReportObj.TableColumns.Contains("PostJV")&&null!=n&&n.Contains(s[h])&&(i.SysColumnName=s[h],i.PostJV=1)):(i=this.AddRow(o[0].Name.toString(),e.Tables[0].length>0?e.Tables[0][0][e.Columns[0][h]].toString():"0",!0,!1),e.Tables[0].length>0&&""!=e.Tables[0][0][e.Columns[0][h]].toString()&&(r+=parseFloat(e.Tables[0][0][e.Columns[0][h]].toString())),this.DtReportObj.TableColumns.Contains("PostJV")&&null!=n&&n.Contains(s[h])&&(i.SysColumnName=s[h],i.PostJV=1)),i.SysColumnName=o[0].SysColumnName.toString(),i.Type=o[0].Type.toString(),e.Tables.length>7&&e.Tables[7].length>0&&""!=e.Tables[7][0][e.Columns[0][h]].toString()&&(i=this.AddRow(o[0].Name.toString()+" Reciept",e.Tables[7][0][e.Columns[0][h]].toString(),!0,!1),r+=parseFloat(e.Tables[7][0][e.Columns[0][h]].toString())),e.Tables.length>8&&e.Tables[8].length>0&&""!=e.Tables[8][0][e.Columns[0][h]].toString()&&(i=this.AddRow(o[0].Name.toString()+" Orders",e.Tables[8][0][e.Columns[0][h]].toString(),!0,!1),r+=parseFloat(e.Tables[8][0][e.Columns[0][h]].toString())),e.Tables.length>9&&e.Tables[9].length>0&&""!=e.Tables[9][0][e.Columns[0][h]].toString()&&(i=this.AddRow(o[0].Name.toString()+" Gift vouchers",e.Tables[9][0][e.Columns[0][h]].toString(),!0,!1),r+=parseFloat(e.Tables[9][0][e.Columns[0][h]].toString())),e.Tables.length>4&&e.Tables[4].length>0&&""!=e.Tables[4][0][e.Columns[0][h]].toString()&&("5"==o[0].Type.toString()?(a=0,""!=e.Tables[4][0][h].toString()&&(a+=parseFloat(e.Tables[4][0][e.Columns[0][h]].toString())),e.Tables.length>6&&e.Tables[6].length>0&&""!=e.Tables[6][0][e.Columns[0][0]].toString()&&(a-=parseFloat(e.Tables[6][0][e.Columns[0][0]].toString())),r-=a,null!=i&&this.DtReportObj.TableColumns.Contains("PostJV")&&"1"==i.PostJV.toString()&&""!=i.AmountActual.toString()&&a>0&&(i.AmountActual=parseFloat(i.AmountActual.toString())-a),i=this.AddRow("  Sales Return",a.toString(),!0,!1)):(null!=i&&this.DtReportObj.TableColumns.Contains("PostJV")&&"1"==i.PostJV.toString()&&""!=i.AmountActual.toString()&&""!=e.Tables[4][0][e.Columns[0][h]].toString()&&(i.AmountActual=parseFloat(i.AmountActual.toString())-parseFloat(e.Tables[4][0][e.Columns[0][h]].toString())),i=this.AddRow("  Sales Return",e.Tables[4][0][e.Columns[0][h]].toString(),!0,!1),r-=parseFloat(e.Tables[4][0][h].toString())),i.SysColumnName=o[0].SysColumnName.toString(),i.Type=o[0].Type.toString()),i=this.AddRow(o[0].Name.toString()+" @Register",m.e.IsEmpty(o[0].Amount)?"0":o[0].Amount.toString(),!0,!1),i.SysColumnName=o[0].SysColumnName.toString(),i.Type=o[0].Type.toString(),this.DtDiffPosting.Tables.length>0&&this.DtDiffPosting.Columns[0].Contains("Name")){var t=this.DtDiffPosting.Tables[0].filter(e=>e.Name==-i.Type.toString());this.DtReportObj.TableColumns.Contains("PostJV")&&t.length>0&&(i.SysColumnName="RegPOs",i.PostJV=1)}if(r=m.e.IsEmpty(o[0].Amount)?-r:parseFloat(o[0].Amount.toString())-r,r=parseFloat(r.ToString("N"+g.a.SessionManager.Preferences.DecimalsinAmount)),0==r||this.IsDiff||(this.IsDiff=!0),i=this.AddRow(o[0].Name.toString()+" Diff",r.toString(),!0,!1),i.SysColumnName=o[0].SysColumnName.toString(),i.Type=o[0].Type.toString(),this.DtDiffPosting.Tables.length>0&&this.DtDiffPosting.Columns[0].Contains("Name")){let e=this.DtDiffPosting.Tables[0].filter(e=>e.Name==i.Type);this.DtReportObj.TableColumns.Contains("PostJV")&&e.length>0&&(i.SysColumnName="DiffPOs",i.PostJV=1)}}else{let t=this.Parent.ScreenObject.Data.Tables[0].filter(e=>e.SysColumnName.toLowerCase()==s[h].toLowerCase());t.length>0&&(e.Tables[0].length>0&&(i=this.AddRow(t[0].ResourceData.toString(),e.Tables[0][0][e.Columns[0][h]].toString(),!1,!1)),this.DtReportObj.TableColumns.Contains("PostJV")&&null!=n&&n.Contains(s[h])&&(i.SysColumnName=s[h],i.PostJV=1))}}if(null!=this.Denom&&null!=this.Denom.GrdDenomination&&null!=this.Denom.GrdDenomination.Table&&this.Denom.GrdDenomination.Table.length>0&&this.Denom.GrdDenomination.TableColumns.Contains("Notes")&&this.Denom.GrdDenomination.TableColumns.Contains("NotesTender")){i=this.AddRow("Denominations","",!1,!0);for(let e=0;e<this.Denom.GrdDenomination.Table.length;e++)m.e.IsEmpty(this.Denom.GrdDenomination.Table[e].Notes.toString())||m.e.IsEmpty(this.Denom.GrdDenomination.Table[e].NotesTender.toString())||(i=this.AddRow(this.Denom.GrdDenomination.Table[e].Notes.toString()+" X "+this.Denom.GrdDenomination.Table[e].NotesTender.toString(),(parseFloat(this.Denom.GrdDenomination.Table[e].Notes.toString())*parseFloat(this.Denom.GrdDenomination.Table[e].NotesTender.toString())).toString(),!1,!1));this.AddRow("Total",this.Denom.GetTotal().toString(),!1,!1)}}this.ExitGrid.Table=this.DtReport,this.ExitGrid.refreshDatawithIDs()}))}AddRow(e,t,i,s){let n=new u.d(this.oReport.ReportColumns.length);s&&(n.Cells[0].IsNormal=!1,n.Cells[0].CellAppearance=this.oReport.ReportColumns[0].DataAppearance.Clone(),n.Cells[0].CellAppearance.IsBold=!0,n.Cells[0].IsNormal=!1,n.Cells[1].CellAppearance=this.oReport.ReportColumns[1].DataAppearance.Clone(),n.Cells[1].CellAppearance.IsBold=!0),n.Cells[0].Text=e;let o=0;i?(o=m.e.DoubleTryParse(t),this.oReport.SetCellValue(o,this.oReport.ReportColumns[1].DataFormat,"FLOAT",n.Cells[1])):n.Cells[1].Text=t,this.oReport.Data.push(n);let a=this.DtReportObj.NewRow();return a.NameWithKey=e,s&&(a.StyleIsBold="1"),i?(a.Amount=n.Cells[1].Text,a.AmountActual=o,e.Contains("Diff")&&(o>0&&(a.Row_Background="GREEN"),o<0&&(a.Row_Background="RED"))):a.Amount=t,this.DtReport.push(a),a}GetJVXML(e,t){if(t.IsValid=!0,!this.DtReportObj.TableColumns.Contains("PostJV"))return"";let i,s,n=this.Parent.ScreenObject.GenerateQueryfromList(this.Parent.ScreenObject._CCFields,!0,{message:""},!1,!1);g.a.SessionManager.RegisterCCID>0&&this.Parent.ScreenObject.RegisterNodeID>0&&!n.toString().Contains("dcCCNID"+(g.a.SessionManager.RegisterCCID-5e4).toString()+"=")&&(n+=" dcCCNID"+(g.a.SessionManager.RegisterCCID-5e4).toString()+"="+this.Parent.ScreenObject.RegisterNodeID.toString()+", "),this.Parent.ScreenObject.Preferences.ContainsKey("PosJVOn")&&"2"==this.Parent.ScreenObject.Preferences.PosJVOn&&g.a.SessionManager.Preferences.PosShifts.length>0&&parseInt(g.a.SessionManager.Preferences.PosShifts)>5e4&&this.Parent.ScreenObject.ShiftNodeID>0&&!n.toString().Contains("dcCCNID"+(parseInt(g.a.SessionManager.Preferences.PosShifts)-5e4).toString()+"=")&&(n+=" dcCCNID"+(parseInt(g.a.SessionManager.Preferences.PosShifts)-5e4).toString()+"="+this.Parent.ScreenObject.ShiftNodeID.toString()+", ");let o,a="";for(let g=0;g<this.DtReport.length;g++)if("1"==m.e.StringValue(this.DtReport[g].PostJV)&&!m.e.IsEmpty(this.DtReport[g].AmountActual)&&(o="DiffPOs"==this.DtReport[g].SysColumnName.toString()?this.DtDiffPosting.Tables[0].filter(e=>e.Name==this.DtReport[g].Type.toString()):"RegPOs"==this.DtReport[g].SysColumnName.toString()?this.DtDiffPosting.Tables[0].filter(e=>e.Name="-"+this.DtReport[g].Type.toString()):this.Parent.ScreenObject.Data.Tables[0].filter(e=>e.SysColumnName==this.DtReport[g].SysColumnName.toString()),o.length>0)){if(i=m.e.IntTryParse(o[0].DebitAccount.toString()),s=m.e.IntTryParse(o[0].CreditAccount.toString()),i<=0&&o[0].Table.Columns.Contains("DrRefColID")&&""!=o[0].DrRefColID.toString()&&parseInt(o[0].DrRefColID.toString())>0){let e=this.Parent.ScreenObject._CCFields.find(e=>e.DBColumnName.toLowerCase()==o[0].DRSysColumnName.toString().toLowerCase());null!=e&&e instanceof r.b&&e.SelectedValue>0&&(i=this.Parent.ScreenObject.GetAccountByRef(parseInt(o[0].DrRefID.toString()),parseInt(o[0].DrRefColID.toString()),e.SelectedValue))}if(s<=0&&o[0].Table.Columns.Contains("CrRefColID")&&""!=o[0].CrRefColID.toString()&&parseInt(o[0].CrRefColID.toString())>0){let e=this.Parent.ScreenObject._CCFields.find(e=>e.DBColumnName.toLowerCase()==o[0].CRSysColumnName.toString().toLowerCase());null!=e&&e instanceof r.b&&e.SelectedValue>0&&(s=this.Parent.ScreenObject.GetAccountByRef(parseInt(o[0].CrRefID.toString()),parseInt(o[0].CrRefColID.toString()),e.SelectedValue))}if(this.DtReportObj.TableColumns.Contains("DebitAccount")||this.DtReportObj.TableColumns.push("DebitAccount"),this.DtReportObj.TableColumns.Contains("CreditAccount")||this.DtReportObj.TableColumns.push("CreditAccount"),!(i>0))return t.IsValid=!1,this.DisplayMessage="DebitAccount not defined for "+this.DtReport[g].NameWithKey.toString(),this.MessageVisibility=!0,"";if(this.DtReport[g].DebitAccount=i,!(s>0))return t.IsValid=!1,this.DisplayMessage="Credit not defined for "+this.DtReport[g].NameWithKey.toString(),this.MessageVisibility=!0,"";this.DtReport[g].CreditAccount=s,a+=i+",",a+=s+","}a.length>1&&(a=a.Remove(0,a.length));let l=this.Parent.ScreenObject.CheckIsBillWise(a),h=1,S="";for(let r=0;r<this.DtReport.length;r++)"1"==m.e.StringValue(this.DtReport[r].PostJV)&&m.e.IsEmpty(this.DtReport[r].AmountActual)&&0!=parseFloat(this.DtReport[r].AmountActual.toString())&&(S+='<Row><Transactions   DocDetailsID="0"  DocSeqNo="'+h+'" Amount="'+this.DtReport[r].AmountActual.toString().Replace("-","")+'" ',S+=' AmtFc="'+this.DtReport[r].AmountActual.toString().Replace("-","")+'"  CurrencyID="1"  ExchangeRate="1" ',parseFloat(this.DtReport[r].AmountActual.toString())>0?S+='DebitAccount="'+this.DtReport[r].DebitAccount.toString()+'" CreditAccount="-99" ></Transactions> ':S+='CreditAccount="'+this.DtReport[r].DebitAccount.toString()+'" DebitAccount="-99" ></Transactions> ',S+=' <Numeric /> <Alpha /> <CostCenters  Query="'+n+'"  /> <EXTRAXML>',null!=l&&l.Tables.length>0&&l.Columns[0].Contains("AccountId")&&(o=l.Tables[0].filter(e=>e.AccountId==this.DtReport[r].DebitAccount.toString()),o.length>0&&"true"==o[0].IsBillwise.toString().toLowerCase()&&(S+='<BillWise> <Row DocSeqNo="'+h+'" AccountID="'+this.DtReport[r].DebitAccount.toString(),S+='" AmountFC="'+this.DtReport[r].AmountActual.toString()+'" AdjAmount="'+this.DtReport[r].AmountActual.toString()+'"',S+=' AdjCurrID="1" AdjExchRT="1" Narration=""  IsDocPDC="0" IsNewReference="1" ></Row></BillWise>')),S+="   </EXTRAXML>  </Row>",h++,S+='<Row><Transactions   DocDetailsID="0"  DocSeqNo="'+h+'" Amount="'+this.DtReport[r].AmountActual.toString().Replace("-","")+'" ',S+=' AmtFc="'+this.DtReport[r].AmountActual.toString().Replace("-","")+'"  CurrencyID="1"  ExchangeRate="1" ',parseFloat(this.DtReport[r].AmountActual.toString())>0?S+='DebitAccount="-99" CreditAccount="'+this.DtReport[r].CreditAccount.toString()+'" ></Transactions> ':S+='CreditAccount="-99" DebitAccount="'+this.DtReport[r].CreditAccount.toString()+'" ></Transactions> ',S+=' <Numeric /> <Alpha /> <CostCenters  Query="'+n+'"  /> <EXTRAXML>',null!=l&&l.Tables.length>0&&l.Columns[0].Contains("AccountId")&&(o=l.Tables[0].filter(e=>e.AccountId==this.DtReport[r].CreditAccount.toString()),o.length>0&&"true"==o[0].IsBillwise.toString().toLowerCase()&&(S+='<BillWise> <Row DocSeqNo="'+h+'" AccountID="'+this.DtReport[r].CreditAccount.toString(),S+='" AmountFC="-'+this.DtReport[r].AmountActual.toString()+'" AdjAmount="-'+this.DtReport[r].AmountActual.toString()+'"',S+=' AdjCurrID="1" AdjExchRT="1" Narration=""  IsDocPDC="0" IsNewReference="1" ></Row></BillWise>')),S+="   </EXTRAXML>  </Row>",h++);return S.length>0&&(S="<DocumentXML>"+S+"</DocumentXML>"),S.toString()}CloseSession(){let e,t,i="",s="";if(this.CloseType>0&&(s+="<XML>",this.DTPayModes.forEach(e=>{s+='<Row Type="'+m.e.String(e.Type),s+='" SysColName="'+m.e.String(e.SysColumnName),s+='" Name="'+m.e.String(e.Name),s+='" Amount="'+m.e.String(e.Amount)+'" />',"5"==e.Type.toString()&&0!=m.e.String(e.DenomXML).length&&(this.DenomXML=e.DenomXML.toString())}),s+="</XML>"),1==this.CloseType&&this.Parent.ScreenObject.Preferences.ContainsKey("PosJVOn")&&"1"==this.Parent.ScreenObject.Preferences.PosJVOn||2==this.CloseType&&this.Parent.ScreenObject.Preferences.ContainsKey("PosJVOn")&&"2"==this.Parent.ScreenObject.Preferences.PosJVOn){let t={IsValid:""};if(i=this.GetJVXML(!0,t),e=t.IsValid,!e)return this.Parent.DisplayMessage=this.DisplayMessage,this.Parent.MessageVisibility=!0,void g.a.page.HideDialog()}let n=this.Parent.ScreenObject.ShiftNodeID;5==this.CloseType&&this.Shift.Visible&&this.Shift.SelectedValue>0&&(n=this.Shift.SelectedValue),t=g.a.admin.POSLogin(this.Parent.ScreenObject.RegisterNodeID,n,this.Parent.DocumentDate,this.CloseType,this.DenomXML,i,s.toString()).obj,(t>0||-100==t)&&(this.DayClose.IsChecked&&this.DayClose.Visible?t=g.a.admin.POSLogin(this.Parent.ScreenObject.RegisterNodeID,n,this.Parent.DocumentDate,1,"","","").obj:-100==t&&(confirm("All shifts are closed.Closing the Day.")||g.a.admin.POSLogin(this.Parent.ScreenObject.RegisterNodeID,n,this.Parent.DocumentDate,1,"","","")),this.CloseType>0&&(this.Parent.ScreenObject.Preferences.ContainsKey("DonotConsiderOpeningInPaymode")&&""!=this.Parent.ScreenObject.Preferences.DonotConsiderOpeningInPaymode&&Object(D.j)(this.Parent.ScreenObject.Preferences.DonotConsiderOpeningInPaymode)&&(this.ExitGrid.SelectedItem=null,this.Denom=new S.AddDenominationViewModel(this,null),g.a.page.ShowDialog(this.Denom,d.AddDenominationComponent)),this.CallPrint(n)),g.a.page.HideDialog(),g.a.page.removeActiveTab())}AddDenom(){this.ExitGrid.SelectedItem.DenomXML=this.Denom.GetXML(),this.ExitGrid.SelectedItem.Amount=this.Denom.GetTotal(),g.a.page.HideDialog()}CallPrint(e){this.NewPrintCode(e)}ExportFile(e,t,i){this.DisplayMessage="Print"==e?"Printing data please wait...":"Exporting data please wait...";let s={};t.InitPrintOrExport(s),s.Type=e,s.PrintDataOnSeperatePageBy=g.a.SessionManager.Preferences.ContainsKey("PrintDataOnSeperatePageBy")?g.a.SessionManager.Preferences.PrintDataOnSeperatePageBy:"",s.DimensionFiltersKeys.Clear(),s.DimensionFiltersValues.Clear(),s.DimensionFiltersKeys.push(g.a.SessionManager.RegisterCCID),s.DimensionFiltersValues.push(this.Parent.ScreenObject.RegisterNodeID.toString()),g.a.SessionManager.Preferences.PosShifts.length>0&&parseInt(g.a.SessionManager.Preferences.PosShifts)>5e4&&(s.DimensionFiltersKeys.push(g.a.SessionManager.Preferences.PosShifts),s.DimensionFiltersValues.push(i.toString())),g.a.SessionManager.DivisionID>0&&(s.DimensionFiltersKeys.push(50001),s.DimensionFiltersValues.push(g.a.SessionManager.DivisionID.toString())),g.a.SessionManager.LocationID>0&&(s.DimensionFiltersKeys.push(50002),s.DimensionFiltersValues.push(g.a.SessionManager.LocationID.toString())),"PDF"==e?s.lst=[]:"Print"==e?(s.lst=[],s.Type="PDF"):"Excel"!=e&&"OpenXML"!=e||(s.lst=[]),s.al="al",g.a.report.ExportReport(t.Data,t.ReportColumns,s,"POSEXIT").subscribe(t=>{"Print"==e?g.a.SessionManager.printTab(t.FileName):(g.a.SessionManager.Download(t.FileName,"khasim"),m.e.IsEmpty(t.Message)&&!m.e.IsEmpty(t.FileName)&&(this.DisplayMessage="Exported Successfully"))},e=>{console.log(e)})}NewPrintCode(e){let t="<XML><Row ColID='FROMDATE' Value='"+this.Parent.DocumentDate.ToString("dd MMM yyyy")+"'/>";t+="<Row ColID='TODATE' Value='"+this.Parent.DocumentDate.ToString("dd MMM yyyy")+"'/>",t+="<Row ColID='"+g.a.SessionManager.RegisterCCID+"' Value='"+this.Parent.ScreenObject.RegisterNodeID+"'/>",g.a.SessionManager.Preferences.PosShifts.length>0&&parseInt(g.a.SessionManager.Preferences.PosShifts)>5e4&&e>0&&(t+="<Row ColID='"+g.a.SessionManager.Preferences.PosShifts+"' Value='"+e+"'/>"),t+="</XML>";let i=new b.ReportViewModel;return i.RecordCount="",i.PostFilterData=[],i.ReportSummaryData=[],i.ReportSummaryDataColumns=[],i.ReportViewModel_Document(50,t,190,!0,this,null),this.ExportFile("Print",i,e),""}GetReportDataTable(){let e=[];return this.ExitGrid.Table.forEach(t=>{let i={};i.RegID=this.Parent.ScreenObject.RegisterNodeID,i.RegName=this.Parent.ScreenObject.RegisterNodeID.toString(),i.Name=t.NameWithKey,i.StyleIsBold=t.StyleIsBold,i.Value=i[this.Parent.DocumentDate.ToString("ddMMMyyyy")]=t.Amount.toString(),e.push(i)}),e.length>0&&(e[0].CloseType=3==this.CloseType?"UserClose":2==this.CloseType?"ShiftClose":"DAY CLOSE"),e}OnPreviewKeyDown(e){if(this.IsPayMode)if(112==e.keyCode)this.IsPayMode&&(null!=this.ExitGrid.SelectedItem&&"5"==this.ExitGrid.SelectedItem.Type.toString()?(this.Denom=new S.AddDenominationViewModel(this,this.ExitGrid.SelectedItem.DenomXML.toString()),g.a.page.ShowDialog(this.Denom,d.AddDenominationComponent)):this.ExitGrid.Table.forEach(e=>{"5"==e.Type.toString()&&(this.ExitGrid.SelectedItem=e,this.Denom=new S.AddDenominationViewModel(this,this.ExitGrid.SelectedItem.DenomXML.toString()),g.a.page.ShowDialog(this.Denom,d.AddDenominationComponent))}));else if(e.keyCode>=91&&e.keyCode<=101){let t=e.keyCode-91;t<this.ExitGrid.Table.length&&(this.ExitGrid.ColumnNo=1,this.ExitGrid.LineNo=t+1,this.ExitGrid.SetFocusongrid=!0)}}}}}]);