(window.webpackJsonp=window.webpackJsonp||[]).push([[156,75,77,89,113,121,141,148,150,160,210,212],{EggS:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var a=s("Do2H"),i=s("Lp6j"),o=s("eQJW");class r{constructor(){this.CustomerID=0,this.CustomerTypeID=0,this.StatusID=0,this.AccountID=0,this.ParentID=0,this.SelectedNodeID=0,this.CodeNumber=0,this.IsGroup=!1,this.CreditDays=0,this.CreditLimit=0,this.DebitDays=0,this.Debitlimit=0,this.IsCode=!1,this.ActivityXml="",this.CCXML=""}SaveCustomerQuick(){try{let e=[];return e.push(this.CustomerID),e.push(null!=this.CustomerCode?this.CustomerCode:""),e.push(null!=this.CustomerName?this.CustomerName:""),e.push(this.StatusID),e.push(this.CodePrefix),e.push(this.CodeNumber),e.push(this.StaticFieldsQuery),e.push(this.CustomFieldsQuery),e.push(this.CustomCostCenterFieldsQuery),e.push(a.a.SessionManager.CompanyGUID),e.push(this.GUID),e.push(""),e.push(a.a.SessionManager.UserName),e.push(a.a.SessionManager.RoleID),e.push(a.a.SessionManager.LanguageID),a.a.crmService.SetCustomerQuick(e)}catch(e){return Logger.ErrorLog("Account:: SaveAccountQuick"+e.stack),""}}SaveCustomer(){Logger.InfoLog("Customer:: Inside SaveCustomer");try{0==this.CustomerID&&(this.GUID=i.e.NewGuid());let e=[];return e.push(this.CustomerID),e.push(null!=this.CustomerCode?this.CustomerCode:""),e.push(null!=this.CustomerName?this.CustomerName:""),e.push(null!=this.AliasName?this.AliasName:""),e.push(this.CustomerTypeID),e.push(this.StatusID),e.push(this.AccountID),e.push(this.SelectedNodeID),e.push(this.IsGroup),e.push(this.CreditDays),e.push(this.CreditLimit),e.push(null!=this.UserName?this.UserName:""),e.push(null!=this.Password?this.Password:""),e.push(null!=this.OnlineCustType?this.OnlineCustType:""),e.push(a.a.SessionManager.CompanyGUID),e.push(null!=this.GUID?this.GUID:"GUID"),e.push(""),e.push(a.a.SessionManager.UserName),e.push(this.CustomFieldsQuery),e.push(this.CustomCostCenterFieldsQuery),e.push(this.ContactsXML),e.push(this.AttachmetsXML),e.push(this.NotesXML),e.push(this.AddressXML),e.push(this.ActivityXml),e.push(this.CCXML),e.push(!1),e.push(null==this.PrimaryContactQuery?"":this.PrimaryContactQuery),e.push(a.a.SessionManager.RoleID),e.push(a.a.SessionManager.LanguageID),e.push(null!=this.CodePrefix?this.CodePrefix:""),e.push(this.CodeNumber),e.push(this.IsCode),a.a.crmService.SaveCustomer(e)}catch(e){return Logger.ErrorLog("Customer:: SaveCustomer"+e.stack),""}}GetCustomerDetails(){let e=a.a.crmService.GetCustomerInfo("?UserID="+a.a.SessionManager.UserID+"&RoleID="+a.a.SessionManager.RoleID+"&LangID="+a.a.SessionManager.LangID+"&CustomerID="+this.CustomerID);return!e.Columns[0].Contains("ErrorMessage")&&e.Tables.length>0&&e.Tables[0].length>0&&(this.CustomerID=parseInt(e.Tables[0][0].CustomerID),this.CustomerCode=i.e.String(e.Tables[0][0].CustomerCode),this.CustomerName=i.e.String(e.Tables[0][0].CustomerName),this.AliasName=i.e.String(e.Tables[0][0].AliasName),i.e.IsEmpty(e.Tables[0][0].CustomerTypeID)||(this.CustomerTypeID=parseInt(e.Tables[0][0].CustomerTypeID)),this.StatusID=parseInt(e.Tables[0][0].StatusID),i.e.IsEmpty(e.Tables[0][0].AccountID)||(this.AccountID=parseInt(e.Tables[0][0].AccountID)),this.IsGroup=Object(o.j)(e.Tables[0][0].IsGroup),i.e.IsEmpty(e.Tables[0][0].CreditDays)||(this.CreditDays=parseInt(e.Tables[0][0].CreditDays)),i.e.IsEmpty(e.Tables[0][0].CreditLimit)||(this.CreditLimit=parseFloat(e.Tables[0][0].CreditLimit)),this.ParentID=parseInt(e.Tables[0][0].ParentID),this.GUID=i.e.String(e.Tables[0][0].GUID),this.Description=i.e.String(e.Tables[0][0].Description),this.CodePrefix=i.e.String(e.Tables[0][0].CodePrefix),this.UserName=i.e.String(e.Tables[0][0].UserName),this.OnlineCustType=i.e.String(e.Tables[0][0].OnlineCustType),this.Password=i.e.String(e.Tables[0][0].Password),i.e.IsEmpty(e.Tables[0][0].CodeNumber)||(this.CodeNumber=parseInt(e.Tables[0][0].CodeNumber))),e}DeleteCustomer(e,t){try{let s=[];return s.push(e),s.push(t),s.push(a.a.SessionManager.RoleID),s.push(a.a.SessionManager.LanguageID),Logger.InfoLog("Customer:: Success: DBH.DeleteCustomer "+e.toString()),a.a.crmService.RemoveCustomer(s)}catch(s){return Logger.ErrorLog("LEAD::DeleteLead"+s.stack),""}}}},NM0h:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var a=s("Do2H"),i=s("Lp6j");class o{constructor(){this.ChangeValueXML=null,this.DetailsXML=null,this.AMCode=null,this.AMName=null,this.AMPurchaseValue=null,this.HistoryXML=null,this.DocNo=null,this.XML=null,this.DocSave=null,this.CodePrefix=null,this.Sno=null,this.AssetClassID=0,this.DeprBookID=0,this.AcqnCostACCID=0,this.AccumDeprACCID=0,this.AcqnCostDispACCID=0,this.AccumDeprDispACCID=0,this.GainsDispACCID=0,this.LossDispACCID=0,this.MaintExpenseACCID=0,this.DeprExpenseACCID=0,this.PostingGroupID=0,this.AMStatusID=0,this.CodeNumber=0,this.AMAssetID=0,this.AMParentAssetID=0,this.IsGroup=!1,this.Post=!1,this.StatusID=0,this.DeprBookMethod=0,this.DeprBookMethodBasedOn=0,this.AveragingMethodID=0,this.DeprScheduleID=0,this.DeprTypeID=0,this.AssetClassCode=null,this.AssetClassName=null,this.GUID=null,this.DeprBookCode=null,this.DeprBookName=null,this.PostGroupCode=null,this.PostGroupName=null,this.AMGUID=null,this.RecordType=null,this.AMGroup=!1,this.IsIncreaseAssetValue=!1,this.EmpName=null,this.EmpCode=null,this.EmpID=0,this.SelectedNodeID=0,this.PostCCID=0,this.PostAssetID=0,this.ScheduleID=0,this.LocationID=0,this.AddressXML=null,this.NotesXML=null,this.ContactsXML=null,this.CustomCostCenterFieldsQuery=null,this.CustomFieldsQuery=null,this.PrimaryContactQuery=null,this.AttachmetsXML=null,this.DepreciationXML=null,this.JVXML=null,this.Description=null,this.DeprStartValue=0,this.ChangeVal=0,this.AssetNetValueChange=0,this.DeprBookMethodBasedOnValue=0,this.TotalYears=0}static GetAssetClassDetails(e){let t=[];return t.push(e),t.push(a.a.SessionManager.UserID),t.push(a.a.SessionManager.LanguageID),a.a.accounting.GetAssetClassDetails(t)}static GetPostingGroupDetails(e){let t=[];return t.push(e),t.push(a.a.SessionManager.UserID),t.push(a.a.SessionManager.LanguageID),a.a.accounting.GetPostingGroupDetails(t)}SaveAssetClass(){0==this.AssetClassID&&(this.GUID=i.e.NewGuid());let e=[];return e.push(this.AssetClassID),e.push(null!=this.AssetClassCode?this.AssetClassCode:""),e.push(null!=this.AssetClassName?this.AssetClassName:""),e.push(this.PostingGroupID),e.push(this.DeprBookID),e.push(this.DeprTypeID),e.push(this.TotalYears),e.push(this.StatusID),e.push(a.a.SessionManager.CompanyGUID),e.push(this.GUID),e.push(""),e.push(a.a.SessionManager.UserName),e.push(a.a.SessionManager.UserID),e.push(a.a.SessionManager.LanguageID),a.a.accounting.SetAssetClass(e)}static GetDeprBookDetails(e){let t=[];return t.push(e),t.push(a.a.SessionManager.UserID),t.push(a.a.SessionManager.LanguageID),a.a.accounting.GetDeprBookDetails(t)}PostJVvoucher(){this.GUID=i.e.NewGuid();let e=[];return e.push(this.PostAssetID),e.push(this.PostCCID),e.push(this.JVXML),e.push(this.Post),e.push(this.DeprTypeID),e.push(this.DocXML),e.push(this.DocSave),e.push(this.DepreciationXML),e.push(this.RecordType),e.push(a.a.SessionManager.CompanyGUID),e.push(this.GUID),e.push(a.a.SessionManager.UserName),e.push(a.a.SessionManager.UserID),e.push(a.a.SessionManager.LanguageID),a.a.accounting.GetPostJvVoucher(e)}SetAssetDispose(e){this.GUID=i.e.NewGuid();let t=[];return t.push(this.PostAssetID),t.push(e.ToString("dd/MMM/yyyy")),t.push(this.PostCCID),t.push(this.JVXML),t.push(this.Post),t.push(this.DeprTypeID),t.push(this.DocXML),t.push(this.DocSave),t.push(this.DepreciationXML),t.push(this.RecordType),t.push(a.a.SessionManager.CompanyGUID),t.push(this.GUID),t.push(a.a.SessionManager.UserName),t.push(a.a.SessionManager.UserID),t.push(a.a.SessionManager.LanguageID),a.a.accounting.SetAssetDispose(t)}SaveDeprBook(e,t,s){0==this.DeprBookID&&(this.GUID=i.e.NewGuid());let o=[];return o.push(this.DeprBookID),o.push(this.DeprBookCode),o.push(this.DeprBookName),o.push(this.DeprBookMethod),o.push(this.DeprBookMethodBasedOn),o.push(this.DeprBookMethodBasedOnValue),o.push(this.StatusID),o.push(this.AveragingMethodID),o.push(e),o.push(t),o.push(s),o.push(a.a.SessionManager.CompanyGUID),o.push(this.GUID),o.push(""),o.push(a.a.SessionManager.UserName),o.push(a.a.SessionManager.UserID),o.push(a.a.SessionManager.LanguageID),a.a.accounting.SetDeprBook(o)}SaveFAPostingGroup(){0==this.PostingGroupID&&(this.GUID=i.e.NewGuid());let e=[];return e.push(this.PostingGroupID),e.push(this.PostGroupCode),e.push(this.PostGroupName),e.push(this.AcqnCostACCID),e.push(this.AccumDeprACCID),e.push(this.AcqnCostDispACCID),e.push(this.AccumDeprDispACCID),e.push(this.GainsDispACCID),e.push(this.LossDispACCID),e.push(this.MaintExpenseACCID),e.push(this.DeprExpenseACCID),e.push(this.StatusID),e.push(0),e.push(this.IsGroup),e.push(a.a.SessionManager.CompanyGUID),e.push(this.GUID),e.push(a.a.SessionManager.UserName),e.push(a.a.SessionManager.UserID),e.push(a.a.SessionManager.LanguageID),a.a.accounting.SetPostingGroup(e)}static GetAssetManagementDetails(e){let t=[];return t.push(e),t.push(a.a.SessionManager.UserID),t.push(a.a.SessionManager.LanguageID),a.a.accounting.GetAssetManagementDetails(t)}static GetAssetDeprSchDetails(e){let t=[];return t.push(e),t.push(a.a.SessionManager.UserID),t.push(a.a.SessionManager.LanguageID),a.a.accounting.GetAssetDeprSchDetails(t)}SetAssetManagementDetails(){let e=[];return e.push(this.AMAssetID),e.push(this.AMCode),e.push(this.AMName),e.push(this.AMStatusID),e.push(this.AMPurchaseValue),e.push(this.AMParentAssetID),e.push(this.AMGroup),e.push(this.CodePrefix),e.push(this.CodeNumber),e.push(this.Sno),e.push(this.DetailsXML),e.push(this.ChangeValueXML),e.push(this.CustomFieldsQuery),e.push(this.CustomCostCenterFieldsQuery),e.push(this.DepreciationXML),e.push(this.HistoryXML),e.push(this.NotesXML),e.push(this.AttachmetsXML),e.push(a.a.SessionManager.CompanyGUID),e.push(this.AMGUID),e.push(a.a.SessionManager.UserName),e.push(a.a.SessionManager.UserID),e.push(a.a.SessionManager.LanguageID),a.a.accounting.SetAssetManagementDetails(e).toPromise()}static DeleteAsset(e){let t=[];return t.push(e),t.push(a.a.SessionManager.UserID),t.push(a.a.SessionManager.RoleID),a.a.accounting.DeleteAsset(t)}static DeleteAssetDeprSchedule(e){let t=[];return t.push(e),t.push(a.a.SessionManager.RoleID),t.push(a.a.SessionManager.LanguageID),a.a.accounting.DeleteAssetDeprSchedule(t)}static DeleteAssetRefDoc(e,t){let s=[];return s.push(e),s.push(t),s.push(a.a.SessionManager.UserID),a.a.accounting.DeleteAssetRefDoc(s)}PostDeprJV(){this.GUID=i.e.NewGuid();let e=[];return e.push(this.PostCCID),e.push(this.JVXML),e.push(this.Post),e.push(a.a.SessionManager.CompanyGUID),e.push(this.GUID),e.push(a.a.SessionManager.UserName),e.push(a.a.SessionManager.UserID),e.push(a.a.SessionManager.LanguageID),e.push(a.a.SessionManager.RoleID),a.a.accounting.PostDeprJV(e)}PostDeprJVSummary(e,t,s,o,r){this.GUID=i.e.NewGuid();let n=[];return n.push(e),n.push(t),n.push(s),n.push(o),n.push(r),n.push(a.a.SessionManager.CompanyGUID),n.push(a.a.SessionManager.UserName),n.push(a.a.SessionManager.UserID),n.push(a.a.SessionManager.LanguageID),a.a.accounting.SetDeprPostingJVSummary(n).toPromise()}static SetsPostDeprReverseJV(e,t,s){let i=[];return i.push(e),i.push(t),i.push(s),i.push(a.a.SessionManager.CompanyGUID),i.push(a.a.SessionManager.UserName),i.push(a.a.SessionManager.UserID),i.push(a.a.SessionManager.LanguageID),a.a.accounting.SetsPostDeprReverseJV(i)}ChangeValue(e,t){this.GUID=i.e.NewGuid();let s=[];return s.push(this.PostAssetID),s.push(e),s.push(this.ChangeVal),s.push(this.AssetNetValueChange),s.push(t.ToString("dd/MMM/yyyy")),s.push(this.Description),s.push(this.DepreciationXML),s.push(this.ChangeValueXML),s.push(this.HistoryXML),s.push(this.LocationID),s.push(this.IsIncreaseAssetValue),s.push(this.JVXML),s.push(this.ChangeValueTypeID),s.push(a.a.SessionManager.CompanyGUID),s.push(this.GUID),s.push(a.a.SessionManager.UserName),s.push(a.a.SessionManager.UserID),s.push(a.a.SessionManager.LanguageID),a.a.accounting.SetAssetChangeValue(s)}DisposeReverse(e){let t=[];return t.push(e),t.push(a.a.SessionManager.UserName),t.push(a.a.SessionManager.UserID),t.push(a.a.SessionManager.LanguageID),a.a.accounting.DisposeReverse(t)}}},ouML:function(e,t,s){"use strict";s.r(t),s.d(t,"DocumentDraftsViewModel",(function(){return c}));var a=s("mrSG"),i=s("Do2H"),o=s("Lp6j"),r=s("ScVY"),n=s("8B8H"),h=s("ockk"),l=s("rJVx"),u=s("CUWK");class c extends r.b{constructor(e,t,s=0){if(super(),this.Grid=new n.a,this.IsFromDocs=!1,this.PopupWidth=0,this.ReportType=0,this.Parent=null,this.CCID=0,this.WID=0,this.LevelID=0,this.PactGridVisible=!1,this.CCID=s,this.Parent=e,this.ReportType=t,this.Parent instanceof l.GeneralDashboardViewModel||"DashAddOnsViewModel"==this.Parent.ClassName)1==t&&(this.ColSource=l.GeneralDashboardViewModel.InitColumns("Document Drafts_DashBoardCustomize"));else{let e;1==t?this.DisplayName="Drafts":2==t?this.DisplayName="Hold Documents":3==t?this.DisplayName="Approval History":4==t&&(this.DisplayName="Level Info",this.PactGrid=new n.a),this.Title=this.DisplayName,this.IsFromDocs=!0,this.FillGrid(),this.Grid.OnLinkClick.Subscribe(this,"GridLinkClick"),this.ColSource=[],1==t?(this.ColSource=l.GeneralDashboardViewModel.InitColumns("Document Drafts_DashBoardCustomize"),this.PopupWidth=22,this.ColSource.forEach(e=>{this.PopupWidth=this.PopupWidth+e.Width})):2==t?(e=new h.a,e.DataType="TextBlock",e.Header="Hold Date",e.DisplayMember="HoldDate_Key",e.Width=100,this.ColSource.push(e),e=new h.a,e.DataType="LINK",e.Header=i.a.GetResource("DocName"),e.DisplayMember="DocName",e.Width=135,this.ColSource.push(e),e=new h.a,e.DataType="TextBlock",e.Header="NetValue",e.DisplayMember="NetValue",e.Width=100,this.ColSource.push(e),e=new h.a,e.DataType="TextBlock",e.Header="NoOfProducts",e.DisplayMember="NoOfProducts",e.Width=50,this.ColSource.push(e),e=new h.a,e.DataType="LINK",e.Header=i.a.GetResource("Delete"),e.DisplayMember="Delete",e.Width=100,this.ColSource.push(e),this.PopupWidth=450):3==t?(e=new h.a,e.DataType="TextBlock",e.Header="User",e.DisplayMember="CreatedBy",e.Width=90,this.ColSource.push(e),e=new h.a,e.DataType="TextBlock",e.Header="FirstName",e.DisplayMember="FirstName",e.Width=90,this.ColSource.push(e),e=new h.a,e.DataType="TextBlock",e.Header="LastName",e.DisplayMember="LastName",e.Width=90,this.ColSource.push(e),e=new h.a,e.DataType="TextBlock",e.Header="Email",e.DisplayMember="Email1",e.Width=150,this.ColSource.push(e),e=new h.a,e.DataType="TextBlock",e.Header=i.a.GetResource("Date"),e.DisplayMember="AppDate",e.Width=128,this.ColSource.push(e),e=new h.a,e.DataType="LINK",e.Header="Level",e.DisplayMember="LevelName",e.Width=93,this.ColSource.push(e),e=new h.a,e.DataType="TextBlock",e.Header="Status",e.DisplayMember="Status",e.Width=80,this.ColSource.push(e),e=new h.a,e.DataType="Format",e.Header="Remarks",e.DisplayMember="Remarks",e.Width=190,this.ColSource.push(e),this.PopupWidth=950,"AddEditDocumentViewModel"==this.Parent.ClassName&&(e=new h.a,e.Header="WorkFlowName",e.DisplayMember="WorkFlowName",e.Width=200,this.ColSource.push(e)),this.PopupWidth=950):4==t&&(e=new h.a,e.DataType="TextBlock",e.ReadOnly=!0,e.Header="User Name",e.DisplayMember="UserName",e.Width=120,this.ColSource.push(e),e=new h.a,e.DataType="TextBlock",e.ReadOnly=!0,e.Header="First Name",e.DisplayMember="FirstName",e.Width=120,this.ColSource.push(e),e=new h.a,e.DataType="TextBlock",e.ReadOnly=!0,e.Header="Last Name",e.DisplayMember="LastName",e.Width=120,this.ColSource.push(e),this.PactGrid.Columns=this.ColSource,this.PopupWidth=400)}}get Table(){return this.Grid.Table}set Table(e){this.Grid.Table=e}get TableColumns(){return this.Grid.TableColumns}set TableColumns(e){this.Grid.TableColumns=e}get ColSource(){return this.Grid.Columns}set ColSource(e){this.Grid.Columns=e}get SelectedRow(){return this.Grid.SelectedItem}set SelectedRow(e){this.Grid.SelectedItem=e}onClick(e){event.preventDefault(),null!=this.SelectedRow&&this.LoadDraft(this.SelectedRow)}FillGrid(){let e=0,t=null;if(o.e.IsType(this.Parent,"AddEditDocumentViewModel")?(t=this.Parent,e=0==this.CCID?t.CostCenterID:this.CCID):o.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName||(e=this.CCID),1==this.ReportType||2==this.ReportType){let s;s=o.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName?null==t||38!=t.ScreenObject.DocumentType&&39!=t.ScreenObject.DocumentType?i.a.document.GetDocumentDrafts(0,e,this.ReportType,!1):i.a.document.GetDocumentDrafts(t.ScreenObject.RegisterNodeID,e,this.ReportType,!1,!0):i.a.document.GetDocumentDrafts(0,this.Parent.CostCenterID,this.ReportType,!1),s.subscribe(e=>{this.Table=e.Tables[0],this.Grid.TableColumns.Contains("Date_Text")||(this.Grid.TableColumns.push("Date_Text"),this.Grid.TableColumns.push("Delete")),this.Grid.TableColumns.Contains("HoldDate_Key")||this.Grid.TableColumns.push("HoldDate_Key"),this.Table.forEach(e=>{e.Delete="Delete",e.id=i.a.slick.rowid,e.Date_Text=new Date(e.Date).ToString(i.a.SessionManager.Preferences["Date Format"]+" hh:mm a"),null!=e.HoldDate&&(e.HoldDate_Key=new Date(e.HoldDate).ToString(i.a.SessionManager.Preferences["Date Format"]))})})}else if(3==this.ReportType){let t=null;if(o.e.IsType(this.Parent,"AddEditDocumentViewModel")?(t=this.Parent.ScreenObject.GetDocStatusHistory(),t.Tables.length>1&&t.Tables[1].length>0&&t.Columns[1].Contains("WID")&&(this.WID=parseInt(t.Tables[1][0].WID))):o.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName?o.e.IsEmpty(this.Parent.ClassName)||"AddEditCasesViewModel"!=this.Parent.ClassName||(t=this.GetDocStatusHistory(73,this.Parent.CaseID,!1)):t=i.a.rental.GetHistory(e,this.Parent.ContractID),null!=t&&t.Tables.length>0){this.Table=t.Tables[0],this.Grid.TableColumns.push("AppDate");for(let t=0;t<this.Table.length;t++)""!=this.Table[t].Date.toString()&&(this.Table[t].AppDate=new Date(this.Table[t].Date.toString()).ToString(i.a.SessionManager.Preferences["Date Format"]+" hh:mm a"));let e=0,s=0;this.Table.length>0&&(e=o.e.IntTryParse(this.Table[this.Table.length-1].WorkFlowLevel.toString()),s=o.e.IntTryParse(this.Table[this.Table.length-1].StatusID.toString())),369!=s&&(t.Tables[1]=t.Tables[1].filter(t=>t.levelID>e),t.Tables[1].forEach(e=>{let t=this.Grid.NewRow();t.LevelName=e.LevelName,t.Status="Pending",t.WorkFlowLevel=e.LevelID,this.Grid.addRow(t)}));for(let t=this.Table.length;t<7;t++)this.Grid.addEmptyRow()}}else if(4==this.ReportType){let e=null;if("WFLevelDoc"==this.Parent.ClassName?e=i.a.SessionManager.Preferences.ContainsKey("CanApproveFunction")&&"True"==i.a.SessionManager.Preferences.CanApproveFunction?i.a.report.GetExtWFDet(this.Parent.WID,this.Parent.LevelID,this.Parent.ccid,this.Parent.DOcId):i.a.report.GetWorkFlowLevelDetails(this.Parent.WID,this.Parent.LevelID,this.Parent.ccDate):this.Parent instanceof c&&(i.a.SessionManager.Preferences.ContainsKey("CanApproveFunction")&&"True"==i.a.SessionManager.Preferences.CanApproveFunction?"AddEditDocumentViewModel"==this.Parent.Parent.ClassName?e=i.a.report.GetExtWFDet(this.Parent.WID,this.Parent.LevelID,this.Parent.Parent.CostCenterID,this.Parent.Parent.ScreenObject.DocID):"ReportViewModel"==this.Parent.Parent.ClassName&&"INV_ComparisonReport"==this.Parent.Parent.StaticReportObject&&(e=i.a.report.GetExtWFDet(this.Parent.WID,this.Parent.LevelID,this.Parent.Parent.StaticReportObject.QuotationDocument,this.Parent.Parent.StatusDocID)):e=i.a.report.GetWorkFlowLevelDetails(this.Parent.WID,this.Parent.LevelID,"AddEditDocumentViewModel"==this.Parent.Parent.ClassName?this.Parent.Parent.ScreenObject.DocDate.Date:Date.Today())),null!=e){for(let t=e.Tables[0].length;t<8;t++)e.Tables[0].push();this.PactGrid.Table=e.Tables[0]}this.PactGrid.Width="",this.PactGrid.SearchVisible=!0,this.PactGrid.SearchCols.Width="85",this.PactGrid.SearchOptions.Width="90",this.PactGrid.SearchText.Width="110",this.PactGridVisible=!0}}GetDocStatusHistory(e,t,s){Logger.InfoLog("DocumentDraftsViewModel:: Inside GetDocStatusHistory");let a=[];a.push(e),a.push(t),a.push(s),a.push(i.a.SessionManager.UserID),a.push(i.a.SessionManager.LanguageID);let o=i.a.document.GetDocStatusHistory(a);return Logger.InfoLog("DocumentDraftsViewModel:: Exiting GetDocStatusHistory"),o}OnButtonClick(e){"Cancel"==e.toString()&&(o.e.IsType(this.Parent,"AddEditDocumentViewModel")&&this.CCID>0&&(this.Parent.res="No"),i.a.page.HideDialog())}DeleteDraft(e){let t;t=o.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName?i.a.document.DeleteDocumentDraft(parseInt(e.DraftID)):i.a.rental.DeleteQuotation(parseInt(e.CostCenterID),parseInt(e.DraftID)),t.RetValue>0&&this.Grid.removeRow(e)}LoadDraft(e){return Object(a.b)(this,void 0,void 0,(function*(){if(o.e.IsEmpty(this.Parent.ClassName)||"AddEditRenContractViewModel"!=this.Parent.ClassName){const{AddEditDocumentViewModel:t}=yield Promise.all([s.e(2),s.e(1),s.e(3),s.e(5),s.e(4),s.e(6),s.e(7),s.e(10),s.e(9),s.e(12),s.e(11),s.e(13),s.e(19),s.e(15),s.e(21),s.e(20),s.e(16),s.e(14),s.e(18),s.e(17),s.e(22),s.e(89)]).then(s.bind(null,"1Cra")),{AddEditDocumentComponent:a}=yield Promise.all([s.e(4),s.e(6)]).then(s.bind(null,"MCKn"));let o,r;r=i.a.document.GetDocumentDrafts(parseInt(e.DraftID),0,1,!1),r.subscribe(s=>{if(o=s.Tables[0],null!=o&&o.length>0)if("AddEditDocumentViewModel"==this.Parent.ClassName||"POSDocumentViewModel"==this.Parent.ClassName)this.CCID>0||(this.Parent.clear(1),this.Parent.LoadDraftXML(o[0]),i.a.page.HideDialog(),this.Parent.ScreenObject.GridDataObj.RefreshGridView());else{let s=1==this.ReportType,r=new t(parseInt(e.CostCenterID),e.Type.toString(),s);i.a.page.addNewTab({component:a,params:{obj:r}}),r.LoadDraftXML(o[0],s)}})}else u.RibbonExtViewModel.LoadDraftRentalContract(this.Parent,parseInt(e.DraftID)),i.a.page.HideDialog()}))}GridLinkClick(e,t,s){event.preventDefault(),"Delete"==t?this.DeleteDraft(e):"Date_Text"!=t&&"DocName"!=t||this.LoadDraft(e)}}},rJVx:function(e,t,s){"use strict";s.r(t),s.d(t,"GeneralDashboardViewModel",(function(){return u}));var a=s("mrSG"),i=s("Do2H"),o=s("Lp6j"),r=s("ScVY"),n=s("NkMH"),h=s("ockk"),l=s("JIg3");class u extends r.b{constructor(){super(),this.ButtonPDC=new n.a,this.timerdashboard=new o.d,this.Date=new l.a(0),this.tdMaximize=new Array(4).fill(!1),Logger.InfoLog("DashboardViewModel::Entering DashboardViewModel"),this.timerdashboard.Enabled=!0,this.timerdashboard.Interval=6e4,i.a.SessionManager.IsWebApplication||this.timerdashboard.Elapsed(this,"timerdashboard_Elapsed"),this.DisplayName=i.a.GetResource("Dashboard_Maindashboard"),this.loadDrafts(),Logger.InfoLog("DashboardViewModel::Exiting DashboardViewModel")}loadDrafts(){return Object(a.b)(this,void 0,void 0,(function*(){const{DocumentDraftsViewModel:e}=yield s.e(150).then(s.bind(null,"ouML"));this.DocumentDrafts=new e(this,1),setTimeout(()=>{this.DocumentDrafts.FillGrid()},500);const{UnAppDocumentsViewModel:t}=yield s.e(0).then(s.bind(null,"AyOk"));this.UnApprovedDocuments=new t;const{DashBoardNotifViewModel:a}=yield Promise.all([s.e(2),s.e(1),s.e(5),s.e(26),s.e(42),s.e(0),s.e(73)]).then(s.bind(null,"Wh9R"));this.NotifEvents=new a(2),this.PDCDocuments=new a(4)}))}timerdashboard_Elapsed(e,t){i.a.page.isActiveTab(this)&&(this.OnButtonClick("RefreshPDC"),this.OnButtonClick("RefreshEvents"),this.NotifEvents.RefreshData(),this.UnApprovedDocuments.OnLoad())}OnButtonClick(e){"PostPDC"==e||("RefreshPDC"==e?(this.PDCDocuments.EventsType=4,this.PDCDocuments.InitColumns()):"PostEvents"==e||("RefreshEvents"==e?this.NotifEvents.RefreshData():"UnApproved"==e?this.UnApprovedDocuments.OnLoad():"Drafts"==e&&this.DocumentDrafts.FillGrid()))}OnMessageCallBack(){this.res="Yes"}static InitColumns(e){let t,s="",a=[];if(i.a.SessionManager.Preferences.ContainsKey(e)&&(s=i.a.SessionManager.Preferences[e]),s.length>0){let r=new o.f;r.LoadXml(s);for(let s=0;s<r.DocumentElement.children.length;s++){let o=r.DocumentElement.children[s];t=new h.a,t.Header=i.a.GetResource(o.attributes.Header.value),t.DisplayMember=o.attributes.ID.value,t.ReadOnly=!0,t.Width=parseInt(o.attributes.Width.value),a.push(t),"Un Approved Documents_DashBoardCustomize"==e?"VoucherNo"==t.DisplayMember?t.DataType="LINK":"Amount"==t.DisplayMember&&(t.DataType="FLOAT",t.DecimalPoints=i.a.SessionManager.Preferences.DecimalsinAmount.toString()):"Document Drafts_DashBoardCustomize"==e?"Date_Text"!=t.DisplayMember&&"Delete"!=t.DisplayMember||(t.DataType="LINK"):"Post Dated Documents_DashBoardCustomize"==e?"VoucherNo"==t.DisplayMember?t.DataType="LINK":"Amount"==t.DisplayMember&&(t.DataType="FLOAT",t.DecimalPoints=i.a.SessionManager.Preferences.DecimalsinAmount.toString()):"Notification Events_DashBoardCustomize"==e&&"VoucherNo"==t.DisplayMember&&(t.DataType="LINK")}}return a}static IsActionAssigned(e,t){return i.a.SessionManager.IsActionAssigned(e,t)}}},s4nK:function(e,t,s){"use strict";s.r(t),s.d(t,"GenerateBillsViewModel",(function(){return g}));var a=s("mrSG"),i=s("Do2H"),o=s("Lp6j"),r=s("eQJW"),n=s("ScVY"),h=s("0/4Q"),l=s("EQd/"),u=s("n56n"),c=s("JIg3"),D=s("8B8H"),d=s("ockk"),p=s("PDNK"),m=s("wlFP"),C=s("1Cra");class g extends n.b{constructor(e){super(),this.InProgress="",this.ProgressMessage="",this.ProgressValue=0,this.ProgressWidth=0,this.ProgressMax=0,this.BasedOn=new h.e(0),this.Status=new h.e(0),this.Customer=new u.b(0),this.From=new l.d(0),this.TO=new l.d(0),this.FromDate=new c.a(0),this.ToDate=new c.a(0),this.InvoiceDate=new c.a(0),this.TillDate=new c.a(0),this._SelectAll=!1,this.chkSelectAll=new m.a,this.VoucherWise=!1,this.DateWise=!1,this.rdoVoucherWise=new p.a("",0,"Doc"),this.rdoDateWise=new p.a("",0,"Doc"),this.dtpref=null,this.ShowProcessDialog=!1,this.DisplayName=e,this.FromDate.Label=i.a.GetResource("DocumentDesigner_FromDate"),this.Customer.Label="Customer",this.Customer.CCID=2,this.Customer.TypeID=2,this.ToDate.Label=i.a.GetResource("DocumentDesigner_ToDate"),this.BasedOn.Label="Post Bills",this.Status.Label="Show Contracts",this.BasedOn.Items.push(h.d.ComboBoxItems_2("Contract based","0")),this.BasedOn.Items.push(h.d.ComboBoxItems_2("Customer based","1")),this.Status.Items.push(h.d.ComboBoxItems_2("Both","0")),this.Status.Items.push(h.d.ComboBoxItems_2("Pending","1")),this.Status.Items.push(h.d.ComboBoxItems_2("Invoiced","2")),this.BasedOn.SelectedValue="0",this.Status.SelectedValue="1",this.InvoiceDate.Label="Invoice Date",this.VoucherWise=!1,this.DateWise=!0,this.From.Label="From",this.TO.Label="To",this.TillDate.Label="Till Date",this.LoadGrid(),this.rdoVoucherWise.Label=i.a.GetResource("Com_HCNoWise"),this.rdoVoucherWise.CheckedChangedCommand.Subscribe(this,"onVoucherWiseCheck"),this.rdoDateWise.Label=i.a.GetResource("Com_DateWise"),this.rdoDateWise.CheckedChangedCommand.Subscribe(this,"onDateWiseCheck"),this.chkSelectAll.Label=i.a.GetResource("Selectall"),this.chkSelectAll.CheckedChangedCommand.Subscribe(this,"onSelectall"),this.ProgressWidth=1}get SelectAll(){return this._SelectAll}set SelectAll(e){e!=this._SelectAll&&(this._SelectAll=e,this.SelectUnselectAll(e))}onSelectall(e){this.SelectAll=e.IsChecked}onVoucherWiseCheck(e){this.VoucherWise=e.IsChecked,this.DateWise=!1,this.rdoDateWise.IsChecked=!1,this.FromDate.Enable=!1,this.ToDate.Enable=!1,this.From.Enable=!0,this.TO.Enable=!0}onDateWiseCheck(e){this.DateWise=e.IsChecked,this.VoucherWise=!1,this.rdoVoucherWise.IsChecked=!1,this.FromDate.Enable=!0,this.ToDate.Enable=!0,this.From.Enable=!1,this.TO.Enable=!1}OnBeginEdit(e){return!o.e.IsEmpty(e.args.item.BillNo)}LoadGrid(){this.Vouchers=new D.a(!0),this.Vouchers.CanUserDeleteRows=!0,this.Vouchers.Table=[],this.Vouchers.OnBeginEdit.Subscribe(this,"OnBeginEdit"),this.Vouchers.TableColumns.push("Select"),this.Vouchers.TableColumns.push("Sno"),this.Vouchers.TableColumns.push("Date"),this.Vouchers.TableColumns.push("HCNo"),this.Vouchers.TableColumns.push("Customer"),this.Vouchers.TableColumns.push("Product"),this.Vouchers.TableColumns.push("BillCycle"),this.Vouchers.TableColumns.push("Price"),this.Vouchers.TableColumns.push("CustomerID"),this.Vouchers.TableColumns.push("DtBill"),this.Vouchers.TableColumns.push("BillNo"),this.Vouchers.TableColumns.push("Billdate"),this.Vouchers.TableColumns.push("TotDays"),this.Vouchers.TableColumns.push("InvDocDetailsID"),this.Vouchers.TableColumns.push("Remarks"),this.Vouchers.TableColumns.push("ProductID"),this.Vouchers.TableColumns.push("Fromdate"),this.Vouchers.TableColumns.push("Todate"),this.Vouchers.TableColumns.push("billseq");let e=new d.a;this.Vouchers.Columns=[],e=new d.a,e.Header="Select",e.DisplayMember="Select",e.DataType="CheckBox",e.Width=50,this.Vouchers.Columns.push(e),e=new d.a,e.Header="Sno",e.DisplayMember="Sno",e.DataType="TextBlock",e.Width=50,e.ReadOnly=!0,this.Vouchers.Columns.push(e),e=new d.a,e.Header="HC Date",e.DisplayMember="Date",e.DataType="TextBlock",e.Width=80,e.ReadOnly=!0,this.Vouchers.Columns.push(e),e=new d.a,e.Header="HC No.",e.DisplayMember="HCNo",e.DataType="LINK",e.Click.Subscribe(this,"onHCClick"),e.Width=100,e.ReadOnly=!0,this.Vouchers.Columns.push(e),e=new d.a,e.Header="Customer",e.DisplayMember="Customer",e.DataType="TextBlock",e.Width=200,e.ReadOnly=!0,this.Vouchers.Columns.push(e),e=new d.a,e.Header="Product",e.DisplayMember="Product",e.DataType="TextBlock",e.Width=150,e.ReadOnly=!0,this.Vouchers.Columns.push(e),e=new d.a,e.Header="BillCycle",e.DisplayMember="BillCycle",e.DataType="TextBlock",e.Width=200,e.ReadOnly=!0,this.Vouchers.Columns.push(e),e=new d.a,e.Header="Tot Days",e.DisplayMember="TotDays",e.DataType="TextBlock",e.Width=80,e.ReadOnly=!0,this.Vouchers.Columns.push(e),e=new d.a,e.Header="Qty",e.DisplayMember="Qty",e.DataType="FLOAT",e.Width=80,e.ReadOnly=!0,e.IsVisible=!1,this.Vouchers.Columns.push(e),e=new d.a,e.Header="Price",e.DisplayMember="Price",e.DataType="FLOAT",e.Width=70,e.DecimalPoints=i.a.SessionManager.Preferences.DecimalsinAmount,e.ReadOnly=!0,this.Vouchers.Columns.push(e),e=new d.a,e.Header="Bill No",e.DisplayMember="BillNo",e.DataType="LINK",e.Width=100,e.ReadOnly=!0,e.Click.Subscribe(this,"onDOcClick"),this.Vouchers.Columns.push(e),e=new d.a,e.Header="Bill Date",e.DisplayMember="Billdate",e.Width=100,e.ReadOnly=!0,this.Vouchers.Columns.push(e),e=new d.a,e.Header="Remarks",e.DisplayMember="Remarks",e.Width=100,e.ReadOnly=!0,this.Vouchers.Columns.push(e),this.Vouchers.SearchVisible=!0,this.Vouchers.SelectAll.Visible=!0,this.Vouchers.SearchColStartIndex=1,this.Vouchers.AddSearchCols()}onHCClick(e){return Object(a.b)(this,void 0,void 0,(function*(){if(null!=this.Vouchers.SelectedItem&&!o.e.IsEmpty(this.Vouchers.SelectedItem.HCNo)){let e=0,t=i.a.report.GetDocumentDetailsByVoucherNo(this.Vouchers.SelectedItem.HCNo.toString());if(e=o.e.Int(t.obj),e>0){let e;e=t.Tables[0].length>0?t.Tables[0][0]:t.Tables[1][0];const{AddEditDocumentComponent:a}=yield Promise.resolve().then(s.bind(null,"MCKn")),{AddEditDocumentViewModel:o}=yield Promise.resolve().then(s.bind(null,"1Cra"));let r=new o(parseInt(e.CostCenterID),e.DocumentName.toString(),!0);r.ScreenObject.DocPrefix.ComboBox.SelectedValue=e.DocPrefix.toString(),r.ScreenObject.DocPrefix.TextBox.Text=e.DocNumber.toString(),r.OnDocPrefixChanged("lostFocus"),r.ScreenObject.FillDocumentPrefix(!0),i.a.page.addNewTab({component:a,params:{obj:r}})}}}))}onDOcClick(e){return Object(a.b)(this,void 0,void 0,(function*(){if(null!=this.Vouchers.SelectedItem&&!o.e.IsEmpty(this.Vouchers.SelectedItem.BillNo)){let e=0,t=i.a.report.GetDocumentDetailsByVoucherNo(this.Vouchers.SelectedItem.BillNo.toString());if(e=o.e.Int(t.obj),e>0){let e;e=t.Tables[0].length>0?t.Tables[0][0]:t.Tables[1][0];const{AddEditDocumentComponent:a}=yield Promise.resolve().then(s.bind(null,"MCKn"));let o=new C.AddEditDocumentViewModel(parseInt(e.CostCenterID),e.DocumentName.toString(),!0);o.ScreenObject.DocPrefix.ComboBox.SelectedValue=e.DocPrefix.toString(),o.ScreenObject.DocPrefix.TextBox.Text=e.DocNumber.toString(),o.OnDocPrefixChanged("lostFocus"),o.ScreenObject.FillDocumentPrefix(!0),i.a.page.addNewTab({component:a,params:{obj:o}})}}}))}OnButtonClick(e){if("Hide"==e)this.ShowProcessDialog=!1;else if("Generate Bills"==e)this.ProgressMessage="Resaving documents.Please wait...",this.ShowProcessDialog=!0,this.SaveCall();else if("Export"==e);else if("OK"==e){this.SelectAll=!1;let e=0,t=0;null!=this.From.Text&&o.e.Int(this.From.Text)>0&&(e=parseInt(this.From.Text)),null!=this.TO.Text&&o.e.Int(this.TO.Text)>0&&(t=parseInt(this.TO.Text));let s=this.GetBills(this.FromDate.Date,this.ToDate.Date,this.VoucherWise,e,t,this.TillDate.Date,this.Customer.SelectedValue);if(null!=s&&s.Tables.length>0&&s.Columns[0].Contains("ErrorMessage")&&s.Tables[0].length>0)return this.DisplayMessage=s.Tables[0][0].ErrorMessage.toString(),void(this.MessageVisibility=!0);if(null!=s&&s.Tables.length>0){let e=!1;if(s.Tables.length>1&&s.Tables[1].length>0&&s.Columns[1].Contains("Name")){if(this.dtpref=s.Tables[1],!this.Vouchers.TableColumns.Contains("Qty")){let e=this.dtpref.filter(e=>"QtyBased"==e.Name);e.length>0&&!o.e.IsEmpty(e[0].Value)&&Object(r.j)(e[0].Value.toString())&&(this.Vouchers.TableColumns.push("Qty"),this.Vouchers.Columns[8].IsVisible=!0,this.Vouchers.UpdateFooter())}let t=this.dtpref.filter(e=>"InvoiceOnDelDate"==e.Name);t.length>0&&(e=Object(r.j)(t[0].Value.toString())),e&&!this.Vouchers.TableColumns.Contains("InvDate")&&this.Vouchers.TableColumns.push("InvDate")}this.Vouchers.Table.Clear();for(let t=0;t<s.Tables[0].length;t++){if("1"==this.Status.SelectedValue&&!o.e.IsEmpty(s.Tables[0][t].BillNo))continue;if("2"==this.Status.SelectedValue&&""==o.e.String(s.Tables[0][t].BillNo))continue;let a=this.Vouchers.NewRow();a.Date=new Date(s.Tables[0][t].docdate.toString()).ToString(i.a.SessionManager.Preferences["Date Format"]),a.HCNo=s.Tables[0][t].voucherno,a.Customer=s.Tables[0][t].accountname,a.CustomerID=s.Tables[0][t].debitaccount,a.Product=s.Tables[0][t].productname,a.ProductID=s.Tables[0][t].Prodid,a.Fromdate=new Date(o.e.String(s.Tables[0][t].Fromdate)),a.Todate=new Date(o.e.String(s.Tables[0][t].Todate)),a.BillCycle="from "+new Date(s.Tables[0][t].Fromdate.toString()).ToString(i.a.SessionManager.Preferences["Date Format"])+"- to "+new Date(s.Tables[0][t].Todate.toString()).ToString(i.a.SessionManager.Preferences["Date Format"]),o.e.IsEmpty(s.Tables[0][t].Amount)||(a.Price=parseFloat(s.Tables[0][t].Amount.toString()).ToString("N"+i.a.SessionManager.Preferences.DecimalsinAmount));let n=new Date(s.Tables[0][t].Todate.toString()).Subtract(new Date(s.Tables[0][t].Fromdate.toString())).TotalDays+1;o.e.IsEmpty(s.Tables[0][t].ExlDays)||(n-=parseInt(s.Tables[0][t].ExlDays.toString())),a.TotDays=n,a.DtBill=new Date(s.Tables[0][t].Billdate.toString()),a.Billdate=new Date(s.Tables[0][t].Billdate.toString()).ToString(i.a.SessionManager.Preferences["Date Format"]),a.BillNo=s.Tables[0][t].BillNo,a.InvDocDetailsID=s.Tables[0][t].InvDocDetailsID,a.Sno=(t+1).toString(),a.Select=!1,this.Vouchers.TableColumns.Contains("Qty")&&s.Columns[0].Contains("Qty")&&(a.Qty=s.Tables[0][t].Qty),this.Vouchers.TableColumns.Contains("billseq")&&s.Columns[0].Contains("billseq")&&(a.billseq=s.Tables[0][t].billseq),e&&(a.InvDate="1"==a.billseq.toString()?new Date(o.e.String(s.Tables[0][t].Fromdate)):new Date(o.e.String(s.Tables[0][t].Todate)));let h=this.dtpref.filter(e=>"OffHireDoc"==e.Name);h.length>0&&!o.e.IsEmpty(h[0].Value)&&parseInt(h[0].Value.toString())>0&&(a.Remarks=s.Columns[0].Contains("isoffhire")&&!o.e.IsEmpty(s.Tables[0][t].isoffhire)&&Object(r.j)(s.Tables[0][t].isoffhire.toString())?"Off Hire":"Hire cont."),this.Vouchers.addRow(a)}}}}GetExportHTML(){let e="",t="";e+="<html><meta charset='utf-8' /><body style='color:blac;background-color:white;'>",t+=".hdr{text-align:cente; padding:5px; background-color:#4F81BD;color:white;font-family:Arial;font-size:11pt} ",t+=".grp{padding:2p; background-color:#87CEEB; color:#FFFCF7;font-family:arial; font-size:10pt;}",t+=".tot{background-color:whit; color:red;font-family:arial; font-weight:bold; font-size:8pt;}",t+=".alt{background-color:whitesmok; color:black; font-family:arial; font-size:9pt; align:right;}",e+="<style>"+t.toString()+"</style>";let s=0;for(let i=0;i<this.Vouchers.Columns.length;i++)s+=this.Vouchers.Columns[i].Width;e+="<table>",e+="\r\n<tr><td align='center'><h2>",e+=i.a.SessionManager.CompanyName,e+="</h2></td></tr>",e+="\r\n<tr><td align='center'><h3 style='vertical-align:middl;'>",e+=this.DisplayName,e+="</h3></td></tr>",e+="\r\n<tr><td align='center'>",e+=" From :  "+this.FromDate.Date.ToString(i.a.SessionManager.Preferences["Date Format"]),e+=" &nbs;&nbsp;&nbsp;To :  "+this.ToDate.Date.ToString(i.a.SessionManager.Preferences["Date Format"]),e+="</td></tr>",e+="<tr><td style='padding-top:10p;'><table border=1 width='"+s+"' style='border-collapse:collapse;  font-family:arial; font-size:9pt;' >",e+="<COLGROUP>";for(let i=0;i<this.Vouchers.Columns.length-2;i++)e+="FLOAT"==this.Vouchers.Columns[i].DataType?"<COL style='text-align:righ;'>":"<COL style=''>";e+="</COLGROUP>",e+="<tr style=''>";for(let i=0;i<this.Vouchers.Columns.length-2;i++)e+="<th class='hdr' width='"+this.Vouchers.Columns[i].Width,e+="px' >",e+=this.Vouchers.Columns[i].Header,e+="</th>";e+="</tr>";let a=this.Vouchers.Table;for(let i=0;i<a.length;i++){e+="<tr",i%2==1&&(e+=" class=alt"),e+=">";for(let t=0;t<this.Vouchers.Columns.length-2;t++)e+="<td",e+="FLOAT"==this.Vouchers.Columns[t].DataType?" align='right'":" align='left'",e+=">",e+=a[i][this.Vouchers.Columns[t].DisplayMember].toString(),e+="</td>";e+="</tr>"}return e+="</table>",e+="</td></tr></table>",e+="</body><html>",e}SelectUnselectAll(e){let t=this.Vouchers.Table;for(let s=0;s<t.length;s++)""==o.e.String(t[s].BillNo)&&(t[s].Select=e);this.Vouchers.refreshDataView()}SaveCall(){if(this.ProgressValue=1,null==this.dtpref)return;let e=0,t=0,s=!1;this.Billdatefld="";let a=this.dtpref.filter(e=>"SIVDoc"==e.Name);if(a.length>0&&(e=parseInt(a[0].Value.toString())),a=this.dtpref.filter(e=>"HireContractDoc"==e.Name),a.length>0&&(t=parseInt(a[0].Value.toString())),a=this.dtpref.filter(e=>"SIVBillingDate"==e.Name),a.length>0&&(this.Billdatefld=a[0].Value.toString()),a=this.dtpref.filter(e=>"InvoiceOnDelDate"==e.Name),a.length>0&&(s=Object(r.j)(a[0].Value.toString())),0==e)return;this.objViewModel=new C.AddEditDocumentViewModel(e,"",!0),this.objViewModel.GenratePrefix=!0;var i=this.objViewModel.ScreenObject.Link.LinkCombo.Items.find(e=>e.Parent==t.toString());if(null==i||null==i)return void(this.DisplayMessage="Please place linking between Hire Contract and Sales invoice Docuemnt");if(this.objViewModel.ScreenObject.Link.LinkCombo.SelectedValue=i.Value,!this.objViewModel.ScreenObject.GridDataColumns.Contains(this.Billdatefld))return void(this.DisplayMessage="Sales invoice Billing Date should be in body");let n="",h=null;"1"==this.BasedOn.SelectedValue?s?(h=this.Vouchers.Table.filter(e=>1==e.Select),h=h.sort((e,t)=>e.CustomerID>t.CustomerID||e.CustomerID==t.CustomerID&&e.InvDate>t.InvDate?1:-1)):(h=this.Vouchers.Table.filter(e=>1==e.Select),h=h.sort((e,t)=>t.CustomerID-e.CustomerID)):s?(h=this.Vouchers.Table.filter(e=>1==e.Select),h=h.sort((e,t)=>e.HCNo>t.HCNo||e.HCNo==t.HCNo&&e.InvDate>t.InvDate?1:-1)):(h=this.Vouchers.Table.filter(e=>1==e.Select),h=h.sort((e,t)=>t.HCNo-e.HCNo)),this.obja=[];let l=null;for(let r=0;r<h.length;r++)n.Contains(o.e.String(h[r].HCNo))||(""!=n&&(n+="','"),n+=h[r].HCNo.toString()),(0==r||s&&new Date(h[r].InvDate.toString()).Date()!=new Date(h[r-1].InvDate.toString()).Date()||"1"==this.BasedOn.SelectedValue&&o.e.String(h[r].CustomerID)!=o.e.String(h[r-1].CustomerID)||"1"!=this.BasedOn.SelectedValue&&o.e.String(h[r].HCNo)!=o.e.String(h[r-1].HCNo))&&(r>0&&this.obja.push(l),l=[]),l.push(h[r]);null!=l&&this.obja.push(l),this.ProgressMax=this.obja.length,this.InProgress=this.ProgressValue+" of "+this.ProgressMax,this.ProgressWidth=100*(this.ProgressValue-1)/this.ProgressMax,0==this.ProgressWidth&&(this.ProgressWidth=1),this.objViewModel.ScreenObject.GetLinkDocDetails(n,parseInt(i.Value),"",!0).subscribe(e=>{this.dsLink=e,this.objViewModel.IsSelectAll=!0,this.iLoop=0,this.objViewModel.SaveCallBackMethod.Subscribe(this,"SaveCallBack_Complete"),this.SaveCallBack()})}SaveCallBack(){let e=!1,t=this.dtpref.filter(e=>"InvoiceOnDelDate"==e.Name);if(t.length>0&&(e=Object(r.j)(t[0].Value.toString())),this.iLoop>=this.obja.length)return this.Vouchers.refreshDataView(),void(this.ShowProcessDialog=!1);this.InProgress=this.ProgressValue+" of "+this.ProgressMax,this.ids=this.obja[this.iLoop],this.objViewModel.DocumentDate=this.InvoiceDate.Date,this.objViewModel.DocumentDate=e&&this.ids.length>0?new Date(this.ids[0].InvDate).Date():this.InvoiceDate.Date;for(let s=0;s<this.ids.length;s++){let e=[];e.push(this.ids[s]),0==s&&null!=this.objViewModel.ScreenObject.DebitAccount&&(this.objViewModel.ScreenObject.DebitAccount.SelectedValue=parseInt(o.e.String(this.ids[s].CustomerID)),this.objViewModel.ScreenObject.Data.Tables[0].filter(e=>null!=e.LocalReference&&e.LocalReference=="'"+this.objViewModel.ScreenObject.DebitAccount.DBColumnID+"'").length>0&&this.objViewModel.ScreenObject.GetLinkReferenceData(this.objViewModel.ScreenObject.DebitAccount.DBColumnID,this.objViewModel.CostCenterID,this.objViewModel.ScreenObject.DebitAccount.SelectedValue,this.objViewModel.DocumentDate,this.objViewModel.ScreenObject.DebitAccount.DBColumnName,2,null));let t=this.objViewModel.GetEmptyRowPosition(this.objViewModel.ScreenObject.GridDataObj,"ProductID_Key");this.objViewModel.LoadLinkData(this.dsLink,e,0,[],null),this.objViewModel.ScreenObject.GridData[t][this.Billdatefld]=new Date(this.ids[s].DtBill.toString()).ToString(i.a.SessionManager.Preferences["Date Format"]),this.objViewModel.ScreenObject.GridDataColumns.Contains(this.Billdatefld+"_Key")&&(this.objViewModel.ScreenObject.GridData[t][this.Billdatefld+"_Key"]=new Date(this.ids[s].DtBill.toString())),this.objViewModel.ScreenObject.GridDataColumns.Contains("dcnum10")&&(this.objViewModel.ScreenObject.GridData[t].dcnum10=this.ids[s].TotDays.toString()),!o.e.IsEmpty(this.ids[s].Fromdate)&&this.objViewModel.ScreenObject.GridDataColumns.Contains("dcalpha6_Key")&&(this.objViewModel.ScreenObject.GridData[t].dcalpha6_Key=new Date(this.ids[s].Fromdate.toString()),this.objViewModel.ScreenObject.GridData[t].dcalpha6=new Date(this.ids[s].Fromdate.toString()).ToString(i.a.SessionManager.Preferences["Date Format"])),!o.e.IsEmpty(this.ids[s].Todate)&&this.objViewModel.ScreenObject.GridDataColumns.Contains("dcalpha7_Key")&&(this.objViewModel.ScreenObject.GridData[t].dcalpha7_Key=new Date(this.ids[s].Todate.toString()),this.objViewModel.ScreenObject.GridData[t].dcalpha7=new Date(this.ids[s].Todate.toString()).ToString(i.a.SessionManager.Preferences["Date Format"])),this.objViewModel.ScreenObject.GridData[t].ProductID_Key.toString()!=this.ids[s].ProductID.toString()&&(this.objViewModel.ScreenObject.GridData[t].ProductID_Key=this.ids[s].ProductID.toString()),this.objViewModel.ScreenObject.GridData[t].Rate=this.ids[s].Price.toString(),this.Vouchers.TableColumns.Contains("Qty")&&!o.e.IsEmpty(this.ids[s].Qty)&&(this.objViewModel.ScreenObject.GridData[t].Quantity=this.ids[s].Qty.toString()),this.objViewModel.ScreenObject.GridDataColumns.Contains("LineNarration")&&(this.objViewModel.ScreenObject.GridData[t].LineNarration=this.ids[s].BillCycle.toString()+"("+this.ids[s].Remarks.toString()+")"),this.objViewModel.CalculateTotals(this.objViewModel.ScreenObject.GridData[t],!1)}this.objViewModel.SaveInventoryDocument("Save",!1)}SaveCallBack_Complete(){setTimeout(()=>{if(this.objViewModel.RetValue<=0)this.objViewModel.clear(1);else for(let e=0;e<this.ids.length;e++)this.ids[e].BillNo=this.objViewModel.DisplayMessage,this.ids[e].Select=!1;this.ProgressValue++,this.iLoop++,this.SaveCallBack()},30)}GetBills(e,t,s,a,o,r,n){Logger.InfoLog("Document:: Inside GetBills");try{let h=[];return h.push(e.ToString("dd/MMM/yyyy")),h.push(t.ToString("dd/MMM/yyyy")),h.push(s),h.push(a),h.push(o),h.push(r.ToString("dd/MMM/yyyy")),h.push(n),h.push(i.a.SessionManager.UserName),h.push(i.a.SessionManager.UserID),h.push(i.a.SessionManager.LanguageID),i.a.document.GetBills(h)}catch(h){return Logger.ErrorLog("Document:: GetBills"+h.stack),null}}}}}]);